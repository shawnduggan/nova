/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-sonnet-4",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-2.5-flash-preview-05-20",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  licensing: {
    licenseKey: "",
    debugSettings: {
      enabled: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "License & Tier" });
    const currentTier = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getCurrentTier()) || "core";
    const currentLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getCurrentLicense();
    const tierDisplay = licenseContainer.createDiv({ cls: "nova-tier-display" });
    const tierText = currentTier === "supernova" ? "SuperNova" : "Core (Free)";
    const tierIcon = currentTier === "supernova" ? "\u2B50" : "\u{1F193}";
    tierDisplay.innerHTML = `
			<div class="nova-tier-badge ${currentTier}">
				<span class="tier-icon">${tierIcon}</span>
				<span class="tier-name">${tierText}</span>
			</div>
		`;
    if (currentLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = currentLicense.expiresAt ? `Expires: ${currentLicense.expiresAt.toLocaleDateString()}` : "Lifetime License";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${currentLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian.Setting(licenseContainer).setName("License Key").setDesc("Enter your Nova SuperNova license key to unlock premium features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter license key...").setValue(this.plugin.settings.licensing.licenseKey).onChange(async (value) => {
        this.plugin.settings.licensing.licenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateLicense(value || null);
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateLicense(licenseKey);
              const tier = this.plugin.featureManager.getCurrentTier();
              if (tier === "supernova") {
                this.showLicenseMessage("\u2705 Valid SuperNova license!", "success");
              } else {
                this.showLicenseMessage("\u274C Invalid or expired license key.", "error");
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("\u274C Error validating license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createFeatureComparison(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createFeatureComparison(container) {
    const comparisonContainer = container.createDiv({ cls: "nova-feature-comparison" });
    comparisonContainer.createEl("h4", { text: "Feature Comparison" });
    const table = comparisonContainer.createEl("table", { cls: "nova-comparison-table" });
    const headerRow = table.createEl("tr");
    headerRow.createEl("th", { text: "Feature" });
    headerRow.createEl("th", { text: "Core (Free)" });
    headerRow.createEl("th", { text: "SuperNova" });
    const features = [
      ["Basic Document Editing", "\u2705", "\u2705"],
      ["Local AI (Ollama, LM Studio)", "\u2705", "\u2705"],
      ["One Cloud AI Provider", "\u2705", "\u2705"],
      ["Multiple Cloud AI Providers", "\u274C", "\u2705"],
      ["Provider Switching in Chat", "\u274C", "\u2705"],
      ["Mobile Device Support", "\u274C", "\u2705"],
      ["Advanced Templates", "\u274C", "\u2705"],
      ["Priority Support", "\u274C", "\u2705"]
    ];
    features.forEach(([feature, core, supernova]) => {
      const row = table.createEl("tr");
      row.createEl("td", { text: feature });
      row.createEl("td", { text: core, cls: core === "\u2705" ? "feature-yes" : "feature-no" });
      row.createEl("td", { text: supernova, cls: supernova === "\u2705" ? "feature-yes" : "feature-no" });
    });
    const upgradeContainer = comparisonContainer.createDiv({ cls: "nova-upgrade-container" });
    const upgradeButton = upgradeContainer.createEl("button", {
      text: "\u2B50 Upgrade to SuperNova",
      cls: "nova-upgrade-btn"
    });
    upgradeButton.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
    });
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian.Setting(debugContainer).setName("Override Tier").setDesc("Override license tier for testing").addDropdown((dropdown) => dropdown.addOption("", "Use Real License").addOption("core", "Force Core Tier").addOption("supernova", "Force SuperNova Tier").setValue(this.plugin.settings.licensing.debugSettings.overrideTier || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideTier = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    var _a;
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "AI Provider Settings" });
    const currentTier = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getCurrentTier()) || "core";
    const isCoreTier = currentTier === "core";
    if (isCoreTier) {
      const restrictionNotice = containerEl.createDiv({ cls: "nova-license-message" });
      restrictionNotice.innerHTML = `
				<strong>Core Tier Restrictions:</strong> You can configure 1 local provider (Ollama) and 1 cloud provider. 
				<a href="#" class="upgrade-link">Upgrade to SuperNova</a> for unlimited providers.
			`;
      const upgradeLink = restrictionNotice.querySelector(".upgrade-link");
      upgradeLink == null ? void 0 : upgradeLink.addEventListener("click", (e) => {
        e.preventDefault();
        window.open("https://novawriter.ai/upgrade", "_blank");
      });
    }
    this.createOllamaSettings();
    this.createClaudeSettings(isCoreTier);
    this.createGoogleSettings(isCoreTier);
    this.createOpenAISettings(isCoreTier);
  }
  createClaudeSettings(isRestricted = false) {
    const { containerEl } = this;
    if (isRestricted && !this.isProviderAllowedForCoreTier("claude")) {
      return this.createRestrictedProviderNotice(containerEl, "Claude (Anthropic)");
    }
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(claudeContainer).setName("Model").setDesc("Claude model to use").addDropdown((dropdown) => dropdown.addOption("claude-sonnet-4", "Claude Sonnet 4").addOption("claude-opus-4", "Claude Opus 4").addOption("claude-3-haiku-20240307", "Claude 3 Haiku").addOption("claude-3-sonnet-20240229", "Claude 3 Sonnet").addOption("claude-3-opus-20240229", "Claude 3 Opus").setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.model = value;
      await this.plugin.saveSettings();
    }));
  }
  isProviderAllowedForCoreTier(providerType) {
    if (!this.plugin.aiProviderManager) return true;
    return this.plugin.aiProviderManager.isProviderAllowed(providerType);
  }
  createRestrictedProviderNotice(container, providerName) {
    const restrictedContainer = container.createDiv({ cls: "nova-provider-section nova-provider-restricted" });
    restrictedContainer.innerHTML = `
			<h4>${providerName} <span class="restriction-badge">SuperNova Only</span></h4>
			<p class="restriction-text">This provider requires a SuperNova license.</p>
		`;
  }
  createOpenAISettings(isRestricted = false) {
    const { containerEl } = this;
    if (isRestricted && !this.isProviderAllowedForCoreTier("openai")) {
      return this.createRestrictedProviderNotice(containerEl, "OpenAI");
    }
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "OpenAI" });
    new import_obsidian.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(openaiContainer).setName("Base URL").setDesc("OpenAI API base URL (for custom endpoints)").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.aiProviders.openai.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use").addDropdown((dropdown) => dropdown.addOption("gpt-4o", "GPT-4o").addOption("gpt-3.5-turbo", "GPT-3.5 Turbo").addOption("gpt-4", "GPT-4").addOption("gpt-4-turbo-preview", "GPT-4 Turbo").setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4o").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createGoogleSettings(isRestricted = false) {
    const { containerEl } = this;
    if (isRestricted && !this.isProviderAllowedForCoreTier("google")) {
      return this.createRestrictedProviderNotice(containerEl, "Google (Gemini)");
    }
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(googleContainer).setName("Model").setDesc("Gemini model to use").addDropdown((dropdown) => dropdown.addOption("gemini-2.5-flash-preview-05-20", "Gemini 2.5 Flash Preview").addOption("gemini-2.5-pro-preview-06-05", "Gemini 2.5 Pro Preview").addOption("gemini-1.5-flash", "Gemini 1.5 Flash").addOption("gemini-1.5-pro", "Gemini 1.5 Pro").setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-05-20").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createOllamaSettings() {
    const { containerEl } = this;
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    var _a;
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Platform Settings" });
    const currentTier = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getCurrentTier()) || "core";
    const isCoreTier = currentTier === "core";
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    if (isCoreTier) {
      const restrictionNotice = platformContainer.createDiv({ cls: "nova-license-message" });
      restrictionNotice.innerHTML = `
				<strong>Platform Restrictions:</strong> Core tier allows 1 local + 1 cloud provider on desktop. 
				Mobile is disabled for Core tier users.
			`;
    }
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        if (this.validateProviderSelection(value, "desktop")) {
          this.plugin.settings.platformSettings.desktop.primaryProvider = value;
          await this.plugin.saveSettings();
          if (this.plugin.aiProviderManager) {
            this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
          }
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileDesc = isCoreTier ? "Mobile access requires SuperNova license" : "Primary AI provider for mobile";
    const mobileSetting = new import_obsidian.Setting(platformContainer).setName("Primary Provider").setDesc(mobileDesc);
    if (isCoreTier) {
      mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "Upgrade to SuperNova for Mobile Access").setValue("none").setDisabled(true));
    } else {
      mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.mobile.primaryProvider = value;
        await this.plugin.saveSettings();
      }));
    }
  }
  getAllowedProvidersForPlatform(platform) {
    var _a;
    if (!this.plugin.aiProviderManager) {
      return ["claude", "openai", "google", "ollama"];
    }
    const currentTier = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getCurrentTier()) || "core";
    if (platform === "mobile" && currentTier === "core") {
      return ["none"];
    }
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    return allowedProviders.length > 0 ? allowedProviders : ["claude", "openai", "google", "ollama"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "OpenAI",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  validateProviderSelection(provider, platform) {
    var _a;
    const currentTier = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getCurrentTier()) || "core";
    if (currentTier === "supernova") {
      return true;
    }
    if (platform === "mobile" && provider !== "none") {
      this.showLicenseMessage("\u274C Mobile access requires SuperNova license.", "error");
      return false;
    }
    if (platform === "desktop" && this.plugin.aiProviderManager) {
      if (!this.plugin.aiProviderManager.isProviderAllowed(provider)) {
        this.showLicenseMessage("\u274C This provider requires SuperNova license.", "error");
        return false;
      }
    }
    return true;
  }
};

// src/ai/provider-manager.ts
var import_obsidian2 = require("obsidian");

// src/ai/providers/claude.ts
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt, options) {
    const messages = [{ role: "user", content: prompt }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt, options) {
    const messages = [{ role: "user", content: prompt }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.content[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        stream: true,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              if (parsed.type === "content_block_delta" && ((_b = parsed.delta) == null ? void 0 : _b.text)) {
                yield { content: parsed.delta.text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt, options) {
    const messages = [{ role: "user", content: prompt }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt, options) {
    const messages = [{ role: "user", content: prompt }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const response = await fetch(this.config.baseUrl || "https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.choices[0].message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const response = await fetch(this.config.baseUrl || "https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt, options) {
    const messages = [{ role: "user", content: prompt }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt, options) {
    const messages = [{ role: "user", content: prompt }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.candidates[0].content.parts[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    if (import_obsidian2.Platform.isMobile && this.featureManager) {
      if (!this.featureManager.isFeatureEnabled("mobile_access")) {
        return ["none"];
      }
    }
    const platform = import_obsidian2.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    let providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    if (this.featureManager && !this.featureManager.isFeatureEnabled("unlimited_cloud_ai")) {
      providers = this.filterProvidersForCoreTier(providers);
    }
    return providers;
  }
  filterProvidersForCoreTier(providers) {
    const localProviders = ["ollama"];
    const cloudProviders = ["claude", "openai", "google"];
    let allowedLocal = [];
    let allowedCloud = [];
    for (const provider of providers) {
      if (localProviders.includes(provider) && allowedLocal.length === 0) {
        allowedLocal.push(provider);
        break;
      }
    }
    for (const provider of providers) {
      if (cloudProviders.includes(provider) && allowedCloud.length === 0) {
        allowedCloud.push(provider);
        break;
      }
    }
    return providers.filter(
      (p) => p === "none" || allowedLocal.includes(p) || allowedCloud.includes(p)
    );
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt, options);
  }
  async *generateTextStream(prompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    return this.getPlatformProviders();
  }
  isProviderAllowed(providerType) {
    return this.getAllowedProviders().includes(providerType);
  }
  getProviderLimits() {
    if (this.featureManager && this.featureManager.isFeatureEnabled("unlimited_cloud_ai")) {
      return { local: Infinity, cloud: Infinity };
    }
    return { local: 1, cloud: 1 };
  }
  cleanup() {
    this.providers.clear();
  }
};

// src/ui/sidebar-view.ts
var import_obsidian3 = require("obsidian");
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var NovaSidebarView = class extends import_obsidian3.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    var _a, _b, _c;
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    if (import_obsidian3.Platform.isMobile && ((_a = this.plugin.featureManager) == null ? void 0 : _a.getCurrentTier()) === "core") {
      if (!this.plugin.featureManager.isFeatureEnabled("mobile_access")) {
        this.showMobileBlockedMessage(container);
        return;
      }
    }
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 10px;
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: 1.1em; display: flex; align-items: center; gap: 6px;";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: 8px;";
    const currentTier = ((_b = this.plugin.featureManager) == null ? void 0 : _b.getCurrentTier()) || "core";
    const canSwitchProviders = ((_c = this.plugin.featureManager) == null ? void 0 : _c.isFeatureEnabled("provider_switching")) || false;
    if (canSwitchProviders) {
      this.createProviderDropdown(rightContainer);
    } else {
      this.createStaticProviderStatus(rightContainer);
    }
    const clearButton = new import_obsidian3.ButtonComponent(rightContainer);
    clearButton.setButtonText("Clear").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.loadConversationForActiveFile();
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: 10px;
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: 8px;
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.inputContainer.style.cssText = `
			display: flex;
			flex-direction: column;
			gap: 8px;
			padding: 10px;
			border-top: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const inputRow = this.inputContainer.createDiv({ cls: "nova-input-row" });
    inputRow.style.cssText = `
			display: flex;
			align-items: center;
			gap: 8px;
		`;
    const textAreaContainer = inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1;";
    this.textArea = new import_obsidian3.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova to help edit your document...");
    this.textArea.inputEl.style.cssText = `
			width: 100%;
			min-height: 38px;
			max-height: 120px;
			resize: vertical;
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			padding: 10px;
			font-size: var(--font-text-size);
			line-height: var(--line-height-normal);
		`;
    this.sendButton = new import_obsidian3.ButtonComponent(inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.setCta();
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
		`;
    this.textArea.inputEl.addEventListener("keydown", (event) => {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        this.handleSend();
      }
    });
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: 10px;
			padding: 8px 12px;
			border-radius: 8px;
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: 0.9em;" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: 0.8em;
			opacity: 0.7;
			margin-bottom: 4px;
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    contentEl.textContent = content;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: 12px;
			margin: 16px auto;
			padding: 16px 20px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 18px;
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: 32px;
			height: 32px;
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Welcome to Nova" });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "Your AI thinking partner. Ask me to help edit your document!" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: #4caf50; display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleSend() {
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.addMessage("user", message);
    this.textArea.setValue("");
    this.sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(message);
      }
      const isLikelyCommand = this.plugin.promptBuilder["isLikelyCommand"](message);
      let response = null;
      if (isLikelyCommand && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(message);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
        response = await this.plugin.aiProviderManager.complete(prompt.systemPrompt, prompt.userPrompt, {
          temperature: prompt.config.temperature,
          maxTokens: prompt.config.maxTokens
        });
      }
      loadingEl.remove();
      if (activeFile && response) {
        await this.plugin.documentEngine.addAssistantMessage(response);
      }
      if (response) {
        this.addMessage("assistant", response);
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addMessage("assistant", `Sorry, I encountered an error: ${error.message}`);
    } finally {
      this.sendButton.setDisabled(false);
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return `\u274C No markdown file is open. Please open a file in the editor to use editing commands.`;
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return `\u274C Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`;
      }
      let result;
      switch (command.action) {
        case "add":
          result = await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          result = await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          result = await this.plugin.rewriteCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, or rewrite content.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return `\u274C Error executing command: ${error.message}`;
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      if (leaves.length > 0) {
        const view = leaves[0].view;
        targetFile = view.file;
      }
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFile = targetFile;
    this.chatContainer.empty();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
      }
    } catch (error) {
      console.warn("Failed to load conversation history:", error);
      this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
      } catch (error) {
        console.warn("Failed to clear conversation:", error);
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared! Ready to help you with "${this.currentFile.basename}". What would you like to do?`);
    } else {
      this.addWelcomeMessage("Chat cleared! Ready to help. What would you like to do?");
    }
    new import_obsidian3.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite"];
    if (validActions.includes(command.action)) {
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt.systemPrompt, prompt.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Create static provider status for Core tier users
   */
  createStaticProviderStatus(container) {
    const providerStatus = container.createDiv({ cls: "nova-header-provider" });
    providerStatus.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			font-size: 0.75em;
			color: var(--text-muted);
			opacity: 0.8;
		`;
    const headerStatusDot = providerStatus.createSpan({ cls: "nova-status-dot-small" });
    headerStatusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const headerProviderName = providerStatus.createSpan({ text: "Loading..." });
    this.plugin.aiProviderManager.getCurrentProviderName().then((name) => {
      headerProviderName.setText(name);
    });
  }
  /**
   * Create provider dropdown for SuperNova tier users
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-muted);
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const statusDot = providerButton.createSpan({ cls: "nova-status-dot-small" });
    statusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
      providerName.setText(currentProviderName);
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    document.addEventListener("click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providerItem = dropdownMenu.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				transition: background-color 0.2s ease;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const displayName = this.getProviderDisplayName(providerType);
      const nameSpan = providerItem.createSpan({ text: displayName });
      const isCurrent = displayName === currentProviderName;
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      providerItem.addEventListener("click", async () => {
        if (!isCurrent) {
          await this.switchToProvider(providerType);
          dropdownMenu.style.display = "none";
          if (this.currentProviderDropdown) {
            this.currentProviderDropdown.updateCurrentProvider();
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Claude",
      "openai": "OpenAI",
      "google": "Gemini",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "#D2691E",
      "openai": "#10A37F",
      "google": "#4285F4",
      "ollama": "#7C3AED",
      "none": "#999"
    };
    return colors[providerType] || "#4caf50";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = `\u{1F504} Switched to ${this.getProviderDisplayName(providerType)}`;
      this.addMessage("system", switchMessage);
      const platform = import_obsidian3.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    } catch (error) {
      console.error("Error switching provider:", error);
      this.addMessage("system", `\u274C Failed to switch to ${this.getProviderDisplayName(providerType)}`);
    }
  }
  /**
   * Show blocked message for Core tier mobile users
   */
  showMobileBlockedMessage(container) {
    container.addClass("nova-mobile-blocked");
    const messageContainer = container.createDiv({ cls: "nova-mobile-block-container" });
    messageContainer.innerHTML = `
			<div class="nova-mobile-block-content">
				<div class="nova-block-icon">\u{1F6AB}</div>
				<h3>Mobile Access Restricted</h3>
				<div class="nova-tier-badge core">
					<span class="tier-icon">\u{1F193}</span>
					<span class="tier-name">Core (Free)</span>
				</div>
				<p>Nova Core is designed for desktop use only.</p>
				<p>Mobile access is available with Nova SuperNova.</p>
				
				<div class="nova-feature-list">
					<h4>SuperNova includes:</h4>
					<ul>
						<li>\u2705 Mobile device support</li>
						<li>\u2705 Multiple AI providers</li>
						<li>\u2705 In-chat provider switching</li>
						<li>\u2705 Advanced templates</li>
					</ul>
				</div>
				
				<button class="mod-cta nova-upgrade-btn">
					\u2B50 Upgrade to SuperNova
				</button>
			</div>
		`;
    const upgradeBtn = messageContainer.querySelector(".nova-upgrade-btn");
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
    });
  }
};

// src/core/document-engine.ts
var import_obsidian4 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.loadConversations();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
      console.warn("Failed to load conversation data:", error);
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
      console.error("Failed to save conversation data:", error);
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Remove old conversations to manage memory
   */
  async cleanupOldConversations(maxAge = 7 * 24 * 60 * 60 * 1e3) {
    const now = Date.now();
    let removedCount = 0;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (now - conversation.lastUpdated > maxAge) {
        this.conversations.delete(filePath);
        removedCount++;
      }
    }
    if (removedCount > 0) {
      await this.saveConversations();
    }
    return removedCount;
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance
   */
  getActiveEditor() {
    const activeEditor = this.app.workspace.activeEditor;
    if (activeEditor == null ? void 0 : activeEditor.editor) {
      return activeEditor.editor;
    }
    let view = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
    if (!view) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of leaves) {
        const leafView = leaf.view;
        if (leafView instanceof import_obsidian4.MarkdownView) {
          view = leafView;
          break;
        }
      }
    }
    if (!view) {
      return null;
    }
    const editor = view.editor;
    return editor || null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at a specific location
   */
  async deleteContent(target, location) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      } else if (target === "section" && location) {
        const section = await this.findSection(location);
        if (!section) {
          return {
            success: false,
            error: `Section "${location}" not found`,
            editType: "delete"
          };
        }
        const content = editor.getValue();
        const lines = content.split("\n");
        const newLines = lines.filter(
          (_, index) => index < section.range.start || index > section.range.end
        );
        await this.app.vault.modify(file, newLines.join("\n"));
        return {
          success: true,
          editType: "delete",
          appliedAt: { line: section.range.start, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Find a section by heading name
   */
  async findSection(headingText) {
    const context = await this.getDocumentContext();
    if (!context) return null;
    const headingIndex = context.headings.findIndex(
      (h) => h.text.toLowerCase().includes(headingText.toLowerCase())
    );
    if (headingIndex === -1) return null;
    const heading = context.headings[headingIndex];
    const nextHeading = context.headings[headingIndex + 1];
    const lines = context.content.split("\n");
    const endLine = nextHeading ? nextHeading.line - 1 : lines.length - 1;
    const sectionLines = lines.slice(heading.line + 1, endLine + 1);
    const sectionContent = sectionLines.join("\n").trim();
    return {
      heading: heading.text,
      level: heading.level,
      content: sectionContent,
      range: {
        start: heading.line,
        end: endLine
      }
    };
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor() {
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: 0.7,
      maxTokens: 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents directly. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Be concise and focused on the specific request
- Do not add section headers unless specifically requested`;
    const actionSpecificPrompts = {
      add: `
TASK: Add new content to the document.
- Create well-structured, relevant content that fits the document's purpose
- Use appropriate markdown formatting (headings, lists, emphasis)
- Ensure smooth flow with existing content
- Match the document's style and tone`,
      edit: `
TASK: Edit and improve existing content.
- Enhance clarity, readability, and flow
- Preserve the original meaning unless changes are requested
- Improve word choice and sentence structure
- Maintain the original formatting and structure`,
      delete: `
TASK: Remove specified content from the document.
- Identify the exact content to be removed
- Ensure remaining content flows naturally
- Preserve document structure and formatting
- Confirm the deletion is appropriate for the context`,
      grammar: `
TASK: Fix grammar, spelling, and language issues.
- Correct spelling errors, grammar mistakes, and typos
- Improve sentence structure and clarity
- Maintain the original voice and style
- Preserve all formatting and markdown syntax
- Make minimal changes - only fix actual errors`,
      rewrite: `
TASK: Rewrite or restructure content.
- Create new content that serves the same purpose
- Improve organization, clarity, and flow
- Use more effective language and structure
- Maintain key information and concepts
- Adapt to any specified style requirements`
    };
    return basePrompt + actionSpecificPrompts[action];
  }
  /**
   * Build user prompt with specific instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt = `${contextInfo}

USER REQUEST: ${command.instruction}`;
    if (command.context && command.context.trim()) {
      prompt += `

ADDITIONAL REQUIREMENTS: ${command.context}`;
    }
    const targetInstructions = this.getTargetInstructions(command);
    if (targetInstructions) {
      prompt += `

${targetInstructions}`;
    }
    const actionInstructions = this.getActionInstructions(command);
    if (actionInstructions) {
      prompt += `

${actionInstructions}`;
    }
    return prompt;
  }
  /**
   * Get target-specific instructions
   */
  getTargetInstructions(command) {
    switch (command.target) {
      case "selection":
        return "FOCUS: Work with the selected text only. Provide the improved version of the selected content.";
      case "section":
        if (command.location) {
          return `FOCUS: Work with the "${command.location}" section. ${command.action === "add" ? "Add content to this section." : "Modify only this section."}`;
        }
        return "FOCUS: Work with the current section.";
      case "document":
        return "FOCUS: Apply changes to the entire document while preserving its structure.";
      case "end":
        return "FOCUS: Add content at the end of the document. Ensure it flows naturally from existing content.";
      case "paragraph":
        return "FOCUS: Work with the current paragraph or create a new paragraph.";
      default:
        return "";
    }
  }
  /**
   * Get action-specific instructions
   */
  getActionInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added. Include appropriate headings if adding a section.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide only the corrected text with grammar and spelling fixes.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      default:
        return "";
    }
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeHistory && conversationContext && conversationContext.trim()) {
      context += `
${conversationContext}
`;
    }
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += "\nDOCUMENT STRUCTURE:\n";
      documentContext.headings.forEach((heading) => {
        const indent = "  ".repeat(heading.level - 1);
        context += `${indent}- ${heading.text}
`;
      });
    }
    if (documentContext.selectedText && command.target === "selection") {
      context += `
SELECTED TEXT:
${documentContext.selectedText}
`;
    }
    if (command.target === "section" && command.location) {
      const section = this.findSectionInContent(documentContext.content, command.location);
      if (section) {
        context += `
CURRENT SECTION "${command.location}":
${section}
`;
      }
    } else if (command.target === "paragraph" && documentContext.surroundingLines) {
      context += "\nCURRENT CONTEXT:\n";
      if (documentContext.surroundingLines.before.length > 0) {
        context += `Before: ${documentContext.surroundingLines.before.join(" ")}
`;
      }
      if (documentContext.surroundingLines.after.length > 0) {
        context += `After: ${documentContext.surroundingLines.after.join(" ")}
`;
      }
    }
    const contentLines = documentContext.content.split("\n");
    if (contentLines.length > config.maxContextLines) {
      const start = Math.max(0, contentLines.length - config.maxContextLines);
      context += `
RECENT CONTENT (last ${config.maxContextLines} lines):
`;
      context += contentLines.slice(start).join("\n");
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}`;
    }
    return context;
  }
  /**
   * Find a specific section in content
   */
  findSectionInContent(content, sectionName) {
    const lines = content.split("\n");
    const normalizedSectionName = sectionName.toLowerCase().trim();
    let sectionStart = -1;
    let sectionLevel = 0;
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const heading = headingMatch[2].toLowerCase().trim();
        if (heading === normalizedSectionName || heading.includes(normalizedSectionName)) {
          sectionStart = i;
          sectionLevel = level;
          break;
        }
      }
    }
    if (sectionStart === -1) return null;
    let sectionEnd = lines.length;
    for (let i = sectionStart + 1; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+/);
      if (headingMatch && headingMatch[1].length <= sectionLevel) {
        sectionEnd = i;
        break;
      }
    }
    return lines.slice(sectionStart, sectionEnd).join("\n");
  }
  /**
   * Create a simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner. Provide helpful, concise responses to user requests. Focus on being practical and actionable.`;
    let userPrompt = instruction;
    if (context) {
      userPrompt = `Context: ${context}

Request: ${instruction}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 500
      }
    };
  }
  /**
   * Build prompt for conversation context
   */
  buildConversationPrompt(message, documentContext, recentHistory = []) {
    let systemPrompt = `You are Nova, an AI writing partner that helps users with their documents. You can:
- Answer questions about writing and editing
- Provide suggestions for improvement
- Help plan document structure
- Assist with research and content development

Be helpful, concise, and practical in your responses.`;
    let userPrompt = message;
    let context = "";
    if (documentContext) {
      context += `Current document: ${documentContext.filename}
`;
      if (documentContext.headings.length > 0) {
        context += "Document structure:\n";
        documentContext.headings.forEach((heading) => {
          const indent = "  ".repeat(heading.level - 1);
          context += `${indent}- ${heading.text}
`;
        });
      }
    }
    if (recentHistory.length > 0) {
      context += "\nRecent conversation:\n";
      recentHistory.slice(-3).forEach((msg) => {
        if (msg.role === "user") {
          context += `You: ${msg.content}
`;
        } else if (msg.role === "assistant") {
          context += `Nova: ${msg.content}
`;
        }
      });
    }
    if (context) {
      userPrompt = `${context}

Current message: ${message}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context,
      config: {
        temperature: 0.8,
        maxTokens: 800
      }
    };
  }
  /**
   * Estimate token count for a prompt
   */
  estimateTokenCount(prompt) {
    const totalText = prompt.systemPrompt + prompt.userPrompt + prompt.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Validate prompt generation
   */
  validatePrompt(prompt) {
    const issues = [];
    if (!prompt.systemPrompt || prompt.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt.userPrompt || prompt.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    const tokenCount = this.estimateTokenCount(prompt);
    if (tokenCount > 8e3) {
      issues.push(`Prompt is too long (${tokenCount} tokens, max 8000)`);
    }
    if (prompt.config.temperature < 0 || prompt.config.temperature > 1) {
      issues.push("Temperature must be between 0 and 1");
    }
    if (prompt.config.maxTokens < 10 || prompt.config.maxTokens > 4e3) {
      issues.push("Max tokens must be between 10 and 4000");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document", "paragraph"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection", "section", "line"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert)\b(?!\s+.*\b(better|clearer|more|less)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i
    ],
    targets: ["end", "section", "paragraph"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection", "section", "paragraph"]
  }
];
var LOCATION_PATTERNS = [
  /\b(?:to|in|at|under|within|inside)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:section|heading|part)\s+["']([^"']+?)["']/i,
  /\b(?:section|heading)\s+(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:the\s+)?([a-zA-Z][a-zA-Z\s&]*?)\s+(?:section|heading)\b/i
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:this|current|selected)\s+(?:paragraph|line)/i, target: "paragraph" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" },
  { pattern: /\b(?:section|heading|part)/i, target: "section" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const location = this.extractLocation(input);
    const context = this.extractContext(input);
    return {
      action,
      target,
      location,
      instruction: input,
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return input.includes("section") || input.includes("heading") ? "section" : "end";
      case "edit":
        return hasSelection ? "selection" : "paragraph";
      case "delete":
        return hasSelection ? "selection" : "section";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return "end";
      default:
        return "paragraph";
    }
  }
  /**
   * Extract location information from the input
   */
  extractLocation(input) {
    for (const pattern of LOCATION_PATTERNS) {
      const match = pattern.exec(input);
      if (match && match[1]) {
        return match[1].trim();
      }
    }
    return void 0;
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "delete" && !command.location) {
      return {
        valid: false,
        error: "Please specify which section to delete"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection, hasHeadings) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add a conclusion section",
        "Fix grammar in this document",
        "Add an introduction",
        "Create a summary"
      );
    }
    if (hasHeadings) {
      suggestions.push(
        "Add content to the introduction section",
        "Expand the methodology section"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target, location } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new sections";
        break;
    }
    if (location) {
      description += ` in "${location}"`;
    } else {
      switch (target) {
        case "selection":
          description += " in selected text";
          break;
        case "section":
          description += " in current section";
          break;
        case "paragraph":
          description += " in current paragraph";
          break;
        case "document":
          description += " in entire document";
          break;
        case "end":
          description += " at end of document";
          break;
      }
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const commandWords = [
      "add",
      "create",
      "write",
      "insert",
      "include",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "fix",
      "correct",
      "grammar",
      "spell",
      "proofread",
      "polish",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const lowerMessage = message.toLowerCase();
    return commandWords.some((word) => lowerMessage.includes(word));
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    return this.contextBuilder.buildConversationPrompt(message, documentContext, recentHistory);
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    return this.contextBuilder.buildSimplePrompt(instruction, context);
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt) {
    const validation = this.contextBuilder.validatePrompt(prompt);
    if (!validation.valid) {
      console.warn("Prompt validation issues:", validation.issues);
      let optimizedPrompt = { ...prompt };
      const tokenCount = this.contextBuilder.estimateTokenCount(prompt);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt.context.length * 0.6);
        optimizedPrompt.context = prompt.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt.config.temperature < 0 || prompt.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt.config.temperature));
      }
      if (prompt.config.maxTokens < 10 || prompt.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt) {
    return this.contextBuilder.estimateTokenCount(prompt);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      location: void 0,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt.userPrompt,
          {
            systemPrompt: prompt.systemPrompt,
            temperature: prompt.config.temperature,
            maxTokens: prompt.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "insert"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.documentEngine.applyEdit(
          content,
          await this.determineInsertPosition(command, documentContext),
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Determine where to insert new content
   */
  async determineInsertPosition(command, documentContext) {
    switch (command.target) {
      case "end":
        return "end";
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            return { line: section.range.end, ch: 0 };
          }
        }
        return "cursor";
      case "paragraph":
        return "cursor";
      case "document":
        return "end";
      default:
        return "cursor";
    }
  }
  /**
   * Validate add command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    if (command.target === "section" && !command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for add commands
   */
  getSuggestions(documentContext) {
    const suggestions = [
      "Add a conclusion section",
      "Add an introduction",
      "Create a summary",
      "Add examples",
      "Create a methodology section"
    ];
    if (documentContext.headings.length > 0) {
      const sectionNames = documentContext.headings.map((h) => h.text);
      if (!sectionNames.some((name) => name.toLowerCase().includes("introduction"))) {
        suggestions.unshift("Add an introduction section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("conclusion"))) {
        suggestions.push("Add a conclusion section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("summary"))) {
        suggestions.push("Add a summary section");
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what content would be added (without actually adding it)
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let positionDescription = "";
      switch (command.target) {
        case "end":
          positionDescription = "at the end of the document";
          break;
        case "section":
          if (command.location) {
            positionDescription = `in the "${command.location}" section`;
          } else {
            positionDescription = "in the current section";
          }
          break;
        case "paragraph":
          positionDescription = "at the cursor position";
          break;
        case "document":
          positionDescription = "at the end of the document";
          break;
        default:
          positionDescription = "at the cursor position";
      }
      return {
        success: true,
        preview: `Will add new content ${positionDescription}`,
        position: positionDescription
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt.userPrompt,
          {
            systemPrompt: prompt.systemPrompt,
            temperature: prompt.config.temperature,
            maxTokens: prompt.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyEdit(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          content,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${content}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid edit target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "edit" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for edit commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Make this more professional",
        "Make this more detailed",
        "Improve clarity and flow",
        "Make this more formal",
        "Simplify this text",
        "Expand on this point",
        "Make this more engaging"
      );
    } else {
      suggestions.push(
        "Improve the writing style",
        "Make the document more professional",
        "Enhance clarity throughout",
        "Improve the introduction",
        "Polish the conclusion",
        "Make it more concise",
        "Add more detail",
        "Improve the flow between sections"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Improve the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be edited
   */
  async preview(command) {
    var _a, _b;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will edit the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will edit the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will edit content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will edit content at cursor position";
          if (documentContext.surroundingLines) {
            const currentLine = (_b = (_a = documentContext.cursorPosition) == null ? void 0 : _a.line) != null ? _b : 0;
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              affectedContent = editor.getLine(currentLine);
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will edit the entire document";
          break;
        case "end":
          previewText = "Will add edited content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid edit target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get edit targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of changes
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const conversationContext = this.documentEngine.getConversationContext();
        const promptConfig = conversationContext ? { includeHistory: true } : {};
        const prompt = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
        const promptValidation = this.contextBuilder.validatePrompt(prompt);
        if (!promptValidation.valid) {
          return {
            success: false,
            error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
            editType: "delete"
          };
        }
        try {
          const aiResponse = await this.providerManager.generateText(
            prompt.userPrompt,
            {
              systemPrompt: prompt.systemPrompt,
              temperature: prompt.config.temperature,
              maxTokens: prompt.config.maxTokens
            }
          );
        } catch (error) {
          const result2 = {
            success: false,
            error: error instanceof Error ? error.message : "AI analysis failed",
            editType: "delete"
          };
          await this.documentEngine.addAssistantMessage(
            `Error: ${result2.error}`,
            result2
          );
          return result2;
        }
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0 && !result.success) {
        await this.documentEngine.addAssistantMessage("Failed to delete content", result);
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "delete"
              };
            }
            editor.replaceRange("", startPos, endPos);
            return {
              success: true,
              content: "",
              editType: "delete",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "delete"
            };
          }
        } else {
          return {
            success: false,
            error: "Section name required for section deletion",
            editType: "delete"
          };
        }
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "delete"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          const lineContent = editor.getLine(currentLine);
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine + 1, ch: 0 };
          editor.replaceRange("", startPos, endPos);
          return {
            success: true,
            content: "",
            editType: "delete",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "delete"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end of document. Use a different target.",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: "Invalid deletion target",
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && !command.location) {
      return {
        valid: false,
        error: "Section name required for section deletion"
      };
    }
    if (command.target === "end") {
      return {
        valid: false,
        error: "Cannot delete from end of document. Use a different target."
      };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for delete commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Delete the selected text",
        "Remove this content",
        "Clear the selection"
      );
    } else {
      suggestions.push(
        "Delete the current paragraph",
        "Remove empty sections",
        "Clear redundant content",
        "Delete duplicate information"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Delete the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what would be deleted
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will delete the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = `${section.heading}

${section.content}`;
              previewText = `Will delete the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            return {
              success: false,
              error: "Section name required for preview"
            };
          }
          break;
        case "paragraph":
          previewText = "Will delete the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will delete all document content";
          break;
        case "end":
          return {
            success: false,
            error: "Cannot delete from end of document"
          };
        default:
          return {
            success: false,
            error: "Invalid deletion target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get delete targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-1, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of deletion
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length + section.heading.length;
            linesAffected = section.range.end - section.range.start + 1;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "Invalid target for deletion";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const correctedContent = await this.providerManager.generateText(
          prompt.userPrompt,
          {
            systemPrompt: prompt.systemPrompt,
            temperature: 0.3,
            // Lower temperature for grammar corrections
            maxTokens: prompt.config.maxTokens
          }
        );
        if (!correctedContent || correctedContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate corrected content", result2);
          return result2;
        }
        const result = await this.applyGrammarCorrection(command, documentContext, correctedContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to correct grammar", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Grammar correction failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar correction based on command target
   */
  async applyGrammarCorrection(command, documentContext, correctedContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${correctedContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(correctedContent, startPos, endPos);
          return {
            success: true,
            content: correctedContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(correctedContent);
      case "end":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid grammar correction target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "grammar" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for grammar commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Fix grammar in selected text",
        "Correct spelling and punctuation",
        "Improve sentence structure",
        "Fix capitalization errors",
        "Correct verb tenses",
        "Fix subject-verb agreement",
        "Improve readability"
      );
    } else {
      suggestions.push(
        "Check grammar throughout document",
        "Fix spelling errors",
        "Correct punctuation",
        "Improve sentence structure",
        "Fix grammatical errors in current paragraph",
        "Check for common mistakes",
        "Proofread the document"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Check grammar in "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be grammar-corrected
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const potentialIssues = [];
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will check grammar in the selected text";
            potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will check grammar in the "${command.location}" section`;
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will check grammar at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will check grammar in the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will check grammar throughout the entire document";
          potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          break;
        case "end":
          previewText = "Will add grammar-corrected content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid grammar correction target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        potentialIssues: potentialIssues.slice(0, 5)
        // Limit to 5 issues
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Detect potential grammar issues in text
   */
  detectPotentialIssues(text) {
    const issues = [];
    const patterns = [
      { pattern: /\bi\s/gi, issue: 'Lowercase "i" should be capitalized' },
      { pattern: /\.\s*[a-z]/g, issue: "Sentence should start with capital letter" },
      { pattern: /\s{2,}/g, issue: "Multiple spaces detected" },
      { pattern: /[.!?]{2,}/g, issue: "Multiple punctuation marks" },
      { pattern: /\s+[.!?,:;]/g, issue: "Space before punctuation" },
      { pattern: /[.!?]\w/g, issue: "Missing space after punctuation" },
      { pattern: /\bteh\b/gi, issue: 'Common typo: "teh" should be "the"' },
      { pattern: /\band\s+and\b/gi, issue: 'Duplicate "and"' },
      { pattern: /\bthe\s+the\b/gi, issue: 'Duplicate "the"' },
      { pattern: /\bis\s+is\b/gi, issue: 'Duplicate "is"' }
    ];
    patterns.forEach(({ pattern, issue }) => {
      if (pattern.test(text)) {
        issues.push(issue);
      }
    });
    return issues;
  }
  /**
   * Get grammar check targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of grammar correction
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        estimatedIssues: 0
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const estimatedIssues = this.detectPotentialIssues(contentToAnalyze).length;
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      estimatedIssues
    };
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const rewrittenContent = await this.providerManager.generateText(
          prompt.userPrompt,
          {
            systemPrompt: prompt.systemPrompt,
            temperature: prompt.config.temperature,
            maxTokens: prompt.config.maxTokens
          }
        );
        if (!rewrittenContent || rewrittenContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate rewritten content", result2);
          return result2;
        }
        const result = await this.applyRewrite(command, documentContext, rewrittenContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Rewrite generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, rewrittenContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${rewrittenContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(rewrittenContent, startPos, endPos);
          return {
            success: true,
            content: rewrittenContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(rewrittenContent);
      case "end":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid rewrite target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "rewrite" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for rewrite commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Rewrite in a more formal tone",
        "Rewrite in a casual tone",
        "Make this more concise",
        "Expand with more detail",
        "Rewrite for clarity",
        "Simplify the language",
        "Make it more engaging",
        "Rewrite in bullet points",
        "Convert to narrative form"
      );
    } else {
      suggestions.push(
        "Rewrite the current paragraph",
        "Rewrite in a different style",
        "Make the writing more engaging",
        "Simplify complex language",
        "Rewrite for different audience",
        "Convert to more formal tone",
        "Make the content more concise"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Rewrite the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be rewritten
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const rewriteStyle = this.inferRewriteStyle(command.instruction);
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = `Will rewrite the selected text`;
            if (rewriteStyle) {
              previewText += ` (${rewriteStyle})`;
            }
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will rewrite the "${command.location}" section`;
              if (rewriteStyle) {
                previewText += ` (${rewriteStyle})`;
              }
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will rewrite content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will rewrite the current paragraph";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will rewrite the entire document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        case "end":
          previewText = "Will add rewritten content at the end of the document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        default:
          return {
            success: false,
            error: "Invalid rewrite target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        rewriteStyle
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Infer rewrite style from instruction
   */
  inferRewriteStyle(instruction) {
    const lowerInstruction = instruction.toLowerCase();
    if (lowerInstruction.includes("formal")) return "formal tone";
    if (lowerInstruction.includes("casual") || lowerInstruction.includes("informal")) return "casual tone";
    if (lowerInstruction.includes("concise") || lowerInstruction.includes("shorter")) return "more concise";
    if (lowerInstruction.includes("expand") || lowerInstruction.includes("detail")) return "more detailed";
    if (lowerInstruction.includes("simple") || lowerInstruction.includes("simplify")) return "simplified language";
    if (lowerInstruction.includes("engaging") || lowerInstruction.includes("interesting")) return "more engaging";
    if (lowerInstruction.includes("professional")) return "professional tone";
    if (lowerInstruction.includes("bullet") || lowerInstruction.includes("list")) return "bullet point format";
    if (lowerInstruction.includes("narrative") || lowerInstruction.includes("story")) return "narrative style";
    if (lowerInstruction.includes("technical")) return "technical style";
    if (lowerInstruction.includes("creative")) return "creative style";
    return "";
  }
  /**
   * Get rewrite targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of rewriting
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        rewriteComplexity: "low"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const rewriteComplexity = this.estimateComplexity(contentToAnalyze, command.instruction);
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      rewriteComplexity
    };
  }
  /**
   * Estimate rewrite complexity
   */
  estimateComplexity(content, instruction) {
    const contentLength = content.length;
    const lowerInstruction = instruction.toLowerCase();
    let complexity = "low";
    if (contentLength > 1e3) complexity = "high";
    else if (contentLength > 300) complexity = "medium";
    const complexInstructions = [
      "restructure",
      "reorganize",
      "completely rewrite",
      "transform",
      "change style",
      "different audience",
      "technical",
      "academic"
    ];
    if (complexInstructions.some((term) => lowerInstruction.includes(term))) {
      if (complexity === "low") complexity = "medium";
      else if (complexity === "medium") complexity = "high";
    }
    return complexity;
  }
};

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.currentLicense = null;
    this.currentTier = "core" /* CORE */;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags for Core vs SuperNova tiers
   */
  initializeFeatureFlags() {
    this.registerFeature({
      key: "basic_editing",
      requiredTier: "core" /* CORE */,
      enabled: true,
      description: "Basic document editing commands (add, edit, delete, grammar, rewrite)"
    });
    this.registerFeature({
      key: "local_ai_providers",
      requiredTier: "core" /* CORE */,
      enabled: true,
      description: "Local AI providers (Ollama, LM Studio)"
    });
    this.registerFeature({
      key: "file_conversations",
      requiredTier: "core" /* CORE */,
      enabled: true,
      description: "File-scoped conversation history"
    });
    this.registerFeature({
      key: "single_cloud_provider",
      requiredTier: "core" /* CORE */,
      enabled: true,
      description: "One cloud AI provider (user choice: Claude, OpenAI, or Google)"
    });
    this.registerFeature({
      key: "unlimited_cloud_ai",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Unlimited access to all cloud AI providers",
      fallbackBehavior: "prompt_upgrade"
    });
    this.registerFeature({
      key: "provider_switching",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Switch AI providers directly in chat interface",
      fallbackBehavior: "prompt_upgrade"
    });
    this.registerFeature({
      key: "mobile_access",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Mobile device support (iOS/Android)",
      fallbackBehavior: "prompt_upgrade"
    });
    this.registerFeature({
      key: "advanced_templates",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Advanced template integration and custom prompts",
      fallbackBehavior: "prompt_upgrade"
    });
    this.registerFeature({
      key: "batch_operations",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Batch document processing",
      fallbackBehavior: "limited_usage"
    });
    this.registerFeature({
      key: "cross_document_context",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Reference other vault notes during editing",
      fallbackBehavior: "disable"
    });
    this.registerFeature({
      key: "priority_support",
      requiredTier: "supernova" /* SUPERNOVA */,
      enabled: false,
      description: "Priority email support and feature requests",
      fallbackBehavior: "disable"
    });
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
    this.updateFeatureAvailability();
  }
  /**
   * Update license and recalculate feature availability
   */
  async updateLicense(licenseKey) {
    if (!licenseKey) {
      this.currentLicense = null;
      this.currentTier = "core" /* CORE */;
    } else {
      const validation = await this.licenseValidator.validateLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.currentLicense = validation.license;
        this.currentTier = validation.license.tier === "supernova" ? "supernova" /* SUPERNOVA */ : "core" /* CORE */;
      } else {
        this.currentLicense = null;
        this.currentTier = "core" /* CORE */;
      }
    }
    this.updateFeatureAvailability();
  }
  /**
   * Get current user's license tier
   */
  getCurrentTier() {
    if (this.debugSettings.enabled && this.debugSettings.overrideTier) {
      return this.debugSettings.overrideTier === "supernova" ? "supernova" /* SUPERNOVA */ : "core" /* CORE */;
    }
    return this.currentTier;
  }
  /**
   * Get current license information
   */
  getCurrentLicense() {
    return this.currentLicense;
  }
  /**
   * Check if a feature is enabled for current tier
   */
  isFeatureEnabled(featureKey) {
    var _a;
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    const currentTier = this.getCurrentTier();
    const requiredTier = feature.requiredTier;
    return {
      allowed: false,
      reason: `Feature requires ${requiredTier} tier (current: ${currentTier})`,
      fallbackBehavior: feature.fallbackBehavior,
      upgradePrompt: this.getUpgradePrompt(feature)
    };
  }
  /**
   * Get all features for a specific tier
   */
  getFeaturesForTier(tier) {
    return Array.from(this.features.values()).filter(
      (feature) => tier === "supernova" /* SUPERNOVA */ ? true : feature.requiredTier === "core" /* CORE */
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.updateFeatureAvailability();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Update feature availability based on current tier
   */
  updateFeatureAvailability() {
    const currentTier = this.getCurrentTier();
    for (const [key, feature] of this.features) {
      const shouldEnable = currentTier === "supernova" /* SUPERNOVA */ || feature.requiredTier === "core" /* CORE */;
      this.features.set(key, { ...feature, enabled: shouldEnable });
    }
  }
  /**
   * Generate upgrade prompt for blocked feature
   */
  getUpgradePrompt(feature) {
    return `${feature.description} is available with Nova SuperNova. Upgrade to unlock this feature and support Nova development.`;
  }
  /**
   * Get feature usage summary for current tier
   */
  getFeatureSummary() {
    const currentTier = this.getCurrentTier();
    const enabled = [];
    const disabled = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else {
        disabled.push(key);
      }
    }
    return { tier: currentTier, enabled, disabled };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      if (tier !== "core" && tier !== "supernova") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        tier,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      license.tier,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// main.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    try {
      console.log("Nova: onload starting...");
      await this.loadSettings();
      console.log("Nova: settings loaded");
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateLicense(this.settings.licensing.licenseKey);
      }
      console.log("Nova: feature manager initialized");
      if (import_obsidian5.Platform.isMobile && this.featureManager.getCurrentTier() === "core") {
        if (!this.featureManager.isFeatureEnabled("mobile_access")) {
          this.showMobileUpgradePrompt();
          return;
        }
      }
      (0, import_obsidian5.addIcon)("nova-star", NOVA_ICON_SVG);
      console.log("Nova: icon registered");
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      console.log("Nova: AI provider manager initialized");
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder();
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      console.log("Nova: document engine and commands initialized");
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      console.log("Nova: view registered");
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      console.log("Nova: ribbon icon added");
      console.log("Nova: ribbon icon element:", ribbonIcon);
      console.log("Nova: ribbon icon innerHTML:", ribbonIcon.innerHTML);
      console.log("Nova: ribbon icon classList:", ribbonIcon.classList.toString());
      this.addCommand({
        id: "nova-add-content",
        name: "Nova: Add content",
        editorCallback: async (editor, ctx) => {
          await this.handleAddCommand();
        }
      });
      this.addCommand({
        id: "nova-edit-content",
        name: "Nova: Edit content",
        editorCallback: async (editor, ctx) => {
          await this.handleEditCommand();
        }
      });
      this.addCommand({
        id: "nova-delete-content",
        name: "Nova: Delete content",
        editorCallback: async (editor, ctx) => {
          await this.handleDeleteCommand();
        }
      });
      this.addCommand({
        id: "nova-fix-grammar",
        name: "Nova: Fix grammar",
        editorCallback: async (editor, ctx) => {
          await this.handleGrammarCommand();
        }
      });
      this.addCommand({
        id: "nova-rewrite-content",
        name: "Nova: Rewrite content",
        editorCallback: async (editor, ctx) => {
          await this.handleRewriteCommand();
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      console.log("Nova: commands registered");
      this.addSettingTab(new NovaSettingTab(this.app, this));
      console.log("Nova: settings tab added");
      console.log("Nova: onload completed successfully");
    } catch (error) {
      console.error("Nova: Error in onload:", error);
    }
  }
  onunload() {
    var _a;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
  }
  /**
   * Handle add content command with user input
   */
  async handleAddCommand() {
    const instruction = await this.promptForInstruction("What would you like to add?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.addCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian5.Notice("Content added successfully");
      } else {
        new import_obsidian5.Notice(`Failed to add content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian5.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle edit content command with user input
   */
  async handleEditCommand() {
    const instruction = await this.promptForInstruction("How would you like to edit the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.editCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian5.Notice("Content edited successfully");
      } else {
        new import_obsidian5.Notice(`Failed to edit content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian5.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle delete content command with user input
   */
  async handleDeleteCommand() {
    const instruction = await this.promptForInstruction("What would you like to delete?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.deleteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian5.Notice("Content deleted successfully");
      } else {
        new import_obsidian5.Notice(`Failed to delete content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian5.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle grammar correction command
   */
  async handleGrammarCommand() {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      new import_obsidian5.Notice("No active document found");
      return;
    }
    let target = "document";
    let instruction = "Fix grammar and spelling errors";
    if (documentContext.selectedText) {
      target = "selection";
      instruction = "Fix grammar and spelling errors in the selected text";
    }
    try {
      const command = {
        action: "grammar",
        target,
        instruction
      };
      const result = await this.grammarCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian5.Notice("Grammar corrected successfully");
      } else {
        new import_obsidian5.Notice(`Failed to correct grammar: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian5.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle rewrite content command with user input
   */
  async handleRewriteCommand() {
    const instruction = await this.promptForInstruction("How would you like to rewrite the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.rewriteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian5.Notice("Content rewritten successfully");
      } else {
        new import_obsidian5.Notice(`Failed to rewrite content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian5.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Prompt user for instruction input
   */
  async promptForInstruction(placeholder) {
    return new Promise((resolve) => {
      const modal = document.createElement("div");
      modal.className = "modal nova-input-modal";
      modal.innerHTML = `
				<div class="modal-container">
					<div class="modal-bg" onclick="this.parentElement.parentElement.remove(); resolve(null);"></div>
					<div class="modal-content">
						<div class="modal-header">
							<h3>Nova AI Command</h3>
							<button class="modal-close-button" onclick="this.closest('.modal').remove(); resolve(null);">\xD7</button>
						</div>
						<div class="modal-body">
							<input type="text" class="nova-instruction-input" placeholder="${placeholder}" autofocus>
						</div>
						<div class="modal-footer">
							<button class="mod-cta nova-submit-btn">Execute</button>
							<button class="nova-cancel-btn">Cancel</button>
						</div>
					</div>
				</div>
			`;
      const input = modal.querySelector(".nova-instruction-input");
      const submitBtn = modal.querySelector(".nova-submit-btn");
      const cancelBtn = modal.querySelector(".nova-cancel-btn");
      const handleSubmit = () => {
        const value = input.value.trim();
        modal.remove();
        resolve(value || null);
      };
      const handleCancel = () => {
        modal.remove();
        resolve(null);
      };
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          handleSubmit();
        } else if (e.key === "Escape") {
          e.preventDefault();
          handleCancel();
        }
      });
      submitBtn.addEventListener("click", handleSubmit);
      cancelBtn.addEventListener("click", handleCancel);
      document.body.appendChild(modal);
      input.focus();
    });
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>\u{1F680} Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">\u{1F193}</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>\u2705 Mobile device support</li>
								<li>\u2705 Multiple AI providers</li>
								<li>\u2705 In-chat provider switching</li>
								<li>\u2705 Advanced templates</li>
								<li>\u2705 Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">\u2B50 Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian5.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXIudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9jbGF1ZGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vcGVuYWkudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9nb29nbGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vbGxhbWEudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9kb2N1bWVudC1lbmdpbmUudHMiLCAic3JjL2NvcmUvY29udmVyc2F0aW9uLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvY29udGV4dC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmQtcGFyc2VyLnRzIiwgInNyYy9jb3JlL3Byb21wdC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2VkaXQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9kZWxldGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyLnRzIiwgInNyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3IudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgV29ya3NwYWNlTGVhZiwgSXRlbVZpZXcsIGFkZEljb24sIE5vdGljZSwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzLCBOb3ZhU2V0dGluZ1RhYiwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBOb3ZhU2lkZWJhclZpZXcsIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgfSBmcm9tICcuL3NyYy91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL3NyYy9jb3JlL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IFByb21wdEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL3Byb21wdC1idWlsZGVyJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IEFkZENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgRGVsZXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgR3JhbW1hckNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZCc7XG5pbXBvcnQgeyBSZXdyaXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kJztcbmltcG9ydCB7IEZlYXR1cmVNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlcic7XG5pbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9zcmMvbGljZW5zaW5nL2xpY2Vuc2UtdmFsaWRhdG9yJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3ZhUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBOb3ZhU2V0dGluZ3M7XG5cdGFpUHJvdmlkZXJNYW5hZ2VyITogQUlQcm92aWRlck1hbmFnZXI7XG5cdGRvY3VtZW50RW5naW5lITogRG9jdW1lbnRFbmdpbmU7XG5cdGNvbnRleHRCdWlsZGVyITogQ29udGV4dEJ1aWxkZXI7XG5cdGNvbW1hbmRQYXJzZXIhOiBDb21tYW5kUGFyc2VyO1xuXHRwcm9tcHRCdWlsZGVyITogUHJvbXB0QnVpbGRlcjtcblx0Y29udmVyc2F0aW9uTWFuYWdlciE6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG5cdGFkZENvbW1hbmRIYW5kbGVyITogQWRkQ29tbWFuZDtcblx0ZWRpdENvbW1hbmRIYW5kbGVyITogRWRpdENvbW1hbmQ7XG5cdGRlbGV0ZUNvbW1hbmRIYW5kbGVyITogRGVsZXRlQ29tbWFuZDtcblx0Z3JhbW1hckNvbW1hbmRIYW5kbGVyITogR3JhbW1hckNvbW1hbmQ7XG5cdHJld3JpdGVDb21tYW5kSGFuZGxlciE6IFJld3JpdGVDb21tYW5kO1xuXHRmZWF0dXJlTWFuYWdlciE6IEZlYXR1cmVNYW5hZ2VyO1xuXHRsaWNlbnNlVmFsaWRhdG9yITogTGljZW5zZVZhbGlkYXRvcjtcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBvbmxvYWQgc3RhcnRpbmcuLi4nKTtcblx0XHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgbG9hZGVkJyk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgbGljZW5zaW5nIHN5c3RlbVxuXHRcdFx0dGhpcy5saWNlbnNlVmFsaWRhdG9yID0gbmV3IExpY2Vuc2VWYWxpZGF0b3IoKTtcblx0XHRcdHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBuZXcgRmVhdHVyZU1hbmFnZXIoXG5cdFx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvcixcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5nc1xuXHRcdFx0KTtcblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIGxpY2Vuc2UgZnJvbSBzZXR0aW5nc1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5mZWF0dXJlTWFuYWdlci51cGRhdGVMaWNlbnNlKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpO1xuXHRcdFx0fVxuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGZlYXR1cmUgbWFuYWdlciBpbml0aWFsaXplZCcpO1xuXG5cdFx0XHQvLyBDaGVjayBtb2JpbGUgYWNjZXNzIGZvciBDb3JlIHRpZXIgdXNlcnNcblx0XHRcdGlmIChQbGF0Zm9ybS5pc01vYmlsZSAmJiB0aGlzLmZlYXR1cmVNYW5hZ2VyLmdldEN1cnJlbnRUaWVyKCkgPT09ICdjb3JlJykge1xuXHRcdFx0XHRpZiAoIXRoaXMuZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbW9iaWxlX2FjY2VzcycpKSB7XG5cdFx0XHRcdFx0dGhpcy5zaG93TW9iaWxlVXBncmFkZVByb21wdCgpO1xuXHRcdFx0XHRcdHJldHVybjsgLy8gU3RvcCBwbHVnaW4gaW5pdGlhbGl6YXRpb24gZm9yIENvcmUgbW9iaWxlIHVzZXJzXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVnaXN0ZXIgY3VzdG9tIGljb25cblx0XHRcdGFkZEljb24oJ25vdmEtc3RhcicsIE5PVkFfSUNPTl9TVkcpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGljb24gcmVnaXN0ZXJlZCcpO1xuXG5cdFx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyID0gbmV3IEFJUHJvdmlkZXJNYW5hZ2VyKHRoaXMuc2V0dGluZ3MsIHRoaXMuZmVhdHVyZU1hbmFnZXIpO1xuXHRcdFx0YXdhaXQgdGhpcy5haVByb3ZpZGVyTWFuYWdlci5pbml0aWFsaXplKCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogQUkgcHJvdmlkZXIgbWFuYWdlciBpbml0aWFsaXplZCcpO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGFuZCBkb2N1bWVudCBlbmdpbmVcblx0XHRcdGNvbnN0IGRhdGFTdG9yZSA9IHtcblx0XHRcdFx0bG9hZERhdGE6IChrZXk6IHN0cmluZykgPT4gdGhpcy5sb2FkRGF0YVdpdGhLZXkoa2V5KSxcblx0XHRcdFx0c2F2ZURhdGE6IChrZXk6IHN0cmluZywgZGF0YTogYW55KSA9PiB0aGlzLnNhdmVEYXRhV2l0aEtleShrZXksIGRhdGEpXG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBuZXcgRG9jdW1lbnRFbmdpbmUodGhpcy5hcHAsIGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lLnNldENvbnZlcnNhdGlvbk1hbmFnZXIodGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdHRoaXMuY29udGV4dEJ1aWxkZXIgPSBuZXcgQ29udGV4dEJ1aWxkZXIoKTtcblx0XHRcdHRoaXMuY29tbWFuZFBhcnNlciA9IG5ldyBDb21tYW5kUGFyc2VyKCk7XG5cdFx0XHR0aGlzLnByb21wdEJ1aWxkZXIgPSBuZXcgUHJvbXB0QnVpbGRlcih0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpO1xuXHRcdFx0XG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbW1hbmQgaW1wbGVtZW50YXRpb25zXG5cdFx0XHR0aGlzLmFkZENvbW1hbmRIYW5kbGVyID0gbmV3IEFkZENvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5lZGl0Q29tbWFuZEhhbmRsZXIgPSBuZXcgRWRpdENvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5kZWxldGVDb21tYW5kSGFuZGxlciA9IG5ldyBEZWxldGVDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZ3JhbW1hckNvbW1hbmRIYW5kbGVyID0gbmV3IEdyYW1tYXJDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMucmV3cml0ZUNvbW1hbmRIYW5kbGVyID0gbmV3IFJld3JpdGVDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBkb2N1bWVudCBlbmdpbmUgYW5kIGNvbW1hbmRzIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0XHRWSUVXX1RZUEVfTk9WQV9TSURFQkFSLFxuXHRcdFx0XHQobGVhZikgPT4gbmV3IE5vdmFTaWRlYmFyVmlldyhsZWFmLCB0aGlzKVxuXHRcdFx0KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiB2aWV3IHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0Y29uc3QgcmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbignbm92YS1zdGFyJywgJ05vdmEgQUknLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBhZGRlZCcpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGVsZW1lbnQ6JywgcmliYm9uSWNvbik7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gaW5uZXJIVE1MOicsIHJpYmJvbkljb24uaW5uZXJIVE1MKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBjbGFzc0xpc3Q6JywgcmliYm9uSWNvbi5jbGFzc0xpc3QudG9TdHJpbmcoKSk7XG5cblx0XHRcdC8vIFJlZ2lzdGVyIGNvcmUgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWFkZC1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IEFkZCBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVBZGRDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtZWRpdC1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IEVkaXQgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlRWRpdENvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1kZWxldGUtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBEZWxldGUgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlRGVsZXRlQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWZpeC1ncmFtbWFyJyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IEZpeCBncmFtbWFyJyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVHcmFtbWFyQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLXJld3JpdGUtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBSZXdyaXRlIGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVJld3JpdGVDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ29wZW4tbm92YS1zaWRlYmFyJyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IE9wZW4gc2lkZWJhcicsXG5cdFx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogY29tbWFuZHMgcmVnaXN0ZXJlZCcpO1xuXG5cdFx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IE5vdmFTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgdGFiIGFkZGVkJyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogb25sb2FkIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignTm92YTogRXJyb3IgaW4gb25sb2FkOicsIGVycm9yKTtcblx0XHR9XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcblx0fVxuXG5cdGFzeW5jIGFjdGl2YXRlVmlldygpIHtcblx0XHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gdGhpcy5hcHA7XG5cblx0XHRsZXQgbGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGw7XG5cdFx0Y29uc3QgbGVhdmVzID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblxuXHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0bGVhZiA9IGxlYXZlc1swXTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuXHRcdFx0YXdhaXQgbGVhZj8uc2V0Vmlld1N0YXRlKHsgdHlwZTogVklFV19UWVBFX05PVkFfU0lERUJBUiwgYWN0aXZlOiB0cnVlIH0pO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYhKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgYWRkIGNvbnRlbnQgY29tbWFuZCB3aXRoIHVzZXIgaW5wdXRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlQWRkQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ1doYXQgd291bGQgeW91IGxpa2UgdG8gYWRkPycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdDb250ZW50IGFkZGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGFkZCBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBlZGl0IGNvbnRlbnQgY29tbWFuZCB3aXRoIHVzZXIgaW5wdXRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlRWRpdENvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW5zdHJ1Y3Rpb24gPSBhd2FpdCB0aGlzLnByb21wdEZvckluc3RydWN0aW9uKCdIb3cgd291bGQgeW91IGxpa2UgdG8gZWRpdCB0aGUgY29udGVudD8nKTtcblx0XHRpZiAoIWluc3RydWN0aW9uKSByZXR1cm47XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKGRvY3VtZW50Q29udGV4dD8uc2VsZWN0ZWRUZXh0KTtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGluc3RydWN0aW9uLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgZWRpdGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGVkaXQgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZGVsZXRlIGNvbnRlbnQgY29tbWFuZCB3aXRoIHVzZXIgaW5wdXRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlRGVsZXRlQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ1doYXQgd291bGQgeW91IGxpa2UgdG8gZGVsZXRlPycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmRlbGV0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdDb250ZW50IGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gZGVsZXRlIGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGdyYW1tYXIgY29ycmVjdGlvbiBjb21tYW5kXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUdyYW1tYXJDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0aWYgKCFkb2N1bWVudENvbnRleHQpIHtcblx0XHRcdG5ldyBOb3RpY2UoJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSB0YXJnZXQgYmFzZWQgb24gc2VsZWN0aW9uXG5cdFx0bGV0IHRhcmdldDogJ3NlbGVjdGlvbicgfCAnZG9jdW1lbnQnID0gJ2RvY3VtZW50Jztcblx0XHRsZXQgaW5zdHJ1Y3Rpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nIGVycm9ycyc7XG5cdFx0XG5cdFx0aWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcblx0XHRcdHRhcmdldCA9ICdzZWxlY3Rpb24nO1xuXHRcdFx0aW5zdHJ1Y3Rpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nIGVycm9ycyBpbiB0aGUgc2VsZWN0ZWQgdGV4dCc7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB7XG5cdFx0XHRcdGFjdGlvbjogJ2dyYW1tYXInIGFzIGNvbnN0LFxuXHRcdFx0XHR0YXJnZXQsXG5cdFx0XHRcdGluc3RydWN0aW9uXG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnR3JhbW1hciBjb3JyZWN0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY29ycmVjdCBncmFtbWFyOiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSByZXdyaXRlIGNvbnRlbnQgY29tbWFuZCB3aXRoIHVzZXIgaW5wdXRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlUmV3cml0ZUNvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW5zdHJ1Y3Rpb24gPSBhd2FpdCB0aGlzLnByb21wdEZvckluc3RydWN0aW9uKCdIb3cgd291bGQgeW91IGxpa2UgdG8gcmV3cml0ZSB0aGUgY29udGVudD8nKTtcblx0XHRpZiAoIWluc3RydWN0aW9uKSByZXR1cm47XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKGRvY3VtZW50Q29udGV4dD8uc2VsZWN0ZWRUZXh0KTtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGluc3RydWN0aW9uLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgcmV3cml0dGVuIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIHJld3JpdGUgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQcm9tcHQgdXNlciBmb3IgaW5zdHJ1Y3Rpb24gaW5wdXRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgcHJvbXB0Rm9ySW5zdHJ1Y3Rpb24ocGxhY2Vob2xkZXI6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuXHRcdFx0Y29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdG1vZGFsLmNsYXNzTmFtZSA9ICdtb2RhbCBub3ZhLWlucHV0LW1vZGFsJztcblx0XHRcdG1vZGFsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1iZ1wiIG9uY2xpY2s9XCJ0aGlzLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5yZW1vdmUoKTsgcmVzb2x2ZShudWxsKTtcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuXHRcdFx0XHRcdFx0XHQ8aDM+Tm92YSBBSSBDb21tYW5kPC9oMz5cblx0XHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZGFsLWNsb3NlLWJ1dHRvblwiIG9uY2xpY2s9XCJ0aGlzLmNsb3Nlc3QoJy5tb2RhbCcpLnJlbW92ZSgpOyByZXNvbHZlKG51bGwpO1wiPlx1MDBENzwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYm9keVwiPlxuXHRcdFx0XHRcdFx0XHQ8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cIm5vdmEtaW5zdHJ1Y3Rpb24taW5wdXRcIiBwbGFjZWhvbGRlcj1cIiR7cGxhY2Vob2xkZXJ9XCIgYXV0b2ZvY3VzPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+XG5cdFx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJtb2QtY3RhIG5vdmEtc3VibWl0LWJ0blwiPkV4ZWN1dGU8L2J1dHRvbj5cblx0XHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm5vdmEtY2FuY2VsLWJ0blwiPkNhbmNlbDwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgaW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS1pbnN0cnVjdGlvbi1pbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cdFx0XHRjb25zdCBzdWJtaXRCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS1zdWJtaXQtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0XHRjb25zdCBjYW5jZWxCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jYW5jZWwtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cblx0XHRcdGNvbnN0IGhhbmRsZVN1Ym1pdCA9ICgpID0+IHtcblx0XHRcdFx0Y29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZS50cmltKCk7XG5cdFx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdFx0XHRyZXNvbHZlKHZhbHVlIHx8IG51bGwpO1xuXHRcdFx0fTtcblxuXHRcdFx0Y29uc3QgaGFuZGxlQ2FuY2VsID0gKCkgPT4ge1xuXHRcdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHRcdFx0cmVzb2x2ZShudWxsKTtcblx0XHRcdH07XG5cblx0XHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuXHRcdFx0XHRpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0aGFuZGxlU3VibWl0KCk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGhhbmRsZUNhbmNlbCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0c3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlU3VibWl0KTtcblx0XHRcdGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUNhbmNlbCk7XG5cblx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpO1xuXHRcdFx0aW5wdXQuZm9jdXMoKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTaG93IHVwZ3JhZGUgcHJvbXB0IGZvciBDb3JlIHRpZXIgbW9iaWxlIHVzZXJzXG5cdCAqL1xuXHRwcml2YXRlIHNob3dNb2JpbGVVcGdyYWRlUHJvbXB0KCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0bW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsIG5vdmEtbW9iaWxlLXVwZ3JhZGUtbW9kYWwnO1xuXHRcdG1vZGFsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250YWluZXJcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJnXCI+PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuXHRcdFx0XHRcdFx0PGgzPlx1RDgzRFx1REU4MCBOb3ZhIFN1cGVyTm92YSBSZXF1aXJlZDwvaDM+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpZXItYmFkZ2UgY29yZVwiIHN0eWxlPVwibWFyZ2luLWJvdHRvbTogMWVtO1wiPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItaWNvblwiPlx1RDgzQ1x1REQ5Mzwvc3Bhbj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLW5hbWVcIj5Db3JlIChGcmVlKTwvc3Bhbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PHA+TW9iaWxlIGFjY2VzcyBpcyBhdmFpbGFibGUgd2l0aCBOb3ZhIFN1cGVyTm92YS48L3A+XG5cdFx0XHRcdFx0XHQ8cD5Db3JlIHRpZXIgaXMgbGltaXRlZCB0byBkZXNrdG9wIHVzZSBvbmx5LjwvcD5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWZlYXR1cmUtbGlzdFwiPlxuXHRcdFx0XHRcdFx0XHQ8aDQ+U3VwZXJOb3ZhIGluY2x1ZGVzOjwvaDQ+XG5cdFx0XHRcdFx0XHRcdDx1bD5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+XHUyNzA1IE1vYmlsZSBkZXZpY2Ugc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPlx1MjcwNSBNdWx0aXBsZSBBSSBwcm92aWRlcnM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5cdTI3MDUgSW4tY2hhdCBwcm92aWRlciBzd2l0Y2hpbmc8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5cdTI3MDUgQWR2YW5jZWQgdGVtcGxhdGVzPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+XHUyNzA1IFByaW9yaXR5IHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS11cGdyYWRlLWJ0blwiPlx1MkI1MCBVcGdyYWRlIHRvIFN1cGVyTm92YTwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm5vdmEtY2xvc2UtYnRuXCI+Q2xvc2U8L2J1dHRvbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Y29uc3QgdXBncmFkZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXVwZ3JhZGUtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0Y29uc3QgY2xvc2VCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jbG9zZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBtb2RhbEJnID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsLWJnJykgYXMgSFRNTEVsZW1lbnQ7XG5cblx0XHRjb25zdCBjbG9zZU1vZGFsID0gKCkgPT4ge1xuXHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0fTtcblxuXHRcdHVwZ3JhZGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3aW5kb3cub3BlbignaHR0cHM6Ly9ub3Zhd3JpdGVyLmFpL3VwZ3JhZGUnLCAnX2JsYW5rJyk7XG5cdFx0XHRjbG9zZU1vZGFsKCk7XG5cdFx0fSk7XG5cblx0XHRjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXHRcdG1vZGFsQmcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcblxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpO1xuXG5cdFx0Ly8gU2hvdyBub3RpY2UgYXMgd2VsbFxuXHRcdG5ldyBOb3RpY2UoJ05vdmEgbW9iaWxlIGFjY2VzcyByZXF1aXJlcyBTdXBlck5vdmEgbGljZW5zZScsIDgwMDApO1xuXHR9XG5cblx0Ly8gRGF0YVN0b3JlIGludGVyZmFjZSBpbXBsZW1lbnRhdGlvbiBmb3IgQ29udmVyc2F0aW9uTWFuYWdlclxuXHRhc3luYyBsb2FkRGF0YVdpdGhLZXkoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuXHRcdGNvbnN0IGFsbERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG5cdFx0cmV0dXJuIGFsbERhdGEgPyBhbGxEYXRhW2tleV0gOiB1bmRlZmluZWQ7XG5cdH1cblxuXHRhc3luYyBzYXZlRGF0YVdpdGhLZXkoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFsbERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCkgfHwge307XG5cdFx0YWxsRGF0YVtrZXldID0gZGF0YTtcblx0XHRyZXR1cm4gYXdhaXQgdGhpcy5zYXZlRGF0YShhbGxEYXRhKTtcblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXJTZXR0aW5ncywgUGxhdGZvcm1TZXR0aW5ncywgUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi9haS90eXBlcyc7XG5pbXBvcnQgeyBEZWJ1Z1NldHRpbmdzLCBMaWNlbnNlVGllciB9IGZyb20gJy4vbGljZW5zaW5nL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBOb3ZhU2V0dGluZ3Mge1xuXHRhaVByb3ZpZGVyczogQUlQcm92aWRlclNldHRpbmdzO1xuXHRwbGF0Zm9ybVNldHRpbmdzOiBQbGF0Zm9ybVNldHRpbmdzO1xuXHRnZW5lcmFsOiB7XG5cdFx0ZGVmYXVsdFRlbXBlcmF0dXJlOiBudW1iZXI7XG5cdFx0ZGVmYXVsdE1heFRva2VuczogbnVtYmVyO1xuXHRcdGF1dG9TYXZlOiBib29sZWFuO1xuXHR9O1xuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiBzdHJpbmc7XG5cdFx0ZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncztcblx0fTtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE5vdmFTZXR0aW5ncyA9IHtcblx0YWlQcm92aWRlcnM6IHtcblx0XHRjbGF1ZGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2NsYXVkZS1zb25uZXQtNCcsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvcGVuYWk6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRiYXNlVXJsOiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScsXG5cdFx0XHRtb2RlbDogJ2dwdC00bycsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRnb29nbGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNS0yMCcsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvbGxhbWE6IHtcblx0XHRcdGJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jyxcblx0XHRcdG1vZGVsOiAnJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9XG5cdH0sXG5cdHBsYXRmb3JtU2V0dGluZ3M6IHtcblx0XHRkZXNrdG9wOiB7XG5cdFx0XHRwcmltYXJ5UHJvdmlkZXI6ICdvbGxhbWEnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdH0sXG5cdFx0bW9iaWxlOiB7XG5cdFx0XHRwcmltYXJ5UHJvdmlkZXI6ICdub25lJyxcblx0XHRcdGZhbGxiYWNrUHJvdmlkZXJzOiBbJ29wZW5haScsICdnb29nbGUnXVxuXHRcdH1cblx0fSxcblx0Z2VuZXJhbDoge1xuXHRcdGRlZmF1bHRUZW1wZXJhdHVyZTogMC43LFxuXHRcdGRlZmF1bHRNYXhUb2tlbnM6IDEwMDAsXG5cdFx0YXV0b1NhdmU6IHRydWVcblx0fSxcblx0bGljZW5zaW5nOiB7XG5cdFx0bGljZW5zZUtleTogJycsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2Vcblx0XHR9XG5cdH1cbn07XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IE5vdmFQbHVnaW47XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ05vdmEgQUkgU2V0dGluZ3MnIH0pO1xuXG5cdFx0dGhpcy5jcmVhdGVMaWNlbnNlU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZUdlbmVyYWxTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlUGxhdGZvcm1TZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlUHJvdmlkZXJTZXR0aW5ncygpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVMaWNlbnNlU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb25zdCBsaWNlbnNlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXNlY3Rpb24nIH0pO1xuXHRcdGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnTGljZW5zZSAmIFRpZXInIH0pO1xuXG5cdFx0Ly8gQ3VycmVudCB0aWVyIGRpc3BsYXlcblx0XHRjb25zdCBjdXJyZW50VGllciA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDdXJyZW50VGllcigpIHx8ICdjb3JlJztcblx0XHRjb25zdCBjdXJyZW50TGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDdXJyZW50TGljZW5zZSgpO1xuXHRcdFxuXHRcdGNvbnN0IHRpZXJEaXNwbGF5ID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXRpZXItZGlzcGxheScgfSk7XG5cdFx0Y29uc3QgdGllclRleHQgPSBjdXJyZW50VGllciA9PT0gJ3N1cGVybm92YScgPyAnU3VwZXJOb3ZhJyA6ICdDb3JlIChGcmVlKSc7XG5cdFx0Y29uc3QgdGllckljb24gPSBjdXJyZW50VGllciA9PT0gJ3N1cGVybm92YScgPyAnXHUyQjUwJyA6ICdcdUQ4M0NcdUREOTMnO1xuXHRcdHRpZXJEaXNwbGF5LmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpZXItYmFkZ2UgJHtjdXJyZW50VGllcn1cIj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLWljb25cIj4ke3RpZXJJY29ufTwvc3Bhbj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLW5hbWVcIj4ke3RpZXJUZXh0fTwvc3Bhbj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBMaWNlbnNlIHN0YXR1c1xuXHRcdGlmIChjdXJyZW50TGljZW5zZSkge1xuXHRcdFx0Y29uc3Qgc3RhdHVzRWwgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zdGF0dXMnIH0pO1xuXHRcdFx0Y29uc3QgZXhwaXJ5VGV4dCA9IGN1cnJlbnRMaWNlbnNlLmV4cGlyZXNBdCBcblx0XHRcdFx0PyBgRXhwaXJlczogJHtjdXJyZW50TGljZW5zZS5leHBpcmVzQXQudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdFx0XHQ6ICdMaWZldGltZSBMaWNlbnNlJztcblx0XHRcdHN0YXR1c0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cImxpY2Vuc2UtaW5mb1wiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1lbWFpbFwiPiR7Y3VycmVudExpY2Vuc2UuZW1haWx9PC9zcGFuPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1leHBpcnlcIj4ke2V4cGlyeVRleHR9PC9zcGFuPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fVxuXG5cdFx0Ly8gTGljZW5zZSBrZXkgaW5wdXRcblx0XHRuZXcgU2V0dGluZyhsaWNlbnNlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0xpY2Vuc2UgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdFbnRlciB5b3VyIE5vdmEgU3VwZXJOb3ZhIGxpY2Vuc2Uga2V5IHRvIHVubG9jayBwcmVtaXVtIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4ge1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG5cdFx0XHRcdHRleHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGxpY2Vuc2Uga2V5Li4uJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgbGljZW5zZSBpbiBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVMaWNlbnNlKHZhbHVlIHx8IG51bGwpO1xuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBkaXNwbGF5IHRvIHNob3cgdXBkYXRlZCB0aWVyXG5cdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIEFkZCB2YWxpZGF0aW9uIGJ1dHRvblxuXHRcdFx0XHRjb25zdCB2YWxpZGF0ZUJ1dHRvbiA9IHRleHQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5jcmVhdGVFbCgnYnV0dG9uJywge1xuXHRcdFx0XHRcdHRleHQ6ICdWYWxpZGF0ZScsXG5cdFx0XHRcdFx0Y2xzOiAnbm92YS12YWxpZGF0ZS1idG4nXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHZhbGlkYXRlQnV0dG9uKSB7XG5cdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBsaWNlbnNlS2V5ID0gdGV4dC5pbnB1dEVsLnZhbHVlO1xuXHRcdFx0XHRcdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdQbGVhc2UgZW50ZXIgYSBsaWNlbnNlIGtleSBmaXJzdC4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdWYWxpZGF0aW5nLi4uJztcblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCB0aWVyID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuZ2V0Q3VycmVudFRpZXIoKTtcblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHRpZiAodGllciA9PT0gJ3N1cGVybm92YScpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdcdTI3MDUgVmFsaWQgU3VwZXJOb3ZhIGxpY2Vuc2UhJywgJ3N1Y2Nlc3MnKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1x1Mjc0QyBJbnZhbGlkIG9yIGV4cGlyZWQgbGljZW5zZSBrZXkuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnXHUyNzRDIEVycm9yIHZhbGlkYXRpbmcgbGljZW5zZS4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdH0gZmluYWxseSB7XG5cdFx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLnRleHRDb250ZW50ID0gJ1ZhbGlkYXRlJztcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHQvLyBGZWF0dXJlcyBjb21wYXJpc29uXG5cdFx0dGhpcy5jcmVhdGVGZWF0dXJlQ29tcGFyaXNvbihsaWNlbnNlQ29udGFpbmVyKTtcblxuXHRcdC8vIERlYnVnIHNldHRpbmdzIChkZXZlbG9wbWVudCBvbmx5KVxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyB8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHR0aGlzLmNyZWF0ZURlYnVnU2V0dGluZ3MobGljZW5zZUNvbnRhaW5lcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVGZWF0dXJlQ29tcGFyaXNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgY29tcGFyaXNvbkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWZlYXR1cmUtY29tcGFyaXNvbicgfSk7XG5cdFx0Y29tcGFyaXNvbkNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdGZWF0dXJlIENvbXBhcmlzb24nIH0pO1xuXG5cdFx0Y29uc3QgdGFibGUgPSBjb21wYXJpc29uQ29udGFpbmVyLmNyZWF0ZUVsKCd0YWJsZScsIHsgY2xzOiAnbm92YS1jb21wYXJpc29uLXRhYmxlJyB9KTtcblx0XHRcblx0XHQvLyBIZWFkZXJcblx0XHRjb25zdCBoZWFkZXJSb3cgPSB0YWJsZS5jcmVhdGVFbCgndHInKTtcblx0XHRoZWFkZXJSb3cuY3JlYXRlRWwoJ3RoJywgeyB0ZXh0OiAnRmVhdHVyZScgfSk7XG5cdFx0aGVhZGVyUm93LmNyZWF0ZUVsKCd0aCcsIHsgdGV4dDogJ0NvcmUgKEZyZWUpJyB9KTtcblx0XHRoZWFkZXJSb3cuY3JlYXRlRWwoJ3RoJywgeyB0ZXh0OiAnU3VwZXJOb3ZhJyB9KTtcblxuXHRcdC8vIEZlYXR1cmUgcm93c1xuXHRcdGNvbnN0IGZlYXR1cmVzID0gW1xuXHRcdFx0WydCYXNpYyBEb2N1bWVudCBFZGl0aW5nJywgJ1x1MjcwNScsICdcdTI3MDUnXSxcblx0XHRcdFsnTG9jYWwgQUkgKE9sbGFtYSwgTE0gU3R1ZGlvKScsICdcdTI3MDUnLCAnXHUyNzA1J10sXG5cdFx0XHRbJ09uZSBDbG91ZCBBSSBQcm92aWRlcicsICdcdTI3MDUnLCAnXHUyNzA1J10sXG5cdFx0XHRbJ011bHRpcGxlIENsb3VkIEFJIFByb3ZpZGVycycsICdcdTI3NEMnLCAnXHUyNzA1J10sXG5cdFx0XHRbJ1Byb3ZpZGVyIFN3aXRjaGluZyBpbiBDaGF0JywgJ1x1Mjc0QycsICdcdTI3MDUnXSxcblx0XHRcdFsnTW9iaWxlIERldmljZSBTdXBwb3J0JywgJ1x1Mjc0QycsICdcdTI3MDUnXSxcblx0XHRcdFsnQWR2YW5jZWQgVGVtcGxhdGVzJywgJ1x1Mjc0QycsICdcdTI3MDUnXSxcblx0XHRcdFsnUHJpb3JpdHkgU3VwcG9ydCcsICdcdTI3NEMnLCAnXHUyNzA1J11cblx0XHRdO1xuXG5cdFx0ZmVhdHVyZXMuZm9yRWFjaCgoW2ZlYXR1cmUsIGNvcmUsIHN1cGVybm92YV0pID0+IHtcblx0XHRcdGNvbnN0IHJvdyA9IHRhYmxlLmNyZWF0ZUVsKCd0cicpO1xuXHRcdFx0cm93LmNyZWF0ZUVsKCd0ZCcsIHsgdGV4dDogZmVhdHVyZSB9KTtcblx0XHRcdHJvdy5jcmVhdGVFbCgndGQnLCB7IHRleHQ6IGNvcmUsIGNsczogY29yZSA9PT0gJ1x1MjcwNScgPyAnZmVhdHVyZS15ZXMnIDogJ2ZlYXR1cmUtbm8nIH0pO1xuXHRcdFx0cm93LmNyZWF0ZUVsKCd0ZCcsIHsgdGV4dDogc3VwZXJub3ZhLCBjbHM6IHN1cGVybm92YSA9PT0gJ1x1MjcwNScgPyAnZmVhdHVyZS15ZXMnIDogJ2ZlYXR1cmUtbm8nIH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gVXBncmFkZSBsaW5rXG5cdFx0Y29uc3QgdXBncmFkZUNvbnRhaW5lciA9IGNvbXBhcmlzb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS11cGdyYWRlLWNvbnRhaW5lcicgfSk7XG5cdFx0Y29uc3QgdXBncmFkZUJ1dHRvbiA9IHVwZ3JhZGVDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcblx0XHRcdHRleHQ6ICdcdTJCNTAgVXBncmFkZSB0byBTdXBlck5vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS11cGdyYWRlLWJ0bidcblx0XHR9KTtcblx0XHRcblx0XHR1cGdyYWRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0d2luZG93Lm9wZW4oJ2h0dHBzOi8vbm92YXdyaXRlci5haS91cGdyYWRlJywgJ19ibGFuaycpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1NldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBkZWJ1Z0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0RldmVsb3BtZW50IFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0RlYnVnIE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXZlbG9wbWVudCB0ZXN0aW5nIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIGRlYnVnIG9wdGlvbnNcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnT3ZlcnJpZGUgVGllcicpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBsaWNlbnNlIHRpZXIgZm9yIHRlc3RpbmcnKVxuXHRcdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cblx0XHRcdFx0XHQuYWRkT3B0aW9uKCcnLCAnVXNlIFJlYWwgTGljZW5zZScpXG5cdFx0XHRcdFx0LmFkZE9wdGlvbignY29yZScsICdGb3JjZSBDb3JlIFRpZXInKVxuXHRcdFx0XHRcdC5hZGRPcHRpb24oJ3N1cGVybm92YScsICdGb3JjZSBTdXBlck5vdmEgVGllcicpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlVGllciB8fCAnJylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZVRpZXIgPSAodmFsdWUgYXMgTGljZW5zZVRpZXIpIHx8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheVxuXHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0fSkpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0xpY2Vuc2VNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgdHlwZTogJ3N1Y2Nlc3MnIHwgJ2Vycm9yJykge1xuXHRcdC8vIENyZWF0ZSBvciB1cGRhdGUgbWVzc2FnZSBlbGVtZW50XG5cdFx0Y29uc3QgZXhpc3RpbmdNZXNzYWdlID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1saWNlbnNlLW1lc3NhZ2UnKTtcblx0XHRpZiAoZXhpc3RpbmdNZXNzYWdlKSB7XG5cdFx0XHRleGlzdGluZ01lc3NhZ2UucmVtb3ZlKCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBcblx0XHRcdGNsczogYG5vdmEtbGljZW5zZS1tZXNzYWdlICR7dHlwZX1gLFxuXHRcdFx0dGV4dDogbWVzc2FnZVxuXHRcdH0pO1xuXG5cdFx0Ly8gQXV0by1yZW1vdmUgYWZ0ZXIgNSBzZWNvbmRzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRtZXNzYWdlRWwucmVtb3ZlKCk7XG5cdFx0fSwgNTAwMCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUdlbmVyYWxTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0dlbmVyYWwgU2V0dGluZ3MnIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBUZW1wZXJhdHVyZScpXG5cdFx0XHQuc2V0RGVzYygnQ29udHJvbHMgcmFuZG9tbmVzcyBpbiBBSSByZXNwb25zZXMgKDAuMCAtIDEuMCknKVxuXHRcdFx0LmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXG5cdFx0XHRcdC5zZXRMaW1pdHMoMCwgMSwgMC4xKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0VGVtcGVyYXR1cmUpXG5cdFx0XHRcdC5zZXREeW5hbWljVG9vbHRpcCgpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IE1heCBUb2tlbnMnKVxuXHRcdFx0LnNldERlc2MoJ01heGltdW0gbGVuZ3RoIG9mIEFJIHJlc3BvbnNlcycpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCcxMDAwJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2Vucy50b1N0cmluZygpKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgbnVtVmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XG5cdFx0XHRcdFx0aWYgKCFpc05hTihudW1WYWx1ZSkgJiYgbnVtVmFsdWUgPiAwKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnMgPSBudW1WYWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnQXV0by1zYXZlIHNldHRpbmdzJylcblx0XHRcdC5zZXREZXNjKCdBdXRvbWF0aWNhbGx5IHNhdmUgc2V0dGluZ3Mgd2hlbiBjaGFuZ2VkJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5hdXRvU2F2ZSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuYXV0b1NhdmUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlclNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQUkgUHJvdmlkZXIgU2V0dGluZ3MnIH0pO1xuXG5cdFx0Y29uc3QgY3VycmVudFRpZXIgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uZ2V0Q3VycmVudFRpZXIoKSB8fCAnY29yZSc7XG5cdFx0Y29uc3QgaXNDb3JlVGllciA9IGN1cnJlbnRUaWVyID09PSAnY29yZSc7XG5cdFx0XG5cdFx0aWYgKGlzQ29yZVRpZXIpIHtcblx0XHRcdGNvbnN0IHJlc3RyaWN0aW9uTm90aWNlID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLW1lc3NhZ2UnIH0pO1xuXHRcdFx0cmVzdHJpY3Rpb25Ob3RpY2UuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8c3Ryb25nPkNvcmUgVGllciBSZXN0cmljdGlvbnM6PC9zdHJvbmc+IFlvdSBjYW4gY29uZmlndXJlIDEgbG9jYWwgcHJvdmlkZXIgKE9sbGFtYSkgYW5kIDEgY2xvdWQgcHJvdmlkZXIuIFxuXHRcdFx0XHQ8YSBocmVmPVwiI1wiIGNsYXNzPVwidXBncmFkZS1saW5rXCI+VXBncmFkZSB0byBTdXBlck5vdmE8L2E+IGZvciB1bmxpbWl0ZWQgcHJvdmlkZXJzLlxuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGNsaWNrIGhhbmRsZXIgZm9yIHVwZ3JhZGUgbGlua1xuXHRcdFx0Y29uc3QgdXBncmFkZUxpbmsgPSByZXN0cmljdGlvbk5vdGljZS5xdWVyeVNlbGVjdG9yKCcudXBncmFkZS1saW5rJyk7XG5cdFx0XHR1cGdyYWRlTGluaz8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHdpbmRvdy5vcGVuKCdodHRwczovL25vdmF3cml0ZXIuYWkvdXBncmFkZScsICdfYmxhbmsnKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEFsd2F5cyBzaG93IE9sbGFtYSAobG9jYWwgcHJvdmlkZXIpXG5cdFx0dGhpcy5jcmVhdGVPbGxhbWFTZXR0aW5ncygpO1xuXHRcdFxuXHRcdC8vIFNob3cgY2xvdWQgcHJvdmlkZXJzIGJhc2VkIG9uIHRpZXJcblx0XHR0aGlzLmNyZWF0ZUNsYXVkZVNldHRpbmdzKGlzQ29yZVRpZXIpO1xuXHRcdHRoaXMuY3JlYXRlR29vZ2xlU2V0dGluZ3MoaXNDb3JlVGllcik7XG5cdFx0dGhpcy5jcmVhdGVPcGVuQUlTZXR0aW5ncyhpc0NvcmVUaWVyKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2xhdWRlU2V0dGluZ3MoaXNSZXN0cmljdGVkOiBib29sZWFuID0gZmFsc2UpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRoaXMgcHJvdmlkZXIgc2hvdWxkIGJlIHNob3duIGZvciBDb3JlIHRpZXJcblx0XHRpZiAoaXNSZXN0cmljdGVkICYmICF0aGlzLmlzUHJvdmlkZXJBbGxvd2VkRm9yQ29yZVRpZXIoJ2NsYXVkZScpKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVSZXN0cmljdGVkUHJvdmlkZXJOb3RpY2UoY29udGFpbmVyRWwsICdDbGF1ZGUgKEFudGhyb3BpYyknKTtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgY2xhdWRlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRjbGF1ZGVDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQ2xhdWRlIChBbnRocm9waWMpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNsYXVkZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEFudGhyb3BpYyBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ3NrLWFudC0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY2xhdWRlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdDbGF1ZGUgbW9kZWwgdG8gdXNlJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUtc29ubmV0LTQnLCAnQ2xhdWRlIFNvbm5ldCA0Jylcblx0XHRcdFx0LmFkZE9wdGlvbignY2xhdWRlLW9wdXMtNCcsICdDbGF1ZGUgT3B1cyA0Jylcblx0XHRcdFx0LmFkZE9wdGlvbignY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLCAnQ2xhdWRlIDMgSGFpa3UnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUtMy1zb25uZXQtMjAyNDAyMjknLCAnQ2xhdWRlIDMgU29ubmV0Jylcblx0XHRcdFx0LmFkZE9wdGlvbignY2xhdWRlLTMtb3B1cy0yMDI0MDIyOScsICdDbGF1ZGUgMyBPcHVzJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5tb2RlbCB8fCAnY2xhdWRlLXNvbm5ldC00Jylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGlzUHJvdmlkZXJBbGxvd2VkRm9yQ29yZVRpZXIocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSByZXR1cm4gdHJ1ZTtcblx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuaXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUmVzdHJpY3RlZFByb3ZpZGVyTm90aWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHByb3ZpZGVyTmFtZTogc3RyaW5nKSB7XG5cdFx0Y29uc3QgcmVzdHJpY3RlZENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24gbm92YS1wcm92aWRlci1yZXN0cmljdGVkJyB9KTtcblx0XHRyZXN0cmljdGVkQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdDxoND4ke3Byb3ZpZGVyTmFtZX0gPHNwYW4gY2xhc3M9XCJyZXN0cmljdGlvbi1iYWRnZVwiPlN1cGVyTm92YSBPbmx5PC9zcGFuPjwvaDQ+XG5cdFx0XHQ8cCBjbGFzcz1cInJlc3RyaWN0aW9uLXRleHRcIj5UaGlzIHByb3ZpZGVyIHJlcXVpcmVzIGEgU3VwZXJOb3ZhIGxpY2Vuc2UuPC9wPlxuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZU9wZW5BSVNldHRpbmdzKGlzUmVzdHJpY3RlZDogYm9vbGVhbiA9IGZhbHNlKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGlzIHByb3ZpZGVyIHNob3VsZCBiZSBzaG93biBmb3IgQ29yZSB0aWVyXG5cdFx0aWYgKGlzUmVzdHJpY3RlZCAmJiAhdGhpcy5pc1Byb3ZpZGVyQWxsb3dlZEZvckNvcmVUaWVyKCdvcGVuYWknKSkge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlUmVzdHJpY3RlZFByb3ZpZGVyTm90aWNlKGNvbnRhaW5lckVsLCAnT3BlbkFJJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IG9wZW5haUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0b3BlbmFpQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ09wZW5BSScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBPcGVuQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Jhc2UgVVJMJylcblx0XHRcdC5zZXREZXNjKCdPcGVuQUkgQVBJIGJhc2UgVVJMIChmb3IgY3VzdG9tIGVuZHBvaW50cyknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYmFzZVVybCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5iYXNlVXJsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT3BlbkFJIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cblx0XHRcdFx0LmFkZE9wdGlvbignZ3B0LTRvJywgJ0dQVC00bycpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dwdC0zLjUtdHVyYm8nLCAnR1BULTMuNSBUdXJibycpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dwdC00JywgJ0dQVC00Jylcblx0XHRcdFx0LmFkZE9wdGlvbignZ3B0LTQtdHVyYm8tcHJldmlldycsICdHUFQtNCBUdXJibycpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgfHwgJ2dwdC00bycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHb29nbGVTZXR0aW5ncyhpc1Jlc3RyaWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZSkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgdGhpcyBwcm92aWRlciBzaG91bGQgYmUgc2hvd24gZm9yIENvcmUgdGllclxuXHRcdGlmIChpc1Jlc3RyaWN0ZWQgJiYgIXRoaXMuaXNQcm92aWRlckFsbG93ZWRGb3JDb3JlVGllcignZ29vZ2xlJykpIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZVJlc3RyaWN0ZWRQcm92aWRlck5vdGljZShjb250YWluZXJFbCwgJ0dvb2dsZSAoR2VtaW5pKScpO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBnb29nbGVDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdGdvb2dsZUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdHb29nbGUgKEdlbWluaSknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgR29vZ2xlIEFJIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignQUkuLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdHZW1pbmkgbW9kZWwgdG8gdXNlJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0XHQuYWRkT3B0aW9uKCdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDUtMjAnLCAnR2VtaW5pIDIuNSBGbGFzaCBQcmV2aWV3Jylcblx0XHRcdFx0LmFkZE9wdGlvbignZ2VtaW5pLTIuNS1wcm8tcHJldmlldy0wNi0wNScsICdHZW1pbmkgMi41IFBybyBQcmV2aWV3Jylcblx0XHRcdFx0LmFkZE9wdGlvbignZ2VtaW5pLTEuNS1mbGFzaCcsICdHZW1pbmkgMS41IEZsYXNoJylcblx0XHRcdFx0LmFkZE9wdGlvbignZ2VtaW5pLTEuNS1wcm8nLCAnR2VtaW5pIDEuNSBQcm8nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsIHx8ICdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDUtMjAnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlT2xsYW1hU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb25zdCBvbGxhbWFDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdG9sbGFtYUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdPbGxhbWEgKExvY2FsKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQmFzZSBVUkwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBzZXJ2ZXIgVVJMJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBtb2RlbCB0byB1c2UnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignbGxhbWEyJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdQbGF0Zm9ybSBTZXR0aW5ncycgfSk7XG5cblx0XHRjb25zdCBjdXJyZW50VGllciA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDdXJyZW50VGllcigpIHx8ICdjb3JlJztcblx0XHRjb25zdCBpc0NvcmVUaWVyID0gY3VycmVudFRpZXIgPT09ICdjb3JlJztcblxuXHRcdGNvbnN0IHBsYXRmb3JtQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHRpZiAoaXNDb3JlVGllcikge1xuXHRcdFx0Y29uc3QgcmVzdHJpY3Rpb25Ob3RpY2UgPSBwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxpY2Vuc2UtbWVzc2FnZScgfSk7XG5cdFx0XHRyZXN0cmljdGlvbk5vdGljZS5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxzdHJvbmc+UGxhdGZvcm0gUmVzdHJpY3Rpb25zOjwvc3Ryb25nPiBDb3JlIHRpZXIgYWxsb3dzIDEgbG9jYWwgKyAxIGNsb3VkIHByb3ZpZGVyIG9uIGRlc2t0b3AuIFxuXHRcdFx0XHRNb2JpbGUgaXMgZGlzYWJsZWQgZm9yIENvcmUgdGllciB1c2Vycy5cblx0XHRcdGA7XG5cdFx0fVxuXHRcdFxuXHRcdHBsYXRmb3JtQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0Rlc2t0b3AnIH0pO1xuXHRcdGNvbnN0IGRlc2t0b3BEcm9wZG93biA9IG5ldyBTZXR0aW5nKHBsYXRmb3JtQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1ByaW1hcnkgUHJvdmlkZXInKVxuXHRcdFx0LnNldERlc2MoJ1ByaW1hcnkgQUkgcHJvdmlkZXIgZm9yIGRlc2t0b3AnKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMuZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKCdkZXNrdG9wJyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRhbGxvd2VkUHJvdmlkZXJzLmZvckVhY2gocHJvdmlkZXIgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGxhYmVsID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyKTtcblx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24ocHJvdmlkZXIsIGxhYmVsKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnByaW1hcnlQcm92aWRlcilcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnZhbGlkYXRlUHJvdmlkZXJTZWxlY3Rpb24odmFsdWUgYXMgUHJvdmlkZXJUeXBlLCAnZGVza3RvcCcpKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0cGxhdGZvcm1Db250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnTW9iaWxlJyB9KTtcblx0XHRjb25zdCBtb2JpbGVEZXNjID0gaXNDb3JlVGllciBcblx0XHRcdD8gJ01vYmlsZSBhY2Nlc3MgcmVxdWlyZXMgU3VwZXJOb3ZhIGxpY2Vuc2UnXG5cdFx0XHQ6ICdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBtb2JpbGUnO1xuXHRcdFx0XG5cdFx0Y29uc3QgbW9iaWxlU2V0dGluZyA9IG5ldyBTZXR0aW5nKHBsYXRmb3JtQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1ByaW1hcnkgUHJvdmlkZXInKVxuXHRcdFx0LnNldERlc2MobW9iaWxlRGVzYyk7XG5cdFx0XHRcblx0XHRpZiAoaXNDb3JlVGllcikge1xuXHRcdFx0Ly8gRm9yIENvcmUgdGllciwgc2hvdyBkaXNhYmxlZCBkcm9wZG93biB3aXRoIHVwZ3JhZGUgbWVzc2FnZVxuXHRcdFx0bW9iaWxlU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0XHQuYWRkT3B0aW9uKCdub25lJywgJ1VwZ3JhZGUgdG8gU3VwZXJOb3ZhIGZvciBNb2JpbGUgQWNjZXNzJylcblx0XHRcdFx0LnNldFZhbHVlKCdub25lJylcblx0XHRcdFx0LnNldERpc2FibGVkKHRydWUpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bW9iaWxlU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0XHQuYWRkT3B0aW9uKCdub25lJywgJ05vbmUgKERpc2FibGVkKScpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZScsICdDbGF1ZGUnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdvcGVuYWknLCAnT3BlbkFJJylcblx0XHRcdFx0LmFkZE9wdGlvbignZ29vZ2xlJywgJ0dvb2dsZScpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5wcmltYXJ5UHJvdmlkZXIpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlciA9IHZhbHVlIGFzIFByb3ZpZGVyVHlwZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKHBsYXRmb3JtOiAnZGVza3RvcCcgfCAnbW9iaWxlJyk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHRyZXR1cm4gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXTtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgY3VycmVudFRpZXIgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uZ2V0Q3VycmVudFRpZXIoKSB8fCAnY29yZSc7XG5cdFx0XG5cdFx0aWYgKHBsYXRmb3JtID09PSAnbW9iaWxlJyAmJiBjdXJyZW50VGllciA9PT0gJ2NvcmUnKSB7XG5cdFx0XHRyZXR1cm4gWydub25lJ107XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGFsbG93ZWRQcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRBbGxvd2VkUHJvdmlkZXJzKCk7XG5cdFx0cmV0dXJuIGFsbG93ZWRQcm92aWRlcnMubGVuZ3RoID4gMCA/IGFsbG93ZWRQcm92aWRlcnMgOiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyOiBQcm92aWRlclR5cGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8UHJvdmlkZXJUeXBlLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdDbGF1ZGUgKEFudGhyb3BpYyknLFxuXHRcdFx0J29wZW5haSc6ICdPcGVuQUknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUgKEdlbWluaSknLCBcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hIChMb2NhbCknLFxuXHRcdFx0J25vbmUnOiAnTm9uZSAoRGlzYWJsZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIG5hbWVzW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcblx0fVxuXG5cdHByaXZhdGUgdmFsaWRhdGVQcm92aWRlclNlbGVjdGlvbihwcm92aWRlcjogUHJvdmlkZXJUeXBlLCBwbGF0Zm9ybTogJ2Rlc2t0b3AnIHwgJ21vYmlsZScpOiBib29sZWFuIHtcblx0XHRjb25zdCBjdXJyZW50VGllciA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDdXJyZW50VGllcigpIHx8ICdjb3JlJztcblx0XHRcblx0XHQvLyBTdXBlck5vdmEgdXNlcnMgY2FuIHNlbGVjdCBhbnkgcHJvdmlkZXJcblx0XHRpZiAoY3VycmVudFRpZXIgPT09ICdzdXBlcm5vdmEnKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ29yZSB0aWVyIHJlc3RyaWN0aW9uc1xuXHRcdGlmIChwbGF0Zm9ybSA9PT0gJ21vYmlsZScgJiYgcHJvdmlkZXIgIT09ICdub25lJykge1xuXHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1x1Mjc0QyBNb2JpbGUgYWNjZXNzIHJlcXVpcmVzIFN1cGVyTm92YSBsaWNlbnNlLicsICdlcnJvcicpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRcblx0XHQvLyBGb3IgZGVza3RvcCwgY2hlY2sgaWYgcHJvdmlkZXIgaXMgYWxsb3dlZFxuXHRcdGlmIChwbGF0Zm9ybSA9PT0gJ2Rlc2t0b3AnICYmIHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmlzUHJvdmlkZXJBbGxvd2VkKHByb3ZpZGVyKSkge1xuXHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnXHUyNzRDIFRoaXMgcHJvdmlkZXIgcmVxdWlyZXMgU3VwZXJOb3ZhIGxpY2Vuc2UuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cbn0iLCAiaW1wb3J0IHsgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyLCBQcm92aWRlclR5cGUsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgQUlQcm92aWRlclNldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDbGF1ZGVQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2NsYXVkZSc7XG5pbXBvcnQgeyBPcGVuQUlQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL29wZW5haSc7XG5pbXBvcnQgeyBHb29nbGVQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2dvb2dsZSc7XG5pbXBvcnQgeyBPbGxhbWFQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL29sbGFtYSc7XG5pbXBvcnQgeyBOb3ZhU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4uL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgQUlQcm92aWRlck1hbmFnZXIge1xuXHRwcml2YXRlIHByb3ZpZGVyczogTWFwPFByb3ZpZGVyVHlwZSwgQUlQcm92aWRlcj4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc2V0dGluZ3M6IE5vdmFTZXR0aW5ncztcblx0cHJpdmF0ZSBmZWF0dXJlTWFuYWdlcj86IEZlYXR1cmVNYW5hZ2VyO1xuXG5cdGNvbnN0cnVjdG9yKHNldHRpbmdzOiBOb3ZhU2V0dGluZ3MsIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXIpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdFx0dGhpcy5mZWF0dXJlTWFuYWdlciA9IGZlYXR1cmVNYW5hZ2VyO1xuXHR9XG5cblx0YXN5bmMgaW5pdGlhbGl6ZSgpIHtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2NsYXVkZScsIG5ldyBDbGF1ZGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb3BlbmFpJywgbmV3IE9wZW5BSVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdnb29nbGUnLCBuZXcgR29vZ2xlUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ29sbGFtYScsIG5ldyBPbGxhbWFQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYSkpO1xuXHR9XG5cblx0dXBkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IE5vdmFTZXR0aW5ncykge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLnByb3ZpZGVycy5mb3JFYWNoKChwcm92aWRlciwgdHlwZSkgPT4ge1xuXHRcdFx0aWYgKHR5cGUgIT09ICdub25lJyAmJiB0eXBlIGluIHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMpIHtcblx0XHRcdFx0cHJvdmlkZXIudXBkYXRlQ29uZmlnPy4odGhpcy5zZXR0aW5ncy5haVByb3ZpZGVyc1t0eXBlIGFzIGtleW9mIEFJUHJvdmlkZXJTZXR0aW5nc10pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRQbGF0Zm9ybVByb3ZpZGVycygpOiBQcm92aWRlclR5cGVbXSB7XG5cdFx0Ly8gQ2hlY2sgbW9iaWxlIGFjY2VzcyBmb3IgQ29yZSB0aWVyIHVzZXJzXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlICYmIHRoaXMuZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdGlmICghdGhpcy5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtb2JpbGVfYWNjZXNzJykpIHtcblx0XHRcdFx0cmV0dXJuIFsnbm9uZSddOyAvLyBCbG9jayBhbGwgcHJvdmlkZXJzIGZvciBDb3JlIG1vYmlsZSB1c2Vyc1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRjb25zdCBwbGF0Zm9ybVNldHRpbmdzID0gdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXTtcblx0XHRsZXQgcHJvdmlkZXJzID0gW3BsYXRmb3JtU2V0dGluZ3MucHJpbWFyeVByb3ZpZGVyLCAuLi5wbGF0Zm9ybVNldHRpbmdzLmZhbGxiYWNrUHJvdmlkZXJzXTtcblx0XHRcblx0XHQvLyBBcHBseSBDb3JlIHRpZXIgcmVzdHJpY3Rpb25zIGlmIGFwcGxpY2FibGVcblx0XHRpZiAodGhpcy5mZWF0dXJlTWFuYWdlciAmJiAhdGhpcy5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCd1bmxpbWl0ZWRfY2xvdWRfYWknKSkge1xuXHRcdFx0cHJvdmlkZXJzID0gdGhpcy5maWx0ZXJQcm92aWRlcnNGb3JDb3JlVGllcihwcm92aWRlcnMpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gcHJvdmlkZXJzO1xuXHR9XG5cblx0cHJpdmF0ZSBmaWx0ZXJQcm92aWRlcnNGb3JDb3JlVGllcihwcm92aWRlcnM6IFByb3ZpZGVyVHlwZVtdKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdGNvbnN0IGxvY2FsUHJvdmlkZXJzOiBQcm92aWRlclR5cGVbXSA9IFsnb2xsYW1hJ107XG5cdFx0Y29uc3QgY2xvdWRQcm92aWRlcnM6IFByb3ZpZGVyVHlwZVtdID0gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZSddO1xuXHRcdFxuXHRcdGxldCBhbGxvd2VkTG9jYWw6IFByb3ZpZGVyVHlwZVtdID0gW107XG5cdFx0bGV0IGFsbG93ZWRDbG91ZDogUHJvdmlkZXJUeXBlW10gPSBbXTtcblx0XHRcblx0XHQvLyBBbGxvdyAxIGxvY2FsIHByb3ZpZGVyIChmaXJzdCBmb3VuZClcblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyIG9mIHByb3ZpZGVycykge1xuXHRcdFx0aWYgKGxvY2FsUHJvdmlkZXJzLmluY2x1ZGVzKHByb3ZpZGVyKSAmJiBhbGxvd2VkTG9jYWwubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdGFsbG93ZWRMb2NhbC5wdXNoKHByb3ZpZGVyKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEFsbG93IDEgY2xvdWQgcHJvdmlkZXIgKGZpcnN0IGZvdW5kKVxuXHRcdGZvciAoY29uc3QgcHJvdmlkZXIgb2YgcHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAoY2xvdWRQcm92aWRlcnMuaW5jbHVkZXMocHJvdmlkZXIpICYmIGFsbG93ZWRDbG91ZC5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0YWxsb3dlZENsb3VkLnB1c2gocHJvdmlkZXIpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gUHJlc2VydmUgb3JkZXIgYW5kIGluY2x1ZGUgJ25vbmUnIGlmIHByZXNlbnRcblx0XHRyZXR1cm4gcHJvdmlkZXJzLmZpbHRlcihwID0+IFxuXHRcdFx0cCA9PT0gJ25vbmUnIHx8IGFsbG93ZWRMb2NhbC5pbmNsdWRlcyhwKSB8fCBhbGxvd2VkQ2xvdWQuaW5jbHVkZXMocClcblx0XHQpO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBnZXRBdmFpbGFibGVQcm92aWRlcigpOiBQcm9taXNlPEFJUHJvdmlkZXIgfCBudWxsPiB7XG5cdFx0Y29uc3Qgb3JkZXJlZFByb3ZpZGVycyA9IHRoaXMuZ2V0UGxhdGZvcm1Qcm92aWRlcnMoKTtcblx0XHRcblx0XHQvLyBJZiBwcmltYXJ5IHByb3ZpZGVyIGlzICdub25lJywgTm92YSBpcyBkaXNhYmxlZCBvbiB0aGlzIHBsYXRmb3JtXG5cdFx0aWYgKG9yZGVyZWRQcm92aWRlcnNbMF0gPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGZvciAoY29uc3QgcHJvdmlkZXJUeXBlIG9mIG9yZGVyZWRQcm92aWRlcnMpIHtcblx0XHRcdGlmIChwcm92aWRlclR5cGUgPT09ICdub25lJykgY29udGludWU7XG5cdFx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHByb3ZpZGVyLmlzQXZhaWxhYmxlKCkpIHtcblx0XHRcdFx0cmV0dXJuIHByb3ZpZGVyO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmdlbmVyYXRlVGV4dChwcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHR5aWVsZCogcHJvdmlkZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlci5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHlpZWxkKiBwcm92aWRlci5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRQcm92aWRlck5hbWVzKCk6IHN0cmluZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSkubWFwKHAgPT4gcC5uYW1lKTtcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRQcm92aWRlck5hbWUoKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRyZXR1cm4gcHJvdmlkZXIgPyBwcm92aWRlci5uYW1lIDogJ05vbmUnO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNvbXBsZXRlKHN5c3RlbVByb21wdCwgdXNlclByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRBbGxvd2VkUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRQbGF0Zm9ybVByb3ZpZGVycygpO1xuXHR9XG5cblx0aXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRBbGxvd2VkUHJvdmlkZXJzKCkuaW5jbHVkZXMocHJvdmlkZXJUeXBlKTtcblx0fVxuXG5cdGdldFByb3ZpZGVyTGltaXRzKCk6IHsgbG9jYWw6IG51bWJlcjsgY2xvdWQ6IG51bWJlciB9IHtcblx0XHRpZiAodGhpcy5mZWF0dXJlTWFuYWdlciAmJiB0aGlzLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ3VubGltaXRlZF9jbG91ZF9haScpKSB7XG5cdFx0XHRyZXR1cm4geyBsb2NhbDogSW5maW5pdHksIGNsb3VkOiBJbmZpbml0eSB9O1xuXHRcdH1cblx0XHRyZXR1cm4geyBsb2NhbDogMSwgY2xvdWQ6IDEgfTtcblx0fVxuXG5cdGNsZWFudXAoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuY2xlYXIoKTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQ2xhdWRlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdDbGF1ZGUgKEFudGhyb3BpYyknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlID09PSAnYXNzaXN0YW50JyA/ICdhc3Npc3RhbnQnIDogJ3VzZXInLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2xhdWRlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEuY29udGVudFswXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJywge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCd4LWFwaS1rZXknOiB0aGlzLmNvbmZpZy5hcGlLZXksXG5cdFx0XHRcdCdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdjbGF1ZGUtMy1oYWlrdS0yMDI0MDMwNycsXG5cdFx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0c3lzdGVtOiBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnYXNzaXN0YW50JyA6ICd1c2VyJyxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSlcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENsYXVkZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG5cdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLnR5cGUgPT09ICdjb250ZW50X2Jsb2NrX2RlbHRhJyAmJiBwYXJzZWQuZGVsdGE/LnRleHQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHBhcnNlZC5kZWx0YS50ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPcGVuQUlQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ09wZW5BSSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjdcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXHRcdGxldCBidWZmZXIgPSAnJztcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0Y29uc3QgbGluZXMgPSBidWZmZXIuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJztcblxuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGF0YSA9IGxpbmUuc2xpY2UoNik7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YSA9PT0gJ1tET05FXScpIHtcblx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBwYXJzZWQuY2hvaWNlcz8uWzBdPy5kZWx0YT8uY29udGVudDtcblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdvb2dsZVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnR29vZ2xlIChHZW1pbmkpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgc3lzdGVtUHJvbXB0Pzogc3RyaW5nKTogYW55IHtcblx0XHRjb25zdCBjb250ZW50cyA9IFtdO1xuXHRcdFxuXHRcdGlmIChzeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlOiAndXNlcicsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBgU3lzdGVtOiAke3N5c3RlbVByb21wdH1gIH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgbWVzc2FnZXMpIHtcblx0XHRcdGNvbnN0IHJvbGUgPSBtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ21vZGVsJyA6ICd1c2VyJztcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogbWVzc2FnZS5jb250ZW50IH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29udGVudHM7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdHb29nbGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS1wcm8nO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRcdGdlbmVyYXRpb25Db25maWc6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktcHJvJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzLCBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGV4dCA9IHBhcnNlZC5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XG5cdFx0XHRcdFx0XHRcdGlmICh0ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiB0ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPbGxhbWFQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ09sbGFtYSAoTG9jYWwpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLm1vZGVsKSByZXR1cm4gZmFsc2U7IC8vIFJlcXVpcmUgbW9kZWwgdG8gYmUgc2V0XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL3RhZ3NgLCB7XG5cdFx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiByZXNwb25zZS5vaztcblx0XHR9IGNhdGNoIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2dlbmVyYXRlYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdHByb21wdCxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5yZXNwb25zZTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5yZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogcGFyc2VkLnJlc3BvbnNlLCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2NoYXRgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSksXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEubWVzc2FnZS5jb250ZW50O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9jaGF0YCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpLFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5tZXNzYWdlPy5jb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQubWVzc2FnZS5jb250ZW50LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlLCBOb3RpY2UsIE1hcmtkb3duVmlldywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSID0gJ25vdmEtc2lkZWJhcic7XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2lkZWJhclZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaW5wdXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0ZXh0QXJlYSE6IFRleHRBcmVhQ29tcG9uZW50O1xuXHRwcml2YXRlIHNlbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIobGVhZik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRnZXRWaWV3VHlwZSgpIHtcblx0XHRyZXR1cm4gVklFV19UWVBFX05PVkFfU0lERUJBUjtcblx0fVxuXG5cdGdldERpc3BsYXlUZXh0KCkge1xuXHRcdHJldHVybiAnTm92YSBBSSc7XG5cdH1cblxuXHRnZXRJY29uKCkge1xuXHRcdHJldHVybiAnbm92YS1zdGFyJztcblx0fVxuXG5cdGFzeW5jIG9uT3BlbigpIHtcblx0XHRjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNoaWxkcmVuWzFdIGFzIEhUTUxFbGVtZW50O1xuXHRcdGNvbnRhaW5lci5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbm92YS1zaWRlYmFyLWNvbnRhaW5lcicpO1xuXG5cdFx0Ly8gQ2hlY2sgbW9iaWxlIGFjY2VzcyBmb3IgQ29yZSB0aWVyIHVzZXJzXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlICYmIHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDdXJyZW50VGllcigpID09PSAnY29yZScpIHtcblx0XHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbW9iaWxlX2FjY2VzcycpKSB7XG5cdFx0XHRcdHRoaXMuc2hvd01vYmlsZUJsb2NrZWRNZXNzYWdlKGNvbnRhaW5lcik7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHdyYXBwZXIgd2l0aCBwcm9wZXIgZmxleCBsYXlvdXRcblx0XHRjb25zdCB3cmFwcGVyRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13cmFwcGVyJyB9KTtcblx0XHR3cmFwcGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0aGVpZ2h0OiAxMDAlO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciB3aXRoIHByb3ZpZGVyIGluZm9cblx0XHRjb25zdCBoZWFkZXJFbCA9IHdyYXBwZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogMTBweDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIExlZnQgc2lkZTogVGl0bGUgd2l0aCBOb3ZhIGljb25cblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2g0Jyk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZm9udC1zaXplOiAxLjFlbTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7Jztcblx0XHR0aXRsZUVsLmlubmVySFRNTCA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAxOHB4OyBoZWlnaHQ6IDE4cHg7XCI+XG5cdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0PC9zdmc+Tm92YWA7XG5cdFx0XG5cdFx0Ly8gUmlnaHQgc2lkZTogUHJvdmlkZXIgc3RhdHVzIGFuZCBDbGVhciBidXR0b25cblx0XHRjb25zdCByaWdodENvbnRhaW5lciA9IGhlYWRlckVsLmNyZWF0ZURpdigpO1xuXHRcdHJpZ2h0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA4cHg7Jztcblx0XHRcblx0XHQvLyBDaGVjayBpZiB1c2VyIGNhbiBzd2l0Y2ggcHJvdmlkZXJzIChTdXBlck5vdmEgb25seSlcblx0XHRjb25zdCBjdXJyZW50VGllciA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDdXJyZW50VGllcigpIHx8ICdjb3JlJztcblx0XHRjb25zdCBjYW5Td2l0Y2hQcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uaXNGZWF0dXJlRW5hYmxlZCgncHJvdmlkZXJfc3dpdGNoaW5nJykgfHwgZmFsc2U7XG5cdFx0XG5cdFx0aWYgKGNhblN3aXRjaFByb3ZpZGVycykge1xuXHRcdFx0Ly8gU3VwZXJOb3ZhOiBQcm92aWRlciBkcm9wZG93biB3aXRoIHN3aXRjaGluZyBjYXBhYmlsaXR5XG5cdFx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyRHJvcGRvd24ocmlnaHRDb250YWluZXIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBDb3JlOiBTdGF0aWMgcHJvdmlkZXIgc3RhdHVzIGRpc3BsYXlcblx0XHRcdHRoaXMuY3JlYXRlU3RhdGljUHJvdmlkZXJTdGF0dXMocmlnaHRDb250YWluZXIpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhciBDaGF0IGJ1dHRvbiBpbiByaWdodCBjb250YWluZXJcblx0XHRjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQocmlnaHRDb250YWluZXIpO1xuXHRcdGNsZWFyQnV0dG9uLnNldEJ1dHRvblRleHQoJ0NsZWFyJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBjb252ZXJzYXRpb24gaGlzdG9yeScpXG5cdFx0XHQub25DbGljaygoKSA9PiB0aGlzLmNsZWFyQ2hhdCgpKTtcblxuXHRcdHRoaXMuY3JlYXRlQ2hhdEludGVyZmFjZSh3cmFwcGVyRWwpO1xuXHRcdHRoaXMuY3JlYXRlSW5wdXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHRcblx0XHQvLyBSZWdpc3RlciBldmVudCBsaXN0ZW5lciBmb3IgYWN0aXZlIGZpbGUgY2hhbmdlc1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdFx0XHR9KVxuXHRcdCk7XG5cdFx0XG5cdFx0Ly8gTG9hZCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuXHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0fVxuXG5cdGFzeW5jIG9uQ2xvc2UoKSB7XG5cdFx0Ly8gQ2xlYW4gdXAgcHJvdmlkZXIgZHJvcGRvd24gZXZlbnQgbGlzdGVuZXJcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8uY2xlYW51cCkge1xuXHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi5jbGVhbnVwKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDaGF0SW50ZXJmYWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmNoYXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jaGF0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHBhZGRpbmc6IDEwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogOHB4O1xuXHRcdGA7XG5cblx0XHQvLyBXZWxjb21lIG1lc3NhZ2Ugd2l0aCBOb3ZhIGJyYW5kaW5nXG5cdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVJbnB1dEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRnYXA6IDhweDtcblx0XHRcdHBhZGRpbmc6IDEwcHg7XG5cdFx0XHRib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblxuXHRcdC8vIFNpbXBsaWZpZWQgaW5wdXQgcm93IHdpdGgganVzdCB0ZXh0YXJlYSBhbmQgc2VuZCBidXR0b25cblx0XHRjb25zdCBpbnB1dFJvdyA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1yb3cnIH0pO1xuXHRcdGlucHV0Um93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogOHB4O1xuXHRcdGA7XG5cblx0XHQvLyBUZXh0IGFyZWEgdGFrZXMgbW9zdCBzcGFjZVxuXHRcdGNvbnN0IHRleHRBcmVhQ29udGFpbmVyID0gaW5wdXRSb3cuY3JlYXRlRGl2KCk7XG5cdFx0dGV4dEFyZWFDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdmbGV4OiAxOyc7XG5cdFx0dGhpcy50ZXh0QXJlYSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudCh0ZXh0QXJlYUNvbnRhaW5lcik7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRQbGFjZWhvbGRlcignQXNrIE5vdmEgdG8gaGVscCBlZGl0IHlvdXIgZG9jdW1lbnQuLi4nKTtcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0bWluLWhlaWdodDogMzhweDtcblx0XHRcdG1heC1oZWlnaHQ6IDEyMHB4O1xuXHRcdFx0cmVzaXplOiB2ZXJ0aWNhbDtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdHBhZGRpbmc6IDEwcHg7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdGV4dC1zaXplKTtcblx0XHRcdGxpbmUtaGVpZ2h0OiB2YXIoLS1saW5lLWhlaWdodC1ub3JtYWwpO1xuXHRcdGA7XG5cblx0XHQvLyBTZW5kIGJ1dHRvbiB2ZXJ0aWNhbGx5IGNlbnRlcmVkXG5cdFx0dGhpcy5zZW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEljb24oJ3NlbmQnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0VG9vbHRpcCgnU2VuZCBtZXNzYWdlJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEN0YSgpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuaGFuZGxlU2VuZCgpKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiAzNnB4O1xuXHRcdFx0aGVpZ2h0OiAzNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXG5cdFx0Ly8gRW50ZXIga2V5IGhhbmRsaW5nXG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcblx0XHRcdGlmIChldmVudC5rZXkgPT09ICdFbnRlcicgJiYgIWV2ZW50LnNoaWZ0S2V5KSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRNZXNzYWdlKHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbScsIGNvbnRlbnQ6IHN0cmluZykge1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2Ugbm92YS1tZXNzYWdlLSR7cm9sZX1gIH0pO1xuXHRcdG1lc3NhZ2VFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTBweDtcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHQke3JvbGUgPT09ICd1c2VyJyBcblx0XHRcdFx0PyAnbWFyZ2luLWxlZnQ6IGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7JyBcblx0XHRcdFx0OiByb2xlID09PSAnc3lzdGVtJ1xuXHRcdFx0XHQ/ICdtYXJnaW46IDAgYXV0bzsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LXNpemU6IDAuOWVtOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0b3BhY2l0eTogMC43O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRgO1xuXG5cdFx0Y29uc3QgY29udGVudEVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtbWVzc2FnZS1jb250ZW50JyB9KTtcblx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tIHdpdGggc21vb3RoIGFuaW1hdGlvblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZykge1xuXHRcdGNvbnN0IHdlbGNvbWVFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUnIH0pO1xuXHRcdHdlbGNvbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDEycHg7XG5cdFx0XHRtYXJnaW46IDE2cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDE2cHggMjBweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxOHB4O1xuXHRcdFx0bWF4LXdpZHRoOiA5MCU7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjVzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBOb3ZhIHN0YXIgaWNvbiAoc3RhdGljLCBub3QgYW5pbWF0ZWQpXG5cdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUtaWNvbicgfSk7XG5cdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0d2lkdGg6IDMycHg7XG5cdFx0XHRoZWlnaHQ6IDMycHg7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdGljb25Db250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0PHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogMzJweDsgaGVpZ2h0OiAzMnB4OyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPlxuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gV2VsY29tZSB0ZXh0XG5cdFx0Y29uc3QgdGV4dENvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSB0ZXh0Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6ICdXZWxjb21lIHRvIE5vdmEnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXRleHQtc2l6ZSk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdWJ0aXRsZUVsID0gdGV4dENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBtZXNzYWdlIHx8ICdZb3VyIEFJIHRoaW5raW5nIHBhcnRuZXIuIEFzayBtZSB0byBoZWxwIGVkaXQgeW91ciBkb2N1bWVudCEnIH0pO1xuXHRcdHN1YnRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGZvbnQtc2l6ZTogMC45ZW07XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3VjY2Vzc0luZGljYXRvcihhY3Rpb246IHN0cmluZykge1xuXHRcdGNvbnN0IGluZGljYXRvckVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VjY2Vzcy1pbmRpY2F0b3InIH0pO1xuXHRcdGluZGljYXRvckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0bWFyZ2luOiA4cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDZweCAxMnB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSg3NiwgMTc1LCA4MCwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoNzYsIDE3NSwgODAsIDAuMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdG1heC13aWR0aDogMjAwcHg7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjNzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBZGQgY2hlY2ttYXJrIGFuZCB0ZXh0XG5cdFx0aW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBzdHlsZT1cIndpZHRoOiAxMnB4OyBoZWlnaHQ6IDEycHg7IG1hcmdpbi1yaWdodDogNnB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyO1wiPlxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwid2lkdGg6IDRweDsgaGVpZ2h0OiAycHg7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgd2hpdGU7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB3aGl0ZTsgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKSB0cmFuc2xhdGUoLTAuNXB4LCAtMC41cHgpO1wiPjwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQke3RoaXMuZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbil9XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRzd2l0Y2ggKGFjdGlvbikge1xuXHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGFkZGVkJztcblx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgZWRpdGVkJztcblx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBkZWxldGVkJztcblx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRyZXR1cm4gJ0dyYW1tYXIgZml4ZWQnO1xuXHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCByZXdyaXR0ZW4nO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuICdDb21tYW5kIGNvbXBsZXRlZCc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVTZW5kKCkge1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZSkgcmV0dXJuO1xuXG5cdFx0Ly8gQWRkIHVzZXIgbWVzc2FnZVxuXHRcdHRoaXMuYWRkTWVzc2FnZSgndXNlcicsIG1lc3NhZ2UpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoJycpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXREaXNhYmxlZCh0cnVlKTtcblxuXHRcdHRyeSB7XG5cdFx0XHQvLyBBZGQgbG9hZGluZyBpbmRpY2F0b3Igd2l0aCBhbmltYXRlZCBub3ZhXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1sb2FkaW5nJyB9KTtcblx0XHRcdGxvYWRpbmdFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiAxMnB4IDE2cHg7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogMTJweDtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogOHB4O1xuXHRcdFx0XHRtYXgtd2lkdGg6IDgwJTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiAxMHB4O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gQ3JlYXRlIGFuaW1hdGVkIG5vdmEgYnVyc3Rcblx0XHRcdGNvbnN0IG5vdmFDb250YWluZXIgPSBsb2FkaW5nRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1idXJzdC1jb250YWluZXInIH0pO1xuXHRcdFx0bm92YUNvbnRhaW5lci5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJ1cnN0XCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtY29yZVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTFcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0yXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctM1wiPjwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdGNvbnN0IHRleHRFbCA9IGxvYWRpbmdFbC5jcmVhdGVTcGFuKHsgdGV4dDogJ05vdmEgaXMgdGhpbmtpbmcuLi4nIH0pO1xuXHRcdFx0dGV4dEVsLnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtOyc7XG5cblx0XHRcdC8vIFN0b3JlIG1lc3NhZ2UgaW4gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UobWVzc2FnZSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYSBjb21tYW5kIG9yIGNvbnZlcnNhdGlvblxuXHRcdFx0Y29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlclsnaXNMaWtlbHlDb21tYW5kJ10obWVzc2FnZSk7XG5cdFx0XHRsZXQgcmVzcG9uc2U6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNMaWtlbHlDb21tYW5kICYmIGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0Ly8gUGFyc2UgYXMgY29tbWFuZCBhbmQgcm91dGUgdG8gYXBwcm9wcmlhdGUgaGFuZGxlclxuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQobWVzc2FnZSk7XG5cdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChwYXJzZWRDb21tYW5kKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBhcyBjb252ZXJzYXRpb24gdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdFx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShtZXNzYWdlLCBhY3RpdmVGaWxlIHx8IHVuZGVmaW5lZCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0LCBwcm9tcHQudXNlclByb21wdCwge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvclxuXHRcdFx0bG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHQvLyBTdG9yZSByZXNwb25zZSBpbiBjb252ZXJzYXRpb24gbWFuYWdlciAoaWYgcmVzcG9uc2UgZXhpc3RzKVxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUgJiYgcmVzcG9uc2UpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShyZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBBSSByZXNwb25zZSAob25seSBpZiB0aGVyZSBpcyBhIHJlc3BvbnNlKVxuXHRcdFx0aWYgKHJlc3BvbnNlKSB7XG5cdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgcmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3IgaWYgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtbG9hZGluZycpO1xuXHRcdFx0aWYgKGxvYWRpbmdFbCkgbG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGBTb3JyeSwgSSBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXREaXNhYmxlZChmYWxzZSk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgaW5zZXJ0VGV4dEludG9BY3RpdmVOb3RlKHRleHQ6IHN0cmluZykge1xuXHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XG5cdFx0aWYgKGFjdGl2ZVZpZXcgJiYgJ2VkaXRvcicgaW4gYWN0aXZlVmlldykge1xuXHRcdFx0Y29uc3QgZWRpdG9yID0gKGFjdGl2ZVZpZXcgYXMgYW55KS5lZGl0b3I7XG5cdFx0XHRpZiAoZWRpdG9yKSB7XG5cdFx0XHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0ZWRpdG9yLnJlcGxhY2VSYW5nZSh0ZXh0LCBjdXJzb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgZXhlY3V0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhIGN1cnJlbnQgZmlsZSAodGhlIG9uZSB3ZSdyZSBjaGF0dGluZyBhYm91dClcblx0XHRcdGlmICghdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRyZXR1cm4gYFx1Mjc0QyBObyBtYXJrZG93biBmaWxlIGlzIG9wZW4uIFBsZWFzZSBvcGVuIGEgZmlsZSBpbiB0aGUgZWRpdG9yIHRvIHVzZSBlZGl0aW5nIGNvbW1hbmRzLmA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEVuc3VyZSB0aGVyZSdzIGEgbWFya2Rvd24gdmlldyB3aXRoIHRoaXMgZmlsZVxuXHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdGxldCBtYXJrZG93blZpZXc6IE1hcmtkb3duVmlldyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIHRoZSB2aWV3IHdpdGggb3VyIGZpbGVcblx0XHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdGlmICh2aWV3LmZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSB2aWV3O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIElmIG5vdCBmb3VuZCwgdHJ5IHRvIG9wZW4gdGhlIGZpbGVcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRcdGlmIChsZWFmKSB7XG5cdFx0XHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHJldHVybiBgXHUyNzRDIFVuYWJsZSB0byBhY2Nlc3MgdGhlIGZpbGUgXCIke3RoaXMuY3VycmVudEZpbGUuYmFzZW5hbWV9XCIuIFBsZWFzZSBtYWtlIHN1cmUgaXQncyBvcGVuIGluIHRoZSBlZGl0b3IuYDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmRlbGV0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gYEkgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgY29tbWFuZCBcIiR7Y29tbWFuZC5hY3Rpb259XCIuIFRyeSBhc2tpbmcgbWUgdG8gYWRkLCBlZGl0LCBkZWxldGUsIGZpeCBncmFtbWFyLCBvciByZXdyaXRlIGNvbnRlbnQuYDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdC8vIEFkZCBjb21wYWN0IHN1Y2Nlc3MgaW5kaWNhdG9yIGluc3RlYWQgb2YgZnVsbCBtZXNzYWdlXG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc0luZGljYXRvcihjb21tYW5kLmFjdGlvbik7XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBEb24ndCByZXR1cm4gdGV4dCBmb3IgcmVndWxhciBtZXNzYWdlXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gYEZhaWxlZCB0byAke2NvbW1hbmQuYWN0aW9ufTogJHtyZXN1bHQuZXJyb3J9YDtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIGBcdTI3NEMgRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQ6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWA7XG5cdFx0fVxuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIElmIG5vIGFjdGl2ZSBmaWxlLCB0cnkgdG8gZmluZCBhbnkgb3BlbiBtYXJrZG93biBmaWxlXG5cdFx0bGV0IHRhcmdldEZpbGUgPSBhY3RpdmVGaWxlO1xuXHRcdGlmICghdGFyZ2V0RmlsZSkge1xuXHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHR0YXJnZXRGaWxlID0gdmlldy5maWxlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBubyBmaWxlIG9yIHNhbWUgZmlsZSwgZG8gbm90aGluZ1xuXHRcdGlmICghdGFyZ2V0RmlsZSB8fCB0YXJnZXRGaWxlID09PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY3VycmVudEZpbGUgPSB0YXJnZXRGaWxlO1xuXHRcdFxuXHRcdC8vIENsZWFyIGN1cnJlbnQgY2hhdFxuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBMb2FkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGlmIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKHRhcmdldEZpbGUsIDEwKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlY2VudE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gRGlzcGxheSByZWNlbnQgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0XHRcdFx0cmVjZW50TWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuXHRcdFx0XHRcdGlmIChtc2cucm9sZSAhPT0gJ3N5c3RlbScpIHtcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZShtc2cucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JywgbXNnLmNvbnRlbnQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBmb3IgbmV3IGZpbGVcblx0XHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBjb252ZXJzYXRpb24gaGlzdG9yeTonLCBlcnJvcik7XG5cdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBvbiBlcnJvclxuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNsZWFyQ2hhdCgpIHtcblx0XHQvLyBDbGVhciB0aGUgY2hhdCBjb250YWluZXJcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBDbGVhciBjb252ZXJzYXRpb24gaW4gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbih0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNsZWFyIGNvbnZlcnNhdGlvbjonLCBlcnJvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgZnJlc2ggd2VsY29tZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYENoYXQgY2xlYXJlZCEgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShcIkNoYXQgY2xlYXJlZCEgUmVhZHkgdG8gaGVscC4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9cIik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgbm90aWNlIHRvIHVzZXJcblx0XHRuZXcgTm90aWNlKCdDaGF0IGhpc3RvcnkgY2xlYXJlZCcpO1xuXHR9XG5cblx0Ly8gUHVibGljIG1ldGhvZHMgZm9yIHRlc3Rpbmdcblx0YXN5bmMgc2VuZE1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBCdWlsZCBwcm9tcHQgdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKG1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcblx0XHQvLyBUcnkgdG8gcGFyc2UgYXMgY29tbWFuZCBmaXJzdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiBpdCdzIGEgdmFsaWQgY29tbWFuZCBhY3Rpb25cblx0XHRjb25zdCB2YWxpZEFjdGlvbnMgPSBbJ2FkZCcsICdlZGl0JywgJ2RlbGV0ZScsICdncmFtbWFyJywgJ3Jld3JpdGUnXTtcblx0XHRpZiAodmFsaWRBY3Rpb25zLmluY2x1ZGVzKGNvbW1hbmQuYWN0aW9uKSkge1xuXHRcdFx0Ly8gRXhlY3V0ZSBjb21tYW5kXG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBSZWd1bGFyIGNvbnZlcnNhdGlvblxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShhY3RpdmVGaWxlLCBtZXNzYWdlLCBudWxsIGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIENhbGwgQUkgcHJvdmlkZXJcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIHByb21wdC51c2VyUHJvbXB0KTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGFjdGl2ZUZpbGUsICdBSSByZXNwb25zZScsIHsgc3VjY2VzczogdHJ1ZSwgZWRpdFR5cGU6ICdub25lJyB9IGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkoZmlsZTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHQvLyBJbiByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGRpc3BsYXkgbWVzc2FnZXMgaW4gdGhlIFVJXG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHN0YXRpYyBwcm92aWRlciBzdGF0dXMgZm9yIENvcmUgdGllciB1c2Vyc1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVTdGF0aWNQcm92aWRlclN0YXR1cyhjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgcHJvdmlkZXJTdGF0dXMgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXItcHJvdmlkZXInIH0pO1xuXHRcdHByb3ZpZGVyU3RhdHVzLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRvcGFjaXR5OiAwLjg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJTdGF0dXNEb3QgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtZG90LXNtYWxsJyB9KTtcblx0XHRoZWFkZXJTdGF0dXNEb3Quc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiA2cHg7XG5cdFx0XHRoZWlnaHQ6IDZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGJhY2tncm91bmQ6ICM0Y2FmNTA7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJQcm92aWRlck5hbWUgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nIH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBuYW1lIGFzeW5jaHJvbm91c2x5XG5cdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpLnRoZW4obmFtZSA9PiB7XG5cdFx0XHRoZWFkZXJQcm92aWRlck5hbWUuc2V0VGV4dChuYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIFN1cGVyTm92YSB0aWVyIHVzZXJzXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZVByb3ZpZGVyRHJvcGRvd24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGNvbnN0IGRyb3Bkb3duQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tY29udGFpbmVyJyB9KTtcblx0XHRkcm9wZG93bkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgcHJvdmlkZXIgYnV0dG9uXG5cdFx0Y29uc3QgcHJvdmlkZXJCdXR0b24gPSBkcm9wZG93bkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWJ1dHRvbicgfSk7XG5cdFx0cHJvdmlkZXJCdXR0b24uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA0cHg7XG5cdFx0XHRwYWRkaW5nOiA0cHggOHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBTdGF0dXMgZG90XG5cdFx0Y29uc3Qgc3RhdHVzRG90ID0gcHJvdmlkZXJCdXR0b24uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtc3RhdHVzLWRvdC1zbWFsbCcgfSk7XG5cdFx0c3RhdHVzRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHR3aWR0aDogNnB4O1xuXHRcdFx0aGVpZ2h0OiA2cHg7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRiYWNrZ3JvdW5kOiAjNGNhZjUwO1xuXHRcdGA7XG5cblx0XHQvLyBQcm92aWRlciBuYW1lXG5cdFx0Y29uc3QgcHJvdmlkZXJOYW1lID0gcHJvdmlkZXJCdXR0b24uY3JlYXRlU3Bhbih7IHRleHQ6ICdMb2FkaW5nLi4uJyB9KTtcblxuXHRcdC8vIERyb3Bkb3duIGFycm93XG5cdFx0Y29uc3QgZHJvcGRvd25BcnJvdyA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnXHUyNUJDJyB9KTtcblx0XHRkcm9wZG93bkFycm93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IDAuNmVtO1xuXHRcdFx0bWFyZ2luLWxlZnQ6IDRweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0YDtcblxuXHRcdC8vIERyb3Bkb3duIG1lbnUgKGluaXRpYWxseSBoaWRkZW4pXG5cdFx0Y29uc3QgZHJvcGRvd25NZW51ID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1tZW51JyB9KTtcblx0XHRkcm9wZG93bk1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdHRvcDogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0bWluLXdpZHRoOiAxNTBweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xNSk7XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdG92ZXJmbG93OiBoaWRkZW47XG5cdFx0YDtcblxuXHRcdGxldCBpc0Ryb3Bkb3duT3BlbiA9IGZhbHNlO1xuXG5cdFx0Ly8gVXBkYXRlIGN1cnJlbnQgcHJvdmlkZXIgZGlzcGxheVxuXHRcdGNvbnN0IHVwZGF0ZUN1cnJlbnRQcm92aWRlciA9IGFzeW5jICgpID0+IHtcblx0XHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChjdXJyZW50UHJvdmlkZXJOYW1lKTtcblx0XHR9O1xuXG5cdFx0Ly8gVG9nZ2xlIGRyb3Bkb3duXG5cdFx0Y29uc3QgdG9nZ2xlRHJvcGRvd24gPSAoKSA9PiB7XG5cdFx0XHRpc0Ryb3Bkb3duT3BlbiA9ICFpc0Ryb3Bkb3duT3Blbjtcblx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gaXNEcm9wZG93bk9wZW4gPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSBpc0Ryb3Bkb3duT3BlbiA/ICdyb3RhdGUoMTgwZGVnKScgOiAncm90YXRlKDBkZWcpJztcblx0XHRcdFxuXHRcdFx0aWYgKGlzRHJvcGRvd25PcGVuKSB7XG5cdFx0XHRcdHRoaXMucG9wdWxhdGVQcm92aWRlckRyb3Bkb3duKGRyb3Bkb3duTWVudSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIENsb3NlIGRyb3Bkb3duIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlRHJvcGRvd24gPSAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdGlmICghZHJvcGRvd25Db250YWluZXIuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdGlzRHJvcGRvd25PcGVuID0gZmFsc2U7XG5cdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRkcm9wZG93bkFycm93LnN0eWxlLnRyYW5zZm9ybSA9ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRwcm92aWRlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0dG9nZ2xlRHJvcGRvd24oKTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBnbG9iYWwgY2xpY2sgbGlzdGVuZXJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRHJvcGRvd24pO1xuXG5cdFx0Ly8gVXBkYXRlIHByb3ZpZGVyIG5hbWUgaW5pdGlhbGx5XG5cdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIGNsZWFudXBcblx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duID0ge1xuXHRcdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyLFxuXHRcdFx0Y2xlYW51cDogKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZURyb3Bkb3duKVxuXHRcdH07XG5cdH1cblxuXHQvKipcblx0ICogUG9wdWxhdGUgcHJvdmlkZXIgZHJvcGRvd24gd2l0aCBhdmFpbGFibGUgcHJvdmlkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnU6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cblx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBhbGxvd2VkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBwcm92aWRlckl0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1pdGVtJyB9KTtcblx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgaWNvbi9kb3Rcblx0XHRcdGNvbnN0IHByb3ZpZGVyRG90ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdHByb3ZpZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHdpZHRoOiA4cHg7XG5cdFx0XHRcdGhlaWdodDogOHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGJhY2tncm91bmQ6ICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdFx0Y29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IG5hbWVTcGFuID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiBkaXNwbGF5TmFtZSB9KTtcblxuXHRcdFx0Ly8gTWFyayBjdXJyZW50IHByb3ZpZGVyXG5cdFx0XHRjb25zdCBpc0N1cnJlbnQgPSBkaXNwbGF5TmFtZSA9PT0gY3VycmVudFByb3ZpZGVyTmFtZTtcblx0XHRcdGlmIChpc0N1cnJlbnQpIHtcblx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHRuYW1lU3Bhbi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDbGljayBoYW5kbGVyXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdFx0Ly8gQ2xvc2UgZHJvcGRvd25cblx0XHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIb3ZlciBlZmZlY3Rcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBuYW1lczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnQ2xhdWRlJyxcblx0XHRcdCdvcGVuYWknOiAnT3BlbkFJJyxcblx0XHRcdCdnb29nbGUnOiAnR2VtaW5pJyxcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hJyxcblx0XHRcdCdub25lJzogJ05vbmUnXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJUeXBlXSB8fCBwcm92aWRlclR5cGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGNvbG9yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnI0QyNjkxRScsXG5cdFx0XHQnb3BlbmFpJzogJyMxMEEzN0YnLFxuXHRcdFx0J2dvb2dsZSc6ICcjNDI4NUY0Jyxcblx0XHRcdCdvbGxhbWEnOiAnIzdDM0FFRCcsXG5cdFx0XHQnbm9uZSc6ICcjOTk5J1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICcjNGNhZjUwJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgcHJvdmlkZXIgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBhIHN5c3RlbSBtZXNzYWdlIGFib3V0IHByb3ZpZGVyIHN3aXRjaGluZ1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IGBcdUQ4M0RcdUREMDQgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gO1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCBzd2l0Y2hNZXNzYWdlKTtcblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIHRoZSBwbGF0Zm9ybSBzZXR0aW5ncyB0byB1c2UgdGhlIG5ldyBwcm92aWRlclxuXHRcdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0ucHJpbWFyeVByb3ZpZGVyID0gcHJvdmlkZXJUeXBlIGFzIGFueTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZS1pbml0aWFsaXplIHRoZSBwcm92aWRlciBtYW5hZ2VyIHdpdGggbmV3IHNldHRpbmdzXG5cdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igc3dpdGNoaW5nIHByb3ZpZGVyOicsIGVycm9yKTtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgYFx1Mjc0QyBGYWlsZWQgdG8gc3dpdGNoIHRvICR7dGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSl9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNob3cgYmxvY2tlZCBtZXNzYWdlIGZvciBDb3JlIHRpZXIgbW9iaWxlIHVzZXJzXG5cdCAqL1xuXHRwcml2YXRlIHNob3dNb2JpbGVCbG9ja2VkTWVzc2FnZShjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29udGFpbmVyLmFkZENsYXNzKCdub3ZhLW1vYmlsZS1ibG9ja2VkJyk7XG5cdFx0XG5cdFx0Y29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vYmlsZS1ibG9jay1jb250YWluZXInIH0pO1xuXHRcdG1lc3NhZ2VDb250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtbW9iaWxlLWJsb2NrLWNvbnRlbnRcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmxvY2staWNvblwiPlx1RDgzRFx1REVBQjwvZGl2PlxuXHRcdFx0XHQ8aDM+TW9iaWxlIEFjY2VzcyBSZXN0cmljdGVkPC9oMz5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtdGllci1iYWRnZSBjb3JlXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLWljb25cIj5cdUQ4M0NcdUREOTM8L3NwYW4+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLW5hbWVcIj5Db3JlIChGcmVlKTwvc3Bhbj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDxwPk5vdmEgQ29yZSBpcyBkZXNpZ25lZCBmb3IgZGVza3RvcCB1c2Ugb25seS48L3A+XG5cdFx0XHRcdDxwPk1vYmlsZSBhY2Nlc3MgaXMgYXZhaWxhYmxlIHdpdGggTm92YSBTdXBlck5vdmEuPC9wPlxuXHRcdFx0XHRcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtZmVhdHVyZS1saXN0XCI+XG5cdFx0XHRcdFx0PGg0PlN1cGVyTm92YSBpbmNsdWRlczo8L2g0PlxuXHRcdFx0XHRcdDx1bD5cblx0XHRcdFx0XHRcdDxsaT5cdTI3MDUgTW9iaWxlIGRldmljZSBzdXBwb3J0PC9saT5cblx0XHRcdFx0XHRcdDxsaT5cdTI3MDUgTXVsdGlwbGUgQUkgcHJvdmlkZXJzPC9saT5cblx0XHRcdFx0XHRcdDxsaT5cdTI3MDUgSW4tY2hhdCBwcm92aWRlciBzd2l0Y2hpbmc8L2xpPlxuXHRcdFx0XHRcdFx0PGxpPlx1MjcwNSBBZHZhbmNlZCB0ZW1wbGF0ZXM8L2xpPlxuXHRcdFx0XHRcdDwvdWw+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcblx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS11cGdyYWRlLWJ0blwiPlxuXHRcdFx0XHRcdFx1MkI1MCBVcGdyYWRlIHRvIFN1cGVyTm92YVxuXHRcdFx0XHQ8L2J1dHRvbj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBBZGQgdXBncmFkZSBidXR0b24gZnVuY3Rpb25hbGl0eVxuXHRcdGNvbnN0IHVwZ3JhZGVCdG4gPSBtZXNzYWdlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXVwZ3JhZGUtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0dXBncmFkZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHdpbmRvdy5vcGVuKCdodHRwczovL25vdmF3cml0ZXIuYWkvdXBncmFkZScsICdfYmxhbmsnKTtcblx0XHR9KTtcblx0fVxufSIsICIvKipcbiAqIENvcmUgZG9jdW1lbnQgZW5naW5lIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFsbCBkb2N1bWVudCBtYW5pcHVsYXRpb24gYW5kIGVkaXRvciBpbnRlcmFjdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBURmlsZSwgRWRpdG9yUG9zaXRpb24sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50Q29udGV4dCwgSGVhZGluZ0luZm8sIEVkaXRSZXN1bHQsIEVkaXRPcHRpb25zLCBEb2N1bWVudFNlY3Rpb24sIEVkaXRDb21tYW5kIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyLCBEYXRhU3RvcmUgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIERvY3VtZW50RW5naW5lIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIGRhdGFTdG9yZT86IERhdGFTdG9yZSkge1xuICAgICAgICBpZiAoZGF0YVN0b3JlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb24pXG4gICAgICovXG4gICAgc2V0Q29udmVyc2F0aW9uTWFuYWdlcihjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IGNvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZWRpdG9yIGluc3RhbmNlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRWRpdG9yKCk6IEVkaXRvciB8IG51bGwge1xuICAgICAgICAvLyBGaXJzdCB0cnkgdGhlIHdvcmtzcGFjZSBtZXRob2RcbiAgICAgICAgY29uc3QgYWN0aXZlRWRpdG9yID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUVkaXRvcjtcbiAgICAgICAgaWYgKGFjdGl2ZUVkaXRvcj8uZWRpdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aXZlRWRpdG9yLmVkaXRvcjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIGdldCB0aGUgYWN0aXZlIG1hcmtkb3duIHZpZXdcbiAgICAgICAgbGV0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBcbiAgICAgICAgLy8gSWYgbm8gYWN0aXZlIG1hcmtkb3duIHZpZXcsIHRyeSB0byBmaW5kIGFueSBtYXJrZG93biB2aWV3XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZWFmVmlldyA9IGxlYWYudmlldztcbiAgICAgICAgICAgICAgICBpZiAobGVhZlZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldyA9IGxlYWZWaWV3O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSBkaWZmZXJlbnQgd2F5cyB0byBnZXQgdGhlIGVkaXRvclxuICAgICAgICBjb25zdCBlZGl0b3IgPSB2aWV3LmVkaXRvcjtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IgfHwgbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGl2ZSBmaWxlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRmlsZSgpOiBURmlsZSB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgZ2V0U2VsZWN0ZWRUZXh0KCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBnZXRDdXJzb3JQb3NpdGlvbigpOiBFZGl0b3JQb3NpdGlvbiB8IG51bGwge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY29tcHJlaGVuc2l2ZSBkb2N1bWVudCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KCk6IFByb21pc2U8RG9jdW1lbnRDb250ZXh0IHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIWVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHRoaXMuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5nZXRDdXJzb3JQb3NpdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBoZWFkaW5ncyBmcm9tIHRoZSBkb2N1bWVudFxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZXh0cmFjdEhlYWRpbmdzKGNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHN1cnJvdW5kaW5nIGxpbmVzIGZvciBjb250ZXh0XG4gICAgICAgIGNvbnN0IHN1cnJvdW5kaW5nTGluZXMgPSBjdXJzb3JQb3NpdGlvbiA/IFxuICAgICAgICAgICAgdGhpcy5nZXRTdXJyb3VuZGluZ0xpbmVzKGNvbnRlbnQsIGN1cnNvclBvc2l0aW9uLmxpbmUpIDogXG4gICAgICAgICAgICB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICBoZWFkaW5ncyxcbiAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogc2VsZWN0ZWRUZXh0IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGN1cnNvclBvc2l0aW9uOiBjdXJzb3JQb3NpdGlvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBzdXJyb3VuZGluZ0xpbmVzXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBoZWFkaW5ncyBmcm9tIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RIZWFkaW5ncyhjb250ZW50OiBzdHJpbmcpOiBIZWFkaW5nSW5mb1tdIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IEhlYWRpbmdJbmZvW10gPSBbXTtcbiAgICAgICAgbGV0IGNoYXJDb3VudCA9IDA7XG5cbiAgICAgICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgaWYgKGhlYWRpbmdNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gaGVhZGluZ01hdGNoWzFdLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gaGVhZGluZ01hdGNoWzJdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGhlYWRpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LFxuICAgICAgICAgICAgICAgICAgICBsZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogY2hhckNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBjaGFyQ291bnQgKyBsaW5lLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBsaW5lIGxlbmd0aCArIG5ld2xpbmUgY2hhcmFjdGVyXG4gICAgICAgICAgICBjaGFyQ291bnQgKz0gbGluZS5sZW5ndGggKyAxO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaGVhZGluZ3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGxpbmVzIHN1cnJvdW5kaW5nIHRoZSBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFN1cnJvdW5kaW5nTGluZXMoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGN1cnJlbnRMaW5lOiBudW1iZXIsIFxuICAgICAgICBjb250ZXh0U2l6ZTogbnVtYmVyID0gNVxuICAgICk6IHsgYmVmb3JlOiBzdHJpbmdbXTsgYWZ0ZXI6IHN0cmluZ1tdIH0ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3RhcnRMaW5lID0gTWF0aC5tYXgoMCwgY3VycmVudExpbmUgLSBjb250ZXh0U2l6ZSk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBjdXJyZW50TGluZSArIGNvbnRleHRTaXplKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBiZWZvcmU6IGxpbmVzLnNsaWNlKHN0YXJ0TGluZSwgY3VycmVudExpbmUpLFxuICAgICAgICAgICAgYWZ0ZXI6IGxpbmVzLnNsaWNlKGN1cnJlbnRMaW5lICsgMSwgZW5kTGluZSArIDEpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgYW4gZWRpdCB0byB0aGUgZG9jdW1lbnRcbiAgICAgKi9cbiAgICBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcG9zaXRpb246ICdjdXJzb3InIHwgJ3NlbGVjdGlvbicgfCAnZW5kJyB8IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0sXG4gICAgICAgIG9wdGlvbnM6IEVkaXRPcHRpb25zID0ge31cbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgYXBwbGllZEF0OiBFZGl0b3JQb3NpdGlvbjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnY3Vyc29yJykge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihjb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lID0gZWRpdG9yLmxhc3RMaW5lKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmVMZW5ndGggPSBlZGl0b3IuZ2V0TGluZShsYXN0TGluZSkubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGN1cnJlbnRDb250ZW50ICsgKGN1cnJlbnRDb250ZW50LmVuZHNXaXRoKCdcXG4nKSA/ICcnIDogJ1xcbicpICsgY29udGVudDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVc2UgdmF1bHQubW9kaWZ5IGZvciB1bmRvL3JlZG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IHNwZWNpZmljIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gcG9zaXRpb247XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBIYW5kbGUgcG9zdC1lZGl0IG9wdGlvbnNcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNlbGVjdE5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGFwcGxpZWRBdC5saW5lICsgY29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgY2g6IGNvbnRlbnQuaW5jbHVkZXMoJ1xcbicpID8gXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnNwbGl0KCdcXG4nKS5wb3AoKSEubGVuZ3RoIDogXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQuY2ggKyBjb250ZW50Lmxlbmd0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihhcHBsaWVkQXQsIGVuZFBvcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNjcm9sbFRvRWRpdCkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IGFwcGxpZWRBdCxcbiAgICAgICAgICAgICAgICAgICAgdG86IGFwcGxpZWRBdFxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogcG9zaXRpb24gPT09ICdzZWxlY3Rpb24nID8gJ3JlcGxhY2UnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPT09ICdlbmQnID8gJ2FwcGVuZCcgOiAnaW5zZXJ0JyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBjb250ZW50IGF0IGEgc3BlY2lmaWMgbG9jYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBkZWxldGVDb250ZW50KFxuICAgICAgICB0YXJnZXQ6ICdzZWxlY3Rpb24nIHwgJ2xpbmUnIHwgJ3NlY3Rpb24nLFxuICAgICAgICBsb2NhdGlvbj86IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJ2xpbmUnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBjdXJzb3IubGluZTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lLCBjaDogMCB9LCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBsaW5lICsgMSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJ3NlY3Rpb24nICYmIGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZmluZFNlY3Rpb24obG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIGlmICghc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2xvY2F0aW9ufVwiIG5vdCBmb3VuZGAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBzZWN0aW9uIGluY2x1ZGluZyBpdHMgaGVhZGluZ1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmVzID0gbGluZXMuZmlsdGVyKChfLCBpbmRleCkgPT4gXG4gICAgICAgICAgICAgICAgICAgIGluZGV4IDwgc2VjdGlvbi5yYW5nZS5zdGFydCB8fCBpbmRleCA+IHNlY3Rpb24ucmFuZ2UuZW5kXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3TGluZXMuam9pbignXFxuJykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmU6IHNlY3Rpb24ucmFuZ2Uuc3RhcnQsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgYSBzZWN0aW9uIGJ5IGhlYWRpbmcgbmFtZVxuICAgICAqL1xuICAgIGFzeW5jIGZpbmRTZWN0aW9uKGhlYWRpbmdUZXh0OiBzdHJpbmcpOiBQcm9taXNlPERvY3VtZW50U2VjdGlvbiB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghY29udGV4dCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgaGVhZGluZ0luZGV4ID0gY29udGV4dC5oZWFkaW5ncy5maW5kSW5kZXgoaCA9PiBcbiAgICAgICAgICAgIGgudGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGhlYWRpbmdUZXh0LnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKGhlYWRpbmdJbmRleCA9PT0gLTEpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IGhlYWRpbmcgPSBjb250ZXh0LmhlYWRpbmdzW2hlYWRpbmdJbmRleF07XG4gICAgICAgIGNvbnN0IG5leHRIZWFkaW5nID0gY29udGV4dC5oZWFkaW5nc1toZWFkaW5nSW5kZXggKyAxXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgZW5kTGluZSA9IG5leHRIZWFkaW5nID8gbmV4dEhlYWRpbmcubGluZSAtIDEgOiBsaW5lcy5sZW5ndGggLSAxO1xuXG4gICAgICAgIC8vIEV4dHJhY3Qgc2VjdGlvbiBjb250ZW50IChleGNsdWRpbmcgdGhlIGhlYWRpbmcgbGluZSlcbiAgICAgICAgY29uc3Qgc2VjdGlvbkxpbmVzID0gbGluZXMuc2xpY2UoaGVhZGluZy5saW5lICsgMSwgZW5kTGluZSArIDEpO1xuICAgICAgICBjb25zdCBzZWN0aW9uQ29udGVudCA9IHNlY3Rpb25MaW5lcy5qb2luKCdcXG4nKS50cmltKCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhlYWRpbmc6IGhlYWRpbmcudGV4dCxcbiAgICAgICAgICAgIGxldmVsOiBoZWFkaW5nLmxldmVsLFxuICAgICAgICAgICAgY29udGVudDogc2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICByYW5nZToge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBoZWFkaW5nLmxpbmUsXG4gICAgICAgICAgICAgICAgZW5kOiBlbmRMaW5lXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBmdWxsIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBnZXREb2N1bWVudENvbnRlbnQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIHRoZSBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIGFzeW5jIHNldERvY3VtZW50Q29udGVudChjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENvbnZlcnNhdGlvbiBtYW5hZ2VtZW50IG1ldGhvZHNcblxuICAgIC8qKlxuICAgICAqIEFkZCB1c2VyIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkVXNlck1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBjb21tYW5kPzogRWRpdENvbW1hbmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShmaWxlLCBjb250ZW50LCBjb21tYW5kKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhc3Npc3RhbnQgcmVzcG9uc2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShjb250ZW50OiBzdHJpbmcsIHJlc3VsdD86IEVkaXRSZXN1bHQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGZpbGUsIGNvbnRlbnQsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgc3lzdGVtIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkU3lzdGVtTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRTeXN0ZW1NZXNzYWdlKGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGUsIG1heE1lc3NhZ2VzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyQ29udmVyc2F0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmNsZWFyQ29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25TdGF0cygpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBzdHJpbmcgfCBudWxsO1xuICAgICAgICBjb252ZXJzYXRpb25BZ2U6IG51bWJlcjtcbiAgICB9IHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0U3RhdHMoZmlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgY3VycmVudCBmaWxlIGhhcyBhbiBhY3RpdmUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgaGFzQ29udmVyc2F0aW9uKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuaGFzQ29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbigpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5leHBvcnRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgfVxufSIsICIvKipcbiAqIENvbnZlcnNhdGlvbiBNYW5hZ2VyIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGZpbGUtc2NvcGVkIGNvbnZlcnNhdGlvbiBzdG9yYWdlIGFuZCByZXRyaWV2YWxcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbkRhdGEsIENvbnZlcnNhdGlvbk1lc3NhZ2UsIEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0LCBFZGl0QWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVN0b3JlIHtcbiAgICBsb2FkRGF0YShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PjtcbiAgICBzYXZlRGF0YShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbk1hbmFnZXIge1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uczogTWFwPHN0cmluZywgQ29udmVyc2F0aW9uRGF0YT4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBtYXhNZXNzYWdlc1BlckZpbGUgPSAxMDA7IC8vIExpbWl0IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgcHJpdmF0ZSBzdG9yYWdlS2V5ID0gJ25vdmEtY29udmVyc2F0aW9ucyc7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRhdGFTdG9yZTogRGF0YVN0b3JlKSB7XG4gICAgICAgIHRoaXMubG9hZENvbnZlcnNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGNvbnZlcnNhdGlvbnMgZnJvbSBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5kYXRhU3RvcmUubG9hZERhdGEodGhpcy5zdG9yYWdlS2V5KTtcbiAgICAgICAgICAgIGlmIChkYXRhICYmIEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbnZlcnNhdGlvbiBvZiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQoY29udmVyc2F0aW9uLmZpbGVQYXRoLCBjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGRhdGE6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSBjb252ZXJzYXRpb25zIHRvIHBsdWdpbiBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlQ29udmVyc2F0aW9ucygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbnNBcnJheSA9IEFycmF5LmZyb20odGhpcy5jb252ZXJzYXRpb25zLnZhbHVlcygpKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGF0YVN0b3JlLnNhdmVEYXRhKHRoaXMuc3RvcmFnZUtleSwgY29udmVyc2F0aW9uc0FycmF5KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzYXZlIGNvbnZlcnNhdGlvbiBkYXRhOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gZm9yIGEgc3BlY2lmaWMgZmlsZVxuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IENvbnZlcnNhdGlvbkRhdGEge1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgXG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25zLmhhcyhmaWxlUGF0aCkpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgY29udmVyc2F0aW9uIGZvciB0aGlzIGZpbGVcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbnZlcnNhdGlvbjogQ29udmVyc2F0aW9uRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdENvdW50OiAwLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kRnJlcXVlbmN5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJld3JpdGU6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGZpbGVQYXRoLCBuZXdDb252ZXJzYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZVBhdGgpITtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSB1c2VyIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIGNvbW1hbmRcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBVcGRhdGUgY29tbWFuZCBmcmVxdWVuY3kgaWYgY29tbWFuZCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZCAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5W2NvbW1hbmQuYWN0aW9uXSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gYXNzaXN0YW50IHJlc3BvbnNlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSxcbiAgICAgICAgY29udGVudDogc3RyaW5nLFxuICAgICAgICByZXN1bHQ/OiBFZGl0UmVzdWx0XG4gICAgKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICByZXN1bHRcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBJbmNyZW1lbnQgZWRpdCBjb3VudCBpZiByZXN1bHQgaW5kaWNhdGVzIHN1Y2Nlc3NmdWwgZWRpdFxuICAgICAgICBpZiAocmVzdWx0Py5zdWNjZXNzICYmIGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmVkaXRDb3VudCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBzeXN0ZW0gbWVzc2FnZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkU3lzdGVtTWVzc2FnZShmaWxlOiBURmlsZSwgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCByZWNlbnQgbWVzc2FnZXMgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRSZWNlbnRNZXNzYWdlcyhmaWxlOiBURmlsZSwgY291bnQ6IG51bWJlciA9IDEwKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLWNvdW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbWVzc2FnZXMgYnkgcm9sZVxuICAgICAqL1xuICAgIGdldE1lc3NhZ2VzQnlSb2xlKGZpbGU6IFRGaWxlLCByb2xlOiBDb252ZXJzYXRpb25NZXNzYWdlWydyb2xlJ10pOiBDb252ZXJzYXRpb25NZXNzYWdlW10ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5yb2xlID09PSByb2xlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGU6IFRGaWxlLCBtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0TGluZXMgPSBtZXNzYWdlcy5tYXAobXNnID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZygpO1xuICAgICAgICAgICAgbGV0IGxpbmUgPSBgWyR7dGltZXN0YW1wfV0gJHttc2cucm9sZS50b1VwcGVyQ2FzZSgpfTogJHttc2cuY29udGVudH1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobXNnLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKENvbW1hbmQ6ICR7bXNnLmNvbW1hbmQuYWN0aW9ufSAke21zZy5jb21tYW5kLnRhcmdldH0pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKFJlc3VsdDogJHttc2cucmVzdWx0LnN1Y2Nlc3MgPyAnc3VjY2VzcycgOiAnZmFpbGVkJ30pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBgUHJldmlvdXMgY29udmVyc2F0aW9uOlxcbiR7Y29udGV4dExpbmVzLmpvaW4oJ1xcbicpfVxcbmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gW107XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50ID0gMDtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5ID0ge1xuICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgIHJld3JpdGU6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzXG4gICAgICovXG4gICAgZ2V0U3RhdHMoZmlsZTogVEZpbGUpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgbWF4Q291bnQgPSAwO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBbYWN0aW9uLCBjb3VudF0gb2YgT2JqZWN0LmVudHJpZXMoY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kID0gYWN0aW9uIGFzIEVkaXRBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IERhdGUubm93KCkgLSBjb252ZXJzYXRpb24ubWVzc2FnZXNbMF0udGltZXN0YW1wXG4gICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2VDb3VudDogY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCxcbiAgICAgICAgICAgIGVkaXRDb3VudDogY29udmVyc2F0aW9uLm1ldGFkYXRhPy5lZGl0Q291bnQgfHwgMCxcbiAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkFnZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBvbGQgY29udmVyc2F0aW9ucyB0byBtYW5hZ2UgbWVtb3J5XG4gICAgICovXG4gICAgYXN5bmMgY2xlYW51cE9sZENvbnZlcnNhdGlvbnMobWF4QWdlOiBudW1iZXIgPSA3ICogMjQgKiA2MCAqIDYwICogMTAwMCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGxldCByZW1vdmVkQ291bnQgPSAwO1xuXG4gICAgICAgIGZvciAoY29uc3QgW2ZpbGVQYXRoLCBjb252ZXJzYXRpb25dIG9mIHRoaXMuY29udmVyc2F0aW9ucy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIGlmIChub3cgLSBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPiBtYXhBZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICByZW1vdmVkQ291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZW1vdmVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVtb3ZlZENvdW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb25zdCBsaW5lcyA9IFtgIyBDb252ZXJzYXRpb24gSGlzdG9yeSBmb3IgJHtmaWxlLm5hbWV9YCwgJyddO1xuXG4gICAgICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBjb252ZXJzYXRpb24ubWVzc2FnZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1lc3NhZ2UudGltZXN0YW1wKS50b0xvY2FsZVN0cmluZygpO1xuICAgICAgICAgICAgbGluZXMucHVzaChgIyMgJHttZXNzYWdlLnJvbGUudG9VcHBlckNhc2UoKX0gKCR7dGltZXN0YW1wfSlgKTtcbiAgICAgICAgICAgIGxpbmVzLnB1c2gobWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuY29tbWFuZCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpDb21tYW5kOiAke21lc3NhZ2UuY29tbWFuZC5hY3Rpb259ICR7bWVzc2FnZS5jb21tYW5kLnRhcmdldH0qYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpSZXN1bHQ6ICR7bWVzc2FnZS5yZXN1bHQuc3VjY2VzcyA/ICdTdWNjZXNzJyA6ICdGYWlsZWQnfSpgKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS5yZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkVycm9yOiAke21lc3NhZ2UucmVzdWx0LmVycm9yfSpgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxpbmVzLnB1c2goJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBtZXNzYWdlIElEXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZU1lc3NhZ2VJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYG1zZ18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpbSBjb252ZXJzYXRpb24gdG8gbWF4IGxlbmd0aCBhbmQgc2F2ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgdHJpbUFuZFNhdmUoY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb25EYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpIHtcbiAgICAgICAgICAgIC8vIEtlZXAgdGhlIG1vc3QgcmVjZW50IG1lc3NhZ2VzXG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLXRoaXMubWF4TWVzc2FnZXNQZXJGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgY29udmVyc2F0aW9uIGZpbGUgcGF0aHNcbiAgICAgKi9cbiAgICBnZXRBbGxDb252ZXJzYXRpb25GaWxlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy5rZXlzKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGZpbGUgaGFzIGFjdGl2ZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBoYXNDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChmaWxlLnBhdGgpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uID8gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgOiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgY29udmVyc2F0aW9uIGZpbGUgcGF0aCAoZm9yIGZpbGUgcmVuYW1lcylcbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVGaWxlUGF0aChvbGRQYXRoOiBzdHJpbmcsIG5ld1BhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KG9sZFBhdGgpO1xuICAgICAgICBpZiAoY29udmVyc2F0aW9uKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24uZmlsZVBhdGggPSBuZXdQYXRoO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShvbGRQYXRoKTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQobmV3UGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBDb250ZXh0IGJ1aWxkZXIgZm9yIE5vdmFcbiAqIEdlbmVyYXRlcyBhcHByb3ByaWF0ZSBwcm9tcHRzIGZvciBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIERvY3VtZW50U2VjdGlvbiwgUHJvbXB0Q29uZmlnLCBDb252ZXJzYXRpb25NZXNzYWdlIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogR2VuZXJhdGVkIHByb21wdCBmb3IgQUkgY29tcGxldGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlZFByb21wdCB7XG4gICAgLyoqIFN5c3RlbSBwcm9tcHQgZm9yIEFJIGNvbnRleHQgKi9cbiAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogVXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnMgKi9cbiAgICB1c2VyUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEFkZGl0aW9uYWwgY29udGV4dCBmb3IgdGhlIEFJICovXG4gICAgY29udGV4dDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBDb25maWd1cmF0aW9uIGZvciBBSSBnZW5lcmF0aW9uICovXG4gICAgY29uZmlnOiB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gICAgICAgIG1heFRva2VuczogbnVtYmVyO1xuICAgIH07XG59XG5cbi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBnZW5lcmF0aW5nIEFJIHByb21wdHNcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGRlZmF1bHRDb25maWc6IFByb21wdENvbmZpZyA9IHtcbiAgICAgICAgbWF4Q29udGV4dExpbmVzOiAyMCxcbiAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogdHJ1ZSxcbiAgICAgICAgaW5jbHVkZUhpc3Rvcnk6IGZhbHNlLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHNwZWNpZmljIGNvbW1hbmRcbiAgICAgKi9cbiAgICBidWlsZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fSxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHsgLi4udGhpcy5kZWZhdWx0Q29uZmlnLCAuLi5vcHRpb25zIH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSB0aGlzLmJ1aWxkU3lzdGVtUHJvbXB0KGNvbW1hbmQuYWN0aW9uLCBjb25maWcpO1xuICAgICAgICBjb25zdCBjb250ZXh0SW5mbyA9IHRoaXMuYnVpbGRDb250ZXh0SW5mbyhkb2N1bWVudENvbnRleHQsIGNvbW1hbmQsIGNvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgIGNvbnN0IHVzZXJQcm9tcHQgPSB0aGlzLmJ1aWxkVXNlclByb21wdChjb21tYW5kLCBjb250ZXh0SW5mbyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHRJbmZvLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IGNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBjb25maWcubWF4VG9rZW5zIHx8IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzeXN0ZW0gcHJvbXB0IGJhc2VkIG9uIGFjdGlvbiB0eXBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFN5c3RlbVByb21wdChhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSwgY29uZmlnOiBQcm9tcHRDb25maWcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBiYXNlUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyIHRoYXQgaGVscHMgdXNlcnMgZWRpdCBkb2N1bWVudHMgZGlyZWN0bHkuIFlvdSB3b3JrIHdpdGggTWFya2Rvd24gZG9jdW1lbnRzIGluIE9ic2lkaWFuLlxuXG5JTVBPUlRBTlQgR1VJREVMSU5FUzpcbi0gUHJvdmlkZSBPTkxZIHRoZSBjb250ZW50IHRvIGJlIGluc2VydGVkL21vZGlmaWVkLCBubyBleHBsYW5hdGlvbnMgb3IgbWV0YS10ZXh0XG4tIE1haW50YWluIHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIHN0eWxlIGFuZCB0b25lIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIFByZXNlcnZlIGZvcm1hdHRpbmcsIHN0cnVjdHVyZSwgYW5kIG1hcmtkb3duIHN5bnRheFxuLSBCZSBjb25jaXNlIGFuZCBmb2N1c2VkIG9uIHRoZSBzcGVjaWZpYyByZXF1ZXN0XG4tIERvIG5vdCBhZGQgc2VjdGlvbiBoZWFkZXJzIHVubGVzcyBzcGVjaWZpY2FsbHkgcmVxdWVzdGVkYDtcblxuICAgICAgICBjb25zdCBhY3Rpb25TcGVjaWZpY1Byb21wdHMgPSB7XG4gICAgICAgICAgICBhZGQ6IGBcblRBU0s6IEFkZCBuZXcgY29udGVudCB0byB0aGUgZG9jdW1lbnQuXG4tIENyZWF0ZSB3ZWxsLXN0cnVjdHVyZWQsIHJlbGV2YW50IGNvbnRlbnQgdGhhdCBmaXRzIHRoZSBkb2N1bWVudCdzIHB1cnBvc2Vcbi0gVXNlIGFwcHJvcHJpYXRlIG1hcmtkb3duIGZvcm1hdHRpbmcgKGhlYWRpbmdzLCBsaXN0cywgZW1waGFzaXMpXG4tIEVuc3VyZSBzbW9vdGggZmxvdyB3aXRoIGV4aXN0aW5nIGNvbnRlbnRcbi0gTWF0Y2ggdGhlIGRvY3VtZW50J3Mgc3R5bGUgYW5kIHRvbmVgLFxuXG4gICAgICAgICAgICBlZGl0OiBgXG5UQVNLOiBFZGl0IGFuZCBpbXByb3ZlIGV4aXN0aW5nIGNvbnRlbnQuXG4tIEVuaGFuY2UgY2xhcml0eSwgcmVhZGFiaWxpdHksIGFuZCBmbG93XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBtZWFuaW5nIHVubGVzcyBjaGFuZ2VzIGFyZSByZXF1ZXN0ZWRcbi0gSW1wcm92ZSB3b3JkIGNob2ljZSBhbmQgc2VudGVuY2Ugc3RydWN0dXJlXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCBmb3JtYXR0aW5nIGFuZCBzdHJ1Y3R1cmVgLFxuXG4gICAgICAgICAgICBkZWxldGU6IGBcblRBU0s6IFJlbW92ZSBzcGVjaWZpZWQgY29udGVudCBmcm9tIHRoZSBkb2N1bWVudC5cbi0gSWRlbnRpZnkgdGhlIGV4YWN0IGNvbnRlbnQgdG8gYmUgcmVtb3ZlZFxuLSBFbnN1cmUgcmVtYWluaW5nIGNvbnRlbnQgZmxvd3MgbmF0dXJhbGx5XG4tIFByZXNlcnZlIGRvY3VtZW50IHN0cnVjdHVyZSBhbmQgZm9ybWF0dGluZ1xuLSBDb25maXJtIHRoZSBkZWxldGlvbiBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIGNvbnRleHRgLFxuXG4gICAgICAgICAgICBncmFtbWFyOiBgXG5UQVNLOiBGaXggZ3JhbW1hciwgc3BlbGxpbmcsIGFuZCBsYW5ndWFnZSBpc3N1ZXMuXG4tIENvcnJlY3Qgc3BlbGxpbmcgZXJyb3JzLCBncmFtbWFyIG1pc3Rha2VzLCBhbmQgdHlwb3Ncbi0gSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUgYW5kIGNsYXJpdHlcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIHZvaWNlIGFuZCBzdHlsZVxuLSBQcmVzZXJ2ZSBhbGwgZm9ybWF0dGluZyBhbmQgbWFya2Rvd24gc3ludGF4XG4tIE1ha2UgbWluaW1hbCBjaGFuZ2VzIC0gb25seSBmaXggYWN0dWFsIGVycm9yc2AsXG5cbiAgICAgICAgICAgIHJld3JpdGU6IGBcblRBU0s6IFJld3JpdGUgb3IgcmVzdHJ1Y3R1cmUgY29udGVudC5cbi0gQ3JlYXRlIG5ldyBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2Vcbi0gSW1wcm92ZSBvcmdhbml6YXRpb24sIGNsYXJpdHksIGFuZCBmbG93XG4tIFVzZSBtb3JlIGVmZmVjdGl2ZSBsYW5ndWFnZSBhbmQgc3RydWN0dXJlXG4tIE1haW50YWluIGtleSBpbmZvcm1hdGlvbiBhbmQgY29uY2VwdHNcbi0gQWRhcHQgdG8gYW55IHNwZWNpZmllZCBzdHlsZSByZXF1aXJlbWVudHNgXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGJhc2VQcm9tcHQgKyBhY3Rpb25TcGVjaWZpY1Byb21wdHNbYWN0aW9uXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCB1c2VyIHByb21wdCB3aXRoIHNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRVc2VyUHJvbXB0KGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBjb250ZXh0SW5mbzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHByb21wdCA9IGAke2NvbnRleHRJbmZvfVxcblxcblVTRVIgUkVRVUVTVDogJHtjb21tYW5kLmluc3RydWN0aW9ufWA7XG5cbiAgICAgICAgLy8gQWRkIHNwZWNpZmljIGNvbnRleHQgaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQuY29udGV4dCAmJiBjb21tYW5kLmNvbnRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbkFERElUSU9OQUwgUkVRVUlSRU1FTlRTOiAke2NvbW1hbmQuY29udGV4dH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRhcmdldC1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgICAgY29uc3QgdGFyZ2V0SW5zdHJ1Y3Rpb25zID0gdGhpcy5nZXRUYXJnZXRJbnN0cnVjdGlvbnMoY29tbWFuZCk7XG4gICAgICAgIGlmICh0YXJnZXRJbnN0cnVjdGlvbnMpIHtcbiAgICAgICAgICAgIHByb21wdCArPSBgXFxuXFxuJHt0YXJnZXRJbnN0cnVjdGlvbnN9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBhY3Rpb24tc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICAgIGNvbnN0IGFjdGlvbkluc3RydWN0aW9ucyA9IHRoaXMuZ2V0QWN0aW9uSW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuICAgICAgICBpZiAoYWN0aW9uSW5zdHJ1Y3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbiR7YWN0aW9uSW5zdHJ1Y3Rpb25zfWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0YXJnZXQtc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRUYXJnZXRJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IFdvcmsgd2l0aCB0aGUgc2VsZWN0ZWQgdGV4dCBvbmx5LiBQcm92aWRlIHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBzZWxlY3RlZCBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgRk9DVVM6IFdvcmsgd2l0aCB0aGUgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbi4gJHtjb21tYW5kLmFjdGlvbiA9PT0gJ2FkZCcgPyAnQWRkIGNvbnRlbnQgdG8gdGhpcyBzZWN0aW9uLicgOiAnTW9kaWZ5IG9ubHkgdGhpcyBzZWN0aW9uLid9YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogV29yayB3aXRoIHRoZSBjdXJyZW50IHNlY3Rpb24uJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IEFwcGx5IGNoYW5nZXMgdG8gdGhlIGVudGlyZSBkb2N1bWVudCB3aGlsZSBwcmVzZXJ2aW5nIGl0cyBzdHJ1Y3R1cmUuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBBZGQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudC4gRW5zdXJlIGl0IGZsb3dzIG5hdHVyYWxseSBmcm9tIGV4aXN0aW5nIGNvbnRlbnQuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBXb3JrIHdpdGggdGhlIGN1cnJlbnQgcGFyYWdyYXBoIG9yIGNyZWF0ZSBhIG5ldyBwYXJhZ3JhcGguJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYWN0aW9uLXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0QWN0aW9uSW5zdHJ1Y3Rpb25zKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBuZXcgY29udGVudCB0byBiZSBhZGRlZC4gSW5jbHVkZSBhcHByb3ByaWF0ZSBoZWFkaW5ncyBpZiBhZGRpbmcgYSBzZWN0aW9uLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGltcHJvdmVkIHZlcnNpb24gb2YgdGhlIGNvbnRlbnQuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogQ29uZmlybSB3aGF0IHNob3VsZCBiZSBkZWxldGVkIGJ5IHByb3ZpZGluZyB0aGUgZXhhY3QgdGV4dCB0byByZW1vdmUsIG9yIHJlc3BvbmQgXCJDT05GSVJNRURcIiBpZiB0aGUgZGVsZXRpb24gaXMgY2xlYXIuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgY29ycmVjdGVkIHRleHQgd2l0aCBncmFtbWFyIGFuZCBzcGVsbGluZyBmaXhlcy4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSB0aGUgY29tcGxldGVseSByZXdyaXR0ZW4gY29udGVudCB0aGF0IHNlcnZlcyB0aGUgc2FtZSBwdXJwb3NlLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29udGV4dCBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb21wdFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRDb250ZXh0SW5mbyhcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBjb25maWc6IFByb21wdENvbmZpZyxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gYERPQ1VNRU5UOiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGUgYW5kIHJlcXVlc3RlZFxuICAgICAgICBpZiAoY29uZmlnLmluY2x1ZGVIaXN0b3J5ICYmIGNvbnZlcnNhdGlvbkNvbnRleHQgJiYgY29udmVyc2F0aW9uQ29udGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbiR7Y29udmVyc2F0aW9uQ29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IHN0cnVjdHVyZSBpZiByZXF1ZXN0ZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlU3RydWN0dXJlICYmIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5ET0NVTUVOVCBTVFJVQ1RVUkU6XFxuJztcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGVudCA9ICcgICcucmVwZWF0KGhlYWRpbmcubGV2ZWwgLSAxKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBzZWxlY3RlZCB0ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcblNFTEVDVEVEIFRFWFQ6XFxuJHtkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVsZXZhbnQgY29udGV4dCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IHRoaXMuZmluZFNlY3Rpb25JbkNvbnRlbnQoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5DVVJSRU5UIFNFQ1RJT04gXCIke2NvbW1hbmQubG9jYXRpb259XCI6XFxuJHtzZWN0aW9ufVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdwYXJhZ3JhcGgnICYmIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5DVVJSRU5UIENPTlRFWFQ6XFxuJztcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYEJlZm9yZTogJHtkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUuam9pbignICcpfVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYWZ0ZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYEFmdGVyOiAke2RvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJyAnKX1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGxpbWl0ZWQgZG9jdW1lbnQgY29udGVudCBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBjb250ZW50TGluZXMgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGlmIChjb250ZW50TGluZXMubGVuZ3RoID4gY29uZmlnLm1heENvbnRleHRMaW5lcykge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heCgwLCBjb250ZW50TGluZXMubGVuZ3RoIC0gY29uZmlnLm1heENvbnRleHRMaW5lcyk7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5SRUNFTlQgQ09OVEVOVCAobGFzdCAke2NvbmZpZy5tYXhDb250ZXh0TGluZXN9IGxpbmVzKTpcXG5gO1xuICAgICAgICAgICAgY29udGV4dCArPSBjb250ZW50TGluZXMuc2xpY2Uoc3RhcnQpLmpvaW4oJ1xcbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuRlVMTCBET0NVTUVOVDpcXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc3BlY2lmaWMgc2VjdGlvbiBpbiBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBmaW5kU2VjdGlvbkluQ29udGVudChjb250ZW50OiBzdHJpbmcsIHNlY3Rpb25OYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFNlY3Rpb25OYW1lID0gc2VjdGlvbk5hbWUudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgc2VjdGlvblN0YXJ0ID0gLTE7XG4gICAgICAgIGxldCBzZWN0aW9uTGV2ZWwgPSAwO1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgc2VjdGlvbiBoZWFkaW5nXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaGVhZGluZ01hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRpbmcgPSBoZWFkaW5nTWF0Y2hbMl0udG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGhlYWRpbmcgPT09IG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSB8fCBoZWFkaW5nLmluY2x1ZGVzKG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvblN0YXJ0ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbkxldmVsID0gbGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHNlY3Rpb25TdGFydCA9PT0gLTEpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uXG4gICAgICAgIGxldCBzZWN0aW9uRW5kID0gbGluZXMubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpID0gc2VjdGlvblN0YXJ0ICsgMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrLyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2ggJiYgaGVhZGluZ01hdGNoWzFdLmxlbmd0aCA8PSBzZWN0aW9uTGV2ZWwpIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uRW5kID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGxpbmVzLnNsaWNlKHNlY3Rpb25TdGFydCwgc2VjdGlvbkVuZCkuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIuIFByb3ZpZGUgaGVscGZ1bCwgY29uY2lzZSByZXNwb25zZXMgdG8gdXNlciByZXF1ZXN0cy4gRm9jdXMgb24gYmVpbmcgcHJhY3RpY2FsIGFuZCBhY3Rpb25hYmxlLmA7XG4gICAgICAgIFxuICAgICAgICBsZXQgdXNlclByb21wdCA9IGluc3RydWN0aW9uO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBDb250ZXh0OiAke2NvbnRleHR9XFxuXFxuUmVxdWVzdDogJHtpbnN0cnVjdGlvbn1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0IHx8ICcnLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDUwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgKi9cbiAgICBidWlsZENvbnZlcnNhdGlvblByb21wdChcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ/OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdXG4gICAgKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgbGV0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIHdpdGggdGhlaXIgZG9jdW1lbnRzLiBZb3UgY2FuOlxuLSBBbnN3ZXIgcXVlc3Rpb25zIGFib3V0IHdyaXRpbmcgYW5kIGVkaXRpbmdcbi0gUHJvdmlkZSBzdWdnZXN0aW9ucyBmb3IgaW1wcm92ZW1lbnRcbi0gSGVscCBwbGFuIGRvY3VtZW50IHN0cnVjdHVyZVxuLSBBc3Npc3Qgd2l0aCByZXNlYXJjaCBhbmQgY29udGVudCBkZXZlbG9wbWVudFxuXG5CZSBoZWxwZnVsLCBjb25jaXNlLCBhbmQgcHJhY3RpY2FsIGluIHlvdXIgcmVzcG9uc2VzLmA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBtZXNzYWdlO1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBDdXJyZW50IGRvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9ICdEb2N1bWVudCBzdHJ1Y3R1cmU6XFxuJztcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgIGlmIChyZWNlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1xcblJlY2VudCBjb252ZXJzYXRpb246XFxuJztcbiAgICAgICAgICAgIHJlY2VudEhpc3Rvcnkuc2xpY2UoLTMpLmZvckVhY2gobXNnID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobXNnLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBZb3U6ICR7bXNnLmNvbnRlbnR9XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5yb2xlID09PSAnYXNzaXN0YW50Jykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBOb3ZhOiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGAke2NvbnRleHR9XFxuXFxuQ3VycmVudCBtZXNzYWdlOiAke21lc3NhZ2V9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjgsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiA4MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBlc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0aW9uOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgICAgICBjb25zdCB0b3RhbFRleHQgPSBwcm9tcHQuc3lzdGVtUHJvbXB0ICsgcHJvbXB0LnVzZXJQcm9tcHQgKyBwcm9tcHQuY29udGV4dDtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcHJvbXB0IGdlbmVyYXRpb25cbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKGBQcm9tcHQgaXMgdG9vIGxvbmcgKCR7dG9rZW5Db3VudH0gdG9rZW5zLCBtYXggODAwMClgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1RlbXBlcmF0dXJlIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdNYXggdG9rZW5zIG11c3QgYmUgYmV0d2VlbiAxMCBhbmQgNDAwMCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgaXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIENvbW1hbmQgcGFyc2VyIGZvciBOb3ZhXG4gKiBDb252ZXJ0cyBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gc3RydWN0dXJlZCBFZGl0Q29tbWFuZCBvYmplY3RzXG4gKi9cblxuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRBY3Rpb24gfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQYXR0ZXJucyBmb3IgZGV0ZWN0aW5nIGRpZmZlcmVudCBjb21tYW5kIHR5cGVzXG4gKi9cbmludGVyZmFjZSBDb21tYW5kUGF0dGVybiB7XG4gICAgYWN0aW9uOiBFZGl0QWN0aW9uO1xuICAgIHBhdHRlcm5zOiBSZWdFeHBbXTtcbiAgICB0YXJnZXRzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBDb21tYW5kIHBhcnNpbmcgcnVsZXNcbiAqL1xuY29uc3QgQ09NTUFORF9QQVRURVJOUzogQ29tbWFuZFBhdHRlcm5bXSA9IFtcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2dyYW1tYXInLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihncmFtbWFyfHNwZWxsfHNwZWxsaW5nfHByb29mcmVhZHxwb2xpc2gpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY2hlY2tcXGIuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGdyYW1tYXRpY2FsfGNvcnJlY3R8cHJvcGVyKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmZpeFxccysuKlxcYihncmFtbWFyfGVycm9yc3xtaXN0YWtlc3x0eXBvcylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJjb3JyZWN0XFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nLCAnZG9jdW1lbnQnLCAncGFyYWdyYXBoJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAncmV3cml0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHJld3JpdGV8cmV3b3JkfHJlcGhyYXNlfHJlc3RydWN0dXJlfHJlb3JnYW5pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxid3JpdGVcXHMrLipcXGIobmV3fGRpZmZlcmVudHxhbHRlcm5hdGl2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnLCAnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZGVsZXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGV8Y3V0fGVyYXNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdldFxccytyaWRcXHMrb2ZcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ0YWtlXFxzK291dFxcYi9pLFxuICAgICAgICAgICAgL1xcYmRyb3BcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxwYXJ0KVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ3NlY3Rpb24nLCAnbGluZSddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2FkZCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGUpXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8aGVhZGluZ3xjb250ZW50fHRleHR8cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnQpXFxiKD8hXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzcylcXGIpL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9ufHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXGIuKlxcYihzZWN0aW9ufGNvbnRlbnR8dGV4dClcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2VuZCcsICdzZWN0aW9uJywgJ3BhcmFncmFwaCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2VkaXQnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihlZGl0fG1vZGlmeXxjaGFuZ2V8dXBkYXRlfHJldmlzZXxpbXByb3ZlfGVuaGFuY2UpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihiZXR0ZXJ8Y2xlYXJlcnxtb3JlfGxlc3N8Zm9ybWFsfHByb2Zlc3Npb25hbHxkZXRhaWxlZHxjb21wcmVoZW5zaXZlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihmaXh8Y29ycmVjdHxhZGp1c3QpXFxiKD8hLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiKS9pLFxuICAgICAgICAgICAgL1xcYihleHBhbmR8c2hvcnRlbnxjb25kZW5zZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbicsICdzZWN0aW9uJywgJ3BhcmFncmFwaCddXG4gICAgfVxuXTtcblxuLyoqXG4gKiBMb2NhdGlvbiBleHRyYWN0aW9uIHBhdHRlcm5zXG4gKi9cbmNvbnN0IExPQ0FUSU9OX1BBVFRFUk5TID0gW1xuICAgIC9cXGIoPzp0b3xpbnxhdHx1bmRlcnx3aXRoaW58aW5zaWRlKVxccysoPzp0aGVcXHMrKT9bXCInXShbXlwiJ10rPylbXCInXVxccysoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSxcbiAgICAvXFxiKD86dGhlXFxzKyk/W1wiJ10oW15cIiddKz8pW1wiJ11cXHMrKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpL2ksXG4gICAgL1xcYig/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KVxccytbXCInXShbXlwiJ10rPylbXCInXS9pLFxuICAgIC9cXGIoPzpzZWN0aW9ufGhlYWRpbmcpXFxzKyg/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OnRoZVxccyspPyhbYS16QS1aXVthLXpBLVpcXHMmXSo/KVxccysoPzpzZWN0aW9ufGhlYWRpbmcpXFxiL2lcbl07XG5cbi8qKlxuICogVGFyZ2V0IHR5cGUgZGV0ZWN0aW9uIHBhdHRlcm5zXG4gKi9cbmNvbnN0IFRBUkdFVF9QQVRURVJOUyA9IFtcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWxlY3RlZHxoaWdobGlnaHRlZHxjaG9zZW4pXFxzKyg/OnRleHR8Y29udGVudCkvaSwgdGFyZ2V0OiAnc2VsZWN0aW9uJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OnRoaXN8Y3VycmVudHxzZWxlY3RlZClcXHMrKD86cGFyYWdyYXBofGxpbmUpL2ksIHRhcmdldDogJ3BhcmFncmFwaCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbnRpcmV8d2hvbGV8ZnVsbClcXHMrKD86ZG9jdW1lbnR8ZmlsZXxub3RlKS9pLCB0YXJnZXQ6ICdkb2N1bWVudCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbmR8Ym90dG9tfGNvbmNsdXNpb24pL2ksIHRhcmdldDogJ2VuZCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSwgdGFyZ2V0OiAnc2VjdGlvbicgfVxuXTtcblxuZXhwb3J0IGNsYXNzIENvbW1hbmRQYXJzZXIge1xuICAgIC8qKlxuICAgICAqIFBhcnNlIG5hdHVyYWwgbGFuZ3VhZ2UgaW5wdXQgaW50byBhbiBFZGl0Q29tbWFuZFxuICAgICAqL1xuICAgIHBhcnNlQ29tbWFuZChpbnB1dDogc3RyaW5nLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4gPSBmYWxzZSk6IEVkaXRDb21tYW5kIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElucHV0ID0gaW5wdXQudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIGFjdGlvbiB0eXBlXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGV0ZWN0QWN0aW9uKG5vcm1hbGl6ZWRJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIHRhcmdldCB0eXBlXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGV0ZWN0VGFyZ2V0KG5vcm1hbGl6ZWRJbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsb2NhdGlvbiBpZiBzcGVjaWZpZWRcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSB0aGlzLmV4dHJhY3RMb2NhdGlvbihpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IGZyb20gdGhlIGlucHV0XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmV4dHJhY3RDb250ZXh0KGlucHV0KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQsXG4gICAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICAgIGluc3RydWN0aW9uOiBpbnB1dCxcbiAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZSBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0QWN0aW9uKGlucHV0OiBzdHJpbmcpOiBFZGl0QWN0aW9uIHtcbiAgICAgICAgLy8gQ2hlY2sgcGF0dGVybnMgaW4gb3JkZXIgb2Ygc3BlY2lmaWNpdHlcbiAgICAgICAgZm9yIChjb25zdCBjb21tYW5kUGF0dGVybiBvZiBDT01NQU5EX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgY29tbWFuZFBhdHRlcm4ucGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tbWFuZFBhdHRlcm4uYWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGVmYXVsdCBmYWxsYmFjayBsb2dpYyB3aXRoIG1vcmUgc3BlY2lmaWMgY2hlY2tzXG4gICAgICAgIGlmICgvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8Z2VuZXJhdGUuKnNlY3Rpb24pXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnYWRkJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihmaXh8Y29ycmVjdHxncmFtbWFyfHNwZWxsfHByb29mcmVhZHxwb2xpc2gpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZ3JhbW1hcic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGUpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZGVsZXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihyZXdyaXRlfHJlcGhyYXNlfHJlc3RydWN0dXJlfGdlbmVyYXRlLipuZXcpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAncmV3cml0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgdG8gZWRpdCBmb3IgYW1iaWd1b3VzIGNhc2VzXG4gICAgICAgIHJldHVybiAnZWRpdCc7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdFRhcmdldChcbiAgICAgICAgaW5wdXQ6IHN0cmluZywgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgXG4gICAgICAgIGFjdGlvbjogRWRpdEFjdGlvblxuICAgICk6IEVkaXRDb21tYW5kWyd0YXJnZXQnXSB7XG4gICAgICAgIC8vIENoZWNrIGV4cGxpY2l0IHRhcmdldCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHRhcmdldFBhdHRlcm4gb2YgVEFSR0VUX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0UGF0dGVybi5wYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFBhdHRlcm4udGFyZ2V0IGFzIEVkaXRDb21tYW5kWyd0YXJnZXQnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ29udGV4dC1iYXNlZCB0YXJnZXQgZGV0ZWN0aW9uXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24gJiYgKGFjdGlvbiA9PT0gJ2VkaXQnIHx8IGFjdGlvbiA9PT0gJ2dyYW1tYXInIHx8IGFjdGlvbiA9PT0gJ2RlbGV0ZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3NlbGVjdGlvbic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFjdGlvbi1zcGVjaWZpYyBkZWZhdWx0c1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQuaW5jbHVkZXMoJ3NlY3Rpb24nKSB8fCBpbnB1dC5pbmNsdWRlcygnaGVhZGluZycpID8gJ3NlY3Rpb24nIDogJ2VuZCc7XG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAncGFyYWdyYXBoJztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ3NlY3Rpb24nO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdwYXJhZ3JhcGgnO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgbG9jYXRpb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RMb2NhdGlvbihpbnB1dDogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIExPQ0FUSU9OX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHBhdHRlcm4uZXhlYyhpbnB1dCk7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGFkZGl0aW9uYWwgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdENvbnRleHQoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3Qgc3R5bGUvdG9uZSBpbmRpY2F0b3JzXG4gICAgICAgIGNvbnN0IHN0eWxlSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICdmb3JtYWwnLCAnaW5mb3JtYWwnLCAnY2FzdWFsJywgJ3Byb2Zlc3Npb25hbCcsICdhY2FkZW1pYycsICd0ZWNobmljYWwnLFxuICAgICAgICAgICAgJ3NpbXBsZScsICdjb21wbGV4JywgJ2RldGFpbGVkJywgJ2JyaWVmJywgJ2NvbmNpc2UnLCAndmVyYm9zZScsXG4gICAgICAgICAgICAnZnJpZW5kbHknLCAnc2VyaW91cycsICdodW1vcm91cycsICdjcmVhdGl2ZScsICdhbmFseXRpY2FsJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZm91bmRTdHlsZXMgPSBzdHlsZUluZGljYXRvcnMuZmlsdGVyKHN0eWxlID0+IFxuICAgICAgICAgICAgaW5wdXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHlsZSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIGlmIChmb3VuZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBTdHlsZTogJHtmb3VuZFN0eWxlcy5qb2luKCcsICcpfS4gYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsZW5ndGggaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ3Nob3J0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2JyaWVmJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbmNpc2UnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnS2VlcCBpdCBicmllZi4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2xvbmcnKSB8fCBpbnB1dC5pbmNsdWRlcygnZGV0YWlsZWQnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29tcHJlaGVuc2l2ZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdQcm92aWRlIGRldGFpbGVkIGNvbnRlbnQuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3Qgc3BlY2lmaWMgcmVxdWlyZW1lbnRzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnYnVsbGV0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2xpc3QnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIGJ1bGxldCBwb2ludHMgb3IgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdleGFtcGxlJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGVzJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0luY2x1ZGUgZXhhbXBsZXMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdudW1iZXInKSB8fCBpbnB1dC5pbmNsdWRlcygnbnVtYmVyZWQnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIG51bWJlcmVkIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGV4dC50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIGEgY29tbWFuZCBjYW4gYmUgZXhlY3V0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2RlbGV0ZScgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNwZWNpZnkgd2hpY2ggc2VjdGlvbiB0byBkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24tdGFyZ2V0IGNvbWJpbmF0aW9uc1xuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdhZGQnICYmIGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0ZWQgY29tbWFuZHMgYmFzZWQgb24gY29udGV4dFxuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgaGFzSGVhZGluZ3M6IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBhIGNvbmNsdXNpb24gc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNIZWFkaW5ncykge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnQWRkIGNvbnRlbnQgdG8gdGhlIGludHJvZHVjdGlvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIHRoZSBtZXRob2RvbG9neSBzZWN0aW9uJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBtdWx0aXBsZSBjb21tYW5kcyBmcm9tIGEgc2luZ2xlIGlucHV0XG4gICAgICovXG4gICAgcGFyc2VNdWx0aXBsZUNvbW1hbmRzKGlucHV0OiBzdHJpbmcpOiBFZGl0Q29tbWFuZFtdIHtcbiAgICAgICAgLy8gU3BsaXQgb24gY29tbW9uIGNvbW1hbmQgc2VwYXJhdG9yc1xuICAgICAgICBjb25zdCBzZXBhcmF0b3JzID0gL1xcYig/OnRoZW58YWxzb3xhbmQgdGhlbnxhZnRlciB0aGF0fG5leHR8YWRkaXRpb25hbGx5KVxcYi9pO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGlucHV0LnNwbGl0KHNlcGFyYXRvcnMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnBhcnNlQ29tbWFuZChpbnB1dCldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFydHNcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5wYXJzZUNvbW1hbmQocGFydCkpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgY29tbWFuZCBkZXNjcmlwdGlvbiBmb3IgZGlzcGxheVxuICAgICAqL1xuICAgIGdldENvbW1hbmREZXNjcmlwdGlvbihjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCB0YXJnZXQsIGxvY2F0aW9uIH0gPSBjb21tYW5kO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdBZGQgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRWRpdCBleGlzdGluZyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0dlbmVyYXRlIG5ldyBzZWN0aW9ucyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChsb2NhdGlvbikge1xuICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gYCBpbiBcIiR7bG9jYXRpb259XCJgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBjdXJyZW50IHNlY3Rpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgZW5kIG9mIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9XG59IiwgIi8qKlxuICogUHJvbXB0IGJ1aWxkZXIgc2VydmljZSBmb3IgTm92YVxuICogSW50ZWdyYXRlcyBDb250ZXh0QnVpbGRlciB3aXRoIGRvY3VtZW50IGVuZ2luZSBhbmQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyLCBHZW5lcmF0ZWRQcm9tcHQgfSBmcm9tICcuL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFByb21wdCBidWlsZGluZyBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9tcHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcjtcbiAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZTtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb21tYW5kUGFyc2VyOiBDb21tYW5kUGFyc2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICAgICAgdGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgdXNlciBtZXNzYWdlIC0gZGV0ZXJtaW5lcyBpZiBpdCdzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFByb21wdEZvck1lc3NhZ2UoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgbGlrZWx5IGEgY29tbWFuZCBiYXNlZCBvbiBhY3Rpb24gd29yZHNcbiAgICAgICAgY29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5pc0xpa2VseUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNMaWtlbHlDb21tYW5kICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChwYXJzZWRDb21tYW5kLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0J3MgYSBjb252ZXJzYXRpb24gLSBidWlsZCBjb252ZXJzYXRpb24gcHJvbXB0XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbnZlcnNhdGlvblByb21wdChtZXNzYWdlLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgbWVzc2FnZSBpcyBsaWtlbHkgYSBjb21tYW5kIHZzIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICAvLyBDaGVjayBmb3IgY29tbW9uIGNvbW1hbmQgYWN0aW9uIHdvcmRzXG4gICAgICAgIGNvbnN0IGNvbW1hbmRXb3JkcyA9IFtcbiAgICAgICAgICAgICdhZGQnLCAnY3JlYXRlJywgJ3dyaXRlJywgJ2luc2VydCcsICdpbmNsdWRlJywgJ2dlbmVyYXRlJyxcbiAgICAgICAgICAgICdlZGl0JywgJ21vZGlmeScsICdjaGFuZ2UnLCAndXBkYXRlJywgJ3JldmlzZScsICdpbXByb3ZlJywgJ2VuaGFuY2UnLFxuICAgICAgICAgICAgJ2RlbGV0ZScsICdyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2N1dCcsICdlcmFzZScsXG4gICAgICAgICAgICAnZml4JywgJ2NvcnJlY3QnLCAnZ3JhbW1hcicsICdzcGVsbCcsICdwcm9vZnJlYWQnLCAncG9saXNoJyxcbiAgICAgICAgICAgICdyZXdyaXRlJywgJ3Jld29yZCcsICdyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZW9yZ2FuaXplJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gY29tbWFuZFdvcmRzLnNvbWUod29yZCA9PiBsb3dlck1lc3NhZ2UuaW5jbHVkZXMod29yZCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb21tYW5kUHJvbXB0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIGlzIHJlcXVpcmVkIGZvciBjb21tYW5kIHByb21wdHMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBsZXQgY29udmVyc2F0aW9uQ29udGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAob3B0aW9ucy5pbmNsdWRlSGlzdG9yeSkge1xuICAgICAgICAgICAgY29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNSk7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5mb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KHJlY2VudE1lc3NhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBwcm9tcHRcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBvcHRpb25zLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGNvbnZlcnNhdGlvbiAobm9uLWNvbW1hbmQgbWVzc2FnZXMpXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCB8IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdO1xuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0IGlmIGZpbGUgaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgICAgICByZWNlbnRIaXN0b3J5ID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQobWVzc2FnZSwgZG9jdW1lbnRDb250ZXh0LCByZWNlbnRIaXN0b3J5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzaW1wbGUgcHJvbXB0IGZvciBiYXNpYyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb246IHN0cmluZywgY29udGV4dD86IHN0cmluZyk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZG9jdW1lbnQgY29udGV4dCBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dD4ge1xuICAgICAgICAvLyBVc2UgdGhlIGRvY3VtZW50IGVuZ2luZSdzIGJ1aWx0LWluIGNvbnRleHQgZ2F0aGVyaW5nXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjazogY3JlYXRlIG1pbmltYWwgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZW50KCkgfHwgJyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBoZWFkaW5nczogW10sXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSBjb250ZXh0IGFzLWlzLCBzaW5jZSBpdCdzIGFscmVhZHkgaW4gdGhlIGNvcnJlY3QgZm9ybWF0XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb252ZXJzYXRpb24gaGlzdG9yeSBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShtZXNzYWdlczogQ29udmVyc2F0aW9uTWVzc2FnZVtdKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnO1xuXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSAnUkVDRU5UIENPTlZFUlNBVElPTjpcXG4nO1xuICAgICAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCByb2xlID0gbXNnLnJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogJ05vdmEnO1xuICAgICAgICAgICAgZm9ybWF0dGVkICs9IGAke3JvbGV9OiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIG9wdGltaXplIHByb21wdCBiZWZvcmUgc2VuZGluZyB0byBBSVxuICAgICAqL1xuICAgIHZhbGlkYXRlQW5kT3B0aW1pemVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Byb21wdCB2YWxpZGF0aW9uIGlzc3VlczonLCB2YWxpZGF0aW9uLmlzc3Vlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBmaXggY29tbW9uIGlzc3Vlc1xuICAgICAgICAgICAgbGV0IG9wdGltaXplZFByb21wdCA9IHsgLi4ucHJvbXB0IH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRydW5jYXRlIGlmIHRvbyBsb25nXG4gICAgICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5jb250ZXh0QnVpbGRlci5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICh0b2tlbkNvdW50ID4gODAwMCkge1xuICAgICAgICAgICAgICAgIC8vIFJlZHVjZSBjb250ZXh0IHNpemUgbW9yZSBhZ2dyZXNzaXZlbHlcbiAgICAgICAgICAgICAgICBjb25zdCBtYXhDb250ZXh0TGVuZ3RoID0gTWF0aC5mbG9vcihwcm9tcHQuY29udGV4dC5sZW5ndGggKiAwLjYpO1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb250ZXh0ID0gcHJvbXB0LmNvbnRleHQuc3Vic3RyaW5nKDAsIG1heENvbnRleHRMZW5ndGgpICsgJ1xcbltDb250ZXh0IHRydW5jYXRlZC4uLl0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCB0ZW1wZXJhdHVyZVxuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPCAwIHx8IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPiAxKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHByb21wdC5jb25maWcudGVtcGVyYXR1cmUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgbWF4IHRva2Vuc1xuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcubWF4VG9rZW5zIDwgMTAgfHwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPiA0MDAwKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPSBNYXRoLm1heCgxMCwgTWF0aC5taW4oNDAwMCwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIG9wdGltaXplZFByb21wdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRva2VuIGNvdW50IGVzdGltYXRlIGZvciBhIHByb21wdFxuICAgICAqL1xuICAgIGdldFRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgcHJvbXB0IGZvciBhIHNwZWNpZmljIGFjdGlvbiB3aXRoIG1pbmltYWwgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkUXVpY2tQcm9tcHQoXG4gICAgICAgIGFjdGlvbjogRWRpdENvbW1hbmRbJ2FjdGlvbiddLFxuICAgICAgICBpbnN0cnVjdGlvbjogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBjb25zdCBjb21tYW5kOiBFZGl0Q29tbWFuZCA9IHtcbiAgICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICAgIHRhcmdldDogJ2RvY3VtZW50JyxcbiAgICAgICAgICAgIGluc3RydWN0aW9uLFxuICAgICAgICAgICAgbG9jYXRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQoY29tbWFuZCwgZmlsZSwgeyBcbiAgICAgICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDEwLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IHdpdGggY3VzdG9tIHN5c3RlbSBwcm9tcHQgb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZEN1c3RvbVByb21wdChcbiAgICAgICAgc3lzdGVtUHJvbXB0OiBzdHJpbmcsXG4gICAgICAgIHVzZXJNZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICBjb250ZXh0ID0gYERvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdDogdXNlck1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogQWRkIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgYWRkaW5nIG5ldyBjb250ZW50IHRvIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFkZENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGVkaXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZXRlcm1pbmVJbnNlcnRQb3NpdGlvbihjb21tYW5kLCBkb2N1bWVudENvbnRleHQpLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gYWRkIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmUgd2hlcmUgdG8gaW5zZXJ0IG5ldyBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBkZXRlcm1pbmVJbnNlcnRQb3NpdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dFxuICAgICk6IFByb21pc2U8J2N1cnNvcicgfCAnc2VsZWN0aW9uJyB8ICdlbmQnIHwgeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfT4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjayB0byBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCBhdCB0aGUgZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuICdlbmQnO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFkZCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBBZGQgY29tbWFuZCBjYW5ub3QgdGFyZ2V0IHNlbGVjdGlvblxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBhZGQgY29udGVudCB0byBhIHNlbGVjdGlvbi4gVXNlIFwiZWRpdFwiIHRvIG1vZGlmeSBzZWxlY3RlZCB0ZXh0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRhcmdldGluZyBhIHNlY3Rpb24sIGxvY2F0aW9uIHNob3VsZCBiZSBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiAhY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgLy8gVGhpcyBpcyBzdGlsbCB2YWxpZCAtIHdlJ2xsIGFkZCB0byBjdXJyZW50IHNlY3Rpb24gb3IgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGlvbnMgZm9yIGFkZCBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXG4gICAgICAgICAgICAnQWRkIGEgY29uY2x1c2lvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICdDcmVhdGUgYSBzdW1tYXJ5JyxcbiAgICAgICAgICAgICdBZGQgZXhhbXBsZXMnLFxuICAgICAgICAgICAgJ0NyZWF0ZSBhIG1ldGhvZG9sb2d5IHNlY3Rpb24nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnMgYmFzZWQgb24gZXhpc3RpbmcgaGVhZGluZ3NcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uTmFtZXMgPSBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubWFwKGggPT4gaC50ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaW50cm9kdWN0aW9uJykpKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMudW5zaGlmdCgnQWRkIGFuIGludHJvZHVjdGlvbiBzZWN0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghc2VjdGlvbk5hbWVzLnNvbWUobmFtZSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NvbmNsdXNpb24nKSkpIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgYSBjb25jbHVzaW9uIHNlY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc3VtbWFyeScpKSkge1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0FkZCBhIHN1bW1hcnkgc2VjdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDgpOyAvLyBMaW1pdCB0byA4IHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IGNvbnRlbnQgd291bGQgYmUgYWRkZWQgKHdpdGhvdXQgYWN0dWFsbHkgYWRkaW5nIGl0KVxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIHBvc2l0aW9uPzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHdoZXJlIGNvbnRlbnQgd291bGQgYmUgcGxhY2VkXG4gICAgICAgICAgICBsZXQgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSBgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICdpbiB0aGUgY3VycmVudCBzZWN0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogYFdpbGwgYWRkIG5ldyBjb250ZW50ICR7cG9zaXRpb25EZXNjcmlwdGlvbn1gLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbkRlc2NyaXB0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBFZGl0IGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgbW9kaWZ5aW5nIGFuZCBpbXByb3ZpbmcgZXhpc3RpbmcgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBlZGl0IGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGVkaXQgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBlbnRpcmUgc2VjdGlvbiBjb250ZW50IChleGNsdWRpbmcgaGVhZGluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHRvIHJlcGxhY2UgZnJvbSBoZWFkaW5nIGxpbmUgdG8gc2VjdGlvbiBlbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgZWRpdCBjb21tYW5kcyB0YXJnZXRpbmcgZW5kLCB0cmVhdCBhcyBhZGRpbmcgdG8gZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBlZGl0IHRhcmdldCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZWRpdCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIGxvY2F0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgcHJvdmlkZWQgZm9yIHNlY3Rpb24gZWRpdHNcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdlZGl0JyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiBlZGl0c1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBlZGl0IGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGRldGFpbGVkJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBjbGFyaXR5IGFuZCBmbG93JyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgZm9ybWFsJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgdGhpcyB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIG9uIHRoaXMgcG9pbnQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBlbmdhZ2luZydcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdJbXByb3ZlIHRoZSB3cml0aW5nIHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgZG9jdW1lbnQgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFbmhhbmNlIGNsYXJpdHkgdGhyb3VnaG91dCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgdGhlIGludHJvZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgJ1BvbGlzaCB0aGUgY29uY2x1c2lvbicsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBjb25jaXNlJyxcbiAgICAgICAgICAgICAgICAnQWRkIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSB0aGUgZmxvdyBiZXR3ZWVuIHNlY3Rpb25zJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBJbXByb3ZlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCAxMCk7IC8vIExpbWl0IHRvIDEwIHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IHdvdWxkIGJlIGVkaXRlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBhZmZlY3RlZENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGxldCBwcmV2aWV3VGV4dCA9ICcnO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgdGhlIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGVkaXQgdGhlIGVudGlyZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uPy5saW5lID8/IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGFkZCBlZGl0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVkaXQgdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZWRpdCB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGNoYW5nZXNcbiAgICAgKi9cbiAgICBhc3luYyBlc3RpbWF0ZVNjb3BlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgbGluZXNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBzY29wZURlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBzZWN0aW9uLmNvbnRlbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IHNlY3Rpb24ucmFuZ2UuZW5kIC0gc2VjdGlvbi5yYW5nZS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDsgLy8gTmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ05ldyBjb250ZW50IGF0IGVuZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogRGVsZXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgcmVtb3ZpbmcgY29udGVudCBmcm9tIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHNtYXJ0IGRlbGV0aW9uLCB3ZSBtYXkgbmVlZCBBSSB0byBkZXRlcm1pbmUgd2hhdCB0byBkZWxldGVcbiAgICAgICAgICAgIGlmIChjb21tYW5kLmluc3RydWN0aW9uICYmIGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB0byBpZGVudGlmeSB3aGF0IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBc2sgQUkgd2hhdCBjb250ZW50IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGRldGVybWluZSBkZWxldGlvbiBhY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIE1WUCwgd2UnbGwgcHJvY2VlZCB3aXRoIHRoZSB0YXJnZXQtYmFzZWQgZGVsZXRpb25cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBhbmFseXNpcyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBkZWxldGlvbiByZXN1bHQgKG9ubHkgZmFpbHVyZXMpXG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwICYmICFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZGVsZXRpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RGVsZXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHRcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZGVsZXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgZW50aXJlIHNlY3Rpb24gaW5jbHVkaW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3Igc2VjdGlvbiBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgcGFyYWdyYXBoIGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXMgKGVtcHR5IGxpbmVzIG9yIGhlYWRpbmcgbWFya2VycylcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudCgnJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGNvbnRlbnQgZnJvbSBlbmQgLSBub3QgbWVhbmluZ2Z1bCBmb3IgZGVsZXRlIGNvbW1hbmRcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LicsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZGVsZXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgZm9yIHNlY3Rpb24gZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnU2VjdGlvbiBuYW1lIHJlcXVpcmVkIGZvciBzZWN0aW9uIGRlbGV0aW9uJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIHRhcmdldCBpcyBhcHByb3ByaWF0ZSBmb3IgZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnZW5kJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgZGVsZXRlIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnUmVtb3ZlIHRoaXMgY29udGVudCcsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHRoZSBzZWxlY3Rpb24nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ1JlbW92ZSBlbXB0eSBzZWN0aW9ucycsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHJlZHVuZGFudCBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAnRGVsZXRlIGR1cGxpY2F0ZSBpbmZvcm1hdGlvbidcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIGRlbGV0aW9uIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChgRGVsZXRlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCA4KTsgLy8gTGltaXQgdG8gOCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBkZWxldGVkXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGFmZmVjdGVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgbGV0IHByZXZpZXdUZXh0ID0gJyc7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IGlzIGN1cnJlbnRseSBzZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtzZWN0aW9uLmNvbnRlbnR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGRlbGV0ZSB0aGUgZW50aXJlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3IgcHJldmlldydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGRlbGV0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY3VycmVudCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFncmFwaExpbmVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHN0YXJ0IG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2TGluZS50cmltKCkgPT09ICcnIHx8IHByZXZMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5lLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgZW5kIG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dExpbmUgPSBlZGl0b3IuZ2V0TGluZShlbmRMaW5lICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydExpbmU7IGkgPD0gZW5kTGluZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaExpbmVzLnB1c2goZWRpdG9yLmdldExpbmUoaSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBwYXJhZ3JhcGhMaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIGFsbCBkb2N1bWVudCBjb250ZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgZnJvbSBlbmQgb2YgZG9jdW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRpb24gdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGVsZXRlIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnXTtcblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgdGFyZ2V0cy51bnNoaWZ0KCdzZWxlY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoLTEsIDAsICdzZWN0aW9uJyk7IC8vIEluc2VydCBiZWZvcmUgJ2RvY3VtZW50J1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGRlbGV0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogJ05vIGRvY3VtZW50IGF2YWlsYWJsZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aCArIHNlY3Rpb24uaGVhZGluZy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0ludmFsaWQgdGFyZ2V0IGZvciBkZWxldGlvbic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogR3JhbW1hciBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGdyYW1tYXIgY2hlY2tpbmcgYW5kIGNvcnJlY3Rpb24gb2YgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdyYW1tYXJDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uIHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb24gZm9yIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcnJlY3RlZENvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLCAvLyBMb3dlciB0ZW1wZXJhdHVyZSBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29ycmVjdGVkQ29udGVudCB8fCBjb3JyZWN0ZWRDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb3JyZWN0ZWQgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5R3JhbW1hckNvcnJlY3Rpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb3JyZWN0ZWRDb250ZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gY29ycmVjdCBncmFtbWFyJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdHcmFtbWFyIGNvcnJlY3Rpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlHcmFtbWFyQ29ycmVjdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29ycmVjdGVkQ29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb3JyZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlY3Rpb24gY29udGVudCB3aGlsZSBwcmVzZXJ2aW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29ycmVjdGVkQ29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3U2VjdGlvbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3U2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZhbGwgdGhyb3VnaCB0byBwYXJhZ3JhcGggaWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCBjb3JyZWN0ZWQgY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29ycmVjdGVkQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvcnJlY3RlZENvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciBncmFtbWFyIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyBjb3JyZWN0ZWQgY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3Igc2VjdGlvbiB0YXJnZXRzLCBsb2NhdGlvbiBzaG91bGQgYmUgcHJvdmlkZWQgZm9yIGJldHRlciBhY2N1cmFjeVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2dyYW1tYXInICYmIGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIC8vIExvY2F0aW9uIGlzIHByb3ZpZGVkLCB3aGljaCBpcyBnb29kIGZvciBzZWN0aW9uIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBncmFtbWFyIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXIgaW4gc2VsZWN0ZWQgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ0NvcnJlY3Qgc3BlbGxpbmcgYW5kIHB1bmN0dWF0aW9uJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUnLFxuICAgICAgICAgICAgICAgICdGaXggY2FwaXRhbGl6YXRpb24gZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCB2ZXJiIHRlbnNlcycsXG4gICAgICAgICAgICAgICAgJ0ZpeCBzdWJqZWN0LXZlcmIgYWdyZWVtZW50JyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSByZWFkYWJpbGl0eSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdDaGVjayBncmFtbWFyIHRocm91Z2hvdXQgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdGaXggc3BlbGxpbmcgZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCBwdW5jdHVhdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgc2VudGVuY2Ugc3RydWN0dXJlJyxcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXRpY2FsIGVycm9ycyBpbiBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ0NoZWNrIGZvciBjb21tb24gbWlzdGFrZXMnLFxuICAgICAgICAgICAgICAgICdQcm9vZnJlYWQgdGhlIGRvY3VtZW50J1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgZ3JhbW1hciBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYENoZWNrIGdyYW1tYXIgaW4gXCIke2hlYWRpbmcudGV4dH1cIiBzZWN0aW9uYCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgMTApOyAvLyBMaW1pdCB0byAxMCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBncmFtbWFyLWNvcnJlY3RlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgcG90ZW50aWFsSXNzdWVzPzogc3RyaW5nW107XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHBvdGVudGlhbElzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGluIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmFzaWMgZ3JhbW1hciBpc3N1ZSBkZXRlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhMaW5lczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnRMaW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ291bnQgPSBlZGl0b3IubGluZUNvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dExpbmUudHJpbSgpID09PSAnJyB8fCBuZXh0TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRMaW5lOyBpIDw9IGVuZExpbmU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGhMaW5lcy5wdXNoKGVkaXRvci5nZXRMaW5lKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gcGFyYWdyYXBoTGluZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgdGhyb3VnaG91dCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBhZGQgZ3JhbW1hci1jb3JyZWN0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3VlczogcG90ZW50aWFsSXNzdWVzLnNsaWNlKDAsIDUpIC8vIExpbWl0IHRvIDUgaXNzdWVzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdCBwb3RlbnRpYWwgZ3JhbW1hciBpc3N1ZXMgaW4gdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0UG90ZW50aWFsSXNzdWVzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQmFzaWMgcGF0dGVybiBtYXRjaGluZyBmb3IgY29tbW9uIGlzc3Vlc1xuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYmlcXHMvZ2ksIGlzc3VlOiAnTG93ZXJjYXNlIFwiaVwiIHNob3VsZCBiZSBjYXBpdGFsaXplZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcLlxccypbYS16XS9nLCBpc3N1ZTogJ1NlbnRlbmNlIHNob3VsZCBzdGFydCB3aXRoIGNhcGl0YWwgbGV0dGVyJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHNwYWNlcyBkZXRlY3RlZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1suIT9dezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHB1bmN0dWF0aW9uIG1hcmtzJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzK1suIT8sOjtdL2csIGlzc3VlOiAnU3BhY2UgYmVmb3JlIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvWy4hP11cXHcvZywgaXNzdWU6ICdNaXNzaW5nIHNwYWNlIGFmdGVyIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxidGVoXFxiL2dpLCBpc3N1ZTogJ0NvbW1vbiB0eXBvOiBcInRlaFwiIHNob3VsZCBiZSBcInRoZVwiJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxiYW5kXFxzK2FuZFxcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJhbmRcIicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYnRoZVxccyt0aGVcXGIvZ2ksIGlzc3VlOiAnRHVwbGljYXRlIFwidGhlXCInIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXGJpc1xccytpc1xcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJpc1wiJyB9XG4gICAgICAgIF07XG5cbiAgICAgICAgcGF0dGVybnMuZm9yRWFjaCgoeyBwYXR0ZXJuLCBpc3N1ZSB9KSA9PiB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KHRleHQpKSB7XG4gICAgICAgICAgICAgICAgaXNzdWVzLnB1c2goaXNzdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaXNzdWVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBncmFtbWFyIGNoZWNrIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnLCAnZW5kJ107XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgIHRhcmdldHMudW5zaGlmdCgnc2VsZWN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRhcmdldHMuc3BsaWNlKC0yLCAwLCAnc2VjdGlvbicpOyAvLyBJbnNlcnQgYmVmb3JlICdkb2N1bWVudCcgYW5kICdlbmQnXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGFyZ2V0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0aGUgc2NvcGUgb2YgZ3JhbW1hciBjb3JyZWN0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgICBlc3RpbWF0ZWRJc3N1ZXM6IG51bWJlcjtcbiAgICB9PiB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb246ICdObyBkb2N1bWVudCBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZElzc3VlczogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIGxldCBjb250ZW50VG9BbmFseXplID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBzZWN0aW9uLnJhbmdlLmVuZCAtIHNlY3Rpb24ucmFuZ2Uuc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gYFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAvLyBFc3RpbWF0ZSBzaW5nbGUgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMTAwOyAvLyBSb3VnaCBlc3RpbWF0ZVxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAxO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnQ3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgIC8vIEZvciBlc3RpbWF0aW9uIHB1cnBvc2VzLCB1c2Ugc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7IC8vIE5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdOZXcgY29udGVudCBhdCBlbmQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXN0aW1hdGUgcG90ZW50aWFsIGlzc3Vlc1xuICAgICAgICBjb25zdCBlc3RpbWF0ZWRJc3N1ZXMgPSB0aGlzLmRldGVjdFBvdGVudGlhbElzc3Vlcyhjb250ZW50VG9BbmFseXplKS5sZW5ndGg7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgZXN0aW1hdGVkSXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIFJld3JpdGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZXdyaXRpbmcgY29udGVudCB3aXRoIGRpZmZlcmVudCBzdHlsZXMgYW5kIGFwcHJvYWNoZXNcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgZm9yIHJld3JpdGluZyB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uIGZvciByZXdyaXRpbmdcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXdyaXR0ZW5Db250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFyZXdyaXR0ZW5Db250ZW50IHx8IHJld3JpdHRlbkNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIHJld3JpdHRlbiBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgcmV3cml0ZSBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmV3cml0ZShjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Jld3JpdGUgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcmV3cml0ZSBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlSZXdyaXRlKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICByZXdyaXR0ZW5Db250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugc2VjdGlvbiBjb250ZW50IHdoaWxlIHByZXNlcnZpbmcgaGVhZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3U2VjdGlvbkNvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtyZXdyaXR0ZW5Db250ZW50fWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgcmV3cml0ZSB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCByZXdyaXR0ZW4gY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UocmV3cml0dGVuQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciByZXdyaXRlIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyByZXdyaXR0ZW4gY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJld3JpdGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSByZXdyaXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIHNlY3Rpb24gdGFyZ2V0cywgbG9jYXRpb24gc2hvdWxkIGJlIHByb3ZpZGVkIGZvciBiZXR0ZXIgYWNjdXJhY3lcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdyZXdyaXRlJyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiByZXdyaXRpbmdcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgcmV3cml0ZSBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYSBtb3JlIGZvcm1hbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBpbiBhIGNhc3VhbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCB3aXRoIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBmb3IgY2xhcml0eScsXG4gICAgICAgICAgICAgICAgJ1NpbXBsaWZ5IHRoZSBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBlbmdhZ2luZycsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYnVsbGV0IHBvaW50cycsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbmFycmF0aXZlIGZvcm0nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnLFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGluIGEgZGlmZmVyZW50IHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgd3JpdGluZyBtb3JlIGVuZ2FnaW5nJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgY29tcGxleCBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgZm9yIGRpZmZlcmVudCBhdWRpZW5jZScsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbW9yZSBmb3JtYWwgdG9uZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhlIGNvbnRlbnQgbW9yZSBjb25jaXNlJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgcmV3cml0ZSBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYFJld3JpdGUgdGhlIFwiJHtoZWFkaW5nLnRleHR9XCIgc2VjdGlvbmApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDEwKTsgLy8gTGltaXQgdG8gMTAgc3VnZ2VzdGlvbnNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2aWV3IHdoYXQgd291bGQgYmUgcmV3cml0dGVuXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICByZXdyaXRlU3R5bGU/OiBzdHJpbmc7XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHJld3JpdGVTdHlsZSA9IHRoaXMuaW5mZXJSZXdyaXRlU3R5bGUoY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgc2VsZWN0ZWQgdGV4dGA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBpcyBjdXJyZW50bHkgc2VsZWN0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gc2VjdGlvbi5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIHJld3JpdGUgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXdyaXRlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ICs9IGAgKCR7cmV3cml0ZVN0eWxlfSlgO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYWdyYXBoTGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBwYXJhZ3JhcGggYm91bmRhcmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkxpbmUgPSBlZGl0b3IuZ2V0TGluZShzdGFydExpbmUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChlbmRMaW5lIDwgbGluZUNvdW50IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0TGluZTsgaSA8PSBlbmRMaW5lOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYWdyYXBoTGluZXMucHVzaChlZGl0b3IuZ2V0TGluZShpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHBhcmFncmFwaExpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgYWRkIHJld3JpdHRlbiBjb250ZW50IGF0IHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmV3cml0ZSB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHJld3JpdGVTdHlsZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmZlciByZXdyaXRlIHN0eWxlIGZyb20gaW5zdHJ1Y3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGluZmVyUmV3cml0ZVN0eWxlKGluc3RydWN0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdmb3JtYWwnKSkgcmV0dXJuICdmb3JtYWwgdG9uZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjYXN1YWwnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdpbmZvcm1hbCcpKSByZXR1cm4gJ2Nhc3VhbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2NvbmNpc2UnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdzaG9ydGVyJykpIHJldHVybiAnbW9yZSBjb25jaXNlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2V4cGFuZCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2RldGFpbCcpKSByZXR1cm4gJ21vcmUgZGV0YWlsZWQnO1xuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxlJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxpZnknKSkgcmV0dXJuICdzaW1wbGlmaWVkIGxhbmd1YWdlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2VuZ2FnaW5nJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnaW50ZXJlc3RpbmcnKSkgcmV0dXJuICdtb3JlIGVuZ2FnaW5nJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3Byb2Zlc3Npb25hbCcpKSByZXR1cm4gJ3Byb2Zlc3Npb25hbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2J1bGxldCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2xpc3QnKSkgcmV0dXJuICdidWxsZXQgcG9pbnQgZm9ybWF0JztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ25hcnJhdGl2ZScpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3N0b3J5JykpIHJldHVybiAnbmFycmF0aXZlIHN0eWxlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3RlY2huaWNhbCcpKSByZXR1cm4gJ3RlY2huaWNhbCBzdHlsZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjcmVhdGl2ZScpKSByZXR1cm4gJ2NyZWF0aXZlIHN0eWxlJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmV3cml0ZSB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIHJld3JpdGluZ1xuICAgICAqL1xuICAgIGFzeW5jIGVzdGltYXRlU2NvcGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBsaW5lc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIHNjb3BlRGVzY3JpcHRpb246IHN0cmluZztcbiAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICByZXdyaXRlQ29tcGxleGl0eTogJ2xvdydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBsZXQgY29udGVudFRvQW5hbHl6ZSA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IHNlY3Rpb24uY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9IGBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAvLyBGb3IgZXN0aW1hdGlvbiBwdXJwb3NlcywgdXNlIHN1cnJvdW5kaW5nIGNvbnRleHRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5qb2luKCdcXG4nKSArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xcbicgKyBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwOyAvLyBOZXcgY29udGVudFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnTmV3IGNvbnRlbnQgYXQgZW5kJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERldGVybWluZSByZXdyaXRlIGNvbXBsZXhpdHkgYmFzZWQgb24gY29udGVudCBsZW5ndGggYW5kIGluc3RydWN0aW9uXG4gICAgICAgIGNvbnN0IHJld3JpdGVDb21wbGV4aXR5ID0gdGhpcy5lc3RpbWF0ZUNvbXBsZXhpdHkoY29udGVudFRvQW5hbHl6ZSwgY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSByZXdyaXRlIGNvbXBsZXhpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlQ29tcGxleGl0eShjb250ZW50OiBzdHJpbmcsIGluc3RydWN0aW9uOiBzdHJpbmcpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHtcbiAgICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IGNvbnRlbnQubGVuZ3RoO1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEJhc2UgY29tcGxleGl0eSBvbiBjb250ZW50IGxlbmd0aFxuICAgICAgICBsZXQgY29tcGxleGl0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyA9ICdsb3cnO1xuICAgICAgICBpZiAoY29udGVudExlbmd0aCA+IDEwMDApIGNvbXBsZXhpdHkgPSAnaGlnaCc7XG4gICAgICAgIGVsc2UgaWYgKGNvbnRlbnRMZW5ndGggPiAzMDApIGNvbXBsZXhpdHkgPSAnbWVkaXVtJztcbiAgICAgICAgXG4gICAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBpbnN0cnVjdGlvbiBjb21wbGV4aXR5XG4gICAgICAgIGNvbnN0IGNvbXBsZXhJbnN0cnVjdGlvbnMgPSBbXG4gICAgICAgICAgICAncmVzdHJ1Y3R1cmUnLCAncmVvcmdhbml6ZScsICdjb21wbGV0ZWx5IHJld3JpdGUnLCAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgICdjaGFuZ2Ugc3R5bGUnLCAnZGlmZmVyZW50IGF1ZGllbmNlJywgJ3RlY2huaWNhbCcsICdhY2FkZW1pYydcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb21wbGV4SW5zdHJ1Y3Rpb25zLnNvbWUodGVybSA9PiBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKHRlcm0pKSkge1xuICAgICAgICAgICAgaWYgKGNvbXBsZXhpdHkgPT09ICdsb3cnKSBjb21wbGV4aXR5ID0gJ21lZGl1bSc7XG4gICAgICAgICAgICBlbHNlIGlmIChjb21wbGV4aXR5ID09PSAnbWVkaXVtJykgY29tcGxleGl0eSA9ICdoaWdoJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbXBsZXhpdHk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBMaWNlbnNlLCBMaWNlbnNlVGllciwgRmVhdHVyZUZsYWcsIEZlYXR1cmVBY2Nlc3NSZXN1bHQsIEZlYXR1cmVUaWVyLCBEZWJ1Z1NldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTWFuYWdlciB7XG5cdHByaXZhdGUgZmVhdHVyZXM6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBjdXJyZW50TGljZW5zZTogTGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGN1cnJlbnRUaWVyOiBGZWF0dXJlVGllciA9IEZlYXR1cmVUaWVyLkNPUkU7XG5cdHByaXZhdGUgZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIGxpY2Vuc2VWYWxpZGF0b3I6IExpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0ZGVidWdTZXR0aW5ncz86IERlYnVnU2V0dGluZ3Ncblx0KSB7XG5cdFx0aWYgKGRlYnVnU2V0dGluZ3MpIHtcblx0XHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IGRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemUgYWxsIGZlYXR1cmUgZmxhZ3MgZm9yIENvcmUgdnMgU3VwZXJOb3ZhIHRpZXJzXG5cdCAqL1xuXHRwcml2YXRlIGluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTogdm9pZCB7XG5cdFx0Ly8gQ29yZSBmZWF0dXJlcyAoYWx3YXlzIGF2YWlsYWJsZSlcblx0XHR0aGlzLnJlZ2lzdGVyRmVhdHVyZSh7XG5cdFx0XHRrZXk6ICdiYXNpY19lZGl0aW5nJyxcblx0XHRcdHJlcXVpcmVkVGllcjogRmVhdHVyZVRpZXIuQ09SRSxcblx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRkZXNjcmlwdGlvbjogJ0Jhc2ljIGRvY3VtZW50IGVkaXRpbmcgY29tbWFuZHMgKGFkZCwgZWRpdCwgZGVsZXRlLCBncmFtbWFyLCByZXdyaXRlKSdcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdGtleTogJ2xvY2FsX2FpX3Byb3ZpZGVycycsXG5cdFx0XHRyZXF1aXJlZFRpZXI6IEZlYXR1cmVUaWVyLkNPUkUsXG5cdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICdMb2NhbCBBSSBwcm92aWRlcnMgKE9sbGFtYSwgTE0gU3R1ZGlvKSdcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdGtleTogJ2ZpbGVfY29udmVyc2F0aW9ucycsXG5cdFx0XHRyZXF1aXJlZFRpZXI6IEZlYXR1cmVUaWVyLkNPUkUsXG5cdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICdGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeSdcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdGtleTogJ3NpbmdsZV9jbG91ZF9wcm92aWRlcicsXG5cdFx0XHRyZXF1aXJlZFRpZXI6IEZlYXR1cmVUaWVyLkNPUkUsXG5cdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICdPbmUgY2xvdWQgQUkgcHJvdmlkZXIgKHVzZXIgY2hvaWNlOiBDbGF1ZGUsIE9wZW5BSSwgb3IgR29vZ2xlKSdcblx0XHR9KTtcblxuXHRcdC8vIFN1cGVyTm92YSBmZWF0dXJlcyAocHJlbWl1bSBvbmx5KVxuXHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdGtleTogJ3VubGltaXRlZF9jbG91ZF9haScsXG5cdFx0XHRyZXF1aXJlZFRpZXI6IEZlYXR1cmVUaWVyLlNVUEVSTk9WQSxcblx0XHRcdGVuYWJsZWQ6IGZhbHNlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICdVbmxpbWl0ZWQgYWNjZXNzIHRvIGFsbCBjbG91ZCBBSSBwcm92aWRlcnMnLFxuXHRcdFx0ZmFsbGJhY2tCZWhhdmlvcjogJ3Byb21wdF91cGdyYWRlJ1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0a2V5OiAncHJvdmlkZXJfc3dpdGNoaW5nJyxcblx0XHRcdHJlcXVpcmVkVGllcjogRmVhdHVyZVRpZXIuU1VQRVJOT1ZBLFxuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRkZXNjcmlwdGlvbjogJ1N3aXRjaCBBSSBwcm92aWRlcnMgZGlyZWN0bHkgaW4gY2hhdCBpbnRlcmZhY2UnLFxuXHRcdFx0ZmFsbGJhY2tCZWhhdmlvcjogJ3Byb21wdF91cGdyYWRlJ1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0a2V5OiAnbW9iaWxlX2FjY2VzcycsXG5cdFx0XHRyZXF1aXJlZFRpZXI6IEZlYXR1cmVUaWVyLlNVUEVSTk9WQSxcblx0XHRcdGVuYWJsZWQ6IGZhbHNlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICdNb2JpbGUgZGV2aWNlIHN1cHBvcnQgKGlPUy9BbmRyb2lkKScsXG5cdFx0XHRmYWxsYmFja0JlaGF2aW9yOiAncHJvbXB0X3VwZ3JhZGUnXG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRmVhdHVyZSh7XG5cdFx0XHRrZXk6ICdhZHZhbmNlZF90ZW1wbGF0ZXMnLFxuXHRcdFx0cmVxdWlyZWRUaWVyOiBGZWF0dXJlVGllci5TVVBFUk5PVkEsXG5cdFx0XHRlbmFibGVkOiBmYWxzZSxcblx0XHRcdGRlc2NyaXB0aW9uOiAnQWR2YW5jZWQgdGVtcGxhdGUgaW50ZWdyYXRpb24gYW5kIGN1c3RvbSBwcm9tcHRzJyxcblx0XHRcdGZhbGxiYWNrQmVoYXZpb3I6ICdwcm9tcHRfdXBncmFkZSdcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdGtleTogJ2JhdGNoX29wZXJhdGlvbnMnLFxuXHRcdFx0cmVxdWlyZWRUaWVyOiBGZWF0dXJlVGllci5TVVBFUk5PVkEsXG5cdFx0XHRlbmFibGVkOiBmYWxzZSxcblx0XHRcdGRlc2NyaXB0aW9uOiAnQmF0Y2ggZG9jdW1lbnQgcHJvY2Vzc2luZycsXG5cdFx0XHRmYWxsYmFja0JlaGF2aW9yOiAnbGltaXRlZF91c2FnZSdcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdGtleTogJ2Nyb3NzX2RvY3VtZW50X2NvbnRleHQnLFxuXHRcdFx0cmVxdWlyZWRUaWVyOiBGZWF0dXJlVGllci5TVVBFUk5PVkEsXG5cdFx0XHRlbmFibGVkOiBmYWxzZSxcblx0XHRcdGRlc2NyaXB0aW9uOiAnUmVmZXJlbmNlIG90aGVyIHZhdWx0IG5vdGVzIGR1cmluZyBlZGl0aW5nJyxcblx0XHRcdGZhbGxiYWNrQmVoYXZpb3I6ICdkaXNhYmxlJ1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0a2V5OiAncHJpb3JpdHlfc3VwcG9ydCcsXG5cdFx0XHRyZXF1aXJlZFRpZXI6IEZlYXR1cmVUaWVyLlNVUEVSTk9WQSxcblx0XHRcdGVuYWJsZWQ6IGZhbHNlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICdQcmlvcml0eSBlbWFpbCBzdXBwb3J0IGFuZCBmZWF0dXJlIHJlcXVlc3RzJyxcblx0XHRcdGZhbGxiYWNrQmVoYXZpb3I6ICdkaXNhYmxlJ1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGEgbmV3IGZlYXR1cmUgZmxhZ1xuXHQgKi9cblx0cmVnaXN0ZXJGZWF0dXJlKGZsYWc6IEZlYXR1cmVGbGFnKTogdm9pZCB7XG5cdFx0dGhpcy5mZWF0dXJlcy5zZXQoZmxhZy5rZXksIGZsYWcpO1xuXHRcdHRoaXMudXBkYXRlRmVhdHVyZUF2YWlsYWJpbGl0eSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBsaWNlbnNlIGFuZCByZWNhbGN1bGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHQgKi9cblx0YXN5bmMgdXBkYXRlTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRMaWNlbnNlID0gbnVsbDtcblx0XHRcdHRoaXMuY3VycmVudFRpZXIgPSBGZWF0dXJlVGllci5DT1JFO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCB2YWxpZGF0aW9uID0gYXdhaXQgdGhpcy5saWNlbnNlVmFsaWRhdG9yLnZhbGlkYXRlTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICh2YWxpZGF0aW9uLnZhbGlkICYmIHZhbGlkYXRpb24ubGljZW5zZSkge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRMaWNlbnNlID0gdmFsaWRhdGlvbi5saWNlbnNlO1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRUaWVyID0gdmFsaWRhdGlvbi5saWNlbnNlLnRpZXIgPT09ICdzdXBlcm5vdmEnIFxuXHRcdFx0XHRcdD8gRmVhdHVyZVRpZXIuU1VQRVJOT1ZBIFxuXHRcdFx0XHRcdDogRmVhdHVyZVRpZXIuQ09SRTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudExpY2Vuc2UgPSBudWxsO1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRUaWVyID0gRmVhdHVyZVRpZXIuQ09SRTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLnVwZGF0ZUZlYXR1cmVBdmFpbGFiaWxpdHkoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCB1c2VyJ3MgbGljZW5zZSB0aWVyXG5cdCAqL1xuXHRnZXRDdXJyZW50VGllcigpOiBGZWF0dXJlVGllciB7XG5cdFx0Ly8gRGV2ZWxvcG1lbnQgb3ZlcnJpZGVcblx0XHRpZiAodGhpcy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgJiYgdGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlVGllcikge1xuXHRcdFx0cmV0dXJuIHRoaXMuZGVidWdTZXR0aW5ncy5vdmVycmlkZVRpZXIgPT09ICdzdXBlcm5vdmEnIFxuXHRcdFx0XHQ/IEZlYXR1cmVUaWVyLlNVUEVSTk9WQSBcblx0XHRcdFx0OiBGZWF0dXJlVGllci5DT1JFO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRUaWVyO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGxpY2Vuc2UgaW5mb3JtYXRpb25cblx0ICovXG5cdGdldEN1cnJlbnRMaWNlbnNlKCk6IExpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5jdXJyZW50TGljZW5zZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIGZlYXR1cmUgaXMgZW5hYmxlZCBmb3IgY3VycmVudCB0aWVyXG5cdCAqL1xuXHRpc0ZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGZlYXR1cmUgPSB0aGlzLmZlYXR1cmVzLmdldChmZWF0dXJlS2V5KTtcblx0XHRyZXR1cm4gZmVhdHVyZT8uZW5hYmxlZCA/PyBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBmZWF0dXJlIGFjY2VzcyB3aXRoIGRldGFpbGVkIHJlc3VsdFxuXHQgKi9cblx0Y2hlY2tGZWF0dXJlQWNjZXNzKGZlYXR1cmVLZXk6IHN0cmluZyk6IEZlYXR1cmVBY2Nlc3NSZXN1bHQge1xuXHRcdGNvbnN0IGZlYXR1cmUgPSB0aGlzLmZlYXR1cmVzLmdldChmZWF0dXJlS2V5KTtcblx0XHRcblx0XHRpZiAoIWZlYXR1cmUpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRhbGxvd2VkOiBmYWxzZSwgXG5cdFx0XHRcdHJlYXNvbjogYEZlYXR1cmUgJyR7ZmVhdHVyZUtleX0nIG5vdCBmb3VuZGAgXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcblx0XHR9XG5cblx0XHRjb25zdCBjdXJyZW50VGllciA9IHRoaXMuZ2V0Q3VycmVudFRpZXIoKTtcblx0XHRjb25zdCByZXF1aXJlZFRpZXIgPSBmZWF0dXJlLnJlcXVpcmVkVGllcjtcblxuXHRcdHJldHVybiB7XG5cdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdHJlYXNvbjogYEZlYXR1cmUgcmVxdWlyZXMgJHtyZXF1aXJlZFRpZXJ9IHRpZXIgKGN1cnJlbnQ6ICR7Y3VycmVudFRpZXJ9KWAsXG5cdFx0XHRmYWxsYmFja0JlaGF2aW9yOiBmZWF0dXJlLmZhbGxiYWNrQmVoYXZpb3IsXG5cdFx0XHR1cGdyYWRlUHJvbXB0OiB0aGlzLmdldFVwZ3JhZGVQcm9tcHQoZmVhdHVyZSlcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgZmVhdHVyZXMgZm9yIGEgc3BlY2lmaWMgdGllclxuXHQgKi9cblx0Z2V0RmVhdHVyZXNGb3JUaWVyKHRpZXI6IEZlYXR1cmVUaWVyKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHR0aWVyID09PSBGZWF0dXJlVGllci5TVVBFUk5PVkEgPyB0cnVlIDogZmVhdHVyZS5yZXF1aXJlZFRpZXIgPT09IEZlYXR1cmVUaWVyLkNPUkVcblx0XHQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBkZWJ1ZyBzZXR0aW5ncyBmb3IgZGV2ZWxvcG1lbnQgdGVzdGluZ1xuXHQgKi9cblx0dXBkYXRlRGVidWdTZXR0aW5ncyhzZXR0aW5nczogRGVidWdTZXR0aW5ncyk6IHZvaWQge1xuXHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMudXBkYXRlRmVhdHVyZUF2YWlsYWJpbGl0eSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkZWJ1ZyBzZXR0aW5nc1xuXHQgKi9cblx0Z2V0RGVidWdTZXR0aW5ncygpOiBEZWJ1Z1NldHRpbmdzIHtcblx0XHRyZXR1cm4geyAuLi50aGlzLmRlYnVnU2V0dGluZ3MgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHkgYmFzZWQgb24gY3VycmVudCB0aWVyXG5cdCAqL1xuXHRwcml2YXRlIHVwZGF0ZUZlYXR1cmVBdmFpbGFiaWxpdHkoKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFRpZXIgPSB0aGlzLmdldEN1cnJlbnRUaWVyKCk7XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBba2V5LCBmZWF0dXJlXSBvZiB0aGlzLmZlYXR1cmVzKSB7XG5cdFx0XHRjb25zdCBzaG91bGRFbmFibGUgPSBjdXJyZW50VGllciA9PT0gRmVhdHVyZVRpZXIuU1VQRVJOT1ZBIHx8IFxuXHRcdFx0XHRcdFx0XHQgICBmZWF0dXJlLnJlcXVpcmVkVGllciA9PT0gRmVhdHVyZVRpZXIuQ09SRTtcblx0XHRcdFxuXHRcdFx0dGhpcy5mZWF0dXJlcy5zZXQoa2V5LCB7IC4uLmZlYXR1cmUsIGVuYWJsZWQ6IHNob3VsZEVuYWJsZSB9KTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGUgdXBncmFkZSBwcm9tcHQgZm9yIGJsb2NrZWQgZmVhdHVyZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRVcGdyYWRlUHJvbXB0KGZlYXR1cmU6IEZlYXR1cmVGbGFnKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gYCR7ZmVhdHVyZS5kZXNjcmlwdGlvbn0gaXMgYXZhaWxhYmxlIHdpdGggTm92YSBTdXBlck5vdmEuIGAgK1xuXHRcdFx0ICAgYFVwZ3JhZGUgdG8gdW5sb2NrIHRoaXMgZmVhdHVyZSBhbmQgc3VwcG9ydCBOb3ZhIGRldmVsb3BtZW50LmA7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgdXNhZ2Ugc3VtbWFyeSBmb3IgY3VycmVudCB0aWVyXG5cdCAqL1xuXHRnZXRGZWF0dXJlU3VtbWFyeSgpOiB7IHRpZXI6IEZlYXR1cmVUaWVyOyBlbmFibGVkOiBzdHJpbmdbXTsgZGlzYWJsZWQ6IHN0cmluZ1tdIH0ge1xuXHRcdGNvbnN0IGN1cnJlbnRUaWVyID0gdGhpcy5nZXRDdXJyZW50VGllcigpO1xuXHRcdGNvbnN0IGVuYWJsZWQ6IHN0cmluZ1tdID0gW107XG5cdFx0Y29uc3QgZGlzYWJsZWQ6IHN0cmluZ1tdID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkaXNhYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHsgdGllcjogY3VycmVudFRpZXIsIGVuYWJsZWQsIGRpc2FibGVkIH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgTGljZW5zZSwgTGljZW5zZVZhbGlkYXRpb25SZXN1bHQsIExpY2Vuc2VFcnJvciwgTGljZW5zZVRpZXIgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIExpY2Vuc2VWYWxpZGF0b3Ige1xuXHQvLyBFbWJlZGRlZCBzaWduaW5nIGtleSAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSBvYmZ1c2NhdGVkXG5cdHByaXZhdGUgcmVhZG9ubHkgU0VDUkVUX0tFWSA9ICdub3ZhLWxpY2Vuc2Utc2lnbmluZy1rZXktMjAyNSc7XG5cdFxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBrZXkgYW5kIHJldHVybnMgdmFsaWRhdGlvbiByZXN1bHRcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgbGljZW5zZSBrZXkgc3RyaW5nIGludG8gYSBMaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBMaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0aWVyfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0aWVyLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFZhbGlkYXRlIHRpZXJcblx0XHRcdGlmICh0aWVyICE9PSAnY29yZScgJiYgdGllciAhPT0gJ3N1cGVybm92YScpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHR0aWVyOiB0aWVyIGFzIExpY2Vuc2VUaWVyLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBkZWNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RGVjb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYXRvYihzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGVuY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjRFbmNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBidG9hKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IExpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50aWVyLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlIChwcmV2ZW50IGZ1dHVyZS1kYXRlZCBsaWNlbnNlcylcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIGxpY2Vuc2UgZGF0YVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHRpZXI6IExpY2Vuc2VUaWVyLFxuXHRcdGV4cGlyZXNBdDogRGF0ZSB8IG51bGwsXG5cdFx0aXNzdWVkQXQ6IERhdGVcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBkYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfWA7XG5cdFx0XG5cdFx0Y29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdGNvbnN0IGtleURhdGEgPSBlbmNvZGVyLmVuY29kZSh0aGlzLlNFQ1JFVF9LRVkpO1xuXHRcdGNvbnN0IG1lc3NhZ2VEYXRhID0gZW5jb2Rlci5lbmNvZGUoZGF0YSk7XG5cdFx0XG5cdFx0Y29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG5cdFx0XHQncmF3Jyxcblx0XHRcdGtleURhdGEsXG5cdFx0XHR7IG5hbWU6ICdITUFDJywgaGFzaDogJ1NIQS0yNTYnIH0sXG5cdFx0XHRmYWxzZSxcblx0XHRcdFsnc2lnbiddXG5cdFx0KTtcblx0XHRcblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBjcnlwdG9LZXksIG1lc3NhZ2VEYXRhKTtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShzaWduYXR1cmUpKVxuXHRcdFx0Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpXG5cdFx0XHQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHRlc3QgbGljZW5zZSBmb3IgZGV2ZWxvcG1lbnQgcHVycG9zZXNcblx0ICovXG5cdGFzeW5jIGNyZWF0ZVRlc3RMaWNlbnNlKGVtYWlsOiBzdHJpbmcsIHRpZXI6IExpY2Vuc2VUaWVyLCBsaWZldGltZU1vZGUgPSB0cnVlKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gbGlmZXRpbWVNb2RlID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKGVtYWlsLCB0aWVyLCBleHBpcmVzQXQsIGlzc3VlZEF0KTtcblx0XHRcblx0XHRjb25zdCBsaWNlbnNlRGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX18JHtzaWduYXR1cmV9YDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5iYXNlNjRFbmNvZGUobGljZW5zZURhdGEpO1xuXHR9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBbUg7OztBQ0FuSCxzQkFBK0M7QUFtQnhDLElBQU0sbUJBQWlDO0FBQUEsRUFDN0MsYUFBYTtBQUFBLElBQ1osUUFBUTtBQUFBLE1BQ1AsUUFBUTtBQUFBLE1BQ1IsT0FBTztBQUFBLE1BQ1AsYUFBYTtBQUFBLE1BQ2IsV0FBVztBQUFBLElBQ1o7QUFBQSxJQUNBLFFBQVE7QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxNQUNULE9BQU87QUFBQSxNQUNQLGFBQWE7QUFBQSxNQUNiLFdBQVc7QUFBQSxJQUNaO0FBQUEsSUFDQSxRQUFRO0FBQUEsTUFDUCxRQUFRO0FBQUEsTUFDUixPQUFPO0FBQUEsTUFDUCxhQUFhO0FBQUEsTUFDYixXQUFXO0FBQUEsSUFDWjtBQUFBLElBQ0EsUUFBUTtBQUFBLE1BQ1AsU0FBUztBQUFB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
