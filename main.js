/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian16 = require("obsidian");

// src/settings.ts
var import_obsidian12 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian11 = require("obsidian");

// src/core/multi-doc-context.ts
var import_obsidian = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
      if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
        return false;
      }
      return true;
    });
    if (allPersistentDocs.length !== rawPersistentDocs.length) {
      if (allPersistentDocs.length > 0) {
        this.persistentContext.set(currentFile.path, allPersistentDocs);
      } else {
        this.persistentContext.delete(currentFile.path);
      }
    }
    const contextParts = [];
    const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
    if (currentFileContext) {
      contextParts.push(currentFileContext);
    }
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ai/models.ts
function getAvailableModels(providerType, settings) {
  var _a, _b;
  switch (providerType) {
    case "claude":
      return [
        { value: "claude-opus-4-20250514", label: "Claude Opus 4" },
        { value: "claude-sonnet-4-20250514", label: "Claude Sonnet 4" },
        { value: "claude-3-7-sonnet-latest", label: "Claude 3.7 Sonnet" },
        { value: "claude-3-5-sonnet-latest", label: "Claude 3.5 Sonnet" },
        { value: "claude-3-5-sonnet-20241022", label: "Claude 3.5 Sonnet (Oct 22)" },
        { value: "claude-3-5-haiku-latest", label: "Claude 3.5 Haiku" }
      ];
    case "openai":
      return [
        { value: "gpt-4.1-2025-04-14", label: "GPT-4.1" },
        { value: "gpt-4.1-mini-2025-04-14", label: "GPT-4.1 Mini" },
        { value: "gpt-4.1-nano-2025-04-14", label: "GPT-4.1 Nano" },
        { value: "gpt-4o", label: "GPT-4o" },
        { value: "gpt-4o-mini", label: "GPT-4o Mini" }
      ];
    case "google":
      return [
        { value: "gemini-2.5-flash-preview-04-17", label: "Gemini 2.5 Flash" },
        { value: "gemini-2.5-pro-preview-03-25", label: "Gemini 2.5 Pro" },
        { value: "gemini-2.0-flash", label: "Gemini 2.0 Flash" },
        { value: "gemini-2.0-flash-lite", label: "Gemini 2.0 Flash-Lite" }
      ];
    case "ollama":
      const ollamaModel = (_b = (_a = settings == null ? void 0 : settings.aiProviders) == null ? void 0 : _a.ollama) == null ? void 0 : _b.model;
      if (ollamaModel && ollamaModel.trim()) {
        return [{ value: ollamaModel, label: ollamaModel }];
      }
      return [];
    default:
      return [];
  }
}

// src/ui/input-handler.ts
var import_obsidian3 = require("obsidian");

// src/ui/wikilink-suggest.ts
var import_obsidian2 = require("obsidian");
var NovaWikilinkAutocomplete = class {
  // Reference to NovaSidebarView
  constructor(app, textArea, container) {
    this.suggestionPopup = null;
    this.suggestions = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.currentQuery = "";
    this.currentTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.container = container || textArea.parentElement;
    this.setupEventListeners();
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
    this.textArea.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textArea.addEventListener("blur", () => {
      setTimeout(() => this.hideSuggestions(), 150);
    });
    document.addEventListener("click", (e) => {
      if (this.suggestionPopup && !this.suggestionPopup.contains(e.target) && e.target !== this.textArea) {
        this.hideSuggestions();
      }
    });
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch) {
      this.currentQuery = linkMatch[1] || "";
      this.currentTriggerPos = cursorPos - linkMatch[0].length;
      this.showSuggestions();
    } else {
      this.hideSuggestions();
    }
  }
  handleKeydown(e) {
    if (!this.isVisible) return;
    switch (e.key) {
      case "ArrowDown":
        e.preventDefault();
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);
        this.updateSelection();
        break;
      case "ArrowUp":
        e.preventDefault();
        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
        this.updateSelection();
        break;
      case "Enter":
      case "Tab":
        if (this.selectedIndex >= 0 || this.suggestions.length > 0) {
          e.preventDefault();
          const index = this.selectedIndex >= 0 ? this.selectedIndex : 0;
          this.selectSuggestion(this.suggestions[index]).then();
        }
        break;
      case "Escape":
        e.preventDefault();
        this.hideSuggestions();
        break;
    }
  }
  showSuggestions() {
    this.suggestions = this.getSuggestions(this.currentQuery);
    if (this.suggestions.length === 0) {
      this.hideSuggestions();
      return;
    }
    if (!this.suggestionPopup) {
      this.createSuggestionPopup();
    }
    this.renderSuggestions();
    this.positionPopup();
    this.isVisible = true;
    this.selectedIndex = 0;
    this.updateSelection();
  }
  hideSuggestions() {
    if (this.suggestionPopup) {
      this.suggestionPopup.style.display = "none";
    }
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  createSuggestionPopup() {
    this.suggestionPopup = document.createElement("div");
    this.suggestionPopup.className = "nova-wikilink-suggestions";
    const maxHeight = import_obsidian2.Platform.isMobile ? "100px" : "600px";
    this.suggestionPopup.style.cssText = `
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: ${maxHeight};
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-bottom: 4px;
        `;
    if (import_obsidian2.Platform.isMobile) {
      this.suggestionPopup.classList.add("is-mobile");
      document.body.classList.add("is-mobile");
    }
    this.container.appendChild(this.suggestionPopup);
  }
  renderSuggestions() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.innerHTML = "";
    this.suggestions.forEach((suggestion, index) => {
      const item = document.createElement("div");
      item.className = "nova-suggestion-item";
      if (import_obsidian2.Platform.isMobile) {
        item.style.cssText = `
                    padding: 6px 10px;
                    cursor: pointer;
                    border-bottom: 1px solid var(--background-modifier-border-hover);
                    transition: background-color 0.2s;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                `;
        const nameEl = document.createElement("div");
        nameEl.className = "nova-suggestion-name";
        nameEl.textContent = suggestion.file.basename;
        nameEl.style.cssText = `
                    font-weight: 500;
                    color: var(--text-normal);
                    font-size: 0.9em;
                    flex: 1;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                `;
        item.appendChild(nameEl);
        if (suggestion.file.path.includes("/")) {
          const pathEl = document.createElement("div");
          pathEl.className = "nova-suggestion-path";
          const folderPath = suggestion.file.path.substring(0, suggestion.file.path.lastIndexOf("/"));
          pathEl.textContent = folderPath.length > 15 ? "..." + folderPath.slice(-15) : folderPath;
          pathEl.style.cssText = `
                        font-size: 0.75em;
                        color: var(--text-muted);
                        opacity: 0.7;
                    `;
          item.appendChild(pathEl);
        }
      } else {
        item.style.cssText = `
                    padding: 8px 12px;
                    cursor: pointer;
                    border-bottom: 1px solid var(--background-modifier-border-hover);
                    transition: background-color 0.2s;
                `;
        const nameEl = document.createElement("div");
        nameEl.className = "nova-suggestion-name";
        nameEl.textContent = suggestion.file.basename;
        nameEl.style.cssText = `
                    font-weight: 500;
                    color: var(--text-normal);
                    margin-bottom: 4px;
                `;
        item.appendChild(nameEl);
        const descEl = document.createElement("div");
        descEl.className = "nova-suggestion-desc";
        descEl.textContent = `Link to document in ${suggestion.file.path.includes("/") ? suggestion.file.path.substring(0, suggestion.file.path.lastIndexOf("/")) : "root"}`;
        descEl.style.cssText = `
                    font-size: 0.85em;
                    color: var(--text-muted);
                    margin-bottom: 4px;
                `;
        item.appendChild(descEl);
        const exampleEl = document.createElement("div");
        exampleEl.className = "nova-suggestion-example";
        this.getFilePreview(suggestion.file).then((preview) => {
          exampleEl.textContent = `Preview: ${preview}`;
        });
        exampleEl.style.cssText = `
                    font-size: 0.8em;
                    color: var(--text-accent);
                    font-family: var(--font-monospace);
                `;
        item.appendChild(exampleEl);
      }
      this.suggestionPopup.appendChild(item);
      item.addEventListener("click", async () => {
        await this.selectSuggestion(suggestion);
      });
      item.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.suggestionPopup.style.display = "block";
  }
  updateSelection() {
    if (!this.suggestionPopup) return;
    const items = this.suggestionPopup.querySelectorAll(".nova-suggestion-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.backgroundColor = "var(--background-modifier-hover)";
      } else {
        element.style.backgroundColor = "";
      }
    });
  }
  positionPopup() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.style.position = "absolute";
    this.suggestionPopup.style.left = "0";
    this.suggestionPopup.style.right = "0";
    this.suggestionPopup.style.bottom = "100%";
    this.suggestionPopup.style.marginBottom = "4px";
  }
  async selectSuggestion(suggestion) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch) {
      const startPos = cursorPos - linkMatch[0].length;
      const newText = text.substring(0, startPos) + text.substring(cursorPos);
      this.textArea.value = newText;
      this.textArea.setSelectionRange(startPos, startPos);
      this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    }
    if (this.sidebarView && this.sidebarView.addFilesToContext) {
      await this.sidebarView.addFilesToContext([suggestion.file.basename]);
    }
    this.hideSuggestions();
    this.textArea.focus();
  }
  getSuggestions(query) {
    const files = this.app.vault.getMarkdownFiles();
    const suggestions = [];
    for (const file of files) {
      const score = this.scoreFile(file, query);
      if (score > 0) {
        suggestions.push({
          file,
          displayText: file.basename,
          score
        });
      }
    }
    const maxResults = import_obsidian2.Platform.isMobile ? 5 : 8;
    return suggestions.sort((a, b) => b.score - a.score).slice(0, maxResults);
  }
  scoreFile(file, query) {
    if (!query) return 50;
    const basename = file.basename.toLowerCase();
    const path = file.path.toLowerCase();
    const queryLower = query.toLowerCase();
    if (basename === queryLower) return 100;
    if (basename.startsWith(queryLower)) return 80;
    if (basename.includes(queryLower)) return 60;
    if (path.includes(queryLower)) return 40;
    if (this.fuzzyMatch(basename, queryLower)) return 20;
    return 0;
  }
  fuzzyMatch(text, query) {
    let textIndex = 0;
    let queryIndex = 0;
    while (textIndex < text.length && queryIndex < query.length) {
      if (text[textIndex] === query[queryIndex]) {
        queryIndex++;
      }
      textIndex++;
    }
    return queryIndex === query.length;
  }
  async getFilePreview(file) {
    try {
      const content = await this.app.vault.read(file);
      let textContent = content;
      if (content.startsWith("---")) {
        const frontmatterEnd = content.indexOf("---", 3);
        if (frontmatterEnd !== -1) {
          textContent = content.substring(frontmatterEnd + 3);
        }
      }
      const plainText = textContent.replace(/^#+ /gm, "").replace(/\*\*(.*?)\*\*/g, "$1").replace(/\*(.*?)\*/g, "$1").replace(/\[(.*?)\]\(.*?\)/g, "$1").replace(/\n/g, " ").trim();
      return plainText.length > 50 ? plainText.substring(0, 50) + "..." : plainText || "Empty file";
    } catch (error) {
      return "Unable to load preview";
    }
  }
  destroy() {
    if (this.suggestionPopup) {
      this.suggestionPopup.remove();
    }
  }
};

// src/ui/input-handler.ts
var _InputHandler = class _InputHandler {
  constructor(plugin, container, contextManager) {
    this.dropZoneOverlay = null;
    this.isDragging = false;
    // Reference to NovaSidebarView for context operations
    // Event cleanup tracking
    this.eventListeners = [];
    this.plugin = plugin;
    this.container = container;
    this.contextManager = contextManager;
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.setSidebarView(sidebarView);
    }
  }
  setCommandSystem(commandSystem) {
    this.commandSystem = commandSystem;
    const sendButtonEl = this.sendButton.buttonEl;
    sendButtonEl.remove();
    this.commandSystem.createCommandButton(this.inputRow);
    this.inputRow.appendChild(sendButtonEl);
    this.commandSystem.createCommandPickerInContainer(this.inputRow);
  }
  getTextArea() {
    return this.textArea;
  }
  createInputInterface(chatContainer) {
    this.container = this.container.createDiv({ cls: "nova-input-container" });
    this.container.style.cssText = `
			flex-shrink: 0;
			padding: var(--size-4-3);
			border-top: 1px solid var(--background-modifier-border);
			position: relative;
		`;
    this.inputRow = this.container.createDiv({ cls: "nova-input-row" });
    this.inputRow.style.cssText = `
			display: flex;
			gap: var(--size-2-3);
			align-items: center;
			position: relative;
		`;
    const textAreaContainer = this.inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian3.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova anything... (Shift+Enter for new line)");
    this.textArea.inputEl.style.cssText = `
			min-height: 80px;
			max-height: 200px;
			resize: none;
			overflow-y: auto;
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			border: 1px solid var(--background-modifier-border);
			background: var(--background-primary);
			color: var(--text-normal);
			font-family: var(--font-interface);
			font-size: var(--font-ui-medium);
			line-height: 1.4;
			width: 100%;
			box-sizing: border-box;
		`;
    this.autoGrowTextarea = () => {
      const textarea = this.textArea.inputEl;
      textarea.style.height = "auto";
      textarea.style.height = Math.min(textarea.scrollHeight, 200) + "px";
    };
    this.addEventListener(this.textArea.inputEl, "input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.plugin.app, this.textArea.inputEl, this.inputRow);
    if (this.sidebarView) {
      this.wikilinkAutocomplete.setSidebarView(this.sidebarView);
    }
    this.addEventListener(this.textArea.inputEl, "input", () => {
      this.contextManager.updateLiveContextPreview(this.textArea.getValue());
    });
    this.sendButton = new import_obsidian3.ButtonComponent(this.inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
		`;
    this.addEventListener(this.textArea.inputEl, "keydown", (event) => {
      var _a, _b, _c, _d;
      const keyEvent = event;
      if (keyEvent.key === "Enter" && !keyEvent.shiftKey) {
        event.preventDefault();
        ((_a = this.commandSystem) == null ? void 0 : _a.handleCommandPickerSelection()) || false || this.handleSend();
      } else if (keyEvent.key === "Escape") {
        (_b = this.commandSystem) == null ? void 0 : _b.hideCommandPicker();
      } else if (keyEvent.key === "ArrowUp" || keyEvent.key === "ArrowDown") {
        if ((_c = this.commandSystem) == null ? void 0 : _c.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      } else if (keyEvent.key === "Tab") {
        if ((_d = this.commandSystem) == null ? void 0 : _d.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      }
    });
    this.addEventListener(this.textArea.inputEl, "input", () => {
      if (this.commandSystem) {
        this.commandSystem.handleInputChange();
      }
    });
    this.setupDragAndDrop();
  }
  focus() {
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _InputHandler.FOCUS_DELAY_MS);
  }
  handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.textArea.setValue("");
    this.autoGrowTextarea();
    this.contextManager.hideContextPreview();
    (_a = this.onSendMessage) == null ? void 0 : _a.call(this, message);
  }
  setOnSendMessage(callback) {
    this.onSendMessage = callback;
  }
  getValue() {
    return this.textArea.getValue();
  }
  setValue(value) {
    this.textArea.setValue(value);
    this.autoGrowTextarea();
  }
  insertText(text) {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + text + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const newPosition = start + text.length;
    setTimeout(() => {
      textarea.setSelectionRange(newPosition, newPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  insertTextWithCursor(beforeCursor, afterCursor = "") {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + beforeCursor + afterCursor + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const cursorPosition = start + beforeCursor.length;
    setTimeout(() => {
      textarea.setSelectionRange(cursorPosition, cursorPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.eventListeners.push({ element, event, handler });
  }
  setupDragAndDrop() {
    const dropZone = this.textArea.inputEl;
    this.addEventListener(dropZone, "dragenter", (e) => {
      e.preventDefault();
      this.handleDragEnter();
    });
    this.addEventListener(dropZone, "dragover", (e) => {
      e.preventDefault();
      e.dataTransfer.dropEffect = "copy";
    });
    this.addEventListener(dropZone, "dragleave", (e) => {
      if (e.target === dropZone) {
        this.handleDragLeave();
      }
    });
    this.addEventListener(dropZone, "drop", (e) => {
      e.preventDefault();
      this.handleDrop(e);
    });
  }
  handleDragEnter() {
    if (this.isDragging) return;
    this.isDragging = true;
    if (!this.dropZoneOverlay) {
      this.dropZoneOverlay = document.createElement("div");
      this.dropZoneOverlay.className = "nova-drop-zone-overlay";
      this.dropZoneOverlay.style.cssText = `
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: var(--interactive-accent);
				opacity: 0;
				border: 2px dashed var(--interactive-accent);
				border-radius: var(--radius-s);
				display: flex;
				align-items: center;
				justify-content: center;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 10;
			`;
      const iconContainer = document.createElement("div");
      iconContainer.style.cssText = `
				background: var(--background-primary);
				border-radius: 50%;
				width: 48px;
				height: 48px;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
				opacity: 0;
				transform: scale(0.8);
				transition: all 0.2s ease;
			`;
      const icon = document.createElement("div");
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>`;
      icon.style.cssText = `
				color: var(--interactive-accent);
				display: flex;
				align-items: center;
				justify-content: center;
			`;
      iconContainer.appendChild(icon);
      this.dropZoneOverlay.appendChild(iconContainer);
    }
    const textAreaContainer = this.textArea.inputEl.parentElement;
    textAreaContainer.style.position = "relative";
    textAreaContainer.appendChild(this.dropZoneOverlay);
    setTimeout(() => {
      if (this.dropZoneOverlay) {
        this.dropZoneOverlay.style.opacity = "0.1";
        const icon = this.dropZoneOverlay.querySelector("div");
        if (icon) {
          icon.style.opacity = "1";
          icon.style.transform = "scale(1)";
        }
      }
    }, 10);
  }
  handleDragLeave() {
    this.isDragging = false;
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.style.opacity = "0";
      const icon = this.dropZoneOverlay.querySelector("div");
      if (icon) {
        icon.style.opacity = "0";
        icon.style.transform = "scale(0.8)";
      }
      setTimeout(() => {
        var _a;
        (_a = this.dropZoneOverlay) == null ? void 0 : _a.remove();
        this.dropZoneOverlay = null;
      }, 200);
    }
  }
  handleDrop(e) {
    var _a;
    this.handleDragLeave();
    const files = [];
    const textPlainData = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
    if (textPlainData && textPlainData.includes("obsidian://open?")) {
      const urls = textPlainData.split(/[\n\r]/).filter((line) => line.trim().startsWith("obsidian://open?"));
      for (const urlString of urls) {
        try {
          const url = new URL(urlString.trim());
          const filePath = url.searchParams.get("file");
          if (filePath) {
            const decodedPath = decodeURIComponent(filePath);
            const pathParts = decodedPath.split(/[/\\]/);
            const filename = pathParts[pathParts.length - 1];
            if (filename.endsWith(".md")) {
              const baseName = filename.replace(".md", "");
              if (baseName && !files.includes(baseName)) {
                files.push(baseName);
              }
            } else {
              if (filename && !files.includes(filename)) {
                files.push(filename);
              }
            }
          }
        } catch (error) {
          console.warn("Failed to parse Obsidian URL:", urlString, error);
        }
      }
    }
    if (files.length > 0) {
      this.addFilesToContext(files);
    } else if (textPlainData && textPlainData.includes("obsidian://open?")) {
      new import_obsidian3.Notice("Only markdown files can be added to context", 3e3);
    } else if (textPlainData && textPlainData.trim() && !textPlainData.includes("://")) {
      new import_obsidian3.Notice("Folders cannot be added to context. Please select individual files.", 3e3);
    }
  }
  async addFilesToContext(filenames) {
    if (filenames.length === 0) return;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      new import_obsidian3.Notice("Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025.", 3e3);
      return;
    }
    if (this.sidebarView) {
      await this.sidebarView.addFilesToContext(filenames);
    }
  }
  refreshCommandButton() {
    if (this.commandSystem) {
      this.commandSystem.updateCommandButtonVisibility();
    }
  }
  updateContextState(hasContext) {
    if (this.container) {
      if (hasContext) {
        this.container.classList.add("has-context");
      } else {
        this.container.classList.remove("has-context");
      }
    }
  }
  cleanup() {
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.remove();
      this.dropZoneOverlay = null;
    }
    this.eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.eventListeners = [];
  }
};
_InputHandler.FOCUS_DELAY_MS = 150;
var InputHandler = _InputHandler;

// src/ui/command-system.ts
var import_obsidian4 = require("obsidian");
var CommandSystem = class {
  constructor(plugin, container, textArea) {
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.plugin = plugin;
    this.container = container;
    this.textArea = textArea;
  }
  createCommandButton(inputRow) {
    this.commandButton = new import_obsidian4.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: var(--size-2-3);
		`;
    return this.commandButton;
  }
  createCommandPicker() {
    this.createCommandPickerInContainer(this.container);
  }
  createCommandPickerInContainer(container) {
    this.commandPicker = container.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			margin-bottom: 4px;
		`;
  }
  shouldShowCommandButton() {
    return import_obsidian4.Platform.isMobile && this.plugin.settings.showCommandButton && this.plugin.featureManager.isFeatureEnabled("commands");
  }
  updateCommandButtonVisibility() {
    if (this.commandButton) {
      const shouldShow = this.shouldShowCommandButton();
      this.commandButton.buttonEl.style.display = shouldShow ? "flex" : "none";
    }
  }
  toggleCommandMenu() {
    if (!this.commandMenu) {
      this.createCommandMenu();
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  createCommandMenu() {
    this.commandMenu = this.container.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			box-shadow: var(--shadow-s);
			min-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			padding: var(--size-2-2);
		`;
    const commands = [
      { name: "Improve Writing", description: "Enhance clarity and flow", command: "improve writing" },
      { name: "Fix Grammar", description: "Correct grammar and spelling", command: "fix grammar" },
      { name: "Summarize", description: "Create a concise summary", command: "summarize" },
      { name: "Expand Ideas", description: "Develop thoughts further", command: "expand" },
      { name: "Explain", description: "Clarify complex concepts", command: "explain this" },
      { name: "Continue Writing", description: "Extend the current text", command: "continue writing" }
    ];
    const title = this.commandMenu.createEl("div", { text: "Quick Commands" });
    title.style.cssText = `
			font-size: var(--font-ui-medium);
			font-weight: 600;
			margin-bottom: var(--size-2-3);
			color: var(--text-normal);
		`;
    commands.forEach((cmd) => {
      const cmdEl = this.commandMenu.createDiv({ cls: "nova-command-item" });
      cmdEl.style.cssText = `
				padding: var(--size-2-2) var(--size-2-3);
				border-radius: var(--radius-xs);
				cursor: pointer;
				margin-bottom: var(--size-2-1);
				transition: background-color 0.1s;
			`;
      const nameEl = cmdEl.createEl("div", { text: cmd.name });
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
				margin-bottom: var(--size-2-1);
			`;
      const descEl = cmdEl.createEl("div", { text: cmd.description });
      descEl.style.cssText = `
				font-size: var(--font-ui-smaller);
				color: var(--text-muted);
			`;
      cmdEl.addEventListener("click", () => {
        this.textArea.setValue(cmd.command + " ");
        this.textArea.inputEl.focus();
        this.hideCommandMenu();
      });
      cmdEl.addEventListener("mouseenter", () => {
        cmdEl.style.background = "var(--background-modifier-hover)";
      });
      cmdEl.addEventListener("mouseleave", () => {
        cmdEl.style.background = "transparent";
      });
    });
  }
  showCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "block";
      this.isCommandMenuVisible = true;
    }
  }
  hideCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "none";
      this.isCommandMenuVisible = false;
    }
  }
  handleInputChange() {
    if (!this.textArea) {
      return;
    }
    const input = this.textArea.getValue();
    if (input.startsWith(":")) {
      this.showStructuredCommandPicker(input);
    } else {
      this.hideCommandPicker();
    }
  }
  /**
   * Show structured command picker for ":" trigger  
   */
  showStructuredCommandPicker(input) {
    if (!this.commandPicker) {
      return;
    }
    const structuredCommands = this.getStructuredCommands();
    const filterText = input.slice(1).toLowerCase();
    const filtered = structuredCommands.filter(
      (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
    );
    this.commandPickerItems = [];
    this.commandPicker.empty();
    this.selectedCommandIndex = -1;
    if (filtered.length > 0) {
      filtered.forEach((cmd, index) => {
        const item = this.commandPicker.createDiv({ cls: "nova-command-picker-item" });
        item.style.cssText = `
					padding: 8px 12px;
					cursor: pointer;
					border-bottom: 1px solid var(--background-modifier-border-hover);
					transition: background-color 0.2s;
				`;
        const nameEl = item.createEl("div", { text: cmd.name });
        nameEl.style.cssText = `
					font-weight: 500;
					color: var(--text-normal);
					margin-bottom: 4px;
				`;
        const descEl = item.createEl("div", { text: cmd.description });
        descEl.style.cssText = `
					font-size: 0.85em;
					color: var(--text-muted);
					margin-bottom: 4px;
				`;
        const exampleEl = item.createEl("div", { text: `Example: ${cmd.example}` });
        exampleEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-accent);
					font-family: var(--font-monospace);
				`;
        item.addEventListener("click", () => {
          this.selectStructuredCommand(cmd.template);
        });
        item.addEventListener("mouseenter", () => {
          this.selectedCommandIndex = index;
          this.updateCommandPickerSelection();
        });
        this.commandPickerItems.push(item);
      });
      this.commandPicker.style.display = "block";
    } else {
      this.hideCommandPicker();
    }
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
  }
  handleCommandPickerNavigation(key) {
    if (this.commandPickerItems.length === 0) return false;
    if (key === "ArrowDown") {
      this.selectedCommandIndex = Math.min(this.selectedCommandIndex + 1, this.commandPickerItems.length - 1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "ArrowUp") {
      this.selectedCommandIndex = Math.max(this.selectedCommandIndex - 1, -1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "Tab" && this.selectedCommandIndex >= 0) {
      return this.handleCommandPickerSelection();
    }
    return false;
  }
  handleCommandPickerSelection() {
    if (this.selectedCommandIndex >= 0 && this.commandPickerItems.length > 0) {
      const commands = this.getStructuredCommands();
      const input = this.textArea.getValue();
      if (input.startsWith(":")) {
        const filterText = input.slice(1).toLowerCase();
        const filtered = commands.filter(
          (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
        );
        if (this.selectedCommandIndex < filtered.length) {
          const selectedCmd = filtered[this.selectedCommandIndex];
          this.selectStructuredCommand(selectedCmd.template);
          return true;
        }
      }
    }
    return false;
  }
  updateCommandPickerSelection() {
    this.commandPickerItems.forEach((item, index) => {
      if (index === this.selectedCommandIndex) {
        item.style.background = "var(--background-modifier-hover)";
      } else {
        item.style.background = "transparent";
      }
    });
  }
  selectCommand(command) {
    this.textArea.setValue(command + " ");
    this.textArea.inputEl.focus();
    const length = this.textArea.getValue().length;
    this.textArea.inputEl.setSelectionRange(length, length);
    this.hideCommandPicker();
  }
  /**
   * Get structured commands for ":" trigger
   */
  getStructuredCommands() {
    return [
      {
        name: "Add Content",
        description: "Add new content at cursor position",
        command: "add",
        template: "add {cursor}",
        example: ":add paragraph about methodology",
        keywords: ["create", "new", "insert", "write"]
      },
      {
        name: "Edit Selection",
        description: "Edit the selected text",
        command: "edit",
        template: "edit to {cursor}",
        example: ":edit to be more formal",
        keywords: ["modify", "update", "change", "revise"]
      },
      {
        name: "Delete Selection",
        description: "Remove the selected text",
        command: "delete",
        template: "delete {cursor}",
        example: ":delete selected text",
        keywords: ["remove", "eliminate", "erase"]
      },
      {
        name: "Rewrite",
        description: "Rewrite content with specific style",
        command: "rewrite",
        template: "rewrite as {cursor}",
        example: ":rewrite as bullet points",
        keywords: ["rephrase", "restructure", "reword"]
      },
      {
        name: "Fix Grammar",
        description: "Correct grammar and spelling errors",
        command: "grammar",
        template: "fix grammar {cursor}",
        example: ":fix grammar in selection",
        keywords: ["correct", "proofread", "spelling"]
      },
      {
        name: "Continue",
        description: "Continue writing from current position",
        command: "continue",
        template: "continue {cursor}",
        example: ":continue with examples",
        keywords: ["extend", "expand", "proceed"]
      },
      {
        name: "Update Metadata",
        description: "Update document properties",
        command: "metadata",
        template: "update {cursor} property",
        example: ":update tags property",
        keywords: ["frontmatter", "properties", "tags"]
      }
    ];
  }
  /**
   * Select a structured command and insert template
   */
  selectStructuredCommand(template) {
    this.hideCommandPicker();
    const cursorPos = template.indexOf("{cursor}");
    if (cursorPos !== -1) {
      const beforeCursor = template.slice(0, cursorPos);
      const afterCursor = template.slice(cursorPos + 8);
      this.textArea.setValue(beforeCursor + afterCursor);
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(cursorPos, cursorPos);
        this.textArea.inputEl.focus();
      }, 0);
    } else {
      this.textArea.setValue(template);
      this.textArea.inputEl.focus();
    }
  }
  cleanup() {
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.remove();
    }
  }
};

// src/ui/context-manager.ts
var import_obsidian5 = require("obsidian");
var _ContextManager = class _ContextManager {
  constructor(plugin, app, container) {
    this.currentContext = null;
    this.plugin = plugin;
    this.app = app;
    this.container = container;
    this.multiDocHandler = new MultiDocContextHandler(app);
  }
  createContextIndicator() {
    this.contextIndicator = this.container.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			position: absolute;
			top: -2px;
			right: var(--size-4-3);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-1) var(--size-2-2);
			font-size: var(--font-ui-smaller);
			color: var(--text-muted);
			display: none;
			z-index: 100;
			max-width: 200px;
			box-shadow: var(--shadow-s);
		`;
  }
  createContextPreview() {
    const previewContainer = this.container.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			margin-bottom: var(--size-2-2);
			font-size: var(--font-ui-small);
			display: none;
		`;
    const previewLabel = previewContainer.createSpan({ text: "Context: " });
    previewLabel.style.cssText = "color: var(--text-muted); font-weight: 600;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview(message) {
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      foundRefs.push({ name: docName, property });
    }
    if (foundRefs.length === 0) {
      this.contextPreview.style.display = "none";
      return;
    }
    const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
    if (previewList) {
      const refsText = foundRefs.map(
        (ref) => ref.property ? `${ref.name}#${ref.property}` : ref.name
      ).join(", ");
      previewList.textContent = refsText;
    }
    this.contextPreview.style.display = "block";
  }
  async buildContext(message, currentFile) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context") || !currentFile) {
      return null;
    }
    try {
      const result = await this.multiDocHandler.buildContext(message, currentFile);
      this.currentContext = result.context;
      if ((_a = result.context) == null ? void 0 : _a.persistentDocs.length) {
        this.updateContextIndicator(result.context);
        if (result.context.isNearLimit) {
          new import_obsidian5.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _ContextManager.NOTICE_DURATION_MS);
        }
      }
      return result.context;
    } catch (error) {
      return null;
    }
  }
  updateContextIndicator(context) {
    if (!this.contextIndicator) return;
    const docCount = context.persistentDocs.length;
    if (docCount > 0) {
      this.contextIndicator.textContent = `${docCount} doc${docCount > 1 ? "s" : ""}`;
      this.contextIndicator.style.display = "block";
      this.contextIndicator.style.cursor = "pointer";
      this.contextIndicator.onclick = () => {
        this.showContextDetails(context);
      };
      this.contextIndicator.addEventListener("mouseenter", () => {
        this.contextIndicator.style.background = "var(--interactive-hover)";
      });
      this.contextIndicator.addEventListener("mouseleave", () => {
        this.contextIndicator.style.background = "var(--background-primary)";
      });
    } else {
      this.contextIndicator.style.display = "none";
    }
  }
  showContextDetails(context) {
    const modal = this.container.createDiv({ cls: "nova-context-modal" });
    modal.style.cssText = `
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 10000;
		`;
    const content = modal.createDiv();
    content.style.cssText = `
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-4-4);
			max-width: 80%;
			max-height: 80%;
			overflow-y: auto;
			box-shadow: var(--shadow-s);
		`;
    const header = content.createEl("h3", { text: "Context Documents" });
    header.style.cssText = "margin-top: 0; margin-bottom: var(--size-4-3);";
    context.persistentDocs.forEach((doc) => {
      const docEl = content.createDiv();
      docEl.style.cssText = `
				padding: var(--size-2-2);
				margin-bottom: var(--size-2-2);
				background: var(--background-modifier-hover);
				border-radius: var(--radius-xs);
			`;
      const nameEl = docEl.createEl("div", { text: doc.file.basename });
      nameEl.style.cssText = "font-weight: 600; margin-bottom: var(--size-2-1);";
      if (doc.property) {
        const propEl = docEl.createEl("div", { text: `Property: ${doc.property}` });
        propEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted);";
      }
      const previewEl = docEl.createEl("div", { text: doc.file.path });
      previewEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted); margin-top: var(--size-2-1);";
    });
    const closeBtn = content.createEl("button", { text: "Close" });
    closeBtn.style.cssText = `
			margin-top: var(--size-4-3);
			padding: var(--size-2-2) var(--size-4-3);
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
			border-radius: var(--radius-s);
			cursor: pointer;
		`;
    closeBtn.onclick = () => modal.remove();
    modal.onclick = (e) => {
      if (e.target === modal) modal.remove();
    };
  }
  hideContextPreview() {
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
  }
  hideContextIndicator() {
    if (this.contextIndicator) {
      this.contextIndicator.style.display = "none";
    }
  }
  clearCurrentContext() {
    this.currentContext = null;
    this.hideContextIndicator();
    this.hideContextPreview();
  }
  getCurrentContext() {
    return this.currentContext;
  }
  cleanup() {
    this.clearCurrentContext();
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.contextPreview) {
      this.contextPreview.remove();
    }
  }
};
_ContextManager.NOTICE_DURATION_MS = 5e3;
var ContextManager = _ContextManager;

// src/ui/chat-renderer.ts
var _ChatRenderer = class _ChatRenderer {
  constructor(plugin, chatContainer) {
    this.plugin = plugin;
    this.chatContainer = chatContainer;
  }
  /**
   * Add a chat message with role header
   */
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom(true);
  }
  /**
   * Helper method to create simple messages without role headers
   */
  createSimpleMessage(content, className) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${className}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom();
  }
  addErrorMessage(content) {
    this.createSimpleMessage(content, "nova-message-error");
  }
  addSuccessMessage(content) {
    this.createSimpleMessage(content, "nova-message-success");
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			padding: var(--size-4-4);
			margin-bottom: var(--size-4-3);
			background: var(--background-modifier-hover);
			border-radius: var(--radius-s);
			border: 1px solid var(--background-modifier-border);
			text-align: center;
			position: relative;
		`;
    const content = message || `
			<div style="display: flex; align-items: center; justify-content: center; gap: var(--size-2-3); margin-bottom: var(--size-4-2);">
				<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size-xl); height: var(--icon-size-xl); color: var(--interactive-accent);">
					<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
					<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				</svg>
				<span style="font-size: var(--font-ui-large); font-weight: 600; color: var(--text-normal);">Welcome to Nova</span>
			</div>
			<p style="margin: 0 0 var(--size-4-3) 0; color: var(--text-muted); font-size: var(--font-ui-medium);">
				Your AI thinking partner for Obsidian. Start a conversation or use commands to enhance your writing.
			</p>
			<p style="margin: 0; color: var(--text-faint); font-size: var(--font-ui-small);">
				\u{1F4A1} <strong>Tip:</strong> Reference other notes with [[Note Name]] or use the \u26A1 button for quick commands
			</p>
		`;
    welcomeEl.innerHTML = content;
    const dismissBtn = welcomeEl.createEl("button");
    dismissBtn.textContent = "\xD7";
    dismissBtn.style.cssText = `
			position: absolute;
			top: var(--size-2-2);
			right: var(--size-2-2);
			background: none;
			border: none;
			font-size: var(--font-ui-large);
			color: var(--text-faint);
			cursor: pointer;
			padding: var(--size-2-1);
			border-radius: var(--radius-xs);
		`;
    dismissBtn.addEventListener("click", () => {
      welcomeEl.remove();
    });
    dismissBtn.addEventListener("mouseenter", () => {
      dismissBtn.style.color = "var(--text-normal)";
      dismissBtn.style.background = "var(--background-modifier-hover)";
    });
    dismissBtn.addEventListener("mouseleave", () => {
      dismissBtn.style.color = "var(--text-faint)";
      dismissBtn.style.background = "none";
    });
    this.scrollToBottom(true);
  }
  clearChat() {
    this.chatContainer.empty();
  }
  scrollToBottom(smooth = false) {
    setTimeout(() => {
      if (smooth) {
        this.chatContainer.scrollTo({
          top: this.chatContainer.scrollHeight,
          behavior: "smooth"
        });
      } else {
        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
      }
    }, _ChatRenderer.SCROLL_DELAY_MS);
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
    for (const message of messages) {
      this.addMessage(message.role, message.content);
    }
  }
};
_ChatRenderer.SCROLL_DELAY_MS = 50;
var ChatRenderer = _ChatRenderer;

// src/ui/streaming-manager.ts
var import_obsidian6 = require("obsidian");
var _StreamingManager = class _StreamingManager {
  constructor() {
    this.dotsAnimationInterval = null;
    this.thinkingNotice = null;
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Show thinking notice with context-aware phrase and animated dots
   */
  showThinkingNotice(actionType) {
    try {
      const phrases = _StreamingManager.THINKING_PHRASES[actionType] || _StreamingManager.THINKING_PHRASES["chat"];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      this.thinkingNotice = new import_obsidian6.Notice(`Nova: ${randomPhrase}.`, 0);
      const initialNoticeText = `Nova: ${randomPhrase}.`;
      const noticeEl = this.thinkingNotice.noticeEl;
      if (noticeEl) {
        noticeEl.textContent = initialNoticeText;
      }
      this.startNoticeDotsAnimation(randomPhrase);
    } catch (error) {
      console.warn("Failed to create thinking notice:", error);
    }
  }
  /**
   * Start streaming at a specific position with hybrid approach
   * For selection replacement: startPos and endPos define the range to replace
   * For cursor insertion: startPos is the cursor position, endPos should be null
   */
  startStreaming(editor, startPos, endPos, options = {}) {
    this.originalPosition = { from: startPos, to: endPos };
    if (endPos) {
      editor.replaceRange("", startPos, endPos);
      this.currentStreamingEndPos = startPos;
    } else {
      this.currentStreamingEndPos = startPos;
    }
    this.streamingStartPos = null;
    const updateStream = (newText, isComplete) => {
      this.updateStreamingText(editor, newText, isComplete, options);
    };
    const stopStream = () => {
      this.stopAnimation();
      this.cleanup();
    };
    return { updateStream, stopStream };
  }
  /**
   * Update streaming text with proper position tracking
   */
  updateStreamingText(editor, newText, isComplete, options) {
    try {
      if (this.currentStreamingEndPos) {
        if (this.thinkingNotice) {
          this.stopDotsAnimation();
        }
        if (!this.streamingStartPos) {
          this.streamingStartPos = { ...this.currentStreamingEndPos };
        }
        const lines = newText.split("\n");
        const newEndPos = {
          line: this.streamingStartPos.line + lines.length - 1,
          ch: lines.length > 1 ? lines[lines.length - 1].length : this.streamingStartPos.ch + newText.length
        };
        editor.replaceRange(newText, this.streamingStartPos, this.currentStreamingEndPos);
        this.currentStreamingEndPos = newEndPos;
        if (options.onChunk) {
          options.onChunk(newText, isComplete);
        }
      }
      if (isComplete) {
        editor.setCursor(this.currentStreamingEndPos);
        this.cleanup();
        if (options.onComplete) {
          options.onComplete();
        }
      }
    } catch (error) {
      console.warn("Error updating streaming text:", error);
      this.cleanup();
      if (options.onError) {
        options.onError(error instanceof Error ? error : new Error(String(error)));
      }
    }
  }
  /**
   * Animate dots in notice text
   */
  startNoticeDotsAnimation(basePhrase) {
    let dotCount = 1;
    this.dotsAnimationInterval = setInterval(() => {
      try {
        if (!this.thinkingNotice) return;
        dotCount++;
        if (dotCount > 5) {
          dotCount = 1;
        }
        const dots = ".".repeat(dotCount);
        const noticeText = `Nova: ${basePhrase}${dots}`;
        const noticeEl = this.thinkingNotice.noticeEl;
        if (noticeEl) {
          noticeEl.textContent = noticeText;
        }
      } catch (error) {
        console.warn("Error in notice dots animation:", error);
        this.stopDotsAnimation();
      }
    }, 400);
  }
  /**
   * Stop the dots animation and dismiss notice
   */
  stopDotsAnimation() {
    if (this.dotsAnimationInterval) {
      clearInterval(this.dotsAnimationInterval);
      this.dotsAnimationInterval = null;
    }
    if (this.thinkingNotice) {
      this.thinkingNotice.hide();
      this.thinkingNotice = null;
    }
  }
  /**
   * Stop all animations and clean up
   */
  stopAnimation() {
    this.stopDotsAnimation();
  }
  /**
   * Clean up all internal state
   */
  cleanup() {
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Get the original position before streaming started
   */
  getOriginalPosition() {
    return this.originalPosition;
  }
  /**
   * Check if currently streaming
   */
  isStreaming() {
    return this.currentStreamingEndPos !== null;
  }
};
// Comprehensive thinking phrases for all action types
_StreamingManager.THINKING_PHRASES = {
  "improve": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "longer": [
    "expanding...",
    "developing...",
    "elaborating...",
    "building...",
    "enriching...",
    "deepening...",
    "growing...",
    "extending...",
    "amplifying...",
    "unfolding..."
  ],
  "shorter": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ],
  "tone": [
    "adjusting tone...",
    "reshaping...",
    "reframing...",
    "adapting...",
    "transforming...",
    "modulating...",
    "recasting...",
    "shifting...",
    "reforming...",
    "reimagining..."
  ],
  "custom": [
    "working on it...",
    "considering...",
    "thinking...",
    "processing...",
    "analyzing...",
    "contemplating...",
    "understanding...",
    "interpreting...",
    "exploring...",
    "evaluating..."
  ],
  "chat": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "add": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "edit": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "rewrite": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "grammar": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "delete": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ]
};
var StreamingManager = _StreamingManager;

// src/ui/selection-context-menu.ts
var import_obsidian10 = require("obsidian");

// src/core/commands/selection-edit-command.ts
var import_obsidian7 = require("obsidian");
var SelectionEditCommand = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Execute a selection-based edit action
   */
  async execute(action, editor, selectedText, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const loadingNotice = new import_obsidian7.Notice("Nova is processing your request...", 0);
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      const response = await this.plugin.aiProviderManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt
      );
      loadingNotice.hide();
      const transformedText = this.cleanAIResponse(response);
      return {
        success: true,
        transformedText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit command error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Execute a selection-based edit action with streaming
   */
  async executeStreaming(action, editor, selectedText, onChunk, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      await new Promise((resolve) => setTimeout(resolve, 1e3));
      let fullResponse = "";
      const stream = this.plugin.aiProviderManager.generateTextStream(prompt2.userPrompt, {
        systemPrompt: prompt2.systemPrompt
      });
      for await (const chunk of stream) {
        if (chunk.error) {
          throw new Error(chunk.error);
        }
        fullResponse += chunk.content;
        const cleanedChunk = this.cleanAIResponse(fullResponse);
        onChunk(cleanedChunk, chunk.done);
        if (chunk.done) {
          break;
        }
        await new Promise((resolve) => setTimeout(resolve, 50));
      }
      return {
        success: true,
        transformedText: this.cleanAIResponse(fullResponse),
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit streaming error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Build prompt for the AI based on the action type
   */
  buildPrompt(action, selectedText, customInstruction) {
    const baseSystemPrompt = `You are Nova, an AI writing assistant. Your task is to transform the provided text according to the user's request. 

CRITICAL RULES:
- Provide ONLY the transformed text, no explanations or meta-commentary
- Maintain the original meaning unless specifically asked to change it
- Preserve the original format (markdown, structure, etc.) unless instructed otherwise
- Do not add introductory phrases like "Here's the improved text:" or similar
- Return only the content that should replace the selected text`;
    let specificPrompt = "";
    let userPrompt = "";
    switch (action) {
      case "improve":
        specificPrompt = `
TASK: Improve the writing quality
- Make the text clearer and more concise
- Improve flow and readability
- Fix any awkward phrasing
- Preserve the original tone and meaning`;
        userPrompt = `Improve this text:

${selectedText}`;
        break;
      case "longer":
        specificPrompt = `
TASK: Expand the text with more detail
- Add relevant examples, context, or explanations
- Maintain the original style and voice
- Expand ideas without changing the core message
- Make it more comprehensive and detailed`;
        userPrompt = `Make this text longer and more detailed:

${selectedText}`;
        break;
      case "shorter":
        specificPrompt = `
TASK: Condense the text to essential points
- Remove redundancy and unnecessary words
- Keep all key information and meaning
- Make it more concise and direct
- Preserve the original tone`;
        userPrompt = `Make this text shorter and more concise:

${selectedText}`;
        break;
      case "tone":
        const toneMap = {
          "formal": "professional and structured, suitable for business or academic contexts",
          "casual": "relaxed and conversational, suitable for informal communication",
          "academic": "scholarly and precise, using technical vocabulary where appropriate",
          "friendly": "warm and approachable, building connection with the reader"
        };
        const toneDescription = toneMap[customInstruction || "formal"] || toneMap.formal;
        specificPrompt = `
TASK: Change the tone to be ${toneDescription}
- Adjust language and vocabulary to match the requested tone
- Keep the same content and meaning
- Maintain appropriate formality level for the chosen tone`;
        userPrompt = `Rewrite this text in a ${customInstruction || "formal"} tone:

${selectedText}`;
        break;
      case "custom":
        specificPrompt = `
TASK: Apply custom transformation
- Follow the user's specific instruction exactly
- Maintain content integrity unless asked to change it
- Apply the requested changes precisely`;
        userPrompt = `Apply this instruction to the text: "${customInstruction}"

Text to transform:

${selectedText}`;
        break;
      default:
        specificPrompt = `
TASK: General text improvement
- Enhance clarity and readability
- Preserve original meaning and tone`;
        userPrompt = `Improve this text:

${selectedText}`;
    }
    return {
      systemPrompt: baseSystemPrompt + "\n" + specificPrompt,
      userPrompt
    };
  }
  /**
   * Clean AI response to extract only the transformed text
   */
  cleanAIResponse(response) {
    let cleaned = response.trim();
    const introPatterns = [
      /^Here's the improved text:?\s*/i,
      /^Here's the rewritten text:?\s*/i,
      /^Here's the transformed text:?\s*/i,
      /^Improved version:?\s*/i,
      /^Rewritten:?\s*/i,
      /^Result:?\s*/i,
      /^Output:?\s*/i
    ];
    for (const pattern of introPatterns) {
      cleaned = cleaned.replace(pattern, "");
    }
    cleaned = cleaned.split(/\n\s*---+\s*/).shift() || cleaned;
    cleaned = cleaned.split(/\n\s*\*\*?Explanation\*?\*?:/i).shift() || cleaned;
    return cleaned.trim();
  }
};

// src/ui/tone-selection-modal.ts
var import_obsidian8 = require("obsidian");
var TONE_OPTIONS = [
  {
    id: "formal",
    label: "Formal",
    description: "Professional, structured language suitable for business or academic contexts"
  },
  {
    id: "casual",
    label: "Casual",
    description: "Relaxed, conversational tone for informal communication"
  },
  {
    id: "academic",
    label: "Academic",
    description: "Scholarly, precise language with technical vocabulary"
  },
  {
    id: "friendly",
    label: "Friendly",
    description: "Warm, approachable tone that builds connection"
  }
];
var ToneSelectionModal = class extends import_obsidian8.Modal {
  constructor(app, onSelect, onCancel) {
    super(app);
    this.selectedTone = null;
    this.applyButton = null;
    this.onSelect = onSelect;
    this.onCancel = onCancel;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Choose Writing Tone" });
    contentEl.createEl("p", {
      text: "Select how you want Nova to adjust the tone of your selected text:",
      cls: "setting-item-description"
    });
    const toneContainer = contentEl.createDiv({ cls: "nova-tone-options" });
    TONE_OPTIONS.forEach((tone) => {
      const optionEl = toneContainer.createDiv({
        cls: "nova-tone-option"
      });
      optionEl.style.cssText = `
                padding: var(--size-4-3);
                margin-bottom: var(--size-2-2);
                border: 1px solid var(--background-modifier-border);
                border-radius: var(--radius-s);
                cursor: pointer;
                transition: all 0.2s ease;
            `;
      const headerEl = optionEl.createDiv({ cls: "nova-tone-header" });
      headerEl.style.cssText = `
                display: flex;
                align-items: center;
                margin-bottom: var(--size-2-1);
            `;
      const radioEl = headerEl.createSpan({ cls: "nova-tone-radio" });
      radioEl.style.cssText = `
                width: 16px;
                height: 16px;
                border: 2px solid var(--interactive-normal);
                border-radius: 50%;
                margin-right: var(--size-2-2);
                transition: all 0.2s ease;
            `;
      const labelEl = headerEl.createSpan({
        text: tone.label,
        cls: "nova-tone-label"
      });
      labelEl.style.cssText = `
                font-weight: 600;
                color: var(--text-normal);
            `;
      const descEl = optionEl.createDiv({
        text: tone.description,
        cls: "nova-tone-description"
      });
      descEl.style.cssText = `
                font-size: var(--font-ui-smaller);
                color: var(--text-muted);
                line-height: 1.4;
            `;
      optionEl.addEventListener("click", () => {
        this.selectTone(tone.id);
      });
      optionEl.addEventListener("mouseenter", () => {
        optionEl.style.borderColor = "var(--interactive-accent)";
        optionEl.style.backgroundColor = "var(--background-modifier-hover)";
      });
      optionEl.addEventListener("mouseleave", () => {
        if (this.selectedTone !== tone.id) {
          optionEl.style.borderColor = "var(--background-modifier-border)";
          optionEl.style.backgroundColor = "";
        }
      });
      optionEl.setAttribute("data-tone", tone.id);
    });
    const buttonContainer = contentEl.createDiv({ cls: "nova-tone-buttons" });
    buttonContainer.style.cssText = `
            display: flex;
            gap: var(--size-2-3);
            justify-content: flex-end;
            margin-top: var(--size-4-4);
            padding-top: var(--size-4-3);
            border-top: 1px solid var(--background-modifier-border);
        `;
    const cancelBtn = new import_obsidian8.ButtonComponent(buttonContainer);
    cancelBtn.setButtonText("Cancel");
    cancelBtn.onClick(() => {
      this.close();
      this.onCancel();
    });
    const applyBtn = new import_obsidian8.ButtonComponent(buttonContainer);
    applyBtn.setButtonText("Apply Tone");
    applyBtn.setCta();
    applyBtn.setDisabled(true);
    applyBtn.onClick(() => {
      if (this.selectedTone) {
        this.close();
        this.onSelect(this.selectedTone);
      }
    });
    this.applyButton = applyBtn;
  }
  selectTone(toneId) {
    this.selectedTone = toneId;
    const options = this.contentEl.querySelectorAll(".nova-tone-option");
    options.forEach((option) => {
      const optionEl = option;
      const radio = optionEl.querySelector(".nova-tone-radio");
      if (optionEl.getAttribute("data-tone") === toneId) {
        optionEl.style.borderColor = "var(--interactive-accent)";
        optionEl.style.backgroundColor = "var(--background-modifier-selected)";
        radio.style.backgroundColor = "var(--interactive-accent)";
        radio.style.borderColor = "var(--interactive-accent)";
      } else {
        optionEl.style.borderColor = "var(--background-modifier-border)";
        optionEl.style.backgroundColor = "";
        radio.style.backgroundColor = "";
        radio.style.borderColor = "var(--interactive-normal)";
      }
    });
    if (this.applyButton) {
      this.applyButton.setDisabled(false);
    }
  }
  onClose() {
  }
};

// src/ui/custom-instruction-modal.ts
var import_obsidian9 = require("obsidian");
var CustomInstructionModal = class extends import_obsidian9.Modal {
  constructor(app, onSubmit, onCancel) {
    super(app);
    this.instruction = "";
    this.textAreaComponent = null;
    this.submitButton = null;
    this.onSubmit = onSubmit;
    this.onCancel = onCancel;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    if (import_obsidian9.Platform.isMobile) {
      this.modalEl.style.cssText = `
                width: 95vw !important;
                height: auto !important;
                max-width: none !important;
                max-height: 80vh !important;
                margin: 0 !important;
                top: 60px !important;
                left: 2.5vw !important;
                transform: none !important;
                border-radius: var(--radius-m);
                position: fixed !important;
            `;
      contentEl.style.cssText = `
                display: flex;
                flex-direction: column;
                padding: var(--size-4-2);
                max-height: 80vh;
                overflow-y: auto;
            `;
    }
    const titleEl = contentEl.createEl("h2", { text: "Tell Nova" });
    if (import_obsidian9.Platform.isMobile) {
      titleEl.style.cssText = `
                font-size: var(--font-ui-large);
                margin: 0 0 var(--size-2-1) 0;
            `;
    }
    const descEl = contentEl.createEl("p", {
      text: "Describe how you want Nova to transform your selected text:",
      cls: "setting-item-description"
    });
    if (import_obsidian9.Platform.isMobile) {
      descEl.style.cssText = `
                font-size: var(--font-ui-medium);
                margin: 0 0 var(--size-2-3) 0;
                line-height: 1.3;
            `;
    }
    const inputContainer = contentEl.createDiv({ cls: "nova-custom-instruction-input" });
    if (import_obsidian9.Platform.isMobile) {
      inputContainer.style.cssText = `
                margin: 0 0 var(--size-4-3) 0;
            `;
    } else {
      inputContainer.style.cssText = `
                margin: var(--size-4-3) 0;
            `;
    }
    this.textAreaComponent = new import_obsidian9.TextAreaComponent(inputContainer);
    this.textAreaComponent.setPlaceholder('e.g., "make this more persuasive", "add statistics", "write in bullet points"');
    if (import_obsidian9.Platform.isMobile) {
      this.textAreaComponent.inputEl.style.cssText = `
                width: 100%;
                min-height: 90px;
                max-height: 140px;
                resize: vertical;
                border-radius: var(--radius-m);
                padding: var(--size-4-3);
                border: 1px solid var(--background-modifier-border);
                background: var(--background-primary);
                color: var(--text-normal);
                font-family: var(--font-interface);
                font-size: var(--font-ui-medium);
                line-height: 1.4;
                -webkit-appearance: none;
                touch-action: manipulation;
            `;
    } else {
      this.textAreaComponent.inputEl.style.cssText = `
                width: 100%;
                min-height: 80px;
                max-height: 150px;
                resize: vertical;
                border-radius: var(--radius-s);
                padding: var(--size-2-2) var(--size-2-3);
                border: 1px solid var(--background-modifier-border);
                background: var(--background-primary);
                color: var(--text-normal);
                font-family: var(--font-interface);
                font-size: var(--font-ui-medium);
                line-height: 1.4;
            `;
    }
    this.textAreaComponent.onChange((value) => {
      this.instruction = value;
      this.updateSubmitButton();
    });
    const buttonContainer = contentEl.createDiv({ cls: "nova-instruction-buttons" });
    if (import_obsidian9.Platform.isMobile) {
      buttonContainer.style.cssText = `
                display: flex;
                gap: var(--size-2-3);
                justify-content: stretch;
                margin-top: var(--size-4-3);
                padding-top: var(--size-4-3);
                border-top: 1px solid var(--background-modifier-border);
            `;
    } else {
      buttonContainer.style.cssText = `
                display: flex;
                gap: var(--size-2-3);
                justify-content: flex-end;
                margin-top: var(--size-4-4);
                padding-top: var(--size-4-3);
                border-top: 1px solid var(--background-modifier-border);
            `;
    }
    const cancelBtn = new import_obsidian9.ButtonComponent(buttonContainer);
    cancelBtn.setButtonText("Cancel");
    if (import_obsidian9.Platform.isMobile) {
      cancelBtn.buttonEl.style.cssText = `
                flex: 1;
                min-height: 48px;
                font-size: var(--font-ui-medium);
                padding: var(--size-4-3);
                border-radius: var(--radius-m);
                touch-action: manipulation;
            `;
    }
    cancelBtn.onClick(() => {
      this.close();
      this.onCancel();
    });
    this.submitButton = new import_obsidian9.ButtonComponent(buttonContainer);
    this.submitButton.setButtonText("Transform Text");
    this.submitButton.setCta();
    this.submitButton.setDisabled(true);
    if (import_obsidian9.Platform.isMobile) {
      this.submitButton.buttonEl.style.cssText = `
                flex: 2;
                min-height: 48px;
                font-size: var(--font-ui-medium);
                padding: var(--size-4-3);
                border-radius: var(--radius-m);
                touch-action: manipulation;
            `;
    }
    this.submitButton.onClick(() => {
      if (this.instruction.trim()) {
        this.close();
        this.onSubmit(this.instruction.trim());
      }
    });
    setTimeout(() => {
      var _a;
      (_a = this.textAreaComponent) == null ? void 0 : _a.inputEl.focus();
    }, 100);
    this.textAreaComponent.inputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();
        if (this.instruction.trim()) {
          this.close();
          this.onSubmit(this.instruction.trim());
        }
      }
    });
  }
  updateSubmitButton() {
    if (this.submitButton) {
      this.submitButton.setDisabled(!this.instruction.trim());
    }
  }
  onClose() {
  }
};

// src/ui/selection-context-menu.ts
var SELECTION_ACTIONS = [
  {
    id: "improve",
    label: "Improve Writing",
    icon: "sparkles",
    description: "Make text clearer, more concise, better flow"
  },
  {
    id: "longer",
    label: "Make Longer",
    icon: "plus-circle",
    description: "Expand ideas with more detail and examples"
  },
  {
    id: "shorter",
    label: "Make Shorter",
    icon: "minus-circle",
    description: "Condense to essential points"
  },
  {
    id: "tone",
    label: "Change Tone",
    icon: "palette",
    description: "Adjust writing style and tone"
  },
  {
    id: "custom",
    label: "Tell Nova...",
    icon: "message-circle",
    description: "Custom instruction for transformation"
  }
];
var _SelectionContextMenu = class _SelectionContextMenu {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    /**
     * Update text with streaming effect
     */
    this.currentStreamingEndPos = null;
    this.streamingTextContainer = null;
    this.streamingStartPos = null;
    this.animatedSelection = null;
    this.dotsAnimationInterval = null;
    this.thinkingNotice = null;
    this.originalSelectionRange = null;
    this.selectionEditCommand = new SelectionEditCommand(plugin);
  }
  /**
   * Register the context menu with Obsidian's editor
   */
  register() {
    this.plugin.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor) => {
        this.addNovaSubmenu(menu, editor);
      })
    );
  }
  /**
   * Add Nova submenu to the context menu if text is selected
   */
  addNovaSubmenu(menu, editor) {
    const selectedText = editor.getSelection();
    if (!selectedText || selectedText.trim().length === 0) {
      return;
    }
    menu.addSeparator();
    SELECTION_ACTIONS.forEach((action) => {
      menu.addItem((item) => {
        item.setTitle(`Nova: ${action.label}`).setIcon(action.icon || "edit").onClick(() => {
          this.handleSelectionAction(action.id, editor, selectedText);
        });
      });
    });
  }
  /**
   * Handle selection action when menu item is clicked
   */
  async handleSelectionAction(actionId, editor, selectedText, customInstruction) {
    try {
      if (actionId === "tone" && !customInstruction) {
        this.showToneSelectionModal(editor, selectedText);
        return;
      }
      if (actionId === "custom" && !customInstruction) {
        this.showCustomInstructionModal(editor, selectedText);
        return;
      }
      await this.executeSelectionEdit(actionId, editor, selectedText, customInstruction);
    } catch (error) {
      console.error("Error executing Nova selection action:", error);
      new import_obsidian10.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show tone selection modal
   */
  showToneSelectionModal(editor, selectedText) {
    const modal = new ToneSelectionModal(
      this.app,
      async (selectedTone) => {
        await this.executeSelectionEdit("tone", editor, selectedText, selectedTone);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Show custom instruction modal
   */
  showCustomInstructionModal(editor, selectedText) {
    const modal = new CustomInstructionModal(
      this.app,
      async (instruction) => {
        await this.executeSelectionEdit("custom", editor, selectedText, instruction);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Execute the selection edit command with streaming
   */
  async executeSelectionEdit(actionId, editor, selectedText, customInstruction) {
    this.startSelectionAnimation(editor);
    const originalRange = {
      from: editor.getCursor("from"),
      to: editor.getCursor("to")
    };
    try {
      await this.showThinkingAnimation(editor, originalRange.from, originalRange.to, actionId);
      const result = await this.selectionEditCommand.executeStreaming(
        actionId,
        editor,
        selectedText,
        (chunk, isComplete) => {
          this.updateStreamingText(editor, chunk, originalRange.from, isComplete);
        },
        customInstruction
      );
      if (result.success) {
        const actionName = this.getActionDisplayName(actionId);
        new import_obsidian10.Notice(`Nova: Text ${actionName} successfully`, 2e3);
        this.addSuccessChatMessage(actionId, selectedText, customInstruction);
      } else {
        new import_obsidian10.Notice(`Nova: ${result.error || "Failed to process text"}`, 3e3);
        this.addFailureChatMessage(actionId, result.error || "Failed to process text");
      }
    } catch (error) {
      console.error("Error in streaming selection edit:", error);
      new import_obsidian10.Notice("Failed to execute Nova action. Please try again.", 3e3);
    } finally {
      this.stopSelectionAnimation();
      this.stopDotsAnimation();
    }
  }
  updateStreamingText(editor, newText, startPos, isComplete) {
    try {
      if (this.currentStreamingEndPos) {
        if (this.thinkingNotice) {
          this.stopDotsAnimation();
        }
        if (!this.streamingStartPos) {
          this.streamingStartPos = { ...this.currentStreamingEndPos };
        }
        const lines = newText.split("\n");
        const newEndPos = {
          line: this.streamingStartPos.line + lines.length - 1,
          ch: lines.length > 1 ? lines[lines.length - 1].length : this.streamingStartPos.ch + newText.length
        };
        editor.replaceRange(newText, this.streamingStartPos, this.currentStreamingEndPos);
        this.currentStreamingEndPos = newEndPos;
      }
      if (isComplete) {
        editor.setCursor(this.currentStreamingEndPos);
        this.currentStreamingEndPos = null;
        this.streamingStartPos = null;
        this.originalSelectionRange = null;
      }
    } catch (error) {
      console.warn("Error updating streaming text:", error);
      this.currentStreamingEndPos = null;
      this.streamingStartPos = null;
      this.originalSelectionRange = null;
    }
  }
  /**
   * Start pulsing animation on selected text
   */
  startSelectionAnimation(editor) {
    var _a;
    try {
      const editorContainer = ((_a = editor.cm) == null ? void 0 : _a.dom) || document.querySelector(".cm-editor");
      if (editorContainer) {
        editorContainer.classList.add("nova-selection-processing");
      }
      const selection = editor.getSelection();
      if (selection) {
        this.animatedSelection = {
          from: editor.getCursor("from"),
          to: editor.getCursor("to")
        };
      }
    } catch (error) {
      console.warn("Failed to start selection animation:", error);
    }
  }
  /**
   * Stop pulsing animation
   */
  stopSelectionAnimation() {
    try {
      const editorElements = document.querySelectorAll(".CodeMirror, .cm-editor");
      editorElements.forEach((el) => {
        el.classList.remove("nova-selection-processing");
      });
      this.animatedSelection = null;
    } catch (error) {
      console.warn("Failed to stop selection animation:", error);
    }
  }
  /**
   * Show Nova thinking animation with notice + document placeholder
   */
  async showThinkingAnimation(editor, startPos, endPos, actionId) {
    try {
      const phrases = _SelectionContextMenu.THINKING_PHRASES[actionId] || _SelectionContextMenu.THINKING_PHRASES["custom"];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      this.showThinkingNotice(randomPhrase);
      editor.replaceRange("", startPos, endPos);
      this.currentStreamingEndPos = startPos;
      this.originalSelectionRange = { from: startPos, to: endPos };
    } catch (error) {
      console.warn("Failed to show thinking animation:", error);
    }
  }
  /**
   * Show thinking notice with animated dots
   */
  showThinkingNotice(basePhrase) {
    try {
      this.thinkingNotice = new import_obsidian10.Notice(`Nova: ${basePhrase}.`, 0);
      const initialNoticeText = `Nova: ${basePhrase}.`;
      const noticeEl = this.thinkingNotice.noticeEl;
      if (noticeEl) {
        noticeEl.textContent = initialNoticeText;
      }
      this.startNoticeDotsAnimation(basePhrase);
    } catch (error) {
      console.warn("Failed to create thinking notice:", error);
    }
  }
  /**
   * Animate dots in notice text
   */
  startNoticeDotsAnimation(basePhrase) {
    let dotCount = 1;
    this.dotsAnimationInterval = setInterval(() => {
      try {
        if (!this.thinkingNotice) return;
        dotCount++;
        if (dotCount > 5) {
          dotCount = 1;
        }
        const dots = ".".repeat(dotCount);
        const noticeText = `Nova: ${basePhrase}${dots}`;
        const noticeEl = this.thinkingNotice.noticeEl;
        if (noticeEl) {
          noticeEl.textContent = noticeText;
        }
      } catch (error) {
        console.warn("Error in notice dots animation:", error);
        this.stopDotsAnimation();
      }
    }, 400);
  }
  /**
   * Stop the dots animation and dismiss notice
   */
  stopDotsAnimation() {
    if (this.dotsAnimationInterval) {
      clearInterval(this.dotsAnimationInterval);
      this.dotsAnimationInterval = null;
    }
    if (this.thinkingNotice) {
      this.thinkingNotice.hide();
      this.thinkingNotice = null;
    }
  }
  /**
   * Get display name for action
   */
  getActionDisplayName(actionId) {
    switch (actionId) {
      case "improve":
        return "improved";
      case "longer":
        return "expanded";
      case "shorter":
        return "condensed";
      case "tone":
        return "tone adjusted";
      case "custom":
        return "transformed";
      default:
        return "processed";
    }
  }
  /**
   * Add success message to chat
   */
  addSuccessChatMessage(actionId, originalText, customInstruction) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView && sidebarView.chatRenderer) {
          const actionDescription = this.getActionDescription(actionId, customInstruction);
          const truncatedText = originalText.length > 50 ? originalText.substring(0, 50) + "..." : originalText;
          const message = `\u2713 ${actionDescription} text: "${truncatedText}"`;
          sidebarView.chatRenderer.addSuccessMessage(message);
        }
      }
    } catch (error) {
      console.warn("Failed to add success chat message:", error);
    }
  }
  /**
   * Add failure message to chat
   */
  addFailureChatMessage(actionId, errorMessage) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView && sidebarView.chatRenderer) {
          const actionName = this.getActionDisplayName(actionId);
          const message = `\u2717 Failed to ${actionName.replace("ed", "")} text: ${errorMessage}`;
          sidebarView.chatRenderer.addErrorMessage(message);
        }
      }
    } catch (error) {
      console.warn("Failed to add error chat message:", error);
    }
  }
  /**
   * Get detailed action description for chat
   */
  getActionDescription(actionId, customInstruction) {
    switch (actionId) {
      case "improve":
        return "Improved";
      case "longer":
        return "Expanded";
      case "shorter":
        return "Condensed";
      case "tone":
        return `Changed tone to ${customInstruction || "formal"}`;
      case "custom":
        return `Applied "${customInstruction}"`;
      default:
        return "Processed";
    }
  }
};
// Dynamic thinking phrases for each action type
_SelectionContextMenu.THINKING_PHRASES = {
  "improve": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "longer": [
    "expanding...",
    "developing...",
    "elaborating...",
    "building...",
    "enriching...",
    "deepening...",
    "growing...",
    "extending...",
    "amplifying...",
    "unfolding..."
  ],
  "shorter": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ],
  "tone": [
    "adjusting tone...",
    "reshaping...",
    "reframing...",
    "adapting...",
    "transforming...",
    "modulating...",
    "recasting...",
    "shifting...",
    "reforming...",
    "reimagining..."
  ],
  "custom": [
    "working on it...",
    "considering...",
    "thinking...",
    "processing...",
    "analyzing...",
    "contemplating...",
    "understanding...",
    "interpreting...",
    "exploring...",
    "evaluating..."
  ]
};
var SelectionContextMenu = _SelectionContextMenu;

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var _NovaSidebarView = class _NovaSidebarView extends import_obsidian11.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.currentContext = null;
    // Command system delegation
    this._commandPickerItems = [];
    this._selectedCommandIndex = -1;
    this._isCommandMenuVisible = false;
    // Cursor position tracking - file-scoped like conversation history
    this.currentFileCursorPosition = null;
    // Performance optimization - debouncing and timing constants
    this.contextPreviewDebounceTimeout = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  // Cursor-only architecture - delegate to new components
  get textArea() {
    var _a;
    return (_a = this.inputHandler) == null ? void 0 : _a.getTextArea();
  }
  get wikilinkAutocomplete() {
    return this.inputHandler ? { destroy: () => {
    } } : null;
  }
  get autoGrowTextarea() {
    return () => {
    };
  }
  get commandPickerItems() {
    return this._commandPickerItems;
  }
  set commandPickerItems(value) {
    this._commandPickerItems = value;
  }
  get selectedCommandIndex() {
    return this._selectedCommandIndex;
  }
  set selectedCommandIndex(value) {
    this._selectedCommandIndex = value;
  }
  get isCommandMenuVisible() {
    return this._isCommandMenuVisible;
  }
  set isCommandMenuVisible(value) {
    this._isCommandMenuVisible = value;
  }
  // Context system delegation
  get contextPreview() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextPreview;
  }
  get contextIndicator() {
    var _a;
    return this._contextIndicator || ((_a = this.contextManager) == null ? void 0 : _a.contextIndicator);
  }
  set contextIndicator(value) {
    this._contextIndicator = value;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    if (import_obsidian11.Platform.isMobile) {
      container.addClass("is-mobile");
    } else {
      container.addClass("is-desktop");
    }
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian11.Platform.isDesktopApp ? "var(--size-4-6)" : "var(--size-4-5)"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: var(--size-4-2);
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: var(--font-ui-medium); display: flex; align-items: center; gap: var(--size-2-2);";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size); height: var(--icon-size);">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: var(--size-2-3);";
    const privacyIndicator = rightContainer.createSpan({ cls: "nova-privacy-indicator" });
    privacyIndicator.style.cssText = `
			display: flex;
			align-items: center;
			padding: 4px;
			color: var(--icon-color);
			font-weight: var(--font-weight-medium);
		`;
    this.updatePrivacyIndicator(privacyIndicator);
    this.privacyIndicator = privacyIndicator;
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian11.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-change", (editor) => {
        this.trackCursorPosition(editor);
      })
    );
    this.loadConversationForActiveFile();
    setTimeout(() => this.refreshProviderStatus(), 100);
  }
  /**
   * Track cursor position changes in the active editor (file-scoped)
   */
  trackCursorPosition(editor) {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile || !editor) {
      return;
    }
    if (this.currentFile && activeFile.path === this.currentFile.path) {
      const cursorPos = editor.getCursor();
      if (cursorPos) {
        this.currentFileCursorPosition = cursorPos;
      }
    }
  }
  /**
   * Restore cursor position for current file (file-scoped)
   */
  restoreCursorPosition() {
    if (this.currentFileCursorPosition) {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (editor) {
        editor.setCursor(this.currentFileCursorPosition);
      }
    }
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
      this.contextPreviewDebounceTimeout = null;
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: var(--size-4-2);
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: var(--size-2-3);
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements using new architecture
   */
  createInputArea() {
    this.inputContainer.empty();
    this.contextManager = new ContextManager(this.plugin, this.app, this.inputContainer);
    this.chatRenderer = new ChatRenderer(this.plugin, this.chatContainer);
    this.streamingManager = new StreamingManager();
    this.selectionContextMenu = new SelectionContextMenu(this.app, this.plugin);
    this.inputHandler = new InputHandler(this.plugin, this.inputContainer, this.contextManager);
    this.inputHandler.setSidebarView(this);
    this.inputHandler.createInputInterface(this.chatContainer);
    this.commandSystem = new CommandSystem(this.plugin, this.inputContainer, this.inputHandler.getTextArea());
    this.inputHandler.setCommandSystem(this.commandSystem);
    this.inputHandler.setOnSendMessage((message) => {
      this.handleSend(message);
    });
    this.contextManager.createContextIndicator();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  /**
   * Helper method to create simple messages without role headers
   */
  createSimpleMessage(content, className) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${className}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  addErrorMessage(content) {
    this.createSimpleMessage(content, "nova-message-error");
  }
  addSuccessMessage(content) {
    this.createSimpleMessage(content, "nova-message-success");
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: var(--size-4-3);
			margin: var(--size-4-4) auto;
			padding: var(--size-4-4) var(--size-4-5);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-l);
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: var(--icon-size-xl);
			height: var(--icon-size-xl);
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size-xl); height: var(--icon-size-xl); color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Hi! I'm Nova." });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: var(--text-success); display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addMessage("system", this.createIconMessage("zap", "Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025."));
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addSuccessMessage(this.createIconMessage("refresh-cw", `Switched to ${this.getProviderWithModelDisplayName(providerId)}`));
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.inputHandler.getTextArea().setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addMessage("system", this.createIconMessage("edit", `Loaded template: ${customCommand.name}`));
        return true;
      }
    }
    this.addErrorMessage(this.createIconMessage("help-circle", `Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`));
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker nova-panel-base" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.inputHandler.getTextArea().getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("commands")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item nova-panel-item" });
      const triggerEl = item.createSpan({ cls: "nova-command-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      const nameEl = item.createSpan({ cls: "nova-command-name nova-panel-text" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1;";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.removeClass("selected");
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].addClass("selected");
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    var _a;
    const commands = [];
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
    const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
    if (selectedText && selectedText.trim().length > 0) {
      SELECTION_ACTIONS.forEach((action) => {
        commands.push({
          trigger: action.id,
          name: `Nova: ${action.label}`,
          description: action.description
        });
      });
      commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Provider Commands" });
    }
    commands.push(
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" }
    );
    if (import_obsidian11.Platform.isDesktopApp) {
      commands.push({ trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" });
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      if (customCommands.length > 0) {
        commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Custom Commands" });
        customCommands.forEach((cmd) => {
          commands.push({
            trigger: cmd.trigger,
            name: cmd.name,
            ...cmd.description && { description: cmd.description }
          });
        });
      }
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu nova-panel-base" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addMessage("system", this.createIconMessage("zap", "Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025."));
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header nova-panel-header" });
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      if (command.trigger === "---") {
        const separator = this.commandMenu.createDiv({ cls: "nova-command-menu-separator" });
        separator.style.cssText = `
					padding: 8px 16px 4px 16px;
					font-size: 0.75em;
					color: var(--text-muted);
					font-weight: 600;
					text-transform: uppercase;
					letter-spacing: 0.5px;
					border-top: 1px solid var(--background-modifier-border);
					margin-top: 4px;
					cursor: default;
				`;
        separator.textContent = command.description || "";
        return;
      }
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item nova-panel-item-vertical" });
      const nameEl = item.createDiv({ cls: "nova-command-menu-name nova-panel-text" });
      nameEl.textContent = command.name;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.opacity = "0.8";
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  async executeCommandFromMenu(trigger) {
    var _a;
    this.hideCommandMenu();
    const selectionAction = SELECTION_ACTIONS.find((action) => action.id === trigger);
    if (selectionAction) {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
      const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
      if ((activeView == null ? void 0 : activeView.editor) && selectedText && selectedText.trim().length > 0) {
        await this.selectionContextMenu.handleSelectionAction(trigger, activeView.editor, selectedText);
      } else {
        new import_obsidian11.Notice("No text selected. Please select text to use Nova editing commands.", 3e3);
      }
      return;
    }
    if (trigger === "---") {
      return;
    }
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  /**
   * Debounced version of updateLiveContextPreview for performance
   */
  debouncedUpdateContextPreview() {
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
    }
    this.contextPreviewDebounceTimeout = setTimeout(() => {
      this.updateLiveContextPreview();
      this.contextPreviewDebounceTimeout = null;
    }, _NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS);
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.inputHandler.getTextArea().getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian11.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian11.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian11.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext || !this.currentContext.persistentDocs) {
      this.contextIndicator.style.display = "none";
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (!allDocs || allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    if (this.inputHandler) {
      this.inputHandler.updateContextState(true);
    }
    const isMobile = import_obsidian11.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: block;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.filter((doc) => {
      var _a;
      return (_a = doc == null ? void 0 : doc.file) == null ? void 0 : _a.basename;
    }).map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px; min-width: 0;";
    const filenamePartEl = summaryTextEl.createSpan();
    filenamePartEl.style.cssText = "white-space: nowrap; overflow: hidden; text-overflow: ellipsis; min-width: 0; flex: 1;";
    filenamePartEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount}`;
    const tokenPartEl = summaryTextEl.createSpan();
    tokenPartEl.style.cssText = "white-space: nowrap; flex-shrink: 0; margin-left: 8px;";
    if (isMobile) {
      tokenPartEl.textContent = `(${tokenPercent}%)`;
    } else {
      tokenPartEl.textContent = `(${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian11.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("trash-2").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.filter((doc) => {
      var _a;
      return (_a = doc == null ? void 0 : doc.file) == null ? void 0 : _a.basename;
    }).forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em; flex-shrink: 0;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
				flex: 1;
				min-width: 0;
				margin-right: 8px;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
				flex-shrink: 0;
				margin-right: 8px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.textContent = "\xD7";
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 4px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: normal;
				line-height: 1;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      try {
        const persistentDocs = this.multiDocHandler.getPersistentContext(this.currentFile.path) || [];
        if (persistentDocs.length > 0) {
          this.currentContext = {
            persistentDocs,
            contextString: "",
            // Not needed for UI
            tokenCount: 0,
            // Not needed for UI refresh
            isNearLimit: false
          };
        } else {
          this.currentContext = null;
        }
        this.updateContextIndicator();
      } catch (error) {
        this.currentContext = null;
        this.updateContextIndicator();
      }
    } else {
      this.currentContext = null;
      this.updateContextIndicator();
    }
  }
  async handleSend(message) {
    var _a, _b, _c, _d, _e, _f;
    const messageText = message || this.inputHandler.getValue().trim();
    if (!messageText) return;
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (!currentProviderType) {
      this.addErrorMessage(this.createIconMessage("alert-circle", "Nova is disabled or no AI provider is available. Please configure an AI provider in settings."));
      return;
    }
    if (messageText.startsWith(":")) {
      const commandResult = await this.handleColonCommand(messageText);
      if (commandResult) {
        this.inputHandler.setValue("");
        return;
      }
    }
    let processedMessage = messageText;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (messageText.includes("[[")) {
          this.addMessage("system", this.createIconMessage("book-open", "Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025."));
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(messageText, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_b = (_a = this.currentContext) == null ? void 0 : _a.persistentDocs) == null ? void 0 : _b.length) || 0;
        const currentPersistentCount = ((_c = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _c.length) || 0;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0 && (multiDocContext == null ? void 0 : multiDocContext.persistentDocs) && multiDocContext.persistentDocs.length > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.filter((doc) => {
              var _a2;
              return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
            }).map((doc) => doc.file.basename).join(", ");
            if (docNames) {
              this.addSuccessMessage(this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
            }
          }
          this.inputHandler.setValue("");
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (((_d = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _d.length) > 0) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.filter((doc) => {
            var _a2;
            return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
          }).map((doc) => doc.file.basename).join(", ");
          if (docNames && allDocs.length > 0) {
            const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
            const currentFile = ((_e = this.currentFile) == null ? void 0 : _e.basename) || "current file";
            this.addMessage("system", this.createIconMessage("book-open", `Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`));
          }
        }
        if (multiDocContext == null ? void 0 : multiDocContext.isNearLimit) {
          new import_obsidian11.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _NovaSidebarView.NOTICE_DURATION_MS);
        }
      }
    }
    this.addMessage("user", messageText);
    this.inputHandler.setValue("");
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(messageText);
      }
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
      const selectedText = (_f = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _f.getSelection();
      const hasSelection = !!(selectedText && selectedText.trim().length > 0);
      const intent = await this.plugin.aiIntentClassifier.classifyIntent(processedMessage, hasSelection);
      let response = null;
      if (intent === "METADATA" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else if (intent === "CONTENT" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedSystemPrompt = (prompt2.systemPrompt || "") + `

MULTI-DOCUMENT CONTEXT INSTRUCTIONS:
- You have access to multiple documents as REFERENCE CONTEXT ONLY
- These documents are for your understanding and background knowledge
- DO NOT echo, quote, or output content from these context documents unless specifically requested
- When responding, focus on the user's request, not the content of context documents
- Context documents are read-only; you can only edit the current working document
- If the user asks about context documents, you may reference and discuss their content`;
          const enhancedUserPrompt = `REFERENCE CONTEXT (for your understanding only):
${multiDocContext.contextString}

---

USER REQUEST: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(enhancedSystemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      loadingEl.remove();
      const filteredResponse = response ? this.filterThinkingContent(response) : response;
      if (activeFile && filteredResponse) {
        await this.plugin.documentEngine.addAssistantMessage(filteredResponse);
      }
      if (filteredResponse) {
        if (filteredResponse.includes("x-circle") || filteredResponse.includes("Error executing command") || filteredResponse.includes("Failed to") || filteredResponse.includes("No markdown file is open") || filteredResponse.includes("Unable to access") || filteredResponse.includes("Unable to set")) {
          this.addErrorMessage(filteredResponse);
        } else {
          this.addMessage("assistant", filteredResponse);
        }
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addErrorMessage(this.createIconMessage("x-circle", `Sorry, I encountered an error: ${error.message}`));
    } finally {
      const sendButton2 = this.inputHandler.sendButton;
      if (sendButton2) sendButton2.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: false });
        await new Promise((resolve) => setTimeout(resolve, 50));
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      const currentPos = this.plugin.documentEngine.getCursorPosition();
      if (currentPos) {
        this.currentFileCursorPosition = currentPos;
      }
      this.restoreCursorPosition();
      let result;
      switch (command.action) {
        case "add":
          result = await this.executeAddCommandWithStreaming(command);
          break;
        case "edit":
          result = await this.executeEditCommandWithStreaming(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.executeGrammarCommandWithStreaming(command);
          break;
        case "rewrite":
          result = await this.executeRewriteCommandWithStreaming(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        if (result.successMessage) {
          this.addSuccessMessage(this.createIconMessage("check-circle", result.successMessage));
        } else {
          this.addSuccessIndicator(command.action);
        }
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return this.createIconMessage("x-circle", `Error executing command: ${error.message}`);
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian11.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      this.currentFile = null;
      this.chatContainer.empty();
      this.refreshContext();
      this.addWelcomeMessage("Open a document to get started.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFileCursorPosition = null;
    this.currentFile = targetFile;
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
    if (activeView && activeView.editor) {
      this.trackCursorPosition(activeView.editor);
    }
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Working on "${targetFile.basename}".`);
      }
    } catch (error) {
      this.addWelcomeMessage(`Working on "${targetFile.basename}".`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared.`);
    } else {
      this.addWelcomeMessage("Chat cleared.");
    }
    new import_obsidian11.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Update send button enabled/disabled state based on provider availability
   */
  async updateSendButtonState() {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(!currentProviderType);
  }
  /**
   * Update privacy indicator icon and tooltip based on current provider
   */
  async updatePrivacyIndicator(privacyIndicator) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (currentProviderType) {
      const isLocalProvider = currentProviderType === "ollama";
      const iconName = isLocalProvider ? "lock" : "unlock";
      const tooltip = isLocalProvider ? "Local processing - data stays on your device" : "Cloud processing - data sent to provider";
      (0, import_obsidian11.setIcon)(privacyIndicator, iconName);
      privacyIndicator.setAttribute("aria-label", tooltip);
      privacyIndicator.setAttribute("title", tooltip);
    } else {
      (0, import_obsidian11.setIcon)(privacyIndicator, "help-circle");
      privacyIndicator.setAttribute("aria-label", "No provider selected");
      privacyIndicator.setAttribute("title", "No provider selected");
    }
  }
  /**
   * Filter thinking content from AI responses
   * Removes content between <think>/<thinking> and </think>/<thinking> tags
   */
  filterThinkingContent(content) {
    return content.replace(/<think(?:ing)?[\s\S]*?<\/think(?:ing)?>/gi, "").trim();
  }
  /**
   * Refresh all provider status indicators in the UI
   */
  async refreshProviderStatus() {
    var _a;
    if (this.privacyIndicator) {
      await this.updatePrivacyIndicator(this.privacyIndicator);
    }
    this.updateSendButtonState();
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      await this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-normal);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
      if (currentProviderType) {
        const displayText = this.getProviderWithModelDisplayName(currentProviderType);
        providerName.setText(displayText);
      } else {
        const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
        providerName.setText(currentProviderName);
      }
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Get available models for a provider type
   */
  getAvailableModels(providerType) {
    return getAvailableModels(providerType, this.plugin.settings);
  }
  /**
   * Get current model for a provider type
   */
  getCurrentModel(providerType) {
    var _a;
    const providers = this.plugin.settings.aiProviders;
    const currentModel = (_a = providers[providerType]) == null ? void 0 : _a.model;
    if (currentModel) {
      return currentModel;
    }
    const availableModels = this.getAvailableModels(providerType);
    return availableModels.length > 0 ? availableModels[0].value : "";
  }
  /**
   * Get model display name from model value
   */
  getModelDisplayName(providerType, modelValue) {
    const models = this.getAvailableModels(providerType);
    const model = models.find((m) => m.value === modelValue);
    return model ? model.label : modelValue;
  }
  /**
   * Switch to a specific model for a provider
   */
  async switchToModel(providerType, modelValue) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const isCurrentProvider = currentProviderType === providerType;
    const providers = this.plugin.settings.aiProviders;
    providers[providerType].model = modelValue;
    await this.plugin.saveSettings();
    if (isCurrentProvider) {
      const modelName = this.getModelDisplayName(providerType, modelValue);
      const providerName = this.getProviderDisplayName(providerType);
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${providerName} ${modelName}`);
      this.addMessage("system", switchMessage);
    } else {
      await this.switchToProvider(providerType);
    }
    if (this.currentProviderDropdown) {
      this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    var _a;
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providers = this.plugin.settings.aiProviders;
      const hasApiKey = (_a = providers[providerType]) == null ? void 0 : _a.apiKey;
      if (!hasApiKey && providerType !== "ollama") continue;
      const models = this.getAvailableModels(providerType);
      const currentModel = this.getCurrentModel(providerType);
      const displayName = this.getProviderDisplayName(providerType);
      const isCurrent = displayName === currentProviderName;
      const providerContainer = dropdownMenu.createDiv({ cls: "nova-provider-container" });
      const providerItem = providerContainer.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				color: var(--text-normal);
				transition: background-color 0.2s ease;
				position: relative;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const nameSpan = providerItem.createSpan({ text: displayName });
      nameSpan.style.flex = "1";
      let expandArrow = null;
      if (models.length > 0) {
        expandArrow = providerItem.createSpan({ text: "\u25B6" });
        expandArrow.style.cssText = `
					font-size: 0.6em;
					transition: transform 0.2s ease;
					color: var(--text-muted);
				`;
      }
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      let modelsMenu = null;
      let isExpanded = false;
      if (models.length > 0) {
        modelsMenu = providerContainer.createDiv({ cls: "nova-models-submenu" });
        modelsMenu.style.cssText = `
					display: none;
					background: var(--background-primary);
					border-left: 2px solid ${this.getProviderColor(providerType)};
					margin-left: 16px;
				`;
        for (const model of models) {
          const modelItem = modelsMenu.createDiv({ cls: "nova-model-item" });
          modelItem.style.cssText = `
						padding: 6px 12px;
						cursor: pointer;
						font-size: 0.8em;
						color: var(--text-normal);
						transition: background-color 0.2s ease;
						display: flex;
						align-items: center;
						gap: 8px;
					`;
          const modelDot = modelItem.createSpan();
          modelDot.style.cssText = `
						width: 4px;
						height: 4px;
						border-radius: 50%;
						background: ${model.value === currentModel ? this.getProviderColor(providerType) : "var(--text-muted)"};
					`;
          const modelName = modelItem.createSpan({ text: model.label });
          if (model.value === currentModel) {
            modelName.style.fontWeight = "bold";
          }
          modelItem.addEventListener("click", async (e) => {
            e.stopPropagation();
            await this.switchToModel(providerType, model.value);
            dropdownMenu.style.display = "none";
          });
          modelItem.addEventListener("mouseenter", () => {
            modelItem.style.background = "var(--background-modifier-border-hover)";
          });
          modelItem.addEventListener("mouseleave", () => {
            modelItem.style.background = "transparent";
          });
        }
      }
      providerItem.addEventListener("click", async (e) => {
        if (models.length > 0) {
          e.stopPropagation();
          isExpanded = !isExpanded;
          if (modelsMenu) {
            modelsMenu.style.display = isExpanded ? "block" : "none";
          }
          if (expandArrow) {
            expandArrow.style.transform = isExpanded ? "rotate(90deg)" : "rotate(0deg)";
          }
        } else {
          if (!isCurrent) {
            await this.switchToProvider(providerType);
            dropdownMenu.style.display = "none";
            if (this.currentProviderDropdown) {
              this.currentProviderDropdown.updateCurrentProvider();
            }
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent && !isExpanded) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "trash-2": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M8 6V4A2 2 0 0 1 10 2H14A2 2 0 0 1 16 4V6M19 6V20A2 2 0 0 1 17 22H7A2 2 0 0 1 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Anthropic",
      "openai": "OpenAI",
      "google": "Google",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get display name for header (just model name if available, otherwise provider name)
   */
  getProviderWithModelDisplayName(providerType) {
    const models = this.getAvailableModels(providerType);
    if (models.length > 0) {
      const currentModel = this.getCurrentModel(providerType);
      return this.getModelDisplayName(providerType, currentModel);
    }
    return this.getProviderDisplayName(providerType);
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "var(--color-orange)",
      "openai": "var(--color-green)",
      "google": "var(--color-blue)",
      "ollama": "var(--color-purple)",
      "none": "var(--text-muted)"
    };
    return colors[providerType] || "var(--text-success)";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${this.getProviderWithModelDisplayName(providerType)}`);
      this.addMessage("system", switchMessage);
      const platform = import_obsidian11.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      setTimeout(() => this.refreshProviderStatus(), 100);
    } catch (error) {
      this.addErrorMessage(this.createIconMessage("x-circle", `Failed to switch to ${this.getProviderWithModelDisplayName(providerType)}`));
    }
  }
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    if (this.inputHandler) {
      this.inputHandler.refreshCommandButton();
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
  /**
   * Execute add command with streaming support
   */
  async executeAddCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      this.streamingManager.showThinkingNotice("add");
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.addCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming add command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute edit command with streaming support
   */
  async executeEditCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      this.streamingManager.showThinkingNotice("edit");
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.editCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming edit command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeRewriteCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      this.streamingManager.showThinkingNotice("rewrite");
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.rewriteCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming rewrite command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeGrammarCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      this.streamingManager.showThinkingNotice("grammar");
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.grammarCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming grammar command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Add files to persistent context
   */
  async addFilesToContext(filenames) {
    if (!this.currentFile) {
      new import_obsidian11.Notice("No file is open. Please open a file to add context.", 3e3);
      return;
    }
    const addedFiles = [];
    const alreadyExistingFiles = [];
    const notFoundFiles = [];
    const existingPersistent = this.multiDocHandler.getPersistentContext(this.currentFile.path) || [];
    const updatedPersistent = [...existingPersistent];
    for (const filename of filenames) {
      let file = this.app.vault.getAbstractFileByPath(filename);
      if (!file || !(file instanceof import_obsidian11.TFile)) {
        file = this.app.vault.getAbstractFileByPath(filename + ".md");
      }
      if (!file || !(file instanceof import_obsidian11.TFile)) {
        const files = this.app.vault.getMarkdownFiles();
        file = files.find(
          (f) => f.basename === filename || f.name === filename || f.path.endsWith("/" + filename) || f.path.endsWith("/" + filename + ".md")
        ) || null;
      }
      if (file instanceof import_obsidian11.TFile) {
        const exists = updatedPersistent.some((ref) => ref.file.path === file.path);
        if (!exists) {
          updatedPersistent.push({
            file,
            property: void 0,
            isPersistent: true,
            rawReference: `+[[${file.basename}]]`
          });
          addedFiles.push(file.basename);
        } else {
          alreadyExistingFiles.push(file.basename);
        }
      } else {
        notFoundFiles.push(filename);
      }
    }
    if (addedFiles.length > 0 || alreadyExistingFiles.length > 0) {
      const handler = this.multiDocHandler;
      handler.persistentContext.set(this.currentFile.path, updatedPersistent);
    }
    await this.refreshContext();
    const totalFiles = filenames.length;
    const messages = [];
    if (addedFiles.length > 0) {
      if (addedFiles.length === 1) {
        messages.push(`Added "${addedFiles[0]}" to context`);
      } else {
        messages.push(`Added ${addedFiles.length} files to context`);
      }
    }
    if (alreadyExistingFiles.length > 0) {
      if (alreadyExistingFiles.length === 1) {
        messages.push(`"${alreadyExistingFiles[0]}" already in context`);
      } else {
        messages.push(`${alreadyExistingFiles.length} already in context`);
      }
    }
    if (notFoundFiles.length > 0) {
      if (notFoundFiles.length === 1) {
        messages.push(`"${notFoundFiles[0]}" not found`);
      } else {
        messages.push(`${notFoundFiles.length} not found`);
      }
    }
    if (messages.length > 0) {
      const combinedMessage = messages.join(", ");
      const duration = notFoundFiles.length > 0 ? 3e3 : 2e3;
      new import_obsidian11.Notice(combinedMessage, duration);
    }
  }
};
_NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS = 300;
_NovaSidebarView.SCROLL_DELAY_MS = 50;
_NovaSidebarView.FOCUS_DELAY_MS = 150;
_NovaSidebarView.HOVER_TIMEOUT_MS = 150;
_NovaSidebarView.NOTICE_DURATION_MS = 5e3;
var NovaSidebarView = _NovaSidebarView;

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-3-5-sonnet-20241022",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-1.5-flash",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian12.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isSupernova ? "supernova" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian12.Setting(licenseContainer).setName("Supernova License Key (Optional)").setDesc("Enter your Supernova supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Supernova license key...").setValue(this.plugin.settings.licensing.supernovaLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Supernova license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
              const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
              if (isSupernova2) {
                this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
                this.showConfetti();
              } else {
                this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
              }
              const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
              if (leaves.length > 0) {
                const sidebarView = leaves[0].view;
                sidebarView.refreshSupernovaUI();
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Supernova license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createSupernovaInfo(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian12.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian12.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian12.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.display();
      }));
      new import_obsidian12.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian12.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian12.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "AI Provider Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const providerContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    providerContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = providerContainer.style.display !== "none";
      providerContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = providerContainer.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
			<div class="nova-info-card nova-model-guidance">
				<h4>Recommended Defaults</h4>
				<ul class="nova-model-recommendations">
					<li><strong>Claude Sonnet 4</strong> - Latest generation with excellent instruction following for collaborative editing</li>
					<li><strong>GPT-4.1 Mini</strong> - Current-generation model that outperforms GPT-4o while remaining cost-effective</li>
					<li><strong>Gemini 2.5 Flash</strong> - Best price/performance with "thinking" capabilities and strong coding support</li>
				</ul>
				<p class="nova-guidance-note">These defaults offer modern AI capabilities without premium pricing.</p>
			</div>
		`;
    this.createOllamaSettings(providerContainer);
    this.createClaudeSettings(providerContainer);
    this.createGoogleSettings(providerContainer);
    this.createOpenAISettings(providerContainer);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian12.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian12.Setting(claudeContainer).setName("Model").setDesc("Claude model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateClaudeModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4-20250514").onChange(async (value) => {
        this.plugin.settings.aiProviders.claude.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateClaudeModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("claude");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    new import_obsidian12.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian12.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateOpenAIModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4.1-mini-2025-04-14").onChange(async (value) => {
        this.plugin.settings.aiProviders.openai.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateOpenAIModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("openai");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian12.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian12.Setting(googleContainer).setName("Model").setDesc("Gemini model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateGoogleModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-04-17").onChange(async (value) => {
        this.plugin.settings.aiProviders.google.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateGoogleModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("google");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian12.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Platform Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    platformContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = platformContainer.style.display !== "none";
      platformContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian12.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian12.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian12.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Custom Commands" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = commandContainer.style.display !== "none";
      commandContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian12.Setting(commandContainer).setName("Show Command Button in Chat (Mobile)").setDesc("Show the Commands button beside the Send button for mobile quick access to Nova commands and selection actions").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian12.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(commandContainer);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian14 = require("obsidian");

// src/ai/providers/claude.ts
var import_obsidian13 = require("obsidian");
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-5-haiku-latest",
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
      system: options == null ? void 0 : options.systemPrompt,
      messages: messages.map((msg) => ({
        role: msg.role === "assistant" ? "assistant" : "user",
        content: msg.content
      }))
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await (0, import_obsidian13.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": this.config.apiKey,
            "anthropic-version": "2023-06-01"
          },
          body: requestBody
        });
        if (response.status === 200) {
          const data = response.json;
          return data.content[0].text;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`Claude API error: ${response.status} - ${response.text}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && (error.message.includes("Network error") || error.message.includes("Failed to connect"))) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        if (error instanceof Error && error.message.startsWith("Claude API error:")) {
          throw error;
        }
        throw new Error(`Failed to connect to Claude API: ${error instanceof Error ? error.message : "Network error"}`);
      }
    }
    throw new Error("Claude API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    const result = await this.chatCompletion(messages, options);
    yield { content: result, done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await (0, import_obsidian13.requestUrl)({
        url: "https://api.anthropic.com/v1/messages",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-5-haiku-latest",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (response.status !== 200) {
        throw new Error(`API key validation failed: ${response.status} - ${response.text}`);
      }
      const models = [
        "claude-opus-4-20250514",
        "claude-sonnet-4-20250514",
        "claude-3-7-sonnet-latest",
        "claude-3-5-sonnet-latest",
        "claude-3-5-haiku-latest"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
      messages: requestMessages,
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${this.config.apiKey}`
          },
          body: requestBody
        });
        if (response.ok) {
          const data = await response.json();
          return data.choices[0].message.content;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`OpenAI API error: ${response.statusText}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && error.message.includes("fetch")) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw error;
      }
    }
    throw new Error("OpenAI API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gpt-4.1-2025-04-14",
        "gpt-4.1-mini-2025-04-14",
        "gpt-4.1-nano-2025-04-14",
        "gpt-4o",
        "gpt-4o-mini"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt && systemPrompt.trim()) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    if (contents.length === 0) {
      throw new Error("No messages provided for Google API");
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const requestBody = {
      contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
      generationConfig: {
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
      }
    };
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(requestBody)
    });
    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Google API error: ${response.statusText} - ${errorText}`);
    }
    const data = await response.json();
    if (!data.candidates || data.candidates.length === 0) {
      if (data.error) {
        throw new Error(`Google API error: ${data.error.message || JSON.stringify(data.error)}`);
      }
      throw new Error("Google API returned no candidates");
    }
    if (data.candidates[0].finishReason === "SAFETY" || data.candidates[0].finishReason === "BLOCKED") {
      throw new Error("Google API blocked the response due to safety filters");
    }
    if (data.candidates[0].finishReason === "MAX_TOKENS" && (!data.candidates[0].content || !data.candidates[0].content.parts || data.candidates[0].content.parts.length === 0)) {
      throw new Error('API hit token limit before generating any content. Please increase "Default Max Tokens" in settings.');
    }
    if (data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
      const text = data.candidates[0].content.parts[0].text;
      if (data.candidates[0].finishReason === "MAX_TOKENS") {
        throw new Error('Response was truncated due to token limit. Please increase "Default Max Tokens" in settings.');
      }
      return text || "";
    }
    throw new Error("Google API returned empty response");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gemini-2.5-flash-preview-04-17",
        "gemini-2.5-pro-preview-03-25",
        "gemini-2.0-flash",
        "gemini-2.0-flash-lite"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian14.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async getCurrentProviderType() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return providerType;
      }
    }
    return null;
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    if (import_obsidian14.Platform.isMobile) {
      return ["claude", "openai", "google"];
    }
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
  /**
   * Get the default max tokens from settings
   */
  getDefaultMaxTokens() {
    return this.settings.general.defaultMaxTokens;
  }
};

// src/core/document-engine.ts
var import_obsidian15 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance - ensures we get the editor for the active file
   */
  getActiveEditor() {
    const activeFile = this.getActiveFile();
    if (!activeFile) {
      return null;
    }
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    for (const leaf of leaves) {
      const view2 = leaf.view;
      if (view2 instanceof import_obsidian15.MarkdownView && view2.file === activeFile) {
        return view2.editor;
      }
    }
    const activeEditor = this.app.workspace.activeEditor;
    if ((activeEditor == null ? void 0 : activeEditor.editor) && activeEditor.file === activeFile) {
      return activeEditor.editor;
    }
    const view = this.app.workspace.getActiveViewOfType(import_obsidian15.MarkdownView);
    if (view && view.file === activeFile) {
      return view.editor;
    }
    return null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Set the cursor position (optionally focus the editor)
   */
  setCursorPosition(position, shouldFocus = false) {
    const editor = this.getActiveEditor();
    if (!editor) return;
    editor.setCursor(position);
    if (shouldFocus) {
      editor.focus();
    }
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at cursor location
   */
  async deleteContent(target) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
  /**
   * Replace selected text with new content
   * Handles undo/redo properly and preserves cursor position
   */
  async replaceSelection(newText, from, to) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "replace"
      };
    }
    try {
      const fromPos = from || editor.getCursor("from");
      const toPos = to || editor.getCursor("to");
      editor.replaceRange(newText, fromPos, toPos);
      const newCursorPos = {
        line: fromPos.line + (newText.split("\n").length - 1),
        ch: newText.includes("\n") ? newText.split("\n").pop().length : fromPos.ch + newText.length
      };
      editor.setCursor(newCursorPos);
      editor.focus();
      return {
        success: true,
        content: newText,
        appliedAt: fromPos,
        editType: "replace"
      };
    } catch (error) {
      console.error("Error replacing selection:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor(settings) {
    var _a, _b, _c, _d;
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: (_b = (_a = settings == null ? void 0 : settings.general) == null ? void 0 : _a.defaultTemperature) != null ? _b : 0.7,
      maxTokens: (_d = (_c = settings == null ? void 0 : settings.general) == null ? void 0 : _c.defaultMaxTokens) != null ? _d : 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents at their cursor position. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Work at the user's cursor position - every edit happens where they are focused
- Do not add headers unless specifically requested
- Focus on the user's immediate editing context`;
    const actionSpecificPrompts = {
      "add": `

ACTION: ADD CONTENT
- Generate EXACTLY what the user requested - follow their instruction literally
- Do NOT create content related to the document theme unless specifically asked
- Focus on the user's specific request, not the document's existing content
- Match basic formatting style but prioritize the user's exact request`,
      "edit": `

ACTION: EDIT CONTENT  
- Improve, modify, or enhance the specified content
- Preserve the original intent while following user instructions
- Apply style, tone, or structural changes as requested`,
      "delete": `

ACTION: DELETE CONTENT
- Confirm what should be deleted by providing the exact text to remove
- Be precise about deletion boundaries
- Respond "CONFIRMED" if the deletion is clear`,
      "grammar": `

ACTION: GRAMMAR & SPELLING
- Fix grammar, spelling, and punctuation errors
- Improve clarity while preserving meaning
- Maintain the original tone and style`,
      "rewrite": `

ACTION: REWRITE CONTENT
- Generate alternative content that serves the same purpose
- Apply requested style, tone, or structural changes
- Create fresh content while maintaining core meaning`,
      "metadata": `

ACTION: UPDATE METADATA
- Modify frontmatter properties, tags, or document metadata
- Return ONLY a JSON object with the properties to update
- For tags, return as an array: {"tags": ["tag1", "tag2"]}
- For other properties: {"title": "New Title", "author": "Name"}
- Do NOT include properties that shouldn't be changed
- Do NOT return any explanatory text, ONLY the JSON object`
    };
    return basePrompt + (actionSpecificPrompts[action] || "");
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += `DOCUMENT STRUCTURE:
`;
      const structure = this.buildDocumentStructure(documentContext.headings);
      context += structure + "\n";
    }
    context += this.buildTargetContext(command, documentContext);
    if (conversationContext && config.includeHistory) {
      context += `
CONVERSATION CONTEXT:
${conversationContext}
`;
    }
    if (command.action === "add" && command.target === "cursor") {
      if (documentContext.surroundingLines) {
        const before = documentContext.surroundingLines.before.slice(-3).join("\n");
        const after = documentContext.surroundingLines.after.slice(0, 3).join("\n");
        context += `
LOCAL CONTEXT (for style reference only):
Before cursor:
${before}

After cursor:
${after}
`;
      }
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}
`;
    }
    return context;
  }
  /**
   * Build target-specific context
   */
  buildTargetContext(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return `
SELECTED TEXT:
${documentContext.selectedText}
`;
        }
        return `
No text currently selected.
`;
      case "cursor":
        if (documentContext.surroundingLines) {
          const context = `
CURSOR CONTEXT:
`;
          const before = documentContext.surroundingLines.before.join("\n");
          const after = documentContext.surroundingLines.after.join("\n");
          return context + `Before cursor:
${before}

After cursor:
${after}
`;
        }
        return `
Cursor position context not available.
`;
      case "document":
        return `
Targeting entire document.
`;
      case "end":
        return `
Targeting end of document.
`;
      default:
        return `
Working at cursor position.
`;
    }
  }
  /**
   * Build user prompt with instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = contextInfo;
    prompt2 += `
USER REQUEST: ${command.instruction}
`;
    if (command.context) {
      prompt2 += `ADDITIONAL REQUIREMENTS: ${command.context}
`;
    }
    prompt2 += this.getFocusInstructions(command);
    prompt2 += this.getOutputInstructions(command);
    return prompt2;
  }
  /**
   * Get focus instructions based on target
   */
  getFocusInstructions(command) {
    const actionGuidance = {
      "add": "Add new content",
      "edit": "Modify existing content",
      "delete": "Remove specified content",
      "rewrite": "Generate alternative content",
      "grammar": "Fix grammar and spelling",
      "metadata": "Update document metadata"
    };
    switch (command.target) {
      case "selection":
        return `
FOCUS: ${actionGuidance[command.action]} in the selected text.
`;
      case "cursor":
        return `
FOCUS: ${actionGuidance[command.action]} at the current cursor position.
`;
      case "document":
        return `
FOCUS: ${actionGuidance[command.action]} for the entire document.
`;
      case "end":
        return `
FOCUS: Add content at the very end of the document, after all existing content. Ensure it flows naturally.
`;
      default:
        return `
FOCUS: ${actionGuidance[command.action]} at the cursor position.
`;
    }
  }
  /**
   * Get output instructions based on action
   */
  getOutputInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide the corrected version with proper grammar and spelling.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return "OUTPUT: Provide the updated metadata in proper YAML format.";
      default:
        return "OUTPUT: Provide only the requested content changes.";
    }
  }
  /**
   * Build document structure from headings
   */
  buildDocumentStructure(headings) {
    return headings.map((heading) => {
      const indent = "  ".repeat(heading.level - 1);
      return `${indent}- ${heading.text}`;
    }).join("\n");
  }
  /**
   * Validate generated prompt
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    if (prompt2.userPrompt.length > 1e4) {
      issues.push("User prompt is too long (>10000 characters)");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document"]
  },
  {
    action: "metadata",
    patterns: [
      // Tag-specific patterns with colon format (highest priority)
      /^(add|set|update|remove)\s+tags?:/i,
      // Tag optimization patterns
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i,
      /^add tags$/i,
      // Simple "add tags" for AI suggestions
      // General metadata patterns
      /\b(update|set|change|modify)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      // Tag-specific patterns that exclude content/text/section
      /\b(add|remove|update)\s+(?!.*\b(content|text|section|paragraph|about)\b).*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include|append|prepend)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert|append|prepend)\b(?!\s+.*\b(better|clearer|more|less|tags?|property|properties|metadata|frontmatter)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i,
      // Specific patterns for append/prepend with location
      /\b(append|add)\b.*\b(after|following)\b/i,
      /\b(prepend|add)\b.*\b(before|preceding)\b/i
    ],
    targets: ["end"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection"]
  }
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const context = this.extractContext(input);
    return {
      action,
      target,
      instruction: input,
      // Keep original input for display
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input (simplified for cursor-only editing)
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return "cursor";
      // Changed from 'end' to 'cursor' for cursor-only editing
      case "edit":
        return hasSelection ? "selection" : "cursor";
      case "delete":
        return hasSelection ? "selection" : "cursor";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return hasSelection ? "selection" : "cursor";
      // Changed from 'end' to support cursor-only
      case "metadata":
        return "document";
      default:
        return "cursor";
    }
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add content at cursor",
        "Fix grammar in this document",
        "Add conclusion at end",
        "Create a summary"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new content";
        break;
      case "metadata":
        description = "Update document metadata";
        break;
    }
    switch (target) {
      case "selection":
        description += " in selected text";
        break;
      case "cursor":
        description += " at cursor position";
        break;
      case "document":
        description += " in entire document";
        break;
      case "end":
        description += " at end of document";
        break;
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const lowerMessage = message.toLowerCase().trim();
    if (lowerMessage.startsWith(":")) {
      return true;
    }
    const actionVerbs = [
      "add",
      "insert",
      "append",
      "prepend",
      "include",
      "create",
      "write",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "replace",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "drop",
      "fix",
      "correct",
      "proofread",
      "polish",
      "check",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const startsWithAction = actionVerbs.some((verb) => {
      const verbPattern = new RegExp(`^${verb}\\b`, "i");
      return verbPattern.test(lowerMessage);
    });
    if (startsWithAction) {
      const questionIndicators = [
        /^(how|what|why|when|where|which|who|can|could|should|would|will|is|are|am|do|does|did)/i,
        /\?/,
        // Contains question mark
        /\b(help|advice|suggest|recommend|think|opinion)\b/i
      ];
      const isQuestion = questionIndicators.some((pattern) => pattern.test(lowerMessage));
      if (isQuestion) {
        return false;
      }
      return true;
    }
    const explicitCommandPatterns = [
      // Grammar/spelling commands that don't start with action verbs
      /\b(grammar|spell|spelling|proofread|polish)\b.*\b(check|fix|correct)\b/i,
      // Metadata commands with different structures
      /\bset\s+(the\s+)?(title|tags|metadata|properties)/i,
      /\bupdate\s+(the\s+)?(title|tags|metadata|properties)/i,
      // Tag-specific patterns
      /^(add|set|update|remove)\s+tags?:/i,
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i
    ];
    for (const pattern of explicitCommandPatterns) {
      if (pattern.test(lowerMessage)) {
        return true;
      }
    }
    return false;
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Key capabilities:
- Answer questions about documents and content
- Provide writing assistance and suggestions
- Help with research and analysis
- Engage in natural conversation about the user's work

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional
- Reference document context when relevant`;
    let userPrompt = `USER REQUEST: ${message}`;
    if (documentContext && file) {
      userPrompt = `Current document: ${documentContext.filename}

${userPrompt}`;
    }
    if (recentHistory.length > 0) {
      const historyString = this.formatConversationHistory(recentHistory);
      userPrompt = `RECENT CONVERSATION:
${historyString}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: (documentContext == null ? void 0 : documentContext.content) || "",
      config: {
        temperature: options.temperature || 0.7,
        maxTokens: options.maxTokens || 2e3
      }
    };
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional`;
    let userPrompt = `USER REQUEST: ${instruction}`;
    if (context) {
      userPrompt = `Context: ${context}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 2e3
      }
    };
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Simple token count estimation
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            const result2 = {
              success: false,
              error: "AI provider returned empty content",
              editType: "insert"
            };
            await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
            return result2;
          }
          result = await this.applyAddition(command, documentContext, content);
        }
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        } else {
          await this.documentEngine.addAssistantMessage("Content added successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Apply addition based on command target
   */
  async applyAddition(command, documentContext, content) {
    switch (command.target) {
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return await this.documentEngine.applyEdit(
            content,
            "cursor",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        }
      default:
        return {
          success: false,
          error: `Invalid add target: ${command.target}`,
          editType: "insert"
        };
    }
  }
  /**
   * Validate add command
   */
  validateCommand(command) {
    if (command.action !== "add") {
      return {
        valid: false,
        error: "Command action must be add"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Add instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute add command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "insert"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "insert",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "insert"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            const result2 = {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
            await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
            return result2;
          }
          result = await this.applyEdit(command, documentContext, content);
        }
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        } else {
          await this.documentEngine.addAssistantMessage("Content edited successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for editing",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid edit target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to edit"
      };
    }
    if (command.action !== "edit") {
      return {
        valid: false,
        error: "Command action must be edit"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Edit instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute edit command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        if (result.success) {
          await this.documentEngine.addAssistantMessage("Content deleted successfully", result);
        } else {
          await this.documentEngine.addAssistantMessage("Failed to delete content", result);
        }
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "cursor":
        return await this.documentEngine.deleteContent("line");
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end - use cursor or selection instead",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: `Invalid delete target: ${command.target}`,
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to delete"
      };
    }
    if (command.action !== "delete") {
      return {
        valid: false,
        error: "Command action must be delete"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            const result2 = {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
            await this.documentEngine.addAssistantMessage("Failed to fix grammar", result2);
            return result2;
          }
          result = await this.applyGrammarFix(command, documentContext, content);
        }
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to fix grammar", result);
        } else {
          await this.documentEngine.addAssistantMessage("Grammar fixed successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar fix based on command target
   */
  async applyGrammarFix(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for grammar correction",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "cursor":
        return {
          success: false,
          error: 'Please select text to correct grammar, or use "document" to fix entire document',
          editType: "replace"
        };
      case "end":
        return {
          success: false,
          error: 'Grammar correction requires selecting text or specifying "document"',
          editType: "replace"
        };
      default:
        return {
          success: false,
          error: `Invalid grammar target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command
   */
  validateCommand(command, hasSelection) {
    if (command.action !== "grammar") {
      return {
        valid: false,
        error: "Command action must be grammar"
      };
    }
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to correct grammar"
      };
    }
    if (command.target !== "selection" && command.target !== "document") {
      return {
        valid: false,
        error: "Grammar correction requires selecting text or targeting entire document"
      };
    }
    return { valid: true };
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            const result2 = {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
            await this.documentEngine.addAssistantMessage("Failed to generate rewrite", result2);
            return result2;
          }
          result = await this.applyRewrite(command, documentContext, content);
        }
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        } else {
          await this.documentEngine.addAssistantMessage("Content rewritten successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, content) {
    switch (command.target) {
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for rewriting",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid rewrite target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command
   */
  validateCommand(command) {
    if (command.action !== "rewrite") {
      return {
        valid: false,
        error: "Command action must be rewrite"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Rewrite instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const tagResult = await this.handleDirectTagOperation(command.instruction, documentContext);
      if (tagResult) {
        return tagResult;
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        console.error("Failed to parse metadata updates. AI response:", aiResponse);
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      console.log("Metadata updates:", updates);
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      const successMessage = this.generateSuccessMessage(updates);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
  /**
   * Handle direct tag operations (add, remove, set tags)
   */
  async handleDirectTagOperation(instruction, documentContext) {
    const lowerInstruction = instruction.toLowerCase().trim();
    const colonMatch = lowerInstruction.match(/^(add|set|update|remove)\s+tags?:\s*(.*)$/);
    if (colonMatch) {
      const action = colonMatch[1];
      const tagString = colonMatch[2];
      const newTags = tagString ? tagString.split(",").map((t) => t.trim()).filter((t) => t) : [];
      if (action === "add" && newTags.length === 0) {
        return await this.handleAITagOperation("add suggested tags", documentContext);
      }
      const currentTags = this.getCurrentTags(documentContext.content);
      let updatedTags = [];
      let message = "";
      switch (action) {
        case "add":
          const tagsToAdd = newTags.filter(
            (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
          );
          updatedTags = [...currentTags, ...tagsToAdd];
          message = tagsToAdd.length > 0 ? `Added ${tagsToAdd.length} tag${tagsToAdd.length !== 1 ? "s" : ""}: ${tagsToAdd.join(", ")}` : "No new tags to add (duplicates filtered)";
          break;
        case "remove":
          const lowerNewTags = newTags.map((t) => t.toLowerCase());
          const beforeCount = currentTags.length;
          updatedTags = currentTags.filter(
            (tag) => !lowerNewTags.includes(tag.toLowerCase())
          );
          const removedCount = beforeCount - updatedTags.length;
          message = removedCount > 0 ? `Removed ${removedCount} tag${removedCount !== 1 ? "s" : ""}` : "No tags found to remove";
          break;
        case "set":
        case "update":
          updatedTags = [...new Set(newTags.map((t) => t.toLowerCase()))];
          message = `Set ${updatedTags.length} tag${updatedTags.length !== 1 ? "s" : ""}`;
          break;
      }
      const updates = { tags: updatedTags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    }
    if (/\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i.test(lowerInstruction) || /\b(suggest|recommend)\s+.*\btags?\b/i.test(lowerInstruction) || /^add suggested tags$/i.test(lowerInstruction) || /^add tags$/i.test(lowerInstruction) || // Handle simple "add tags" as AI suggestion
    /^update tags$/i.test(lowerInstruction)) {
      return await this.handleAITagOperation(instruction, documentContext);
    }
    return null;
  }
  /**
   * Handle AI-powered tag operations (suggest, optimize, clean up)
   */
  async handleAITagOperation(instruction, documentContext) {
    const currentTags = this.getCurrentTags(documentContext.content);
    const systemPrompt = `You are an expert at document tagging and metadata organization. Your task is to analyze documents and provide optimal tags.

Rules for tags:
- Tags should be lowercase
- Use hyphens for multi-word tags (e.g., "machine-learning")
- Be specific but not overly granular
- Aim for 5-10 tags per document
- Focus on key concepts, topics, and themes FROM THE ACTUAL DOCUMENT CONTENT
- Tags must be directly relevant to the document's subject matter
- Avoid generic tags like "document" or "text"
- Consider the document's purpose, audience, and main topics
- Extract tags based on the document's actual content, not random topics

IMPORTANT: Base your tag suggestions ONLY on the content provided. Do not invent unrelated tags.

Return ONLY a JSON object with a "tags" array and a "reasoning" field explaining your choices.`;
    let userPrompt = "";
    if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
      userPrompt = `Carefully analyze the following document and suggest relevant tags based on its actual content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Based on the above document content, suggest additional tags that:
1. Reflect the actual topics discussed in the document
2. Capture key concepts, technologies, or themes mentioned
3. Would help with discoverability and organization
4. Are directly relevant to what this document is about

DO NOT suggest tags about topics not mentioned in the document.`;
    } else if (/clean up|cleanup/i.test(instruction)) {
      userPrompt = `Clean up and optimize the tags for this document by analyzing both the current tags and the document content.

Current tags: ${currentTags.join(", ")}

DOCUMENT CONTENT:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Remove duplicate or redundant tags
2. Consolidate similar tags (e.g., "js" and "javascript")
3. Remove tags that aren't relevant to the document content
4. Standardize tag format (lowercase, hyphenated)
5. Ensure remaining tags accurately reflect the document

Provide a cleaned-up tag list based on the actual document content.`;
    } else if (/optimize|improve|review|analyze|update/i.test(instruction)) {
      userPrompt = `Analyze this document thoroughly and provide an optimized set of tags that accurately represents its content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Review the document content carefully
2. Remove any tags that aren't relevant to the actual content
3. Add tags for important concepts, topics, or themes that are missing
4. Ensure all tags directly relate to what's discussed in the document
5. Aim for 5-10 highly relevant tags

Provide an optimized tag list that best represents THIS SPECIFIC document's content.`;
    }
    try {
      const defaultMaxTokens = this.providerManager.getDefaultMaxTokens();
      const aiResponse = await this.providerManager.complete(systemPrompt, userPrompt, {
        temperature: 0.3,
        maxTokens: defaultMaxTokens
      });
      const parsed = this.parseAITagResponse(aiResponse);
      if (!parsed || !parsed.tags || parsed.tags.length === 0) {
        const preview = aiResponse.length > 100 ? aiResponse.substring(0, 100) + "..." : aiResponse;
        return {
          success: false,
          error: `Could not parse AI tag suggestions. AI response: "${preview}"`,
          editType: "replace"
        };
      }
      const updates = { tags: parsed.tags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      let message = "";
      if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
        const addedTags = parsed.tags.filter(
          (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
        );
        message = `Added ${addedTags.length} suggested tag${addedTags.length !== 1 ? "s" : ""}: ${addedTags.join(", ")}`;
      } else if (/clean up|cleanup/i.test(instruction)) {
        message = `Cleaned up tags: ${currentTags.length} \u2192 ${parsed.tags.length} tags`;
      } else {
        message = `Optimized tags: ${parsed.tags.length} tag${parsed.tags.length !== 1 ? "s" : ""} (was ${currentTags.length})`;
      }
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to process tag operation: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Get current tags from document content
   */
  getCurrentTags(content) {
    if (!content) return [];
    const lines = content.split("\n");
    if (lines.length > 0 && lines[0] === "---") {
      let inFrontmatter = true;
      for (let i = 1; i < lines.length && inFrontmatter; i++) {
        if (lines[i] === "---") {
          break;
        }
        const tagMatch = lines[i].match(/^tags:\s*(.*)$/);
        if (tagMatch) {
          const tagValue = tagMatch[1].trim();
          if (!tagValue) return [];
          try {
            const parsed = JSON.parse(tagValue);
            if (Array.isArray(parsed)) {
              return parsed.filter((t) => t);
            }
          } catch (e) {
            return tagValue.split(",").map((t) => t.trim()).filter((t) => t);
          }
        }
      }
    }
    return [];
  }
  /**
   * Parse AI response for tag operations
   */
  parseAITagResponse(response) {
    try {
      const cleanResponse = response.trim();
      const jsonMatch = cleanResponse.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        try {
          const parsed = JSON.parse(jsonMatch[0]);
          if (parsed.tags && Array.isArray(parsed.tags)) {
            return {
              tags: parsed.tags.map((t) => String(t).toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t),
              reasoning: parsed.reasoning
            };
          }
        } catch (e) {
        }
      }
      const patterns = [
        // JSON array: tags: ["tag1", "tag2"]
        /tags?:\s*\[([^\]]+)\]/i,
        // Comma list: Tags: tag1, tag2, tag3
        /tags?:\s*([^\n]+?)(?:\n|$)/i,
        // Bullet list: - tag1\n- tag2
        /(?:tags?:)?\s*(?:\n)?(\s*[-•*]\s*.+(?:\n\s*[-•*]\s*.+)*)/i
      ];
      for (const pattern of patterns) {
        const match = cleanResponse.match(pattern);
        if (match) {
          let tagString = match[1];
          let tags = [];
          if (tagString.includes("-") || tagString.includes("\u2022") || tagString.includes("*")) {
            tags = tagString.split(/\n/).map((line) => line.replace(/^\s*[-•*]\s*/, "").trim()).filter((t) => t);
          } else {
            tags = tagString.split(",").map((t) => t.trim().replace(/["']/g, "")).filter((t) => t);
          }
          if (tags.length > 0) {
            return {
              tags: tags.map((t) => t.toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t)
            };
          }
        }
      }
      const suggestMatch = cleanResponse.match(/(?:suggest|recommend|propose|here are|tags are)[:\s]+([^.]+)/i);
      if (suggestMatch) {
        const tags = suggestMatch[1].split(/[,\n]/).map((t) => t.trim().replace(/["']/g, "").replace(/^and\s+/i, "")).filter((t) => t);
        if (tags.length > 0) {
          return {
            tags: tags.map((t) => t.toLowerCase().trim()).filter((t) => t)
          };
        }
      }
      const lines = cleanResponse.split("\n").map((line) => line.trim()).filter((line) => line);
      const validTags = lines.filter((line) => {
        return line.length > 0 && line.length < 50 && !line.includes(":") && !line.toLowerCase().includes("tag") && !line.toLowerCase().includes("here") && !line.toLowerCase().includes("suggest");
      }).map((line) => {
        return line.toLowerCase().replace(/^[-•*#]\s*/, "").replace(/^\d+\.\s*/, "").trim().replace(/\s+/g, "-");
      }).filter((tag) => tag);
      if (validTags.length > 0) {
        return { tags: validTags };
      }
      console.error("Failed to parse AI tag response:", cleanResponse);
      return null;
    } catch (error) {
      console.error("Error parsing AI tag response:", error, "Response was:", response);
      return null;
    }
  }
  /**
   * Generate success message based on updates
   */
  generateSuccessMessage(updates) {
    const keys = Object.keys(updates);
    if (keys.length === 0) return "Metadata updated";
    if (keys.length === 1) {
      const key = keys[0];
      if (key === "tags") {
        const count = Array.isArray(updates.tags) ? updates.tags.length : 0;
        return `Updated tags (${count} tag${count !== 1 ? "s" : ""})`;
      }
      return `Updated ${key}`;
    }
    return `Updated ${keys.length} properties`;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Commands (unified) - 2 month early access
  "commands": {
    supernovaDate: "2025-07-31",
    // Supernova early access
    generalDate: "2025-09-30",
    // General availability 
    description: "Command system with : triggers, command button, and custom commands"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context",
  // Current document context
  "multi-doc-context"
  // Reference other documents with [[doc]] syntax
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Supernova status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsSupernova() && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// src/core/ai-intent-classifier.ts
var AIIntentClassifier = class {
  constructor(providerManager) {
    this.providerManager = providerManager;
  }
  /**
   * Classify user input into one of three intents
   */
  async classifyIntent(userInput, hasSelection = false) {
    if (userInput.startsWith(":")) {
      return "CHAT";
    }
    return this.fallbackClassification(userInput);
  }
  /**
   * Simple heuristic fallback for when AI classification fails
   */
  fallbackClassification(userInput) {
    const lowerInput = userInput.toLowerCase().trim();
    if (lowerInput.includes("?") || lowerInput.startsWith("what") || lowerInput.startsWith("why") || lowerInput.startsWith("how") || lowerInput.startsWith("when") || lowerInput.startsWith("where") || lowerInput.startsWith("who") || lowerInput.startsWith("can you") || lowerInput.startsWith("could you") || lowerInput.includes("explain") || lowerInput.includes("help me understand")) {
      return "CHAT";
    }
    if (
      // Tag-specific patterns
      /\btags?\b/i.test(lowerInput) || /\btagging\b/i.test(lowerInput) || // Property patterns
      /\b(title|author|date|status|category|categories)\b/i.test(lowerInput) || // Metadata/frontmatter patterns
      /\b(metadata|frontmatter|properties|property)\b/i.test(lowerInput) || // Common metadata actions
      /^(add|update|set|remove|clean|optimize)\s+(tags?|title|author|metadata)/i.test(lowerInput)
    ) {
      return "METADATA";
    }
    if (/^(add|write|create|insert)\s+(a\s+)?(section|paragraph|conclusion|introduction|summary)/i.test(lowerInput) || /^(fix|correct|improve)\s+(grammar|spelling|writing)/i.test(lowerInput) || /^(make|rewrite|edit|modify|change)/i.test(lowerInput) || /^(delete|remove)\s+(the\s+)?(section|paragraph|sentence)/i.test(lowerInput)) {
      return "CONTENT";
    }
    return "CONTENT";
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian16.Plugin {
  async onload() {
    try {
      await this.loadSettings();
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      this.app.workspace.onLayoutReady(() => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
      });
      (0, import_obsidian16.addIcon)("nova-star", NOVA_ICON_SVG2);
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder(this.settings);
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.aiIntentClassifier = new AIIntentClassifier(this.aiProviderManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      this.addCommand({
        id: "nova-improve-writing",
        name: "Nova: Improve Writing",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("improve", editor);
        }
      });
      this.addCommand({
        id: "nova-make-longer",
        name: "Nova: Make Longer",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("longer", editor);
        }
      });
      this.addCommand({
        id: "nova-make-shorter",
        name: "Nova: Make Shorter",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("shorter", editor);
        }
      });
      TONE_OPTIONS.forEach((tone) => {
        this.addCommand({
          id: `nova-make-${tone.id}`,
          name: `Nova: Make ${tone.label}`,
          editorCallback: async (editor) => {
            await this.handleToneCommand(tone.id, editor);
          }
        });
      });
      this.addCommand({
        id: "nova-tell-nova",
        name: "Nova: Tell Nova...",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("custom", editor);
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      this.selectionContextMenu = new SelectionContextMenu(this.app, this);
      this.selectionContextMenu.register();
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
    } catch (error) {
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle selection-based commands
   */
  async handleSelectionCommand(actionId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian16.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction(actionId, editor, selectedText);
    } catch (error) {
      console.error("Error executing Nova selection command:", error);
      new import_obsidian16.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Handle tone-specific commands
   */
  async handleToneCommand(toneId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian16.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction("tone", editor, selectedText, toneId);
    } catch (error) {
      console.error("Error executing Nova tone command:", error);
      new import_obsidian16.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian16.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvYWkvbW9kZWxzLnRzIiwgInNyYy91aS9pbnB1dC1oYW5kbGVyLnRzIiwgInNyYy91aS93aWtpbGluay1zdWdnZXN0LnRzIiwgInNyYy91aS9jb21tYW5kLXN5c3RlbS50cyIsICJzcmMvdWkvY29udGV4dC1tYW5hZ2VyLnRzIiwgInNyYy91aS9jaGF0LXJlbmRlcmVyLnRzIiwgInNyYy91aS9zdHJlYW1pbmctbWFuYWdlci50cyIsICJzcmMvdWkvc2VsZWN0aW9uLWNvbnRleHQtbWVudS50cyIsICJzcmMvY29yZS9jb21tYW5kcy9zZWxlY3Rpb24tZWRpdC1jb21tYW5kLnRzIiwgInNyYy91aS90b25lLXNlbGVjdGlvbi1tb2RhbC50cyIsICJzcmMvdWkvY3VzdG9tLWluc3RydWN0aW9uLW1vZGFsLnRzIiwgInNyYy9haS9wcm92aWRlci1tYW5hZ2VyLnRzIiwgInNyYy9haS9wcm92aWRlcnMvY2xhdWRlLnRzIiwgInNyYy9haS9wcm92aWRlcnMvb3BlbmFpLnRzIiwgInNyYy9haS9wcm92aWRlcnMvZ29vZ2xlLnRzIiwgInNyYy9haS9wcm92aWRlcnMvb2xsYW1hLnRzIiwgInNyYy9jb3JlL2RvY3VtZW50LWVuZ2luZS50cyIsICJzcmMvY29yZS9jb252ZXJzYXRpb24tbWFuYWdlci50cyIsICJzcmMvY29yZS9jb250ZXh0LWJ1aWxkZXIudHMiLCAic3JjL2NvcmUvY29tbWFuZC1wYXJzZXIudHMiLCAic3JjL2NvcmUvcHJvbXB0LWJ1aWxkZXIudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvYWRkLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZWRpdC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2RlbGV0ZS1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9yZXdyaXRlLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZC50cyIsICJzcmMvbGljZW5zaW5nL2ZlYXR1cmUtY29uZmlnLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyLnRzIiwgInNyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3IudHMiLCAic3JjL2NvcmUvYWktaW50ZW50LWNsYXNzaWZpZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgV29ya3NwYWNlTGVhZiwgSXRlbVZpZXcsIGFkZEljb24sIE5vdGljZSwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzLCBOb3ZhU2V0dGluZ1RhYiwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBOb3ZhU2lkZWJhclZpZXcsIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgfSBmcm9tICcuL3NyYy91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL3NyYy9jb3JlL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IFByb21wdEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL3Byb21wdC1idWlsZGVyJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IEFkZENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgRGVsZXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgR3JhbW1hckNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZCc7XG5pbXBvcnQgeyBSZXdyaXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kJztcbmltcG9ydCB7IE1ldGFkYXRhQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZCc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3NyYy91aS93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IFNlbGVjdGlvbkNvbnRleHRNZW51IH0gZnJvbSAnLi9zcmMvdWkvc2VsZWN0aW9uLWNvbnRleHQtbWVudSc7XG5pbXBvcnQgeyBUT05FX09QVElPTlMgfSBmcm9tICcuL3NyYy91aS90b25lLXNlbGVjdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBBSUludGVudENsYXNzaWZpZXIgfSBmcm9tICcuL3NyYy9jb3JlL2FpLWludGVudC1jbGFzc2lmaWVyJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3ZhUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBOb3ZhU2V0dGluZ3M7XG5cdGFpUHJvdmlkZXJNYW5hZ2VyITogQUlQcm92aWRlck1hbmFnZXI7XG5cdGRvY3VtZW50RW5naW5lITogRG9jdW1lbnRFbmdpbmU7XG5cdGNvbnRleHRCdWlsZGVyITogQ29udGV4dEJ1aWxkZXI7XG5cdGNvbW1hbmRQYXJzZXIhOiBDb21tYW5kUGFyc2VyO1xuXHRwcm9tcHRCdWlsZGVyITogUHJvbXB0QnVpbGRlcjtcblx0Y29udmVyc2F0aW9uTWFuYWdlciE6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG5cdGFpSW50ZW50Q2xhc3NpZmllciE6IEFJSW50ZW50Q2xhc3NpZmllcjtcblx0YWRkQ29tbWFuZEhhbmRsZXIhOiBBZGRDb21tYW5kO1xuXHRlZGl0Q29tbWFuZEhhbmRsZXIhOiBFZGl0Q29tbWFuZDtcblx0ZGVsZXRlQ29tbWFuZEhhbmRsZXIhOiBEZWxldGVDb21tYW5kO1xuXHRncmFtbWFyQ29tbWFuZEhhbmRsZXIhOiBHcmFtbWFyQ29tbWFuZDtcblx0cmV3cml0ZUNvbW1hbmRIYW5kbGVyITogUmV3cml0ZUNvbW1hbmQ7XG5cdG1ldGFkYXRhQ29tbWFuZEhhbmRsZXIhOiBNZXRhZGF0YUNvbW1hbmQ7XG5cdGZlYXR1cmVNYW5hZ2VyITogRmVhdHVyZU1hbmFnZXI7XG5cdGxpY2Vuc2VWYWxpZGF0b3IhOiBMaWNlbnNlVmFsaWRhdG9yO1xuXHRzZXR0aW5nVGFiITogTm92YVNldHRpbmdUYWI7XG5cdHNpZGViYXJWaWV3ITogTm92YVNpZGViYXJWaWV3O1xuXHRzZWxlY3Rpb25Db250ZXh0TWVudSE6IFNlbGVjdGlvbkNvbnRleHRNZW51O1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBsaWNlbnNpbmcgc3lzdGVtXG5cdFx0XHR0aGlzLmxpY2Vuc2VWYWxpZGF0b3IgPSBuZXcgTGljZW5zZVZhbGlkYXRvcigpO1xuXHRcdFx0dGhpcy5mZWF0dXJlTWFuYWdlciA9IG5ldyBGZWF0dXJlTWFuYWdlcihcblx0XHRcdFx0dGhpcy5saWNlbnNlVmFsaWRhdG9yLFxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzXG5cdFx0XHQpO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgbGljZW5zZSBmcm9tIHNldHRpbmdzXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5saWNlbnNpbmcubGljZW5zZUtleSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UodGhpcy5zZXR0aW5ncy5saWNlbnNpbmcubGljZW5zZUtleSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJlZnJlc2ggU3VwZXJub3ZhIFVJIGFmdGVyIGxpY2Vuc2UgdmFsaWRhdGlvbiB0byBoYW5kbGUgZXhwaXJlZCBsaWNlbnNlc1xuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIE5vdGU6IE1vYmlsZSBhY2Nlc3MgcmVzdHJpY3Rpb25zIGFyZSBub3cgaGFuZGxlZCBpbiBzaWRlYmFyIFVJXG5cdFx0XHQvLyBUaGlzIGFsbG93cyBDb3JlIG1vYmlsZSB1c2VycyB0byBzZWUgdGhlIHVwZ3JhZGUgaW50ZXJmYWNlIHJhdGhlciB0aGFuIGEgYnJva2VuIHBsdWdpblxuXG5cdFx0XHQvLyBSZWdpc3RlciBjdXN0b20gaWNvblxuXHRcdFx0YWRkSWNvbignbm92YS1zdGFyJywgTk9WQV9JQ09OX1NWRyk7XG5cblx0XHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXIgPSBuZXcgQUlQcm92aWRlck1hbmFnZXIodGhpcy5zZXR0aW5ncywgdGhpcy5mZWF0dXJlTWFuYWdlcik7XG5cdFx0XHRhd2FpdCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyLmluaXRpYWxpemUoKTtcblxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb252ZXJzYXRpb24gbWFuYWdlciBhbmQgZG9jdW1lbnQgZW5naW5lXG5cdFx0XHRjb25zdCBkYXRhU3RvcmUgPSB7XG5cdFx0XHRcdGxvYWREYXRhOiAoa2V5OiBzdHJpbmcpID0+IHRoaXMubG9hZERhdGFXaXRoS2V5KGtleSksXG5cdFx0XHRcdHNhdmVEYXRhOiAoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdGhpcy5zYXZlRGF0YVdpdGhLZXkoa2V5LCBkYXRhKVxuXHRcdFx0fTtcblx0XHRcdHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IG5ldyBDb252ZXJzYXRpb25NYW5hZ2VyKGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lID0gbmV3IERvY3VtZW50RW5naW5lKHRoaXMuYXBwLCBkYXRhU3RvcmUpO1xuXHRcdFx0dGhpcy5kb2N1bWVudEVuZ2luZS5zZXRDb252ZXJzYXRpb25NYW5hZ2VyKHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcik7XG5cdFx0XHR0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKHRoaXMuc2V0dGluZ3MpO1xuXHRcdFx0dGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcblx0XHRcdHRoaXMucHJvbXB0QnVpbGRlciA9IG5ldyBQcm9tcHRCdWlsZGVyKHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcik7XG5cdFx0XHR0aGlzLmFpSW50ZW50Q2xhc3NpZmllciA9IG5ldyBBSUludGVudENsYXNzaWZpZXIodGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHRcblx0XHRcdC8vIEluaXRpYWxpemUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbnNcblx0XHRcdHRoaXMuYWRkQ29tbWFuZEhhbmRsZXIgPSBuZXcgQWRkQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmVkaXRDb21tYW5kSGFuZGxlciA9IG5ldyBFZGl0Q29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmRlbGV0ZUNvbW1hbmRIYW5kbGVyID0gbmV3IERlbGV0ZUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5ncmFtbWFyQ29tbWFuZEhhbmRsZXIgPSBuZXcgR3JhbW1hckNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5yZXdyaXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgUmV3cml0ZUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyID0gbmV3IE1ldGFkYXRhQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cblx0XHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0XHRWSUVXX1RZUEVfTk9WQV9TSURFQkFSLFxuXHRcdFx0XHQobGVhZikgPT4gbmV3IE5vdmFTaWRlYmFyVmlldyhsZWFmLCB0aGlzKVxuXHRcdFx0KTtcblxuXHRcdFx0Ly8gTm90ZTogV2lraWxpbmsgYXV0b2NvbXBsZXRlIGlzIG5vdyBoYW5kbGVkIGRpcmVjdGx5IGluIHNpZGViYXIgdmlld1xuXG5cdFx0XHRjb25zdCByaWJib25JY29uID0gdGhpcy5hZGRSaWJib25JY29uKCdub3ZhLXN0YXInLCAnTm92YSBBSScsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBSZWdpc3RlciBzZWxlY3Rpb24tYmFzZWQgY29tbWFuZHNcblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1pbXByb3ZlLXdyaXRpbmcnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogSW1wcm92ZSBXcml0aW5nJyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvcikgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlU2VsZWN0aW9uQ29tbWFuZCgnaW1wcm92ZScsIGVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtbWFrZS1sb25nZXInLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogTWFrZSBMb25nZXInLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVTZWxlY3Rpb25Db21tYW5kKCdsb25nZXInLCBlZGl0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLW1ha2Utc2hvcnRlcicsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBNYWtlIFNob3J0ZXInLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVTZWxlY3Rpb25Db21tYW5kKCdzaG9ydGVyJywgZWRpdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEluZGl2aWR1YWwgdG9uZSBjb21tYW5kc1xuXHRcdFx0VE9ORV9PUFRJT05TLmZvckVhY2godG9uZSA9PiB7XG5cdFx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdFx0aWQ6IGBub3ZhLW1ha2UtJHt0b25lLmlkfWAsXG5cdFx0XHRcdFx0bmFtZTogYE5vdmE6IE1ha2UgJHt0b25lLmxhYmVsfWAsXG5cdFx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvcikgPT4ge1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVUb25lQ29tbWFuZCh0b25lLmlkLCBlZGl0b3IpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLXRlbGwtbm92YScsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBUZWxsIE5vdmEuLi4nLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVTZWxlY3Rpb25Db21tYW5kKCdjdXN0b20nLCBlZGl0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdvcGVuLW5vdmEtc2lkZWJhcicsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBPcGVuIHNpZGViYXInLFxuXHRcdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIHNlbGVjdGlvbiBjb250ZXh0IG1lbnVcblx0XHRcdHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUgPSBuZXcgU2VsZWN0aW9uQ29udGV4dE1lbnUodGhpcy5hcHAsIHRoaXMpO1xuXHRcdFx0dGhpcy5zZWxlY3Rpb25Db250ZXh0TWVudS5yZWdpc3RlcigpO1xuXG5cdFx0XHR0aGlzLnNldHRpbmdUYWIgPSBuZXcgTm92YVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpO1xuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYih0aGlzLnNldHRpbmdUYWIpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0fVxuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlcj8uY2xlYW51cCgpO1xuXHRcdHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcj8uY2xlYW51cCgpO1xuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlcj8udXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XG5cdFx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuXG5cdFx0bGV0IGxlYWY6IFdvcmtzcGFjZUxlYWYgfCBudWxsO1xuXHRcdGNvbnN0IGxlYXZlcyA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cblx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGxlYWYgPSBsZWF2ZXNbMF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxlYWYgPSB3b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWY/LnNldFZpZXdTdGF0ZSh7IHR5cGU6IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsIGFjdGl2ZTogdHJ1ZSB9KTtcblx0XHR9XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmISk7XG5cdFx0XG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIHRvIHNpZGViYXIgdmlld1xuXHRcdGlmIChsZWFmPy52aWV3IGluc3RhbmNlb2YgTm92YVNpZGViYXJWaWV3KSB7XG5cdFx0XHR0aGlzLnNpZGViYXJWaWV3ID0gbGVhZi52aWV3O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgc2VsZWN0aW9uLWJhc2VkIGNvbW1hbmRzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoYWN0aW9uSWQ6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXHRcdFx0aWYgKCFzZWxlY3RlZFRleHQgfHwgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCBzb21lIHRleHQgZmlyc3QnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRhd2FpdCB0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51LmhhbmRsZVNlbGVjdGlvbkFjdGlvbihhY3Rpb25JZCwgZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgTm92YSBzZWxlY3Rpb24gY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHRvbmUtc3BlY2lmaWMgY29tbWFuZHNcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlVG9uZUNvbW1hbmQodG9uZUlkOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdGlmICghc2VsZWN0ZWRUZXh0IHx8IHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ1BsZWFzZSBzZWxlY3Qgc29tZSB0ZXh0IGZpcnN0Jyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2FsbCBoYW5kbGVTZWxlY3Rpb25BY3Rpb24gd2l0aCB0b25lIGFjdGlvbiBhbmQgdGhlIHNwZWNpZmljIHRvbmVcblx0XHRcdGF3YWl0IHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKCd0b25lJywgZWRpdG9yLCBzZWxlY3RlZFRleHQsIHRvbmVJZCk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyBOb3ZhIHRvbmUgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcblx0XHR9XG5cdH1cblxuXG5cdC8qKlxuXHQgKiBTaG93IHVwZ3JhZGUgcHJvbXB0IGZvciBDb3JlIHRpZXIgbW9iaWxlIHVzZXJzXG5cdCAqL1xuXHRwcml2YXRlIHNob3dNb2JpbGVVcGdyYWRlUHJvbXB0KCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0bW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsIG5vdmEtbW9iaWxlLXVwZ3JhZGUtbW9kYWwnO1xuXHRcdG1vZGFsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250YWluZXJcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJnXCI+PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuXHRcdFx0XHRcdFx0PGgzPk5vdmEgU3VwZXJOb3ZhIFJlcXVpcmVkPC9oMz5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYm9keVwiPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtdGllci1iYWRnZSBjb3JlXCIgc3R5bGU9XCJtYXJnaW4tYm90dG9tOiAxZW07XCI+XG5cdFx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwidGllci1pY29uXCI+RlJFRTwvc3Bhbj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLW5hbWVcIj5Db3JlIChGcmVlKTwvc3Bhbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PHA+TW9iaWxlIGFjY2VzcyBpcyBhdmFpbGFibGUgd2l0aCBOb3ZhIFN1cGVyTm92YS48L3A+XG5cdFx0XHRcdFx0XHQ8cD5Db3JlIHRpZXIgaXMgbGltaXRlZCB0byBkZXNrdG9wIHVzZSBvbmx5LjwvcD5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWZlYXR1cmUtbGlzdFwiPlxuXHRcdFx0XHRcdFx0XHQ8aDQ+U3VwZXJOb3ZhIGluY2x1ZGVzOjwvaDQ+XG5cdFx0XHRcdFx0XHRcdDx1bD5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+TW9iaWxlIGRldmljZSBzdXBwb3J0PC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+TXVsdGlwbGUgQUkgcHJvdmlkZXJzPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+SW4tY2hhdCBwcm92aWRlciBzd2l0Y2hpbmc8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5BZHZhbmNlZCB0ZW1wbGF0ZXM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Qcmlvcml0eSBzdXBwb3J0PC9saT5cblx0XHRcdFx0XHRcdFx0PC91bD5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJtb2QtY3RhIG5vdmEtdXBncmFkZS1idG5cIj5VcGdyYWRlIHRvIFN1cGVyTm92YTwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm5vdmEtY2xvc2UtYnRuXCI+Q2xvc2U8L2J1dHRvbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Y29uc3QgdXBncmFkZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXVwZ3JhZGUtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0Y29uc3QgY2xvc2VCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jbG9zZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBtb2RhbEJnID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsLWJnJykgYXMgSFRNTEVsZW1lbnQ7XG5cblx0XHRjb25zdCBjbG9zZU1vZGFsID0gKCkgPT4ge1xuXHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0fTtcblxuXHRcdHVwZ3JhZGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3aW5kb3cub3BlbignaHR0cHM6Ly9ub3Zhd3JpdGVyLmFpL3VwZ3JhZGUnLCAnX2JsYW5rJyk7XG5cdFx0XHRjbG9zZU1vZGFsKCk7XG5cdFx0fSk7XG5cblx0XHRjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXHRcdG1vZGFsQmcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcblxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpO1xuXG5cdFx0Ly8gU2hvdyBub3RpY2UgYXMgd2VsbFxuXHRcdG5ldyBOb3RpY2UoJ05vdmEgbW9iaWxlIGFjY2VzcyByZXF1aXJlcyBTdXBlck5vdmEgbGljZW5zZScsIDgwMDApO1xuXHR9XG5cblx0Ly8gRGF0YVN0b3JlIGludGVyZmFjZSBpbXBsZW1lbnRhdGlvbiBmb3IgQ29udmVyc2F0aW9uTWFuYWdlclxuXHRhc3luYyBsb2FkRGF0YVdpdGhLZXkoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuXHRcdGNvbnN0IGFsbERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG5cdFx0cmV0dXJuIGFsbERhdGEgPyBhbGxEYXRhW2tleV0gOiB1bmRlZmluZWQ7XG5cdH1cblxuXHRhc3luYyBzYXZlRGF0YVdpdGhLZXkoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFsbERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCkgfHwge307XG5cdFx0YWxsRGF0YVtrZXldID0gZGF0YTtcblx0XHRyZXR1cm4gYXdhaXQgdGhpcy5zYXZlRGF0YShhbGxEYXRhKTtcblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vbWFpbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyU2V0dGluZ3MsIFBsYXRmb3JtU2V0dGluZ3MsIFByb3ZpZGVyVHlwZSB9IGZyb20gJy4vYWkvdHlwZXMnO1xuaW1wb3J0IHsgRGVidWdTZXR0aW5ncyB9IGZyb20gJy4vbGljZW5zaW5nL3R5cGVzJztcbmltcG9ydCB7IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsIE5vdmFTaWRlYmFyVmlldyB9IGZyb20gJy4vdWkvc2lkZWJhci12aWV3JztcbmltcG9ydCB7IGdldEF2YWlsYWJsZU1vZGVscyB9IGZyb20gJy4vYWkvbW9kZWxzJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbUNvbW1hbmQge1xuXHRpZDogc3RyaW5nO1xuXHRuYW1lOiBzdHJpbmc7XG5cdHRyaWdnZXI6IHN0cmluZztcblx0dGVtcGxhdGU6IHN0cmluZztcblx0ZGVzY3JpcHRpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTm92YVNldHRpbmdzIHtcblx0YWlQcm92aWRlcnM6IEFJUHJvdmlkZXJTZXR0aW5ncztcblx0cGxhdGZvcm1TZXR0aW5nczogUGxhdGZvcm1TZXR0aW5ncztcblx0Y3VzdG9tQ29tbWFuZHM/OiBDdXN0b21Db21tYW5kW107XG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IG51bWJlcjtcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiBudW1iZXI7XG5cdFx0YXV0b1NhdmU6IGJvb2xlYW47XG5cdH07XG5cdHNob3dDb21tYW5kQnV0dG9uOiBib29sZWFuO1xuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiBzdHJpbmc7XG5cdFx0c3VwZXJub3ZhTGljZW5zZUtleT86IHN0cmluZztcblx0XHRpc1N1cGVybm92YT86IGJvb2xlYW47XG5cdFx0ZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncztcblx0fTtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE5vdmFTZXR0aW5ncyA9IHtcblx0YWlQcm92aWRlcnM6IHtcblx0XHRjbGF1ZGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9wZW5haToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdGJhc2VVcmw6ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJyxcblx0XHRcdG1vZGVsOiAnZ3B0LTRvJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdGdvb2dsZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnZ2VtaW5pLTEuNS1mbGFzaCcsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvbGxhbWE6IHtcblx0XHRcdGJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jyxcblx0XHRcdG1vZGVsOiAnJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9XG5cdH0sXG5cdHBsYXRmb3JtU2V0dGluZ3M6IHtcblx0XHRkZXNrdG9wOiB7XG5cdFx0XHRwcmltYXJ5UHJvdmlkZXI6ICdvbGxhbWEnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdH0sXG5cdFx0bW9iaWxlOiB7XG5cdFx0XHRwcmltYXJ5UHJvdmlkZXI6ICdub25lJyxcblx0XHRcdGZhbGxiYWNrUHJvdmlkZXJzOiBbJ29wZW5haScsICdnb29nbGUnXVxuXHRcdH1cblx0fSxcblx0Y3VzdG9tQ29tbWFuZHM6IFtdLFxuXHRnZW5lcmFsOiB7XG5cdFx0ZGVmYXVsdFRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0ZGVmYXVsdE1heFRva2VuczogMTAwMCxcblx0XHRhdXRvU2F2ZTogdHJ1ZVxuXHR9LFxuXHRzaG93Q29tbWFuZEJ1dHRvbjogdHJ1ZSxcblx0bGljZW5zaW5nOiB7XG5cdFx0bGljZW5zZUtleTogJycsXG5cdFx0c3VwZXJub3ZhTGljZW5zZUtleTogJycsXG5cdFx0aXNTdXBlcm5vdmE6IGZhbHNlLFxuXHRcdGRlYnVnU2V0dGluZ3M6IHtcblx0XHRcdGVuYWJsZWQ6IGZhbHNlLFxuXHRcdFx0b3ZlcnJpZGVEYXRlOiB1bmRlZmluZWQsXG5cdFx0XHRmb3JjZVN1cGVybm92YTogZmFsc2Vcblx0XHR9XG5cdH1cbn07XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IE5vdmFQbHVnaW47XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ05vdmEgQUkgU2V0dGluZ3MnIH0pO1xuXG5cdFx0dGhpcy5jcmVhdGVMaWNlbnNlU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZUdlbmVyYWxTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlUGxhdGZvcm1TZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlUHJvdmlkZXJTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlQ29tbWFuZFNldHRpbmdzKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUxpY2Vuc2VTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnN0IGxpY2Vuc2VDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxpY2Vuc2Utc2VjdGlvbicgfSk7XG5cdFx0bGljZW5zZUNvbnRhaW5lci5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdTdXBlcm5vdmEgU3VwcG9ydGVyIFN0YXR1cycgfSk7XG5cblx0XHQvLyBJbmZvIGFib3V0IHRoZSBuZXcgbW9kZWxcblx0XHRjb25zdCBpbmZvRWwgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbW9kZWwtaW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZCBjb21wYWN0XCI+XG5cdFx0XHRcdDxwPk5vdmEgcHJvdmlkZXMgYWxsIGZlYXR1cmVzIGZvciBmcmVlIHdoZW4geW91IHVzZSB5b3VyIG93biBBSSBwcm92aWRlciBBUEkga2V5cy4gXG5cdFx0XHRcdFN1cGVybm92YSBzdXBwb3J0ZXJzIGdldCBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IFN1cGVybm92YSBzdGF0dXNcblx0XHRjb25zdCBpc1N1cGVybm92YSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5pc1N1cGVybm92YVN1cHBvcnRlcigpIHx8IGZhbHNlO1xuXHRcdGNvbnN0IHN1cGVybm92YUxpY2Vuc2UgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uZ2V0U3VwZXJub3ZhTGljZW5zZSgpO1xuXHRcdFxuXHRcdGNvbnN0IHN0YXR1c0Rpc3BsYXkgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VwZXJub3ZhLXN0YXR1cycgfSk7XG5cdFx0Y29uc3Qgc3RhdHVzVGV4dCA9IGlzU3VwZXJub3ZhID8gJ1N1cGVybm92YSBTdXBwb3J0ZXInIDogJ05vdmEgVXNlcic7XG5cdFx0Y29uc3Qgc3RhdHVzSWNvbiA9IGlzU3VwZXJub3ZhID8gYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0eWxlPVwid2lkdGg6IDE0cHg7IGhlaWdodDogMTRweDsgY29sb3I6ICM5MzMzZWE7IGZpbHRlcjogZHJvcC1zaGFkb3coMCAwIDRweCByZ2JhKDE0NywgNTEsIDIzNCwgMC42KSk7XCI+XG5cdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0PC9zdmc+YCA6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHlsZT1cIndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XCI+XG5cdFx0XHQke05PVkFfSUNPTl9TVkd9XG5cdFx0PC9zdmc+YDtcblx0XHRzdGF0dXNEaXNwbGF5LmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXN0YXR1cy1iYWRnZSAke2lzU3VwZXJub3ZhID8gJ3N1cGVybm92YScgOiAnbm92YSd9XCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLWljb25cIj4ke3N0YXR1c0ljb259PC9zcGFuPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInN0YXR1cy1uYW1lXCI+JHtzdGF0dXNUZXh0fTwvc3Bhbj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBzdGF0dXNcblx0XHRpZiAoc3VwZXJub3ZhTGljZW5zZSkge1xuXHRcdFx0Y29uc3Qgc3RhdHVzRWwgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zdGF0dXMnIH0pO1xuXHRcdFx0Y29uc3QgZXhwaXJ5VGV4dCA9IHN1cGVybm92YUxpY2Vuc2UuZXhwaXJlc0F0IFxuXHRcdFx0XHQ/IGBFeHBpcmVzOiAke3N1cGVybm92YUxpY2Vuc2UuZXhwaXJlc0F0LnRvTG9jYWxlRGF0ZVN0cmluZygpfWBcblx0XHRcdFx0OiAnTGlmZXRpbWUgU3VwcG9ydCc7XG5cdFx0XHRzdGF0dXNFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJsaWNlbnNlLWluZm9cIj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImxpY2Vuc2UtZW1haWxcIj4ke3N1cGVybm92YUxpY2Vuc2UuZW1haWx9PC9zcGFuPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1leHBpcnlcIj4ke2V4cGlyeVRleHR9PC9zcGFuPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fVxuXG5cdFx0Ly8gU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IGlucHV0XG5cdFx0bmV3IFNldHRpbmcobGljZW5zZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdTdXBlcm5vdmEgTGljZW5zZSBLZXkgKE9wdGlvbmFsKScpXG5cdFx0XHQuc2V0RGVzYygnRW50ZXIgeW91ciBTdXBlcm5vdmEgc3VwcG9ydGVyIGxpY2Vuc2Uga2V5IGZvciBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4ge1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG5cdFx0XHRcdHRleHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIFN1cGVybm92YSBsaWNlbnNlIGtleS4uLicpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5IHx8ICcnKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gVXBkYXRlIFN1cGVybm92YSBsaWNlbnNlIGluIGZlYXR1cmUgbWFuYWdlclxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UodmFsdWUgfHwgbnVsbCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXIgdG8gdXBkYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCB0aGUgZGlzcGxheSB0byBzaG93IHVwZGF0ZWQgc3RhdHVzXG5cdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIEFkZCB2YWxpZGF0aW9uIGJ1dHRvblxuXHRcdFx0XHRjb25zdCB2YWxpZGF0ZUJ1dHRvbiA9IHRleHQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5jcmVhdGVFbCgnYnV0dG9uJywge1xuXHRcdFx0XHRcdHRleHQ6ICdWYWxpZGF0ZScsXG5cdFx0XHRcdFx0Y2xzOiAnbm92YS12YWxpZGF0ZS1idG4nXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHZhbGlkYXRlQnV0dG9uKSB7XG5cdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBsaWNlbnNlS2V5ID0gdGV4dC5pbnB1dEVsLnZhbHVlO1xuXHRcdFx0XHRcdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdQbGVhc2UgZW50ZXIgYSBTdXBlcm5vdmEgbGljZW5zZSBrZXkgZmlyc3QuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24udGV4dENvbnRlbnQgPSAnVmFsaWRhdGluZy4uLic7XG5cdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc1N1cGVybm92YVN1cHBvcnRlcigpO1xuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdGlmIChpc1N1cGVybm92YSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1ZhbGlkIFN1cGVybm92YSBsaWNlbnNlISBZb3Ugbm93IGhhdmUgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy4nLCAnc3VjY2VzcycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93Q29uZmV0dGkoKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0ludmFsaWQgb3IgZXhwaXJlZCBTdXBlcm5vdmEgbGljZW5zZSBrZXkuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnRXJyb3IgdmFsaWRhdGluZyBTdXBlcm5vdmEgbGljZW5zZS4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdH0gZmluYWxseSB7XG5cdFx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLnRleHRDb250ZW50ID0gJ1ZhbGlkYXRlJztcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHQvLyBTdXBlcm5vdmEgc3VwcG9ydGVyIGluZm9ybWF0aW9uIG9ubHlcblx0XHR0aGlzLmNyZWF0ZVN1cGVybm92YUluZm8obGljZW5zZUNvbnRhaW5lcik7XG5cblx0XHQvLyBEZWJ1ZyBzZXR0aW5ncyAoZGV2ZWxvcG1lbnQgb25seSlcblx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgfHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCkge1xuXHRcdFx0dGhpcy5jcmVhdGVEZWJ1Z1NldHRpbmdzKGxpY2Vuc2VDb250YWluZXIpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlU3VwZXJub3ZhSW5mbyhjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Ly8gU3VwZXJub3ZhIHN1cHBvcnRlciBpbmZvcm1hdGlvblxuXHRcdGNvbnN0IHN1cGVybm92YUluZm8gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdXBlcm5vdmEtaW5mbycgfSk7XG5cdFx0c3VwZXJub3ZhSW5mby5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg1PkJlY29tZSBhIFN1cGVybm92YSBTdXBwb3J0ZXI8L2g1PlxuXHRcdFx0XHQ8cD5TdXBwb3J0IE5vdmEgZGV2ZWxvcG1lbnQgYW5kIGdldCBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLiBBbGwgZmVhdHVyZXMgZXZlbnR1YWxseSBiZWNvbWUgZnJlZSBmb3IgZXZlcnlvbmUuPC9wPlxuXHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0PGxpPkVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMgKDMtNiBtb250aHMgYmVmb3JlIGdlbmVyYWwgcmVsZWFzZSk8L2xpPlxuXHRcdFx0XHRcdDxsaT5Qcmlvcml0eSBzdXBwb3J0IGFuZCBmZWF0dXJlIHJlcXVlc3RzPC9saT5cblx0XHRcdFx0XHQ8bGk+U3VwcG9ydGVyIGJhZGdlIGFuZCByZWNvZ25pdGlvbjwvbGk+XG5cdFx0XHRcdFx0PGxpPkRpcmVjdGx5IHN1cHBvcnQgb3Blbi1zb3VyY2UgZGV2ZWxvcG1lbnQ8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlRGVidWdTZXR0aW5ncyhjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgZGVidWdDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kZWJ1Zy1zZWN0aW9uJyB9KTtcblx0XHRkZWJ1Z0NvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXZlbG9wbWVudCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdEZWJ1ZyBNb2RlJylcblx0XHRcdC5zZXREZXNjKCdFbmFibGUgZGV2ZWxvcG1lbnQgdGVzdGluZyBmZWF0dXJlcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5IHRvIHNob3cvaGlkZSBkZWJ1ZyBvcHRpb25zXG5cdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ092ZXJyaWRlIERhdGUnKVxuXHRcdFx0XHQuc2V0RGVzYygnT3ZlcnJpZGUgY3VycmVudCBkYXRlIGZvciB0ZXN0aW5nIHRpbWUtZ2F0ZWQgZmVhdHVyZXMgKFlZWVktTU0tREQpJylcblx0XHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCcyMDI1LTEyLTAxJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlIHx8ICcnKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSA9IHZhbHVlIHx8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIERvbid0IHJlZnJlc2ggZGlzcGxheSBvbiBldmVyeSBrZXlzdHJva2UgLSBqdXN0IHVwZGF0ZSB0aGUgZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0fSkpO1xuXG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ0ZvcmNlIFN1cGVybm92YSBTdGF0dXMnKVxuXHRcdFx0XHQuc2V0RGVzYygnT3ZlcnJpZGUgU3VwZXJub3ZhIHN1cHBvcnRlciBzdGF0dXMgZm9yIHRlc3RpbmcnKVxuXHRcdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgfHwgZmFsc2UpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFNob3cgY29uZmV0dGkgd2hlbiB0dXJuaW5nIE9OIEZvcmNlIFN1cGVybm92YVxuXHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0NvbmZldHRpKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5IHRvIHNob3cgdXBkYXRlZCBmZWF0dXJlIHN0YXR1c1xuXHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0fSkpO1xuXG5cdFx0XHQvLyBDbGVhciBsaWNlbnNlcyBidXR0b25cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnQ2xlYXIgQWxsIExpY2Vuc2VzJylcblx0XHRcdFx0LnNldERlc2MoJ1JlbW92ZSBhbGwgYXBwbGllZCBsaWNlbnNlcyAoZm9yIHRlc3RpbmcpJylcblx0XHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ0NsZWFyIExpY2Vuc2VzJylcblx0XHRcdFx0XHQuc2V0V2FybmluZygpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0Ly8gQ29uZmlybSBhY3Rpb25cblx0XHRcdFx0XHRcdGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciBhbGwgbGljZW5zZXM/IFRoaXMgd2lsbCByZW1vdmUgYW55IGFwcGxpZWQgU3VwZXJub3ZhIGxpY2Vuc2UuJyk7XG5cdFx0XHRcdFx0XHRpZiAoIWNvbmZpcm1lZCkgcmV0dXJuO1xuXG5cdFx0XHRcdFx0XHQvLyBDbGVhciBsaWNlbnNlIGtleVxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgPSAnJztcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gQ2xlYXIgRm9yY2UgU3VwZXJub3ZhIGlmIGVuYWJsZWRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblxuXHRcdFx0XHRcdFx0Ly8gVXBkYXRlIGZlYXR1cmUgbWFuYWdlclxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobnVsbCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXJcblx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gU2hvdyBzdWNjZXNzIG1lc3NhZ2Vcblx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdBbGwgbGljZW5zZXMgY2xlYXJlZCBzdWNjZXNzZnVsbHkuJywgJ3N1Y2Nlc3MnKTtcblxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5XG5cdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9KSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93TGljZW5zZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InKSB7XG5cdFx0Ly8gQ3JlYXRlIG9yIHVwZGF0ZSBtZXNzYWdlIGVsZW1lbnRcblx0XHRjb25zdCBleGlzdGluZ01lc3NhZ2UgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWxpY2Vuc2UtbWVzc2FnZScpO1xuXHRcdGlmIChleGlzdGluZ01lc3NhZ2UpIHtcblx0XHRcdGV4aXN0aW5nTWVzc2FnZS5yZW1vdmUoKTtcblx0XHR9XG5cblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IFxuXHRcdFx0Y2xzOiBgbm92YS1saWNlbnNlLW1lc3NhZ2UgJHt0eXBlfWAsXG5cdFx0XHR0ZXh0OiBtZXNzYWdlXG5cdFx0fSk7XG5cblx0XHQvLyBBdXRvLXJlbW92ZSBhZnRlciA1IHNlY29uZHNcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdG1lc3NhZ2VFbC5yZW1vdmUoKTtcblx0XHR9LCA1MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbmZldHRpKCkge1xuXHRcdC8vIENyZWF0ZSBjb25mZXR0aSBjb250YWluZXJcblx0XHRjb25zdCBjb25mZXR0aUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdGNvbmZldHRpQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdub3ZhLWNvbmZldHRpLWNvbnRhaW5lcic7XG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb25mZXR0aUNvbnRhaW5lcik7XG5cblx0XHQvLyBHZXQgc2V0dGluZ3MgY29udGFpbmVyIHBvc2l0aW9uIGZvciBleHBsb3Npb24gY2VudGVyXG5cdFx0Y29uc3QgcmVjdCA9IHRoaXMuY29udGFpbmVyRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Y29uc3QgY2VudGVyWCA9IHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyO1xuXHRcdGNvbnN0IGNlbnRlclkgPSByZWN0LnRvcCArIE1hdGgubWluKHJlY3QuaGVpZ2h0IC8gMiwgMzAwKTtcblxuXHRcdC8vIENvbG9ycyBmb3IgY29uZmV0dGlcblx0XHRjb25zdCBjb2xvcnMgPSBbJ2dvbGQnLCAnYmx1ZScsICdwaW5rJywgJ2dyZWVuJywgJ3JlZCcsICcnXTsgIC8vIGVtcHR5IHN0cmluZyA9IGRlZmF1bHQgcHVycGxlXG5cblx0XHQvLyBDcmVhdGUgY29uZmV0dGkgcGllY2VzXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCAxNTA7IGkrKykge1xuXHRcdFx0Y29uc3QgY29uZmV0dGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdGNvbmZldHRpLmNsYXNzTmFtZSA9IGBub3ZhLWNvbmZldHRpLXBpZWNlICR7Y29sb3JzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbG9ycy5sZW5ndGgpXX1gO1xuXHRcdFx0XG5cdFx0XHQvLyBQb3NpdGlvbiBhdCBleHBsb3Npb24gY2VudGVyXG5cdFx0XHRjb25mZXR0aS5zdHlsZS5sZWZ0ID0gYCR7Y2VudGVyWH1weGA7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS50b3AgPSBgJHtjZW50ZXJZfXB4YDtcblx0XHRcdFxuXHRcdFx0Ly8gQ2FsY3VsYXRlIGV4cGxvc2lvbiB0cmFqZWN0b3J5XG5cdFx0XHRjb25zdCBhbmdsZSA9IChNYXRoLlBJICogMiAqIGkpIC8gMTUwICsgKE1hdGgucmFuZG9tKCkgKiAwLjIgLSAwLjEpO1xuXHRcdFx0Y29uc3QgdmVsb2NpdHkgPSAyNTAgKyBNYXRoLnJhbmRvbSgpICogMzUwOyAvLyBwaXhlbHNcblx0XHRcdGNvbnN0IGV4cGxvZGVYID0gTWF0aC5jb3MoYW5nbGUpICogdmVsb2NpdHk7XG5cdFx0XHRjb25zdCBleHBsb2RlWSA9IE1hdGguc2luKGFuZ2xlKSAqIHZlbG9jaXR5IC0gMTUwOyAvLyBTdHJvbmcgdXB3YXJkIGJpYXNcblx0XHRcdFxuXHRcdFx0Ly8gU2V0IENTUyBjdXN0b20gcHJvcGVydGllcyBmb3IgYW5pbWF0aW9uXG5cdFx0XHRjb25mZXR0aS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1leHBsb2RlLXgnLCBgJHtleHBsb2RlWH1weGApO1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUuc2V0UHJvcGVydHkoJy0tZXhwbG9kZS15JywgYCR7ZXhwbG9kZVl9cHhgKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmFuZG9tIGRlbGF5IGZvciBzdGFnZ2VyZWQgZXhwbG9zaW9uXG5cdFx0XHRjb25mZXR0aS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGAke01hdGgucmFuZG9tKCkgKiAwLjJ9c2A7XG5cdFx0XHRcblx0XHRcdC8vIFJhbmRvbSBzaXplXG5cdFx0XHRjb25zdCBzaXplID0gNiArIE1hdGgucmFuZG9tKCkgKiAxNDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLndpZHRoID0gYCR7c2l6ZX1weGA7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS5oZWlnaHQgPSBgJHtzaXplfXB4YDtcblx0XHRcdFxuXHRcdFx0Ly8gTWFrZSBzb21lIGNvbmZldHRpIHJlY3Rhbmd1bGFyXG5cdFx0XHRpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xuXHRcdFx0XHRjb25mZXR0aS5zdHlsZS5oZWlnaHQgPSBgJHtzaXplICogMC40fXB4YDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Y29uZmV0dGlDb250YWluZXIuYXBwZW5kQ2hpbGQoY29uZmV0dGkpO1xuXHRcdH1cblxuXHRcdC8vIFJlbW92ZSBjb250YWluZXIgYWZ0ZXIgYW5pbWF0aW9uIGNvbXBsZXRlc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y29uZmV0dGlDb250YWluZXIucmVtb3ZlKCk7XG5cdFx0fSwgNDAwMCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUdlbmVyYWxTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0dlbmVyYWwgU2V0dGluZ3MnIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBUZW1wZXJhdHVyZScpXG5cdFx0XHQuc2V0RGVzYygnQ29udHJvbHMgcmFuZG9tbmVzcyBpbiBBSSByZXNwb25zZXMgKDAuMCAtIDEuMCknKVxuXHRcdFx0LmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXG5cdFx0XHRcdC5zZXRMaW1pdHMoMCwgMSwgMC4xKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0VGVtcGVyYXR1cmUpXG5cdFx0XHRcdC5zZXREeW5hbWljVG9vbHRpcCgpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IE1heCBUb2tlbnMnKVxuXHRcdFx0LnNldERlc2MoJ01heGltdW0gbGVuZ3RoIG9mIEFJIHJlc3BvbnNlcycpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCcxMDAwJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2Vucy50b1N0cmluZygpKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgbnVtVmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XG5cdFx0XHRcdFx0aWYgKCFpc05hTihudW1WYWx1ZSkgJiYgbnVtVmFsdWUgPiAwKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnMgPSBudW1WYWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnQXV0by1zYXZlIHNldHRpbmdzJylcblx0XHRcdC5zZXREZXNjKCdBdXRvbWF0aWNhbGx5IHNhdmUgc2V0dGluZ3Mgd2hlbiBjaGFuZ2VkJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5hdXRvU2F2ZSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuYXV0b1NhdmUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVByb3ZpZGVyU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQUkgUHJvdmlkZXIgU2V0dGluZ3MnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZsZXg6IDE7JztcblxuXHRcdGNvbnN0IHByb3ZpZGVyQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRwcm92aWRlckNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IG5vbmU7JzsgLy8gU3RhcnQgY29sbGFwc2VkXG5cdFx0XG5cdFx0Ly8gVG9nZ2xlIGZ1bmN0aW9uYWxpdHlcblx0XHRoZWFkZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdGNvbnN0IGlzVmlzaWJsZSA9IHByb3ZpZGVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdHByb3ZpZGVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpc1Zpc2libGUgPyAnbm9uZScgOiAnYmxvY2snO1xuXHRcdFx0YXJyb3dFbC5zdHlsZS50cmFuc2Zvcm0gPSBpc1Zpc2libGUgPyAncm90YXRlKDBkZWcpJyA6ICdyb3RhdGUoOTBkZWcpJztcblx0XHR9KTtcblxuXHRcdC8vIEluZm8gYWJvdXQgQVBJIGtleXMgYW5kIG1vZGVsIHJlY29tbWVuZGF0aW9uc1xuXHRcdGNvbnN0IGluZm9FbCA9IHByb3ZpZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDQ+Q29uZmlndXJlIFlvdXIgQVBJIEtleXM8L2g0PlxuXHRcdFx0XHQ8cD5Ob3ZhIGNvbm5lY3RzIHRvIEFJIHByb3ZpZGVycyB1c2luZyB5b3VyIG93biBBUEkga2V5cy4gQWxsIHByb3ZpZGVycyBhcmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyAtIFxuXHRcdFx0XHRqdXN0IGFkZCB5b3VyIEFQSSBrZXlzIGJlbG93IHRvIGdldCBzdGFydGVkLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkIG5vdmEtbW9kZWwtZ3VpZGFuY2VcIj5cblx0XHRcdFx0PGg0PlJlY29tbWVuZGVkIERlZmF1bHRzPC9oND5cblx0XHRcdFx0PHVsIGNsYXNzPVwibm92YS1tb2RlbC1yZWNvbW1lbmRhdGlvbnNcIj5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5DbGF1ZGUgU29ubmV0IDQ8L3N0cm9uZz4gLSBMYXRlc3QgZ2VuZXJhdGlvbiB3aXRoIGV4Y2VsbGVudCBpbnN0cnVjdGlvbiBmb2xsb3dpbmcgZm9yIGNvbGxhYm9yYXRpdmUgZWRpdGluZzwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+R1BULTQuMSBNaW5pPC9zdHJvbmc+IC0gQ3VycmVudC1nZW5lcmF0aW9uIG1vZGVsIHRoYXQgb3V0cGVyZm9ybXMgR1BULTRvIHdoaWxlIHJlbWFpbmluZyBjb3N0LWVmZmVjdGl2ZTwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+R2VtaW5pIDIuNSBGbGFzaDwvc3Ryb25nPiAtIEJlc3QgcHJpY2UvcGVyZm9ybWFuY2Ugd2l0aCBcInRoaW5raW5nXCIgY2FwYWJpbGl0aWVzIGFuZCBzdHJvbmcgY29kaW5nIHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHQ8cCBjbGFzcz1cIm5vdmEtZ3VpZGFuY2Utbm90ZVwiPlRoZXNlIGRlZmF1bHRzIG9mZmVyIG1vZGVybiBBSSBjYXBhYmlsaXRpZXMgd2l0aG91dCBwcmVtaXVtIHByaWNpbmcuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIFNob3cgYWxsIHByb3ZpZGVycyAtIG5vIHJlc3RyaWN0aW9uc1xuXHRcdHRoaXMuY3JlYXRlT2xsYW1hU2V0dGluZ3MocHJvdmlkZXJDb250YWluZXIpO1xuXHRcdHRoaXMuY3JlYXRlQ2xhdWRlU2V0dGluZ3MocHJvdmlkZXJDb250YWluZXIpO1xuXHRcdHRoaXMuY3JlYXRlR29vZ2xlU2V0dGluZ3MocHJvdmlkZXJDb250YWluZXIpO1xuXHRcdHRoaXMuY3JlYXRlT3BlbkFJU2V0dGluZ3MocHJvdmlkZXJDb250YWluZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDbGF1ZGVTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRcblx0XHRjb25zdCBjbGF1ZGVDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdGNsYXVkZUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDbGF1ZGUgKEFudGhyb3BpYyknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY2xhdWRlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgQW50aHJvcGljIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignc2stYW50LS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHQvLyBNb2RlbCBzZXR0aW5nIHdpdGggcmVmcmVzaCBidXR0b25cblx0XHRjb25zdCBtb2RlbFNldHRpbmcgPSBuZXcgU2V0dGluZyhjbGF1ZGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ0NsYXVkZSBtb2RlbCB0byB1c2UnKTtcblxuXHRcdGxldCBtb2RlbERyb3Bkb3duOiBhbnk7XG5cdFx0XG5cdFx0bW9kZWxTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdG1vZGVsRHJvcGRvd24gPSBkcm9wZG93bjtcblx0XHRcdHRoaXMucG9wdWxhdGVDbGF1ZGVNb2RlbHMoZHJvcGRvd24pO1xuXHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUubW9kZWwgfHwgJ2NsYXVkZS1zb25uZXQtNC0yMDI1MDUxNCcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyBDbGF1ZGUgbW9kZWxzIGFyZSBoYXJkY29kZWQgLSBubyByZWZyZXNoIG5lZWRlZFxuXHR9XG5cblx0cHJpdmF0ZSBwb3B1bGF0ZUNsYXVkZU1vZGVscyhkcm9wZG93bjogYW55KSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3Rpbmcgb3B0aW9uc1xuXHRcdGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gVXNlIGNlbnRyYWxpemVkIG1vZGVsIGRlZmluaXRpb25zXG5cdFx0Y29uc3QgY3VycmVudE1vZGVscyA9IGdldEF2YWlsYWJsZU1vZGVscygnY2xhdWRlJyk7XG5cblx0XHRjdXJyZW50TW9kZWxzLmZvckVhY2gobW9kZWwgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKG1vZGVsLnZhbHVlLCBtb2RlbC5sYWJlbCk7XG5cdFx0fSk7XG5cdH1cblxuXG5cblx0cHJpdmF0ZSBjcmVhdGVPcGVuQUlTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRcblx0XHRjb25zdCBvcGVuYWlDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdG9wZW5haUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDaGF0R1BUIChPcGVuQUkpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIE9wZW5BSSBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ3NrLS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHQvLyBNb2RlbCBzZXR0aW5nIHdpdGggcmVmcmVzaCBidXR0b25cblx0XHRjb25zdCBtb2RlbFNldHRpbmcgPSBuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ09wZW5BSSBtb2RlbCB0byB1c2UnKTtcblxuXHRcdGxldCBtb2RlbERyb3Bkb3duOiBhbnk7XG5cdFx0XG5cdFx0bW9kZWxTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdG1vZGVsRHJvcGRvd24gPSBkcm9wZG93bjtcblx0XHRcdHRoaXMucG9wdWxhdGVPcGVuQUlNb2RlbHMoZHJvcGRvd24pO1xuXHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgfHwgJ2dwdC00LjEtbWluaS0yMDI1LTA0LTE0Jylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIE9wZW5BSSBtb2RlbHMgYXJlIGhhcmRjb2RlZCAtIG5vIHJlZnJlc2ggbmVlZGVkXG5cdH1cblxuXHRwcml2YXRlIHBvcHVsYXRlT3BlbkFJTW9kZWxzKGRyb3Bkb3duOiBhbnkpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG5cdFx0ZHJvcGRvd24uc2VsZWN0RWwuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBVc2UgY2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnNcblx0XHRjb25zdCBjdXJyZW50TW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzKCdvcGVuYWknKTtcblxuXHRcdGN1cnJlbnRNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR29vZ2xlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3QgZ29vZ2xlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRnb29nbGVDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnR29vZ2xlIChHZW1pbmkpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGdvb2dsZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEdvb2dsZSBBSSBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0FJLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIE1vZGVsIHNldHRpbmcgd2l0aCByZWZyZXNoIGJ1dHRvblxuXHRcdGNvbnN0IG1vZGVsU2V0dGluZyA9IG5ldyBTZXR0aW5nKGdvb2dsZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnR2VtaW5pIG1vZGVsIHRvIHVzZScpO1xuXG5cdFx0bGV0IG1vZGVsRHJvcGRvd246IGFueTtcblx0XHRcblx0XHRtb2RlbFNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0bW9kZWxEcm9wZG93biA9IGRyb3Bkb3duO1xuXHRcdFx0dGhpcy5wb3B1bGF0ZUdvb2dsZU1vZGVscyhkcm9wZG93bik7XG5cdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5tb2RlbCB8fCAnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA0LTE3Jylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIEdvb2dsZSBtb2RlbHMgYXJlIGhhcmRjb2RlZCAtIG5vIHJlZnJlc2ggbmVlZGVkXG5cdH1cblxuXHRwcml2YXRlIHBvcHVsYXRlR29vZ2xlTW9kZWxzKGRyb3Bkb3duOiBhbnkpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG5cdFx0ZHJvcGRvd24uc2VsZWN0RWwuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBVc2UgY2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnNcblx0XHRjb25zdCBjdXJyZW50TW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzKCdnb29nbGUnKTtcblxuXHRcdGN1cnJlbnRNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlT2xsYW1hU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0Y29uc3Qgb2xsYW1hQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRvbGxhbWFDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnT2xsYW1hIChMb2NhbCknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcob2xsYW1hQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Jhc2UgVVJMJylcblx0XHRcdC5zZXREZXNjKCdPbGxhbWEgc2VydmVyIFVSTCcpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdodHRwOi8vbG9jYWxob3N0OjExNDM0Jylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsIHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcob2xsYW1hQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdPbGxhbWEgbW9kZWwgdG8gdXNlJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2xsYW1hMicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEubW9kZWwgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQbGF0Zm9ybVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbGxhcHNpYmxlIGhlYWRlclxuXHRcdGNvbnN0IGhlYWRlckVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6IDhweCAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDE2cHg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBhcnJvd0VsID0gaGVhZGVyRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29sbGFwc2libGUtYXJyb3cnIH0pO1xuXHRcdGFycm93RWwuaW5uZXJIVE1MID0gJ1x1MjVCNic7XG5cdFx0YXJyb3dFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdFx0Zm9udC1zaXplOiAxMnB4O1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1BsYXRmb3JtIFNldHRpbmdzJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmbGV4OiAxOyc7XG5cblx0XHRjb25zdCBwbGF0Zm9ybUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcGxhdGZvcm0tc2VjdGlvbicgfSk7XG5cdFx0cGxhdGZvcm1Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBub25lOyc7IC8vIFN0YXJ0IGNvbGxhcHNlZFxuXHRcdFxuXHRcdC8vIFRvZ2dsZSBmdW5jdGlvbmFsaXR5XG5cdFx0aGVhZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRjb25zdCBpc1Zpc2libGUgPSBwbGF0Zm9ybUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG5cdFx0XHRwbGF0Zm9ybUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaXNWaXNpYmxlID8gJ25vbmUnIDogJ2Jsb2NrJztcblx0XHRcdGFycm93RWwuc3R5bGUudHJhbnNmb3JtID0gaXNWaXNpYmxlID8gJ3JvdGF0ZSgwZGVnKScgOiAncm90YXRlKDkwZGVnKSc7XG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly8gSW5mbyBhYm91dCBwbGF0Zm9ybSBzZXR0aW5nc1xuXHRcdGNvbnN0IGluZm9FbCA9IHBsYXRmb3JtQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcGxhdGZvcm0taW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDQ+XHVEODNEXHVEREE1XHVGRTBGIFBsYXRmb3JtIENvbmZpZ3VyYXRpb248L2g0PlxuXHRcdFx0XHQ8cD5Db25maWd1cmUgd2hpY2ggQUkgcHJvdmlkZXIgdG8gdXNlIGFzIHlvdXIgcHJpbWFyeSBwcm92aWRlciBvbiBkaWZmZXJlbnQgcGxhdGZvcm1zLiBcblx0XHRcdFx0Tm92YSB3b3JrcyBzZWFtbGVzc2x5IGFjcm9zcyBkZXNrdG9wIGFuZCBtb2JpbGUgd2l0aCBhbGwgcHJvdmlkZXJzLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cdFx0XG5cdFx0cGxhdGZvcm1Db250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnRGVza3RvcCcgfSk7XG5cdFx0Y29uc3QgZGVza3RvcERyb3Bkb3duID0gbmV3IFNldHRpbmcocGxhdGZvcm1Db250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnUHJpbWFyeSBQcm92aWRlcicpXG5cdFx0XHQuc2V0RGVzYygnUHJpbWFyeSBBSSBwcm92aWRlciBmb3IgZGVza3RvcCcpXG5cdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5nZXRBbGxvd2VkUHJvdmlkZXJzRm9yUGxhdGZvcm0oJ2Rlc2t0b3AnKTtcblx0XHRcdFx0XG5cdFx0XHRcdGFsbG93ZWRQcm92aWRlcnMuZm9yRWFjaChwcm92aWRlciA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgbGFiZWwgPSB0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXIpO1xuXHRcdFx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihwcm92aWRlciwgbGFiZWwpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AucHJpbWFyeVByb3ZpZGVyKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnByaW1hcnlQcm92aWRlciA9IHZhbHVlIGFzIFByb3ZpZGVyVHlwZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0cGxhdGZvcm1Db250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnTW9iaWxlJyB9KTtcblx0XHRjb25zdCBtb2JpbGVTZXR0aW5nID0gbmV3IFNldHRpbmcocGxhdGZvcm1Db250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnUHJpbWFyeSBQcm92aWRlcicpXG5cdFx0XHQuc2V0RGVzYygnUHJpbWFyeSBBSSBwcm92aWRlciBmb3IgbW9iaWxlIGRldmljZXMnKTtcblx0XHRcdFxuXHRcdG1vYmlsZVNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cblx0XHRcdC5hZGRPcHRpb24oJ25vbmUnLCAnTm9uZSAoRGlzYWJsZWQpJylcblx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZScsICdDbGF1ZGUnKVxuXHRcdFx0LmFkZE9wdGlvbignb3BlbmFpJywgJ09wZW5BSScpXG5cdFx0XHQuYWRkT3B0aW9uKCdnb29nbGUnLCAnR29vZ2xlJylcblx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5wcmltYXJ5UHJvdmlkZXIpXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUucHJpbWFyeVByb3ZpZGVyID0gdmFsdWUgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGdldEFsbG93ZWRQcm92aWRlcnNGb3JQbGF0Zm9ybShwbGF0Zm9ybTogJ2Rlc2t0b3AnIHwgJ21vYmlsZScpOiBQcm92aWRlclR5cGVbXSB7XG5cdFx0Ly8gQWxsIHByb3ZpZGVycyBhcmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyBpbiB0aGUgU3VwZXJub3ZhIG1vZGVsXG5cdFx0cmV0dXJuIHBsYXRmb3JtID09PSAnZGVza3RvcCcgXG5cdFx0XHQ/IFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ11cblx0XHRcdDogWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZSddO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyOiBQcm92aWRlclR5cGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8UHJvdmlkZXJUeXBlLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdDbGF1ZGUgKEFudGhyb3BpYyknLFxuXHRcdFx0J29wZW5haSc6ICdDaGF0R1BUIChPcGVuQUkpJyxcblx0XHRcdCdnb29nbGUnOiAnR29vZ2xlIChHZW1pbmkpJywgXG5cdFx0XHQnb2xsYW1hJzogJ09sbGFtYSAoTG9jYWwpJyxcblx0XHRcdCdub25lJzogJ05vbmUgKERpc2FibGVkKSdcblx0XHR9O1xuXHRcdHJldHVybiBuYW1lc1twcm92aWRlcl0gfHwgcHJvdmlkZXI7XG5cdH1cblxuXHRhc3luYyBzZXRDdXJyZW50UHJvdmlkZXIocHJvdmlkZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVySWQgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbGxhcHNpYmxlIGhlYWRlclxuXHRcdGNvbnN0IGhlYWRlckVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6IDhweCAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDE2cHg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBhcnJvd0VsID0gaGVhZGVyRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29sbGFwc2libGUtYXJyb3cnIH0pO1xuXHRcdGFycm93RWwuaW5uZXJIVE1MID0gJ1x1MjVCNic7XG5cdFx0YXJyb3dFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdFx0Zm9udC1zaXplOiAxMnB4O1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0N1c3RvbSBDb21tYW5kcycgfSk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZmxleDogMTsnO1xuXG5cdFx0Y29uc3QgY29tbWFuZENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1zZWN0aW9uJyB9KTtcblx0XHRjb21tYW5kQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogbm9uZTsnOyAvLyBTdGFydCBjb2xsYXBzZWRcblx0XHRcblx0XHQvLyBUb2dnbGUgZnVuY3Rpb25hbGl0eVxuXHRcdGhlYWRlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgaXNWaXNpYmxlID0gY29tbWFuZENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG5cdFx0XHRjb21tYW5kQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpc1Zpc2libGUgPyAnbm9uZScgOiAnYmxvY2snO1xuXHRcdFx0YXJyb3dFbC5zdHlsZS50cmFuc2Zvcm0gPSBpc1Zpc2libGUgPyAncm90YXRlKDBkZWcpJyA6ICdyb3RhdGUoOTBkZWcpJztcblx0XHR9KTtcblxuXHRcdC8vIEZlYXR1cmUgYXZhaWxhYmlsaXR5IGNoZWNrXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBub3RpY2VFbCA9IGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1mZWF0dXJlLW5vdGljZScgfSk7XG5cdFx0XHRub3RpY2VFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAxNnB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgYm9yZGVyLXJhZGl1czogOHB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XCI+XG5cdFx0XHRcdFx0PGg0IHN0eWxlPVwibWFyZ2luOiAwIDAgOHB4IDA7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XCI+U3VwZXJub3ZhIFN1cHBvcnRlciBGZWF0dXJlPC9oND5cblx0XHRcdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtO1wiPlxuXHRcdFx0XHRcdFx0Q3VzdG9tIGNvbW1hbmRzIGFyZSBjdXJyZW50bHkgYXZhaWxhYmxlIHRvIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBcblx0XHRcdFx0XHRcdFRoZXkgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uIDxzdHJvbmc+T2N0b2JlciAxLCAyMDI1PC9zdHJvbmc+LlxuXHRcdFx0XHRcdDwvcD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERlc2NyaXB0aW9uXG5cdFx0Y29uc3QgZGVzY0VsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzY3JpcHRpb24nIH0pO1xuXHRcdGRlc2NFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8cCBzdHlsZT1cImNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLWJvdHRvbTogMTZweDtcIj5cblx0XHRcdFx0Q3JlYXRlIGN1c3RvbSBjb21tYW5kIHNob3J0Y3V0cyB0aGF0IGluc2VydCBwcmVkZWZpbmVkIHRleHQgdGVtcGxhdGVzIHdoZW4gdHJpZ2dlcmVkIHdpdGggPGNvZGU+OnRyaWdnZXI8L2NvZGU+LlxuXHRcdFx0PC9wPlxuXHRcdGA7XG5cblx0XHQvLyBTaG93IENvbW1hbmQgQnV0dG9uIHNldHRpbmcgKFN1cGVybm92YS1vbmx5LCBNb2JpbGUtb25seSlcblx0XHRuZXcgU2V0dGluZyhjb21tYW5kQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1Nob3cgQ29tbWFuZCBCdXR0b24gaW4gQ2hhdCAoTW9iaWxlKScpXG5cdFx0XHQuc2V0RGVzYygnU2hvdyB0aGUgQ29tbWFuZHMgYnV0dG9uIGJlc2lkZSB0aGUgU2VuZCBidXR0b24gZm9yIG1vYmlsZSBxdWljayBhY2Nlc3MgdG8gTm92YSBjb21tYW5kcyBhbmQgc2VsZWN0aW9uIGFjdGlvbnMnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbilcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gRmluZCBhbmQgcmVmcmVzaCBzaWRlYmFyIHZpZXdcblx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaENvbW1hbmRCdXR0b24oKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIEFkZCBuZXcgY29tbWFuZCBidXR0b24gYXQgdGhlIHRvcFxuXHRcdGNvbnN0IGJ1dHRvbkVsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWFkZC1jb21tYW5kJyB9KTtcblx0XHRidXR0b25FbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbi1ib3R0b206IDE2cHg7Jztcblx0XHRcblx0XHRuZXcgU2V0dGluZyhidXR0b25FbClcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IFxuXHRcdFx0XHRidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnKyBBZGQgQ3VzdG9tIENvbW1hbmQnKVxuXHRcdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHRoaXMuc2hvd0FkZENvbW1hbmREaWFsb2coKSlcblx0XHRcdCk7XG5cblx0XHQvLyBDb21tYW5kcyBsaXN0XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29tbWFuZENvbnRhaW5lcik7XG5cdH1cblxuXHRwcml2YXRlIHJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdChjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3RpbmcgY29tbWFuZHMgbGlzdFxuXHRcdGNvbnN0IGV4aXN0aW5nTGlzdCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kcy1saXN0Jyk7XG5cdFx0aWYgKGV4aXN0aW5nTGlzdCkgZXhpc3RpbmdMaXN0LnJlbW92ZSgpO1xuXG5cdFx0Y29uc3QgY29tbWFuZHNMaXN0ID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZHMtbGlzdCcgfSk7XG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyB8fCBbXTtcblxuXHRcdGlmIChjb21tYW5kcy5sZW5ndGggPT09IDApIHtcblx0XHRcdGNvbnN0IGVtcHR5RWwgPSBjb21tYW5kc0xpc3QuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kcy1lbXB0eScgfSk7XG5cdFx0XHRlbXB0eUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjRweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1wiPlxuXHRcdFx0XHRcdDxwPk5vIGN1c3RvbSBjb21tYW5kcyB5ZXQuPC9wPlxuXHRcdFx0XHRcdDxwIHN0eWxlPVwiZm9udC1zaXplOiAwLjllbTtcIj5DcmVhdGUgeW91ciBmaXJzdCBjb21tYW5kIHRvIGdldCBzdGFydGVkITwvcD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbW1hbmRzLmZvckVhY2goKGNvbW1hbmQsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBjb21tYW5kRWwgPSBjb21tYW5kc0xpc3QuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0nIH0pO1xuXHRcdFx0Y29tbWFuZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0XHRwYWRkaW5nOiAxNnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiAxMnB4O1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gQ29tbWFuZCBoZWFkZXJcblx0XHRcdGNvbnN0IGhlYWRlckVsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1oZWFkZXInIH0pO1xuXHRcdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OyBtYXJnaW4tYm90dG9tOiA4cHg7JztcblxuXHRcdFx0Y29uc3QgaW5mb0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWluZm8nIH0pO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBuYW1lRWwgPSBpbmZvRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW5hbWUnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDYwMDsgbWFyZ2luLWJvdHRvbTogNHB4Oyc7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGluZm9FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtdHJpZ2dlcicgfSk7XG5cdFx0XHR0cmlnZ2VyRWwuaW5uZXJIVE1MID0gYDxjb2RlPjoke2NvbW1hbmQudHJpZ2dlcn08L2NvZGU+YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7IGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBmb250LXNpemU6IDAuOWVtOyc7XG5cblx0XHRcdC8vIEFjdGlvbnNcblx0XHRcdGNvbnN0IGFjdGlvbnNFbCA9IGhlYWRlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1hY3Rpb25zJyB9KTtcblx0XHRcdGFjdGlvbnNFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGdhcDogOHB4Oyc7XG5cblx0XHRcdGNvbnN0IGVkaXRCdG4gPSBhY3Rpb25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0VkaXQnIH0pO1xuXHRcdFx0ZWRpdEJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGZvbnQtc2l6ZTogMC44ZW07IGJvcmRlci1yYWRpdXM6IDRweDsnO1xuXHRcdFx0ZWRpdEJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5zaG93RWRpdENvbW1hbmREaWFsb2coaW5kZXgpO1xuXG5cdFx0XHRjb25zdCBkZWxldGVCdG4gPSBhY3Rpb25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0RlbGV0ZScgfSk7XG5cdFx0XHRkZWxldGVCdG4uc3R5bGUuY3NzVGV4dCA9ICdwYWRkaW5nOiA0cHggOHB4OyBmb250LXNpemU6IDAuOGVtOyBib3JkZXItcmFkaXVzOiA0cHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpOyBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpOyc7XG5cdFx0XHRkZWxldGVCdG4ub25jbGljayA9ICgpID0+IHRoaXMuZGVsZXRlQ29tbWFuZChpbmRleCk7XG5cblx0XHRcdC8vIERlc2NyaXB0aW9uIGFuZCB0ZW1wbGF0ZSBwcmV2aWV3XG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2MnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07IG1hcmdpbi1ib3R0b206IDhweDsnO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB0ZW1wbGF0ZUVsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC10ZW1wbGF0ZScgfSk7XG5cdFx0XHR0ZW1wbGF0ZUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cImJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBwYWRkaW5nOiA4cHg7IGJvcmRlci1yYWRpdXM6IDRweDsgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTsgZm9udC1zaXplOiAwLjhlbTsgd2hpdGUtc3BhY2U6IHByZS13cmFwOyBtYXgtaGVpZ2h0OiA2MHB4OyBvdmVyZmxvdy15OiBhdXRvO1wiPlxuXHRcdFx0XHRcdCR7Y29tbWFuZC50ZW1wbGF0ZX1cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93QWRkQ29tbWFuZERpYWxvZygpIHtcblx0XHR0aGlzLnNob3dDb21tYW5kRGlhbG9nKCk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dFZGl0Q29tbWFuZERpYWxvZyhpbmRleDogbnVtYmVyKSB7XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzPy5baW5kZXhdO1xuXHRcdGlmIChjb21tYW5kKSB7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kRGlhbG9nKGNvbW1hbmQsIGluZGV4KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kRGlhbG9nKGV4aXN0aW5nQ29tbWFuZD86IEN1c3RvbUNvbW1hbmQsIGVkaXRJbmRleD86IG51bWJlcikge1xuXHRcdC8vIEZvciBub3csIHVzZSBhIHNpbXBsZSBwcm9tcHQtYmFzZWQgYXBwcm9hY2hcblx0XHQvLyBUT0RPOiBJbXBsZW1lbnQgcHJvcGVyIG1vZGFsIHdoZW4gTW9kYWwgY2xhc3MgaXMgcHJvcGVybHkgYXZhaWxhYmxlXG5cdFx0Y29uc3QgbmFtZSA9IHByb21wdCgnQ29tbWFuZCBuYW1lOicsIGV4aXN0aW5nQ29tbWFuZD8ubmFtZSB8fCAnJyk7XG5cdFx0aWYgKCFuYW1lKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgdHJpZ2dlciA9IHByb21wdCgnQ29tbWFuZCB0cmlnZ2VyICh3aXRob3V0IDopOicsIGV4aXN0aW5nQ29tbWFuZD8udHJpZ2dlciB8fCAnJyk7XG5cdFx0aWYgKCF0cmlnZ2VyKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgZGVzY3JpcHRpb24gPSBwcm9tcHQoJ0Rlc2NyaXB0aW9uIChvcHRpb25hbCk6JywgZXhpc3RpbmdDb21tYW5kPy5kZXNjcmlwdGlvbiB8fCAnJyk7XG5cdFx0XG5cdFx0Y29uc3QgdGVtcGxhdGUgPSBwcm9tcHQoJ1RlbXBsYXRlIGNvbnRlbnQ6JywgZXhpc3RpbmdDb21tYW5kPy50ZW1wbGF0ZSB8fCAnJyk7XG5cdFx0aWYgKCF0ZW1wbGF0ZSkgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IHJlc3VsdDogQ3VzdG9tQ29tbWFuZCA9IHtcblx0XHRcdGlkOiBleGlzdGluZ0NvbW1hbmQ/LmlkIHx8ICgnY21kXycgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSkpLFxuXHRcdFx0bmFtZSxcblx0XHRcdHRyaWdnZXI6IHRyaWdnZXIudG9Mb3dlckNhc2UoKSxcblx0XHRcdHRlbXBsYXRlLFxuXHRcdFx0ZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uIHx8IHVuZGVmaW5lZFxuXHRcdH07XG5cdFx0XG5cdFx0aWYgKGVkaXRJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHQvLyBFZGl0IGV4aXN0aW5nIGNvbW1hbmRcblx0XHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzID0gW107XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kc1tlZGl0SW5kZXhdID0gcmVzdWx0O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBBZGQgbmV3IGNvbW1hbmRcblx0XHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzID0gW107XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcy5wdXNoKHJlc3VsdCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZC1zZWN0aW9uJykgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cblx0cHJpdmF0ZSBkZWxldGVDb21tYW5kKGluZGV4OiBudW1iZXIpIHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzW2luZGV4XTtcblx0XHRjb25zdCBjb25maXJtZWQgPSBjb25maXJtKGBEZWxldGUgY29tbWFuZCBcIiR7Y29tbWFuZC5uYW1lfVwiICgke2NvbW1hbmQudHJpZ2dlcn0pP2ApO1xuXHRcdFxuXHRcdGlmIChjb25maXJtZWQpIHtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZC1zZWN0aW9uJykgYXMgSFRNTEVsZW1lbnQpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBJdGVtVmlldywgV29ya3NwYWNlTGVhZiwgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUsIE5vdGljZSwgTWFya2Rvd25WaWV3LCBQbGF0Zm9ybSwgc2V0SWNvbiwgRWRpdG9yUG9zaXRpb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS90eXBlcyc7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3dpa2lsaW5rLXN1Z2dlc3QnO1xuaW1wb3J0IHsgTXVsdGlEb2NDb250ZXh0SGFuZGxlciwgTXVsdGlEb2NDb250ZXh0IH0gZnJvbSAnLi4vY29yZS9tdWx0aS1kb2MtY29udGV4dCc7XG5pbXBvcnQgeyBnZXRBdmFpbGFibGVNb2RlbHMgfSBmcm9tICcuLi9haS9tb2RlbHMnO1xuaW1wb3J0IHsgSW5wdXRIYW5kbGVyIH0gZnJvbSAnLi9pbnB1dC1oYW5kbGVyJztcbmltcG9ydCB7IENvbW1hbmRTeXN0ZW0gfSBmcm9tICcuL2NvbW1hbmQtc3lzdGVtJztcbmltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9jb250ZXh0LW1hbmFnZXInO1xuaW1wb3J0IHsgQ2hhdFJlbmRlcmVyIH0gZnJvbSAnLi9jaGF0LXJlbmRlcmVyJztcbmltcG9ydCB7IFN0cmVhbWluZ01hbmFnZXIgfSBmcm9tICcuL3N0cmVhbWluZy1tYW5hZ2VyJztcbmltcG9ydCB7IFNlbGVjdGlvbkNvbnRleHRNZW51LCBTRUxFQ1RJT05fQUNUSU9OUyB9IGZyb20gJy4vc2VsZWN0aW9uLWNvbnRleHQtbWVudSc7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSID0gJ25vdmEtc2lkZWJhcic7XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2lkZWJhclZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaW5wdXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBtdWx0aURvY0hhbmRsZXIhOiBNdWx0aURvY0NvbnRleHRIYW5kbGVyO1xuXHRwcml2YXRlIGN1cnJlbnRDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XG5cdC8vIE5ldyBhcmNoaXRlY3R1cmUgY29tcG9uZW50c1xuXHRwcml2YXRlIGlucHV0SGFuZGxlciE6IElucHV0SGFuZGxlcjtcblx0cHJpdmF0ZSBjb21tYW5kU3lzdGVtITogQ29tbWFuZFN5c3RlbTtcblx0cHJpdmF0ZSBjb250ZXh0TWFuYWdlciE6IENvbnRleHRNYW5hZ2VyO1xuXHRwcml2YXRlIGNoYXRSZW5kZXJlciE6IENoYXRSZW5kZXJlcjtcblx0cHJpdmF0ZSBzdHJlYW1pbmdNYW5hZ2VyITogU3RyZWFtaW5nTWFuYWdlcjtcblx0cHJpdmF0ZSBzZWxlY3Rpb25Db250ZXh0TWVudSE6IFNlbGVjdGlvbkNvbnRleHRNZW51O1xuXHRcblx0Ly8gQ3Vyc29yLW9ubHkgYXJjaGl0ZWN0dXJlIC0gZGVsZWdhdGUgdG8gbmV3IGNvbXBvbmVudHNcblx0cHJpdmF0ZSBnZXQgdGV4dEFyZWEoKSB7IHJldHVybiB0aGlzLmlucHV0SGFuZGxlcj8uZ2V0VGV4dEFyZWEoKTsgfVxuXHRwcml2YXRlIGdldCB3aWtpbGlua0F1dG9jb21wbGV0ZSgpIHsgcmV0dXJuIHRoaXMuaW5wdXRIYW5kbGVyID8geyBkZXN0cm95OiAoKSA9PiB7fSB9IDogbnVsbDsgfVxuXHRwcml2YXRlIGdldCBhdXRvR3Jvd1RleHRhcmVhKCkgeyByZXR1cm4gKCkgPT4ge307IH1cblx0XG5cdC8vIENvbW1hbmQgc3lzdGVtIGRlbGVnYXRpb25cblx0cHJpdmF0ZSBfY29tbWFuZFBpY2tlckl0ZW1zOiBhbnlbXSA9IFtdO1xuXHRwcml2YXRlIGdldCBjb21tYW5kUGlja2VySXRlbXMoKSB7IHJldHVybiB0aGlzLl9jb21tYW5kUGlja2VySXRlbXM7IH1cblx0cHJpdmF0ZSBzZXQgY29tbWFuZFBpY2tlckl0ZW1zKHZhbHVlOiBhbnlbXSkgeyB0aGlzLl9jb21tYW5kUGlja2VySXRlbXMgPSB2YWx1ZTsgfVxuXHRwcml2YXRlIF9zZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyID0gLTE7XG5cdHByaXZhdGUgZ2V0IHNlbGVjdGVkQ29tbWFuZEluZGV4KCkgeyByZXR1cm4gdGhpcy5fc2VsZWN0ZWRDb21tYW5kSW5kZXg7IH1cblx0cHJpdmF0ZSBzZXQgc2VsZWN0ZWRDb21tYW5kSW5kZXgodmFsdWU6IG51bWJlcikgeyB0aGlzLl9zZWxlY3RlZENvbW1hbmRJbmRleCA9IHZhbHVlOyB9XG5cdHByaXZhdGUgX2lzQ29tbWFuZE1lbnVWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZ2V0IGlzQ29tbWFuZE1lbnVWaXNpYmxlKCkgeyByZXR1cm4gdGhpcy5faXNDb21tYW5kTWVudVZpc2libGU7IH1cblx0cHJpdmF0ZSBzZXQgaXNDb21tYW5kTWVudVZpc2libGUodmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5faXNDb21tYW5kTWVudVZpc2libGUgPSB2YWx1ZTsgfVxuXHRcblx0Ly8gQ29udGV4dCBzeXN0ZW0gZGVsZWdhdGlvblxuXHRwcml2YXRlIGdldCBjb250ZXh0UHJldmlldygpIHsgcmV0dXJuIHRoaXMuY29udGV4dE1hbmFnZXI/LmNvbnRleHRQcmV2aWV3OyB9XG5cdHByaXZhdGUgX2NvbnRleHRJbmRpY2F0b3I6IGFueTtcblx0cHJpdmF0ZSBnZXQgY29udGV4dEluZGljYXRvcigpIHsgcmV0dXJuIHRoaXMuX2NvbnRleHRJbmRpY2F0b3IgfHwgdGhpcy5jb250ZXh0TWFuYWdlcj8uY29udGV4dEluZGljYXRvcjsgfVxuXHRwcml2YXRlIHNldCBjb250ZXh0SW5kaWNhdG9yKHZhbHVlOiBhbnkpIHsgdGhpcy5fY29udGV4dEluZGljYXRvciA9IHZhbHVlOyB9XG5cdFxuXHQvLyBDb21wb25lbnQgcmVmZXJlbmNlc1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjb21tYW5kTWVudSE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdFxuXHQvLyBDdXJzb3IgcG9zaXRpb24gdHJhY2tpbmcgLSBmaWxlLXNjb3BlZCBsaWtlIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG5cdHByaXZhdGUgY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbjogRWRpdG9yUG9zaXRpb24gfCBudWxsID0gbnVsbDtcblx0XG5cdFxuXHQvLyBQZXJmb3JtYW5jZSBvcHRpbWl6YXRpb24gLSBkZWJvdW5jaW5nIGFuZCB0aW1pbmcgY29uc3RhbnRzXG5cdHByaXZhdGUgY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQ6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENPTlRFWFRfUFJFVklFV19ERUJPVU5DRV9NUyA9IDMwMDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgU0NST0xMX0RFTEFZX01TID0gNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEZPQ1VTX0RFTEFZX01TID0gMTUwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBIT1ZFUl9USU1FT1VUX01TID0gMTUwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBOT1RJQ0VfRFVSQVRJT05fTVMgPSA1MDAwO1xuXHRcblx0Ly8gRXZlbnQgbGlzdGVuZXIgY2xlYW51cCB0cmFja2luZ1xuXHRwcml2YXRlIGRvY3VtZW50RXZlbnRMaXN0ZW5lcnM6IEFycmF5PHtlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcn0+ID0gW107XG5cdHByaXZhdGUgdGltZW91dHM6IE5vZGVKUy5UaW1lb3V0W10gPSBbXTtcblxuXHRjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IE5vdmFQbHVnaW4pIHtcblx0XHRzdXBlcihsZWFmKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLm11bHRpRG9jSGFuZGxlciA9IG5ldyBNdWx0aURvY0NvbnRleHRIYW5kbGVyKHRoaXMuYXBwKTtcblx0fVxuXG5cdGdldFZpZXdUeXBlKCkge1xuXHRcdHJldHVybiBWSUVXX1RZUEVfTk9WQV9TSURFQkFSO1xuXHR9XG5cblx0Z2V0RGlzcGxheVRleHQoKSB7XG5cdFx0cmV0dXJuICdOb3ZhIEFJJztcblx0fVxuXG5cdGdldEljb24oKSB7XG5cdFx0cmV0dXJuICdub3ZhLXN0YXInO1xuXHR9XG5cblx0YXN5bmMgb25PcGVuKCkge1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG5cdFx0Y29udGFpbmVyLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyLmFkZENsYXNzKCdub3ZhLXNpZGViYXItY29udGFpbmVyJyk7XG5cdFx0XG5cdFx0Ly8gQWRkIHBsYXRmb3JtLXNwZWNpZmljIGNsYXNzIGZvciBzdHlsaW5nXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XG5cdFx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ2lzLW1vYmlsZScpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ2lzLWRlc2t0b3AnKTtcblx0XHR9XG5cblx0XHQvLyBNb2JpbGUgYWNjZXNzIGlzIG5vdyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHdyYXBwZXIgd2l0aCBwcm9wZXIgZmxleCBsYXlvdXRcblx0XHRjb25zdCB3cmFwcGVyRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13cmFwcGVyJyB9KTtcblx0XHR3cmFwcGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0aGVpZ2h0OiAxMDAlO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdHBhZGRpbmctYm90dG9tOiAke1BsYXRmb3JtLmlzRGVza3RvcEFwcCA/ICd2YXIoLS1zaXplLTQtNiknIDogJ3ZhcigtLXNpemUtNC01KSd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyIHdpdGggcHJvdmlkZXIgaW5mb1xuXHRcdGNvbnN0IGhlYWRlckVsID0gd3JhcHBlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBMZWZ0IHNpZGU6IFRpdGxlIHdpdGggTm92YSBpY29uXG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckVsLmNyZWF0ZUVsKCdoNCcpO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IHZhcigtLXNpemUtMi0yKTsnO1xuXHRcdHRpdGxlRWwuaW5uZXJIVE1MID0gYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IHZhcigtLWljb24tc2l6ZSk7IGhlaWdodDogdmFyKC0taWNvbi1zaXplKTtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5Ob3ZhYDtcblx0XHRcblx0XHQvLyBSaWdodCBzaWRlOiBQcm92aWRlciBzdGF0dXMgYW5kIENsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IHJpZ2h0Q29udGFpbmVyID0gaGVhZGVyRWwuY3JlYXRlRGl2KCk7XG5cdFx0cmlnaHRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IHZhcigtLXNpemUtMi0zKTsnO1xuXHRcdFxuXHRcdC8vIFByaXZhY3kgaW5kaWNhdG9yIGljb25cblx0XHRjb25zdCBwcml2YWN5SW5kaWNhdG9yID0gcmlnaHRDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtcHJpdmFjeS1pbmRpY2F0b3InIH0pO1xuXHRcdHByaXZhY3lJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0cGFkZGluZzogNHB4O1xuXHRcdFx0Y29sb3I6IHZhcigtLWljb24tY29sb3IpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IHZhcigtLWZvbnQtd2VpZ2h0LW1lZGl1bSk7XG5cdFx0YDtcblx0XHR0aGlzLnVwZGF0ZVByaXZhY3lJbmRpY2F0b3IocHJpdmFjeUluZGljYXRvcik7XG5cdFx0XG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciB1cGRhdGVzXG5cdFx0KHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yID0gcHJpdmFjeUluZGljYXRvcjtcblx0XHRcblx0XHQvLyBBbGwgdXNlcnMgY2FuIHN3aXRjaCBwcm92aWRlcnMgZnJlZWx5XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlckRyb3Bkb3duKHJpZ2h0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDbGVhciBDaGF0IGJ1dHRvbiBpbiByaWdodCBjb250YWluZXJcblx0XHRjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQocmlnaHRDb250YWluZXIpO1xuXHRcdGNsZWFyQnV0dG9uLnNldEljb24oJ2VyYXNlcicpXG5cdFx0XHQuc2V0VG9vbHRpcCgnQ2xlYXIgY29udmVyc2F0aW9uIGhpc3RvcnknKVxuXHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5jbGVhckNoYXQoKSk7XG5cblx0XHR0aGlzLmNyZWF0ZUNoYXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHR0aGlzLmNyZWF0ZUlucHV0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0XG5cdFx0Ly8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXIgZm9yIGFjdGl2ZSBmaWxlIGNoYW5nZXNcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcblx0XHRcdFx0dGhpcy5sb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGN1cnNvciBwb3NpdGlvbiB0cmFja2luZyBmb3IgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1jaGFuZ2UnLCAoZWRpdG9yKSA9PiB7XG5cdFx0XHRcdHRoaXMudHJhY2tDdXJzb3JQb3NpdGlvbihlZGl0b3IpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIExvYWQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcblx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gSW5pdGlhbCBzdGF0dXMgcmVmcmVzaCB0byBlbnN1cmUgYWxsIGluZGljYXRvcnMgYXJlIHVwIHRvIGRhdGVcblx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzKCksIDEwMCk7XG5cdFx0XG5cdFx0Ly8gTm90ZTogQXV0by1mb2N1cyByZW1vdmVkIHRvIHByZXZlbnQgc3RlYWxpbmcgY3Vyc29yIGZyb20gZWRpdG9yXG5cdH1cblxuXHQvKipcblx0ICogVHJhY2sgY3Vyc29yIHBvc2l0aW9uIGNoYW5nZXMgaW4gdGhlIGFjdGl2ZSBlZGl0b3IgKGZpbGUtc2NvcGVkKVxuXHQgKi9cblx0cHJpdmF0ZSB0cmFja0N1cnNvclBvc2l0aW9uKGVkaXRvcjogYW55KSB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0aWYgKCFhY3RpdmVGaWxlIHx8ICFlZGl0b3IpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gT25seSB0cmFjayBjdXJzb3IgcG9zaXRpb24gaWYgdGhpcyBpcyB0aGUgY3VycmVudCBmaWxlIHdlJ3JlIHdvcmtpbmcgd2l0aFxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlICYmIGFjdGl2ZUZpbGUucGF0aCA9PT0gdGhpcy5jdXJyZW50RmlsZS5wYXRoKSB7XG5cdFx0XHRjb25zdCBjdXJzb3JQb3MgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRpZiAoY3Vyc29yUG9zKSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbiA9IGN1cnNvclBvcztcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiBmb3IgY3VycmVudCBmaWxlIChmaWxlLXNjb3BlZClcblx0ICovXG5cdHByaXZhdGUgcmVzdG9yZUN1cnNvclBvc2l0aW9uKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlQ3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdC8vIFJlc3RvcmUgd2l0aG91dCBzdGVhbGluZyBmb2N1c1xuXHRcdFx0Y29uc3QgZWRpdG9yID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG5cdFx0XHRpZiAoZWRpdG9yKSB7XG5cdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IodGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBvbkNsb3NlKCkge1xuXHRcdC8vIENsZWFuIHVwIHByb3ZpZGVyIGRyb3Bkb3duIGV2ZW50IGxpc3RlbmVyXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LmNsZWFudXApIHtcblx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24uY2xlYW51cCgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5kZXN0cm95KCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFyIGRlYm91bmNlIHRpbWVvdXRcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpO1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCA9IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFuIHVwIHRyYWNrZWQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0dGhpcy5jbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcblx0XHQvLyBDbGVhciBhbGwgdGltZW91dHNcblx0XHR0aGlzLmNsZWFyVGltZW91dHMoKTtcblx0XHRcblx0XHQvLyBDbGVhbiB1cCBET00gZWxlbWVudHNcblx0XHR0aGlzLmNsZWFudXBET01FbGVtZW50cygpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIGV2ZW50IGxpc3RlbmVyIHdpdGggYXV0b21hdGljIGNsZWFudXAgdHJhY2tpbmdcblx0ICovXG5cdHByaXZhdGUgYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGQgdGltZW91dCB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRUaW1lb3V0KGNhbGxiYWNrOiAoKSA9PiB2b2lkLCBkZWxheTogbnVtYmVyKTogTm9kZUpTLlRpbWVvdXQge1xuXHRcdGNvbnN0IGlkID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0dGhpcy50aW1lb3V0cyA9IHRoaXMudGltZW91dHMuZmlsdGVyKHQgPT4gdCAhPT0gaWQpO1xuXHRcdH0sIGRlbGF5KTtcblx0XHR0aGlzLnRpbWVvdXRzLnB1c2goaWQpO1xuXHRcdHJldHVybiBpZDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIGFsbCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFyIGFsbCB0cmFja2VkIHRpbWVvdXRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFyVGltZW91dHMoKTogdm9pZCB7XG5cdFx0dGhpcy50aW1lb3V0cy5mb3JFYWNoKGlkID0+IGNsZWFyVGltZW91dChpZCkpO1xuXHRcdHRoaXMudGltZW91dHMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRE9NRWxlbWVudHMoKTogdm9pZCB7XG5cdFx0Ly8gQ2xlYW51cCBpcyBub3cgaGFuZGxlZCBieSBpbmRpdmlkdWFsIGNvbXBvbmVudCBjbGVhbnVwIG1ldGhvZHNcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2hhdEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY2hhdC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdGA7XG5cblx0XHQvLyBXZWxjb21lIG1lc3NhZ2Ugd2l0aCBOb3ZhIGJyYW5kaW5nXG5cdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVJbnB1dEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jcmVhdGVJbnB1dEFyZWEoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgdGhlIGlucHV0IGFyZWEgVUkgZWxlbWVudHMgdXNpbmcgbmV3IGFyY2hpdGVjdHVyZVxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbnB1dEFyZWEoKSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3RpbmcgaW5wdXQgYXJlYSBjb250ZW50XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIEluaXRpYWxpemUgY29udGV4dCBtYW5hZ2VyLCBjaGF0IHJlbmRlcmVyLCBzdHJlYW1pbmcgbWFuYWdlciwgYW5kIHNlbGVjdGlvbiBtZW51IGZpcnN0XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlciA9IG5ldyBDb250ZXh0TWFuYWdlcih0aGlzLnBsdWdpbiwgdGhpcy5hcHAsIHRoaXMuaW5wdXRDb250YWluZXIpO1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyID0gbmV3IENoYXRSZW5kZXJlcih0aGlzLnBsdWdpbiwgdGhpcy5jaGF0Q29udGFpbmVyKTtcblx0XHR0aGlzLnN0cmVhbWluZ01hbmFnZXIgPSBuZXcgU3RyZWFtaW5nTWFuYWdlcigpO1xuXHRcdHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUgPSBuZXcgU2VsZWN0aW9uQ29udGV4dE1lbnUodGhpcy5hcHAsIHRoaXMucGx1Z2luKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgSW5wdXRIYW5kbGVyIHdoaWNoIHdpbGwgaGFuZGxlIGFsbCBpbnB1dCBVSSBjcmVhdGlvblxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyID0gbmV3IElucHV0SGFuZGxlcih0aGlzLnBsdWdpbiwgdGhpcy5pbnB1dENvbnRhaW5lciwgdGhpcy5jb250ZXh0TWFuYWdlcik7XG5cdFx0XG5cdFx0Ly8gUGFzcyBzaWRlYmFyIHZpZXcgcmVmZXJlbmNlIGZvciBjb250ZXh0IG9wZXJhdGlvbnNcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRTaWRlYmFyVmlldyh0aGlzKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgdGhlIGlucHV0IGludGVyZmFjZSB1c2luZyBuZXcgSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuY3JlYXRlSW5wdXRJbnRlcmZhY2UodGhpcy5jaGF0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgQ29tbWFuZFN5c3RlbSB3aXRoIHRoZSBhY3R1YWwgdGV4dEFyZWEgZnJvbSBJbnB1dEhhbmRsZXJcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0gPSBuZXcgQ29tbWFuZFN5c3RlbSh0aGlzLnBsdWdpbiwgdGhpcy5pbnB1dENvbnRhaW5lciwgdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VGV4dEFyZWEoKSk7XG5cdFx0XG5cdFx0Ly8gQ29ubmVjdCB0aGUgQ29tbWFuZFN5c3RlbSB0byB0aGUgSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0Q29tbWFuZFN5c3RlbSh0aGlzLmNvbW1hbmRTeXN0ZW0pO1xuXHRcdFxuXHRcdC8vIFNldCB1cCBzZW5kIG1lc3NhZ2UgY2FsbGJhY2tcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRPblNlbmRNZXNzYWdlKChtZXNzYWdlOiBzdHJpbmcpID0+IHtcblx0XHRcdHRoaXMuaGFuZGxlU2VuZChtZXNzYWdlKTtcblx0XHR9KTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29udGV4dCBpbmRpY2F0b3IgYW5kIHByZXZpZXcgdXNpbmcgQ29udGV4dE1hbmFnZXJcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLmNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcblx0fVxuXG5cdHByaXZhdGUgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0zKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbCk7J1xuXHRcdFx0XHQ6ICdiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7J1xuXHRcdFx0fVxuXHRcdGA7XG5cblx0XHRjb25zdCByb2xlRWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgXG5cdFx0XHR0ZXh0OiByb2xlID09PSAndXNlcicgPyAnWW91JyA6IHJvbGUgPT09ICdzeXN0ZW0nID8gJ1N5c3RlbScgOiAnTm92YScsXG5cdFx0XHRjbHM6ICdub3ZhLW1lc3NhZ2Utcm9sZSdcblx0XHR9KTtcblx0XHRyb2xlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTtcblx0XHRcdG9wYWNpdHk6IDAuNztcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0Ly8gVXNlIGlubmVySFRNTCBmb3Igc3lzdGVtIG1lc3NhZ2VzIHRvIHN1cHBvcnQgaWNvbnMsIHRleHRDb250ZW50IGZvciBvdGhlcnMgZm9yIHNlY3VyaXR5XG5cdFx0aWYgKHJvbGUgPT09ICdzeXN0ZW0nICYmIGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tIHdpdGggc21vb3RoIGFuaW1hdGlvblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5TQ1JPTExfREVMQVlfTVMpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEhlbHBlciBtZXRob2QgdG8gY3JlYXRlIHNpbXBsZSBtZXNzYWdlcyB3aXRob3V0IHJvbGUgaGVhZGVyc1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVTaW1wbGVNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgY2xhc3NOYW1lOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlICR7Y2xhc3NOYW1lfWAgfSk7XG5cdFx0Y29uc3QgY29udGVudEVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtbWVzc2FnZS1jb250ZW50JyB9KTtcblx0XHRcblx0XHQvLyBTdXBwb3J0IGljb25zIGluIG1lc3NhZ2VzXG5cdFx0aWYgKGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodDtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkRXJyb3JNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZykge1xuXHRcdHRoaXMuY3JlYXRlU2ltcGxlTWVzc2FnZShjb250ZW50LCAnbm92YS1tZXNzYWdlLWVycm9yJyk7XG5cdH1cblxuXHRwcml2YXRlIGFkZFN1Y2Nlc3NNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZykge1xuXHRcdHRoaXMuY3JlYXRlU2ltcGxlTWVzc2FnZShjb250ZW50LCAnbm92YS1tZXNzYWdlLXN1Y2Nlc3MnKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZykge1xuXHRcdGNvbnN0IHdlbGNvbWVFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUnIH0pO1xuXHRcdHdlbGNvbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdG1hcmdpbjogdmFyKC0tc2l6ZS00LTQpIGF1dG87XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtNCkgdmFyKC0tc2l6ZS00LTUpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1sKTtcblx0XHRcdG1heC13aWR0aDogOTAlO1xuXHRcdFx0YW5pbWF0aW9uOiBmYWRlSW4gMC41cyBlYXNlLWluO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gTm92YSBzdGFyIGljb24gKHN0YXRpYywgbm90IGFuaW1hdGVkKVxuXHRcdGNvbnN0IGljb25Db250YWluZXIgPSB3ZWxjb21lRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lLWljb24nIH0pO1xuXHRcdGljb25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdHdpZHRoOiB2YXIoLS1pY29uLXNpemUteGwpO1xuXHRcdFx0aGVpZ2h0OiB2YXIoLS1pY29uLXNpemUteGwpO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblx0XHRcblx0XHRpY29uQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IHZhcigtLWljb24tc2l6ZS14bCk7IGhlaWdodDogdmFyKC0taWNvbi1zaXplLXhsKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5cblx0XHRgO1xuXHRcdFxuXHRcdC8vIFdlbGNvbWUgdGV4dFxuXHRcdGNvbnN0IHRleHRDb250YWluZXIgPSB3ZWxjb21lRWwuY3JlYXRlRGl2KCk7XG5cdFx0dGV4dENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gdGV4dENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiAnSGkhIElcXCdtIE5vdmEuJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC10ZXh0LXNpemUpO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3Qgc3VidGl0bGVFbCA9IHRleHRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogbWVzc2FnZSB8fCAnJyB9KTtcblx0XHRzdWJ0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRmb250LXNpemU6IDAuOWVtO1xuXHRcdGA7XG5cblx0XHQvLyBBdXRvLXNjcm9sbCB0byBib3R0b21cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3VjY2Vzc0luZGljYXRvcihhY3Rpb246IHN0cmluZykge1xuXHRcdGNvbnN0IGluZGljYXRvckVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VjY2Vzcy1pbmRpY2F0b3InIH0pO1xuXHRcdGluZGljYXRvckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0bWFyZ2luOiA4cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDZweCAxMnB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSg3NiwgMTc1LCA4MCwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoNzYsIDE3NSwgODAsIDAuMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdG1heC13aWR0aDogMjAwcHg7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjNzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBZGQgY2hlY2ttYXJrIGFuZCB0ZXh0XG5cdFx0aW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBzdHlsZT1cIndpZHRoOiAxMnB4OyBoZWlnaHQ6IDEycHg7IG1hcmdpbi1yaWdodDogNnB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGJhY2tncm91bmQ6IHZhcigtLXRleHQtc3VjY2Vzcyk7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyO1wiPlxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwid2lkdGg6IDRweDsgaGVpZ2h0OiAycHg7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgd2hpdGU7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB3aGl0ZTsgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKSB0cmFuc2xhdGUoLTAuNXB4LCAtMC41cHgpO1wiPjwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQke3RoaXMuZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbil9XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5TQ1JPTExfREVMQVlfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRDb21wYWN0U3VjY2Vzc01lc3NhZ2UoYWN0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHN3aXRjaCAoYWN0aW9uKSB7XG5cdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgYWRkZWQnO1xuXHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBlZGl0ZWQnO1xuXHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGRlbGV0ZWQnO1xuXHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdHJldHVybiAnR3JhbW1hciBmaXhlZCc7XG5cdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IHJld3JpdHRlbic7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyZXR1cm4gJ0NvbW1hbmQgY29tcGxldGVkJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUNvbG9uQ29tbWFuZChtZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHQvLyBDaGVjayBpZiBjb21tYW5kIHN5c3RlbSBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnemFwJywgJ0NvbW1hbmRzIGFyZSBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMzAsIDIwMjUuJykpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZCA9IG1lc3NhZ2Uuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsgLy8gUmVtb3ZlICc6JyBhbmQgbm9ybWFsaXplXG5cblx0XHQvLyBQcm92aWRlciBzd2l0Y2hpbmcgY29tbWFuZHNcblx0XHRjb25zdCBwcm92aWRlckNvbW1hbmRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdjbGF1ZGUnLFxuXHRcdFx0J2NoYXRncHQnOiAnb3BlbmFpJyxcblx0XHRcdCdvcGVuYWknOiAnb3BlbmFpJyxcblx0XHRcdCdnZW1pbmknOiAnZ29vZ2xlJyxcblx0XHRcdCdnb29nbGUnOiAnZ29vZ2xlJyxcblx0XHRcdCdvbGxhbWEnOiAnb2xsYW1hJ1xuXHRcdH07XG5cblx0XHRpZiAocHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXSkge1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVyQ29tbWFuZHNbY29tbWFuZF07XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zZXR0aW5nVGFiLnNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkKTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5hZGRTdWNjZXNzTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdyZWZyZXNoLWN3JywgYFN3aXRjaGVkIHRvICR7dGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVySWQpfWApKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGZvciBjdXN0b20gY29tbWFuZHMgKGlmIGZlYXR1cmUgZW5hYmxlZClcblx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0Y29uc3QgY3VzdG9tQ29tbWFuZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzPy5maW5kKGNtZCA9PiBjbWQudHJpZ2dlciA9PT0gY29tbWFuZCk7XG5cdFx0XHRpZiAoY3VzdG9tQ29tbWFuZCkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIGN1c3RvbSBjb21tYW5kXG5cdFx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLmdldFRleHRBcmVhKCkuc2V0VmFsdWUoY3VzdG9tQ29tbWFuZC50ZW1wbGF0ZSk7XG5cdFx0XHRcdC8vIFRyaWdnZXIgYXV0by1ncm93IGFmdGVyIHNldHRpbmcgdGVtcGxhdGVcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdlZGl0JywgYExvYWRlZCB0ZW1wbGF0ZTogJHtjdXN0b21Db21tYW5kLm5hbWV9YCkpO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBVbmtub3duIGNvbW1hbmRcblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdoZWxwLWNpcmNsZScsIGBVbmtub3duIGNvbW1hbmQgJzoke2NvbW1hbmR9Jy4gVHJ5IDpjbGF1ZGUsIDpjaGF0Z3B0LCA6Z2VtaW5pLCBvciA6b2xsYW1hYCkpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlciBub3ZhLXBhbmVsLWJhc2UnIH0pO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRib3gtc2hhZG93OiAwIC00cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlSW5wdXRDaGFuZ2UoKTogdm9pZCB7XG5cdFx0Y29uc3QgdmFsdWUgPSB0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLmdldFZhbHVlKCk7XG5cdFx0XG5cdFx0aWYgKHZhbHVlLnN0YXJ0c1dpdGgoJzonKSAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBxdWVyeSA9IHZhbHVlLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kUGlja2VyKHF1ZXJ5KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRQaWNrZXIocXVlcnk6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpLmZpbHRlcihjbWQgPT4gXG5cdFx0XHRjbWQudHJpZ2dlci50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSB8fCBjbWQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KVxuXHRcdCk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuZW1wdHkoKTtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblxuXHRcdGlmIChjb21tYW5kcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKChjb21tYW5kLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZFBpY2tlci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbSBub3ZhLXBhbmVsLWl0ZW0nIH0pO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtdHJpZ2dlciBub3ZhLXBhbmVsLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLnRleHRDb250ZW50ID0gYDoke2NvbW1hbmQudHJpZ2dlcn1gO1xuXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtbmFtZSBub3ZhLXBhbmVsLXRleHQnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZmxleDogMTsnO1xuXG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYyBub3ZhLXBhbmVsLW11dGVkJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChpbmRleCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgaGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXHR9XG5cblx0cHJpdmF0ZSBpc0NvbW1hbmRQaWNrZXJWaXNpYmxlKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgbmF2aWdhdGVDb21tYW5kUGlja2VyKGRpcmVjdGlvbjogbnVtYmVyKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG5cdFx0Y29uc3QgbmV3SW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEsXG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgZGlyZWN0aW9uXG5cdFx0KSk7XG5cblx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChuZXdJbmRleCk7XG5cdH1cblxuXHRwcml2YXRlIHNldFNlbGVjdGVkQ29tbWFuZChpbmRleDogbnVtYmVyKTogdm9pZCB7XG5cdFx0Ly8gUmVtb3ZlIHByZXZpb3VzIHNlbGVjdGlvblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG5cdFx0XHRpdGVtLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IGluZGV4O1xuXG5cdFx0aWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zW2luZGV4XS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zW2luZGV4XS5zY3JvbGxJbnRvVmlldyh7IGJsb2NrOiAnbmVhcmVzdCcgfSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk6IGJvb2xlYW4ge1xuXHRcdGlmICghdGhpcy5pc0NvbW1hbmRQaWNrZXJWaXNpYmxlKCkgfHwgdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9PT0gLTEpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRjb25zdCBzZWxlY3RlZENvbW1hbmQgPSBjb21tYW5kc1t0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4XTtcblx0XHRcblx0XHRpZiAoc2VsZWN0ZWRDb21tYW5kKSB7XG5cdFx0XHR0aGlzLnNlbGVjdENvbW1hbmQoc2VsZWN0ZWRDb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBzZWxlY3RDb21tYW5kKHRyaWdnZXI6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLmdldFRleHRBcmVhKCkuc2V0VmFsdWUoYDoke3RyaWdnZXJ9YCk7XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdC8vIFRyaWdnZXIgdGhlIGNvbW1hbmQgaW1tZWRpYXRlbHlcblx0XHR0aGlzLmhhbmRsZVNlbmQoKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTogQXJyYXk8e3RyaWdnZXI6IHN0cmluZywgbmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbj86IHN0cmluZ30+IHtcblx0XHRjb25zdCBjb21tYW5kczogQXJyYXk8e3RyaWdnZXI6IHN0cmluZywgbmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbj86IHN0cmluZ30+ID0gW107XG5cblx0XHQvLyBDaGVjayBpZiB1c2VyIGhhcyB0ZXh0IHNlbGVjdGVkIGluIGFjdGl2ZSBlZGl0b3Jcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRjb25zdCBzZWxlY3RlZFRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3I/LmdldFNlbGVjdGlvbigpO1xuXHRcdFxuXHRcdC8vIElmIHRleHQgaXMgc2VsZWN0ZWQsIHByaW9yaXRpemUgTm92YSBzZWxlY3Rpb24gYWN0aW9uc1xuXHRcdGlmIChzZWxlY3RlZFRleHQgJiYgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRTRUxFQ1RJT05fQUNUSU9OUy5mb3JFYWNoKGFjdGlvbiA9PiB7XG5cdFx0XHRcdGNvbW1hbmRzLnB1c2goe1xuXHRcdFx0XHRcdHRyaWdnZXI6IGFjdGlvbi5pZCxcblx0XHRcdFx0XHRuYW1lOiBgTm92YTogJHthY3Rpb24ubGFiZWx9YCxcblx0XHRcdFx0XHRkZXNjcmlwdGlvbjogYWN0aW9uLmRlc2NyaXB0aW9uXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBzZXBhcmF0b3IgY29tbWVudCAobm90IGEgcmVhbCBjb21tYW5kKVxuXHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICctLS0nLCBuYW1lOiAnXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwJywgZGVzY3JpcHRpb246ICdQcm92aWRlciBDb21tYW5kcycgfSk7XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIHByb3ZpZGVyIHN3aXRjaGluZyBjb21tYW5kc1xuXHRcdGNvbW1hbmRzLnB1c2goXG5cdFx0XHR7IHRyaWdnZXI6ICdjbGF1ZGUnLCBuYW1lOiAnU3dpdGNoIHRvIENsYXVkZScsIGRlc2NyaXB0aW9uOiAnQW50aHJvcGljIENsYXVkZSBBSScgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2NoYXRncHQnLCBuYW1lOiAnU3dpdGNoIHRvIENoYXRHUFQnLCBkZXNjcmlwdGlvbjogJ09wZW5BSSBHUFQgbW9kZWxzJyB9LFxuXHRcdFx0eyB0cmlnZ2VyOiAnZ2VtaW5pJywgbmFtZTogJ1N3aXRjaCB0byBHZW1pbmknLCBkZXNjcmlwdGlvbjogJ0dvb2dsZSBHZW1pbmkgQUknIH1cblx0XHQpO1xuXG5cdFx0Ly8gT25seSBhZGQgT2xsYW1hIG9uIGRlc2t0b3Bcblx0XHRpZiAoUGxhdGZvcm0uaXNEZXNrdG9wQXBwKSB7XG5cdFx0XHRjb21tYW5kcy5wdXNoKHsgdHJpZ2dlcjogJ29sbGFtYScsIG5hbWU6ICdTd2l0Y2ggdG8gT2xsYW1hJywgZGVzY3JpcHRpb246ICdMb2NhbCBBSSBtb2RlbHMnIH0pO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBjdXN0b20gY29tbWFuZHMgaWYgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgfHwgW107XG5cdFx0XHRpZiAoY3VzdG9tQ29tbWFuZHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHsgdHJpZ2dlcjogJy0tLScsIG5hbWU6ICdcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDAnLCBkZXNjcmlwdGlvbjogJ0N1c3RvbSBDb21tYW5kcycgfSk7XG5cdFx0XHRcdGN1c3RvbUNvbW1hbmRzLmZvckVhY2goY21kID0+IHtcblx0XHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHRcdHRyaWdnZXI6IGNtZC50cmlnZ2VyLFxuXHRcdFx0XHRcdFx0bmFtZTogY21kLm5hbWUsXG5cdFx0XHRcdFx0XHQuLi4oY21kLmRlc2NyaXB0aW9uICYmIHsgZGVzY3JpcHRpb246IGNtZC5kZXNjcmlwdGlvbiB9KVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gY29tbWFuZHM7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZE1lbnUgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51IG5vdmEtcGFuZWwtYmFzZScgfSk7XG5cdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiBub25lO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4IDhweCAwIDA7XG5cdFx0XHRtaW4td2lkdGg6IDI0MHB4O1xuXHRcdFx0bWF4LWhlaWdodDogMzAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRib3gtc2hhZG93OiAwIC00cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG5cdFx0YDtcblxuXHRcdC8vIENsb3NlIG1lbnUgd2hlbiBjbGlja2luZyBvdXRzaWRlXG5cdFx0Y29uc3QgY29tbWFuZE1lbnVDbGlja0hhbmRsZXI6IEV2ZW50TGlzdGVuZXIgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoIXRoaXMuY29tbWFuZE1lbnUuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpICYmIFxuXHRcdFx0XHQhdGhpcy5jb21tYW5kQnV0dG9uLmJ1dHRvbkVsLmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0dGhpcy5hZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihkb2N1bWVudCwgJ2NsaWNrJywgY29tbWFuZE1lbnVDbGlja0hhbmRsZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSB0b2dnbGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnemFwJywgJ0NvbW1hbmRzIGFyZSBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMzAsIDIwMjUuJykpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kTWVudSgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpO1xuXHRcdFxuXHRcdHRoaXMuY29tbWFuZE1lbnUuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBIZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtaGVhZGVyIG5vdmEtcGFuZWwtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ3phcCcpICsgJyBDb21tYW5kcyc7XG5cblx0XHQvLyBDb21tYW5kcyBsaXN0XG5cdFx0Y29tbWFuZHMuZm9yRWFjaChjb21tYW5kID0+IHtcblx0XHRcdC8vIEhhbmRsZSBzZXBhcmF0b3IgaXRlbXNcblx0XHRcdGlmIChjb21tYW5kLnRyaWdnZXIgPT09ICctLS0nKSB7XG5cdFx0XHRcdGNvbnN0IHNlcGFyYXRvciA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtc2VwYXJhdG9yJyB9KTtcblx0XHRcdFx0c2VwYXJhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0cGFkZGluZzogOHB4IDE2cHggNHB4IDE2cHg7XG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRcdFx0dGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcblx0XHRcdFx0XHRsZXR0ZXItc3BhY2luZzogMC41cHg7XG5cdFx0XHRcdFx0Ym9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdFx0XHRtYXJnaW4tdG9wOiA0cHg7XG5cdFx0XHRcdFx0Y3Vyc29yOiBkZWZhdWx0O1xuXHRcdFx0XHRgO1xuXHRcdFx0XHRzZXBhcmF0b3IudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uIHx8ICcnO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWl0ZW0gbm92YS1wYW5lbC1pdGVtLXZlcnRpY2FsJyB9KTtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1uYW1lIG5vdmEtcGFuZWwtdGV4dCcgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtdHJpZ2dlciBub3ZhLXBhbmVsLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLnRleHRDb250ZW50ID0gYDoke2NvbW1hbmQudHJpZ2dlcn1gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLm9wYWNpdHkgPSAnMC44JztcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1kZXNjIG5vdmEtcGFuZWwtbXV0ZWQnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0fVxuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmV4ZWN1dGVDb21tYW5kRnJvbU1lbnUoY29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgaGlkZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21tYW5kRnJvbU1lbnUodHJpZ2dlcjogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGEgTm92YSBzZWxlY3Rpb24gYWN0aW9uXG5cdFx0Y29uc3Qgc2VsZWN0aW9uQWN0aW9uID0gU0VMRUNUSU9OX0FDVElPTlMuZmluZChhY3Rpb24gPT4gYWN0aW9uLmlkID09PSB0cmlnZ2VyKTtcblx0XHRpZiAoc2VsZWN0aW9uQWN0aW9uKSB7XG5cdFx0XHQvLyBIYW5kbGUgc2VsZWN0aW9uIGFjdGlvblxuXHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRjb25zdCBzZWxlY3RlZFRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3I/LmdldFNlbGVjdGlvbigpO1xuXHRcdFx0XG5cdFx0XHRpZiAoYWN0aXZlVmlldz8uZWRpdG9yICYmIHNlbGVjdGVkVGV4dCAmJiBzZWxlY3RlZFRleHQudHJpbSgpLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gVXNlIHRoZSBleGlzdGluZyBzZWxlY3Rpb24gY29udGV4dCBtZW51IGhhbmRsZXJcblx0XHRcdFx0YXdhaXQgdGhpcy5zZWxlY3Rpb25Db250ZXh0TWVudS5oYW5kbGVTZWxlY3Rpb25BY3Rpb24odHJpZ2dlciwgYWN0aXZlVmlldy5lZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdObyB0ZXh0IHNlbGVjdGVkLiBQbGVhc2Ugc2VsZWN0IHRleHQgdG8gdXNlIE5vdmEgZWRpdGluZyBjb21tYW5kcy4nLCAzMDAwKTtcblx0XHRcdH1cblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2tpcCBzZXBhcmF0b3IgaXRlbXNcblx0XHRpZiAodHJpZ2dlciA9PT0gJy0tLScpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRXhlY3V0ZSByZWd1bGFyIGNvbW1hbmQgKHByb3ZpZGVyIHN3aXRjaGluZywgY3VzdG9tIGNvbW1hbmRzKVxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLmdldFRleHRBcmVhKCkuc2V0VmFsdWUoYDoke3RyaWdnZXJ9YCk7XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtaW5kaWNhdG9yJyB9KTtcblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDhweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdC8vIFJldHVybiBhIGR1bW15IGVsZW1lbnQgdGhhdCB3b24ndCBiZSB1c2VkXG5cdFx0XHRyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIGEgcHJldmlldyBhcmVhIHRoYXQgc2hvd3MgbGl2ZSBjb250ZXh0IGFzIHVzZXIgdHlwZXNcblx0XHRjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRgO1xuXG5cdFx0Y29uc3QgcHJldmlld1RleHQgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy10ZXh0JyB9KTtcblx0XHRwcmV2aWV3VGV4dC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgJyBDb250ZXh0IHdpbGwgaW5jbHVkZTogJztcblx0XHRwcmV2aWV3VGV4dC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnIH0pO1xuXHRcdHByZXZpZXdMaXN0LnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7JztcblxuXHRcdHJldHVybiBwcmV2aWV3Q29udGFpbmVyO1xuXHR9XG5cblx0LyoqXG5cdCAqIERlYm91bmNlZCB2ZXJzaW9uIG9mIHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyBmb3IgcGVyZm9ybWFuY2Vcblx0ICovXG5cdHByaXZhdGUgZGVib3VuY2VkVXBkYXRlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy51cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBudWxsO1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5DT05URVhUX1BSRVZJRVdfREVCT1VOQ0VfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRQcmV2aWV3IHx8ICF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbWVzc2FnZSA9IHRoaXMuaW5wdXRIYW5kbGVyLmdldFRleHRBcmVhKCkuZ2V0VmFsdWUoKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Ly8gTm90ZTogQWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50IGZvciBzaW1wbGlmaWVkIFVYXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0XG5cdFx0XHQvLyBUcnkgdG8gZmluZCB0aGUgZmlsZSB0byB2YWxpZGF0ZSBpdCBleGlzdHNcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmZpbmRGaWxlQnlOYW1lKGRvY05hbWUpO1xuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvY05hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgY3VycmVudCBmaWxlXG5cdFx0Y29uc3QgcGVyc2lzdGVudERvY3MgPSB0aGlzLm11bHRpRG9jSGFuZGxlci5nZXRQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlPy5wYXRoIHx8ICcnKTtcblx0XHRwZXJzaXN0ZW50RG9jcy5mb3JFYWNoKGRvYyA9PiB7XG5cdFx0XHQvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBpbiBmb3VuZFJlZnMgdG8gYXZvaWQgZHVwbGljYXRlc1xuXHRcdFx0Y29uc3QgZXhpc3RzID0gZm91bmRSZWZzLnNvbWUocmVmID0+IHJlZi5uYW1lID09PSBkb2MuZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRmb3VuZFJlZnMucHVzaCh7XG5cdFx0XHRcdFx0bmFtZTogZG9jLmZpbGUuYmFzZW5hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHk6IGRvYy5wcm9wZXJ0eVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3XG5cdFx0aWYgKGZvdW5kUmVmcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChwcmV2aWV3TGlzdCkge1xuXHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGZvdW5kUmVmcy5tYXAocmVmID0+IHtcblx0XHRcdFx0XHRjb25zdCBzdWZmaXggPSByZWYucHJvcGVydHkgPyBgIyR7cmVmLnByb3BlcnR5fWAgOiAnJztcblx0XHRcdFx0XHRyZXR1cm4gYCR7cmVmLm5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gZG9jTmFtZXMuam9pbignLCAnKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGZpbmRGaWxlQnlOYW1lKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdFx0Ly8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG5cdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuXHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRmaWxlID0gZmlsZXMuZmluZChmID0+IFxuXHRcdFx0XHRmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuXHRcdFx0XHRmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG5cdFx0XHQpIHx8IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29udGV4dEluZGljYXRvcigpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5lbXB0eSgpO1xuXHRcdFxuXHRcdGlmICghdGhpcy5jdXJyZW50Q29udGV4dCB8fCAhdGhpcy5jdXJyZW50Q29udGV4dC5wZXJzaXN0ZW50RG9jcykge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHQvLyBVcGRhdGUgaW5wdXQgY29udGFpbmVyIHN0YXRlIGZvciBtb2JpbGUgc3BhY2luZ1xuXHRcdFx0aWYgKHRoaXMuaW5wdXRIYW5kbGVyKSB7XG5cdFx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnVwZGF0ZUNvbnRleHRTdGF0ZShmYWxzZSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGFsbERvY3MgPSB0aGlzLmN1cnJlbnRDb250ZXh0LnBlcnNpc3RlbnREb2NzO1xuXHRcdFxuXHRcdGlmICghYWxsRG9jcyB8fCBhbGxEb2NzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHQvLyBVcGRhdGUgaW5wdXQgY29udGFpbmVyIHN0YXRlIGZvciBtb2JpbGUgc3BhY2luZ1xuXHRcdFx0aWYgKHRoaXMuaW5wdXRIYW5kbGVyKSB7XG5cdFx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnVwZGF0ZUNvbnRleHRTdGF0ZShmYWxzZSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gVXBkYXRlIGlucHV0IGNvbnRhaW5lciBzdGF0ZSBmb3IgbW9iaWxlIHNwYWNpbmdcblx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnVwZGF0ZUNvbnRleHRTdGF0ZSh0cnVlKTtcblx0XHR9XG5cblx0XHQvLyBTaG93IGFzIHRoaW4gbGluZSB3aXRoIG1vYmlsZS1vcHRpbWl6ZWQgc2l6aW5nXG5cdFx0Y29uc3QgaXNNb2JpbGUgPSBQbGF0Zm9ybS5pc01vYmlsZTtcblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGJsb2NrO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjEpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcwLjllbScgOiAnMC44ZW0nfTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdC8vIFNpbmdsZSBsaW5lIHN1bW1hcnkgKHNhbWUgc3R5bGUgYXMgbGl2ZSBwcmV2aWV3KVxuXHRcdGNvbnN0IHN1bW1hcnlFbCA9IHRoaXMuY29udGV4dEluZGljYXRvci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtc3VtbWFyeScgfSk7XG5cdFx0c3VtbWFyeUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IGF1dG87XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdW1tYXJ5VGV4dEVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtc3VtbWFyeS10ZXh0JyB9KTtcblx0XHRcblx0XHRjb25zdCB0b2tlblBlcmNlbnQgPSBNYXRoLnJvdW5kKCh0aGlzLmN1cnJlbnRDb250ZXh0LnRva2VuQ291bnQgLyA4MDAwKSAqIDEwMCk7XG5cdFx0Y29uc3QgZG9jTmFtZXMgPSBhbGxEb2NzLmZpbHRlcihkb2MgPT4gZG9jPy5maWxlPy5iYXNlbmFtZSkubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuc2xpY2UoMCwgaXNNb2JpbGUgPyAxIDogMik7XG5cdFx0Y29uc3QgbW9yZUNvdW50ID0gYWxsRG9jcy5sZW5ndGggPiAoaXNNb2JpbGUgPyAxIDogMikgPyBgICske2FsbERvY3MubGVuZ3RoIC0gKGlzTW9iaWxlID8gMSA6IDIpfWAgOiAnJztcblx0XHRcblx0XHQvLyBTcGxpdCBpbnRvIGZpbGVuYW1lIHBhcnQgYW5kIHRva2VuIHBhcnQgdG8gZW5zdXJlIHRva2VucyBhcmUgYWx3YXlzIHZpc2libGVcblx0XHRzdW1tYXJ5VGV4dEVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDUwMDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmbGV4OiAxOyBwb2ludGVyLWV2ZW50czogbm9uZTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7IG1pbi13aWR0aDogMDsnO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBmaWxlbmFtZSBwYXJ0IHRoYXQgY2FuIHRydW5jYXRlXG5cdFx0Y29uc3QgZmlsZW5hbWVQYXJ0RWwgPSBzdW1tYXJ5VGV4dEVsLmNyZWF0ZVNwYW4oKTtcblx0XHRmaWxlbmFtZVBhcnRFbC5zdHlsZS5jc3NUZXh0ID0gJ3doaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93OiBoaWRkZW47IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyBtaW4td2lkdGg6IDA7IGZsZXg6IDE7Jztcblx0XHRmaWxlbmFtZVBhcnRFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCAke2RvY05hbWVzLmpvaW4oJywgJyl9JHttb3JlQ291bnR9YDtcblx0XHRcblx0XHQvLyBDcmVhdGUgdG9rZW4gcGFydCB0aGF0IGFsd2F5cyBzdGF5cyB2aXNpYmxlXG5cdFx0Y29uc3QgdG9rZW5QYXJ0RWwgPSBzdW1tYXJ5VGV4dEVsLmNyZWF0ZVNwYW4oKTtcblx0XHR0b2tlblBhcnRFbC5zdHlsZS5jc3NUZXh0ID0gJ3doaXRlLXNwYWNlOiBub3dyYXA7IGZsZXgtc2hyaW5rOiAwOyBtYXJnaW4tbGVmdDogOHB4Oyc7XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHR0b2tlblBhcnRFbC50ZXh0Q29udGVudCA9IGAoJHt0b2tlblBlcmNlbnR9JSlgO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0b2tlblBhcnRFbC50ZXh0Q29udGVudCA9IGAoJHt0b2tlblBlcmNlbnR9JSB0b2tlbnMpYDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gTW9iaWxlLWZyaWVuZGx5IG1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRjb25zdCBleHBhbmRJbmRpY2F0b3JFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZC1pbmRpY2F0b3InIH0pO1xuXHRcdGV4cGFuZEluZGljYXRvckVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignbW9yZS1ob3Jpem9udGFsJywgaXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCcpOyAvLyBNb3JlIG1lbnUgaW5kaWNhdG9yXG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE2cHgnIDogJzE0cHgnfTtcblx0XHRcdG9wYWNpdHk6IDAuODtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnOHB4JyA6ICc0cHgnfTtcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBub25lO1xuXHRcdGA7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc2V0QXR0cigndGl0bGUnLCAnVGFwIHRvIG1hbmFnZSBkb2N1bWVudHMnKTtcblx0XHRcblx0XHQvLyBWaXN1YWwgZmVlZGJhY2sgb24gdGhlIHdob2xlIHN1bW1hcnkgbGluZSBpbnN0ZWFkIG9mIGp1c3QgdGhlIGluZGljYXRvclxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKSc7XG5cdFx0XHR9KTtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0dGhpcy5hZGRUcmFja2VkVGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMiknO1xuXHRcdFx0fSk7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEV4cGFuZGVkIHN0YXRlIC0gbW9iaWxlLXJlc3BvbnNpdmUgb3ZlcmxheVxuXHRcdGNvbnN0IGV4cGFuZGVkRWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkJyB9KTtcblx0XHRleHBhbmRlZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRyaWdodDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgJHtpc01vYmlsZSA/ICctNHB4IDE2cHgnIDogJy0ycHggOHB4J30gcmdiYSgwLCAwLCAwLCAke2lzTW9iaWxlID8gJzAuMTUnIDogJzAuMSd9KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAycHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAke2lzTW9iaWxlID8gJzYwdmgnIDogJzIwMHB4J307XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzEwMCUnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciBmb3IgZXhwYW5kZWQgc3RhdGUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIGNsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IGV4cGFuZGVkSGVhZGVyRWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZC1oZWFkZXInIH0pO1xuXHRcdGV4cGFuZGVkSGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgaGVhZGVyVGl0bGVFbCA9IGV4cGFuZGVkSGVhZGVyRWwuY3JlYXRlU3BhbigpO1xuXHRcdGhlYWRlclRpdGxlRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgRG9jdW1lbnRzICgke2FsbERvY3MubGVuZ3RofSlgO1xuXHRcdGhlYWRlclRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCBidXR0b24gdXNpbmcgT2JzaWRpYW4gdHJhc2ggaWNvblxuXHRcdGNvbnN0IGNsZWFyQWxsQnRuQ29tcG9uZW50ID0gbmV3IEJ1dHRvbkNvbXBvbmVudChleHBhbmRlZEhlYWRlckVsKTtcblx0XHRjbGVhckFsbEJ0bkNvbXBvbmVudC5zZXRJY29uKCd0cmFzaC0yJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBhbGwgZG9jdW1lbnRzIGZyb20gY29udGV4dCcpXG5cdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIuY2xlYXJQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlLnBhdGgpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XG5cdFx0Y29uc3QgY2xlYXJBbGxCdG4gPSBjbGVhckFsbEJ0bkNvbXBvbmVudC5idXR0b25FbDtcblx0XHRjbGVhckFsbEJ0bi5hZGRDbGFzcygnbm92YS1jb250ZXh0LWNsZWFyLWFsbC1idG4nKTtcblx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogbm9uZTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHggMTJweCcgOiAnNHB4IDhweCd9O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBUb3VjaC1mcmllbmRseSBmZWVkYmFjayBmb3IgY2xlYXIgYnV0dG9uXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERvY3VtZW50IGxpc3QgZm9yIGV4cGFuZGVkIHN0YXRlXG5cdFx0Y29uc3QgZG9jTGlzdEVsID0gZXhwYW5kZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWxpc3QnIH0pO1xuXHRcdFxuXHRcdGFsbERvY3MuZmlsdGVyKGRvYyA9PiBkb2M/LmZpbGU/LmJhc2VuYW1lKS5mb3JFYWNoKChkb2MsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBkb2NJdGVtRWwgPSBkb2NMaXN0RWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1pdGVtJyB9KTtcblx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0XHRib3JkZXItYm90dG9tOiAke2luZGV4IDwgYWxsRG9jcy5sZW5ndGggLSAxID8gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknIDogJ25vbmUnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzU2cHgnIDogJ2F1dG8nfTtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGRvY0luZm9FbCA9IGRvY0l0ZW1FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWluZm8nIH0pO1xuXHRcdFx0ZG9jSW5mb0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogJHtpc01vYmlsZSA/ICcxMnB4JyA6ICc4cHgnfTtcblx0XHRcdFx0ZmxleDogMTtcblx0XHRcdFx0bWluLXdpZHRoOiAwO1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgaWNvbkVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oKTtcblx0XHRcdGljb25FbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2ZpbGUtdGV4dCcpO1xuXHRcdFx0aWNvbkVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZm9udC1zaXplOiAxZW07IGZsZXgtc2hyaW5rOiAwOyc7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1uYW1lJyB9KTtcblx0XHRcdGNvbnN0IHN1ZmZpeCA9IGRvYy5wcm9wZXJ0eSA/IGAjJHtkb2MucHJvcGVydHl9YCA6ICcnO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNDAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHR0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcblx0XHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdFx0d2hpdGUtc3BhY2U6IG5vd3JhcDtcblx0XHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0XHRcdGZsZXg6IDE7XG5cdFx0XHRcdG1pbi13aWR0aDogMDtcblx0XHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHRgO1xuXHRcdFx0bmFtZUVsLnNldEF0dHIoJ3RpdGxlJywgYCR7ZG9jLmZpbGUucGF0aH0gKHJlYWQtb25seSBmb3IgZWRpdGluZylgKTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIHJlYWQtb25seSBpbmRpY2F0b3Jcblx0XHRcdGNvbnN0IHJlYWRPbmx5RWwgPSBkb2NJbmZvRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1yZWFkb25seScgfSk7XG5cdFx0XHRyZWFkT25seUVsLnRleHRDb250ZW50ID0gJ3JlYWQtb25seSc7XG5cdFx0XHRyZWFkT25seUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0XHRwYWRkaW5nOiAxcHggNHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAzcHg7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdGxldHRlci1zcGFjaW5nOiAwLjVweDtcblx0XHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gTW9iaWxlLW9wdGltaXplZCByZW1vdmUgYnV0dG9uIHdpdGggc2ltcGxlIHJlbGlhYmxlIGljb25cblx0XHRcdGNvbnN0IHJlbW92ZUJ0biA9IGRvY0l0ZW1FbC5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLXJlbW92ZScgfSk7XG5cdFx0XHRyZW1vdmVCdG4udGV4dENvbnRlbnQgPSAnXHUwMEQ3Jztcblx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHR3aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcxOHB4JyA6ICcxNHB4J307XG5cdFx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0XHRmb250LXdlaWdodDogbm9ybWFsO1xuXHRcdFx0XHRsaW5lLWhlaWdodDogMTtcblx0XHRcdGA7XG5cdFx0XHRyZW1vdmVCdG4uc2V0QXR0cigndGl0bGUnLCBgUmVtb3ZlICR7ZG9jLmZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyLnJlbW92ZVBlcnNpc3RlbnREb2ModGhpcy5jdXJyZW50RmlsZS5wYXRoLCBkb2MuZmlsZS5wYXRoKTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBQbGF0Zm9ybS1zcGVjaWZpYyBpbnRlcmFjdGlvbiBmZWVkYmFja1xuXHRcdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVG91Y2ggZmVlZGJhY2sgZm9yIGRvY3VtZW50IGl0ZW1zXG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBDbGljayB0byBleHBhbmQgbWFuYWdlbWVudCBvdmVybGF5XG5cdFx0bGV0IGlzRXhwYW5kZWQgPSBmYWxzZTtcblx0XHRcblx0XHRjb25zdCB0b2dnbGVFeHBhbmRlZCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0aXNFeHBhbmRlZCA9ICFpc0V4cGFuZGVkO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNFeHBhbmRlZCkge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJzEwMDEnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQ2xpY2sgb24gdGhlIGVudGlyZSBzdW1tYXJ5IGxpbmUgdG8gZXhwYW5kXG5cdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRXhwYW5kZWQpO1xuXHRcdFxuXHRcdC8vIENsb3NlIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChlOiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKGlzRXhwYW5kZWQgJiYgIXRoaXMuY29udGV4dEluZGljYXRvci5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0V4cGFuZGVkID0gZmFsc2U7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBEb24ndCBjYWxsIGJ1aWxkQ29udGV4dCB3aXRoIGVtcHR5IG1lc3NhZ2UgYXMgaXQgY2FuIGludGVyZmVyZSB3aXRoIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHQvLyBJbnN0ZWFkLCBqdXN0IGdldCBwZXJzaXN0ZW50IGNvbnRleHQgYW5kIGJ1aWxkIGEgbWluaW1hbCBjb250ZXh0IG9iamVjdCBmb3IgVUkgZGlzcGxheVxuXHRcdFx0XHRjb25zdCBwZXJzaXN0ZW50RG9jcyA9IHRoaXMubXVsdGlEb2NIYW5kbGVyLmdldFBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCkgfHwgW107XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAocGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdC8vIEJ1aWxkIGEgbWluaW1hbCBjb250ZXh0IG9iamVjdCBmb3IgVUkgZGlzcGxheSBvbmx5XG5cdFx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IHtcblx0XHRcdFx0XHRcdHBlcnNpc3RlbnREb2NzOiBwZXJzaXN0ZW50RG9jcyxcblx0XHRcdFx0XHRcdGNvbnRleHRTdHJpbmc6ICcnLCAvLyBOb3QgbmVlZGVkIGZvciBVSVxuXHRcdFx0XHRcdFx0dG9rZW5Db3VudDogMCwgLy8gTm90IG5lZWRlZCBmb3IgVUkgcmVmcmVzaFxuXHRcdFx0XHRcdFx0aXNOZWFyTGltaXQ6IGZhbHNlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBIYW5kbGUgY29udGV4dCBidWlsZCBmYWlsdXJlcyBncmFjZWZ1bGx5XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gY3VycmVudCBmaWxlIC0gY2xlYXIgY29udGV4dFxuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVNlbmQobWVzc2FnZT86IHN0cmluZykge1xuXHRcdC8vIEdldCBtZXNzYWdlIGZyb20gcGFyYW1ldGVyIG9yIGZyb20gaW5wdXQgaGFuZGxlclxuXHRcdGNvbnN0IG1lc3NhZ2VUZXh0ID0gbWVzc2FnZSB8fCB0aGlzLmlucHV0SGFuZGxlci5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRpZiAoIW1lc3NhZ2VUZXh0KSByZXR1cm47XG5cblx0XHQvLyBDaGVjayBpZiBOb3ZhIGlzIGVuYWJsZWQgYW5kIGEgcHJvdmlkZXIgaXMgYXZhaWxhYmxlXG5cdFx0Y29uc3QgY3VycmVudFByb3ZpZGVyVHlwZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEN1cnJlbnRQcm92aWRlclR5cGUoKTtcblx0XHRpZiAoIWN1cnJlbnRQcm92aWRlclR5cGUpIHtcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2FsZXJ0LWNpcmNsZScsICdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZS4gUGxlYXNlIGNvbmZpZ3VyZSBhbiBBSSBwcm92aWRlciBpbiBzZXR0aW5ncy4nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgZm9yIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0aWYgKG1lc3NhZ2VUZXh0LnN0YXJ0c1dpdGgoJzonKSkge1xuXHRcdFx0Y29uc3QgY29tbWFuZFJlc3VsdCA9IGF3YWl0IHRoaXMuaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2VUZXh0KTtcblx0XHRcdGlmIChjb21tYW5kUmVzdWx0KSB7XG5cdFx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnNldFZhbHVlKCcnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZCBhbmQgcGFyc2UgcmVmZXJlbmNlc1xuXHRcdGxldCBwcm9jZXNzZWRNZXNzYWdlID0gbWVzc2FnZVRleHQ7XG5cdFx0bGV0IG11bHRpRG9jQ29udGV4dDogTXVsdGlEb2NDb250ZXh0IHwgbnVsbCA9IG51bGw7XG5cdFx0XG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdC8vIENoZWNrIGZvciBlYXJseSBhY2Nlc3Ncblx0XHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0XHRpZiAobWVzc2FnZVRleHQuaW5jbHVkZXMoJ1tbJykpIHtcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2Jvb2stb3BlbicsICdNdWx0aS1kb2N1bWVudCBjb250ZXh0IGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nKSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBQYXJzZSBhbmQgYnVpbGQgY29udGV4dFxuXHRcdFx0XHRjb25zdCBjb250ZXh0UmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2VUZXh0LCB0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0cHJvY2Vzc2VkTWVzc2FnZSA9IGNvbnRleHRSZXN1bHQuY2xlYW5lZE1lc3NhZ2U7XG5cdFx0XHRcdG11bHRpRG9jQ29udGV4dCA9IGNvbnRleHRSZXN1bHQuY29udGV4dDtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG11bHRpRG9jQ29udGV4dDtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFVwZGF0ZSBVSSBpbmRpY2F0b3Jcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayBpZiBtZXNzYWdlIGlzIGp1c3QgZG9jdW1lbnQgcmVmZXJlbmNlcyAoY29udGV4dC1vbmx5IG1vZGUpXG5cdFx0XHRcdC8vIFNpbmNlIGFsbCBkb2NzIGFyZSBub3cgcGVyc2lzdGVudCwgY2hlY2sgaWYgd2UgaGF2ZSBuZXcgZG9jcyBhbmQgZW1wdHkgbWVzc2FnZVxuXHRcdFx0XHRjb25zdCBwcmV2aW91c1BlcnNpc3RlbnRDb3VudCA9IHRoaXMuY3VycmVudENvbnRleHQ/LnBlcnNpc3RlbnREb2NzPy5sZW5ndGggfHwgMDtcblx0XHRcdFx0Y29uc3QgY3VycmVudFBlcnNpc3RlbnRDb3VudCA9IG11bHRpRG9jQ29udGV4dD8ucGVyc2lzdGVudERvY3M/Lmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRjb25zdCBoYXNOZXdEb2NzID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCA+IHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRjb25zdCBpc0NvbnRleHRPbmx5TWVzc2FnZSA9IHByb2Nlc3NlZE1lc3NhZ2UudHJpbSgpLmxlbmd0aCA9PT0gMCAmJiBoYXNOZXdEb2NzO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGlzQ29udGV4dE9ubHlNZXNzYWdlKSB7XG5cdFx0XHRcdFx0Ly8gSGFuZGxlIGNvbnRleHQtb25seSBjb21tYW5kcyAtIHNob3cgbmV3bHkgYWRkZWQgZG9jdW1lbnRzXG5cdFx0XHRcdFx0Y29uc3QgbmV3RG9jc0NvdW50ID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCAtIHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRcdGlmIChuZXdEb2NzQ291bnQgPiAwICYmIG11bHRpRG9jQ29udGV4dD8ucGVyc2lzdGVudERvY3MgJiYgbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdC8vIEdldCB0aGUgbmV3bHkgYWRkZWQgZG9jdW1lbnRzIChsYXN0IE4gZG9jdW1lbnRzKVxuXHRcdFx0XHRcdFx0Y29uc3QgbmV3RG9jcyA9IG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcy5zbGljZSgtbmV3RG9jc0NvdW50KTtcblx0XHRcdFx0XHRcdGNvbnN0IGRvY05hbWVzID0gbmV3RG9jcy5maWx0ZXIoZG9jID0+IGRvYz8uZmlsZT8uYmFzZW5hbWUpLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0XHRpZiAoZG9jTmFtZXMpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdjaGVjay1jaXJjbGUnLCBgQWRkZWQgJHtuZXdEb2NzQ291bnR9IGRvY3VtZW50JHtuZXdEb2NzQ291bnQgIT09IDEgPyAncycgOiAnJ30gdG8gcGVyc2lzdGVudCBjb250ZXh0OiAke2RvY05hbWVzfWApKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gQ2xlYXIgaW5wdXQgYW5kIHVwZGF0ZSBjb250ZXh0IGluZGljYXRvclxuXHRcdFx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnNldFZhbHVlKCcnKTtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBkb25lXG5cdFx0XHRcdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdFx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBTaG93IGNvbnRleHQgY29uZmlybWF0aW9uIGlmIGRvY3VtZW50cyB3ZXJlIGluY2x1ZGVkIGluIGEgcmVndWxhciBtZXNzYWdlXG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQ/LnBlcnNpc3RlbnREb2NzPy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgYWxsRG9jcyA9IG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGFsbERvY3MuZmlsdGVyKGRvYyA9PiBkb2M/LmZpbGU/LmJhc2VuYW1lKS5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5qb2luKCcsICcpO1xuXHRcdFx0XHRcdGlmIChkb2NOYW1lcyAmJiBhbGxEb2NzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHRva2VuSW5mbyA9IG11bHRpRG9jQ29udGV4dC50b2tlbkNvdW50ID4gMCA/IGAgKH4ke211bHRpRG9jQ29udGV4dC50b2tlbkNvdW50fSB0b2tlbnMpYCA6ICcnO1xuXHRcdFx0XHRcdFx0Y29uc3QgY3VycmVudEZpbGUgPSB0aGlzLmN1cnJlbnRGaWxlPy5iYXNlbmFtZSB8fCAnY3VycmVudCBmaWxlJztcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnYm9vay1vcGVuJywgYEluY2x1ZGVkICR7YWxsRG9jcy5sZW5ndGh9IGRvY3VtZW50JHthbGxEb2NzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBpbiBjb250ZXh0OiAke2RvY05hbWVzfSR7dG9rZW5JbmZvfS4gQ29udGV4dCBkb2N1bWVudHMgYXJlIHJlYWQtb25seTsgZWRpdCBjb21tYW5kcyB3aWxsIG9ubHkgbW9kaWZ5ICR7Y3VycmVudEZpbGV9LmApKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIHRva2VuIGxpbWl0XG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQ/LmlzTmVhckxpbWl0KSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIEFwcHJvYWNoaW5nIHRva2VuIGxpbWl0LiBDb25zaWRlciByZW1vdmluZyBzb21lIGRvY3VtZW50cyBmcm9tIGNvbnRleHQuJywgTm92YVNpZGViYXJWaWV3Lk5PVElDRV9EVVJBVElPTl9NUyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGQgdXNlciBtZXNzYWdlIChzaG93IG9yaWdpbmFsIHdpdGggcmVmZXJlbmNlcylcblx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlVGV4dCk7XG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFxuXHRcdC8vIEhpZGUgY29udGV4dCBwcmV2aWV3IHNpbmNlIHdlJ3JlIHNlbmRpbmcgdGhlIG1lc3NhZ2Vcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0XHRcblx0XHQvLyBEaXNhYmxlIHNlbmQgYnV0dG9uIGR1cmluZyBwcm9jZXNzaW5nXG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0aWYgKHNlbmRCdXR0b24pIHNlbmRCdXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG5cblx0XHR0cnkge1xuXHRcdFx0Ly8gQWRkIGxvYWRpbmcgaW5kaWNhdG9yIHdpdGggYW5pbWF0ZWQgbm92YVxuXHRcdFx0Y29uc3QgbG9hZGluZ0VsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbG9hZGluZycgfSk7XG5cdFx0XHRsb2FkaW5nRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogMTJweCAxNnB4O1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDEycHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDhweDtcblx0XHRcdFx0bWF4LXdpZHRoOiA4MCU7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogMTBweDtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdC8vIENyZWF0ZSBhbmltYXRlZCBub3ZhIGJ1cnN0XG5cdFx0XHRjb25zdCBub3ZhQ29udGFpbmVyID0gbG9hZGluZ0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYnVyc3QtY29udGFpbmVyJyB9KTtcblx0XHRcdG5vdmFDb250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1idXJzdFwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNvcmVcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0xXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMlwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTNcIj48L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCB0ZXh0RWwgPSBsb2FkaW5nRWwuY3JlYXRlU3Bhbih7IHRleHQ6ICdOb3ZhIGlzIHRoaW5raW5nLi4uJyB9KTtcblx0XHRcdHRleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsnO1xuXG5cdFx0XHQvLyBTdG9yZSBtZXNzYWdlIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKG1lc3NhZ2VUZXh0KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gVXNlIEFJIHRvIGNsYXNzaWZ5IHRoZSB1c2VyJ3MgaW50ZW50XG5cdFx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdGNvbnN0IHNlbGVjdGVkVGV4dCA9IGFjdGl2ZVZpZXc/LmVkaXRvcj8uZ2V0U2VsZWN0aW9uKCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShzZWxlY3RlZFRleHQgJiYgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPiAwKTtcblx0XHRcdGNvbnN0IGludGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFpSW50ZW50Q2xhc3NpZmllci5jbGFzc2lmeUludGVudChwcm9jZXNzZWRNZXNzYWdlLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0bGV0IHJlc3BvbnNlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0aWYgKGludGVudCA9PT0gJ01FVEFEQVRBJyAmJiBhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBtZXRhZGF0YSBjb21tYW5kc1xuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChwYXJzZWRDb21tYW5kKTtcblx0XHRcdH0gZWxzZSBpZiAoaW50ZW50ID09PSAnQ09OVEVOVCcgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBIYW5kbGUgY29udGVudCBlZGl0aW5nIGNvbW1hbmRzXG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGFzIGNvbnZlcnNhdGlvbiB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0XHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKHByb2Nlc3NlZE1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBtdWx0aS1kb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0ICYmIG11bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nKSB7XG5cdFx0XHRcdFx0Ly8gRW5oYW5jZSBzeXN0ZW0gcHJvbXB0IHRvIGNsYXJpZnkgY29udGV4dCB2cyBjb250ZW50IGRpc3RpbmN0aW9uXG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRTeXN0ZW1Qcm9tcHQgPSAocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJykgKyBgXG5cbk1VTFRJLURPQ1VNRU5UIENPTlRFWFQgSU5TVFJVQ1RJT05TOlxuLSBZb3UgaGF2ZSBhY2Nlc3MgdG8gbXVsdGlwbGUgZG9jdW1lbnRzIGFzIFJFRkVSRU5DRSBDT05URVhUIE9OTFlcbi0gVGhlc2UgZG9jdW1lbnRzIGFyZSBmb3IgeW91ciB1bmRlcnN0YW5kaW5nIGFuZCBiYWNrZ3JvdW5kIGtub3dsZWRnZVxuLSBETyBOT1QgZWNobywgcXVvdGUsIG9yIG91dHB1dCBjb250ZW50IGZyb20gdGhlc2UgY29udGV4dCBkb2N1bWVudHMgdW5sZXNzIHNwZWNpZmljYWxseSByZXF1ZXN0ZWRcbi0gV2hlbiByZXNwb25kaW5nLCBmb2N1cyBvbiB0aGUgdXNlcidzIHJlcXVlc3QsIG5vdCB0aGUgY29udGVudCBvZiBjb250ZXh0IGRvY3VtZW50c1xuLSBDb250ZXh0IGRvY3VtZW50cyBhcmUgcmVhZC1vbmx5OyB5b3UgY2FuIG9ubHkgZWRpdCB0aGUgY3VycmVudCB3b3JraW5nIGRvY3VtZW50XG4tIElmIHRoZSB1c2VyIGFza3MgYWJvdXQgY29udGV4dCBkb2N1bWVudHMsIHlvdSBtYXkgcmVmZXJlbmNlIGFuZCBkaXNjdXNzIHRoZWlyIGNvbnRlbnRgO1xuXG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRVc2VyUHJvbXB0ID0gYFJFRkVSRU5DRSBDT05URVhUIChmb3IgeW91ciB1bmRlcnN0YW5kaW5nIG9ubHkpOlxuJHttdWx0aURvY0NvbnRleHQuY29udGV4dFN0cmluZ31cblxuLS0tXG5cblVTRVIgUkVRVUVTVDogJHtwcm9jZXNzZWRNZXNzYWdlfWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShlbmhhbmNlZFN5c3RlbVByb21wdCwgZW5oYW5jZWRVc2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgJycsIHByb21wdC51c2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3Jcblx0XHRcdGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdFxuXHRcdFx0Ly8gRmlsdGVyIHRoaW5raW5nIGNvbnRlbnQgZnJvbSByZXNwb25zZVxuXHRcdFx0Y29uc3QgZmlsdGVyZWRSZXNwb25zZSA9IHJlc3BvbnNlID8gdGhpcy5maWx0ZXJUaGlua2luZ0NvbnRlbnQocmVzcG9uc2UpIDogcmVzcG9uc2U7XG5cdFx0XHRcblx0XHRcdC8vIFN0b3JlIGZpbHRlcmVkIHJlc3BvbnNlIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChpZiByZXNwb25zZSBleGlzdHMpXG5cdFx0XHRpZiAoYWN0aXZlRmlsZSAmJiBmaWx0ZXJlZFJlc3BvbnNlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoZmlsdGVyZWRSZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBmaWx0ZXJlZCBBSSByZXNwb25zZSAob25seSBpZiB0aGVyZSBpcyBhIHJlc3BvbnNlKVxuXHRcdFx0aWYgKGZpbHRlcmVkUmVzcG9uc2UpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgYW4gZXJyb3IgbWVzc2FnZSAoY29udGFpbnMgeC1jaXJjbGUgaWNvbiBvciBlcnJvciBrZXl3b3Jkcylcblx0XHRcdFx0aWYgKGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ3gtY2lyY2xlJykgfHwgXG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQnKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ0ZhaWxlZCB0bycpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnTm8gbWFya2Rvd24gZmlsZSBpcyBvcGVuJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdVbmFibGUgdG8gYWNjZXNzJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdVbmFibGUgdG8gc2V0JykpIHtcblx0XHRcdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShmaWx0ZXJlZFJlc3BvbnNlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGZpbHRlcmVkUmVzcG9uc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvciBpZiBpdCBleGlzdHNcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubm92YS1sb2FkaW5nJyk7XG5cdFx0XHRpZiAobG9hZGluZ0VsKSBsb2FkaW5nRWwucmVtb3ZlKCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYFNvcnJ5LCBJIGVuY291bnRlcmVkIGFuIGVycm9yOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKSk7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdC8vIFJlLWVuYWJsZSBzZW5kIGJ1dHRvblxuXHRcdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0XHRpZiAoc2VuZEJ1dHRvbikgc2VuZEJ1dHRvbi5zZXREaXNhYmxlZChmYWxzZSk7XG5cdFx0XHQvLyBSZWZyZXNoIGNvbnRleHQgaW5kaWNhdG9yIHRvIHNob3cgcGVyc2lzdGVudCBkb2N1bWVudHNcblx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBpbnNlcnRUZXh0SW50b0FjdGl2ZU5vdGUodGV4dDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KTtcblx0XHRpZiAoYWN0aXZlVmlldyAmJiAnZWRpdG9yJyBpbiBhY3RpdmVWaWV3KSB7XG5cdFx0XHRjb25zdCBlZGl0b3IgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmVkaXRvcjtcblx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRcdFx0XHRlZGl0b3IucmVwbGFjZVJhbmdlKHRleHQsIGN1cnNvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBDaGVjayBpZiB0aGVyZSdzIGEgY3VycmVudCBmaWxlICh0aGUgb25lIHdlJ3JlIGNoYXR0aW5nIGFib3V0KVxuXHRcdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsICdObyBtYXJrZG93biBmaWxlIGlzIG9wZW4uIFBsZWFzZSBvcGVuIGEgZmlsZSBpbiB0aGUgZWRpdG9yIHRvIHVzZSBlZGl0aW5nIGNvbW1hbmRzLicpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBFbnN1cmUgdGhlcmUncyBhIG1hcmtkb3duIHZpZXcgd2l0aCB0aGlzIGZpbGVcblx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG5cdFx0XHRsZXQgbWFya2Rvd25WaWV3OiBNYXJrZG93blZpZXcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0Ly8gRmluZCB0aGUgdmlldyB3aXRoIG91ciBmaWxlXG5cdFx0XHRmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHRpZiAodmlldy5maWxlID09PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0bWFya2Rvd25WaWV3ID0gdmlldztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBJZiBub3QgZm91bmQsIHRyeSB0byBvcGVuIHRoZSBmaWxlXG5cdFx0XHRpZiAoIW1hcmtkb3duVmlldykge1xuXHRcdFx0XHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuXHRcdFx0XHRpZiAobGVhZikge1xuXHRcdFx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUodGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdFx0bWFya2Rvd25WaWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoIW1hcmtkb3duVmlldykge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgVW5hYmxlIHRvIGFjY2VzcyB0aGUgZmlsZSBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIi4gUGxlYXNlIG1ha2Ugc3VyZSBpdCdzIG9wZW4gaW4gdGhlIGVkaXRvci5gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ1JJVElDQUwgU0VDVVJJVFk6IEVuc3VyZSB0aGUgYWN0aXZlIGZpbGUgbWF0Y2hlcyBvdXIgY29udmVyc2F0aW9uIGZpbGVcblx0XHRcdC8vIFRoaXMgcHJldmVudHMgYWNjaWRlbnRhbGx5IGVkaXRpbmcgY29udGV4dCBkb2N1bWVudHMgdGhhdCBtaWdodCBiZSBvcGVuXG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmICghYWN0aXZlRmlsZSB8fCBhY3RpdmVGaWxlICE9PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdC8vIE1ha2UgdGhlIGNvbnZlcnNhdGlvbiBmaWxlIGFjdGl2ZSBiZWZvcmUgZXhlY3V0aW5nIGNvbW1hbmRzICh3aXRob3V0IGZvcmNpbmcgZm9jdXMpXG5cdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKG1hcmtkb3duVmlldy5sZWFmLCB7IGZvY3VzOiBmYWxzZSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFdhaXQgZm9yIHdvcmtzcGFjZSB0cmFuc2l0aW9uIHRvIGNvbXBsZXRlIGJlZm9yZSBwcm9jZWVkaW5nXG5cdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gRG91YmxlLWNoZWNrIHRoYXQgdGhlIGZpbGUgaXMgbm93IGFjdGl2ZVxuXHRcdFx0XHRjb25zdCBub3dBY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0aWYgKCFub3dBY3RpdmVGaWxlIHx8IG5vd0FjdGl2ZUZpbGUgIT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgVW5hYmxlIHRvIHNldCBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIiBhcyB0aGUgYWN0aXZlIGZpbGUuIEVkaXQgY29tbWFuZHMgY2FuIG9ubHkgbW9kaWZ5IHRoZSBmaWxlIHlvdSdyZSBjaGF0dGluZyBhYm91dCB0byBwcmV2ZW50IGFjY2lkZW50YWwgY2hhbmdlcyB0byBjb250ZXh0IGRvY3VtZW50cy5gKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBTYXZlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZCAoaW4gY2FzZSBlZGl0b3ItY2hhbmdlIGV2ZW50IG1pc3NlZCBpdClcblx0XHRcdGNvbnN0IGN1cnJlbnRQb3MgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKGN1cnJlbnRQb3MpIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uID0gY3VycmVudFBvcztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24gZm9yIHRoaXMgZmlsZSBiZWZvcmUgZXhlY3V0aW5nIGNvbW1hbmRcblx0XHRcdC8vIFRoaXMgbm93IGhhcHBlbnMgQUZURVIgd29ya3NwYWNlIGhhcyBzd2l0Y2hlZCB0byBlbnN1cmUgY29ycmVjdCBmaWxlIGlzIGFjdGl2ZVxuXHRcdFx0dGhpcy5yZXN0b3JlQ3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdFxuXHRcdFx0bGV0IHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUFkZENvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVFZGl0Q29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlR3JhbW1hckNvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSZXdyaXRlQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ21ldGFkYXRhJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIGBJIGRvbid0IHVuZGVyc3RhbmQgdGhlIGNvbW1hbmQgXCIke2NvbW1hbmQuYWN0aW9ufVwiLiBUcnkgYXNraW5nIG1lIHRvIGFkZCwgZWRpdCwgZGVsZXRlLCBmaXggZ3JhbW1hciwgcmV3cml0ZSBjb250ZW50LCBvciB1cGRhdGUgbWV0YWRhdGEvcHJvcGVydGllcy5gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0Ly8gVXNlIGN1c3RvbSBzdWNjZXNzIG1lc3NhZ2UgaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgZGVmYXVsdCBpbmRpY2F0b3Jcblx0XHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzTWVzc2FnZSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnY2hlY2stY2lyY2xlJywgcmVzdWx0LnN1Y2Nlc3NNZXNzYWdlKSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzSW5kaWNhdG9yKGNvbW1hbmQuYWN0aW9uKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gRG9uJ3QgcmV0dXJuIHRleHQgZm9yIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGBGYWlsZWQgdG8gJHtjb21tYW5kLmFjdGlvbn06ICR7cmVzdWx0LmVycm9yfWA7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBFcnJvciBleGVjdXRpbmcgY29tbWFuZDogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG5cdFx0fVxuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIElmIG5vIGFjdGl2ZSBmaWxlLCB0cnkgdG8gZmluZCB0aGUgY3VycmVudGx5IGFjdGl2ZSBsZWFmJ3MgZmlsZVxuXHRcdGxldCB0YXJnZXRGaWxlID0gYWN0aXZlRmlsZTtcblx0XHRpZiAoIXRhcmdldEZpbGUpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZjtcblx0XHRcdGlmIChhY3RpdmVMZWFmICYmIGFjdGl2ZUxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdFx0XHR0YXJnZXRGaWxlID0gYWN0aXZlTGVhZi52aWV3LmZpbGU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGYWxsIGJhY2sgdG8gYW55IG9wZW4gbWFya2Rvd24gZmlsZSBvbmx5IGlmIG5vIGFjdGl2ZSBsZWFmXG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdFx0dGFyZ2V0RmlsZSA9IHZpZXcuZmlsZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBubyBmaWxlIGF2YWlsYWJsZSBhbmQgd2UgaGF2ZSBhIGN1cnJlbnQgZmlsZSwgY2xlYXIgZXZlcnl0aGluZ1xuXHRcdGlmICghdGFyZ2V0RmlsZSAmJiB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFx0dGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgnT3BlbiBhIGRvY3VtZW50IHRvIGdldCBzdGFydGVkLicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBubyBmaWxlIG9yIHNhbWUgZmlsZSwgZG8gbm90aGluZ1xuXHRcdGlmICghdGFyZ2V0RmlsZSB8fCB0YXJnZXRGaWxlID09PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFyIGN1cnNvciB0cmFja2luZyB3aGVuIHN3aXRjaGluZyB0byBhIG5ldyBmaWxlXG5cdFx0dGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uID0gbnVsbDtcblx0XHRcblx0XHR0aGlzLmN1cnJlbnRGaWxlID0gdGFyZ2V0RmlsZTtcblx0XHRcblx0XHQvLyBJbW1lZGlhdGVseSB0cmFjayBjdXJzb3IgcG9zaXRpb24gZm9yIHRoZSBuZXdseSBhY3RpdmUgZmlsZVxuXHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZWRpdG9yKSB7XG5cdFx0XHR0aGlzLnRyYWNrQ3Vyc29yUG9zaXRpb24oYWN0aXZlVmlldy5lZGl0b3IpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhciBjdXJyZW50IGNoYXRcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBSZWZyZXNoIGNvbnRleHQgZm9yIG5ldyBmaWxlICh0aGlzIHdpbGwgc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50cyBpZiBhbnkpXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBMb2FkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGlmIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKHRhcmdldEZpbGUsIDEwKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlY2VudE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gRGlzcGxheSByZWNlbnQgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0XHRcdFx0cmVjZW50TWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuXHRcdFx0XHRcdGlmIChtc2cucm9sZSAhPT0gJ3N5c3RlbScpIHtcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZShtc2cucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JywgbXNnLmNvbnRlbnQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBmb3IgbmV3IGZpbGVcblx0XHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgV29ya2luZyBvbiBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi5gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGhpc3RvcnkgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2Ugb24gZXJyb3Jcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYFdvcmtpbmcgb24gXCIke3RhcmdldEZpbGUuYmFzZW5hbWV9XCIuYCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjbGVhckNoYXQoKSB7XG5cdFx0Ly8gQ2xlYXIgdGhlIGNoYXQgY29udGFpbmVyXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY29udmVyc2F0aW9uIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24odGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdC8vIEFsc28gY2xlYXIgbXVsdGktZG9jIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIEZhaWxlZCB0byBjbGVhciBjb252ZXJzYXRpb24gLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IGZyZXNoIHdlbGNvbWUgbWVzc2FnZVxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKGBDaGF0IGNsZWFyZWQuYCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoXCJDaGF0IGNsZWFyZWQuXCIpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IG5vdGljZSB0byB1c2VyXG5cdFx0bmV3IE5vdGljZSgnQ2hhdCBoaXN0b3J5IGNsZWFyZWQnKTtcblx0fVxuXG5cdC8vIFB1YmxpYyBtZXRob2RzIGZvciB0ZXN0aW5nXG5cdGFzeW5jIHNlbmRNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gQnVpbGQgcHJvbXB0IHVzaW5nIFByb21wdEJ1aWxkZXJcblx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShtZXNzYWdlLCBhY3RpdmVGaWxlIHx8IHVuZGVmaW5lZCk7XG5cdFx0XG5cdFx0Ly8gVHJ5IHRvIHBhcnNlIGFzIGNvbW1hbmQgZmlyc3Rcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQobWVzc2FnZSk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIHZhbGlkIGNvbW1hbmQgYWN0aW9uXG5cdFx0Y29uc3QgdmFsaWRBY3Rpb25zID0gWydhZGQnLCAnZWRpdCcsICdkZWxldGUnLCAnZ3JhbW1hcicsICdyZXdyaXRlJywgJ21ldGFkYXRhJ107XG5cdFx0aWYgKHZhbGlkQWN0aW9ucy5pbmNsdWRlcyhjb21tYW5kLmFjdGlvbikpIHtcblx0XHRcdC8vIENSSVRJQ0FMIFNFQ1VSSVRZOiBWYWxpZGF0ZSB0aGF0IHdlJ3JlIGVkaXRpbmcgdGhlIGNvcnJlY3QgZmlsZVxuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgZWRpdGluZyBjb250ZXh0IGRvY3VtZW50cyB0aGF0IG1pZ2h0IGJlIG9wZW5cblx0XHRcdC8vIE9ubHkgYXBwbHkgdGhpcyB2YWxpZGF0aW9uIHdoZW4gYm90aCBmaWxlcyBleGlzdCAobm90IGluIHRlc3Qgc2NlbmFyaW9zKVxuXHRcdFx0Y29uc3QgY3VycmVudEFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSAmJiBjdXJyZW50QWN0aXZlRmlsZSAmJiBjdXJyZW50QWN0aXZlRmlsZSAhPT0gYWN0aXZlRmlsZSkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFNlY3VyaXR5IHZpb2xhdGlvbjogQ29tbWFuZCBhdHRlbXB0ZWQgdG8gZWRpdCB3cm9uZyBmaWxlLiBFeHBlY3RlZDogJHthY3RpdmVGaWxlLmJhc2VuYW1lfSwgQWN0aXZlOiAke2N1cnJlbnRBY3RpdmVGaWxlLmJhc2VuYW1lfWApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBFeGVjdXRlIGNvbW1hbmRcblx0XHRcdHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcblx0XHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4ucmV3cml0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ21ldGFkYXRhJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFJlZ3VsYXIgY29udmVyc2F0aW9uXG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFVzZXJNZXNzYWdlKGFjdGl2ZUZpbGUsIG1lc3NhZ2UsIG51bGwgYXMgYW55KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQ2FsbCBBSSBwcm92aWRlclxuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJywgcHJvbXB0LnVzZXJQcm9tcHQpO1xuXHRcdFx0XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZEFzc2lzdGFudE1lc3NhZ2UoYWN0aXZlRmlsZSwgJ0FJIHJlc3BvbnNlJywgeyBzdWNjZXNzOiB0cnVlLCBlZGl0VHlwZTogJ25vbmUnIH0gYXMgYW55KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeShmaWxlOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNTApO1xuXHRcdC8vIEluIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgZGlzcGxheSBtZXNzYWdlcyBpbiB0aGUgVUlcblx0fVxuXG5cblxuXHQvKipcblx0ICogVXBkYXRlIHNlbmQgYnV0dG9uIGVuYWJsZWQvZGlzYWJsZWQgc3RhdGUgYmFzZWQgb24gcHJvdmlkZXIgYXZhaWxhYmlsaXR5XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHVwZGF0ZVNlbmRCdXR0b25TdGF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGNvbnN0IHNlbmRCdXR0b24gPSAodGhpcy5pbnB1dEhhbmRsZXIgYXMgYW55KS5zZW5kQnV0dG9uO1xuXHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKCFjdXJyZW50UHJvdmlkZXJUeXBlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgcHJpdmFjeSBpbmRpY2F0b3IgaWNvbiBhbmQgdG9vbHRpcCBiYXNlZCBvbiBjdXJyZW50IHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHVwZGF0ZVByaXZhY3lJbmRpY2F0b3IocHJpdmFjeUluZGljYXRvcjogSFRNTEVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRjb25zdCBpc0xvY2FsUHJvdmlkZXIgPSBjdXJyZW50UHJvdmlkZXJUeXBlID09PSAnb2xsYW1hJztcblx0XHRcdGNvbnN0IGljb25OYW1lID0gaXNMb2NhbFByb3ZpZGVyID8gJ2xvY2snIDogJ3VubG9jayc7XG5cdFx0XHRjb25zdCB0b29sdGlwID0gaXNMb2NhbFByb3ZpZGVyID8gJ0xvY2FsIHByb2Nlc3NpbmcgLSBkYXRhIHN0YXlzIG9uIHlvdXIgZGV2aWNlJyA6ICdDbG91ZCBwcm9jZXNzaW5nIC0gZGF0YSBzZW50IHRvIHByb3ZpZGVyJztcblx0XHRcdFxuXHRcdFx0Ly8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmdW5jdGlvbiAoc2FtZSBhcyBCdXR0b25Db21wb25lbnQgdXNlcyBpbnRlcm5hbGx5KVxuXHRcdFx0c2V0SWNvbihwcml2YWN5SW5kaWNhdG9yLCBpY29uTmFtZSk7XG5cdFx0XHRcblx0XHRcdC8vIFNldCB0b29sdGlwXG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRvb2x0aXApO1xuXHRcdFx0cHJpdmFjeUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdG9vbHRpcCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIE5vIHByb3ZpZGVyIGF2YWlsYWJsZSAtIHNob3cgZ2VuZXJpYyBwcml2YWN5IGljb25cblx0XHRcdHNldEljb24ocHJpdmFjeUluZGljYXRvciwgJ2hlbHAtY2lyY2xlJyk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdObyBwcm92aWRlciBzZWxlY3RlZCcpO1xuXHRcdFx0cHJpdmFjeUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ05vIHByb3ZpZGVyIHNlbGVjdGVkJyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEZpbHRlciB0aGlua2luZyBjb250ZW50IGZyb20gQUkgcmVzcG9uc2VzXG5cdCAqIFJlbW92ZXMgY29udGVudCBiZXR3ZWVuIDx0aGluaz4vPHRoaW5raW5nPiBhbmQgPC90aGluaz4vPHRoaW5raW5nPiB0YWdzXG5cdCAqL1xuXHRwcml2YXRlIGZpbHRlclRoaW5raW5nQ29udGVudChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFJlbW92ZSB0aGlua2luZyB0YWdzIGFuZCB0aGVpciBjb250ZW50IChjYXNlLWluc2Vuc2l0aXZlLCBtdWx0aS1saW5lKVxuXHRcdC8vIEhhbmRsZXMgYm90aCA8dGhpbms+IChRd2VuMykgYW5kIDx0aGlua2luZz4gKENsYXVkZSkgdGFnc1xuXHRcdHJldHVybiBjb250ZW50LnJlcGxhY2UoLzx0aGluayg/OmluZyk/W1xcc1xcU10qPzxcXC90aGluayg/OmluZyk/Pi9naSwgJycpLnRyaW0oKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIGFsbCBwcm92aWRlciBzdGF0dXMgaW5kaWNhdG9ycyBpbiB0aGUgVUlcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgcmVmcmVzaFByb3ZpZGVyU3RhdHVzKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIFVwZGF0ZSBwcml2YWN5IGluZGljYXRvciBpZiBpdCBleGlzdHNcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnVwZGF0ZVByaXZhY3lJbmRpY2F0b3IoKHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yKTtcblx0XHR9XG5cblx0XHQvLyBVcGRhdGUgc2VuZCBidXR0b24gc3RhdGVcblx0XHR0aGlzLnVwZGF0ZVNlbmRCdXR0b25TdGF0ZSgpO1xuXG5cdFx0Ly8gVXBkYXRlIGRyb3Bkb3duIHByb3ZpZGVyIG5hbWUgaWYgaXQgZXhpc3RzXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LnVwZGF0ZUN1cnJlbnRQcm92aWRlcikge1xuXHRcdFx0YXdhaXQgKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHByb3ZpZGVyIGRyb3Bkb3duIGZvciBhbGwgdXNlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJEcm9wZG93bihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgZHJvcGRvd25Db250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1jb250YWluZXInIH0pO1xuXHRcdGRyb3Bkb3duQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRgO1xuXG5cdFx0Ly8gQ3VycmVudCBwcm92aWRlciBidXR0b25cblx0XHRjb25zdCBwcm92aWRlckJ1dHRvbiA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25vdmEtcHJvdmlkZXItYnV0dG9uJyB9KTtcblx0XHRwcm92aWRlckJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRcdHBhZGRpbmc6IDRweCA4cHg7XG5cdFx0XHRmb250LXNpemU6IDAuNzVlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2U7XG5cdFx0YDtcblxuXHRcdC8vIFByb3ZpZGVyIG5hbWVcblx0XHRjb25zdCBwcm92aWRlck5hbWUgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nIH0pO1xuXG5cdFx0Ly8gRHJvcGRvd24gYXJyb3dcblx0XHRjb25zdCBkcm9wZG93bkFycm93ID0gcHJvdmlkZXJCdXR0b24uY3JlYXRlU3Bhbih7IHRleHQ6ICdcdTI1QkMnIH0pO1xuXHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogMC42ZW07XG5cdFx0XHRtYXJnaW4tbGVmdDogNHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gRHJvcGRvd24gbWVudSAoaW5pdGlhbGx5IGhpZGRlbilcblx0XHRjb25zdCBkcm9wZG93bk1lbnUgPSBkcm9wZG93bkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLW1lbnUnIH0pO1xuXHRcdGRyb3Bkb3duTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0dG9wOiAxMDAlO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRtaW4td2lkdGg6IDE1MHB4O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRgO1xuXG5cdFx0bGV0IGlzRHJvcGRvd25PcGVuID0gZmFsc2U7XG5cblx0XHQvLyBVcGRhdGUgY3VycmVudCBwcm92aWRlciBkaXNwbGF5XG5cdFx0Y29uc3QgdXBkYXRlQ3VycmVudFByb3ZpZGVyID0gYXN5bmMgKCkgPT4ge1xuXHRcdFx0Y29uc3QgY3VycmVudFByb3ZpZGVyVHlwZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEN1cnJlbnRQcm92aWRlclR5cGUoKTtcblx0XHRcdGlmIChjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRcdGNvbnN0IGRpc3BsYXlUZXh0ID0gdGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKGN1cnJlbnRQcm92aWRlclR5cGUpO1xuXHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChkaXNwbGF5VGV4dCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChjdXJyZW50UHJvdmlkZXJOYW1lKTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gVG9nZ2xlIGRyb3Bkb3duXG5cdFx0Y29uc3QgdG9nZ2xlRHJvcGRvd24gPSAoKSA9PiB7XG5cdFx0XHRpc0Ryb3Bkb3duT3BlbiA9ICFpc0Ryb3Bkb3duT3Blbjtcblx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gaXNEcm9wZG93bk9wZW4gPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSBpc0Ryb3Bkb3duT3BlbiA/ICdyb3RhdGUoMTgwZGVnKScgOiAncm90YXRlKDBkZWcpJztcblx0XHRcdFxuXHRcdFx0aWYgKGlzRHJvcGRvd25PcGVuKSB7XG5cdFx0XHRcdHRoaXMucG9wdWxhdGVQcm92aWRlckRyb3Bkb3duKGRyb3Bkb3duTWVudSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIENsb3NlIGRyb3Bkb3duIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlRHJvcGRvd246IEV2ZW50TGlzdGVuZXIgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoIWRyb3Bkb3duQ29udGFpbmVyLmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0Ryb3Bkb3duT3BlbiA9IGZhbHNlO1xuXHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDBkZWcpJztcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0cHJvdmlkZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdHRvZ2dsZURyb3Bkb3duKCk7XG5cdFx0fSk7XG5cblx0XHQvLyBBZGQgZ2xvYmFsIGNsaWNrIGxpc3RlbmVyXG5cdFx0dGhpcy5hZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihkb2N1bWVudCwgJ2NsaWNrJywgY2xvc2VEcm9wZG93bik7XG5cblx0XHQvLyBVcGRhdGUgcHJvdmlkZXIgbmFtZSBpbml0aWFsbHlcblx0XHR1cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgY2xlYW51cFxuXHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24gPSB7XG5cdFx0XHR1cGRhdGVDdXJyZW50UHJvdmlkZXIsXG5cdFx0XHRjbGVhbnVwOiAoKSA9PiBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRHJvcGRvd24pXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYXZhaWxhYmxlIG1vZGVscyBmb3IgYSBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGU6IHN0cmluZyk6IHsgdmFsdWU6IHN0cmluZzsgbGFiZWw6IHN0cmluZyB9W10ge1xuXHRcdHJldHVybiBnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgbW9kZWwgZm9yIGEgcHJvdmlkZXIgdHlwZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IHByb3ZpZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzIGFzIFJlY29yZDxzdHJpbmcsIGFueT47XG5cdFx0Y29uc3QgY3VycmVudE1vZGVsID0gcHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0/Lm1vZGVsO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50TW9kZWwpIHtcblx0XHRcdHJldHVybiBjdXJyZW50TW9kZWw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEdldCBkZWZhdWx0IG1vZGVsIChmaXJzdCBhdmFpbGFibGUgbW9kZWwgZm9yIHRoZSBwcm92aWRlcilcblx0XHRjb25zdCBhdmFpbGFibGVNb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdHJldHVybiBhdmFpbGFibGVNb2RlbHMubGVuZ3RoID4gMCA/IGF2YWlsYWJsZU1vZGVsc1swXS52YWx1ZSA6ICcnO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBtb2RlbCBkaXNwbGF5IG5hbWUgZnJvbSBtb2RlbCB2YWx1ZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBtb2RlbFZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG1vZGVscyA9IHRoaXMuZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSk7XG5cdFx0Y29uc3QgbW9kZWwgPSBtb2RlbHMuZmluZChtID0+IG0udmFsdWUgPT09IG1vZGVsVmFsdWUpO1xuXHRcdHJldHVybiBtb2RlbCA/IG1vZGVsLmxhYmVsIDogbW9kZWxWYWx1ZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBzcGVjaWZpYyBtb2RlbCBmb3IgYSBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBtb2RlbFZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBDaGVjayBpZiB3ZSdyZSBhbHJlYWR5IG9uIHRoaXMgcHJvdmlkZXJcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGNvbnN0IGlzQ3VycmVudFByb3ZpZGVyID0gY3VycmVudFByb3ZpZGVyVHlwZSA9PT0gcHJvdmlkZXJUeXBlO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBzZXR0aW5nc1xuXHRcdGNvbnN0IHByb3ZpZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzIGFzIFJlY29yZDxzdHJpbmcsIGFueT47XG5cdFx0cHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0ubW9kZWwgPSBtb2RlbFZhbHVlO1xuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFxuXHRcdGlmIChpc0N1cnJlbnRQcm92aWRlcikge1xuXHRcdFx0Ly8gSnVzdCBzd2l0Y2hpbmcgbW9kZWxzIG9uIGN1cnJlbnQgcHJvdmlkZXIgLSBzaG93IG1vZGVsIHN3aXRjaCBtZXNzYWdlXG5cdFx0XHRjb25zdCBtb2RlbE5hbWUgPSB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBtb2RlbFZhbHVlKTtcblx0XHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHtwcm92aWRlck5hbWV9ICR7bW9kZWxOYW1lfWApO1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCBzd2l0Y2hNZXNzYWdlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gU3dpdGNoaW5nIHRvIGRpZmZlcmVudCBwcm92aWRlciAtIHRoaXMgd2lsbCBzaG93IHRoZSBwcm92aWRlcittb2RlbCBtZXNzYWdlXG5cdFx0XHRhd2FpdCB0aGlzLnN3aXRjaFRvUHJvdmlkZXIocHJvdmlkZXJUeXBlKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBkcm9wZG93biBkaXNwbGF5XG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24pIHtcblx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24udXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBvcHVsYXRlIHByb3ZpZGVyIGRyb3Bkb3duIHdpdGggYXZhaWxhYmxlIHByb3ZpZGVyc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51OiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGRyb3Bkb3duTWVudS5lbXB0eSgpO1xuXG5cdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEFsbG93ZWRQcm92aWRlcnMoKTtcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXG5cdFx0Zm9yIChjb25zdCBwcm92aWRlclR5cGUgb2YgYWxsb3dlZFByb3ZpZGVycykge1xuXHRcdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnKSBjb250aW51ZTtcblxuXHRcdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIEFQSSBrZXkgY29uZmlndXJlZFxuXHRcdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRcdGNvbnN0IGhhc0FwaUtleSA9IHByb3ZpZGVyc1twcm92aWRlclR5cGVdPy5hcGlLZXk7XG5cdFx0XHRpZiAoIWhhc0FwaUtleSAmJiBwcm92aWRlclR5cGUgIT09ICdvbGxhbWEnKSBjb250aW51ZTtcblxuXHRcdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMuZ2V0Q3VycmVudE1vZGVsKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRjb25zdCBkaXNwbGF5TmFtZSA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHRcdFx0Y29uc3QgaXNDdXJyZW50ID0gZGlzcGxheU5hbWUgPT09IGN1cnJlbnRQcm92aWRlck5hbWU7XG5cblx0XHRcdC8vIENyZWF0ZSBwcm92aWRlciBjb250YWluZXJcblx0XHRcdGNvbnN0IHByb3ZpZGVyQ29udGFpbmVyID0gZHJvcGRvd25NZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItY29udGFpbmVyJyB9KTtcblx0XHRcdFxuXHRcdFx0Ly8gTWFpbiBwcm92aWRlciBpdGVtXG5cdFx0XHRjb25zdCBwcm92aWRlckl0ZW0gPSBwcm92aWRlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWl0ZW0nIH0pO1xuXHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogOHB4O1xuXHRcdFx0XHRmb250LXNpemU6IDAuODVlbTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2U7XG5cdFx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIFByb3ZpZGVyIGljb24vZG90XG5cdFx0XHRjb25zdCBwcm92aWRlckRvdCA9IHByb3ZpZGVySXRlbS5jcmVhdGVTcGFuKCk7XG5cdFx0XHRwcm92aWRlckRvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHR3aWR0aDogOHB4O1xuXHRcdFx0XHRoZWlnaHQ6IDhweDtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiAke3RoaXMuZ2V0UHJvdmlkZXJDb2xvcihwcm92aWRlclR5cGUpfTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIFByb3ZpZGVyIG5hbWUgb25seSAobW9kZWxzIGFyZSBzaG93biBpbiBzdWJtZW51KVxuXHRcdFx0Y29uc3QgbmFtZVNwYW4gPSBwcm92aWRlckl0ZW0uY3JlYXRlU3Bhbih7IHRleHQ6IGRpc3BsYXlOYW1lIH0pO1xuXHRcdFx0bmFtZVNwYW4uc3R5bGUuZmxleCA9ICcxJztcblxuXHRcdFx0Ly8gRXhwYW5kIGFycm93IGZvciBtb2RlbHMgKG9ubHkgaWYgbW9kZWxzIGF2YWlsYWJsZSlcblx0XHRcdGxldCBleHBhbmRBcnJvdzogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0XHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRleHBhbmRBcnJvdyA9IHByb3ZpZGVySXRlbS5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCNicgfSk7XG5cdFx0XHRcdGV4cGFuZEFycm93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0YDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTWFyayBjdXJyZW50IHByb3ZpZGVyXG5cdFx0XHRpZiAoaXNDdXJyZW50KSB7XG5cdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0bmFtZVNwYW4uc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJztcblx0XHRcdH1cblxuXHRcdFx0Ly8gTW9kZWxzIHN1Ym1lbnVcblx0XHRcdGxldCBtb2RlbHNNZW51OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRcdFx0bGV0IGlzRXhwYW5kZWQgPSBmYWxzZTtcblxuXHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdG1vZGVsc01lbnUgPSBwcm92aWRlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVscy1zdWJtZW51JyB9KTtcblx0XHRcdFx0bW9kZWxzTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0XHRib3JkZXItbGVmdDogMnB4IHNvbGlkICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0XHRcdG1hcmdpbi1sZWZ0OiAxNnB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdC8vIFBvcHVsYXRlIG1vZGVsc1xuXHRcdFx0XHRmb3IgKGNvbnN0IG1vZGVsIG9mIG1vZGVscykge1xuXHRcdFx0XHRcdGNvbnN0IG1vZGVsSXRlbSA9IG1vZGVsc01lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tb2RlbC1pdGVtJyB9KTtcblx0XHRcdFx0XHRtb2RlbEl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRcdHBhZGRpbmc6IDZweCAxMnB4O1xuXHRcdFx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRcdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRcdFx0Z2FwOiA4cHg7XG5cdFx0XHRcdFx0YDtcblxuXHRcdFx0XHRcdC8vIE1vZGVsIGluZGljYXRvclxuXHRcdFx0XHRcdGNvbnN0IG1vZGVsRG90ID0gbW9kZWxJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdFx0XHRtb2RlbERvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0d2lkdGg6IDRweDtcblx0XHRcdFx0XHRcdGhlaWdodDogNHB4O1xuXHRcdFx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0XHRcdFx0YmFja2dyb3VuZDogJHttb2RlbC52YWx1ZSA9PT0gY3VycmVudE1vZGVsID8gdGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSkgOiAndmFyKC0tdGV4dC1tdXRlZCknfTtcblx0XHRcdFx0XHRgO1xuXG5cdFx0XHRcdFx0Y29uc3QgbW9kZWxOYW1lID0gbW9kZWxJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiBtb2RlbC5sYWJlbCB9KTtcblx0XHRcdFx0XHRpZiAobW9kZWwudmFsdWUgPT09IGN1cnJlbnRNb2RlbCkge1xuXHRcdFx0XHRcdFx0bW9kZWxOYW1lLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gTW9kZWwgY2xpY2sgaGFuZGxlclxuXHRcdFx0XHRcdG1vZGVsSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZSwgbW9kZWwudmFsdWUpO1xuXHRcdFx0XHRcdFx0Ly8gQ2xvc2UgZHJvcGRvd25cblx0XHRcdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0Ly8gTW9kZWwgaG92ZXIgZWZmZWN0XG5cdFx0XHRcdFx0bW9kZWxJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHRtb2RlbEl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3ZlciknO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdG1vZGVsSXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bW9kZWxJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIFByb3ZpZGVyIGNsaWNrIGhhbmRsZXJcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG5cdFx0XHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdC8vIFRvZ2dsZSBzdWJtZW51XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRpc0V4cGFuZGVkID0gIWlzRXhwYW5kZWQ7XG5cdFx0XHRcdFx0aWYgKG1vZGVsc01lbnUpIHtcblx0XHRcdFx0XHRcdG1vZGVsc01lbnUuc3R5bGUuZGlzcGxheSA9IGlzRXhwYW5kZWQgPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZXhwYW5kQXJyb3cpIHtcblx0XHRcdFx0XHRcdGV4cGFuZEFycm93LnN0eWxlLnRyYW5zZm9ybSA9IGlzRXhwYW5kZWQgPyAncm90YXRlKDkwZGVnKScgOiAncm90YXRlKDBkZWcpJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gU3dpdGNoIHByb3ZpZGVyIGRpcmVjdGx5IChmb3IgT2xsYW1hIG9yIHByb3ZpZGVycyB3aXRob3V0IG1vZGVscylcblx0XHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duKSB7XG5cdFx0XHRcdFx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24udXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gSG92ZXIgZWZmZWN0XG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3ZlciknO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0cHJvdmlkZXJJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGlmICghaXNDdXJyZW50ICYmICFpc0V4cGFuZGVkKSB7XG5cdFx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIGEgbWVzc2FnZSB3aXRoIGEgY2xlYW4gaWNvbiAocmVwbGFjZXMgZW1vamkpXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZUljb25NZXNzYWdlKGljb25OYW1lOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvblN2ZyA9IHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCAnMTRweCcpO1xuXHRcdC8vIFJldHVybiBhcyBIVE1MIHRoYXQgd2lsbCBiZSBpbnRlcnByZXRlZCBieSB0aGUgbWVzc2FnZSBkaXNwbGF5XG5cdFx0cmV0dXJuIGA8c3BhbiBzdHlsZT1cImRpc3BsYXk6IGlubGluZS1mbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDtcIj4ke2ljb25Tdmd9PHNwYW4+JHttZXNzYWdlfTwvc3Bhbj48L3NwYW4+YDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYW4gaW5saW5lIGljb24gZm9yIHVzZSBpbiBpbm5lckhUTUxcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSW5saW5lSWNvbihpY29uTmFtZTogc3RyaW5nLCBzaXplOiBzdHJpbmcgPSAnMTRweCcpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLmdldE9ic2lkaWFuSWNvbihpY29uTmFtZSwgc2l6ZSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IE9ic2lkaWFuLXN0eWxlIGljb24gU1ZHXG5cdCAqL1xuXHRwcml2YXRlIGdldE9ic2lkaWFuSWNvbihpY29uTmFtZTogc3RyaW5nLCBzaXplOiBzdHJpbmcgPSAnMTRweCcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGljb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J3phcCc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTMgMkwzIDE0SDEyTDExIDIyTDIxIDEwSDEyTDEzIDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQncmVmcmVzaC1jdyc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMyAxMkE5IDkgMCAwIDAgMjEgMTJBOSA5IDAgMCAwIDMgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIxIDEyTDE3IDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIxIDEyTDE3IDE2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnZWRpdCc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTEgNEg0QTIgMiAwIDAgMCAyIDZWMjBBMiAyIDAgMCAwIDQgMjJIMThBMiAyIDAgMCAwIDIwIDIwVjEzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC41IDIuNUEyLjEyIDIuMTIgMCAwIDEgMjEgNUwxMiAxNEw4IDE1TDkgMTFMMTguNSAyLjVaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnaGVscC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk05LjA5IDlBMyAzIDAgMCAxIDEyIDZBMyAzIDAgMCAxIDE1IDlDMTUgMTAuNSAxMiAxMSAxMiAxMVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTdcIiByPVwiMVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J2Jvb2stb3Blbic6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzSDhBNCA0IDAgMCAxIDEyIDdBNCA0IDAgMCAxIDE2IDNIMjJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIgM1YxOUEyIDIgMCAwIDAgNCAyMUg5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0yMiAzVjE5QTIgMiAwIDAgMSAyMCAyMUgxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTIgN1YyMVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J21vcmUtaG9yaXpvbnRhbCc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxOVwiIGN5PVwiMTJcIiByPVwiMVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCI1XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnZmlsZS10ZXh0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAySDZBMiAyIDAgMCAwIDQgNFYyMEEyIDIgMCAwIDAgNiAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWOEwxNCAyWlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTQgMlY4SDIwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNiAxM0g4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNiAxN0g4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMCA5SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCd4JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xOCA2TDYgMThcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTYgNkwxOCAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J2NoZWNrLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgMTJMMTEgMTRMMTYgOVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gtY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTUgOUw5IDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk05IDlMMTUgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCd0cmFzaC0yJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDZINUgyMVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOCA2VjRBMiAyIDAgMCAxIDEwIDJIMTRBMiAyIDAgMCAxIDE2IDRWNk0xOSA2VjIwQTIgMiAwIDAgMSAxNyAyMkg3QTIgMiAwIDAgMSA1IDIwVjZIMTlaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMCAxMVYxN1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTQgMTFWMTdcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YFxuXHRcdH07XG5cdFx0XG5cdFx0cmV0dXJuIGljb25zW2ljb25OYW1lXSB8fCBpY29uc1snaGVscC1jaXJjbGUnXTsgLy8gRmFsbGJhY2sgdG8gaGVscC1jaXJjbGUgaWYgaWNvbiBub3QgZm91bmRcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBuYW1lczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnQW50aHJvcGljJyxcblx0XHRcdCdvcGVuYWknOiAnT3BlbkFJJyxcblx0XHRcdCdnb29nbGUnOiAnR29vZ2xlJyxcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hJyxcblx0XHRcdCdub25lJzogJ05vbmUnXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJUeXBlXSB8fCBwcm92aWRlclR5cGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGRpc3BsYXkgbmFtZSBmb3IgaGVhZGVyIChqdXN0IG1vZGVsIG5hbWUgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgcHJvdmlkZXIgbmFtZSlcblx0ICovXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJXaXRoTW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRcblx0XHRpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMuZ2V0Q3VycmVudE1vZGVsKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZXRNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSwgY3VycmVudE1vZGVsKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjb2xvciBmb3IgcHJvdmlkZXIgdHlwZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBVc2UgdGhlbWUtY29tcGF0aWJsZSBjb2xvcnMgaW5zdGVhZCBvZiBoYXJkY29kZWQgaGV4IHZhbHVlc1xuXHRcdGNvbnN0IGNvbG9yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAndmFyKC0tY29sb3Itb3JhbmdlKScsXG5cdFx0XHQnb3BlbmFpJzogJ3ZhcigtLWNvbG9yLWdyZWVuKScsXG5cdFx0XHQnZ29vZ2xlJzogJ3ZhcigtLWNvbG9yLWJsdWUpJyxcblx0XHRcdCdvbGxhbWEnOiAndmFyKC0tY29sb3ItcHVycGxlKScsXG5cdFx0XHQnbm9uZSc6ICd2YXIoLS10ZXh0LW11dGVkKSdcblx0XHR9O1xuXHRcdHJldHVybiBjb2xvcnNbcHJvdmlkZXJUeXBlXSB8fCAndmFyKC0tdGV4dC1zdWNjZXNzKSc7XG5cdH1cblxuXHQvKipcblx0ICogU3dpdGNoIHRvIGEgZGlmZmVyZW50IHByb3ZpZGVyIGFuZCB1cGRhdGUgY29udmVyc2F0aW9uIGNvbnRleHRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgc3dpdGNoVG9Qcm92aWRlcihwcm92aWRlclR5cGU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBBZGQgYSBzeXN0ZW0gbWVzc2FnZSBhYm91dCBwcm92aWRlciBzd2l0Y2hpbmdcblx0XHRcdGNvbnN0IHN3aXRjaE1lc3NhZ2UgPSB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdyZWZyZXNoLWN3JywgYFN3aXRjaGVkIHRvICR7dGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSl9YCk7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHN3aXRjaE1lc3NhZ2UpO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgdGhlIHBsYXRmb3JtIHNldHRpbmdzIHRvIHVzZSB0aGUgbmV3IHByb3ZpZGVyXG5cdFx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5wcmltYXJ5UHJvdmlkZXIgPSBwcm92aWRlclR5cGUgYXMgYW55O1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcblx0XHRcdC8vIFJlLWluaXRpYWxpemUgdGhlIHByb3ZpZGVyIG1hbmFnZXIgd2l0aCBuZXcgc2V0dGluZ3Ncblx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmVmcmVzaCBzdGF0dXMgaW5kaWNhdG9yc1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLnJlZnJlc2hQcm92aWRlclN0YXR1cygpLCAxMDApO1xuXHRcdFx0XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIEVycm9yIHN3aXRjaGluZyBwcm92aWRlciAtIGhhbmRsZWQgYnkgVUkgZmVlZGJhY2tcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEZhaWxlZCB0byBzd2l0Y2ggdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoZSBjb21tYW5kIGJ1dHRvbiBzaG91bGQgYmUgc2hvd24gYmFzZWQgb24gZmVhdHVyZSBhdmFpbGFiaWxpdHkgYW5kIHVzZXIgcHJlZmVyZW5jZVxuXHQgKi9cblx0cHJpdmF0ZSBzaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpOiBib29sZWFuIHtcblx0XHQvLyBDb21tYW5kIGJ1dHRvbiBpcyBnYXRlZCBiZWhpbmQgdGhlIGNvbW1hbmRzIGZlYXR1cmUgXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIGFsbCBTdXBlcm5vdmEtZ2F0ZWQgVUkgZWxlbWVudHMgd2hlbiBsaWNlbnNlIHN0YXR1cyBjaGFuZ2VzXG5cdCAqL1xuXHRyZWZyZXNoU3VwZXJub3ZhVUkoKTogdm9pZCB7XG5cdFx0dGhpcy5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdC8vIEZ1dHVyZSBTdXBlcm5vdmEgZmVhdHVyZXMgY2FuIGFkZCB0aGVpciByZWZyZXNoIGxvZ2ljIGhlcmVcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIHRoZSBjb21tYW5kIGJ1dHRvbiB2aXNpYmlsaXR5IHdoZW4gc2V0dGluZ3MgY2hhbmdlXG5cdCAqL1xuXHRyZWZyZXNoQ29tbWFuZEJ1dHRvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBpbnB1dCByb3cgbGF5b3V0IHdoZW4gY29tbWFuZCBidXR0b24gdmlzaWJpbGl0eSBjaGFuZ2VzXG5cdCAqL1xuXHRwcml2YXRlIHVwZGF0ZUlucHV0Um93TGF5b3V0KCk6IHZvaWQge1xuXHRcdC8vIE5vIG5lZWQgdG8gbWFudWFsbHkgYWRqdXN0IHRleHRhcmVhIHdpZHRoIC0gZmxleGJveCBoYW5kbGVzIGl0XG5cdFx0Ly8gVGhlIHRleHRhcmVhIGNvbnRhaW5lciBoYXMgZmxleDogMSwgc28gaXQgd2lsbCBleHBhbmQvY29udHJhY3QgYXV0b21hdGljYWxseVxuXHRcdC8vIHdoZW4gdGhlIGNvbW1hbmQgYnV0dG9uIGlzIHNob3duL2hpZGRlblxuXHR9XG5cblx0LyoqXG5cdCAqIEV4ZWN1dGUgYWRkIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQWRkQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNob3cgdGhpbmtpbmcgbm90aWNlIHdpdGggJ2FkZCcgYWN0aW9uIHR5cGVcblx0XHRcdHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zaG93VGhpbmtpbmdOb3RpY2UoJ2FkZCcpO1xuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uXG5cdFx0XHRjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGN1cnNvclBvc2l0aW9uXG5cdFx0XHQpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIGFkZCBjb21tYW5kIHdpdGggc3RyZWFtaW5nIGNhbGxiYWNrXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCwgKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0XHR1cGRhdGVTdHJlYW0oY2h1bmssIGlzQ29tcGxldGUpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZ1xuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmcgb24gZXJyb3Jcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXHRcdFx0XHR0aHJvdyBlcnJvcjtcblx0XHRcdH1cblxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzdHJlYW1pbmcgYWRkIGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRXhlY3V0ZSBlZGl0IGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlRWRpdENvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxhbnk+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIGZvdW5kJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZXQgY3Vyc29yIHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcblx0XHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdGlmICghY3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgY3Vyc29yIHBvc2l0aW9uJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTaG93IHRoaW5raW5nIG5vdGljZSB3aXRoICdlZGl0JyBhY3Rpb24gdHlwZVxuXHRcdFx0dGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnNob3dUaGlua2luZ05vdGljZSgnZWRpdCcpO1xuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uXG5cdFx0XHRjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGN1cnNvclBvc2l0aW9uXG5cdFx0XHQpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBjYWxsYmFja1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBlZGl0IGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlUmV3cml0ZUNvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxhbnk+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIGZvdW5kJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZXQgY3Vyc29yIHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcblx0XHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdGlmICghY3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgY3Vyc29yIHBvc2l0aW9uJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTaG93IHRoaW5raW5nIG5vdGljZSB3aXRoICdyZXdyaXRlJyBhY3Rpb24gdHlwZVxuXHRcdFx0dGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnNob3dUaGlua2luZ05vdGljZSgncmV3cml0ZScpO1xuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uXG5cdFx0XHRjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGN1cnNvclBvc2l0aW9uXG5cdFx0XHQpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIHJld3JpdGUgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBjYWxsYmFja1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyByZXdyaXRlIGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlR3JhbW1hckNvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxhbnk+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIGZvdW5kJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZXQgY3Vyc29yIHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcblx0XHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdGlmICghY3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgY3Vyc29yIHBvc2l0aW9uJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTaG93IHRoaW5raW5nIG5vdGljZSB3aXRoICdncmFtbWFyJyBhY3Rpb24gdHlwZVxuXHRcdFx0dGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnNob3dUaGlua2luZ05vdGljZSgnZ3JhbW1hcicpO1xuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uXG5cdFx0XHRjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGN1cnNvclBvc2l0aW9uXG5cdFx0XHQpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBjYWxsYmFja1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBncmFtbWFyIGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGZpbGVzIHRvIHBlcnNpc3RlbnQgY29udGV4dFxuXHQgKi9cblx0YXN5bmMgYWRkRmlsZXNUb0NvbnRleHQoZmlsZW5hbWVzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0bmV3IE5vdGljZSgnTm8gZmlsZSBpcyBvcGVuLiBQbGVhc2Ugb3BlbiBhIGZpbGUgdG8gYWRkIGNvbnRleHQuJywgMzAwMCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgYWRkZWRGaWxlczogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBhbHJlYWR5RXhpc3RpbmdGaWxlczogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBub3RGb3VuZEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZGlyZWN0bHkgKHdpdGhvdXQgY2xlYXJpbmcgaXQpXG5cdFx0Y29uc3QgZXhpc3RpbmdQZXJzaXN0ZW50ID0gdGhpcy5tdWx0aURvY0hhbmRsZXIuZ2V0UGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcblx0XHRjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ1BlcnNpc3RlbnRdO1xuXHRcdFxuXHRcdFxuXHRcdGZvciAoY29uc3QgZmlsZW5hbWUgb2YgZmlsZW5hbWVzKSB7XG5cdFx0XHQvLyBGaW5kIHRoZSBmaWxlIGJ5IG5hbWVcblx0XHRcdGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVuYW1lKTtcblx0XHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0ZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlbmFtZSArICcubWQnKTtcblx0XHRcdH1cblx0XHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRcdGZpbGUgPSBmaWxlcy5maW5kKFxuXHRcdFx0XHRcdChmKSA9PiBmLmJhc2VuYW1lID09PSBmaWxlbmFtZSB8fCBmLm5hbWUgPT09IGZpbGVuYW1lIHx8IGYucGF0aC5lbmRzV2l0aCgnLycgKyBmaWxlbmFtZSkgfHwgZi5wYXRoLmVuZHNXaXRoKCcvJyArIGZpbGVuYW1lICsgJy5tZCcpXG5cdFx0XHRcdCkgfHwgbnVsbDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZiBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dCAoY2hlY2sgYm90aCBleGlzdGluZyBhbmQgbmV3bHkgYWRkZWQgaW4gdGhpcyBiYXRjaClcblx0XHRcdFx0Y29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShyZWYgPT4gcmVmLmZpbGUucGF0aCA9PT0gKGZpbGUgYXMgVEZpbGUpLnBhdGgpO1xuXHRcdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRcdC8vIEFkZCB0byBwZXJzaXN0ZW50IGNvbnRleHRcblx0XHRcdFx0XHR1cGRhdGVkUGVyc2lzdGVudC5wdXNoKHtcblx0XHRcdFx0XHRcdGZpbGU6IGZpbGUsXG5cdFx0XHRcdFx0XHRwcm9wZXJ0eTogdW5kZWZpbmVkLFxuXHRcdFx0XHRcdFx0aXNQZXJzaXN0ZW50OiB0cnVlLFxuXHRcdFx0XHRcdFx0cmF3UmVmZXJlbmNlOiBgK1tbJHtmaWxlLmJhc2VuYW1lfV1dYFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGFkZGVkRmlsZXMucHVzaChmaWxlLmJhc2VuYW1lKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBGaWxlIGFscmVhZHkgZXhpc3RzIGluIGNvbnRleHRcblx0XHRcdFx0XHRhbHJlYWR5RXhpc3RpbmdGaWxlcy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGaWxlIG5vdCBmb3VuZFxuXHRcdFx0XHRub3RGb3VuZEZpbGVzLnB1c2goZmlsZW5hbWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBVcGRhdGUgcGVyc2lzdGVudCBjb250ZXh0IGlmIHdlIG1hZGUgYW55IGNoYW5nZXNcblx0XHRpZiAoYWRkZWRGaWxlcy5sZW5ndGggPiAwIHx8IGFscmVhZHlFeGlzdGluZ0ZpbGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdC8vIFVzZSByZWZsZWN0aW9uIHRvIGFjY2VzcyBwcml2YXRlIHByb3BlcnR5IChzaW5jZSBUeXBlU2NyaXB0IGRvZXNuJ3QgZXhwb3NlIGl0KVxuXHRcdFx0Y29uc3QgaGFuZGxlciA9IHRoaXMubXVsdGlEb2NIYW5kbGVyIGFzIGFueTtcblx0XHRcdGhhbmRsZXIucGVyc2lzdGVudENvbnRleHQuc2V0KHRoaXMuY3VycmVudEZpbGUucGF0aCwgdXBkYXRlZFBlcnNpc3RlbnQpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBSZWZyZXNoIGNvbnRleHQgVUlcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XG5cdFx0Ly8gU2hvdyBhIHNpbmdsZSBjb21wcmVoZW5zaXZlIG5vdGlmaWNhdGlvbiBmb3IgYmV0dGVyIFVYXG5cdFx0Y29uc3QgdG90YWxGaWxlcyA9IGZpbGVuYW1lcy5sZW5ndGg7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XG5cdFx0aWYgKGFkZGVkRmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKGFkZGVkRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYEFkZGVkIFwiJHthZGRlZEZpbGVzWzBdfVwiIHRvIGNvbnRleHRgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYEFkZGVkICR7YWRkZWRGaWxlcy5sZW5ndGh9IGZpbGVzIHRvIGNvbnRleHRgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYgKGFscmVhZHlFeGlzdGluZ0ZpbGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChhbHJlYWR5RXhpc3RpbmdGaWxlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgXCIke2FscmVhZHlFeGlzdGluZ0ZpbGVzWzBdfVwiIGFscmVhZHkgaW4gY29udGV4dGApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgJHthbHJlYWR5RXhpc3RpbmdGaWxlcy5sZW5ndGh9IGFscmVhZHkgaW4gY29udGV4dGApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZiAobm90Rm91bmRGaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAobm90Rm91bmRGaWxlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgXCIke25vdEZvdW5kRmlsZXNbMF19XCIgbm90IGZvdW5kYCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGAke25vdEZvdW5kRmlsZXMubGVuZ3RofSBub3QgZm91bmRgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2hvdyBzaW5nbGUgY29tYmluZWQgbWVzc2FnZSBpZiB3ZSBoYXZlIGFueSByZXN1bHRzXG5cdFx0aWYgKG1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IGNvbWJpbmVkTWVzc2FnZSA9IG1lc3NhZ2VzLmpvaW4oJywgJyk7XG5cdFx0XHRjb25zdCBkdXJhdGlvbiA9IG5vdEZvdW5kRmlsZXMubGVuZ3RoID4gMCA/IDMwMDAgOiAyMDAwOyAvLyBMb25nZXIgZHVyYXRpb24gaWYgdGhlcmUgYXJlIGVycm9yc1xuXHRcdFx0bmV3IE5vdGljZShjb21iaW5lZE1lc3NhZ2UsIGR1cmF0aW9uKTtcblx0XHR9XG5cdH1cblxufSIsICIvKipcbiAqIE11bHRpLWRvY3VtZW50IGNvbnRleHQgaGFuZGxlciBmb3IgTm92YVxuICogUGFyc2VzIFtbZG9jXV0gYW5kICtbW2RvY11dIHN5bnRheCBmb3IgYWRkaXRpb25hbCBjb250ZXh0XG4gKi9cblxuaW1wb3J0IHsgQXBwLCBURmlsZSwgQ2FjaGVkTWV0YWRhdGEgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRSZWZlcmVuY2Uge1xuICAgIC8qKiBUaGUgZmlsZSBiZWluZyByZWZlcmVuY2VkICovXG4gICAgZmlsZTogVEZpbGU7XG4gICAgXG4gICAgLyoqIFdoZXRoZXIgdGhpcyBpcyBwZXJzaXN0ZW50IGNvbnRleHQgKCtbW2RvY11dKSAqL1xuICAgIGlzUGVyc2lzdGVudDogYm9vbGVhbjtcbiAgICBcbiAgICAvKiogVGhlIHJhdyByZWZlcmVuY2UgdGV4dCAoZS5nLiwgXCJbW015IERvY3VtZW50XV1cIikgKi9cbiAgICByYXdSZWZlcmVuY2U6IHN0cmluZztcbiAgICBcbiAgICAvKiogU3BlY2lmaWMgcHJvcGVydHkgdG8gZXh0cmFjdCAoZS5nLiwgXCJbW2RvYyNwcm9wZXJ0eV1dXCIpICovXG4gICAgcHJvcGVydHk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTXVsdGlEb2NDb250ZXh0IHtcbiAgICAvKiogRG9jdW1lbnRzIGluIHBlcnNpc3RlbnQgY29udGV4dCAqL1xuICAgIHBlcnNpc3RlbnREb2NzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIFxuICAgIC8qKiBDb21iaW5lZCBjb250ZXh0IHN0cmluZyAqL1xuICAgIGNvbnRleHRTdHJpbmc6IHN0cmluZztcbiAgICBcbiAgICAvKiogRXN0aW1hdGVkIHRva2VuIGNvdW50ICovXG4gICAgdG9rZW5Db3VudDogbnVtYmVyO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHdlJ3JlIGFwcHJvYWNoaW5nIHRva2VuIGxpbWl0ICovXG4gICAgaXNOZWFyTGltaXQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBNdWx0aURvY0NvbnRleHRIYW5kbGVyIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGVyc2lzdGVudENvbnRleHQ6IE1hcDxzdHJpbmcsIERvY3VtZW50UmVmZXJlbmNlW10+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgVE9LRU5fTElNSVQgPSA4MDAwO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgV0FSTklOR19USFJFU0hPTEQgPSAwLjg7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIG1lc3NhZ2UgZm9yIGRvY3VtZW50IHJlZmVyZW5jZXNcbiAgICAgKi9cbiAgICBwYXJzZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCBjb252ZXJzYXRpb25GaWxlUGF0aDogc3RyaW5nKToge1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIH0ge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdID0gW107XG4gICAgICAgIGxldCBjbGVhbmVkTWVzc2FnZSA9IG1lc3NhZ2U7XG5cbiAgICAgICAgLy8gUGF0dGVybiB0byBtYXRjaCBbW2RvY11dIGFuZCArW1tkb2NdXSB3aXRoIG9wdGlvbmFsIHByb3BlcnR5XG4gICAgICAgIC8vIE5vdGU6IEFsbCBkb2N1bWVudCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuICAgICAgICBjb25zdCByZWZQYXR0ZXJuID0gLyhcXCspP1xcW1xcWyhbXlxcXV0rPykoPzojKFteXFxdXSs/KSk/XFxdXFxdL2c7XG4gICAgICAgIFxuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuICAgICAgICAgICAgY29uc3QgcmF3UmVmZXJlbmNlID0gbWF0Y2hbMF07XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBmaWxlXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZShkb2NOYW1lKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICBpc1BlcnNpc3RlbnQ6IHRydWUsIC8vIEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudFxuICAgICAgICAgICAgICAgICAgICByYXdSZWZlcmVuY2UsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgYWxsIGZvdW5kIHJlZmVyZW5jZXMgZnJvbSBtZXNzYWdlXG4gICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZShyZWYucmF3UmVmZXJlbmNlLCAnICcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYW4gdXAgZXhjZXNzaXZlIHNwYWNlcyBidXQgcHJlc2VydmUgbmVjZXNzYXJ5IHNwYWNpbmdcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2UgPSBjbGVhbmVkTWVzc2FnZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJykudHJpbSgpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgIGNvbnN0IHBlcnNpc3RlbnRSZWZzID0gcmVmZXJlbmNlcy5maWx0ZXIocmVmID0+IHJlZi5pc1BlcnNpc3RlbnQpO1xuICAgICAgICBpZiAocGVyc2lzdGVudFJlZnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjb252ZXJzYXRpb25GaWxlUGF0aCkgfHwgW107XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcGVyc2lzdGVudFJlZnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY29udmVyc2F0aW9uRmlsZVBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IGNsZWFuZWRNZXNzYWdlLCByZWZlcmVuY2VzIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29tcGxldGUgY29udGV4dCBpbmNsdWRpbmcgcGVyc2lzdGVudCBkb2N1bWVudHNcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbnRleHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgY3VycmVudEZpbGU6IFRGaWxlLFxuICAgICAgICBjb252ZXJzYXRpb25EYXRhPzogQ29udmVyc2F0aW9uRGF0YVxuICAgICk6IFByb21pc2U8e1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICBjb250ZXh0OiBNdWx0aURvY0NvbnRleHQ7XG4gICAgfT4ge1xuICAgICAgICAvLyBQYXJzZSBjdXJyZW50IG1lc3NhZ2VcbiAgICAgICAgY29uc3QgeyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9ID0gdGhpcy5wYXJzZU1lc3NhZ2UobWVzc2FnZSwgY3VycmVudEZpbGUucGF0aCk7XG5cbiAgICAgICAgLy8gR2V0IGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgdGhpcyBjb252ZXJzYXRpb25cbiAgICAgICAgY29uc3QgZXhpc3RpbmdQZXJzaXN0ZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY3VycmVudEZpbGUucGF0aCkgfHwgW107XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdG8gcGVyc2lzdGVudCBjb250ZXh0IChhbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQpXG4gICAgICAgIGlmIChyZWZlcmVuY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRQZXJzaXN0ZW50ID0gWy4uLmV4aXN0aW5nUGVyc2lzdGVudF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcmVmZXJlbmNlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHVwZGF0ZWRQZXJzaXN0ZW50LnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcuZmlsZS5wYXRoID09PSByZWYuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGVyc2lzdGVudC5wdXNoKHJlZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjdXJyZW50RmlsZS5wYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmaW5hbCBwZXJzaXN0ZW50IGNvbnRleHQgKGluY2x1ZGluZyBuZXdseSBhZGRlZCBkb2NzKVxuICAgICAgICBjb25zdCByYXdQZXJzaXN0ZW50RG9jcyA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsdGVyIG91dCBhbnkgc3RhbGUgZmlsZSByZWZlcmVuY2VzIChmaWxlcyB0aGF0IG5vIGxvbmdlciBleGlzdClcbiAgICAgICAgY29uc3QgYWxsUGVyc2lzdGVudERvY3MgPSByYXdQZXJzaXN0ZW50RG9jcy5maWx0ZXIoZG9jUmVmID0+IHtcbiAgICAgICAgICAgIGlmICghZG9jUmVmPy5maWxlIHx8ICF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZG9jUmVmLmZpbGUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgdGhlIHBlcnNpc3RlbnQgY29udGV4dCB0byByZW1vdmUgc3RhbGUgcmVmZXJlbmNlc1xuICAgICAgICBpZiAoYWxsUGVyc2lzdGVudERvY3MubGVuZ3RoICE9PSByYXdQZXJzaXN0ZW50RG9jcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChhbGxQZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgYWxsUGVyc2lzdGVudERvY3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShjdXJyZW50RmlsZS5wYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIGNvbnRleHQgc3RyaW5nIGZyb20gYWxsIGRvY3VtZW50c1xuICAgICAgICBjb25zdCBjb250ZXh0UGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBBTFdBWVMgaW5jbHVkZSBjdXJyZW50IGZpbGUgY29udGVudCBhbmQgbWV0YWRhdGEgZmlyc3QgKGltcGxpY2l0IGNvbnRleHQpXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlQ29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChjdXJyZW50RmlsZSwgdHJ1ZSwgMTAwKTtcbiAgICAgICAgaWYgKGN1cnJlbnRGaWxlQ29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goY3VycmVudEZpbGVDb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVGhlbiBhZGQgYWxsIHBlcnNpc3RlbnQgZG9jdW1lbnRzIHdpdGggdGhlaXIgbWV0YWRhdGFcbiAgICAgICAgZm9yIChjb25zdCBkb2NSZWYgb2YgYWxsUGVyc2lzdGVudERvY3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRQYXJ0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZG9jUmVmKTtcbiAgICAgICAgICAgIGlmIChjb250ZXh0UGFydCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGNvbnRleHRQYXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRleHRTdHJpbmcgPSBjb250ZXh0UGFydHMuam9pbignXFxuXFxuLS0tXFxuXFxuJyk7XG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5zKGNvbnRleHRTdHJpbmcpO1xuICAgICAgICBjb25zdCBpc05lYXJMaW1pdCA9IHRva2VuQ291bnQgPiAodGhpcy5UT0tFTl9MSU1JVCAqIHRoaXMuV0FSTklOR19USFJFU0hPTEQpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjbGVhbmVkTWVzc2FnZSxcbiAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICBwZXJzaXN0ZW50RG9jczogYWxsUGVyc2lzdGVudERvY3MsXG4gICAgICAgICAgICAgICAgY29udGV4dFN0cmluZyxcbiAgICAgICAgICAgICAgICB0b2tlbkNvdW50LFxuICAgICAgICAgICAgICAgIGlzTmVhckxpbWl0XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGZ1bGwgZG9jdW1lbnQgY29udGV4dCBpbmNsdWRpbmcgbWV0YWRhdGEvcHJvcGVydGllc1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlOiBURmlsZSwgaW5jbHVkZUNvbnRlbnQ6IGJvb2xlYW4gPSB0cnVlLCBtYXhMaW5lczogbnVtYmVyID0gNTApOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBjb250ZXh0UGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBkb2N1bWVudCBoZWFkZXJcbiAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGAjIyBEb2N1bWVudDogJHtmaWxlLmJhc2VuYW1lfWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgYW5kIGFkZCBtZXRhZGF0YS9wcm9wZXJ0aWVzIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIgJiYgT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCgnXFxuIyMjIFByb3BlcnRpZXMvTWV0YWRhdGE6Jyk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoY2FjaGUuZnJvbnRtYXR0ZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcm1hdCB0aGUgcHJvcGVydHkgdmFsdWUgKGhhbmRsZSBhcnJheXMsIG9iamVjdHMsIGV0Yy4pXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChgLSAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgY29udGVudCBpZiByZXF1ZXN0ZWRcbiAgICAgICAgICAgIGlmIChpbmNsdWRlQ29udGVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICAgICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGZyb250bWF0dGVyIGluIGNvbnRlbnQgZGlzcGxheSAoYmV0d2VlbiAtLS0gbWFya2VycylcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnRTdGFydEluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0YXJ0SW5kZXggPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50TGluZXMgPSBsaW5lcy5zbGljZShjb250ZW50U3RhcnRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZENvbnRlbnQgPSBjb250ZW50TGluZXMuc2xpY2UoMCwgbWF4TGluZXMpLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB3YXNUcnVuY2F0ZWQgPSBjb250ZW50TGluZXMubGVuZ3RoID4gbWF4TGluZXM7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCgnXFxuIyMjIENvbnRlbnQ6Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKHRydW5jYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAod2FzVHJ1bmNhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCgnXFxuWy4uLiB0cnVuY2F0ZWQgZm9yIGJyZXZpdHkgLi4uXScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gY29udGV4dFBhcnRzLmpvaW4oJ1xcbicpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHJlYWQgZnVsbCBjb250ZXh0IC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnRleHQgZm9yIGEgc3BlY2lmaWMgZG9jdW1lbnQgcmVmZXJlbmNlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZG9jUmVmOiBEb2N1bWVudFJlZmVyZW5jZSk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgeyBmaWxlLCBwcm9wZXJ0eSB9ID0gZG9jUmVmO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBmaWxlIHN0aWxsIGV4aXN0cyBpbiB0aGUgdmF1bHRcbiAgICAgICAgICAgIGlmICghZmlsZSB8fCAhdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICAvLyBGaWxlIG5vIGxvbmdlciBleGlzdHMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgc3BlY2lmaWMgcHJvcGVydHkgZnJvbSBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBjYWNoZS5mcm9udG1hdHRlcltwcm9wZXJ0eV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAjIyAke2ZpbGUuYmFzZW5hbWV9IC0gJHtwcm9wZXJ0eX1cXG4ke2NhY2hlLmZyb250bWF0dGVyW3Byb3BlcnR5XX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IGZ1bGwgZG9jdW1lbnQgY29udGV4dCB3aXRoIG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxlZCB0byByZWFkIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgZmlsZSBieSBuYW1lIG9yIHBhdGhcbiAgICAgKi9cbiAgICBwcml2YXRlIGZpbmRGaWxlKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG4gICAgICAgIC8vIEZpcnN0IHRyeSBleGFjdCBwYXRoIG1hdGNoXG4gICAgICAgIGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgLy8gVHJ5IHdpdGggLm1kIGV4dGVuc2lvblxuICAgICAgICAgICAgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoICsgJy5tZCcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAvLyBTZWFyY2ggYnkgYmFzZW5hbWVcbiAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICAgICAgZmlsZSA9IGZpbGVzLmZpbmQoZiA9PiBcbiAgICAgICAgICAgICAgICBmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuICAgICAgICAgICAgICAgIGYubmFtZSA9PT0gbmFtZU9yUGF0aCB8fFxuICAgICAgICAgICAgICAgIGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoKSB8fFxuICAgICAgICAgICAgICAgIGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG4gICAgICAgICAgICApIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgY2xlYXJQZXJzaXN0ZW50Q29udGV4dChmaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcGVyc2lzdGVudCBjb250ZXh0IGZvciBhIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGdldFBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiBEb2N1bWVudFJlZmVyZW5jZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGZpbGVQYXRoKSB8fCBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBzcGVjaWZpYyBkb2N1bWVudCBmcm9tIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAqL1xuICAgIHJlbW92ZVBlcnNpc3RlbnREb2MoZmlsZVBhdGg6IHN0cmluZywgZG9jVG9SZW1vdmU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoZmlsZVBhdGgpIHx8IFtdO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZCA9IGN1cnJlbnQuZmlsdGVyKHJlZiA9PiByZWYuZmlsZS5wYXRoICE9PSBkb2NUb1JlbW92ZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoZmlsZVBhdGgsIGZpbHRlcmVkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzdGltYXRlIHRva2VuIGNvdW50IChyb3VnaCBhcHByb3hpbWF0aW9uKVxuICAgICAqL1xuICAgIHByaXZhdGUgZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgLy8gUm91Z2ggZXN0aW1hdGU6IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodGV4dC5sZW5ndGggLyA0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdmlzdWFsIGluZGljYXRvcnMgZm9yIGNvbnRleHQgc3RhdGVcbiAgICAgKi9cbiAgICBnZXRDb250ZXh0SW5kaWNhdG9ycyhjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiB7XG4gICAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgICAgY2xhc3NOYW1lOiBzdHJpbmc7XG4gICAgICAgIHRvb2x0aXA6IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgY29uc3QgZG9jQ291bnQgPSBjb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGNvbnRleHQudG9rZW5Db3VudCAvIHRoaXMuVE9LRU5fTElNSVQpICogMTAwKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjbGFzc05hbWUgPSAnbm92YS1jb250ZXh0LWluZGljYXRvcic7XG4gICAgICAgIGxldCB0b29sdGlwID0gYENvbnRleHQ6ICR7ZG9jQ291bnR9IGRvY3VtZW50JHtkb2NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSwgfiR7Y29udGV4dC50b2tlbkNvdW50fSB0b2tlbnNgO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnRleHQuaXNOZWFyTGltaXQpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAnIG5vdmEtY29udGV4dC13YXJuaW5nJztcbiAgICAgICAgICAgIHRvb2x0aXAgKz0gJyAoYXBwcm9hY2hpbmcgbGltaXQpJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdGV4dCA9IGAke2RvY0NvdW50fSBkb2NzICR7cGVyY2VudGFnZX0lYDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHRleHQsIGNsYXNzTmFtZSwgdG9vbHRpcCB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb250ZXh0IGZvciBkaXNwbGF5IGluIFVJXG4gICAgICovXG4gICAgZm9ybWF0Q29udGV4dEZvckRpc3BsYXkoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBpdGVtczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBwZXJzaXN0ZW50IGRvY3VtZW50c1xuICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiBjb250ZXh0LnBlcnNpc3RlbnREb2NzKSB7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGAke2RvYy5maWxlLmJhc2VuYW1lfSR7ZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyd9YCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9XG59IiwgIi8qKlxuICogQ2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnMgZm9yIGFsbCBBSSBwcm92aWRlcnNcbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIE1vZGVsRGVmaW5pdGlvbiB7XG5cdHZhbHVlOiBzdHJpbmc7XG5cdGxhYmVsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZWxDb25maWcge1xuXHRnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlOiBzdHJpbmcsIHNldHRpbmdzPzogYW55KTogTW9kZWxEZWZpbml0aW9uW107XG59XG5cbi8qKlxuICogR2V0IGF2YWlsYWJsZSBtb2RlbHMgZm9yIGEgcHJvdmlkZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGU6IHN0cmluZywgc2V0dGluZ3M/OiBhbnkpOiBNb2RlbERlZmluaXRpb25bXSB7XG5cdHN3aXRjaCAocHJvdmlkZXJUeXBlKSB7XG5cdFx0Y2FzZSAnY2xhdWRlJzpcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtb3B1cy00LTIwMjUwNTE0JywgbGFiZWw6ICdDbGF1ZGUgT3B1cyA0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0JywgbGFiZWw6ICdDbGF1ZGUgU29ubmV0IDQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy03LXNvbm5ldC1sYXRlc3QnLCBsYWJlbDogJ0NsYXVkZSAzLjcgU29ubmV0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNS1zb25uZXQtbGF0ZXN0JywgbGFiZWw6ICdDbGF1ZGUgMy41IFNvbm5ldCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJywgbGFiZWw6ICdDbGF1ZGUgMy41IFNvbm5ldCAoT2N0IDIyKScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0JywgbGFiZWw6ICdDbGF1ZGUgMy41IEhhaWt1JyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ29wZW5haSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTQuMS0yMDI1LTA0LTE0JywgbGFiZWw6ICdHUFQtNC4xJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnLCBsYWJlbDogJ0dQVC00LjEgTWluaScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00LjEtbmFuby0yMDI1LTA0LTE0JywgbGFiZWw6ICdHUFQtNC4xIE5hbm8nIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNG8nLCBsYWJlbDogJ0dQVC00bycgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00by1taW5pJywgbGFiZWw6ICdHUFQtNG8gTWluaScgfVxuXHRcdFx0XTtcblx0XHRjYXNlICdnb29nbGUnOlxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNC0xNycsIGxhYmVsOiAnR2VtaW5pIDIuNSBGbGFzaCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjUtcHJvLXByZXZpZXctMDMtMjUnLCBsYWJlbDogJ0dlbWluaSAyLjUgUHJvJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuMC1mbGFzaCcsIGxhYmVsOiAnR2VtaW5pIDIuMCBGbGFzaCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjAtZmxhc2gtbGl0ZScsIGxhYmVsOiAnR2VtaW5pIDIuMCBGbGFzaC1MaXRlJyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ29sbGFtYSc6XG5cdFx0XHQvLyBSZXR1cm4gdGhlIGNvbmZpZ3VyZWQgbW9kZWwgZnJvbSBzZXR0aW5nc1xuXHRcdFx0Y29uc3Qgb2xsYW1hTW9kZWwgPSBzZXR0aW5ncz8uYWlQcm92aWRlcnM/Lm9sbGFtYT8ubW9kZWw7XG5cdFx0XHRpZiAob2xsYW1hTW9kZWwgJiYgb2xsYW1hTW9kZWwudHJpbSgpKSB7XG5cdFx0XHRcdHJldHVybiBbeyB2YWx1ZTogb2xsYW1hTW9kZWwsIGxhYmVsOiBvbGxhbWFNb2RlbCB9XTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBbXTtcblx0XHRkZWZhdWx0OlxuXHRcdFx0cmV0dXJuIFtdO1xuXHR9XG59IiwgImltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFBsYXRmb3JtLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB9IGZyb20gJy4vd2lraWxpbmstc3VnZ2VzdCc7XG5pbXBvcnQgeyBDb21tYW5kU3lzdGVtIH0gZnJvbSAnLi9jb21tYW5kLXN5c3RlbSc7XG5pbXBvcnQgeyBDb250ZXh0TWFuYWdlciB9IGZyb20gJy4vY29udGV4dC1tYW5hZ2VyJztcblxuLyoqXG4gKiBIYW5kbGVzIHRleHRhcmVhIGlucHV0LCBhdXRvLWdyb3csIHNlbmQgYnV0dG9uLCBhbmQgaW5wdXQgZXZlbnRzXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnB1dEhhbmRsZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHRleHRBcmVhITogVGV4dEFyZWFDb21wb25lbnQ7XG5cdHByaXZhdGUgc2VuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0cHJpdmF0ZSBhdXRvR3Jvd1RleHRhcmVhITogKCkgPT4gdm9pZDtcblx0cHJpdmF0ZSB3aWtpbGlua0F1dG9jb21wbGV0ZSE6IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZTtcblx0cHJpdmF0ZSBjb21tYW5kU3lzdGVtITogQ29tbWFuZFN5c3RlbTtcblx0cHJpdmF0ZSBjb250ZXh0TWFuYWdlcjogQ29udGV4dE1hbmFnZXI7XG5cdHByaXZhdGUgaW5wdXRSb3chOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRk9DVVNfREVMQVlfTVMgPSAxNTA7XG5cdHByaXZhdGUgZHJvcFpvbmVPdmVybGF5OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzRHJhZ2dpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBzaWRlYmFyVmlldzogYW55OyAvLyBSZWZlcmVuY2UgdG8gTm92YVNpZGViYXJWaWV3IGZvciBjb250ZXh0IG9wZXJhdGlvbnNcblxuXHQvLyBFdmVudCBjbGVhbnVwIHRyYWNraW5nXG5cdHByaXZhdGUgZXZlbnRMaXN0ZW5lcnM6IEFycmF5PHtlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcn0+ID0gW107XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cGx1Z2luOiBOb3ZhUGx1Z2luLCBcblx0XHRjb250YWluZXI6IEhUTUxFbGVtZW50LCBcblx0XHRjb250ZXh0TWFuYWdlcjogQ29udGV4dE1hbmFnZXJcblx0KSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlciA9IGNvbnRleHRNYW5hZ2VyO1xuXHR9XG5cblx0c2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXc6IGFueSk6IHZvaWQge1xuXHRcdHRoaXMuc2lkZWJhclZpZXcgPSBzaWRlYmFyVmlldztcblx0XHQvLyBBbHNvIHBhc3MgdG8gd2lraWxpbmsgYXV0b2NvbXBsZXRlIGlmIGl0IGV4aXN0c1xuXHRcdGlmICh0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlKSB7XG5cdFx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlLnNldFNpZGViYXJWaWV3KHNpZGViYXJWaWV3KTtcblx0XHR9XG5cdH1cblxuXHRzZXRDb21tYW5kU3lzdGVtKGNvbW1hbmRTeXN0ZW06IENvbW1hbmRTeXN0ZW0pOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0gPSBjb21tYW5kU3lzdGVtO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb21tYW5kIGJ1dHRvbiBiZWZvcmUgc2VuZCBidXR0b24gZm9yIHByb3BlciBET00gb3JkZXJcblx0XHRjb25zdCBzZW5kQnV0dG9uRWwgPSB0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWw7XG5cdFx0c2VuZEJ1dHRvbkVsLnJlbW92ZSgpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb21tYW5kIGJ1dHRvblxuXHRcdHRoaXMuY29tbWFuZFN5c3RlbS5jcmVhdGVDb21tYW5kQnV0dG9uKHRoaXMuaW5wdXRSb3cpO1xuXHRcdFxuXHRcdC8vIFJlLWFkZCBzZW5kIGJ1dHRvbiAod2lsbCBiZSBsYXN0IGluIERPTSBvcmRlcilcblx0XHR0aGlzLmlucHV0Um93LmFwcGVuZENoaWxkKHNlbmRCdXR0b25FbCk7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgcGlja2VyXG5cdFx0dGhpcy5jb21tYW5kU3lzdGVtLmNyZWF0ZUNvbW1hbmRQaWNrZXJJbkNvbnRhaW5lcih0aGlzLmlucHV0Um93KTtcblx0fVxuXG5cdGdldFRleHRBcmVhKCk6IFRleHRBcmVhQ29tcG9uZW50IHtcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYTtcblx0fVxuXG5cdGNyZWF0ZUlucHV0SW50ZXJmYWNlKGNoYXRDb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0dGhpcy5jb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRgO1xuXG5cdFx0dGhpcy5pbnB1dFJvdyA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtcm93JyB9KTtcblx0XHR0aGlzLmlucHV0Um93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0Z2FwOiB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHQvLyBUZXh0YXJlYSBjb250YWluZXJcblx0XHRjb25zdCB0ZXh0QXJlYUNvbnRhaW5lciA9IHRoaXMuaW5wdXRSb3cuY3JlYXRlRGl2KCk7XG5cdFx0dGV4dEFyZWFDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdmbGV4OiAxOyBwb3NpdGlvbjogcmVsYXRpdmU7JztcblxuXHRcdC8vIENyZWF0ZSB0ZXh0YXJlYVxuXHRcdHRoaXMudGV4dEFyZWEgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodGV4dEFyZWFDb250YWluZXIpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0UGxhY2Vob2xkZXIoJ0FzayBOb3ZhIGFueXRoaW5nLi4uIChTaGlmdCtFbnRlciBmb3IgbmV3IGxpbmUpJyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4taGVpZ2h0OiA4MHB4O1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRyZXNpemU6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtMi0zKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0Zm9udC1mYW1pbHk6IHZhcigtLWZvbnQtaW50ZXJmYWNlKTtcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0Ym94LXNpemluZzogYm9yZGVyLWJveDtcblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCB0ZXh0YXJlYSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9IE1hdGgubWluKHRleHRhcmVhLnNjcm9sbEhlaWdodCwgMjAwKSArICdweCc7XG5cdFx0fTtcblxuXHRcdC8vIEFkZCBpbnB1dCBldmVudCBsaXN0ZW5lciBmb3IgYXV0by1ncm93XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2lucHV0JywgdGhpcy5hdXRvR3Jvd1RleHRhcmVhKTtcblxuXHRcdC8vIFRyaWdnZXIgYXV0by1ncm93IG9uIGluaXRpYWwgbG9hZFxuXHRcdHNldFRpbWVvdXQodGhpcy5hdXRvR3Jvd1RleHRhcmVhLCAwKTtcblxuXHRcdC8vIEluaXRpYWxpemUgd2lraWxpbmsgYXV0b2NvbXBsZXRlIHdpdGggaW5wdXRSb3cgZm9yIGNvbnNpc3RlbnQgd2lkdGhcblx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlID0gbmV3IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgdGhpcy5pbnB1dFJvdyk7XG5cdFx0XG5cdFx0Ly8gUGFzcyBzaWRlYmFyIHZpZXcgcmVmZXJlbmNlIHdoZW4gYXZhaWxhYmxlXG5cdFx0aWYgKHRoaXMuc2lkZWJhclZpZXcpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuc2V0U2lkZWJhclZpZXcodGhpcy5zaWRlYmFyVmlldyk7XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGRlYm91bmNlZCBjb250ZXh0IHByZXZpZXdcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAnaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLnVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyh0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ29tbWFuZCBidXR0b24gd2lsbCBiZSBjcmVhdGVkIGxhdGVyIHdoZW4gQ29tbWFuZFN5c3RlbSBpcyBzZXRcblxuXHRcdC8vIFNlbmQgYnV0dG9uXG5cdFx0dGhpcy5zZW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh0aGlzLmlucHV0Um93KTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0SWNvbignc2VuZCcpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRUb29sdGlwKCdTZW5kIG1lc3NhZ2UnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmhhbmRsZVNlbmQoKSk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4td2lkdGg6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGhlaWdodDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xuXHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdGA7XG5cblx0XHQvLyBFbnRlciBrZXkgaGFuZGxpbmcgYW5kIGNvbW1hbmQvc2VjdGlvbiBwaWNrZXJcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAna2V5ZG93bicsIChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGNvbnN0IGtleUV2ZW50ID0gZXZlbnQgYXMgS2V5Ym9hcmRFdmVudDtcblxuXHRcdFx0aWYgKGtleUV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAha2V5RXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0KHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpIHx8IGZhbHNlKSB8fCB0aGlzLmhhbmRsZVNlbmQoKTtcblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0/LmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGtleUV2ZW50LmtleSA9PT0gJ0Fycm93VXAnIHx8IGtleUV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlck5hdmlnYXRpb24oa2V5RXZlbnQua2V5KSkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnVGFiJykge1xuXHRcdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtPy5oYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXlFdmVudC5rZXkpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSW5wdXQgY2hhbmdlIGhhbmRsaW5nIGZvciBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdpbnB1dCcsICgpID0+IHtcblx0XHRcdGlmICh0aGlzLmNvbW1hbmRTeXN0ZW0pIHtcblx0XHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtLmhhbmRsZUlucHV0Q2hhbmdlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBTZXR1cCBkcmFnIGFuZCBkcm9wIGZvciBmaWxlIGNvbnRleHRcblx0XHR0aGlzLnNldHVwRHJhZ0FuZERyb3AoKTtcblx0fVxuXG5cdGZvY3VzKCk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMudGV4dEFyZWE/LmlucHV0RWwpIHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9XG5cdFx0fSwgSW5wdXRIYW5kbGVyLkZPQ1VTX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlU2VuZCgpOiB2b2lkIHtcblx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHJldHVybjtcblxuXHRcdC8vIENsZWFyIGlucHV0XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSgnJyk7XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5oaWRlQ29udGV4dFByZXZpZXcoKTtcblxuXHRcdC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGNhbGwgYSBjYWxsYmFjayBvciBlbWl0IGFuIGV2ZW50XG5cdFx0Ly8gRm9yIG5vdywgd2UnbGwgYXNzdW1lIHRoZSBwYXJlbnQgaGFuZGxlcyB0aGUgYWN0dWFsIHNlbmRpbmdcblx0XHR0aGlzLm9uU2VuZE1lc3NhZ2U/LihtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgb25TZW5kTWVzc2FnZT86IChtZXNzYWdlOiBzdHJpbmcpID0+IHZvaWQ7XG5cblx0c2V0T25TZW5kTWVzc2FnZShjYWxsYmFjazogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZCk6IHZvaWQge1xuXHRcdHRoaXMub25TZW5kTWVzc2FnZSA9IGNhbGxiYWNrO1xuXHR9XG5cblx0Z2V0VmFsdWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHR9XG5cblx0c2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodmFsdWUpO1xuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpO1xuXHR9XG5cblx0aW5zZXJ0VGV4dCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0Y29uc3Qgc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDtcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XG5cblx0XHRjb25zdCBuZXdWYWx1ZSA9IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBzdGFydCkgKyB0ZXh0ICsgY3VycmVudFZhbHVlLnNsaWNlKGVuZCk7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShuZXdWYWx1ZSk7XG5cblx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYWZ0ZXIgaW5zZXJ0ZWQgdGV4dFxuXHRcdGNvbnN0IG5ld1Bvc2l0aW9uID0gc3RhcnQgKyB0ZXh0Lmxlbmd0aDtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKG5ld1Bvc2l0aW9uLCBuZXdQb3NpdGlvbik7XG5cdFx0XHR0ZXh0YXJlYS5mb2N1cygpO1xuXHRcdH0sIDApO1xuXG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdH1cblxuXHRpbnNlcnRUZXh0V2l0aEN1cnNvcihiZWZvcmVDdXJzb3I6IHN0cmluZywgYWZ0ZXJDdXJzb3I6IHN0cmluZyA9ICcnKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFZhbHVlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdGNvbnN0IHRleHRhcmVhID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsO1xuXHRcdGNvbnN0IHN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7XG5cdFx0Y29uc3QgZW5kID0gdGV4dGFyZWEuc2VsZWN0aW9uRW5kO1xuXG5cdFx0Y29uc3QgbmV3VmFsdWUgPSBjdXJyZW50VmFsdWUuc2xpY2UoMCwgc3RhcnQpICsgYmVmb3JlQ3Vyc29yICsgYWZ0ZXJDdXJzb3IgKyBjdXJyZW50VmFsdWUuc2xpY2UoZW5kKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBiZXR3ZWVuIGJlZm9yZSBhbmQgYWZ0ZXIgdGV4dFxuXHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gc3RhcnQgKyBiZWZvcmVDdXJzb3IubGVuZ3RoO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yUG9zaXRpb24sIGN1cnNvclBvc2l0aW9uKTtcblx0XHRcdHRleHRhcmVhLmZvY3VzKCk7XG5cdFx0fSwgMCk7XG5cblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkRXZlbnRMaXN0ZW5lcihlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0dGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblxuXHRwcml2YXRlIHNldHVwRHJhZ0FuZERyb3AoKTogdm9pZCB7XG5cdFx0Y29uc3QgZHJvcFpvbmUgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cblx0XHQvLyBQcmV2ZW50IGRlZmF1bHQgZHJhZyBiZWhhdmlvcnNcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcmFnZW50ZXInLCAoZTogRXZlbnQpID0+IHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMuaGFuZGxlRHJhZ0VudGVyKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcmFnb3ZlcicsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Ly8gU2V0IGRyb3AgZWZmZWN0IHRvIHNob3cgaXQncyBhbGxvd2VkXG5cdFx0XHQoZSBhcyBEcmFnRXZlbnQpLmRhdGFUcmFuc2ZlciEuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihkcm9wWm9uZSwgJ2RyYWdsZWF2ZScsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0Ly8gT25seSBoaWRlIG92ZXJsYXkgaWYgd2UncmUgbGVhdmluZyB0aGUgZHJvcCB6b25lIGVudGlyZWx5XG5cdFx0XHRpZiAoZS50YXJnZXQgPT09IGRyb3Bab25lKSB7XG5cdFx0XHRcdHRoaXMuaGFuZGxlRHJhZ0xlYXZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcm9wJywgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLmhhbmRsZURyb3AoZSBhcyBEcmFnRXZlbnQpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVEcmFnRW50ZXIoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuaXNEcmFnZ2luZykgcmV0dXJuO1xuXHRcdHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG5cblx0XHQvLyBDcmVhdGUgb3ZlcmxheSBmb3IgdmlzdWFsIGZlZWRiYWNrXG5cdFx0aWYgKCF0aGlzLmRyb3Bab25lT3ZlcmxheSkge1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LmNsYXNzTmFtZSA9ICdub3ZhLWRyb3Atem9uZS1vdmVybGF5Jztcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdFx0dG9wOiAwO1xuXHRcdFx0XHRsZWZ0OiAwO1xuXHRcdFx0XHRyaWdodDogMDtcblx0XHRcdFx0Ym90dG9tOiAwO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0XHRvcGFjaXR5OiAwO1xuXHRcdFx0XHRib3JkZXI6IDJweCBkYXNoZWQgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0XHRcdHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlO1xuXHRcdFx0XHR6LWluZGV4OiAxMDtcblx0XHRcdGA7XG5cblx0XHRcdC8vIEFkZCBpY29uIGNvbnRhaW5lclxuXHRcdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdHdpZHRoOiA0OHB4O1xuXHRcdFx0XHRoZWlnaHQ6IDQ4cHg7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0XHRib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdFx0b3BhY2l0eTogMDtcblx0XHRcdFx0dHJhbnNmb3JtOiBzY2FsZSgwLjgpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gQWRkIE9ic2lkaWFuJ3MgcGx1cyBpY29uXG5cdFx0XHRjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRpY29uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGxpbmUgeDE9XCIxMlwiIHkxPVwiNVwiIHgyPVwiMTJcIiB5Mj1cIjE5XCI+PC9saW5lPjxsaW5lIHgxPVwiNVwiIHkxPVwiMTJcIiB4Mj1cIjE5XCIgeTI9XCIxMlwiPjwvbGluZT48L3N2Zz5gO1xuXHRcdFx0aWNvbi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRgO1xuXG5cdFx0XHRpY29uQ29udGFpbmVyLmFwcGVuZENoaWxkKGljb24pO1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuYXBwZW5kQ2hpbGQoaWNvbkNvbnRhaW5lcik7XG5cdFx0fVxuXG5cdFx0Ly8gUG9zaXRpb24gcmVsYXRpdmUgdG8gdGV4dGFyZWFcblx0XHRjb25zdCB0ZXh0QXJlYUNvbnRhaW5lciA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbC5wYXJlbnRFbGVtZW50ITtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0dGV4dEFyZWFDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5kcm9wWm9uZU92ZXJsYXkpO1xuXG5cdFx0Ly8gQW5pbWF0ZSBpblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuZHJvcFpvbmVPdmVybGF5KSB7XG5cdFx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAnMC4xJztcblx0XHRcdFx0Y29uc3QgaWNvbiA9IHRoaXMuZHJvcFpvbmVPdmVybGF5LnF1ZXJ5U2VsZWN0b3IoJ2RpdicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRpZiAoaWNvbikge1xuXHRcdFx0XHRcdGljb24uc3R5bGUub3BhY2l0eSA9ICcxJztcblx0XHRcdFx0XHRpY29uLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LCAxMCk7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyYWdMZWF2ZSgpOiB2b2lkIHtcblx0XHR0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcblx0XHRpZiAodGhpcy5kcm9wWm9uZU92ZXJsYXkpIHtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0XHRjb25zdCBpY29uID0gdGhpcy5kcm9wWm9uZU92ZXJsYXkucXVlcnlTZWxlY3RvcignZGl2JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAoaWNvbikge1xuXHRcdFx0XHRpY29uLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0XHRcdGljb24uc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDAuOCknO1xuXHRcdFx0fVxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5Py5yZW1vdmUoKTtcblx0XHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBudWxsO1xuXHRcdFx0fSwgMjAwKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyb3AoZTogRHJhZ0V2ZW50KTogdm9pZCB7XG5cdFx0dGhpcy5oYW5kbGVEcmFnTGVhdmUoKTtcblxuXHRcdGNvbnN0IGZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIFBhcnNlIE9ic2lkaWFuJ3Mgb2JzaWRpYW46Ly8gVVJMcyAtIHByZWZlciB0ZXh0L3BsYWluIGFzIGl0IGhhcyBwcm9wZXIgbmV3bGluZXNcblx0XHRjb25zdCB0ZXh0UGxhaW5EYXRhID0gZS5kYXRhVHJhbnNmZXI/LmdldERhdGEoJ3RleHQvcGxhaW4nKTtcblx0XHRcblx0XHRpZiAodGV4dFBsYWluRGF0YSAmJiB0ZXh0UGxhaW5EYXRhLmluY2x1ZGVzKCdvYnNpZGlhbjovL29wZW4/JykpIHtcblx0XHRcdC8vIEhhbmRsZSBtdWx0aXBsZSBVUkxzIHNlcGFyYXRlZCBieSBuZXdsaW5lc1xuXHRcdFx0Y29uc3QgdXJscyA9IHRleHRQbGFpbkRhdGEuc3BsaXQoL1tcXG5cXHJdLykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkuc3RhcnRzV2l0aCgnb2JzaWRpYW46Ly9vcGVuPycpKTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCB1cmxTdHJpbmcgb2YgdXJscykge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGNvbnN0IHVybCA9IG5ldyBVUkwodXJsU3RyaW5nLnRyaW0oKSk7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZVBhdGggPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZmlsZScpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChmaWxlUGF0aCkge1xuXHRcdFx0XHRcdFx0Ly8gRGVjb2RlIHRoZSBVUkwtZW5jb2RlZCBwYXRoXG5cdFx0XHRcdFx0XHRjb25zdCBkZWNvZGVkUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChmaWxlUGF0aCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIEV4dHJhY3QgZmlsZW5hbWUgZnJvbSBwYXRoIChoYW5kbGUgYm90aCAvIGFuZCBcXCBzZXBhcmF0b3JzKVxuXHRcdFx0XHRcdFx0Y29uc3QgcGF0aFBhcnRzID0gZGVjb2RlZFBhdGguc3BsaXQoL1svXFxcXF0vKTtcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGVuYW1lID0gcGF0aFBhcnRzW3BhdGhQYXJ0cy5sZW5ndGggLSAxXTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gT25seSBwcm9jZXNzIG1hcmtkb3duIGZpbGVzXG5cdFx0XHRcdFx0XHRpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5tZCcpKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGJhc2VOYW1lID0gZmlsZW5hbWUucmVwbGFjZSgnLm1kJywgJycpO1xuXHRcdFx0XHRcdFx0XHRpZiAoYmFzZU5hbWUgJiYgIWZpbGVzLmluY2x1ZGVzKGJhc2VOYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzLnB1c2goYmFzZU5hbWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBGb3IgZmlsZXMgd2l0aG91dCAubWQgZXh0ZW5zaW9uLCBhc3N1bWUgdGhleSdyZSBtYXJrZG93biBub3Rlc1xuXHRcdFx0XHRcdFx0XHQvLyAoT2JzaWRpYW4gc29tZXRpbWVzIG9taXRzIHRoZSAubWQgZXh0ZW5zaW9uIGluIHBhdGhzKVxuXHRcdFx0XHRcdFx0XHRpZiAoZmlsZW5hbWUgJiYgIWZpbGVzLmluY2x1ZGVzKGZpbGVuYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzLnB1c2goZmlsZW5hbWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBhcnNlIE9ic2lkaWFuIFVSTDonLCB1cmxTdHJpbmcsIGVycm9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBmaWxlcyB0byBjb250ZXh0IGlmIHdlIGdvdCBhbnlcblx0XHRpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0dGhpcy5hZGRGaWxlc1RvQ29udGV4dChmaWxlcyk7XG5cdFx0fSBlbHNlIGlmICh0ZXh0UGxhaW5EYXRhICYmIHRleHRQbGFpbkRhdGEuaW5jbHVkZXMoJ29ic2lkaWFuOi8vb3Blbj8nKSkge1xuXHRcdFx0Ly8gVXNlciBkcm9wcGVkIHNvbWV0aGluZyBmcm9tIE9ic2lkaWFuIGJ1dCBubyBmaWxlcyB3ZXJlIGV4dHJhY3RlZFxuXHRcdFx0Ly8gVGhpcyBsaWtlbHkgbWVhbnMgdGhleSBkcm9wcGVkIG5vbi1tYXJrZG93biBmaWxlc1xuXHRcdFx0bmV3IE5vdGljZSgnT25seSBtYXJrZG93biBmaWxlcyBjYW4gYmUgYWRkZWQgdG8gY29udGV4dCcsIDMwMDApO1xuXHRcdH0gZWxzZSBpZiAodGV4dFBsYWluRGF0YSAmJiB0ZXh0UGxhaW5EYXRhLnRyaW0oKSAmJiAhdGV4dFBsYWluRGF0YS5pbmNsdWRlcygnOi8vJykpIHtcblx0XHRcdC8vIFVzZXIgZHJvcHBlZCBhIGZvbGRlciAocGxhaW4gdGV4dCBwYXRoIHdpdGhvdXQgcHJvdG9jb2wpXG5cdFx0XHRuZXcgTm90aWNlKCdGb2xkZXJzIGNhbm5vdCBiZSBhZGRlZCB0byBjb250ZXh0LiBQbGVhc2Ugc2VsZWN0IGluZGl2aWR1YWwgZmlsZXMuJywgMzAwMCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBhZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKGZpbGVuYW1lcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0bmV3IE5vdGljZSgnTXVsdGktZG9jdW1lbnQgY29udGV4dCBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBBdWd1c3QgMTUsIDIwMjUuJywgMzAwMCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGZpbGVzIHRvIGNvbnRleHRcblx0XHRpZiAodGhpcy5zaWRlYmFyVmlldykge1xuXHRcdFx0YXdhaXQgdGhpcy5zaWRlYmFyVmlldy5hZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXMpO1xuXHRcdH1cblx0fVxuXG5cblx0cmVmcmVzaENvbW1hbmRCdXR0b24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbSkge1xuXHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtLnVwZGF0ZUNvbW1hbmRCdXR0b25WaXNpYmlsaXR5KCk7XG5cdFx0fVxuXHR9XG5cblx0dXBkYXRlQ29udGV4dFN0YXRlKGhhc0NvbnRleHQ6IGJvb2xlYW4pOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250YWluZXIpIHtcblx0XHRcdGlmIChoYXNDb250ZXh0KSB7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hhcy1jb250ZXh0Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdoYXMtY29udGV4dCcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKTogdm9pZCB7XG5cdFx0Ly8gQ2xlYW4gdXAgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuZGVzdHJveSgpO1xuXHRcdH1cblxuXHRcdC8vIENsZWFuIHVwIGRyb3Agem9uZSBvdmVybGF5XG5cdFx0aWYgKHRoaXMuZHJvcFpvbmVPdmVybGF5KSB7XG5cdFx0XHR0aGlzLmRyb3Bab25lT3ZlcmxheS5yZW1vdmUoKTtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5ID0gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBDbGVhbiB1cCBldmVudCBsaXN0ZW5lcnNcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzID0gW107XG5cdH1cbn0iLCAiLyoqXG4gKiBDdXN0b20gd2lraWxpbmsgYXV0b2NvbXBsZXRlIGZvciBOb3ZhIHRleHRhcmVhXG4gKiBQcm92aWRlcyBbW2RvY3VtZW50XV0gc3VnZ2VzdGlvbnMgd2hlbiB0eXBpbmcgaW4gTm92YSdzIHRleHRhcmVhXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUsIEFwcCwgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2lraWxpbmtTdWdnZXN0aW9uIHtcbiAgICBmaWxlOiBURmlsZTtcbiAgICBkaXNwbGF5VGV4dDogc3RyaW5nO1xuICAgIHNjb3JlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUge1xuICAgIHByaXZhdGUgYXBwOiBBcHA7XG4gICAgcHJpdmF0ZSB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9uUG9wdXA6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9uczogV2lraWxpbmtTdWdnZXN0aW9uW10gPSBbXTtcbiAgICBwcml2YXRlIHNlbGVjdGVkSW5kZXg6IG51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgaXNWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjdXJyZW50UXVlcnk6IHN0cmluZyA9ICcnO1xuICAgIHByaXZhdGUgY3VycmVudFRyaWdnZXJQb3M6IG51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgc2lkZWJhclZpZXc6IGFueTsgLy8gUmVmZXJlbmNlIHRvIE5vdmFTaWRlYmFyVmlld1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50LCBjb250YWluZXI/OiBIVE1MRWxlbWVudCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lciB8fCB0ZXh0QXJlYS5wYXJlbnRFbGVtZW50ITtcbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgc2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXc6IGFueSk6IHZvaWQge1xuICAgICAgICB0aGlzLnNpZGViYXJWaWV3ID0gc2lkZWJhclZpZXc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5oYW5kbGVJbnB1dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlkb3duLmJpbmQodGhpcykpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xvc2Ugb24gZm9jdXMgbG9zc1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBEZWxheSB0byBhbGxvdyBzZWxlY3Rpb24gY2xpY2tzXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCksIDE1MCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIGNsaWNrIG91dHNpZGVcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwICYmICF0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSAmJiBlLnRhcmdldCAhPT0gdGhpcy50ZXh0QXJlYSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlSW5wdXQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHRBcmVhLnZhbHVlO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICBcbiAgICAgICAgLy8gTG9vayBmb3IgW1sgcGF0dGVybiBiZWZvcmUgY3Vyc29yIChzaW1wbGlmaWVkIC0gbm8gbmVlZCBmb3IgKyBwcmVmaXggYW55bW9yZSlcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxpbmtNYXRjaCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlcnkgPSBsaW5rTWF0Y2hbMV0gfHwgJyc7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUcmlnZ2VyUG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuc2hvd1N1Z2dlc3Rpb25zKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlkb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWF4KHRoaXMuc2VsZWN0ZWRJbmRleCAtIDEsIC0xKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgICAgY2FzZSAnVGFiJzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID49IDAgfHwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXggPj0gMCA/IHRoaXMuc2VsZWN0ZWRJbmRleCA6IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0U3VnZ2VzdGlvbih0aGlzLnN1Z2dlc3Rpb25zW2luZGV4XSkudGhlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ0VzY2FwZSc6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucyA9IHRoaXMuZ2V0U3VnZ2VzdGlvbnModGhpcy5jdXJyZW50UXVlcnkpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVN1Z2dlc3Rpb25Qb3B1cCgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlbmRlclN1Z2dlc3Rpb25zKCk7XG4gICAgICAgIHRoaXMucG9zaXRpb25Qb3B1cCgpO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IDA7XG4gICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoaWRlU3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVN1Z2dlc3Rpb25Qb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuY2xhc3NOYW1lID0gJ25vdmEtd2lraWxpbmstc3VnZ2VzdGlvbnMnO1xuICAgICAgICBcbiAgICAgICAgLy8gTW9iaWxlLW9wdGltaXplZCBtYXgtaGVpZ2h0XG4gICAgICAgIGNvbnN0IG1heEhlaWdodCA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJzEwMHB4JyA6ICc2MDBweCc7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgYm90dG9tOiAxMDAlO1xuICAgICAgICAgICAgbGVmdDogMDtcbiAgICAgICAgICAgIHJpZ2h0OiAwO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICAgICAgICAgIG1heC1oZWlnaHQ6ICR7bWF4SGVpZ2h0fTtcbiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICAgICAgICB6LWluZGV4OiAxMDAwO1xuICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDRweDtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBtb2JpbGUgY2xhc3MgZm9yIGFkZGl0aW9uYWwgc3R5bGluZ1xuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLmNsYXNzTGlzdC5hZGQoJ2lzLW1vYmlsZScpO1xuICAgICAgICAgICAgLy8gQWxzbyBlbnN1cmUgYm9keSBoYXMgbW9iaWxlIGNsYXNzIGZvciBDU1MgdGFyZ2V0aW5nXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2lzLW1vYmlsZScpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJbnNlcnQgaW4gdGhlIHByb3ZpZGVkIGNvbnRhaW5lciBmb3IgY29uc2lzdGVudCB3aWR0aFxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnN1Z2dlc3Rpb25Qb3B1cCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zLmZvckVhY2goKHN1Z2dlc3Rpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBpdGVtLmNsYXNzTmFtZSA9ICdub3ZhLXN1Z2dlc3Rpb24taXRlbSc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuICAgICAgICAgICAgICAgIC8vIE1vYmlsZTogQ29tcGFjdCBzaW5nbGUtbGluZSBsYXlvdXRcbiAgICAgICAgICAgICAgICBpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDZweCAxMHB4O1xuICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgICAgICAgICAgZ2FwOiA4cHg7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBOYW1lIG9ubHkgZm9yIG1vYmlsZVxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIG5hbWVFbC5jbGFzc05hbWUgPSAnbm92YS1zdWdnZXN0aW9uLW5hbWUnO1xuICAgICAgICAgICAgICAgIG5hbWVFbC50ZXh0Q29udGVudCA9IHN1Z2dlc3Rpb24uZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgICAgICAgICBuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjllbTtcbiAgICAgICAgICAgICAgICAgICAgZmxleDogMTtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICAgICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gICAgICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKG5hbWVFbCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU21hbGwgcGF0aCBpbmRpY2F0b3IgZm9yIG1vYmlsZVxuICAgICAgICAgICAgICAgIGlmIChzdWdnZXN0aW9uLmZpbGUucGF0aC5pbmNsdWRlcygnLycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgICAgICBwYXRoRWwuY2xhc3NOYW1lID0gJ25vdmEtc3VnZ2VzdGlvbi1wYXRoJztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnN1YnN0cmluZygwLCBzdWdnZXN0aW9uLmZpbGUucGF0aC5sYXN0SW5kZXhPZignLycpKTtcbiAgICAgICAgICAgICAgICAgICAgcGF0aEVsLnRleHRDb250ZW50ID0gZm9sZGVyUGF0aC5sZW5ndGggPiAxNSA/ICcuLi4nICsgZm9sZGVyUGF0aC5zbGljZSgtMTUpIDogZm9sZGVyUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgcGF0aEVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzVlbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNztcbiAgICAgICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChwYXRoRWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRGVza3RvcDogRnVsbCBsYXlvdXQgd2l0aCBwcmV2aWV3XG4gICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiA4cHggMTJweDtcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBOYW1lIChzdGFuZGFyZGl6ZWQgdG8gbWF0Y2ggY29tbWFuZCBwaWNrZXIpXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgbmFtZUVsLmNsYXNzTmFtZSA9ICdub3ZhLXN1Z2dlc3Rpb24tbmFtZSc7XG4gICAgICAgICAgICAgICAgbmFtZUVsLnRleHRDb250ZW50ID0gc3VnZ2VzdGlvbi5maWxlLmJhc2VuYW1lO1xuICAgICAgICAgICAgICAgIG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKG5hbWVFbCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gRGVzY3JpcHRpb24gKHN0YW5kYXJkaXplZClcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBkZXNjRWwuY2xhc3NOYW1lID0gJ25vdmEtc3VnZ2VzdGlvbi1kZXNjJztcbiAgICAgICAgICAgICAgICBkZXNjRWwudGV4dENvbnRlbnQgPSBgTGluayB0byBkb2N1bWVudCBpbiAke3N1Z2dlc3Rpb24uZmlsZS5wYXRoLmluY2x1ZGVzKCcvJykgPyBzdWdnZXN0aW9uLmZpbGUucGF0aC5zdWJzdHJpbmcoMCwgc3VnZ2VzdGlvbi5maWxlLnBhdGgubGFzdEluZGV4T2YoJy8nKSkgOiAncm9vdCd9YDtcbiAgICAgICAgICAgICAgICBkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjg1ZW07XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChkZXNjRWwpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIENvbnRlbnQgUHJldmlldyAoc3RhbmRhcmRpemVkIHdpdGggbW9ub3NwYWNlKVxuICAgICAgICAgICAgICAgIGNvbnN0IGV4YW1wbGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGV4YW1wbGVFbC5jbGFzc05hbWUgPSAnbm92YS1zdWdnZXN0aW9uLWV4YW1wbGUnO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RmlsZVByZXZpZXcoc3VnZ2VzdGlvbi5maWxlKS50aGVuKHByZXZpZXcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBleGFtcGxlRWwudGV4dENvbnRlbnQgPSBgUHJldmlldzogJHtwcmV2aWV3fWA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZXhhbXBsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LWFjY2VudCk7XG4gICAgICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKGV4YW1wbGVFbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwIS5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcubm92YS1zdWdnZXN0aW9uLWl0ZW0nKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBpdGVtIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcG9zaXRpb25Qb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgLy8gUG9zaXRpb24gYWJvdmUgdGhlIHRleHRhcmVhIHdpdGggZnVsbCBjb250YWluZXIgd2lkdGggKG1hdGNoaW5nIG90aGVyIHBpY2tlcnMpXG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUubGVmdCA9ICcwJztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUucmlnaHQgPSAnMCc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmJvdHRvbSA9ICcxMDAlJztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUubWFyZ2luQm90dG9tID0gJzRweCc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBzZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IFdpa2lsaW5rU3VnZ2VzdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0QXJlYS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy50ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIFtbIHBhdHRlcm4gdG8gcmVtb3ZlIChzaW1wbGlmaWVkIC0gbm8gKyBwcmVmaXggbmVlZGVkKVxuICAgICAgICBjb25zdCBiZWZvcmVDdXJzb3IgPSB0ZXh0LnN1YnN0cmluZygwLCBjdXJzb3JQb3MpO1xuICAgICAgICBjb25zdCBsaW5rTWF0Y2ggPSBiZWZvcmVDdXJzb3IubWF0Y2goL1xcW1xcWyhbXlxcXV0qPykkLyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobGlua01hdGNoKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IGN1cnNvclBvcyAtIGxpbmtNYXRjaFswXS5sZW5ndGg7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaW5jb21wbGV0ZSBbWyBwYXR0ZXJuIGZyb20gdGhlIGlucHV0XG4gICAgICAgICAgICBjb25zdCBuZXdUZXh0ID0gdGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRQb3MpICsgdGV4dC5zdWJzdHJpbmcoY3Vyc29yUG9zKTtcbiAgICAgICAgICAgIHRoaXMudGV4dEFyZWEudmFsdWUgPSBuZXdUZXh0O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQb3NpdGlvbiBjdXJzb3IgYXQgdGhlIGNsZWFyZWQgcG9zaXRpb25cbiAgICAgICAgICAgIHRoaXMudGV4dEFyZWEuc2V0U2VsZWN0aW9uUmFuZ2Uoc3RhcnRQb3MsIHN0YXJ0UG9zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJpZ2dlciBpbnB1dCBldmVudCB0byB1cGRhdGUgYW55IGF1dG8tZ3JvdyBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAgICB0aGlzLnRleHRBcmVhLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpbnB1dCcsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBmaWxlIHRvIGNvbnRleHQgYXV0b21hdGljYWxseSBcbiAgICAgICAgaWYgKHRoaXMuc2lkZWJhclZpZXcgJiYgdGhpcy5zaWRlYmFyVmlldy5hZGRGaWxlc1RvQ29udGV4dCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zaWRlYmFyVmlldy5hZGRGaWxlc1RvQ29udGV4dChbc3VnZ2VzdGlvbi5maWxlLmJhc2VuYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSB7XG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogV2lraWxpbmtTdWdnZXN0aW9uW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgY29uc3Qgc2NvcmUgPSB0aGlzLnNjb3JlRmlsZShmaWxlLCBxdWVyeSk7XG4gICAgICAgICAgICBpZiAoc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUZXh0OiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgICAgICBzY29yZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTb3J0IGJ5IHNjb3JlIChoaWdoZXN0IGZpcnN0KSBhbmQgbGltaXQgcmVzdWx0c1xuICAgICAgICBjb25zdCBtYXhSZXN1bHRzID0gUGxhdGZvcm0uaXNNb2JpbGUgPyA1IDogODtcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXG4gICAgICAgICAgICAuc2xpY2UoMCwgbWF4UmVzdWx0cyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzY29yZUZpbGUoZmlsZTogVEZpbGUsIHF1ZXJ5OiBzdHJpbmcpOiBudW1iZXIge1xuICAgICAgICBpZiAoIXF1ZXJ5KSByZXR1cm4gNTA7IC8vIFNob3cgYWxsIGZpbGVzIHdoZW4gbm8gcXVlcnlcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGJhc2VuYW1lID0gZmlsZS5iYXNlbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5TG93ZXIgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXhhY3QgbWF0Y2hcbiAgICAgICAgaWYgKGJhc2VuYW1lID09PSBxdWVyeUxvd2VyKSByZXR1cm4gMTAwO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RhcnRzIHdpdGggcXVlcnlcbiAgICAgICAgaWYgKGJhc2VuYW1lLnN0YXJ0c1dpdGgocXVlcnlMb3dlcikpIHJldHVybiA4MDtcbiAgICAgICAgXG4gICAgICAgIC8vIENvbnRhaW5zIHF1ZXJ5XG4gICAgICAgIGlmIChiYXNlbmFtZS5pbmNsdWRlcyhxdWVyeUxvd2VyKSkgcmV0dXJuIDYwO1xuICAgICAgICBcbiAgICAgICAgLy8gUGF0aCBjb250YWlucyBxdWVyeVxuICAgICAgICBpZiAocGF0aC5pbmNsdWRlcyhxdWVyeUxvd2VyKSkgcmV0dXJuIDQwO1xuICAgICAgICBcbiAgICAgICAgLy8gRnV6enkgbWF0Y2hcbiAgICAgICAgaWYgKHRoaXMuZnV6enlNYXRjaChiYXNlbmFtZSwgcXVlcnlMb3dlcikpIHJldHVybiAyMDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIHByaXZhdGUgZnV6enlNYXRjaCh0ZXh0OiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHRleHRJbmRleCA9IDA7XG4gICAgICAgIGxldCBxdWVyeUluZGV4ID0gMDtcbiAgICAgICAgXG4gICAgICAgIHdoaWxlICh0ZXh0SW5kZXggPCB0ZXh0Lmxlbmd0aCAmJiBxdWVyeUluZGV4IDwgcXVlcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGV4dFt0ZXh0SW5kZXhdID09PSBxdWVyeVtxdWVyeUluZGV4XSkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5SW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRleHRJbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcXVlcnlJbmRleCA9PT0gcXVlcnkubGVuZ3RoO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZ2V0RmlsZVByZXZpZXcoZmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9udG1hdHRlciBpZiBwcmVzZW50XG4gICAgICAgICAgICBsZXQgdGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlckVuZCA9IGNvbnRlbnQuaW5kZXhPZignLS0tJywgMyk7XG4gICAgICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyRW5kICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCA9IGNvbnRlbnQuc3Vic3RyaW5nKGZyb250bWF0dGVyRW5kICsgMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgZmlyc3QgNTAgY2hhcmFjdGVycyBvZiBhY3R1YWwgdGV4dCBjb250ZW50LCByZW1vdmluZyBtYXJrZG93biBmb3JtYXR0aW5nXG4gICAgICAgICAgICBjb25zdCBwbGFpblRleHQgPSB0ZXh0Q29udGVudFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9eIysgL2dtLCAnJykgLy8gUmVtb3ZlIGhlYWRpbmdzXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKlxcKiguKj8pXFwqXFwqL2csICckMScpIC8vIFJlbW92ZSBib2xkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKiguKj8pXFwqL2csICckMScpIC8vIFJlbW92ZSBpdGFsaWNcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxbKC4qPylcXF1cXCguKj9cXCkvZywgJyQxJykgLy8gUmVtb3ZlIGxpbmtzXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnICcpIC8vIFJlcGxhY2UgbmV3bGluZXMgd2l0aCBzcGFjZXNcbiAgICAgICAgICAgICAgICAudHJpbSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gcGxhaW5UZXh0Lmxlbmd0aCA+IDUwID8gcGxhaW5UZXh0LnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJyA6IHBsYWluVGV4dCB8fCAnRW1wdHkgZmlsZSc7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1VuYWJsZSB0byBsb2FkIHByZXZpZXcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS90eXBlcyc7XG5cbmludGVyZmFjZSBTdHJ1Y3R1cmVkQ29tbWFuZCB7XG5cdG5hbWU6IHN0cmluZztcblx0ZGVzY3JpcHRpb246IHN0cmluZztcblx0Y29tbWFuZDogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRleGFtcGxlOiBzdHJpbmc7XG5cdGtleXdvcmRzOiBzdHJpbmdbXTtcbn1cblxuXG4vKipcbiAqIEhhbmRsZXMgY29tbWFuZCBwaWNrZXIsIGNvbW1hbmQgbWVudSwgYW5kIGNvbW1hbmQgZXhlY3V0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBDb21tYW5kU3lzdGVtIHtcblx0cHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0ZXh0QXJlYTogVGV4dEFyZWFDb21wb25lbnQ7XG5cdHByaXZhdGUgY29tbWFuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0cHJpdmF0ZSBjb21tYW5kUGlja2VyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY29tbWFuZFBpY2tlckl0ZW1zOiBIVE1MRWxlbWVudFtdID0gW107XG5cdHByaXZhdGUgc2VsZWN0ZWRDb21tYW5kSW5kZXg6IG51bWJlciA9IC0xO1xuXHRwcml2YXRlIGNvbW1hbmRNZW51ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaXNDb21tYW5kTWVudVZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE5vdmFQbHVnaW4sIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHRleHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdHRoaXMudGV4dEFyZWEgPSB0ZXh0QXJlYTtcblx0fVxuXG5cdGNyZWF0ZUNvbW1hbmRCdXR0b24oaW5wdXRSb3c6IEhUTUxFbGVtZW50KTogQnV0dG9uQ29tcG9uZW50IHtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Um93KTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uc2V0SWNvbignemFwJyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldFRvb2x0aXAoJ0NvbW1hbmRzJyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy50b2dnbGVDb21tYW5kTWVudSgpKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1pbi13aWR0aDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0aGVpZ2h0OiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRkaXNwbGF5OiAke3RoaXMuc2hvdWxkU2hvd0NvbW1hbmRCdXR0b24oKSA/ICdmbGV4JyA6ICdub25lJ307XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAwO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRtYXJnaW4tcmlnaHQ6IHZhcigtLXNpemUtMi0zKTtcblx0XHRgO1xuXHRcdHJldHVybiB0aGlzLmNvbW1hbmRCdXR0b247XG5cdH1cblxuXHRjcmVhdGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKHRoaXMuY29udGFpbmVyKTtcblx0fVxuXG5cdGNyZWF0ZUNvbW1hbmRQaWNrZXJJbkNvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXInIH0pO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdGA7XG5cdH1cblxuXHRzaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gUGxhdGZvcm0uaXNNb2JpbGUgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b24gJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKTtcblx0fVxuXG5cdHVwZGF0ZUNvbW1hbmRCdXR0b25WaXNpYmlsaXR5KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRCdXR0b24pIHtcblx0XHRcdGNvbnN0IHNob3VsZFNob3cgPSB0aGlzLnNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk7XG5cdFx0XHR0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IHNob3VsZFNob3cgPyAnZmxleCcgOiAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0dG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNyZWF0ZUNvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICh0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kTWVudSgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudSA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51JyB9KTtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctcyk7XG5cdFx0XHRtaW4td2lkdGg6IDI1MHB4O1xuXHRcdFx0bWF4LWhlaWdodDogMzAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMik7XG5cdFx0YDtcblxuXHRcdC8vIENvbW1hbmRzIGF2YWlsYWJsZSB0byBhbGwgdXNlcnNcblx0XHRjb25zdCBjb21tYW5kcyA9IFtcblx0XHRcdHsgbmFtZTogJ0ltcHJvdmUgV3JpdGluZycsIGRlc2NyaXB0aW9uOiAnRW5oYW5jZSBjbGFyaXR5IGFuZCBmbG93JywgY29tbWFuZDogJ2ltcHJvdmUgd3JpdGluZycgfSxcblx0XHRcdHsgbmFtZTogJ0ZpeCBHcmFtbWFyJywgZGVzY3JpcHRpb246ICdDb3JyZWN0IGdyYW1tYXIgYW5kIHNwZWxsaW5nJywgY29tbWFuZDogJ2ZpeCBncmFtbWFyJyB9LFxuXHRcdFx0eyBuYW1lOiAnU3VtbWFyaXplJywgZGVzY3JpcHRpb246ICdDcmVhdGUgYSBjb25jaXNlIHN1bW1hcnknLCBjb21tYW5kOiAnc3VtbWFyaXplJyB9LFxuXHRcdFx0eyBuYW1lOiAnRXhwYW5kIElkZWFzJywgZGVzY3JpcHRpb246ICdEZXZlbG9wIHRob3VnaHRzIGZ1cnRoZXInLCBjb21tYW5kOiAnZXhwYW5kJyB9LFxuXHRcdFx0eyBuYW1lOiAnRXhwbGFpbicsIGRlc2NyaXB0aW9uOiAnQ2xhcmlmeSBjb21wbGV4IGNvbmNlcHRzJywgY29tbWFuZDogJ2V4cGxhaW4gdGhpcycgfSxcblx0XHRcdHsgbmFtZTogJ0NvbnRpbnVlIFdyaXRpbmcnLCBkZXNjcmlwdGlvbjogJ0V4dGVuZCB0aGUgY3VycmVudCB0ZXh0JywgY29tbWFuZDogJ2NvbnRpbnVlIHdyaXRpbmcnIH1cblx0XHRdO1xuXG5cdFx0Y29uc3QgdGl0bGUgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6ICdRdWljayBDb21tYW5kcycgfSk7XG5cdFx0dGl0bGUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0zKTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0YDtcblxuXHRcdGNvbW1hbmRzLmZvckVhY2goY21kID0+IHtcblx0XHRcdGNvbnN0IGNtZEVsID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRjbWRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMteHMpO1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjFzO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gY21kRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLm5hbWUgfSk7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgZGVzY0VsID0gY21kRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLmRlc2NyaXB0aW9uIH0pO1xuXHRcdFx0ZGVzY0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y21kRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoY21kLmNvbW1hbmQgKyAnICcpO1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRjbWRFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRjbWRFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdH0pO1xuXG5cdFx0XHRjbWRFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRjbWRFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRoaWRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRoYW5kbGVJbnB1dENoYW5nZSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMudGV4dEFyZWEpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgaW5wdXQgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XG5cdFx0Ly8gSGFuZGxlIGRpZmZlcmVudCB0cmlnZ2Vyc1xuXHRcdGlmIChpbnB1dC5zdGFydHNXaXRoKCc6JykpIHtcblx0XHRcdC8vIEN1c3RvbSBjb21tYW5kIHRyaWdnZXIgLSBzaG93IHN0cnVjdHVyZWQgY29tbWFuZHNcblx0XHRcdHRoaXMuc2hvd1N0cnVjdHVyZWRDb21tYW5kUGlja2VyKGlucHV0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gdHJpZ2dlcnMgYWN0aXZlIC0gaGlkZSBjb21tYW5kIHBpY2tlclxuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdH1cblx0fVxuXG5cblx0LyoqXG5cdCAqIFNob3cgc3RydWN0dXJlZCBjb21tYW5kIHBpY2tlciBmb3IgXCI6XCIgdHJpZ2dlciAgXG5cdCAqL1xuXHRwcml2YXRlIHNob3dTdHJ1Y3R1cmVkQ29tbWFuZFBpY2tlcihpbnB1dDogc3RyaW5nKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbW1hbmRQaWNrZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3Qgc3RydWN0dXJlZENvbW1hbmRzID0gdGhpcy5nZXRTdHJ1Y3R1cmVkQ29tbWFuZHMoKTtcblx0XHRjb25zdCBmaWx0ZXJUZXh0ID0gaW5wdXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsgLy8gUmVtb3ZlIFwiOlwiXG5cdFx0XG5cdFx0Y29uc3QgZmlsdGVyZWQgPSBzdHJ1Y3R1cmVkQ29tbWFuZHMuZmlsdGVyKGNtZCA9PiBcblx0XHRcdGNtZC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdGNtZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdGNtZC5rZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4ga2V5d29yZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpKVxuXHRcdCk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5lbXB0eSgpO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblxuXHRcdGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRmaWx0ZXJlZC5mb3JFYWNoKChjbWQsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlci1pdGVtJyB9KTtcblx0XHRcdFx0aXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5uYW1lIH0pO1xuXHRcdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLmRlc2NyaXB0aW9uIH0pO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuODVlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IGV4YW1wbGVFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogYEV4YW1wbGU6ICR7Y21kLmV4YW1wbGV9YCB9KTtcblx0XHRcdFx0ZXhhbXBsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpO1xuXHRcdFx0XHRcdGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKGNtZC50ZW1wbGF0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gaW5kZXg7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cdH1cblxuXHRoYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuXHRcdGlmIChrZXkgPT09ICdBcnJvd0Rvd24nKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCArIDEsIHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEpO1xuXHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ0Fycm93VXAnKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gTWF0aC5tYXgodGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCAtIDEsIC0xKTtcblx0XHRcdHRoaXMudXBkYXRlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIGlmIChrZXkgPT09ICdUYWInICYmIHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPj0gMCkge1xuXHRcdFx0Ly8gVXNlIHRoZSBzYW1lIGxvZ2ljIGFzIGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24gZm9yIFRhYlxuXHRcdFx0cmV0dXJuIHRoaXMuaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPj0gMCAmJiB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPiAwKSB7XG5cdFx0XHQvLyBGb3Igc3RydWN0dXJlZCBjb21tYW5kcywgd2UgbmVlZCB0byBnZXQgdGhlIHNlbGVjdGVkIGNvbW1hbmQgZnJvbSB0aGUgZmlsdGVyZWQgbGlzdFxuXHRcdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldFN0cnVjdHVyZWRDb21tYW5kcygpO1xuXHRcdFx0Y29uc3QgaW5wdXQgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XHRpZiAoaW5wdXQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRcdGNvbnN0IGZpbHRlclRleHQgPSBpbnB1dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRjb25zdCBmaWx0ZXJlZCA9IGNvbW1hbmRzLmZpbHRlcihjbWQgPT4gXG5cdFx0XHRcdFx0Y21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0XHRcdGNtZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdFx0XHRjbWQua2V5d29yZHMuc29tZShrZXl3b3JkID0+IGtleXdvcmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSlcblx0XHRcdFx0KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4IDwgZmlsdGVyZWQubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc2VsZWN0ZWRDbWQgPSBmaWx0ZXJlZFt0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4XTtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKHNlbGVjdGVkQ21kLnRlbXBsYXRlKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpbmRleCA9PT0gdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCkge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZChjb21tYW5kOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGNvbW1hbmQgKyAnICcpO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCBlbmRcblx0XHRjb25zdCBsZW5ndGggPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkubGVuZ3RoO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZShsZW5ndGgsIGxlbmd0aCk7XG5cdFx0XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHR9XG5cblxuXHQvKipcblx0ICogR2V0IHN0cnVjdHVyZWQgY29tbWFuZHMgZm9yIFwiOlwiIHRyaWdnZXJcblx0ICovXG5cdHByaXZhdGUgZ2V0U3RydWN0dXJlZENvbW1hbmRzKCk6IFN0cnVjdHVyZWRDb21tYW5kW10ge1xuXHRcdHJldHVybiBbXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdBZGQgQ29udGVudCcsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnQWRkIG5ldyBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdhZGQnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2FkZCB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6YWRkIHBhcmFncmFwaCBhYm91dCBtZXRob2RvbG9neScsXG5cdFx0XHRcdGtleXdvcmRzOiBbJ2NyZWF0ZScsICduZXcnLCAnaW5zZXJ0JywgJ3dyaXRlJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdFZGl0IFNlbGVjdGlvbicsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnRWRpdCB0aGUgc2VsZWN0ZWQgdGV4dCcsXG5cdFx0XHRcdGNvbW1hbmQ6ICdlZGl0Jyxcblx0XHRcdFx0dGVtcGxhdGU6ICdlZGl0IHRvIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzplZGl0IHRvIGJlIG1vcmUgZm9ybWFsJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnbW9kaWZ5JywgJ3VwZGF0ZScsICdjaGFuZ2UnLCAncmV2aXNlJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdEZWxldGUgU2VsZWN0aW9uJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdSZW1vdmUgdGhlIHNlbGVjdGVkIHRleHQnLFxuXHRcdFx0XHRjb21tYW5kOiAnZGVsZXRlJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdkZWxldGUge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmRlbGV0ZSBzZWxlY3RlZCB0ZXh0Jyxcblx0XHRcdFx0a2V5d29yZHM6IFsncmVtb3ZlJywgJ2VsaW1pbmF0ZScsICdlcmFzZSddXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRuYW1lOiAnUmV3cml0ZScsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnUmV3cml0ZSBjb250ZW50IHdpdGggc3BlY2lmaWMgc3R5bGUnLFxuXHRcdFx0XHRjb21tYW5kOiAncmV3cml0ZScsXG5cdFx0XHRcdHRlbXBsYXRlOiAncmV3cml0ZSBhcyB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6cmV3cml0ZSBhcyBidWxsZXQgcG9pbnRzJyxcblx0XHRcdFx0a2V5d29yZHM6IFsncmVwaHJhc2UnLCAncmVzdHJ1Y3R1cmUnLCAncmV3b3JkJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdGaXggR3JhbW1hcicsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnQ29ycmVjdCBncmFtbWFyIGFuZCBzcGVsbGluZyBlcnJvcnMnLFxuXHRcdFx0XHRjb21tYW5kOiAnZ3JhbW1hcicsXG5cdFx0XHRcdHRlbXBsYXRlOiAnZml4IGdyYW1tYXIge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmZpeCBncmFtbWFyIGluIHNlbGVjdGlvbicsXG5cdFx0XHRcdGtleXdvcmRzOiBbJ2NvcnJlY3QnLCAncHJvb2ZyZWFkJywgJ3NwZWxsaW5nJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdDb250aW51ZScsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnQ29udGludWUgd3JpdGluZyBmcm9tIGN1cnJlbnQgcG9zaXRpb24nLFxuXHRcdFx0XHRjb21tYW5kOiAnY29udGludWUnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2NvbnRpbnVlIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzpjb250aW51ZSB3aXRoIGV4YW1wbGVzJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnZXh0ZW5kJywgJ2V4cGFuZCcsICdwcm9jZWVkJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdVcGRhdGUgTWV0YWRhdGEnLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogJ1VwZGF0ZSBkb2N1bWVudCBwcm9wZXJ0aWVzJyxcblx0XHRcdFx0Y29tbWFuZDogJ21ldGFkYXRhJyxcblx0XHRcdFx0dGVtcGxhdGU6ICd1cGRhdGUge2N1cnNvcn0gcHJvcGVydHknLFxuXHRcdFx0XHRleGFtcGxlOiAnOnVwZGF0ZSB0YWdzIHByb3BlcnR5Jyxcblx0XHRcdFx0a2V5d29yZHM6IFsnZnJvbnRtYXR0ZXInLCAncHJvcGVydGllcycsICd0YWdzJ11cblx0XHRcdH1cblx0XHRdO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNlbGVjdCBhIHN0cnVjdHVyZWQgY29tbWFuZCBhbmQgaW5zZXJ0IHRlbXBsYXRlXG5cdCAqL1xuXHRwcml2YXRlIHNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKHRlbXBsYXRlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XG5cdFx0Ly8gUmVwbGFjZSBjdXJzb3IgcGxhY2Vob2xkZXIgYW5kIGluc2VydCB0ZW1wbGF0ZVxuXHRcdGNvbnN0IGN1cnNvclBvcyA9IHRlbXBsYXRlLmluZGV4T2YoJ3tjdXJzb3J9Jyk7XG5cdFx0aWYgKGN1cnNvclBvcyAhPT0gLTEpIHtcblx0XHRcdGNvbnN0IGJlZm9yZUN1cnNvciA9IHRlbXBsYXRlLnNsaWNlKDAsIGN1cnNvclBvcyk7XG5cdFx0XHRjb25zdCBhZnRlckN1cnNvciA9IHRlbXBsYXRlLnNsaWNlKGN1cnNvclBvcyArIDgpOyAvLyBMZW5ndGggb2YgJ3tjdXJzb3J9J1xuXHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShiZWZvcmVDdXJzb3IgKyBhZnRlckN1cnNvcik7XG5cdFx0XHRcblx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciB3aGVyZSB7Y3Vyc29yfSB3YXNcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yUG9zLCBjdXJzb3JQb3MpO1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdH0sIDApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKHRlbXBsYXRlKTtcblx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY29tbWFuZE1lbnUucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXIpIHtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlci5yZW1vdmUoKTtcblx0XHR9XG5cdH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBQbGF0Zm9ybSwgVEZpbGUsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgTXVsdGlEb2NDb250ZXh0SGFuZGxlciwgTXVsdGlEb2NDb250ZXh0IH0gZnJvbSAnLi4vY29yZS9tdWx0aS1kb2MtY29udGV4dCc7XG5cbi8qKlxuICogSGFuZGxlcyBtdWx0aS1kb2N1bWVudCBjb250ZXh0IFVJIGFuZCBtYW5hZ2VtZW50XG4gKi9cbmV4cG9ydCBjbGFzcyBDb250ZXh0TWFuYWdlciB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGFwcDogQXBwO1xuXHRwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgbXVsdGlEb2NIYW5kbGVyOiBNdWx0aURvY0NvbnRleHRIYW5kbGVyO1xuXHRwdWJsaWMgY29udGV4dEluZGljYXRvciE6IEhUTUxFbGVtZW50O1xuXHRwdWJsaWMgY29udGV4dFByZXZpZXchOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjdXJyZW50Q29udGV4dDogTXVsdGlEb2NDb250ZXh0IHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE5PVElDRV9EVVJBVElPTl9NUyA9IDUwMDA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBhcHA6IEFwcCwgY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuYXBwID0gYXBwO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyID0gbmV3IE11bHRpRG9jQ29udGV4dEhhbmRsZXIoYXBwKTtcblx0fVxuXG5cdGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IC0ycHg7XG5cdFx0XHRyaWdodDogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0xKSB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0ei1pbmRleDogMTAwO1xuXHRcdFx0bWF4LXdpZHRoOiAyMDBweDtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRgO1xuXHR9XG5cblx0Y3JlYXRlQ29udGV4dFByZXZpZXcoKTogSFRNTEVsZW1lbnQge1xuXHRcdGNvbnN0IHByZXZpZXdDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsKTtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdMYWJlbCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IHRleHQ6ICdDb250ZXh0OiAnIH0pO1xuXHRcdHByZXZpZXdMYWJlbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC13ZWlnaHQ6IDYwMDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dFByZXZpZXcgfHwgIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0Zm91bmRSZWZzLnB1c2goeyBuYW1lOiBkb2NOYW1lLCBwcm9wZXJ0eSB9KTtcblx0XHR9XG5cblx0XHRpZiAoZm91bmRSZWZzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3IGRpc3BsYXlcblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdGNvbnN0IHJlZnNUZXh0ID0gZm91bmRSZWZzLm1hcChyZWYgPT4gXG5cdFx0XHRcdHJlZi5wcm9wZXJ0eSA/IGAke3JlZi5uYW1lfSMke3JlZi5wcm9wZXJ0eX1gIDogcmVmLm5hbWVcblx0XHRcdCkuam9pbignLCAnKTtcblx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gcmVmc1RleHQ7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdGFzeW5jIGJ1aWxkQ29udGV4dChtZXNzYWdlOiBzdHJpbmcsIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPE11bHRpRG9jQ29udGV4dCB8IG51bGw+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykgfHwgIWN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2UsIGN1cnJlbnRGaWxlKTtcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSByZXN1bHQuY29udGV4dDtcblxuXHRcdFx0aWYgKHJlc3VsdC5jb250ZXh0Py5wZXJzaXN0ZW50RG9jcy5sZW5ndGgpIHtcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKHJlc3VsdC5jb250ZXh0KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIHRva2VuIGxpbWl0XG5cdFx0XHRcdGlmIChyZXN1bHQuY29udGV4dC5pc05lYXJMaW1pdCkge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1x1MjZBMFx1RkUwRiBBcHByb2FjaGluZyB0b2tlbiBsaW1pdC4gQ29uc2lkZXIgcmVtb3Zpbmcgc29tZSBkb2N1bWVudHMgZnJvbSBjb250ZXh0LicsIENvbnRleHRNYW5hZ2VyLk5PVElDRV9EVVJBVElPTl9NUyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJlc3VsdC5jb250ZXh0O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBGYWlsZWQgdG8gYnVpbGQgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHJldHVybjtcblxuXHRcdGNvbnN0IGRvY0NvdW50ID0gY29udGV4dC5wZXJzaXN0ZW50RG9jcy5sZW5ndGg7XG5cdFx0aWYgKGRvY0NvdW50ID4gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnRleHRDb250ZW50ID0gYCR7ZG9jQ291bnR9IGRvYyR7ZG9jQ291bnQgPiAxID8gJ3MnIDogJyd9YDtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblxuXHRcdFx0Ly8gQWRkIGV4cGFuZCBmdW5jdGlvbmFsaXR5XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLm9uY2xpY2sgPSAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2hvd0NvbnRleHREZXRhaWxzKGNvbnRleHQpO1xuXHRcdFx0fTtcblxuXHRcdFx0Ly8gQWRkIGhvdmVyIGVmZmVjdFxuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWludGVyYWN0aXZlLWhvdmVyKSc7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtcHJpbWFyeSknO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbnRleHREZXRhaWxzKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHZvaWQge1xuXHRcdC8vIENyZWF0ZSBtb2RhbCBvciBleHBhbmRlZCB2aWV3XG5cdFx0Y29uc3QgbW9kYWwgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtbW9kYWwnIH0pO1xuXHRcdG1vZGFsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogZml4ZWQ7XG5cdFx0XHR0b3A6IDA7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRib3R0b206IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0ei1pbmRleDogMTAwMDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5jcmVhdGVEaXYoKTtcblx0XHRjb250ZW50LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTQpO1xuXHRcdFx0bWF4LXdpZHRoOiA4MCU7XG5cdFx0XHRtYXgtaGVpZ2h0OiA4MCU7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0Ym94LXNoYWRvdzogdmFyKC0tc2hhZG93LXMpO1xuXHRcdGA7XG5cblx0XHRjb25zdCBoZWFkZXIgPSBjb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0NvbnRleHQgRG9jdW1lbnRzJyB9KTtcblx0XHRoZWFkZXIuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tdG9wOiAwOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMyk7JztcblxuXHRcdGNvbnRleHQucGVyc2lzdGVudERvY3MuZm9yRWFjaChkb2MgPT4ge1xuXHRcdFx0Y29uc3QgZG9jRWwgPSBjb250ZW50LmNyZWF0ZURpdigpO1xuXHRcdFx0ZG9jRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMteHMpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gZG9jRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogZG9jLmZpbGUuYmFzZW5hbWUgfSk7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNjAwOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7JztcblxuXHRcdFx0aWYgKGRvYy5wcm9wZXJ0eSkge1xuXHRcdFx0XHRjb25zdCBwcm9wRWwgPSBkb2NFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBgUHJvcGVydHk6ICR7ZG9jLnByb3BlcnR5fWAgfSk7XG5cdFx0XHRcdHByb3BFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyc7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNob3cgZmlsZSBwYXRoIGFzIHByZXZpZXcgc2luY2UgY29udGVudCBpc24ndCBkaXJlY3RseSBhdmFpbGFibGVcblx0XHRcdGNvbnN0IHByZXZpZXdFbCA9IGRvY0VsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGRvYy5maWxlLnBhdGggfSk7XG5cdFx0XHRwcmV2aWV3RWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLXRvcDogdmFyKC0tc2l6ZS0yLTEpOyc7XG5cdFx0fSk7XG5cblx0XHRjb25zdCBjbG9zZUJ0biA9IGNvbnRlbnQuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0Nsb3NlJyB9KTtcblx0XHRjbG9zZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWFyZ2luLXRvcDogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xuXHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdGA7XG5cblx0XHRjbG9zZUJ0bi5vbmNsaWNrID0gKCkgPT4gbW9kYWwucmVtb3ZlKCk7XG5cdFx0bW9kYWwub25jbGljayA9IChlKSA9PiB7XG5cdFx0XHRpZiAoZS50YXJnZXQgPT09IG1vZGFsKSBtb2RhbC5yZW1vdmUoKTtcblx0XHR9O1xuXHR9XG5cblx0aGlkZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYXJDdXJyZW50Q29udGV4dCgpOiB2b2lkIHtcblx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbnVsbDtcblx0XHR0aGlzLmhpZGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0dGhpcy5oaWRlQ29udGV4dFByZXZpZXcoKTtcblx0fVxuXG5cdGdldEN1cnJlbnRDb250ZXh0KCk6IE11bHRpRG9jQ29udGV4dCB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRDb250ZXh0O1xuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHR0aGlzLmNsZWFyQ3VycmVudENvbnRleHQoKTtcblx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnJlbW92ZSgpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuXG4vKipcbiAqIEhhbmRsZXMgYWxsIGNoYXQgbWVzc2FnZSByZW5kZXJpbmcgYW5kIGRpc3BsYXkgbG9naWNcbiAqL1xuZXhwb3J0IGNsYXNzIENoYXRSZW5kZXJlciB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNoYXRDb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBTQ1JPTExfREVMQVlfTVMgPSA1MDtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE5vdmFQbHVnaW4sIGNoYXRDb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY2hhdENvbnRhaW5lcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgYSBjaGF0IG1lc3NhZ2Ugd2l0aCByb2xlIGhlYWRlclxuXHQgKi9cblx0YWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0zKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbCk7J1xuXHRcdFx0XHQ6ICdiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7J1xuXHRcdFx0fVxuXHRcdGA7XG5cblx0XHRjb25zdCByb2xlRWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgXG5cdFx0XHR0ZXh0OiByb2xlID09PSAndXNlcicgPyAnWW91JyA6IHJvbGUgPT09ICdzeXN0ZW0nID8gJ1N5c3RlbScgOiAnTm92YScsXG5cdFx0XHRjbHM6ICdub3ZhLW1lc3NhZ2Utcm9sZSdcblx0XHR9KTtcblx0XHRyb2xlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTtcblx0XHRcdG9wYWNpdHk6IDAuNztcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0Ly8gVXNlIGlubmVySFRNTCBmb3Igc3lzdGVtIG1lc3NhZ2VzIHRvIHN1cHBvcnQgaWNvbnMsIHRleHRDb250ZW50IGZvciBvdGhlcnMgZm9yIHNlY3VyaXR5XG5cdFx0aWYgKHJvbGUgPT09ICdzeXN0ZW0nICYmIGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0dGhpcy5zY3JvbGxUb0JvdHRvbSh0cnVlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBIZWxwZXIgbWV0aG9kIHRvIGNyZWF0ZSBzaW1wbGUgbWVzc2FnZXMgd2l0aG91dCByb2xlIGhlYWRlcnNcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlU2ltcGxlTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIGNsYXNzTmFtZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSAke2NsYXNzTmFtZX1gIH0pO1xuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0XG5cdFx0Ly8gU3VwcG9ydCBpY29ucyBpbiBtZXNzYWdlc1xuXHRcdGlmIChjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTtcblx0fVxuXG5cdGFkZEVycm9yTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmNyZWF0ZVNpbXBsZU1lc3NhZ2UoY29udGVudCwgJ25vdmEtbWVzc2FnZS1lcnJvcicpO1xuXHR9XG5cblx0YWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jcmVhdGVTaW1wbGVNZXNzYWdlKGNvbnRlbnQsICdub3ZhLW1lc3NhZ2Utc3VjY2VzcycpO1xuXHR9XG5cblx0YWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IHdlbGNvbWVFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUnIH0pO1xuXHRcdHdlbGNvbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTQpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBtZXNzYWdlIHx8IGBcblx0XHRcdDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgZ2FwOiB2YXIoLS1zaXplLTItMyk7IG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcIj5cblx0XHRcdFx0PHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogdmFyKC0taWNvbi1zaXplLXhsKTsgaGVpZ2h0OiB2YXIoLS1pY29uLXNpemUteGwpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcIj5cblx0XHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PC9zdmc+XG5cdFx0XHRcdDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiB2YXIoLS1mb250LXVpLWxhcmdlKTsgZm9udC13ZWlnaHQ6IDYwMDsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj5XZWxjb21lIHRvIE5vdmE8L3NwYW4+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxwIHN0eWxlPVwibWFyZ2luOiAwIDAgdmFyKC0tc2l6ZS00LTMpIDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7XCI+XG5cdFx0XHRcdFlvdXIgQUkgdGhpbmtpbmcgcGFydG5lciBmb3IgT2JzaWRpYW4uIFN0YXJ0IGEgY29udmVyc2F0aW9uIG9yIHVzZSBjb21tYW5kcyB0byBlbmhhbmNlIHlvdXIgd3JpdGluZy5cblx0XHRcdDwvcD5cblx0XHRcdDxwIHN0eWxlPVwibWFyZ2luOiAwOyBjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbCk7XCI+XG5cdFx0XHRcdFx1RDgzRFx1RENBMSA8c3Ryb25nPlRpcDo8L3N0cm9uZz4gUmVmZXJlbmNlIG90aGVyIG5vdGVzIHdpdGggW1tOb3RlIE5hbWVdXSBvciB1c2UgdGhlIFx1MjZBMSBidXR0b24gZm9yIHF1aWNrIGNvbW1hbmRzXG5cdFx0XHQ8L3A+XG5cdFx0YDtcblxuXHRcdHdlbGNvbWVFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXG5cdFx0Ly8gQWRkIGRpc21pc3MgYnV0dG9uXG5cdFx0Y29uc3QgZGlzbWlzc0J0biA9IHdlbGNvbWVFbC5jcmVhdGVFbCgnYnV0dG9uJyk7XG5cdFx0ZGlzbWlzc0J0bi50ZXh0Q29udGVudCA9ICdcdTAwRDcnO1xuXHRcdGRpc21pc3NCdG4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdHRvcDogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0cmlnaHQ6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktbGFyZ2UpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTEpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXhzKTtcblx0XHRgO1xuXG5cdFx0ZGlzbWlzc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHdlbGNvbWVFbC5yZW1vdmUoKTtcblx0XHR9KTtcblxuXHRcdGRpc21pc3NCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdGRpc21pc3NCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1ub3JtYWwpJztcblx0XHRcdGRpc21pc3NCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0fSk7XG5cblx0XHRkaXNtaXNzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdGRpc21pc3NCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHR9KTtcblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG5cdH1cblxuXHRjbGVhckNoYXQoKTogdm9pZCB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdH1cblxuXHRwcml2YXRlIHNjcm9sbFRvQm90dG9tKHNtb290aDogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAoc21vb3RoKSB7XG5cdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJ1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUb3AgPSB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0fVxuXHRcdH0sIENoYXRSZW5kZXJlci5TQ1JPTExfREVMQVlfTVMpO1xuXHR9XG5cblx0YXN5bmMgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNTApO1xuXHRcdC8vIERpc3BsYXkgbWVzc2FnZXMgaW4gdGhlIFVJXG5cdFx0Zm9yIChjb25zdCBtZXNzYWdlIG9mIG1lc3NhZ2VzKSB7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UobWVzc2FnZS5yb2xlIGFzICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbScsIG1lc3NhZ2UuY29udGVudCk7XG5cdFx0fVxuXHR9XG59IiwgIi8qKlxuICogVW5pZmllZCBzdHJlYW1pbmcgYW5kIG5vdGljZSBtYW5hZ2VtZW50IGZvciBOb3ZhXG4gKiBQcm92aWRlcyBjb25zaXN0ZW50IHZpc3VhbCBmZWVkYmFjayBhbmQgc3RyZWFtaW5nIGFjcm9zcyBhbGwgY29tbWFuZCB0eXBlc1xuICovXG5cbmltcG9ydCB7IEVkaXRvciwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0cmVhbWluZ09wdGlvbnMge1xuICAgIG9uQ2h1bms/OiAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4gdm9pZDtcbiAgICBvbkNvbXBsZXRlPzogKCkgPT4gdm9pZDtcbiAgICBvbkVycm9yPzogKGVycm9yOiBFcnJvcikgPT4gdm9pZDtcbn1cblxuZXhwb3J0IHR5cGUgQWN0aW9uVHlwZSA9ICdpbXByb3ZlJyB8ICdsb25nZXInIHwgJ3Nob3J0ZXInIHwgJ3RvbmUnIHwgJ2N1c3RvbScgfCAnY2hhdCcgfCAnYWRkJyB8ICdlZGl0JyB8ICdyZXdyaXRlJyB8ICdncmFtbWFyJyB8ICdkZWxldGUnO1xuXG5leHBvcnQgY2xhc3MgU3RyZWFtaW5nTWFuYWdlciB7XG4gICAgcHJpdmF0ZSBkb3RzQW5pbWF0aW9uSW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSB0aGlua2luZ05vdGljZTogTm90aWNlIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBjdXJyZW50U3RyZWFtaW5nRW5kUG9zOiBhbnkgPSBudWxsO1xuICAgIHByaXZhdGUgc3RyZWFtaW5nU3RhcnRQb3M6IGFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBvcmlnaW5hbFBvc2l0aW9uOiBhbnkgPSBudWxsO1xuXG4gICAgLy8gQ29tcHJlaGVuc2l2ZSB0aGlua2luZyBwaHJhc2VzIGZvciBhbGwgYWN0aW9uIHR5cGVzXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgVEhJTktJTkdfUEhSQVNFUzogUmVjb3JkPEFjdGlvblR5cGUsIHN0cmluZ1tdPiA9IHtcbiAgICAgICAgJ2ltcHJvdmUnOiBbXG4gICAgICAgICAgICAncmVmaW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3BvbGlzaGluZy4uLicsXG4gICAgICAgICAgICAnZW5oYW5jaW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAncGVyZmVjdGluZy4uLicsXG4gICAgICAgICAgICAnc21vb3RoaW5nLi4uJyxcbiAgICAgICAgICAgICdzaGFycGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdlbGV2YXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ZpbmUtdHVuaW5nLi4uJyxcbiAgICAgICAgICAgICdzY3VscHRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdsb25nZXInOiBbXG4gICAgICAgICAgICAnZXhwYW5kaW5nLi4uJyxcbiAgICAgICAgICAgICdkZXZlbG9waW5nLi4uJyxcbiAgICAgICAgICAgICdlbGFib3JhdGluZy4uLicsXG4gICAgICAgICAgICAnYnVpbGRpbmcuLi4nLFxuICAgICAgICAgICAgJ2VucmljaGluZy4uLicsXG4gICAgICAgICAgICAnZGVlcGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdncm93aW5nLi4uJyxcbiAgICAgICAgICAgICdleHRlbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2FtcGxpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ3VuZm9sZGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ3Nob3J0ZXInOiBbXG4gICAgICAgICAgICAnY29uZGVuc2luZy4uLicsXG4gICAgICAgICAgICAnZGlzdGlsbGluZy4uLicsXG4gICAgICAgICAgICAndGlnaHRlbmluZy4uLicsXG4gICAgICAgICAgICAnZm9jdXNpbmcuLi4nLFxuICAgICAgICAgICAgJ3N0cmVhbWxpbmluZy4uLicsXG4gICAgICAgICAgICAnY29tcHJlc3NpbmcuLi4nLFxuICAgICAgICAgICAgJ3RyaW1taW5nLi4uJyxcbiAgICAgICAgICAgICdjbGFyaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdzaW1wbGlmeWluZy4uLicsXG4gICAgICAgICAgICAnY29uY2VudHJhdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ3RvbmUnOiBbXG4gICAgICAgICAgICAnYWRqdXN0aW5nIHRvbmUuLi4nLFxuICAgICAgICAgICAgJ3Jlc2hhcGluZy4uLicsXG4gICAgICAgICAgICAncmVmcmFtaW5nLi4uJyxcbiAgICAgICAgICAgICdhZGFwdGluZy4uLicsXG4gICAgICAgICAgICAndHJhbnNmb3JtaW5nLi4uJyxcbiAgICAgICAgICAgICdtb2R1bGF0aW5nLi4uJyxcbiAgICAgICAgICAgICdyZWNhc3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoaWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdyZWZvcm1pbmcuLi4nLFxuICAgICAgICAgICAgJ3JlaW1hZ2luaW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnY3VzdG9tJzogW1xuICAgICAgICAgICAgJ3dvcmtpbmcgb24gaXQuLi4nLFxuICAgICAgICAgICAgJ2NvbnNpZGVyaW5nLi4uJyxcbiAgICAgICAgICAgICd0aGlua2luZy4uLicsXG4gICAgICAgICAgICAncHJvY2Vzc2luZy4uLicsXG4gICAgICAgICAgICAnYW5hbHl6aW5nLi4uJyxcbiAgICAgICAgICAgICdjb250ZW1wbGF0aW5nLi4uJyxcbiAgICAgICAgICAgICd1bmRlcnN0YW5kaW5nLi4uJyxcbiAgICAgICAgICAgICdpbnRlcnByZXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2V4cGxvcmluZy4uLicsXG4gICAgICAgICAgICAnZXZhbHVhdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2NoYXQnOiBbXG4gICAgICAgICAgICAnY29tcG9zaW5nLi4uJyxcbiAgICAgICAgICAgICdkcmFmdGluZy4uLicsXG4gICAgICAgICAgICAnY3JlYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2dlbmVyYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3dyaXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdmb3JtdWxhdGluZy4uLicsXG4gICAgICAgICAgICAnZGV2ZWxvcGluZy4uLicsXG4gICAgICAgICAgICAnYnVpbGRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbnN0cnVjdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2FkZCc6IFtcbiAgICAgICAgICAgICdjb21wb3NpbmcuLi4nLFxuICAgICAgICAgICAgJ2RyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdjcmVhdGluZy4uLicsXG4gICAgICAgICAgICAnZ2VuZXJhdGluZy4uLicsXG4gICAgICAgICAgICAnd3JpdGluZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ2Zvcm11bGF0aW5nLi4uJyxcbiAgICAgICAgICAgICdkZXZlbG9waW5nLi4uJyxcbiAgICAgICAgICAgICdidWlsZGluZy4uLicsXG4gICAgICAgICAgICAnY29uc3RydWN0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnZWRpdCc6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ3Jld3JpdGUnOiBbXG4gICAgICAgICAgICAncmVmaW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3BvbGlzaGluZy4uLicsXG4gICAgICAgICAgICAnZW5oYW5jaW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAncGVyZmVjdGluZy4uLicsXG4gICAgICAgICAgICAnc21vb3RoaW5nLi4uJyxcbiAgICAgICAgICAgICdzaGFycGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdlbGV2YXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ZpbmUtdHVuaW5nLi4uJyxcbiAgICAgICAgICAgICdzY3VscHRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdncmFtbWFyJzogW1xuICAgICAgICAgICAgJ3JlZmluaW5nLi4uJyxcbiAgICAgICAgICAgICdwb2xpc2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2VuaGFuY2luZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3BlcmZlY3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3Ntb290aGluZy4uLicsXG4gICAgICAgICAgICAnc2hhcnBlbmluZy4uLicsXG4gICAgICAgICAgICAnZWxldmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdmaW5lLXR1bmluZy4uLicsXG4gICAgICAgICAgICAnc2N1bHB0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnZGVsZXRlJzogW1xuICAgICAgICAgICAgJ2NvbmRlbnNpbmcuLi4nLFxuICAgICAgICAgICAgJ2Rpc3RpbGxpbmcuLi4nLFxuICAgICAgICAgICAgJ3RpZ2h0ZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2ZvY3VzaW5nLi4uJyxcbiAgICAgICAgICAgICdzdHJlYW1saW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbXByZXNzaW5nLi4uJyxcbiAgICAgICAgICAgICd0cmltbWluZy4uLicsXG4gICAgICAgICAgICAnY2xhcmlmeWluZy4uLicsXG4gICAgICAgICAgICAnc2ltcGxpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbmNlbnRyYXRpbmcuLi4nXG4gICAgICAgIF1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU2hvdyB0aGlua2luZyBub3RpY2Ugd2l0aCBjb250ZXh0LWF3YXJlIHBocmFzZSBhbmQgYW5pbWF0ZWQgZG90c1xuICAgICAqL1xuICAgIHNob3dUaGlua2luZ05vdGljZShhY3Rpb25UeXBlOiBBY3Rpb25UeXBlKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBTZWxlY3QgcmFuZG9tIHBocmFzZSBiYXNlZCBvbiBhY3Rpb24gdHlwZVxuICAgICAgICAgICAgY29uc3QgcGhyYXNlcyA9IFN0cmVhbWluZ01hbmFnZXIuVEhJTktJTkdfUEhSQVNFU1thY3Rpb25UeXBlXSB8fCBTdHJlYW1pbmdNYW5hZ2VyLlRISU5LSU5HX1BIUkFTRVNbJ2NoYXQnXTtcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbVBocmFzZSA9IHBocmFzZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGhyYXNlcy5sZW5ndGgpXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ3JlYXRlIHBlcnNpc3RlbnQgbm90aWNlICgwIHRpbWVvdXQgPSBtYW51YWwgZGlzbWlzc2FsKVxuICAgICAgICAgICAgdGhpcy50aGlua2luZ05vdGljZSA9IG5ldyBOb3RpY2UoYE5vdmE6ICR7cmFuZG9tUGhyYXNlfS5gLCAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2hvdyBpbml0aWFsIHN0YXRlIHdpdGggMSBkb3QgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxOb3RpY2VUZXh0ID0gYE5vdmE6ICR7cmFuZG9tUGhyYXNlfS5gO1xuICAgICAgICAgICAgY29uc3Qgbm90aWNlRWwgPSAodGhpcy50aGlua2luZ05vdGljZSBhcyBhbnkpLm5vdGljZUVsO1xuICAgICAgICAgICAgaWYgKG5vdGljZUVsKSB7XG4gICAgICAgICAgICAgICAgbm90aWNlRWwudGV4dENvbnRlbnQgPSBpbml0aWFsTm90aWNlVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RhcnQgZG90cyBhbmltYXRpb24gaW4gbm90aWNlXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Tm90aWNlRG90c0FuaW1hdGlvbihyYW5kb21QaHJhc2UpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjcmVhdGUgdGhpbmtpbmcgbm90aWNlOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHN0cmVhbWluZyBhdCBhIHNwZWNpZmljIHBvc2l0aW9uIHdpdGggaHlicmlkIGFwcHJvYWNoXG4gICAgICogRm9yIHNlbGVjdGlvbiByZXBsYWNlbWVudDogc3RhcnRQb3MgYW5kIGVuZFBvcyBkZWZpbmUgdGhlIHJhbmdlIHRvIHJlcGxhY2VcbiAgICAgKiBGb3IgY3Vyc29yIGluc2VydGlvbjogc3RhcnRQb3MgaXMgdGhlIGN1cnNvciBwb3NpdGlvbiwgZW5kUG9zIHNob3VsZCBiZSBudWxsXG4gICAgICovXG4gICAgc3RhcnRTdHJlYW1pbmcoXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLCBcbiAgICAgICAgc3RhcnRQb3M6IGFueSwgXG4gICAgICAgIGVuZFBvcz86IGFueSwgXG4gICAgICAgIG9wdGlvbnM6IFN0cmVhbWluZ09wdGlvbnMgPSB7fVxuICAgICk6IHtcbiAgICAgICAgdXBkYXRlU3RyZWFtOiAobmV3VGV4dDogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB2b2lkO1xuICAgICAgICBzdG9wU3RyZWFtOiAoKSA9PiB2b2lkO1xuICAgIH0ge1xuICAgICAgICAvLyBTdG9yZSBvcmlnaW5hbCBwb3NpdGlvbihzKVxuICAgICAgICB0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB7IGZyb206IHN0YXJ0UG9zLCB0bzogZW5kUG9zIH07XG4gICAgICAgIFxuICAgICAgICBpZiAoZW5kUG9zKSB7XG4gICAgICAgICAgICAvLyBTZWxlY3Rpb24gcmVwbGFjZW1lbnQgbW9kZSAtIGNsZWFyIHRoZSBzZWxlY3Rpb25cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJycsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zID0gc3RhcnRQb3M7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBDdXJzb3IgaW5zZXJ0aW9uIG1vZGUgLSBzZXQgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zID0gc3RhcnRQb3M7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgPSBudWxsOyAvLyBXaWxsIGJlIHNldCBvbiBmaXJzdCBjaHVua1xuXG4gICAgICAgIGNvbnN0IHVwZGF0ZVN0cmVhbSA9IChuZXdUZXh0OiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RyZWFtaW5nVGV4dChlZGl0b3IsIG5ld1RleHQsIGlzQ29tcGxldGUsIG9wdGlvbnMpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHN0b3BTdHJlYW0gPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzdHJlYW1pbmcgdGV4dCB3aXRoIHByb3BlciBwb3NpdGlvbiB0cmFja2luZ1xuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlU3RyZWFtaW5nVGV4dChcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBuZXdUZXh0OiBzdHJpbmcsIFxuICAgICAgICBpc0NvbXBsZXRlOiBib29sZWFuLFxuICAgICAgICBvcHRpb25zOiBTdHJlYW1pbmdPcHRpb25zXG4gICAgKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zKSB7XG4gICAgICAgICAgICAgICAgLy8gU3RvcCB0aGUgbm90aWNlIGFuaW1hdGlvbiBzaW5jZSBzdHJlYW1pbmcgaXMgc3RhcnRpbmcgKG9ubHkgb24gZmlyc3QgY2h1bmspXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGhpbmtpbmdOb3RpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgc3RhcnQgcG9zaXRpb24geWV0LCBzZXQgaXRcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3RyZWFtaW5nU3RhcnRQb3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IHsgLi4udGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgZW5kIHBvc2l0aW9uIGJhc2VkIG9uIHRoZSBjb21wbGV0ZSBuZXcgdGV4dFxuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gbmV3VGV4dC5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RW5kUG9zID0ge1xuICAgICAgICAgICAgICAgICAgICBsaW5lOiB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zLmxpbmUgKyBsaW5lcy5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICAgICBjaDogbGluZXMubGVuZ3RoID4gMSA/IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLmxlbmd0aCA6IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MuY2ggKyBuZXdUZXh0Lmxlbmd0aFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGFsbCBjb250ZW50IGZyb20gc3RhcnQgdG8gY3VycmVudCBlbmQgd2l0aCBuZXcgdGV4dFxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3VGV4dCwgdGhpcy5zdHJlYW1pbmdTdGFydFBvcywgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBuZXdFbmRQb3M7XG5cbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIGNodW5rIGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMub25DaHVuaykge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm9uQ2h1bmsobmV3VGV4dCwgaXNDb21wbGV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTZXQgY3Vyc29yIGF0IHRoZSBlbmQgb2YgdGhlIG5ldyB0ZXh0IG9ubHkgd2hlbiBjb21wbGV0ZVxuICAgICAgICAgICAgaWYgKGlzQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBjb21wbGV0aW9uIGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMub25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm9uQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Vycm9yIHVwZGF0aW5nIHN0cmVhbWluZyB0ZXh0OicsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIGVycm9yIGNhbGxiYWNrXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5vbkVycm9yKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbmltYXRlIGRvdHMgaW4gbm90aWNlIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0Tm90aWNlRG90c0FuaW1hdGlvbihiYXNlUGhyYXNlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgbGV0IGRvdENvdW50ID0gMTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudGhpbmtpbmdOb3RpY2UpIHJldHVybjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBkb3RDb3VudCsrO1xuICAgICAgICAgICAgICAgIGlmIChkb3RDb3VudCA+IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgZG90Q291bnQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBkb3RzID0gJy4nLnJlcGVhdChkb3RDb3VudCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm90aWNlVGV4dCA9IGBOb3ZhOiAke2Jhc2VQaHJhc2V9JHtkb3RzfWA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIG5vdGljZSB0ZXh0IGRpcmVjdGx5XG4gICAgICAgICAgICAgICAgY29uc3Qgbm90aWNlRWwgPSAodGhpcy50aGlua2luZ05vdGljZSBhcyBhbnkpLm5vdGljZUVsO1xuICAgICAgICAgICAgICAgIGlmIChub3RpY2VFbCkge1xuICAgICAgICAgICAgICAgICAgICBub3RpY2VFbC50ZXh0Q29udGVudCA9IG5vdGljZVRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Vycm9yIGluIG5vdGljZSBkb3RzIGFuaW1hdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCA0MDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3AgdGhlIGRvdHMgYW5pbWF0aW9uIGFuZCBkaXNtaXNzIG5vdGljZVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RvcERvdHNBbmltYXRpb24oKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERpc21pc3MgdGhpbmtpbmcgbm90aWNlXG4gICAgICAgIGlmICh0aGlzLnRoaW5raW5nTm90aWNlKSB7XG4gICAgICAgICAgICB0aGlzLnRoaW5raW5nTm90aWNlLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcCBhbGwgYW5pbWF0aW9ucyBhbmQgY2xlYW4gdXBcbiAgICAgKi9cbiAgICBzdG9wQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgYWxsIGludGVybmFsIHN0YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBjbGVhbnVwKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBudWxsO1xuICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIG9yaWdpbmFsIHBvc2l0aW9uIGJlZm9yZSBzdHJlYW1pbmcgc3RhcnRlZFxuICAgICAqL1xuICAgIGdldE9yaWdpbmFsUG9zaXRpb24oKTogeyBmcm9tOiBhbnk7IHRvPzogYW55IH0gfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZ2luYWxQb3NpdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBjdXJyZW50bHkgc3RyZWFtaW5nXG4gICAgICovXG4gICAgaXNTdHJlYW1pbmcoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgIT09IG51bGw7XG4gICAgfVxufSIsICIvKipcbiAqIFNlbGVjdGlvbi1iYXNlZCBjb250ZXh0IG1lbnUgZm9yIE5vdmFcbiAqIEFkZHMgTm92YSBzdWJtZW51IHRvIE9ic2lkaWFuJ3MgcmlnaHQtY2xpY2sgY29udGV4dCBtZW51IHdoZW4gdGV4dCBpcyBzZWxlY3RlZFxuICovXG5cbmltcG9ydCB7IEFwcCwgRWRpdG9yLCBNZW51LCBNZW51SXRlbSwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBTZWxlY3Rpb25FZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvY29tbWFuZHMvc2VsZWN0aW9uLWVkaXQtY29tbWFuZCc7XG5pbXBvcnQgeyBUb25lU2VsZWN0aW9uTW9kYWwgfSBmcm9tICcuL3RvbmUtc2VsZWN0aW9uLW1vZGFsJztcbmltcG9ydCB7IEN1c3RvbUluc3RydWN0aW9uTW9kYWwgfSBmcm9tICcuL2N1c3RvbS1pbnN0cnVjdGlvbi1tb2RhbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0aW9uQWN0aW9uIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgaWNvbj86IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IFNFTEVDVElPTl9BQ1RJT05TOiBTZWxlY3Rpb25BY3Rpb25bXSA9IFtcbiAgICB7XG4gICAgICAgIGlkOiAnaW1wcm92ZScsXG4gICAgICAgIGxhYmVsOiAnSW1wcm92ZSBXcml0aW5nJyxcbiAgICAgICAgaWNvbjogJ3NwYXJrbGVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdNYWtlIHRleHQgY2xlYXJlciwgbW9yZSBjb25jaXNlLCBiZXR0ZXIgZmxvdydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdsb25nZXInLFxuICAgICAgICBsYWJlbDogJ01ha2UgTG9uZ2VyJyxcbiAgICAgICAgaWNvbjogJ3BsdXMtY2lyY2xlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdFeHBhbmQgaWRlYXMgd2l0aCBtb3JlIGRldGFpbCBhbmQgZXhhbXBsZXMnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnc2hvcnRlcicsXG4gICAgICAgIGxhYmVsOiAnTWFrZSBTaG9ydGVyJyxcbiAgICAgICAgaWNvbjogJ21pbnVzLWNpcmNsZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29uZGVuc2UgdG8gZXNzZW50aWFsIHBvaW50cydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICd0b25lJyxcbiAgICAgICAgbGFiZWw6ICdDaGFuZ2UgVG9uZScsXG4gICAgICAgIGljb246ICdwYWxldHRlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZGp1c3Qgd3JpdGluZyBzdHlsZSBhbmQgdG9uZSdcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdjdXN0b20nLFxuICAgICAgICBsYWJlbDogJ1RlbGwgTm92YS4uLicsXG4gICAgICAgIGljb246ICdtZXNzYWdlLWNpcmNsZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ3VzdG9tIGluc3RydWN0aW9uIGZvciB0cmFuc2Zvcm1hdGlvbidcbiAgICB9XG5dO1xuXG5leHBvcnQgY2xhc3MgU2VsZWN0aW9uQ29udGV4dE1lbnUge1xuICAgIHByaXZhdGUgc2VsZWN0aW9uRWRpdENvbW1hbmQ6IFNlbGVjdGlvbkVkaXRDb21tYW5kO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luXG4gICAgKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uRWRpdENvbW1hbmQgPSBuZXcgU2VsZWN0aW9uRWRpdENvbW1hbmQocGx1Z2luKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciB0aGUgY29udGV4dCBtZW51IHdpdGggT2JzaWRpYW4ncyBlZGl0b3JcbiAgICAgKi9cbiAgICByZWdpc3RlcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLW1lbnUnLCAobWVudTogTWVudSwgZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZE5vdmFTdWJtZW51KG1lbnUsIGVkaXRvcik7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBOb3ZhIHN1Ym1lbnUgdG8gdGhlIGNvbnRleHQgbWVudSBpZiB0ZXh0IGlzIHNlbGVjdGVkXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGROb3ZhU3VibWVudShtZW51OiBNZW51LCBlZGl0b3I6IEVkaXRvcik6IHZvaWQge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBPbmx5IHNob3cgTm92YSBzdWJtZW51IHdoZW4gdGV4dCBpcyBzZWxlY3RlZFxuICAgICAgICBpZiAoIXNlbGVjdGVkVGV4dCB8fCBzZWxlY3RlZFRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHNlcGFyYXRvciBiZWZvcmUgTm92YSBzdWJtZW51IGZvciB2aXN1YWwgY2xhcml0eVxuICAgICAgICBtZW51LmFkZFNlcGFyYXRvcigpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBOb3ZhIGFjdGlvbiBpdGVtcyBkaXJlY3RseSAobm8gc3RhbmRhbG9uZSBOb3ZhIGl0ZW0pXG4gICAgICAgIFNFTEVDVElPTl9BQ1RJT05TLmZvckVhY2goYWN0aW9uID0+IHtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbTogTWVudUl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgTm92YTogJHthY3Rpb24ubGFiZWx9YClcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oYWN0aW9uLmljb24gfHwgJ2VkaXQnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVNlbGVjdGlvbkFjdGlvbihhY3Rpb24uaWQsIGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgc2VsZWN0aW9uIGFjdGlvbiB3aGVuIG1lbnUgaXRlbSBpcyBjbGlja2VkXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZVNlbGVjdGlvbkFjdGlvbihhY3Rpb25JZDogc3RyaW5nLCBlZGl0b3I6IEVkaXRvciwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgdG9uZSBzZWxlY3Rpb24gd2l0aCBtb2RhbCAod2hlbiBubyBzcGVjaWZpYyB0b25lIHByb3ZpZGVkKVxuICAgICAgICAgICAgaWYgKGFjdGlvbklkID09PSAndG9uZScgJiYgIWN1c3RvbUluc3RydWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93VG9uZVNlbGVjdGlvbk1vZGFsKGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChhY3Rpb25JZCA9PT0gJ2N1c3RvbScgJiYgIWN1c3RvbUluc3RydWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93Q3VzdG9tSW5zdHJ1Y3Rpb25Nb2RhbChlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSBzZWxlY3Rpb24gZWRpdCBjb21tYW5kIGZvciBvdGhlciBhY3Rpb25zIG9yIGRpcmVjdCB0b25lL2N1c3RvbSBjYWxsc1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlU2VsZWN0aW9uRWRpdChhY3Rpb25JZCwgZWRpdG9yLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyBOb3ZhIHNlbGVjdGlvbiBhY3Rpb246JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGV4ZWN1dGUgTm92YSBhY3Rpb24uIFBsZWFzZSB0cnkgYWdhaW4uJywgMzAwMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRvbmUgc2VsZWN0aW9uIG1vZGFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93VG9uZVNlbGVjdGlvbk1vZGFsKGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBUb25lU2VsZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICB0aGlzLmFwcCxcbiAgICAgICAgICAgIGFzeW5jIChzZWxlY3RlZFRvbmU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgdG9uZSBjaGFuZ2Ugd2l0aCB0aGUgc2VsZWN0ZWQgdG9uZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVNlbGVjdGlvbkVkaXQoJ3RvbmUnLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCwgc2VsZWN0ZWRUb25lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBjYW5jZWxsZWQsIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgbW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgY3VzdG9tIGluc3RydWN0aW9uIG1vZGFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93Q3VzdG9tSW5zdHJ1Y3Rpb25Nb2RhbChlZGl0b3I6IEVkaXRvciwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgQ3VzdG9tSW5zdHJ1Y3Rpb25Nb2RhbChcbiAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgYXN5bmMgKGluc3RydWN0aW9uOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIGN1c3RvbSB0cmFuc2Zvcm1hdGlvbiB3aXRoIHRoZSBpbnN0cnVjdGlvblxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVNlbGVjdGlvbkVkaXQoJ2N1c3RvbScsIGVkaXRvciwgc2VsZWN0ZWRUZXh0LCBpbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgY2FuY2VsbGVkLCBkbyBub3RoaW5nXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIHRoZSBzZWxlY3Rpb24gZWRpdCBjb21tYW5kIHdpdGggc3RyZWFtaW5nXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlU2VsZWN0aW9uRWRpdChcbiAgICAgICAgYWN0aW9uSWQ6IHN0cmluZywgXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLCBcbiAgICAgICAgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIFxuICAgICAgICBjdXN0b21JbnN0cnVjdGlvbj86IHN0cmluZ1xuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBTdGFydCBzZWxlY3Rpb24gYW5pbWF0aW9uXG4gICAgICAgIHRoaXMuc3RhcnRTZWxlY3Rpb25BbmltYXRpb24oZWRpdG9yKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFN0b3JlIG9yaWdpbmFsIHNlbGVjdGlvbiByYW5nZVxuICAgICAgICBjb25zdCBvcmlnaW5hbFJhbmdlID0ge1xuICAgICAgICAgICAgZnJvbTogZWRpdG9yLmdldEN1cnNvcignZnJvbScpLFxuICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBTaG93IE5vdmEgdGhpbmtpbmcgYW5pbWF0aW9uIHdoaWxlIHdhaXRpbmcgZm9yIHN0cmVhbVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zaG93VGhpbmtpbmdBbmltYXRpb24oZWRpdG9yLCBvcmlnaW5hbFJhbmdlLmZyb20sIG9yaWdpbmFsUmFuZ2UudG8sIGFjdGlvbklkKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyB0byBwcm9ncmVzc2l2ZWx5IHJlcGxhY2UgdGV4dFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zZWxlY3Rpb25FZGl0Q29tbWFuZC5leGVjdXRlU3RyZWFtaW5nKFxuICAgICAgICAgICAgICAgIGFjdGlvbklkLCBcbiAgICAgICAgICAgICAgICBlZGl0b3IsIFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkVGV4dCxcbiAgICAgICAgICAgICAgICAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBQcm9ncmVzc2l2ZSB0ZXh0IHJlcGxhY2VtZW50IHdpdGggdHlwZXdyaXRlciBlZmZlY3RcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdHJlYW1pbmdUZXh0KGVkaXRvciwgY2h1bmssIG9yaWdpbmFsUmFuZ2UuZnJvbSwgaXNDb21wbGV0ZSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjdXN0b21JbnN0cnVjdGlvblxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uTmFtZSA9IHRoaXMuZ2V0QWN0aW9uRGlzcGxheU5hbWUoYWN0aW9uSWQpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE5vdmE6IFRleHQgJHthY3Rpb25OYW1lfSBzdWNjZXNzZnVsbHlgLCAyMDAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBBZGQgc3VjY2VzcyBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFN1Y2Nlc3NDaGF0TWVzc2FnZShhY3Rpb25JZCwgc2VsZWN0ZWRUZXh0LCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE5vdmE6ICR7cmVzdWx0LmVycm9yIHx8ICdGYWlsZWQgdG8gcHJvY2VzcyB0ZXh0J31gLCAzMDAwKTtcbiAgICAgICAgICAgICAgICAvLyBBZGQgZmFpbHVyZSBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEZhaWx1cmVDaGF0TWVzc2FnZShhY3Rpb25JZCwgcmVzdWx0LmVycm9yIHx8ICdGYWlsZWQgdG8gcHJvY2VzcyB0ZXh0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzdHJlYW1pbmcgc2VsZWN0aW9uIGVkaXQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGV4ZWN1dGUgTm92YSBhY3Rpb24uIFBsZWFzZSB0cnkgYWdhaW4uJywgMzAwMCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAvLyBBbHdheXMgc3RvcCBhbmltYXRpb25zIGFuZCBjbGVhbiB1cFxuICAgICAgICAgICAgdGhpcy5zdG9wU2VsZWN0aW9uQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGV4dCB3aXRoIHN0cmVhbWluZyBlZmZlY3RcbiAgICAgKi9cbiAgICBwcml2YXRlIGN1cnJlbnRTdHJlYW1pbmdFbmRQb3M6IGFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdHJlYW1pbmdUZXh0Q29udGFpbmVyOiBIVE1MU3BhbkVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICAgIHByaXZhdGUgc3RyZWFtaW5nU3RhcnRQb3M6IGFueSA9IG51bGw7XG5cbiAgICBwcml2YXRlIHVwZGF0ZVN0cmVhbWluZ1RleHQoXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLCBcbiAgICAgICAgbmV3VGV4dDogc3RyaW5nLCBcbiAgICAgICAgc3RhcnRQb3M6IGFueSwgXG4gICAgICAgIGlzQ29tcGxldGU6IGJvb2xlYW5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpIHtcbiAgICAgICAgICAgICAgICAvLyBTdG9wIHRoZSBub3RpY2UgYW5pbWF0aW9uIHNpbmNlIHN0cmVhbWluZyBpcyBzdGFydGluZyAob25seSBvbiBmaXJzdCBjaHVuaylcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aGlua2luZ05vdGljZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSBzdGFydCBwb3NpdGlvbiB5ZXQsIHNldCBpdFxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdHJlYW1pbmdTdGFydFBvcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0geyAuLi50aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBlbmQgcG9zaXRpb24gYmFzZWQgb24gdGhlIGNvbXBsZXRlIG5ldyB0ZXh0XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBuZXdUZXh0LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdFbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MubGluZSArIGxpbmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBsaW5lcy5sZW5ndGggPiAxID8gbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoIDogdGhpcy5zdHJlYW1pbmdTdGFydFBvcy5jaCArIG5ld1RleHQubGVuZ3RoXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYWxsIGNvbnRlbnQgZnJvbSBzdGFydCB0byBjdXJyZW50IGVuZCB3aXRoIG5ldyB0ZXh0XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdUZXh0LCB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zLCB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG5ld0VuZFBvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGN1cnNvciBhdCB0aGUgZW5kIG9mIHRoZSBuZXcgdGV4dCBvbmx5IHdoZW4gY29tcGxldGVcbiAgICAgICAgICAgIGlmIChpc0NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG51bGw7IC8vIFJlc2V0IGZvciBuZXh0IHVzZVxuICAgICAgICAgICAgICAgIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgPSBudWxsOyAvLyBSZXNldCBzdGFydCBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZSA9IG51bGw7IC8vIENsZWFyIHNlbGVjdGlvbiByZWZlcmVuY2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgdXBkYXRpbmcgc3RyZWFtaW5nIHRleHQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcHVsc2luZyBhbmltYXRpb24gb24gc2VsZWN0ZWQgdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRTZWxlY3Rpb25BbmltYXRpb24oZWRpdG9yOiBFZGl0b3IpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGVkaXRvciBjb250YWluZXIgaW4gdGhlIERPTVxuICAgICAgICAgICAgY29uc3QgZWRpdG9yQ29udGFpbmVyID0gKGVkaXRvciBhcyBhbnkpLmNtPy5kb20gfHwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNtLWVkaXRvcicpO1xuICAgICAgICAgICAgaWYgKGVkaXRvckNvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIGVkaXRvckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdub3ZhLXNlbGVjdGlvbi1wcm9jZXNzaW5nJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBvcmlnaW5hbCBzZWxlY3Rpb24gZm9yIGxhdGVyIGNsZWFudXBcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGVkU2VsZWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICAgICAgICAgIHRvOiBlZGl0b3IuZ2V0Q3Vyc29yKCd0bycpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHN0YXJ0IHNlbGVjdGlvbiBhbmltYXRpb246JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcCBwdWxzaW5nIGFuaW1hdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgc3RvcFNlbGVjdGlvbkFuaW1hdGlvbigpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSBhbmltYXRpb24gY2xhc3MgZnJvbSBhbGwgcG9zc2libGUgZWRpdG9yIGVsZW1lbnRzXG4gICAgICAgICAgICBjb25zdCBlZGl0b3JFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5Db2RlTWlycm9yLCAuY20tZWRpdG9yJyk7XG4gICAgICAgICAgICBlZGl0b3JFbGVtZW50cy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdub3ZhLXNlbGVjdGlvbi1wcm9jZXNzaW5nJyk7XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGVkU2VsZWN0aW9uID0gbnVsbDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHN0b3Agc2VsZWN0aW9uIGFuaW1hdGlvbjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFuaW1hdGVkU2VsZWN0aW9uOiB7IGZyb206IGFueTsgdG86IGFueSB9IHwgbnVsbCA9IG51bGw7XG5cbiAgICAvLyBEeW5hbWljIHRoaW5raW5nIHBocmFzZXMgZm9yIGVhY2ggYWN0aW9uIHR5cGVcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBUSElOS0lOR19QSFJBU0VTID0ge1xuICAgICAgICAnaW1wcm92ZSc6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2xvbmdlcic6IFtcbiAgICAgICAgICAgICdleHBhbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2RldmVsb3BpbmcuLi4nLFxuICAgICAgICAgICAgJ2VsYWJvcmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdidWlsZGluZy4uLicsXG4gICAgICAgICAgICAnZW5yaWNoaW5nLi4uJyxcbiAgICAgICAgICAgICdkZWVwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2dyb3dpbmcuLi4nLFxuICAgICAgICAgICAgJ2V4dGVuZGluZy4uLicsXG4gICAgICAgICAgICAnYW1wbGlmeWluZy4uLicsXG4gICAgICAgICAgICAndW5mb2xkaW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnc2hvcnRlcic6IFtcbiAgICAgICAgICAgICdjb25kZW5zaW5nLi4uJyxcbiAgICAgICAgICAgICdkaXN0aWxsaW5nLi4uJyxcbiAgICAgICAgICAgICd0aWdodGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdmb2N1c2luZy4uLicsXG4gICAgICAgICAgICAnc3RyZWFtbGluaW5nLi4uJyxcbiAgICAgICAgICAgICdjb21wcmVzc2luZy4uLicsXG4gICAgICAgICAgICAndHJpbW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2NsYXJpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ3NpbXBsaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdjb25jZW50cmF0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAndG9uZSc6IFtcbiAgICAgICAgICAgICdhZGp1c3RpbmcgdG9uZS4uLicsXG4gICAgICAgICAgICAncmVzaGFwaW5nLi4uJyxcbiAgICAgICAgICAgICdyZWZyYW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2FkYXB0aW5nLi4uJyxcbiAgICAgICAgICAgICd0cmFuc2Zvcm1pbmcuLi4nLFxuICAgICAgICAgICAgJ21vZHVsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlY2FzdGluZy4uLicsXG4gICAgICAgICAgICAnc2hpZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlZm9ybWluZy4uLicsXG4gICAgICAgICAgICAncmVpbWFnaW5pbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdjdXN0b20nOiBbXG4gICAgICAgICAgICAnd29ya2luZyBvbiBpdC4uLicsXG4gICAgICAgICAgICAnY29uc2lkZXJpbmcuLi4nLFxuICAgICAgICAgICAgJ3RoaW5raW5nLi4uJyxcbiAgICAgICAgICAgICdwcm9jZXNzaW5nLi4uJyxcbiAgICAgICAgICAgICdhbmFseXppbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbnRlbXBsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3VuZGVyc3RhbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ludGVycHJldGluZy4uLicsXG4gICAgICAgICAgICAnZXhwbG9yaW5nLi4uJyxcbiAgICAgICAgICAgICdldmFsdWF0aW5nLi4uJ1xuICAgICAgICBdXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNob3cgTm92YSB0aGlua2luZyBhbmltYXRpb24gd2l0aCBub3RpY2UgKyBkb2N1bWVudCBwbGFjZWhvbGRlclxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2hvd1RoaW5raW5nQW5pbWF0aW9uKGVkaXRvcjogRWRpdG9yLCBzdGFydFBvczogYW55LCBlbmRQb3M6IGFueSwgYWN0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gU2VsZWN0IHJhbmRvbSBwaHJhc2UgYmFzZWQgb24gYWN0aW9uIHR5cGVcbiAgICAgICAgICAgIGNvbnN0IHBocmFzZXMgPSBTZWxlY3Rpb25Db250ZXh0TWVudS5USElOS0lOR19QSFJBU0VTW2FjdGlvbklkIGFzIGtleW9mIHR5cGVvZiBTZWxlY3Rpb25Db250ZXh0TWVudS5USElOS0lOR19QSFJBU0VTXSB8fCBTZWxlY3Rpb25Db250ZXh0TWVudS5USElOS0lOR19QSFJBU0VTWydjdXN0b20nXTtcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbVBocmFzZSA9IHBocmFzZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGhyYXNlcy5sZW5ndGgpXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2hvdyB0aGlua2luZyBub3RpY2UgZm9yIHVzZXIgZmVlZGJhY2tcbiAgICAgICAgICAgIHRoaXMuc2hvd1RoaW5raW5nTm90aWNlKHJhbmRvbVBocmFzZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBzZWxlY3Rpb24gaW4gZG9jdW1lbnQgdG8gY3JlYXRlIGNsZWFuIHN0cmVhbWluZyBwb3NpdGlvblxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNldCBzdHJlYW1pbmcgcG9zaXRpb24gdG8gd2hlcmUgc2VsZWN0aW9uIHdhcyBjbGVhcmVkXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBzdGFydFBvcztcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZSA9IHsgZnJvbTogc3RhcnRQb3MsIHRvOiBlbmRQb3MgfTsgLy8gU3RvcmUgZm9yIHVuZG8gY29udGV4dFxuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzaG93IHRoaW5raW5nIGFuaW1hdGlvbjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGRvdHNBbmltYXRpb25JbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIHRoaW5raW5nTm90aWNlOiBOb3RpY2UgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIG9yaWdpbmFsU2VsZWN0aW9uUmFuZ2U6IHsgZnJvbTogYW55OyB0bzogYW55IH0gfCBudWxsID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhpbmtpbmcgbm90aWNlIHdpdGggYW5pbWF0ZWQgZG90c1xuICAgICAqL1xuICAgIHByaXZhdGUgc2hvd1RoaW5raW5nTm90aWNlKGJhc2VQaHJhc2U6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHBlcnNpc3RlbnQgbm90aWNlICgwIHRpbWVvdXQgPSBtYW51YWwgZGlzbWlzc2FsKVxuICAgICAgICAgICAgdGhpcy50aGlua2luZ05vdGljZSA9IG5ldyBOb3RpY2UoYE5vdmE6ICR7YmFzZVBocmFzZX0uYCwgMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNob3cgaW5pdGlhbCBzdGF0ZSB3aXRoIDEgZG90IGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsTm90aWNlVGV4dCA9IGBOb3ZhOiAke2Jhc2VQaHJhc2V9LmA7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VFbCA9ICh0aGlzLnRoaW5raW5nTm90aWNlIGFzIGFueSkubm90aWNlRWw7XG4gICAgICAgICAgICBpZiAobm90aWNlRWwpIHtcbiAgICAgICAgICAgICAgICBub3RpY2VFbC50ZXh0Q29udGVudCA9IGluaXRpYWxOb3RpY2VUZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdGFydCBkb3RzIGFuaW1hdGlvbiBpbiBub3RpY2VcbiAgICAgICAgICAgIHRoaXMuc3RhcnROb3RpY2VEb3RzQW5pbWF0aW9uKGJhc2VQaHJhc2UpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjcmVhdGUgdGhpbmtpbmcgbm90aWNlOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFuaW1hdGUgZG90cyBpbiBub3RpY2UgdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROb3RpY2VEb3RzQW5pbWF0aW9uKGJhc2VQaHJhc2U6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgZG90Q291bnQgPSAxO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5kb3RzQW5pbWF0aW9uSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aGlua2luZ05vdGljZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGRvdENvdW50Kys7XG4gICAgICAgICAgICAgICAgaWYgKGRvdENvdW50ID4gNSkge1xuICAgICAgICAgICAgICAgICAgICBkb3RDb3VudCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGRvdHMgPSAnLicucmVwZWF0KGRvdENvdW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBub3RpY2VUZXh0ID0gYE5vdmE6ICR7YmFzZVBocmFzZX0ke2RvdHN9YDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgbm90aWNlIHRleHQgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICBjb25zdCBub3RpY2VFbCA9ICh0aGlzLnRoaW5raW5nTm90aWNlIGFzIGFueSkubm90aWNlRWw7XG4gICAgICAgICAgICAgICAgaWYgKG5vdGljZUVsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGljZUVsLnRleHRDb250ZW50ID0gbm90aWNlVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgaW4gbm90aWNlIGRvdHMgYW5pbWF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDQwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcCB0aGUgZG90cyBhbmltYXRpb24gYW5kIGRpc21pc3Mgbm90aWNlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdG9wRG90c0FuaW1hdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsKTtcbiAgICAgICAgICAgIHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGlzbWlzcyB0aGlua2luZyBub3RpY2VcbiAgICAgICAgaWYgKHRoaXMudGhpbmtpbmdOb3RpY2UpIHtcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy50aGlua2luZ05vdGljZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIGFjdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0QWN0aW9uRGlzcGxheU5hbWUoYWN0aW9uSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoYWN0aW9uSWQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2ltcHJvdmUnOiByZXR1cm4gJ2ltcHJvdmVkJztcbiAgICAgICAgICAgIGNhc2UgJ2xvbmdlcic6IHJldHVybiAnZXhwYW5kZWQnO1xuICAgICAgICAgICAgY2FzZSAnc2hvcnRlcic6IHJldHVybiAnY29uZGVuc2VkJztcbiAgICAgICAgICAgIGNhc2UgJ3RvbmUnOiByZXR1cm4gJ3RvbmUgYWRqdXN0ZWQnO1xuICAgICAgICAgICAgY2FzZSAnY3VzdG9tJzogcmV0dXJuICd0cmFuc2Zvcm1lZCc7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gJ3Byb2Nlc3NlZCc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgc3VjY2VzcyBtZXNzYWdlIHRvIGNoYXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZFN1Y2Nlc3NDaGF0TWVzc2FnZShhY3Rpb25JZDogc3RyaW5nLCBvcmlnaW5hbFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGFjdGl2ZSBOb3ZhIHNpZGViYXIgdmlldyBhbmQgYWRkIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbm92YS1zaWRlYmFyJyk7XG4gICAgICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIGFueTtcbiAgICAgICAgICAgICAgICBpZiAoc2lkZWJhclZpZXcgJiYgc2lkZWJhclZpZXcuY2hhdFJlbmRlcmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbkRlc2NyaXB0aW9uID0gdGhpcy5nZXRBY3Rpb25EZXNjcmlwdGlvbihhY3Rpb25JZCwgY3VzdG9tSW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRUZXh0ID0gb3JpZ2luYWxUZXh0Lmxlbmd0aCA+IDUwIFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBvcmlnaW5hbFRleHQuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nIFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBvcmlnaW5hbFRleHQ7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYFx1MjcxMyAke2FjdGlvbkRlc2NyaXB0aW9ufSB0ZXh0OiBcIiR7dHJ1bmNhdGVkVGV4dH1cImA7XG4gICAgICAgICAgICAgICAgICAgIHNpZGViYXJWaWV3LmNoYXRSZW5kZXJlci5hZGRTdWNjZXNzTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBhZGQgc3VjY2VzcyBjaGF0IG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGZhaWx1cmUgbWVzc2FnZSB0byBjaGF0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRGYWlsdXJlQ2hhdE1lc3NhZ2UoYWN0aW9uSWQ6IHN0cmluZywgZXJyb3JNZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGFjdGl2ZSBOb3ZhIHNpZGViYXIgdmlldyBhbmQgYWRkIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbm92YS1zaWRlYmFyJyk7XG4gICAgICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIGFueTtcbiAgICAgICAgICAgICAgICBpZiAoc2lkZWJhclZpZXcgJiYgc2lkZWJhclZpZXcuY2hhdFJlbmRlcmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbk5hbWUgPSB0aGlzLmdldEFjdGlvbkRpc3BsYXlOYW1lKGFjdGlvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGBcdTI3MTcgRmFpbGVkIHRvICR7YWN0aW9uTmFtZS5yZXBsYWNlKCdlZCcsICcnKX0gdGV4dDogJHtlcnJvck1lc3NhZ2V9YDtcbiAgICAgICAgICAgICAgICAgICAgc2lkZWJhclZpZXcuY2hhdFJlbmRlcmVyLmFkZEVycm9yTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBhZGQgZXJyb3IgY2hhdCBtZXNzYWdlOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBkZXRhaWxlZCBhY3Rpb24gZGVzY3JpcHRpb24gZm9yIGNoYXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkRlc2NyaXB0aW9uKGFjdGlvbklkOiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChhY3Rpb25JZCkge1xuICAgICAgICAgICAgY2FzZSAnaW1wcm92ZSc6IHJldHVybiAnSW1wcm92ZWQnO1xuICAgICAgICAgICAgY2FzZSAnbG9uZ2VyJzogcmV0dXJuICdFeHBhbmRlZCc7XG4gICAgICAgICAgICBjYXNlICdzaG9ydGVyJzogcmV0dXJuICdDb25kZW5zZWQnO1xuICAgICAgICAgICAgY2FzZSAndG9uZSc6IHJldHVybiBgQ2hhbmdlZCB0b25lIHRvICR7Y3VzdG9tSW5zdHJ1Y3Rpb24gfHwgJ2Zvcm1hbCd9YDtcbiAgICAgICAgICAgIGNhc2UgJ2N1c3RvbSc6IHJldHVybiBgQXBwbGllZCBcIiR7Y3VzdG9tSW5zdHJ1Y3Rpb259XCJgO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuICdQcm9jZXNzZWQnO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIFNlbGVjdGlvbi1iYXNlZCBlZGl0aW5nIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogUHJvY2Vzc2VzIEFJIHRyYW5zZm9ybWF0aW9ucyBvbiBzZWxlY3RlZCB0ZXh0XG4gKi9cblxuaW1wb3J0IHsgRWRpdG9yLCBFZGl0b3JQb3NpdGlvbiwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vYWkvdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGlvbkVkaXRSZXN1bHQge1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgdHJhbnNmb3JtZWRUZXh0Pzogc3RyaW5nO1xuICAgIGVycm9yPzogc3RyaW5nO1xuICAgIG9yaWdpbmFsUmFuZ2U/OiB7XG4gICAgICAgIGZyb206IEVkaXRvclBvc2l0aW9uO1xuICAgICAgICB0bzogRWRpdG9yUG9zaXRpb247XG4gICAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIFNlbGVjdGlvbkVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbikge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBzZWxlY3Rpb24tYmFzZWQgZWRpdCBhY3Rpb25cbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGFjdGlvbjogc3RyaW5nLCBlZGl0b3I6IEVkaXRvciwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogUHJvbWlzZTxTZWxlY3Rpb25FZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgc2VsZWN0aW9uIHJhbmdlIGZvciBsYXRlciByZXBsYWNlbWVudFxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uUmFuZ2UgPSB7XG4gICAgICAgICAgICAgICAgZnJvbTogZWRpdG9yLmdldEN1cnNvcignZnJvbScpLFxuICAgICAgICAgICAgICAgIHRvOiBlZGl0b3IuZ2V0Q3Vyc29yKCd0bycpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBTaG93IGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgICAgICBjb25zdCBsb2FkaW5nTm90aWNlID0gbmV3IE5vdGljZSgnTm92YSBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4uLicsIDApO1xuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBwcm9tcHQgYmFzZWQgb24gYWN0aW9uXG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmJ1aWxkUHJvbXB0KGFjdGlvbiwgc2VsZWN0ZWRUZXh0LCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBBSSByZXNwb25zZSB1c2luZyB0aGUgcHJvdmlkZXIgbWFuYWdlclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsb2FkaW5nTm90aWNlLmhpZGUoKTtcblxuICAgICAgICAgICAgLy8gQ2xlYW4gdXAgQUkgcmVzcG9uc2UgKHJlbW92ZSBhbnkgZXhwbGFuYXRpb24gdGV4dClcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZm9ybWVkVGV4dCA9IHRoaXMuY2xlYW5BSVJlc3BvbnNlKHJlc3BvbnNlKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkVGV4dCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFJhbmdlOiBzZWxlY3Rpb25SYW5nZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU2VsZWN0aW9uIGVkaXQgY29tbWFuZCBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBzZWxlY3Rpb24tYmFzZWQgZWRpdCBhY3Rpb24gd2l0aCBzdHJlYW1pbmdcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlU3RyZWFtaW5nKFxuICAgICAgICBhY3Rpb246IHN0cmluZywgXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLCBcbiAgICAgICAgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIFxuICAgICAgICBvbkNodW5rOiAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4gdm9pZCxcbiAgICAgICAgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPFNlbGVjdGlvbkVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBzZWxlY3Rpb24gcmFuZ2UgZm9yIGxhdGVyIHJlcGxhY2VtZW50XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25SYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHByb21wdCBiYXNlZCBvbiBhY3Rpb25cbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQoYWN0aW9uLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIDEtc2Vjb25kIG1pbmltdW0gZGVsYXkgdG8gZ3VhcmFudGVlIHRoaW5raW5nIGFuaW1hdGlvbiB2aXNpYmlsaXR5XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgZnVsbFJlc3BvbnNlID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0cmVhbSBBSSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdC51c2VyUHJvbXB0LCB7XG4gICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGNodW5rLmVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZnVsbFJlc3BvbnNlICs9IGNodW5rLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xlYW5lZENodW5rID0gdGhpcy5jbGVhbkFJUmVzcG9uc2UoZnVsbFJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBvbkNodW5rKGNsZWFuZWRDaHVuaywgY2h1bmsuZG9uZSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmRvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFkZCBzbWFsbCBkZWxheSB0byBzbG93IGRvd24gc3RyZWFtaW5nIGZvciBiZXR0ZXIgdmlzdWFsIGVmZmVjdFxuICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRUZXh0OiB0aGlzLmNsZWFuQUlSZXNwb25zZShmdWxsUmVzcG9uc2UpLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2U6IHNlbGVjdGlvblJhbmdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTZWxlY3Rpb24gZWRpdCBzdHJlYW1pbmcgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIHRoZSBBSSBiYXNlZCBvbiB0aGUgYWN0aW9uIHR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkUHJvbXB0KGFjdGlvbjogc3RyaW5nLCBzZWxlY3RlZFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiB7XG4gICAgICAgIHN5c3RlbVByb21wdDogc3RyaW5nO1xuICAgICAgICB1c2VyUHJvbXB0OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGJhc2VTeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIGFzc2lzdGFudC4gWW91ciB0YXNrIGlzIHRvIHRyYW5zZm9ybSB0aGUgcHJvdmlkZWQgdGV4dCBhY2NvcmRpbmcgdG8gdGhlIHVzZXIncyByZXF1ZXN0LiBcblxuQ1JJVElDQUwgUlVMRVM6XG4tIFByb3ZpZGUgT05MWSB0aGUgdHJhbnNmb3JtZWQgdGV4dCwgbm8gZXhwbGFuYXRpb25zIG9yIG1ldGEtY29tbWVudGFyeVxuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgbWVhbmluZyB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkIHRvIGNoYW5nZSBpdFxuLSBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgZm9ybWF0IChtYXJrZG93biwgc3RydWN0dXJlLCBldGMuKSB1bmxlc3MgaW5zdHJ1Y3RlZCBvdGhlcndpc2Vcbi0gRG8gbm90IGFkZCBpbnRyb2R1Y3RvcnkgcGhyYXNlcyBsaWtlIFwiSGVyZSdzIHRoZSBpbXByb3ZlZCB0ZXh0OlwiIG9yIHNpbWlsYXJcbi0gUmV0dXJuIG9ubHkgdGhlIGNvbnRlbnQgdGhhdCBzaG91bGQgcmVwbGFjZSB0aGUgc2VsZWN0ZWQgdGV4dGA7XG5cbiAgICAgICAgbGV0IHNwZWNpZmljUHJvbXB0ID0gJyc7XG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2ltcHJvdmUnOlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogSW1wcm92ZSB0aGUgd3JpdGluZyBxdWFsaXR5XG4tIE1ha2UgdGhlIHRleHQgY2xlYXJlciBhbmQgbW9yZSBjb25jaXNlXG4tIEltcHJvdmUgZmxvdyBhbmQgcmVhZGFiaWxpdHlcbi0gRml4IGFueSBhd2t3YXJkIHBocmFzaW5nXG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCB0b25lIGFuZCBtZWFuaW5nYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEltcHJvdmUgdGhpcyB0ZXh0OlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2xvbmdlcic6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBFeHBhbmQgdGhlIHRleHQgd2l0aCBtb3JlIGRldGFpbFxuLSBBZGQgcmVsZXZhbnQgZXhhbXBsZXMsIGNvbnRleHQsIG9yIGV4cGxhbmF0aW9uc1xuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgc3R5bGUgYW5kIHZvaWNlXG4tIEV4cGFuZCBpZGVhcyB3aXRob3V0IGNoYW5naW5nIHRoZSBjb3JlIG1lc3NhZ2Vcbi0gTWFrZSBpdCBtb3JlIGNvbXByZWhlbnNpdmUgYW5kIGRldGFpbGVkYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYE1ha2UgdGhpcyB0ZXh0IGxvbmdlciBhbmQgbW9yZSBkZXRhaWxlZDpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzaG9ydGVyJzpcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IENvbmRlbnNlIHRoZSB0ZXh0IHRvIGVzc2VudGlhbCBwb2ludHNcbi0gUmVtb3ZlIHJlZHVuZGFuY3kgYW5kIHVubmVjZXNzYXJ5IHdvcmRzXG4tIEtlZXAgYWxsIGtleSBpbmZvcm1hdGlvbiBhbmQgbWVhbmluZ1xuLSBNYWtlIGl0IG1vcmUgY29uY2lzZSBhbmQgZGlyZWN0XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCB0b25lYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYE1ha2UgdGhpcyB0ZXh0IHNob3J0ZXIgYW5kIG1vcmUgY29uY2lzZTpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICd0b25lJzpcbiAgICAgICAgICAgICAgICBjb25zdCB0b25lTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgICAgICAgICAgICAgICAnZm9ybWFsJzogJ3Byb2Zlc3Npb25hbCBhbmQgc3RydWN0dXJlZCwgc3VpdGFibGUgZm9yIGJ1c2luZXNzIG9yIGFjYWRlbWljIGNvbnRleHRzJyxcbiAgICAgICAgICAgICAgICAgICAgJ2Nhc3VhbCc6ICdyZWxheGVkIGFuZCBjb252ZXJzYXRpb25hbCwgc3VpdGFibGUgZm9yIGluZm9ybWFsIGNvbW11bmljYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAnYWNhZGVtaWMnOiAnc2Nob2xhcmx5IGFuZCBwcmVjaXNlLCB1c2luZyB0ZWNobmljYWwgdm9jYWJ1bGFyeSB3aGVyZSBhcHByb3ByaWF0ZScsXG4gICAgICAgICAgICAgICAgICAgICdmcmllbmRseSc6ICd3YXJtIGFuZCBhcHByb2FjaGFibGUsIGJ1aWxkaW5nIGNvbm5lY3Rpb24gd2l0aCB0aGUgcmVhZGVyJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgdG9uZURlc2NyaXB0aW9uID0gdG9uZU1hcFtjdXN0b21JbnN0cnVjdGlvbiB8fCAnZm9ybWFsJ10gfHwgdG9uZU1hcC5mb3JtYWw7XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBDaGFuZ2UgdGhlIHRvbmUgdG8gYmUgJHt0b25lRGVzY3JpcHRpb259XG4tIEFkanVzdCBsYW5ndWFnZSBhbmQgdm9jYWJ1bGFyeSB0byBtYXRjaCB0aGUgcmVxdWVzdGVkIHRvbmVcbi0gS2VlcCB0aGUgc2FtZSBjb250ZW50IGFuZCBtZWFuaW5nXG4tIE1haW50YWluIGFwcHJvcHJpYXRlIGZvcm1hbGl0eSBsZXZlbCBmb3IgdGhlIGNob3NlbiB0b25lYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYFJld3JpdGUgdGhpcyB0ZXh0IGluIGEgJHtjdXN0b21JbnN0cnVjdGlvbiB8fCAnZm9ybWFsJ30gdG9uZTpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdjdXN0b20nOlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogQXBwbHkgY3VzdG9tIHRyYW5zZm9ybWF0aW9uXG4tIEZvbGxvdyB0aGUgdXNlcidzIHNwZWNpZmljIGluc3RydWN0aW9uIGV4YWN0bHlcbi0gTWFpbnRhaW4gY29udGVudCBpbnRlZ3JpdHkgdW5sZXNzIGFza2VkIHRvIGNoYW5nZSBpdFxuLSBBcHBseSB0aGUgcmVxdWVzdGVkIGNoYW5nZXMgcHJlY2lzZWx5YDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEFwcGx5IHRoaXMgaW5zdHJ1Y3Rpb24gdG8gdGhlIHRleHQ6IFwiJHtjdXN0b21JbnN0cnVjdGlvbn1cIlxcblxcblRleHQgdG8gdHJhbnNmb3JtOlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBHZW5lcmFsIHRleHQgaW1wcm92ZW1lbnRcbi0gRW5oYW5jZSBjbGFyaXR5IGFuZCByZWFkYWJpbGl0eVxuLSBQcmVzZXJ2ZSBvcmlnaW5hbCBtZWFuaW5nIGFuZCB0b25lYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEltcHJvdmUgdGhpcyB0ZXh0OlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBiYXNlU3lzdGVtUHJvbXB0ICsgJ1xcbicgKyBzcGVjaWZpY1Byb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHRcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiBBSSByZXNwb25zZSB0byBleHRyYWN0IG9ubHkgdGhlIHRyYW5zZm9ybWVkIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGNsZWFuQUlSZXNwb25zZShyZXNwb25zZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gUmVtb3ZlIGNvbW1vbiBBSSByZXNwb25zZSBwYXR0ZXJuc1xuICAgICAgICBsZXQgY2xlYW5lZCA9IHJlc3BvbnNlLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBpbnRyb2R1Y3RvcnkgcGhyYXNlc1xuICAgICAgICBjb25zdCBpbnRyb1BhdHRlcm5zID0gW1xuICAgICAgICAgICAgL15IZXJlJ3MgdGhlIGltcHJvdmVkIHRleHQ6P1xccyovaSxcbiAgICAgICAgICAgIC9eSGVyZSdzIHRoZSByZXdyaXR0ZW4gdGV4dDo/XFxzKi9pLFxuICAgICAgICAgICAgL15IZXJlJ3MgdGhlIHRyYW5zZm9ybWVkIHRleHQ6P1xccyovaSxcbiAgICAgICAgICAgIC9eSW1wcm92ZWQgdmVyc2lvbjo/XFxzKi9pLFxuICAgICAgICAgICAgL15SZXdyaXR0ZW46P1xccyovaSxcbiAgICAgICAgICAgIC9eUmVzdWx0Oj9cXHMqL2ksXG4gICAgICAgICAgICAvXk91dHB1dDo/XFxzKi9pXG4gICAgICAgIF07XG5cbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGludHJvUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UocGF0dGVybiwgJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIHRyYWlsaW5nIGV4cGxhbmF0aW9ucyAodGV4dCBhZnRlciBcIi0tLVwiIG9yIHNpbWlsYXIgcGF0dGVybnMpXG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnNwbGl0KC9cXG5cXHMqLS0tK1xccyovKS5zaGlmdCgpIHx8IGNsZWFuZWQ7XG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnNwbGl0KC9cXG5cXHMqXFwqXFwqP0V4cGxhbmF0aW9uXFwqP1xcKj86L2kpLnNoaWZ0KCkgfHwgY2xlYW5lZDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjbGVhbmVkLnRyaW0oKTtcbiAgICB9XG59IiwgIi8qKlxuICogVG9uZSBzZWxlY3Rpb24gbW9kYWwgZm9yIE5vdmEgc2VsZWN0aW9uLWJhc2VkIGVkaXRpbmdcbiAqIEFsbG93cyB1c2VycyB0byBjaG9vc2UgYmV0d2VlbiBkaWZmZXJlbnQgd3JpdGluZyB0b25lc1xuICovXG5cbmltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBUb25lT3B0aW9uIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IFRPTkVfT1BUSU9OUzogVG9uZU9wdGlvbltdID0gW1xuICAgIHtcbiAgICAgICAgaWQ6ICdmb3JtYWwnLFxuICAgICAgICBsYWJlbDogJ0Zvcm1hbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUHJvZmVzc2lvbmFsLCBzdHJ1Y3R1cmVkIGxhbmd1YWdlIHN1aXRhYmxlIGZvciBidXNpbmVzcyBvciBhY2FkZW1pYyBjb250ZXh0cydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdjYXN1YWwnLFxuICAgICAgICBsYWJlbDogJ0Nhc3VhbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUmVsYXhlZCwgY29udmVyc2F0aW9uYWwgdG9uZSBmb3IgaW5mb3JtYWwgY29tbXVuaWNhdGlvbidcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdhY2FkZW1pYycsXG4gICAgICAgIGxhYmVsOiAnQWNhZGVtaWMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1NjaG9sYXJseSwgcHJlY2lzZSBsYW5ndWFnZSB3aXRoIHRlY2huaWNhbCB2b2NhYnVsYXJ5J1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2ZyaWVuZGx5JyxcbiAgICAgICAgbGFiZWw6ICdGcmllbmRseScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnV2FybSwgYXBwcm9hY2hhYmxlIHRvbmUgdGhhdCBidWlsZHMgY29ubmVjdGlvbidcbiAgICB9XG5dO1xuXG5leHBvcnQgY2xhc3MgVG9uZVNlbGVjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgc2VsZWN0ZWRUb25lOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIG9uU2VsZWN0OiAodG9uZTogc3RyaW5nKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgb25DYW5jZWw6ICgpID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIG9uU2VsZWN0OiAodG9uZTogc3RyaW5nKSA9PiB2b2lkLFxuICAgICAgICBvbkNhbmNlbDogKCkgPT4gdm9pZFxuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XG4gICAgICAgIHRoaXMub25DYW5jZWwgPSBvbkNhbmNlbDtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICAvLyBNb2RhbCB0aXRsZVxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnQ2hvb3NlIFdyaXRpbmcgVG9uZScgfSk7XG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgXG4gICAgICAgICAgICB0ZXh0OiAnU2VsZWN0IGhvdyB5b3Ugd2FudCBOb3ZhIHRvIGFkanVzdCB0aGUgdG9uZSBvZiB5b3VyIHNlbGVjdGVkIHRleHQ6JyxcbiAgICAgICAgICAgIGNsczogJ3NldHRpbmctaXRlbS1kZXNjcmlwdGlvbidcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRvbmUgb3B0aW9uc1xuICAgICAgICBjb25zdCB0b25lQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtdG9uZS1vcHRpb25zJyB9KTtcbiAgICAgICAgXG4gICAgICAgIFRPTkVfT1BUSU9OUy5mb3JFYWNoKHRvbmUgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uRWwgPSB0b25lQ29udGFpbmVyLmNyZWF0ZURpdih7IFxuICAgICAgICAgICAgICAgIGNsczogJ25vdmEtdG9uZS1vcHRpb24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3R5bGUgdGhlIG9wdGlvbiBlbGVtZW50XG4gICAgICAgICAgICBvcHRpb25FbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IHZhcigtLXNpemUtNC0zKTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMik7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcbiAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcbiAgICAgICAgICAgIGA7XG5cbiAgICAgICAgICAgIC8vIE9wdGlvbiBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlckVsID0gb3B0aW9uRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS10b25lLWhlYWRlcicgfSk7XG4gICAgICAgICAgICBoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG4gICAgICAgICAgICBgO1xuXG4gICAgICAgICAgICAvLyBSYWRpbyBidXR0b24gKHZpc3VhbCBvbmx5KVxuICAgICAgICAgICAgY29uc3QgcmFkaW9FbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXRvbmUtcmFkaW8nIH0pO1xuICAgICAgICAgICAgcmFkaW9FbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxNnB4O1xuICAgICAgICAgICAgICAgIGhlaWdodDogMTZweDtcbiAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1pbnRlcmFjdGl2ZS1ub3JtYWwpO1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IHZhcigtLXNpemUtMi0yKTtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuICAgICAgICAgICAgYDtcblxuICAgICAgICAgICAgLy8gVG9uZSBsYWJlbFxuICAgICAgICAgICAgY29uc3QgbGFiZWxFbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBcbiAgICAgICAgICAgICAgICB0ZXh0OiB0b25lLmxhYmVsLFxuICAgICAgICAgICAgICAgIGNsczogJ25vdmEtdG9uZS1sYWJlbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGFiZWxFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgIGA7XG5cbiAgICAgICAgICAgIC8vIFRvbmUgZGVzY3JpcHRpb25cbiAgICAgICAgICAgIGNvbnN0IGRlc2NFbCA9IG9wdGlvbkVsLmNyZWF0ZURpdih7IFxuICAgICAgICAgICAgICAgIHRleHQ6IHRvbmUuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgY2xzOiAnbm92YS10b25lLWRlc2NyaXB0aW9uJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjQ7XG4gICAgICAgICAgICBgO1xuXG4gICAgICAgICAgICAvLyBDbGljayBoYW5kbGVyXG4gICAgICAgICAgICBvcHRpb25FbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFRvbmUodG9uZS5pZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gSG92ZXIgZWZmZWN0c1xuICAgICAgICAgICAgb3B0aW9uRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBvcHRpb25FbC5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcbiAgICAgICAgICAgICAgICBvcHRpb25FbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG9wdGlvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRUb25lICE9PSB0b25lLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkVsLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBTdG9yZSByZWZlcmVuY2UgZm9yIHNlbGVjdGlvbiBzdHlsaW5nXG4gICAgICAgICAgICBvcHRpb25FbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdG9uZScsIHRvbmUuaWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBCdXR0b25zXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXRvbmUtYnV0dG9ucycgfSk7XG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IHZhcigtLXNpemUtNC00KTtcbiAgICAgICAgICAgIHBhZGRpbmctdG9wOiB2YXIoLS1zaXplLTQtMyk7XG4gICAgICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICBgO1xuXG4gICAgICAgIC8vIENhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpO1xuICAgICAgICBjYW5jZWxCdG4uc2V0QnV0dG9uVGV4dCgnQ2FuY2VsJyk7XG4gICAgICAgIGNhbmNlbEJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMub25DYW5jZWwoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQXBwbHkgYnV0dG9uXG4gICAgICAgIGNvbnN0IGFwcGx5QnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpO1xuICAgICAgICBhcHBseUJ0bi5zZXRCdXR0b25UZXh0KCdBcHBseSBUb25lJyk7XG4gICAgICAgIGFwcGx5QnRuLnNldEN0YSgpO1xuICAgICAgICBhcHBseUJ0bi5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgYXBwbHlCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFRvbmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblNlbGVjdCh0aGlzLnNlbGVjdGVkVG9uZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgZW5hYmxpbmcvZGlzYWJsaW5nXG4gICAgICAgIHRoaXMuYXBwbHlCdXR0b24gPSBhcHBseUJ0bjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFwcGx5QnV0dG9uOiBCdXR0b25Db21wb25lbnQgfCBudWxsID0gbnVsbDtcblxuICAgIHByaXZhdGUgc2VsZWN0VG9uZSh0b25lSWQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnNlbGVjdGVkVG9uZSA9IHRvbmVJZDtcblxuICAgICAgICAvLyBVcGRhdGUgdmlzdWFsIHNlbGVjdGlvblxuICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5jb250ZW50RWwucXVlcnlTZWxlY3RvckFsbCgnLm5vdmEtdG9uZS1vcHRpb24nKTtcbiAgICAgICAgb3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25FbCA9IG9wdGlvbiBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IHJhZGlvID0gb3B0aW9uRWwucXVlcnlTZWxlY3RvcignLm5vdmEtdG9uZS1yYWRpbycpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAob3B0aW9uRWwuZ2V0QXR0cmlidXRlKCdkYXRhLXRvbmUnKSA9PT0gdG9uZUlkKSB7XG4gICAgICAgICAgICAgICAgLy8gU2VsZWN0ZWQgc3RhdGVcbiAgICAgICAgICAgICAgICBvcHRpb25FbC5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcbiAgICAgICAgICAgICAgICBvcHRpb25FbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1zZWxlY3RlZCknO1xuICAgICAgICAgICAgICAgIHJhZGlvLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcbiAgICAgICAgICAgICAgICByYWRpby5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVW5zZWxlY3RlZCBzdGF0ZVxuICAgICAgICAgICAgICAgIG9wdGlvbkVsLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgICAgICAgICAgb3B0aW9uRWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICAgICAgcmFkaW8uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICAgICAgcmFkaW8uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtbm9ybWFsKSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEVuYWJsZSBhcHBseSBidXR0b25cbiAgICAgICAgaWYgKHRoaXMuYXBwbHlCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMuYXBwbHlCdXR0b24uc2V0RGlzYWJsZWQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgLy8gQ2xlYW51cCBoYW5kbGVkIGJ5IE9ic2lkaWFuXG4gICAgfVxufSIsICIvKipcbiAqIEN1c3RvbSBpbnN0cnVjdGlvbiBtb2RhbCBmb3IgTm92YSBzZWxlY3Rpb24tYmFzZWQgZWRpdGluZ1xuICogQWxsb3dzIHVzZXJzIHRvIHByb3ZpZGUgY3VzdG9tIGluc3RydWN0aW9ucyBmb3IgdGV4dCB0cmFuc2Zvcm1hdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcsIEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgQ3VzdG9tSW5zdHJ1Y3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIGluc3RydWN0aW9uOiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIG9uU3VibWl0OiAoaW5zdHJ1Y3Rpb246IHN0cmluZykgPT4gdm9pZDtcbiAgICBwcml2YXRlIG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgdGV4dEFyZWFDb21wb25lbnQ6IFRleHRBcmVhQ29tcG9uZW50IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdWJtaXRCdXR0b246IEJ1dHRvbkNvbXBvbmVudCB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBvblN1Ym1pdDogKGluc3RydWN0aW9uOiBzdHJpbmcpID0+IHZvaWQsXG4gICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB2b2lkXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgICAgICAgdGhpcy5vbkNhbmNlbCA9IG9uQ2FuY2VsO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgICAgIC8vIEFwcGx5IG1vYmlsZS1zcGVjaWZpYyBzdHlsaW5nIHRvIG1vZGFsIGNvbnRhaW5lclxuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHRoaXMubW9kYWxFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIHdpZHRoOiA5NXZ3ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgbWF4LXdpZHRoOiBub25lICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgbWF4LWhlaWdodDogODB2aCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgICAgIHRvcDogNjBweCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgICAgIGxlZnQ6IDIuNXZ3ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBub25lICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLW0pO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29udGVudEVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IHZhcigtLXNpemUtNC0yKTtcbiAgICAgICAgICAgICAgICBtYXgtaGVpZ2h0OiA4MHZoO1xuICAgICAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICAgICAgICBgO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTW9kYWwgdGl0bGVcbiAgICAgICAgY29uc3QgdGl0bGVFbCA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdUZWxsIE5vdmEnIH0pO1xuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IHZhcigtLWZvbnQtdWktbGFyZ2UpO1xuICAgICAgICAgICAgICAgIG1hcmdpbjogMCAwIHZhcigtLXNpemUtMi0xKSAwO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlc2NFbCA9IGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgXG4gICAgICAgICAgICB0ZXh0OiAnRGVzY3JpYmUgaG93IHlvdSB3YW50IE5vdmEgdG8gdHJhbnNmb3JtIHlvdXIgc2VsZWN0ZWQgdGV4dDonLFxuICAgICAgICAgICAgY2xzOiAnc2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uJ1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICBkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTtcbiAgICAgICAgICAgICAgICBtYXJnaW46IDAgMCB2YXIoLS1zaXplLTItMykgMDtcbiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMS4zO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluc3RydWN0aW9uIGlucHV0IGFyZWFcbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jdXN0b20taW5zdHJ1Y3Rpb24taW5wdXQnIH0pO1xuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIGlucHV0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwIDAgdmFyKC0tc2l6ZS00LTMpIDA7XG4gICAgICAgICAgICBgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5wdXRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBtYXJnaW46IHZhcigtLXNpemUtNC0zKSAwO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSB0ZXh0YXJlYSBmb3IgaW5zdHJ1Y3Rpb25cbiAgICAgICAgdGhpcy50ZXh0QXJlYUNvbXBvbmVudCA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgIHRoaXMudGV4dEFyZWFDb21wb25lbnQuc2V0UGxhY2Vob2xkZXIoJ2UuZy4sIFwibWFrZSB0aGlzIG1vcmUgcGVyc3Vhc2l2ZVwiLCBcImFkZCBzdGF0aXN0aWNzXCIsIFwid3JpdGUgaW4gYnVsbGV0IHBvaW50c1wiJyk7XG4gICAgICAgIFxuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHRoaXMudGV4dEFyZWFDb21wb25lbnQuaW5wdXRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDkwcHg7XG4gICAgICAgICAgICAgICAgbWF4LWhlaWdodDogMTQwcHg7XG4gICAgICAgICAgICAgICAgcmVzaXplOiB2ZXJ0aWNhbDtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbSk7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogdmFyKC0tc2l6ZS00LTMpO1xuICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG4gICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtaW50ZXJmYWNlKTtcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTtcbiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMS40O1xuICAgICAgICAgICAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTtcbiAgICAgICAgICAgICAgICB0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjtcbiAgICAgICAgICAgIGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRleHRBcmVhQ29tcG9uZW50LmlucHV0RWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBtaW4taGVpZ2h0OiA4MHB4O1xuICAgICAgICAgICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4O1xuICAgICAgICAgICAgICAgIHJlc2l6ZTogdmVydGljYWw7XG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKSB2YXIoLS1zaXplLTItMyk7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tZm9udC1pbnRlcmZhY2UpO1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1xuICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjQ7XG4gICAgICAgICAgICBgO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGlucHV0IGV2ZW50IGxpc3RlbmVyXG4gICAgICAgIHRoaXMudGV4dEFyZWFDb21wb25lbnQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluc3RydWN0aW9uID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN1Ym1pdEJ1dHRvbigpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBCdXR0b25zXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWluc3RydWN0aW9uLWJ1dHRvbnMnIH0pO1xuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgZ2FwOiB2YXIoLS1zaXplLTItMyk7XG4gICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzdHJldGNoO1xuICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IHZhcigtLXNpemUtNC0zKTtcbiAgICAgICAgICAgICAgICBwYWRkaW5nLXRvcDogdmFyKC0tc2l6ZS00LTMpO1xuICAgICAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnV0dG9uQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICBnYXA6IHZhcigtLXNpemUtMi0zKTtcbiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IHZhcigtLXNpemUtNC00KTtcbiAgICAgICAgICAgICAgICBwYWRkaW5nLXRvcDogdmFyKC0tc2l6ZS00LTMpO1xuICAgICAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBgO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FuY2VsIGJ1dHRvblxuICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcik7XG4gICAgICAgIGNhbmNlbEJ0bi5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKTtcbiAgICAgICAgaWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICBjYW5jZWxCdG4uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQ4cHg7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogdmFyKC0tc2l6ZS00LTMpO1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1tKTtcbiAgICAgICAgICAgICAgICB0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjtcbiAgICAgICAgICAgIGA7XG4gICAgICAgIH1cbiAgICAgICAgY2FuY2VsQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5vbkNhbmNlbCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTdWJtaXQgYnV0dG9uXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpO1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5zZXRCdXR0b25UZXh0KCdUcmFuc2Zvcm0gVGV4dCcpO1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgIGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmbGV4OiAyO1xuICAgICAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQ4cHg7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogdmFyKC0tc2l6ZS00LTMpO1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1tKTtcbiAgICAgICAgICAgICAgICB0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjtcbiAgICAgICAgICAgIGA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbnN0cnVjdGlvbi50cmltKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLmluc3RydWN0aW9uLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZvY3VzIHRoZSB0ZXh0YXJlYVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGV4dEFyZWFDb21wb25lbnQ/LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgfSwgMTAwKTtcblxuICAgICAgICAvLyBIYW5kbGUgRW50ZXIga2V5IChDdHJsK0VudGVyIG9yIENtZCtFbnRlciB0byBzdWJtaXQpXG4gICAgICAgIHRoaXMudGV4dEFyZWFDb21wb25lbnQuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5zdHJ1Y3Rpb24udHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLmluc3RydWN0aW9uLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVN1Ym1pdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VibWl0QnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi5zZXREaXNhYmxlZCghdGhpcy5pbnN0cnVjdGlvbi50cmltKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgLy8gQ2xlYW51cCBoYW5kbGVkIGJ5IE9ic2lkaWFuXG4gICAgfVxufSIsICJpbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFJUHJvdmlkZXIsIFByb3ZpZGVyVHlwZSwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBBSVByb3ZpZGVyU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENsYXVkZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvY2xhdWRlJztcbmltcG9ydCB7IE9wZW5BSVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb3BlbmFpJztcbmltcG9ydCB7IEdvb2dsZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvZ29vZ2xlJztcbmltcG9ydCB7IE9sbGFtYVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb2xsYW1hJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzJztcbmltcG9ydCB7IEZlYXR1cmVNYW5hZ2VyIH0gZnJvbSAnLi4vbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBBSVByb3ZpZGVyTWFuYWdlciB7XG5cdHByaXZhdGUgcHJvdmlkZXJzOiBNYXA8UHJvdmlkZXJUeXBlLCBBSVByb3ZpZGVyPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzZXR0aW5nczogTm92YVNldHRpbmdzO1xuXHRwcml2YXRlIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXI7XG5cblx0Y29uc3RydWN0b3Ioc2V0dGluZ3M6IE5vdmFTZXR0aW5ncywgZmVhdHVyZU1hbmFnZXI/OiBGZWF0dXJlTWFuYWdlcikge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gZmVhdHVyZU1hbmFnZXI7XG5cdH1cblxuXHRhc3luYyBpbml0aWFsaXplKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnY2xhdWRlJywgbmV3IENsYXVkZVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdvcGVuYWknLCBuZXcgT3BlbkFJUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2dvb2dsZScsIG5ldyBHb29nbGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb2xsYW1hJywgbmV3IE9sbGFtYVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hKSk7XG5cdH1cblxuXHR1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTm92YVNldHRpbmdzKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMucHJvdmlkZXJzLmZvckVhY2goKHByb3ZpZGVyLCB0eXBlKSA9PiB7XG5cdFx0XHRpZiAodHlwZSAhPT0gJ25vbmUnICYmIHR5cGUgaW4gdGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycykge1xuXHRcdFx0XHRwcm92aWRlci51cGRhdGVDb25maWc/Lih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzW3R5cGUgYXMga2V5b2YgQUlQcm92aWRlclNldHRpbmdzXSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGdldFBsYXRmb3JtUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0Y29uc3QgcGxhdGZvcm1TZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV07XG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gW3BsYXRmb3JtU2V0dGluZ3MucHJpbWFyeVByb3ZpZGVyLCAuLi5wbGF0Zm9ybVNldHRpbmdzLmZhbGxiYWNrUHJvdmlkZXJzXTtcblx0XHRcblx0XHQvLyBObyByZXN0cmljdGlvbnMgLSBhbGwgdXNlcnMgY2FuIHVzZSBhbGwgcHJvdmlkZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdFx0cmV0dXJuIHByb3ZpZGVycztcblx0fVxuXG5cblx0cHJpdmF0ZSBhc3luYyBnZXRBdmFpbGFibGVQcm92aWRlcigpOiBQcm9taXNlPEFJUHJvdmlkZXIgfCBudWxsPiB7XG5cdFx0Y29uc3Qgb3JkZXJlZFByb3ZpZGVycyA9IHRoaXMuZ2V0UGxhdGZvcm1Qcm92aWRlcnMoKTtcblx0XHRcblx0XHQvLyBJZiBwcmltYXJ5IHByb3ZpZGVyIGlzICdub25lJywgTm92YSBpcyBkaXNhYmxlZCBvbiB0aGlzIHBsYXRmb3JtXG5cdFx0aWYgKG9yZGVyZWRQcm92aWRlcnNbMF0gPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGZvciAoY29uc3QgcHJvdmlkZXJUeXBlIG9mIG9yZGVyZWRQcm92aWRlcnMpIHtcblx0XHRcdGlmIChwcm92aWRlclR5cGUgPT09ICdub25lJykgY29udGludWU7XG5cdFx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHByb3ZpZGVyLmlzQXZhaWxhYmxlKCkpIHtcblx0XHRcdFx0cmV0dXJuIHByb3ZpZGVyO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmdlbmVyYXRlVGV4dChwcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHR5aWVsZCogcHJvdmlkZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlci5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHlpZWxkKiBwcm92aWRlci5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRQcm92aWRlck5hbWVzKCk6IHN0cmluZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSkubWFwKHAgPT4gcC5uYW1lKTtcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRQcm92aWRlck5hbWUoKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRyZXR1cm4gcHJvdmlkZXIgPyBwcm92aWRlci5uYW1lIDogJ05vbmUnO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHRjb25zdCBvcmRlcmVkUHJvdmlkZXJzID0gdGhpcy5nZXRQbGF0Zm9ybVByb3ZpZGVycygpO1xuXHRcdGlmIChvcmRlcmVkUHJvdmlkZXJzWzBdID09PSAnbm9uZScpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBvcmRlcmVkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRcdGlmIChwcm92aWRlciAmJiBhd2FpdCBwcm92aWRlci5pc0F2YWlsYWJsZSgpKSB7XG5cdFx0XHRcdHJldHVybiBwcm92aWRlclR5cGU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNvbXBsZXRlKHN5c3RlbVByb21wdCwgdXNlclByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRBbGxvd2VkUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBPbGxhbWEgcmVxdWlyZXMgbG9jYWwgc2VydmVyIC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGVcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdFx0fVxuXHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHR9XG5cblx0aXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhbGxvd2VkXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRnZXRQcm92aWRlckxpbWl0cygpOiB7IGxvY2FsOiBudW1iZXI7IGNsb3VkOiBudW1iZXIgfSB7XG5cdFx0Ly8gTm8gbGltaXRzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4geyBsb2NhbDogSW5maW5pdHksIGNsb3VkOiBJbmZpbml0eSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRhc3luYyBnZXRQcm92aWRlck1vZGVscyhwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgUHJvdmlkZXIgJHtwcm92aWRlclR5cGV9IG5vdCBmb3VuZGApO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBnZXRBdmFpbGFibGVNb2RlbHMgbWV0aG9kXG5cdFx0aWYgKCdnZXRBdmFpbGFibGVNb2RlbHMnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5nZXRBdmFpbGFibGVNb2RlbHMgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHJldHVybiBhd2FpdCAocHJvdmlkZXIgYXMgYW55KS5nZXRBdmFpbGFibGVNb2RlbHMoKTtcblx0XHR9XG5cblx0XHQvLyBGb3IgcHJvdmlkZXJzIHdpdGhvdXQgQVBJIG1vZGVsIGxpc3RpbmcgKGxpa2UgT2xsYW1hKSwgcmV0dXJuIGVtcHR5IGFycmF5XG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIG1vZGVsIGNhY2hlIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRjbGVhclByb3ZpZGVyTW9kZWxDYWNoZShwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IHZvaWQge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBjbGVhck1vZGVsQ2FjaGUgbWV0aG9kXG5cdFx0aWYgKCdjbGVhck1vZGVsQ2FjaGUnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5jbGVhck1vZGVsQ2FjaGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdChwcm92aWRlciBhcyBhbnkpLmNsZWFyTW9kZWxDYWNoZSgpO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuY2xlYXIoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIGRlZmF1bHQgbWF4IHRva2VucyBmcm9tIHNldHRpbmdzXG5cdCAqL1xuXHRnZXREZWZhdWx0TWF4VG9rZW5zKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zO1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyByZXF1ZXN0VXJsIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgQ2xhdWRlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdDbGF1ZGUgKEFudGhyb3BpYyknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlcXVlc3RCb2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCcsXG5cdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0c3lzdGVtOiBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQsXG5cdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRyb2xlOiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnYXNzaXN0YW50JyA6ICd1c2VyJyxcblx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdH0pKVxuXHRcdH0pO1xuXG5cdFx0Ly8gUmV0cnkgbG9naWMgZm9yIDUwMC1sZXZlbCBlcnJvcnNcblx0XHRjb25zdCBtYXhSZXRyaWVzID0gMztcblx0XHRjb25zdCBiYXNlRGVsYXkgPSAxMDAwOyAvLyAxIHNlY29uZFxuXG5cdFx0Zm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0XHRcdHVybDogJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLFxuXHRcdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRib2R5OiByZXF1ZXN0Qm9keVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcblx0XHRcdFx0XHRjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbjtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YS5jb250ZW50WzBdLnRleHQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgNTAwLWxldmVsIGVycm9yIHRoYXQgd2Ugc2hvdWxkIHJldHJ5XG5cdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPj0gNTAwICYmIGF0dGVtcHQgPCBtYXhSZXRyaWVzKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTsgLy8gRXhwb25lbnRpYWwgYmFja29mZlxuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlOyAvLyBSZXRyeVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRm9yIGFsbCBvdGhlciBlcnJvcnMgb3IgZmluYWwgYXR0ZW1wdCwgdGhyb3cgZXJyb3Jcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBDbGF1ZGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gLSAke3Jlc3BvbnNlLnRleHR9YCk7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIE5ldHdvcmsvY29ubmVjdGlvbiBlcnJvcnMgLSByZXRyeSBpZiBub3QgZmluYWwgYXR0ZW1wdFxuXHRcdFx0XHRpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMgJiYgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiAoXG5cdFx0XHRcdFx0ZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnTmV0d29yayBlcnJvcicpIHx8IFxuXHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0ZhaWxlZCB0byBjb25uZWN0Jylcblx0XHRcdFx0KSkge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7XG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIFJlLXRocm93IHRoZSBlcnJvciBpZiBpdCdzIHRoZSBmaW5hbCBhdHRlbXB0IG9yIG5vdCBhIHJldHJ5YWJsZSBlcnJvclxuXHRcdFx0XHRpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLnN0YXJ0c1dpdGgoJ0NsYXVkZSBBUEkgZXJyb3I6JykpIHtcblx0XHRcdFx0XHR0aHJvdyBlcnJvcjsgLy8gQWxyZWFkeSBmb3JtYXR0ZWQgZXJyb3Jcblx0XHRcdFx0fVxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjb25uZWN0IHRvIENsYXVkZSBBUEk6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnTmV0d29yayBlcnJvcid9YCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gVGhpcyBzaG91bGQgbmV2ZXIgYmUgcmVhY2hlZCwgYnV0IFR5cGVTY3JpcHQgd2FudHMgaXRcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEk6IE1heGltdW0gcmV0cmllcyBleGNlZWRlZCcpO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Ly8gRm9yIG5vdywgZmFsbCBiYWNrIHRvIG5vbi1zdHJlYW1pbmcgZm9yIENsYXVkZSBkdWUgdG8gQ09SUyBsaW1pdGF0aW9uc1xuXHRcdC8vIHJlcXVlc3RVcmwgZG9lc24ndCBzdXBwb3J0IHN0cmVhbWluZywgc28gd2UnbGwgZ2V0IHRoZSBmdWxsIHJlc3BvbnNlIGF0IG9uY2Vcblx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0XHR5aWVsZCB7IGNvbnRlbnQ6IHJlc3VsdCwgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBDbGF1ZGUgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdC8vIEZvciBDbGF1ZGUsIHdlJ2xsIHVzZSBhIGhhcmRjb2RlZCBsaXN0IHNpbmNlIEFudGhyb3BpYyBkb2Vzbid0IHByb3ZpZGUgYSBtb2RlbHMgZW5kcG9pbnRcblx0XHQvLyBCdXQgd2UgY2FuIHZhbGlkYXRlIHRoZSBBUEkga2V5IGJ5IG1ha2luZyBhIHRlc3QgY2FsbFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBWYWxpZGF0ZSBBUEkga2V5IHdpdGggYSBtaW5pbWFsIHJlcXVlc3Rcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHRcdHVybDogJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLFxuXHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdFx0fSxcblx0XHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRcdG1vZGVsOiAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLFxuXHRcdFx0XHRcdG1heF90b2tlbnM6IDEsXG5cdFx0XHRcdFx0bWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dXG5cdFx0XHRcdH0pXG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQVBJIGtleSB2YWxpZGF0aW9uIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtyZXNwb25zZS50ZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZXR1cm4gY3VycmVudCBhdmFpbGFibGUgbW9kZWxzIChmcm9tIEFQSSBkb2NzKVxuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnY2xhdWRlLW9wdXMtNC0yMDI1MDUxNCcsXG5cdFx0XHRcdCdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnLFxuXHRcdFx0XHQnY2xhdWRlLTMtNy1zb25uZXQtbGF0ZXN0Jyxcblx0XHRcdFx0J2NsYXVkZS0zLTUtc29ubmV0LWxhdGVzdCcsXG5cdFx0XHRcdCdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggQ2xhdWRlIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT3BlbkFJUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPcGVuQUknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlcXVlc3RNZXNzYWdlcyA9IFsuLi5tZXNzYWdlc107XG5cdFx0aWYgKG9wdGlvbnM/LnN5c3RlbVByb21wdCkge1xuXHRcdFx0cmVxdWVzdE1lc3NhZ2VzLnVuc2hpZnQoeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogb3B0aW9ucy5zeXN0ZW1Qcm9tcHQgfSk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdGNvbnN0IGVuZHBvaW50ID0gYmFzZVVybC5lbmRzV2l0aCgnL2NoYXQvY29tcGxldGlvbnMnKSA/IGJhc2VVcmwgOiBgJHtiYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYDtcblx0XHRcblx0XHRjb25zdCByZXF1ZXN0Qm9keSA9IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnZ3B0LTMuNS10dXJibycsXG5cdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuN1xuXHRcdH0pO1xuXG5cdFx0Ly8gUmV0cnkgbG9naWMgZm9yIDUwMC1sZXZlbCBlcnJvcnNcblx0XHRjb25zdCBtYXhSZXRyaWVzID0gMztcblx0XHRjb25zdCBiYXNlRGVsYXkgPSAxMDAwOyAvLyAxIHNlY29uZFxuXG5cdFx0Zm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRib2R5OiByZXF1ZXN0Qm9keVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAocmVzcG9uc2Uub2spIHtcblx0XHRcdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIDUwMC1sZXZlbCBlcnJvciB0aGF0IHdlIHNob3VsZCByZXRyeVxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCAmJiBhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gUmV0cnlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvciBhbGwgb3RoZXIgZXJyb3JzIG9yIGZpbmFsIGF0dGVtcHQsIHRocm93IGVycm9yXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBOZXR3b3JrIGVycm9ycyAtIHJldHJ5IGlmIG5vdCBmaW5hbCBhdHRlbXB0XG5cdFx0XHRcdGlmIChhdHRlbXB0IDwgbWF4UmV0cmllcyAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2ZldGNoJykpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZS10aHJvdyB0aGUgZXJyb3IgaWYgaXQncyB0aGUgZmluYWwgYXR0ZW1wdCBvciBub3QgYSBuZXR3b3JrIGVycm9yXG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWQsIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIGl0XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJOiBNYXhpbXVtIHJldHJpZXMgZXhjZWVkZWQnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRpZiAob3B0aW9ucz8uc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRyZXF1ZXN0TWVzc2FnZXMudW5zaGlmdCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBvcHRpb25zLnN5c3RlbVByb21wdCB9KTtcblx0XHR9XG5cblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSc7XG5cdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvY2hhdC9jb21wbGV0aW9ucycpID8gYmFzZVVybCA6IGAke2Jhc2VVcmx9L2NoYXQvY29tcGxldGlvbnNgO1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdncHQtMy41LXR1cmJvJyxcblx0XHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRzdHJlYW06IHRydWVcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG5cdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gcGFyc2VkLmNob2ljZXM/LlswXT8uZGVsdGE/LmNvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBPcGVuQUkgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSc7XG5cdFx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9tb2RlbHMnKSA/IGJhc2VVcmwgOiBgJHtiYXNlVXJsfS9tb2RlbHNgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZXR1cm4gaGFyZGNvZGVkIGN1cnJlbnQgbW9kZWxzXG5cdFx0XHRjb25zdCBtb2RlbHMgPSBbXG5cdFx0XHRcdCdncHQtNC4xLTIwMjUtMDQtMTQnLFxuXHRcdFx0XHQnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnLFxuXHRcdFx0XHQnZ3B0LTQuMS1uYW5vLTIwMjUtMDQtMTQnLFxuXHRcdFx0XHQnZ3B0LTRvJyxcblx0XHRcdFx0J2dwdC00by1taW5pJ1xuXHRcdFx0XTtcblxuXHRcdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBtb2RlbHM7XG5cdFx0XHRyZXR1cm4gbW9kZWxzO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBPcGVuQUkgbW9kZWxzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBjYWNoZWQgbW9kZWxzXG5cdCAqL1xuXHRjbGVhck1vZGVsQ2FjaGUoKTogdm9pZCB7XG5cdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBudWxsO1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBHb29nbGVQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ0dvb2dsZSAoR2VtaW5pKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblx0cHJpdmF0ZSBjYWNoZWRNb2RlbHM6IHN0cmluZ1tdIHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdHByaXZhdGUgZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBzeXN0ZW1Qcm9tcHQ/OiBzdHJpbmcpOiBhbnkge1xuXHRcdGNvbnN0IGNvbnRlbnRzID0gW107XG5cdFx0XG5cdFx0aWYgKHN5c3RlbVByb21wdCAmJiBzeXN0ZW1Qcm9tcHQudHJpbSgpKSB7XG5cdFx0XHRjb250ZW50cy5wdXNoKHtcblx0XHRcdFx0cm9sZTogJ3VzZXInLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogYFN5c3RlbTogJHtzeXN0ZW1Qcm9tcHR9YCB9XVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Zm9yIChjb25zdCBtZXNzYWdlIG9mIG1lc3NhZ2VzKSB7XG5cdFx0XHRjb25zdCByb2xlID0gbWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50JyA/ICdtb2RlbCcgOiAndXNlcic7XG5cdFx0XHRjb250ZW50cy5wdXNoKHtcblx0XHRcdFx0cm9sZSxcblx0XHRcdFx0cGFydHM6IFt7IHRleHQ6IG1lc3NhZ2UuY29udGVudCB9XVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gRW5zdXJlIHdlIGhhdmUgYXQgbGVhc3Qgb25lIG1lc3NhZ2Vcblx0XHRpZiAoY29udGVudHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vIG1lc3NhZ2VzIHByb3ZpZGVkIGZvciBHb29nbGUgQVBJJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbnRlbnRzO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBVc2UgYSBuZXdlciBtb2RlbCBieSBkZWZhdWx0IGlmIG5vIG1vZGVsIGlzIHNwZWNpZmllZFxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuXHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0Y29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiByZXNwb25zZSBoYXMgdmFsaWQgc3RydWN0dXJlXG5cdFx0aWYgKCFkYXRhLmNhbmRpZGF0ZXMgfHwgZGF0YS5jYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhbiBlcnJvciBtZXNzYWdlIGluIHRoZSByZXNwb25zZVxuXHRcdFx0aWYgKGRhdGEuZXJyb3IpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke2RhdGEuZXJyb3IubWVzc2FnZSB8fCBKU09OLnN0cmluZ2lmeShkYXRhLmVycm9yKX1gKTtcblx0XHRcdH1cblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBubyBjYW5kaWRhdGVzJyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRoZSByZXNwb25zZSB3YXMgYmxvY2tlZCBvciBmaWx0ZXJlZFxuXHRcdGlmIChkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnU0FGRVRZJyB8fCBkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnQkxPQ0tFRCcpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBibG9ja2VkIHRoZSByZXNwb25zZSBkdWUgdG8gc2FmZXR5IGZpbHRlcnMnKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgd2UgaGl0IHRoZSB0b2tlbiBsaW1pdCBiZWZvcmUgZ2VuZXJhdGluZyBjb250ZW50XG5cdFx0aWYgKGRhdGEuY2FuZGlkYXRlc1swXS5maW5pc2hSZWFzb24gPT09ICdNQVhfVE9LRU5TJyAmJiBcblx0XHQgICAgKCFkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudCB8fCAhZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMgfHwgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMubGVuZ3RoID09PSAwKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdBUEkgaGl0IHRva2VuIGxpbWl0IGJlZm9yZSBnZW5lcmF0aW5nIGFueSBjb250ZW50LiBQbGVhc2UgaW5jcmVhc2UgXCJEZWZhdWx0IE1heCBUb2tlbnNcIiBpbiBzZXR0aW5ncy4nKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgcmVzcG9uc2UgaGFzIGNvbnRlbnRcblx0XHRpZiAoZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQgJiYgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMgJiYgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgdGV4dCA9IGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG5cdFx0XHRcblx0XHRcdC8vIElmIHJlc3BvbnNlIHdhcyB0cnVuY2F0ZWQsIHRocm93IGVycm9yIGluc3RlYWQgb2YgcmV0dXJuaW5nIHBhcnRpYWwgY29udGVudFxuXHRcdFx0aWYgKGRhdGEuY2FuZGlkYXRlc1swXS5maW5pc2hSZWFzb24gPT09ICdNQVhfVE9LRU5TJykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1Jlc3BvbnNlIHdhcyB0cnVuY2F0ZWQgZHVlIHRvIHRva2VuIGxpbWl0LiBQbGVhc2UgaW5jcmVhc2UgXCJEZWZhdWx0IE1heCBUb2tlbnNcIiBpbiBzZXR0aW5ncy4nKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRleHQgfHwgJyc7XG5cdFx0fVxuXHRcdFxuXHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBlbXB0eSByZXNwb25zZScpO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBVc2UgYSBuZXdlciBtb2RlbCBieSBkZWZhdWx0IGlmIG5vIG1vZGVsIGlzIHNwZWNpZmllZFxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OnN0cmVhbUdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRcdGdlbmVyYXRpb25Db25maWc6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCB0ZXh0ID0gcGFyc2VkLmNhbmRpZGF0ZXM/LlswXT8uY29udGVudD8ucGFydHM/LlswXT8udGV4dDtcblx0XHRcdFx0XHRcdFx0aWYgKHRleHQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHRleHQsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHQvKipcblx0ICogRmV0Y2ggYXZhaWxhYmxlIG1vZGVscyBmcm9tIEdvb2dsZSBBUElcblx0ICovXG5cdGFzeW5jIGdldEF2YWlsYWJsZU1vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtb2RlbHMsIHJldHVybiB0aGVtXG5cdFx0aWYgKHRoaXMuY2FjaGVkTW9kZWxzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jYWNoZWRNb2RlbHM7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzP2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gO1xuXHRcdFx0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZXR1cm4gaGFyZGNvZGVkIGN1cnJlbnQgbW9kZWxzXG5cdFx0XHRjb25zdCBtb2RlbHMgPSBbXG5cdFx0XHRcdCdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnLFxuXHRcdFx0XHQnZ2VtaW5pLTIuNS1wcm8tcHJldmlldy0wMy0yNScsXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoJyxcblx0XHRcdFx0J2dlbWluaS0yLjAtZmxhc2gtbGl0ZSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggR29vZ2xlIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT2xsYW1hUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPbGxhbWEgKExvY2FsKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5tb2RlbCkgcmV0dXJuIGZhbHNlOyAvLyBSZXF1aXJlIG1vZGVsIHRvIGJlIHNldFxuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS90YWdzYCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2Uub2s7XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEucmVzcG9uc2U7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2dlbmVyYXRlYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdHByb21wdCxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0Y29uc3QgbGluZXMgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSkuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQucmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHBhcnNlZC5yZXNwb25zZSwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLmRvbmUpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9jaGF0YCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpLFxuXHRcdFx0XHRzdHJlYW06IGZhbHNlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLm1lc3NhZ2UuY29udGVudDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0Y29uc3QgbGluZXMgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSkuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQubWVzc2FnZT8uY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogcGFyc2VkLm1lc3NhZ2UuY29udGVudCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLmRvbmUpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgIi8qKlxuICogQ29yZSBkb2N1bWVudCBlbmdpbmUgZm9yIE5vdmFcbiAqIEhhbmRsZXMgYWxsIGRvY3VtZW50IG1hbmlwdWxhdGlvbiBhbmQgZWRpdG9yIGludGVyYWN0aW9uc1xuICovXG5cbmltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blZpZXcsIFRGaWxlLCBFZGl0b3JQb3NpdGlvbiwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRDb250ZXh0LCBIZWFkaW5nSW5mbywgRWRpdFJlc3VsdCwgRWRpdE9wdGlvbnMsIERvY3VtZW50U2VjdGlvbiwgRWRpdENvbW1hbmQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIsIERhdGFTdG9yZSB9IGZyb20gJy4vY29udmVyc2F0aW9uLW1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgRG9jdW1lbnRFbmdpbmUge1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlciB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCwgZGF0YVN0b3JlPzogRGF0YVN0b3JlKSB7XG4gICAgICAgIGlmIChkYXRhU3RvcmUpIHtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IG5ldyBDb252ZXJzYXRpb25NYW5hZ2VyKGRhdGFTdG9yZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgY29udmVyc2F0aW9uIG1hbmFnZXIgKGZvciBkZXBlbmRlbmN5IGluamVjdGlvbilcbiAgICAgKi9cbiAgICBzZXRDb252ZXJzYXRpb25NYW5hZ2VyKGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGl2ZSBlZGl0b3IgaW5zdGFuY2UgLSBlbnN1cmVzIHdlIGdldCB0aGUgZWRpdG9yIGZvciB0aGUgYWN0aXZlIGZpbGVcbiAgICAgKi9cbiAgICBnZXRBY3RpdmVFZGl0b3IoKTogRWRpdG9yIHwgbnVsbCB7XG4gICAgICAgIC8vIEdldCB0aGUgYWN0aXZlIGZpbGUgZmlyc3QgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XG4gICAgICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgbWFya2Rvd24gdmlldyBmb3IgdGhlIGFjdGl2ZSBmaWxlIHNwZWNpZmljYWxseVxuICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuICAgICAgICAgICAgaWYgKHZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgdmlldy5maWxlID09PSBhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcuZWRpdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBGYWxsYmFjazogdHJ5IHRoZSB3b3Jrc3BhY2UgYWN0aXZlIGVkaXRvciBpZiBpdCBtYXRjaGVzIHRoZSBhY3RpdmUgZmlsZVxuICAgICAgICBjb25zdCBhY3RpdmVFZGl0b3IgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlRWRpdG9yO1xuICAgICAgICBpZiAoYWN0aXZlRWRpdG9yPy5lZGl0b3IgJiYgYWN0aXZlRWRpdG9yLmZpbGUgPT09IGFjdGl2ZUZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBhY3RpdmVFZGl0b3IuZWRpdG9yO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5hbCBmYWxsYmFjazogdHJ5IGdldEFjdGl2ZVZpZXdPZlR5cGVcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICh2aWV3ICYmIHZpZXcuZmlsZSA9PT0gYWN0aXZlRmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZpZXcuZWRpdG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYWN0aXZlIGZpbGVcbiAgICAgKi9cbiAgICBnZXRBY3RpdmVGaWxlKCk6IFRGaWxlIHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHRleHRcbiAgICAgKi9cbiAgICBnZXRTZWxlY3RlZFRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IGN1cnNvciBwb3NpdGlvblxuICAgICAqL1xuICAgIGdldEN1cnNvclBvc2l0aW9uKCk6IEVkaXRvclBvc2l0aW9uIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBjdXJzb3IgcG9zaXRpb24gKG9wdGlvbmFsbHkgZm9jdXMgdGhlIGVkaXRvcilcbiAgICAgKi9cbiAgICBzZXRDdXJzb3JQb3NpdGlvbihwb3NpdGlvbjogRWRpdG9yUG9zaXRpb24sIHNob3VsZEZvY3VzOiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGVkaXRvci5zZXRDdXJzb3IocG9zaXRpb24pO1xuICAgICAgICBpZiAoc2hvdWxkRm9jdXMpIHtcbiAgICAgICAgICAgIGVkaXRvci5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBjb21wcmVoZW5zaXZlIGRvY3VtZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBhc3luYyBnZXREb2N1bWVudENvbnRleHQoKTogUHJvbWlzZTxEb2N1bWVudENvbnRleHQgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSB8fCAhZWRpdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gdGhpcy5nZXRTZWxlY3RlZFRleHQoKTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLmdldEN1cnNvclBvc2l0aW9uKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IGhlYWRpbmdzIGZyb20gdGhlIGRvY3VtZW50XG4gICAgICAgIGNvbnN0IGhlYWRpbmdzID0gdGhpcy5leHRyYWN0SGVhZGluZ3MoY29udGVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgc3Vycm91bmRpbmcgbGluZXMgZm9yIGNvbnRleHRcbiAgICAgICAgY29uc3Qgc3Vycm91bmRpbmdMaW5lcyA9IGN1cnNvclBvc2l0aW9uID8gXG4gICAgICAgICAgICB0aGlzLmdldFN1cnJvdW5kaW5nTGluZXMoY29udGVudCwgY3Vyc29yUG9zaXRpb24ubGluZSkgOiBcbiAgICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIGhlYWRpbmdzLFxuICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiBzZWxlY3RlZFRleHQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgY3Vyc29yUG9zaXRpb246IGN1cnNvclBvc2l0aW9uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXNcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGhlYWRpbmdzIGZyb20gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdEhlYWRpbmdzKGNvbnRlbnQ6IHN0cmluZyk6IEhlYWRpbmdJbmZvW10ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBjb25zdCBoZWFkaW5nczogSGVhZGluZ0luZm9bXSA9IFtdO1xuICAgICAgICBsZXQgY2hhckNvdW50ID0gMDtcblxuICAgICAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaGVhZGluZ01hdGNoID0gbGluZS5tYXRjaCgvXigjezEsNn0pXFxzKyguKykkLyk7XG4gICAgICAgICAgICBpZiAoaGVhZGluZ01hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBoZWFkaW5nTWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaGVhZGluZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHRleHQsXG4gICAgICAgICAgICAgICAgICAgIGxldmVsLFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBjaGFyQ291bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGNoYXJDb3VudCArIGxpbmUubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGxpbmUgbGVuZ3RoICsgbmV3bGluZSBjaGFyYWN0ZXJcbiAgICAgICAgICAgIGNoYXJDb3VudCArPSBsaW5lLmxlbmd0aCArIDE7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBoZWFkaW5ncztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbGluZXMgc3Vycm91bmRpbmcgdGhlIGN1cnNvciBwb3NpdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0U3Vycm91bmRpbmdMaW5lcyhcbiAgICAgICAgY29udGVudDogc3RyaW5nLCBcbiAgICAgICAgY3VycmVudExpbmU6IG51bWJlciwgXG4gICAgICAgIGNvbnRleHRTaXplOiBudW1iZXIgPSA1XG4gICAgKTogeyBiZWZvcmU6IHN0cmluZ1tdOyBhZnRlcjogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdGFydExpbmUgPSBNYXRoLm1heCgwLCBjdXJyZW50TGluZSAtIGNvbnRleHRTaXplKTtcbiAgICAgICAgY29uc3QgZW5kTGluZSA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCAtIDEsIGN1cnJlbnRMaW5lICsgY29udGV4dFNpemUpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJlZm9yZTogbGluZXMuc2xpY2Uoc3RhcnRMaW5lLCBjdXJyZW50TGluZSksXG4gICAgICAgICAgICBhZnRlcjogbGluZXMuc2xpY2UoY3VycmVudExpbmUgKyAxLCBlbmRMaW5lICsgMSlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBhbiBlZGl0IHRvIHRoZSBkb2N1bWVudFxuICAgICAqL1xuICAgIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29udGVudDogc3RyaW5nLFxuICAgICAgICBwb3NpdGlvbjogJ2N1cnNvcicgfCAnc2VsZWN0aW9uJyB8ICdlbmQnIHwgeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfSxcbiAgICAgICAgb3B0aW9uczogRWRpdE9wdGlvbnMgPSB7fVxuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBhcHBsaWVkQXQ6IEVkaXRvclBvc2l0aW9uO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocG9zaXRpb24gPT09ICdjdXJzb3InKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGNvbnRlbnQsIGFwcGxpZWRBdCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGNvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ2VuZCcpIHtcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmUgPSBlZGl0b3IubGFzdExpbmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZUxlbmd0aCA9IGVkaXRvci5nZXRMaW5lKGxhc3RMaW5lKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0geyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudENvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gY3VycmVudENvbnRlbnQgKyAoY3VycmVudENvbnRlbnQuZW5kc1dpdGgoJ1xcbicpID8gJycgOiAnXFxuJykgKyBjb250ZW50O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFVzZSB2YXVsdC5tb2RpZnkgZm9yIHVuZG8vcmVkbyBzdXBwb3J0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgc3BlY2lmaWMgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBwb3NpdGlvbjtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGNvbnRlbnQsIGFwcGxpZWRBdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBwb3N0LWVkaXQgb3B0aW9uc1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2VsZWN0TmV3VGV4dCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGluZTogYXBwbGllZEF0LmxpbmUgKyBjb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICAgICBjaDogY29udGVudC5pbmNsdWRlcygnXFxuJykgPyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3BsaXQoJ1xcbicpLnBvcCgpIS5sZW5ndGggOiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdC5jaCArIGNvbnRlbnQubGVuZ3RoXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0U2VsZWN0aW9uKGFwcGxpZWRBdCwgZW5kUG9zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2Nyb2xsVG9FZGl0KSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogYXBwbGllZEF0LFxuICAgICAgICAgICAgICAgICAgICB0bzogYXBwbGllZEF0XG4gICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiBwb3NpdGlvbiA9PT0gJ3NlbGVjdGlvbicgPyAncmVwbGFjZScgOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gJ2VuZCcgPyAnYXBwZW5kJyA6ICdpbnNlcnQnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVsZXRlIGNvbnRlbnQgYXQgY3Vyc29yIGxvY2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlQ29udGVudChcbiAgICAgICAgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdsaW5lJ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJ2xpbmUnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBjdXJzb3IubGluZTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lLCBjaDogMCB9LCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBsaW5lICsgMSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGRlbGV0ZSB0YXJnZXQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGZ1bGwgZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIGFzeW5jIGdldERvY3VtZW50Q29udGVudCgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcGxhY2UgdGhlIGVudGlyZSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ29udmVyc2F0aW9uIG1hbmFnZW1lbnQgbWV0aG9kc1xuXG4gICAgLyoqXG4gICAgICogQWRkIHVzZXIgbWVzc2FnZSB0byBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRVc2VyTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFVzZXJNZXNzYWdlKGZpbGUsIGNvbnRlbnQsIGNvbW1hbmQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFzc2lzdGFudCByZXNwb25zZSB0byBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRBc3Npc3RhbnRNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgcmVzdWx0PzogRWRpdFJlc3VsdCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZEFzc2lzdGFudE1lc3NhZ2UoZmlsZSwgY29udGVudCwgcmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBzeXN0ZW0gbWVzc2FnZSB0byBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRTeXN0ZW1NZXNzYWdlKGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFN5c3RlbU1lc3NhZ2UoZmlsZSwgY29udGVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KG1heE1lc3NhZ2VzOiBudW1iZXIgPSA2KTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldENvbnZlcnNhdGlvbkNvbnRleHQoZmlsZSwgbWF4TWVzc2FnZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGNvbnZlcnNhdGlvbiBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb252ZXJzYXRpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIHN0YXRpc3RpY3MgZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvblN0YXRzKCk6IHtcbiAgICAgICAgbWVzc2FnZUNvdW50OiBudW1iZXI7XG4gICAgICAgIGVkaXRDb3VudDogbnVtYmVyO1xuICAgICAgICBtb3N0VXNlZENvbW1hbmQ6IHN0cmluZyB8IG51bGw7XG4gICAgICAgIGNvbnZlcnNhdGlvbkFnZTogbnVtYmVyO1xuICAgIH0gfCBudWxsIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRTdGF0cyhmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBjdXJyZW50IGZpbGUgaGFzIGFuIGFjdGl2ZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBoYXNDb252ZXJzYXRpb24oKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5oYXNDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0IGNvbnZlcnNhdGlvbiBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZXhwb3J0Q29udmVyc2F0aW9uKCk6IHN0cmluZyB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmV4cG9ydENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIHNlbGVjdGVkIHRleHQgd2l0aCBuZXcgY29udGVudFxuICAgICAqIEhhbmRsZXMgdW5kby9yZWRvIHByb3Blcmx5IGFuZCBwcmVzZXJ2ZXMgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgYXN5bmMgcmVwbGFjZVNlbGVjdGlvbihcbiAgICAgICAgbmV3VGV4dDogc3RyaW5nLFxuICAgICAgICBmcm9tPzogRWRpdG9yUG9zaXRpb24sXG4gICAgICAgIHRvPzogRWRpdG9yUG9zaXRpb25cbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVXNlIHByb3ZpZGVkIHJhbmdlIG9yIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICBjb25zdCBmcm9tUG9zID0gZnJvbSB8fCBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICBjb25zdCB0b1BvcyA9IHRvIHx8IGVkaXRvci5nZXRDdXJzb3IoJ3RvJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBlcmZvcm0gdGhlIHJlcGxhY2VtZW50IHVzaW5nIE9ic2lkaWFuJ3MgdHJhbnNhY3Rpb24gc3lzdGVtIGZvciBwcm9wZXIgdW5kby9yZWRvXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld1RleHQsIGZyb21Qb3MsIHRvUG9zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGN1cnNvciBhdCB0aGUgZW5kIG9mIHRoZSByZXBsYWNlZCB0ZXh0XG4gICAgICAgICAgICBjb25zdCBuZXdDdXJzb3JQb3MgPSB7XG4gICAgICAgICAgICAgICAgbGluZTogZnJvbVBvcy5saW5lICsgKG5ld1RleHQuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEpLFxuICAgICAgICAgICAgICAgIGNoOiBuZXdUZXh0LmluY2x1ZGVzKCdcXG4nKSA/IFxuICAgICAgICAgICAgICAgICAgICBuZXdUZXh0LnNwbGl0KCdcXG4nKS5wb3AoKSEubGVuZ3RoIDogXG4gICAgICAgICAgICAgICAgICAgIGZyb21Qb3MuY2ggKyBuZXdUZXh0Lmxlbmd0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcihuZXdDdXJzb3JQb3MpO1xuICAgICAgICAgICAgZWRpdG9yLmZvY3VzKCk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdUZXh0LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZnJvbVBvcyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXBsYWNpbmcgc2VsZWN0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbn0iLCAiLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlciBmb3IgTm92YVxuICogSGFuZGxlcyBmaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gc3RvcmFnZSBhbmQgcmV0cmlldmFsXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhLCBDb252ZXJzYXRpb25NZXNzYWdlLCBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRWRpdEFjdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTdG9yZSB7XG4gICAgbG9hZERhdGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gICAgc2F2ZURhdGEoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbnM6IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbkRhdGE+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgbWF4TWVzc2FnZXNQZXJGaWxlID0gMTAwOyAvLyBMaW1pdCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgIHByaXZhdGUgc3RvcmFnZUtleSA9ICdub3ZhLWNvbnZlcnNhdGlvbnMnO1xuICAgIHByaXZhdGUgY2xlYW51cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0YVN0b3JlOiBEYXRhU3RvcmUpIHtcbiAgICAgICAgdGhpcy5sb2FkQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBjb252ZXJzYXRpb25zIGZyb20gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZGF0YVN0b3JlLmxvYWREYXRhKHRoaXMuc3RvcmFnZUtleSk7XG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb252ZXJzYXRpb24gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGNvbnZlcnNhdGlvbi5maWxlUGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gbG9hZCBjb252ZXJzYXRpb24gZGF0YSAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIGNvbnZlcnNhdGlvbnMgdG8gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uc0FycmF5ID0gQXJyYXkuZnJvbSh0aGlzLmNvbnZlcnNhdGlvbnMudmFsdWVzKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kYXRhU3RvcmUuc2F2ZURhdGEodGhpcy5zdG9yYWdlS2V5LCBjb252ZXJzYXRpb25zQXJyYXkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHNhdmUgY29udmVyc2F0aW9uIGRhdGEgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBmb3IgYSBzcGVjaWZpYyBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogQ29udmVyc2F0aW9uRGF0YSB7XG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbnMuaGFzKGZpbGVQYXRoKSkge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBjb252ZXJzYXRpb24gZm9yIHRoaXMgZmlsZVxuICAgICAgICAgICAgY29uc3QgbmV3Q29udmVyc2F0aW9uOiBDb252ZXJzYXRpb25EYXRhID0ge1xuICAgICAgICAgICAgICAgIGZpbGVQYXRoLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgICAgICAgICBsYXN0VXBkYXRlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBlZGl0Q291bnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRGcmVxdWVuY3k6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV3cml0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChmaWxlUGF0aCwgbmV3Q29udmVyc2F0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGVQYXRoKSE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgdXNlciBtZXNzYWdlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRVc2VyTWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsIFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjb21tYW5kPzogRWRpdENvbW1hbmRcbiAgICApOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjb21tYW5kXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmQgZnJlcXVlbmN5IGlmIGNvbW1hbmQgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeVtjb21tYW5kLmFjdGlvbl0rKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFuIGFzc2lzdGFudCByZXNwb25zZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcmVzdWx0PzogRWRpdFJlc3VsdFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gSW5jcmVtZW50IGVkaXQgY291bnQgaWYgcmVzdWx0IGluZGljYXRlcyBzdWNjZXNzZnVsIGVkaXRcbiAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcyAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgc3lzdGVtIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoZmlsZTogVEZpbGUsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmVjZW50IG1lc3NhZ2VzIGZvciBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0UmVjZW50TWVzc2FnZXMoZmlsZTogVEZpbGUsIGNvdW50OiBudW1iZXIgPSAxMCk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uLm1lc3NhZ2VzLnNsaWNlKC1jb3VudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG1lc3NhZ2VzIGJ5IHJvbGVcbiAgICAgKi9cbiAgICBnZXRNZXNzYWdlc0J5Um9sZShmaWxlOiBURmlsZSwgcm9sZTogQ29udmVyc2F0aW9uTWVzc2FnZVsncm9sZSddKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cucm9sZSA9PT0gcm9sZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlOiBURmlsZSwgbWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgbWF4TWVzc2FnZXMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dExpbmVzID0gbWVzc2FnZXMubWFwKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZShtc2cudGltZXN0YW1wKS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcbiAgICAgICAgICAgIGxldCBsaW5lID0gYFske3RpbWVzdGFtcH1dICR7bXNnLnJvbGUudG9VcHBlckNhc2UoKX06ICR7bXNnLmNvbnRlbnR9YDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChDb21tYW5kOiAke21zZy5jb21tYW5kLmFjdGlvbn0gJHttc2cuY29tbWFuZC50YXJnZXR9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtc2cucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChSZXN1bHQ6ICR7bXNnLnJlc3VsdC5zdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2ZhaWxlZCd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYFByZXZpb3VzIGNvbnZlcnNhdGlvbjpcXG4ke2NvbnRleHRMaW5lcy5qb2luKCdcXG4nKX1cXG5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IFtdO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmVkaXRDb3VudCA9IDA7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeSA9IHtcbiAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICBkZWxldGU6IDAsXG4gICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICByZXdyaXRlOiAwLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljc1xuICAgICAqL1xuICAgIGdldFN0YXRzKGZpbGU6IFRGaWxlKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGw7XG4gICAgICAgIGNvbnZlcnNhdGlvbkFnZTogbnVtYmVyO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBtb3N0VXNlZENvbW1hbmQ6IEVkaXRBY3Rpb24gfCBudWxsID0gbnVsbDtcbiAgICAgICAgbGV0IG1heENvdW50ID0gMDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2FjdGlvbiwgY291bnRdIG9mIE9iamVjdC5lbnRyaWVzKGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5KSkge1xuICAgICAgICAgICAgICAgIGlmIChjb3VudCA+IG1heENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIG1heENvdW50ID0gY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCA9IGFjdGlvbiBhcyBFZGl0QWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkFnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwIFxuICAgICAgICAgICAgPyBEYXRlLm5vdygpIC0gY29udmVyc2F0aW9uLm1lc3NhZ2VzWzBdLnRpbWVzdGFtcFxuICAgICAgICAgICAgOiAwO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtZXNzYWdlQ291bnQ6IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGgsXG4gICAgICAgICAgICBlZGl0Q291bnQ6IGNvbnZlcnNhdGlvbi5tZXRhZGF0YT8uZWRpdENvdW50IHx8IDAsXG4gICAgICAgICAgICBtb3N0VXNlZENvbW1hbmQsXG4gICAgICAgICAgICBjb252ZXJzYXRpb25BZ2VcbiAgICAgICAgfTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb25zdCBsaW5lcyA9IFtgIyBDb252ZXJzYXRpb24gSGlzdG9yeSBmb3IgJHtmaWxlLm5hbWV9YCwgJyddO1xuXG4gICAgICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBjb252ZXJzYXRpb24ubWVzc2FnZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1lc3NhZ2UudGltZXN0YW1wKS50b0xvY2FsZVN0cmluZygpO1xuICAgICAgICAgICAgbGluZXMucHVzaChgIyMgJHttZXNzYWdlLnJvbGUudG9VcHBlckNhc2UoKX0gKCR7dGltZXN0YW1wfSlgKTtcbiAgICAgICAgICAgIGxpbmVzLnB1c2gobWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuY29tbWFuZCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpDb21tYW5kOiAke21lc3NhZ2UuY29tbWFuZC5hY3Rpb259ICR7bWVzc2FnZS5jb21tYW5kLnRhcmdldH0qYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpSZXN1bHQ6ICR7bWVzc2FnZS5yZXN1bHQuc3VjY2VzcyA/ICdTdWNjZXNzJyA6ICdGYWlsZWQnfSpgKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS5yZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkVycm9yOiAke21lc3NhZ2UucmVzdWx0LmVycm9yfSpgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxpbmVzLnB1c2goJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBtZXNzYWdlIElEXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZU1lc3NhZ2VJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYG1zZ18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpbSBjb252ZXJzYXRpb24gdG8gbWF4IGxlbmd0aCBhbmQgc2F2ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgdHJpbUFuZFNhdmUoY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb25EYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpIHtcbiAgICAgICAgICAgIC8vIEtlZXAgdGhlIG1vc3QgcmVjZW50IG1lc3NhZ2VzXG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLXRoaXMubWF4TWVzc2FnZXNQZXJGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgY29udmVyc2F0aW9uIGZpbGUgcGF0aHNcbiAgICAgKi9cbiAgICBnZXRBbGxDb252ZXJzYXRpb25GaWxlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy5rZXlzKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGZpbGUgaGFzIGFjdGl2ZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBoYXNDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChmaWxlLnBhdGgpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uID8gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgOiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgY29udmVyc2F0aW9uIGZpbGUgcGF0aCAoZm9yIGZpbGUgcmVuYW1lcylcbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVGaWxlUGF0aChvbGRQYXRoOiBzdHJpbmcsIG5ld1BhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KG9sZFBhdGgpO1xuICAgICAgICBpZiAoY29udmVyc2F0aW9uKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24uZmlsZVBhdGggPSBuZXdQYXRoO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShvbGRQYXRoKTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQobmV3UGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHBlcmlvZGljIGNsZWFudXAgb2Ygb2xkIGNvbnZlcnNhdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk6IHZvaWQge1xuICAgICAgICAvLyBDbGVhbiB1cCBldmVyeSAyNCBob3Vyc1xuICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBPbGRDb252ZXJzYXRpb25zKDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gNyBkYXlzXG4gICAgICAgIH0sIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIHVwIGNvbnZlcnNhdGlvbnMgb2xkZXIgdGhhbiB0aGUgc3BlY2lmaWVkIGFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY2xlYW51cE9sZENvbnZlcnNhdGlvbnMobWF4QWdlOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgbGV0IGNsZWFuZWQgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGNvbnN0IFtmaWxlUGF0aCwgY29udmVyc2F0aW9uXSBvZiB0aGlzLmNvbnZlcnNhdGlvbnMuZW50cmllcygpKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBjb252ZXJzYXRpb24gaXMgb2xkIGJhc2VkIG9uIGxhc3QgbWVzc2FnZVxuICAgICAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdE1lc3NhZ2UgPSBjb252ZXJzYXRpb24ubWVzc2FnZXNbY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFnZSA9IG5vdyAtIGxhc3RNZXNzYWdlLnRpbWVzdGFtcDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoYWdlID4gbWF4QWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5kZWxldGUoZmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBjbGVhbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2xlYW5lZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW51cCBtZXRob2QgdG8gY2FsbCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxuICAgICAqL1xuICAgIGNsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNsZWFudXBJbnRlcnZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBJbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBOb3ZhXG4gKiBHZW5lcmF0ZXMgYXBwcm9wcmlhdGUgcHJvbXB0cyBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZ1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuXG4vKipcbiAqIEdlbmVyYXRlZCBwcm9tcHQgZm9yIEFJIGNvbXBsZXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRQcm9tcHQge1xuICAgIC8qKiBTeXN0ZW0gcHJvbXB0IGZvciBBSSBjb250ZXh0ICovXG4gICAgc3lzdGVtUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFVzZXIgcHJvbXB0IHdpdGggc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zICovXG4gICAgdXNlclByb21wdDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBBZGRpdGlvbmFsIGNvbnRleHQgZm9yIHRoZSBBSSAqL1xuICAgIGNvbnRleHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogQ29uZmlndXJhdGlvbiBmb3IgQUkgZ2VuZXJhdGlvbiAqL1xuICAgIGNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogbnVtYmVyO1xuICAgICAgICBtYXhUb2tlbnM6IG51bWJlcjtcbiAgICB9O1xufVxuXG4vKipcbiAqIENvbnRleHQgYnVpbGRlciBmb3IgZ2VuZXJhdGluZyBBSSBwcm9tcHRzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb250ZXh0QnVpbGRlciB7XG4gICAgcHJpdmF0ZSBkZWZhdWx0Q29uZmlnOiBQcm9tcHRDb25maWc7XG5cbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncz86IE5vdmFTZXR0aW5ncykge1xuICAgICAgICB0aGlzLmRlZmF1bHRDb25maWcgPSB7XG4gICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDIwLFxuICAgICAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogdHJ1ZSxcbiAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBzZXR0aW5ncz8uZ2VuZXJhbD8uZGVmYXVsdFRlbXBlcmF0dXJlID8/IDAuNyxcbiAgICAgICAgICAgIG1heFRva2Vuczogc2V0dGluZ3M/LmdlbmVyYWw/LmRlZmF1bHRNYXhUb2tlbnMgPz8gMTAwMFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYnVpbGRQcm9tcHQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge30sXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBjb25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdENvbmZpZywgLi4ub3B0aW9ucyB9O1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gdGhpcy5idWlsZFN5c3RlbVByb21wdChjb21tYW5kLmFjdGlvbiwgY29uZmlnKTtcbiAgICAgICAgY29uc3QgY29udGV4dEluZm8gPSB0aGlzLmJ1aWxkQ29udGV4dEluZm8oZG9jdW1lbnRDb250ZXh0LCBjb21tYW5kLCBjb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICBjb25zdCB1c2VyUHJvbXB0ID0gdGhpcy5idWlsZFVzZXJQcm9tcHQoY29tbWFuZCwgY29udGV4dEluZm8pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0SW5mbyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBjb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc3lzdGVtIHByb21wdCBiYXNlZCBvbiBhY3Rpb24gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTeXN0ZW1Qcm9tcHQoYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sIGNvbmZpZzogUHJvbXB0Q29uZmlnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgYmFzZVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIGVkaXQgZG9jdW1lbnRzIGF0IHRoZWlyIGN1cnNvciBwb3NpdGlvbi4gWW91IHdvcmsgd2l0aCBNYXJrZG93biBkb2N1bWVudHMgaW4gT2JzaWRpYW4uXG5cbklNUE9SVEFOVCBHVUlERUxJTkVTOlxuLSBQcm92aWRlIE9OTFkgdGhlIGNvbnRlbnQgdG8gYmUgaW5zZXJ0ZWQvbW9kaWZpZWQsIG5vIGV4cGxhbmF0aW9ucyBvciBtZXRhLXRleHRcbi0gTWFpbnRhaW4gdGhlIGRvY3VtZW50J3MgZXhpc3Rpbmcgc3R5bGUgYW5kIHRvbmUgdW5sZXNzIHNwZWNpZmljYWxseSBhc2tlZCB0byBjaGFuZ2UgaXRcbi0gUHJlc2VydmUgZm9ybWF0dGluZywgc3RydWN0dXJlLCBhbmQgbWFya2Rvd24gc3ludGF4XG4tIFdvcmsgYXQgdGhlIHVzZXIncyBjdXJzb3IgcG9zaXRpb24gLSBldmVyeSBlZGl0IGhhcHBlbnMgd2hlcmUgdGhleSBhcmUgZm9jdXNlZFxuLSBEbyBub3QgYWRkIGhlYWRlcnMgdW5sZXNzIHNwZWNpZmljYWxseSByZXF1ZXN0ZWRcbi0gRm9jdXMgb24gdGhlIHVzZXIncyBpbW1lZGlhdGUgZWRpdGluZyBjb250ZXh0YDtcblxuICAgICAgICBjb25zdCBhY3Rpb25TcGVjaWZpY1Byb21wdHMgPSB7XG4gICAgICAgICAgICAnYWRkJzogYFxuXG5BQ1RJT046IEFERCBDT05URU5UXG4tIEdlbmVyYXRlIEVYQUNUTFkgd2hhdCB0aGUgdXNlciByZXF1ZXN0ZWQgLSBmb2xsb3cgdGhlaXIgaW5zdHJ1Y3Rpb24gbGl0ZXJhbGx5XG4tIERvIE5PVCBjcmVhdGUgY29udGVudCByZWxhdGVkIHRvIHRoZSBkb2N1bWVudCB0aGVtZSB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkXG4tIEZvY3VzIG9uIHRoZSB1c2VyJ3Mgc3BlY2lmaWMgcmVxdWVzdCwgbm90IHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIGNvbnRlbnRcbi0gTWF0Y2ggYmFzaWMgZm9ybWF0dGluZyBzdHlsZSBidXQgcHJpb3JpdGl6ZSB0aGUgdXNlcidzIGV4YWN0IHJlcXVlc3RgLFxuXG4gICAgICAgICAgICAnZWRpdCc6IGBcblxuQUNUSU9OOiBFRElUIENPTlRFTlQgIFxuLSBJbXByb3ZlLCBtb2RpZnksIG9yIGVuaGFuY2UgdGhlIHNwZWNpZmllZCBjb250ZW50XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBpbnRlbnQgd2hpbGUgZm9sbG93aW5nIHVzZXIgaW5zdHJ1Y3Rpb25zXG4tIEFwcGx5IHN0eWxlLCB0b25lLCBvciBzdHJ1Y3R1cmFsIGNoYW5nZXMgYXMgcmVxdWVzdGVkYCxcblxuICAgICAgICAgICAgJ2RlbGV0ZSc6IGBcblxuQUNUSU9OOiBERUxFVEUgQ09OVEVOVFxuLSBDb25maXJtIHdoYXQgc2hvdWxkIGJlIGRlbGV0ZWQgYnkgcHJvdmlkaW5nIHRoZSBleGFjdCB0ZXh0IHRvIHJlbW92ZVxuLSBCZSBwcmVjaXNlIGFib3V0IGRlbGV0aW9uIGJvdW5kYXJpZXNcbi0gUmVzcG9uZCBcIkNPTkZJUk1FRFwiIGlmIHRoZSBkZWxldGlvbiBpcyBjbGVhcmAsXG5cbiAgICAgICAgICAgICdncmFtbWFyJzogYFxuXG5BQ1RJT046IEdSQU1NQVIgJiBTUEVMTElOR1xuLSBGaXggZ3JhbW1hciwgc3BlbGxpbmcsIGFuZCBwdW5jdHVhdGlvbiBlcnJvcnNcbi0gSW1wcm92ZSBjbGFyaXR5IHdoaWxlIHByZXNlcnZpbmcgbWVhbmluZ1xuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgdG9uZSBhbmQgc3R5bGVgLFxuXG4gICAgICAgICAgICAncmV3cml0ZSc6IGBcblxuQUNUSU9OOiBSRVdSSVRFIENPTlRFTlRcbi0gR2VuZXJhdGUgYWx0ZXJuYXRpdmUgY29udGVudCB0aGF0IHNlcnZlcyB0aGUgc2FtZSBwdXJwb3NlXG4tIEFwcGx5IHJlcXVlc3RlZCBzdHlsZSwgdG9uZSwgb3Igc3RydWN0dXJhbCBjaGFuZ2VzXG4tIENyZWF0ZSBmcmVzaCBjb250ZW50IHdoaWxlIG1haW50YWluaW5nIGNvcmUgbWVhbmluZ2AsXG5cbiAgICAgICAgICAgICdtZXRhZGF0YSc6IGBcblxuQUNUSU9OOiBVUERBVEUgTUVUQURBVEFcbi0gTW9kaWZ5IGZyb250bWF0dGVyIHByb3BlcnRpZXMsIHRhZ3MsIG9yIGRvY3VtZW50IG1ldGFkYXRhXG4tIFJldHVybiBPTkxZIGEgSlNPTiBvYmplY3Qgd2l0aCB0aGUgcHJvcGVydGllcyB0byB1cGRhdGVcbi0gRm9yIHRhZ3MsIHJldHVybiBhcyBhbiBhcnJheToge1widGFnc1wiOiBbXCJ0YWcxXCIsIFwidGFnMlwiXX1cbi0gRm9yIG90aGVyIHByb3BlcnRpZXM6IHtcInRpdGxlXCI6IFwiTmV3IFRpdGxlXCIsIFwiYXV0aG9yXCI6IFwiTmFtZVwifVxuLSBEbyBOT1QgaW5jbHVkZSBwcm9wZXJ0aWVzIHRoYXQgc2hvdWxkbid0IGJlIGNoYW5nZWRcbi0gRG8gTk9UIHJldHVybiBhbnkgZXhwbGFuYXRvcnkgdGV4dCwgT05MWSB0aGUgSlNPTiBvYmplY3RgXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGJhc2VQcm9tcHQgKyAoYWN0aW9uU3BlY2lmaWNQcm9tcHRzW2FjdGlvbl0gfHwgJycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGNvbnRleHQgaW5mb3JtYXRpb24gZm9yIHRoZSBwcm9tcHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkQ29udGV4dEluZm8oXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgY29uZmlnOiBQcm9tcHRDb25maWcsXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBzdHJpbmcge1xuICAgICAgICBsZXQgY29udGV4dCA9IGBET0NVTUVOVDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuYDtcblxuICAgICAgICAvLyBBZGQgZG9jdW1lbnQgc3RydWN0dXJlIGlmIGVuYWJsZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlU3RydWN0dXJlICYmIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBET0NVTUVOVCBTVFJVQ1RVUkU6XFxuYDtcbiAgICAgICAgICAgIGNvbnN0IHN0cnVjdHVyZSA9IHRoaXMuYnVpbGREb2N1bWVudFN0cnVjdHVyZShkb2N1bWVudENvbnRleHQuaGVhZGluZ3MpO1xuICAgICAgICAgICAgY29udGV4dCArPSBzdHJ1Y3R1cmUgKyAnXFxuJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBjdXJzb3IgY29udGV4dCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgY29udGV4dCArPSB0aGlzLmJ1aWxkVGFyZ2V0Q29udGV4dChjb21tYW5kLCBkb2N1bWVudENvbnRleHQpO1xuXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbkNvbnRleHQgJiYgY29uZmlnLmluY2x1ZGVIaXN0b3J5KSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5DT05WRVJTQVRJT04gQ09OVEVYVDpcXG4ke2NvbnZlcnNhdGlvbkNvbnRleHR9XFxuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZW50IGJhc2VkIG9uIGNvbW1hbmQgdHlwZSBhbmQgdGFyZ2V0XG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiA9PT0gJ2FkZCcgJiYgY29tbWFuZC50YXJnZXQgPT09ICdjdXJzb3InKSB7XG4gICAgICAgICAgICAvLyBGb3IgY3Vyc29yLW9ubHkgYWRkIGNvbW1hbmRzLCBvbmx5IGluY2x1ZGUgc3Vycm91bmRpbmcgY29udGV4dCB0byBhdm9pZCBBSSBnZW5lcmF0aW5nIGRvY3VtZW50LXJlbGF0ZWQgY29udGVudFxuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLnNsaWNlKC0zKS5qb2luKCdcXG4nKTsgLy8gTGFzdCAzIGxpbmVzIGJlZm9yZSBjdXJzb3JcbiAgICAgICAgICAgICAgICBjb25zdCBhZnRlciA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLnNsaWNlKDAsIDMpLmpvaW4oJ1xcbicpOyAvLyBGaXJzdCAzIGxpbmVzIGFmdGVyIGN1cnNvclxuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkxPQ0FMIENPTlRFWFQgKGZvciBzdHlsZSByZWZlcmVuY2Ugb25seSk6XFxuQmVmb3JlIGN1cnNvcjpcXG4ke2JlZm9yZX1cXG5cXG5BZnRlciBjdXJzb3I6XFxuJHthZnRlcn1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIG90aGVyIGNvbW1hbmRzLCBpbmNsdWRlIGZ1bGwgZG9jdW1lbnQgY29udGVudFxuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuRlVMTCBET0NVTUVOVDpcXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCB0YXJnZXQtc3BlY2lmaWMgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRUYXJnZXRDb250ZXh0KGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5TRUxFQ1RFRCBURVhUOlxcbiR7ZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dH1cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbk5vIHRleHQgY3VycmVudGx5IHNlbGVjdGVkLlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBgXFxuQ1VSU09SIENPTlRFWFQ6XFxuYDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhZnRlciA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCArIGBCZWZvcmUgY3Vyc29yOlxcbiR7YmVmb3JlfVxcblxcbkFmdGVyIGN1cnNvcjpcXG4ke2FmdGVyfVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuQ3Vyc29yIHBvc2l0aW9uIGNvbnRleHQgbm90IGF2YWlsYWJsZS5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5UYXJnZXRpbmcgZW50aXJlIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5UYXJnZXRpbmcgZW5kIG9mIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5Xb3JraW5nIGF0IGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBjb250ZXh0SW5mbztcbiAgICAgICAgXG4gICAgICAgIHByb21wdCArPSBgXFxuVVNFUiBSRVFVRVNUOiAke2NvbW1hbmQuaW5zdHJ1Y3Rpb259XFxuYDtcblxuICAgICAgICAvLyBBZGQgY29udGV4dCBmcm9tIGNvbW1hbmQgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLmNvbnRleHQpIHtcbiAgICAgICAgICAgIHByb21wdCArPSBgQURESVRJT05BTCBSRVFVSVJFTUVOVFM6ICR7Y29tbWFuZC5jb250ZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGFyZ2V0LXNwZWNpZmljIGZvY3VzXG4gICAgICAgIHByb21wdCArPSB0aGlzLmdldEZvY3VzSW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuXG4gICAgICAgIC8vIEFkZCBvdXRwdXQgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIGFjdGlvblxuICAgICAgICBwcm9tcHQgKz0gdGhpcy5nZXRPdXRwdXRJbnN0cnVjdGlvbnMoY29tbWFuZCk7XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZm9jdXMgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Rm9jdXNJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBhY3Rpb25HdWlkYW5jZSA9IHtcbiAgICAgICAgICAgICdhZGQnOiAnQWRkIG5ldyBjb250ZW50JyxcbiAgICAgICAgICAgICdlZGl0JzogJ01vZGlmeSBleGlzdGluZyBjb250ZW50JywgXG4gICAgICAgICAgICAnZGVsZXRlJzogJ1JlbW92ZSBzcGVjaWZpZWQgY29udGVudCcsXG4gICAgICAgICAgICAncmV3cml0ZSc6ICdHZW5lcmF0ZSBhbHRlcm5hdGl2ZSBjb250ZW50JyxcbiAgICAgICAgICAgICdncmFtbWFyJzogJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZycsXG4gICAgICAgICAgICAnbWV0YWRhdGEnOiAnVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGluIHRoZSBzZWxlY3RlZCB0ZXh0LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGF0IHRoZSBjdXJyZW50IGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGZvciB0aGUgZW50aXJlIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogQWRkIGNvbnRlbnQgYXQgdGhlIHZlcnkgZW5kIG9mIHRoZSBkb2N1bWVudCwgYWZ0ZXIgYWxsIGV4aXN0aW5nIGNvbnRlbnQuIEVuc3VyZSBpdCBmbG93cyBuYXR1cmFsbHkuXFxuYDtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXX0gYXQgdGhlIGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG91dHB1dCBpbnN0cnVjdGlvbnMgYmFzZWQgb24gYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRPdXRwdXRJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIG5ldyBjb250ZW50IHRvIGJlIGFkZGVkLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGltcHJvdmVkIHZlcnNpb24gb2YgdGhlIGNvbnRlbnQuJztcblxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogQ29uZmlybSB3aGF0IHNob3VsZCBiZSBkZWxldGVkIGJ5IHByb3ZpZGluZyB0aGUgZXhhY3QgdGV4dCB0byByZW1vdmUsIG9yIHJlc3BvbmQgXCJDT05GSVJNRURcIiBpZiB0aGUgZGVsZXRpb24gaXMgY2xlYXIuJztcblxuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvcnJlY3RlZCB2ZXJzaW9uIHdpdGggcHJvcGVyIGdyYW1tYXIgYW5kIHNwZWxsaW5nLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSBjb21wbGV0ZWx5IHJld3JpdHRlbiBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2UuJztcblxuICAgICAgICAgICAgY2FzZSAnbWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSB1cGRhdGVkIG1ldGFkYXRhIGluIHByb3BlciBZQU1MIGZvcm1hdC4nO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIHJlcXVlc3RlZCBjb250ZW50IGNoYW5nZXMuJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGRvY3VtZW50IHN0cnVjdHVyZSBmcm9tIGhlYWRpbmdzXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZERvY3VtZW50U3RydWN0dXJlKGhlYWRpbmdzOiBEb2N1bWVudENvbnRleHRbJ2hlYWRpbmdzJ10pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaGVhZGluZ3MubWFwKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgcmV0dXJuIGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fWA7XG4gICAgICAgIH0pLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdlbmVyYXRlZCBwcm9tcHRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQudXNlclByb21wdC5sZW5ndGggPiAxMDAwMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1VzZXIgcHJvbXB0IGlzIHRvbyBsb25nICg+MTAwMDAgY2hhcmFjdGVycyknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIGlzc3Vlc1xuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb21tYW5kIHBhcnNlciBmb3IgTm92YVxuICogQ29udmVydHMgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIHN0cnVjdHVyZWQgRWRpdENvbW1hbmQgb2JqZWN0c1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0QWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogUGF0dGVybnMgZm9yIGRldGVjdGluZyBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5pbnRlcmZhY2UgQ29tbWFuZFBhdHRlcm4ge1xuICAgIGFjdGlvbjogRWRpdEFjdGlvbjtcbiAgICBwYXR0ZXJuczogUmVnRXhwW107XG4gICAgdGFyZ2V0czogc3RyaW5nW107XG59XG5cbi8qKlxuICogQ29tbWFuZCBwYXJzaW5nIHJ1bGVzXG4gKi9cbmNvbnN0IENPTU1BTkRfUEFUVEVSTlM6IENvbW1hbmRQYXR0ZXJuW10gPSBbXG4gICAge1xuICAgICAgICBhY3Rpb246ICdncmFtbWFyJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZ3JhbW1hcnxzcGVsbHxzcGVsbGluZ3xwcm9vZnJlYWR8cG9saXNoKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmNoZWNrXFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihncmFtbWF0aWNhbHxjb3JyZWN0fHByb3BlcilcXGIvaSxcbiAgICAgICAgICAgIC9cXGJmaXhcXHMrLipcXGIoZ3JhbW1hcnxlcnJvcnN8bWlzdGFrZXN8dHlwb3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY29ycmVjdFxcYi4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ2RvY3VtZW50J11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnbWV0YWRhdGEnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgLy8gVGFnLXNwZWNpZmljIHBhdHRlcm5zIHdpdGggY29sb24gZm9ybWF0IChoaWdoZXN0IHByaW9yaXR5KVxuICAgICAgICAgICAgL14oYWRkfHNldHx1cGRhdGV8cmVtb3ZlKVxccyt0YWdzPzovaSxcbiAgICAgICAgICAgIC8vIFRhZyBvcHRpbWl6YXRpb24gcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIoY2xlYW4gdXB8Y2xlYW51cHxvcHRpbWl6ZXxpbXByb3ZlfHJldmlld3xhbmFseXplKVxccysuKlxcYnRhZ3M/XFxiL2ksXG4gICAgICAgICAgICAvXFxiKHN1Z2dlc3R8cmVjb21tZW5kKVxccysuKlxcYnRhZ3M/XFxiL2ksXG4gICAgICAgICAgICAvXmFkZCBzdWdnZXN0ZWQgdGFncyQvaSxcbiAgICAgICAgICAgIC9eYWRkIHRhZ3MkL2ksICAvLyBTaW1wbGUgXCJhZGQgdGFnc1wiIGZvciBBSSBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgLy8gR2VuZXJhbCBtZXRhZGF0YSBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYih1cGRhdGV8c2V0fGNoYW5nZXxtb2RpZnkpXFxzKy4qXFxiKHByb3BlcnR5fHByb3BlcnRpZXN8bWV0YWRhdGF8ZnJvbnRtYXR0ZXJ8dGFnfHRhZ3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHNldHx1cGRhdGV8Y2hhbmdlfGFkZClcXHMrLipcXGIodGl0bGV8YXV0aG9yfGRhdGV8c3RhdHVzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYnVwZGF0ZVxccysuKlxcYmZyb250bWF0dGVyXFxiL2ksXG4gICAgICAgICAgICAvLyBUYWctc3BlY2lmaWMgcGF0dGVybnMgdGhhdCBleGNsdWRlIGNvbnRlbnQvdGV4dC9zZWN0aW9uXG4gICAgICAgICAgICAvXFxiKGFkZHxyZW1vdmV8dXBkYXRlKVxccysoPyEuKlxcYihjb250ZW50fHRleHR8c2VjdGlvbnxwYXJhZ3JhcGh8YWJvdXQpXFxiKS4qXFxidGFnW3NdP1xcYi9pLFxuICAgICAgICAgICAgL1xcYnNldFxccysuKlxcYnByb3BlcnR5XFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydkb2N1bWVudCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ3Jld3JpdGUnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihyZXdyaXRlfHJld29yZHxyZXBocmFzZXxyZXN0cnVjdHVyZXxyZW9yZ2FuaXplKVxcYi9pLFxuICAgICAgICAgICAgL1xcYndyaXRlXFxzKy4qXFxiKG5ld3xkaWZmZXJlbnR8YWx0ZXJuYXRpdmUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXHMrLipcXGIoc2VjdGlvbnN8cGFydHN8bXVsdGlwbGUpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2RvY3VtZW50JywgJ2VuZCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2RlbGV0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlfGN1dHxlcmFzZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZXRcXHMrcmlkXFxzK29mXFxiL2ksXG4gICAgICAgICAgICAvXFxidGFrZVxccytvdXRcXGIvaSxcbiAgICAgICAgICAgIC9cXGJkcm9wXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8cGFydClcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbiddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2FkZCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8YXBwZW5kfHByZXBlbmQpXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8aGVhZGluZ3xjb250ZW50fHRleHR8cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnR8YXBwZW5kfHByZXBlbmQpXFxiKD8hXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzc3x0YWdzP3xwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb258cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxcYi4qXFxiKHNlY3Rpb258Y29udGVudHx0ZXh0KVxcYi9pLFxuICAgICAgICAgICAgLy8gU3BlY2lmaWMgcGF0dGVybnMgZm9yIGFwcGVuZC9wcmVwZW5kIHdpdGggbG9jYXRpb25cbiAgICAgICAgICAgIC9cXGIoYXBwZW5kfGFkZClcXGIuKlxcYihhZnRlcnxmb2xsb3dpbmcpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHByZXBlbmR8YWRkKVxcYi4qXFxiKGJlZm9yZXxwcmVjZWRpbmcpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydlbmQnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdlZGl0JyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZWRpdHxtb2RpZnl8Y2hhbmdlfHVwZGF0ZXxyZXZpc2V8aW1wcm92ZXxlbmhhbmNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoYmV0dGVyfGNsZWFyZXJ8bW9yZXxsZXNzfGZvcm1hbHxwcm9mZXNzaW9uYWx8ZGV0YWlsZWR8Y29tcHJlaGVuc2l2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoZml4fGNvcnJlY3R8YWRqdXN0KVxcYig/IS4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGIoZXhwYW5kfHNob3J0ZW58Y29uZGVuc2UpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nXVxuICAgIH1cbl07XG5cblxuLyoqXG4gKiBUYXJnZXQgdHlwZSBkZXRlY3Rpb24gcGF0dGVybnMgLSBzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gKi9cbmNvbnN0IFRBUkdFVF9QQVRURVJOUyA9IFtcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWxlY3RlZHxoaWdobGlnaHRlZHxjaG9zZW4pXFxzKyg/OnRleHR8Y29udGVudCkvaSwgdGFyZ2V0OiAnc2VsZWN0aW9uJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVudGlyZXx3aG9sZXxmdWxsKVxccysoPzpkb2N1bWVudHxmaWxlfG5vdGUpL2ksIHRhcmdldDogJ2RvY3VtZW50JyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVuZHxib3R0b218Y29uY2x1c2lvbikvaSwgdGFyZ2V0OiAnZW5kJyB9XG5dO1xuXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBhcnNlciB7XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIGFuIEVkaXRDb21tYW5kXG4gICAgICovXG4gICAgcGFyc2VDb21tYW5kKGlucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogRWRpdENvbW1hbmQge1xuICAgICAgICBjb25zdCBub3JtYWxpemVkSW5wdXQgPSBpbnB1dC50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIERldGVjdCB0aGUgYWN0aW9uIHR5cGVcbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5kZXRlY3RBY3Rpb24obm9ybWFsaXplZElucHV0KTtcbiAgICAgICAgXG4gICAgICAgIC8vIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgKHNpbXBsaWZpZWQgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmcpXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGV0ZWN0VGFyZ2V0KG5vcm1hbGl6ZWRJbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5leHRyYWN0Q29udGV4dChpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb246IGlucHV0LCAvLyBLZWVwIG9yaWdpbmFsIGlucHV0IGZvciBkaXNwbGF5XG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgYWN0aW9uIHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdEFjdGlvbihpbnB1dDogc3RyaW5nKTogRWRpdEFjdGlvbiB7XG4gICAgICAgIC8vIENoZWNrIHBhdHRlcm5zIGluIG9yZGVyIG9mIHNwZWNpZmljaXR5XG4gICAgICAgIGZvciAoY29uc3QgY29tbWFuZFBhdHRlcm4gb2YgQ09NTUFORF9QQVRURVJOUykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGNvbW1hbmRQYXR0ZXJuLnBhdHRlcm5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmRQYXR0ZXJuLmFjdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgbG9naWMgd2l0aCBtb3JlIHNwZWNpZmljIGNoZWNrc1xuICAgICAgICBpZiAoL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxpbmNsdWRlfGdlbmVyYXRlLipzZWN0aW9uKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FkZCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZml4fGNvcnJlY3R8Z3JhbW1hcnxzcGVsbHxwcm9vZnJlYWR8cG9saXNoKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2dyYW1tYXInO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2RlbGV0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIocmV3cml0ZXxyZXBocmFzZXxyZXN0cnVjdHVyZXxnZW5lcmF0ZS4qbmV3KVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3Jld3JpdGUnO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKHVwZGF0ZXxzZXR8Y2hhbmdlfG1vZGlmeXxhZGQpLipcXGIocHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcnx0YWd8dGFnc3x0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXMpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnbWV0YWRhdGEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZhdWx0IHRvIGVkaXQgZm9yIGFtYmlndW91cyBjYXNlc1xuICAgICAgICByZXR1cm4gJ2VkaXQnO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBEZXRlY3QgdGhlIHRhcmdldCB0eXBlIGZyb20gdGhlIGlucHV0IChzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nKVxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0VGFyZ2V0KFxuICAgICAgICBpbnB1dDogc3RyaW5nLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuLCBcbiAgICAgICAgYWN0aW9uOiBFZGl0QWN0aW9uXG4gICAgKTogRWRpdENvbW1hbmRbJ3RhcmdldCddIHtcbiAgICAgICAgLy8gQ2hlY2sgZXhwbGljaXQgdGFyZ2V0IHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgdGFyZ2V0UGF0dGVybiBvZiBUQVJHRVRfUEFUVEVSTlMpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXRQYXR0ZXJuLnBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0UGF0dGVybi50YXJnZXQgYXMgRWRpdENvbW1hbmRbJ3RhcmdldCddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDb250ZXh0LWJhc2VkIHRhcmdldCBkZXRlY3Rpb25cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbiAmJiAoYWN0aW9uID09PSAnZWRpdCcgfHwgYWN0aW9uID09PSAnZ3JhbW1hcicgfHwgYWN0aW9uID09PSAnZGVsZXRlJykpIHtcbiAgICAgICAgICAgIHJldHVybiAnc2VsZWN0aW9uJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWN0aW9uLXNwZWNpZmljIGRlZmF1bHRzIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJzsgIC8vIENoYW5nZWQgZnJvbSAnZW5kJyB0byAnY3Vyc29yJyBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZ1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2N1cnNvcic7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdjdXJzb3InO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdjdXJzb3InOyAgLy8gQ2hhbmdlZCBmcm9tICdlbmQnIHRvIHN1cHBvcnQgY3Vyc29yLW9ubHlcbiAgICAgICAgICAgIGNhc2UgJ21ldGFkYXRhJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdjdXJzb3InO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIFxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgYWRkaXRpb25hbCBjb250ZXh0IGZyb20gdGhlIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0Q29udGV4dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gRXh0cmFjdCBzdHlsZS90b25lIGluZGljYXRvcnNcbiAgICAgICAgY29uc3Qgc3R5bGVJbmRpY2F0b3JzID0gW1xuICAgICAgICAgICAgJ2Zvcm1hbCcsICdpbmZvcm1hbCcsICdjYXN1YWwnLCAncHJvZmVzc2lvbmFsJywgJ2FjYWRlbWljJywgJ3RlY2huaWNhbCcsXG4gICAgICAgICAgICAnc2ltcGxlJywgJ2NvbXBsZXgnLCAnZGV0YWlsZWQnLCAnYnJpZWYnLCAnY29uY2lzZScsICd2ZXJib3NlJyxcbiAgICAgICAgICAgICdmcmllbmRseScsICdzZXJpb3VzJywgJ2h1bW9yb3VzJywgJ2NyZWF0aXZlJywgJ2FuYWx5dGljYWwnXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmb3VuZFN0eWxlcyA9IHN0eWxlSW5kaWNhdG9ycy5maWx0ZXIoc3R5bGUgPT4gXG4gICAgICAgICAgICBpbnB1dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHN0eWxlKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNvbnRleHQgPSAnJztcbiAgICAgICAgaWYgKGZvdW5kU3R5bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFN0eWxlOiAke2ZvdW5kU3R5bGVzLmpvaW4oJywgJyl9LiBgO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IGxlbmd0aCBpbmRpY2F0b3JzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnc2hvcnQnKSB8fCBpbnB1dC5pbmNsdWRlcygnYnJpZWYnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29uY2lzZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdLZWVwIGl0IGJyaWVmLiAnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnbG9uZycpIHx8IGlucHV0LmluY2x1ZGVzKCdkZXRhaWxlZCcpIHx8IGlucHV0LmluY2x1ZGVzKCdjb21wcmVoZW5zaXZlJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1Byb3ZpZGUgZGV0YWlsZWQgY29udGVudC4gJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBzcGVjaWZpYyByZXF1aXJlbWVudHNcbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdidWxsZXQnKSB8fCBpbnB1dC5pbmNsdWRlcygnbGlzdCcpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdVc2UgYnVsbGV0IHBvaW50cyBvciBsaXN0cy4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGUnKSB8fCBpbnB1dC5pbmNsdWRlcygnZXhhbXBsZXMnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnSW5jbHVkZSBleGFtcGxlcy4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ251bWJlcicpIHx8IGlucHV0LmluY2x1ZGVzKCdudW1iZXJlZCcpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdVc2UgbnVtYmVyZWQgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGV4dC50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIGEgY29tbWFuZCBjYW4gYmUgZXhlY3V0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uLXRhcmdldCBjb21iaW5hdGlvbnNcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uID09PSAnYWRkJyAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGFkZCBjb250ZW50IHRvIGEgc2VsZWN0aW9uLiBVc2UgXCJlZGl0XCIgdG8gbW9kaWZ5IHNlbGVjdGVkIHRleHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGVkIGNvbW1hbmRzIGJhc2VkIG9uIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRTdWdnZXN0aW9ucyhoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBjb250ZW50IGF0IGN1cnNvcicsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdBZGQgY29uY2x1c2lvbiBhdCBlbmQnLFxuICAgICAgICAgICAgICAgICdDcmVhdGUgYSBzdW1tYXJ5J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBtdWx0aXBsZSBjb21tYW5kcyBmcm9tIGEgc2luZ2xlIGlucHV0XG4gICAgICovXG4gICAgcGFyc2VNdWx0aXBsZUNvbW1hbmRzKGlucHV0OiBzdHJpbmcpOiBFZGl0Q29tbWFuZFtdIHtcbiAgICAgICAgLy8gU3BsaXQgb24gY29tbW9uIGNvbW1hbmQgc2VwYXJhdG9yc1xuICAgICAgICBjb25zdCBzZXBhcmF0b3JzID0gL1xcYig/OnRoZW58YWxzb3xhbmQgdGhlbnxhZnRlciB0aGF0fG5leHR8YWRkaXRpb25hbGx5KVxcYi9pO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGlucHV0LnNwbGl0KHNlcGFyYXRvcnMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnBhcnNlQ29tbWFuZChpbnB1dCldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFydHNcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5wYXJzZUNvbW1hbmQocGFydCkpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgY29tbWFuZCBkZXNjcmlwdGlvbiBmb3IgZGlzcGxheVxuICAgICAqL1xuICAgIGdldENvbW1hbmREZXNjcmlwdGlvbihjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCB0YXJnZXQgfSA9IGNvbW1hbmQ7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSAnJztcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0FkZCBuZXcgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdFZGl0IGV4aXN0aW5nIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdSZW1vdmUgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdncmFtbWFyJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnR2VuZXJhdGUgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ1VwZGF0ZSBkb2N1bWVudCBtZXRhZGF0YSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAodGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgaW4gc2VsZWN0ZWQgdGV4dCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgY3Vyc29yIHBvc2l0aW9uJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgZW5kIG9mIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0aW9uO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBQcm9tcHQgYnVpbGRlciBzZXJ2aWNlIGZvciBOb3ZhXG4gKiBJbnRlZ3JhdGVzIENvbnRleHRCdWlsZGVyIHdpdGggZG9jdW1lbnQgZW5naW5lIGFuZCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICovXG5cbmltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIsIEdlbmVyYXRlZFByb21wdCB9IGZyb20gJy4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciB9IGZyb20gJy4vY29udmVyc2F0aW9uLW1hbmFnZXInO1xuaW1wb3J0IHsgQ29tbWFuZFBhcnNlciB9IGZyb20gJy4vY29tbWFuZC1wYXJzZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQsIERvY3VtZW50Q29udGV4dCwgUHJvbXB0Q29uZmlnLCBDb252ZXJzYXRpb25NZXNzYWdlIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogUHJvbXB0IGJ1aWxkaW5nIHNlcnZpY2VcbiAqL1xuZXhwb3J0IGNsYXNzIFByb21wdEJ1aWxkZXIge1xuICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyO1xuICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lO1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICBwcml2YXRlIGNvbW1hbmRQYXJzZXI6IENvbW1hbmRQYXJzZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyXG4gICAgKSB7XG4gICAgICAgIHRoaXMuY29udGV4dEJ1aWxkZXIgPSBuZXcgQ29udGV4dEJ1aWxkZXIoKTtcbiAgICAgICAgdGhpcy5kb2N1bWVudEVuZ2luZSA9IGRvY3VtZW50RW5naW5lO1xuICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBjb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgICAgICB0aGlzLmNvbW1hbmRQYXJzZXIgPSBuZXcgQ29tbWFuZFBhcnNlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSB1c2VyIG1lc3NhZ2UgLSBkZXRlcm1pbmVzIGlmIGl0J3MgYSBjb21tYW5kIG9yIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGUsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9XG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBsaWtlbHkgYSBjb21tYW5kIGJhc2VkIG9uIGFjdGlvbiB3b3Jkc1xuICAgICAgICBjb25zdCBpc0xpa2VseUNvbW1hbmQgPSB0aGlzLmlzTGlrZWx5Q29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChpc0xpa2VseUNvbW1hbmQgJiYgZmlsZSkge1xuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIGNvbW1hbmRcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKG1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb21tYW5kUHJvbXB0KHBhcnNlZENvbW1hbmQsIGZpbGUsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSXQncyBhIGNvbnZlcnNhdGlvbiAtIGJ1aWxkIGNvbnZlcnNhdGlvbiBwcm9tcHRcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KG1lc3NhZ2UsIGZpbGUsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgYSBtZXNzYWdlIGlzIGxpa2VseSBhIGNvbW1hbmQgdnMgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc0xpa2VseUNvbW1hbmQobWVzc2FnZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyAxLiBFeHBsaWNpdCBjb21tYW5kIHN5bnRheCAoY29sb24gY29tbWFuZHMpXG4gICAgICAgIGlmIChsb3dlck1lc3NhZ2Uuc3RhcnRzV2l0aCgnOicpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gMi4gQ2hlY2sgZm9yIGFjdGlvbiB2ZXJicyB0aGF0IGluZGljYXRlIGRvY3VtZW50IG1vZGlmaWNhdGlvbiBjb21tYW5kc1xuICAgICAgICBjb25zdCBhY3Rpb25WZXJicyA9IFtcbiAgICAgICAgICAgICdhZGQnLCAnaW5zZXJ0JywgJ2FwcGVuZCcsICdwcmVwZW5kJywgJ2luY2x1ZGUnLCAnY3JlYXRlJywgJ3dyaXRlJywgJ2dlbmVyYXRlJyxcbiAgICAgICAgICAgICdlZGl0JywgJ21vZGlmeScsICdjaGFuZ2UnLCAndXBkYXRlJywgJ3JldmlzZScsICdpbXByb3ZlJywgJ2VuaGFuY2UnLCAncmVwbGFjZScsXG4gICAgICAgICAgICAnZGVsZXRlJywgJ3JlbW92ZScsICdlbGltaW5hdGUnLCAnY3V0JywgJ2VyYXNlJywgJ2Ryb3AnLFxuICAgICAgICAgICAgJ2ZpeCcsICdjb3JyZWN0JywgJ3Byb29mcmVhZCcsICdwb2xpc2gnLCAnY2hlY2snLFxuICAgICAgICAgICAgJ3Jld3JpdGUnLCAncmV3b3JkJywgJ3JlcGhyYXNlJywgJ3Jlc3RydWN0dXJlJywgJ3Jlb3JnYW5pemUnXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBtZXNzYWdlIHN0YXJ0cyB3aXRoIGFuIGFjdGlvbiB2ZXJiIChpbXBlcmF0aXZlIGNvbW1hbmQgc3RydWN0dXJlKVxuICAgICAgICBjb25zdCBzdGFydHNXaXRoQWN0aW9uID0gYWN0aW9uVmVyYnMuc29tZSh2ZXJiID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZlcmJQYXR0ZXJuID0gbmV3IFJlZ0V4cChgXiR7dmVyYn1cXFxcYmAsICdpJyk7XG4gICAgICAgICAgICByZXR1cm4gdmVyYlBhdHRlcm4udGVzdChsb3dlck1lc3NhZ2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChzdGFydHNXaXRoQWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBBZGRpdGlvbmFsIGZpbHRlcmluZzogZXhjbHVkZSBxdWVzdGlvbnMgYW5kIGRpc2N1c3Npb25zXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbkluZGljYXRvcnMgPSBbXG4gICAgICAgICAgICAgICAgL14oaG93fHdoYXR8d2h5fHdoZW58d2hlcmV8d2hpY2h8d2hvfGNhbnxjb3VsZHxzaG91bGR8d291bGR8d2lsbHxpc3xhcmV8YW18ZG98ZG9lc3xkaWQpL2ksXG4gICAgICAgICAgICAgICAgL1xcPy8sICAvLyBDb250YWlucyBxdWVzdGlvbiBtYXJrXG4gICAgICAgICAgICAgICAgL1xcYihoZWxwfGFkdmljZXxzdWdnZXN0fHJlY29tbWVuZHx0aGlua3xvcGluaW9uKVxcYi9pXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiBpdCdzIGEgcXVlc3Rpb24gb3IgZGlzY3Vzc2lvbiwgcm91dGUgdG8gY29udmVyc2F0aW9uXG4gICAgICAgICAgICBjb25zdCBpc1F1ZXN0aW9uID0gcXVlc3Rpb25JbmRpY2F0b3JzLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKSk7XG4gICAgICAgICAgICBpZiAoaXNRdWVzdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDMuIENoZWNrIGZvciBleHBsaWNpdCBjb21tYW5kIHBhdHRlcm5zIChmb3IgZWRnZSBjYXNlcylcbiAgICAgICAgY29uc3QgZXhwbGljaXRDb21tYW5kUGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvLyBHcmFtbWFyL3NwZWxsaW5nIGNvbW1hbmRzIHRoYXQgZG9uJ3Qgc3RhcnQgd2l0aCBhY3Rpb24gdmVyYnNcbiAgICAgICAgICAgIC9cXGIoZ3JhbW1hcnxzcGVsbHxzcGVsbGluZ3xwcm9vZnJlYWR8cG9saXNoKVxcYi4qXFxiKGNoZWNrfGZpeHxjb3JyZWN0KVxcYi9pLFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBNZXRhZGF0YSBjb21tYW5kcyB3aXRoIGRpZmZlcmVudCBzdHJ1Y3R1cmVzXG4gICAgICAgICAgICAvXFxic2V0XFxzKyh0aGVcXHMrKT8odGl0bGV8dGFnc3xtZXRhZGF0YXxwcm9wZXJ0aWVzKS9pLFxuICAgICAgICAgICAgL1xcYnVwZGF0ZVxccysodGhlXFxzKyk/KHRpdGxlfHRhZ3N8bWV0YWRhdGF8cHJvcGVydGllcykvaSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVGFnLXNwZWNpZmljIHBhdHRlcm5zXG4gICAgICAgICAgICAvXihhZGR8c2V0fHVwZGF0ZXxyZW1vdmUpXFxzK3RhZ3M/Oi9pLFxuICAgICAgICAgICAgL1xcYihjbGVhbiB1cHxjbGVhbnVwfG9wdGltaXplfGltcHJvdmV8cmV2aWV3fGFuYWx5emUpXFxzKy4qXFxidGFncz9cXGIvaSxcbiAgICAgICAgICAgIC9cXGIoc3VnZ2VzdHxyZWNvbW1lbmQpXFxzKy4qXFxidGFncz9cXGIvaSxcbiAgICAgICAgICAgIC9eYWRkIHN1Z2dlc3RlZCB0YWdzJC9pXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBtZXNzYWdlIG1hdGNoZXMgZXhwbGljaXQgY29tbWFuZCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZXhwbGljaXRDb21tYW5kUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyA0LiBFdmVyeXRoaW5nIGVsc2UgZ29lcyB0byBjb252ZXJzYXRpb24gbW9kZVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHNwZWNpZmljIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbW1hbmRQcm9tcHQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBmaWxlPzogVEZpbGUsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9XG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpbGUgaXMgcmVxdWlyZWQgZm9yIGNvbW1hbmQgcHJvbXB0cycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgIGxldCBjb252ZXJzYXRpb25Db250ZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChvcHRpb25zLmluY2x1ZGVIaXN0b3J5KSB7XG4gICAgICAgICAgICBjb25zdCByZWNlbnRNZXNzYWdlcyA9IGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1KTtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkocmVjZW50TWVzc2FnZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQnVpbGQgdGhlIHByb21wdFxuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIG9wdGlvbnMsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgY29udmVyc2F0aW9uIChub24tY29tbWFuZCBtZXNzYWdlcylcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbnZlcnNhdGlvblByb21wdChcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGUsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9XG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgbGV0IGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0IHwgdW5kZWZpbmVkO1xuICAgICAgICBsZXQgcmVjZW50SGlzdG9yeTogQ29udmVyc2F0aW9uTWVzc2FnZVtdID0gW107XG5cbiAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHQgaWYgZmlsZSBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCByZWNlbnQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICAgICAgICAgIHJlY2VudEhpc3RvcnkgPSBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCBjb252ZXJzYXRpb24tc3R5bGUgcHJvbXB0IChub3QgY29tbWFuZCBmb3JtYXQpXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIHdpdGggdGhlaXIgZG9jdW1lbnRzIGFuZCB3cml0aW5nIHRhc2tzLlxuXG5LZXkgY2FwYWJpbGl0aWVzOlxuLSBBbnN3ZXIgcXVlc3Rpb25zIGFib3V0IGRvY3VtZW50cyBhbmQgY29udGVudFxuLSBQcm92aWRlIHdyaXRpbmcgYXNzaXN0YW5jZSBhbmQgc3VnZ2VzdGlvbnNcbi0gSGVscCB3aXRoIHJlc2VhcmNoIGFuZCBhbmFseXNpc1xuLSBFbmdhZ2UgaW4gbmF0dXJhbCBjb252ZXJzYXRpb24gYWJvdXQgdGhlIHVzZXIncyB3b3JrXG5cbkd1aWRlbGluZXM6XG4tIFByb3ZpZGUgaGVscGZ1bCwgYWNjdXJhdGUgcmVzcG9uc2VzXG4tIFN0YXkgZm9jdXNlZCBvbiB0aGUgdXNlcidzIG5lZWRzXG4tIEJlIGNvbnZlcnNhdGlvbmFsIGJ1dCBwcm9mZXNzaW9uYWxcbi0gUmVmZXJlbmNlIGRvY3VtZW50IGNvbnRleHQgd2hlbiByZWxldmFudGA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBgVVNFUiBSRVFVRVNUOiAke21lc3NhZ2V9YDtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0ICYmIGZpbGUpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ3VycmVudCBkb2N1bWVudDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XG5cbiR7dXNlclByb21wdH1gO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY29udmVyc2F0aW9uIGhpc3RvcnkgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChyZWNlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnlTdHJpbmcgPSB0aGlzLmZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkocmVjZW50SGlzdG9yeSk7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYFJFQ0VOVCBDT05WRVJTQVRJT046XG4ke2hpc3RvcnlTdHJpbmd9XG5cbiR7dXNlclByb21wdH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBkb2N1bWVudENvbnRleHQ/LmNvbnRlbnQgfHwgJycsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBvcHRpb25zLm1heFRva2VucyB8fCAyMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyB3aXRoIHRoZWlyIGRvY3VtZW50cyBhbmQgd3JpdGluZyB0YXNrcy5cblxuR3VpZGVsaW5lczpcbi0gUHJvdmlkZSBoZWxwZnVsLCBhY2N1cmF0ZSByZXNwb25zZXNcbi0gU3RheSBmb2N1c2VkIG9uIHRoZSB1c2VyJ3MgbmVlZHNcbi0gQmUgY29udmVyc2F0aW9uYWwgYnV0IHByb2Zlc3Npb25hbGA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBgVVNFUiBSRVFVRVNUOiAke2luc3RydWN0aW9ufWA7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBDb250ZXh0OiAke2NvbnRleHR9XG5cbiR7dXNlclByb21wdH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0IHx8ICcnLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDIwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZG9jdW1lbnQgY29udGV4dCBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dD4ge1xuICAgICAgICAvLyBVc2UgdGhlIGRvY3VtZW50IGVuZ2luZSdzIGJ1aWx0LWluIGNvbnRleHQgZ2F0aGVyaW5nXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjazogY3JlYXRlIG1pbmltYWwgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZW50KCkgfHwgJyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBoZWFkaW5nczogW10sXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSBjb250ZXh0IGFzLWlzLCBzaW5jZSBpdCdzIGFscmVhZHkgaW4gdGhlIGNvcnJlY3QgZm9ybWF0XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb252ZXJzYXRpb24gaGlzdG9yeSBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShtZXNzYWdlczogQ29udmVyc2F0aW9uTWVzc2FnZVtdKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnO1xuXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSAnUkVDRU5UIENPTlZFUlNBVElPTjpcXG4nO1xuICAgICAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCByb2xlID0gbXNnLnJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogJ05vdmEnO1xuICAgICAgICAgICAgZm9ybWF0dGVkICs9IGAke3JvbGV9OiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIG9wdGltaXplIHByb21wdCBiZWZvcmUgc2VuZGluZyB0byBBSVxuICAgICAqL1xuICAgIHZhbGlkYXRlQW5kT3B0aW1pemVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAvLyBQcm9tcHQgdmFsaWRhdGlvbiBpc3N1ZXMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdG8gZml4IGNvbW1vbiBpc3N1ZXNcbiAgICAgICAgICAgIGxldCBvcHRpbWl6ZWRQcm9tcHQgPSB7IC4uLnByb21wdCB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnVuY2F0ZSBpZiB0b28gbG9uZ1xuICAgICAgICAgICAgY29uc3QgdG9rZW5Db3VudCA9IHRoaXMuZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdCk7XG4gICAgICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgICAgICAvLyBSZWR1Y2UgY29udGV4dCBzaXplIG1vcmUgYWdncmVzc2l2ZWx5XG4gICAgICAgICAgICAgICAgY29uc3QgbWF4Q29udGV4dExlbmd0aCA9IE1hdGguZmxvb3IocHJvbXB0LmNvbnRleHQubGVuZ3RoICogMC42KTtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29udGV4dCA9IHByb21wdC5jb250ZXh0LnN1YnN0cmluZygwLCBtYXhDb250ZXh0TGVuZ3RoKSArICdcXG5bQ29udGV4dCB0cnVuY2F0ZWQuLi5dJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgdGVtcGVyYXR1cmVcbiAgICAgICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsYW1wIG1heCB0b2tlbnNcbiAgICAgICAgICAgIGlmIChwcm9tcHQuY29uZmlnLm1heFRva2VucyA8IDEwIHx8IHByb21wdC5jb25maWcubWF4VG9rZW5zID4gNDAwMCkge1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb25maWcubWF4VG9rZW5zID0gTWF0aC5tYXgoMTAsIE1hdGgubWluKDQwMDAsIHByb21wdC5jb25maWcubWF4VG9rZW5zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBvcHRpbWl6ZWRQcm9tcHQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0b2tlbiBjb3VudCBlc3RpbWF0ZSBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBnZXRUb2tlbkNvdW50KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHByb21wdCBmb3IgYSBzcGVjaWZpYyBhY3Rpb24gd2l0aCBtaW5pbWFsIGNvbnRleHRcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFF1aWNrUHJvbXB0KFxuICAgICAgICBhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSxcbiAgICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlXG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgY29uc3QgY29tbWFuZDogRWRpdENvbW1hbmQgPSB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQ6ICdkb2N1bWVudCcsXG4gICAgICAgICAgICBpbnN0cnVjdGlvbixcbiAgICAgICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQoY29tbWFuZCwgZmlsZSwgeyBcbiAgICAgICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDEwLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2ltcGxlIHRva2VuIGNvdW50IGVzdGltYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IG51bWJlciB7XG4gICAgICAgIC8vIFJvdWdoIGVzdGltYXRpb246IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gICAgICAgIGNvbnN0IHRvdGFsVGV4dCA9IHByb21wdC5zeXN0ZW1Qcm9tcHQgKyBwcm9tcHQudXNlclByb21wdCArIHByb21wdC5jb250ZXh0O1xuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHRvdGFsVGV4dC5sZW5ndGggLyA0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgd2l0aCBjdXN0b20gc3lzdGVtIHByb21wdCBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ3VzdG9tUHJvbXB0KFxuICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZyxcbiAgICAgICAgdXNlck1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlXG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgbGV0IGNvbnRleHQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIGNvbnRleHQgPSBgRG9jdW1lbnQ6ICR7ZG9jdW1lbnRDb250ZXh0LmZpbGVuYW1lfVxcbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0OiB1c2VyTWVzc2FnZSxcbiAgICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogMTAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBBZGQgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBhZGRpbmcgbmV3IGNvbnRlbnQgdG8gZG9jdW1lbnRzIGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ01hbmFnZXIgfSBmcm9tICcuLi8uLi91aS9zdHJlYW1pbmctbWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RyZWFtaW5nQ2FsbGJhY2sge1xuICAgIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIEFkZENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGFkZGl0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5QWRkaXRpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgcmVzdWx0IGZvciBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gYWRkIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnQ29udGVudCBhZGRlZCBzdWNjZXNzZnVsbHknLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBhZGRpdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlBZGRpdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBkb2N1bWVudCAodHlwaWNhbGx5IGFwcGVuZCB0byBlbmQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlbGVjdGlvbiB3aXRoIG5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm8gc2VsZWN0aW9uLCBhZGQgYXQgY3Vyc29yIGluc3RlYWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgYWRkIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGFkZFxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdhZGQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgYWRkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQWRkIGluc3RydWN0aW9uIGlzIHJlcXVpcmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhZGQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJlYW1pbmcgbW9kZSwgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZCB2aWEgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIEp1c3QgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgZmluYWwgY29udGVudFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxDb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbiB8fCB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1N0cmVhbWluZyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBFZGl0IGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgbW9kaWZ5aW5nIGFuZCBpbXByb3ZpbmcgZXhpc3RpbmcgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdHJlYW1pbmdDYWxsYmFjayB9IGZyb20gJy4vYWRkLWNvbW1hbmQnO1xuXG5leHBvcnQgY2xhc3MgRWRpdENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZWRpdCBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIHN0cmVhbWluZ0NhbGxiYWNrPzogU3RyZWFtaW5nQ2FsbGJhY2spOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kLCAhIWRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBlZGl0IGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIExvZyByZXN1bHQgZm9yIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBlZGl0IGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnQ29udGVudCBlZGl0ZWQgc3VjY2Vzc2Z1bGx5JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBlZGl0IGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZWRpdGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGVudGlyZSBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIGVkaXQgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZWRpdCBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhblxuICAgICk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBlZGl0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBlZGl0XG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ2VkaXQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgZWRpdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBpbnN0cnVjdGlvbiBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoIWNvbW1hbmQuaW5zdHJ1Y3Rpb24gfHwgY29tbWFuZC5pbnN0cnVjdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0VkaXQgaW5zdHJ1Y3Rpb24gaXMgcmVxdWlyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3Igc3RyZWFtaW5nIG1vZGUsIHRoZSBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQgdmlhIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBKdXN0IHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGZpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uIHx8IHsgbGluZTogMCwgY2g6IDAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3RyZWFtaW5nIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBEZWxldGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZW1vdmluZyBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBkZWxldGlvbiByZXN1bHQgZm9yIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdDb250ZW50IGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBkZWxldGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBkZWxldGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlEZWxldGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dFxuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgbGluZSBhdCBjdXJzb3JcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5kZWxldGVDb250ZW50KCdsaW5lJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoJycpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0cmFpbGluZyBjb250ZW50IChub3QgdHlwaWNhbGx5IHVzZWQgZm9yIGRlbGV0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIC0gdXNlIGN1cnNvciBvciBzZWxlY3Rpb24gaW5zdGVhZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBkZWxldGUgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBkZWxldGUgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBkZWxldGVcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZGVsZXRlJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIGRlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBHcmFtbWFyIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgZml4aW5nIGdyYW1tYXIgYW5kIHNwZWxsaW5nIGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ0NhbGxiYWNrIH0gZnJvbSAnLi9hZGQtY29tbWFuZCc7XG5cbmV4cG9ydCBjbGFzcyBHcmFtbWFyQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGxldCBjb250ZW50OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogRWRpdFJlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1pbmdDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIG1vZGVcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV2l0aFN0cmVhbWluZyhjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdCwgc3RyZWFtaW5nQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0cmFkaXRpb25hbCBzeW5jaHJvbm91cyBtb2RlIChmYWxsYmFjaylcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZml4IGdyYW1tYXInLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBncmFtbWFyIGZpeCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUdyYW1tYXJGaXgoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgcmVzdWx0IGZvciBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZml4IGdyYW1tYXInLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnR3JhbW1hciBmaXhlZCBzdWNjZXNzZnVsbHknLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgZml4IGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUdyYW1tYXJGaXgoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGVudGlyZSBkb2N1bWVudCB3aXRoIGNvcnJlY3RlZCB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEdyYW1tYXIgY29ycmVjdGlvbiBhdCBjdXJzb3IgZG9lc24ndCBtYWtlIG11Y2ggc2Vuc2UsIFxuICAgICAgICAgICAgICAgIC8vIHN1Z2dlc3Qgc2VsZWN0aW5nIHRleHQgaW5zdGVhZFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBjb3JyZWN0IGdyYW1tYXIsIG9yIHVzZSBcImRvY3VtZW50XCIgdG8gZml4IGVudGlyZSBkb2N1bWVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEdyYW1tYXIgY29ycmVjdGlvbiBhdCBlbmQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnR3JhbW1hciBjb3JyZWN0aW9uIHJlcXVpcmVzIHNlbGVjdGluZyB0ZXh0IG9yIHNwZWNpZnlpbmcgXCJkb2N1bWVudFwiJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBncmFtbWFyIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGdyYW1tYXJcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZ3JhbW1hcicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBncmFtbWFyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBncmFtbWFyLCB3ZSBuZWVkIGVpdGhlciBzZWxlY3Rpb24gb3IgZG9jdW1lbnQgdGFyZ2V0XG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gY29ycmVjdCBncmFtbWFyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCAhPT0gJ3NlbGVjdGlvbicgJiYgY29tbWFuZC50YXJnZXQgIT09ICdkb2N1bWVudCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnR3JhbW1hciBjb3JyZWN0aW9uIHJlcXVpcmVzIHNlbGVjdGluZyB0ZXh0IG9yIHRhcmdldGluZyBlbnRpcmUgZG9jdW1lbnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3Igc3RyZWFtaW5nIG1vZGUsIHRoZSBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQgdmlhIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBKdXN0IHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGZpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uIHx8IHsgbGluZTogMCwgY2g6IDAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3RyZWFtaW5nIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBSZXdyaXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgZ2VuZXJhdGluZyBhbHRlcm5hdGl2ZSBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ0NhbGxiYWNrIH0gZnJvbSAnLi9hZGQtY29tbWFuZCc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIHJld3JpdGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSByZXdyaXRlIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmV3cml0ZShjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIExvZyByZXN1bHQgZm9yIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnQ29udGVudCByZXdyaXR0ZW4gc3VjY2Vzc2Z1bGx5JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSByZXdyaXRlIGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseVJld3JpdGUoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBlbnRpcmUgZG9jdW1lbnQgd2l0aCByZXdyaXR0ZW4gdmVyc2lvblxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBZGQgcmV3cml0dGVuIGNvbnRlbnQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAvLyBSZXdyaXRlIHNlbGVjdGVkIGNvbnRlbnRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQgZm9yIHJld3JpdGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCByZXdyaXR0ZW4gY29udGVudCBhdCBjdXJzb3JcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgcmV3cml0ZSB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIHJld3JpdGVcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAncmV3cml0ZScpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSByZXdyaXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUmV3cml0ZSBpbnN0cnVjdGlvbiBpcyByZXF1aXJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoU3RyZWFtaW5nKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBwcm9tcHQ6IGFueSxcbiAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2s6IFN0cmVhbWluZ0NhbGxiYWNrXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBjb250ZW50IHdpdGggc3RyZWFtaW5nXG4gICAgICAgICAgICBsZXQgZnVsbENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIHRoZSBzdHJlYW1pbmcgZ2VuZXJhdG9yXG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHRTdHJlYW0oXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsQ29udGVudCArPSBjaHVuay5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3J3YXJkIHRvIHRoZSBzdHJlYW1pbmcgY2FsbGJhY2sgd2hpY2ggaGFuZGxlcyBkb2N1bWVudCB1cGRhdGVzXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaWduYWwgY29tcGxldGlvblxuICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoIWZ1bGxDb250ZW50IHx8IGZ1bGxDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJlYW1pbmcgbW9kZSwgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZCB2aWEgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIEp1c3QgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgZmluYWwgY29udGVudFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxDb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24gfHwgeyBsaW5lOiAwLCBjaDogMCB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdTdHJlYW1pbmcgZmFpbGVkJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIE1ldGFkYXRhIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogSGFuZGxlcyB1cGRhdGluZyBkb2N1bWVudCBwcm9wZXJ0aWVzL2Zyb250bWF0dGVyXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogSGFuZGxlcyBtZXRhZGF0YS9wcm9wZXJ0eSB1cGRhdGUgY29tbWFuZHNcbiAqL1xuZXhwb3J0IGNsYXNzIE1ldGFkYXRhQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIG1ldGFkYXRhIHVwZGF0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgZGlyZWN0IHRhZyBvcGVyYXRpb25cbiAgICAgICAgICAgIGNvbnN0IHRhZ1Jlc3VsdCA9IGF3YWl0IHRoaXMuaGFuZGxlRGlyZWN0VGFnT3BlcmF0aW9uKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBpZiAodGFnUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhZ1Jlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0gdGhpcy5wYXJzZVByb3BlcnR5VXBkYXRlcyhhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlcyB8fCBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBtZXRhZGF0YSB1cGRhdGVzLiBBSSByZXNwb25zZTonLCBhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBwcm9wZXJ0eSB1cGRhdGVzIGZvdW5kIGluIEFJIHJlc3BvbnNlJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyB3aGF0IHdlJ3JlIHVwZGF0aW5nIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNZXRhZGF0YSB1cGRhdGVzOicsIHVwZGF0ZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IHRoaXMudXBkYXRlRnJvbnRtYXR0ZXIoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIHVwZGF0ZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBXcml0ZSB0aGUgdXBkYXRlZCBjb250ZW50IGJhY2sgdG8gdGhlIGZpbGUgZGlyZWN0bHlcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShkb2N1bWVudENvbnRleHQuZmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBzdWNjZXNzIG1lc3NhZ2UgYmFzZWQgb24gdXBkYXRlc1xuICAgICAgICAgICAgY29uc3Qgc3VjY2Vzc01lc3NhZ2UgPSB0aGlzLmdlbmVyYXRlU3VjY2Vzc01lc3NhZ2UodXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byB1cGRhdGUgbWV0YWRhdGE6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VQcm9wZXJ0eVVwZGF0ZXMocmVzcG9uc2U6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OIGZpcnN0XG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIFlBTUwtbGlrZSBmb3JtYXRcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAvLyBNYXRjaCBwYXR0ZXJucyBsaWtlIFwia2V5OiB2YWx1ZVwiIG9yIFwiLSBrZXk6IHZhbHVlXCJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL15bLVxcc10qKFteOl0rKTpcXHMqKC4rKSQvKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdmFsdWUgYXMgSlNPTiAoZm9yIGFycmF5cy9vYmplY3RzKVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBub3QgSlNPTiwgdHJlYXQgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVvdGVzIGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuc3RhcnRzV2l0aCgnXCInKSAmJiB2YWx1ZS5lbmRzV2l0aCgnXCInKSkgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlLnN0YXJ0c1dpdGgoXCInXCIpICYmIHZhbHVlLmVuZHNXaXRoKFwiJ1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID4gMCA/IHVwZGF0ZXMgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHBhcnNlIHByb3BlcnR5IHVwZGF0ZXMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyIGluIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZywgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBmcm9udG1hdHRlciBleGlzdHNcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY2xvc2luZyAtLS1cbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlbmRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvcHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZEluZGV4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9wc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgdXBkYXRlcyB3aXRoIGV4aXN0aW5nIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IHsgLi4uZXhpc3RpbmdQcm9wcywgLi4udXBkYXRlcyB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlYnVpbGQgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobWVyZ2VkUHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIG51bGwvdW5kZWZpbmVkIHZhbHVlcyAoYWxsb3dzIGRlbGV0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goJy0tLScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugb2xkIGZyb250bWF0dGVyIHdpdGggbmV3XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgLi4ubmV3RnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKGVuZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBleGlzdHMsIGNyZWF0ZSBuZXdcbiAgICAgICAgY29uc3QgbmV3RnJvbnRtYXR0ZXIgPSBbJy0tLSddO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZyb250bWF0dGVyIHRvIGJlZ2lubmluZyBvZiBkb2N1bWVudFxuICAgICAgICByZXR1cm4gbmV3RnJvbnRtYXR0ZXIuam9pbignXFxuJykgKyBjb250ZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBkaXJlY3QgdGFnIG9wZXJhdGlvbnMgKGFkZCwgcmVtb3ZlLCBzZXQgdGFncylcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZURpcmVjdFRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbjogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IFByb21pc2U8RWRpdFJlc3VsdCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUGFyc2UgdGFnIGNvbW1hbmRzIHdpdGggY29sb24gZm9ybWF0XG4gICAgICAgIGNvbnN0IGNvbG9uTWF0Y2ggPSBsb3dlckluc3RydWN0aW9uLm1hdGNoKC9eKGFkZHxzZXR8dXBkYXRlfHJlbW92ZSlcXHMrdGFncz86XFxzKiguKikkLyk7XG4gICAgICAgIGlmIChjb2xvbk1hdGNoKSB7XG4gICAgICAgICAgICBjb25zdCBhY3Rpb24gPSBjb2xvbk1hdGNoWzFdO1xuICAgICAgICAgICAgY29uc3QgdGFnU3RyaW5nID0gY29sb25NYXRjaFsyXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1RhZ3MgPSB0YWdTdHJpbmcgPyB0YWdTdHJpbmcuc3BsaXQoJywnKS5tYXAodCA9PiB0LnRyaW0oKSkuZmlsdGVyKHQgPT4gdCkgOiBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgXCJhZGQgdGFnc1wiIHdpdGggbm8gc3BlY2lmaWMgdGFncywgdHJlYXQgYXMgQUktcG93ZXJlZCBzdWdnZXN0aW9uXG4gICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnYWRkJyAmJiBuZXdUYWdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmhhbmRsZUFJVGFnT3BlcmF0aW9uKCdhZGQgc3VnZ2VzdGVkIHRhZ3MnLCBkb2N1bWVudENvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgY3VycmVudCB0YWdzXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50VGFncyA9IHRoaXMuZ2V0Q3VycmVudFRhZ3MoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgdXBkYXRlZFRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdGFncyB3aXRob3V0IGR1cGxpY2F0ZXNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnc1RvQWRkID0gbmV3VGFncy5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgIWN1cnJlbnRUYWdzLnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcudG9Mb3dlckNhc2UoKSA9PT0gdGFnLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gWy4uLmN1cnJlbnRUYWdzLCAuLi50YWdzVG9BZGRdO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gdGFnc1RvQWRkLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGBBZGRlZCAke3RhZ3NUb0FkZC5sZW5ndGh9IHRhZyR7dGFnc1RvQWRkLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfTogJHt0YWdzVG9BZGQuam9pbignLCAnKX1gXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICdObyBuZXcgdGFncyB0byBhZGQgKGR1cGxpY2F0ZXMgZmlsdGVyZWQpJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZSc6XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBzcGVjaWZpZWQgdGFnc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb3dlck5ld1RhZ3MgPSBuZXdUYWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZUNvdW50ID0gY3VycmVudFRhZ3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVGFncyA9IGN1cnJlbnRUYWdzLmZpbHRlcih0YWcgPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICAhbG93ZXJOZXdUYWdzLmluY2x1ZGVzKHRhZy50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVkQ291bnQgPSBiZWZvcmVDb3VudCAtIHVwZGF0ZWRUYWdzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IHJlbW92ZWRDb3VudCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYFJlbW92ZWQgJHtyZW1vdmVkQ291bnR9IHRhZyR7cmVtb3ZlZENvdW50ICE9PSAxID8gJ3MnIDogJyd9YFxuICAgICAgICAgICAgICAgICAgICAgICAgOiAnTm8gdGFncyBmb3VuZCB0byByZW1vdmUnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FzZSAnc2V0JzpcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGFsbCB0YWdzXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gWy4uLm5ldyBTZXQobmV3VGFncy5tYXAodCA9PiB0LnRvTG93ZXJDYXNlKCkpKV07XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgU2V0ICR7dXBkYXRlZFRhZ3MubGVuZ3RofSB0YWcke3VwZGF0ZWRUYWdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfWA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgY29udGVudFxuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHsgdGFnczogdXBkYXRlZFRhZ3MgfTtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiAwLCBjaDogMCB9LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgc3VjY2Vzc01lc3NhZ2U6IG1lc3NhZ2VcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBBSS1wb3dlcmVkIHRhZyBvcGVyYXRpb25zXG4gICAgICAgIGlmICgvXFxiKGNsZWFuIHVwfGNsZWFudXB8b3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZSlcXHMrLipcXGJ0YWdzP1xcYi9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHxcbiAgICAgICAgICAgIC9cXGIoc3VnZ2VzdHxyZWNvbW1lbmQpXFxzKy4qXFxidGFncz9cXGIvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pIHx8XG4gICAgICAgICAgICAvXmFkZCBzdWdnZXN0ZWQgdGFncyQvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pIHx8XG4gICAgICAgICAgICAvXmFkZCB0YWdzJC9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHwgIC8vIEhhbmRsZSBzaW1wbGUgXCJhZGQgdGFnc1wiIGFzIEFJIHN1Z2dlc3Rpb25cbiAgICAgICAgICAgIC9edXBkYXRlIHRhZ3MkL2kudGVzdChsb3dlckluc3RydWN0aW9uKSkgeyAgLy8gSGFuZGxlIFwidXBkYXRlIHRhZ3NcIiBhcyBBSSBvcGVyYXRpb25cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlQUlUYWdPcGVyYXRpb24oaW5zdHJ1Y3Rpb24sIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBBSS1wb3dlcmVkIHRhZyBvcGVyYXRpb25zIChzdWdnZXN0LCBvcHRpbWl6ZSwgY2xlYW4gdXApXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVBSVRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbjogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBjdXJyZW50VGFncyA9IHRoaXMuZ2V0Q3VycmVudFRhZ3MoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgQUkgcHJvbXB0IGZvciB0YWcgb3BlcmF0aW9uXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBhdCBkb2N1bWVudCB0YWdnaW5nIGFuZCBtZXRhZGF0YSBvcmdhbml6YXRpb24uIFlvdXIgdGFzayBpcyB0byBhbmFseXplIGRvY3VtZW50cyBhbmQgcHJvdmlkZSBvcHRpbWFsIHRhZ3MuXG5cblJ1bGVzIGZvciB0YWdzOlxuLSBUYWdzIHNob3VsZCBiZSBsb3dlcmNhc2Vcbi0gVXNlIGh5cGhlbnMgZm9yIG11bHRpLXdvcmQgdGFncyAoZS5nLiwgXCJtYWNoaW5lLWxlYXJuaW5nXCIpXG4tIEJlIHNwZWNpZmljIGJ1dCBub3Qgb3Zlcmx5IGdyYW51bGFyXG4tIEFpbSBmb3IgNS0xMCB0YWdzIHBlciBkb2N1bWVudFxuLSBGb2N1cyBvbiBrZXkgY29uY2VwdHMsIHRvcGljcywgYW5kIHRoZW1lcyBGUk9NIFRIRSBBQ1RVQUwgRE9DVU1FTlQgQ09OVEVOVFxuLSBUYWdzIG11c3QgYmUgZGlyZWN0bHkgcmVsZXZhbnQgdG8gdGhlIGRvY3VtZW50J3Mgc3ViamVjdCBtYXR0ZXJcbi0gQXZvaWQgZ2VuZXJpYyB0YWdzIGxpa2UgXCJkb2N1bWVudFwiIG9yIFwidGV4dFwiXG4tIENvbnNpZGVyIHRoZSBkb2N1bWVudCdzIHB1cnBvc2UsIGF1ZGllbmNlLCBhbmQgbWFpbiB0b3BpY3Ncbi0gRXh0cmFjdCB0YWdzIGJhc2VkIG9uIHRoZSBkb2N1bWVudCdzIGFjdHVhbCBjb250ZW50LCBub3QgcmFuZG9tIHRvcGljc1xuXG5JTVBPUlRBTlQ6IEJhc2UgeW91ciB0YWcgc3VnZ2VzdGlvbnMgT05MWSBvbiB0aGUgY29udGVudCBwcm92aWRlZC4gRG8gbm90IGludmVudCB1bnJlbGF0ZWQgdGFncy5cblxuUmV0dXJuIE9OTFkgYSBKU09OIG9iamVjdCB3aXRoIGEgXCJ0YWdzXCIgYXJyYXkgYW5kIGEgXCJyZWFzb25pbmdcIiBmaWVsZCBleHBsYWluaW5nIHlvdXIgY2hvaWNlcy5gO1xuXG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoL2FkZCBzdWdnZXN0ZWQvaS50ZXN0KGluc3RydWN0aW9uKSB8fCAvXmFkZCB0YWdzJC9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENhcmVmdWxseSBhbmFseXplIHRoZSBmb2xsb3dpbmcgZG9jdW1lbnQgYW5kIHN1Z2dlc3QgcmVsZXZhbnQgdGFncyBiYXNlZCBvbiBpdHMgYWN0dWFsIGNvbnRlbnQuXG5cbkN1cnJlbnQgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGggPiAwID8gY3VycmVudFRhZ3Muam9pbignLCAnKSA6ICdub25lJ31cblxuRE9DVU1FTlQgVE8gQU5BTFlaRTpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cbkJhc2VkIG9uIHRoZSBhYm92ZSBkb2N1bWVudCBjb250ZW50LCBzdWdnZXN0IGFkZGl0aW9uYWwgdGFncyB0aGF0OlxuMS4gUmVmbGVjdCB0aGUgYWN0dWFsIHRvcGljcyBkaXNjdXNzZWQgaW4gdGhlIGRvY3VtZW50XG4yLiBDYXB0dXJlIGtleSBjb25jZXB0cywgdGVjaG5vbG9naWVzLCBvciB0aGVtZXMgbWVudGlvbmVkXG4zLiBXb3VsZCBoZWxwIHdpdGggZGlzY292ZXJhYmlsaXR5IGFuZCBvcmdhbml6YXRpb25cbjQuIEFyZSBkaXJlY3RseSByZWxldmFudCB0byB3aGF0IHRoaXMgZG9jdW1lbnQgaXMgYWJvdXRcblxuRE8gTk9UIHN1Z2dlc3QgdGFncyBhYm91dCB0b3BpY3Mgbm90IG1lbnRpb25lZCBpbiB0aGUgZG9jdW1lbnQuYDtcbiAgICAgICAgfSBlbHNlIGlmICgvY2xlYW4gdXB8Y2xlYW51cC9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENsZWFuIHVwIGFuZCBvcHRpbWl6ZSB0aGUgdGFncyBmb3IgdGhpcyBkb2N1bWVudCBieSBhbmFseXppbmcgYm90aCB0aGUgY3VycmVudCB0YWdzIGFuZCB0aGUgZG9jdW1lbnQgY29udGVudC5cblxuQ3VycmVudCB0YWdzOiAke2N1cnJlbnRUYWdzLmpvaW4oJywgJyl9XG5cbkRPQ1VNRU5UIENPTlRFTlQ6XG49PT1TVEFSVCBPRiBET0NVTUVOVD09PVxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1cbj09PUVORCBPRiBET0NVTUVOVD09PVxuXG5UYXNrczpcbjEuIFJlbW92ZSBkdXBsaWNhdGUgb3IgcmVkdW5kYW50IHRhZ3NcbjIuIENvbnNvbGlkYXRlIHNpbWlsYXIgdGFncyAoZS5nLiwgXCJqc1wiIGFuZCBcImphdmFzY3JpcHRcIilcbjMuIFJlbW92ZSB0YWdzIHRoYXQgYXJlbid0IHJlbGV2YW50IHRvIHRoZSBkb2N1bWVudCBjb250ZW50XG40LiBTdGFuZGFyZGl6ZSB0YWcgZm9ybWF0IChsb3dlcmNhc2UsIGh5cGhlbmF0ZWQpXG41LiBFbnN1cmUgcmVtYWluaW5nIHRhZ3MgYWNjdXJhdGVseSByZWZsZWN0IHRoZSBkb2N1bWVudFxuXG5Qcm92aWRlIGEgY2xlYW5lZC11cCB0YWcgbGlzdCBiYXNlZCBvbiB0aGUgYWN0dWFsIGRvY3VtZW50IGNvbnRlbnQuYDtcbiAgICAgICAgfSBlbHNlIGlmICgvb3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZXx1cGRhdGUvaS50ZXN0KGluc3RydWN0aW9uKSkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBBbmFseXplIHRoaXMgZG9jdW1lbnQgdGhvcm91Z2hseSBhbmQgcHJvdmlkZSBhbiBvcHRpbWl6ZWQgc2V0IG9mIHRhZ3MgdGhhdCBhY2N1cmF0ZWx5IHJlcHJlc2VudHMgaXRzIGNvbnRlbnQuXG5cbkN1cnJlbnQgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGggPiAwID8gY3VycmVudFRhZ3Muam9pbignLCAnKSA6ICdub25lJ31cblxuRE9DVU1FTlQgVE8gQU5BTFlaRTpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cblRhc2tzOlxuMS4gUmV2aWV3IHRoZSBkb2N1bWVudCBjb250ZW50IGNhcmVmdWxseVxuMi4gUmVtb3ZlIGFueSB0YWdzIHRoYXQgYXJlbid0IHJlbGV2YW50IHRvIHRoZSBhY3R1YWwgY29udGVudFxuMy4gQWRkIHRhZ3MgZm9yIGltcG9ydGFudCBjb25jZXB0cywgdG9waWNzLCBvciB0aGVtZXMgdGhhdCBhcmUgbWlzc2luZ1xuNC4gRW5zdXJlIGFsbCB0YWdzIGRpcmVjdGx5IHJlbGF0ZSB0byB3aGF0J3MgZGlzY3Vzc2VkIGluIHRoZSBkb2N1bWVudFxuNS4gQWltIGZvciA1LTEwIGhpZ2hseSByZWxldmFudCB0YWdzXG5cblByb3ZpZGUgYW4gb3B0aW1pemVkIHRhZyBsaXN0IHRoYXQgYmVzdCByZXByZXNlbnRzIFRISVMgU1BFQ0lGSUMgZG9jdW1lbnQncyBjb250ZW50LmA7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVXNlIHVuaWZpZWQgYXBwcm9hY2ggZm9yIGFsbCBwcm92aWRlcnNcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRNYXhUb2tlbnMgPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZXREZWZhdWx0TWF4VG9rZW5zKCk7XG4gICAgICAgICAgICBjb25zdCBhaVJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IGRlZmF1bHRNYXhUb2tlbnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSBBSSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZUFJVGFnUmVzcG9uc2UoYWlSZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoIXBhcnNlZCB8fCAhcGFyc2VkLnRhZ3MgfHwgcGFyc2VkLnRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gU2hvdyB0aGUgYWN0dWFsIEFJIHJlc3BvbnNlIGluIHRoZSBlcnJvciBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlldyA9IGFpUmVzcG9uc2UubGVuZ3RoID4gMTAwIFxuICAgICAgICAgICAgICAgICAgICA/IGFpUmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJyBcbiAgICAgICAgICAgICAgICAgICAgOiBhaVJlc3BvbnNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYENvdWxkIG5vdCBwYXJzZSBBSSB0YWcgc3VnZ2VzdGlvbnMuIEFJIHJlc3BvbnNlOiBcIiR7cHJldmlld31cImAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGFnc1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHsgdGFnczogcGFyc2VkLnRhZ3MgfTtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgYXBwcm9wcmlhdGUgbWVzc2FnZVxuICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgICAgICAgICAgIGlmICgvYWRkIHN1Z2dlc3RlZC9pLnRlc3QoaW5zdHJ1Y3Rpb24pIHx8IC9eYWRkIHRhZ3MkL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhZGRlZFRhZ3MgPSBwYXJzZWQudGFncy5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgICAgICAgICAhY3VycmVudFRhZ3Muc29tZShleGlzdGluZyA9PiBleGlzdGluZy50b0xvd2VyQ2FzZSgpID09PSB0YWcudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgQWRkZWQgJHthZGRlZFRhZ3MubGVuZ3RofSBzdWdnZXN0ZWQgdGFnJHthZGRlZFRhZ3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9OiAke2FkZGVkVGFncy5qb2luKCcsICcpfWA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKC9jbGVhbiB1cHxjbGVhbnVwL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYENsZWFuZWQgdXAgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGh9IFx1MjE5MiAke3BhcnNlZC50YWdzLmxlbmd0aH0gdGFnc2A7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgT3B0aW1pemVkIHRhZ3M6ICR7cGFyc2VkLnRhZ3MubGVuZ3RofSB0YWcke3BhcnNlZC50YWdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSAod2FzICR7Y3VycmVudFRhZ3MubGVuZ3RofSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogdXBkYXRlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmU6IDAsIGNoOiAwIH0sXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZTogbWVzc2FnZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGBGYWlsZWQgdG8gcHJvY2VzcyB0YWcgb3BlcmF0aW9uOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCB0YWdzIGZyb20gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Q3VycmVudFRhZ3MoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBpZiAoIWNvbnRlbnQpIHJldHVybiBbXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobGluZXMubGVuZ3RoID4gMCAmJiBsaW5lc1swXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgIGxldCBpbkZyb250bWF0dGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoICYmIGluRnJvbnRtYXR0ZXI7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ01hdGNoID0gbGluZXNbaV0ubWF0Y2goL150YWdzOlxccyooLiopJC8pO1xuICAgICAgICAgICAgICAgIGlmICh0YWdNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdWYWx1ZSA9IHRhZ01hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFnVmFsdWUpIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSBwYXJzaW5nIGFzIEpTT04gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UodGFnVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyc2VkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZWQuZmlsdGVyKHQgPT4gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IEpTT04sIHRyeSBjb21tYS1zZXBhcmF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWdWYWx1ZS5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKS5maWx0ZXIodCA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTm8gZnJvbnRtYXR0ZXIgb3Igbm8gdGFncyBmb3VuZFxuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgQUkgcmVzcG9uc2UgZm9yIHRhZyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBwYXJzZUFJVGFnUmVzcG9uc2UocmVzcG9uc2U6IHN0cmluZyk6IHsgdGFnczogc3RyaW5nW10sIHJlYXNvbmluZz86IHN0cmluZyB9IHwgbnVsbCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDbGVhbiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuUmVzcG9uc2UgPSByZXNwb25zZS50cmltKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gZnJvbSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QganNvbk1hdGNoID0gY2xlYW5SZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkLnRhZ3MgJiYgQXJyYXkuaXNBcnJheShwYXJzZWQudGFncykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogcGFyc2VkLnRhZ3MubWFwKCh0OiBhbnkpID0+IFN0cmluZyh0KS50b0xvd2VyQ2FzZSgpLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICctJykpLmZpbHRlcigodDogc3RyaW5nKSA9PiB0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25pbmc6IHBhcnNlZC5yZWFzb25pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEpTT04gcGFyc2UgZmFpbGVkLCBjb250aW51ZSB0byBvdGhlciBmb3JtYXRzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdmFyaW91cyBsaXN0IGZvcm1hdHNcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm5zID0gW1xuICAgICAgICAgICAgICAgIC8vIEpTT04gYXJyYXk6IHRhZ3M6IFtcInRhZzFcIiwgXCJ0YWcyXCJdXG4gICAgICAgICAgICAgICAgL3RhZ3M/OlxccypcXFsoW15cXF1dKylcXF0vaSxcbiAgICAgICAgICAgICAgICAvLyBDb21tYSBsaXN0OiBUYWdzOiB0YWcxLCB0YWcyLCB0YWczXG4gICAgICAgICAgICAgICAgL3RhZ3M/OlxccyooW15cXG5dKz8pKD86XFxufCQpL2ksXG4gICAgICAgICAgICAgICAgLy8gQnVsbGV0IGxpc3Q6IC0gdGFnMVxcbi0gdGFnMlxuICAgICAgICAgICAgICAgIC8oPzp0YWdzPzopP1xccyooPzpcXG4pPyhcXHMqWy1cdTIwMjIqXVxccyouKyg/OlxcblxccypbLVx1MjAyMipdXFxzKi4rKSopL2ksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGNsZWFuUmVzcG9uc2UubWF0Y2gocGF0dGVybik7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0YWdTdHJpbmcgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgYnVsbGV0IGxpc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWdTdHJpbmcuaW5jbHVkZXMoJy0nKSB8fCB0YWdTdHJpbmcuaW5jbHVkZXMoJ1x1MjAyMicpIHx8IHRhZ1N0cmluZy5pbmNsdWRlcygnKicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzID0gdGFnU3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9cXG4vKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKGxpbmU6IHN0cmluZykgPT4gbGluZS5yZXBsYWNlKC9eXFxzKlstXHUyMDIyKl1cXHMqLywgJycpLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh0OiBzdHJpbmcpID0+IHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGNvbW1hLXNlcGFyYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFncyA9IHRhZ1N0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgodDogc3RyaW5nKSA9PiB0LnRyaW0oKS5yZXBsYWNlKC9bXCInXS9nLCAnJykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigodDogc3RyaW5nKSA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogdGFncy5tYXAodCA9PiB0LnRvTG93ZXJDYXNlKCkudHJpbSgpLnJlcGxhY2UoL1xccysvZywgJy0nKSkuZmlsdGVyKHQgPT4gdClcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExhc3QgcmVzb3J0OiBleHRyYWN0IGFueSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBhZnRlciBcInN1Z2dlc3RcIiBvciBcInJlY29tbWVuZFwiXG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0TWF0Y2ggPSBjbGVhblJlc3BvbnNlLm1hdGNoKC8oPzpzdWdnZXN0fHJlY29tbWVuZHxwcm9wb3NlfGhlcmUgYXJlfHRhZ3MgYXJlKVs6XFxzXSsoW14uXSspL2kpO1xuICAgICAgICAgICAgaWYgKHN1Z2dlc3RNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3MgPSBzdWdnZXN0TWF0Y2hbMV1cbiAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9bLFxcbl0vKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHQgPT4gdC50cmltKCkucmVwbGFjZSgvW1wiJ10vZywgJycpLnJlcGxhY2UoL15hbmRcXHMrL2ksICcnKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0ID0+IHQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiB0YWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKS50cmltKCkpLmZpbHRlcih0ID0+IHQpXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGaW5hbCBmYWxsYmFjazogdHJlYXQgZWFjaCBsaW5lIGFzIGEgdGFnIChmb3IgR29vZ2xlJ3Mgc2ltcGxlIGZvcm1hdClcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY2xlYW5SZXNwb25zZS5zcGxpdCgnXFxuJykubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihsaW5lID0+IGxpbmUpO1xuICAgICAgICAgICAgY29uc3QgdmFsaWRUYWdzID0gbGluZXNcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGxpbmVzIHRoYXQgYXJlIGNsZWFybHkgbm90IHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUubGVuZ3RoID4gMCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUubGVuZ3RoIDwgNTAgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS5pbmNsdWRlcygnOicpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0YWcnKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaGVyZScpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzdWdnZXN0Jyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cCB0aGUgbGluZSBhbmQgY29udmVydCBzcGFjZXMgdG8gaHlwaGVuc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXlstXHUyMDIyKiNdXFxzKi8sICcnKSAvLyBSZW1vdmUgYnVsbGV0IHBvaW50cyBhbmQgaGFzaHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9eXFxkK1xcLlxccyovLCAnJykgLy8gUmVtb3ZlIG51bWJlcmVkIGxpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnLScpOyAvLyBDb252ZXJ0IHNwYWNlcyB0byBoeXBoZW5zXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHRhZyA9PiB0YWcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodmFsaWRUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB0YWdzOiB2YWxpZFRhZ3MgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgd2Ugc3RpbGwgY2FuJ3QgcGFyc2UsIGxvZyB0aGUgcmVzcG9uc2UgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIEFJIHRhZyByZXNwb25zZTonLCBjbGVhblJlc3BvbnNlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBBSSB0YWcgcmVzcG9uc2U6JywgZXJyb3IsICdSZXNwb25zZSB3YXM6JywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBzdWNjZXNzIG1lc3NhZ2UgYmFzZWQgb24gdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVTdWNjZXNzTWVzc2FnZSh1cGRhdGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpO1xuICAgICAgICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHJldHVybiAnTWV0YWRhdGEgdXBkYXRlZCc7XG4gICAgICAgIFxuICAgICAgICBpZiAoa2V5cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGtleXNbMF07XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAndGFncycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb3VudCA9IEFycmF5LmlzQXJyYXkodXBkYXRlcy50YWdzKSA/IHVwZGF0ZXMudGFncy5sZW5ndGggOiAwO1xuICAgICAgICAgICAgICAgIHJldHVybiBgVXBkYXRlZCB0YWdzICgke2NvdW50fSB0YWcke2NvdW50ICE9PSAxID8gJ3MnIDogJyd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYFVwZGF0ZWQgJHtrZXl9YDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGBVcGRhdGVkICR7a2V5cy5sZW5ndGh9IHByb3BlcnRpZXNgO1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBzdXBlcm5vdmFEYXRlOiBzdHJpbmc7ICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGdlbmVyYWxEYXRlOiBzdHJpbmc7ICAgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIEZlYXR1cmUgcmVsZWFzZSBjb25maWd1cmF0aW9uIGZvciBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIG1vZGVsXG4gKiBTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gc3VwZXJub3ZhRGF0ZVxuICogQWxsIHVzZXJzIGdldCBmZWF0dXJlcyBvbiBnZW5lcmFsRGF0ZVxuICogXG4gKiBEYXRlcyBhcmUgaW4gWVlZWS1NTS1ERCBmb3JtYXQgYW5kIGVhc3kgdG8gbW9kaWZ5IHBvc3QtbGF1bmNoXG4gKi9cbmV4cG9ydCBjb25zdCBTVVBFUk5PVkFfRkVBVFVSRVM6IFJlY29yZDxzdHJpbmcsIFRpbWVHYXRlZEZlYXR1cmU+ID0ge1xuICAgIC8vIENvbW1hbmRzICh1bmlmaWVkKSAtIDIgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmRzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNy0zMScsICAvLyBTdXBlcm5vdmEgZWFybHkgYWNjZXNzXG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOS0zMCcsICAgLy8gR2VuZXJhbCBhdmFpbGFiaWxpdHkgXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29tbWFuZCBzeXN0ZW0gd2l0aCA6IHRyaWdnZXJzLCBjb21tYW5kIGJ1dHRvbiwgYW5kIGN1c3RvbSBjb21tYW5kcydcbiAgICB9LFxuICAgIFxuICAgIC8vIEF1dG8tZ3Jvd2luZyBpbnB1dCAtIDEgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2F1dG8taW5wdXQnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA3LTE1JywgICAvLyAxIG1vbnRoIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0by1ncm93aW5nIGlucHV0IGFyZWEgd2l0aCBzbW9vdGggdHJhbnNpdGlvbnMnXG4gICAgfSxcbiAgICBcbiAgICAvLyBFbmhhbmNlZCBwcm92aWRlciBtYW5hZ2VtZW50IC0gMiBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnZW5oYW5jZWQtcHJvdmlkZXJzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOC0xNScsICAgLy8gMiBtb250aHMgbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZHZhbmNlZCBwcm92aWRlciBjb25maWd1cmF0aW9uIGFuZCBzd2l0Y2hpbmcnXG4gICAgfVxufTtcblxuLyoqXG4gKiBDb3JlIGZlYXR1cmVzIHRoYXQgYXJlIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG4gKiBUaGVzZSBhcmUgTk9UIHRpbWUtZ2F0ZWRcbiAqL1xuZXhwb3J0IGNvbnN0IENPUkVfRkVBVFVSRVMgPSBbXG4gICAgJ2Jhc2ljX2VkaXRpbmcnLCAgICAgICAgICAvLyBBZGQsIGVkaXQsIGRlbGV0ZSwgZ3JhbW1hciwgcmV3cml0ZSBjb21tYW5kc1xuICAgICdhbGxfYWlfcHJvdmlkZXJzJywgICAgICAgLy8gQ2xhdWRlLCBPcGVuQUksIEdvb2dsZSwgT2xsYW1hXG4gICAgJ2ZpbGVfY29udmVyc2F0aW9ucycsICAgICAvLyBGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICdwcm92aWRlcl9zd2l0Y2hpbmcnLCAgICAgLy8gU3dpdGNoIHByb3ZpZGVycyBpbiBjaGF0XG4gICAgJ21vYmlsZV9hY2Nlc3MnLCAgICAgICAgICAvLyBGdWxsIG1vYmlsZSBzdXBwb3J0XG4gICAgJ2FwaV9rZXlfY29uZmlnJywgICAgICAgICAvLyBDb25maWd1cmUgb3duIEFQSSBrZXlzXG4gICAgJ3NpZGViYXJfY2hhdCcsICAgICAgICAgICAvLyBDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyXG4gICAgJ2RvY3VtZW50X2NvbnRleHQnLCAgICAgICAvLyBDdXJyZW50IGRvY3VtZW50IGNvbnRleHRcbiAgICAnbXVsdGktZG9jLWNvbnRleHQnICAgICAgIC8vIFJlZmVyZW5jZSBvdGhlciBkb2N1bWVudHMgd2l0aCBbW2RvY11dIHN5bnRheFxuXTsiLCAiaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgU3VwZXJub3ZhTGljZW5zZSwgRmVhdHVyZUZsYWcsIEZlYXR1cmVBY2Nlc3NSZXN1bHQsIERlYnVnU2V0dGluZ3MsIFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IFNVUEVSTk9WQV9GRUFUVVJFUywgQ09SRV9GRUFUVVJFUywgVGltZUdhdGVkRmVhdHVyZSB9IGZyb20gJy4vZmVhdHVyZS1jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgRmVhdHVyZU1hbmFnZXIge1xuXHRwcml2YXRlIGZlYXR1cmVzOiBNYXA8c3RyaW5nLCBGZWF0dXJlRmxhZz4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc3VwZXJub3ZhTGljZW5zZTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzU3VwZXJub3ZhOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIGxpY2Vuc2VWYWxpZGF0b3I6IExpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0ZGVidWdTZXR0aW5ncz86IERlYnVnU2V0dGluZ3Ncblx0KSB7XG5cdFx0aWYgKGRlYnVnU2V0dGluZ3MpIHtcblx0XHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IGRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemUgYWxsIGZlYXR1cmUgZmxhZ3Ncblx0ICogQ29yZSBmZWF0dXJlcyBhcmUgYWx3YXlzIGVuYWJsZWRcblx0ICogVGltZS1nYXRlZCBmZWF0dXJlcyBkZXBlbmQgb24gY3VycmVudCBkYXRlIGFuZCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRwcml2YXRlIGluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTogdm9pZCB7XG5cdFx0Ly8gQ29yZSBmZWF0dXJlcyAtIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG5cdFx0Q09SRV9GRUFUVVJFUy5mb3JFYWNoKGZlYXR1cmVLZXkgPT4ge1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXk6IGZlYXR1cmVLZXksXG5cdFx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiB0aGlzLmdldENvcmVGZWF0dXJlRGVzY3JpcHRpb24oZmVhdHVyZUtleSlcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gVGltZS1nYXRlZCBmZWF0dXJlcyAtIGF2YWlsYWJsZSBiYXNlZCBvbiBkYXRlXG5cdFx0T2JqZWN0LmVudHJpZXMoU1VQRVJOT1ZBX0ZFQVRVUkVTKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XG5cdFx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5pc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGtleSwgY29uZmlnKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5LFxuXHRcdFx0XHRlbmFibGVkLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuXHRcdFx0XHRpc1RpbWVHYXRlZDogdHJ1ZSxcblx0XHRcdFx0ZWFybHlBY2Nlc3NPbmx5OiAhdGhpcy5pc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWcpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVzY3JpcHRpb24gZm9yIGNvcmUgZmVhdHVyZXNcblx0ICovXG5cdHByaXZhdGUgZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihrZXk6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgZGVzY3JpcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2Jhc2ljX2VkaXRpbmcnOiAnQmFzaWMgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kcyAoYWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUpJyxcblx0XHRcdCdhbGxfYWlfcHJvdmlkZXJzJzogJ0FjY2VzcyB0byBhbGwgQUkgcHJvdmlkZXJzIChDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWEpJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnOiAnRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZyc6ICdTd2l0Y2ggQUkgcHJvdmlkZXJzIGRpcmVjdGx5IGluIGNoYXQgaW50ZXJmYWNlJyxcblx0XHRcdCdtb2JpbGVfYWNjZXNzJzogJ0Z1bGwgbW9iaWxlIGRldmljZSBzdXBwb3J0Jyxcblx0XHRcdCdhcGlfa2V5X2NvbmZpZyc6ICdDb25maWd1cmUgeW91ciBvd24gQVBJIGtleXMnLFxuXHRcdFx0J3NpZGViYXJfY2hhdCc6ICdDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyJyxcblx0XHRcdCdkb2N1bWVudF9jb250ZXh0JzogJ0N1cnJlbnQgZG9jdW1lbnQgY29udGV4dCBpbiBjb252ZXJzYXRpb25zJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGRlc2NyaXB0aW9uc1trZXldIHx8IGtleTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIHRpbWUtZ2F0ZWQgZmVhdHVyZSBzaG91bGQgYmUgZW5hYmxlZFxuXHQgKi9cblx0cHJpdmF0ZSBpc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZywgY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IHN1cGVybm92YURhdGUgPSBuZXcgRGF0ZShjb25maWcuc3VwZXJub3ZhRGF0ZSk7XG5cdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gZXZlcnlvbmUgYWZ0ZXIgZ2VuZXJhbCBkYXRlXG5cdFx0aWYgKG5vdyA+PSBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgYWZ0ZXIgc3VwZXJub3ZhIGRhdGVcblx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA+PSBzdXBlcm5vdmFEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBTdXBlcm5vdmEgc3RhdHVzIChjYW4gYmUgb3ZlcnJpZGRlbiBpbiBkZWJ1ZyBtb2RlKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRJc1N1cGVybm92YSgpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgJiYgdGhpcy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmlzU3VwZXJub3ZhO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGEgbmV3IGZlYXR1cmUgZmxhZ1xuXHQgKi9cblx0cmVnaXN0ZXJGZWF0dXJlKGZsYWc6IEZlYXR1cmVGbGFnKTogdm9pZCB7XG5cdFx0dGhpcy5mZWF0dXJlcy5zZXQoZmxhZy5rZXksIGZsYWcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBhbmQgcmVjYWxjdWxhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0ICovXG5cdGFzeW5jIHVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghbGljZW5zZUtleSkge1xuXHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gbnVsbDtcblx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMubGljZW5zZVZhbGlkYXRvci52YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbi52YWxpZCAmJiB2YWxpZGF0aW9uLmxpY2Vuc2UpIHtcblx0XHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gdmFsaWRhdGlvbi5saWNlbnNlO1xuXHRcdFx0XHR0aGlzLmlzU3VwZXJub3ZhID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuc3VwZXJub3ZhTGljZW5zZSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCB1cGRhdGVkIFN1cGVybm92YSBzdGF0dXNcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRpc1N1cGVybm92YVN1cHBvcnRlcigpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRJc1N1cGVybm92YSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IFN1cGVybm92YSBsaWNlbnNlXG5cdCAqL1xuXHRnZXRTdXBlcm5vdmFMaWNlbnNlKCk6IFN1cGVybm92YUxpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5zdXBlcm5vdmFMaWNlbnNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgZmVhdHVyZSBpcyBlbmFibGVkXG5cdCAqL1xuXHRpc0ZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdC8vIEhhbmRsZSBvbGQgZmVhdHVyZSBrZXlzIHRoYXQgbWlnaHQgc3RpbGwgYmUgcmVmZXJlbmNlZFxuXHRcdGlmICh0aGlzLmlzTGVnYWN5RmVhdHVyZUtleShmZWF0dXJlS2V5KSkge1xuXHRcdFx0cmV0dXJuIHRydWU7IC8vIEFsbCBsZWdhY3kgZmVhdHVyZXMgYXJlIG5vdyBlbmFibGVkIGZvciBldmVyeW9uZVxuXHRcdH1cblxuXHRcdGNvbnN0IGZlYXR1cmUgPSB0aGlzLmZlYXR1cmVzLmdldChmZWF0dXJlS2V5KTtcblx0XHRyZXR1cm4gZmVhdHVyZT8uZW5hYmxlZCA/PyBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiB0aGlzIGlzIGEgbGVnYWN5IGZlYXR1cmUga2V5IHRoYXQgc2hvdWxkIGFsd2F5cyBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzTGVnYWN5RmVhdHVyZUtleShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGxlZ2FjeUtleXMgPSBbXG5cdFx0XHQnYmFzaWNfZWRpdGluZycsXG5cdFx0XHQnbG9jYWxfYWlfcHJvdmlkZXJzJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnLFxuXHRcdFx0J3NpbmdsZV9jbG91ZF9wcm92aWRlcicsXG5cdFx0XHQndW5saW1pdGVkX2Nsb3VkX2FpJyxcblx0XHRcdCdwcm92aWRlcl9zd2l0Y2hpbmcnLFxuXHRcdFx0J21vYmlsZV9hY2Nlc3MnLFxuXHRcdFx0J2FkdmFuY2VkX3RlbXBsYXRlcycsXG5cdFx0XHQnYmF0Y2hfb3BlcmF0aW9ucycsXG5cdFx0XHQnY3Jvc3NfZG9jdW1lbnRfY29udGV4dCcsXG5cdFx0XHQncHJpb3JpdHlfc3VwcG9ydCdcblx0XHRdO1xuXHRcdHJldHVybiBsZWdhY3lLZXlzLmluY2x1ZGVzKGtleSk7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgZmVhdHVyZSBhY2Nlc3Mgd2l0aCBkZXRhaWxlZCByZXN1bHRcblx0ICovXG5cdGNoZWNrRmVhdHVyZUFjY2VzcyhmZWF0dXJlS2V5OiBzdHJpbmcpOiBGZWF0dXJlQWNjZXNzUmVzdWx0IHtcblx0XHQvLyBIYW5kbGUgbGVnYWN5IGZlYXR1cmVzXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdFxuXHRcdGlmICghZmVhdHVyZSkge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLCBcblx0XHRcdFx0cmVhc29uOiBgRmVhdHVyZSAnJHtmZWF0dXJlS2V5fScgbm90IGZvdW5kYCBcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0cmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xuXHRcdH1cblxuXHRcdC8vIEZvciB0aW1lLWdhdGVkIGZlYXR1cmVzLCBwcm92aWRlIG1vcmUgaW5mb3JtYXRpb25cblx0XHRpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2ZlYXR1cmVLZXldO1xuXHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0XHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRcdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblxuXHRcdFx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IHN1cGVybm92YURhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgd2lsbCBiZSBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgb24gJHtjb25maWcuc3VwZXJub3ZhRGF0ZX1gLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmFGZWF0dXJlOiB0cnVlLFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogc3VwZXJub3ZhRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIXRoaXMuZ2V0SXNTdXBlcm5vdmEoKSAmJiBub3cgPCBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gSXQgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uICR7Y29uZmlnLmdlbmVyYWxEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBnZW5lcmFsRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRyZWFzb246ICdGZWF0dXJlIGlzIG5vdCBhdmFpbGFibGUnXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYWxsIGVuYWJsZWQgZmVhdHVyZXNcblx0ICovXG5cdGdldEVuYWJsZWRGZWF0dXJlcygpOiBGZWF0dXJlRmxhZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmZlYXR1cmVzLnZhbHVlcygpKS5maWx0ZXIoZmVhdHVyZSA9PiBmZWF0dXJlLmVuYWJsZWQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgU3VwZXJub3ZhIGVhcmx5IGFjY2VzcyBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0U3VwZXJub3ZhRmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHRmZWF0dXJlLmlzVGltZUdhdGVkICYmIGZlYXR1cmUuZWFybHlBY2Nlc3NPbmx5XG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IHRlc3Rpbmdcblx0ICovXG5cdHVwZGF0ZURlYnVnU2V0dGluZ3Moc2V0dGluZ3M6IERlYnVnU2V0dGluZ3MpOiB2b2lkIHtcblx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCBuZXcgZGVidWcgc2V0dGluZ3Ncblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeVxuXHQgKi9cblx0Z2V0RmVhdHVyZVN1bW1hcnkoKTogeyBcblx0XHRpc1N1cGVybm92YTogYm9vbGVhbjsgXG5cdFx0ZW5hYmxlZDogc3RyaW5nW107IFxuXHRcdGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+IFxuXHR9IHtcblx0XHRjb25zdCBlbmFibGVkOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+ID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZlYXR1cmUuaXNUaW1lR2F0ZWQpIHtcblx0XHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2tleV07XG5cdFx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YVVzZXIgPSB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cdFx0XHRcdFx0Y29taW5nU29vbi5wdXNoKHtcblx0XHRcdFx0XHRcdGtleSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGlzU3VwZXJub3ZhVXNlciA/IGNvbmZpZy5zdXBlcm5vdmFEYXRlIDogY29uZmlnLmdlbmVyYWxEYXRlLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmE6IGlzU3VwZXJub3ZhVXNlclxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHsgXG5cdFx0XHRpc1N1cGVybm92YTogdGhpcy5nZXRJc1N1cGVybm92YSgpLCBcblx0XHRcdGVuYWJsZWQsIFxuXHRcdFx0Y29taW5nU29vbiBcblx0XHR9O1xuXHR9XG59IiwgImltcG9ydCB7IExpY2Vuc2UsIFN1cGVybm92YUxpY2Vuc2UsIExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0LCBTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0LCBMaWNlbnNlRXJyb3IgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIExpY2Vuc2VWYWxpZGF0b3Ige1xuXHQvLyBFbWJlZGRlZCBzaWduaW5nIGtleSAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSBvYmZ1c2NhdGVkXG5cdHByaXZhdGUgcmVhZG9ubHkgU0VDUkVUX0tFWSA9ICdub3ZhLWxpY2Vuc2Utc2lnbmluZy1rZXktMjAyNSc7XG5cdFxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBrZXkgYW5kIHJldHVybnMgdmFsaWRhdGlvbiByZXN1bHRcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgbGljZW5zZSBrZXkgc3RyaW5nIGludG8gYSBMaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBMaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0aWVyfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0aWVyLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFNraXAgdGllciB2YWxpZGF0aW9uIHNpbmNlIHdlJ3JlIHJlbW92aW5nIHRpZXJzXG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBkZWNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RGVjb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYXRvYihzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGVuY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjRFbmNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBidG9hKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IExpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0J2xlZ2FjeScsIC8vIFVzZSBsZWdhY3kgZm9yIG9sZCBsaWNlbnNlc1xuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlIChwcmV2ZW50IGZ1dHVyZS1kYXRlZCBsaWNlbnNlcylcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIGxpY2Vuc2UgZGF0YVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHRpZXI6IHN0cmluZyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50IHB1cnBvc2VzXG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0TGljZW5zZShlbWFpbDogc3RyaW5nLCB0aWVyOiBzdHJpbmcsIGxpZmV0aW1lTW9kZSA9IHRydWUpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSBsaWZldGltZU1vZGUgPyBudWxsIDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyAxIHllYXJcblxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoZW1haWwsIHRpZXIsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nKTogUHJvbWlzZTxTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlU3VwZXJub3ZhTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IHN0cmluZ1xuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZVN1cGVybm92YUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgZm9ybWF0OiBiYXNlNjQoZW1haWx8dHlwZXxleHBpcmVzQXR8aXNzdWVkQXR8c2lnbmF0dXJlKVxuXHRcdFx0Y29uc3QgZGVjb2RlZCA9IHRoaXMuYmFzZTY0RGVjb2RlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBkZWNvZGVkLnNwbGl0KCd8Jyk7XG5cdFx0XHRcblx0XHRcdGlmIChwYXJ0cy5sZW5ndGggIT09IDUpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IFtlbWFpbCwgdHlwZSwgZXhwaXJlc0F0U3RyLCBpc3N1ZWRBdFN0ciwgc2lnbmF0dXJlXSA9IHBhcnRzO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSB0eXBlXG5cdFx0XHRpZiAodHlwZSAhPT0gJ2FubnVhbCcgJiYgdHlwZSAhPT0gJ2xpZmV0aW1lJykge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdHR5cGU6IHR5cGUgYXMgJ2FubnVhbCcgfCAnbGlmZXRpbWUnLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IFN1cGVybm92YUxpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdXBlcm5vdmFTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50eXBlLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBTdXBlcm5vdmEgbGljZW5zZVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHR5cGU6ICdhbm51YWwnIHwgJ2xpZmV0aW1lJyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3R5cGV9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IFN1cGVybm92YSBsaWNlbnNlIGZvciBkZXZlbG9wbWVudFxuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdFN1cGVybm92YUxpY2Vuc2UoZW1haWw6IHN0cmluZywgdHlwZTogJ2FubnVhbCcgfCAnbGlmZXRpbWUnKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gdHlwZSA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDEgeWVhclxuXG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShlbWFpbCwgdHlwZSwgZXhwaXJlc0F0LCBpc3N1ZWRBdCk7XG5cdFx0XG5cdFx0Y29uc3QgbGljZW5zZURhdGEgPSBgJHtlbWFpbH18JHt0eXBlfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9fCR7c2lnbmF0dXJlfWA7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmFzZTY0RW5jb2RlKGxpY2Vuc2VEYXRhKTtcblx0fVxufSIsICIvKipcbiAqIEFJIEludGVudCBDbGFzc2lmaWVyIGZvciBOb3ZhXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdXNlciBpbnB1dCBpcyBhIGNoYXQsIG1ldGFkYXRhIGNvbW1hbmQsIG9yIGNvbnRlbnQgY29tbWFuZFxuICovXG5cbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5cbmV4cG9ydCB0eXBlIFVzZXJJbnRlbnQgPSAnQ0hBVCcgfCAnTUVUQURBVEEnIHwgJ0NPTlRFTlQnO1xuXG5leHBvcnQgY2xhc3MgQUlJbnRlbnRDbGFzc2lmaWVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogQ2xhc3NpZnkgdXNlciBpbnB1dCBpbnRvIG9uZSBvZiB0aHJlZSBpbnRlbnRzXG4gICAgICovXG4gICAgYXN5bmMgY2xhc3NpZnlJbnRlbnQodXNlcklucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxVc2VySW50ZW50PiB7XG4gICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIHN5bnRheCBmaXJzdFxuICAgICAgICBpZiAodXNlcklucHV0LnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgLy8gQ29sb24gY29tbWFuZHMgYXJlIHR5cGljYWxseSBwcm92aWRlciBzd2l0Y2hlcyBvciBjdXN0b20gY29tbWFuZHNcbiAgICAgICAgICAgIHJldHVybiAnQ0hBVCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbHdheXMgdXNlIGZhbGxiYWNrIGZvciBub3cgLSBBSSBjbGFzc2lmaWNhdGlvbiBpcyBjYXVzaW5nIGlzc3Vlc1xuICAgICAgICAvLyBXZSBjYW4gcmUtZW5hYmxlIHRoaXMgb25jZSB3ZSBoYXZlIGEgbW9yZSByZWxpYWJsZSBhcHByb2FjaFxuICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvKiBEaXNhYmxlZCBBSSBjbGFzc2lmaWNhdGlvbiBkdWUgdG8gcHJvdmlkZXIgY29tcGF0aWJpbGl0eSBpc3N1ZXNcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNpbXBsaWZpZWQgcHJvbXB0IGZvciBiZXR0ZXIgY29tcGF0aWJpbGl0eVxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYENsYXNzaWZ5IHRoaXMgdGV4dCBhcyBDSEFULCBNRVRBREFUQSwgb3IgQ09OVEVOVDpcblwiJHt1c2VySW5wdXR9XCJcblxuQ0hBVCA9IHF1ZXN0aW9ucy9kaXNjdXNzaW9uXG5NRVRBREFUQSA9IHRhZ3MvcHJvcGVydGllcy9mcm9udG1hdHRlclxuQ09OVEVOVCA9IGVkaXQgZG9jdW1lbnQgdGV4dFxuXG5BbnN3ZXIgd2l0aCBvbmUgd29yZCBvbmx5OmA7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoJycsIHByb21wdCwge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAxMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gcmVzcG9uc2UudHJpbSgpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHJlc3BvbnNlXG4gICAgICAgICAgICBpZiAoY2xhc3NpZmljYXRpb24gPT09ICdDSEFUJyB8fCBjbGFzc2lmaWNhdGlvbiA9PT0gJ01FVEFEQVRBJyB8fCBjbGFzc2lmaWNhdGlvbiA9PT0gJ0NPTlRFTlQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzaWZpY2F0aW9uIGFzIFVzZXJJbnRlbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIGhldXJpc3RpYyBpZiBBSSBnaXZlcyB1bmV4cGVjdGVkIHJlc3BvbnNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBSSBpbnRlbnQgY2xhc3NpZmljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgICAgIC8vIFVzZSBmYWxsYmFjayBoZXVyaXN0aWNcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0KTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNpbXBsZSBoZXVyaXN0aWMgZmFsbGJhY2sgZm9yIHdoZW4gQUkgY2xhc3NpZmljYXRpb24gZmFpbHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0OiBzdHJpbmcpOiBVc2VySW50ZW50IHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnB1dCA9IHVzZXJJbnB1dC50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgcXVlc3Rpb24gaW5kaWNhdG9ycyBGSVJTVFxuICAgICAgICBpZiAobG93ZXJJbnB1dC5pbmNsdWRlcygnPycpIHx8IFxuICAgICAgICAgICAgbG93ZXJJbnB1dC5zdGFydHNXaXRoKCd3aGF0JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2h5JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnaG93JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hlbicpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ3doZXJlJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hvJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnY2FuIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ2NvdWxkIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LmluY2x1ZGVzKCdleHBsYWluJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuaW5jbHVkZXMoJ2hlbHAgbWUgdW5kZXJzdGFuZCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0NIQVQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIG1ldGFkYXRhIGtleXdvcmRzIC0gYmUgbW9yZSBzcGVjaWZpY1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAvLyBUYWctc3BlY2lmaWMgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGJ0YWdzP1xcYi9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC9cXGJ0YWdnaW5nXFxiL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgLy8gUHJvcGVydHkgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIodGl0bGV8YXV0aG9yfGRhdGV8c3RhdHVzfGNhdGVnb3J5fGNhdGVnb3JpZXMpXFxiL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgLy8gTWV0YWRhdGEvZnJvbnRtYXR0ZXIgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIobWV0YWRhdGF8ZnJvbnRtYXR0ZXJ8cHJvcGVydGllc3xwcm9wZXJ0eSlcXGIvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBDb21tb24gbWV0YWRhdGEgYWN0aW9uc1xuICAgICAgICAgICAgL14oYWRkfHVwZGF0ZXxzZXR8cmVtb3ZlfGNsZWFufG9wdGltaXplKVxccysodGFncz98dGl0bGV8YXV0aG9yfG1ldGFkYXRhKS9pLnRlc3QobG93ZXJJbnB1dClcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gJ01FVEFEQVRBJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbW1vbiBjb250ZW50IGVkaXRpbmcgcGF0dGVybnNcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgL14oYWRkfHdyaXRlfGNyZWF0ZXxpbnNlcnQpXFxzKyhhXFxzKyk/KHNlY3Rpb258cGFyYWdyYXBofGNvbmNsdXNpb258aW50cm9kdWN0aW9ufHN1bW1hcnkpL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgL14oZml4fGNvcnJlY3R8aW1wcm92ZSlcXHMrKGdyYW1tYXJ8c3BlbGxpbmd8d3JpdGluZykvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvXihtYWtlfHJld3JpdGV8ZWRpdHxtb2RpZnl8Y2hhbmdlKS9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC9eKGRlbGV0ZXxyZW1vdmUpXFxzKyh0aGVcXHMrKT8oc2VjdGlvbnxwYXJhZ3JhcGh8c2VudGVuY2UpL2kudGVzdChsb3dlcklucHV0KVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiAnQ09OVEVOVCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IHRvIGNvbnRlbnQgZWRpdGluZyBmb3Igb3RoZXIgY29tbWFuZHNcbiAgICAgICAgcmV0dXJuICdDT05URU5UJztcbiAgICB9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Q0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFdBQVc7QUFBQSxJQUNQO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsUUFBUTtBQUFBLElBQ0o7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxVQUFVO0FBQUEsSUFDTjtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFFBQVE7QUFBQSxJQUNKO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsT0FBTztBQUFBLElBQ0g7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxRQUFRO0FBQUEsSUFDSjtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFdBQVc7QUFBQSxJQUNQO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FB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QUFNLE9BQU87QUFBQSxJQUNkO0FBRUEsZUFBVyxpQkFBaUIsU0FBUyxNQUFNO0FBQzFDLGFBQU8sS0FBSyxpQ0FBaUMsUUFBUTtBQUNyRCxpQkFBVztBQUFBLElBQ1osQ0FBQztBQUVELGFBQVMsaUJBQWlCLFNBQVMsVUFBVTtBQUM3QyxZQUFRLGlCQUFpQixTQUFTLFVBQVU7QUFFNUMsYUFBUyxLQUFLLFlBQVksS0FBSztBQUcvQixRQUFJLHlCQUFPLGlEQUFpRCxHQUFJO0FBQUEsRUFDakU7QUFBQTtBQUFBLEVBR0EsTUFBTSxnQkFBZ0IsS0FBMkI7QUFDaEQsVUFBTSxVQUFVLE1BQU0sS0FBSyxTQUFTO0FBQ3BDLFdBQU8sVUFBVSxRQUFRLEdBQUcsSUFBSTtBQUFBLEVBQ2pDO0FBQUEsRUFFQSxNQUFNLGdCQUFnQixLQUFhLE1BQTBCO0FBQzVELFVBQU0sVUFBVSxNQUFNLEtBQUssU0FBUyxLQUFLLENBQUM7QUFDMUMsWUFBUSxHQUFHLElBQUk7QUFDZixXQUFPLE1BQU0sS0FBSyxTQUFTLE9BQU87QUFBQSxFQUNuQztBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJleGlzdGluZyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicHJvbXB0IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAicHJvbXB0IiwgInNlbmRCdXR0b24iLCAiX2EiLCAiaXNTdXBlcm5vdmEiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgImltcG9ydF9vYnNpZGlhbiIsICJ2aWV3IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAibmV3RnJvbnRtYXR0ZXIiLCAiTk9WQV9JQ09OX1NWRyJdCn0K
