/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian10 = require("obsidian");

// src/settings.ts
var import_obsidian6 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian5 = require("obsidian");

// src/core/multi-doc-context.ts
var import_obsidian = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
      if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
        return false;
      }
      return true;
    });
    if (allPersistentDocs.length !== rawPersistentDocs.length) {
      if (allPersistentDocs.length > 0) {
        this.persistentContext.set(currentFile.path, allPersistentDocs);
      } else {
        this.persistentContext.delete(currentFile.path);
      }
    }
    const contextParts = [];
    const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
    if (currentFileContext) {
      contextParts.push(currentFileContext);
    }
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ai/models.ts
function getAvailableModels(providerType, settings) {
  var _a, _b;
  switch (providerType) {
    case "claude":
      return [
        { value: "claude-opus-4-20250514", label: "Claude Opus 4" },
        { value: "claude-sonnet-4-20250514", label: "Claude Sonnet 4" },
        { value: "claude-3-7-sonnet-latest", label: "Claude 3.7 Sonnet" },
        { value: "claude-3-5-sonnet-latest", label: "Claude 3.5 Sonnet" },
        { value: "claude-3-5-sonnet-20241022", label: "Claude 3.5 Sonnet (Oct 22)" },
        { value: "claude-3-5-haiku-latest", label: "Claude 3.5 Haiku" }
      ];
    case "openai":
      return [
        { value: "gpt-4.1-2025-04-14", label: "GPT-4.1" },
        { value: "gpt-4.1-mini-2025-04-14", label: "GPT-4.1 Mini" },
        { value: "gpt-4.1-nano-2025-04-14", label: "GPT-4.1 Nano" },
        { value: "gpt-4o", label: "GPT-4o" },
        { value: "gpt-4o-mini", label: "GPT-4o Mini" }
      ];
    case "google":
      return [
        { value: "gemini-2.5-flash-preview-04-17", label: "Gemini 2.5 Flash" },
        { value: "gemini-2.5-pro-preview-03-25", label: "Gemini 2.5 Pro" },
        { value: "gemini-2.0-flash", label: "Gemini 2.0 Flash" },
        { value: "gemini-2.0-flash-lite", label: "Gemini 2.0 Flash-Lite" }
      ];
    case "ollama":
      const ollamaModel = (_b = (_a = settings == null ? void 0 : settings.aiProviders) == null ? void 0 : _a.ollama) == null ? void 0 : _b.model;
      if (ollamaModel && ollamaModel.trim()) {
        return [{ value: ollamaModel, label: ollamaModel }];
      }
      return [];
    default:
      return [];
  }
}

// src/ui/input-handler.ts
var import_obsidian2 = require("obsidian");

// src/ui/wikilink-suggest.ts
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea, container) {
    this.suggestionPopup = null;
    this.suggestions = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.currentQuery = "";
    this.currentTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.container = container || textArea.parentElement;
    this.setupEventListeners();
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
    this.textArea.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textArea.addEventListener("blur", () => {
      setTimeout(() => this.hideSuggestions(), 150);
    });
    document.addEventListener("click", (e) => {
      if (this.suggestionPopup && !this.suggestionPopup.contains(e.target) && e.target !== this.textArea) {
        this.hideSuggestions();
      }
    });
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (linkMatch) {
      this.currentQuery = linkMatch[2] || "";
      this.currentTriggerPos = cursorPos - linkMatch[0].length;
      this.showSuggestions();
    } else {
      this.hideSuggestions();
    }
  }
  handleKeydown(e) {
    if (!this.isVisible) return;
    switch (e.key) {
      case "ArrowDown":
        e.preventDefault();
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);
        this.updateSelection();
        break;
      case "ArrowUp":
        e.preventDefault();
        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
        this.updateSelection();
        break;
      case "Enter":
      case "Tab":
        if (this.selectedIndex >= 0) {
          e.preventDefault();
          this.selectSuggestion(this.suggestions[this.selectedIndex]);
        }
        break;
      case "Escape":
        e.preventDefault();
        this.hideSuggestions();
        break;
    }
  }
  showSuggestions() {
    this.suggestions = this.getSuggestions(this.currentQuery);
    if (this.suggestions.length === 0) {
      this.hideSuggestions();
      return;
    }
    if (!this.suggestionPopup) {
      this.createSuggestionPopup();
    }
    this.renderSuggestions();
    this.positionPopup();
    this.isVisible = true;
    this.selectedIndex = -1;
  }
  hideSuggestions() {
    if (this.suggestionPopup) {
      this.suggestionPopup.style.display = "none";
    }
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  createSuggestionPopup() {
    this.suggestionPopup = document.createElement("div");
    this.suggestionPopup.className = "nova-wikilink-suggestions";
    this.suggestionPopup.style.cssText = `
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-bottom: 4px;
        `;
    this.container.appendChild(this.suggestionPopup);
  }
  renderSuggestions() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.innerHTML = "";
    this.suggestions.forEach((suggestion, index) => {
      const item = document.createElement("div");
      item.className = "nova-suggestion-item";
      item.style.cssText = `
                padding: 8px 12px;
                cursor: pointer;
                border-bottom: 1px solid var(--background-modifier-border-hover);
                transition: background-color 0.2s;
            `;
      const nameEl = document.createElement("div");
      nameEl.className = "nova-suggestion-name";
      nameEl.textContent = suggestion.file.basename;
      nameEl.style.cssText = `
                font-weight: 500;
                color: var(--text-normal);
                margin-bottom: 4px;
            `;
      item.appendChild(nameEl);
      const descEl = document.createElement("div");
      descEl.className = "nova-suggestion-desc";
      descEl.textContent = `Link to document in ${suggestion.file.path.includes("/") ? suggestion.file.path.substring(0, suggestion.file.path.lastIndexOf("/")) : "root"}`;
      descEl.style.cssText = `
                font-size: 0.85em;
                color: var(--text-muted);
                margin-bottom: 4px;
            `;
      item.appendChild(descEl);
      const exampleEl = document.createElement("div");
      exampleEl.className = "nova-suggestion-example";
      this.getFilePreview(suggestion.file).then((preview) => {
        exampleEl.textContent = `Preview: ${preview}`;
      });
      exampleEl.style.cssText = `
                font-size: 0.8em;
                color: var(--text-accent);
                font-family: var(--font-monospace);
            `;
      item.appendChild(exampleEl);
      this.suggestionPopup.appendChild(item);
      item.addEventListener("click", () => {
        this.selectSuggestion(suggestion);
      });
      item.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.suggestionPopup.style.display = "block";
  }
  updateSelection() {
    if (!this.suggestionPopup) return;
    const items = this.suggestionPopup.querySelectorAll(".nova-suggestion-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.backgroundColor = "var(--background-modifier-hover)";
      } else {
        element.style.backgroundColor = "";
      }
    });
  }
  positionPopup() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.style.position = "absolute";
    this.suggestionPopup.style.left = "0";
    this.suggestionPopup.style.right = "0";
    this.suggestionPopup.style.bottom = "100%";
    this.suggestionPopup.style.marginBottom = "4px";
  }
  selectSuggestion(suggestion) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (!linkMatch) return;
    const isPersistent = !!linkMatch[1];
    const startPos = cursorPos - linkMatch[0].length;
    const linkText = `[[${suggestion.file.basename}]]`;
    const replacement = isPersistent ? `+${linkText}` : linkText;
    const newText = text.substring(0, startPos) + replacement + text.substring(cursorPos);
    this.textArea.value = newText;
    const newCursorPos = startPos + replacement.length;
    this.textArea.setSelectionRange(newCursorPos, newCursorPos);
    this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    this.hideSuggestions();
    this.textArea.focus();
  }
  getSuggestions(query) {
    const files = this.app.vault.getMarkdownFiles();
    const suggestions = [];
    for (const file of files) {
      const score = this.scoreFile(file, query);
      if (score > 0) {
        suggestions.push({
          file,
          displayText: file.basename,
          score
        });
      }
    }
    return suggestions.sort((a, b) => b.score - a.score).slice(0, 8);
  }
  scoreFile(file, query) {
    if (!query) return 50;
    const basename = file.basename.toLowerCase();
    const path = file.path.toLowerCase();
    const queryLower = query.toLowerCase();
    if (basename === queryLower) return 100;
    if (basename.startsWith(queryLower)) return 80;
    if (basename.includes(queryLower)) return 60;
    if (path.includes(queryLower)) return 40;
    if (this.fuzzyMatch(basename, queryLower)) return 20;
    return 0;
  }
  fuzzyMatch(text, query) {
    let textIndex = 0;
    let queryIndex = 0;
    while (textIndex < text.length && queryIndex < query.length) {
      if (text[textIndex] === query[queryIndex]) {
        queryIndex++;
      }
      textIndex++;
    }
    return queryIndex === query.length;
  }
  async getFilePreview(file) {
    try {
      const content = await this.app.vault.read(file);
      let textContent = content;
      if (content.startsWith("---")) {
        const frontmatterEnd = content.indexOf("---", 3);
        if (frontmatterEnd !== -1) {
          textContent = content.substring(frontmatterEnd + 3);
        }
      }
      const plainText = textContent.replace(/^#+ /gm, "").replace(/\*\*(.*?)\*\*/g, "$1").replace(/\*(.*?)\*/g, "$1").replace(/\[(.*?)\]\(.*?\)/g, "$1").replace(/\n/g, " ").trim();
      return plainText.length > 50 ? plainText.substring(0, 50) + "..." : plainText || "Empty file";
    } catch (error) {
      return "Unable to load preview";
    }
  }
  destroy() {
    if (this.suggestionPopup) {
      this.suggestionPopup.remove();
    }
  }
};

// src/ui/input-handler.ts
var _InputHandler = class _InputHandler {
  constructor(plugin, container, contextManager) {
    // Event cleanup tracking
    this.eventListeners = [];
    this.plugin = plugin;
    this.container = container;
    this.contextManager = contextManager;
  }
  setCommandSystem(commandSystem) {
    this.commandSystem = commandSystem;
    const sendButtonEl = this.sendButton.buttonEl;
    sendButtonEl.remove();
    this.commandSystem.createCommandButton(this.inputRow);
    this.inputRow.appendChild(sendButtonEl);
    this.commandSystem.createCommandPickerInContainer(this.inputRow);
  }
  getTextArea() {
    return this.textArea;
  }
  createInputInterface(chatContainer) {
    this.container = this.container.createDiv({ cls: "nova-input-container" });
    this.container.style.cssText = `
			flex-shrink: 0;
			padding: var(--size-4-3);
			border-top: 1px solid var(--background-modifier-border);
			position: relative;
		`;
    this.inputRow = this.container.createDiv({ cls: "nova-input-row" });
    this.inputRow.style.cssText = `
			display: flex;
			gap: var(--size-2-3);
			align-items: center;
			position: relative;
		`;
    const textAreaContainer = this.inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian2.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova anything... (Shift+Enter for new line)");
    this.textArea.inputEl.style.cssText = `
			min-height: 80px;
			max-height: 200px;
			resize: none;
			overflow-y: auto;
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			border: 1px solid var(--background-modifier-border);
			background: var(--background-primary);
			color: var(--text-normal);
			font-family: var(--font-interface);
			font-size: var(--font-ui-medium);
			line-height: 1.4;
			width: 100%;
			box-sizing: border-box;
		`;
    this.autoGrowTextarea = () => {
      const textarea = this.textArea.inputEl;
      textarea.style.height = "auto";
      textarea.style.height = Math.min(textarea.scrollHeight, 200) + "px";
    };
    this.addEventListener(this.textArea.inputEl, "input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.plugin.app, this.textArea.inputEl, this.inputRow);
    this.addEventListener(this.textArea.inputEl, "input", () => {
      this.contextManager.updateLiveContextPreview(this.textArea.getValue());
    });
    this.sendButton = new import_obsidian2.ButtonComponent(this.inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
		`;
    this.addEventListener(this.textArea.inputEl, "keydown", (event) => {
      var _a, _b, _c, _d;
      const keyEvent = event;
      if (keyEvent.key === "Enter" && !keyEvent.shiftKey) {
        event.preventDefault();
        ((_a = this.commandSystem) == null ? void 0 : _a.handleCommandPickerSelection()) || false || this.handleSend();
      } else if (keyEvent.key === "Escape") {
        (_b = this.commandSystem) == null ? void 0 : _b.hideCommandPicker();
      } else if (keyEvent.key === "ArrowUp" || keyEvent.key === "ArrowDown") {
        if ((_c = this.commandSystem) == null ? void 0 : _c.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      } else if (keyEvent.key === "Tab") {
        if ((_d = this.commandSystem) == null ? void 0 : _d.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      }
    });
    this.addEventListener(this.textArea.inputEl, "input", () => {
      if (this.commandSystem) {
        this.commandSystem.handleInputChange();
      }
    });
  }
  focus() {
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _InputHandler.FOCUS_DELAY_MS);
  }
  handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.textArea.setValue("");
    this.autoGrowTextarea();
    this.contextManager.hideContextPreview();
    (_a = this.onSendMessage) == null ? void 0 : _a.call(this, message);
  }
  setOnSendMessage(callback) {
    this.onSendMessage = callback;
  }
  getValue() {
    return this.textArea.getValue();
  }
  setValue(value) {
    this.textArea.setValue(value);
    this.autoGrowTextarea();
  }
  insertText(text) {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + text + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const newPosition = start + text.length;
    setTimeout(() => {
      textarea.setSelectionRange(newPosition, newPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  insertTextWithCursor(beforeCursor, afterCursor = "") {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + beforeCursor + afterCursor + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const cursorPosition = start + beforeCursor.length;
    setTimeout(() => {
      textarea.setSelectionRange(cursorPosition, cursorPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.eventListeners.push({ element, event, handler });
  }
  refreshCommandButton() {
    if (this.commandSystem) {
      this.commandSystem.updateCommandButtonVisibility();
    }
  }
  cleanup() {
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    this.eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.eventListeners = [];
  }
};
_InputHandler.FOCUS_DELAY_MS = 150;
var InputHandler = _InputHandler;

// src/ui/command-system.ts
var import_obsidian3 = require("obsidian");
var CommandSystem = class {
  constructor(plugin, container, textArea) {
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.plugin = plugin;
    this.container = container;
    this.textArea = textArea;
  }
  createCommandButton(inputRow) {
    this.commandButton = new import_obsidian3.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: var(--size-2-3);
		`;
    return this.commandButton;
  }
  createCommandPicker() {
    this.createCommandPickerInContainer(this.container);
  }
  createCommandPickerInContainer(container) {
    this.commandPicker = container.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			margin-bottom: 4px;
		`;
  }
  shouldShowCommandButton() {
    return this.plugin.settings.showCommandButton && this.plugin.featureManager.isFeatureEnabled("commands");
  }
  updateCommandButtonVisibility() {
    if (this.commandButton) {
      const shouldShow = this.shouldShowCommandButton();
      this.commandButton.buttonEl.style.display = shouldShow ? "flex" : "none";
    }
  }
  toggleCommandMenu() {
    if (!this.commandMenu) {
      this.createCommandMenu();
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  createCommandMenu() {
    this.commandMenu = this.container.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			box-shadow: var(--shadow-s);
			min-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			padding: var(--size-2-2);
		`;
    const commands = [
      { name: "Improve Writing", description: "Enhance clarity and flow", command: "/improve" },
      { name: "Fix Grammar", description: "Correct grammar and spelling", command: "/grammar" },
      { name: "Summarize", description: "Create a concise summary", command: "/summarize" },
      { name: "Expand Ideas", description: "Develop thoughts further", command: "/expand" },
      { name: "Explain", description: "Clarify complex concepts", command: "/explain" },
      { name: "Continue Writing", description: "Extend the current text", command: "/continue" }
    ];
    const title = this.commandMenu.createEl("div", { text: "Quick Commands" });
    title.style.cssText = `
			font-size: var(--font-ui-medium);
			font-weight: 600;
			margin-bottom: var(--size-2-3);
			color: var(--text-normal);
		`;
    commands.forEach((cmd) => {
      const cmdEl = this.commandMenu.createDiv({ cls: "nova-command-item" });
      cmdEl.style.cssText = `
				padding: var(--size-2-2) var(--size-2-3);
				border-radius: var(--radius-xs);
				cursor: pointer;
				margin-bottom: var(--size-2-1);
				transition: background-color 0.1s;
			`;
      const nameEl = cmdEl.createEl("div", { text: cmd.name });
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
				margin-bottom: var(--size-2-1);
			`;
      const descEl = cmdEl.createEl("div", { text: cmd.description });
      descEl.style.cssText = `
				font-size: var(--font-ui-smaller);
				color: var(--text-muted);
			`;
      cmdEl.addEventListener("click", () => {
        this.textArea.setValue(cmd.command + " ");
        this.textArea.inputEl.focus();
        this.hideCommandMenu();
      });
      cmdEl.addEventListener("mouseenter", () => {
        cmdEl.style.background = "var(--background-modifier-hover)";
      });
      cmdEl.addEventListener("mouseleave", () => {
        cmdEl.style.background = "transparent";
      });
    });
  }
  showCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "block";
      this.isCommandMenuVisible = true;
    }
  }
  hideCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "none";
      this.isCommandMenuVisible = false;
    }
  }
  handleInputChange() {
    if (!this.textArea) {
      return;
    }
    const input = this.textArea.getValue();
    if (input.startsWith(":")) {
      this.showStructuredCommandPicker(input);
    } else {
      this.hideCommandPicker();
    }
  }
  /**
   * Show structured command picker for ":" trigger  
   */
  showStructuredCommandPicker(input) {
    if (!this.commandPicker) {
      return;
    }
    const structuredCommands = this.getStructuredCommands();
    const filterText = input.slice(1).toLowerCase();
    const filtered = structuredCommands.filter(
      (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
    );
    this.commandPickerItems = [];
    this.commandPicker.empty();
    this.selectedCommandIndex = -1;
    if (filtered.length > 0) {
      filtered.forEach((cmd, index) => {
        const item = this.commandPicker.createDiv({ cls: "nova-command-picker-item" });
        item.style.cssText = `
					padding: 8px 12px;
					cursor: pointer;
					border-bottom: 1px solid var(--background-modifier-border-hover);
					transition: background-color 0.2s;
				`;
        const nameEl = item.createEl("div", { text: cmd.name });
        nameEl.style.cssText = `
					font-weight: 500;
					color: var(--text-normal);
					margin-bottom: 4px;
				`;
        const descEl = item.createEl("div", { text: cmd.description });
        descEl.style.cssText = `
					font-size: 0.85em;
					color: var(--text-muted);
					margin-bottom: 4px;
				`;
        const exampleEl = item.createEl("div", { text: `Example: ${cmd.example}` });
        exampleEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-accent);
					font-family: var(--font-monospace);
				`;
        item.addEventListener("click", () => {
          this.selectStructuredCommand(cmd.template);
        });
        item.addEventListener("mouseenter", () => {
          this.selectedCommandIndex = index;
          this.updateCommandPickerSelection();
        });
        this.commandPickerItems.push(item);
      });
      this.commandPicker.style.display = "block";
    } else {
      this.hideCommandPicker();
    }
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
  }
  handleCommandPickerNavigation(key) {
    if (this.commandPickerItems.length === 0) return false;
    if (key === "ArrowDown") {
      this.selectedCommandIndex = Math.min(this.selectedCommandIndex + 1, this.commandPickerItems.length - 1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "ArrowUp") {
      this.selectedCommandIndex = Math.max(this.selectedCommandIndex - 1, -1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "Tab" && this.selectedCommandIndex >= 0) {
      return this.handleCommandPickerSelection();
    }
    return false;
  }
  handleCommandPickerSelection() {
    if (this.selectedCommandIndex >= 0 && this.commandPickerItems.length > 0) {
      const commands = this.getStructuredCommands();
      const input = this.textArea.getValue();
      if (input.startsWith(":")) {
        const filterText = input.slice(1).toLowerCase();
        const filtered = commands.filter(
          (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
        );
        if (this.selectedCommandIndex < filtered.length) {
          const selectedCmd = filtered[this.selectedCommandIndex];
          this.selectStructuredCommand(selectedCmd.template);
          return true;
        }
      }
    }
    return false;
  }
  updateCommandPickerSelection() {
    this.commandPickerItems.forEach((item, index) => {
      if (index === this.selectedCommandIndex) {
        item.style.background = "var(--background-modifier-hover)";
      } else {
        item.style.background = "transparent";
      }
    });
  }
  selectCommand(command) {
    this.textArea.setValue(command + " ");
    this.textArea.inputEl.focus();
    const length = this.textArea.getValue().length;
    this.textArea.inputEl.setSelectionRange(length, length);
    this.hideCommandPicker();
  }
  /**
   * Get structured commands for ":" trigger
   */
  getStructuredCommands() {
    return [
      {
        name: "Add Section",
        description: "Add a new section to the document",
        command: "add section",
        template: 'add section "{cursor}"',
        example: ':add section "Results"',
        keywords: ["create", "new", "heading"]
      },
      {
        name: "Edit Section",
        description: "Edit content in a specific section",
        command: "edit section",
        template: "edit {cursor} section",
        example: ":edit Methods section",
        keywords: ["modify", "update", "change"]
      },
      {
        name: "Delete Section",
        description: "Remove a section from the document",
        command: "delete section",
        template: "delete {cursor} section",
        example: ":delete Introduction section",
        keywords: ["remove", "eliminate"]
      },
      {
        name: "Append To",
        description: "Add content to the end of a section",
        command: "append to",
        template: "append {cursor} to /",
        example: ":append conclusion to /Results",
        keywords: ["add", "attach", "end"]
      },
      {
        name: "Prepend To",
        description: "Add content to the beginning of a section",
        command: "prepend to",
        template: "prepend {cursor} to /",
        example: ":prepend warning to /Methods",
        keywords: ["add", "beginning", "start"]
      },
      {
        name: "Insert After",
        description: "Insert content after a section heading",
        command: "insert after",
        template: "insert {cursor} after / heading",
        example: ":insert diagram after /Methods heading",
        keywords: ["add", "place", "after"]
      },
      {
        name: "Insert Before",
        description: "Insert content before a section heading",
        command: "insert before",
        template: "insert {cursor} before / heading",
        example: ":insert note before /Results heading",
        keywords: ["add", "place", "before"]
      }
    ];
  }
  /**
   * Select a structured command and insert template
   */
  selectStructuredCommand(template) {
    this.hideCommandPicker();
    const cursorPos = template.indexOf("{cursor}");
    if (cursorPos !== -1) {
      const beforeCursor = template.slice(0, cursorPos);
      const afterCursor = template.slice(cursorPos + 8);
      this.textArea.setValue(beforeCursor + afterCursor);
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(cursorPos, cursorPos);
        this.textArea.inputEl.focus();
      }, 0);
    } else {
      this.textArea.setValue(template);
      this.textArea.inputEl.focus();
    }
  }
  cleanup() {
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.remove();
    }
  }
};

// src/ui/context-manager.ts
var import_obsidian4 = require("obsidian");
var _ContextManager = class _ContextManager {
  constructor(plugin, app, container) {
    this.currentContext = null;
    this.plugin = plugin;
    this.app = app;
    this.container = container;
    this.multiDocHandler = new MultiDocContextHandler(app);
  }
  createContextIndicator() {
    this.contextIndicator = this.container.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			position: absolute;
			top: -2px;
			right: var(--size-4-3);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-1) var(--size-2-2);
			font-size: var(--font-ui-smaller);
			color: var(--text-muted);
			display: none;
			z-index: 100;
			max-width: 200px;
			box-shadow: var(--shadow-s);
		`;
  }
  createContextPreview() {
    const previewContainer = this.container.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			margin-bottom: var(--size-2-2);
			font-size: var(--font-ui-small);
			display: none;
		`;
    const previewLabel = previewContainer.createSpan({ text: "Context: " });
    previewLabel.style.cssText = "color: var(--text-muted); font-weight: 600;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview(message) {
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      foundRefs.push({ name: docName, property });
    }
    if (foundRefs.length === 0) {
      this.contextPreview.style.display = "none";
      return;
    }
    const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
    if (previewList) {
      const refsText = foundRefs.map(
        (ref) => ref.property ? `${ref.name}#${ref.property}` : ref.name
      ).join(", ");
      previewList.textContent = refsText;
    }
    this.contextPreview.style.display = "block";
  }
  async buildContext(message, currentFile) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context") || !currentFile) {
      return null;
    }
    try {
      const result = await this.multiDocHandler.buildContext(message, currentFile);
      this.currentContext = result.context;
      if ((_a = result.context) == null ? void 0 : _a.persistentDocs.length) {
        this.updateContextIndicator(result.context);
        if (result.context.isNearLimit) {
          new import_obsidian4.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _ContextManager.NOTICE_DURATION_MS);
        }
      }
      return result.context;
    } catch (error) {
      return null;
    }
  }
  updateContextIndicator(context) {
    if (!this.contextIndicator) return;
    const docCount = context.persistentDocs.length;
    if (docCount > 0) {
      this.contextIndicator.textContent = `${docCount} doc${docCount > 1 ? "s" : ""}`;
      this.contextIndicator.style.display = "block";
      this.contextIndicator.style.cursor = "pointer";
      this.contextIndicator.onclick = () => {
        this.showContextDetails(context);
      };
      this.contextIndicator.addEventListener("mouseenter", () => {
        this.contextIndicator.style.background = "var(--interactive-hover)";
      });
      this.contextIndicator.addEventListener("mouseleave", () => {
        this.contextIndicator.style.background = "var(--background-primary)";
      });
    } else {
      this.contextIndicator.style.display = "none";
    }
  }
  showContextDetails(context) {
    const modal = this.container.createDiv({ cls: "nova-context-modal" });
    modal.style.cssText = `
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 10000;
		`;
    const content = modal.createDiv();
    content.style.cssText = `
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-4-4);
			max-width: 80%;
			max-height: 80%;
			overflow-y: auto;
			box-shadow: var(--shadow-s);
		`;
    const header = content.createEl("h3", { text: "Context Documents" });
    header.style.cssText = "margin-top: 0; margin-bottom: var(--size-4-3);";
    context.persistentDocs.forEach((doc) => {
      const docEl = content.createDiv();
      docEl.style.cssText = `
				padding: var(--size-2-2);
				margin-bottom: var(--size-2-2);
				background: var(--background-modifier-hover);
				border-radius: var(--radius-xs);
			`;
      const nameEl = docEl.createEl("div", { text: doc.file.basename });
      nameEl.style.cssText = "font-weight: 600; margin-bottom: var(--size-2-1);";
      if (doc.property) {
        const propEl = docEl.createEl("div", { text: `Property: ${doc.property}` });
        propEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted);";
      }
      const previewEl = docEl.createEl("div", { text: doc.file.path });
      previewEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted); margin-top: var(--size-2-1);";
    });
    const closeBtn = content.createEl("button", { text: "Close" });
    closeBtn.style.cssText = `
			margin-top: var(--size-4-3);
			padding: var(--size-2-2) var(--size-4-3);
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
			border-radius: var(--radius-s);
			cursor: pointer;
		`;
    closeBtn.onclick = () => modal.remove();
    modal.onclick = (e) => {
      if (e.target === modal) modal.remove();
    };
  }
  hideContextPreview() {
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
  }
  hideContextIndicator() {
    if (this.contextIndicator) {
      this.contextIndicator.style.display = "none";
    }
  }
  clearCurrentContext() {
    this.currentContext = null;
    this.hideContextIndicator();
    this.hideContextPreview();
  }
  getCurrentContext() {
    return this.currentContext;
  }
  cleanup() {
    this.clearCurrentContext();
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.contextPreview) {
      this.contextPreview.remove();
    }
  }
};
_ContextManager.NOTICE_DURATION_MS = 5e3;
var ContextManager = _ContextManager;

// src/ui/chat-renderer.ts
var _ChatRenderer = class _ChatRenderer {
  constructor(plugin, chatContainer) {
    this.plugin = plugin;
    this.chatContainer = chatContainer;
  }
  /**
   * Add a chat message with role header
   */
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom(true);
  }
  /**
   * Helper method to create simple messages without role headers
   */
  createSimpleMessage(content, className) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${className}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom();
  }
  addErrorMessage(content) {
    this.createSimpleMessage(content, "nova-message-error");
  }
  addSuccessMessage(content) {
    this.createSimpleMessage(content, "nova-message-success");
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			padding: var(--size-4-4);
			margin-bottom: var(--size-4-3);
			background: var(--background-modifier-hover);
			border-radius: var(--radius-s);
			border: 1px solid var(--background-modifier-border);
			text-align: center;
			position: relative;
		`;
    const content = message || `
			<div style="display: flex; align-items: center; justify-content: center; gap: var(--size-2-3); margin-bottom: var(--size-4-2);">
				<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size-xl); height: var(--icon-size-xl); color: var(--interactive-accent);">
					<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
					<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				</svg>
				<span style="font-size: var(--font-ui-large); font-weight: 600; color: var(--text-normal);">Welcome to Nova</span>
			</div>
			<p style="margin: 0 0 var(--size-4-3) 0; color: var(--text-muted); font-size: var(--font-ui-medium);">
				Your AI thinking partner for Obsidian. Start a conversation or use commands to enhance your writing.
			</p>
			<p style="margin: 0; color: var(--text-faint); font-size: var(--font-ui-small);">
				\u{1F4A1} <strong>Tip:</strong> Reference other notes with [[Note Name]] or use the \u26A1 button for quick commands
			</p>
		`;
    welcomeEl.innerHTML = content;
    const dismissBtn = welcomeEl.createEl("button");
    dismissBtn.textContent = "\xD7";
    dismissBtn.style.cssText = `
			position: absolute;
			top: var(--size-2-2);
			right: var(--size-2-2);
			background: none;
			border: none;
			font-size: var(--font-ui-large);
			color: var(--text-faint);
			cursor: pointer;
			padding: var(--size-2-1);
			border-radius: var(--radius-xs);
		`;
    dismissBtn.addEventListener("click", () => {
      welcomeEl.remove();
    });
    dismissBtn.addEventListener("mouseenter", () => {
      dismissBtn.style.color = "var(--text-normal)";
      dismissBtn.style.background = "var(--background-modifier-hover)";
    });
    dismissBtn.addEventListener("mouseleave", () => {
      dismissBtn.style.color = "var(--text-faint)";
      dismissBtn.style.background = "none";
    });
    this.scrollToBottom(true);
  }
  clearChat() {
    this.chatContainer.empty();
  }
  scrollToBottom(smooth = false) {
    setTimeout(() => {
      if (smooth) {
        this.chatContainer.scrollTo({
          top: this.chatContainer.scrollHeight,
          behavior: "smooth"
        });
      } else {
        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
      }
    }, _ChatRenderer.SCROLL_DELAY_MS);
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
    for (const message of messages) {
      this.addMessage(message.role, message.content);
    }
  }
};
_ChatRenderer.SCROLL_DELAY_MS = 50;
var ChatRenderer = _ChatRenderer;

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var _NovaSidebarView = class _NovaSidebarView extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.currentContext = null;
    // Command system compatibility - stub out old methods
    this._commandPickerItems = [];
    this._selectedCommandIndex = -1;
    this._isCommandMenuVisible = false;
    // Performance optimization - debouncing and timing constants
    this.contextPreviewDebounceTimeout = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  // Legacy compatibility delegates - Forward to new architecture
  get textArea() {
    var _a;
    return (_a = this.inputHandler) == null ? void 0 : _a.getTextArea();
  }
  get wikilinkAutocomplete() {
    return this.inputHandler ? { destroy: () => {
    } } : null;
  }
  get autoGrowTextarea() {
    return () => {
    };
  }
  get commandPickerItems() {
    return this._commandPickerItems;
  }
  set commandPickerItems(value) {
    this._commandPickerItems = value;
  }
  get selectedCommandIndex() {
    return this._selectedCommandIndex;
  }
  set selectedCommandIndex(value) {
    this._selectedCommandIndex = value;
  }
  get isCommandMenuVisible() {
    return this._isCommandMenuVisible;
  }
  set isCommandMenuVisible(value) {
    this._isCommandMenuVisible = value;
  }
  // Context system compatibility - forward to ContextManager
  get contextPreview() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextPreview;
  }
  get contextIndicator() {
    var _a;
    return this._contextIndicator || ((_a = this.contextManager) == null ? void 0 : _a.contextIndicator);
  }
  set contextIndicator(value) {
    this._contextIndicator = value;
  }
  // Stub out old DOM elements that should no longer be used
  get commandPicker() {
    return null;
  }
  set commandPicker(value) {
  }
  get commandMenu() {
    return null;
  }
  set commandMenu(value) {
  }
  get commandButton() {
    return null;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian5.Platform.isDesktopApp ? "var(--size-4-6)" : "var(--size-4-5)"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: var(--size-4-2);
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: var(--font-ui-medium); display: flex; align-items: center; gap: var(--size-2-2);";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size); height: var(--icon-size);">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: var(--size-2-3);";
    const privacyIndicator = rightContainer.createSpan({ cls: "nova-privacy-indicator" });
    privacyIndicator.style.cssText = `
			display: flex;
			align-items: center;
			padding: 4px;
			color: var(--icon-color);
			font-weight: var(--font-weight-medium);
		`;
    this.updatePrivacyIndicator(privacyIndicator);
    this.privacyIndicator = privacyIndicator;
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian5.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.loadConversationForActiveFile();
    setTimeout(() => this.refreshProviderStatus(), 100);
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _NovaSidebarView.FOCUS_DELAY_MS);
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
      this.contextPreviewDebounceTimeout = null;
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: var(--size-4-2);
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: var(--size-2-3);
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements using new architecture
   */
  createInputArea() {
    this.inputContainer.empty();
    this.contextManager = new ContextManager(this.plugin, this.app, this.inputContainer);
    this.chatRenderer = new ChatRenderer(this.plugin, this.chatContainer);
    this.inputHandler = new InputHandler(this.plugin, this.inputContainer, this.contextManager);
    this.inputHandler.createInputInterface(this.chatContainer);
    this.commandSystem = new CommandSystem(this.plugin, this.inputContainer, this.inputHandler.getTextArea());
    this.inputHandler.setCommandSystem(this.commandSystem);
    this.inputHandler.setOnSendMessage((message) => {
      this.handleSend(message);
    });
    this.contextManager.createContextIndicator();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  /**
   * Helper method to create simple messages without role headers
   */
  createSimpleMessage(content, className) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${className}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  addErrorMessage(content) {
    this.createSimpleMessage(content, "nova-message-error");
  }
  addSuccessMessage(content) {
    this.createSimpleMessage(content, "nova-message-success");
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: var(--size-4-3);
			margin: var(--size-4-4) auto;
			padding: var(--size-4-4) var(--size-4-5);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-l);
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: var(--icon-size-xl);
			height: var(--icon-size-xl);
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size-xl); height: var(--icon-size-xl); color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Hi! I'm Nova." });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: var(--text-success); display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addMessage("system", this.createIconMessage("zap", "Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025."));
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addSuccessMessage(this.createIconMessage("refresh-cw", `Switched to ${this.getProviderWithModelDisplayName(providerId)}`));
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.textArea.setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addMessage("system", this.createIconMessage("edit", `Loaded template: ${customCommand.name}`));
        return true;
      }
    }
    this.addErrorMessage(this.createIconMessage("help-circle", `Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`));
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker nova-panel-base" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.textArea.getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("commands")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item nova-panel-item" });
      const triggerEl = item.createSpan({ cls: "nova-command-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      const nameEl = item.createSpan({ cls: "nova-command-name nova-panel-text" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1;";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.removeClass("selected");
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].addClass("selected");
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.textArea.setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    const commands = [
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" }
    ];
    if (import_obsidian5.Platform.isDesktopApp) {
      commands.push({ trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" });
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      customCommands.forEach((cmd) => {
        commands.push({
          trigger: cmd.trigger,
          name: cmd.name,
          ...cmd.description && { description: cmd.description }
        });
      });
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu nova-panel-base" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addMessage("system", this.createIconMessage("zap", "Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025."));
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header nova-panel-header" });
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item nova-panel-item-vertical" });
      const nameEl = item.createDiv({ cls: "nova-command-menu-name nova-panel-text" });
      nameEl.textContent = command.name;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.opacity = "0.8";
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  executeCommandFromMenu(trigger) {
    this.hideCommandMenu();
    this.textArea.setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  /**
   * Debounced version of updateLiveContextPreview for performance
   */
  debouncedUpdateContextPreview() {
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
    }
    this.contextPreviewDebounceTimeout = setTimeout(() => {
      this.updateLiveContextPreview();
      this.contextPreviewDebounceTimeout = null;
    }, _NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS);
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.textArea.getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian5.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian5.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian5.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const isMobile = import_obsidian5.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: block;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px;";
    if (isMobile) {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}%)`;
    } else {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian5.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("eraser").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				margin-left: 6px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.innerHTML = this.createInlineIcon("x", isMobile ? "18px" : "14px");
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: bold;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      const result = await this.multiDocHandler.buildContext("", this.currentFile);
      this.currentContext = result.context;
      this.updateContextIndicator();
    }
  }
  async handleSend(message) {
    var _a, _b;
    const messageText = message || this.inputHandler.getValue().trim();
    if (!messageText) return;
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (!currentProviderType) {
      this.addErrorMessage(this.createIconMessage("alert-circle", "Nova is disabled or no AI provider is available. Please configure an AI provider in settings."));
      return;
    }
    if (messageText.startsWith(":")) {
      const commandResult = await this.handleColonCommand(messageText);
      if (commandResult) {
        this.inputHandler.setValue("");
        return;
      }
    }
    let processedMessage = messageText;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (messageText.includes("[[") || messageText.includes("+[[")) {
          this.addMessage("system", this.createIconMessage("book-open", "Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025."));
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(messageText, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_a = this.currentContext) == null ? void 0 : _a.persistentDocs.length) || 0;
        const currentPersistentCount = multiDocContext.persistentDocs.length;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.map((doc) => doc.file.basename).join(", ");
            this.addSuccessMessage(this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
          }
          this.inputHandler.setValue("");
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (multiDocContext.persistentDocs.length > 0) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.map((doc) => doc.file.basename).join(", ");
          const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
          const currentFile = ((_b = this.currentFile) == null ? void 0 : _b.basename) || "current file";
          this.addMessage("system", this.createIconMessage("book-open", `Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`));
        }
        if (multiDocContext.isNearLimit) {
          new import_obsidian5.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _NovaSidebarView.NOTICE_DURATION_MS);
        }
      }
    }
    this.addMessage("user", messageText);
    this.inputHandler.setValue("");
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(messageText);
      }
      const isLikelyCommand = this.plugin.promptBuilder["isLikelyCommand"](processedMessage);
      let response = null;
      if (isLikelyCommand && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedUserPrompt = `${multiDocContext.contextString}

---

User Request: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      loadingEl.remove();
      const filteredResponse = response ? this.filterThinkingContent(response) : response;
      if (activeFile && filteredResponse) {
        await this.plugin.documentEngine.addAssistantMessage(filteredResponse);
      }
      if (filteredResponse) {
        if (filteredResponse.includes("x-circle") || filteredResponse.includes("Error executing command") || filteredResponse.includes("Failed to") || filteredResponse.includes("No markdown file is open") || filteredResponse.includes("Unable to access") || filteredResponse.includes("Unable to set")) {
          this.addErrorMessage(filteredResponse);
        } else {
          this.addMessage("assistant", filteredResponse);
        }
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addErrorMessage(this.createIconMessage("x-circle", `Sorry, I encountered an error: ${error.message}`));
    } finally {
      const sendButton2 = this.inputHandler.sendButton;
      if (sendButton2) sendButton2.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: true });
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      let result;
      switch (command.action) {
        case "add":
          result = await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          result = await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          result = await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return this.createIconMessage("x-circle", `Error executing command: ${error.message}`);
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian5.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      this.currentFile = null;
      this.chatContainer.empty();
      this.refreshContext();
      this.addWelcomeMessage("Open a document to get started.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFile = targetFile;
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Working on "${targetFile.basename}".`);
      }
    } catch (error) {
      this.addWelcomeMessage(`Working on "${targetFile.basename}".`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared.`);
    } else {
      this.addWelcomeMessage("Chat cleared.");
    }
    new import_obsidian5.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Update send button enabled/disabled state based on provider availability
   */
  async updateSendButtonState() {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(!currentProviderType);
  }
  /**
   * Update privacy indicator icon and tooltip based on current provider
   */
  async updatePrivacyIndicator(privacyIndicator) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (currentProviderType) {
      const isLocalProvider = currentProviderType === "ollama";
      const iconName = isLocalProvider ? "lock" : "unlock";
      const tooltip = isLocalProvider ? "Local processing - data stays on your device" : "Cloud processing - data sent to provider";
      (0, import_obsidian5.setIcon)(privacyIndicator, iconName);
      privacyIndicator.setAttribute("aria-label", tooltip);
      privacyIndicator.setAttribute("title", tooltip);
    } else {
      (0, import_obsidian5.setIcon)(privacyIndicator, "help-circle");
      privacyIndicator.setAttribute("aria-label", "No provider selected");
      privacyIndicator.setAttribute("title", "No provider selected");
    }
  }
  /**
   * Filter thinking content from AI responses
   * Removes content between <think>/<thinking> and </think>/<thinking> tags
   */
  filterThinkingContent(content) {
    return content.replace(/<think(?:ing)?[\s\S]*?<\/think(?:ing)?>/gi, "").trim();
  }
  /**
   * Refresh all provider status indicators in the UI
   */
  async refreshProviderStatus() {
    var _a;
    if (this.privacyIndicator) {
      await this.updatePrivacyIndicator(this.privacyIndicator);
    }
    this.updateSendButtonState();
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      await this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-normal);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
      if (currentProviderType) {
        const displayText = this.getProviderWithModelDisplayName(currentProviderType);
        providerName.setText(displayText);
      } else {
        const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
        providerName.setText(currentProviderName);
      }
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Get available models for a provider type
   */
  getAvailableModels(providerType) {
    return getAvailableModels(providerType, this.plugin.settings);
  }
  /**
   * Get current model for a provider type
   */
  getCurrentModel(providerType) {
    var _a;
    const providers = this.plugin.settings.aiProviders;
    const currentModel = (_a = providers[providerType]) == null ? void 0 : _a.model;
    if (currentModel) {
      return currentModel;
    }
    const availableModels = this.getAvailableModels(providerType);
    return availableModels.length > 0 ? availableModels[0].value : "";
  }
  /**
   * Get model display name from model value
   */
  getModelDisplayName(providerType, modelValue) {
    const models = this.getAvailableModels(providerType);
    const model = models.find((m) => m.value === modelValue);
    return model ? model.label : modelValue;
  }
  /**
   * Switch to a specific model for a provider
   */
  async switchToModel(providerType, modelValue) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const isCurrentProvider = currentProviderType === providerType;
    const providers = this.plugin.settings.aiProviders;
    providers[providerType].model = modelValue;
    await this.plugin.saveSettings();
    if (isCurrentProvider) {
      const modelName = this.getModelDisplayName(providerType, modelValue);
      const providerName = this.getProviderDisplayName(providerType);
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${providerName} ${modelName}`);
      this.addMessage("system", switchMessage);
    } else {
      await this.switchToProvider(providerType);
    }
    if (this.currentProviderDropdown) {
      this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    var _a;
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providers = this.plugin.settings.aiProviders;
      const hasApiKey = (_a = providers[providerType]) == null ? void 0 : _a.apiKey;
      if (!hasApiKey && providerType !== "ollama") continue;
      const models = this.getAvailableModels(providerType);
      const currentModel = this.getCurrentModel(providerType);
      const displayName = this.getProviderDisplayName(providerType);
      const isCurrent = displayName === currentProviderName;
      const providerContainer = dropdownMenu.createDiv({ cls: "nova-provider-container" });
      const providerItem = providerContainer.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				color: var(--text-normal);
				transition: background-color 0.2s ease;
				position: relative;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const nameSpan = providerItem.createSpan({ text: displayName });
      nameSpan.style.flex = "1";
      let expandArrow = null;
      if (models.length > 0) {
        expandArrow = providerItem.createSpan({ text: "\u25B6" });
        expandArrow.style.cssText = `
					font-size: 0.6em;
					transition: transform 0.2s ease;
					color: var(--text-muted);
				`;
      }
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      let modelsMenu = null;
      let isExpanded = false;
      if (models.length > 0) {
        modelsMenu = providerContainer.createDiv({ cls: "nova-models-submenu" });
        modelsMenu.style.cssText = `
					display: none;
					background: var(--background-primary);
					border-left: 2px solid ${this.getProviderColor(providerType)};
					margin-left: 16px;
				`;
        for (const model of models) {
          const modelItem = modelsMenu.createDiv({ cls: "nova-model-item" });
          modelItem.style.cssText = `
						padding: 6px 12px;
						cursor: pointer;
						font-size: 0.8em;
						color: var(--text-normal);
						transition: background-color 0.2s ease;
						display: flex;
						align-items: center;
						gap: 8px;
					`;
          const modelDot = modelItem.createSpan();
          modelDot.style.cssText = `
						width: 4px;
						height: 4px;
						border-radius: 50%;
						background: ${model.value === currentModel ? this.getProviderColor(providerType) : "var(--text-muted)"};
					`;
          const modelName = modelItem.createSpan({ text: model.label });
          if (model.value === currentModel) {
            modelName.style.fontWeight = "bold";
          }
          modelItem.addEventListener("click", async (e) => {
            e.stopPropagation();
            await this.switchToModel(providerType, model.value);
            dropdownMenu.style.display = "none";
          });
          modelItem.addEventListener("mouseenter", () => {
            modelItem.style.background = "var(--background-modifier-border-hover)";
          });
          modelItem.addEventListener("mouseleave", () => {
            modelItem.style.background = "transparent";
          });
        }
      }
      providerItem.addEventListener("click", async (e) => {
        if (models.length > 0) {
          e.stopPropagation();
          isExpanded = !isExpanded;
          if (modelsMenu) {
            modelsMenu.style.display = isExpanded ? "block" : "none";
          }
          if (expandArrow) {
            expandArrow.style.transform = isExpanded ? "rotate(90deg)" : "rotate(0deg)";
          }
        } else {
          if (!isCurrent) {
            await this.switchToProvider(providerType);
            dropdownMenu.style.display = "none";
            if (this.currentProviderDropdown) {
              this.currentProviderDropdown.updateCurrentProvider();
            }
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent && !isExpanded) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Anthropic",
      "openai": "OpenAI",
      "google": "Google",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get display name for header (just model name if available, otherwise provider name)
   */
  getProviderWithModelDisplayName(providerType) {
    const models = this.getAvailableModels(providerType);
    if (models.length > 0) {
      const currentModel = this.getCurrentModel(providerType);
      return this.getModelDisplayName(providerType, currentModel);
    }
    return this.getProviderDisplayName(providerType);
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "var(--color-orange)",
      "openai": "var(--color-green)",
      "google": "var(--color-blue)",
      "ollama": "var(--color-purple)",
      "none": "var(--text-muted)"
    };
    return colors[providerType] || "var(--text-success)";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${this.getProviderWithModelDisplayName(providerType)}`);
      this.addMessage("system", switchMessage);
      const platform = import_obsidian5.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      setTimeout(() => this.refreshProviderStatus(), 100);
    } catch (error) {
      this.addErrorMessage(this.createIconMessage("x-circle", `Failed to switch to ${this.getProviderWithModelDisplayName(providerType)}`));
    }
  }
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    if (this.inputHandler) {
      this.inputHandler.refreshCommandButton();
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
};
_NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS = 300;
_NovaSidebarView.SCROLL_DELAY_MS = 50;
_NovaSidebarView.FOCUS_DELAY_MS = 150;
_NovaSidebarView.HOVER_TIMEOUT_MS = 150;
_NovaSidebarView.NOTICE_DURATION_MS = 5e3;
var NovaSidebarView = _NovaSidebarView;

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-3-5-sonnet-20241022",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-1.5-flash",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isSupernova ? "supernova" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian6.Setting(licenseContainer).setName("Supernova License Key (Optional)").setDesc("Enter your Supernova supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Supernova license key...").setValue(this.plugin.settings.licensing.supernovaLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Supernova license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
              const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
              if (isSupernova2) {
                this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
                this.showConfetti();
              } else {
                this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
              }
              const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
              if (leaves.length > 0) {
                const sidebarView = leaves[0].view;
                sidebarView.refreshSupernovaUI();
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Supernova license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createSupernovaInfo(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian6.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian6.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian6.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.display();
      }));
      new import_obsidian6.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian6.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian6.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian6.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "AI Provider Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const providerContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    providerContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = providerContainer.style.display !== "none";
      providerContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = providerContainer.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
			<div class="nova-info-card nova-model-guidance">
				<h4>Recommended Defaults</h4>
				<ul class="nova-model-recommendations">
					<li><strong>Claude Sonnet 4</strong> - Latest generation with excellent instruction following for collaborative editing</li>
					<li><strong>GPT-4.1 Mini</strong> - Current-generation model that outperforms GPT-4o while remaining cost-effective</li>
					<li><strong>Gemini 2.5 Flash</strong> - Best price/performance with "thinking" capabilities and strong coding support</li>
				</ul>
				<p class="nova-guidance-note">These defaults offer modern AI capabilities without premium pricing.</p>
			</div>
		`;
    this.createOllamaSettings(providerContainer);
    this.createClaudeSettings(providerContainer);
    this.createGoogleSettings(providerContainer);
    this.createOpenAISettings(providerContainer);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian6.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian6.Setting(claudeContainer).setName("Model").setDesc("Claude model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateClaudeModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4-20250514").onChange(async (value) => {
        this.plugin.settings.aiProviders.claude.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateClaudeModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("claude");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    new import_obsidian6.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian6.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateOpenAIModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4.1-mini-2025-04-14").onChange(async (value) => {
        this.plugin.settings.aiProviders.openai.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateOpenAIModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("openai");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian6.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian6.Setting(googleContainer).setName("Model").setDesc("Gemini model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateGoogleModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-04-17").onChange(async (value) => {
        this.plugin.settings.aiProviders.google.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateGoogleModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("google");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian6.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian6.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Platform Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    platformContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = platformContainer.style.display !== "none";
      platformContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian6.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian6.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian6.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Custom Commands" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = commandContainer.style.display !== "none";
      commandContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian6.Setting(commandContainer).setName("Show Command Button in Chat").setDesc("Show the Commands button beside the Send button for quick command access").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian6.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(commandContainer);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian8 = require("obsidian");

// src/ai/providers/claude.ts
var import_obsidian7 = require("obsidian");
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-5-haiku-latest",
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
      system: options == null ? void 0 : options.systemPrompt,
      messages: messages.map((msg) => ({
        role: msg.role === "assistant" ? "assistant" : "user",
        content: msg.content
      }))
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await (0, import_obsidian7.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": this.config.apiKey,
            "anthropic-version": "2023-06-01"
          },
          body: requestBody
        });
        if (response.status === 200) {
          const data = response.json;
          return data.content[0].text;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`Claude API error: ${response.status} - ${response.text}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && (error.message.includes("Network error") || error.message.includes("Failed to connect"))) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        if (error instanceof Error && error.message.startsWith("Claude API error:")) {
          throw error;
        }
        throw new Error(`Failed to connect to Claude API: ${error instanceof Error ? error.message : "Network error"}`);
      }
    }
    throw new Error("Claude API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    const result = await this.chatCompletion(messages, options);
    yield { content: result, done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await (0, import_obsidian7.requestUrl)({
        url: "https://api.anthropic.com/v1/messages",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-5-haiku-latest",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (response.status !== 200) {
        throw new Error(`API key validation failed: ${response.status} - ${response.text}`);
      }
      const models = [
        "claude-opus-4-20250514",
        "claude-sonnet-4-20250514",
        "claude-3-7-sonnet-latest",
        "claude-3-5-sonnet-latest",
        "claude-3-5-haiku-latest"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
      messages: requestMessages,
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${this.config.apiKey}`
          },
          body: requestBody
        });
        if (response.ok) {
          const data = await response.json();
          return data.choices[0].message.content;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`OpenAI API error: ${response.statusText}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && error.message.includes("fetch")) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw error;
      }
    }
    throw new Error("OpenAI API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gpt-4.1-2025-04-14",
        "gpt-4.1-mini-2025-04-14",
        "gpt-4.1-nano-2025-04-14",
        "gpt-4o",
        "gpt-4o-mini"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.candidates[0].content.parts[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gemini-2.5-flash-preview-04-17",
        "gemini-2.5-pro-preview-03-25",
        "gemini-2.0-flash",
        "gemini-2.0-flash-lite"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian8.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async getCurrentProviderType() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return providerType;
      }
    }
    return null;
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    if (import_obsidian8.Platform.isMobile) {
      return ["claude", "openai", "google"];
    }
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
};

// src/core/document-engine.ts
var import_obsidian9 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance
   */
  getActiveEditor() {
    const activeEditor = this.app.workspace.activeEditor;
    if (activeEditor == null ? void 0 : activeEditor.editor) {
      return activeEditor.editor;
    }
    let view = this.app.workspace.getActiveViewOfType(import_obsidian9.MarkdownView);
    if (!view) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of leaves) {
        const leafView = leaf.view;
        if (leafView instanceof import_obsidian9.MarkdownView) {
          view = leafView;
          break;
        }
      }
    }
    if (!view) {
      return null;
    }
    const editor = view.editor;
    return editor || null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at cursor location
   */
  async deleteContent(target) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor() {
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: 0.7,
      maxTokens: 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents at their cursor position. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Work at the user's cursor position - every edit happens where they are focused
- Do not add headers unless specifically requested
- Focus on the user's immediate editing context`;
    const actionSpecificPrompts = {
      "add": `

ACTION: ADD CONTENT
- Generate new content to insert at the specified location
- Match the style and tone of surrounding content
- Ensure proper formatting and structure`,
      "edit": `

ACTION: EDIT CONTENT  
- Improve, modify, or enhance the specified content
- Preserve the original intent while following user instructions
- Apply style, tone, or structural changes as requested`,
      "delete": `

ACTION: DELETE CONTENT
- Confirm what should be deleted by providing the exact text to remove
- Be precise about deletion boundaries
- Respond "CONFIRMED" if the deletion is clear`,
      "grammar": `

ACTION: GRAMMAR & SPELLING
- Fix grammar, spelling, and punctuation errors
- Improve clarity while preserving meaning
- Maintain the original tone and style`,
      "rewrite": `

ACTION: REWRITE CONTENT
- Generate alternative content that serves the same purpose
- Apply requested style, tone, or structural changes
- Create fresh content while maintaining core meaning`,
      "metadata": `

ACTION: UPDATE METADATA
- Modify frontmatter properties, tags, or document metadata
- Follow YAML formatting conventions
- Update only the specified metadata fields`
    };
    return basePrompt + (actionSpecificPrompts[action] || "");
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += `DOCUMENT STRUCTURE:
`;
      const structure = this.buildDocumentStructure(documentContext.headings);
      context += structure + "\n";
    }
    context += this.buildTargetContext(command, documentContext);
    if (conversationContext && config.includeHistory) {
      context += `
CONVERSATION CONTEXT:
${conversationContext}
`;
    }
    context += `
FULL DOCUMENT:
${documentContext.content}
`;
    return context;
  }
  /**
   * Build target-specific context
   */
  buildTargetContext(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return `
SELECTED TEXT:
${documentContext.selectedText}
`;
        }
        return `
No text currently selected.
`;
      case "cursor":
        if (documentContext.surroundingLines) {
          const context = `
CURSOR CONTEXT:
`;
          const before = documentContext.surroundingLines.before.join("\n");
          const after = documentContext.surroundingLines.after.join("\n");
          return context + `Before cursor:
${before}

After cursor:
${after}
`;
        }
        return `
Cursor position context not available.
`;
      case "document":
        return `
Targeting entire document.
`;
      case "end":
        return `
Targeting end of document.
`;
      default:
        return `
Working at cursor position.
`;
    }
  }
  /**
   * Build user prompt with instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = contextInfo;
    prompt2 += `
USER REQUEST: ${command.instruction}
`;
    if (command.context) {
      prompt2 += `ADDITIONAL REQUIREMENTS: ${command.context}
`;
    }
    prompt2 += this.getFocusInstructions(command);
    prompt2 += this.getOutputInstructions(command);
    return prompt2;
  }
  /**
   * Get focus instructions based on target
   */
  getFocusInstructions(command) {
    const actionGuidance = {
      "add": "Add new content",
      "edit": "Modify existing content",
      "delete": "Remove specified content",
      "rewrite": "Generate alternative content",
      "grammar": "Fix grammar and spelling",
      "metadata": "Update document metadata"
    };
    switch (command.target) {
      case "selection":
        return `
FOCUS: ${actionGuidance[command.action]} in the selected text.
`;
      case "cursor":
        return `
FOCUS: ${actionGuidance[command.action]} at the current cursor position.
`;
      case "document":
        return `
FOCUS: ${actionGuidance[command.action]} for the entire document.
`;
      case "end":
        return `
FOCUS: Add content at the very end of the document, after all existing content. Ensure it flows naturally.
`;
      default:
        return `
FOCUS: ${actionGuidance[command.action]} at the cursor position.
`;
    }
  }
  /**
   * Get output instructions based on action
   */
  getOutputInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide the corrected version with proper grammar and spelling.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return "OUTPUT: Provide the updated metadata in proper YAML format.";
      default:
        return "OUTPUT: Provide only the requested content changes.";
    }
  }
  /**
   * Build document structure from headings
   */
  buildDocumentStructure(headings) {
    return headings.map((heading) => {
      const indent = "  ".repeat(heading.level - 1);
      return `${indent}- ${heading.text}`;
    }).join("\n");
  }
  /**
   * Validate generated prompt
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    if (prompt2.userPrompt.length > 1e4) {
      issues.push("User prompt is too long (>10000 characters)");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include|append|prepend)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert|append|prepend)\b(?!\s+.*\b(better|clearer|more|less)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i,
      // Specific patterns for append/prepend with location
      /\b(append|add)\b.*\b(after|following)\b/i,
      /\b(prepend|add)\b.*\b(before|preceding)\b/i
    ],
    targets: ["end"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection"]
  },
  {
    action: "metadata",
    patterns: [
      /\b(update|set|change|modify|add)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      /\b(add|remove|update)\s+.*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  }
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const context = this.extractContext(input);
    return {
      action,
      target,
      instruction: input,
      // Keep original input for display
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input (simplified for cursor-only editing)
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return "end";
      case "edit":
        return hasSelection ? "selection" : "cursor";
      case "delete":
        return hasSelection ? "selection" : "cursor";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return "end";
      case "metadata":
        return "document";
      default:
        return "cursor";
    }
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add content at cursor",
        "Fix grammar in this document",
        "Add conclusion at end",
        "Create a summary"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new content";
        break;
      case "metadata":
        description = "Update document metadata";
        break;
    }
    switch (target) {
      case "selection":
        description += " in selected text";
        break;
      case "cursor":
        description += " at cursor position";
        break;
      case "document":
        description += " in entire document";
        break;
      case "end":
        description += " at end of document";
        break;
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const lowerMessage = message.toLowerCase().trim();
    if (lowerMessage.startsWith(":")) {
      return true;
    }
    const actionVerbs = [
      "add",
      "insert",
      "append",
      "prepend",
      "include",
      "create",
      "write",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "replace",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "drop",
      "fix",
      "correct",
      "proofread",
      "polish",
      "check",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const startsWithAction = actionVerbs.some((verb) => {
      const verbPattern = new RegExp(`^${verb}\\b`, "i");
      return verbPattern.test(lowerMessage);
    });
    if (startsWithAction) {
      const questionIndicators = [
        /^(how|what|why|when|where|which|who|can|could|should|would|will|is|are|am|do|does|did)/i,
        /\?/,
        // Contains question mark
        /\b(help|advice|suggest|recommend|think|opinion)\b/i
      ];
      const isQuestion = questionIndicators.some((pattern) => pattern.test(lowerMessage));
      if (isQuestion) {
        return false;
      }
      return true;
    }
    const explicitCommandPatterns = [
      // Grammar/spelling commands that don't start with action verbs
      /\b(grammar|spell|spelling|proofread|polish)\b.*\b(check|fix|correct)\b/i,
      // Metadata commands with different structures
      /\bset\s+(the\s+)?(title|tags|metadata|properties)/i,
      /\bupdate\s+(the\s+)?(title|tags|metadata|properties)/i
    ];
    for (const pattern of explicitCommandPatterns) {
      if (pattern.test(lowerMessage)) {
        return true;
      }
    }
    return false;
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    return this.contextBuilder.buildConversationPrompt(message, documentContext, recentHistory);
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    return this.contextBuilder.buildSimplePrompt(instruction, context);
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.contextBuilder.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.contextBuilder.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "insert"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyAddition(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        } else {
          await this.documentEngine.addAssistantMessage("Content added successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Apply addition based on command target
   */
  async applyAddition(command, documentContext, content) {
    switch (command.target) {
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return await this.documentEngine.applyEdit(
            content,
            "cursor",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        }
      default:
        return {
          success: false,
          error: `Invalid add target: ${command.target}`,
          editType: "insert"
        };
    }
  }
  /**
   * Validate add command
   */
  validateCommand(command) {
    if (command.action !== "add") {
      return {
        valid: false,
        error: "Command action must be add"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Add instruction is required"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyEdit(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        } else {
          await this.documentEngine.addAssistantMessage("Content edited successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for editing",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid edit target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to edit"
      };
    }
    if (command.action !== "edit") {
      return {
        valid: false,
        error: "Command action must be edit"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Edit instruction is required"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        if (result.success) {
          await this.documentEngine.addAssistantMessage("Content deleted successfully", result);
        } else {
          await this.documentEngine.addAssistantMessage("Failed to delete content", result);
        }
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "cursor":
        return await this.documentEngine.deleteContent("line");
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end - use cursor or selection instead",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: `Invalid delete target: ${command.target}`,
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to delete"
      };
    }
    if (command.action !== "delete") {
      return {
        valid: false,
        error: "Command action must be delete"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to fix grammar", result2);
          return result2;
        }
        const result = await this.applyGrammarFix(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to fix grammar", result);
        } else {
          await this.documentEngine.addAssistantMessage("Grammar fixed successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar fix based on command target
   */
  async applyGrammarFix(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for grammar correction",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "cursor":
        return {
          success: false,
          error: 'Please select text to correct grammar, or use "document" to fix entire document',
          editType: "replace"
        };
      case "end":
        return {
          success: false,
          error: 'Grammar correction requires selecting text or specifying "document"',
          editType: "replace"
        };
      default:
        return {
          success: false,
          error: `Invalid grammar target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command
   */
  validateCommand(command, hasSelection) {
    if (command.action !== "grammar") {
      return {
        valid: false,
        error: "Command action must be grammar"
      };
    }
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to correct grammar"
      };
    }
    if (command.target !== "selection" && command.target !== "document") {
      return {
        valid: false,
        error: "Grammar correction requires selecting text or targeting entire document"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate rewrite", result2);
          return result2;
        }
        const result = await this.applyRewrite(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        } else {
          await this.documentEngine.addAssistantMessage("Content rewritten successfully", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, content) {
    switch (command.target) {
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for rewriting",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid rewrite target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command
   */
  validateCommand(command) {
    if (command.action !== "rewrite") {
      return {
        valid: false,
        error: "Command action must be rewrite"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Rewrite instruction is required"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Commands (unified) - 2 month early access
  "commands": {
    supernovaDate: "2025-07-31",
    // Supernova early access
    generalDate: "2025-09-30",
    // General availability 
    description: "Command system with : triggers, command button, and custom commands"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context",
  // Current document context
  "multi-doc-context"
  // Reference other documents with [[doc]] syntax
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Supernova status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsSupernova() && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian10.Plugin {
  async onload() {
    try {
      console.log("Nova: onload starting...");
      await this.loadSettings();
      console.log("Nova: settings loaded");
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      console.log("Nova: feature manager initialized");
      this.app.workspace.onLayoutReady(() => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
      });
      (0, import_obsidian10.addIcon)("nova-star", NOVA_ICON_SVG2);
      console.log("Nova: icon registered");
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      console.log("Nova: AI provider manager initialized");
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder();
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      console.log("Nova: document engine and commands initialized");
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      console.log("Nova: view registered");
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      console.log("Nova: ribbon icon added");
      console.log("Nova: ribbon icon element:", ribbonIcon);
      console.log("Nova: ribbon icon innerHTML:", ribbonIcon.innerHTML);
      console.log("Nova: ribbon icon classList:", ribbonIcon.classList.toString());
      this.addCommand({
        id: "nova-add-content",
        name: "Nova: Add content",
        editorCallback: async (editor, ctx) => {
          await this.handleAddCommand();
        }
      });
      this.addCommand({
        id: "nova-edit-content",
        name: "Nova: Edit content",
        editorCallback: async (editor, ctx) => {
          await this.handleEditCommand();
        }
      });
      this.addCommand({
        id: "nova-delete-content",
        name: "Nova: Delete content",
        editorCallback: async (editor, ctx) => {
          await this.handleDeleteCommand();
        }
      });
      this.addCommand({
        id: "nova-fix-grammar",
        name: "Nova: Fix grammar",
        editorCallback: async (editor, ctx) => {
          await this.handleGrammarCommand();
        }
      });
      this.addCommand({
        id: "nova-rewrite-content",
        name: "Nova: Rewrite content",
        editorCallback: async (editor, ctx) => {
          await this.handleRewriteCommand();
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      console.log("Nova: commands registered");
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
      console.log("Nova: settings tab added");
      console.log("Nova: onload completed successfully");
    } catch (error) {
      console.error("Nova: Error in onload:", error);
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle add content command with user input
   */
  async handleAddCommand() {
    const instruction = await this.promptForInstruction("What would you like to add?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.addCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content added successfully");
      } else {
        new import_obsidian10.Notice(`Failed to add content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle edit content command with user input
   */
  async handleEditCommand() {
    const instruction = await this.promptForInstruction("How would you like to edit the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.editCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content edited successfully");
      } else {
        new import_obsidian10.Notice(`Failed to edit content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle delete content command with user input
   */
  async handleDeleteCommand() {
    const instruction = await this.promptForInstruction("What would you like to delete?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.deleteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content deleted successfully");
      } else {
        new import_obsidian10.Notice(`Failed to delete content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle grammar correction command
   */
  async handleGrammarCommand() {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      new import_obsidian10.Notice("No active document found");
      return;
    }
    let target = "document";
    let instruction = "Fix grammar and spelling errors";
    if (documentContext.selectedText) {
      target = "selection";
      instruction = "Fix grammar and spelling errors in the selected text";
    }
    try {
      const command = {
        action: "grammar",
        target,
        instruction
      };
      const result = await this.grammarCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Grammar corrected successfully");
      } else {
        new import_obsidian10.Notice(`Failed to correct grammar: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle rewrite content command with user input
   */
  async handleRewriteCommand() {
    const instruction = await this.promptForInstruction("How would you like to rewrite the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.rewriteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content rewritten successfully");
      } else {
        new import_obsidian10.Notice(`Failed to rewrite content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Prompt user for instruction input
   */
  async promptForInstruction(placeholder) {
    return new Promise((resolve) => {
      const modal = document.createElement("div");
      modal.className = "modal nova-input-modal";
      modal.innerHTML = `
				<div class="modal-container">
					<div class="modal-bg" onclick="this.parentElement.parentElement.remove(); resolve(null);"></div>
					<div class="modal-content">
						<div class="modal-header">
							<h3>Nova AI Command</h3>
							<button class="modal-close-button" onclick="this.closest('.modal').remove(); resolve(null);">\xD7</button>
						</div>
						<div class="modal-body">
							<input type="text" class="nova-instruction-input" placeholder="${placeholder}" autofocus>
						</div>
						<div class="modal-footer">
							<button class="mod-cta nova-submit-btn">Execute</button>
							<button class="nova-cancel-btn">Cancel</button>
						</div>
					</div>
				</div>
			`;
      const input = modal.querySelector(".nova-instruction-input");
      const submitBtn = modal.querySelector(".nova-submit-btn");
      const cancelBtn = modal.querySelector(".nova-cancel-btn");
      const handleSubmit = () => {
        const value = input.value.trim();
        modal.remove();
        resolve(value || null);
      };
      const handleCancel = () => {
        modal.remove();
        resolve(null);
      };
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          handleSubmit();
        } else if (e.key === "Escape") {
          e.preventDefault();
          handleCancel();
        }
      });
      submitBtn.addEventListener("click", handleSubmit);
      cancelBtn.addEventListener("click", handleCancel);
      document.body.appendChild(modal);
      input.focus();
    });
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian10.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvYWkvbW9kZWxzLnRzIiwgInNyYy91aS9pbnB1dC1oYW5kbGVyLnRzIiwgInNyYy91aS93aWtpbGluay1zdWdnZXN0LnRzIiwgInNyYy91aS9jb21tYW5kLXN5c3RlbS50cyIsICJzcmMvdWkvY29udGV4dC1tYW5hZ2VyLnRzIiwgInNyYy91aS9jaGF0LXJlbmRlcmVyLnRzIiwgInNyYy9haS9wcm92aWRlci1tYW5hZ2VyLnRzIiwgInNyYy9haS9wcm92aWRlcnMvY2xhdWRlLnRzIiwgInNyYy9haS9wcm92aWRlcnMvb3BlbmFpLnRzIiwgInNyYy9haS9wcm92aWRlcnMvZ29vZ2xlLnRzIiwgInNyYy9haS9wcm92aWRlcnMvb2xsYW1hLnRzIiwgInNyYy9jb3JlL2RvY3VtZW50LWVuZ2luZS50cyIsICJzcmMvY29yZS9jb252ZXJzYXRpb24tbWFuYWdlci50cyIsICJzcmMvY29yZS9jb250ZXh0LWJ1aWxkZXIudHMiLCAic3JjL2NvcmUvY29tbWFuZC1wYXJzZXIudHMiLCAic3JjL2NvcmUvcHJvbXB0LWJ1aWxkZXIudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvYWRkLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZWRpdC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2RlbGV0ZS1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9yZXdyaXRlLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZC50cyIsICJzcmMvbGljZW5zaW5nL2ZlYXR1cmUtY29uZmlnLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyLnRzIiwgInNyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3IudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgV29ya3NwYWNlTGVhZiwgSXRlbVZpZXcsIGFkZEljb24sIE5vdGljZSwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzLCBOb3ZhU2V0dGluZ1RhYiwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBOb3ZhU2lkZWJhclZpZXcsIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgfSBmcm9tICcuL3NyYy91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL3NyYy9jb3JlL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IFByb21wdEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL3Byb21wdC1idWlsZGVyJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IEFkZENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgRGVsZXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgR3JhbW1hckNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZCc7XG5pbXBvcnQgeyBSZXdyaXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kJztcbmltcG9ydCB7IE1ldGFkYXRhQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZCc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3NyYy91aS93aWtpbGluay1zdWdnZXN0JztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3ZhUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBOb3ZhU2V0dGluZ3M7XG5cdGFpUHJvdmlkZXJNYW5hZ2VyITogQUlQcm92aWRlck1hbmFnZXI7XG5cdGRvY3VtZW50RW5naW5lITogRG9jdW1lbnRFbmdpbmU7XG5cdGNvbnRleHRCdWlsZGVyITogQ29udGV4dEJ1aWxkZXI7XG5cdGNvbW1hbmRQYXJzZXIhOiBDb21tYW5kUGFyc2VyO1xuXHRwcm9tcHRCdWlsZGVyITogUHJvbXB0QnVpbGRlcjtcblx0Y29udmVyc2F0aW9uTWFuYWdlciE6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG5cdGFkZENvbW1hbmRIYW5kbGVyITogQWRkQ29tbWFuZDtcblx0ZWRpdENvbW1hbmRIYW5kbGVyITogRWRpdENvbW1hbmQ7XG5cdGRlbGV0ZUNvbW1hbmRIYW5kbGVyITogRGVsZXRlQ29tbWFuZDtcblx0Z3JhbW1hckNvbW1hbmRIYW5kbGVyITogR3JhbW1hckNvbW1hbmQ7XG5cdHJld3JpdGVDb21tYW5kSGFuZGxlciE6IFJld3JpdGVDb21tYW5kO1xuXHRtZXRhZGF0YUNvbW1hbmRIYW5kbGVyITogTWV0YWRhdGFDb21tYW5kO1xuXHRmZWF0dXJlTWFuYWdlciE6IEZlYXR1cmVNYW5hZ2VyO1xuXHRsaWNlbnNlVmFsaWRhdG9yITogTGljZW5zZVZhbGlkYXRvcjtcblx0c2V0dGluZ1RhYiE6IE5vdmFTZXR0aW5nVGFiO1xuXHRzaWRlYmFyVmlldyE6IE5vdmFTaWRlYmFyVmlldztcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBvbmxvYWQgc3RhcnRpbmcuLi4nKTtcblx0XHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgbG9hZGVkJyk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgbGljZW5zaW5nIHN5c3RlbVxuXHRcdFx0dGhpcy5saWNlbnNlVmFsaWRhdG9yID0gbmV3IExpY2Vuc2VWYWxpZGF0b3IoKTtcblx0XHRcdHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBuZXcgRmVhdHVyZU1hbmFnZXIoXG5cdFx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvcixcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5nc1xuXHRcdFx0KTtcblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIGxpY2Vuc2UgZnJvbSBzZXR0aW5nc1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5mZWF0dXJlTWFuYWdlci51cGRhdGVTdXBlcm5vdmFMaWNlbnNlKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpO1xuXHRcdFx0fVxuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGZlYXR1cmUgbWFuYWdlciBpbml0aWFsaXplZCcpO1xuXG5cdFx0XHQvLyBSZWZyZXNoIFN1cGVybm92YSBVSSBhZnRlciBsaWNlbnNlIHZhbGlkYXRpb24gdG8gaGFuZGxlIGV4cGlyZWQgbGljZW5zZXNcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcblx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBOb3RlOiBNb2JpbGUgYWNjZXNzIHJlc3RyaWN0aW9ucyBhcmUgbm93IGhhbmRsZWQgaW4gc2lkZWJhciBVSVxuXHRcdFx0Ly8gVGhpcyBhbGxvd3MgQ29yZSBtb2JpbGUgdXNlcnMgdG8gc2VlIHRoZSB1cGdyYWRlIGludGVyZmFjZSByYXRoZXIgdGhhbiBhIGJyb2tlbiBwbHVnaW5cblxuXHRcdFx0Ly8gUmVnaXN0ZXIgY3VzdG9tIGljb25cblx0XHRcdGFkZEljb24oJ25vdmEtc3RhcicsIE5PVkFfSUNPTl9TVkcpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGljb24gcmVnaXN0ZXJlZCcpO1xuXG5cdFx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyID0gbmV3IEFJUHJvdmlkZXJNYW5hZ2VyKHRoaXMuc2V0dGluZ3MsIHRoaXMuZmVhdHVyZU1hbmFnZXIpO1xuXHRcdFx0YXdhaXQgdGhpcy5haVByb3ZpZGVyTWFuYWdlci5pbml0aWFsaXplKCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogQUkgcHJvdmlkZXIgbWFuYWdlciBpbml0aWFsaXplZCcpO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGFuZCBkb2N1bWVudCBlbmdpbmVcblx0XHRcdGNvbnN0IGRhdGFTdG9yZSA9IHtcblx0XHRcdFx0bG9hZERhdGE6IChrZXk6IHN0cmluZykgPT4gdGhpcy5sb2FkRGF0YVdpdGhLZXkoa2V5KSxcblx0XHRcdFx0c2F2ZURhdGE6IChrZXk6IHN0cmluZywgZGF0YTogYW55KSA9PiB0aGlzLnNhdmVEYXRhV2l0aEtleShrZXksIGRhdGEpXG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBuZXcgRG9jdW1lbnRFbmdpbmUodGhpcy5hcHAsIGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lLnNldENvbnZlcnNhdGlvbk1hbmFnZXIodGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdHRoaXMuY29udGV4dEJ1aWxkZXIgPSBuZXcgQ29udGV4dEJ1aWxkZXIoKTtcblx0XHRcdHRoaXMuY29tbWFuZFBhcnNlciA9IG5ldyBDb21tYW5kUGFyc2VyKCk7XG5cdFx0XHR0aGlzLnByb21wdEJ1aWxkZXIgPSBuZXcgUHJvbXB0QnVpbGRlcih0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpO1xuXHRcdFx0XG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbW1hbmQgaW1wbGVtZW50YXRpb25zXG5cdFx0XHR0aGlzLmFkZENvbW1hbmRIYW5kbGVyID0gbmV3IEFkZENvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5lZGl0Q29tbWFuZEhhbmRsZXIgPSBuZXcgRWRpdENvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5kZWxldGVDb21tYW5kSGFuZGxlciA9IG5ldyBEZWxldGVDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZ3JhbW1hckNvbW1hbmRIYW5kbGVyID0gbmV3IEdyYW1tYXJDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMucmV3cml0ZUNvbW1hbmRIYW5kbGVyID0gbmV3IFJld3JpdGVDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMubWV0YWRhdGFDb21tYW5kSGFuZGxlciA9IG5ldyBNZXRhZGF0YUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGRvY3VtZW50IGVuZ2luZSBhbmQgY29tbWFuZHMgaW5pdGlhbGl6ZWQnKTtcblxuXHRcdFx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0XHRcdFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsXG5cdFx0XHRcdChsZWFmKSA9PiBuZXcgTm92YVNpZGViYXJWaWV3KGxlYWYsIHRoaXMpXG5cdFx0XHQpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHZpZXcgcmVnaXN0ZXJlZCcpO1xuXG5cdFx0XHQvLyBOb3RlOiBXaWtpbGluayBhdXRvY29tcGxldGUgaXMgbm93IGhhbmRsZWQgZGlyZWN0bHkgaW4gc2lkZWJhciB2aWV3XG5cblx0XHRcdGNvbnN0IHJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ25vdmEtc3RhcicsICdOb3ZhIEFJJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0fSk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gYWRkZWQnKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBlbGVtZW50OicsIHJpYmJvbkljb24pO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGlubmVySFRNTDonLCByaWJib25JY29uLmlubmVySFRNTCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gY2xhc3NMaXN0OicsIHJpYmJvbkljb24uY2xhc3NMaXN0LnRvU3RyaW5nKCkpO1xuXG5cdFx0XHQvLyBSZWdpc3RlciBjb3JlIGRvY3VtZW50IGVkaXRpbmcgY29tbWFuZHNcblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1hZGQtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBBZGQgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlQWRkQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWVkaXQtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBFZGl0IGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUVkaXRDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtZGVsZXRlLWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogRGVsZXRlIGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZURlbGV0ZUNvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1maXgtZ3JhbW1hcicsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBGaXggZ3JhbW1hcicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlR3JhbW1hckNvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1yZXdyaXRlLWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogUmV3cml0ZSBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVSZXdyaXRlQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdvcGVuLW5vdmEtc2lkZWJhcicsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBPcGVuIHNpZGViYXInLFxuXHRcdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGNvbW1hbmRzIHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0dGhpcy5zZXR0aW5nVGFiID0gbmV3IE5vdmFTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKTtcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nVGFiKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBzZXR0aW5ncyB0YWIgYWRkZWQnKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBvbmxvYWQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdOb3ZhOiBFcnJvciBpbiBvbmxvYWQ6JywgZXJyb3IpO1xuXHRcdH1cblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXI/LmNsZWFudXAoKTtcblx0XHR0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXI/LmNsZWFudXAoKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXI/LnVwZGF0ZVNldHRpbmdzKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0YXN5bmMgYWN0aXZhdGVWaWV3KCkge1xuXHRcdGNvbnN0IHsgd29ya3NwYWNlIH0gPSB0aGlzLmFwcDtcblxuXHRcdGxldCBsZWFmOiBXb3Jrc3BhY2VMZWFmIHwgbnVsbDtcblx0XHRjb25zdCBsZWF2ZXMgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXG5cdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRsZWFmID0gbGVhdmVzWzBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG5cdFx0XHRhd2FpdCBsZWFmPy5zZXRWaWV3U3RhdGUoeyB0eXBlOiBWSUVXX1RZUEVfTk9WQV9TSURFQkFSLCBhY3RpdmU6IHRydWUgfSk7XG5cdFx0fVxuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZiEpO1xuXHRcdFxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSB0byBzaWRlYmFyIHZpZXdcblx0XHRpZiAobGVhZj8udmlldyBpbnN0YW5jZW9mIE5vdmFTaWRlYmFyVmlldykge1xuXHRcdFx0dGhpcy5zaWRlYmFyVmlldyA9IGxlYWYudmlldztcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGFkZCBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUFkZENvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW5zdHJ1Y3Rpb24gPSBhd2FpdCB0aGlzLnByb21wdEZvckluc3RydWN0aW9uKCdXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGFkZD8nKTtcblx0XHRpZiAoIWluc3RydWN0aW9uKSByZXR1cm47XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKGRvY3VtZW50Q29udGV4dD8uc2VsZWN0ZWRUZXh0KTtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGluc3RydWN0aW9uLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBhZGRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBhZGQgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZWRpdCBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUVkaXRDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignSG93IHdvdWxkIHlvdSBsaWtlIHRvIGVkaXQgdGhlIGNvbnRlbnQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdDb250ZW50IGVkaXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBlZGl0IGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGRlbGV0ZSBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZURlbGV0ZUNvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW5zdHJ1Y3Rpb24gPSBhd2FpdCB0aGlzLnByb21wdEZvckluc3RydWN0aW9uKCdXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGRlbGV0ZT8nKTtcblx0XHRpZiAoIWluc3RydWN0aW9uKSByZXR1cm47XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKGRvY3VtZW50Q29udGV4dD8uc2VsZWN0ZWRUZXh0KTtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGluc3RydWN0aW9uLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBkZWxldGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBncmFtbWFyIGNvcnJlY3Rpb24gY29tbWFuZFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVHcmFtbWFyQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG5cdFx0XHRuZXcgTm90aWNlKCdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBEZXRlcm1pbmUgdGFyZ2V0IGJhc2VkIG9uIHNlbGVjdGlvblxuXHRcdGxldCB0YXJnZXQ6ICdzZWxlY3Rpb24nIHwgJ2RvY3VtZW50JyA9ICdkb2N1bWVudCc7XG5cdFx0bGV0IGluc3RydWN0aW9uID0gJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZyBlcnJvcnMnO1xuXHRcdFxuXHRcdGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG5cdFx0XHR0YXJnZXQgPSAnc2VsZWN0aW9uJztcblx0XHRcdGluc3RydWN0aW9uID0gJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZyBlcnJvcnMgaW4gdGhlIHNlbGVjdGVkIHRleHQnO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBjb21tYW5kID0ge1xuXHRcdFx0XHRhY3Rpb246ICdncmFtbWFyJyBhcyBjb25zdCxcblx0XHRcdFx0dGFyZ2V0LFxuXHRcdFx0XHRpbnN0cnVjdGlvblxuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0dyYW1tYXIgY29ycmVjdGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGNvcnJlY3QgZ3JhbW1hcjogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgcmV3cml0ZSBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVJld3JpdGVDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignSG93IHdvdWxkIHlvdSBsaWtlIHRvIHJld3JpdGUgdGhlIGNvbnRlbnQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucmV3cml0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdDb250ZW50IHJld3JpdHRlbiBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUHJvbXB0IHVzZXIgZm9yIGluc3RydWN0aW9uIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHByb21wdEZvckluc3RydWN0aW9uKHBsYWNlaG9sZGVyOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRtb2RhbC5jbGFzc05hbWUgPSAnbW9kYWwgbm92YS1pbnB1dC1tb2RhbCc7XG5cdFx0XHRtb2RhbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250YWluZXJcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYmdcIiBvbmNsaWNrPVwidGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7IHJlc29sdmUobnVsbCk7XCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj5cblx0XHRcdFx0XHRcdFx0PGgzPk5vdmEgQUkgQ29tbWFuZDwvaDM+XG5cdFx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJtb2RhbC1jbG9zZS1idXR0b25cIiBvbmNsaWNrPVwidGhpcy5jbG9zZXN0KCcubW9kYWwnKS5yZW1vdmUoKTsgcmVzb2x2ZShudWxsKTtcIj5cdTAwRDc8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cblx0XHRcdFx0XHRcdFx0PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJub3ZhLWluc3RydWN0aW9uLWlucHV0XCIgcGxhY2Vob2xkZXI9XCIke3BsYWNlaG9sZGVyfVwiIGF1dG9mb2N1cz5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kLWN0YSBub3ZhLXN1Ym1pdC1idG5cIj5FeGVjdXRlPC9idXR0b24+XG5cdFx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJub3ZhLWNhbmNlbC1idG5cIj5DYW5jZWw8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IGlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtaW5zdHJ1Y3Rpb24taW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXHRcdFx0Y29uc3Qgc3VibWl0QnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtc3VibWl0LWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdFx0Y29uc3QgY2FuY2VsQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtY2FuY2VsLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXG5cdFx0XHRjb25zdCBoYW5kbGVTdWJtaXQgPSAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWUudHJpbSgpO1xuXHRcdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHRcdFx0cmVzb2x2ZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdH07XG5cblx0XHRcdGNvbnN0IGhhbmRsZUNhbmNlbCA9ICgpID0+IHtcblx0XHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0XHRcdHJlc29sdmUobnVsbCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcblx0XHRcdFx0aWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGhhbmRsZVN1Ym1pdCgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRoYW5kbGVDYW5jZWwoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVN1Ym1pdCk7XG5cdFx0XHRjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDYW5jZWwpO1xuXG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcblx0XHRcdGlucHV0LmZvY3VzKCk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogU2hvdyB1cGdyYWRlIHByb21wdCBmb3IgQ29yZSB0aWVyIG1vYmlsZSB1c2Vyc1xuXHQgKi9cblx0cHJpdmF0ZSBzaG93TW9iaWxlVXBncmFkZVByb21wdCgpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdG1vZGFsLmNsYXNzTmFtZSA9ICdtb2RhbCBub3ZhLW1vYmlsZS11cGdyYWRlLW1vZGFsJztcblx0XHRtb2RhbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1iZ1wiPjwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj5cblx0XHRcdFx0XHRcdDxoMz5Ob3ZhIFN1cGVyTm92YSBSZXF1aXJlZDwvaDM+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpZXItYmFkZ2UgY29yZVwiIHN0eWxlPVwibWFyZ2luLWJvdHRvbTogMWVtO1wiPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItaWNvblwiPkZSRUU8L3NwYW4+XG5cdFx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwidGllci1uYW1lXCI+Q29yZSAoRnJlZSk8L3NwYW4+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxwPk1vYmlsZSBhY2Nlc3MgaXMgYXZhaWxhYmxlIHdpdGggTm92YSBTdXBlck5vdmEuPC9wPlxuXHRcdFx0XHRcdFx0PHA+Q29yZSB0aWVyIGlzIGxpbWl0ZWQgdG8gZGVza3RvcCB1c2Ugb25seS48L3A+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1mZWF0dXJlLWxpc3RcIj5cblx0XHRcdFx0XHRcdFx0PGg0PlN1cGVyTm92YSBpbmNsdWRlczo8L2g0PlxuXHRcdFx0XHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPk1vYmlsZSBkZXZpY2Ugc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPk11bHRpcGxlIEFJIHByb3ZpZGVyczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkluLWNoYXQgcHJvdmlkZXIgc3dpdGNoaW5nPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+QWR2YW5jZWQgdGVtcGxhdGVzPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+UHJpb3JpdHkgc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdDwvdWw+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kLWN0YSBub3ZhLXVwZ3JhZGUtYnRuXCI+VXBncmFkZSB0byBTdXBlck5vdmE8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJub3ZhLWNsb3NlLWJ0blwiPkNsb3NlPC9idXR0b24+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdGNvbnN0IHVwZ3JhZGVCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS11cGdyYWRlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IGNsb3NlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtY2xvc2UtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0Y29uc3QgbW9kYWxCZyA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1iZycpIGFzIEhUTUxFbGVtZW50O1xuXG5cdFx0Y29uc3QgY2xvc2VNb2RhbCA9ICgpID0+IHtcblx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdH07XG5cblx0XHR1cGdyYWRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0d2luZG93Lm9wZW4oJ2h0dHBzOi8vbm92YXdyaXRlci5haS91cGdyYWRlJywgJ19ibGFuaycpO1xuXHRcdFx0Y2xvc2VNb2RhbCgpO1xuXHRcdH0pO1xuXG5cdFx0Y2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcblx0XHRtb2RhbEJnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcblxuXHRcdC8vIFNob3cgbm90aWNlIGFzIHdlbGxcblx0XHRuZXcgTm90aWNlKCdOb3ZhIG1vYmlsZSBhY2Nlc3MgcmVxdWlyZXMgU3VwZXJOb3ZhIGxpY2Vuc2UnLCA4MDAwKTtcblx0fVxuXG5cdC8vIERhdGFTdG9yZSBpbnRlcmZhY2UgaW1wbGVtZW50YXRpb24gZm9yIENvbnZlcnNhdGlvbk1hbmFnZXJcblx0YXN5bmMgbG9hZERhdGFXaXRoS2V5KGtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcblx0XHRjb25zdCBhbGxEYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuXHRcdHJldHVybiBhbGxEYXRhID8gYWxsRGF0YVtrZXldIDogdW5kZWZpbmVkO1xuXHR9XG5cblx0YXN5bmMgc2F2ZURhdGFXaXRoS2V5KGtleTogc3RyaW5nLCBkYXRhOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhbGxEYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpIHx8IHt9O1xuXHRcdGFsbERhdGFba2V5XSA9IGRhdGE7XG5cdFx0cmV0dXJuIGF3YWl0IHRoaXMuc2F2ZURhdGEoYWxsRGF0YSk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgQUlQcm92aWRlclNldHRpbmdzLCBQbGF0Zm9ybVNldHRpbmdzLCBQcm92aWRlclR5cGUgfSBmcm9tICcuL2FpL3R5cGVzJztcbmltcG9ydCB7IERlYnVnU2V0dGluZ3MgfSBmcm9tICcuL2xpY2Vuc2luZy90eXBlcyc7XG5pbXBvcnQgeyBWSUVXX1RZUEVfTk9WQV9TSURFQkFSLCBOb3ZhU2lkZWJhclZpZXcgfSBmcm9tICcuL3VpL3NpZGViYXItdmlldyc7XG5pbXBvcnQgeyBnZXRBdmFpbGFibGVNb2RlbHMgfSBmcm9tICcuL2FpL21vZGVscyc7XG5cbmNvbnN0IE5PVkFfSUNPTl9TVkcgPSBgXG48c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPCEtLSBDZW50cmFsIHN0YXIgY29yZSAtLT5cbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuICBcbiAgPCEtLSBQcmltYXJ5IHJheXMgKDQgbWFpbiBkaXJlY3Rpb25zKSAtLT5cbiAgPHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIFxuICA8IS0tIFNlY29uZGFyeSByYXlzIChkaWFnb25hbHMpIC0tPlxuICA8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuPC9zdmc+YDtcblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21Db21tYW5kIHtcblx0aWQ6IHN0cmluZztcblx0bmFtZTogc3RyaW5nO1xuXHR0cmlnZ2VyOiBzdHJpbmc7XG5cdHRlbXBsYXRlOiBzdHJpbmc7XG5cdGRlc2NyaXB0aW9uPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5vdmFTZXR0aW5ncyB7XG5cdGFpUHJvdmlkZXJzOiBBSVByb3ZpZGVyU2V0dGluZ3M7XG5cdHBsYXRmb3JtU2V0dGluZ3M6IFBsYXRmb3JtU2V0dGluZ3M7XG5cdGN1c3RvbUNvbW1hbmRzPzogQ3VzdG9tQ29tbWFuZFtdO1xuXHRnZW5lcmFsOiB7XG5cdFx0ZGVmYXVsdFRlbXBlcmF0dXJlOiBudW1iZXI7XG5cdFx0ZGVmYXVsdE1heFRva2VuczogbnVtYmVyO1xuXHRcdGF1dG9TYXZlOiBib29sZWFuO1xuXHR9O1xuXHRzaG93Q29tbWFuZEJ1dHRvbjogYm9vbGVhbjtcblx0bGljZW5zaW5nOiB7XG5cdFx0bGljZW5zZUtleTogc3RyaW5nO1xuXHRcdHN1cGVybm92YUxpY2Vuc2VLZXk/OiBzdHJpbmc7XG5cdFx0aXNTdXBlcm5vdmE/OiBib29sZWFuO1xuXHRcdGRlYnVnU2V0dGluZ3M6IERlYnVnU2V0dGluZ3M7XG5cdH07XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBOb3ZhU2V0dGluZ3MgPSB7XG5cdGFpUHJvdmlkZXJzOiB7XG5cdFx0Y2xhdWRlOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0bW9kZWw6ICdjbGF1ZGUtMy01LXNvbm5ldC0yMDI0MTAyMicsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvcGVuYWk6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRiYXNlVXJsOiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScsXG5cdFx0XHRtb2RlbDogJ2dwdC00bycsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRnb29nbGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2dlbWluaS0xLjUtZmxhc2gnLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0b2xsYW1hOiB7XG5cdFx0XHRiYXNlVXJsOiAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCcsXG5cdFx0XHRtb2RlbDogJycsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fVxuXHR9LFxuXHRwbGF0Zm9ybVNldHRpbmdzOiB7XG5cdFx0ZGVza3RvcDoge1xuXHRcdFx0cHJpbWFyeVByb3ZpZGVyOiAnb2xsYW1hJyxcblx0XHRcdGZhbGxiYWNrUHJvdmlkZXJzOiBbJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ11cblx0XHR9LFxuXHRcdG1vYmlsZToge1xuXHRcdFx0cHJpbWFyeVByb3ZpZGVyOiAnbm9uZScsXG5cdFx0XHRmYWxsYmFja1Byb3ZpZGVyczogWydvcGVuYWknLCAnZ29vZ2xlJ11cblx0XHR9XG5cdH0sXG5cdGN1c3RvbUNvbW1hbmRzOiBbXSxcblx0Z2VuZXJhbDoge1xuXHRcdGRlZmF1bHRUZW1wZXJhdHVyZTogMC43LFxuXHRcdGRlZmF1bHRNYXhUb2tlbnM6IDEwMDAsXG5cdFx0YXV0b1NhdmU6IHRydWVcblx0fSxcblx0c2hvd0NvbW1hbmRCdXR0b246IHRydWUsXG5cdGxpY2Vuc2luZzoge1xuXHRcdGxpY2Vuc2VLZXk6ICcnLFxuXHRcdHN1cGVybm92YUxpY2Vuc2VLZXk6ICcnLFxuXHRcdGlzU3VwZXJub3ZhOiBmYWxzZSxcblx0XHRkZWJ1Z1NldHRpbmdzOiB7XG5cdFx0XHRlbmFibGVkOiBmYWxzZSxcblx0XHRcdG92ZXJyaWRlRGF0ZTogdW5kZWZpbmVkLFxuXHRcdFx0Zm9yY2VTdXBlcm5vdmE6IGZhbHNlXG5cdFx0fVxuXHR9XG59O1xuXG5leHBvcnQgY2xhc3MgTm92YVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBOb3ZhUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE5vdmFQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdOb3ZhIEFJIFNldHRpbmdzJyB9KTtcblxuXHRcdHRoaXMuY3JlYXRlTGljZW5zZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVHZW5lcmFsU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZUNvbW1hbmRTZXR0aW5ncygpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVMaWNlbnNlU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb25zdCBsaWNlbnNlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXNlY3Rpb24nIH0pO1xuXHRcdGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnU3VwZXJub3ZhIFN1cHBvcnRlciBTdGF0dXMnIH0pO1xuXG5cdFx0Ly8gSW5mbyBhYm91dCB0aGUgbmV3IG1vZGVsXG5cdFx0Y29uc3QgaW5mb0VsID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmQgY29tcGFjdFwiPlxuXHRcdFx0XHQ8cD5Ob3ZhIHByb3ZpZGVzIGFsbCBmZWF0dXJlcyBmb3IgZnJlZSB3aGVuIHlvdSB1c2UgeW91ciBvd24gQUkgcHJvdmlkZXIgQVBJIGtleXMuIFxuXHRcdFx0XHRTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gQ3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uaXNTdXBlcm5vdmFTdXBwb3J0ZXIoKSB8fCBmYWxzZTtcblx0XHRjb25zdCBzdXBlcm5vdmFMaWNlbnNlID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmdldFN1cGVybm92YUxpY2Vuc2UoKTtcblx0XHRcblx0XHRjb25zdCBzdGF0dXNEaXNwbGF5ID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1cGVybm92YS1zdGF0dXMnIH0pO1xuXHRcdGNvbnN0IHN0YXR1c1RleHQgPSBpc1N1cGVybm92YSA/ICdTdXBlcm5vdmEgU3VwcG9ydGVyJyA6ICdOb3ZhIFVzZXInO1xuXHRcdGNvbnN0IHN0YXR1c0ljb24gPSBpc1N1cGVybm92YSA/IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHlsZT1cIndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGNvbG9yOiAjOTMzM2VhOyBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCA0cHggcmdiYSgxNDcsIDUxLCAyMzQsIDAuNikpO1wiPlxuXHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdDwvc3ZnPmAgOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3R5bGU9XCJ3aWR0aDogMTRweDsgaGVpZ2h0OiAxNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1wiPlxuXHRcdFx0JHtOT1ZBX0lDT05fU1ZHfVxuXHRcdDwvc3ZnPmA7XG5cdFx0c3RhdHVzRGlzcGxheS5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1zdGF0dXMtYmFkZ2UgJHtpc1N1cGVybm92YSA/ICdzdXBlcm5vdmEnIDogJ25vdmEnfVwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInN0YXR1cy1pY29uXCI+JHtzdGF0dXNJY29ufTwvc3Bhbj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJzdGF0dXMtbmFtZVwiPiR7c3RhdHVzVGV4dH08L3NwYW4+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gU3VwZXJub3ZhIGxpY2Vuc2Ugc3RhdHVzXG5cdFx0aWYgKHN1cGVybm92YUxpY2Vuc2UpIHtcblx0XHRcdGNvbnN0IHN0YXR1c0VsID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxpY2Vuc2Utc3RhdHVzJyB9KTtcblx0XHRcdGNvbnN0IGV4cGlyeVRleHQgPSBzdXBlcm5vdmFMaWNlbnNlLmV4cGlyZXNBdCBcblx0XHRcdFx0PyBgRXhwaXJlczogJHtzdXBlcm5vdmFMaWNlbnNlLmV4cGlyZXNBdC50b0xvY2FsZURhdGVTdHJpbmcoKX1gXG5cdFx0XHRcdDogJ0xpZmV0aW1lIFN1cHBvcnQnO1xuXHRcdFx0c3RhdHVzRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibGljZW5zZS1pbmZvXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJsaWNlbnNlLWVtYWlsXCI+JHtzdXBlcm5vdmFMaWNlbnNlLmVtYWlsfTwvc3Bhbj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImxpY2Vuc2UtZXhwaXJ5XCI+JHtleHBpcnlUZXh0fTwvc3Bhbj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIGtleSBpbnB1dFxuXHRcdG5ldyBTZXR0aW5nKGxpY2Vuc2VDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnU3VwZXJub3ZhIExpY2Vuc2UgS2V5IChPcHRpb25hbCknKVxuXHRcdFx0LnNldERlc2MoJ0VudGVyIHlvdXIgU3VwZXJub3ZhIHN1cHBvcnRlciBsaWNlbnNlIGtleSBmb3IgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcycpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAncGFzc3dvcmQnO1xuXHRcdFx0XHR0ZXh0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBTdXBlcm5vdmEgbGljZW5zZSBrZXkuLi4nKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSB8fCAnJylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBpbiBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVTdXBlcm5vdmFMaWNlbnNlKHZhbHVlIHx8IG51bGwpO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggdGhlIGRpc3BsYXkgdG8gc2hvdyB1cGRhdGVkIHN0YXR1c1xuXHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBBZGQgdmFsaWRhdGlvbiBidXR0b25cblx0XHRcdFx0Y29uc3QgdmFsaWRhdGVCdXR0b24gPSB0ZXh0LmlucHV0RWwucGFyZW50RWxlbWVudD8uY3JlYXRlRWwoJ2J1dHRvbicsIHtcblx0XHRcdFx0XHR0ZXh0OiAnVmFsaWRhdGUnLFxuXHRcdFx0XHRcdGNsczogJ25vdmEtdmFsaWRhdGUtYnRuJ1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh2YWxpZGF0ZUJ1dHRvbikge1xuXHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgbGljZW5zZUtleSA9IHRleHQuaW5wdXRFbC52YWx1ZTtcblx0XHRcdFx0XHRcdGlmICghbGljZW5zZUtleSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnUGxlYXNlIGVudGVyIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IGZpcnN0LicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLnRleHRDb250ZW50ID0gJ1ZhbGlkYXRpbmcuLi4nO1xuXHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVTdXBlcm5vdmFMaWNlbnNlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNTdXBlcm5vdmFTdXBwb3J0ZXIoKTtcblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHRpZiAoaXNTdXBlcm5vdmEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdWYWxpZCBTdXBlcm5vdmEgbGljZW5zZSEgWW91IG5vdyBoYXZlIGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuJywgJ3N1Y2Nlc3MnKTtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0NvbmZldHRpKCk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdJbnZhbGlkIG9yIGV4cGlyZWQgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5LicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXIgdG8gdXBkYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXlcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0Vycm9yIHZhbGlkYXRpbmcgU3VwZXJub3ZhIGxpY2Vuc2UuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdWYWxpZGF0ZSc7XG5cdFx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0Ly8gU3VwZXJub3ZhIHN1cHBvcnRlciBpbmZvcm1hdGlvbiBvbmx5XG5cdFx0dGhpcy5jcmVhdGVTdXBlcm5vdmFJbmZvKGxpY2Vuc2VDb250YWluZXIpO1xuXG5cdFx0Ly8gRGVidWcgc2V0dGluZ3MgKGRldmVsb3BtZW50IG9ubHkpXG5cdFx0aWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnIHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdHRoaXMuY3JlYXRlRGVidWdTZXR0aW5ncyhsaWNlbnNlQ29udGFpbmVyKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVN1cGVybm92YUluZm8oY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdC8vIFN1cGVybm92YSBzdXBwb3J0ZXIgaW5mb3JtYXRpb25cblx0XHRjb25zdCBzdXBlcm5vdmFJbmZvID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VwZXJub3ZhLWluZm8nIH0pO1xuXHRcdHN1cGVybm92YUluZm8uaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoNT5CZWNvbWUgYSBTdXBlcm5vdmEgU3VwcG9ydGVyPC9oNT5cblx0XHRcdFx0PHA+U3VwcG9ydCBOb3ZhIGRldmVsb3BtZW50IGFuZCBnZXQgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy4gQWxsIGZlYXR1cmVzIGV2ZW50dWFsbHkgYmVjb21lIGZyZWUgZm9yIGV2ZXJ5b25lLjwvcD5cblx0XHRcdFx0PHVsPlxuXHRcdFx0XHRcdDxsaT5FYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzICgzLTYgbW9udGhzIGJlZm9yZSBnZW5lcmFsIHJlbGVhc2UpPC9saT5cblx0XHRcdFx0XHQ8bGk+UHJpb3JpdHkgc3VwcG9ydCBhbmQgZmVhdHVyZSByZXF1ZXN0czwvbGk+XG5cdFx0XHRcdFx0PGxpPlN1cHBvcnRlciBiYWRnZSBhbmQgcmVjb2duaXRpb248L2xpPlxuXHRcdFx0XHRcdDxsaT5EaXJlY3RseSBzdXBwb3J0IG9wZW4tc291cmNlIGRldmVsb3BtZW50PC9saT5cblx0XHRcdFx0PC91bD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZURlYnVnU2V0dGluZ3MoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdGNvbnN0IGRlYnVnQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtZGVidWctc2VjdGlvbicgfSk7XG5cdFx0ZGVidWdDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnRGV2ZWxvcG1lbnQgU2V0dGluZ3MnIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnRGVidWcgTW9kZScpXG5cdFx0XHQuc2V0RGVzYygnRW5hYmxlIGRldmVsb3BtZW50IHRlc3RpbmcgZmVhdHVyZXMnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheSB0byBzaG93L2hpZGUgZGVidWcgb3B0aW9uc1xuXHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCkge1xuXHRcdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKCdPdmVycmlkZSBEYXRlJylcblx0XHRcdFx0LnNldERlc2MoJ092ZXJyaWRlIGN1cnJlbnQgZGF0ZSBmb3IgdGVzdGluZyB0aW1lLWdhdGVkIGZlYXR1cmVzIChZWVlZLU1NLUREKScpXG5cdFx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignMjAyNS0xMi0wMScpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSB8fCAnJylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUgPSB2YWx1ZSB8fCB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBEb24ndCByZWZyZXNoIGRpc3BsYXkgb24gZXZlcnkga2V5c3Ryb2tlIC0ganVzdCB1cGRhdGUgdGhlIGZlYXR1cmUgbWFuYWdlclxuXHRcdFx0XHRcdH0pKTtcblxuXHRcdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKCdGb3JjZSBTdXBlcm5vdmEgU3RhdHVzJylcblx0XHRcdFx0LnNldERlc2MoJ092ZXJyaWRlIFN1cGVybm92YSBzdXBwb3J0ZXIgc3RhdHVzIGZvciB0ZXN0aW5nJylcblx0XHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhIHx8IGZhbHNlKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBTaG93IGNvbmZldHRpIHdoZW4gdHVybmluZyBPTiBGb3JjZSBTdXBlcm5vdmFcblx0XHRcdFx0XHRcdGlmICh2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNob3dDb25mZXR0aSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXIgdG8gdXBkYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheSB0byBzaG93IHVwZGF0ZWQgZmVhdHVyZSBzdGF0dXNcblx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdH0pKTtcblxuXHRcdFx0Ly8gQ2xlYXIgbGljZW5zZXMgYnV0dG9uXG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ0NsZWFyIEFsbCBMaWNlbnNlcycpXG5cdFx0XHRcdC5zZXREZXNjKCdSZW1vdmUgYWxsIGFwcGxpZWQgbGljZW5zZXMgKGZvciB0ZXN0aW5nKScpXG5cdFx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdDbGVhciBMaWNlbnNlcycpXG5cdFx0XHRcdFx0LnNldFdhcm5pbmcoKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdC8vIENvbmZpcm0gYWN0aW9uXG5cdFx0XHRcdFx0XHRjb25zdCBjb25maXJtZWQgPSBjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgYWxsIGxpY2Vuc2VzPyBUaGlzIHdpbGwgcmVtb3ZlIGFueSBhcHBsaWVkIFN1cGVybm92YSBsaWNlbnNlLicpO1xuXHRcdFx0XHRcdFx0aWYgKCFjb25maXJtZWQpIHJldHVybjtcblxuXHRcdFx0XHRcdFx0Ly8gQ2xlYXIgbGljZW5zZSBrZXlcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5ID0gJyc7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIENsZWFyIEZvcmNlIFN1cGVybm92YSBpZiBlbmFibGVkXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cblx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVTdXBlcm5vdmFMaWNlbnNlKG51bGwpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyXG5cdFx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlXG5cdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnQWxsIGxpY2Vuc2VzIGNsZWFyZWQgc3VjY2Vzc2Z1bGx5LicsICdzdWNjZXNzJyk7XG5cblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheVxuXHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0fSkpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0xpY2Vuc2VNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgdHlwZTogJ3N1Y2Nlc3MnIHwgJ2Vycm9yJykge1xuXHRcdC8vIENyZWF0ZSBvciB1cGRhdGUgbWVzc2FnZSBlbGVtZW50XG5cdFx0Y29uc3QgZXhpc3RpbmdNZXNzYWdlID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1saWNlbnNlLW1lc3NhZ2UnKTtcblx0XHRpZiAoZXhpc3RpbmdNZXNzYWdlKSB7XG5cdFx0XHRleGlzdGluZ01lc3NhZ2UucmVtb3ZlKCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBcblx0XHRcdGNsczogYG5vdmEtbGljZW5zZS1tZXNzYWdlICR7dHlwZX1gLFxuXHRcdFx0dGV4dDogbWVzc2FnZVxuXHRcdH0pO1xuXG5cdFx0Ly8gQXV0by1yZW1vdmUgYWZ0ZXIgNSBzZWNvbmRzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRtZXNzYWdlRWwucmVtb3ZlKCk7XG5cdFx0fSwgNTAwMCk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb25mZXR0aSgpIHtcblx0XHQvLyBDcmVhdGUgY29uZmV0dGkgY29udGFpbmVyXG5cdFx0Y29uc3QgY29uZmV0dGlDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRjb25mZXR0aUNvbnRhaW5lci5jbGFzc05hbWUgPSAnbm92YS1jb25mZXR0aS1jb250YWluZXInO1xuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29uZmV0dGlDb250YWluZXIpO1xuXG5cdFx0Ly8gR2V0IHNldHRpbmdzIGNvbnRhaW5lciBwb3NpdGlvbiBmb3IgZXhwbG9zaW9uIGNlbnRlclxuXHRcdGNvbnN0IHJlY3QgPSB0aGlzLmNvbnRhaW5lckVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGNvbnN0IGNlbnRlclggPSByZWN0LmxlZnQgKyByZWN0LndpZHRoIC8gMjtcblx0XHRjb25zdCBjZW50ZXJZID0gcmVjdC50b3AgKyBNYXRoLm1pbihyZWN0LmhlaWdodCAvIDIsIDMwMCk7XG5cblx0XHQvLyBDb2xvcnMgZm9yIGNvbmZldHRpXG5cdFx0Y29uc3QgY29sb3JzID0gWydnb2xkJywgJ2JsdWUnLCAncGluaycsICdncmVlbicsICdyZWQnLCAnJ107ICAvLyBlbXB0eSBzdHJpbmcgPSBkZWZhdWx0IHB1cnBsZVxuXG5cdFx0Ly8gQ3JlYXRlIGNvbmZldHRpIHBpZWNlc1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgMTUwOyBpKyspIHtcblx0XHRcdGNvbnN0IGNvbmZldHRpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRjb25mZXR0aS5jbGFzc05hbWUgPSBgbm92YS1jb25mZXR0aS1waWVjZSAke2NvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb2xvcnMubGVuZ3RoKV19YDtcblx0XHRcdFxuXHRcdFx0Ly8gUG9zaXRpb24gYXQgZXhwbG9zaW9uIGNlbnRlclxuXHRcdFx0Y29uZmV0dGkuc3R5bGUubGVmdCA9IGAke2NlbnRlclh9cHhgO1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUudG9wID0gYCR7Y2VudGVyWX1weGA7XG5cdFx0XHRcblx0XHRcdC8vIENhbGN1bGF0ZSBleHBsb3Npb24gdHJhamVjdG9yeVxuXHRcdFx0Y29uc3QgYW5nbGUgPSAoTWF0aC5QSSAqIDIgKiBpKSAvIDE1MCArIChNYXRoLnJhbmRvbSgpICogMC4yIC0gMC4xKTtcblx0XHRcdGNvbnN0IHZlbG9jaXR5ID0gMjUwICsgTWF0aC5yYW5kb20oKSAqIDM1MDsgLy8gcGl4ZWxzXG5cdFx0XHRjb25zdCBleHBsb2RlWCA9IE1hdGguY29zKGFuZ2xlKSAqIHZlbG9jaXR5O1xuXHRcdFx0Y29uc3QgZXhwbG9kZVkgPSBNYXRoLnNpbihhbmdsZSkgKiB2ZWxvY2l0eSAtIDE1MDsgLy8gU3Ryb25nIHVwd2FyZCBiaWFzXG5cdFx0XHRcblx0XHRcdC8vIFNldCBDU1MgY3VzdG9tIHByb3BlcnRpZXMgZm9yIGFuaW1hdGlvblxuXHRcdFx0Y29uZmV0dGkuc3R5bGUuc2V0UHJvcGVydHkoJy0tZXhwbG9kZS14JywgYCR7ZXhwbG9kZVh9cHhgKTtcblx0XHRcdGNvbmZldHRpLnN0eWxlLnNldFByb3BlcnR5KCctLWV4cGxvZGUteScsIGAke2V4cGxvZGVZfXB4YCk7XG5cdFx0XHRcblx0XHRcdC8vIFJhbmRvbSBkZWxheSBmb3Igc3RhZ2dlcmVkIGV4cGxvc2lvblxuXHRcdFx0Y29uZmV0dGkuc3R5bGUuYW5pbWF0aW9uRGVsYXkgPSBgJHtNYXRoLnJhbmRvbSgpICogMC4yfXNgO1xuXHRcdFx0XG5cdFx0XHQvLyBSYW5kb20gc2l6ZVxuXHRcdFx0Y29uc3Qgc2l6ZSA9IDYgKyBNYXRoLnJhbmRvbSgpICogMTQ7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS53aWR0aCA9IGAke3NpemV9cHhgO1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUuaGVpZ2h0ID0gYCR7c2l6ZX1weGA7XG5cdFx0XHRcblx0XHRcdC8vIE1ha2Ugc29tZSBjb25mZXR0aSByZWN0YW5ndWxhclxuXHRcdFx0aWYgKE1hdGgucmFuZG9tKCkgPiAwLjUpIHtcblx0XHRcdFx0Y29uZmV0dGkuc3R5bGUuaGVpZ2h0ID0gYCR7c2l6ZSAqIDAuNH1weGA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGNvbmZldHRpQ29udGFpbmVyLmFwcGVuZENoaWxkKGNvbmZldHRpKTtcblx0XHR9XG5cblx0XHQvLyBSZW1vdmUgY29udGFpbmVyIGFmdGVyIGFuaW1hdGlvbiBjb21wbGV0ZXNcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGNvbmZldHRpQ29udGFpbmVyLnJlbW92ZSgpO1xuXHRcdH0sIDQwMDApO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHZW5lcmFsU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdHZW5lcmFsIFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgVGVtcGVyYXR1cmUnKVxuXHRcdFx0LnNldERlc2MoJ0NvbnRyb2xzIHJhbmRvbW5lc3MgaW4gQUkgcmVzcG9uc2VzICgwLjAgLSAxLjApJylcblx0XHRcdC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuXHRcdFx0XHQuc2V0TGltaXRzKDAsIDEsIDAuMSlcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlKVxuXHRcdFx0XHQuc2V0RHluYW1pY1Rvb2x0aXAoKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0VGVtcGVyYXR1cmUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBNYXggVG9rZW5zJylcblx0XHRcdC5zZXREZXNjKCdNYXhpbXVtIGxlbmd0aCBvZiBBSSByZXNwb25zZXMnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignMTAwMCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnMudG9TdHJpbmcoKSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IG51bVZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuXHRcdFx0XHRcdGlmICghaXNOYU4obnVtVmFsdWUpICYmIG51bVZhbHVlID4gMCkge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zID0gbnVtVmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0F1dG8tc2F2ZSBzZXR0aW5ncycpXG5cdFx0XHQuc2V0RGVzYygnQXV0b21hdGljYWxseSBzYXZlIHNldHRpbmdzIHdoZW4gY2hhbmdlZCcpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuYXV0b1NhdmUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlclNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbGxhcHNpYmxlIGhlYWRlclxuXHRcdGNvbnN0IGhlYWRlckVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6IDhweCAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDE2cHg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBhcnJvd0VsID0gaGVhZGVyRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29sbGFwc2libGUtYXJyb3cnIH0pO1xuXHRcdGFycm93RWwuaW5uZXJIVE1MID0gJ1x1MjVCNic7XG5cdFx0YXJyb3dFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdFx0Zm9udC1zaXplOiAxMnB4O1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0FJIFByb3ZpZGVyIFNldHRpbmdzJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmbGV4OiAxOyc7XG5cblx0XHRjb25zdCBwcm92aWRlckNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0cHJvdmlkZXJDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBub25lOyc7IC8vIFN0YXJ0IGNvbGxhcHNlZFxuXHRcdFxuXHRcdC8vIFRvZ2dsZSBmdW5jdGlvbmFsaXR5XG5cdFx0aGVhZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRjb25zdCBpc1Zpc2libGUgPSBwcm92aWRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG5cdFx0XHRwcm92aWRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaXNWaXNpYmxlID8gJ25vbmUnIDogJ2Jsb2NrJztcblx0XHRcdGFycm93RWwuc3R5bGUudHJhbnNmb3JtID0gaXNWaXNpYmxlID8gJ3JvdGF0ZSgwZGVnKScgOiAncm90YXRlKDkwZGVnKSc7XG5cdFx0fSk7XG5cblx0XHQvLyBJbmZvIGFib3V0IEFQSSBrZXlzIGFuZCBtb2RlbCByZWNvbW1lbmRhdGlvbnNcblx0XHRjb25zdCBpbmZvRWwgPSBwcm92aWRlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0PkNvbmZpZ3VyZSBZb3VyIEFQSSBLZXlzPC9oND5cblx0XHRcdFx0PHA+Tm92YSBjb25uZWN0cyB0byBBSSBwcm92aWRlcnMgdXNpbmcgeW91ciBvd24gQVBJIGtleXMuIEFsbCBwcm92aWRlcnMgYXJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgLSBcblx0XHRcdFx0anVzdCBhZGQgeW91ciBBUEkga2V5cyBiZWxvdyB0byBnZXQgc3RhcnRlZC48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZCBub3ZhLW1vZGVsLWd1aWRhbmNlXCI+XG5cdFx0XHRcdDxoND5SZWNvbW1lbmRlZCBEZWZhdWx0czwvaDQ+XG5cdFx0XHRcdDx1bCBjbGFzcz1cIm5vdmEtbW9kZWwtcmVjb21tZW5kYXRpb25zXCI+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+Q2xhdWRlIFNvbm5ldCA0PC9zdHJvbmc+IC0gTGF0ZXN0IGdlbmVyYXRpb24gd2l0aCBleGNlbGxlbnQgaW5zdHJ1Y3Rpb24gZm9sbG93aW5nIGZvciBjb2xsYWJvcmF0aXZlIGVkaXRpbmc8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkdQVC00LjEgTWluaTwvc3Ryb25nPiAtIEN1cnJlbnQtZ2VuZXJhdGlvbiBtb2RlbCB0aGF0IG91dHBlcmZvcm1zIEdQVC00byB3aGlsZSByZW1haW5pbmcgY29zdC1lZmZlY3RpdmU8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkdlbWluaSAyLjUgRmxhc2g8L3N0cm9uZz4gLSBCZXN0IHByaWNlL3BlcmZvcm1hbmNlIHdpdGggXCJ0aGlua2luZ1wiIGNhcGFiaWxpdGllcyBhbmQgc3Ryb25nIGNvZGluZyBzdXBwb3J0PC9saT5cblx0XHRcdFx0PC91bD5cblx0XHRcdFx0PHAgY2xhc3M9XCJub3ZhLWd1aWRhbmNlLW5vdGVcIj5UaGVzZSBkZWZhdWx0cyBvZmZlciBtb2Rlcm4gQUkgY2FwYWJpbGl0aWVzIHdpdGhvdXQgcHJlbWl1bSBwcmljaW5nLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBTaG93IGFsbCBwcm92aWRlcnMgLSBubyByZXN0cmljdGlvbnNcblx0XHR0aGlzLmNyZWF0ZU9sbGFtYVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZUNsYXVkZVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZUdvb2dsZVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZU9wZW5BSVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2xhdWRlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3QgY2xhdWRlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRjbGF1ZGVDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQ2xhdWRlIChBbnRocm9waWMpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNsYXVkZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEFudGhyb3BpYyBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ3NrLWFudC0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcoY2xhdWRlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdDbGF1ZGUgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHR0aGlzLnBvcHVsYXRlQ2xhdWRlTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsIHx8ICdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ2xhdWRlIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVDbGF1ZGVNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ2NsYXVkZScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblxuXG5cdHByaXZhdGUgY3JlYXRlT3BlbkFJU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3Qgb3BlbmFpQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRvcGVuYWlDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQ2hhdEdQVCAoT3BlbkFJKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBPcGVuQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdPcGVuQUkgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHR0aGlzLnBvcHVsYXRlT3BlbkFJTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLm1vZGVsIHx8ICdncHQtNC4xLW1pbmktMjAyNS0wNC0xNCcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyBPcGVuQUkgbW9kZWxzIGFyZSBoYXJkY29kZWQgLSBubyByZWZyZXNoIG5lZWRlZFxuXHR9XG5cblx0cHJpdmF0ZSBwb3B1bGF0ZU9wZW5BSU1vZGVscyhkcm9wZG93bjogYW55KSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3Rpbmcgb3B0aW9uc1xuXHRcdGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gVXNlIGNlbnRyYWxpemVkIG1vZGVsIGRlZmluaXRpb25zXG5cdFx0Y29uc3QgY3VycmVudE1vZGVscyA9IGdldEF2YWlsYWJsZU1vZGVscygnb3BlbmFpJyk7XG5cblx0XHRjdXJyZW50TW9kZWxzLmZvckVhY2gobW9kZWwgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKG1vZGVsLnZhbHVlLCBtb2RlbC5sYWJlbCk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUdvb2dsZVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IGdvb2dsZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0Z29vZ2xlQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dvb2dsZSAoR2VtaW5pKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhnb29nbGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBHb29nbGUgQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdBSS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHQvLyBNb2RlbCBzZXR0aW5nIHdpdGggcmVmcmVzaCBidXR0b25cblx0XHRjb25zdCBtb2RlbFNldHRpbmcgPSBuZXcgU2V0dGluZyhnb29nbGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ0dlbWluaSBtb2RlbCB0byB1c2UnKTtcblxuXHRcdGxldCBtb2RlbERyb3Bkb3duOiBhbnk7XG5cdFx0XG5cdFx0bW9kZWxTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdG1vZGVsRHJvcGRvd24gPSBkcm9wZG93bjtcblx0XHRcdHRoaXMucG9wdWxhdGVHb29nbGVNb2RlbHMoZHJvcGRvd24pO1xuXHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUubW9kZWwgfHwgJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNC0xNycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyBHb29nbGUgbW9kZWxzIGFyZSBoYXJkY29kZWQgLSBubyByZWZyZXNoIG5lZWRlZFxuXHR9XG5cblx0cHJpdmF0ZSBwb3B1bGF0ZUdvb2dsZU1vZGVscyhkcm9wZG93bjogYW55KSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3Rpbmcgb3B0aW9uc1xuXHRcdGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gVXNlIGNlbnRyYWxpemVkIG1vZGVsIGRlZmluaXRpb25zXG5cdFx0Y29uc3QgY3VycmVudE1vZGVscyA9IGdldEF2YWlsYWJsZU1vZGVscygnZ29vZ2xlJyk7XG5cblx0XHRjdXJyZW50TW9kZWxzLmZvckVhY2gobW9kZWwgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKG1vZGVsLnZhbHVlLCBtb2RlbC5sYWJlbCk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZU9sbGFtYVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdGNvbnN0IG9sbGFtYUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0b2xsYW1hQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ09sbGFtYSAoTG9jYWwpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdCYXNlIFVSTCcpXG5cdFx0XHQuc2V0RGVzYygnT2xsYW1hIHNlcnZlciBVUkwnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignaHR0cDovL2xvY2FsaG9zdDoxMTQzNCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT2xsYW1hIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdsbGFtYTInKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLm1vZGVsIHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUGxhdGZvcm1TZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb2xsYXBzaWJsZSBoZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29sbGFwc2libGUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiA4cHggMDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAxNnB4O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgYXJyb3dFbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWFycm93JyB9KTtcblx0XHRhcnJvd0VsLmlubmVySFRNTCA9ICdcdTI1QjYnO1xuXHRcdGFycm93RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRcdGZvbnQtc2l6ZTogMTJweDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdQbGF0Zm9ybSBTZXR0aW5ncycgfSk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZmxleDogMTsnO1xuXG5cdFx0Y29uc3QgcGxhdGZvcm1Db250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXBsYXRmb3JtLXNlY3Rpb24nIH0pO1xuXHRcdHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogbm9uZTsnOyAvLyBTdGFydCBjb2xsYXBzZWRcblx0XHRcblx0XHQvLyBUb2dnbGUgZnVuY3Rpb25hbGl0eVxuXHRcdGhlYWRlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgaXNWaXNpYmxlID0gcGxhdGZvcm1Db250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuXHRcdFx0cGxhdGZvcm1Db250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIEluZm8gYWJvdXQgcGxhdGZvcm0gc2V0dGluZ3Ncblx0XHRjb25zdCBpbmZvRWwgPSBwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXBsYXRmb3JtLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0Plx1RDgzRFx1RERBNVx1RkUwRiBQbGF0Zm9ybSBDb25maWd1cmF0aW9uPC9oND5cblx0XHRcdFx0PHA+Q29uZmlndXJlIHdoaWNoIEFJIHByb3ZpZGVyIHRvIHVzZSBhcyB5b3VyIHByaW1hcnkgcHJvdmlkZXIgb24gZGlmZmVyZW50IHBsYXRmb3Jtcy4gXG5cdFx0XHRcdE5vdmEgd29ya3Mgc2VhbWxlc3NseSBhY3Jvc3MgZGVza3RvcCBhbmQgbW9iaWxlIHdpdGggYWxsIHByb3ZpZGVycy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHRcdFxuXHRcdHBsYXRmb3JtQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0Rlc2t0b3AnIH0pO1xuXHRcdGNvbnN0IGRlc2t0b3BEcm9wZG93biA9IG5ldyBTZXR0aW5nKHBsYXRmb3JtQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1ByaW1hcnkgUHJvdmlkZXInKVxuXHRcdFx0LnNldERlc2MoJ1ByaW1hcnkgQUkgcHJvdmlkZXIgZm9yIGRlc2t0b3AnKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMuZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKCdkZXNrdG9wJyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRhbGxvd2VkUHJvdmlkZXJzLmZvckVhY2gocHJvdmlkZXIgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGxhYmVsID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyKTtcblx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24ocHJvdmlkZXIsIGxhYmVsKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnByaW1hcnlQcm92aWRlcilcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdHBsYXRmb3JtQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ01vYmlsZScgfSk7XG5cdFx0Y29uc3QgbW9iaWxlU2V0dGluZyA9IG5ldyBTZXR0aW5nKHBsYXRmb3JtQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1ByaW1hcnkgUHJvdmlkZXInKVxuXHRcdFx0LnNldERlc2MoJ1ByaW1hcnkgQUkgcHJvdmlkZXIgZm9yIG1vYmlsZSBkZXZpY2VzJyk7XG5cdFx0XHRcblx0XHRtb2JpbGVTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG5cdFx0XHQuYWRkT3B0aW9uKCdub25lJywgJ05vbmUgKERpc2FibGVkKScpXG5cdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUnLCAnQ2xhdWRlJylcblx0XHRcdC5hZGRPcHRpb24oJ29wZW5haScsICdPcGVuQUknKVxuXHRcdFx0LmFkZE9wdGlvbignZ29vZ2xlJywgJ0dvb2dsZScpXG5cdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUucHJpbWFyeVByb3ZpZGVyKVxuXHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlciA9IHZhbHVlIGFzIFByb3ZpZGVyVHlwZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBbGxvd2VkUHJvdmlkZXJzRm9yUGxhdGZvcm0ocGxhdGZvcm06ICdkZXNrdG9wJyB8ICdtb2JpbGUnKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgaW4gdGhlIFN1cGVybm92YSBtb2RlbFxuXHRcdHJldHVybiBwbGF0Zm9ybSA9PT0gJ2Rlc2t0b3AnIFxuXHRcdFx0PyBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0XHQ6IFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnXTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcjogUHJvdmlkZXJUeXBlKTogc3RyaW5nIHtcblx0XHRjb25zdCBuYW1lczogUmVjb3JkPFByb3ZpZGVyVHlwZSwgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnQ2xhdWRlIChBbnRocm9waWMpJyxcblx0XHRcdCdvcGVuYWknOiAnQ2hhdEdQVCAoT3BlbkFJKScsXG5cdFx0XHQnZ29vZ2xlJzogJ0dvb2dsZSAoR2VtaW5pKScsIFxuXHRcdFx0J29sbGFtYSc6ICdPbGxhbWEgKExvY2FsKScsXG5cdFx0XHQnbm9uZSc6ICdOb25lIChEaXNhYmxlZCknXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJdIHx8IHByb3ZpZGVyO1xuXHR9XG5cblx0YXN5bmMgc2V0Q3VycmVudFByb3ZpZGVyKHByb3ZpZGVySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5wcmltYXJ5UHJvdmlkZXIgPSBwcm92aWRlcklkIGFzIFByb3ZpZGVyVHlwZTtcblx0XHRcblx0XHQvLyBVcGRhdGUgdGhlIHByb3ZpZGVyIG1hbmFnZXIgd2l0aCBuZXcgc2V0dGluZ3Ncblx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbW1hbmRTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb2xsYXBzaWJsZSBoZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29sbGFwc2libGUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiA4cHggMDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAxNnB4O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgYXJyb3dFbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWFycm93JyB9KTtcblx0XHRhcnJvd0VsLmlubmVySFRNTCA9ICdcdTI1QjYnO1xuXHRcdGFycm93RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRcdGZvbnQtc2l6ZTogMTJweDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdDdXN0b20gQ29tbWFuZHMnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZsZXg6IDE7JztcblxuXHRcdGNvbnN0IGNvbW1hbmRDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtc2VjdGlvbicgfSk7XG5cdFx0Y29tbWFuZENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IG5vbmU7JzsgLy8gU3RhcnQgY29sbGFwc2VkXG5cdFx0XG5cdFx0Ly8gVG9nZ2xlIGZ1bmN0aW9uYWxpdHlcblx0XHRoZWFkZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdGNvbnN0IGlzVmlzaWJsZSA9IGNvbW1hbmRDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuXHRcdFx0Y29tbWFuZENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaXNWaXNpYmxlID8gJ25vbmUnIDogJ2Jsb2NrJztcblx0XHRcdGFycm93RWwuc3R5bGUudHJhbnNmb3JtID0gaXNWaXNpYmxlID8gJ3JvdGF0ZSgwZGVnKScgOiAncm90YXRlKDkwZGVnKSc7XG5cdFx0fSk7XG5cblx0XHQvLyBGZWF0dXJlIGF2YWlsYWJpbGl0eSBjaGVja1xuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0Y29uc3Qgbm90aWNlRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtZmVhdHVyZS1ub3RpY2UnIH0pO1xuXHRcdFx0bm90aWNlRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwicGFkZGluZzogMTZweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1wiPlxuXHRcdFx0XHRcdDxoNCBzdHlsZT1cIm1hcmdpbjogMCAwIDhweCAwOyBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1wiPlN1cGVybm92YSBTdXBwb3J0ZXIgRmVhdHVyZTwvaDQ+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJtYXJnaW46IDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTtcIj5cblx0XHRcdFx0XHRcdEN1c3RvbSBjb21tYW5kcyBhcmUgY3VycmVudGx5IGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycy4gXG5cdFx0XHRcdFx0XHRUaGV5IHdpbGwgYmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyBvbiA8c3Ryb25nPk9jdG9iZXIgMSwgMjAyNTwvc3Ryb25nPi5cblx0XHRcdFx0XHQ8L3A+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBEZXNjcmlwdGlvblxuXHRcdGNvbnN0IGRlc2NFbCA9IGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2NyaXB0aW9uJyB9KTtcblx0XHRkZXNjRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PHAgc3R5bGU9XCJjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IG1hcmdpbi1ib3R0b206IDE2cHg7XCI+XG5cdFx0XHRcdENyZWF0ZSBjdXN0b20gY29tbWFuZCBzaG9ydGN1dHMgdGhhdCBpbnNlcnQgcHJlZGVmaW5lZCB0ZXh0IHRlbXBsYXRlcyB3aGVuIHRyaWdnZXJlZCB3aXRoIDxjb2RlPjp0cmlnZ2VyPC9jb2RlPi5cblx0XHRcdDwvcD5cblx0XHRgO1xuXG5cdFx0Ly8gU2hvdyBDb21tYW5kIEJ1dHRvbiBzZXR0aW5nIChTdXBlcm5vdmEtb25seSlcblx0XHRuZXcgU2V0dGluZyhjb21tYW5kQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1Nob3cgQ29tbWFuZCBCdXR0b24gaW4gQ2hhdCcpXG5cdFx0XHQuc2V0RGVzYygnU2hvdyB0aGUgQ29tbWFuZHMgYnV0dG9uIGJlc2lkZSB0aGUgU2VuZCBidXR0b24gZm9yIHF1aWNrIGNvbW1hbmQgYWNjZXNzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b24pXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbiA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEZpbmQgYW5kIHJlZnJlc2ggc2lkZWJhciB2aWV3XG5cdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cblx0XHQvLyBBZGQgbmV3IGNvbW1hbmQgYnV0dG9uIGF0IHRoZSB0b3Bcblx0XHRjb25zdCBidXR0b25FbCA9IGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1hZGQtY29tbWFuZCcgfSk7XG5cdFx0YnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tYm90dG9tOiAxNnB4Oyc7XG5cdFx0XG5cdFx0bmV3IFNldHRpbmcoYnV0dG9uRWwpXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBcblx0XHRcdFx0YnV0dG9uXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJysgQWRkIEN1c3RvbSBDb21tYW5kJylcblx0XHRcdFx0XHQuc2V0Q3RhKClcblx0XHRcdFx0XHQub25DbGljaygoKSA9PiB0aGlzLnNob3dBZGRDb21tYW5kRGlhbG9nKCkpXG5cdFx0XHQpO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KGNvbW1hbmRDb250YWluZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIGNvbW1hbmRzIGxpc3Rcblx0XHRjb25zdCBleGlzdGluZ0xpc3QgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZHMtbGlzdCcpO1xuXHRcdGlmIChleGlzdGluZ0xpc3QpIGV4aXN0aW5nTGlzdC5yZW1vdmUoKTtcblxuXHRcdGNvbnN0IGNvbW1hbmRzTGlzdCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWxpc3QnIH0pO1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgfHwgW107XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRjb25zdCBlbXB0eUVsID0gY29tbWFuZHNMaXN0LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZHMtZW1wdHknIH0pO1xuXHRcdFx0ZW1wdHlFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmc6IDI0cHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcIj5cblx0XHRcdFx0XHQ8cD5ObyBjdXN0b20gY29tbWFuZHMgeWV0LjwvcD5cblx0XHRcdFx0XHQ8cCBzdHlsZT1cImZvbnQtc2l6ZTogMC45ZW07XCI+Q3JlYXRlIHlvdXIgZmlyc3QgY29tbWFuZCB0byBnZXQgc3RhcnRlZCE8L3A+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKChjb21tYW5kLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgY29tbWFuZEVsID0gY29tbWFuZHNMaXN0LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pdGVtJyB9KTtcblx0XHRcdGNvbW1hbmRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdFx0cGFkZGluZzogMTZweDtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogMTJweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIENvbW1hbmQgaGVhZGVyXG5cdFx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaGVhZGVyJyB9KTtcblx0XHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogZmxleC1zdGFydDsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cblx0XHRcdGNvbnN0IGluZm9FbCA9IGhlYWRlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pbmZvJyB9KTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1uYW1lJyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA2MDA7IG1hcmdpbi1ib3R0b206IDRweDsnO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpbmZvRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLmlubmVySFRNTCA9IGA8Y29kZT46JHtjb21tYW5kLnRyaWdnZXJ9PC9jb2RlPmA7XG5cdFx0XHR0cmlnZ2VyRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgZm9udC1zaXplOiAwLjllbTsnO1xuXG5cdFx0XHQvLyBBY3Rpb25zXG5cdFx0XHRjb25zdCBhY3Rpb25zRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtYWN0aW9ucycgfSk7XG5cdFx0XHRhY3Rpb25zRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBnYXA6IDhweDsnO1xuXG5cdFx0XHRjb25zdCBlZGl0QnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdFZGl0JyB9KTtcblx0XHRcdGVkaXRCdG4uc3R5bGUuY3NzVGV4dCA9ICdwYWRkaW5nOiA0cHggOHB4OyBmb250LXNpemU6IDAuOGVtOyBib3JkZXItcmFkaXVzOiA0cHg7Jztcblx0XHRcdGVkaXRCdG4ub25jbGljayA9ICgpID0+IHRoaXMuc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4KTtcblxuXHRcdFx0Y29uc3QgZGVsZXRlQnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdEZWxldGUnIH0pO1xuXHRcdFx0ZGVsZXRlQnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnO1xuXHRcdFx0ZGVsZXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmRlbGV0ZUNvbW1hbmQoaW5kZXgpO1xuXG5cdFx0XHQvLyBEZXNjcmlwdGlvbiBhbmQgdGVtcGxhdGUgcHJldmlld1xuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdFx0ZGVzY0VsLnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtOyBtYXJnaW4tYm90dG9tOiA4cHg7Jztcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdGVtcGxhdGVFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtdGVtcGxhdGUnIH0pO1xuXHRcdFx0dGVtcGxhdGVFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgcGFkZGluZzogOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7IGZvbnQtc2l6ZTogMC44ZW07IHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsgbWF4LWhlaWdodDogNjBweDsgb3ZlcmZsb3cteTogYXV0bztcIj5cblx0XHRcdFx0XHQke2NvbW1hbmQudGVtcGxhdGV9XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0FkZENvbW1hbmREaWFsb2coKSB7XG5cdFx0dGhpcy5zaG93Q29tbWFuZERpYWxvZygpO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93RWRpdENvbW1hbmREaWFsb2coaW5kZXg6IG51bWJlcikge1xuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uW2luZGV4XTtcblx0XHRpZiAoY29tbWFuZCkge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZERpYWxvZyhjb21tYW5kLCBpbmRleCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZERpYWxvZyhleGlzdGluZ0NvbW1hbmQ/OiBDdXN0b21Db21tYW5kLCBlZGl0SW5kZXg/OiBudW1iZXIpIHtcblx0XHQvLyBGb3Igbm93LCB1c2UgYSBzaW1wbGUgcHJvbXB0LWJhc2VkIGFwcHJvYWNoXG5cdFx0Ly8gVE9ETzogSW1wbGVtZW50IHByb3BlciBtb2RhbCB3aGVuIE1vZGFsIGNsYXNzIGlzIHByb3Blcmx5IGF2YWlsYWJsZVxuXHRcdGNvbnN0IG5hbWUgPSBwcm9tcHQoJ0NvbW1hbmQgbmFtZTonLCBleGlzdGluZ0NvbW1hbmQ/Lm5hbWUgfHwgJycpO1xuXHRcdGlmICghbmFtZSkgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IHRyaWdnZXIgPSBwcm9tcHQoJ0NvbW1hbmQgdHJpZ2dlciAod2l0aG91dCA6KTonLCBleGlzdGluZ0NvbW1hbmQ/LnRyaWdnZXIgfHwgJycpO1xuXHRcdGlmICghdHJpZ2dlcikgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IGRlc2NyaXB0aW9uID0gcHJvbXB0KCdEZXNjcmlwdGlvbiAob3B0aW9uYWwpOicsIGV4aXN0aW5nQ29tbWFuZD8uZGVzY3JpcHRpb24gfHwgJycpO1xuXHRcdFxuXHRcdGNvbnN0IHRlbXBsYXRlID0gcHJvbXB0KCdUZW1wbGF0ZSBjb250ZW50OicsIGV4aXN0aW5nQ29tbWFuZD8udGVtcGxhdGUgfHwgJycpO1xuXHRcdGlmICghdGVtcGxhdGUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCByZXN1bHQ6IEN1c3RvbUNvbW1hbmQgPSB7XG5cdFx0XHRpZDogZXhpc3RpbmdDb21tYW5kPy5pZCB8fCAoJ2NtZF8nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpKSxcblx0XHRcdG5hbWUsXG5cdFx0XHR0cmlnZ2VyOiB0cmlnZ2VyLnRvTG93ZXJDYXNlKCksXG5cdFx0XHR0ZW1wbGF0ZSxcblx0XHRcdGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCB1bmRlZmluZWRcblx0XHR9O1xuXHRcdFxuXHRcdGlmIChlZGl0SW5kZXggIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0Ly8gRWRpdCBleGlzdGluZyBjb21tYW5kXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyA9IFtdO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbZWRpdEluZGV4XSA9IHJlc3VsdDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gQWRkIG5ldyBjb21tYW5kXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyA9IFtdO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMucHVzaChyZXN1bHQpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdCh0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmQtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50KTtcblx0fVxuXG5cdHByaXZhdGUgZGVsZXRlQ29tbWFuZChpbmRleDogbnVtYmVyKSB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kc1tpbmRleF07XG5cdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybShgRGVsZXRlIGNvbW1hbmQgXCIke2NvbW1hbmQubmFtZX1cIiAoJHtjb21tYW5kLnRyaWdnZXJ9KT9gKTtcblx0XHRcblx0XHRpZiAoY29uZmlybWVkKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdCh0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmQtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50KTtcblx0XHR9XG5cdH1cbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlLCBOb3RpY2UsIE1hcmtkb3duVmlldywgUGxhdGZvcm0sIHNldEljb24gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS90eXBlcyc7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3dpa2lsaW5rLXN1Z2dlc3QnO1xuaW1wb3J0IHsgTXVsdGlEb2NDb250ZXh0SGFuZGxlciwgTXVsdGlEb2NDb250ZXh0IH0gZnJvbSAnLi4vY29yZS9tdWx0aS1kb2MtY29udGV4dCc7XG5pbXBvcnQgeyBnZXRBdmFpbGFibGVNb2RlbHMgfSBmcm9tICcuLi9haS9tb2RlbHMnO1xuaW1wb3J0IHsgSW5wdXRIYW5kbGVyIH0gZnJvbSAnLi9pbnB1dC1oYW5kbGVyJztcbmltcG9ydCB7IENvbW1hbmRTeXN0ZW0gfSBmcm9tICcuL2NvbW1hbmQtc3lzdGVtJztcbmltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9jb250ZXh0LW1hbmFnZXInO1xuaW1wb3J0IHsgQ2hhdFJlbmRlcmVyIH0gZnJvbSAnLi9jaGF0LXJlbmRlcmVyJztcblxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgPSAnbm92YS1zaWRlYmFyJztcblxuZXhwb3J0IGNsYXNzIE5vdmFTaWRlYmFyVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcblx0cGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNoYXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpbnB1dENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIG11bHRpRG9jSGFuZGxlciE6IE11bHRpRG9jQ29udGV4dEhhbmRsZXI7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcblx0Ly8gTmV3IGFyY2hpdGVjdHVyZSBjb21wb25lbnRzXG5cdHByaXZhdGUgaW5wdXRIYW5kbGVyITogSW5wdXRIYW5kbGVyO1xuXHRwcml2YXRlIGNvbW1hbmRTeXN0ZW0hOiBDb21tYW5kU3lzdGVtO1xuXHRwcml2YXRlIGNvbnRleHRNYW5hZ2VyITogQ29udGV4dE1hbmFnZXI7XG5cdHByaXZhdGUgY2hhdFJlbmRlcmVyITogQ2hhdFJlbmRlcmVyO1xuXHRcblx0Ly8gTGVnYWN5IGNvbXBhdGliaWxpdHkgZGVsZWdhdGVzIC0gRm9yd2FyZCB0byBuZXcgYXJjaGl0ZWN0dXJlXG5cdHByaXZhdGUgZ2V0IHRleHRBcmVhKCkgeyByZXR1cm4gdGhpcy5pbnB1dEhhbmRsZXI/LmdldFRleHRBcmVhKCk7IH1cblx0cHJpdmF0ZSBnZXQgd2lraWxpbmtBdXRvY29tcGxldGUoKSB7IHJldHVybiB0aGlzLmlucHV0SGFuZGxlciA/IHsgZGVzdHJveTogKCkgPT4ge30gfSA6IG51bGw7IH1cblx0cHJpdmF0ZSBnZXQgYXV0b0dyb3dUZXh0YXJlYSgpIHsgcmV0dXJuICgpID0+IHt9OyB9XG5cdFxuXHQvLyBDb21tYW5kIHN5c3RlbSBjb21wYXRpYmlsaXR5IC0gc3R1YiBvdXQgb2xkIG1ldGhvZHNcblx0cHJpdmF0ZSBfY29tbWFuZFBpY2tlckl0ZW1zOiBhbnlbXSA9IFtdO1xuXHRwcml2YXRlIGdldCBjb21tYW5kUGlja2VySXRlbXMoKSB7IHJldHVybiB0aGlzLl9jb21tYW5kUGlja2VySXRlbXM7IH1cblx0cHJpdmF0ZSBzZXQgY29tbWFuZFBpY2tlckl0ZW1zKHZhbHVlOiBhbnlbXSkgeyB0aGlzLl9jb21tYW5kUGlja2VySXRlbXMgPSB2YWx1ZTsgfVxuXHRwcml2YXRlIF9zZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyID0gLTE7XG5cdHByaXZhdGUgZ2V0IHNlbGVjdGVkQ29tbWFuZEluZGV4KCkgeyByZXR1cm4gdGhpcy5fc2VsZWN0ZWRDb21tYW5kSW5kZXg7IH1cblx0cHJpdmF0ZSBzZXQgc2VsZWN0ZWRDb21tYW5kSW5kZXgodmFsdWU6IG51bWJlcikgeyB0aGlzLl9zZWxlY3RlZENvbW1hbmRJbmRleCA9IHZhbHVlOyB9XG5cdHByaXZhdGUgX2lzQ29tbWFuZE1lbnVWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZ2V0IGlzQ29tbWFuZE1lbnVWaXNpYmxlKCkgeyByZXR1cm4gdGhpcy5faXNDb21tYW5kTWVudVZpc2libGU7IH1cblx0cHJpdmF0ZSBzZXQgaXNDb21tYW5kTWVudVZpc2libGUodmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5faXNDb21tYW5kTWVudVZpc2libGUgPSB2YWx1ZTsgfVxuXHRcblx0Ly8gQ29udGV4dCBzeXN0ZW0gY29tcGF0aWJpbGl0eSAtIGZvcndhcmQgdG8gQ29udGV4dE1hbmFnZXJcblx0cHJpdmF0ZSBnZXQgY29udGV4dFByZXZpZXcoKSB7IHJldHVybiB0aGlzLmNvbnRleHRNYW5hZ2VyPy5jb250ZXh0UHJldmlldzsgfVxuXHRwcml2YXRlIF9jb250ZXh0SW5kaWNhdG9yOiBhbnk7XG5cdHByaXZhdGUgZ2V0IGNvbnRleHRJbmRpY2F0b3IoKSB7IHJldHVybiB0aGlzLl9jb250ZXh0SW5kaWNhdG9yIHx8IHRoaXMuY29udGV4dE1hbmFnZXI/LmNvbnRleHRJbmRpY2F0b3I7IH1cblx0cHJpdmF0ZSBzZXQgY29udGV4dEluZGljYXRvcih2YWx1ZTogYW55KSB7IHRoaXMuX2NvbnRleHRJbmRpY2F0b3IgPSB2YWx1ZTsgfVxuXHRcblx0Ly8gU3R1YiBvdXQgb2xkIERPTSBlbGVtZW50cyB0aGF0IHNob3VsZCBubyBsb25nZXIgYmUgdXNlZFxuXHRwcml2YXRlIGdldCBjb21tYW5kUGlja2VyKCk6IGFueSB7IHJldHVybiBudWxsOyB9XG5cdHByaXZhdGUgc2V0IGNvbW1hbmRQaWNrZXIodmFsdWU6IGFueSkgeyAvKiBuby1vcCAqLyB9XG5cdHByaXZhdGUgZ2V0IGNvbW1hbmRNZW51KCk6IGFueSB7IHJldHVybiBudWxsOyB9XG5cdHByaXZhdGUgc2V0IGNvbW1hbmRNZW51KHZhbHVlOiBhbnkpIHsgLyogbm8tb3AgKi8gfVxuXHRwcml2YXRlIGdldCBjb21tYW5kQnV0dG9uKCk6IGFueSB7IHJldHVybiBudWxsOyB9XG5cdFxuXHRcblx0Ly8gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uIC0gZGVib3VuY2luZyBhbmQgdGltaW5nIGNvbnN0YW50c1xuXHRwcml2YXRlIGNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0OiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT05URVhUX1BSRVZJRVdfREVCT1VOQ0VfTVMgPSAzMDA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFNDUk9MTF9ERUxBWV9NUyA9IDUwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBGT0NVU19ERUxBWV9NUyA9IDE1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgSE9WRVJfVElNRU9VVF9NUyA9IDE1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTk9USUNFX0RVUkFUSU9OX01TID0gNTAwMDtcblx0XG5cdC8vIEV2ZW50IGxpc3RlbmVyIGNsZWFudXAgdHJhY2tpbmdcblx0cHJpdmF0ZSBkb2N1bWVudEV2ZW50TGlzdGVuZXJzOiBBcnJheTx7ZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXJ9PiA9IFtdO1xuXHRwcml2YXRlIHRpbWVvdXRzOiBOb2RlSlMuVGltZW91dFtdID0gW107XG5cblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIobGVhZik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIgPSBuZXcgTXVsdGlEb2NDb250ZXh0SGFuZGxlcih0aGlzLmFwcCk7XG5cdH1cblxuXHRnZXRWaWV3VHlwZSgpIHtcblx0XHRyZXR1cm4gVklFV19UWVBFX05PVkFfU0lERUJBUjtcblx0fVxuXG5cdGdldERpc3BsYXlUZXh0KCkge1xuXHRcdHJldHVybiAnTm92YSBBSSc7XG5cdH1cblxuXHRnZXRJY29uKCkge1xuXHRcdHJldHVybiAnbm92YS1zdGFyJztcblx0fVxuXG5cdGFzeW5jIG9uT3BlbigpIHtcblx0XHRjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNoaWxkcmVuWzFdIGFzIEhUTUxFbGVtZW50O1xuXHRcdGNvbnRhaW5lci5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbm92YS1zaWRlYmFyLWNvbnRhaW5lcicpO1xuXG5cdFx0Ly8gTW9iaWxlIGFjY2VzcyBpcyBub3cgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB3cmFwcGVyIHdpdGggcHJvcGVyIGZsZXggbGF5b3V0XG5cdFx0Y29uc3Qgd3JhcHBlckVsID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtd3JhcHBlcicgfSk7XG5cdFx0d3JhcHBlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGhlaWdodDogMTAwJTtcblx0XHRcdG92ZXJmbG93OiBoaWRkZW47XG5cdFx0XHRwYWRkaW5nLWJvdHRvbTogJHtQbGF0Zm9ybS5pc0Rlc2t0b3BBcHAgPyAndmFyKC0tc2l6ZS00LTYpJyA6ICd2YXIoLS1zaXplLTQtNSknfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciB3aXRoIHByb3ZpZGVyIGluZm9cblx0XHRjb25zdCBoZWFkZXJFbCA9IHdyYXBwZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTIpO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gTGVmdCBzaWRlOiBUaXRsZSB3aXRoIE5vdmEgaWNvblxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDQnKTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiB2YXIoLS1zaXplLTItMik7Jztcblx0XHR0aXRsZUVsLmlubmVySFRNTCA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiB2YXIoLS1pY29uLXNpemUpOyBoZWlnaHQ6IHZhcigtLWljb24tc2l6ZSk7XCI+XG5cdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0PC9zdmc+Tm92YWA7XG5cdFx0XG5cdFx0Ly8gUmlnaHQgc2lkZTogUHJvdmlkZXIgc3RhdHVzIGFuZCBDbGVhciBidXR0b25cblx0XHRjb25zdCByaWdodENvbnRhaW5lciA9IGhlYWRlckVsLmNyZWF0ZURpdigpO1xuXHRcdHJpZ2h0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiB2YXIoLS1zaXplLTItMyk7Jztcblx0XHRcblx0XHQvLyBQcml2YWN5IGluZGljYXRvciBpY29uXG5cdFx0Y29uc3QgcHJpdmFjeUluZGljYXRvciA9IHJpZ2h0Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXByaXZhY3ktaW5kaWNhdG9yJyB9KTtcblx0XHRwcml2YWN5SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDRweDtcblx0XHRcdGNvbG9yOiB2YXIoLS1pY29uLWNvbG9yKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiB2YXIoLS1mb250LXdlaWdodC1tZWRpdW0pO1xuXHRcdGA7XG5cdFx0dGhpcy51cGRhdGVQcml2YWN5SW5kaWNhdG9yKHByaXZhY3lJbmRpY2F0b3IpO1xuXHRcdFxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgdXBkYXRlc1xuXHRcdCh0aGlzIGFzIGFueSkucHJpdmFjeUluZGljYXRvciA9IHByaXZhY3lJbmRpY2F0b3I7XG5cdFx0XG5cdFx0Ly8gQWxsIHVzZXJzIGNhbiBzd2l0Y2ggcHJvdmlkZXJzIGZyZWVseVxuXHRcdHRoaXMuY3JlYXRlUHJvdmlkZXJEcm9wZG93bihyaWdodENvbnRhaW5lcik7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgQ2hhdCBidXR0b24gaW4gcmlnaHQgY29udGFpbmVyXG5cdFx0Y29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHJpZ2h0Q29udGFpbmVyKTtcblx0XHRjbGVhckJ1dHRvbi5zZXRJY29uKCdlcmFzZXInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGNvbnZlcnNhdGlvbiBoaXN0b3J5Jylcblx0XHRcdC5vbkNsaWNrKCgpID0+IHRoaXMuY2xlYXJDaGF0KCkpO1xuXG5cdFx0dGhpcy5jcmVhdGVDaGF0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0dGhpcy5jcmVhdGVJbnB1dEludGVyZmFjZSh3cmFwcGVyRWwpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyIGZvciBhY3RpdmUgZmlsZSBjaGFuZ2VzXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0XHRcdH0pXG5cdFx0KTtcblx0XHRcblx0XHQvLyBMb2FkIGNvbnZlcnNhdGlvbiBmb3IgY3VycmVudCBmaWxlXG5cdFx0dGhpcy5sb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIEluaXRpYWwgc3RhdHVzIHJlZnJlc2ggdG8gZW5zdXJlIGFsbCBpbmRpY2F0b3JzIGFyZSB1cCB0byBkYXRlXG5cdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLnJlZnJlc2hQcm92aWRlclN0YXR1cygpLCAxMDApO1xuXHRcdFxuXHRcdC8vIEF1dG8tZm9jdXMgaW5wdXQgZm9yIGltbWVkaWF0ZSB0eXBpbmdcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmICh0aGlzLnRleHRBcmVhPy5pbnB1dEVsKSB7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0fVxuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5GT0NVU19ERUxBWV9NUyk7XG5cdH1cblxuXHRhc3luYyBvbkNsb3NlKCkge1xuXHRcdC8vIENsZWFuIHVwIHByb3ZpZGVyIGRyb3Bkb3duIGV2ZW50IGxpc3RlbmVyXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LmNsZWFudXApIHtcblx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24uY2xlYW51cCgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5kZXN0cm95KCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFyIGRlYm91bmNlIHRpbWVvdXRcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpO1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCA9IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFuIHVwIHRyYWNrZWQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0dGhpcy5jbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcblx0XHQvLyBDbGVhciBhbGwgdGltZW91dHNcblx0XHR0aGlzLmNsZWFyVGltZW91dHMoKTtcblx0XHRcblx0XHQvLyBDbGVhbiB1cCBET00gZWxlbWVudHNcblx0XHR0aGlzLmNsZWFudXBET01FbGVtZW50cygpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIGV2ZW50IGxpc3RlbmVyIHdpdGggYXV0b21hdGljIGNsZWFudXAgdHJhY2tpbmdcblx0ICovXG5cdHByaXZhdGUgYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGQgdGltZW91dCB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRUaW1lb3V0KGNhbGxiYWNrOiAoKSA9PiB2b2lkLCBkZWxheTogbnVtYmVyKTogTm9kZUpTLlRpbWVvdXQge1xuXHRcdGNvbnN0IGlkID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0dGhpcy50aW1lb3V0cyA9IHRoaXMudGltZW91dHMuZmlsdGVyKHQgPT4gdCAhPT0gaWQpO1xuXHRcdH0sIGRlbGF5KTtcblx0XHR0aGlzLnRpbWVvdXRzLnB1c2goaWQpO1xuXHRcdHJldHVybiBpZDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIGFsbCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFyIGFsbCB0cmFja2VkIHRpbWVvdXRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFyVGltZW91dHMoKTogdm9pZCB7XG5cdFx0dGhpcy50aW1lb3V0cy5mb3JFYWNoKGlkID0+IGNsZWFyVGltZW91dChpZCkpO1xuXHRcdHRoaXMudGltZW91dHMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRE9NRWxlbWVudHMoKTogdm9pZCB7XG5cdFx0Ly8gQ2xlYW51cCBpcyBub3cgaGFuZGxlZCBieSBpbmRpdmlkdWFsIGNvbXBvbmVudCBjbGVhbnVwIG1ldGhvZHNcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2hhdEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY2hhdC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdGA7XG5cblx0XHQvLyBXZWxjb21lIG1lc3NhZ2Ugd2l0aCBOb3ZhIGJyYW5kaW5nXG5cdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVJbnB1dEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jcmVhdGVJbnB1dEFyZWEoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgdGhlIGlucHV0IGFyZWEgVUkgZWxlbWVudHMgdXNpbmcgbmV3IGFyY2hpdGVjdHVyZVxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbnB1dEFyZWEoKSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3RpbmcgaW5wdXQgYXJlYSBjb250ZW50XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIEluaXRpYWxpemUgY29udGV4dCBtYW5hZ2VyIGFuZCBjaGF0IHJlbmRlcmVyIGZpcnN0XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlciA9IG5ldyBDb250ZXh0TWFuYWdlcih0aGlzLnBsdWdpbiwgdGhpcy5hcHAsIHRoaXMuaW5wdXRDb250YWluZXIpO1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyID0gbmV3IENoYXRSZW5kZXJlcih0aGlzLnBsdWdpbiwgdGhpcy5jaGF0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgSW5wdXRIYW5kbGVyIHdoaWNoIHdpbGwgaGFuZGxlIGFsbCBpbnB1dCBVSSBjcmVhdGlvblxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyID0gbmV3IElucHV0SGFuZGxlcih0aGlzLnBsdWdpbiwgdGhpcy5pbnB1dENvbnRhaW5lciwgdGhpcy5jb250ZXh0TWFuYWdlcik7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHRoZSBpbnB1dCBpbnRlcmZhY2UgdXNpbmcgbmV3IElucHV0SGFuZGxlclxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLmNyZWF0ZUlucHV0SW50ZXJmYWNlKHRoaXMuY2hhdENvbnRhaW5lcik7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIENvbW1hbmRTeXN0ZW0gd2l0aCB0aGUgYWN0dWFsIHRleHRBcmVhIGZyb20gSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5jb21tYW5kU3lzdGVtID0gbmV3IENvbW1hbmRTeXN0ZW0odGhpcy5wbHVnaW4sIHRoaXMuaW5wdXRDb250YWluZXIsIHRoaXMuaW5wdXRIYW5kbGVyLmdldFRleHRBcmVhKCkpO1xuXHRcdFxuXHRcdC8vIENvbm5lY3QgdGhlIENvbW1hbmRTeXN0ZW0gdG8gdGhlIElucHV0SGFuZGxlclxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLnNldENvbW1hbmRTeXN0ZW0odGhpcy5jb21tYW5kU3lzdGVtKTtcblx0XHRcblx0XHQvLyBTZXQgdXAgc2VuZCBtZXNzYWdlIGNhbGxiYWNrXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0T25TZW5kTWVzc2FnZSgobWVzc2FnZTogc3RyaW5nKSA9PiB7XG5cdFx0XHR0aGlzLmhhbmRsZVNlbmQobWVzc2FnZSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbnRleHQgaW5kaWNhdG9yIGFuZCBwcmV2aWV3IHVzaW5nIENvbnRleHRNYW5hZ2VyXG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5jcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XG5cdH1cblxuXHRwcml2YXRlIGFkZE1lc3NhZ2Uocm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgY29udGVudDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtJHtyb2xlfWAgfSk7XG5cdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMykgdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHQke3JvbGUgPT09ICd1c2VyJyBcblx0XHRcdFx0PyAnbWFyZ2luLWxlZnQ6IGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7JyBcblx0XHRcdFx0OiByb2xlID09PSAnc3lzdGVtJ1xuXHRcdFx0XHQ/ICdtYXJnaW46IDAgYXV0bzsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbSB3aXRoIHNtb290aCBhbmltYXRpb25cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBIZWxwZXIgbWV0aG9kIHRvIGNyZWF0ZSBzaW1wbGUgbWVzc2FnZXMgd2l0aG91dCByb2xlIGhlYWRlcnNcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlU2ltcGxlTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIGNsYXNzTmFtZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSAke2NsYXNzTmFtZX1gIH0pO1xuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0XG5cdFx0Ly8gU3VwcG9ydCBpY29ucyBpbiBtZXNzYWdlc1xuXHRcdGlmIChjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvcCA9IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQ7XG5cdFx0fSwgTm92YVNpZGViYXJWaWV3LlNDUk9MTF9ERUxBWV9NUyk7XG5cdH1cblxuXHRwcml2YXRlIGFkZEVycm9yTWVzc2FnZShjb250ZW50OiBzdHJpbmcpIHtcblx0XHR0aGlzLmNyZWF0ZVNpbXBsZU1lc3NhZ2UoY29udGVudCwgJ25vdmEtbWVzc2FnZS1lcnJvcicpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTdWNjZXNzTWVzc2FnZShjb250ZW50OiBzdHJpbmcpIHtcblx0XHR0aGlzLmNyZWF0ZVNpbXBsZU1lc3NhZ2UoY29udGVudCwgJ25vdmEtbWVzc2FnZS1zdWNjZXNzJyk7XG5cdH1cblxuXHRwcml2YXRlIGFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2U/OiBzdHJpbmcpIHtcblx0XHRjb25zdCB3ZWxjb21lRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lJyB9KTtcblx0XHR3ZWxjb21lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRtYXJnaW46IHZhcigtLXNpemUtNC00KSBhdXRvO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTQpIHZhcigtLXNpemUtNC01KTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtbCk7XG5cdFx0XHRtYXgtd2lkdGg6IDkwJTtcblx0XHRcdGFuaW1hdGlvbjogZmFkZUluIDAuNXMgZWFzZS1pbjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIE5vdmEgc3RhciBpY29uIChzdGF0aWMsIG5vdCBhbmltYXRlZClcblx0XHRjb25zdCBpY29uQ29udGFpbmVyID0gd2VsY29tZUVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtd2VsY29tZS1pY29uJyB9KTtcblx0XHRpY29uQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHR3aWR0aDogdmFyKC0taWNvbi1zaXplLXhsKTtcblx0XHRcdGhlaWdodDogdmFyKC0taWNvbi1zaXplLXhsKTtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdGA7XG5cdFx0XG5cdFx0aWNvbkNvbnRhaW5lci5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiB2YXIoLS1pY29uLXNpemUteGwpOyBoZWlnaHQ6IHZhcigtLWljb24tc2l6ZS14bCk7IGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+XG5cdFx0YDtcblx0XHRcblx0XHQvLyBXZWxjb21lIHRleHRcblx0XHRjb25zdCB0ZXh0Q29udGFpbmVyID0gd2VsY29tZUVsLmNyZWF0ZURpdigpO1xuXHRcdHRleHRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXg6IDE7XG5cdFx0XHRsaW5lLWhlaWdodDogMS40O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgdGl0bGVFbCA9IHRleHRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogJ0hpISBJXFwnbSBOb3ZhLicgfSk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdGV4dC1zaXplKTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHN1YnRpdGxlRWwgPSB0ZXh0Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IG1lc3NhZ2UgfHwgJycgfSk7XG5cdFx0c3VidGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0Zm9udC1zaXplOiAwLjllbTtcblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG8oe1xuXHRcdFx0XHR0b3A6IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQsXG5cdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJ1xuXHRcdFx0fSk7XG5cdFx0fSwgTm92YVNpZGViYXJWaWV3LlNDUk9MTF9ERUxBWV9NUyk7XG5cdH1cblxuXHRwcml2YXRlIGFkZFN1Y2Nlc3NJbmRpY2F0b3IoYWN0aW9uOiBzdHJpbmcpIHtcblx0XHRjb25zdCBpbmRpY2F0b3JFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Y2Nlc3MtaW5kaWNhdG9yJyB9KTtcblx0XHRpbmRpY2F0b3JFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdG1hcmdpbjogOHB4IGF1dG87XG5cdFx0XHRwYWRkaW5nOiA2cHggMTJweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEoNzYsIDE3NSwgODAsIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKDc2LCAxNzUsIDgwLCAwLjMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogMTZweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRtYXgtd2lkdGg6IDIwMHB4O1xuXHRcdFx0YW5pbWF0aW9uOiBmYWRlSW4gMC4zcyBlYXNlLWluO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gQWRkIGNoZWNrbWFyayBhbmQgdGV4dFxuXHRcdGluZGljYXRvckVsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgc3R5bGU9XCJ3aWR0aDogMTJweDsgaGVpZ2h0OiAxMnB4OyBtYXJnaW4tcmlnaHQ6IDZweDsgYm9yZGVyLXJhZGl1czogNTAlOyBiYWNrZ3JvdW5kOiB2YXIoLS10ZXh0LXN1Y2Nlc3MpOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcIj5cblx0XHRcdFx0PGRpdiBzdHlsZT1cIndpZHRoOiA0cHg7IGhlaWdodDogMnB4OyBib3JkZXItbGVmdDogMXB4IHNvbGlkIHdoaXRlOyBib3JkZXItYm90dG9tOiAxcHggc29saWQgd2hpdGU7IHRyYW5zZm9ybTogcm90YXRlKC00NWRlZykgdHJhbnNsYXRlKC0wLjVweCwgLTAuNXB4KTtcIj48L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdFx0JHt0aGlzLmdldENvbXBhY3RTdWNjZXNzTWVzc2FnZShhY3Rpb24pfVxuXHRcdGA7XG5cblx0XHQvLyBBdXRvLXNjcm9sbCB0byBib3R0b21cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRzd2l0Y2ggKGFjdGlvbikge1xuXHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGFkZGVkJztcblx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgZWRpdGVkJztcblx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBkZWxldGVkJztcblx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRyZXR1cm4gJ0dyYW1tYXIgZml4ZWQnO1xuXHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCByZXdyaXR0ZW4nO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuICdDb21tYW5kIGNvbXBsZXRlZCc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0Ly8gQ2hlY2sgaWYgY29tbWFuZCBzeXN0ZW0gZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3phcCcsICdDb21tYW5kcyBhcmUgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgU3VwZXJub3ZhIHN1cHBvcnRlcnMuIEF2YWlsYWJsZSB0byBhbGwgdXNlcnMgU2VwdGVtYmVyIDMwLCAyMDI1LicpKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbW1hbmQgPSBtZXNzYWdlLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7IC8vIFJlbW92ZSAnOicgYW5kIG5vcm1hbGl6ZVxuXG5cdFx0Ly8gUHJvdmlkZXIgc3dpdGNoaW5nIGNvbW1hbmRzXG5cdFx0Y29uc3QgcHJvdmlkZXJDb21tYW5kczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnY2xhdWRlJyxcblx0XHRcdCdjaGF0Z3B0JzogJ29wZW5haScsXG5cdFx0XHQnb3BlbmFpJzogJ29wZW5haScsXG5cdFx0XHQnZ2VtaW5pJzogJ2dvb2dsZScsXG5cdFx0XHQnZ29vZ2xlJzogJ2dvb2dsZScsXG5cdFx0XHQnb2xsYW1hJzogJ29sbGFtYSdcblx0XHR9O1xuXG5cdFx0aWYgKHByb3ZpZGVyQ29tbWFuZHNbY29tbWFuZF0pIHtcblx0XHRcdGNvbnN0IHByb3ZpZGVySWQgPSBwcm92aWRlckNvbW1hbmRzW2NvbW1hbmRdO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2V0dGluZ1RhYi5zZXRDdXJyZW50UHJvdmlkZXIocHJvdmlkZXJJZCk7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgncmVmcmVzaC1jdycsIGBTd2l0Y2hlZCB0byAke3RoaXMuZ2V0UHJvdmlkZXJXaXRoTW9kZWxEaXNwbGF5TmFtZShwcm92aWRlcklkKX1gKSk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY3VzdG9tIGNvbW1hbmRzIChpZiBmZWF0dXJlIGVuYWJsZWQpXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uZmluZChjbWQgPT4gY21kLnRyaWdnZXIgPT09IGNvbW1hbmQpO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmQpIHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBjdXN0b20gY29tbWFuZFxuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGN1c3RvbUNvbW1hbmQudGVtcGxhdGUpO1xuXHRcdFx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBhZnRlciBzZXR0aW5nIHRlbXBsYXRlXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5hdXRvR3Jvd1RleHRhcmVhKCksIDApO1xuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2VkaXQnLCBgTG9hZGVkIHRlbXBsYXRlOiAke2N1c3RvbUNvbW1hbmQubmFtZX1gKSk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFVua25vd24gY29tbWFuZFxuXHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2hlbHAtY2lyY2xlJywgYFVua25vd24gY29tbWFuZCAnOiR7Y29tbWFuZH0nLiBUcnkgOmNsYXVkZSwgOmNoYXRncHQsIDpnZW1pbmksIG9yIDpvbGxhbWFgKSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtcGlja2VyIG5vdmEtcGFuZWwtYmFzZScgfSk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiBub25lO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4IDhweCAwIDA7XG5cdFx0XHRtYXgtaGVpZ2h0OiAyMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdGJveC1zaGFkb3c6IDAgLTRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVJbnB1dENoYW5nZSgpOiB2b2lkIHtcblx0XHRjb25zdCB2YWx1ZSA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRcblx0XHRpZiAodmFsdWUuc3RhcnRzV2l0aCgnOicpICYmIHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IHF1ZXJ5ID0gdmFsdWUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRQaWNrZXIocXVlcnkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZFBpY2tlcihxdWVyeTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCkuZmlsdGVyKGNtZCA9PiBcblx0XHRcdGNtZC50cmlnZ2VyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkpIHx8IGNtZC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkpXG5cdFx0KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5lbXB0eSgpO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zID0gW107XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXG5cdFx0aWYgKGNvbW1hbmRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbW1hbmRzLmZvckVhY2goKGNvbW1hbmQsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBpdGVtID0gdGhpcy5jb21tYW5kUGlja2VyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pdGVtIG5vdmEtcGFuZWwtaXRlbScgfSk7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyIG5vdmEtcGFuZWwtdHJpZ2dlcicgfSk7XG5cdFx0XHR0cmlnZ2VyRWwudGV4dENvbnRlbnQgPSBgOiR7Y29tbWFuZC50cmlnZ2VyfWA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC1uYW1lIG5vdmEtcGFuZWwtdGV4dCcgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmbGV4OiAxOyc7XG5cblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjIG5vdmEtcGFuZWwtbXV0ZWQnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0fVxuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNlbGVjdENvbW1hbmQoY29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2V0U2VsZWN0ZWRDb21tYW5kKGluZGV4KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHR9XG5cblx0cHJpdmF0ZSBoaWRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cdH1cblxuXHRwcml2YXRlIGlzQ29tbWFuZFBpY2tlclZpc2libGUoKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snO1xuXHR9XG5cblx0cHJpdmF0ZSBuYXZpZ2F0ZUNvbW1hbmRQaWNrZXIoZGlyZWN0aW9uOiBudW1iZXIpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cblx0XHRjb25zdCBuZXdJbmRleCA9IE1hdGgubWF4KDAsIE1hdGgubWluKFxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoIC0gMSxcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggKyBkaXJlY3Rpb25cblx0XHQpKTtcblxuXHRcdHRoaXMuc2V0U2VsZWN0ZWRDb21tYW5kKG5ld0luZGV4KTtcblx0fVxuXG5cdHByaXZhdGUgc2V0U2VsZWN0ZWRDb21tYW5kKGluZGV4OiBudW1iZXIpOiB2b2lkIHtcblx0XHQvLyBSZW1vdmUgcHJldmlvdXMgc2VsZWN0aW9uXG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMuZm9yRWFjaChpdGVtID0+IHtcblx0XHRcdGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gaW5kZXg7XG5cblx0XHRpZiAoaW5kZXggPj0gMCAmJiBpbmRleCA8IHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCkge1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXNbaW5kZXhdLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXNbaW5kZXhdLnNjcm9sbEludG9WaWV3KHsgYmxvY2s6ICduZWFyZXN0JyB9KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogYm9vbGVhbiB7XG5cdFx0aWYgKCF0aGlzLmlzQ29tbWFuZFBpY2tlclZpc2libGUoKSB8fCB0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID09PSAtMSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpO1xuXHRcdGNvbnN0IHNlbGVjdGVkQ29tbWFuZCA9IGNvbW1hbmRzW3RoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXhdO1xuXHRcdFxuXHRcdGlmIChzZWxlY3RlZENvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2VsZWN0Q29tbWFuZChzZWxlY3RlZENvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIHNlbGVjdENvbW1hbmQodHJpZ2dlcjogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShgOiR7dHJpZ2dlcn1gKTtcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0Ly8gVHJpZ2dlciB0aGUgY29tbWFuZCBpbW1lZGlhdGVseVxuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBdmFpbGFibGVDb21tYW5kcygpOiBBcnJheTx7dHJpZ2dlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nfT4ge1xuXHRcdGNvbnN0IGNvbW1hbmRzOiBBcnJheTx7dHJpZ2dlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nfT4gPSBbXG5cdFx0XHR7IHRyaWdnZXI6ICdjbGF1ZGUnLCBuYW1lOiAnU3dpdGNoIHRvIENsYXVkZScsIGRlc2NyaXB0aW9uOiAnQW50aHJvcGljIENsYXVkZSBBSScgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2NoYXRncHQnLCBuYW1lOiAnU3dpdGNoIHRvIENoYXRHUFQnLCBkZXNjcmlwdGlvbjogJ09wZW5BSSBHUFQgbW9kZWxzJyB9LFxuXHRcdFx0eyB0cmlnZ2VyOiAnZ2VtaW5pJywgbmFtZTogJ1N3aXRjaCB0byBHZW1pbmknLCBkZXNjcmlwdGlvbjogJ0dvb2dsZSBHZW1pbmkgQUknIH1cblx0XHRdO1xuXG5cdFx0Ly8gT25seSBhZGQgT2xsYW1hIG9uIGRlc2t0b3Bcblx0XHRpZiAoUGxhdGZvcm0uaXNEZXNrdG9wQXBwKSB7XG5cdFx0XHRjb21tYW5kcy5wdXNoKHsgdHJpZ2dlcjogJ29sbGFtYScsIG5hbWU6ICdTd2l0Y2ggdG8gT2xsYW1hJywgZGVzY3JpcHRpb246ICdMb2NhbCBBSSBtb2RlbHMnIH0pO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBjdXN0b20gY29tbWFuZHMgaWYgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgfHwgW107XG5cdFx0XHRjdXN0b21Db21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRcdGNvbW1hbmRzLnB1c2goe1xuXHRcdFx0XHRcdHRyaWdnZXI6IGNtZC50cmlnZ2VyLFxuXHRcdFx0XHRcdG5hbWU6IGNtZC5uYW1lLFxuXHRcdFx0XHRcdC4uLihjbWQuZGVzY3JpcHRpb24gJiYgeyBkZXNjcmlwdGlvbjogY21kLmRlc2NyaXB0aW9uIH0pXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbW1hbmRzO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudSBub3ZhLXBhbmVsLWJhc2UnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWluLXdpZHRoOiAyNDBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDMwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cblx0XHQvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51LmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSAmJiBcblx0XHRcdFx0IXRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyKTtcblx0fVxuXG5cdHByaXZhdGUgdG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3phcCcsICdDb21tYW5kcyBhcmUgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgU3VwZXJub3ZhIHN1cHBvcnRlcnMuIEF2YWlsYWJsZSB0byBhbGwgdXNlcnMgU2VwdGVtYmVyIDMwLCAyMDI1LicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRcblx0XHR0aGlzLmNvbW1hbmRNZW51LmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWhlYWRlciBub3ZhLXBhbmVsLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd6YXAnKSArICcgQ29tbWFuZHMnO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdGNvbW1hbmRzLmZvckVhY2goY29tbWFuZCA9PiB7XG5cdFx0XHRjb25zdCBpdGVtID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1pdGVtIG5vdmEtcGFuZWwtaXRlbS12ZXJ0aWNhbCcgfSk7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtbmFtZSBub3ZhLXBhbmVsLXRleHQnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5vcGFjaXR5ID0gJzAuOCc7XG5cblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtZGVzYyBub3ZhLXBhbmVsLW11dGVkJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5leGVjdXRlQ29tbWFuZEZyb21NZW51KGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBleGVjdXRlQ29tbWFuZEZyb21NZW51KHRyaWdnZXI6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XG5cdFx0Ly8gRXhlY3V0ZSB0aGUgY29tbWFuZCBkaXJlY3RseVxuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoYDoke3RyaWdnZXJ9YCk7XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtaW5kaWNhdG9yJyB9KTtcblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDhweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdC8vIFJldHVybiBhIGR1bW15IGVsZW1lbnQgdGhhdCB3b24ndCBiZSB1c2VkXG5cdFx0XHRyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIGEgcHJldmlldyBhcmVhIHRoYXQgc2hvd3MgbGl2ZSBjb250ZXh0IGFzIHVzZXIgdHlwZXNcblx0XHRjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRgO1xuXG5cdFx0Y29uc3QgcHJldmlld1RleHQgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy10ZXh0JyB9KTtcblx0XHRwcmV2aWV3VGV4dC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgJyBDb250ZXh0IHdpbGwgaW5jbHVkZTogJztcblx0XHRwcmV2aWV3VGV4dC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnIH0pO1xuXHRcdHByZXZpZXdMaXN0LnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7JztcblxuXHRcdHJldHVybiBwcmV2aWV3Q29udGFpbmVyO1xuXHR9XG5cblx0LyoqXG5cdCAqIERlYm91bmNlZCB2ZXJzaW9uIG9mIHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyBmb3IgcGVyZm9ybWFuY2Vcblx0ICovXG5cdHByaXZhdGUgZGVib3VuY2VkVXBkYXRlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy51cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBudWxsO1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5DT05URVhUX1BSRVZJRVdfREVCT1VOQ0VfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRQcmV2aWV3IHx8ICF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbWVzc2FnZSA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Ly8gTm90ZTogQWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50IGZvciBzaW1wbGlmaWVkIFVYXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0XG5cdFx0XHQvLyBUcnkgdG8gZmluZCB0aGUgZmlsZSB0byB2YWxpZGF0ZSBpdCBleGlzdHNcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmZpbmRGaWxlQnlOYW1lKGRvY05hbWUpO1xuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvY05hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgY3VycmVudCBmaWxlXG5cdFx0Y29uc3QgcGVyc2lzdGVudERvY3MgPSB0aGlzLm11bHRpRG9jSGFuZGxlci5nZXRQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlPy5wYXRoIHx8ICcnKTtcblx0XHRwZXJzaXN0ZW50RG9jcy5mb3JFYWNoKGRvYyA9PiB7XG5cdFx0XHQvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBpbiBmb3VuZFJlZnMgdG8gYXZvaWQgZHVwbGljYXRlc1xuXHRcdFx0Y29uc3QgZXhpc3RzID0gZm91bmRSZWZzLnNvbWUocmVmID0+IHJlZi5uYW1lID09PSBkb2MuZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRmb3VuZFJlZnMucHVzaCh7XG5cdFx0XHRcdFx0bmFtZTogZG9jLmZpbGUuYmFzZW5hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHk6IGRvYy5wcm9wZXJ0eVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3XG5cdFx0aWYgKGZvdW5kUmVmcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChwcmV2aWV3TGlzdCkge1xuXHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGZvdW5kUmVmcy5tYXAocmVmID0+IHtcblx0XHRcdFx0XHRjb25zdCBzdWZmaXggPSByZWYucHJvcGVydHkgPyBgIyR7cmVmLnByb3BlcnR5fWAgOiAnJztcblx0XHRcdFx0XHRyZXR1cm4gYCR7cmVmLm5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gZG9jTmFtZXMuam9pbignLCAnKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGZpbmRGaWxlQnlOYW1lKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdFx0Ly8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG5cdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuXHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRmaWxlID0gZmlsZXMuZmluZChmID0+IFxuXHRcdFx0XHRmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuXHRcdFx0XHRmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG5cdFx0XHQpIHx8IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29udGV4dEluZGljYXRvcigpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5lbXB0eSgpO1xuXHRcdFxuXHRcdGlmICghdGhpcy5jdXJyZW50Q29udGV4dCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGFsbERvY3MgPSB0aGlzLmN1cnJlbnRDb250ZXh0LnBlcnNpc3RlbnREb2NzO1xuXHRcdFxuXHRcdGlmIChhbGxEb2NzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gU2hvdyBhcyB0aGluIGxpbmUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIHNpemluZ1xuXHRcdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBibG9jaztcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMC45ZW0nIDogJzAuOGVtJ307XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHQvLyBTaW5nbGUgbGluZSBzdW1tYXJ5IChzYW1lIHN0eWxlIGFzIGxpdmUgcHJldmlldylcblx0XHRjb25zdCBzdW1tYXJ5RWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXN1bW1hcnknIH0pO1xuXHRcdHN1bW1hcnlFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBhdXRvO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3Qgc3VtbWFyeVRleHRFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXN1bW1hcnktdGV4dCcgfSk7XG5cdFx0XG5cdFx0Y29uc3QgdG9rZW5QZXJjZW50ID0gTWF0aC5yb3VuZCgodGhpcy5jdXJyZW50Q29udGV4dC50b2tlbkNvdW50IC8gODAwMCkgKiAxMDApO1xuXHRcdGNvbnN0IGRvY05hbWVzID0gYWxsRG9jcy5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5zbGljZSgwLCBpc01vYmlsZSA/IDEgOiAyKTtcblx0XHRjb25zdCBtb3JlQ291bnQgPSBhbGxEb2NzLmxlbmd0aCA+IChpc01vYmlsZSA/IDEgOiAyKSA/IGAgKyR7YWxsRG9jcy5sZW5ndGggLSAoaXNNb2JpbGUgPyAxIDogMil9YCA6ICcnO1xuXHRcdFxuXHRcdC8vIE1vYmlsZS1vcHRpbWl6ZWQgdGV4dCAoc2hvcnRlciBvbiBtb2JpbGUpIHdpdGggcHJvcGVyIGZsZXggYWxpZ25tZW50XG5cdFx0c3VtbWFyeVRleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZmxleDogMTsgcG9pbnRlci1ldmVudHM6IG5vbmU7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cdFx0XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5VGV4dEVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJykgKyBgICR7ZG9jTmFtZXMuam9pbignLCAnKX0ke21vcmVDb3VudH0gKCR7dG9rZW5QZXJjZW50fSUpYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3VtbWFyeVRleHRFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCAke2RvY05hbWVzLmpvaW4oJywgJyl9JHttb3JlQ291bnR9ICgke3Rva2VuUGVyY2VudH0lIHRva2VucylgO1xuXHRcdH1cblx0XHRcblx0XHQvLyBNb2JpbGUtZnJpZW5kbHkgbW9yZSBtZW51IGluZGljYXRvclxuXHRcdGNvbnN0IGV4cGFuZEluZGljYXRvckVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kLWluZGljYXRvcicgfSk7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdtb3JlLWhvcml6b250YWwnLCBpc01vYmlsZSA/ICcxNnB4JyA6ICcxNHB4Jyk7IC8vIE1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Y29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCd9O1xuXHRcdFx0b3BhY2l0eTogMC44O1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHgnIDogJzRweCd9O1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0YDtcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zZXRBdHRyKCd0aXRsZScsICdUYXAgdG8gbWFuYWdlIGRvY3VtZW50cycpO1xuXHRcdFxuXHRcdC8vIFZpc3VhbCBmZWVkYmFjayBvbiB0aGUgd2hvbGUgc3VtbWFyeSBsaW5lIGluc3RlYWQgb2YganVzdCB0aGUgaW5kaWNhdG9yXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpJztcblx0XHRcdH0pO1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFkZFRyYWNrZWRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKSc7XG5cdFx0XHR9KTtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gRXhwYW5kZWQgc3RhdGUgLSBtb2JpbGUtcmVzcG9uc2l2ZSBvdmVybGF5XG5cdFx0Y29uc3QgZXhwYW5kZWRFbCA9IHRoaXMuY29udGV4dEluZGljYXRvci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kZWQnIH0pO1xuXHRcdGV4cGFuZGVkRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAke2lzTW9iaWxlID8gJy04cHgnIDogJzAnfTtcblx0XHRcdHJpZ2h0OiAke2lzTW9iaWxlID8gJy04cHgnIDogJzAnfTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCAke2lzTW9iaWxlID8gJy00cHggMTZweCcgOiAnLTJweCA4cHgnfSByZ2JhKDAsIDAsIDAsICR7aXNNb2JpbGUgPyAnMC4xNScgOiAnMC4xJ30pO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDJweDtcblx0XHRcdG1heC1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNjB2aCcgOiAnMjAwcHgnfTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRtaW4td2lkdGg6ICR7aXNNb2JpbGUgPyAnMTAwJScgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyIGZvciBleHBhbmRlZCBzdGF0ZSB3aXRoIG1vYmlsZS1vcHRpbWl6ZWQgY2xlYXIgYnV0dG9uXG5cdFx0Y29uc3QgZXhwYW5kZWRIZWFkZXJFbCA9IGV4cGFuZGVkRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkLWhlYWRlcicgfSk7XG5cdFx0ZXhwYW5kZWRIZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJUaXRsZUVsID0gZXhwYW5kZWRIZWFkZXJFbC5jcmVhdGVTcGFuKCk7XG5cdFx0aGVhZGVyVGl0bGVFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCBEb2N1bWVudHMgKCR7YWxsRG9jcy5sZW5ndGh9KWA7XG5cdFx0aGVhZGVyVGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgYWxsIGJ1dHRvbiB1c2luZyBzYW1lIGljb24gYXMgbWFpbiBzaWRlYmFyXG5cdFx0Y29uc3QgY2xlYXJBbGxCdG5Db21wb25lbnQgPSBuZXcgQnV0dG9uQ29tcG9uZW50KGV4cGFuZGVkSGVhZGVyRWwpO1xuXHRcdGNsZWFyQWxsQnRuQ29tcG9uZW50LnNldEljb24oJ2VyYXNlcicpXG5cdFx0XHQuc2V0VG9vbHRpcCgnQ2xlYXIgYWxsIGRvY3VtZW50cyBmcm9tIGNvbnRleHQnKVxuXHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyLmNsZWFyUGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZS5wYXRoKTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFxuXHRcdGNvbnN0IGNsZWFyQWxsQnRuID0gY2xlYXJBbGxCdG5Db21wb25lbnQuYnV0dG9uRWw7XG5cdFx0Y2xlYXJBbGxCdG4uYWRkQ2xhc3MoJ25vdmEtY29udGV4dC1jbGVhci1hbGwtYnRuJyk7XG5cdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnOHB4IDEycHgnIDogJzRweCA4cHgnfTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRtaW4td2lkdGg6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gVG91Y2gtZnJpZW5kbHkgZmVlZGJhY2sgZm9yIGNsZWFyIGJ1dHRvblxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0fSk7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0fSk7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHQvLyBEb2N1bWVudCBsaXN0IGZvciBleHBhbmRlZCBzdGF0ZVxuXHRcdGNvbnN0IGRvY0xpc3RFbCA9IGV4cGFuZGVkRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1saXN0JyB9KTtcblx0XHRcblx0XHRhbGxEb2NzLmZvckVhY2goKGRvYywgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGRvY0l0ZW1FbCA9IGRvY0xpc3RFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWl0ZW0nIH0pO1xuXHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRcdGJvcmRlci1ib3R0b206ICR7aW5kZXggPCBhbGxEb2NzLmxlbmd0aCAtIDEgPyAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScgOiAnbm9uZSd9O1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG5cdFx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNTZweCcgOiAnYXV0byd9O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgZG9jSW5mb0VsID0gZG9jSXRlbUVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtaW5mbycgfSk7XG5cdFx0XHRkb2NJbmZvRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiAke2lzTW9iaWxlID8gJzEycHgnIDogJzhweCd9O1xuXHRcdFx0XHRmbGV4OiAxO1xuXHRcdFx0XHRtaW4td2lkdGg6IDA7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBpY29uRWwgPSBkb2NJbmZvRWwuY3JlYXRlU3BhbigpO1xuXHRcdFx0aWNvbkVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignZmlsZS10ZXh0Jyk7XG5cdFx0XHRpY29uRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmb250LXNpemU6IDFlbTsnO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBuYW1lRWwgPSBkb2NJbmZvRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtbmFtZScgfSk7XG5cdFx0XHRjb25zdCBzdWZmaXggPSBkb2MucHJvcGVydHkgPyBgIyR7ZG9jLnByb3BlcnR5fWAgOiAnJztcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGAke2RvYy5maWxlLmJhc2VuYW1lfSR7c3VmZml4fWA7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDQwMDtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0dGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG5cdFx0XHRcdG92ZXJmbG93OiBoaWRkZW47XG5cdFx0XHRcdHdoaXRlLXNwYWNlOiBub3dyYXA7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdFx0XHRsaW5lLWhlaWdodDogMS40O1xuXHRcdFx0YDtcblx0XHRcdG5hbWVFbC5zZXRBdHRyKCd0aXRsZScsIGAke2RvYy5maWxlLnBhdGh9IChyZWFkLW9ubHkgZm9yIGVkaXRpbmcpYCk7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCByZWFkLW9ubHkgaW5kaWNhdG9yXG5cdFx0XHRjb25zdCByZWFkT25seUVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcmVhZG9ubHknIH0pO1xuXHRcdFx0cmVhZE9ubHlFbC50ZXh0Q29udGVudCA9ICdyZWFkLW9ubHknO1xuXHRcdFx0cmVhZE9ubHlFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXNpemU6IDAuNzVlbTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdFx0cGFkZGluZzogMXB4IDRweDtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogM3B4O1xuXHRcdFx0XHRtYXJnaW4tbGVmdDogNnB4O1xuXHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHR0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuXHRcdFx0XHRsZXR0ZXItc3BhY2luZzogMC41cHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBNb2JpbGUtb3B0aW1pemVkIHJlbW92ZSBidXR0b24gd2l0aCBsYXJnZXIgdG91Y2ggdGFyZ2V0XG5cdFx0XHRjb25zdCByZW1vdmVCdG4gPSBkb2NJdGVtRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1yZW1vdmUnIH0pO1xuXHRcdFx0cmVtb3ZlQnRuLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbigneCcsIGlzTW9iaWxlID8gJzE4cHgnIDogJzE0cHgnKTtcblx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHR3aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcxOHB4JyA6ICcxNHB4J307XG5cdFx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0XHRmb250LXdlaWdodDogYm9sZDtcblx0XHRcdGA7XG5cdFx0XHRyZW1vdmVCdG4uc2V0QXR0cigndGl0bGUnLCBgUmVtb3ZlICR7ZG9jLmZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyLnJlbW92ZVBlcnNpc3RlbnREb2ModGhpcy5jdXJyZW50RmlsZS5wYXRoLCBkb2MuZmlsZS5wYXRoKTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBQbGF0Zm9ybS1zcGVjaWZpYyBpbnRlcmFjdGlvbiBmZWVkYmFja1xuXHRcdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVG91Y2ggZmVlZGJhY2sgZm9yIGRvY3VtZW50IGl0ZW1zXG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBDbGljayB0byBleHBhbmQgbWFuYWdlbWVudCBvdmVybGF5XG5cdFx0bGV0IGlzRXhwYW5kZWQgPSBmYWxzZTtcblx0XHRcblx0XHRjb25zdCB0b2dnbGVFeHBhbmRlZCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0aXNFeHBhbmRlZCA9ICFpc0V4cGFuZGVkO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNFeHBhbmRlZCkge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJzEwMDEnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQ2xpY2sgb24gdGhlIGVudGlyZSBzdW1tYXJ5IGxpbmUgdG8gZXhwYW5kXG5cdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRXhwYW5kZWQpO1xuXHRcdFxuXHRcdC8vIENsb3NlIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChlOiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKGlzRXhwYW5kZWQgJiYgIXRoaXMuY29udGV4dEluZGljYXRvci5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0V4cGFuZGVkID0gZmFsc2U7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm11bHRpRG9jSGFuZGxlci5idWlsZENvbnRleHQoJycsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IHJlc3VsdC5jb250ZXh0O1xuXHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVTZW5kKG1lc3NhZ2U/OiBzdHJpbmcpIHtcblx0XHQvLyBHZXQgbWVzc2FnZSBmcm9tIHBhcmFtZXRlciBvciBmcm9tIGlucHV0IGhhbmRsZXJcblx0XHRjb25zdCBtZXNzYWdlVGV4dCA9IG1lc3NhZ2UgfHwgdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VmFsdWUoKS50cmltKCk7XG5cdFx0aWYgKCFtZXNzYWdlVGV4dCkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgTm92YSBpcyBlbmFibGVkIGFuZCBhIHByb3ZpZGVyIGlzIGF2YWlsYWJsZVxuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0aWYgKCFjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdhbGVydC1jaXJjbGUnLCAnTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUuIFBsZWFzZSBjb25maWd1cmUgYW4gQUkgcHJvdmlkZXIgaW4gc2V0dGluZ3MuJykpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGZvciBjb21tYW5kIHN5c3RlbSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdGlmIChtZXNzYWdlVGV4dC5zdGFydHNXaXRoKCc6JykpIHtcblx0XHRcdGNvbnN0IGNvbW1hbmRSZXN1bHQgPSBhd2FpdCB0aGlzLmhhbmRsZUNvbG9uQ29tbWFuZChtZXNzYWdlVGV4dCk7XG5cdFx0XHRpZiAoY29tbWFuZFJlc3VsdCkge1xuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWQgYW5kIHBhcnNlIHJlZmVyZW5jZXNcblx0XHRsZXQgcHJvY2Vzc2VkTWVzc2FnZSA9IG1lc3NhZ2VUZXh0O1xuXHRcdGxldCBtdWx0aURvY0NvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcdFxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHQvLyBDaGVjayBmb3IgZWFybHkgYWNjZXNzXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdFx0aWYgKG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdbWycpIHx8IG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCcrW1snKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnYm9vay1vcGVuJywgJ011bHRpLWRvY3VtZW50IGNvbnRleHQgaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgU3VwZXJub3ZhIHN1cHBvcnRlcnMuIEF2YWlsYWJsZSB0byBhbGwgdXNlcnMgQXVndXN0IDE1LCAyMDI1LicpKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFBhcnNlIGFuZCBidWlsZCBjb250ZXh0XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRSZXN1bHQgPSBhd2FpdCB0aGlzLm11bHRpRG9jSGFuZGxlci5idWlsZENvbnRleHQobWVzc2FnZVRleHQsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRwcm9jZXNzZWRNZXNzYWdlID0gY29udGV4dFJlc3VsdC5jbGVhbmVkTWVzc2FnZTtcblx0XHRcdFx0bXVsdGlEb2NDb250ZXh0ID0gY29udGV4dFJlc3VsdC5jb250ZXh0O1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbXVsdGlEb2NDb250ZXh0O1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVXBkYXRlIFVJIGluZGljYXRvclxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIG1lc3NhZ2UgaXMganVzdCBkb2N1bWVudCByZWZlcmVuY2VzIChjb250ZXh0LW9ubHkgbW9kZSlcblx0XHRcdFx0Ly8gU2luY2UgYWxsIGRvY3MgYXJlIG5vdyBwZXJzaXN0ZW50LCBjaGVjayBpZiB3ZSBoYXZlIG5ldyBkb2NzIGFuZCBlbXB0eSBtZXNzYWdlXG5cdFx0XHRcdGNvbnN0IHByZXZpb3VzUGVyc2lzdGVudENvdW50ID0gdGhpcy5jdXJyZW50Q29udGV4dD8ucGVyc2lzdGVudERvY3MubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuXHRcdFx0XHRjb25zdCBoYXNOZXdEb2NzID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCA+IHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRjb25zdCBpc0NvbnRleHRPbmx5TWVzc2FnZSA9IHByb2Nlc3NlZE1lc3NhZ2UudHJpbSgpLmxlbmd0aCA9PT0gMCAmJiBoYXNOZXdEb2NzO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGlzQ29udGV4dE9ubHlNZXNzYWdlKSB7XG5cdFx0XHRcdFx0Ly8gSGFuZGxlIGNvbnRleHQtb25seSBjb21tYW5kcyAtIHNob3cgbmV3bHkgYWRkZWQgZG9jdW1lbnRzXG5cdFx0XHRcdFx0Y29uc3QgbmV3RG9jc0NvdW50ID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCAtIHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRcdGlmIChuZXdEb2NzQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0XHQvLyBHZXQgdGhlIG5ld2x5IGFkZGVkIGRvY3VtZW50cyAobGFzdCBOIGRvY3VtZW50cylcblx0XHRcdFx0XHRcdGNvbnN0IG5ld0RvY3MgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3Muc2xpY2UoLW5ld0RvY3NDb3VudCk7XG5cdFx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IG5ld0RvY3MubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKTtcblx0XHRcdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnY2hlY2stY2lyY2xlJywgYEFkZGVkICR7bmV3RG9jc0NvdW50fSBkb2N1bWVudCR7bmV3RG9jc0NvdW50ICE9PSAxID8gJ3MnIDogJyd9IHRvIHBlcnNpc3RlbnQgY29udGV4dDogJHtkb2NOYW1lc31gKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIENsZWFyIGlucHV0IGFuZCB1cGRhdGUgY29udGV4dCBpbmRpY2F0b3Jcblx0XHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gSGlkZSBjb250ZXh0IHByZXZpZXcgc2luY2Ugd2UncmUgZG9uZVxuXHRcdFx0XHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gU2hvdyBjb250ZXh0IGNvbmZpcm1hdGlvbiBpZiBkb2N1bWVudHMgd2VyZSBpbmNsdWRlZCBpbiBhIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRjb25zdCBhbGxEb2NzID0gbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzO1xuXHRcdFx0XHRcdGNvbnN0IGRvY05hbWVzID0gYWxsRG9jcy5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5qb2luKCcsICcpO1xuXHRcdFx0XHRcdGNvbnN0IHRva2VuSW5mbyA9IG11bHRpRG9jQ29udGV4dC50b2tlbkNvdW50ID4gMCA/IGAgKH4ke211bHRpRG9jQ29udGV4dC50b2tlbkNvdW50fSB0b2tlbnMpYCA6ICcnO1xuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5jdXJyZW50RmlsZT8uYmFzZW5hbWUgfHwgJ2N1cnJlbnQgZmlsZSc7XG5cdFx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdib29rLW9wZW4nLCBgSW5jbHVkZWQgJHthbGxEb2NzLmxlbmd0aH0gZG9jdW1lbnQke2FsbERvY3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9IGluIGNvbnRleHQ6ICR7ZG9jTmFtZXN9JHt0b2tlbkluZm99LiBDb250ZXh0IGRvY3VtZW50cyBhcmUgcmVhZC1vbmx5OyBlZGl0IGNvbW1hbmRzIHdpbGwgb25seSBtb2RpZnkgJHtjdXJyZW50RmlsZX0uYCkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayB0b2tlbiBsaW1pdFxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0LmlzTmVhckxpbWl0KSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIEFwcHJvYWNoaW5nIHRva2VuIGxpbWl0LiBDb25zaWRlciByZW1vdmluZyBzb21lIGRvY3VtZW50cyBmcm9tIGNvbnRleHQuJywgTm92YVNpZGViYXJWaWV3Lk5PVElDRV9EVVJBVElPTl9NUyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGQgdXNlciBtZXNzYWdlIChzaG93IG9yaWdpbmFsIHdpdGggcmVmZXJlbmNlcylcblx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlVGV4dCk7XG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFxuXHRcdC8vIEhpZGUgY29udGV4dCBwcmV2aWV3IHNpbmNlIHdlJ3JlIHNlbmRpbmcgdGhlIG1lc3NhZ2Vcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0XHRcblx0XHQvLyBEaXNhYmxlIHNlbmQgYnV0dG9uIGR1cmluZyBwcm9jZXNzaW5nXG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0aWYgKHNlbmRCdXR0b24pIHNlbmRCdXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG5cblx0XHR0cnkge1xuXHRcdFx0Ly8gQWRkIGxvYWRpbmcgaW5kaWNhdG9yIHdpdGggYW5pbWF0ZWQgbm92YVxuXHRcdFx0Y29uc3QgbG9hZGluZ0VsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbG9hZGluZycgfSk7XG5cdFx0XHRsb2FkaW5nRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogMTJweCAxNnB4O1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDEycHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDhweDtcblx0XHRcdFx0bWF4LXdpZHRoOiA4MCU7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogMTBweDtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdC8vIENyZWF0ZSBhbmltYXRlZCBub3ZhIGJ1cnN0XG5cdFx0XHRjb25zdCBub3ZhQ29udGFpbmVyID0gbG9hZGluZ0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYnVyc3QtY29udGFpbmVyJyB9KTtcblx0XHRcdG5vdmFDb250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1idXJzdFwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNvcmVcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0xXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMlwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTNcIj48L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCB0ZXh0RWwgPSBsb2FkaW5nRWwuY3JlYXRlU3Bhbih7IHRleHQ6ICdOb3ZhIGlzIHRoaW5raW5nLi4uJyB9KTtcblx0XHRcdHRleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsnO1xuXG5cdFx0XHQvLyBTdG9yZSBtZXNzYWdlIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKG1lc3NhZ2VUZXh0KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIGNvbW1hbmQgb3IgY29udmVyc2F0aW9uXG5cdFx0XHRjb25zdCBpc0xpa2VseUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyWydpc0xpa2VseUNvbW1hbmQnXShwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdGxldCByZXNwb25zZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdFx0XHRcblx0XHRcdGlmIChpc0xpa2VseUNvbW1hbmQgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBQYXJzZSBhcyBjb21tYW5kIGFuZCByb3V0ZSB0byBhcHByb3ByaWF0ZSBoYW5kbGVyXG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGFzIGNvbnZlcnNhdGlvbiB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0XHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKHByb2Nlc3NlZE1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBtdWx0aS1kb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0ICYmIG11bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nKSB7XG5cdFx0XHRcdFx0Ly8gVGhlIGNvbnRleHQgYWxyZWFkeSBpbmNsdWRlcyB0aGUgY3VycmVudCBmaWxlLCBzbyB3ZSBjYW4gdXNlIGl0IGRpcmVjdGx5XG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRVc2VyUHJvbXB0ID0gYCR7bXVsdGlEb2NDb250ZXh0LmNvbnRleHRTdHJpbmd9XFxuXFxuLS0tXFxuXFxuVXNlciBSZXF1ZXN0OiAke3Byb2Nlc3NlZE1lc3NhZ2V9YDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgJycsIGVuaGFuY2VkVXNlclByb21wdCwge1xuXHRcdFx0XHRcdFx0dGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0XHRtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0IHx8ICcnLCBwcm9tcHQudXNlclByb21wdCwge1xuXHRcdFx0XHRcdFx0dGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0XHRtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yXG5cdFx0XHRsb2FkaW5nRWwucmVtb3ZlKCk7XG5cdFx0XHRcblx0XHRcdC8vIEZpbHRlciB0aGlua2luZyBjb250ZW50IGZyb20gcmVzcG9uc2Vcblx0XHRcdGNvbnN0IGZpbHRlcmVkUmVzcG9uc2UgPSByZXNwb25zZSA/IHRoaXMuZmlsdGVyVGhpbmtpbmdDb250ZW50KHJlc3BvbnNlKSA6IHJlc3BvbnNlO1xuXHRcdFx0XG5cdFx0XHQvLyBTdG9yZSBmaWx0ZXJlZCByZXNwb25zZSBpbiBjb252ZXJzYXRpb24gbWFuYWdlciAoaWYgcmVzcG9uc2UgZXhpc3RzKVxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUgJiYgZmlsdGVyZWRSZXNwb25zZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKGZpbHRlcmVkUmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBBZGQgZmlsdGVyZWQgQUkgcmVzcG9uc2UgKG9ubHkgaWYgdGhlcmUgaXMgYSByZXNwb25zZSlcblx0XHRcdGlmIChmaWx0ZXJlZFJlc3BvbnNlKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIHJlc3BvbnNlIGlzIGFuIGVycm9yIG1lc3NhZ2UgKGNvbnRhaW5zIHgtY2lyY2xlIGljb24gb3IgZXJyb3Iga2V5d29yZHMpXG5cdFx0XHRcdGlmIChmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCd4LWNpcmNsZScpIHx8IFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ0Vycm9yIGV4ZWN1dGluZyBjb21tYW5kJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdGYWlsZWQgdG8nKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ05vIG1hcmtkb3duIGZpbGUgaXMgb3BlbicpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnVW5hYmxlIHRvIGFjY2VzcycpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnVW5hYmxlIHRvIHNldCcpKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoZmlsdGVyZWRSZXNwb25zZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCBmaWx0ZXJlZFJlc3BvbnNlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3IgaWYgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtbG9hZGluZycpO1xuXHRcdFx0aWYgKGxvYWRpbmdFbCkgbG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBTb3JyeSwgSSBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCkpO1xuXHRcdH0gZmluYWxseSB7XG5cdFx0XHQvLyBSZS1lbmFibGUgc2VuZCBidXR0b25cblx0XHRcdGNvbnN0IHNlbmRCdXR0b24gPSAodGhpcy5pbnB1dEhhbmRsZXIgYXMgYW55KS5zZW5kQnV0dG9uO1xuXHRcdFx0aWYgKHNlbmRCdXR0b24pIHNlbmRCdXR0b24uc2V0RGlzYWJsZWQoZmFsc2UpO1xuXHRcdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGluZGljYXRvciB0byBzaG93IHBlcnNpc3RlbnQgZG9jdW1lbnRzXG5cdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgaW5zZXJ0VGV4dEludG9BY3RpdmVOb3RlKHRleHQ6IHN0cmluZykge1xuXHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XG5cdFx0aWYgKGFjdGl2ZVZpZXcgJiYgJ2VkaXRvcicgaW4gYWN0aXZlVmlldykge1xuXHRcdFx0Y29uc3QgZWRpdG9yID0gKGFjdGl2ZVZpZXcgYXMgYW55KS5lZGl0b3I7XG5cdFx0XHRpZiAoZWRpdG9yKSB7XG5cdFx0XHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0ZWRpdG9yLnJlcGxhY2VSYW5nZSh0ZXh0LCBjdXJzb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgZXhlY3V0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhIGN1cnJlbnQgZmlsZSAodGhlIG9uZSB3ZSdyZSBjaGF0dGluZyBhYm91dClcblx0XHRcdGlmICghdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCAnTm8gbWFya2Rvd24gZmlsZSBpcyBvcGVuLiBQbGVhc2Ugb3BlbiBhIGZpbGUgaW4gdGhlIGVkaXRvciB0byB1c2UgZWRpdGluZyBjb21tYW5kcy4nKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gRW5zdXJlIHRoZXJlJ3MgYSBtYXJrZG93biB2aWV3IHdpdGggdGhpcyBmaWxlXG5cdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuXHRcdFx0bGV0IG1hcmtkb3duVmlldzogTWFya2Rvd25WaWV3IHwgbnVsbCA9IG51bGw7XG5cdFx0XHRcblx0XHRcdC8vIEZpbmQgdGhlIHZpZXcgd2l0aCBvdXIgZmlsZVxuXHRcdFx0Zm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0aWYgKHZpZXcuZmlsZSA9PT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdG1hcmtkb3duVmlldyA9IHZpZXc7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gSWYgbm90IGZvdW5kLCB0cnkgdG8gb3BlbiB0aGUgZmlsZVxuXHRcdFx0aWYgKCFtYXJrZG93blZpZXcpIHtcblx0XHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdFx0aWYgKGxlYWYpIHtcblx0XHRcdFx0XHRhd2FpdCBsZWFmLm9wZW5GaWxlKHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRcdG1hcmtkb3duVmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKCFtYXJrZG93blZpZXcpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYFVuYWJsZSB0byBhY2Nlc3MgdGhlIGZpbGUgXCIke3RoaXMuY3VycmVudEZpbGUuYmFzZW5hbWV9XCIuIFBsZWFzZSBtYWtlIHN1cmUgaXQncyBvcGVuIGluIHRoZSBlZGl0b3IuYCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENSSVRJQ0FMIFNFQ1VSSVRZOiBFbnN1cmUgdGhlIGFjdGl2ZSBmaWxlIG1hdGNoZXMgb3VyIGNvbnZlcnNhdGlvbiBmaWxlXG5cdFx0XHQvLyBUaGlzIHByZXZlbnRzIGFjY2lkZW50YWxseSBlZGl0aW5nIGNvbnRleHQgZG9jdW1lbnRzIHRoYXQgbWlnaHQgYmUgb3BlblxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoIWFjdGl2ZUZpbGUgfHwgYWN0aXZlRmlsZSAhPT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHQvLyBNYWtlIHRoZSBjb252ZXJzYXRpb24gZmlsZSBhY3RpdmUgYmVmb3JlIGV4ZWN1dGluZyBjb21tYW5kc1xuXHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihtYXJrZG93blZpZXcubGVhZiwgeyBmb2N1czogdHJ1ZSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIERvdWJsZS1jaGVjayB0aGF0IHRoZSBmaWxlIGlzIG5vdyBhY3RpdmVcblx0XHRcdFx0Y29uc3Qgbm93QWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdGlmICghbm93QWN0aXZlRmlsZSB8fCBub3dBY3RpdmVGaWxlICE9PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYFVuYWJsZSB0byBzZXQgXCIke3RoaXMuY3VycmVudEZpbGUuYmFzZW5hbWV9XCIgYXMgdGhlIGFjdGl2ZSBmaWxlLiBFZGl0IGNvbW1hbmRzIGNhbiBvbmx5IG1vZGlmeSB0aGUgZmlsZSB5b3UncmUgY2hhdHRpbmcgYWJvdXQgdG8gcHJldmVudCBhY2NpZGVudGFsIGNoYW5nZXMgdG8gY29udGV4dCBkb2N1bWVudHMuYCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmRlbGV0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnbWV0YWRhdGEnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gYEkgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgY29tbWFuZCBcIiR7Y29tbWFuZC5hY3Rpb259XCIuIFRyeSBhc2tpbmcgbWUgdG8gYWRkLCBlZGl0LCBkZWxldGUsIGZpeCBncmFtbWFyLCByZXdyaXRlIGNvbnRlbnQsIG9yIHVwZGF0ZSBtZXRhZGF0YS9wcm9wZXJ0aWVzLmA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHQvLyBBZGQgY29tcGFjdCBzdWNjZXNzIGluZGljYXRvciBpbnN0ZWFkIG9mIGZ1bGwgbWVzc2FnZVxuXHRcdFx0XHR0aGlzLmFkZFN1Y2Nlc3NJbmRpY2F0b3IoY29tbWFuZC5hY3Rpb24pO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gRG9uJ3QgcmV0dXJuIHRleHQgZm9yIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGBGYWlsZWQgdG8gJHtjb21tYW5kLmFjdGlvbn06ICR7cmVzdWx0LmVycm9yfWA7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBFcnJvciBleGVjdXRpbmcgY29tbWFuZDogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG5cdFx0fVxuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIElmIG5vIGFjdGl2ZSBmaWxlLCB0cnkgdG8gZmluZCB0aGUgY3VycmVudGx5IGFjdGl2ZSBsZWFmJ3MgZmlsZVxuXHRcdGxldCB0YXJnZXRGaWxlID0gYWN0aXZlRmlsZTtcblx0XHRpZiAoIXRhcmdldEZpbGUpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZjtcblx0XHRcdGlmIChhY3RpdmVMZWFmICYmIGFjdGl2ZUxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdFx0XHR0YXJnZXRGaWxlID0gYWN0aXZlTGVhZi52aWV3LmZpbGU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGYWxsIGJhY2sgdG8gYW55IG9wZW4gbWFya2Rvd24gZmlsZSBvbmx5IGlmIG5vIGFjdGl2ZSBsZWFmXG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdFx0dGFyZ2V0RmlsZSA9IHZpZXcuZmlsZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBubyBmaWxlIGF2YWlsYWJsZSBhbmQgd2UgaGF2ZSBhIGN1cnJlbnQgZmlsZSwgY2xlYXIgZXZlcnl0aGluZ1xuXHRcdGlmICghdGFyZ2V0RmlsZSAmJiB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFx0dGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgnT3BlbiBhIGRvY3VtZW50IHRvIGdldCBzdGFydGVkLicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBubyBmaWxlIG9yIHNhbWUgZmlsZSwgZG8gbm90aGluZ1xuXHRcdGlmICghdGFyZ2V0RmlsZSB8fCB0YXJnZXRGaWxlID09PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY3VycmVudEZpbGUgPSB0YXJnZXRGaWxlO1xuXHRcdFxuXHRcdC8vIENsZWFyIGN1cnJlbnQgY2hhdFxuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFJlZnJlc2ggY29udGV4dCBmb3IgbmV3IGZpbGUgKHRoaXMgd2lsbCBzaG93IHBlcnNpc3RlbnQgZG9jdW1lbnRzIGlmIGFueSlcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIExvYWQgY29udmVyc2F0aW9uIGhpc3RvcnkgaWYgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCByZWNlbnRNZXNzYWdlcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXModGFyZ2V0RmlsZSwgMTApO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVjZW50TWVzc2FnZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHQvLyBEaXNwbGF5IHJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeVxuXHRcdFx0XHRyZWNlbnRNZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG5cdFx0XHRcdFx0aWYgKG1zZy5yb2xlICE9PSAnc3lzdGVtJykge1xuXHRcdFx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKG1zZy5yb2xlIGFzICd1c2VyJyB8ICdhc3Npc3RhbnQnLCBtc2cuY29udGVudCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFNob3cgd2VsY29tZSBtZXNzYWdlIGZvciBuZXcgZmlsZVxuXHRcdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKGBXb3JraW5nIG9uIFwiJHt0YXJnZXRGaWxlLmJhc2VuYW1lfVwiLmApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBGYWlsZWQgdG8gbG9hZCBjb252ZXJzYXRpb24gaGlzdG9yeSAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBvbiBlcnJvclxuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgV29ya2luZyBvbiBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi5gKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNsZWFyQ2hhdCgpIHtcblx0XHQvLyBDbGVhciB0aGUgY2hhdCBjb250YWluZXJcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBDbGVhciBjb252ZXJzYXRpb24gaW4gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbih0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0Ly8gQWxzbyBjbGVhciBtdWx0aS1kb2MgcGVyc2lzdGVudCBjb250ZXh0XG5cdFx0XHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyLmNsZWFyUGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZS5wYXRoKTtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gRmFpbGVkIHRvIGNsZWFyIGNvbnZlcnNhdGlvbiAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgZnJlc2ggd2VsY29tZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYENoYXQgY2xlYXJlZC5gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShcIkNoYXQgY2xlYXJlZC5cIik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgbm90aWNlIHRvIHVzZXJcblx0XHRuZXcgTm90aWNlKCdDaGF0IGhpc3RvcnkgY2xlYXJlZCcpO1xuXHR9XG5cblx0Ly8gUHVibGljIG1ldGhvZHMgZm9yIHRlc3Rpbmdcblx0YXN5bmMgc2VuZE1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBCdWlsZCBwcm9tcHQgdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKG1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcblx0XHQvLyBUcnkgdG8gcGFyc2UgYXMgY29tbWFuZCBmaXJzdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiBpdCdzIGEgdmFsaWQgY29tbWFuZCBhY3Rpb25cblx0XHRjb25zdCB2YWxpZEFjdGlvbnMgPSBbJ2FkZCcsICdlZGl0JywgJ2RlbGV0ZScsICdncmFtbWFyJywgJ3Jld3JpdGUnLCAnbWV0YWRhdGEnXTtcblx0XHRpZiAodmFsaWRBY3Rpb25zLmluY2x1ZGVzKGNvbW1hbmQuYWN0aW9uKSkge1xuXHRcdFx0Ly8gQ1JJVElDQUwgU0VDVVJJVFk6IFZhbGlkYXRlIHRoYXQgd2UncmUgZWRpdGluZyB0aGUgY29ycmVjdCBmaWxlXG5cdFx0XHQvLyBUaGlzIHByZXZlbnRzIGFjY2lkZW50YWxseSBlZGl0aW5nIGNvbnRleHQgZG9jdW1lbnRzIHRoYXQgbWlnaHQgYmUgb3BlblxuXHRcdFx0Ly8gT25seSBhcHBseSB0aGlzIHZhbGlkYXRpb24gd2hlbiBib3RoIGZpbGVzIGV4aXN0IChub3QgaW4gdGVzdCBzY2VuYXJpb3MpXG5cdFx0XHRjb25zdCBjdXJyZW50QWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmIChhY3RpdmVGaWxlICYmIGN1cnJlbnRBY3RpdmVGaWxlICYmIGN1cnJlbnRBY3RpdmVGaWxlICE9PSBhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgU2VjdXJpdHkgdmlvbGF0aW9uOiBDb21tYW5kIGF0dGVtcHRlZCB0byBlZGl0IHdyb25nIGZpbGUuIEV4cGVjdGVkOiAke2FjdGl2ZUZpbGUuYmFzZW5hbWV9LCBBY3RpdmU6ICR7Y3VycmVudEFjdGl2ZUZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEV4ZWN1dGUgY29tbWFuZFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRlbGV0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnbWV0YWRhdGEnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gUmVndWxhciBjb252ZXJzYXRpb25cblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoYWN0aXZlRmlsZSwgbWVzc2FnZSwgbnVsbCBhcyBhbnkpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBDYWxsIEFJIHByb3ZpZGVyXG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0IHx8ICcnLCBwcm9tcHQudXNlclByb21wdCk7XG5cdFx0XHRcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShhY3RpdmVGaWxlLCAnQUkgcmVzcG9uc2UnLCB7IHN1Y2Nlc3M6IHRydWUsIGVkaXRUeXBlOiAnbm9uZScgfSBhcyBhbnkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGxvYWRDb252ZXJzYXRpb25IaXN0b3J5KGZpbGU6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1MCk7XG5cdFx0Ly8gSW4gcmVhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3b3VsZCBkaXNwbGF5IG1lc3NhZ2VzIGluIHRoZSBVSVxuXHR9XG5cblxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgc2VuZCBidXR0b24gZW5hYmxlZC9kaXNhYmxlZCBzdGF0ZSBiYXNlZCBvbiBwcm92aWRlciBhdmFpbGFiaWxpdHlcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlU2VuZEJ1dHRvblN0YXRlKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0aWYgKHNlbmRCdXR0b24pIHNlbmRCdXR0b24uc2V0RGlzYWJsZWQoIWN1cnJlbnRQcm92aWRlclR5cGUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBwcml2YWN5IGluZGljYXRvciBpY29uIGFuZCB0b29sdGlwIGJhc2VkIG9uIGN1cnJlbnQgcHJvdmlkZXJcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlUHJpdmFjeUluZGljYXRvcihwcml2YWN5SW5kaWNhdG9yOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRQcm92aWRlclR5cGUpIHtcblx0XHRcdGNvbnN0IGlzTG9jYWxQcm92aWRlciA9IGN1cnJlbnRQcm92aWRlclR5cGUgPT09ICdvbGxhbWEnO1xuXHRcdFx0Y29uc3QgaWNvbk5hbWUgPSBpc0xvY2FsUHJvdmlkZXIgPyAnbG9jaycgOiAndW5sb2NrJztcblx0XHRcdGNvbnN0IHRvb2x0aXAgPSBpc0xvY2FsUHJvdmlkZXIgPyAnTG9jYWwgcHJvY2Vzc2luZyAtIGRhdGEgc3RheXMgb24geW91ciBkZXZpY2UnIDogJ0Nsb3VkIHByb2Nlc3NpbmcgLSBkYXRhIHNlbnQgdG8gcHJvdmlkZXInO1xuXHRcdFx0XG5cdFx0XHQvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZ1bmN0aW9uIChzYW1lIGFzIEJ1dHRvbkNvbXBvbmVudCB1c2VzIGludGVybmFsbHkpXG5cdFx0XHRzZXRJY29uKHByaXZhY3lJbmRpY2F0b3IsIGljb25OYW1lKTtcblx0XHRcdFxuXHRcdFx0Ly8gU2V0IHRvb2x0aXBcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgdG9vbHRpcCk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0b29sdGlwKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gcHJvdmlkZXIgYXZhaWxhYmxlIC0gc2hvdyBnZW5lcmljIHByaXZhY3kgaWNvblxuXHRcdFx0c2V0SWNvbihwcml2YWN5SW5kaWNhdG9yLCAnaGVscC1jaXJjbGUnKTtcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ05vIHByb3ZpZGVyIHNlbGVjdGVkJyk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnTm8gcHJvdmlkZXIgc2VsZWN0ZWQnKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRmlsdGVyIHRoaW5raW5nIGNvbnRlbnQgZnJvbSBBSSByZXNwb25zZXNcblx0ICogUmVtb3ZlcyBjb250ZW50IGJldHdlZW4gPHRoaW5rPi88dGhpbmtpbmc+IGFuZCA8L3RoaW5rPi88dGhpbmtpbmc+IHRhZ3Ncblx0ICovXG5cdHByaXZhdGUgZmlsdGVyVGhpbmtpbmdDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUmVtb3ZlIHRoaW5raW5nIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnQgKGNhc2UtaW5zZW5zaXRpdmUsIG11bHRpLWxpbmUpXG5cdFx0Ly8gSGFuZGxlcyBib3RoIDx0aGluaz4gKFF3ZW4zKSBhbmQgPHRoaW5raW5nPiAoQ2xhdWRlKSB0YWdzXG5cdFx0cmV0dXJuIGNvbnRlbnQucmVwbGFjZSgvPHRoaW5rKD86aW5nKT9bXFxzXFxTXSo/PFxcL3RoaW5rKD86aW5nKT8+L2dpLCAnJykudHJpbSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggYWxsIHByb3ZpZGVyIHN0YXR1cyBpbmRpY2F0b3JzIGluIHRoZSBVSVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyByZWZyZXNoUHJvdmlkZXJTdGF0dXMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Ly8gVXBkYXRlIHByaXZhY3kgaW5kaWNhdG9yIGlmIGl0IGV4aXN0c1xuXHRcdGlmICgodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpIHtcblx0XHRcdGF3YWl0IHRoaXMudXBkYXRlUHJpdmFjeUluZGljYXRvcigodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBzZW5kIGJ1dHRvbiBzdGF0ZVxuXHRcdHRoaXMudXBkYXRlU2VuZEJ1dHRvblN0YXRlKCk7XG5cblx0XHQvLyBVcGRhdGUgZHJvcGRvd24gcHJvdmlkZXIgbmFtZSBpZiBpdCBleGlzdHNcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8udXBkYXRlQ3VycmVudFByb3ZpZGVyKSB7XG5cdFx0XHRhd2FpdCAodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLnVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlckRyb3Bkb3duKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWNvbnRhaW5lcicgfSk7XG5cdFx0ZHJvcGRvd25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHByb3ZpZGVyIGJ1dHRvblxuXHRcdGNvbnN0IHByb3ZpZGVyQnV0dG9uID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1wcm92aWRlci1idXR0b24nIH0pO1xuXHRcdHByb3ZpZGVyQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogNHB4IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTG9hZGluZy4uLicgfSk7XG5cblx0XHQvLyBEcm9wZG93biBhcnJvd1xuXHRcdGNvbnN0IGRyb3Bkb3duQXJyb3cgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCQycgfSk7XG5cdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdG1hcmdpbi1sZWZ0OiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBEcm9wZG93biBtZW51IChpbml0aWFsbHkgaGlkZGVuKVxuXHRcdGNvbnN0IGRyb3Bkb3duTWVudSA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudScgfSk7XG5cdFx0ZHJvcGRvd25NZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdG1pbi13aWR0aDogMTUwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdGA7XG5cblx0XHRsZXQgaXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblxuXHRcdC8vIFVwZGF0ZSBjdXJyZW50IHByb3ZpZGVyIGRpc3BsYXlcblx0XHRjb25zdCB1cGRhdGVDdXJyZW50UHJvdmlkZXIgPSBhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdFx0aWYgKGN1cnJlbnRQcm92aWRlclR5cGUpIHtcblx0XHRcdFx0Y29uc3QgZGlzcGxheVRleHQgPSB0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUoY3VycmVudFByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KGRpc3BsYXlUZXh0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KGN1cnJlbnRQcm92aWRlck5hbWUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBUb2dnbGUgZHJvcGRvd25cblx0XHRjb25zdCB0b2dnbGVEcm9wZG93biA9ICgpID0+IHtcblx0XHRcdGlzRHJvcGRvd25PcGVuID0gIWlzRHJvcGRvd25PcGVuO1xuXHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSBpc0Ryb3Bkb3duT3BlbiA/ICdibG9jaycgOiAnbm9uZSc7XG5cdFx0XHRkcm9wZG93bkFycm93LnN0eWxlLnRyYW5zZm9ybSA9IGlzRHJvcGRvd25PcGVuID8gJ3JvdGF0ZSgxODBkZWcpJyA6ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNEcm9wZG93bk9wZW4pIHtcblx0XHRcdFx0dGhpcy5wb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51KTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gQ2xvc2UgZHJvcGRvd24gd2hlbiBjbGlja2luZyBvdXRzaWRlXG5cdFx0Y29uc3QgY2xvc2VEcm9wZG93bjogRXZlbnRMaXN0ZW5lciA9IChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGlmICghZHJvcGRvd25Db250YWluZXIuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdGlzRHJvcGRvd25PcGVuID0gZmFsc2U7XG5cdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRkcm9wZG93bkFycm93LnN0eWxlLnRyYW5zZm9ybSA9ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRwcm92aWRlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0dG9nZ2xlRHJvcGRvd24oKTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBnbG9iYWwgY2xpY2sgbGlzdGVuZXJcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZURyb3Bkb3duKTtcblxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBuYW1lIGluaXRpYWxseVxuXHRcdHVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciBjbGVhbnVwXG5cdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93biA9IHtcblx0XHRcdHVwZGF0ZUN1cnJlbnRQcm92aWRlcixcblx0XHRcdGNsZWFudXA6ICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VEcm9wZG93bilcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHByb3ZpZGVyIHR5cGVcblx0ICovXG5cdHByaXZhdGUgZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogeyB2YWx1ZTogc3RyaW5nOyBsYWJlbDogc3RyaW5nIH1bXSB7XG5cdFx0cmV0dXJuIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBtb2RlbCBmb3IgYSBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnRNb2RlbChwcm92aWRlclR5cGU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSBwcm92aWRlcnNbcHJvdmlkZXJUeXBlXT8ubW9kZWw7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRNb2RlbCkge1xuXHRcdFx0cmV0dXJuIGN1cnJlbnRNb2RlbDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gR2V0IGRlZmF1bHQgbW9kZWwgKGZpcnN0IGF2YWlsYWJsZSBtb2RlbCBmb3IgdGhlIHByb3ZpZGVyKVxuXHRcdGNvbnN0IGF2YWlsYWJsZU1vZGVscyA9IHRoaXMuZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSk7XG5cdFx0cmV0dXJuIGF2YWlsYWJsZU1vZGVscy5sZW5ndGggPiAwID8gYXZhaWxhYmxlTW9kZWxzWzBdLnZhbHVlIDogJyc7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IG1vZGVsIGRpc3BsYXkgbmFtZSBmcm9tIG1vZGVsIHZhbHVlXG5cdCAqL1xuXHRwcml2YXRlIGdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcsIG1vZGVsVmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRjb25zdCBtb2RlbCA9IG1vZGVscy5maW5kKG0gPT4gbS52YWx1ZSA9PT0gbW9kZWxWYWx1ZSk7XG5cdFx0cmV0dXJuIG1vZGVsID8gbW9kZWwubGFiZWwgOiBtb2RlbFZhbHVlO1xuXHR9XG5cblx0LyoqXG5cdCAqIFN3aXRjaCB0byBhIHNwZWNpZmljIG1vZGVsIGZvciBhIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHN3aXRjaFRvTW9kZWwocHJvdmlkZXJUeXBlOiBzdHJpbmcsIG1vZGVsVmFsdWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIENoZWNrIGlmIHdlJ3JlIGFscmVhZHkgb24gdGhpcyBwcm92aWRlclxuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0Y29uc3QgaXNDdXJyZW50UHJvdmlkZXIgPSBjdXJyZW50UHJvdmlkZXJUeXBlID09PSBwcm92aWRlclR5cGU7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHNldHRpbmdzXG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRwcm92aWRlcnNbcHJvdmlkZXJUeXBlXS5tb2RlbCA9IG1vZGVsVmFsdWU7XG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XG5cdFx0aWYgKGlzQ3VycmVudFByb3ZpZGVyKSB7XG5cdFx0XHQvLyBKdXN0IHN3aXRjaGluZyBtb2RlbHMgb24gY3VycmVudCBwcm92aWRlciAtIHNob3cgbW9kZWwgc3dpdGNoIG1lc3NhZ2Vcblx0XHRcdGNvbnN0IG1vZGVsTmFtZSA9IHRoaXMuZ2V0TW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGUsIG1vZGVsVmFsdWUpO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJOYW1lID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRjb25zdCBzd2l0Y2hNZXNzYWdlID0gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgncmVmcmVzaC1jdycsIGBTd2l0Y2hlZCB0byAke3Byb3ZpZGVyTmFtZX0gJHttb2RlbE5hbWV9YCk7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHN3aXRjaE1lc3NhZ2UpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBTd2l0Y2hpbmcgdG8gZGlmZmVyZW50IHByb3ZpZGVyIC0gdGhpcyB3aWxsIHNob3cgdGhlIHByb3ZpZGVyK21vZGVsIG1lc3NhZ2Vcblx0XHRcdGF3YWl0IHRoaXMuc3dpdGNoVG9Qcm92aWRlcihwcm92aWRlclR5cGUpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBVcGRhdGUgdGhlIGRyb3Bkb3duIGRpc3BsYXlcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUG9wdWxhdGUgcHJvdmlkZXIgZHJvcGRvd24gd2l0aCBhdmFpbGFibGUgcHJvdmlkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnU6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cblx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBhbGxvd2VkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG5cdFx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgQVBJIGtleSBjb25maWd1cmVkXG5cdFx0XHRjb25zdCBwcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXHRcdFx0Y29uc3QgaGFzQXBpS2V5ID0gcHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0/LmFwaUtleTtcblx0XHRcdGlmICghaGFzQXBpS2V5ICYmIHByb3ZpZGVyVHlwZSAhPT0gJ29sbGFtYScpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5nZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IGRpc3BsYXlOYW1lID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRjb25zdCBpc0N1cnJlbnQgPSBkaXNwbGF5TmFtZSA9PT0gY3VycmVudFByb3ZpZGVyTmFtZTtcblxuXHRcdFx0Ly8gQ3JlYXRlIHByb3ZpZGVyIGNvbnRhaW5lclxuXHRcdFx0Y29uc3QgcHJvdmlkZXJDb250YWluZXIgPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1jb250YWluZXInIH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBNYWluIHByb3ZpZGVyIGl0ZW1cblx0XHRcdGNvbnN0IHByb3ZpZGVySXRlbSA9IHByb3ZpZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24taXRlbScgfSk7XG5cdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiA4cHg7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgaWNvbi9kb3Rcblx0XHRcdGNvbnN0IHByb3ZpZGVyRG90ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdHByb3ZpZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHdpZHRoOiA4cHg7XG5cdFx0XHRcdGhlaWdodDogOHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGJhY2tncm91bmQ6ICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgbmFtZSBvbmx5IChtb2RlbHMgYXJlIHNob3duIGluIHN1Ym1lbnUpXG5cdFx0XHRjb25zdCBuYW1lU3BhbiA9IHByb3ZpZGVySXRlbS5jcmVhdGVTcGFuKHsgdGV4dDogZGlzcGxheU5hbWUgfSk7XG5cdFx0XHRuYW1lU3Bhbi5zdHlsZS5mbGV4ID0gJzEnO1xuXG5cdFx0XHQvLyBFeHBhbmQgYXJyb3cgZm9yIG1vZGVscyAob25seSBpZiBtb2RlbHMgYXZhaWxhYmxlKVxuXHRcdFx0bGV0IGV4cGFuZEFycm93OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGV4cGFuZEFycm93ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnXHUyNUI2JyB9KTtcblx0XHRcdFx0ZXhwYW5kQXJyb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuNmVtO1xuXHRcdFx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0XHRgO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYXJrIGN1cnJlbnQgcHJvdmlkZXJcblx0XHRcdGlmIChpc0N1cnJlbnQpIHtcblx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHRuYW1lU3Bhbi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNb2RlbHMgc3VibWVudVxuXHRcdFx0bGV0IG1vZGVsc01lbnU6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdFx0XHRsZXQgaXNFeHBhbmRlZCA9IGZhbHNlO1xuXG5cdFx0XHRpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0bW9kZWxzTWVudSA9IHByb3ZpZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbW9kZWxzLXN1Ym1lbnUnIH0pO1xuXHRcdFx0XHRtb2RlbHNNZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRcdGJvcmRlci1sZWZ0OiAycHggc29saWQgJHt0aGlzLmdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlKX07XG5cdFx0XHRcdFx0bWFyZ2luLWxlZnQ6IDE2cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Ly8gUG9wdWxhdGUgbW9kZWxzXG5cdFx0XHRcdGZvciAoY29uc3QgbW9kZWwgb2YgbW9kZWxzKSB7XG5cdFx0XHRcdFx0Y29uc3QgbW9kZWxJdGVtID0gbW9kZWxzTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWl0ZW0nIH0pO1xuXHRcdFx0XHRcdG1vZGVsSXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0cGFkZGluZzogNnB4IDEycHg7XG5cdFx0XHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdFx0XHRgO1xuXG5cdFx0XHRcdFx0Ly8gTW9kZWwgaW5kaWNhdG9yXG5cdFx0XHRcdFx0Y29uc3QgbW9kZWxEb3QgPSBtb2RlbEl0ZW0uY3JlYXRlU3BhbigpO1xuXHRcdFx0XHRcdG1vZGVsRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHR3aWR0aDogNHB4O1xuXHRcdFx0XHRcdFx0aGVpZ2h0OiA0cHg7XG5cdFx0XHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdFx0XHRiYWNrZ3JvdW5kOiAke21vZGVsLnZhbHVlID09PSBjdXJyZW50TW9kZWwgPyB0aGlzLmdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlKSA6ICd2YXIoLS10ZXh0LW11dGVkKSd9O1xuXHRcdFx0XHRcdGA7XG5cblx0XHRcdFx0XHRjb25zdCBtb2RlbE5hbWUgPSBtb2RlbEl0ZW0uY3JlYXRlU3Bhbih7IHRleHQ6IG1vZGVsLmxhYmVsIH0pO1xuXHRcdFx0XHRcdGlmIChtb2RlbC52YWx1ZSA9PT0gY3VycmVudE1vZGVsKSB7XG5cdFx0XHRcdFx0XHRtb2RlbE5hbWUuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBNb2RlbCBjbGljayBoYW5kbGVyXG5cdFx0XHRcdFx0bW9kZWxJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnN3aXRjaFRvTW9kZWwocHJvdmlkZXJUeXBlLCBtb2RlbC52YWx1ZSk7XG5cdFx0XHRcdFx0XHQvLyBDbG9zZSBkcm9wZG93blxuXHRcdFx0XHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBNb2RlbCBob3ZlciBlZmZlY3Rcblx0XHRcdFx0XHRtb2RlbEl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRcdG1vZGVsSXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0bW9kZWxJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHRtb2RlbEl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gUHJvdmlkZXIgY2xpY2sgaGFuZGxlclxuXHRcdFx0cHJvdmlkZXJJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcblx0XHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Ly8gVG9nZ2xlIHN1Ym1lbnVcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGlzRXhwYW5kZWQgPSAhaXNFeHBhbmRlZDtcblx0XHRcdFx0XHRpZiAobW9kZWxzTWVudSkge1xuXHRcdFx0XHRcdFx0bW9kZWxzTWVudS5zdHlsZS5kaXNwbGF5ID0gaXNFeHBhbmRlZCA/ICdibG9jaycgOiAnbm9uZSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChleHBhbmRBcnJvdykge1xuXHRcdFx0XHRcdFx0ZXhwYW5kQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gaXNFeHBhbmRlZCA/ICdyb3RhdGUoOTBkZWcpJyA6ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBTd2l0Y2ggcHJvdmlkZXIgZGlyZWN0bHkgKGZvciBPbGxhbWEgb3IgcHJvdmlkZXJzIHdpdGhvdXQgbW9kZWxzKVxuXHRcdFx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnN3aXRjaFRvUHJvdmlkZXIocHJvdmlkZXJUeXBlKTtcblx0XHRcdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24pIHtcblx0XHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIb3ZlciBlZmZlY3Rcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQgJiYgIWlzRXhwYW5kZWQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdBbnRocm9waWMnLFxuXHRcdFx0J29wZW5haSc6ICdPcGVuQUknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdPbGxhbWEnLFxuXHRcdFx0J25vbmUnOiAnTm9uZSdcblx0XHR9O1xuXHRcdHJldHVybiBuYW1lc1twcm92aWRlclR5cGVdIHx8IHByb3ZpZGVyVHlwZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBoZWFkZXIgKGp1c3QgbW9kZWwgbmFtZSBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSBwcm92aWRlciBuYW1lKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFxuXHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5nZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlKTtcblx0XHRcdHJldHVybiB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBjdXJyZW50TW9kZWwpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFVzZSB0aGVtZS1jb21wYXRpYmxlIGNvbG9ycyBpbnN0ZWFkIG9mIGhhcmRjb2RlZCBoZXggdmFsdWVzXG5cdFx0Y29uc3QgY29sb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICd2YXIoLS1jb2xvci1vcmFuZ2UpJyxcblx0XHRcdCdvcGVuYWknOiAndmFyKC0tY29sb3ItZ3JlZW4pJyxcblx0XHRcdCdnb29nbGUnOiAndmFyKC0tY29sb3ItYmx1ZSknLFxuXHRcdFx0J29sbGFtYSc6ICd2YXIoLS1jb2xvci1wdXJwbGUpJyxcblx0XHRcdCdub25lJzogJ3ZhcigtLXRleHQtbXV0ZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICd2YXIoLS10ZXh0LXN1Y2Nlc3MpJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgcHJvdmlkZXIgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBhIHN5c3RlbSBtZXNzYWdlIGFib3V0IHByb3ZpZGVyIHN3aXRjaGluZ1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKTtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgc3dpdGNoTWVzc2FnZSk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0aGUgcGxhdGZvcm0gc2V0dGluZ3MgdG8gdXNlIHRoZSBuZXcgcHJvdmlkZXJcblx0XHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVyVHlwZSBhcyBhbnk7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmUtaW5pdGlhbGl6ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZWZyZXNoIHN0YXR1cyBpbmRpY2F0b3JzXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzKCksIDEwMCk7XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRXJyb3Igc3dpdGNoaW5nIHByb3ZpZGVyIC0gaGFuZGxlZCBieSBVSSBmZWVkYmFja1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgRmFpbGVkIHRvIHN3aXRjaCB0byAke3RoaXMuZ2V0UHJvdmlkZXJXaXRoTW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpfWApKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgdGhlIGNvbW1hbmQgYnV0dG9uIHNob3VsZCBiZSBzaG93biBiYXNlZCBvbiBmZWF0dXJlIGF2YWlsYWJpbGl0eSBhbmQgdXNlciBwcmVmZXJlbmNlXG5cdCAqL1xuXHRwcml2YXRlIHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdC8vIENvbW1hbmQgYnV0dG9uIGlzIGdhdGVkIGJlaGluZCB0aGUgY29tbWFuZHMgZmVhdHVyZSBcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggYWxsIFN1cGVybm92YS1nYXRlZCBVSSBlbGVtZW50cyB3aGVuIGxpY2Vuc2Ugc3RhdHVzIGNoYW5nZXNcblx0ICovXG5cdHJlZnJlc2hTdXBlcm5vdmFVSSgpOiB2b2lkIHtcblx0XHR0aGlzLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0Ly8gRnV0dXJlIFN1cGVybm92YSBmZWF0dXJlcyBjYW4gYWRkIHRoZWlyIHJlZnJlc2ggbG9naWMgaGVyZVxuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggdGhlIGNvbW1hbmQgYnV0dG9uIHZpc2liaWxpdHkgd2hlbiBzZXR0aW5ncyBjaGFuZ2Vcblx0ICovXG5cdHJlZnJlc2hDb21tYW5kQnV0dG9uKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmlucHV0SGFuZGxlcikge1xuXHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIucmVmcmVzaENvbW1hbmRCdXR0b24oKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIGlucHV0IHJvdyBsYXlvdXQgd2hlbiBjb21tYW5kIGJ1dHRvbiB2aXNpYmlsaXR5IGNoYW5nZXNcblx0ICovXG5cdHByaXZhdGUgdXBkYXRlSW5wdXRSb3dMYXlvdXQoKTogdm9pZCB7XG5cdFx0Ly8gTm8gbmVlZCB0byBtYW51YWxseSBhZGp1c3QgdGV4dGFyZWEgd2lkdGggLSBmbGV4Ym94IGhhbmRsZXMgaXRcblx0XHQvLyBUaGUgdGV4dGFyZWEgY29udGFpbmVyIGhhcyBmbGV4OiAxLCBzbyBpdCB3aWxsIGV4cGFuZC9jb250cmFjdCBhdXRvbWF0aWNhbGx5XG5cdFx0Ly8gd2hlbiB0aGUgY29tbWFuZCBidXR0b24gaXMgc2hvd24vaGlkZGVuXG5cdH1cblxufSIsICIvKipcbiAqIE11bHRpLWRvY3VtZW50IGNvbnRleHQgaGFuZGxlciBmb3IgTm92YVxuICogUGFyc2VzIFtbZG9jXV0gYW5kICtbW2RvY11dIHN5bnRheCBmb3IgYWRkaXRpb25hbCBjb250ZXh0XG4gKi9cblxuaW1wb3J0IHsgQXBwLCBURmlsZSwgQ2FjaGVkTWV0YWRhdGEgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRSZWZlcmVuY2Uge1xuICAgIC8qKiBUaGUgZmlsZSBiZWluZyByZWZlcmVuY2VkICovXG4gICAgZmlsZTogVEZpbGU7XG4gICAgXG4gICAgLyoqIFdoZXRoZXIgdGhpcyBpcyBwZXJzaXN0ZW50IGNvbnRleHQgKCtbW2RvY11dKSAqL1xuICAgIGlzUGVyc2lzdGVudDogYm9vbGVhbjtcbiAgICBcbiAgICAvKiogVGhlIHJhdyByZWZlcmVuY2UgdGV4dCAoZS5nLiwgXCJbW015IERvY3VtZW50XV1cIikgKi9cbiAgICByYXdSZWZlcmVuY2U6IHN0cmluZztcbiAgICBcbiAgICAvKiogU3BlY2lmaWMgcHJvcGVydHkgdG8gZXh0cmFjdCAoZS5nLiwgXCJbW2RvYyNwcm9wZXJ0eV1dXCIpICovXG4gICAgcHJvcGVydHk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTXVsdGlEb2NDb250ZXh0IHtcbiAgICAvKiogRG9jdW1lbnRzIGluIHBlcnNpc3RlbnQgY29udGV4dCAqL1xuICAgIHBlcnNpc3RlbnREb2NzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIFxuICAgIC8qKiBDb21iaW5lZCBjb250ZXh0IHN0cmluZyAqL1xuICAgIGNvbnRleHRTdHJpbmc6IHN0cmluZztcbiAgICBcbiAgICAvKiogRXN0aW1hdGVkIHRva2VuIGNvdW50ICovXG4gICAgdG9rZW5Db3VudDogbnVtYmVyO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHdlJ3JlIGFwcHJvYWNoaW5nIHRva2VuIGxpbWl0ICovXG4gICAgaXNOZWFyTGltaXQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBNdWx0aURvY0NvbnRleHRIYW5kbGVyIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGVyc2lzdGVudENvbnRleHQ6IE1hcDxzdHJpbmcsIERvY3VtZW50UmVmZXJlbmNlW10+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgVE9LRU5fTElNSVQgPSA4MDAwO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgV0FSTklOR19USFJFU0hPTEQgPSAwLjg7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIG1lc3NhZ2UgZm9yIGRvY3VtZW50IHJlZmVyZW5jZXNcbiAgICAgKi9cbiAgICBwYXJzZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCBjb252ZXJzYXRpb25GaWxlUGF0aDogc3RyaW5nKToge1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIH0ge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdID0gW107XG4gICAgICAgIGxldCBjbGVhbmVkTWVzc2FnZSA9IG1lc3NhZ2U7XG5cbiAgICAgICAgLy8gUGF0dGVybiB0byBtYXRjaCBbW2RvY11dIGFuZCArW1tkb2NdXSB3aXRoIG9wdGlvbmFsIHByb3BlcnR5XG4gICAgICAgIC8vIE5vdGU6IEFsbCBkb2N1bWVudCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuICAgICAgICBjb25zdCByZWZQYXR0ZXJuID0gLyhcXCspP1xcW1xcWyhbXlxcXV0rPykoPzojKFteXFxdXSs/KSk/XFxdXFxdL2c7XG4gICAgICAgIFxuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuICAgICAgICAgICAgY29uc3QgcmF3UmVmZXJlbmNlID0gbWF0Y2hbMF07XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBmaWxlXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZShkb2NOYW1lKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICBpc1BlcnNpc3RlbnQ6IHRydWUsIC8vIEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudFxuICAgICAgICAgICAgICAgICAgICByYXdSZWZlcmVuY2UsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgYWxsIGZvdW5kIHJlZmVyZW5jZXMgZnJvbSBtZXNzYWdlXG4gICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZShyZWYucmF3UmVmZXJlbmNlLCAnICcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYW4gdXAgZXhjZXNzaXZlIHNwYWNlcyBidXQgcHJlc2VydmUgbmVjZXNzYXJ5IHNwYWNpbmdcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2UgPSBjbGVhbmVkTWVzc2FnZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJykudHJpbSgpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgIGNvbnN0IHBlcnNpc3RlbnRSZWZzID0gcmVmZXJlbmNlcy5maWx0ZXIocmVmID0+IHJlZi5pc1BlcnNpc3RlbnQpO1xuICAgICAgICBpZiAocGVyc2lzdGVudFJlZnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjb252ZXJzYXRpb25GaWxlUGF0aCkgfHwgW107XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcGVyc2lzdGVudFJlZnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY29udmVyc2F0aW9uRmlsZVBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IGNsZWFuZWRNZXNzYWdlLCByZWZlcmVuY2VzIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29tcGxldGUgY29udGV4dCBpbmNsdWRpbmcgcGVyc2lzdGVudCBkb2N1bWVudHNcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbnRleHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgY3VycmVudEZpbGU6IFRGaWxlLFxuICAgICAgICBjb252ZXJzYXRpb25EYXRhPzogQ29udmVyc2F0aW9uRGF0YVxuICAgICk6IFByb21pc2U8e1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICBjb250ZXh0OiBNdWx0aURvY0NvbnRleHQ7XG4gICAgfT4ge1xuICAgICAgICAvLyBQYXJzZSBjdXJyZW50IG1lc3NhZ2VcbiAgICAgICAgY29uc3QgeyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9ID0gdGhpcy5wYXJzZU1lc3NhZ2UobWVzc2FnZSwgY3VycmVudEZpbGUucGF0aCk7XG5cbiAgICAgICAgLy8gR2V0IGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgdGhpcyBjb252ZXJzYXRpb25cbiAgICAgICAgY29uc3QgZXhpc3RpbmdQZXJzaXN0ZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY3VycmVudEZpbGUucGF0aCkgfHwgW107XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdG8gcGVyc2lzdGVudCBjb250ZXh0IChhbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQpXG4gICAgICAgIGlmIChyZWZlcmVuY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRQZXJzaXN0ZW50ID0gWy4uLmV4aXN0aW5nUGVyc2lzdGVudF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcmVmZXJlbmNlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHVwZGF0ZWRQZXJzaXN0ZW50LnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcuZmlsZS5wYXRoID09PSByZWYuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGVyc2lzdGVudC5wdXNoKHJlZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjdXJyZW50RmlsZS5wYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmaW5hbCBwZXJzaXN0ZW50IGNvbnRleHQgKGluY2x1ZGluZyBuZXdseSBhZGRlZCBkb2NzKVxuICAgICAgICBjb25zdCByYXdQZXJzaXN0ZW50RG9jcyA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsdGVyIG91dCBhbnkgc3RhbGUgZmlsZSByZWZlcmVuY2VzIChmaWxlcyB0aGF0IG5vIGxvbmdlciBleGlzdClcbiAgICAgICAgY29uc3QgYWxsUGVyc2lzdGVudERvY3MgPSByYXdQZXJzaXN0ZW50RG9jcy5maWx0ZXIoZG9jUmVmID0+IHtcbiAgICAgICAgICAgIGlmICghZG9jUmVmPy5maWxlIHx8ICF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZG9jUmVmLmZpbGUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmluZyBzdGFsZSBmaWxlIHJlZmVyZW5jZVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgcGVyc2lzdGVudCBjb250ZXh0IHRvIHJlbW92ZSBzdGFsZSByZWZlcmVuY2VzXG4gICAgICAgIGlmIChhbGxQZXJzaXN0ZW50RG9jcy5sZW5ndGggIT09IHJhd1BlcnNpc3RlbnREb2NzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGFsbFBlcnNpc3RlbnREb2NzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjdXJyZW50RmlsZS5wYXRoLCBhbGxQZXJzaXN0ZW50RG9jcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGN1cnJlbnRGaWxlLnBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBzdHJpbmcgZnJvbSBhbGwgZG9jdW1lbnRzXG4gICAgICAgIGNvbnN0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFMV0FZUyBpbmNsdWRlIGN1cnJlbnQgZmlsZSBjb250ZW50IGFuZCBtZXRhZGF0YSBmaXJzdCAoaW1wbGljaXQgY29udGV4dClcbiAgICAgICAgY29uc3QgY3VycmVudEZpbGVDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXRGdWxsRG9jdW1lbnRDb250ZXh0KGN1cnJlbnRGaWxlLCB0cnVlLCAxMDApO1xuICAgICAgICBpZiAoY3VycmVudEZpbGVDb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChjdXJyZW50RmlsZUNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUaGVuIGFkZCBhbGwgcGVyc2lzdGVudCBkb2N1bWVudHMgd2l0aCB0aGVpciBtZXRhZGF0YVxuICAgICAgICBmb3IgKGNvbnN0IGRvY1JlZiBvZiBhbGxQZXJzaXN0ZW50RG9jcykge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dFBhcnQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChkb2NSZWYpO1xuICAgICAgICAgICAgaWYgKGNvbnRleHRQYXJ0KSB7XG4gICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goY29udGV4dFBhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dFN0cmluZyA9IGNvbnRleHRQYXJ0cy5qb2luKCdcXG5cXG4tLS1cXG5cXG4nKTtcbiAgICAgICAgY29uc3QgdG9rZW5Db3VudCA9IHRoaXMuZXN0aW1hdGVUb2tlbnMoY29udGV4dFN0cmluZyk7XG4gICAgICAgIGNvbnN0IGlzTmVhckxpbWl0ID0gdG9rZW5Db3VudCA+ICh0aGlzLlRPS0VOX0xJTUlUICogdGhpcy5XQVJOSU5HX1RIUkVTSE9MRCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNsZWFuZWRNZXNzYWdlLFxuICAgICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgICAgIHBlcnNpc3RlbnREb2NzOiBhbGxQZXJzaXN0ZW50RG9jcyxcbiAgICAgICAgICAgICAgICBjb250ZXh0U3RyaW5nLFxuICAgICAgICAgICAgICAgIHRva2VuQ291bnQsXG4gICAgICAgICAgICAgICAgaXNOZWFyTGltaXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZnVsbCBkb2N1bWVudCBjb250ZXh0IGluY2x1ZGluZyBtZXRhZGF0YS9wcm9wZXJ0aWVzXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRGdWxsRG9jdW1lbnRDb250ZXh0KGZpbGU6IFRGaWxlLCBpbmNsdWRlQ29udGVudDogYm9vbGVhbiA9IHRydWUsIG1heExpbmVzOiBudW1iZXIgPSA1MCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGRvY3VtZW50IGhlYWRlclxuICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goYCMjIERvY3VtZW50OiAke2ZpbGUuYmFzZW5hbWV9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBhbmQgYWRkIG1ldGFkYXRhL3Byb3BlcnRpZXMgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBPYmplY3Qua2V5cyhjYWNoZS5mcm9udG1hdHRlcikubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKCdcXG4jIyMgUHJvcGVydGllcy9NZXRhZGF0YTonKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjYWNoZS5mcm9udG1hdHRlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9ybWF0IHRoZSBwcm9wZXJ0eSB2YWx1ZSAoaGFuZGxlIGFycmF5cywgb2JqZWN0cywgZXRjLilcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGAtICR7a2V5fTogJHtmb3JtYXR0ZWRWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBjb250ZW50IGlmIHJlcXVlc3RlZFxuICAgICAgICAgICAgaWYgKGluY2x1ZGVDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFNraXAgZnJvbnRtYXR0ZXIgaW4gY29udGVudCBkaXNwbGF5IChiZXR3ZWVuIC0tLSBtYXJrZXJzKVxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGVudFN0YXJ0SW5kZXggPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGluZXNbMF0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVzW2ldID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RhcnRJbmRleCA9IGkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRMaW5lcyA9IGxpbmVzLnNsaWNlKGNvbnRlbnRTdGFydEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJ1bmNhdGVkQ29udGVudCA9IGNvbnRlbnRMaW5lcy5zbGljZSgwLCBtYXhMaW5lcykuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhc1RydW5jYXRlZCA9IGNvbnRlbnRMaW5lcy5sZW5ndGggPiBtYXhMaW5lcztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKCdcXG4jIyMgQ29udGVudDonKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2godHJ1bmNhdGVkQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh3YXNUcnVuY2F0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKCdcXG5bLi4uIHRydW5jYXRlZCBmb3IgYnJldml0eSAuLi5dJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0UGFydHMuam9pbignXFxuJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gcmVhZCBmdWxsIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udGV4dCBmb3IgYSBzcGVjaWZpYyBkb2N1bWVudCByZWZlcmVuY2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldERvY3VtZW50Q29udGV4dChkb2NSZWY6IERvY3VtZW50UmVmZXJlbmNlKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IGZpbGUsIHByb3BlcnR5IH0gPSBkb2NSZWY7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGZpbGUgc3RpbGwgZXhpc3RzIGluIHRoZSB2YXVsdFxuICAgICAgICAgICAgaWYgKCFmaWxlIHx8ICF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZS5wYXRoKSkge1xuICAgICAgICAgICAgICAgIC8vIEZpbGUgbm8gbG9uZ2VyIGV4aXN0cyAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBzcGVjaWZpYyBwcm9wZXJ0eSBmcm9tIGZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyICYmIGNhY2hlLmZyb250bWF0dGVyW3Byb3BlcnR5XSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYCMjICR7ZmlsZS5iYXNlbmFtZX0gLSAke3Byb3BlcnR5fVxcbiR7Y2FjaGUuZnJvbnRtYXR0ZXJbcHJvcGVydHldfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgZnVsbCBkb2N1bWVudCBjb250ZXh0IHdpdGggbWV0YWRhdGFcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGdWxsRG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHJlYWQgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgYSBmaWxlIGJ5IG5hbWUgb3IgcGF0aFxuICAgICAqL1xuICAgIHByaXZhdGUgZmluZEZpbGUobmFtZU9yUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcbiAgICAgICAgbGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG4gICAgICAgICAgICBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgIC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgICAgICBmaWxlID0gZmlsZXMuZmluZChmID0+IFxuICAgICAgICAgICAgICAgIGYuYmFzZW5hbWUgPT09IG5hbWVPclBhdGggfHwgXG4gICAgICAgICAgICAgICAgZi5uYW1lID09PSBuYW1lT3JQYXRoIHx8XG4gICAgICAgICAgICAgICAgZi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG4gICAgICAgICAgICAgICAgZi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGggKyAnLm1kJylcbiAgICAgICAgICAgICkgfHwgbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGZpbGUgOiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgYSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBjbGVhclBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoZmlsZVBhdGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgZ2V0UGVyc2lzdGVudENvbnRleHQoZmlsZVBhdGg6IHN0cmluZyk6IERvY3VtZW50UmVmZXJlbmNlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoZmlsZVBhdGgpIHx8IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHNwZWNpZmljIGRvY3VtZW50IGZyb20gcGVyc2lzdGVudCBjb250ZXh0XG4gICAgICovXG4gICAgcmVtb3ZlUGVyc2lzdGVudERvYyhmaWxlUGF0aDogc3RyaW5nLCBkb2NUb1JlbW92ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChmaWxlUGF0aCkgfHwgW107XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gY3VycmVudC5maWx0ZXIocmVmID0+IHJlZi5maWxlLnBhdGggIT09IGRvY1RvUmVtb3ZlKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChmaWxlUGF0aCwgZmlsdGVyZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoZmlsZVBhdGgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdG9rZW4gY291bnQgKHJvdWdoIGFwcHJveGltYXRpb24pXG4gICAgICovXG4gICAgcHJpdmF0ZSBlc3RpbWF0ZVRva2Vucyh0ZXh0OiBzdHJpbmcpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0ZTogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0ZXh0Lmxlbmd0aCAvIDQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB2aXN1YWwgaW5kaWNhdG9ycyBmb3IgY29udGV4dCBzdGF0ZVxuICAgICAqL1xuICAgIGdldENvbnRleHRJbmRpY2F0b3JzKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBjbGFzc05hbWU6IHN0cmluZztcbiAgICAgICAgdG9vbHRpcDogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBkb2NDb3VudCA9IGNvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuICAgICAgICBjb25zdCBwZXJjZW50YWdlID0gTWF0aC5yb3VuZCgoY29udGV4dC50b2tlbkNvdW50IC8gdGhpcy5UT0tFTl9MSU1JVCkgKiAxMDApO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNsYXNzTmFtZSA9ICdub3ZhLWNvbnRleHQtaW5kaWNhdG9yJztcbiAgICAgICAgbGV0IHRvb2x0aXAgPSBgQ29udGV4dDogJHtkb2NDb3VudH0gZG9jdW1lbnQke2RvY0NvdW50ICE9PSAxID8gJ3MnIDogJyd9LCB+JHtjb250ZXh0LnRva2VuQ291bnR9IHRva2Vuc2A7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udGV4dC5pc05lYXJMaW1pdCkge1xuICAgICAgICAgICAgY2xhc3NOYW1lICs9ICcgbm92YS1jb250ZXh0LXdhcm5pbmcnO1xuICAgICAgICAgICAgdG9vbHRpcCArPSAnIChhcHByb2FjaGluZyBsaW1pdCknO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0ZXh0ID0gYCR7ZG9jQ291bnR9IGRvY3MgJHtwZXJjZW50YWdlfSVgO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHsgdGV4dCwgY2xhc3NOYW1lLCB0b29sdGlwIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9ybWF0IGNvbnRleHQgZm9yIGRpc3BsYXkgaW4gVUlcbiAgICAgKi9cbiAgICBmb3JtYXRDb250ZXh0Rm9yRGlzcGxheShjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHBlcnNpc3RlbnQgZG9jdW1lbnRzXG4gICAgICAgIGZvciAoY29uc3QgZG9jIG9mIGNvbnRleHQucGVyc2lzdGVudERvY3MpIHtcbiAgICAgICAgICAgIGl0ZW1zLnB1c2goYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtkb2MucHJvcGVydHkgPyBgIyR7ZG9jLnByb3BlcnR5fWAgOiAnJ31gKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9ucyBmb3IgYWxsIEFJIHByb3ZpZGVyc1xuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZWxEZWZpbml0aW9uIHtcblx0dmFsdWU6IHN0cmluZztcblx0bGFiZWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb2RlbENvbmZpZyB7XG5cdGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGU6IHN0cmluZywgc2V0dGluZ3M/OiBhbnkpOiBNb2RlbERlZmluaXRpb25bXTtcbn1cblxuLyoqXG4gKiBHZXQgYXZhaWxhYmxlIG1vZGVscyBmb3IgYSBwcm92aWRlclxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBzZXR0aW5ncz86IGFueSk6IE1vZGVsRGVmaW5pdGlvbltdIHtcblx0c3dpdGNoIChwcm92aWRlclR5cGUpIHtcblx0XHRjYXNlICdjbGF1ZGUnOlxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnLCBsYWJlbDogJ0NsYXVkZSBPcHVzIDQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnLCBsYWJlbDogJ0NsYXVkZSBTb25uZXQgNCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTctc29ubmV0LWxhdGVzdCcsIGxhYmVsOiAnQ2xhdWRlIDMuNyBTb25uZXQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy01LXNvbm5ldC1sYXRlc3QnLCBsYWJlbDogJ0NsYXVkZSAzLjUgU29ubmV0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLCBsYWJlbDogJ0NsYXVkZSAzLjUgU29ubmV0IChPY3QgMjIpJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLCBsYWJlbDogJ0NsYXVkZSAzLjUgSGFpa3UnIH1cblx0XHRcdF07XG5cdFx0Y2FzZSAnb3BlbmFpJzpcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNC4xLTIwMjUtMDQtMTQnLCBsYWJlbDogJ0dQVC00LjEnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNC4xLW1pbmktMjAyNS0wNC0xNCcsIGxhYmVsOiAnR1BULTQuMSBNaW5pJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTQuMS1uYW5vLTIwMjUtMDQtMTQnLCBsYWJlbDogJ0dQVC00LjEgTmFubycgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00bycsIGxhYmVsOiAnR1BULTRvJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTRvLW1pbmknLCBsYWJlbDogJ0dQVC00byBNaW5pJyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ2dvb2dsZSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA0LTE3JywgbGFiZWw6ICdHZW1pbmkgMi41IEZsYXNoJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuNS1wcm8tcHJldmlldy0wMy0yNScsIGxhYmVsOiAnR2VtaW5pIDIuNSBQcm8nIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMi4wLWZsYXNoJywgbGFiZWw6ICdHZW1pbmkgMi4wIEZsYXNoJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJywgbGFiZWw6ICdHZW1pbmkgMi4wIEZsYXNoLUxpdGUnIH1cblx0XHRcdF07XG5cdFx0Y2FzZSAnb2xsYW1hJzpcblx0XHRcdC8vIFJldHVybiB0aGUgY29uZmlndXJlZCBtb2RlbCBmcm9tIHNldHRpbmdzXG5cdFx0XHRjb25zdCBvbGxhbWFNb2RlbCA9IHNldHRpbmdzPy5haVByb3ZpZGVycz8ub2xsYW1hPy5tb2RlbDtcblx0XHRcdGlmIChvbGxhbWFNb2RlbCAmJiBvbGxhbWFNb2RlbC50cmltKCkpIHtcblx0XHRcdFx0cmV0dXJuIFt7IHZhbHVlOiBvbGxhbWFNb2RlbCwgbGFiZWw6IG9sbGFtYU1vZGVsIH1dO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIFtdO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRyZXR1cm4gW107XG5cdH1cbn0iLCAiaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB9IGZyb20gJy4vd2lraWxpbmstc3VnZ2VzdCc7XG5pbXBvcnQgeyBDb21tYW5kU3lzdGVtIH0gZnJvbSAnLi9jb21tYW5kLXN5c3RlbSc7XG5pbXBvcnQgeyBDb250ZXh0TWFuYWdlciB9IGZyb20gJy4vY29udGV4dC1tYW5hZ2VyJztcblxuLyoqXG4gKiBIYW5kbGVzIHRleHRhcmVhIGlucHV0LCBhdXRvLWdyb3csIHNlbmQgYnV0dG9uLCBhbmQgaW5wdXQgZXZlbnRzXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnB1dEhhbmRsZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHRleHRBcmVhITogVGV4dEFyZWFDb21wb25lbnQ7XG5cdHByaXZhdGUgc2VuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0cHJpdmF0ZSBhdXRvR3Jvd1RleHRhcmVhITogKCkgPT4gdm9pZDtcblx0cHJpdmF0ZSB3aWtpbGlua0F1dG9jb21wbGV0ZSE6IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZTtcblx0cHJpdmF0ZSBjb21tYW5kU3lzdGVtITogQ29tbWFuZFN5c3RlbTtcblx0cHJpdmF0ZSBjb250ZXh0TWFuYWdlcjogQ29udGV4dE1hbmFnZXI7XG5cdHByaXZhdGUgaW5wdXRSb3chOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRk9DVVNfREVMQVlfTVMgPSAxNTA7XG5cblx0Ly8gRXZlbnQgY2xlYW51cCB0cmFja2luZ1xuXHRwcml2YXRlIGV2ZW50TGlzdGVuZXJzOiBBcnJheTx7ZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXJ9PiA9IFtdO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHBsdWdpbjogTm92YVBsdWdpbiwgXG5cdFx0Y29udGFpbmVyOiBIVE1MRWxlbWVudCwgXG5cdFx0Y29udGV4dE1hbmFnZXI6IENvbnRleHRNYW5hZ2VyXG5cdCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdHRoaXMuY29udGV4dE1hbmFnZXIgPSBjb250ZXh0TWFuYWdlcjtcblx0fVxuXG5cdHNldENvbW1hbmRTeXN0ZW0oY29tbWFuZFN5c3RlbTogQ29tbWFuZFN5c3RlbSk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFN5c3RlbSA9IGNvbW1hbmRTeXN0ZW07XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHRoZSBjb21tYW5kIGJ1dHRvbiBCRUZPUkUgdGhlIHNlbmQgYnV0dG9uIHRvIGdldCBwcm9wZXIgb3JkZXJcblx0XHQvLyBSZW1vdmUgc2VuZCBidXR0b24gdGVtcG9yYXJpbHlcblx0XHRjb25zdCBzZW5kQnV0dG9uRWwgPSB0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWw7XG5cdFx0c2VuZEJ1dHRvbkVsLnJlbW92ZSgpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb21tYW5kIGJ1dHRvblxuXHRcdHRoaXMuY29tbWFuZFN5c3RlbS5jcmVhdGVDb21tYW5kQnV0dG9uKHRoaXMuaW5wdXRSb3cpO1xuXHRcdFxuXHRcdC8vIFJlLWFkZCBzZW5kIGJ1dHRvbiAod2lsbCBiZSBsYXN0IGluIERPTSBvcmRlcilcblx0XHR0aGlzLmlucHV0Um93LmFwcGVuZENoaWxkKHNlbmRCdXR0b25FbCk7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgcGlja2VyXG5cdFx0dGhpcy5jb21tYW5kU3lzdGVtLmNyZWF0ZUNvbW1hbmRQaWNrZXJJbkNvbnRhaW5lcih0aGlzLmlucHV0Um93KTtcblx0fVxuXG5cdGdldFRleHRBcmVhKCk6IFRleHRBcmVhQ29tcG9uZW50IHtcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYTtcblx0fVxuXG5cdGNyZWF0ZUlucHV0SW50ZXJmYWNlKGNoYXRDb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0dGhpcy5jb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRgO1xuXG5cdFx0dGhpcy5pbnB1dFJvdyA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtcm93JyB9KTtcblx0XHR0aGlzLmlucHV0Um93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0Z2FwOiB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHQvLyBUZXh0YXJlYSBjb250YWluZXJcblx0XHRjb25zdCB0ZXh0QXJlYUNvbnRhaW5lciA9IHRoaXMuaW5wdXRSb3cuY3JlYXRlRGl2KCk7XG5cdFx0dGV4dEFyZWFDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdmbGV4OiAxOyBwb3NpdGlvbjogcmVsYXRpdmU7JztcblxuXHRcdC8vIENyZWF0ZSB0ZXh0YXJlYVxuXHRcdHRoaXMudGV4dEFyZWEgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodGV4dEFyZWFDb250YWluZXIpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0UGxhY2Vob2xkZXIoJ0FzayBOb3ZhIGFueXRoaW5nLi4uIChTaGlmdCtFbnRlciBmb3IgbmV3IGxpbmUpJyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4taGVpZ2h0OiA4MHB4O1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRyZXNpemU6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtMi0zKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0Zm9udC1mYW1pbHk6IHZhcigtLWZvbnQtaW50ZXJmYWNlKTtcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0Ym94LXNpemluZzogYm9yZGVyLWJveDtcblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCB0ZXh0YXJlYSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9IE1hdGgubWluKHRleHRhcmVhLnNjcm9sbEhlaWdodCwgMjAwKSArICdweCc7XG5cdFx0fTtcblxuXHRcdC8vIEFkZCBpbnB1dCBldmVudCBsaXN0ZW5lciBmb3IgYXV0by1ncm93XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2lucHV0JywgdGhpcy5hdXRvR3Jvd1RleHRhcmVhKTtcblxuXHRcdC8vIFRyaWdnZXIgYXV0by1ncm93IG9uIGluaXRpYWwgbG9hZFxuXHRcdHNldFRpbWVvdXQodGhpcy5hdXRvR3Jvd1RleHRhcmVhLCAwKTtcblxuXHRcdC8vIEluaXRpYWxpemUgd2lraWxpbmsgYXV0b2NvbXBsZXRlIHdpdGggaW5wdXRSb3cgZm9yIGNvbnNpc3RlbnQgd2lkdGhcblx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlID0gbmV3IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgdGhpcy5pbnB1dFJvdyk7XG5cblxuXHRcdC8vIEFkZCBkZWJvdW5jZWQgY29udGV4dCBwcmV2aWV3XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2lucHV0JywgKCkgPT4ge1xuXHRcdFx0dGhpcy5jb250ZXh0TWFuYWdlci51cGRhdGVMaXZlQ29udGV4dFByZXZpZXcodGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpKTtcblx0XHR9KTtcblxuXHRcdC8vIENvbW1hbmQgYnV0dG9uIHdpbGwgYmUgY3JlYXRlZCBsYXRlciB3aGVuIENvbW1hbmRTeXN0ZW0gaXMgc2V0XG5cblx0XHQvLyBTZW5kIGJ1dHRvblxuXHRcdHRoaXMuc2VuZEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQodGhpcy5pbnB1dFJvdyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEljb24oJ3NlbmQnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0VG9vbHRpcCgnU2VuZCBtZXNzYWdlJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5oYW5kbGVTZW5kKCkpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWluLXdpZHRoOiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRoZWlnaHQ6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAwO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcblx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRgO1xuXG5cdFx0Ly8gRW50ZXIga2V5IGhhbmRsaW5nIGFuZCBjb21tYW5kL3NlY3Rpb24gcGlja2VyXG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2tleWRvd24nLCAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0XHRjb25zdCBrZXlFdmVudCA9IGV2ZW50IGFzIEtleWJvYXJkRXZlbnQ7XG5cblx0XHRcdGlmIChrZXlFdmVudC5rZXkgPT09ICdFbnRlcicgJiYgIWtleUV2ZW50LnNoaWZ0S2V5KSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCh0aGlzLmNvbW1hbmRTeXN0ZW0/LmhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKSB8fCBmYWxzZSkgfHwgdGhpcy5oYW5kbGVTZW5kKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGtleUV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIHtcblx0XHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtPy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdFx0fSBlbHNlIGlmIChrZXlFdmVudC5rZXkgPT09ICdBcnJvd1VwJyB8fCBrZXlFdmVudC5rZXkgPT09ICdBcnJvd0Rvd24nKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNvbW1hbmRTeXN0ZW0/LmhhbmRsZUNvbW1hbmRQaWNrZXJOYXZpZ2F0aW9uKGtleUV2ZW50LmtleSkpIHtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKGtleUV2ZW50LmtleSA9PT0gJ1RhYicpIHtcblx0XHRcdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlck5hdmlnYXRpb24oa2V5RXZlbnQua2V5KSkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIElucHV0IGNoYW5nZSBoYW5kbGluZyBmb3IgY29tbWFuZCBwaWNrZXJcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAnaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtKSB7XG5cdFx0XHRcdHRoaXMuY29tbWFuZFN5c3RlbS5oYW5kbGVJbnB1dENoYW5nZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0Zm9jdXMoKTogdm9pZCB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy50ZXh0QXJlYT8uaW5wdXRFbCkge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdH1cblx0XHR9LCBJbnB1dEhhbmRsZXIuRk9DVVNfREVMQVlfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVTZW5kKCk6IHZvaWQge1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZSkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2xlYXIgaW5wdXRcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLmhpZGVDb250ZXh0UHJldmlldygpO1xuXG5cdFx0Ly8gVGhpcyB3b3VsZCB0eXBpY2FsbHkgY2FsbCBhIGNhbGxiYWNrIG9yIGVtaXQgYW4gZXZlbnRcblx0XHQvLyBGb3Igbm93LCB3ZSdsbCBhc3N1bWUgdGhlIHBhcmVudCBoYW5kbGVzIHRoZSBhY3R1YWwgc2VuZGluZ1xuXHRcdHRoaXMub25TZW5kTWVzc2FnZT8uKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBvblNlbmRNZXNzYWdlPzogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZDtcblxuXHRzZXRPblNlbmRNZXNzYWdlKGNhbGxiYWNrOiAobWVzc2FnZTogc3RyaW5nKSA9PiB2b2lkKTogdm9pZCB7XG5cdFx0dGhpcy5vblNlbmRNZXNzYWdlID0gY2FsbGJhY2s7XG5cdH1cblxuXHRnZXRWYWx1ZSgpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdH1cblxuXHRzZXRWYWx1ZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSh2YWx1ZSk7XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdH1cblxuXHRpbnNlcnRUZXh0KHRleHQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRjb25zdCB0ZXh0YXJlYSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRjb25zdCBzdGFydCA9IHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0O1xuXHRcdGNvbnN0IGVuZCA9IHRleHRhcmVhLnNlbGVjdGlvbkVuZDtcblxuXHRcdGNvbnN0IG5ld1ZhbHVlID0gY3VycmVudFZhbHVlLnNsaWNlKDAsIHN0YXJ0KSArIHRleHQgKyBjdXJyZW50VmFsdWUuc2xpY2UoZW5kKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhZnRlciBpbnNlcnRlZCB0ZXh0XG5cdFx0Y29uc3QgbmV3UG9zaXRpb24gPSBzdGFydCArIHRleHQubGVuZ3RoO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UobmV3UG9zaXRpb24sIG5ld1Bvc2l0aW9uKTtcblx0XHRcdHRleHRhcmVhLmZvY3VzKCk7XG5cdFx0fSwgMCk7XG5cblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0fVxuXG5cdGluc2VydFRleHRXaXRoQ3Vyc29yKGJlZm9yZUN1cnNvcjogc3RyaW5nLCBhZnRlckN1cnNvcjogc3RyaW5nID0gJycpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0Y29uc3Qgc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDtcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XG5cblx0XHRjb25zdCBuZXdWYWx1ZSA9IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBzdGFydCkgKyBiZWZvcmVDdXJzb3IgKyBhZnRlckN1cnNvciArIGN1cnJlbnRWYWx1ZS5zbGljZShlbmQpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUobmV3VmFsdWUpO1xuXG5cdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGJldHdlZW4gYmVmb3JlIGFuZCBhZnRlciB0ZXh0XG5cdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSBzdGFydCArIGJlZm9yZUN1cnNvci5sZW5ndGg7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0ZXh0YXJlYS5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3JQb3NpdGlvbiwgY3Vyc29yUG9zaXRpb24pO1xuXHRcdFx0dGV4dGFyZWEuZm9jdXMoKTtcblx0XHR9LCAwKTtcblxuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRFdmVudExpc3RlbmVyKGVsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyKTogdm9pZCB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2goeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KTtcblx0fVxuXG5cblx0cmVmcmVzaENvbW1hbmRCdXR0b24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbSkge1xuXHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtLnVwZGF0ZUNvbW1hbmRCdXR0b25WaXNpYmlsaXR5KCk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHQvLyBDbGVhbiB1cCB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5kZXN0cm95KCk7XG5cdFx0fVxuXG5cblx0XHQvLyBDbGVhbiB1cCBldmVudCBsaXN0ZW5lcnNcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzID0gW107XG5cdH1cbn0iLCAiLyoqXG4gKiBDdXN0b20gd2lraWxpbmsgYXV0b2NvbXBsZXRlIGZvciBOb3ZhIHRleHRhcmVhXG4gKiBQcm92aWRlcyBbW2RvY3VtZW50XV0gc3VnZ2VzdGlvbnMgd2hlbiB0eXBpbmcgaW4gTm92YSdzIHRleHRhcmVhXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUsIEFwcCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBXaWtpbGlua1N1Z2dlc3Rpb24ge1xuICAgIGZpbGU6IFRGaWxlO1xuICAgIGRpc3BsYXlUZXh0OiBzdHJpbmc7XG4gICAgc2NvcmU6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25Qb3B1cDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25zOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSA9IFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRJbmRleDogbnVtYmVyID0gLTE7XG4gICAgcHJpdmF0ZSBpc1Zpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGN1cnJlbnRRdWVyeTogc3RyaW5nID0gJyc7XG4gICAgcHJpdmF0ZSBjdXJyZW50VHJpZ2dlclBvczogbnVtYmVyID0gLTE7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQsIGNvbnRhaW5lcj86IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnRleHRBcmVhID0gdGV4dEFyZWE7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyIHx8IHRleHRBcmVhLnBhcmVudEVsZW1lbnQhO1xuICAgICAgICB0aGlzLnNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleWRvd24uYmluZCh0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbG9zZSBvbiBmb2N1cyBsb3NzXG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsICgpID0+IHtcbiAgICAgICAgICAgIC8vIERlbGF5IHRvIGFsbG93IHNlbGVjdGlvbiBjbGlja3NcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKSwgMTUwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgY2xpY2sgb3V0c2lkZVxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9uUG9wdXAgJiYgIXRoaXMuc3VnZ2VzdGlvblBvcHVwLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpICYmIGUudGFyZ2V0ICE9PSB0aGlzLnRleHRBcmVhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVJbnB1dCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dEFyZWEudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIFxuICAgICAgICAvLyBMb29rIGZvciBbWyBwYXR0ZXJuIGJlZm9yZSBjdXJzb3JcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC8oXFwrKT9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxpbmtNYXRjaCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlcnkgPSBsaW5rTWF0Y2hbMl0gfHwgJyc7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUcmlnZ2VyUG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuc2hvd1N1Z2dlc3Rpb25zKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlkb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWF4KHRoaXMuc2VsZWN0ZWRJbmRleCAtIDEsIC0xKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgICAgY2FzZSAnVGFiJzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24odGhpcy5zdWdnZXN0aW9uc1t0aGlzLnNlbGVjdGVkSW5kZXhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdFc2NhcGUnOlxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93U3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKHRoaXMuY3VycmVudFF1ZXJ5KTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVTdWdnZXN0aW9uUG9wdXAoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJTdWdnZXN0aW9ucygpO1xuICAgICAgICB0aGlzLnBvc2l0aW9uUG9wdXAoKTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhpZGVTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU3VnZ2VzdGlvblBvcHVwKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5jbGFzc05hbWUgPSAnbm92YS13aWtpbGluay1zdWdnZXN0aW9ucyc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBib3R0b206IDEwMCU7XG4gICAgICAgICAgICBsZWZ0OiAwO1xuICAgICAgICAgICAgcmlnaHQ6IDA7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuICAgICAgICAgICAgbWF4LWhlaWdodDogMjAwcHg7XG4gICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICAvLyBJbnNlcnQgaW4gdGhlIHByb3ZpZGVkIGNvbnRhaW5lciBmb3IgY29uc2lzdGVudCB3aWR0aFxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnN1Z2dlc3Rpb25Qb3B1cCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zLmZvckVhY2goKHN1Z2dlc3Rpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBpdGVtLmNsYXNzTmFtZSA9ICdub3ZhLXN1Z2dlc3Rpb24taXRlbSc7XG4gICAgICAgICAgICBpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgcGFkZGluZzogOHB4IDEycHg7XG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTmFtZSAoc3RhbmRhcmRpemVkIHRvIG1hdGNoIGNvbW1hbmQgcGlja2VyKVxuICAgICAgICAgICAgY29uc3QgbmFtZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBuYW1lRWwuY2xhc3NOYW1lID0gJ25vdmEtc3VnZ2VzdGlvbi1uYW1lJztcbiAgICAgICAgICAgIG5hbWVFbC50ZXh0Q29udGVudCA9IHN1Z2dlc3Rpb24uZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgICAgIG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChuYW1lRWwpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEZXNjcmlwdGlvbiAoc3RhbmRhcmRpemVkKVxuICAgICAgICAgICAgY29uc3QgZGVzY0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkZXNjRWwuY2xhc3NOYW1lID0gJ25vdmEtc3VnZ2VzdGlvbi1kZXNjJztcbiAgICAgICAgICAgIGRlc2NFbC50ZXh0Q29udGVudCA9IGBMaW5rIHRvIGRvY3VtZW50IGluICR7c3VnZ2VzdGlvbi5maWxlLnBhdGguaW5jbHVkZXMoJy8nKSA/IHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnN1YnN0cmluZygwLCBzdWdnZXN0aW9uLmZpbGUucGF0aC5sYXN0SW5kZXhPZignLycpKSA6ICdyb290J31gO1xuICAgICAgICAgICAgZGVzY0VsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjg1ZW07XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDRweDtcbiAgICAgICAgICAgIGA7XG4gICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKGRlc2NFbCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvbnRlbnQgUHJldmlldyAoc3RhbmRhcmRpemVkIHdpdGggbW9ub3NwYWNlKVxuICAgICAgICAgICAgY29uc3QgZXhhbXBsZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBleGFtcGxlRWwuY2xhc3NOYW1lID0gJ25vdmEtc3VnZ2VzdGlvbi1leGFtcGxlJztcbiAgICAgICAgICAgIHRoaXMuZ2V0RmlsZVByZXZpZXcoc3VnZ2VzdGlvbi5maWxlKS50aGVuKHByZXZpZXcgPT4ge1xuICAgICAgICAgICAgICAgIGV4YW1wbGVFbC50ZXh0Q29udGVudCA9IGBQcmV2aWV3OiAke3ByZXZpZXd9YDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZXhhbXBsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjhlbTtcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpO1xuICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChleGFtcGxlRWwpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cCEuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVTZWxlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5zdWdnZXN0aW9uUG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLm5vdmEtc3VnZ2VzdGlvbi1pdGVtJyk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gaXRlbSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHBvc2l0aW9uUG9wdXAoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIC8vIFBvc2l0aW9uIGFib3ZlIHRoZSB0ZXh0YXJlYSB3aXRoIGZ1bGwgY29udGFpbmVyIHdpZHRoIChtYXRjaGluZyBvdGhlciBwaWNrZXJzKVxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmxlZnQgPSAnMCc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLnJpZ2h0ID0gJzAnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5ib3R0b20gPSAnMTAwJSc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc0cHgnO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBXaWtpbGlua1N1Z2dlc3Rpb24pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dEFyZWEudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kIHRoZSBbWyBwYXR0ZXJuIHRvIHJlcGxhY2VcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC8oXFwrKT9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFsaW5rTWF0Y2gpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGlzUGVyc2lzdGVudCA9ICEhbGlua01hdGNoWzFdO1xuICAgICAgICBjb25zdCBzdGFydFBvcyA9IGN1cnNvclBvcyAtIGxpbmtNYXRjaFswXS5sZW5ndGg7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGhlIHJlcGxhY2VtZW50IHRleHRcbiAgICAgICAgY29uc3QgbGlua1RleHQgPSBgW1ske3N1Z2dlc3Rpb24uZmlsZS5iYXNlbmFtZX1dXWA7XG4gICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gaXNQZXJzaXN0ZW50ID8gYCske2xpbmtUZXh0fWAgOiBsaW5rVGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIHRleHRcbiAgICAgICAgY29uc3QgbmV3VGV4dCA9IHRleHQuc3Vic3RyaW5nKDAsIHN0YXJ0UG9zKSArIHJlcGxhY2VtZW50ICsgdGV4dC5zdWJzdHJpbmcoY3Vyc29yUG9zKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS52YWx1ZSA9IG5ld1RleHQ7XG4gICAgICAgIFxuICAgICAgICAvLyBQb3NpdGlvbiBjdXJzb3IgYWZ0ZXIgdGhlIGxpbmtcbiAgICAgICAgY29uc3QgbmV3Q3Vyc29yUG9zID0gc3RhcnRQb3MgKyByZXBsYWNlbWVudC5sZW5ndGg7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UobmV3Q3Vyc29yUG9zLCBuZXdDdXJzb3JQb3MpO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJpZ2dlciBpbnB1dCBldmVudCB0byB1cGRhdGUgYW55IGF1dG8tZ3JvdyBmdW5jdGlvbmFsaXR5XG4gICAgICAgIHRoaXMudGV4dEFyZWEuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSB7XG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogV2lraWxpbmtTdWdnZXN0aW9uW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgY29uc3Qgc2NvcmUgPSB0aGlzLnNjb3JlRmlsZShmaWxlLCBxdWVyeSk7XG4gICAgICAgICAgICBpZiAoc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUZXh0OiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgICAgICBzY29yZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTb3J0IGJ5IHNjb3JlIChoaWdoZXN0IGZpcnN0KSBhbmQgbGltaXQgcmVzdWx0c1xuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSlcbiAgICAgICAgICAgIC5zbGljZSgwLCA4KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNjb3JlRmlsZShmaWxlOiBURmlsZSwgcXVlcnk6IHN0cmluZyk6IG51bWJlciB7XG4gICAgICAgIGlmICghcXVlcnkpIHJldHVybiA1MDsgLy8gU2hvdyBhbGwgZmlsZXMgd2hlbiBubyBxdWVyeVxuICAgICAgICBcbiAgICAgICAgY29uc3QgYmFzZW5hbWUgPSBmaWxlLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgcXVlcnlMb3dlciA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFeGFjdCBtYXRjaFxuICAgICAgICBpZiAoYmFzZW5hbWUgPT09IHF1ZXJ5TG93ZXIpIHJldHVybiAxMDA7XG4gICAgICAgIFxuICAgICAgICAvLyBTdGFydHMgd2l0aCBxdWVyeVxuICAgICAgICBpZiAoYmFzZW5hbWUuc3RhcnRzV2l0aChxdWVyeUxvd2VyKSkgcmV0dXJuIDgwO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udGFpbnMgcXVlcnlcbiAgICAgICAgaWYgKGJhc2VuYW1lLmluY2x1ZGVzKHF1ZXJ5TG93ZXIpKSByZXR1cm4gNjA7XG4gICAgICAgIFxuICAgICAgICAvLyBQYXRoIGNvbnRhaW5zIHF1ZXJ5XG4gICAgICAgIGlmIChwYXRoLmluY2x1ZGVzKHF1ZXJ5TG93ZXIpKSByZXR1cm4gNDA7XG4gICAgICAgIFxuICAgICAgICAvLyBGdXp6eSBtYXRjaFxuICAgICAgICBpZiAodGhpcy5mdXp6eU1hdGNoKGJhc2VuYW1lLCBxdWVyeUxvd2VyKSkgcmV0dXJuIDIwO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmdXp6eU1hdGNoKHRleHQ6IHN0cmluZywgcXVlcnk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgdGV4dEluZGV4ID0gMDtcbiAgICAgICAgbGV0IHF1ZXJ5SW5kZXggPSAwO1xuICAgICAgICBcbiAgICAgICAgd2hpbGUgKHRleHRJbmRleCA8IHRleHQubGVuZ3RoICYmIHF1ZXJ5SW5kZXggPCBxdWVyeS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICh0ZXh0W3RleHRJbmRleF0gPT09IHF1ZXJ5W3F1ZXJ5SW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlJbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGV4dEluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBxdWVyeUluZGV4ID09PSBxdWVyeS5sZW5ndGg7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRGaWxlUHJldmlldyhmaWxlOiBURmlsZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb250bWF0dGVyIGlmIHByZXNlbnRcbiAgICAgICAgICAgIGxldCB0ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgICAgICBpZiAoY29udGVudC5zdGFydHNXaXRoKCctLS0nKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyRW5kID0gY29udGVudC5pbmRleE9mKCctLS0nLCAzKTtcbiAgICAgICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXJFbmQgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHRDb250ZW50ID0gY29udGVudC5zdWJzdHJpbmcoZnJvbnRtYXR0ZXJFbmQgKyAzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBmaXJzdCA1MCBjaGFyYWN0ZXJzIG9mIGFjdHVhbCB0ZXh0IGNvbnRlbnQsIHJlbW92aW5nIG1hcmtkb3duIGZvcm1hdHRpbmdcbiAgICAgICAgICAgIGNvbnN0IHBsYWluVGV4dCA9IHRleHRDb250ZW50XG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL14jKyAvZ20sICcnKSAvLyBSZW1vdmUgaGVhZGluZ3NcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwqXFwqKC4qPylcXCpcXCovZywgJyQxJykgLy8gUmVtb3ZlIGJvbGRcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwqKC4qPylcXCovZywgJyQxJykgLy8gUmVtb3ZlIGl0YWxpY1xuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXFsoLio/KVxcXVxcKC4qP1xcKS9nLCAnJDEnKSAvLyBSZW1vdmUgbGlua3NcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxuL2csICcgJykgLy8gUmVwbGFjZSBuZXdsaW5lcyB3aXRoIHNwYWNlc1xuICAgICAgICAgICAgICAgIC50cmltKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBwbGFpblRleHQubGVuZ3RoID4gNTAgPyBwbGFpblRleHQuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nIDogcGxhaW5UZXh0IHx8ICdFbXB0eSBmaWxlJztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiAnVW5hYmxlIHRvIGxvYWQgcHJldmlldyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZXN0cm95KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9uUG9wdXApIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuXG5pbnRlcmZhY2UgU3RydWN0dXJlZENvbW1hbmQge1xuXHRuYW1lOiBzdHJpbmc7XG5cdGRlc2NyaXB0aW9uOiBzdHJpbmc7XG5cdGNvbW1hbmQ6IHN0cmluZztcblx0dGVtcGxhdGU6IHN0cmluZztcblx0ZXhhbXBsZTogc3RyaW5nO1xuXHRrZXl3b3Jkczogc3RyaW5nW107XG59XG5cblxuLyoqXG4gKiBIYW5kbGVzIGNvbW1hbmQgcGlja2VyLCBjb21tYW5kIG1lbnUsIGFuZCBjb21tYW5kIGV4ZWN1dGlvblxuICovXG5leHBvcnQgY2xhc3MgQ29tbWFuZFN5c3RlbSB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgdGV4dEFyZWE6IFRleHRBcmVhQ29tcG9uZW50O1xuXHRwcml2YXRlIGNvbW1hbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgY29tbWFuZFBpY2tlciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXJJdGVtczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRwcml2YXRlIHNlbGVjdGVkQ29tbWFuZEluZGV4OiBudW1iZXIgPSAtMTtcblx0cHJpdmF0ZSBjb21tYW5kTWVudSE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGlzQ29tbWFuZE1lbnVWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBjb250YWluZXI6IEhUTUxFbGVtZW50LCB0ZXh0QXJlYTogVGV4dEFyZWFDb21wb25lbnQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLnRleHRBcmVhID0gdGV4dEFyZWE7XG5cdH1cblxuXHRjcmVhdGVDb21tYW5kQnV0dG9uKGlucHV0Um93OiBIVE1MRWxlbWVudCk6IEJ1dHRvbkNvbXBvbmVudCB7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldEljb24oJ3phcCcpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5zZXRUb29sdGlwKCdDb21tYW5kcycpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMudG9nZ2xlQ29tbWFuZE1lbnUoKSk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4td2lkdGg6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGhlaWdodDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogJHt0aGlzLnNob3VsZFNob3dDb21tYW5kQnV0dG9uKCkgPyAnZmxleCcgOiAnbm9uZSd9O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0cGFkZGluZzogMDtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0bWFyZ2luLXJpZ2h0OiB2YXIoLS1zaXplLTItMyk7XG5cdFx0YDtcblx0XHRyZXR1cm4gdGhpcy5jb21tYW5kQnV0dG9uO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHQvLyBMZWdhY3kgbWV0aG9kIC0gdXNlIGNyZWF0ZUNvbW1hbmRQaWNrZXJJbkNvbnRhaW5lciBpbnN0ZWFkXG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kUGlja2VySW5Db250YWluZXIodGhpcy5jb250YWluZXIpO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlcicgfSk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0YDtcblx0fVxuXG5cdHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbiAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpO1xuXHR9XG5cblx0dXBkYXRlQ29tbWFuZEJ1dHRvblZpc2liaWxpdHkoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZEJ1dHRvbikge1xuXHRcdFx0Y29uc3Qgc2hvdWxkU2hvdyA9IHRoaXMuc2hvdWxkU2hvd0NvbW1hbmRCdXR0b24oKTtcblx0XHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gc2hvdWxkU2hvdyA/ICdmbGV4JyA6ICdub25lJztcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY3JlYXRlQ29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUpIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRcdG1pbi13aWR0aDogMjUwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ29tbWFuZHMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gW1xuXHRcdFx0eyBuYW1lOiAnSW1wcm92ZSBXcml0aW5nJywgZGVzY3JpcHRpb246ICdFbmhhbmNlIGNsYXJpdHkgYW5kIGZsb3cnLCBjb21tYW5kOiAnL2ltcHJvdmUnIH0sXG5cdFx0XHR7IG5hbWU6ICdGaXggR3JhbW1hcicsIGRlc2NyaXB0aW9uOiAnQ29ycmVjdCBncmFtbWFyIGFuZCBzcGVsbGluZycsIGNvbW1hbmQ6ICcvZ3JhbW1hcicgfSxcblx0XHRcdHsgbmFtZTogJ1N1bW1hcml6ZScsIGRlc2NyaXB0aW9uOiAnQ3JlYXRlIGEgY29uY2lzZSBzdW1tYXJ5JywgY29tbWFuZDogJy9zdW1tYXJpemUnIH0sXG5cdFx0XHR7IG5hbWU6ICdFeHBhbmQgSWRlYXMnLCBkZXNjcmlwdGlvbjogJ0RldmVsb3AgdGhvdWdodHMgZnVydGhlcicsIGNvbW1hbmQ6ICcvZXhwYW5kJyB9LFxuXHRcdFx0eyBuYW1lOiAnRXhwbGFpbicsIGRlc2NyaXB0aW9uOiAnQ2xhcmlmeSBjb21wbGV4IGNvbmNlcHRzJywgY29tbWFuZDogJy9leHBsYWluJyB9LFxuXHRcdFx0eyBuYW1lOiAnQ29udGludWUgV3JpdGluZycsIGRlc2NyaXB0aW9uOiAnRXh0ZW5kIHRoZSBjdXJyZW50IHRleHQnLCBjb21tYW5kOiAnL2NvbnRpbnVlJyB9XG5cdFx0XTtcblxuXHRcdGNvbnN0IHRpdGxlID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnUXVpY2sgQ29tbWFuZHMnIH0pO1xuXHRcdHRpdGxlLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdGA7XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRjb25zdCBjbWRFbCA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0nIH0pO1xuXHRcdFx0Y21kRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtMi0zKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXhzKTtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xcztcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGNtZEVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5uYW1lIH0pO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IGRlc2NFbCA9IGNtZEVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5kZXNjcmlwdGlvbiB9KTtcblx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGA7XG5cblx0XHRcdGNtZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGNtZC5jb21tYW5kICsgJyAnKTtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Y21kRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0Y21kRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR9KTtcblxuXHRcdFx0Y21kRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0Y21kRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0aGFuZGxlSW5wdXRDaGFuZ2UoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnRleHRBcmVhKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGlucHV0ID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdC8vIEhhbmRsZSBkaWZmZXJlbnQgdHJpZ2dlcnNcblx0XHRpZiAoaW5wdXQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHQvLyBDdXN0b20gY29tbWFuZCB0cmlnZ2VyIC0gc2hvdyBzdHJ1Y3R1cmVkIGNvbW1hbmRzXG5cdFx0XHR0aGlzLnNob3dTdHJ1Y3R1cmVkQ29tbWFuZFBpY2tlcihpbnB1dCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIE5vIHRyaWdnZXJzIGFjdGl2ZSAtIGhpZGUgY29tbWFuZCBwaWNrZXJcblx0XHRcdC8vIE5vdGU6IFwiL1wiIGlzIGhhbmRsZWQgYnkgc2VjdGlvbiBwaWNrZXIsIG5vdCBjb21tYW5kIHN5c3RlbVxuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdH1cblx0fVxuXG5cblx0LyoqXG5cdCAqIFNob3cgc3RydWN0dXJlZCBjb21tYW5kIHBpY2tlciBmb3IgXCI6XCIgdHJpZ2dlciAgXG5cdCAqL1xuXHRwcml2YXRlIHNob3dTdHJ1Y3R1cmVkQ29tbWFuZFBpY2tlcihpbnB1dDogc3RyaW5nKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbW1hbmRQaWNrZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3Qgc3RydWN0dXJlZENvbW1hbmRzID0gdGhpcy5nZXRTdHJ1Y3R1cmVkQ29tbWFuZHMoKTtcblx0XHRjb25zdCBmaWx0ZXJUZXh0ID0gaW5wdXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsgLy8gUmVtb3ZlIFwiOlwiXG5cdFx0XG5cdFx0Y29uc3QgZmlsdGVyZWQgPSBzdHJ1Y3R1cmVkQ29tbWFuZHMuZmlsdGVyKGNtZCA9PiBcblx0XHRcdGNtZC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdGNtZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdGNtZC5rZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4ga2V5d29yZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpKVxuXHRcdCk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5lbXB0eSgpO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblxuXHRcdGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRmaWx0ZXJlZC5mb3JFYWNoKChjbWQsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlci1pdGVtJyB9KTtcblx0XHRcdFx0aXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5uYW1lIH0pO1xuXHRcdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLmRlc2NyaXB0aW9uIH0pO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuODVlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IGV4YW1wbGVFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogYEV4YW1wbGU6ICR7Y21kLmV4YW1wbGV9YCB9KTtcblx0XHRcdFx0ZXhhbXBsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpO1xuXHRcdFx0XHRcdGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKGNtZC50ZW1wbGF0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gaW5kZXg7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cdH1cblxuXHRoYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuXHRcdGlmIChrZXkgPT09ICdBcnJvd0Rvd24nKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCArIDEsIHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEpO1xuXHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ0Fycm93VXAnKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gTWF0aC5tYXgodGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCAtIDEsIC0xKTtcblx0XHRcdHRoaXMudXBkYXRlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIGlmIChrZXkgPT09ICdUYWInICYmIHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPj0gMCkge1xuXHRcdFx0Ly8gVXNlIHRoZSBzYW1lIGxvZ2ljIGFzIGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24gZm9yIFRhYlxuXHRcdFx0cmV0dXJuIHRoaXMuaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPj0gMCAmJiB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPiAwKSB7XG5cdFx0XHQvLyBGb3Igc3RydWN0dXJlZCBjb21tYW5kcywgd2UgbmVlZCB0byBnZXQgdGhlIHNlbGVjdGVkIGNvbW1hbmQgZnJvbSB0aGUgZmlsdGVyZWQgbGlzdFxuXHRcdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldFN0cnVjdHVyZWRDb21tYW5kcygpO1xuXHRcdFx0Y29uc3QgaW5wdXQgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XHRpZiAoaW5wdXQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRcdGNvbnN0IGZpbHRlclRleHQgPSBpbnB1dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRjb25zdCBmaWx0ZXJlZCA9IGNvbW1hbmRzLmZpbHRlcihjbWQgPT4gXG5cdFx0XHRcdFx0Y21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0XHRcdGNtZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdFx0XHRjbWQua2V5d29yZHMuc29tZShrZXl3b3JkID0+IGtleXdvcmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSlcblx0XHRcdFx0KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4IDwgZmlsdGVyZWQubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc2VsZWN0ZWRDbWQgPSBmaWx0ZXJlZFt0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4XTtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKHNlbGVjdGVkQ21kLnRlbXBsYXRlKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpbmRleCA9PT0gdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCkge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZChjb21tYW5kOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGNvbW1hbmQgKyAnICcpO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCBlbmRcblx0XHRjb25zdCBsZW5ndGggPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkubGVuZ3RoO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZShsZW5ndGgsIGxlbmd0aCk7XG5cdFx0XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHR9XG5cblxuXHQvKipcblx0ICogR2V0IHN0cnVjdHVyZWQgY29tbWFuZHMgZm9yIFwiOlwiIHRyaWdnZXJcblx0ICovXG5cdHByaXZhdGUgZ2V0U3RydWN0dXJlZENvbW1hbmRzKCk6IFN0cnVjdHVyZWRDb21tYW5kW10ge1xuXHRcdHJldHVybiBbXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdBZGQgU2VjdGlvbicsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnQWRkIGEgbmV3IHNlY3Rpb24gdG8gdGhlIGRvY3VtZW50Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2FkZCBzZWN0aW9uJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdhZGQgc2VjdGlvbiBcIntjdXJzb3J9XCInLFxuXHRcdFx0XHRleGFtcGxlOiAnOmFkZCBzZWN0aW9uIFwiUmVzdWx0c1wiJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY3JlYXRlJywgJ25ldycsICdoZWFkaW5nJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdFZGl0IFNlY3Rpb24nLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogJ0VkaXQgY29udGVudCBpbiBhIHNwZWNpZmljIHNlY3Rpb24nLFxuXHRcdFx0XHRjb21tYW5kOiAnZWRpdCBzZWN0aW9uJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdlZGl0IHtjdXJzb3J9IHNlY3Rpb24nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmVkaXQgTWV0aG9kcyBzZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnbW9kaWZ5JywgJ3VwZGF0ZScsICdjaGFuZ2UnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0RlbGV0ZSBTZWN0aW9uJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdSZW1vdmUgYSBzZWN0aW9uIGZyb20gdGhlIGRvY3VtZW50Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2RlbGV0ZSBzZWN0aW9uJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdkZWxldGUge2N1cnNvcn0gc2VjdGlvbicsXG5cdFx0XHRcdGV4YW1wbGU6ICc6ZGVsZXRlIEludHJvZHVjdGlvbiBzZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsncmVtb3ZlJywgJ2VsaW1pbmF0ZSddXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRuYW1lOiAnQXBwZW5kIFRvJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgY29udGVudCB0byB0aGUgZW5kIG9mIGEgc2VjdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdhcHBlbmQgdG8nLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2FwcGVuZCB7Y3Vyc29yfSB0byAvJyxcblx0XHRcdFx0ZXhhbXBsZTogJzphcHBlbmQgY29uY2x1c2lvbiB0byAvUmVzdWx0cycsXG5cdFx0XHRcdGtleXdvcmRzOiBbJ2FkZCcsICdhdHRhY2gnLCAnZW5kJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdQcmVwZW5kIFRvJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgY29udGVudCB0byB0aGUgYmVnaW5uaW5nIG9mIGEgc2VjdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdwcmVwZW5kIHRvJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdwcmVwZW5kIHtjdXJzb3J9IHRvIC8nLFxuXHRcdFx0XHRleGFtcGxlOiAnOnByZXBlbmQgd2FybmluZyB0byAvTWV0aG9kcycsXG5cdFx0XHRcdGtleXdvcmRzOiBbJ2FkZCcsICdiZWdpbm5pbmcnLCAnc3RhcnQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0luc2VydCBBZnRlcicsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnSW5zZXJ0IGNvbnRlbnQgYWZ0ZXIgYSBzZWN0aW9uIGhlYWRpbmcnLFxuXHRcdFx0XHRjb21tYW5kOiAnaW5zZXJ0IGFmdGVyJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdpbnNlcnQge2N1cnNvcn0gYWZ0ZXIgLyBoZWFkaW5nJyxcblx0XHRcdFx0ZXhhbXBsZTogJzppbnNlcnQgZGlhZ3JhbSBhZnRlciAvTWV0aG9kcyBoZWFkaW5nJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnYWRkJywgJ3BsYWNlJywgJ2FmdGVyJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdJbnNlcnQgQmVmb3JlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdJbnNlcnQgY29udGVudCBiZWZvcmUgYSBzZWN0aW9uIGhlYWRpbmcnLFxuXHRcdFx0XHRjb21tYW5kOiAnaW5zZXJ0IGJlZm9yZScsXG5cdFx0XHRcdHRlbXBsYXRlOiAnaW5zZXJ0IHtjdXJzb3J9IGJlZm9yZSAvIGhlYWRpbmcnLFxuXHRcdFx0XHRleGFtcGxlOiAnOmluc2VydCBub3RlIGJlZm9yZSAvUmVzdWx0cyBoZWFkaW5nJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnYWRkJywgJ3BsYWNlJywgJ2JlZm9yZSddXG5cdFx0XHR9XG5cdFx0XTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTZWxlY3QgYSBzdHJ1Y3R1cmVkIGNvbW1hbmQgYW5kIGluc2VydCB0ZW1wbGF0ZVxuXHQgKi9cblx0cHJpdmF0ZSBzZWxlY3RTdHJ1Y3R1cmVkQ29tbWFuZCh0ZW1wbGF0ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdFxuXHRcdC8vIFJlcGxhY2UgY3Vyc29yIHBsYWNlaG9sZGVyIGFuZCBpbnNlcnQgdGVtcGxhdGVcblx0XHRjb25zdCBjdXJzb3JQb3MgPSB0ZW1wbGF0ZS5pbmRleE9mKCd7Y3Vyc29yfScpO1xuXHRcdGlmIChjdXJzb3JQb3MgIT09IC0xKSB7XG5cdFx0XHRjb25zdCBiZWZvcmVDdXJzb3IgPSB0ZW1wbGF0ZS5zbGljZSgwLCBjdXJzb3JQb3MpO1xuXHRcdFx0Y29uc3QgYWZ0ZXJDdXJzb3IgPSB0ZW1wbGF0ZS5zbGljZShjdXJzb3JQb3MgKyA4KTsgLy8gTGVuZ3RoIG9mICd7Y3Vyc29yfSdcblx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoYmVmb3JlQ3Vyc29yICsgYWZ0ZXJDdXJzb3IpO1xuXHRcdFx0XG5cdFx0XHQvLyBQb3NpdGlvbiBjdXJzb3Igd2hlcmUge2N1cnNvcn0gd2FzXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKGN1cnNvclBvcywgY3Vyc29yUG9zKTtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSh0ZW1wbGF0ZSk7XG5cdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHR9XG5cdH1cblxuXHRjbGVhbnVwKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb21tYW5kUGlja2VyKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXIucmVtb3ZlKCk7XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgUGxhdGZvcm0sIFRGaWxlLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IE11bHRpRG9jQ29udGV4dEhhbmRsZXIsIE11bHRpRG9jQ29udGV4dCB9IGZyb20gJy4uL2NvcmUvbXVsdGktZG9jLWNvbnRleHQnO1xuXG4vKipcbiAqIEhhbmRsZXMgbXVsdGktZG9jdW1lbnQgY29udGV4dCBVSSBhbmQgbWFuYWdlbWVudFxuICovXG5leHBvcnQgY2xhc3MgQ29udGV4dE1hbmFnZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBhcHA6IEFwcDtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIG11bHRpRG9jSGFuZGxlcjogTXVsdGlEb2NDb250ZXh0SGFuZGxlcjtcblx0cHVibGljIGNvbnRleHRJbmRpY2F0b3IhOiBIVE1MRWxlbWVudDtcblx0cHVibGljIGNvbnRleHRQcmV2aWV3ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBOT1RJQ0VfRFVSQVRJT05fTVMgPSA1MDAwO1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogTm92YVBsdWdpbiwgYXBwOiBBcHAsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLm11bHRpRG9jSGFuZGxlciA9IG5ldyBNdWx0aURvY0NvbnRleHRIYW5kbGVyKGFwcCk7XG5cdH1cblxuXHRjcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1pbmRpY2F0b3InIH0pO1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0dG9wOiAtMnB4O1xuXHRcdFx0cmlnaHQ6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMSkgdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHotaW5kZXg6IDEwMDtcblx0XHRcdG1heC13aWR0aDogMjAwcHg7XG5cdFx0XHRib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctcyk7XG5cdFx0YDtcblx0fVxuXG5cdGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblx0XHRjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXcnIH0pO1xuXHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtMi0zKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbCk7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdGA7XG5cblx0XHRjb25zdCBwcmV2aWV3TGFiZWwgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnQ29udGV4dDogJyB9KTtcblx0XHRwcmV2aWV3TGFiZWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtd2VpZ2h0OiA2MDA7JztcblxuXHRcdGNvbnN0IHByZXZpZXdMaXN0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctbGlzdCcgfSk7XG5cdFx0cHJldmlld0xpc3Quc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsnO1xuXG5cdFx0cmV0dXJuIHByZXZpZXdDb250YWluZXI7XG5cdH1cblxuXHR1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRQcmV2aWV3IHx8ICF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCFtZXNzYWdlKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUGFyc2UgZG9jdW1lbnQgcmVmZXJlbmNlcyBmcm9tIGN1cnJlbnQgbWVzc2FnZVxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRjb25zdCBmb3VuZFJlZnM6IEFycmF5PHtuYW1lOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nfT4gPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcblx0XHRcdGZvdW5kUmVmcy5wdXNoKHsgbmFtZTogZG9jTmFtZSwgcHJvcGVydHkgfSk7XG5cdFx0fVxuXG5cdFx0aWYgKGZvdW5kUmVmcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBVcGRhdGUgcHJldmlldyBkaXNwbGF5XG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSB0aGlzLmNvbnRleHRQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0aWYgKHByZXZpZXdMaXN0KSB7XG5cdFx0XHRjb25zdCByZWZzVGV4dCA9IGZvdW5kUmVmcy5tYXAocmVmID0+IFxuXHRcdFx0XHRyZWYucHJvcGVydHkgPyBgJHtyZWYubmFtZX0jJHtyZWYucHJvcGVydHl9YCA6IHJlZi5uYW1lXG5cdFx0XHQpLmpvaW4oJywgJyk7XG5cdFx0XHRwcmV2aWV3TGlzdC50ZXh0Q29udGVudCA9IHJlZnNUZXh0O1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdH1cblxuXHRhc3luYyBidWlsZENvbnRleHQobWVzc2FnZTogc3RyaW5nLCBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsKTogUHJvbWlzZTxNdWx0aURvY0NvbnRleHQgfCBudWxsPiB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpIHx8ICFjdXJyZW50RmlsZSkge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubXVsdGlEb2NIYW5kbGVyLmJ1aWxkQ29udGV4dChtZXNzYWdlLCBjdXJyZW50RmlsZSk7XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gcmVzdWx0LmNvbnRleHQ7XG5cblx0XHRcdGlmIChyZXN1bHQuY29udGV4dD8ucGVyc2lzdGVudERvY3MubGVuZ3RoKSB7XG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcihyZXN1bHQuY29udGV4dCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayB0b2tlbiBsaW1pdFxuXHRcdFx0XHRpZiAocmVzdWx0LmNvbnRleHQuaXNOZWFyTGltaXQpIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgQXBwcm9hY2hpbmcgdG9rZW4gbGltaXQuIENvbnNpZGVyIHJlbW92aW5nIHNvbWUgZG9jdW1lbnRzIGZyb20gY29udGV4dC4nLCBDb250ZXh0TWFuYWdlci5OT1RJQ0VfRFVSQVRJT05fTVMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZXN1bHQuY29udGV4dDtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGJ1aWxkIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0SW5kaWNhdG9yKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0SW5kaWNhdG9yKSByZXR1cm47XG5cblx0XHRjb25zdCBkb2NDb3VudCA9IGNvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuXHRcdGlmIChkb2NDb3VudCA+IDApIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci50ZXh0Q29udGVudCA9IGAke2RvY0NvdW50fSBkb2Mke2RvY0NvdW50ID4gMSA/ICdzJyA6ICcnfWA7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cblx0XHRcdC8vIEFkZCBleHBhbmQgZnVuY3Rpb25hbGl0eVxuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5vbmNsaWNrID0gKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNob3dDb250ZXh0RGV0YWlscyhjb250ZXh0KTtcblx0XHRcdH07XG5cblx0XHRcdC8vIEFkZCBob3ZlciBlZmZlY3Rcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1ob3ZlciknO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb250ZXh0RGV0YWlscyhjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiB2b2lkIHtcblx0XHQvLyBDcmVhdGUgbW9kYWwgb3IgZXhwYW5kZWQgdmlld1xuXHRcdGNvbnN0IG1vZGFsID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LW1vZGFsJyB9KTtcblx0XHRtb2RhbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGZpeGVkO1xuXHRcdFx0dG9wOiAwO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym90dG9tOiAwO1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHotaW5kZXg6IDEwMDAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50ID0gbW9kYWwuY3JlYXRlRGl2KCk7XG5cdFx0Y29udGVudC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC00KTtcblx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0bWF4LWhlaWdodDogODAlO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRgO1xuXG5cdFx0Y29uc3QgaGVhZGVyID0gY29udGVudC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdDb250ZXh0IERvY3VtZW50cycgfSk7XG5cdFx0aGVhZGVyLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luLXRvcDogMDsgbWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTMpOyc7XG5cblx0XHRjb250ZXh0LnBlcnNpc3RlbnREb2NzLmZvckVhY2goZG9jID0+IHtcblx0XHRcdGNvbnN0IGRvY0VsID0gY29udGVudC5jcmVhdGVEaXYoKTtcblx0XHRcdGRvY0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXhzKTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGRvY0VsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGRvYy5maWxlLmJhc2VuYW1lIH0pO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDYwMDsgbWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpOyc7XG5cblx0XHRcdGlmIChkb2MucHJvcGVydHkpIHtcblx0XHRcdFx0Y29uc3QgcHJvcEVsID0gZG9jRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogYFByb3BlcnR5OiAke2RvYy5wcm9wZXJ0eX1gIH0pO1xuXHRcdFx0XHRwcm9wRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTaG93IGZpbGUgcGF0aCBhcyBwcmV2aWV3IHNpbmNlIGNvbnRlbnQgaXNuJ3QgZGlyZWN0bHkgYXZhaWxhYmxlXG5cdFx0XHRjb25zdCBwcmV2aWV3RWwgPSBkb2NFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBkb2MuZmlsZS5wYXRoIH0pO1xuXHRcdFx0cHJldmlld0VsLnN0eWxlLmNzc1RleHQgPSAnZm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IG1hcmdpbi10b3A6IHZhcigtLXNpemUtMi0xKTsnO1xuXHRcdH0pO1xuXG5cdFx0Y29uc3QgY2xvc2VCdG4gPSBjb250ZW50LmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDbG9zZScgfSk7XG5cdFx0Y2xvc2VCdG4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi10b3A6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcblx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRgO1xuXG5cdFx0Y2xvc2VCdG4ub25jbGljayA9ICgpID0+IG1vZGFsLnJlbW92ZSgpO1xuXHRcdG1vZGFsLm9uY2xpY2sgPSAoZSkgPT4ge1xuXHRcdFx0aWYgKGUudGFyZ2V0ID09PSBtb2RhbCkgbW9kYWwucmVtb3ZlKCk7XG5cdFx0fTtcblx0fVxuXG5cdGhpZGVDb250ZXh0UHJldmlldygpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGhpZGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFyQ3VycmVudENvbnRleHQoKTogdm9pZCB7XG5cdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0dGhpcy5oaWRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdHRoaXMuaGlkZUNvbnRleHRQcmV2aWV3KCk7XG5cdH1cblxuXHRnZXRDdXJyZW50Q29udGV4dCgpOiBNdWx0aURvY0NvbnRleHQgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5jdXJyZW50Q29udGV4dDtcblx0fVxuXG5cdGNsZWFudXAoKTogdm9pZCB7XG5cdFx0dGhpcy5jbGVhckN1cnJlbnRDb250ZXh0KCk7XG5cdFx0aWYgKHRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5yZW1vdmUoKTtcblx0XHR9XG5cdH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcblxuLyoqXG4gKiBIYW5kbGVzIGFsbCBjaGF0IG1lc3NhZ2UgcmVuZGVyaW5nIGFuZCBkaXNwbGF5IGxvZ2ljXG4gKi9cbmV4cG9ydCBjbGFzcyBDaGF0UmVuZGVyZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgU0NST0xMX0RFTEFZX01TID0gNTA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGNoYXRDb250YWluZXI7XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGEgY2hhdCBtZXNzYWdlIHdpdGggcm9sZSBoZWFkZXJcblx0ICovXG5cdGFkZE1lc3NhZ2Uocm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtJHtyb2xlfWAgfSk7XG5cdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMykgdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHQke3JvbGUgPT09ICd1c2VyJyBcblx0XHRcdFx0PyAnbWFyZ2luLWxlZnQ6IGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7JyBcblx0XHRcdFx0OiByb2xlID09PSAnc3lzdGVtJ1xuXHRcdFx0XHQ/ICdtYXJnaW46IDAgYXV0bzsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG5cdH1cblxuXHQvKipcblx0ICogSGVscGVyIG1ldGhvZCB0byBjcmVhdGUgc2ltcGxlIG1lc3NhZ2VzIHdpdGhvdXQgcm9sZSBoZWFkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZVNpbXBsZU1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBjbGFzc05hbWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2UgJHtjbGFzc05hbWV9YCB9KTtcblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdFxuXHRcdC8vIFN1cHBvcnQgaWNvbnMgaW4gbWVzc2FnZXNcblx0XHRpZiAoY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50RWwuaW5uZXJIVE1MID0gY29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gY29udGVudDtcblx0XHR9XG5cblx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKCk7XG5cdH1cblxuXHRhZGRFcnJvck1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jcmVhdGVTaW1wbGVNZXNzYWdlKGNvbnRlbnQsICdub3ZhLW1lc3NhZ2UtZXJyb3InKTtcblx0fVxuXG5cdGFkZFN1Y2Nlc3NNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuY3JlYXRlU2ltcGxlTWVzc2FnZShjb250ZW50LCAnbm92YS1tZXNzYWdlLXN1Y2Nlc3MnKTtcblx0fVxuXG5cdGFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2U/OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCB3ZWxjb21lRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lJyB9KTtcblx0XHR3ZWxjb21lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC00KTtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50ID0gbWVzc2FnZSB8fCBgXG5cdFx0XHQ8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGdhcDogdmFyKC0tc2l6ZS0yLTMpOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XCI+XG5cdFx0XHRcdDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IHZhcigtLWljb24tc2l6ZS14bCk7IGhlaWdodDogdmFyKC0taWNvbi1zaXplLXhsKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XCI+XG5cdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDwvc3ZnPlxuXHRcdFx0XHQ8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1sYXJnZSk7IGZvbnQtd2VpZ2h0OiA2MDA7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XCI+V2VsY29tZSB0byBOb3ZhPC9zcGFuPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMCAwIHZhcigtLXNpemUtNC0zKSAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1wiPlxuXHRcdFx0XHRZb3VyIEFJIHRoaW5raW5nIHBhcnRuZXIgZm9yIE9ic2lkaWFuLiBTdGFydCBhIGNvbnZlcnNhdGlvbiBvciB1c2UgY29tbWFuZHMgdG8gZW5oYW5jZSB5b3VyIHdyaXRpbmcuXG5cdFx0XHQ8L3A+XG5cdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgY29sb3I6IHZhcigtLXRleHQtZmFpbnQpOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpO1wiPlxuXHRcdFx0XHRcdUQ4M0RcdURDQTEgPHN0cm9uZz5UaXA6PC9zdHJvbmc+IFJlZmVyZW5jZSBvdGhlciBub3RlcyB3aXRoIFtbTm90ZSBOYW1lXV0gb3IgdXNlIHRoZSBcdTI2QTEgYnV0dG9uIGZvciBxdWljayBjb21tYW5kc1xuXHRcdFx0PC9wPlxuXHRcdGA7XG5cblx0XHR3ZWxjb21lRWwuaW5uZXJIVE1MID0gY29udGVudDtcblxuXHRcdC8vIEFkZCBkaXNtaXNzIGJ1dHRvblxuXHRcdGNvbnN0IGRpc21pc3NCdG4gPSB3ZWxjb21lRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xuXHRcdGRpc21pc3NCdG4udGV4dENvbnRlbnQgPSAnXHUwMEQ3Jztcblx0XHRkaXNtaXNzQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdHJpZ2h0OiB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLWxhcmdlKTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy14cyk7XG5cdFx0YDtcblxuXHRcdGRpc21pc3NCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3ZWxjb21lRWwucmVtb3ZlKCk7XG5cdFx0fSk7XG5cblx0XHRkaXNtaXNzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdH0pO1xuXG5cdFx0ZGlzbWlzc0J0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0ZGlzbWlzc0J0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKHRydWUpO1xuXHR9XG5cblx0Y2xlYXJDaGF0KCk6IHZvaWQge1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBzY3JvbGxUb0JvdHRvbShzbW9vdGg6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHNtb290aCkge1xuXHRcdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG8oe1xuXHRcdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodDtcblx0XHRcdH1cblx0XHR9LCBDaGF0UmVuZGVyZXIuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRDb252ZXJzYXRpb25IaXN0b3J5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHQvLyBEaXNwbGF5IG1lc3NhZ2VzIGluIHRoZSBVSVxuXHRcdGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKG1lc3NhZ2Uucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBtZXNzYWdlLmNvbnRlbnQpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFJUHJvdmlkZXIsIFByb3ZpZGVyVHlwZSwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBBSVByb3ZpZGVyU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENsYXVkZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvY2xhdWRlJztcbmltcG9ydCB7IE9wZW5BSVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb3BlbmFpJztcbmltcG9ydCB7IEdvb2dsZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvZ29vZ2xlJztcbmltcG9ydCB7IE9sbGFtYVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb2xsYW1hJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzJztcbmltcG9ydCB7IEZlYXR1cmVNYW5hZ2VyIH0gZnJvbSAnLi4vbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBBSVByb3ZpZGVyTWFuYWdlciB7XG5cdHByaXZhdGUgcHJvdmlkZXJzOiBNYXA8UHJvdmlkZXJUeXBlLCBBSVByb3ZpZGVyPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzZXR0aW5nczogTm92YVNldHRpbmdzO1xuXHRwcml2YXRlIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXI7XG5cblx0Y29uc3RydWN0b3Ioc2V0dGluZ3M6IE5vdmFTZXR0aW5ncywgZmVhdHVyZU1hbmFnZXI/OiBGZWF0dXJlTWFuYWdlcikge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gZmVhdHVyZU1hbmFnZXI7XG5cdH1cblxuXHRhc3luYyBpbml0aWFsaXplKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnY2xhdWRlJywgbmV3IENsYXVkZVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdvcGVuYWknLCBuZXcgT3BlbkFJUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2dvb2dsZScsIG5ldyBHb29nbGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb2xsYW1hJywgbmV3IE9sbGFtYVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hKSk7XG5cdH1cblxuXHR1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTm92YVNldHRpbmdzKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMucHJvdmlkZXJzLmZvckVhY2goKHByb3ZpZGVyLCB0eXBlKSA9PiB7XG5cdFx0XHRpZiAodHlwZSAhPT0gJ25vbmUnICYmIHR5cGUgaW4gdGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycykge1xuXHRcdFx0XHRwcm92aWRlci51cGRhdGVDb25maWc/Lih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzW3R5cGUgYXMga2V5b2YgQUlQcm92aWRlclNldHRpbmdzXSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGdldFBsYXRmb3JtUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0Y29uc3QgcGxhdGZvcm1TZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV07XG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gW3BsYXRmb3JtU2V0dGluZ3MucHJpbWFyeVByb3ZpZGVyLCAuLi5wbGF0Zm9ybVNldHRpbmdzLmZhbGxiYWNrUHJvdmlkZXJzXTtcblx0XHRcblx0XHQvLyBObyByZXN0cmljdGlvbnMgLSBhbGwgdXNlcnMgY2FuIHVzZSBhbGwgcHJvdmlkZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdFx0cmV0dXJuIHByb3ZpZGVycztcblx0fVxuXG5cblx0cHJpdmF0ZSBhc3luYyBnZXRBdmFpbGFibGVQcm92aWRlcigpOiBQcm9taXNlPEFJUHJvdmlkZXIgfCBudWxsPiB7XG5cdFx0Y29uc3Qgb3JkZXJlZFByb3ZpZGVycyA9IHRoaXMuZ2V0UGxhdGZvcm1Qcm92aWRlcnMoKTtcblx0XHRcblx0XHQvLyBJZiBwcmltYXJ5IHByb3ZpZGVyIGlzICdub25lJywgTm92YSBpcyBkaXNhYmxlZCBvbiB0aGlzIHBsYXRmb3JtXG5cdFx0aWYgKG9yZGVyZWRQcm92aWRlcnNbMF0gPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGZvciAoY29uc3QgcHJvdmlkZXJUeXBlIG9mIG9yZGVyZWRQcm92aWRlcnMpIHtcblx0XHRcdGlmIChwcm92aWRlclR5cGUgPT09ICdub25lJykgY29udGludWU7XG5cdFx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHByb3ZpZGVyLmlzQXZhaWxhYmxlKCkpIHtcblx0XHRcdFx0cmV0dXJuIHByb3ZpZGVyO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmdlbmVyYXRlVGV4dChwcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHR5aWVsZCogcHJvdmlkZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlci5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHlpZWxkKiBwcm92aWRlci5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRQcm92aWRlck5hbWVzKCk6IHN0cmluZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSkubWFwKHAgPT4gcC5uYW1lKTtcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRQcm92aWRlck5hbWUoKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRyZXR1cm4gcHJvdmlkZXIgPyBwcm92aWRlci5uYW1lIDogJ05vbmUnO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHRjb25zdCBvcmRlcmVkUHJvdmlkZXJzID0gdGhpcy5nZXRQbGF0Zm9ybVByb3ZpZGVycygpO1xuXHRcdGlmIChvcmRlcmVkUHJvdmlkZXJzWzBdID09PSAnbm9uZScpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBvcmRlcmVkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRcdGlmIChwcm92aWRlciAmJiBhd2FpdCBwcm92aWRlci5pc0F2YWlsYWJsZSgpKSB7XG5cdFx0XHRcdHJldHVybiBwcm92aWRlclR5cGU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNvbXBsZXRlKHN5c3RlbVByb21wdCwgdXNlclByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRBbGxvd2VkUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBPbGxhbWEgcmVxdWlyZXMgbG9jYWwgc2VydmVyIC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGVcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdFx0fVxuXHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHR9XG5cblx0aXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhbGxvd2VkXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRnZXRQcm92aWRlckxpbWl0cygpOiB7IGxvY2FsOiBudW1iZXI7IGNsb3VkOiBudW1iZXIgfSB7XG5cdFx0Ly8gTm8gbGltaXRzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4geyBsb2NhbDogSW5maW5pdHksIGNsb3VkOiBJbmZpbml0eSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRhc3luYyBnZXRQcm92aWRlck1vZGVscyhwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgUHJvdmlkZXIgJHtwcm92aWRlclR5cGV9IG5vdCBmb3VuZGApO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBnZXRBdmFpbGFibGVNb2RlbHMgbWV0aG9kXG5cdFx0aWYgKCdnZXRBdmFpbGFibGVNb2RlbHMnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5nZXRBdmFpbGFibGVNb2RlbHMgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHJldHVybiBhd2FpdCAocHJvdmlkZXIgYXMgYW55KS5nZXRBdmFpbGFibGVNb2RlbHMoKTtcblx0XHR9XG5cblx0XHQvLyBGb3IgcHJvdmlkZXJzIHdpdGhvdXQgQVBJIG1vZGVsIGxpc3RpbmcgKGxpa2UgT2xsYW1hKSwgcmV0dXJuIGVtcHR5IGFycmF5XG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIG1vZGVsIGNhY2hlIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRjbGVhclByb3ZpZGVyTW9kZWxDYWNoZShwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IHZvaWQge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBjbGVhck1vZGVsQ2FjaGUgbWV0aG9kXG5cdFx0aWYgKCdjbGVhck1vZGVsQ2FjaGUnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5jbGVhck1vZGVsQ2FjaGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdChwcm92aWRlciBhcyBhbnkpLmNsZWFyTW9kZWxDYWNoZSgpO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuY2xlYXIoKTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIENsYXVkZVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnQ2xhdWRlIChBbnRocm9waWMpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0Qm9keSA9IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLFxuXHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0cm9sZTogbXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ2Fzc2lzdGFudCcgOiAndXNlcicsXG5cdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHR9KSlcblx0XHR9KTtcblxuXHRcdC8vIFJldHJ5IGxvZ2ljIGZvciA1MDAtbGV2ZWwgZXJyb3JzXG5cdFx0Y29uc3QgbWF4UmV0cmllcyA9IDM7XG5cdFx0Y29uc3QgYmFzZURlbGF5ID0gMTAwMDsgLy8gMSBzZWNvbmRcblxuXHRcdGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcblx0XHRcdFx0XHR1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcblx0XHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0XHRcdCdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Ym9keTogcmVxdWVzdEJvZHlcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb247XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGEuY29udGVudFswXS50ZXh0O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIDUwMC1sZXZlbCBlcnJvciB0aGF0IHdlIHNob3VsZCByZXRyeVxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCAmJiBhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gUmV0cnlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvciBhbGwgb3RoZXIgZXJyb3JzIG9yIGZpbmFsIGF0dGVtcHQsIHRocm93IGVycm9yXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2xhdWRlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtyZXNwb25zZS50ZXh0fWApO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBOZXR3b3JrL2Nvbm5lY3Rpb24gZXJyb3JzIC0gcmV0cnkgaWYgbm90IGZpbmFsIGF0dGVtcHRcblx0XHRcdFx0aWYgKGF0dGVtcHQgPCBtYXhSZXRyaWVzICYmIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgKFxuXHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ05ldHdvcmsgZXJyb3InKSB8fCBcblx0XHRcdFx0XHRlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdGYWlsZWQgdG8gY29ubmVjdCcpXG5cdFx0XHRcdCkpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZS10aHJvdyB0aGUgZXJyb3IgaWYgaXQncyB0aGUgZmluYWwgYXR0ZW1wdCBvciBub3QgYSByZXRyeWFibGUgZXJyb3Jcblx0XHRcdFx0aWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5zdGFydHNXaXRoKCdDbGF1ZGUgQVBJIGVycm9yOicpKSB7XG5cdFx0XHRcdFx0dGhyb3cgZXJyb3I7IC8vIEFscmVhZHkgZm9ybWF0dGVkIGVycm9yXG5cdFx0XHRcdH1cblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBDbGF1ZGUgQVBJOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ05ldHdvcmsgZXJyb3InfWApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWQsIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIGl0XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJOiBNYXhpbXVtIHJldHJpZXMgZXhjZWVkZWQnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdC8vIEZvciBub3csIGZhbGwgYmFjayB0byBub24tc3RyZWFtaW5nIGZvciBDbGF1ZGUgZHVlIHRvIENPUlMgbGltaXRhdGlvbnNcblx0XHQvLyByZXF1ZXN0VXJsIGRvZXNuJ3Qgc3VwcG9ydCBzdHJlYW1pbmcsIHNvIHdlJ2xsIGdldCB0aGUgZnVsbCByZXNwb25zZSBhdCBvbmNlXG5cdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdFx0eWllbGQgeyBjb250ZW50OiByZXN1bHQsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gQ2xhdWRlIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHQvLyBGb3IgQ2xhdWRlLCB3ZSdsbCB1c2UgYSBoYXJkY29kZWQgbGlzdCBzaW5jZSBBbnRocm9waWMgZG9lc24ndCBwcm92aWRlIGEgbW9kZWxzIGVuZHBvaW50XG5cdFx0Ly8gQnV0IHdlIGNhbiB2YWxpZGF0ZSB0aGUgQVBJIGtleSBieSBtYWtpbmcgYSB0ZXN0IGNhbGxcblx0XHR0cnkge1xuXHRcdFx0Ly8gVmFsaWRhdGUgQVBJIGtleSB3aXRoIGEgbWluaW1hbCByZXF1ZXN0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0XHR1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcblx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdCd4LWFwaS1rZXknOiB0aGlzLmNvbmZpZy5hcGlLZXksXG5cdFx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0XHRtb2RlbDogJ2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0Jyxcblx0XHRcdFx0XHRtYXhfdG9rZW5zOiAxLFxuXHRcdFx0XHRcdG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICd0ZXN0JyB9XVxuXHRcdFx0XHR9KVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSBrZXkgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7cmVzcG9uc2UudGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmV0dXJuIGN1cnJlbnQgYXZhaWxhYmxlIG1vZGVscyAoZnJvbSBBUEkgZG9jcylcblx0XHRcdGNvbnN0IG1vZGVscyA9IFtcblx0XHRcdFx0J2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnLFxuXHRcdFx0XHQnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0Jyxcblx0XHRcdFx0J2NsYXVkZS0zLTctc29ubmV0LWxhdGVzdCcsXG5cdFx0XHRcdCdjbGF1ZGUtMy01LXNvbm5ldC1sYXRlc3QnLFxuXHRcdFx0XHQnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIENsYXVkZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9wZW5BSVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT3BlbkFJJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9jaGF0L2NvbXBsZXRpb25zJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2A7XG5cdFx0XG5cdFx0Y29uc3QgcmVxdWVzdEJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjdcblx0XHR9KTtcblxuXHRcdC8vIFJldHJ5IGxvZ2ljIGZvciA1MDAtbGV2ZWwgZXJyb3JzXG5cdFx0Y29uc3QgbWF4UmV0cmllcyA9IDM7XG5cdFx0Y29uc3QgYmFzZURlbGF5ID0gMTAwMDsgLy8gMSBzZWNvbmRcblxuXHRcdGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Ym9keTogcmVxdWVzdEJvZHlcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLm9rKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSA1MDAtbGV2ZWwgZXJyb3IgdGhhdCB3ZSBzaG91bGQgcmV0cnlcblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA+PSA1MDAgJiYgYXR0ZW1wdCA8IG1heFJldHJpZXMpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpOyAvLyBFeHBvbmVudGlhbCBiYWNrb2ZmXG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG5cdFx0XHRcdFx0Y29udGludWU7IC8vIFJldHJ5XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBGb3IgYWxsIG90aGVyIGVycm9ycyBvciBmaW5hbCBhdHRlbXB0LCB0aHJvdyBlcnJvclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gTmV0d29yayBlcnJvcnMgLSByZXRyeSBpZiBub3QgZmluYWwgYXR0ZW1wdFxuXHRcdFx0XHRpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMgJiYgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdmZXRjaCcpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTtcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gUmUtdGhyb3cgdGhlIGVycm9yIGlmIGl0J3MgdGhlIGZpbmFsIGF0dGVtcHQgb3Igbm90IGEgbmV0d29yayBlcnJvclxuXHRcdFx0XHR0aHJvdyBlcnJvcjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBUaGlzIHNob3VsZCBuZXZlciBiZSByZWFjaGVkLCBidXQgVHlwZVNjcmlwdCB3YW50cyBpdFxuXHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSTogTWF4aW11bSByZXRyaWVzIGV4Y2VlZGVkJyk7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW1xuXHRcdFx0eyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG5cdFx0XHR7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XG5cdFx0XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlcXVlc3RNZXNzYWdlcyA9IFsuLi5tZXNzYWdlc107XG5cdFx0aWYgKG9wdGlvbnM/LnN5c3RlbVByb21wdCkge1xuXHRcdFx0cmVxdWVzdE1lc3NhZ2VzLnVuc2hpZnQoeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogb3B0aW9ucy5zeXN0ZW1Qcm9tcHQgfSk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdGNvbnN0IGVuZHBvaW50ID0gYmFzZVVybC5lbmRzV2l0aCgnL2NoYXQvY29tcGxldGlvbnMnKSA/IGJhc2VVcmwgOiBgJHtiYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYDtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnZ3B0LTMuNS10dXJibycsXG5cdFx0XHRcdG1lc3NhZ2VzOiByZXF1ZXN0TWVzc2FnZXMsXG5cdFx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0c3RyZWFtOiB0cnVlXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2RhdGE6ICcpKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBkYXRhID0gbGluZS5zbGljZSg2KTtcblx0XHRcdFx0XHRcdGlmIChkYXRhID09PSAnW0RPTkVdJykge1xuXHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IHBhcnNlZC5jaG9pY2VzPy5bMF0/LmRlbHRhPy5jb250ZW50O1xuXHRcdFx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gT3BlbkFJIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvbW9kZWxzJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vbW9kZWxzYDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ3B0LTQuMS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbWluaS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbmFuby0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00bycsXG5cdFx0XHRcdCdncHQtNG8tbWluaSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggT3BlbkFJIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgR29vZ2xlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdHb29nbGUgKEdlbWluaSknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgc3lzdGVtUHJvbXB0Pzogc3RyaW5nKTogYW55IHtcblx0XHRjb25zdCBjb250ZW50cyA9IFtdO1xuXHRcdFxuXHRcdGlmIChzeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlOiAndXNlcicsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBgU3lzdGVtOiAke3N5c3RlbVByb21wdH1gIH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgbWVzc2FnZXMpIHtcblx0XHRcdGNvbnN0IHJvbGUgPSBtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ21vZGVsJyA6ICd1c2VyJztcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogbWVzc2FnZS5jb250ZW50IH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29udGVudHM7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdHb29nbGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS1wcm8nO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRcdGdlbmVyYXRpb25Db25maWc6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktcHJvJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzLCBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGV4dCA9IHBhcnNlZC5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XG5cdFx0XHRcdFx0XHRcdGlmICh0ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiB0ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBHb29nbGUgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscz9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA0LTE3Jyxcblx0XHRcdFx0J2dlbWluaS0yLjUtcHJvLXByZXZpZXctMDMtMjUnLFxuXHRcdFx0XHQnZ2VtaW5pLTIuMC1mbGFzaCcsXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoLWxpdGUnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIEdvb2dsZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9sbGFtYVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT2xsYW1hIChMb2NhbCknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdGlmICghdGhpcy5jb25maWcubW9kZWwpIHJldHVybiBmYWxzZTsgLy8gUmVxdWlyZSBtb2RlbCB0byBiZSBzZXRcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvdGFnc2AsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHJlc3BvbnNlLm9rO1xuXHRcdH0gY2F0Y2gge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IGZhbHNlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLnJlc3BvbnNlO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLnJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQucmVzcG9uc2UsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5tZXNzYWdlLmNvbnRlbnQ7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW1xuXHRcdFx0eyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG5cdFx0XHR7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XG5cdFx0XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2NoYXRgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSksXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLm1lc3NhZ2U/LmNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHBhcnNlZC5tZXNzYWdlLmNvbnRlbnQsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxufSIsICIvKipcbiAqIENvcmUgZG9jdW1lbnQgZW5naW5lIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFsbCBkb2N1bWVudCBtYW5pcHVsYXRpb24gYW5kIGVkaXRvciBpbnRlcmFjdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBURmlsZSwgRWRpdG9yUG9zaXRpb24sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50Q29udGV4dCwgSGVhZGluZ0luZm8sIEVkaXRSZXN1bHQsIEVkaXRPcHRpb25zLCBEb2N1bWVudFNlY3Rpb24sIEVkaXRDb21tYW5kIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyLCBEYXRhU3RvcmUgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIERvY3VtZW50RW5naW5lIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIGRhdGFTdG9yZT86IERhdGFTdG9yZSkge1xuICAgICAgICBpZiAoZGF0YVN0b3JlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb24pXG4gICAgICovXG4gICAgc2V0Q29udmVyc2F0aW9uTWFuYWdlcihjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IGNvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZWRpdG9yIGluc3RhbmNlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRWRpdG9yKCk6IEVkaXRvciB8IG51bGwge1xuICAgICAgICAvLyBGaXJzdCB0cnkgdGhlIHdvcmtzcGFjZSBtZXRob2RcbiAgICAgICAgY29uc3QgYWN0aXZlRWRpdG9yID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUVkaXRvcjtcbiAgICAgICAgaWYgKGFjdGl2ZUVkaXRvcj8uZWRpdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aXZlRWRpdG9yLmVkaXRvcjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIGdldCB0aGUgYWN0aXZlIG1hcmtkb3duIHZpZXdcbiAgICAgICAgbGV0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBcbiAgICAgICAgLy8gSWYgbm8gYWN0aXZlIG1hcmtkb3duIHZpZXcsIHRyeSB0byBmaW5kIGFueSBtYXJrZG93biB2aWV3XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZWFmVmlldyA9IGxlYWYudmlldztcbiAgICAgICAgICAgICAgICBpZiAobGVhZlZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldyA9IGxlYWZWaWV3O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSBkaWZmZXJlbnQgd2F5cyB0byBnZXQgdGhlIGVkaXRvclxuICAgICAgICBjb25zdCBlZGl0b3IgPSB2aWV3LmVkaXRvcjtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IgfHwgbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGl2ZSBmaWxlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRmlsZSgpOiBURmlsZSB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgZ2V0U2VsZWN0ZWRUZXh0KCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBnZXRDdXJzb3JQb3NpdGlvbigpOiBFZGl0b3JQb3NpdGlvbiB8IG51bGwge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY29tcHJlaGVuc2l2ZSBkb2N1bWVudCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KCk6IFByb21pc2U8RG9jdW1lbnRDb250ZXh0IHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIWVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHRoaXMuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5nZXRDdXJzb3JQb3NpdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBoZWFkaW5ncyBmcm9tIHRoZSBkb2N1bWVudFxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZXh0cmFjdEhlYWRpbmdzKGNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHN1cnJvdW5kaW5nIGxpbmVzIGZvciBjb250ZXh0XG4gICAgICAgIGNvbnN0IHN1cnJvdW5kaW5nTGluZXMgPSBjdXJzb3JQb3NpdGlvbiA/IFxuICAgICAgICAgICAgdGhpcy5nZXRTdXJyb3VuZGluZ0xpbmVzKGNvbnRlbnQsIGN1cnNvclBvc2l0aW9uLmxpbmUpIDogXG4gICAgICAgICAgICB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICBoZWFkaW5ncyxcbiAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogc2VsZWN0ZWRUZXh0IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGN1cnNvclBvc2l0aW9uOiBjdXJzb3JQb3NpdGlvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBzdXJyb3VuZGluZ0xpbmVzXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBoZWFkaW5ncyBmcm9tIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RIZWFkaW5ncyhjb250ZW50OiBzdHJpbmcpOiBIZWFkaW5nSW5mb1tdIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IEhlYWRpbmdJbmZvW10gPSBbXTtcbiAgICAgICAgbGV0IGNoYXJDb3VudCA9IDA7XG5cbiAgICAgICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgaWYgKGhlYWRpbmdNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gaGVhZGluZ01hdGNoWzFdLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gaGVhZGluZ01hdGNoWzJdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGhlYWRpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LFxuICAgICAgICAgICAgICAgICAgICBsZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogY2hhckNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBjaGFyQ291bnQgKyBsaW5lLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBsaW5lIGxlbmd0aCArIG5ld2xpbmUgY2hhcmFjdGVyXG4gICAgICAgICAgICBjaGFyQ291bnQgKz0gbGluZS5sZW5ndGggKyAxO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaGVhZGluZ3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGxpbmVzIHN1cnJvdW5kaW5nIHRoZSBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFN1cnJvdW5kaW5nTGluZXMoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGN1cnJlbnRMaW5lOiBudW1iZXIsIFxuICAgICAgICBjb250ZXh0U2l6ZTogbnVtYmVyID0gNVxuICAgICk6IHsgYmVmb3JlOiBzdHJpbmdbXTsgYWZ0ZXI6IHN0cmluZ1tdIH0ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3RhcnRMaW5lID0gTWF0aC5tYXgoMCwgY3VycmVudExpbmUgLSBjb250ZXh0U2l6ZSk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBjdXJyZW50TGluZSArIGNvbnRleHRTaXplKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBiZWZvcmU6IGxpbmVzLnNsaWNlKHN0YXJ0TGluZSwgY3VycmVudExpbmUpLFxuICAgICAgICAgICAgYWZ0ZXI6IGxpbmVzLnNsaWNlKGN1cnJlbnRMaW5lICsgMSwgZW5kTGluZSArIDEpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgYW4gZWRpdCB0byB0aGUgZG9jdW1lbnRcbiAgICAgKi9cbiAgICBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcG9zaXRpb246ICdjdXJzb3InIHwgJ3NlbGVjdGlvbicgfCAnZW5kJyB8IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0sXG4gICAgICAgIG9wdGlvbnM6IEVkaXRPcHRpb25zID0ge31cbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgYXBwbGllZEF0OiBFZGl0b3JQb3NpdGlvbjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnY3Vyc29yJykge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihjb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lID0gZWRpdG9yLmxhc3RMaW5lKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmVMZW5ndGggPSBlZGl0b3IuZ2V0TGluZShsYXN0TGluZSkubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGN1cnJlbnRDb250ZW50ICsgKGN1cnJlbnRDb250ZW50LmVuZHNXaXRoKCdcXG4nKSA/ICcnIDogJ1xcbicpICsgY29udGVudDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVc2UgdmF1bHQubW9kaWZ5IGZvciB1bmRvL3JlZG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IHNwZWNpZmljIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gcG9zaXRpb247XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBIYW5kbGUgcG9zdC1lZGl0IG9wdGlvbnNcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNlbGVjdE5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGFwcGxpZWRBdC5saW5lICsgY29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgY2g6IGNvbnRlbnQuaW5jbHVkZXMoJ1xcbicpID8gXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnNwbGl0KCdcXG4nKS5wb3AoKSEubGVuZ3RoIDogXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQuY2ggKyBjb250ZW50Lmxlbmd0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihhcHBsaWVkQXQsIGVuZFBvcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNjcm9sbFRvRWRpdCkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IGFwcGxpZWRBdCxcbiAgICAgICAgICAgICAgICAgICAgdG86IGFwcGxpZWRBdFxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogcG9zaXRpb24gPT09ICdzZWxlY3Rpb24nID8gJ3JlcGxhY2UnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPT09ICdlbmQnID8gJ2FwcGVuZCcgOiAnaW5zZXJ0JyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBjb250ZW50IGF0IGN1cnNvciBsb2NhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGRlbGV0ZUNvbnRlbnQoXG4gICAgICAgIHRhcmdldDogJ3NlbGVjdGlvbicgfCAnbGluZSdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCcnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdsaW5lJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gY3Vyc29yLmxpbmU7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZSwgY2g6IDAgfSwgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogbGluZSArIDEsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmUsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBmdWxsIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBnZXREb2N1bWVudENvbnRlbnQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIHRoZSBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIGFzeW5jIHNldERvY3VtZW50Q29udGVudChjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENvbnZlcnNhdGlvbiBtYW5hZ2VtZW50IG1ldGhvZHNcblxuICAgIC8qKlxuICAgICAqIEFkZCB1c2VyIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkVXNlck1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBjb21tYW5kPzogRWRpdENvbW1hbmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShmaWxlLCBjb250ZW50LCBjb21tYW5kKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhc3Npc3RhbnQgcmVzcG9uc2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShjb250ZW50OiBzdHJpbmcsIHJlc3VsdD86IEVkaXRSZXN1bHQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGZpbGUsIGNvbnRlbnQsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgc3lzdGVtIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkU3lzdGVtTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRTeXN0ZW1NZXNzYWdlKGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGUsIG1heE1lc3NhZ2VzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyQ29udmVyc2F0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmNsZWFyQ29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25TdGF0cygpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBzdHJpbmcgfCBudWxsO1xuICAgICAgICBjb252ZXJzYXRpb25BZ2U6IG51bWJlcjtcbiAgICB9IHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0U3RhdHMoZmlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgY3VycmVudCBmaWxlIGhhcyBhbiBhY3RpdmUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgaGFzQ29udmVyc2F0aW9uKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuaGFzQ29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbigpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5leHBvcnRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgfVxuXG59IiwgIi8qKlxuICogQ29udmVyc2F0aW9uIE1hbmFnZXIgZm9yIE5vdmFcbiAqIEhhbmRsZXMgZmlsZS1zY29wZWQgY29udmVyc2F0aW9uIHN0b3JhZ2UgYW5kIHJldHJpZXZhbFxuICovXG5cbmltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSwgQ29udmVyc2F0aW9uTWVzc2FnZSwgRWRpdENvbW1hbmQsIEVkaXRSZXN1bHQsIEVkaXRBY3Rpb24gfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBEYXRhU3RvcmUge1xuICAgIGxvYWREYXRhKGtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+O1xuICAgIHNhdmVEYXRhKGtleTogc3RyaW5nLCBkYXRhOiBhbnkpOiBQcm9taXNlPHZvaWQ+O1xufVxuXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uTWFuYWdlciB7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25zOiBNYXA8c3RyaW5nLCBDb252ZXJzYXRpb25EYXRhPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIG1heE1lc3NhZ2VzUGVyRmlsZSA9IDEwMDsgLy8gTGltaXQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICBwcml2YXRlIHN0b3JhZ2VLZXkgPSAnbm92YS1jb252ZXJzYXRpb25zJztcbiAgICBwcml2YXRlIGNsZWFudXBJbnRlcnZhbDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRhdGFTdG9yZTogRGF0YVN0b3JlKSB7XG4gICAgICAgIHRoaXMubG9hZENvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgdGhpcy5zdGFydFBlcmlvZGljQ2xlYW51cCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWQgY29udmVyc2F0aW9ucyBmcm9tIHBsdWdpbiBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkQ29udmVyc2F0aW9ucygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmRhdGFTdG9yZS5sb2FkRGF0YSh0aGlzLnN0b3JhZ2VLZXkpO1xuICAgICAgICAgICAgaWYgKGRhdGEgJiYgQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29udmVyc2F0aW9uIG9mIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChjb252ZXJzYXRpb24uZmlsZVBhdGgsIGNvbnZlcnNhdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGRhdGEgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSBjb252ZXJzYXRpb25zIHRvIHBsdWdpbiBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlQ29udmVyc2F0aW9ucygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbnNBcnJheSA9IEFycmF5LmZyb20odGhpcy5jb252ZXJzYXRpb25zLnZhbHVlcygpKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGF0YVN0b3JlLnNhdmVEYXRhKHRoaXMuc3RvcmFnZUtleSwgY29udmVyc2F0aW9uc0FycmF5KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxlZCB0byBzYXZlIGNvbnZlcnNhdGlvbiBkYXRhIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gZm9yIGEgc3BlY2lmaWMgZmlsZVxuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IENvbnZlcnNhdGlvbkRhdGEge1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgXG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25zLmhhcyhmaWxlUGF0aCkpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgY29udmVyc2F0aW9uIGZvciB0aGlzIGZpbGVcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbnZlcnNhdGlvbjogQ29udmVyc2F0aW9uRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdENvdW50OiAwLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kRnJlcXVlbmN5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQoZmlsZVBhdGgsIG5ld0NvbnZlcnNhdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25zLmdldChmaWxlUGF0aCkhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHVzZXIgbWVzc2FnZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkVXNlck1lc3NhZ2UoXG4gICAgICAgIGZpbGU6IFRGaWxlLCBcbiAgICAgICAgY29udGVudDogc3RyaW5nLCBcbiAgICAgICAgY29tbWFuZD86IEVkaXRDb21tYW5kXG4gICAgKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgY29tbWFuZFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBjb21tYW5kIGZyZXF1ZW5jeSBpZiBjb21tYW5kIHByb3ZpZGVkXG4gICAgICAgIGlmIChjb21tYW5kICYmIGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3lbY29tbWFuZC5hY3Rpb25dKys7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhbiBhc3Npc3RhbnQgcmVzcG9uc2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgICAgIHJlc3VsdD86IEVkaXRSZXN1bHRcbiAgICApOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIC8vIEluY3JlbWVudCBlZGl0IGNvdW50IGlmIHJlc3VsdCBpbmRpY2F0ZXMgc3VjY2Vzc2Z1bCBlZGl0XG4gICAgICAgIGlmIChyZXN1bHQ/LnN1Y2Nlc3MgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50Kys7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHN5c3RlbSBtZXNzYWdlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRTeXN0ZW1NZXNzYWdlKGZpbGU6IFRGaWxlLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHJlY2VudCBtZXNzYWdlcyBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIGdldFJlY2VudE1lc3NhZ2VzKGZpbGU6IFRGaWxlLCBjb3VudDogbnVtYmVyID0gMTApOiBDb252ZXJzYXRpb25NZXNzYWdlW10ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5zbGljZSgtY291bnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBtZXNzYWdlcyBieSByb2xlXG4gICAgICovXG4gICAgZ2V0TWVzc2FnZXNCeVJvbGUoZmlsZTogVEZpbGUsIHJvbGU6IENvbnZlcnNhdGlvbk1lc3NhZ2VbJ3JvbGUnXSk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmZpbHRlcihtc2cgPT4gbXNnLnJvbGUgPT09IHJvbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBmb3IgQUkgcHJvbXB0c1xuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbkNvbnRleHQoZmlsZTogVEZpbGUsIG1heE1lc3NhZ2VzOiBudW1iZXIgPSA2KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZXMgPSB0aGlzLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIG1heE1lc3NhZ2VzKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRleHRMaW5lcyA9IG1lc3NhZ2VzLm1hcChtc2cgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUobXNnLnRpbWVzdGFtcCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7XG4gICAgICAgICAgICBsZXQgbGluZSA9IGBbJHt0aW1lc3RhbXB9XSAke21zZy5yb2xlLnRvVXBwZXJDYXNlKCl9OiAke21zZy5jb250ZW50fWA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtc2cuY29tbWFuZCkge1xuICAgICAgICAgICAgICAgIGxpbmUgKz0gYCAoQ29tbWFuZDogJHttc2cuY29tbWFuZC5hY3Rpb259ICR7bXNnLmNvbW1hbmQudGFyZ2V0fSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobXNnLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGxpbmUgKz0gYCAoUmVzdWx0OiAke21zZy5yZXN1bHQuc3VjY2VzcyA/ICdzdWNjZXNzJyA6ICdmYWlsZWQnfSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGBQcmV2aW91cyBjb252ZXJzYXRpb246XFxuJHtjb250ZXh0TGluZXMuam9pbignXFxuJyl9XFxuYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBjb252ZXJzYXRpb24gZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyQ29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQgPSAwO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kgPSB7XG4gICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgIGVkaXQ6IDAsXG4gICAgICAgICAgICAgICAgZGVsZXRlOiAwLFxuICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgcmV3cml0ZTogMCxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIHN0YXRpc3RpY3NcbiAgICAgKi9cbiAgICBnZXRTdGF0cyhmaWxlOiBURmlsZSk6IHtcbiAgICAgICAgbWVzc2FnZUNvdW50OiBudW1iZXI7XG4gICAgICAgIGVkaXRDb3VudDogbnVtYmVyO1xuICAgICAgICBtb3N0VXNlZENvbW1hbmQ6IEVkaXRBY3Rpb24gfCBudWxsO1xuICAgICAgICBjb252ZXJzYXRpb25BZ2U6IG51bWJlcjtcbiAgICB9IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBsZXQgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGxldCBtYXhDb3VudCA9IDA7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFthY3Rpb24sIGNvdW50XSBvZiBPYmplY3QuZW50cmllcyhjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY291bnQgPiBtYXhDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBtYXhDb3VudCA9IGNvdW50O1xuICAgICAgICAgICAgICAgICAgICBtb3N0VXNlZENvbW1hbmQgPSBhY3Rpb24gYXMgRWRpdEFjdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb252ZXJzYXRpb25BZ2UgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCBcbiAgICAgICAgICAgID8gRGF0ZS5ub3coKSAtIGNvbnZlcnNhdGlvbi5tZXNzYWdlc1swXS50aW1lc3RhbXBcbiAgICAgICAgICAgIDogMDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWVzc2FnZUNvdW50OiBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoLFxuICAgICAgICAgICAgZWRpdENvdW50OiBjb252ZXJzYXRpb24ubWV0YWRhdGE/LmVkaXRDb3VudCB8fCAwLFxuICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kLFxuICAgICAgICAgICAgY29udmVyc2F0aW9uQWdlXG4gICAgICAgIH07XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29uc3QgbGluZXMgPSBbYCMgQ29udmVyc2F0aW9uIEhpc3RvcnkgZm9yICR7ZmlsZS5uYW1lfWAsICcnXTtcblxuICAgICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgY29udmVyc2F0aW9uLm1lc3NhZ2VzKSB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZShtZXNzYWdlLnRpbWVzdGFtcCkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICAgICAgICAgIGxpbmVzLnB1c2goYCMjICR7bWVzc2FnZS5yb2xlLnRvVXBwZXJDYXNlKCl9ICgke3RpbWVzdGFtcH0pYCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKG1lc3NhZ2UuY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqQ29tbWFuZDogJHttZXNzYWdlLmNvbW1hbmQuYWN0aW9ufSAke21lc3NhZ2UuY29tbWFuZC50YXJnZXR9KmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqUmVzdWx0OiAke21lc3NhZ2UucmVzdWx0LnN1Y2Nlc3MgPyAnU3VjY2VzcycgOiAnRmFpbGVkJ30qYCk7XG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UucmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpFcnJvcjogJHttZXNzYWdlLnJlc3VsdC5lcnJvcn0qYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBsaW5lcy5wdXNoKCcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSB1bmlxdWUgbWVzc2FnZSBJRFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVNZXNzYWdlSWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBtc2dfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaW0gY29udmVyc2F0aW9uIHRvIG1heCBsZW5ndGggYW5kIHNhdmVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbjogQ29udmVyc2F0aW9uRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IHRoaXMubWF4TWVzc2FnZXNQZXJGaWxlKSB7XG4gICAgICAgICAgICAvLyBLZWVwIHRoZSBtb3N0IHJlY2VudCBtZXNzYWdlc1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLnNsaWNlKC10aGlzLm1heE1lc3NhZ2VzUGVyRmlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYWxsIGNvbnZlcnNhdGlvbiBmaWxlIHBhdGhzXG4gICAgICovXG4gICAgZ2V0QWxsQ29udmVyc2F0aW9uRmlsZXMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmNvbnZlcnNhdGlvbnMua2V5cygpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBmaWxlIGhhcyBhY3RpdmUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgaGFzQ29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZS5wYXRoKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbiA/IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwIDogZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGNvbnZlcnNhdGlvbiBmaWxlIHBhdGggKGZvciBmaWxlIHJlbmFtZXMpXG4gICAgICovXG4gICAgYXN5bmMgdXBkYXRlRmlsZVBhdGgob2xkUGF0aDogc3RyaW5nLCBuZXdQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChvbGRQYXRoKTtcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbikge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLmZpbGVQYXRoID0gbmV3UGF0aDtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5kZWxldGUob2xkUGF0aCk7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KG5ld1BhdGgsIGNvbnZlcnNhdGlvbik7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBwZXJpb2RpYyBjbGVhbnVwIG9mIG9sZCBjb252ZXJzYXRpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGFydFBlcmlvZGljQ2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2xlYW4gdXAgZXZlcnkgMjQgaG91cnNcbiAgICAgICAgdGhpcy5jbGVhbnVwSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwT2xkQ29udmVyc2F0aW9ucyg3ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDcgZGF5c1xuICAgICAgICB9LCAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBjb252ZXJzYXRpb25zIG9sZGVyIHRoYW4gdGhlIHNwZWNpZmllZCBhZ2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGNsZWFudXBPbGRDb252ZXJzYXRpb25zKG1heEFnZTogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGxldCBjbGVhbmVkID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChjb25zdCBbZmlsZVBhdGgsIGNvbnZlcnNhdGlvbl0gb2YgdGhpcy5jb252ZXJzYXRpb25zLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY29udmVyc2F0aW9uIGlzIG9sZCBiYXNlZCBvbiBsYXN0IG1lc3NhZ2VcbiAgICAgICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RNZXNzYWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzW2NvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBjb25zdCBhZ2UgPSBub3cgLSBsYXN0TWVzc2FnZS50aW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGFnZSA+IG1heEFnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgY2xlYW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNsZWFuZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFudXAgbWV0aG9kIHRvIGNhbGwgd2hlbiBwbHVnaW4gaXMgZGlzYWJsZWRcbiAgICAgKi9cbiAgICBjbGVhbnVwKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5jbGVhbnVwSW50ZXJ2YWwgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jbGVhbnVwSW50ZXJ2YWwpO1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwSW50ZXJ2YWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIENvbnRleHQgYnVpbGRlciBmb3IgTm92YVxuICogR2VuZXJhdGVzIGFwcHJvcHJpYXRlIHByb21wdHMgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmdcbiAqL1xuXG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRG9jdW1lbnRDb250ZXh0LCBQcm9tcHRDb25maWcgfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBHZW5lcmF0ZWQgcHJvbXB0IGZvciBBSSBjb21wbGV0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAvKiogU3lzdGVtIHByb21wdCBmb3IgQUkgY29udGV4dCAqL1xuICAgIHN5c3RlbVByb21wdDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBVc2VyIHByb21wdCB3aXRoIHNwZWNpZmljIGluc3RydWN0aW9ucyAqL1xuICAgIHVzZXJQcm9tcHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogQWRkaXRpb25hbCBjb250ZXh0IGZvciB0aGUgQUkgKi9cbiAgICBjb250ZXh0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIENvbmZpZ3VyYXRpb24gZm9yIEFJIGdlbmVyYXRpb24gKi9cbiAgICBjb25maWc6IHtcbiAgICAgICAgdGVtcGVyYXR1cmU6IG51bWJlcjtcbiAgICAgICAgbWF4VG9rZW5zOiBudW1iZXI7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBDb250ZXh0IGJ1aWxkZXIgZm9yIGdlbmVyYXRpbmcgQUkgcHJvbXB0c1xuICovXG5leHBvcnQgY2xhc3MgQ29udGV4dEJ1aWxkZXIge1xuICAgIHByaXZhdGUgZGVmYXVsdENvbmZpZzogUHJvbXB0Q29uZmlnID0ge1xuICAgICAgICBtYXhDb250ZXh0TGluZXM6IDIwLFxuICAgICAgICBpbmNsdWRlU3RydWN0dXJlOiB0cnVlLFxuICAgICAgICBpbmNsdWRlSGlzdG9yeTogZmFsc2UsXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgIG1heFRva2VuczogMTAwMFxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgY29tbWFuZFxuICAgICAqL1xuICAgIGJ1aWxkUHJvbXB0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9LFxuICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0Pzogc3RyaW5nXG4gICAgKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3QgY29uZmlnID0geyAuLi50aGlzLmRlZmF1bHRDb25maWcsIC4uLm9wdGlvbnMgfTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IHRoaXMuYnVpbGRTeXN0ZW1Qcm9tcHQoY29tbWFuZC5hY3Rpb24sIGNvbmZpZyk7XG4gICAgICAgIGNvbnN0IGNvbnRleHRJbmZvID0gdGhpcy5idWlsZENvbnRleHRJbmZvKGRvY3VtZW50Q29udGV4dCwgY29tbWFuZCwgY29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgY29uc3QgdXNlclByb21wdCA9IHRoaXMuYnVpbGRVc2VyUHJvbXB0KGNvbW1hbmQsIGNvbnRleHRJbmZvKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dDogY29udGV4dEluZm8sXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IGNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHN5c3RlbSBwcm9tcHQgYmFzZWQgb24gYWN0aW9uIHR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkU3lzdGVtUHJvbXB0KGFjdGlvbjogRWRpdENvbW1hbmRbJ2FjdGlvbiddLCBjb25maWc6IFByb21wdENvbmZpZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGJhc2VQcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyBlZGl0IGRvY3VtZW50cyBhdCB0aGVpciBjdXJzb3IgcG9zaXRpb24uIFlvdSB3b3JrIHdpdGggTWFya2Rvd24gZG9jdW1lbnRzIGluIE9ic2lkaWFuLlxuXG5JTVBPUlRBTlQgR1VJREVMSU5FUzpcbi0gUHJvdmlkZSBPTkxZIHRoZSBjb250ZW50IHRvIGJlIGluc2VydGVkL21vZGlmaWVkLCBubyBleHBsYW5hdGlvbnMgb3IgbWV0YS10ZXh0XG4tIE1haW50YWluIHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIHN0eWxlIGFuZCB0b25lIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIFByZXNlcnZlIGZvcm1hdHRpbmcsIHN0cnVjdHVyZSwgYW5kIG1hcmtkb3duIHN5bnRheFxuLSBXb3JrIGF0IHRoZSB1c2VyJ3MgY3Vyc29yIHBvc2l0aW9uIC0gZXZlcnkgZWRpdCBoYXBwZW5zIHdoZXJlIHRoZXkgYXJlIGZvY3VzZWRcbi0gRG8gbm90IGFkZCBoZWFkZXJzIHVubGVzcyBzcGVjaWZpY2FsbHkgcmVxdWVzdGVkXG4tIEZvY3VzIG9uIHRoZSB1c2VyJ3MgaW1tZWRpYXRlIGVkaXRpbmcgY29udGV4dGA7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uU3BlY2lmaWNQcm9tcHRzID0ge1xuICAgICAgICAgICAgJ2FkZCc6IGBcblxuQUNUSU9OOiBBREQgQ09OVEVOVFxuLSBHZW5lcmF0ZSBuZXcgY29udGVudCB0byBpbnNlcnQgYXQgdGhlIHNwZWNpZmllZCBsb2NhdGlvblxuLSBNYXRjaCB0aGUgc3R5bGUgYW5kIHRvbmUgb2Ygc3Vycm91bmRpbmcgY29udGVudFxuLSBFbnN1cmUgcHJvcGVyIGZvcm1hdHRpbmcgYW5kIHN0cnVjdHVyZWAsXG5cbiAgICAgICAgICAgICdlZGl0JzogYFxuXG5BQ1RJT046IEVESVQgQ09OVEVOVCAgXG4tIEltcHJvdmUsIG1vZGlmeSwgb3IgZW5oYW5jZSB0aGUgc3BlY2lmaWVkIGNvbnRlbnRcbi0gUHJlc2VydmUgdGhlIG9yaWdpbmFsIGludGVudCB3aGlsZSBmb2xsb3dpbmcgdXNlciBpbnN0cnVjdGlvbnNcbi0gQXBwbHkgc3R5bGUsIHRvbmUsIG9yIHN0cnVjdHVyYWwgY2hhbmdlcyBhcyByZXF1ZXN0ZWRgLFxuXG4gICAgICAgICAgICAnZGVsZXRlJzogYFxuXG5BQ1RJT046IERFTEVURSBDT05URU5UXG4tIENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlXG4tIEJlIHByZWNpc2UgYWJvdXQgZGVsZXRpb24gYm91bmRhcmllc1xuLSBSZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyYCxcblxuICAgICAgICAgICAgJ2dyYW1tYXInOiBgXG5cbkFDVElPTjogR1JBTU1BUiAmIFNQRUxMSU5HXG4tIEZpeCBncmFtbWFyLCBzcGVsbGluZywgYW5kIHB1bmN0dWF0aW9uIGVycm9yc1xuLSBJbXByb3ZlIGNsYXJpdHkgd2hpbGUgcHJlc2VydmluZyBtZWFuaW5nXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCB0b25lIGFuZCBzdHlsZWAsXG5cbiAgICAgICAgICAgICdyZXdyaXRlJzogYFxuXG5BQ1RJT046IFJFV1JJVEUgQ09OVEVOVFxuLSBHZW5lcmF0ZSBhbHRlcm5hdGl2ZSBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2Vcbi0gQXBwbHkgcmVxdWVzdGVkIHN0eWxlLCB0b25lLCBvciBzdHJ1Y3R1cmFsIGNoYW5nZXNcbi0gQ3JlYXRlIGZyZXNoIGNvbnRlbnQgd2hpbGUgbWFpbnRhaW5pbmcgY29yZSBtZWFuaW5nYCxcblxuICAgICAgICAgICAgJ21ldGFkYXRhJzogYFxuXG5BQ1RJT046IFVQREFURSBNRVRBREFUQVxuLSBNb2RpZnkgZnJvbnRtYXR0ZXIgcHJvcGVydGllcywgdGFncywgb3IgZG9jdW1lbnQgbWV0YWRhdGFcbi0gRm9sbG93IFlBTUwgZm9ybWF0dGluZyBjb252ZW50aW9uc1xuLSBVcGRhdGUgb25seSB0aGUgc3BlY2lmaWVkIG1ldGFkYXRhIGZpZWxkc2BcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gYmFzZVByb21wdCArIChhY3Rpb25TcGVjaWZpY1Byb21wdHNbYWN0aW9uXSB8fCAnJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29udGV4dCBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb21wdFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRDb250ZXh0SW5mbyhcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBjb25maWc6IFByb21wdENvbmZpZyxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gYERPQ1VNRU5UOiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBzdHJ1Y3R1cmUgaWYgZW5hYmxlZFxuICAgICAgICBpZiAoY29uZmlnLmluY2x1ZGVTdHJ1Y3R1cmUgJiYgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYERPQ1VNRU5UIFNUUlVDVFVSRTpcXG5gO1xuICAgICAgICAgICAgY29uc3Qgc3RydWN0dXJlID0gdGhpcy5idWlsZERvY3VtZW50U3RydWN0dXJlKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncyk7XG4gICAgICAgICAgICBjb250ZXh0ICs9IHN0cnVjdHVyZSArICdcXG4nO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGN1cnNvciBjb250ZXh0IGJhc2VkIG9uIHRhcmdldFxuICAgICAgICBjb250ZXh0ICs9IHRoaXMuYnVpbGRUYXJnZXRDb250ZXh0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG5cbiAgICAgICAgLy8gQWRkIGNvbnZlcnNhdGlvbiBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29udmVyc2F0aW9uQ29udGV4dCAmJiBjb25maWcuaW5jbHVkZUhpc3RvcnkpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkNPTlZFUlNBVElPTiBDT05URVhUOlxcbiR7Y29udmVyc2F0aW9uQ29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGZ1bGwgZG9jdW1lbnQgY29udGVudFxuICAgICAgICBjb250ZXh0ICs9IGBcXG5GVUxMIERPQ1VNRU5UOlxcbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9XFxuYDtcblxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCB0YXJnZXQtc3BlY2lmaWMgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRUYXJnZXRDb250ZXh0KGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5TRUxFQ1RFRCBURVhUOlxcbiR7ZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dH1cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbk5vIHRleHQgY3VycmVudGx5IHNlbGVjdGVkLlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBgXFxuQ1VSU09SIENPTlRFWFQ6XFxuYDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhZnRlciA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCArIGBCZWZvcmUgY3Vyc29yOlxcbiR7YmVmb3JlfVxcblxcbkFmdGVyIGN1cnNvcjpcXG4ke2FmdGVyfVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuQ3Vyc29yIHBvc2l0aW9uIGNvbnRleHQgbm90IGF2YWlsYWJsZS5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5UYXJnZXRpbmcgZW50aXJlIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5UYXJnZXRpbmcgZW5kIG9mIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5Xb3JraW5nIGF0IGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBjb250ZXh0SW5mbztcbiAgICAgICAgXG4gICAgICAgIHByb21wdCArPSBgXFxuVVNFUiBSRVFVRVNUOiAke2NvbW1hbmQuaW5zdHJ1Y3Rpb259XFxuYDtcblxuICAgICAgICAvLyBBZGQgY29udGV4dCBmcm9tIGNvbW1hbmQgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLmNvbnRleHQpIHtcbiAgICAgICAgICAgIHByb21wdCArPSBgQURESVRJT05BTCBSRVFVSVJFTUVOVFM6ICR7Y29tbWFuZC5jb250ZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGFyZ2V0LXNwZWNpZmljIGZvY3VzXG4gICAgICAgIHByb21wdCArPSB0aGlzLmdldEZvY3VzSW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuXG4gICAgICAgIC8vIEFkZCBvdXRwdXQgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIGFjdGlvblxuICAgICAgICBwcm9tcHQgKz0gdGhpcy5nZXRPdXRwdXRJbnN0cnVjdGlvbnMoY29tbWFuZCk7XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZm9jdXMgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Rm9jdXNJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBhY3Rpb25HdWlkYW5jZSA9IHtcbiAgICAgICAgICAgICdhZGQnOiAnQWRkIG5ldyBjb250ZW50JyxcbiAgICAgICAgICAgICdlZGl0JzogJ01vZGlmeSBleGlzdGluZyBjb250ZW50JywgXG4gICAgICAgICAgICAnZGVsZXRlJzogJ1JlbW92ZSBzcGVjaWZpZWQgY29udGVudCcsXG4gICAgICAgICAgICAncmV3cml0ZSc6ICdHZW5lcmF0ZSBhbHRlcm5hdGl2ZSBjb250ZW50JyxcbiAgICAgICAgICAgICdncmFtbWFyJzogJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZycsXG4gICAgICAgICAgICAnbWV0YWRhdGEnOiAnVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGluIHRoZSBzZWxlY3RlZCB0ZXh0LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGF0IHRoZSBjdXJyZW50IGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGZvciB0aGUgZW50aXJlIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogQWRkIGNvbnRlbnQgYXQgdGhlIHZlcnkgZW5kIG9mIHRoZSBkb2N1bWVudCwgYWZ0ZXIgYWxsIGV4aXN0aW5nIGNvbnRlbnQuIEVuc3VyZSBpdCBmbG93cyBuYXR1cmFsbHkuXFxuYDtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXX0gYXQgdGhlIGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG91dHB1dCBpbnN0cnVjdGlvbnMgYmFzZWQgb24gYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRPdXRwdXRJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIG5ldyBjb250ZW50IHRvIGJlIGFkZGVkLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGltcHJvdmVkIHZlcnNpb24gb2YgdGhlIGNvbnRlbnQuJztcblxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogQ29uZmlybSB3aGF0IHNob3VsZCBiZSBkZWxldGVkIGJ5IHByb3ZpZGluZyB0aGUgZXhhY3QgdGV4dCB0byByZW1vdmUsIG9yIHJlc3BvbmQgXCJDT05GSVJNRURcIiBpZiB0aGUgZGVsZXRpb24gaXMgY2xlYXIuJztcblxuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvcnJlY3RlZCB2ZXJzaW9uIHdpdGggcHJvcGVyIGdyYW1tYXIgYW5kIHNwZWxsaW5nLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSBjb21wbGV0ZWx5IHJld3JpdHRlbiBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2UuJztcblxuICAgICAgICAgICAgY2FzZSAnbWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSB1cGRhdGVkIG1ldGFkYXRhIGluIHByb3BlciBZQU1MIGZvcm1hdC4nO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIHJlcXVlc3RlZCBjb250ZW50IGNoYW5nZXMuJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGRvY3VtZW50IHN0cnVjdHVyZSBmcm9tIGhlYWRpbmdzXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZERvY3VtZW50U3RydWN0dXJlKGhlYWRpbmdzOiBEb2N1bWVudENvbnRleHRbJ2hlYWRpbmdzJ10pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaGVhZGluZ3MubWFwKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgcmV0dXJuIGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fWA7XG4gICAgICAgIH0pLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdlbmVyYXRlZCBwcm9tcHRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQudXNlclByb21wdC5sZW5ndGggPiAxMDAwMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1VzZXIgcHJvbXB0IGlzIHRvbyBsb25nICg+MTAwMDAgY2hhcmFjdGVycyknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIGlzc3Vlc1xuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb21tYW5kIHBhcnNlciBmb3IgTm92YVxuICogQ29udmVydHMgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIHN0cnVjdHVyZWQgRWRpdENvbW1hbmQgb2JqZWN0c1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0QWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogUGF0dGVybnMgZm9yIGRldGVjdGluZyBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5pbnRlcmZhY2UgQ29tbWFuZFBhdHRlcm4ge1xuICAgIGFjdGlvbjogRWRpdEFjdGlvbjtcbiAgICBwYXR0ZXJuczogUmVnRXhwW107XG4gICAgdGFyZ2V0czogc3RyaW5nW107XG59XG5cbi8qKlxuICogQ29tbWFuZCBwYXJzaW5nIHJ1bGVzXG4gKi9cbmNvbnN0IENPTU1BTkRfUEFUVEVSTlM6IENvbW1hbmRQYXR0ZXJuW10gPSBbXG4gICAge1xuICAgICAgICBhY3Rpb246ICdncmFtbWFyJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZ3JhbW1hcnxzcGVsbHxzcGVsbGluZ3xwcm9vZnJlYWR8cG9saXNoKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmNoZWNrXFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihncmFtbWF0aWNhbHxjb3JyZWN0fHByb3BlcilcXGIvaSxcbiAgICAgICAgICAgIC9cXGJmaXhcXHMrLipcXGIoZ3JhbW1hcnxlcnJvcnN8bWlzdGFrZXN8dHlwb3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY29ycmVjdFxcYi4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ2RvY3VtZW50J11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAncmV3cml0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHJld3JpdGV8cmV3b3JkfHJlcGhyYXNlfHJlc3RydWN0dXJlfHJlb3JnYW5pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxid3JpdGVcXHMrLipcXGIobmV3fGRpZmZlcmVudHxhbHRlcm5hdGl2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnLCAnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZGVsZXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGV8Y3V0fGVyYXNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdldFxccytyaWRcXHMrb2ZcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ0YWtlXFxzK291dFxcYi9pLFxuICAgICAgICAgICAgL1xcYmRyb3BcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxwYXJ0KVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnYWRkJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnR8aW5jbHVkZXxhcHBlbmR8cHJlcGVuZClcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxoZWFkaW5nfGNvbnRlbnR8dGV4dHxwYXJ0KVxcYi9pLFxuICAgICAgICAgICAgL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxhcHBlbmR8cHJlcGVuZClcXGIoPyFcXHMrLipcXGIoYmV0dGVyfGNsZWFyZXJ8bW9yZXxsZXNzKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb258cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxcYi4qXFxiKHNlY3Rpb258Y29udGVudHx0ZXh0KVxcYi9pLFxuICAgICAgICAgICAgLy8gU3BlY2lmaWMgcGF0dGVybnMgZm9yIGFwcGVuZC9wcmVwZW5kIHdpdGggbG9jYXRpb25cbiAgICAgICAgICAgIC9cXGIoYXBwZW5kfGFkZClcXGIuKlxcYihhZnRlcnxmb2xsb3dpbmcpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHByZXBlbmR8YWRkKVxcYi4qXFxiKGJlZm9yZXxwcmVjZWRpbmcpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydlbmQnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdlZGl0JyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZWRpdHxtb2RpZnl8Y2hhbmdlfHVwZGF0ZXxyZXZpc2V8aW1wcm92ZXxlbmhhbmNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoYmV0dGVyfGNsZWFyZXJ8bW9yZXxsZXNzfGZvcm1hbHxwcm9mZXNzaW9uYWx8ZGV0YWlsZWR8Y29tcHJlaGVuc2l2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoZml4fGNvcnJlY3R8YWRqdXN0KVxcYig/IS4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGIoZXhwYW5kfHNob3J0ZW58Y29uZGVuc2UpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdtZXRhZGF0YScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHVwZGF0ZXxzZXR8Y2hhbmdlfG1vZGlmeXxhZGQpXFxzKy4qXFxiKHByb3BlcnR5fHByb3BlcnRpZXN8bWV0YWRhdGF8ZnJvbnRtYXR0ZXJ8dGFnfHRhZ3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHNldHx1cGRhdGV8Y2hhbmdlfGFkZClcXHMrLipcXGIodGl0bGV8YXV0aG9yfGRhdGV8c3RhdHVzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYnVwZGF0ZVxccysuKlxcYmZyb250bWF0dGVyXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGFkZHxyZW1vdmV8dXBkYXRlKVxccysuKlxcYnRhZ1tzXT9cXGIvaSxcbiAgICAgICAgICAgIC9cXGJzZXRcXHMrLipcXGJwcm9wZXJ0eVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnXVxuICAgIH1cbl07XG5cblxuLyoqXG4gKiBUYXJnZXQgdHlwZSBkZXRlY3Rpb24gcGF0dGVybnMgLSBzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gKi9cbmNvbnN0IFRBUkdFVF9QQVRURVJOUyA9IFtcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWxlY3RlZHxoaWdobGlnaHRlZHxjaG9zZW4pXFxzKyg/OnRleHR8Y29udGVudCkvaSwgdGFyZ2V0OiAnc2VsZWN0aW9uJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVudGlyZXx3aG9sZXxmdWxsKVxccysoPzpkb2N1bWVudHxmaWxlfG5vdGUpL2ksIHRhcmdldDogJ2RvY3VtZW50JyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVuZHxib3R0b218Y29uY2x1c2lvbikvaSwgdGFyZ2V0OiAnZW5kJyB9XG5dO1xuXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBhcnNlciB7XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIGFuIEVkaXRDb21tYW5kXG4gICAgICovXG4gICAgcGFyc2VDb21tYW5kKGlucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogRWRpdENvbW1hbmQge1xuICAgICAgICBjb25zdCBub3JtYWxpemVkSW5wdXQgPSBpbnB1dC50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIERldGVjdCB0aGUgYWN0aW9uIHR5cGVcbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5kZXRlY3RBY3Rpb24obm9ybWFsaXplZElucHV0KTtcbiAgICAgICAgXG4gICAgICAgIC8vIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgKHNpbXBsaWZpZWQgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmcpXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGV0ZWN0VGFyZ2V0KG5vcm1hbGl6ZWRJbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5leHRyYWN0Q29udGV4dChpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb246IGlucHV0LCAvLyBLZWVwIG9yaWdpbmFsIGlucHV0IGZvciBkaXNwbGF5XG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgYWN0aW9uIHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdEFjdGlvbihpbnB1dDogc3RyaW5nKTogRWRpdEFjdGlvbiB7XG4gICAgICAgIC8vIENoZWNrIHBhdHRlcm5zIGluIG9yZGVyIG9mIHNwZWNpZmljaXR5XG4gICAgICAgIGZvciAoY29uc3QgY29tbWFuZFBhdHRlcm4gb2YgQ09NTUFORF9QQVRURVJOUykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGNvbW1hbmRQYXR0ZXJuLnBhdHRlcm5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmRQYXR0ZXJuLmFjdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgbG9naWMgd2l0aCBtb3JlIHNwZWNpZmljIGNoZWNrc1xuICAgICAgICBpZiAoL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxpbmNsdWRlfGdlbmVyYXRlLipzZWN0aW9uKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FkZCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZml4fGNvcnJlY3R8Z3JhbW1hcnxzcGVsbHxwcm9vZnJlYWR8cG9saXNoKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2dyYW1tYXInO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2RlbGV0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIocmV3cml0ZXxyZXBocmFzZXxyZXN0cnVjdHVyZXxnZW5lcmF0ZS4qbmV3KVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3Jld3JpdGUnO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKHVwZGF0ZXxzZXR8Y2hhbmdlfG1vZGlmeXxhZGQpLipcXGIocHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcnx0YWd8dGFnc3x0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXMpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnbWV0YWRhdGEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZhdWx0IHRvIGVkaXQgZm9yIGFtYmlndW91cyBjYXNlc1xuICAgICAgICByZXR1cm4gJ2VkaXQnO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBEZXRlY3QgdGhlIHRhcmdldCB0eXBlIGZyb20gdGhlIGlucHV0IChzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nKVxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0VGFyZ2V0KFxuICAgICAgICBpbnB1dDogc3RyaW5nLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuLCBcbiAgICAgICAgYWN0aW9uOiBFZGl0QWN0aW9uXG4gICAgKTogRWRpdENvbW1hbmRbJ3RhcmdldCddIHtcbiAgICAgICAgLy8gQ2hlY2sgZXhwbGljaXQgdGFyZ2V0IHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgdGFyZ2V0UGF0dGVybiBvZiBUQVJHRVRfUEFUVEVSTlMpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXRQYXR0ZXJuLnBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0UGF0dGVybi50YXJnZXQgYXMgRWRpdENvbW1hbmRbJ3RhcmdldCddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDb250ZXh0LWJhc2VkIHRhcmdldCBkZXRlY3Rpb25cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbiAmJiAoYWN0aW9uID09PSAnZWRpdCcgfHwgYWN0aW9uID09PSAnZ3JhbW1hcicgfHwgYWN0aW9uID09PSAnZGVsZXRlJykpIHtcbiAgICAgICAgICAgIHJldHVybiAnc2VsZWN0aW9uJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWN0aW9uLXNwZWNpZmljIGRlZmF1bHRzXG4gICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdjdXJzb3InO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAnY3Vyc29yJztcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdkb2N1bWVudCc7XG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2VuZCc7XG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdkb2N1bWVudCc7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGFkZGl0aW9uYWwgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdENvbnRleHQoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3Qgc3R5bGUvdG9uZSBpbmRpY2F0b3JzXG4gICAgICAgIGNvbnN0IHN0eWxlSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICdmb3JtYWwnLCAnaW5mb3JtYWwnLCAnY2FzdWFsJywgJ3Byb2Zlc3Npb25hbCcsICdhY2FkZW1pYycsICd0ZWNobmljYWwnLFxuICAgICAgICAgICAgJ3NpbXBsZScsICdjb21wbGV4JywgJ2RldGFpbGVkJywgJ2JyaWVmJywgJ2NvbmNpc2UnLCAndmVyYm9zZScsXG4gICAgICAgICAgICAnZnJpZW5kbHknLCAnc2VyaW91cycsICdodW1vcm91cycsICdjcmVhdGl2ZScsICdhbmFseXRpY2FsJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZm91bmRTdHlsZXMgPSBzdHlsZUluZGljYXRvcnMuZmlsdGVyKHN0eWxlID0+IFxuICAgICAgICAgICAgaW5wdXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHlsZSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIGlmIChmb3VuZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBTdHlsZTogJHtmb3VuZFN0eWxlcy5qb2luKCcsICcpfS4gYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsZW5ndGggaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ3Nob3J0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2JyaWVmJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbmNpc2UnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnS2VlcCBpdCBicmllZi4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2xvbmcnKSB8fCBpbnB1dC5pbmNsdWRlcygnZGV0YWlsZWQnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29tcHJlaGVuc2l2ZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdQcm92aWRlIGRldGFpbGVkIGNvbnRlbnQuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3Qgc3BlY2lmaWMgcmVxdWlyZW1lbnRzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnYnVsbGV0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2xpc3QnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIGJ1bGxldCBwb2ludHMgb3IgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdleGFtcGxlJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGVzJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0luY2x1ZGUgZXhhbXBsZXMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdudW1iZXInKSB8fCBpbnB1dC5pbmNsdWRlcygnbnVtYmVyZWQnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIG51bWJlcmVkIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbnRleHQudHJpbSgpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBpZiBhIGNvbW1hbmQgY2FuIGJlIGV4ZWN1dGVkXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbi10YXJnZXQgY29tYmluYXRpb25zXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiA9PT0gJ2FkZCcgJiYgY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBhZGQgY29udGVudCB0byBhIHNlbGVjdGlvbi4gVXNlIFwiZWRpdFwiIHRvIG1vZGlmeSBzZWxlY3RlZCB0ZXh0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3RlZCBjb21tYW5kcyBiYXNlZCBvbiBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaGFzU2VsZWN0aW9uOiBib29sZWFuKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGNvbmNpc2UnLFxuICAgICAgICAgICAgICAgICdGaXggZ3JhbW1hciBpbiB0aGlzIHRleHQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFeHBhbmQgb24gdGhpcyBwb2ludCdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdBZGQgY29udGVudCBhdCBjdXJzb3InLFxuICAgICAgICAgICAgICAgICdGaXggZ3JhbW1hciBpbiB0aGlzIGRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICAnQWRkIGNvbmNsdXNpb24gYXQgZW5kJyxcbiAgICAgICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbXVsdGlwbGUgY29tbWFuZHMgZnJvbSBhIHNpbmdsZSBpbnB1dFxuICAgICAqL1xuICAgIHBhcnNlTXVsdGlwbGVDb21tYW5kcyhpbnB1dDogc3RyaW5nKTogRWRpdENvbW1hbmRbXSB7XG4gICAgICAgIC8vIFNwbGl0IG9uIGNvbW1vbiBjb21tYW5kIHNlcGFyYXRvcnNcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9ycyA9IC9cXGIoPzp0aGVufGFsc298YW5kIHRoZW58YWZ0ZXIgdGhhdHxuZXh0fGFkZGl0aW9uYWxseSlcXGIvaTtcbiAgICAgICAgY29uc3QgcGFydHMgPSBpbnB1dC5zcGxpdChzZXBhcmF0b3JzKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5wYXJzZUNvbW1hbmQoaW5wdXQpXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhcnRzXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gcGFydC50cmltKCkpXG4gICAgICAgICAgICAuZmlsdGVyKHBhcnQgPT4gcGFydC5sZW5ndGggPiAwKVxuICAgICAgICAgICAgLm1hcChwYXJ0ID0+IHRoaXMucGFyc2VDb21tYW5kKHBhcnQpKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogR2V0IGNvbW1hbmQgZGVzY3JpcHRpb24gZm9yIGRpc3BsYXlcbiAgICAgKi9cbiAgICBnZXRDb21tYW5kRGVzY3JpcHRpb24oY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB7IGFjdGlvbiwgdGFyZ2V0IH0gPSBjb21tYW5kO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdBZGQgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRWRpdCBleGlzdGluZyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0dlbmVyYXRlIG5ldyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ21ldGFkYXRhJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdVcGRhdGUgZG9jdW1lbnQgbWV0YWRhdGEnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKHRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGF0IGVuZCBvZiBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9XG59IiwgIi8qKlxuICogUHJvbXB0IGJ1aWxkZXIgc2VydmljZSBmb3IgTm92YVxuICogSW50ZWdyYXRlcyBDb250ZXh0QnVpbGRlciB3aXRoIGRvY3VtZW50IGVuZ2luZSBhbmQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyLCBHZW5lcmF0ZWRQcm9tcHQgfSBmcm9tICcuL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFByb21wdCBidWlsZGluZyBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9tcHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcjtcbiAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZTtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb21tYW5kUGFyc2VyOiBDb21tYW5kUGFyc2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICAgICAgdGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgdXNlciBtZXNzYWdlIC0gZGV0ZXJtaW5lcyBpZiBpdCdzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFByb21wdEZvck1lc3NhZ2UoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgbGlrZWx5IGEgY29tbWFuZCBiYXNlZCBvbiBhY3Rpb24gd29yZHNcbiAgICAgICAgY29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5pc0xpa2VseUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNMaWtlbHlDb21tYW5kICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChwYXJzZWRDb21tYW5kLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0J3MgYSBjb252ZXJzYXRpb24gLSBidWlsZCBjb252ZXJzYXRpb24gcHJvbXB0XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbnZlcnNhdGlvblByb21wdChtZXNzYWdlLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgbWVzc2FnZSBpcyBsaWtlbHkgYSBjb21tYW5kIHZzIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gMS4gRXhwbGljaXQgY29tbWFuZCBzeW50YXggKGNvbG9uIGNvbW1hbmRzKVxuICAgICAgICBpZiAobG93ZXJNZXNzYWdlLnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDIuIENoZWNrIGZvciBhY3Rpb24gdmVyYnMgdGhhdCBpbmRpY2F0ZSBkb2N1bWVudCBtb2RpZmljYXRpb24gY29tbWFuZHNcbiAgICAgICAgY29uc3QgYWN0aW9uVmVyYnMgPSBbXG4gICAgICAgICAgICAnYWRkJywgJ2luc2VydCcsICdhcHBlbmQnLCAncHJlcGVuZCcsICdpbmNsdWRlJywgJ2NyZWF0ZScsICd3cml0ZScsICdnZW5lcmF0ZScsXG4gICAgICAgICAgICAnZWRpdCcsICdtb2RpZnknLCAnY2hhbmdlJywgJ3VwZGF0ZScsICdyZXZpc2UnLCAnaW1wcm92ZScsICdlbmhhbmNlJywgJ3JlcGxhY2UnLFxuICAgICAgICAgICAgJ2RlbGV0ZScsICdyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2N1dCcsICdlcmFzZScsICdkcm9wJyxcbiAgICAgICAgICAgICdmaXgnLCAnY29ycmVjdCcsICdwcm9vZnJlYWQnLCAncG9saXNoJywgJ2NoZWNrJyxcbiAgICAgICAgICAgICdyZXdyaXRlJywgJ3Jld29yZCcsICdyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZW9yZ2FuaXplJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbWVzc2FnZSBzdGFydHMgd2l0aCBhbiBhY3Rpb24gdmVyYiAoaW1wZXJhdGl2ZSBjb21tYW5kIHN0cnVjdHVyZSlcbiAgICAgICAgY29uc3Qgc3RhcnRzV2l0aEFjdGlvbiA9IGFjdGlvblZlcmJzLnNvbWUodmVyYiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2ZXJiUGF0dGVybiA9IG5ldyBSZWdFeHAoYF4ke3ZlcmJ9XFxcXGJgLCAnaScpO1xuICAgICAgICAgICAgcmV0dXJuIHZlcmJQYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoc3RhcnRzV2l0aEFjdGlvbikge1xuICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBmaWx0ZXJpbmc6IGV4Y2x1ZGUgcXVlc3Rpb25zIGFuZCBkaXNjdXNzaW9uc1xuICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25JbmRpY2F0b3JzID0gW1xuICAgICAgICAgICAgICAgIC9eKGhvd3x3aGF0fHdoeXx3aGVufHdoZXJlfHdoaWNofHdob3xjYW58Y291bGR8c2hvdWxkfHdvdWxkfHdpbGx8aXN8YXJlfGFtfGRvfGRvZXN8ZGlkKS9pLFxuICAgICAgICAgICAgICAgIC9cXD8vLCAgLy8gQ29udGFpbnMgcXVlc3Rpb24gbWFya1xuICAgICAgICAgICAgICAgIC9cXGIoaGVscHxhZHZpY2V8c3VnZ2VzdHxyZWNvbW1lbmR8dGhpbmt8b3BpbmlvbilcXGIvaVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgaXQncyBhIHF1ZXN0aW9uIG9yIGRpc2N1c3Npb24sIHJvdXRlIHRvIGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgY29uc3QgaXNRdWVzdGlvbiA9IHF1ZXN0aW9uSW5kaWNhdG9ycy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KGxvd2VyTWVzc2FnZSkpO1xuICAgICAgICAgICAgaWYgKGlzUXVlc3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyAzLiBDaGVjayBmb3IgZXhwbGljaXQgY29tbWFuZCBwYXR0ZXJucyAoZm9yIGVkZ2UgY2FzZXMpXG4gICAgICAgIGNvbnN0IGV4cGxpY2l0Q29tbWFuZFBhdHRlcm5zID0gW1xuICAgICAgICAgICAgLy8gR3JhbW1hci9zcGVsbGluZyBjb21tYW5kcyB0aGF0IGRvbid0IHN0YXJ0IHdpdGggYWN0aW9uIHZlcmJzXG4gICAgICAgICAgICAvXFxiKGdyYW1tYXJ8c3BlbGx8c3BlbGxpbmd8cHJvb2ZyZWFkfHBvbGlzaClcXGIuKlxcYihjaGVja3xmaXh8Y29ycmVjdClcXGIvaSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTWV0YWRhdGEgY29tbWFuZHMgd2l0aCBkaWZmZXJlbnQgc3RydWN0dXJlc1xuICAgICAgICAgICAgL1xcYnNldFxccysodGhlXFxzKyk/KHRpdGxlfHRhZ3N8bWV0YWRhdGF8cHJvcGVydGllcykvaSxcbiAgICAgICAgICAgIC9cXGJ1cGRhdGVcXHMrKHRoZVxccyspPyh0aXRsZXx0YWdzfG1ldGFkYXRhfHByb3BlcnRpZXMpL2lcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIG1lc3NhZ2UgbWF0Y2hlcyBleHBsaWNpdCBjb21tYW5kIHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBleHBsaWNpdENvbW1hbmRQYXR0ZXJucykge1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChsb3dlck1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDQuIEV2ZXJ5dGhpbmcgZWxzZSBnb2VzIHRvIGNvbnZlcnNhdGlvbiBtb2RlXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29tbWFuZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBpcyByZXF1aXJlZCBmb3IgY29tbWFuZCBwcm9tcHRzJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBuZWVkZWRcbiAgICAgICAgbGV0IGNvbnZlcnNhdGlvbkNvbnRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKG9wdGlvbnMuaW5jbHVkZUhpc3RvcnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShyZWNlbnRNZXNzYWdlcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCB0aGUgcHJvbXB0XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgb3B0aW9ucywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBjb252ZXJzYXRpb24gKG5vbi1jb21tYW5kIG1lc3NhZ2VzKVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCByZWNlbnRIaXN0b3J5OiBDb252ZXJzYXRpb25NZXNzYWdlW10gPSBbXTtcblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dCBpZiBmaWxlIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IHJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICAgICAgICAgcmVjZW50SGlzdG9yeSA9IGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KG1lc3NhZ2UsIGRvY3VtZW50Q29udGV4dCwgcmVjZW50SGlzdG9yeSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbiwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRvY3VtZW50IGNvbnRleHQgZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxEb2N1bWVudENvbnRleHQ+IHtcbiAgICAgICAgLy8gVXNlIHRoZSBkb2N1bWVudCBlbmdpbmUncyBidWlsdC1pbiBjb250ZXh0IGdhdGhlcmluZ1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGNyZWF0ZSBtaW5pbWFsIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGVudCgpIHx8ICcnO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgaGVhZGluZ3M6IFtdLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXM6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybiB0aGUgY29udGV4dCBhcy1pcywgc2luY2UgaXQncyBhbHJlYWR5IGluIHRoZSBjb3JyZWN0IGZvcm1hdFxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgY29udmVyc2F0aW9uIGhpc3RvcnkgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkobWVzc2FnZXM6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSk6IHN0cmluZyB7XG4gICAgICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybiAnJztcblxuICAgICAgICBsZXQgZm9ybWF0dGVkID0gJ1JFQ0VOVCBDT05WRVJTQVRJT046XFxuJztcbiAgICAgICAgbWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuICAgICAgICAgICAgY29uc3Qgcm9sZSA9IG1zZy5yb2xlID09PSAndXNlcicgPyAnWW91JyA6ICdOb3ZhJztcbiAgICAgICAgICAgIGZvcm1hdHRlZCArPSBgJHtyb2xlfTogJHttc2cuY29udGVudH1cXG5gO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFuZCBvcHRpbWl6ZSBwcm9tcHQgYmVmb3JlIHNlbmRpbmcgdG8gQUlcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUFuZE9wdGltaXplUHJvbXB0KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgLy8gUHJvbXB0IHZhbGlkYXRpb24gaXNzdWVzIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIGZpeCBjb21tb24gaXNzdWVzXG4gICAgICAgICAgICBsZXQgb3B0aW1pemVkUHJvbXB0ID0geyAuLi5wcm9tcHQgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ1bmNhdGUgaWYgdG9vIGxvbmdcbiAgICAgICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKHRva2VuQ291bnQgPiA4MDAwKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVkdWNlIGNvbnRleHQgc2l6ZSBtb3JlIGFnZ3Jlc3NpdmVseVxuICAgICAgICAgICAgICAgIGNvbnN0IG1heENvbnRleHRMZW5ndGggPSBNYXRoLmZsb29yKHByb21wdC5jb250ZXh0Lmxlbmd0aCAqIDAuNik7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbnRleHQgPSBwcm9tcHQuY29udGV4dC5zdWJzdHJpbmcoMCwgbWF4Q29udGV4dExlbmd0aCkgKyAnXFxuW0NvbnRleHQgdHJ1bmNhdGVkLi4uXSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsYW1wIHRlbXBlcmF0dXJlXG4gICAgICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA8IDAgfHwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA+IDEpIHtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCBtYXggdG9rZW5zXG4gICAgICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29uZmlnLm1heFRva2VucyA9IE1hdGgubWF4KDEwLCBNYXRoLm1pbig0MDAwLCBwcm9tcHQuY29uZmlnLm1heFRva2VucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gb3B0aW1pemVkUHJvbXB0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdG9rZW4gY291bnQgZXN0aW1hdGUgZm9yIGEgcHJvbXB0XG4gICAgICovXG4gICAgZ2V0VG9rZW5Db3VudChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgYWN0aW9uIHdpdGggbWluaW1hbCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRRdWlja1Byb21wdChcbiAgICAgICAgYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sXG4gICAgICAgIGluc3RydWN0aW9uOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmQ6IEVkaXRDb21tYW5kID0ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0OiAnZG9jdW1lbnQnLFxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24sXG4gICAgICAgICAgICBjb250ZXh0OiB1bmRlZmluZWRcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb21tYW5kUHJvbXB0KGNvbW1hbmQsIGZpbGUsIHsgXG4gICAgICAgICAgICAgICAgbWF4Q29udGV4dExpbmVzOiAxMCxcbiAgICAgICAgICAgICAgICBpbmNsdWRlU3RydWN0dXJlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbmNsdWRlSGlzdG9yeTogZmFsc2UgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCB3aXRoIGN1c3RvbSBzeXN0ZW0gcHJvbXB0IG92ZXJyaWRlXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDdXN0b21Qcm9tcHQoXG4gICAgICAgIHN5c3RlbVByb21wdDogc3RyaW5nLFxuICAgICAgICB1c2VyTWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgY29udGV4dCA9IGBEb2N1bWVudDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQ6IHVzZXJNZXNzYWdlLFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIEFkZCBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFkZGluZyBuZXcgY29udGVudCB0byBkb2N1bWVudHMgYXQgY3Vyc29yIHBvc2l0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQWRkQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhZGQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kKTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgYWRkaXRpb24gYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUFkZGl0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgcmVzdWx0IGZvciBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gYWRkIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnQ29udGVudCBhZGRlZCBzdWNjZXNzZnVsbHknLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBhZGRpdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlBZGRpdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBkb2N1bWVudCAodHlwaWNhbGx5IGFwcGVuZCB0byBlbmQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlbGVjdGlvbiB3aXRoIG5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm8gc2VsZWN0aW9uLCBhZGQgYXQgY3Vyc29yIGluc3RlYWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgYWRkIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGFkZFxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdhZGQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgYWRkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQWRkIGluc3RydWN0aW9uIGlzIHJlcXVpcmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxufSIsICIvKipcbiAqIEVkaXQgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBtb2RpZnlpbmcgYW5kIGltcHJvdmluZyBleGlzdGluZyBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gTG9nIHJlc3VsdCBmb3IgY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGVkaXQgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdDb250ZW50IGVkaXRlZCBzdWNjZXNzZnVsbHknLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGVkaXQgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciBlZGl0aW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgZW50aXJlIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgZWRpdCB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBlZGl0IGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuXG4gICAgKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGVkaXQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGVkaXRcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZWRpdCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBlZGl0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnRWRpdCBpbnN0cnVjdGlvbiBpcyByZXF1aXJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBEZWxldGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZW1vdmluZyBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBkZWxldGlvbiByZXN1bHQgZm9yIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdDb250ZW50IGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBkZWxldGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBkZWxldGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlEZWxldGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dFxuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgbGluZSBhdCBjdXJzb3JcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5kZWxldGVDb250ZW50KCdsaW5lJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoJycpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0cmFpbGluZyBjb250ZW50IChub3QgdHlwaWNhbGx5IHVzZWQgZm9yIGRlbGV0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIC0gdXNlIGN1cnNvciBvciBzZWxlY3Rpb24gaW5zdGVhZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBkZWxldGUgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBkZWxldGUgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBkZWxldGVcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZGVsZXRlJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIGRlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBHcmFtbWFyIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgZml4aW5nIGdyYW1tYXIgYW5kIHNwZWxsaW5nIGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdyYW1tYXJDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBmaXggZ3JhbW1hcicsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGdyYW1tYXIgZml4IGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlHcmFtbWFyRml4KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgcmVzdWx0IGZvciBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZml4IGdyYW1tYXInLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnR3JhbW1hciBmaXhlZCBzdWNjZXNzZnVsbHknLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgZml4IGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUdyYW1tYXJGaXgoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGVudGlyZSBkb2N1bWVudCB3aXRoIGNvcnJlY3RlZCB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEdyYW1tYXIgY29ycmVjdGlvbiBhdCBjdXJzb3IgZG9lc24ndCBtYWtlIG11Y2ggc2Vuc2UsIFxuICAgICAgICAgICAgICAgIC8vIHN1Z2dlc3Qgc2VsZWN0aW5nIHRleHQgaW5zdGVhZFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBjb3JyZWN0IGdyYW1tYXIsIG9yIHVzZSBcImRvY3VtZW50XCIgdG8gZml4IGVudGlyZSBkb2N1bWVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEdyYW1tYXIgY29ycmVjdGlvbiBhdCBlbmQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnR3JhbW1hciBjb3JyZWN0aW9uIHJlcXVpcmVzIHNlbGVjdGluZyB0ZXh0IG9yIHNwZWNpZnlpbmcgXCJkb2N1bWVudFwiJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBncmFtbWFyIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGdyYW1tYXJcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZ3JhbW1hcicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBncmFtbWFyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBncmFtbWFyLCB3ZSBuZWVkIGVpdGhlciBzZWxlY3Rpb24gb3IgZG9jdW1lbnQgdGFyZ2V0XG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gY29ycmVjdCBncmFtbWFyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCAhPT0gJ3NlbGVjdGlvbicgJiYgY29tbWFuZC50YXJnZXQgIT09ICdkb2N1bWVudCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnR3JhbW1hciBjb3JyZWN0aW9uIHJlcXVpcmVzIHNlbGVjdGluZyB0ZXh0IG9yIHRhcmdldGluZyBlbnRpcmUgZG9jdW1lbnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG59IiwgIi8qKlxuICogUmV3cml0ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGdlbmVyYXRpbmcgYWx0ZXJuYXRpdmUgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIHJld3JpdGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSByZXdyaXRlIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlSZXdyaXRlKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgcmVzdWx0IGZvciBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gcmV3cml0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0NvbnRlbnQgcmV3cml0dGVuIHN1Y2Nlc3NmdWxseScsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcmV3cml0ZSBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlSZXdyaXRlKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgZW50aXJlIGRvY3VtZW50IHdpdGggcmV3cml0dGVuIHZlcnNpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoY29udGVudCk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gQWRkIHJld3JpdHRlbiBjb250ZW50IHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgLy8gUmV3cml0ZSBzZWxlY3RlZCBjb250ZW50XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciByZXdyaXRpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgcmV3cml0dGVuIGNvbnRlbnQgYXQgY3Vyc29yXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIHJld3JpdGUgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcmV3cml0ZSBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyByZXdyaXRlXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ3Jld3JpdGUnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgcmV3cml0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBpbnN0cnVjdGlvbiBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoIWNvbW1hbmQuaW5zdHJ1Y3Rpb24gfHwgY29tbWFuZC5pbnN0cnVjdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1Jld3JpdGUgaW5zdHJ1Y3Rpb24gaXMgcmVxdWlyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG59IiwgIi8qKlxuICogTWV0YWRhdGEgY29tbWFuZCBoYW5kbGVyIGZvciBOb3ZhXG4gKiBIYW5kbGVzIHVwZGF0aW5nIGRvY3VtZW50IHByb3BlcnRpZXMvZnJvbnRtYXR0ZXJcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRSZXN1bHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogSGFuZGxlcyBtZXRhZGF0YS9wcm9wZXJ0eSB1cGRhdGUgY29tbWFuZHNcbiAqL1xuZXhwb3J0IGNsYXNzIE1ldGFkYXRhQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIG1ldGFkYXRhIHVwZGF0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHt2YWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgY29uc3QgYWlSZXNwb25zZSA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKFxuICAgICAgICAgICAgICAgIHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBBSSByZXNwb25zZSB0byBleHRyYWN0IHByb3BlcnR5IHVwZGF0ZXNcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSB0aGlzLnBhcnNlUHJvcGVydHlVcGRhdGVzKGFpUmVzcG9uc2UpO1xuICAgICAgICAgICAgaWYgKCF1cGRhdGVzIHx8IE9iamVjdC5rZXlzKHVwZGF0ZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHByb3BlcnR5IHVwZGF0ZXMgZm91bmQgaW4gQUkgcmVzcG9uc2UnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXBkYXRlIG9yIGNyZWF0ZSBmcm9udG1hdHRlclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyKGRvY3VtZW50Q29udGV4dC5jb250ZW50LCB1cGRhdGVzKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gV3JpdGUgdGhlIHVwZGF0ZWQgY29udGVudCBiYWNrIHRvIHRoZSBmaWxlIGRpcmVjdGx5XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiAwLCBjaDogMCB9LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBgRmFpbGVkIHRvIHVwZGF0ZSBtZXRhZGF0YTogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICovXG4gICAgcHJpdmF0ZSBwYXJzZVByb3BlcnR5VXBkYXRlcyhyZXNwb25zZTogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgYW55PiB8IG51bGwge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIEpTT04gZmlyc3RcbiAgICAgICAgICAgIGNvbnN0IGpzb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9gYGBqc29uXFxzKihbXFxzXFxTXSo/KVxccypgYGAvKTtcbiAgICAgICAgICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uTWF0Y2hbMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgWUFNTC1saWtlIGZvcm1hdFxuICAgICAgICAgICAgY29uc3QgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZS5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICAgIC8vIE1hdGNoIHBhdHRlcm5zIGxpa2UgXCJrZXk6IHZhbHVlXCIgb3IgXCItIGtleTogdmFsdWVcIlxuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXlstXFxzXSooW146XSspOlxccyooLispJC8pO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IG1hdGNoWzJdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSB2YWx1ZSBhcyBKU09OIChmb3IgYXJyYXlzL29iamVjdHMpXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIG5vdCBKU09OLCB0cmVhdCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBxdW90ZXMgaWYgcHJlc2VudFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZS5zdGFydHNXaXRoKCdcIicpICYmIHZhbHVlLmVuZHNXaXRoKCdcIicpKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodmFsdWUuc3RhcnRzV2l0aChcIidcIikgJiYgdmFsdWUuZW5kc1dpdGgoXCInXCIpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoMSwgLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPiAwID8gdXBkYXRlcyA6IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gcGFyc2UgcHJvcGVydHkgdXBkYXRlcyAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXIgaW4gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlRnJvbnRtYXR0ZXIoY29udGVudDogc3RyaW5nLCB1cGRhdGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGZyb250bWF0dGVyIGV4aXN0c1xuICAgICAgICBpZiAobGluZXNbMF0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBjbG9zaW5nIC0tLVxuICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gLTE7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbmVzW2ldID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICBlbmRJbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGVuZEluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIFBhcnNlIGV4aXN0aW5nIGZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdQcm9wczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZW5kSW5kZXg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmVzW2ldLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBLZWVwIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1Byb3BzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBNZXJnZSB1cGRhdGVzIHdpdGggZXhpc3RpbmcgcHJvcGVydGllc1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lcmdlZFByb3BzID0geyAuLi5leGlzdGluZ1Byb3BzLCAuLi51cGRhdGVzIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gUmVidWlsZCBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Zyb250bWF0dGVyID0gWyctLS0nXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhtZXJnZWRQcm9wcykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNraXAgbnVsbC91bmRlZmluZWQgdmFsdWVzIChhbGxvd3MgZGVsZXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goYCR7a2V5fTogJHtmb3JtYXR0ZWRWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBvbGQgZnJvbnRtYXR0ZXIgd2l0aCBuZXdcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgICAgICAuLi5uZXdGcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgLi4ubGluZXMuc2xpY2UoZW5kSW5kZXggKyAxKVxuICAgICAgICAgICAgICAgIF0uam9pbignXFxuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIE5vIGZyb250bWF0dGVyIGV4aXN0cywgY3JlYXRlIG5ld1xuICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHVwZGF0ZXMpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgXG4gICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcbiAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goYCR7a2V5fTogJHtmb3JtYXR0ZWRWYWx1ZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKCctLS0nLCAnJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZnJvbnRtYXR0ZXIgdG8gYmVnaW5uaW5nIG9mIGRvY3VtZW50XG4gICAgICAgIHJldHVybiBuZXdGcm9udG1hdHRlci5qb2luKCdcXG4nKSArIGNvbnRlbnQ7XG4gICAgfVxufSIsICJleHBvcnQgaW50ZXJmYWNlIFRpbWVHYXRlZEZlYXR1cmUge1xuICAgIHN1cGVybm92YURhdGU6IHN0cmluZzsgIC8vIFlZWVktTU0tREQgZm9ybWF0XG4gICAgZ2VuZXJhbERhdGU6IHN0cmluZzsgICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRmVhdHVyZSByZWxlYXNlIGNvbmZpZ3VyYXRpb24gZm9yIFN1cGVybm92YSBlYXJseSBhY2Nlc3MgbW9kZWxcbiAqIFN1cGVybm92YSBzdXBwb3J0ZXJzIGdldCBmZWF0dXJlcyBvbiBzdXBlcm5vdmFEYXRlXG4gKiBBbGwgdXNlcnMgZ2V0IGZlYXR1cmVzIG9uIGdlbmVyYWxEYXRlXG4gKiBcbiAqIERhdGVzIGFyZSBpbiBZWVlZLU1NLUREIGZvcm1hdCBhbmQgZWFzeSB0byBtb2RpZnkgcG9zdC1sYXVuY2hcbiAqL1xuZXhwb3J0IGNvbnN0IFNVUEVSTk9WQV9GRUFUVVJFUzogUmVjb3JkPHN0cmluZywgVGltZUdhdGVkRmVhdHVyZT4gPSB7XG4gICAgLy8gQ29tbWFuZHMgKHVuaWZpZWQpIC0gMiBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnY29tbWFuZHMnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA3LTMxJywgIC8vIFN1cGVybm92YSBlYXJseSBhY2Nlc3NcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA5LTMwJywgICAvLyBHZW5lcmFsIGF2YWlsYWJpbGl0eSBcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb21tYW5kIHN5c3RlbSB3aXRoIDogdHJpZ2dlcnMsIGNvbW1hbmQgYnV0dG9uLCBhbmQgY3VzdG9tIGNvbW1hbmRzJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gQXV0by1ncm93aW5nIGlucHV0IC0gMSBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnYXV0by1pbnB1dCc6IHtcbiAgICAgICAgc3VwZXJub3ZhRGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDctMTUnLCAgIC8vIDEgbW9udGggbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdBdXRvLWdyb3dpbmcgaW5wdXQgYXJlYSB3aXRoIHNtb290aCB0cmFuc2l0aW9ucydcbiAgICB9LFxuICAgIFxuICAgIC8vIEVuaGFuY2VkIHByb3ZpZGVyIG1hbmFnZW1lbnQgLSAyIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdlbmhhbmNlZC1wcm92aWRlcnMnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA4LTE1JywgICAvLyAyIG1vbnRocyBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FkdmFuY2VkIHByb3ZpZGVyIGNvbmZpZ3VyYXRpb24gYW5kIHN3aXRjaGluZydcbiAgICB9XG59O1xuXG4vKipcbiAqIENvcmUgZmVhdHVyZXMgdGhhdCBhcmUgYWx3YXlzIGF2YWlsYWJsZSB0byBhbGwgdXNlcnNcbiAqIFRoZXNlIGFyZSBOT1QgdGltZS1nYXRlZFxuICovXG5leHBvcnQgY29uc3QgQ09SRV9GRUFUVVJFUyA9IFtcbiAgICAnYmFzaWNfZWRpdGluZycsICAgICAgICAgIC8vIEFkZCwgZWRpdCwgZGVsZXRlLCBncmFtbWFyLCByZXdyaXRlIGNvbW1hbmRzXG4gICAgJ2FsbF9haV9wcm92aWRlcnMnLCAgICAgICAvLyBDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWFcbiAgICAnZmlsZV9jb252ZXJzYXRpb25zJywgICAgIC8vIEZpbGUtc2NvcGVkIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgJ3Byb3ZpZGVyX3N3aXRjaGluZycsICAgICAvLyBTd2l0Y2ggcHJvdmlkZXJzIGluIGNoYXRcbiAgICAnbW9iaWxlX2FjY2VzcycsICAgICAgICAgIC8vIEZ1bGwgbW9iaWxlIHN1cHBvcnRcbiAgICAnYXBpX2tleV9jb25maWcnLCAgICAgICAgIC8vIENvbmZpZ3VyZSBvd24gQVBJIGtleXNcbiAgICAnc2lkZWJhcl9jaGF0JywgICAgICAgICAgIC8vIENoYXQgaW50ZXJmYWNlIGluIHNpZGViYXJcbiAgICAnZG9jdW1lbnRfY29udGV4dCcsICAgICAgIC8vIEN1cnJlbnQgZG9jdW1lbnQgY29udGV4dFxuICAgICdtdWx0aS1kb2MtY29udGV4dCcgICAgICAgLy8gUmVmZXJlbmNlIG90aGVyIGRvY3VtZW50cyB3aXRoIFtbZG9jXV0gc3ludGF4XG5dOyIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBTdXBlcm5vdmFMaWNlbnNlLCBGZWF0dXJlRmxhZywgRmVhdHVyZUFjY2Vzc1Jlc3VsdCwgRGVidWdTZXR0aW5ncywgU3VwZXJub3ZhVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgU1VQRVJOT1ZBX0ZFQVRVUkVTLCBDT1JFX0ZFQVRVUkVTLCBUaW1lR2F0ZWRGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlLWNvbmZpZyc7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTWFuYWdlciB7XG5cdHByaXZhdGUgZmVhdHVyZXM6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzdXBlcm5vdmFMaWNlbnNlOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgaXNTdXBlcm5vdmE6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbGljZW5zZVZhbGlkYXRvcjogTGljZW5zZVZhbGlkYXRvcixcblx0XHRkZWJ1Z1NldHRpbmdzPzogRGVidWdTZXR0aW5nc1xuXHQpIHtcblx0XHRpZiAoZGVidWdTZXR0aW5ncykge1xuXHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0gZGVidWdTZXR0aW5ncztcblx0XHR9XG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZSBhbGwgZmVhdHVyZSBmbGFnc1xuXHQgKiBDb3JlIGZlYXR1cmVzIGFyZSBhbHdheXMgZW5hYmxlZFxuXHQgKiBUaW1lLWdhdGVkIGZlYXR1cmVzIGRlcGVuZCBvbiBjdXJyZW50IGRhdGUgYW5kIFN1cGVybm92YSBzdGF0dXNcblx0ICovXG5cdHByaXZhdGUgaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpOiB2b2lkIHtcblx0XHQvLyBDb3JlIGZlYXR1cmVzIC0gYWx3YXlzIGF2YWlsYWJsZSB0byBhbGwgdXNlcnNcblx0XHRDT1JFX0ZFQVRVUkVTLmZvckVhY2goZmVhdHVyZUtleSA9PiB7XG5cdFx0XHR0aGlzLnJlZ2lzdGVyRmVhdHVyZSh7XG5cdFx0XHRcdGtleTogZmVhdHVyZUtleSxcblx0XHRcdFx0ZW5hYmxlZDogdHJ1ZSxcblx0XHRcdFx0ZGVzY3JpcHRpb246IHRoaXMuZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihmZWF0dXJlS2V5KVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyBUaW1lLWdhdGVkIGZlYXR1cmVzIC0gYXZhaWxhYmxlIGJhc2VkIG9uIGRhdGVcblx0XHRPYmplY3QuZW50cmllcyhTVVBFUk5PVkFfRkVBVFVSRVMpLmZvckVhY2goKFtrZXksIGNvbmZpZ10pID0+IHtcblx0XHRcdGNvbnN0IGVuYWJsZWQgPSB0aGlzLmlzVGltZUdhdGVkRmVhdHVyZUVuYWJsZWQoa2V5LCBjb25maWcpO1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXksXG5cdFx0XHRcdGVuYWJsZWQsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiBjb25maWcuZGVzY3JpcHRpb24sXG5cdFx0XHRcdGlzVGltZUdhdGVkOiB0cnVlLFxuXHRcdFx0XHRlYXJseUFjY2Vzc09ubHk6ICF0aGlzLmlzR2VuZXJhbGx5QXZhaWxhYmxlKGNvbmZpZylcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkZXNjcmlwdGlvbiBmb3IgY29yZSBmZWF0dXJlc1xuXHQgKi9cblx0cHJpdmF0ZSBnZXRDb3JlRmVhdHVyZURlc2NyaXB0aW9uKGtleTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBkZXNjcmlwdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnYmFzaWNfZWRpdGluZyc6ICdCYXNpYyBkb2N1bWVudCBlZGl0aW5nIGNvbW1hbmRzIChhZGQsIGVkaXQsIGRlbGV0ZSwgZ3JhbW1hciwgcmV3cml0ZSknLFxuXHRcdFx0J2FsbF9haV9wcm92aWRlcnMnOiAnQWNjZXNzIHRvIGFsbCBBSSBwcm92aWRlcnMgKENsYXVkZSwgT3BlbkFJLCBHb29nbGUsIE9sbGFtYSknLFxuXHRcdFx0J2ZpbGVfY29udmVyc2F0aW9ucyc6ICdGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeScsXG5cdFx0XHQncHJvdmlkZXJfc3dpdGNoaW5nJzogJ1N3aXRjaCBBSSBwcm92aWRlcnMgZGlyZWN0bHkgaW4gY2hhdCBpbnRlcmZhY2UnLFxuXHRcdFx0J21vYmlsZV9hY2Nlc3MnOiAnRnVsbCBtb2JpbGUgZGV2aWNlIHN1cHBvcnQnLFxuXHRcdFx0J2FwaV9rZXlfY29uZmlnJzogJ0NvbmZpZ3VyZSB5b3VyIG93biBBUEkga2V5cycsXG5cdFx0XHQnc2lkZWJhcl9jaGF0JzogJ0NoYXQgaW50ZXJmYWNlIGluIHNpZGViYXInLFxuXHRcdFx0J2RvY3VtZW50X2NvbnRleHQnOiAnQ3VycmVudCBkb2N1bWVudCBjb250ZXh0IGluIGNvbnZlcnNhdGlvbnMnXG5cdFx0fTtcblx0XHRyZXR1cm4gZGVzY3JpcHRpb25zW2tleV0gfHwga2V5O1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgdGltZS1nYXRlZCBmZWF0dXJlIHNob3VsZCBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzVGltZUdhdGVkRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nLCBjb25maWc6IFRpbWVHYXRlZEZlYXR1cmUpOiBib29sZWFuIHtcblx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblx0XHRjb25zdCBnZW5lcmFsRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5nZW5lcmFsRGF0ZSk7XG5cblx0XHQvLyBGZWF0dXJlIGlzIGF2YWlsYWJsZSB0byBldmVyeW9uZSBhZnRlciBnZW5lcmFsIGRhdGVcblx0XHRpZiAobm93ID49IGdlbmVyYWxEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBGZWF0dXJlIGlzIGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycyBhZnRlciBzdXBlcm5vdmEgZGF0ZVxuXHRcdGlmICh0aGlzLmdldElzU3VwZXJub3ZhKCkgJiYgbm93ID49IHN1cGVybm92YURhdGUpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBmZWF0dXJlIGlzIGdlbmVyYWxseSBhdmFpbGFibGUgKHBhc3QgZ2VuZXJhbCBkYXRlKVxuXHQgKi9cblx0cHJpdmF0ZSBpc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWc6IFRpbWVHYXRlZEZlYXR1cmUpOiBib29sZWFuIHtcblx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXHRcdHJldHVybiBub3cgPj0gZ2VuZXJhbERhdGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgZGF0ZSAoY2FuIGJlIG92ZXJyaWRkZW4gaW4gZGVidWcgbW9kZSlcblx0ICovXG5cdHByaXZhdGUgZ2V0Q3VycmVudERhdGUoKTogRGF0ZSB7XG5cdFx0aWYgKHRoaXMuZGVidWdTZXR0aW5ncy5lbmFibGVkICYmIHRoaXMuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUpIHtcblx0XHRcdHJldHVybiBuZXcgRGF0ZSh0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKTtcblx0XHR9XG5cdFx0cmV0dXJuIG5ldyBEYXRlKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IFN1cGVybm92YSBzdGF0dXMgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldElzU3VwZXJub3ZhKCk6IGJvb2xlYW4ge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuaXNTdXBlcm5vdmE7XG5cdH1cblxuXHQvKipcblx0ICogUmVnaXN0ZXIgYSBuZXcgZmVhdHVyZSBmbGFnXG5cdCAqL1xuXHRyZWdpc3RlckZlYXR1cmUoZmxhZzogRmVhdHVyZUZsYWcpOiB2b2lkIHtcblx0XHR0aGlzLmZlYXR1cmVzLnNldChmbGFnLmtleSwgZmxhZyk7XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIFN1cGVybm92YSBsaWNlbnNlIGFuZCByZWNhbGN1bGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHQgKi9cblx0YXN5bmMgdXBkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHR0aGlzLnN1cGVybm92YUxpY2Vuc2UgPSBudWxsO1xuXHRcdFx0dGhpcy5pc1N1cGVybm92YSA9IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCB2YWxpZGF0aW9uID0gYXdhaXQgdGhpcy5saWNlbnNlVmFsaWRhdG9yLnZhbGlkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICh2YWxpZGF0aW9uLnZhbGlkICYmIHZhbGlkYXRpb24ubGljZW5zZSkge1xuXHRcdFx0XHR0aGlzLnN1cGVybm92YUxpY2Vuc2UgPSB2YWxpZGF0aW9uLmxpY2Vuc2U7XG5cdFx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSB0cnVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pc1N1cGVybm92YSA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFJlaW5pdGlhbGl6ZSBmZWF0dXJlcyB3aXRoIHVwZGF0ZWQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IFN1cGVybm92YSBzdGF0dXNcblx0ICovXG5cdGlzU3VwZXJub3ZhU3VwcG9ydGVyKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgU3VwZXJub3ZhIGxpY2Vuc2Vcblx0ICovXG5cdGdldFN1cGVybm92YUxpY2Vuc2UoKTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLnN1cGVybm92YUxpY2Vuc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgYSBmZWF0dXJlIGlzIGVuYWJsZWRcblx0ICovXG5cdGlzRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gSGFuZGxlIG9sZCBmZWF0dXJlIGtleXMgdGhhdCBtaWdodCBzdGlsbCBiZSByZWZlcmVuY2VkXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTsgLy8gQWxsIGxlZ2FjeSBmZWF0dXJlcyBhcmUgbm93IGVuYWJsZWQgZm9yIGV2ZXJ5b25lXG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdHJldHVybiBmZWF0dXJlPy5lbmFibGVkID8/IGZhbHNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoaXMgaXMgYSBsZWdhY3kgZmVhdHVyZSBrZXkgdGhhdCBzaG91bGQgYWx3YXlzIGJlIGVuYWJsZWRcblx0ICovXG5cdHByaXZhdGUgaXNMZWdhY3lGZWF0dXJlS2V5KGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Y29uc3QgbGVnYWN5S2V5cyA9IFtcblx0XHRcdCdiYXNpY19lZGl0aW5nJyxcblx0XHRcdCdsb2NhbF9haV9wcm92aWRlcnMnLFxuXHRcdFx0J2ZpbGVfY29udmVyc2F0aW9ucycsXG5cdFx0XHQnc2luZ2xlX2Nsb3VkX3Byb3ZpZGVyJyxcblx0XHRcdCd1bmxpbWl0ZWRfY2xvdWRfYWknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZycsXG5cdFx0XHQnbW9iaWxlX2FjY2VzcycsXG5cdFx0XHQnYWR2YW5jZWRfdGVtcGxhdGVzJyxcblx0XHRcdCdiYXRjaF9vcGVyYXRpb25zJyxcblx0XHRcdCdjcm9zc19kb2N1bWVudF9jb250ZXh0Jyxcblx0XHRcdCdwcmlvcml0eV9zdXBwb3J0J1xuXHRcdF07XG5cdFx0cmV0dXJuIGxlZ2FjeUtleXMuaW5jbHVkZXMoa2V5KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBmZWF0dXJlIGFjY2VzcyB3aXRoIGRldGFpbGVkIHJlc3VsdFxuXHQgKi9cblx0Y2hlY2tGZWF0dXJlQWNjZXNzKGZlYXR1cmVLZXk6IHN0cmluZyk6IEZlYXR1cmVBY2Nlc3NSZXN1bHQge1xuXHRcdC8vIEhhbmRsZSBsZWdhY3kgZmVhdHVyZXNcblx0XHRpZiAodGhpcy5pc0xlZ2FjeUZlYXR1cmVLZXkoZmVhdHVyZUtleSkpIHtcblx0XHRcdHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcblx0XHR9XG5cblx0XHRjb25zdCBmZWF0dXJlID0gdGhpcy5mZWF0dXJlcy5nZXQoZmVhdHVyZUtleSk7XG5cdFx0XG5cdFx0aWYgKCFmZWF0dXJlKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0YWxsb3dlZDogZmFsc2UsIFxuXHRcdFx0XHRyZWFzb246IGBGZWF0dXJlICcke2ZlYXR1cmVLZXl9JyBub3QgZm91bmRgIFxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRpZiAoZmVhdHVyZS5lbmFibGVkKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHRpbWUtZ2F0ZWQgZmVhdHVyZXMsIHByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvblxuXHRcdGlmIChmZWF0dXJlLmlzVGltZUdhdGVkKSB7XG5cdFx0XHRjb25zdCBjb25maWcgPSBTVVBFUk5PVkFfRkVBVFVSRVNbZmVhdHVyZUtleV07XG5cdFx0XHRpZiAoY29uZmlnKSB7XG5cdFx0XHRcdGNvbnN0IG5vdyA9IHRoaXMuZ2V0Q3VycmVudERhdGUoKTtcblx0XHRcdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXHRcdFx0XHRjb25zdCBzdXBlcm5vdmFEYXRlID0gbmV3IERhdGUoY29uZmlnLnN1cGVybm92YURhdGUpO1xuXG5cdFx0XHRcdGlmICh0aGlzLmdldElzU3VwZXJub3ZhKCkgJiYgbm93IDwgc3VwZXJub3ZhRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSB3aWxsIGJlIGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycyBvbiAke2NvbmZpZy5zdXBlcm5vdmFEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBzdXBlcm5vdmFEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIGlmICghdGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IGdlbmVyYWxEYXRlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLFxuXHRcdFx0XHRcdFx0cmVhc29uOiBgVGhpcyBmZWF0dXJlIGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBJdCB3aWxsIGJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgb24gJHtjb25maWcuZ2VuZXJhbERhdGV9YCxcblx0XHRcdFx0XHRcdGlzU3VwZXJub3ZhRmVhdHVyZTogdHJ1ZSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGdlbmVyYWxEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdHJlYXNvbjogJ0ZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZSdcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgZW5hYmxlZCBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0RW5hYmxlZEZlYXR1cmVzKCk6IEZlYXR1cmVGbGFnW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMuZmVhdHVyZXMudmFsdWVzKCkpLmZpbHRlcihmZWF0dXJlID0+IGZlYXR1cmUuZW5hYmxlZCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFsbCBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIGZlYXR1cmVzXG5cdCAqL1xuXHRnZXRTdXBlcm5vdmFGZWF0dXJlcygpOiBGZWF0dXJlRmxhZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmZlYXR1cmVzLnZhbHVlcygpKS5maWx0ZXIoZmVhdHVyZSA9PiBcblx0XHRcdGZlYXR1cmUuaXNUaW1lR2F0ZWQgJiYgZmVhdHVyZS5lYXJseUFjY2Vzc09ubHlcblx0XHQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBkZWJ1ZyBzZXR0aW5ncyBmb3IgZGV2ZWxvcG1lbnQgdGVzdGluZ1xuXHQgKi9cblx0dXBkYXRlRGVidWdTZXR0aW5ncyhzZXR0aW5nczogRGVidWdTZXR0aW5ncyk6IHZvaWQge1xuXHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdC8vIFJlaW5pdGlhbGl6ZSBmZWF0dXJlcyB3aXRoIG5ldyBkZWJ1ZyBzZXR0aW5nc1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkZWJ1ZyBzZXR0aW5nc1xuXHQgKi9cblx0Z2V0RGVidWdTZXR0aW5ncygpOiBEZWJ1Z1NldHRpbmdzIHtcblx0XHRyZXR1cm4geyAuLi50aGlzLmRlYnVnU2V0dGluZ3MgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZmVhdHVyZSBzdW1tYXJ5XG5cdCAqL1xuXHRnZXRGZWF0dXJlU3VtbWFyeSgpOiB7IFxuXHRcdGlzU3VwZXJub3ZhOiBib29sZWFuOyBcblx0XHRlbmFibGVkOiBzdHJpbmdbXTsgXG5cdFx0Y29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzU3VwZXJub3ZhOiBib29sZWFufT4gXG5cdH0ge1xuXHRcdGNvbnN0IGVuYWJsZWQ6IHN0cmluZ1tdID0gW107XG5cdFx0Y29uc3QgY29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzU3VwZXJub3ZhOiBib29sZWFufT4gPSBbXTtcblxuXHRcdGZvciAoY29uc3QgW2tleSwgZmVhdHVyZV0gb2YgdGhpcy5mZWF0dXJlcykge1xuXHRcdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0XHRlbmFibGVkLnB1c2goa2V5KTtcblx0XHRcdH0gZWxzZSBpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0XHRjb25zdCBjb25maWcgPSBTVVBFUk5PVkFfRkVBVFVSRVNba2V5XTtcblx0XHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRcdGNvbnN0IGlzU3VwZXJub3ZhVXNlciA9IHRoaXMuZ2V0SXNTdXBlcm5vdmEoKTtcblx0XHRcdFx0XHRjb21pbmdTb29uLnB1c2goe1xuXHRcdFx0XHRcdFx0a2V5LFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogaXNTdXBlcm5vdmFVc2VyID8gY29uZmlnLnN1cGVybm92YURhdGUgOiBjb25maWcuZ2VuZXJhbERhdGUsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YTogaXNTdXBlcm5vdmFVc2VyXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4geyBcblx0XHRcdGlzU3VwZXJub3ZhOiB0aGlzLmdldElzU3VwZXJub3ZhKCksIFxuXHRcdFx0ZW5hYmxlZCwgXG5cdFx0XHRjb21pbmdTb29uIFxuXHRcdH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgTGljZW5zZSwgU3VwZXJub3ZhTGljZW5zZSwgTGljZW5zZVZhbGlkYXRpb25SZXN1bHQsIFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQsIExpY2Vuc2VFcnJvciB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgTGljZW5zZVZhbGlkYXRvciB7XG5cdC8vIEVtYmVkZGVkIHNpZ25pbmcga2V5IC0gaW4gcHJvZHVjdGlvbiB0aGlzIHdvdWxkIGJlIG9iZnVzY2F0ZWRcblx0cHJpdmF0ZSByZWFkb25seSBTRUNSRVRfS0VZID0gJ25vdmEtbGljZW5zZS1zaWduaW5nLWtleS0yMDI1Jztcblx0XG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBsaWNlbnNlIGtleSBhbmQgcmV0dXJucyB2YWxpZGF0aW9uIHJlc3VsdFxuXHQgKi9cblx0YXN5bmMgdmFsaWRhdGVMaWNlbnNlKGxpY2Vuc2VLZXk6IHN0cmluZyk6IFByb21pc2U8TGljZW5zZVZhbGlkYXRpb25SZXN1bHQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgbGljZW5zZSA9IHRoaXMucGFyc2VMaWNlbnNlS2V5KGxpY2Vuc2VLZXkpO1xuXHRcdFx0aWYgKCFsaWNlbnNlKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5JTlZBTElEX0ZPUk1BVCBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbkVycm9yID0gYXdhaXQgdGhpcy52YWxpZGF0ZUxpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBsaWNlbnNlIGtleSBzdHJpbmcgaW50byBhIExpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIHBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5OiBzdHJpbmcpOiBMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIExpY2Vuc2Uga2V5IGZvcm1hdDogYmFzZTY0KGVtYWlsfHRpZXJ8ZXhwaXJlc0F0fGlzc3VlZEF0fHNpZ25hdHVyZSlcblx0XHRcdGNvbnN0IGRlY29kZWQgPSB0aGlzLmJhc2U2NERlY29kZShsaWNlbnNlS2V5KTtcblx0XHRcdGNvbnN0IHBhcnRzID0gZGVjb2RlZC5zcGxpdCgnfCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAocGFydHMubGVuZ3RoICE9PSA1KSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBbZW1haWwsIHRpZXIsIGV4cGlyZXNBdFN0ciwgaXNzdWVkQXRTdHIsIHNpZ25hdHVyZV0gPSBwYXJ0cztcblxuXHRcdFx0Ly8gU2tpcCB0aWVyIHZhbGlkYXRpb24gc2luY2Ugd2UncmUgcmVtb3ZpbmcgdGllcnNcblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdGV4cGlyZXNBdCxcblx0XHRcdFx0aXNzdWVkQXQsXG5cdFx0XHRcdHNpZ25hdHVyZSxcblx0XHRcdFx0bGljZW5zZUtleVxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGRlY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjREZWNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYXRvYiAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBhdG9iKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCd1dGY4Jyk7XG5cdH1cblxuXHQvKipcblx0ICogU2FmZSBiYXNlNjQgZW5jb2RlIHRoYXQgaGFuZGxlcyBib3RoIGJyb3dzZXIgYW5kIE5vZGUuanMgZW52aXJvbm1lbnRzXG5cdCAqL1xuXHRwcml2YXRlIGJhc2U2NEVuY29kZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHR5cGVvZiBidG9hICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIGJ0b2Eoc3RyKTtcblx0XHR9XG5cdFx0Ly8gRmFsbGJhY2sgZm9yIE5vZGUuanMgZW52aXJvbm1lbnRcblx0XHRyZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAndXRmOCcpLnRvU3RyaW5nKCdiYXNlNjQnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBsaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyB2YWxpZGF0ZUxpY2Vuc2VPYmplY3QobGljZW5zZTogTGljZW5zZSk6IFByb21pc2U8TGljZW5zZUVycm9yIHwgbnVsbD4ge1xuXHRcdC8vIDEuIFZlcmlmeSBITUFDIHNpZ25hdHVyZVxuXHRcdGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRcdGxpY2Vuc2UuZW1haWwsXG5cdFx0XHQnbGVnYWN5JywgLy8gVXNlIGxlZ2FjeSBmb3Igb2xkIGxpY2Vuc2VzXG5cdFx0XHRsaWNlbnNlLmV4cGlyZXNBdCxcblx0XHRcdGxpY2Vuc2UuaXNzdWVkQXRcblx0XHQpO1xuXG5cdFx0aWYgKGxpY2Vuc2Uuc2lnbmF0dXJlICE9PSBleHBlY3RlZFNpZ25hdHVyZSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5JTlZBTElEX1NJR05BVFVSRTtcblx0XHR9XG5cblx0XHQvLyAyLiBDaGVjayBleHBpcmF0aW9uXG5cdFx0aWYgKGxpY2Vuc2UuZXhwaXJlc0F0ICYmIG5ldyBEYXRlKCkgPiBsaWNlbnNlLmV4cGlyZXNBdCkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5FWFBJUkVEO1xuXHRcdH1cblxuXHRcdC8vIDMuIFZhbGlkYXRlIGlzc3VlIGRhdGUgKHByZXZlbnQgZnV0dXJlLWRhdGVkIGxpY2Vuc2VzKVxuXHRcdGlmIChsaWNlbnNlLmlzc3VlZEF0ID4gbmV3IERhdGUoKSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5GVVRVUkVfREFURUQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIEhNQUMtU0hBMjU2IHNpZ25hdHVyZSBmb3IgbGljZW5zZSBkYXRhXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdlbmVyYXRlU2lnbmF0dXJlKFxuXHRcdGVtYWlsOiBzdHJpbmcsXG5cdFx0dGllcjogc3RyaW5nLFxuXHRcdGV4cGlyZXNBdDogRGF0ZSB8IG51bGwsXG5cdFx0aXNzdWVkQXQ6IERhdGVcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBkYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfWA7XG5cdFx0XG5cdFx0Y29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdGNvbnN0IGtleURhdGEgPSBlbmNvZGVyLmVuY29kZSh0aGlzLlNFQ1JFVF9LRVkpO1xuXHRcdGNvbnN0IG1lc3NhZ2VEYXRhID0gZW5jb2Rlci5lbmNvZGUoZGF0YSk7XG5cdFx0XG5cdFx0Y29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG5cdFx0XHQncmF3Jyxcblx0XHRcdGtleURhdGEsXG5cdFx0XHR7IG5hbWU6ICdITUFDJywgaGFzaDogJ1NIQS0yNTYnIH0sXG5cdFx0XHRmYWxzZSxcblx0XHRcdFsnc2lnbiddXG5cdFx0KTtcblx0XHRcblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBjcnlwdG9LZXksIG1lc3NhZ2VEYXRhKTtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShzaWduYXR1cmUpKVxuXHRcdFx0Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpXG5cdFx0XHQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHRlc3QgbGljZW5zZSBmb3IgZGV2ZWxvcG1lbnQgcHVycG9zZXNcblx0ICovXG5cdGFzeW5jIGNyZWF0ZVRlc3RMaWNlbnNlKGVtYWlsOiBzdHJpbmcsIHRpZXI6IHN0cmluZywgbGlmZXRpbWVNb2RlID0gdHJ1ZSk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZSgpO1xuXHRcdGNvbnN0IGV4cGlyZXNBdCA9IGxpZmV0aW1lTW9kZSA/IG51bGwgOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDEgeWVhclxuXG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVNpZ25hdHVyZShlbWFpbCwgdGllciwgZXhwaXJlc0F0LCBpc3N1ZWRBdCk7XG5cdFx0XG5cdFx0Y29uc3QgbGljZW5zZURhdGEgPSBgJHtlbWFpbH18JHt0aWVyfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9fCR7c2lnbmF0dXJlfWA7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmFzZTY0RW5jb2RlKGxpY2Vuc2VEYXRhKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBrZXlcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgbGljZW5zZSA9IHRoaXMucGFyc2VTdXBlcm5vdmFMaWNlbnNlS2V5KGxpY2Vuc2VLZXkpO1xuXHRcdFx0aWYgKCFsaWNlbnNlKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5JTlZBTElEX0ZPUk1BVCBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbkVycm9yID0gYXdhaXQgdGhpcy52YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBrZXkgc3RyaW5nXG5cdCAqL1xuXHRwcml2YXRlIHBhcnNlU3VwZXJub3ZhTGljZW5zZUtleShsaWNlbnNlS2V5OiBzdHJpbmcpOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0eXBlfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0eXBlLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFZhbGlkYXRlIHR5cGVcblx0XHRcdGlmICh0eXBlICE9PSAnYW5udWFsJyAmJiB0eXBlICE9PSAnbGlmZXRpbWUnKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBQYXJzZSBkYXRlc1xuXHRcdFx0Y29uc3QgZXhwaXJlc0F0ID0gZXhwaXJlc0F0U3RyID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKGV4cGlyZXNBdFN0cik7XG5cdFx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKGlzc3VlZEF0U3RyKTtcblxuXHRcdFx0Ly8gVmFsaWRhdGUgZGF0ZXNcblx0XHRcdGlmIChpc05hTihpc3N1ZWRBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXhwaXJlc0F0ICYmIGlzTmFOKGV4cGlyZXNBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRlbWFpbCxcblx0XHRcdFx0dHlwZTogdHlwZSBhcyAnYW5udWFsJyB8ICdsaWZldGltZScsXG5cdFx0XHRcdGV4cGlyZXNBdCxcblx0XHRcdFx0aXNzdWVkQXQsXG5cdFx0XHRcdHNpZ25hdHVyZSxcblx0XHRcdFx0bGljZW5zZUtleVxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIFN1cGVybm92YSBsaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyB2YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2VPYmplY3QobGljZW5zZTogU3VwZXJub3ZhTGljZW5zZSk6IFByb21pc2U8TGljZW5zZUVycm9yIHwgbnVsbD4ge1xuXHRcdC8vIDEuIFZlcmlmeSBITUFDIHNpZ25hdHVyZVxuXHRcdGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShcblx0XHRcdGxpY2Vuc2UuZW1haWwsXG5cdFx0XHRsaWNlbnNlLnR5cGUsXG5cdFx0XHRsaWNlbnNlLmV4cGlyZXNBdCxcblx0XHRcdGxpY2Vuc2UuaXNzdWVkQXRcblx0XHQpO1xuXG5cdFx0aWYgKGxpY2Vuc2Uuc2lnbmF0dXJlICE9PSBleHBlY3RlZFNpZ25hdHVyZSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5JTlZBTElEX1NJR05BVFVSRTtcblx0XHR9XG5cblx0XHQvLyAyLiBDaGVjayBleHBpcmF0aW9uXG5cdFx0aWYgKGxpY2Vuc2UuZXhwaXJlc0F0ICYmIG5ldyBEYXRlKCkgPiBsaWNlbnNlLmV4cGlyZXNBdCkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5FWFBJUkVEO1xuXHRcdH1cblxuXHRcdC8vIDMuIFZhbGlkYXRlIGlzc3VlIGRhdGVcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIFN1cGVybm92YSBsaWNlbnNlXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdlbmVyYXRlU3VwZXJub3ZhU2lnbmF0dXJlKFxuXHRcdGVtYWlsOiBzdHJpbmcsXG5cdFx0dHlwZTogJ2FubnVhbCcgfCAnbGlmZXRpbWUnLFxuXHRcdGV4cGlyZXNBdDogRGF0ZSB8IG51bGwsXG5cdFx0aXNzdWVkQXQ6IERhdGVcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBkYXRhID0gYCR7ZW1haWx9fCR7dHlwZX18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfWA7XG5cdFx0XG5cdFx0Y29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdGNvbnN0IGtleURhdGEgPSBlbmNvZGVyLmVuY29kZSh0aGlzLlNFQ1JFVF9LRVkpO1xuXHRcdGNvbnN0IG1lc3NhZ2VEYXRhID0gZW5jb2Rlci5lbmNvZGUoZGF0YSk7XG5cdFx0XG5cdFx0Y29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG5cdFx0XHQncmF3Jyxcblx0XHRcdGtleURhdGEsXG5cdFx0XHR7IG5hbWU6ICdITUFDJywgaGFzaDogJ1NIQS0yNTYnIH0sXG5cdFx0XHRmYWxzZSxcblx0XHRcdFsnc2lnbiddXG5cdFx0KTtcblx0XHRcblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBjcnlwdG9LZXksIG1lc3NhZ2VEYXRhKTtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShzaWduYXR1cmUpKVxuXHRcdFx0Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpXG5cdFx0XHQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHRlc3QgU3VwZXJub3ZhIGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50XG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0U3VwZXJub3ZhTGljZW5zZShlbWFpbDogc3RyaW5nLCB0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSB0eXBlID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU3VwZXJub3ZhU2lnbmF0dXJlKGVtYWlsLCB0eXBlLCBleHBpcmVzQXQsIGlzc3VlZEF0KTtcblx0XHRcblx0XHRjb25zdCBsaWNlbnNlRGF0YSA9IGAke2VtYWlsfXwke3R5cGV9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX18JHtzaWduYXR1cmV9YDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5iYXNlNjRFbmNvZGUobGljZW5zZURhdGEpO1xuXHR9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxvQkFBbUg7OztBQ0FuSCxJQUFBQyxtQkFBeUQ7OztBQ0F6RCxJQUFBQyxtQkFBNEg7OztBQ0s1SCxzQkFBMkM7QUErQnBDLElBQU0seUJBQU4sTUFBNkI7QUFBQSxFQU1oQyxZQUFZLEtBQVU7QUFKdEIsU0FBUSxvQkFBc0Qsb0JBQUksSUFBSTtBQUN0RSxTQUFpQixjQUFjO0FBQy9CLFNBQWlCLG9CQUFvQjtBQUdqQyxTQUFLLE1BQU07QUFBQSxFQUNmO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxhQUFhLFNBQWlCLHNCQUc1QjtBQUNFLFVBQU0sYUFBa0MsQ0FBQztBQUN6QyxRQUFJLGlCQUFpQjtBQUlyQixVQUFNLGFBQWE7QUFFbkIsUUFBSTtBQUNKLFlBQVEsUUFBUSxXQUFXLEtBQUssT0FBTyxPQUFPLE1BQU07QUFDaEQsWUFBTSxVQUFVLE1BQU0sQ0FBQztBQUN2QixZQUFNLFdBQVcsTUFBTSxDQUFDO0FBQ3hCLFlBQU0sZUFBZSxNQUFNLENBQUM7QUFHNUIsWUFBTSxPQUFPLEtBQUssU0FBUyxPQUFPO0FBRWxDLFVBQUksTUFBTTtBQUNOLG1CQUFXLEtBQUs7QUFBQSxVQUNaO0FBQUEsVUFDQSxjQUFjO0FBQUE7QUFBQSxVQUNkO0FBQUEsVUFDQTtBQUFBLFFBQ0osQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBR0EsZUFBVyxPQUFPLFlBQVk7QUFDMUIsdUJBQWlCLGVBQWUsUUFBUSxJQUFJLGNBQWMsR0FBRztBQUFBLElBQ2pFO0FBR0EscUJBQWlCLGVBQWUsUUFBUSxXQUFXLEdBQUcsRUFBRSxLQUFLO0FBRzdELFVBQU0saUJBQWlCLFdBQVcsT0FBTyxTQUFPLElBQUksWUFBWTtBQUNoRSxRQUFJLGVBQWUsU0FBUyxHQUFHO0FBQzNCLFlBQU0sV0FBVyxLQUFLLGtCQUFrQixJQUFJLG9CQUFvQixLQUFLLENBQUM7QUFDdEUsWUFBTSxvQkFBb0IsQ0FBQyxHQUFHLFFBQVE7QUFHdEMsaUJBQVcsT0FBTyxnQkFBZ0I7QUFDOUIsY0FBTSxTQUFTLGtCQUFrQixLQUFLLENBQUFDLGNBQVlBLFVBQVMsS0FBSyxTQUFTLElBQUksS0FBSyxJQUFJO0FBQ3RGLFlBQUksQ0FBQyxRQUFRO0FBQ1QsNEJBQWtCLEtBQUssR0FBRztBQUFBLFFBQzlCO0FBQUEsTUFDSjtBQUVBLFdBQUssa0JBQWtCLElBQUksc0JBQXNCLGlCQUFpQjtBQUFBLElBQ3RFO0FBRUEsV0FBTyxFQUFFLGdCQUFnQixXQUFXO0FBQUEsRUFDeEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sYUFDRixTQUNBLGFBQ0Esa0JBSUQ7QUFFQyxVQUFNLEVBQUUsZ0JBQWdCLFdBQVcsSUFBSSxLQUFLLGFBQWEsU0FBUyxZQUFZLElBQUk7QUFHbEYsVUFBTSxxQkFBcUIsS0FBSyxrQkFBa0IsSUFBSSxZQUFZLElBQUksS0FBSyxDQUFDO0FBRzVFLFFBQUksV0FBVyxTQUFTLEdBQUc7QUFDdkIsWUFBTSxvQkFBb0IsQ0FBQyxHQUFHLGtCQUFrQjtBQUdoRCxpQkFBVyxPQUFPLFlBQVk7QUFDMUIsY0FBTSxTQUFTLGtCQUFrQixLQUFLLGNBQVksU0FBUyxLQUFLLFNBQVMsSUFBSSxLQUFLLElBQUk7QUFDdEYsWUFBSSxDQUFDLFFBQVE7QUFDVCw0QkFBa0IsS0FBSyxHQUFHO0FBQUEsUUFDOUI7QUFBQSxNQUNKO0FBRUEsV0FBSyxrQkFBa0IsSUFBSSxZQUFZLE1BQU0saUJBQWlCO0FBQUEsSUFDbEU7QUFHQSxVQUFNLG9CQUFvQixLQUFLLGtCQUFrQixJQUFJLFlBQVksSUFBSSxLQUFLLENBQUM7QUFHM0UsVUFBTSxvQkFBb0Isa0JBQWtCLE9BQU8sWUFBVTtBQUN6RCxVQUFJLEVBQUMsaUNBQVEsU0FBUSxDQUFDLEtBQUssSUFBSSxNQUFNLHNCQUFzQixPQUFPLEtBQUssSUFBSSxHQUFHO0FBRTFFLGVBQU87QUFBQSxNQUNYO0FBQ0EsYUFBTztBQUFBLElBQ1gsQ0FBQztBQUdELFFBQUksa0JBQWtCLFdBQVcsa0JBQWtCLFFBQVE7QUFDdkQsVUFBSSxrQkFBa0IsU0FBUyxHQUFHO0FBQzlCLGFBQUssa0JBQWtCLElBQUksWUFBWSxNQUFNLGlCQUFpQjtBQUFBLE1BQ2xFLE9BQU87QUFDSCxhQUFLLGtCQUFrQixPQUFPLFlBQVksSUFBSTtBQUFBLE1BQ2xEO0FBQUEsSUFDSjtBQUdBLFVBQU0sZUFBeUIsQ0FBQztBQUdoQyxVQUFNLHFCQUFxQixNQUFNLEtBQUssdUJBQXVCLGFBQWEsTUFBTSxHQUFHO0FBQ25GLFFBQUksb0JBQW9CO0FBQ3BCLG1CQUFhLEtBQUssa0JBQWtCO0FBQUEsSUFDeEM7QUFHQSxlQUFXLFVBQVUsbUJBQW1CO0FBQ3BDLFlBQU0sY0FBYyxNQUFNLEtBQUssbUJBQW1CLE1BQU07QUFDeEQsVUFBSSxhQUFhO0FBQ2IscUJBQWEsS0FBSyxXQUFXO0FBQUEsTUFDakM7QUFBQSxJQUNKO0FBRUEsVUFBTSxnQkFBZ0IsYUFBYSxLQUFLLGFBQWE7QUFDckQsVUFBTSxhQUFhLEtBQUssZUFBZSxhQUFhO0FBQ3BELFVBQU0sY0FBYyxhQUFjLEtBQUssY0FBYyxLQUFLO0FBRTFELFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQSxTQUFTO0FBQUEsUUFDTCxnQkFBZ0I7QUFBQSxRQUNoQjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUF1QixNQUFhLGlCQUEwQixNQUFNLFdBQW1CLElBQTRCO0FBQzdILFFBQUk7QUFDQSxVQUFJLGVBQXlCLENBQUM7QUFHOUIsbUJBQWEsS0FBSyxnQkFBZ0IsS0FBSyxRQUFRLEVBQUU7QUFHakQsWUFBTSxRQUFRLEtBQUssSUFBSSxjQUFjLGFBQWEsSUFBSTtBQUN0RCxXQUFJLCtCQUFPLGdCQUFlLE9BQU8sS0FBSyxNQUFNLFdBQVcsRUFBRSxTQUFTLEdBQUc7QUFDakUscUJBQWEsS0FBSyw0QkFBNEI7QUFDOUMsbUJBQVcsQ0FBQyxLQUFLLEtBQUssS0FBSyxPQUFPLFFBQVEsTUFBTSxXQUFXLEdBQUc7QUFFMUQsZ0JBQU0saUJBQWlCLE9BQU8sVUFBVSxXQUFXLEtBQUssVUFBVSxLQUFLLElBQUk7QUFDM0UsdUJBQWEsS0FBSyxLQUFLLEdBQUcsS0FBSyxjQUFjLEVBQUU7QUFBQSxRQUNuRDtBQUFBLE1BQ0o7QUFHQSxVQUFJLGdCQUFnQjtBQUNoQixjQUFNLFVBQVUsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLElBQUk7QUFDOUMsWUFBSSxTQUFTO0FBQ1QsZ0JBQU0sUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUdoQyxjQUFJLG9CQUFvQjtBQUN4QixjQUFJLE1BQU0sQ0FBQyxNQUFNLE9BQU87QUFDcEIscUJBQVMsSUFBSSxHQUFHLElBQUksTUFBTSxRQUFRLEtBQUs7QUFDbkMsa0JBQUksTUFBTSxDQUFDLE1BQU0sT0FBTztBQUNwQixvQ0FBb0IsSUFBSTtBQUN4QjtBQUFBLGNBQ0o7QUFBQSxZQUNKO0FBQUEsVUFDSjtBQUVBLGdCQUFNLGVBQWUsTUFBTSxNQUFNLGlCQUFpQjtBQUNsRCxnQkFBTSxtQkFBbUIsYUFBYSxNQUFNLEdBQUcsUUFBUSxFQUFFLEtBQUssSUFBSTtBQUNsRSxnQkFBTSxlQUFlLGFBQWEsU0FBUztBQUUzQyx1QkFBYSxLQUFLLGdCQUFnQjtBQUNsQyx1QkFBYSxLQUFLLGdCQUFnQjtBQUNsQyxjQUFJLGNBQWM7QUFDZCx5QkFBYSxLQUFLLG1DQUFtQztBQUFBLFVBQ3pEO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFFQSxhQUFPLGFBQWEsS0FBSyxJQUFJO0FBQUEsSUFDakMsU0FBUyxPQUFPO0FBRVosYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLG1CQUFtQixRQUFtRDtBQUNoRixRQUFJO0FBQ0EsWUFBTSxFQUFFLE1BQU0sU0FBUyxJQUFJO0FBRzNCLFVBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLEtBQUssSUFBSSxHQUFHO0FBRTNELGVBQU87QUFBQSxNQUNYO0FBRUEsVUFBSSxVQUFVO0FBRVYsY0FBTSxRQUFRLEtBQUssSUFBSSxjQUFjLGFBQWEsSUFBSTtBQUN0RCxhQUFJLCtCQUFPLGdCQUFlLE1BQU0sWUFBWSxRQUFRLEdBQUc7QUFDbkQsaUJBQU8sTUFBTSxLQUFLLFFBQVEsTUFBTSxRQUFRO0FBQUEsRUFBSyxNQUFNLFlBQVksUUFBUSxDQUFDO0FBQUEsUUFDNUU7QUFDQSxlQUFPO0FBQUEsTUFDWCxPQUFPO0FBRUgsZUFBTyxLQUFLLHVCQUF1QixJQUFJO0FBQUEsTUFDM0M7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUVaLGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsU0FBUyxZQUFrQztBQUUvQyxRQUFJLE9BQU8sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFVBQVU7QUFFMUQsUUFBSSxDQUFDLFFBQVEsRUFBRSxnQkFBZ0Isd0JBQVE7QUFFbkMsYUFBTyxLQUFLLElBQUksTUFBTSxzQkFBc0IsYUFBYSxLQUFLO0FBQUEsSUFDbEU7QUFFQSxRQUFJLENBQUMsUUFBUSxFQUFFLGdCQUFnQix3QkFBUTtBQUVuQyxZQUFNLFFBQVEsS0FBSyxJQUFJLE1BQU0saUJBQWlCO0FBQzlDLGFBQU8sTUFBTTtBQUFBLFFBQUssT0FDZCxFQUFFLGFBQWEsY0FDZixFQUFFLFNBQVMsY0FDWCxFQUFFLEtBQUssU0FBUyxNQUFNLFVBQVUsS0FDaEMsRUFBRSxLQUFLLFNBQVMsTUFBTSxhQUFhLEtBQUs7QUFBQSxNQUM1QyxLQUFLO0FBQUEsSUFDVDtBQUVBLFdBQU8sZ0JBQWdCLHdCQUFRLE9BQU87QUFBQSxFQUMxQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQXVCLFVBQXdCO0FBQzNDLFNBQUssa0JBQWtCLE9BQU8sUUFBUTtBQUFBLEVBQzFDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBcUIsVUFBdUM7QUFDeEQsV0FBTyxLQUFLLGtCQUFrQixJQUFJLFFBQVEsS0FBSyxDQUFDO0FBQUEsRUFDcEQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUFvQixVQUFrQixhQUEyQjtBQUM3RCxVQUFNLFVBQVUsS0FBSyxrQkFBa0IsSUFBSSxRQUFRLEtBQUssQ0FBQztBQUN6RCxVQUFNLFdBQVcsUUFBUSxPQUFPLFNBQU8sSUFBSSxLQUFLLFNBQVMsV0FBVztBQUVwRSxRQUFJLFNBQVMsU0FBUyxHQUFHO0FBQ3JCLFdBQUssa0JBQWtCLElBQUksVUFBVSxRQUFRO0FBQUEsSUFDakQsT0FBTztBQUNILFdBQUssa0JBQWtCLE9BQU8sUUFBUTtBQUFBLElBQzFDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZUFBZSxNQUFzQjtBQUV6QyxXQUFPLEtBQUssS0FBSyxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQ3BDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBcUIsU0FJbkI7QUFDRSxVQUFNLFdBQVcsUUFBUSxlQUFlO0FBQ3hDLFVBQU0sYUFBYSxLQUFLLE1BQU8sUUFBUSxhQUFhLEtBQUssY0FBZSxHQUFHO0FBRTNFLFFBQUksWUFBWTtBQUNoQixRQUFJLFVBQVUsWUFBWSxRQUFRLFlBQVksYUFBYSxJQUFJLE1BQU0sRUFBRSxNQUFNLFFBQVEsVUFBVTtBQUUvRixRQUFJLFFBQVEsYUFBYTtBQUNyQixtQkFBYTtBQUNiLGlCQUFXO0FBQUEsSUFDZjtBQUVBLFVBQU0sT0FBTyxHQUFHLFFBQVEsU0FBUyxVQUFVO0FBRTNDLFdBQU8sRUFBRSxNQUFNLFdBQVcsUUFBUTtBQUFBLEVBQ3RDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx3QkFBd0IsU0FBb0M7QUFDeEQsVUFBTSxRQUFrQixDQUFDO0FBR3pCLGVBQVcsT0FBTyxRQUFRLGdCQUFnQjtBQUN0QyxZQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssUUFBUSxHQUFHLElBQUksV0FBVyxJQUFJLElBQUksUUFBUSxLQUFLLEVBQUUsRUFBRTtBQUFBLElBQzlFO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFDSjs7O0FDMVdPLFNBQVMsbUJBQW1CLGNBQXNCLFVBQW1DO0FBaEI1RjtBQWlCQyxVQUFRLGNBQWM7QUFBQSxJQUNyQixLQUFLO0FBQ0osYUFBTztBQUFBLFFBQ04sRUFBRSxPQUFPLDBCQUEwQixPQUFPLGdCQUFnQjtBQUFBLFFBQzFELEVBQUUsT0FBTyw0QkFBNEIsT0FBTyxrQkFBa0I7QUFBQSxRQUM5RCxFQUFFLE9BQU8sNEJBQTRCLE9BQU8sb0JBQW9CO0FBQUEsUUFDaEUsRUFBRSxPQUFPLDRCQUE0QixPQUFPLG9CQUFvQjtBQUFBLFFBQ2hFLEVBQUUsT0FBTyw4QkFBOEIsT0FBTyw2QkFBNkI7QUFBQSxRQUMzRSxFQUFFLE9BQU8sMkJBQTJCLE9BQU8sbUJBQW1CO0FBQUEsTUFDL0Q7QUFBQSxJQUNELEtBQUs7QUFDSixhQUFPO0FBQUEsUUFDTixFQUFFLE9BQU8sc0JBQXNCLE9BQU8sVUFBVTtBQUFBLFFBQ2hELEVBQUUsT0FBTywyQkFBMkIsT0FBTyxlQUFlO0FBQUEsUUFDMUQsRUFBRSxPQUFPLDJCQUEyQixPQUFPLGVBQWU7QUFBQSxRQUMxRCxFQUFFLE9BQU8sVUFBVSxPQUFPLFNBQVM7QUFBQSxRQUNuQyxFQUFFLE9BQU8sZUFBZSxPQUFPLGNBQWM7QUFBQSxNQUM5QztBQUFBLElBQ0QsS0FBSztBQUNKLGFBQU87QUFBQSxRQUNOLEVBQUUsT0FBTyxrQ0FBa0MsT0FBTyxtQkFBbUI7QUFBQSxRQUNyRSxFQUFFLE9BQU8sZ0NBQWdDLE9BQU8saUJBQWlCO0FBQUEsUUFDakUsRUFBRSxPQUFPLG9CQUFvQixPQUFPLG1CQUFtQjtBQUFBLFFBQ3ZELEVBQUUsT0FBTyx5QkFBeUIsT0FBTyx3QkFBd0I7QUFBQSxNQUNsRTtBQUFBLElBQ0QsS0FBSztBQUVKLFlBQU0sZUFBYyxnREFBVSxnQkFBVixtQkFBdUIsV0FBdkIsbUJBQStCO0FBQ25ELFVBQUksZUFBZSxZQUFZLEtBQUssR0FBRztBQUN0QyxlQUFPLENBQUMsRUFBRSxPQUFPLGFBQWEsT0FBTyxZQUFZLENBQUM7QUFBQSxNQUNuRDtBQUNBLGFBQU8sQ0FBQztBQUFBLElBQ1Q7QUFDQyxhQUFPLENBQUM7QUFBQSxFQUNWO0FBQ0Q7OztBQ3BEQSxJQUFBQyxtQkFBNkQ7OztBQ2F0RCxJQUFNLDJCQUFOLE1BQStCO0FBQUEsRUFXbEMsWUFBWSxLQUFVLFVBQStCLFdBQXlCO0FBUDlFLFNBQVEsa0JBQXNDO0FBQzlDLFNBQVEsY0FBb0MsQ0FBQztBQUM3QyxTQUFRLGdCQUF3QjtBQUNoQyxTQUFRLFlBQXFCO0FBQzdCLFNBQVEsZUFBdUI7QUFDL0IsU0FBUSxvQkFBNEI7QUFHaEMsU0FBSyxNQUFNO0FBQ1gsU0FBSyxXQUFXO0FBQ2hCLFNBQUssWUFBWSxhQUFhLFNBQVM7QUFDdkMsU0FBSyxvQkFBb0I7QUFBQSxFQUM3QjtBQUFBLEVBRVEsc0JBQTRCO0FBQ2hDLFNBQUssU0FBUyxpQkFBaUIsU0FBUyxLQUFLLFlBQVksS0FBSyxJQUFJLENBQUM7QUFDbkUsU0FBSyxTQUFTLGlCQUFpQixXQUFXLEtBQUssY0FBYyxLQUFLLElBQUksQ0FBQztBQUd2RSxTQUFLLFNBQVMsaUJBQWlCLFFBQVEsTUFBTTtBQUV6QyxpQkFBVyxNQUFNLEtBQUssZ0JBQWdCLEdBQUcsR0FBRztBQUFBLElBQ2hELENBQUM7QUFHRCxhQUFTLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUN0QyxVQUFJLEtBQUssbUJBQW1CLENBQUMsS0FBSyxnQkFBZ0IsU0FBUyxFQUFFLE1BQWMsS0FBSyxFQUFFLFdBQVcsS0FBSyxVQUFVO0FBQ3hHLGFBQUssZ0JBQWdCO0FBQUEsTUFDekI7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFUSxjQUFvQjtBQUN4QixVQUFNLE9BQU8sS0FBSyxTQUFTO0FBQzNCLFVBQU0sWUFBWSxLQUFLLFNBQVM7QUFHaEMsVUFBTSxlQUFlLEtBQUssVUFBVSxHQUFHLFNBQVM7QUFDaEQsVUFBTSxZQUFZLGFBQWEsTUFBTSxxQkFBcUI7QUFFMUQsUUFBSSxXQUFXO0FBQ1gsV0FBSyxlQUFlLFVBQVUsQ0FBQyxLQUFLO0FBQ3BDLFdBQUssb0JBQW9CLFlBQVksVUFBVSxDQUFDLEVBQUU7QUFDbEQsV0FBSyxnQkFBZ0I7QUFBQSxJQUN6QixPQUFPO0FBQ0gsV0FBSyxnQkFBZ0I7QUFBQSxJQUN6QjtBQUFBLEVBQ0o7QUFBQSxFQUVRLGNBQWMsR0FBd0I7QUFDMUMsUUFBSSxDQUFDLEtBQUssVUFBVztBQUVyQixZQUFRLEVBQUUsS0FBSztBQUFBLE1BQ1gsS0FBSztBQUNELFVBQUUsZUFBZTtBQUNqQixhQUFLLGdCQUFnQixLQUFLLElBQUksS0FBSyxnQkFBZ0IsR0FBRyxLQUFLLFlBQVksU0FBUyxDQUFDO0FBQ2pGLGFBQUssZ0JBQWdCO0FBQ3JCO0FBQUEsTUFFSixLQUFLO0FBQ0QsVUFBRSxlQUFlO0FBQ2pCLGFBQUssZ0JBQWdCLEtBQUssSUFBSSxLQUFLLGdCQUFnQixHQUFHLEVBQUU7QUFDeEQsYUFBSyxnQkFBZ0I7QUFDckI7QUFBQSxNQUVKLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFDRCxZQUFJLEtBQUssaUJBQWlCLEdBQUc7QUFDekIsWUFBRSxlQUFlO0FBQ2pCLGVBQUssaUJBQWlCLEtBQUssWUFBWSxLQUFLLGFBQWEsQ0FBQztBQUFBLFFBQzlEO0FBQ0E7QUFBQSxNQUVKLEtBQUs7QUFDRCxVQUFFLGVBQWU7QUFDakIsYUFBSyxnQkFBZ0I7QUFDckI7QUFBQSxJQUNSO0FBQUEsRUFDSjtBQUFBLEVBRVEsa0JBQXdCO0FBQzVCLFNBQUssY0FBYyxLQUFLLGVBQWUsS0FBSyxZQUFZO0FBRXhELFFBQUksS0FBSyxZQUFZLFdBQVcsR0FBRztBQUMvQixXQUFLLGdCQUFnQjtBQUNyQjtBQUFBLElBQ0o7QUFFQSxRQUFJLENBQUMsS0FBSyxpQkFBaUI7QUFDdkIsV0FBSyxzQkFBc0I7QUFBQSxJQUMvQjtBQUVBLFNBQUssa0JBQWtCO0FBQ3ZCLFNBQUssY0FBYztBQUNuQixTQUFLLFlBQVk7QUFDakIsU0FBSyxnQkFBZ0I7QUFBQSxFQUN6QjtBQUFBLEVBRVEsa0JBQXdCO0FBQzVCLFFBQUksS0FBSyxpQkFBaUI7QUFDdEIsV0FBSyxnQkFBZ0IsTUFBTSxVQUFVO0FBQUEsSUFDekM7QUFDQSxTQUFLLFlBQVk7QUFDakIsU0FBSyxnQkFBZ0I7QUFBQSxFQUN6QjtBQUFBLEVBRVEsd0JBQThCO0FBQ2xDLFNBQUssa0JBQWtCLFNBQVMsY0FBYyxLQUFLO0FBQ25ELFNBQUssZ0JBQWdCLFlBQVk7QUFDakMsU0FBSyxnQkFBZ0IsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlCckMsU0FBSyxVQUFVLFlBQVksS0FBSyxlQUFlO0FBQUEsRUFDbkQ7QUFBQSxFQUVRLG9CQUEwQjtBQUM5QixRQUFJLENBQUMsS0FBSyxnQkFBaUI7QUFFM0IsU0FBSyxnQkFBZ0IsWUFBWTtBQUVqQyxTQUFLLFlBQVksUUFBUSxDQUFDLFlBQVksVUFBVTtBQUM1QyxZQUFNLE9BQU8sU0FBUyxjQUFjLEtBQUs7QUFDekMsV0FBSyxZQUFZO0FBQ2pCLFdBQUssTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVFyQixZQUFNLFNBQVMsU0FBUyxjQUFjLEtBQUs7QUFDM0MsYUFBTyxZQUFZO0FBQ25CLGFBQU8sY0FBYyxXQUFXLEtBQUs7QUFDckMsYUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUt2QixXQUFLLFlBQVksTUFBTTtBQUd2QixZQUFNLFNBQVMsU0FBUyxjQUFjLEtBQUs7QUFDM0MsYUFBTyxZQUFZO0FBQ25CLGFBQU8sY0FBYyx1QkFBdUIsV0FBVyxLQUFLLEtBQUssU0FBUyxHQUFHLElBQUksV0FBVyxLQUFLLEtBQUssVUFBVSxHQUFHLFdBQVcsS0FBSyxLQUFLLFlBQVksR0FBRyxDQUFDLElBQUksTUFBTTtBQUNsSyxhQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBS3ZCLFdBQUssWUFBWSxNQUFNO0FBR3ZCLFlBQU0sWUFBWSxTQUFTLGNBQWMsS0FBSztBQUM5QyxnQkFBVSxZQUFZO0FBQ3RCLFdBQUssZUFBZSxXQUFXLElBQUksRUFBRSxLQUFLLGFBQVc7QUFDakQsa0JBQVUsY0FBYyxZQUFZLE9BQU87QUFBQSxNQUMvQyxDQUFDO0FBQ0QsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFLMUIsV0FBSyxZQUFZLFNBQVM7QUFFMUIsV0FBSyxnQkFBaUIsWUFBWSxJQUFJO0FBRXRDLFdBQUssaUJBQWlCLFNBQVMsTUFBTTtBQUNqQyxhQUFLLGlCQUFpQixVQUFVO0FBQUEsTUFDcEMsQ0FBQztBQUVELFdBQUssaUJBQWlCLGNBQWMsTUFBTTtBQUN0QyxhQUFLLGdCQUFnQjtBQUNyQixhQUFLLGdCQUFnQjtBQUFBLE1BQ3pCLENBQUM7QUFBQSxJQUNMLENBQUM7QUFFRCxTQUFLLGdCQUFnQixNQUFNLFVBQVU7QUFBQSxFQUN6QztBQUFBLEVBRVEsa0JBQXdCO0FBQzVCLFFBQUksQ0FBQyxLQUFLLGdCQUFpQjtBQUUzQixVQUFNLFFBQVEsS0FBSyxnQkFBZ0IsaUJBQWlCLHVCQUF1QjtBQUMzRSxVQUFNLFFBQVEsQ0FBQyxNQUFNLFVBQVU7QUFDM0IsWUFBTSxVQUFVO0FBQ2hCLFVBQUksVUFBVSxLQUFLLGVBQWU7QUFDOUIsZ0JBQVEsTUFBTSxrQkFBa0I7QUFBQSxNQUNwQyxPQUFPO0FBQ0gsZ0JBQVEsTUFBTSxrQkFBa0I7QUFBQSxNQUNwQztBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVRLGdCQUFzQjtBQUMxQixRQUFJLENBQUMsS0FBSyxnQkFBaUI7QUFHM0IsU0FBSyxnQkFBZ0IsTUFBTSxXQUFXO0FBQ3RDLFNBQUssZ0JBQWdCLE1BQU0sT0FBTztBQUNsQyxTQUFLLGdCQUFnQixNQUFNLFFBQVE7QUFDbkMsU0FBSyxnQkFBZ0IsTUFBTSxTQUFTO0FBQ3BDLFNBQUssZ0JBQWdCLE1BQU0sZUFBZTtBQUFBLEVBQzlDO0FBQUEsRUFFUSxpQkFBaUIsWUFBc0M7QUFDM0QsVUFBTSxPQUFPLEtBQUssU0FBUztBQUMzQixVQUFNLFlBQVksS0FBSyxTQUFTO0FBR2hDLFVBQU0sZUFBZSxLQUFLLFVBQVUsR0FBRyxTQUFTO0FBQ2hELFVBQU0sWUFBWSxhQUFhLE1BQU0scUJBQXFCO0FBRTFELFFBQUksQ0FBQyxVQUFXO0FBRWhCLFVBQU0sZUFBZSxDQUFDLENBQUMsVUFBVSxDQUFDO0FBQ2xDLFVBQU0sV0FBVyxZQUFZLFVBQVUsQ0FBQyxFQUFFO0FBRzFDLFVBQU0sV0FBVyxLQUFLLFdBQVcsS0FBSyxRQUFRO0FBQzlDLFVBQU0sY0FBYyxlQUFlLElBQUksUUFBUSxLQUFLO0FBR3BELFVBQU0sVUFBVSxLQUFLLFVBQVUsR0FBRyxRQUFRLElBQUksY0FBYyxLQUFLLFVBQVUsU0FBUztBQUNwRixTQUFLLFNBQVMsUUFBUTtBQUd0QixVQUFNLGVBQWUsV0FBVyxZQUFZO0FBQzVDLFNBQUssU0FBUyxrQkFBa0IsY0FBYyxZQUFZO0FBRzFELFNBQUssU0FBUyxjQUFjLElBQUksTUFBTSxTQUFTLEVBQUUsU0FBUyxLQUFLLENBQUMsQ0FBQztBQUVqRSxTQUFLLGdCQUFnQjtBQUNyQixTQUFLLFNBQVMsTUFBTTtBQUFBLEVBQ3hCO0FBQUEsRUFFUSxlQUFlLE9BQXFDO0FBQ3hELFVBQU0sUUFBUSxLQUFLLElBQUksTUFBTSxpQkFBaUI7QUFDOUMsVUFBTSxjQUFvQyxDQUFDO0FBRTNDLGVBQVcsUUFBUSxPQUFPO0FBQ3RCLFlBQU0sUUFBUSxLQUFLLFVBQVUsTUFBTSxLQUFLO0FBQ3hDLFVBQUksUUFBUSxHQUFHO0FBQ1gsb0JBQVksS0FBSztBQUFBLFVBQ2I7QUFBQSxVQUNBLGFBQWEsS0FBSztBQUFBLFVBQ2xCO0FBQUEsUUFDSixDQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0o7QUFHQSxXQUFPLFlBQ0YsS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQ2hDLE1BQU0sR0FBRyxDQUFDO0FBQUEsRUFDbkI7QUFBQSxFQUVRLFVBQVUsTUFBYSxPQUF1QjtBQUNsRCxRQUFJLENBQUMsTUFBTyxRQUFPO0FBRW5CLFVBQU0sV0FBVyxLQUFLLFNBQVMsWUFBWTtBQUMzQyxVQUFNLE9BQU8sS0FBSyxLQUFLLFlBQVk7QUFDbkMsVUFBTSxhQUFhLE1BQU0sWUFBWTtBQUdyQyxRQUFJLGFBQWEsV0FBWSxRQUFPO0FBR3BDLFFBQUksU0FBUyxXQUFXLFVBQVUsRUFBRyxRQUFPO0FBRzVDLFFBQUksU0FBUyxTQUFTLFVBQVUsRUFBRyxRQUFPO0FBRzFDLFFBQUksS0FBSyxTQUFTLFVBQVUsRUFBRyxRQUFPO0FBR3RDLFFBQUksS0FBSyxXQUFXLFVBQVUsVUFBVSxFQUFHLFFBQU87QUFFbEQsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVRLFdBQVcsTUFBYyxPQUF3QjtBQUNyRCxRQUFJLFlBQVk7QUFDaEIsUUFBSSxhQUFhO0FBRWpCLFdBQU8sWUFBWSxLQUFLLFVBQVUsYUFBYSxNQUFNLFFBQVE7QUFDekQsVUFBSSxLQUFLLFNBQVMsTUFBTSxNQUFNLFVBQVUsR0FBRztBQUN2QztBQUFBLE1BQ0o7QUFDQTtBQUFBLElBQ0o7QUFFQSxXQUFPLGVBQWUsTUFBTTtBQUFBLEVBQ2hDO0FBQUEsRUFFQSxNQUFjLGVBQWUsTUFBOEI7QUFDdkQsUUFBSTtBQUNBLFlBQU0sVUFBVSxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssSUFBSTtBQUc5QyxVQUFJLGNBQWM7QUFDbEIsVUFBSSxRQUFRLFdBQVcsS0FBSyxHQUFHO0FBQzNCLGNBQU0saUJBQWlCLFFBQVEsUUFBUSxPQUFPLENBQUM7QUFDL0MsWUFBSSxtQkFBbUIsSUFBSTtBQUN2Qix3QkFBYyxRQUFRLFVBQVUsaUJBQWlCLENBQUM7QUFBQSxRQUN0RDtBQUFBLE1BQ0o7QUFHQSxZQUFNLFlBQVksWUFDYixRQUFRLFVBQVUsRUFBRSxFQUNwQixRQUFRLGtCQUFrQixJQUFJLEVBQzlCLFFBQVEsY0FBYyxJQUFJLEVBQzFCLFFBQVEscUJBQXFCLElBQUksRUFDakMsUUFBUSxPQUFPLEdBQUcsRUFDbEIsS0FBSztBQUVWLGFBQU8sVUFBVSxTQUFTLEtBQUssVUFBVSxVQUFVLEdBQUcsRUFBRSxJQUFJLFFBQVEsYUFBYTtBQUFBLElBQ3JGLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixRQUFJLEtBQUssaUJBQWlCO0FBQ3RCLFdBQUssZ0JBQWdCLE9BQU87QUFBQSxJQUNoQztBQUFBLEVBQ0o7QUFDSjs7O0FEaFdPLElBQU0sZ0JBQU4sTUFBTSxjQUFhO0FBQUEsRUFlekIsWUFDQyxRQUNBLFdBQ0EsZ0JBQ0M7QUFORjtBQUFBLFNBQVEsaUJBQXVGLENBQUM7QUFPL0YsU0FBSyxTQUFTO0FBQ2QsU0FBSyxZQUFZO0FBQ2pCLFNBQUssaUJBQWlCO0FBQUEsRUFDdkI7QUFBQSxFQUVBLGlCQUFpQixlQUFvQztBQUNwRCxTQUFLLGdCQUFnQjtBQUlyQixVQUFNLGVBQWUsS0FBSyxXQUFXO0FBQ3JDLGlCQUFhLE9BQU87QUFHcEIsU0FBSyxjQUFjLG9CQUFvQixLQUFLLFFBQVE7QUFHcEQsU0FBSyxTQUFTLFlBQVksWUFBWTtBQUd0QyxTQUFLLGNBQWMsK0JBQStCLEtBQUssUUFBUTtBQUFBLEVBQ2hFO0FBQUEsRUFFQSxjQUFpQztBQUNoQyxXQUFPLEtBQUs7QUFBQSxFQUNiO0FBQUEsRUFFQSxxQkFBcUIsZUFBa0M7QUFDdEQsU0FBSyxZQUFZLEtBQUssVUFBVSxVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUN6RSxTQUFLLFVBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU8vQixTQUFLLFdBQVcsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQ2xFLFNBQUssU0FBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUTlCLFVBQU0sb0JBQW9CLEtBQUssU0FBUyxVQUFVO0FBQ2xELHNCQUFrQixNQUFNLFVBQVU7QUFHbEMsU0FBSyxXQUFXLElBQUksbUNBQWtCLGlCQUFpQjtBQUN2RCxTQUFLLFNBQVMsZUFBZSxpREFBaUQ7QUFDOUUsU0FBSyxTQUFTLFFBQVEsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBa0J0QyxTQUFLLG1CQUFtQixNQUFNO0FBQzdCLFlBQU0sV0FBVyxLQUFLLFNBQVM7QUFDL0IsZUFBUyxNQUFNLFNBQVM7QUFDeEIsZUFBUyxNQUFNLFNBQVMsS0FBSyxJQUFJLFNBQVMsY0FBYyxHQUFHLElBQUk7QUFBQSxJQUNoRTtBQUdBLFNBQUssaUJBQWlCLEtBQUssU0FBUyxTQUFTLFNBQVMsS0FBSyxnQkFBZ0I7QUFHM0UsZUFBVyxLQUFLLGtCQUFrQixDQUFDO0FBR25DLFNBQUssdUJBQXVCLElBQUkseUJBQXlCLEtBQUssT0FBTyxLQUFLLEtBQUssU0FBUyxTQUFTLEtBQUssUUFBUTtBQUk5RyxTQUFLLGlCQUFpQixLQUFLLFNBQVMsU0FBUyxTQUFTLE1BQU07QUFDM0QsV0FBSyxlQUFlLHlCQUF5QixLQUFLLFNBQVMsU0FBUyxDQUFDO0FBQUEsSUFDdEUsQ0FBQztBQUtELFNBQUssYUFBYSxJQUFJLGlDQUFnQixLQUFLLFFBQVE7QUFDbkQsU0FBSyxXQUFXLFFBQVEsTUFBTTtBQUM5QixTQUFLLFdBQVcsV0FBVyxjQUFjO0FBQ3pDLFNBQUssV0FBVyxRQUFRLE1BQU0sS0FBSyxXQUFXLENBQUM7QUFDL0MsU0FBSyxXQUFXLFNBQVMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZXpDLFNBQUssaUJBQWlCLEtBQUssU0FBUyxTQUFTLFdBQVcsQ0FBQyxVQUFpQjtBQTdJNUU7QUE4SUcsWUFBTSxXQUFXO0FBRWpCLFVBQUksU0FBUyxRQUFRLFdBQVcsQ0FBQyxTQUFTLFVBQVU7QUFDbkQsY0FBTSxlQUFlO0FBQ3JCLFVBQUMsVUFBSyxrQkFBTCxtQkFBb0IsbUNBQWtDLFNBQVUsS0FBSyxXQUFXO0FBQUEsTUFDbEYsV0FBVyxTQUFTLFFBQVEsVUFBVTtBQUNyQyxtQkFBSyxrQkFBTCxtQkFBb0I7QUFBQSxNQUNyQixXQUFXLFNBQVMsUUFBUSxhQUFhLFNBQVMsUUFBUSxhQUFhO0FBQ3RFLGFBQUksVUFBSyxrQkFBTCxtQkFBb0IsOEJBQThCLFNBQVMsTUFBTTtBQUNwRSxnQkFBTSxlQUFlO0FBQUEsUUFDdEI7QUFBQSxNQUNELFdBQVcsU0FBUyxRQUFRLE9BQU87QUFDbEMsYUFBSSxVQUFLLGtCQUFMLG1CQUFvQiw4QkFBOEIsU0FBUyxNQUFNO0FBQ3BFLGdCQUFNLGVBQWU7QUFBQSxRQUN0QjtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLGlCQUFpQixLQUFLLFNBQVMsU0FBUyxTQUFTLE1BQU07QUFDM0QsVUFBSSxLQUFLLGVBQWU7QUFDdkIsYUFBSyxjQUFjLGtCQUFrQjtBQUFBLE1BQ3RDO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRUEsUUFBYztBQUNiLGVBQVcsTUFBTTtBQXpLbkI7QUEwS0csV0FBSSxVQUFLLGFBQUwsbUJBQWUsU0FBUztBQUMzQixhQUFLLFNBQVMsUUFBUSxNQUFNO0FBQUEsTUFDN0I7QUFBQSxJQUNELEdBQUcsY0FBYSxjQUFjO0FBQUEsRUFDL0I7QUFBQSxFQUVRLGFBQW1CO0FBaEw1QjtBQWlMRSxVQUFNLFVBQVUsS0FBSyxTQUFTLFNBQVMsRUFBRSxLQUFLO0FBQzlDLFFBQUksQ0FBQyxRQUFTO0FBR2QsU0FBSyxTQUFTLFNBQVMsRUFBRTtBQUN6QixTQUFLLGlCQUFpQjtBQUN0QixTQUFLLGVBQWUsbUJBQW1CO0FBSXZDLGVBQUssa0JBQUwsOEJBQXFCO0FBQUEsRUFDdEI7QUFBQSxFQUlBLGlCQUFpQixVQUEyQztBQUMzRCxTQUFLLGdCQUFnQjtBQUFBLEVBQ3RCO0FBQUEsRUFFQSxXQUFtQjtBQUNsQixXQUFPLEtBQUssU0FBUyxTQUFTO0FBQUEsRUFDL0I7QUFBQSxFQUVBLFNBQVMsT0FBcUI7QUFDN0IsU0FBSyxTQUFTLFNBQVMsS0FBSztBQUM1QixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxXQUFXLE1BQW9CO0FBQzlCLFVBQU0sZUFBZSxLQUFLLFNBQVMsU0FBUztBQUM1QyxVQUFNLFdBQVcsS0FBSyxTQUFTO0FBQy9CLFVBQU0sUUFBUSxTQUFTO0FBQ3ZCLFVBQU0sTUFBTSxTQUFTO0FBRXJCLFVBQU0sV0FBVyxhQUFhLE1BQU0sR0FBRyxLQUFLLElBQUksT0FBTyxhQUFhLE1BQU0sR0FBRztBQUM3RSxTQUFLLFNBQVMsU0FBUyxRQUFRO0FBRy9CLFVBQU0sY0FBYyxRQUFRLEtBQUs7QUFDakMsZUFBVyxNQUFNO0FBQ2hCLGVBQVMsa0JBQWtCLGFBQWEsV0FBVztBQUNuRCxlQUFTLE1BQU07QUFBQSxJQUNoQixHQUFHLENBQUM7QUFFSixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxxQkFBcUIsY0FBc0IsY0FBc0IsSUFBVTtBQUMxRSxVQUFNLGVBQWUsS0FBSyxTQUFTLFNBQVM7QUFDNUMsVUFBTSxXQUFXLEtBQUssU0FBUztBQUMvQixVQUFNLFFBQVEsU0FBUztBQUN2QixVQUFNLE1BQU0sU0FBUztBQUVyQixVQUFNLFdBQVcsYUFBYSxNQUFNLEdBQUcsS0FBSyxJQUFJLGVBQWUsY0FBYyxhQUFhLE1BQU0sR0FBRztBQUNuRyxTQUFLLFNBQVMsU0FBUyxRQUFRO0FBRy9CLFVBQU0saUJBQWlCLFFBQVEsYUFBYTtBQUM1QyxlQUFXLE1BQU07QUFDaEIsZUFBUyxrQkFBa0IsZ0JBQWdCLGNBQWM7QUFDekQsZUFBUyxNQUFNO0FBQUEsSUFDaEIsR0FBRyxDQUFDO0FBRUosU0FBSyxpQkFBaUI7QUFBQSxFQUN2QjtBQUFBLEVBRVEsaUJBQWlCLFNBQXNCLE9BQWUsU0FBOEI7QUFDM0YsWUFBUSxpQkFBaUIsT0FBTyxPQUFPO0FBQ3ZDLFNBQUssZUFBZSxLQUFLLEVBQUUsU0FBUyxPQUFPLFFBQVEsQ0FBQztBQUFBLEVBQ3JEO0FBQUEsRUFHQSx1QkFBNkI7QUFDNUIsUUFBSSxLQUFLLGVBQWU7QUFDdkIsV0FBSyxjQUFjLDhCQUE4QjtBQUFBLElBQ2xEO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBZ0I7QUFFZixRQUFJLEtBQUssc0JBQXNCO0FBQzlCLFdBQUsscUJBQXFCLFFBQVE7QUFBQSxJQUNuQztBQUlBLFNBQUssZUFBZSxRQUFRLENBQUMsRUFBRSxTQUFTLE9BQU8sUUFBUSxNQUFNO0FBQzVELGNBQVEsb0JBQW9CLE9BQU8sT0FBTztBQUFBLElBQzNDLENBQUM7QUFDRCxTQUFLLGlCQUFpQixDQUFDO0FBQUEsRUFDeEI7QUFDRDtBQW5RYSxjQVVZLGlCQUFpQjtBQVZuQyxJQUFNLGVBQU47OztBRVRQLElBQUFDLG1CQUFtRDtBQWlCNUMsSUFBTSxnQkFBTixNQUFvQjtBQUFBLEVBVzFCLFlBQVksUUFBb0IsV0FBd0IsVUFBNkI7QUFMckYsU0FBUSxxQkFBb0MsQ0FBQztBQUM3QyxTQUFRLHVCQUErQjtBQUV2QyxTQUFRLHVCQUFnQztBQUd2QyxTQUFLLFNBQVM7QUFDZCxTQUFLLFlBQVk7QUFDakIsU0FBSyxXQUFXO0FBQUEsRUFDakI7QUFBQSxFQUVBLG9CQUFvQixVQUF3QztBQUMzRCxTQUFLLGdCQUFnQixJQUFJLGlDQUFnQixRQUFRO0FBQ2pELFNBQUssY0FBYyxRQUFRLEtBQUs7QUFDaEMsU0FBSyxjQUFjLFdBQVcsVUFBVTtBQUN4QyxTQUFLLGNBQWMsUUFBUSxNQUFNLEtBQUssa0JBQWtCLENBQUM7QUFDekQsU0FBSyxjQUFjLFNBQVMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUEsY0FJaEMsS0FBSyx3QkFBd0IsSUFBSSxTQUFTLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPNUQsV0FBTyxLQUFLO0FBQUEsRUFDYjtBQUFBLEVBRUEsc0JBQTRCO0FBRTNCLFNBQUssK0JBQStCLEtBQUssU0FBUztBQUFBLEVBQ25EO0FBQUEsRUFFQSwrQkFBK0IsV0FBOEI7QUFDNUQsU0FBSyxnQkFBZ0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUN2RSxTQUFLLGNBQWMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBZXBDO0FBQUEsRUFFQSwwQkFBbUM7QUFDbEMsV0FBTyxLQUFLLE9BQU8sU0FBUyxxQkFBcUIsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLFVBQVU7QUFBQSxFQUN4RztBQUFBLEVBRUEsZ0NBQXNDO0FBQ3JDLFFBQUksS0FBSyxlQUFlO0FBQ3ZCLFlBQU0sYUFBYSxLQUFLLHdCQUF3QjtBQUNoRCxXQUFLLGNBQWMsU0FBUyxNQUFNLFVBQVUsYUFBYSxTQUFTO0FBQUEsSUFDbkU7QUFBQSxFQUNEO0FBQUEsRUFFQSxvQkFBMEI7QUFDekIsUUFBSSxDQUFDLEtBQUssYUFBYTtBQUN0QixXQUFLLGtCQUFrQjtBQUFBLElBQ3hCO0FBRUEsUUFBSSxLQUFLLHNCQUFzQjtBQUM5QixXQUFLLGdCQUFnQjtBQUFBLElBQ3RCLE9BQU87QUFDTixXQUFLLGdCQUFnQjtBQUFBLElBQ3RCO0FBQUEsRUFDRDtBQUFBLEVBRVEsb0JBQTBCO0FBQ2pDLFNBQUssY0FBYyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDeEUsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFpQmpDLFVBQU0sV0FBVztBQUFBLE1BQ2hCLEVBQUUsTUFBTSxtQkFBbUIsYUFBYSw0QkFBNEIsU0FBUyxXQUFXO0FBQUEsTUFDeEYsRUFBRSxNQUFNLGVBQWUsYUFBYSxnQ0FBZ0MsU0FBUyxXQUFXO0FBQUEsTUFDeEYsRUFBRSxNQUFNLGFBQWEsYUFBYSw0QkFBNEIsU0FBUyxhQUFhO0FBQUEsTUFDcEYsRUFBRSxNQUFNLGdCQUFnQixhQUFhLDRCQUE0QixTQUFTLFVBQVU7QUFBQSxNQUNwRixFQUFFLE1BQU0sV0FBVyxhQUFhLDRCQUE0QixTQUFTLFdBQVc7QUFBQSxNQUNoRixFQUFFLE1BQU0sb0JBQW9CLGFBQWEsMkJBQTJCLFNBQVMsWUFBWTtBQUFBLElBQzFGO0FBRUEsVUFBTSxRQUFRLEtBQUssWUFBWSxTQUFTLE9BQU8sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3pFLFVBQU0sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU90QixhQUFTLFFBQVEsU0FBTztBQUN2QixZQUFNLFFBQVEsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ3JFLFlBQU0sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUXRCLFlBQU0sU0FBUyxNQUFNLFNBQVMsT0FBTyxFQUFFLE1BQU0sSUFBSSxLQUFLLENBQUM7QUFDdkQsYUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU12QixZQUFNLFNBQVMsTUFBTSxTQUFTLE9BQU8sRUFBRSxNQUFNLElBQUksWUFBWSxDQUFDO0FBQzlELGFBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBS3ZCLFlBQU0saUJBQWlCLFNBQVMsTUFBTTtBQUNyQyxhQUFLLFNBQVMsU0FBUyxJQUFJLFVBQVUsR0FBRztBQUN4QyxhQUFLLFNBQVMsUUFBUSxNQUFNO0FBQzVCLGFBQUssZ0JBQWdCO0FBQUEsTUFDdEIsQ0FBQztBQUVELFlBQU0saUJBQWlCLGNBQWMsTUFBTTtBQUMxQyxjQUFNLE1BQU0sYUFBYTtBQUFBLE1BQzFCLENBQUM7QUFFRCxZQUFNLGlCQUFpQixjQUFjLE1BQU07QUFDMUMsY0FBTSxNQUFNLGFBQWE7QUFBQSxNQUMxQixDQUFDO0FBQUEsSUFDRixDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsa0JBQXdCO0FBQy9CLFFBQUksS0FBSyxhQUFhO0FBQ3JCLFdBQUssWUFBWSxNQUFNLFVBQVU7QUFDakMsV0FBSyx1QkFBdUI7QUFBQSxJQUM3QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLGtCQUF3QjtBQUN2QixRQUFJLEtBQUssYUFBYTtBQUNyQixXQUFLLFlBQVksTUFBTSxVQUFVO0FBQ2pDLFdBQUssdUJBQXVCO0FBQUEsSUFDN0I7QUFBQSxFQUNEO0FBQUEsRUFFQSxvQkFBMEI7QUFDekIsUUFBSSxDQUFDLEtBQUssVUFBVTtBQUNuQjtBQUFBLElBQ0Q7QUFFQSxVQUFNLFFBQVEsS0FBSyxTQUFTLFNBQVM7QUFHckMsUUFBSSxNQUFNLFdBQVcsR0FBRyxHQUFHO0FBRTFCLFdBQUssNEJBQTRCLEtBQUs7QUFBQSxJQUN2QyxPQUFPO0FBR04sV0FBSyxrQkFBa0I7QUFBQSxJQUN4QjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1RLDRCQUE0QixPQUFxQjtBQUN4RCxRQUFJLENBQUMsS0FBSyxlQUFlO0FBQ3hCO0FBQUEsSUFDRDtBQUVBLFVBQU0scUJBQXFCLEtBQUssc0JBQXNCO0FBQ3RELFVBQU0sYUFBYSxNQUFNLE1BQU0sQ0FBQyxFQUFFLFlBQVk7QUFFOUMsVUFBTSxXQUFXLG1CQUFtQjtBQUFBLE1BQU8sU0FDMUMsSUFBSSxLQUFLLFlBQVksRUFBRSxTQUFTLFVBQVUsS0FDMUMsSUFBSSxRQUFRLFlBQVksRUFBRSxTQUFTLFVBQVUsS0FDN0MsSUFBSSxTQUFTLEtBQUssYUFBVyxRQUFRLFlBQVksRUFBRSxTQUFTLFVBQVUsQ0FBQztBQUFBLElBQ3hFO0FBRUEsU0FBSyxxQkFBcUIsQ0FBQztBQUMzQixTQUFLLGNBQWMsTUFBTTtBQUN6QixTQUFLLHVCQUF1QjtBQUU1QixRQUFJLFNBQVMsU0FBUyxHQUFHO0FBQ3hCLGVBQVMsUUFBUSxDQUFDLEtBQUssVUFBVTtBQUNoQyxjQUFNLE9BQU8sS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLDJCQUEyQixDQUFDO0FBQzdFLGFBQUssTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9yQixjQUFNLFNBQVMsS0FBSyxTQUFTLE9BQU8sRUFBRSxNQUFNLElBQUksS0FBSyxDQUFDO0FBQ3RELGVBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNdkIsY0FBTSxTQUFTLEtBQUssU0FBUyxPQUFPLEVBQUUsTUFBTSxJQUFJLFlBQVksQ0FBQztBQUM3RCxlQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXZCLGNBQU0sWUFBWSxLQUFLLFNBQVMsT0FBTyxFQUFFLE1BQU0sWUFBWSxJQUFJLE9BQU8sR0FBRyxDQUFDO0FBQzFFLGtCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTTFCLGFBQUssaUJBQWlCLFNBQVMsTUFBTTtBQUNwQyxlQUFLLHdCQUF3QixJQUFJLFFBQVE7QUFBQSxRQUMxQyxDQUFDO0FBRUQsYUFBSyxpQkFBaUIsY0FBYyxNQUFNO0FBQ3pDLGVBQUssdUJBQXVCO0FBQzVCLGVBQUssNkJBQTZCO0FBQUEsUUFDbkMsQ0FBQztBQUVELGFBQUssbUJBQW1CLEtBQUssSUFBSTtBQUFBLE1BQ2xDLENBQUM7QUFFRCxXQUFLLGNBQWMsTUFBTSxVQUFVO0FBQUEsSUFDcEMsT0FBTztBQUNOLFdBQUssa0JBQWtCO0FBQUEsSUFDeEI7QUFBQSxFQUNEO0FBQUEsRUFFQSxvQkFBMEI7QUFDekIsU0FBSyxjQUFjLE1BQU0sVUFBVTtBQUNuQyxTQUFLLHFCQUFxQixDQUFDO0FBQzNCLFNBQUssdUJBQXVCO0FBQUEsRUFDN0I7QUFBQSxFQUVBLDhCQUE4QixLQUFzQjtBQUNuRCxRQUFJLEtBQUssbUJBQW1CLFdBQVcsRUFBRyxRQUFPO0FBRWpELFFBQUksUUFBUSxhQUFhO0FBQ3hCLFdBQUssdUJBQXVCLEtBQUssSUFBSSxLQUFLLHVCQUF1QixHQUFHLEtBQUssbUJBQW1CLFNBQVMsQ0FBQztBQUN0RyxXQUFLLDZCQUE2QjtBQUNsQyxhQUFPO0FBQUEsSUFDUixXQUFXLFFBQVEsV0FBVztBQUM3QixXQUFLLHVCQUF1QixLQUFLLElBQUksS0FBSyx1QkFBdUIsR0FBRyxFQUFFO0FBQ3RFLFdBQUssNkJBQTZCO0FBQ2xDLGFBQU87QUFBQSxJQUNSLFdBQVcsUUFBUSxTQUFTLEtBQUssd0JBQXdCLEdBQUc7QUFFM0QsYUFBTyxLQUFLLDZCQUE2QjtBQUFBLElBQzFDO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLCtCQUF3QztBQUN2QyxRQUFJLEtBQUssd0JBQXdCLEtBQUssS0FBSyxtQkFBbUIsU0FBUyxHQUFHO0FBRXpFLFlBQU0sV0FBVyxLQUFLLHNCQUFzQjtBQUM1QyxZQUFNLFFBQVEsS0FBSyxTQUFTLFNBQVM7QUFDckMsVUFBSSxNQUFNLFdBQVcsR0FBRyxHQUFHO0FBQzFCLGNBQU0sYUFBYSxNQUFNLE1BQU0sQ0FBQyxFQUFFLFlBQVk7QUFDOUMsY0FBTSxXQUFXLFNBQVM7QUFBQSxVQUFPLFNBQ2hDLElBQUksS0FBSyxZQUFZLEVBQUUsU0FBUyxVQUFVLEtBQzFDLElBQUksUUFBUSxZQUFZLEVBQUUsU0FBUyxVQUFVLEtBQzdDLElBQUksU0FBUyxLQUFLLGFBQVcsUUFBUSxZQUFZLEVBQUUsU0FBUyxVQUFVLENBQUM7QUFBQSxRQUN4RTtBQUVBLFlBQUksS0FBSyx1QkFBdUIsU0FBUyxRQUFRO0FBQ2hELGdCQUFNLGNBQWMsU0FBUyxLQUFLLG9CQUFvQjtBQUN0RCxlQUFLLHdCQUF3QixZQUFZLFFBQVE7QUFDakQsaUJBQU87QUFBQSxRQUNSO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFDQSxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRVEsK0JBQXFDO0FBQzVDLFNBQUssbUJBQW1CLFFBQVEsQ0FBQyxNQUFNLFVBQVU7QUFDaEQsVUFBSSxVQUFVLEtBQUssc0JBQXNCO0FBQ3hDLGFBQUssTUFBTSxhQUFhO0FBQUEsTUFDekIsT0FBTztBQUNOLGFBQUssTUFBTSxhQUFhO0FBQUEsTUFDekI7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFUSxjQUFjLFNBQXVCO0FBQzVDLFNBQUssU0FBUyxTQUFTLFVBQVUsR0FBRztBQUNwQyxTQUFLLFNBQVMsUUFBUSxNQUFNO0FBRzVCLFVBQU0sU0FBUyxLQUFLLFNBQVMsU0FBUyxFQUFFO0FBQ3hDLFNBQUssU0FBUyxRQUFRLGtCQUFrQixRQUFRLE1BQU07QUFFdEQsU0FBSyxrQkFBa0I7QUFBQSxFQUN4QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTVEsd0JBQTZDO0FBQ3BELFdBQU87QUFBQSxNQUNOO0FBQUEsUUFDQyxNQUFNO0FBQUEsUUFDTixhQUFhO0FBQUEsUUFDYixTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixTQUFTO0FBQUEsUUFDVCxVQUFVLENBQUMsVUFBVSxPQUFPLFNBQVM7QUFBQSxNQUN0QztBQUFBLE1BQ0E7QUFBQSxRQUNDLE1BQU07QUFBQSxRQUNOLGFBQWE7QUFBQSxRQUNiLFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxRQUNWLFNBQVM7QUFBQSxRQUNULFVBQVUsQ0FBQyxVQUFVLFVBQVUsUUFBUTtBQUFBLE1BQ3hDO0FBQUEsTUFDQTtBQUFBLFFBQ0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsU0FBUztBQUFBLFFBQ1QsVUFBVTtBQUFBLFFBQ1YsU0FBUztBQUFBLFFBQ1QsVUFBVSxDQUFDLFVBQVUsV0FBVztBQUFBLE1BQ2pDO0FBQUEsTUFDQTtBQUFBLFFBQ0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsU0FBUztBQUFBLFFBQ1QsVUFBVTtBQUFBLFFBQ1YsU0FBUztBQUFBLFFBQ1QsVUFBVSxDQUFDLE9BQU8sVUFBVSxLQUFLO0FBQUEsTUFDbEM7QUFBQSxNQUNBO0FBQUEsUUFDQyxNQUFNO0FBQUEsUUFDTixhQUFhO0FBQUEsUUFDYixTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixTQUFTO0FBQUEsUUFDVCxVQUFVLENBQUMsT0FBTyxhQUFhLE9BQU87QUFBQSxNQUN2QztBQUFBLE1BQ0E7QUFBQSxRQUNDLE1BQU07QUFBQSxRQUNOLGFBQWE7QUFBQSxRQUNiLFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxRQUNWLFNBQVM7QUFBQSxRQUNULFVBQVUsQ0FBQyxPQUFPLFNBQVMsT0FBTztBQUFBLE1BQ25DO0FBQUEsTUFDQTtBQUFBLFFBQ0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsU0FBUztBQUFBLFFBQ1QsVUFBVTtBQUFBLFFBQ1YsU0FBUztBQUFBLFFBQ1QsVUFBVSxDQUFDLE9BQU8sU0FBUyxRQUFRO0FBQUEsTUFDcEM7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esd0JBQXdCLFVBQXdCO0FBQ3ZELFNBQUssa0JBQWtCO0FBR3ZCLFVBQU0sWUFBWSxTQUFTLFFBQVEsVUFBVTtBQUM3QyxRQUFJLGNBQWMsSUFBSTtBQUNyQixZQUFNLGVBQWUsU0FBUyxNQUFNLEdBQUcsU0FBUztBQUNoRCxZQUFNLGNBQWMsU0FBUyxNQUFNLFlBQVksQ0FBQztBQUNoRCxXQUFLLFNBQVMsU0FBUyxlQUFlLFdBQVc7QUFHakQsaUJBQVcsTUFBTTtBQUNoQixhQUFLLFNBQVMsUUFBUSxrQkFBa0IsV0FBVyxTQUFTO0FBQzVELGFBQUssU0FBUyxRQUFRLE1BQU07QUFBQSxNQUM3QixHQUFHLENBQUM7QUFBQSxJQUNMLE9BQU87QUFDTixXQUFLLFNBQVMsU0FBUyxRQUFRO0FBQy9CLFdBQUssU0FBUyxRQUFRLE1BQU07QUFBQSxJQUM3QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsUUFBSSxLQUFLLGFBQWE7QUFDckIsV0FBSyxZQUFZLE9BQU87QUFBQSxJQUN6QjtBQUNBLFFBQUksS0FBSyxlQUFlO0FBQ3ZCLFdBQUssY0FBYyxPQUFPO0FBQUEsSUFDM0I7QUFBQSxFQUNEO0FBQ0Q7OztBQzViQSxJQUFBQyxtQkFBNkM7QUFPdEMsSUFBTSxrQkFBTixNQUFNLGdCQUFlO0FBQUEsRUFVM0IsWUFBWSxRQUFvQixLQUFVLFdBQXdCO0FBSGxFLFNBQVEsaUJBQXlDO0FBSWhELFNBQUssU0FBUztBQUNkLFNBQUssTUFBTTtBQUNYLFNBQUssWUFBWTtBQUNqQixTQUFLLGtCQUFrQixJQUFJLHVCQUF1QixHQUFHO0FBQUEsRUFDdEQ7QUFBQSxFQUVBLHlCQUErQjtBQUM5QixTQUFLLG1CQUFtQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbEYsU0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBZXZDO0FBQUEsRUFFQSx1QkFBb0M7QUFDbkMsVUFBTSxtQkFBbUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ2pGLHFCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVWpDLFVBQU0sZUFBZSxpQkFBaUIsV0FBVyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ3RFLGlCQUFhLE1BQU0sVUFBVTtBQUU3QixVQUFNLGNBQWMsaUJBQWlCLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBQ3BGLGdCQUFZLE1BQU0sVUFBVTtBQUU1QixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEseUJBQXlCLFNBQXVCO0FBQy9DLFFBQUksQ0FBQyxLQUFLLGtCQUFrQixDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUM5RjtBQUFBLElBQ0Q7QUFFQSxRQUFJLENBQUMsU0FBUztBQUNiLFdBQUssZUFBZSxNQUFNLFVBQVU7QUFDcEM7QUFBQSxJQUNEO0FBR0EsVUFBTSxhQUFhO0FBQ25CLFVBQU0sWUFBc0QsQ0FBQztBQUM3RCxRQUFJO0FBRUosWUFBUSxRQUFRLFdBQVcsS0FBSyxPQUFPLE9BQU8sTUFBTTtBQUNuRCxZQUFNLFVBQVUsTUFBTSxDQUFDO0FBQ3ZCLFlBQU0sV0FBVyxNQUFNLENBQUM7QUFDeEIsZ0JBQVUsS0FBSyxFQUFFLE1BQU0sU0FBUyxTQUFTLENBQUM7QUFBQSxJQUMzQztBQUVBLFFBQUksVUFBVSxXQUFXLEdBQUc7QUFDM0IsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUNwQztBQUFBLElBQ0Q7QUFHQSxVQUFNLGNBQWMsS0FBSyxlQUFlLGNBQWMsNEJBQTRCO0FBQ2xGLFFBQUksYUFBYTtBQUNoQixZQUFNLFdBQVcsVUFBVTtBQUFBLFFBQUksU0FDOUIsSUFBSSxXQUFXLEdBQUcsSUFBSSxJQUFJLElBQUksSUFBSSxRQUFRLEtBQUssSUFBSTtBQUFBLE1BQ3BELEVBQUUsS0FBSyxJQUFJO0FBQ1gsa0JBQVksY0FBYztBQUFBLElBQzNCO0FBRUEsU0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLEVBQ3JDO0FBQUEsRUFFQSxNQUFNLGFBQWEsU0FBaUIsYUFBNEQ7QUF0R2pHO0FBdUdFLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsbUJBQW1CLEtBQUssQ0FBQyxhQUFhO0FBQ3RGLGFBQU87QUFBQSxJQUNSO0FBRUEsUUFBSTtBQUNILFlBQU0sU0FBUyxNQUFNLEtBQUssZ0JBQWdCLGFBQWEsU0FBUyxXQUFXO0FBQzNFLFdBQUssaUJBQWlCLE9BQU87QUFFN0IsV0FBSSxZQUFPLFlBQVAsbUJBQWdCLGVBQWUsUUFBUTtBQUMxQyxhQUFLLHVCQUF1QixPQUFPLE9BQU87QUFHMUMsWUFBSSxPQUFPLFFBQVEsYUFBYTtBQUMvQixjQUFJLHdCQUFPLHdGQUE4RSxnQkFBZSxrQkFBa0I7QUFBQSxRQUMzSDtBQUFBLE1BQ0Q7QUFFQSxhQUFPLE9BQU87QUFBQSxJQUNmLFNBQVMsT0FBTztBQUVmLGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUFBLEVBRVEsdUJBQXVCLFNBQWdDO0FBQzlELFFBQUksQ0FBQyxLQUFLLGlCQUFrQjtBQUU1QixVQUFNLFdBQVcsUUFBUSxlQUFlO0FBQ3hDLFFBQUksV0FBVyxHQUFHO0FBQ2pCLFdBQUssaUJBQWlCLGNBQWMsR0FBRyxRQUFRLE9BQU8sV0FBVyxJQUFJLE1BQU0sRUFBRTtBQUM3RSxXQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFHdEMsV0FBSyxpQkFBaUIsTUFBTSxTQUFTO0FBQ3JDLFdBQUssaUJBQWlCLFVBQVUsTUFBTTtBQUNyQyxhQUFLLG1CQUFtQixPQUFPO0FBQUEsTUFDaEM7QUFHQSxXQUFLLGlCQUFpQixpQkFBaUIsY0FBYyxNQUFNO0FBQzFELGFBQUssaUJBQWlCLE1BQU0sYUFBYTtBQUFBLE1BQzFDLENBQUM7QUFFRCxXQUFLLGlCQUFpQixpQkFBaUIsY0FBYyxNQUFNO0FBQzFELGFBQUssaUJBQWlCLE1BQU0sYUFBYTtBQUFBLE1BQzFDLENBQUM7QUFBQSxJQUNGLE9BQU87QUFDTixXQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFBQSxJQUN2QztBQUFBLEVBQ0Q7QUFBQSxFQUVRLG1CQUFtQixTQUFnQztBQUUxRCxVQUFNLFFBQVEsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3BFLFVBQU0sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWF0QixVQUFNLFVBQVUsTUFBTSxVQUFVO0FBQ2hDLFlBQVEsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBV3hCLFVBQU0sU0FBUyxRQUFRLFNBQVMsTUFBTSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDbkUsV0FBTyxNQUFNLFVBQVU7QUFFdkIsWUFBUSxlQUFlLFFBQVEsU0FBTztBQUNyQyxZQUFNLFFBQVEsUUFBUSxVQUFVO0FBQ2hDLFlBQU0sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU90QixZQUFNLFNBQVMsTUFBTSxTQUFTLE9BQU8sRUFBRSxNQUFNLElBQUksS0FBSyxTQUFTLENBQUM7QUFDaEUsYUFBTyxNQUFNLFVBQVU7QUFFdkIsVUFBSSxJQUFJLFVBQVU7QUFDakIsY0FBTSxTQUFTLE1BQU0sU0FBUyxPQUFPLEVBQUUsTUFBTSxhQUFhLElBQUksUUFBUSxHQUFHLENBQUM7QUFDMUUsZUFBTyxNQUFNLFVBQVU7QUFBQSxNQUN4QjtBQUdBLFlBQU0sWUFBWSxNQUFNLFNBQVMsT0FBTyxFQUFFLE1BQU0sSUFBSSxLQUFLLEtBQUssQ0FBQztBQUMvRCxnQkFBVSxNQUFNLFVBQVU7QUFBQSxJQUMzQixDQUFDO0FBRUQsVUFBTSxXQUFXLFFBQVEsU0FBUyxVQUFVLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDN0QsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVXpCLGFBQVMsVUFBVSxNQUFNLE1BQU0sT0FBTztBQUN0QyxVQUFNLFVBQVUsQ0FBQyxNQUFNO0FBQ3RCLFVBQUksRUFBRSxXQUFXLE1BQU8sT0FBTSxPQUFPO0FBQUEsSUFDdEM7QUFBQSxFQUNEO0FBQUEsRUFFQSxxQkFBMkI7QUFDMUIsUUFBSSxLQUFLLGdCQUFnQjtBQUN4QixXQUFLLGVBQWUsTUFBTSxVQUFVO0FBQUEsSUFDckM7QUFBQSxFQUNEO0FBQUEsRUFFQSx1QkFBNkI7QUFDNUIsUUFBSSxLQUFLLGtCQUFrQjtBQUMxQixXQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFBQSxJQUN2QztBQUFBLEVBQ0Q7QUFBQSxFQUVBLHNCQUE0QjtBQUMzQixTQUFLLGlCQUFpQjtBQUN0QixTQUFLLHFCQUFxQjtBQUMxQixTQUFLLG1CQUFtQjtBQUFBLEVBQ3pCO0FBQUEsRUFFQSxvQkFBNEM7QUFDM0MsV0FBTyxLQUFLO0FBQUEsRUFDYjtBQUFBLEVBRUEsVUFBZ0I7QUFDZixTQUFLLG9CQUFvQjtBQUN6QixRQUFJLEtBQUssa0JBQWtCO0FBQzFCLFdBQUssaUJBQWlCLE9BQU87QUFBQSxJQUM5QjtBQUNBLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxlQUFlLE9BQU87QUFBQSxJQUM1QjtBQUFBLEVBQ0Q7QUFDRDtBQXhQYSxnQkFRWSxxQkFBcUI7QUFSdkMsSUFBTSxpQkFBTjs7O0FDREEsSUFBTSxnQkFBTixNQUFNLGNBQWE7QUFBQSxFQUt6QixZQUFZLFFBQW9CLGVBQTRCO0FBQzNELFNBQUssU0FBUztBQUNkLFNBQUssZ0JBQWdCO0FBQUEsRUFDdEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLFdBQVcsTUFBdUMsU0FBdUI7QUFDeEUsVUFBTSxZQUFZLEtBQUssY0FBYyxVQUFVLEVBQUUsS0FBSyw2QkFBNkIsSUFBSSxHQUFHLENBQUM7QUFDM0YsY0FBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBS3ZCLFNBQVMsU0FDUiw0RkFDQSxTQUFTLFdBQ1QsaUpBQ0EsNkZBQ0g7QUFBQTtBQUdELFVBQU0sU0FBUyxVQUFVLFNBQVMsT0FBTztBQUFBLE1BQ3hDLE1BQU0sU0FBUyxTQUFTLFFBQVEsU0FBUyxXQUFXLFdBQVc7QUFBQSxNQUMvRCxLQUFLO0FBQUEsSUFDTixDQUFDO0FBQ0QsV0FBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3ZCLFVBQU0sWUFBWSxVQUFVLFNBQVMsT0FBTyxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFFM0UsUUFBSSxTQUFTLFlBQVksUUFBUSxTQUFTLE1BQU0sR0FBRztBQUNsRCxnQkFBVSxZQUFZO0FBQUEsSUFDdkIsT0FBTztBQUNOLGdCQUFVLGNBQWM7QUFBQSxJQUN6QjtBQUVBLFNBQUssZUFBZSxJQUFJO0FBQUEsRUFDekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUFvQixTQUFpQixXQUF5QjtBQUNyRSxVQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLGdCQUFnQixTQUFTLEdBQUcsQ0FBQztBQUNuRixVQUFNLFlBQVksVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRzNFLFFBQUksUUFBUSxTQUFTLE1BQU0sR0FBRztBQUM3QixnQkFBVSxZQUFZO0FBQUEsSUFDdkIsT0FBTztBQUNOLGdCQUFVLGNBQWM7QUFBQSxJQUN6QjtBQUVBLFNBQUssZUFBZTtBQUFBLEVBQ3JCO0FBQUEsRUFFQSxnQkFBZ0IsU0FBdUI7QUFDdEMsU0FBSyxvQkFBb0IsU0FBUyxvQkFBb0I7QUFBQSxFQUN2RDtBQUFBLEVBRUEsa0JBQWtCLFNBQXVCO0FBQ3hDLFNBQUssb0JBQW9CLFNBQVMsc0JBQXNCO0FBQUEsRUFDekQ7QUFBQSxFQUVBLGtCQUFrQixTQUF3QjtBQUN6QyxVQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUN0RSxjQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFVMUIsVUFBTSxVQUFVLFdBQVc7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUF1QjNCLGNBQVUsWUFBWTtBQUd0QixVQUFNLGFBQWEsVUFBVSxTQUFTLFFBQVE7QUFDOUMsZUFBVyxjQUFjO0FBQ3pCLGVBQVcsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWEzQixlQUFXLGlCQUFpQixTQUFTLE1BQU07QUFDMUMsZ0JBQVUsT0FBTztBQUFBLElBQ2xCLENBQUM7QUFFRCxlQUFXLGlCQUFpQixjQUFjLE1BQU07QUFDL0MsaUJBQVcsTUFBTSxRQUFRO0FBQ3pCLGlCQUFXLE1BQU0sYUFBYTtBQUFBLElBQy9CLENBQUM7QUFFRCxlQUFXLGlCQUFpQixjQUFjLE1BQU07QUFDL0MsaUJBQVcsTUFBTSxRQUFRO0FBQ3pCLGlCQUFXLE1BQU0sYUFBYTtBQUFBLElBQy9CLENBQUM7QUFFRCxTQUFLLGVBQWUsSUFBSTtBQUFBLEVBQ3pCO0FBQUEsRUFFQSxZQUFrQjtBQUNqQixTQUFLLGNBQWMsTUFBTTtBQUFBLEVBQzFCO0FBQUEsRUFFUSxlQUFlLFNBQWtCLE9BQWE7QUFDckQsZUFBVyxNQUFNO0FBQ2hCLFVBQUksUUFBUTtBQUNYLGFBQUssY0FBYyxTQUFTO0FBQUEsVUFDM0IsS0FBSyxLQUFLLGNBQWM7QUFBQSxVQUN4QixVQUFVO0FBQUEsUUFDWCxDQUFDO0FBQUEsTUFDRixPQUFPO0FBQ04sYUFBSyxjQUFjLFlBQVksS0FBSyxjQUFjO0FBQUEsTUFDbkQ7QUFBQSxJQUNELEdBQUcsY0FBYSxlQUFlO0FBQUEsRUFDaEM7QUFBQSxFQUVBLE1BQU0sd0JBQXdCLE1BQTRCO0FBQ3pELFVBQU0sV0FBVyxNQUFNLEtBQUssT0FBTyxvQkFBb0Isa0JBQWtCLE1BQU0sRUFBRTtBQUVqRixlQUFXLFdBQVcsVUFBVTtBQUMvQixXQUFLLFdBQVcsUUFBUSxNQUF5QyxRQUFRLE9BQU87QUFBQSxJQUNqRjtBQUFBLEVBQ0Q7QUFDRDtBQXpLYSxjQUdZLGtCQUFrQjtBQUhwQyxJQUFNLGVBQU47OztBUEtBLElBQU0seUJBQXlCO0FBRS9CLElBQU0sbUJBQU4sTUFBTSx5QkFBd0IsMEJBQVM7QUFBQSxFQXdEN0MsWUFBWSxNQUFxQixRQUFvQjtBQUNwRCxVQUFNLElBQUk7QUFyRFgsU0FBUSxjQUE0QjtBQUVwQyxTQUFRLGlCQUF5QztBQWNqRDtBQUFBLFNBQVEsc0JBQTZCLENBQUM7QUFHdEMsU0FBUSx3QkFBZ0M7QUFHeEMsU0FBUSx3QkFBaUM7QUFtQnpDO0FBQUEsU0FBUSxnQ0FBdUQ7QUFRL0Q7QUFBQSxTQUFRLHlCQUErRixDQUFDO0FBQ3hHLFNBQVEsV0FBNkIsQ0FBQztBQUlyQyxTQUFLLFNBQVM7QUFDZCxTQUFLLGtCQUFrQixJQUFJLHVCQUF1QixLQUFLLEdBQUc7QUFBQSxFQUMzRDtBQUFBO0FBQUEsRUE3Q0EsSUFBWSxXQUFXO0FBNUJ4QjtBQTRCMEIsWUFBTyxVQUFLLGlCQUFMLG1CQUFtQjtBQUFBLEVBQWU7QUFBQSxFQUNsRSxJQUFZLHVCQUF1QjtBQUFFLFdBQU8sS0FBSyxlQUFlLEVBQUUsU0FBUyxNQUFNO0FBQUEsSUFBQyxFQUFFLElBQUk7QUFBQSxFQUFNO0FBQUEsRUFDOUYsSUFBWSxtQkFBbUI7QUFBRSxXQUFPLE1BQU07QUFBQSxJQUFDO0FBQUEsRUFBRztBQUFBLEVBSWxELElBQVkscUJBQXFCO0FBQUUsV0FBTyxLQUFLO0FBQUEsRUFBcUI7QUFBQSxFQUNwRSxJQUFZLG1CQUFtQixPQUFjO0FBQUUsU0FBSyxzQkFBc0I7QUFBQSxFQUFPO0FBQUEsRUFFakYsSUFBWSx1QkFBdUI7QUFBRSxXQUFPLEtBQUs7QUFBQSxFQUF1QjtBQUFBLEVBQ3hFLElBQVkscUJBQXFCLE9BQWU7QUFBRSxTQUFLLHdCQUF3QjtBQUFBLEVBQU87QUFBQSxFQUV0RixJQUFZLHVCQUF1QjtBQUFFLFdBQU8sS0FBSztBQUFBLEVBQXVCO0FBQUEsRUFDeEUsSUFBWSxxQkFBcUIsT0FBZ0I7QUFBRSxTQUFLLHdCQUF3QjtBQUFBLEVBQU87QUFBQTtBQUFBLEVBR3ZGLElBQVksaUJBQWlCO0FBNUM5QjtBQTRDZ0MsWUFBTyxVQUFLLG1CQUFMLG1CQUFxQjtBQUFBLEVBQWdCO0FBQUEsRUFFM0UsSUFBWSxtQkFBbUI7QUE5Q2hDO0FBOENrQyxXQUFPLEtBQUssdUJBQXFCLFVBQUssbUJBQUwsbUJBQXFCO0FBQUEsRUFBa0I7QUFBQSxFQUN6RyxJQUFZLGlCQUFpQixPQUFZO0FBQUUsU0FBSyxvQkFBb0I7QUFBQSxFQUFPO0FBQUE7QUFBQSxFQUczRSxJQUFZLGdCQUFxQjtBQUFFLFdBQU87QUFBQSxFQUFNO0FBQUEsRUFDaEQsSUFBWSxjQUFjLE9BQVk7QUFBQSxFQUFjO0FBQUEsRUFDcEQsSUFBWSxjQUFtQjtBQUFFLFdBQU87QUFBQSxFQUFNO0FBQUEsRUFDOUMsSUFBWSxZQUFZLE9BQVk7QUFBQSxFQUFjO0FBQUEsRUFDbEQsSUFBWSxnQkFBcUI7QUFBRSxXQUFPO0FBQUEsRUFBTTtBQUFBLEVBcUJoRCxjQUFjO0FBQ2IsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLGlCQUFpQjtBQUNoQixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEsVUFBVTtBQUNULFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLFNBQVM7QUFDZCxVQUFNLFlBQVksS0FBSyxZQUFZLFNBQVMsQ0FBQztBQUM3QyxjQUFVLE1BQU07QUFDaEIsY0FBVSxTQUFTLHdCQUF3QjtBQUszQyxVQUFNLFlBQVksVUFBVSxVQUFVLEVBQUUsS0FBSyxlQUFlLENBQUM7QUFDN0QsY0FBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHFCQUtQLDBCQUFTLGVBQWUsb0JBQW9CLGlCQUFpQjtBQUFBO0FBSWhGLFVBQU0sV0FBVyxVQUFVLFVBQVUsRUFBRSxLQUFLLGNBQWMsQ0FBQztBQUMzRCxhQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVXpCLFVBQU0sVUFBVSxTQUFTLFNBQVMsSUFBSTtBQUN0QyxZQUFRLE1BQU0sVUFBVTtBQUN4QixZQUFRLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWFwQixVQUFNLGlCQUFpQixTQUFTLFVBQVU7QUFDMUMsbUJBQWUsTUFBTSxVQUFVO0FBRy9CLFVBQU0sbUJBQW1CLGVBQWUsV0FBVyxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDcEYscUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9qQyxTQUFLLHVCQUF1QixnQkFBZ0I7QUFHNUMsSUFBQyxLQUFhLG1CQUFtQjtBQUdqQyxTQUFLLHVCQUF1QixjQUFjO0FBRzFDLFVBQU0sY0FBYyxJQUFJLGlDQUFnQixjQUFjO0FBQ3RELGdCQUFZLFFBQVEsUUFBUSxFQUMxQixXQUFXLDRCQUE0QixFQUN2QyxRQUFRLE1BQU0sS0FBSyxVQUFVLENBQUM7QUFFaEMsU0FBSyxvQkFBb0IsU0FBUztBQUNsQyxTQUFLLHFCQUFxQixTQUFTO0FBR25DLFNBQUs7QUFBQSxNQUNKLEtBQUssSUFBSSxVQUFVLEdBQUcsc0JBQXNCLE1BQU07QUFDakQsYUFBSyw4QkFBOEI7QUFBQSxNQUNwQyxDQUFDO0FBQUEsSUFDRjtBQUdBLFNBQUssOEJBQThCO0FBR25DLGVBQVcsTUFBTSxLQUFLLHNCQUFzQixHQUFHLEdBQUc7QUFHbEQsZUFBVyxNQUFNO0FBOUtuQjtBQStLRyxXQUFJLFVBQUssYUFBTCxtQkFBZSxTQUFTO0FBQzNCLGFBQUssU0FBUyxRQUFRLE1BQU07QUFBQSxNQUM3QjtBQUFBLElBQ0QsR0FBRyxpQkFBZ0IsY0FBYztBQUFBLEVBQ2xDO0FBQUEsRUFFQSxNQUFNLFVBQVU7QUFyTGpCO0FBdUxFLFNBQUssVUFBYSw0QkFBYixtQkFBc0MsU0FBUztBQUNuRCxNQUFDLEtBQWEsd0JBQXdCLFFBQVE7QUFBQSxJQUMvQztBQUdBLFFBQUksS0FBSyxzQkFBc0I7QUFDOUIsV0FBSyxxQkFBcUIsUUFBUTtBQUFBLElBQ25DO0FBR0EsUUFBSSxLQUFLLCtCQUErQjtBQUN2QyxtQkFBYSxLQUFLLDZCQUE2QjtBQUMvQyxXQUFLLGdDQUFnQztBQUFBLElBQ3RDO0FBR0EsU0FBSyxzQkFBc0I7QUFHM0IsU0FBSyxjQUFjO0FBR25CLFNBQUssbUJBQW1CO0FBQUEsRUFDekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHdCQUF3QixTQUFzQixPQUFlLFNBQThCO0FBQ2xHLFlBQVEsaUJBQWlCLE9BQU8sT0FBTztBQUN2QyxTQUFLLHVCQUF1QixLQUFLLEVBQUUsU0FBUyxPQUFPLFFBQVEsQ0FBQztBQUFBLEVBQzdEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxrQkFBa0IsVUFBc0IsT0FBK0I7QUFDOUUsVUFBTSxLQUFLLFdBQVcsTUFBTTtBQUMzQixlQUFTO0FBQ1QsV0FBSyxXQUFXLEtBQUssU0FBUyxPQUFPLE9BQUssTUFBTSxFQUFFO0FBQUEsSUFDbkQsR0FBRyxLQUFLO0FBQ1IsU0FBSyxTQUFTLEtBQUssRUFBRTtBQUNyQixXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esd0JBQThCO0FBQ3JDLFNBQUssdUJBQXVCLFFBQVEsQ0FBQyxFQUFFLFNBQVMsT0FBTyxRQUFRLE1BQU07QUFDcEUsY0FBUSxvQkFBb0IsT0FBTyxPQUFPO0FBQUEsSUFDM0MsQ0FBQztBQUNELFNBQUsseUJBQXlCLENBQUM7QUFBQSxFQUNoQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQXNCO0FBQzdCLFNBQUssU0FBUyxRQUFRLFFBQU0sYUFBYSxFQUFFLENBQUM7QUFDNUMsU0FBSyxXQUFXLENBQUM7QUFBQSxFQUNsQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EscUJBQTJCO0FBQUEsRUFFbkM7QUFBQSxFQUVRLG9CQUFvQixXQUF3QjtBQUNuRCxTQUFLLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ3ZFLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBV25DLFNBQUssa0JBQWtCO0FBQUEsRUFDeEI7QUFBQSxFQUVRLHFCQUFxQixXQUF3QjtBQUNwRCxTQUFLLGlCQUFpQixVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ3pFLFNBQUssZ0JBQWdCO0FBQUEsRUFDdEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQjtBQUV6QixTQUFLLGVBQWUsTUFBTTtBQUcxQixTQUFLLGlCQUFpQixJQUFJLGVBQWUsS0FBSyxRQUFRLEtBQUssS0FBSyxLQUFLLGNBQWM7QUFDbkYsU0FBSyxlQUFlLElBQUksYUFBYSxLQUFLLFFBQVEsS0FBSyxhQUFhO0FBR3BFLFNBQUssZUFBZSxJQUFJLGFBQWEsS0FBSyxRQUFRLEtBQUssZ0JBQWdCLEtBQUssY0FBYztBQUcxRixTQUFLLGFBQWEscUJBQXFCLEtBQUssYUFBYTtBQUd6RCxTQUFLLGdCQUFnQixJQUFJLGNBQWMsS0FBSyxRQUFRLEtBQUssZ0JBQWdCLEtBQUssYUFBYSxZQUFZLENBQUM7QUFHeEcsU0FBSyxhQUFhLGlCQUFpQixLQUFLLGFBQWE7QUFHckQsU0FBSyxhQUFhLGlCQUFpQixDQUFDLFlBQW9CO0FBQ3ZELFdBQUssV0FBVyxPQUFPO0FBQUEsSUFDeEIsQ0FBQztBQUdELFNBQUssZUFBZSx1QkFBdUI7QUFBQSxFQUU1QztBQUFBLEVBRVEsV0FBVyxNQUF1QyxTQUFpQjtBQUMxRSxVQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLDZCQUE2QixJQUFJLEdBQUcsQ0FBQztBQUMzRixjQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FLdkIsU0FBUyxTQUNSLDRGQUNBLFNBQVMsV0FDVCxpSkFDQSw2RkFDSDtBQUFBO0FBR0QsVUFBTSxTQUFTLFVBQVUsU0FBUyxPQUFPO0FBQUEsTUFDeEMsTUFBTSxTQUFTLFNBQVMsUUFBUSxTQUFTLFdBQVcsV0FBVztBQUFBLE1BQy9ELEtBQUs7QUFBQSxJQUNOLENBQUM7QUFDRCxXQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPdkIsVUFBTSxZQUFZLFVBQVUsU0FBUyxPQUFPLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUUzRSxRQUFJLFNBQVMsWUFBWSxRQUFRLFNBQVMsTUFBTSxHQUFHO0FBQ2xELGdCQUFVLFlBQVk7QUFBQSxJQUN2QixPQUFPO0FBQ04sZ0JBQVUsY0FBYztBQUFBLElBQ3pCO0FBR0EsZUFBVyxNQUFNO0FBQ2hCLFdBQUssY0FBYyxTQUFTO0FBQUEsUUFDM0IsS0FBSyxLQUFLLGNBQWM7QUFBQSxRQUN4QixVQUFVO0FBQUEsTUFDWCxDQUFDO0FBQUEsSUFDRixHQUFHLGlCQUFnQixlQUFlO0FBQUEsRUFDbkM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUFvQixTQUFpQixXQUF5QjtBQUNyRSxVQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLGdCQUFnQixTQUFTLEdBQUcsQ0FBQztBQUNuRixVQUFNLFlBQVksVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRzNFLFFBQUksUUFBUSxTQUFTLE1BQU0sR0FBRztBQUM3QixnQkFBVSxZQUFZO0FBQUEsSUFDdkIsT0FBTztBQUNOLGdCQUFVLGNBQWM7QUFBQSxJQUN6QjtBQUdBLGVBQVcsTUFBTTtBQUNoQixXQUFLLGNBQWMsWUFBWSxLQUFLLGNBQWM7QUFBQSxJQUNuRCxHQUFHLGlCQUFnQixlQUFlO0FBQUEsRUFDbkM7QUFBQSxFQUVRLGdCQUFnQixTQUFpQjtBQUN4QyxTQUFLLG9CQUFvQixTQUFTLG9CQUFvQjtBQUFBLEVBQ3ZEO0FBQUEsRUFFUSxrQkFBa0IsU0FBaUI7QUFDMUMsU0FBSyxvQkFBb0IsU0FBUyxzQkFBc0I7QUFBQSxFQUN6RDtBQUFBLEVBRVEsa0JBQWtCLFNBQWtCO0FBQzNDLFVBQU0sWUFBWSxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssZUFBZSxDQUFDO0FBQ3RFLGNBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWMxQixVQUFNLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ3RFLGtCQUFjLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPOUIsa0JBQWMsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWUxQixVQUFNLGdCQUFnQixVQUFVLFVBQVU7QUFDMUMsa0JBQWMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBSzlCLFVBQU0sVUFBVSxjQUFjLFVBQVUsRUFBRSxNQUFNLGdCQUFpQixDQUFDO0FBQ2xFLFlBQVEsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU94QixVQUFNLGFBQWEsY0FBYyxVQUFVLEVBQUUsTUFBTSxXQUFXLEdBQUcsQ0FBQztBQUNsRSxlQUFXLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQU0zQixlQUFXLE1BQU07QUFDaEIsV0FBSyxjQUFjLFNBQVM7QUFBQSxRQUMzQixLQUFLLEtBQUssY0FBYztBQUFBLFFBQ3hCLFVBQVU7QUFBQSxNQUNYLENBQUM7QUFBQSxJQUNGLEdBQUcsaUJBQWdCLGVBQWU7QUFBQSxFQUNuQztBQUFBLEVBRVEsb0JBQW9CLFFBQWdCO0FBQzNDLFVBQU0sY0FBYyxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbEYsZ0JBQVksTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFnQjVCLGdCQUFZLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUlyQixLQUFLLHlCQUF5QixNQUFNLENBQUM7QUFBQTtBQUl4QyxlQUFXLE1BQU07QUFDaEIsV0FBSyxjQUFjLFNBQVM7QUFBQSxRQUMzQixLQUFLLEtBQUssY0FBYztBQUFBLFFBQ3hCLFVBQVU7QUFBQSxNQUNYLENBQUM7QUFBQSxJQUNGLEdBQUcsaUJBQWdCLGVBQWU7QUFBQSxFQUNuQztBQUFBLEVBRVEseUJBQXlCLFFBQXdCO0FBQ3hELFlBQVEsUUFBUTtBQUFBLE1BQ2YsS0FBSztBQUNKLGVBQU87QUFBQSxNQUNSLEtBQUs7QUFDSixlQUFPO0FBQUEsTUFDUixLQUFLO0FBQ0osZUFBTztBQUFBLE1BQ1IsS0FBSztBQUNKLGVBQU87QUFBQSxNQUNSLEtBQUs7QUFDSixlQUFPO0FBQUEsTUFDUjtBQUNDLGVBQU87QUFBQSxJQUNUO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBYyxtQkFBbUIsU0FBbUM7QUFqZnJFO0FBbWZFLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQzdELFdBQUssV0FBVyxVQUFVLEtBQUssa0JBQWtCLE9BQU8sNkdBQTZHLENBQUM7QUFDdEssYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLFVBQVUsUUFBUSxNQUFNLENBQUMsRUFBRSxZQUFZO0FBRzdDLFVBQU0sbUJBQTJDO0FBQUEsTUFDaEQsVUFBVTtBQUFBLE1BQ1YsV0FBVztBQUFBLE1BQ1gsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLElBQ1g7QUFFQSxRQUFJLGlCQUFpQixPQUFPLEdBQUc7QUFDOUIsWUFBTSxhQUFhLGlCQUFpQixPQUFPO0FBQzNDLFlBQU0sS0FBSyxPQUFPLFdBQVcsbUJBQW1CLFVBQVU7QUFDMUQsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixXQUFLLGtCQUFrQixLQUFLLGtCQUFrQixjQUFjLGVBQWUsS0FBSyxnQ0FBZ0MsVUFBVSxDQUFDLEVBQUUsQ0FBQztBQUM5SCxhQUFPO0FBQUEsSUFDUjtBQUdBLFFBQUksS0FBSyxPQUFPLGVBQWUsaUJBQWlCLFVBQVUsR0FBRztBQUM1RCxZQUFNLGlCQUFnQixVQUFLLE9BQU8sU0FBUyxtQkFBckIsbUJBQXFDLEtBQUssU0FBTyxJQUFJLFlBQVk7QUFDdkYsVUFBSSxlQUFlO0FBRWxCLGFBQUssU0FBUyxTQUFTLGNBQWMsUUFBUTtBQUU3QyxtQkFBVyxNQUFNLEtBQUssaUJBQWlCLEdBQUcsQ0FBQztBQUMzQyxhQUFLLFdBQVcsVUFBVSxLQUFLLGtCQUFrQixRQUFRLG9CQUFvQixjQUFjLElBQUksRUFBRSxDQUFDO0FBQ2xHLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUdBLFNBQUssZ0JBQWdCLEtBQUssa0JBQWtCLGVBQWUscUJBQXFCLE9BQU8sK0NBQStDLENBQUM7QUFDdkksV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVRLHNCQUE0QjtBQUNuQyxTQUFLLGdCQUFnQixLQUFLLGVBQWUsVUFBVSxFQUFFLEtBQUssc0NBQXNDLENBQUM7QUFDakcsU0FBSyxjQUFjLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBYXBDO0FBQUEsRUFFUSxvQkFBMEI7QUFDakMsVUFBTSxRQUFRLEtBQUssU0FBUyxTQUFTO0FBRXJDLFFBQUksTUFBTSxXQUFXLEdBQUcsS0FBSyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQ3JGLFlBQU0sUUFBUSxNQUFNLE1BQU0sQ0FBQyxFQUFFLFlBQVk7QUFDekMsV0FBSyxrQkFBa0IsS0FBSztBQUFBLElBQzdCLE9BQU87QUFDTixXQUFLLGtCQUFrQjtBQUFBLElBQ3hCO0FBQUEsRUFDRDtBQUFBLEVBRVEsa0JBQWtCLE9BQXFCO0FBQzlDLFVBQU0sV0FBVyxLQUFLLHFCQUFxQixFQUFFO0FBQUEsTUFBTyxTQUNuRCxJQUFJLFFBQVEsWUFBWSxFQUFFLFNBQVMsS0FBSyxLQUFLLElBQUksS0FBSyxZQUFZLEVBQUUsU0FBUyxLQUFLO0FBQUEsSUFDbkY7QUFFQSxTQUFLLGNBQWMsTUFBTTtBQUN6QixTQUFLLHFCQUFxQixDQUFDO0FBQzNCLFNBQUssdUJBQXVCO0FBRTVCLFFBQUksU0FBUyxXQUFXLEdBQUc7QUFDMUIsV0FBSyxrQkFBa0I7QUFDdkI7QUFBQSxJQUNEO0FBRUEsYUFBUyxRQUFRLENBQUMsU0FBUyxVQUFVO0FBQ3BDLFlBQU0sT0FBTyxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssb0NBQW9DLENBQUM7QUFFdEYsWUFBTSxZQUFZLEtBQUssV0FBVyxFQUFFLEtBQUssMENBQTBDLENBQUM7QUFDcEYsZ0JBQVUsY0FBYyxJQUFJLFFBQVEsT0FBTztBQUUzQyxZQUFNLFNBQVMsS0FBSyxXQUFXLEVBQUUsS0FBSyxvQ0FBb0MsQ0FBQztBQUMzRSxhQUFPLGNBQWMsUUFBUTtBQUM3QixhQUFPLE1BQU0sVUFBVTtBQUV2QixVQUFJLFFBQVEsYUFBYTtBQUN4QixjQUFNLFNBQVMsS0FBSyxXQUFXLEVBQUUsS0FBSyxxQ0FBcUMsQ0FBQztBQUM1RSxlQUFPLGNBQWMsUUFBUTtBQUFBLE1BQzlCO0FBRUEsV0FBSyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3BDLGFBQUssY0FBYyxRQUFRLE9BQU87QUFBQSxNQUNuQyxDQUFDO0FBRUQsV0FBSyxpQkFBaUIsY0FBYyxNQUFNO0FBQ3pDLGFBQUssbUJBQW1CLEtBQUs7QUFBQSxNQUM5QixDQUFDO0FBRUQsV0FBSyxtQkFBbUIsS0FBSyxJQUFJO0FBQUEsSUFDbEMsQ0FBQztBQUVELFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQSxFQUNwQztBQUFBLEVBRVEsb0JBQTBCO0FBQ2pDLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFDbkMsU0FBSyx1QkFBdUI7QUFBQSxFQUM3QjtBQUFBLEVBRVEseUJBQWtDO0FBQ3pDLFdBQU8sS0FBSyxjQUFjLE1BQU0sWUFBWTtBQUFBLEVBQzdDO0FBQUEsRUFFUSxzQkFBc0IsV0FBeUI7QUFDdEQsUUFBSSxLQUFLLG1CQUFtQixXQUFXLEVBQUc7QUFFMUMsVUFBTSxXQUFXLEtBQUssSUFBSSxHQUFHLEtBQUs7QUFBQSxNQUNqQyxLQUFLLG1CQUFtQixTQUFTO0FBQUEsTUFDakMsS0FBSyx1QkFBdUI7QUFBQSxJQUM3QixDQUFDO0FBRUQsU0FBSyxtQkFBbUIsUUFBUTtBQUFBLEVBQ2pDO0FBQUEsRUFFUSxtQkFBbUIsT0FBcUI7QUFFL0MsU0FBSyxtQkFBbUIsUUFBUSxVQUFRO0FBQ3ZDLFdBQUssWUFBWSxVQUFVO0FBQUEsSUFDNUIsQ0FBQztBQUVELFNBQUssdUJBQXVCO0FBRTVCLFFBQUksU0FBUyxLQUFLLFFBQVEsS0FBSyxtQkFBbUIsUUFBUTtBQUN6RCxXQUFLLG1CQUFtQixLQUFLLEVBQUUsU0FBUyxVQUFVO0FBQ2xELFdBQUssbUJBQW1CLEtBQUssRUFBRSxlQUFlLEVBQUUsT0FBTyxVQUFVLENBQUM7QUFBQSxJQUNuRTtBQUFBLEVBQ0Q7QUFBQSxFQUVRLCtCQUF3QztBQUMvQyxRQUFJLENBQUMsS0FBSyx1QkFBdUIsS0FBSyxLQUFLLHlCQUF5QixJQUFJO0FBQ3ZFLGFBQU87QUFBQSxJQUNSO0FBRUEsVUFBTSxXQUFXLEtBQUsscUJBQXFCO0FBQzNDLFVBQU0sa0JBQWtCLFNBQVMsS0FBSyxvQkFBb0I7QUFFMUQsUUFBSSxpQkFBaUI7QUFDcEIsV0FBSyxjQUFjLGdCQUFnQixPQUFPO0FBQzFDLGFBQU87QUFBQSxJQUNSO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVRLGNBQWMsU0FBdUI7QUFDNUMsU0FBSyxTQUFTLFNBQVMsSUFBSSxPQUFPLEVBQUU7QUFDcEMsU0FBSyxrQkFBa0I7QUFFdkIsU0FBSyxXQUFXO0FBQUEsRUFDakI7QUFBQSxFQUVRLHVCQUFxRjtBQUM1RixVQUFNLFdBQXlFO0FBQUEsTUFDOUUsRUFBRSxTQUFTLFVBQVUsTUFBTSxvQkFBb0IsYUFBYSxzQkFBc0I7QUFBQSxNQUNsRixFQUFFLFNBQVMsV0FBVyxNQUFNLHFCQUFxQixhQUFhLG9CQUFvQjtBQUFBLE1BQ2xGLEVBQUUsU0FBUyxVQUFVLE1BQU0sb0JBQW9CLGFBQWEsbUJBQW1CO0FBQUEsSUFDaEY7QUFHQSxRQUFJLDBCQUFTLGNBQWM7QUFDMUIsZUFBUyxLQUFLLEVBQUUsU0FBUyxVQUFVLE1BQU0sb0JBQW9CLGFBQWEsa0JBQWtCLENBQUM7QUFBQSxJQUM5RjtBQUdBLFFBQUksS0FBSyxPQUFPLGVBQWUsaUJBQWlCLFVBQVUsR0FBRztBQUM1RCxZQUFNLGlCQUFpQixLQUFLLE9BQU8sU0FBUyxrQkFBa0IsQ0FBQztBQUMvRCxxQkFBZSxRQUFRLFNBQU87QUFDN0IsaUJBQVMsS0FBSztBQUFBLFVBQ2IsU0FBUyxJQUFJO0FBQUEsVUFDYixNQUFNLElBQUk7QUFBQSxVQUNWLEdBQUksSUFBSSxlQUFlLEVBQUUsYUFBYSxJQUFJLFlBQVk7QUFBQSxRQUN2RCxDQUFDO0FBQUEsTUFDRixDQUFDO0FBQUEsSUFDRjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFUSxvQkFBMEI7QUFDakMsU0FBSyxjQUFjLEtBQUssZUFBZSxVQUFVLEVBQUUsS0FBSyxvQ0FBb0MsQ0FBQztBQUM3RixTQUFLLFlBQVksTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZWpDLFVBQU0sMEJBQXlDLENBQUMsVUFBaUI7QUFDaEUsVUFBSSxDQUFDLEtBQUssWUFBWSxTQUFTLE1BQU0sTUFBYyxLQUNsRCxDQUFDLEtBQUssY0FBYyxTQUFTLFNBQVMsTUFBTSxNQUFjLEdBQUc7QUFDN0QsYUFBSyxnQkFBZ0I7QUFBQSxNQUN0QjtBQUFBLElBQ0Q7QUFDQSxTQUFLLHdCQUF3QixVQUFVLFNBQVMsdUJBQXVCO0FBQUEsRUFDeEU7QUFBQSxFQUVRLG9CQUEwQjtBQUNqQyxRQUFJLENBQUMsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLFVBQVUsR0FBRztBQUM3RCxXQUFLLFdBQVcsVUFBVSxLQUFLLGtCQUFrQixPQUFPLDZHQUE2RyxDQUFDO0FBQ3RLO0FBQUEsSUFDRDtBQUVBLFFBQUksS0FBSyxzQkFBc0I7QUFDOUIsV0FBSyxnQkFBZ0I7QUFBQSxJQUN0QixPQUFPO0FBQ04sV0FBSyxnQkFBZ0I7QUFBQSxJQUN0QjtBQUFBLEVBQ0Q7QUFBQSxFQUVRLGtCQUF3QjtBQUMvQixVQUFNLFdBQVcsS0FBSyxxQkFBcUI7QUFFM0MsU0FBSyxZQUFZLE1BQU07QUFHdkIsVUFBTSxXQUFXLEtBQUssWUFBWSxVQUFVLEVBQUUsS0FBSyw2Q0FBNkMsQ0FBQztBQUNqRyxhQUFTLFlBQVksS0FBSyxpQkFBaUIsS0FBSyxJQUFJO0FBR3BELGFBQVMsUUFBUSxhQUFXO0FBQzNCLFlBQU0sT0FBTyxLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssa0RBQWtELENBQUM7QUFFbEcsWUFBTSxTQUFTLEtBQUssVUFBVSxFQUFFLEtBQUsseUNBQXlDLENBQUM7QUFDL0UsYUFBTyxjQUFjLFFBQVE7QUFFN0IsWUFBTSxZQUFZLEtBQUssVUFBVSxFQUFFLEtBQUssK0NBQStDLENBQUM7QUFDeEYsZ0JBQVUsY0FBYyxJQUFJLFFBQVEsT0FBTztBQUMzQyxnQkFBVSxNQUFNLFVBQVU7QUFFMUIsVUFBSSxRQUFRLGFBQWE7QUFDeEIsY0FBTSxTQUFTLEtBQUssVUFBVSxFQUFFLEtBQUssMENBQTBDLENBQUM7QUFDaEYsZUFBTyxjQUFjLFFBQVE7QUFBQSxNQUM5QjtBQUVBLFdBQUssaUJBQWlCLFNBQVMsTUFBTTtBQUNwQyxhQUFLLHVCQUF1QixRQUFRLE9BQU87QUFBQSxNQUM1QyxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUEsRUFFUSxrQkFBd0I7QUFDL0IsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUEsRUFFUSx1QkFBdUIsU0FBdUI7QUFDckQsU0FBSyxnQkFBZ0I7QUFHckIsU0FBSyxTQUFTLFNBQVMsSUFBSSxPQUFPLEVBQUU7QUFDcEMsU0FBSyxXQUFXO0FBQUEsRUFDakI7QUFBQSxFQUVRLHlCQUErQjtBQUV0QyxRQUFJLENBQUMsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLG1CQUFtQixHQUFHO0FBQ3RFO0FBQUEsSUFDRDtBQUVBLFNBQUssbUJBQW1CLEtBQUssZUFBZSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUN2RixTQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBV3ZDO0FBQUEsRUFFUSx1QkFBb0M7QUFFM0MsUUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUV0RSxhQUFPLFNBQVMsY0FBYyxLQUFLO0FBQUEsSUFDcEM7QUFHQSxVQUFNLG1CQUFtQixLQUFLLGVBQWUsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDdEYscUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWNqQyxVQUFNLGNBQWMsaUJBQWlCLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBQ3BGLGdCQUFZLFlBQVksS0FBSyxpQkFBaUIsV0FBVyxJQUFJO0FBQzdELGdCQUFZLE1BQU0sVUFBVTtBQUU1QixVQUFNLGNBQWMsaUJBQWlCLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBQ3BGLGdCQUFZLE1BQU0sVUFBVTtBQUU1QixXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0NBQXNDO0FBQzdDLFFBQUksS0FBSywrQkFBK0I7QUFDdkMsbUJBQWEsS0FBSyw2QkFBNkI7QUFBQSxJQUNoRDtBQUVBLFNBQUssZ0NBQWdDLFdBQVcsTUFBTTtBQUNyRCxXQUFLLHlCQUF5QjtBQUM5QixXQUFLLGdDQUFnQztBQUFBLElBQ3RDLEdBQUcsaUJBQWdCLDJCQUEyQjtBQUFBLEVBQy9DO0FBQUEsRUFFUSwyQkFBaUM7QUFsMUIxQztBQW0xQkUsUUFBSSxDQUFDLEtBQUssa0JBQWtCLENBQUMsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLG1CQUFtQixHQUFHO0FBQzlGO0FBQUEsSUFDRDtBQUVBLFVBQU0sVUFBVSxLQUFLLFNBQVMsU0FBUztBQUN2QyxRQUFJLENBQUMsU0FBUztBQUNiLFdBQUssZUFBZSxNQUFNLFVBQVU7QUFDcEM7QUFBQSxJQUNEO0FBSUEsVUFBTSxhQUFhO0FBQ25CLFVBQU0sWUFBc0QsQ0FBQztBQUM3RCxRQUFJO0FBRUosWUFBUSxRQUFRLFdBQVcsS0FBSyxPQUFPLE9BQU8sTUFBTTtBQUNuRCxZQUFNLFVBQVUsTUFBTSxDQUFDO0FBQ3ZCLFlBQU0sV0FBVyxNQUFNLENBQUM7QUFHeEIsWUFBTSxPQUFPLEtBQUssZUFBZSxPQUFPO0FBQ3hDLFVBQUksTUFBTTtBQUNULGtCQUFVLEtBQUs7QUFBQSxVQUNkLE1BQU07QUFBQSxVQUNOO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0Q7QUFHQSxVQUFNLGlCQUFpQixLQUFLLGdCQUFnQix1QkFBcUIsVUFBSyxnQkFBTCxtQkFBa0IsU0FBUSxFQUFFO0FBQzdGLG1CQUFlLFFBQVEsU0FBTztBQUU3QixZQUFNLFNBQVMsVUFBVSxLQUFLLFNBQU8sSUFBSSxTQUFTLElBQUksS0FBSyxRQUFRO0FBQ25FLFVBQUksQ0FBQyxRQUFRO0FBQ1osa0JBQVUsS0FBSztBQUFBLFVBQ2QsTUFBTSxJQUFJLEtBQUs7QUFBQSxVQUNmLFVBQVUsSUFBSTtBQUFBLFFBQ2YsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNELENBQUM7QUFHRCxRQUFJLFVBQVUsU0FBUyxHQUFHO0FBQ3pCLFlBQU0sY0FBYyxLQUFLLGVBQWUsY0FBYyw0QkFBNEI7QUFDbEYsVUFBSSxhQUFhO0FBQ2hCLGNBQU0sV0FBVyxVQUFVLElBQUksU0FBTztBQUNyQyxnQkFBTSxTQUFTLElBQUksV0FBVyxJQUFJLElBQUksUUFBUSxLQUFLO0FBQ25ELGlCQUFPLEdBQUcsSUFBSSxJQUFJLEdBQUcsTUFBTTtBQUFBLFFBQzVCLENBQUM7QUFDRCxvQkFBWSxjQUFjLFNBQVMsS0FBSyxJQUFJO0FBQUEsTUFDN0M7QUFDQSxXQUFLLGVBQWUsTUFBTSxVQUFVO0FBQUEsSUFDckMsT0FBTztBQUNOLFdBQUssZUFBZSxNQUFNLFVBQVU7QUFBQSxJQUNyQztBQUFBLEVBQ0Q7QUFBQSxFQUVRLGVBQWUsWUFBa0M7QUFFeEQsUUFBSSxPQUFPLEtBQUssSUFBSSxNQUFNLHNCQUFzQixVQUFVO0FBRTFELFFBQUksQ0FBQyxRQUFRLEVBQUUsZ0JBQWdCLHlCQUFRO0FBRXRDLGFBQU8sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLGFBQWEsS0FBSztBQUFBLElBQy9EO0FBRUEsUUFBSSxDQUFDLFFBQVEsRUFBRSxnQkFBZ0IseUJBQVE7QUFFdEMsWUFBTSxRQUFRLEtBQUssSUFBSSxNQUFNLGlCQUFpQjtBQUM5QyxhQUFPLE1BQU07QUFBQSxRQUFLLE9BQ2pCLEVBQUUsYUFBYSxjQUNmLEVBQUUsU0FBUyxjQUNYLEVBQUUsS0FBSyxTQUFTLE1BQU0sVUFBVSxLQUNoQyxFQUFFLEtBQUssU0FBUyxNQUFNLGFBQWEsS0FBSztBQUFBLE1BQ3pDLEtBQUs7QUFBQSxJQUNOO0FBRUEsV0FBTyxnQkFBZ0IseUJBQVEsT0FBTztBQUFBLEVBQ3ZDO0FBQUEsRUFFUSx5QkFBK0I7QUFDdEMsUUFBSSxDQUFDLEtBQUssa0JBQWtCO0FBQzNCO0FBQUEsSUFDRDtBQUVBLFNBQUssaUJBQWlCLE1BQU07QUFFNUIsUUFBSSxDQUFDLEtBQUssZ0JBQWdCO0FBQ3pCLFdBQUssaUJBQWlCLE1BQU0sVUFBVTtBQUN0QztBQUFBLElBQ0Q7QUFFQSxVQUFNLFVBQVUsS0FBSyxlQUFlO0FBRXBDLFFBQUksUUFBUSxXQUFXLEdBQUc7QUFDekIsV0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQ3RDO0FBQUEsSUFDRDtBQUdBLFVBQU0sV0FBVywwQkFBUztBQUMxQixTQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUEsY0FHMUIsV0FBVyxjQUFjLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGdCQUtqQyxXQUFXLFVBQVUsT0FBTztBQUFBO0FBQUE7QUFBQTtBQUFBLGlCQUkzQixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBR3pDLFVBQU0sWUFBWSxLQUFLLGlCQUFpQixVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUNqRixjQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUzFCLFVBQU0sZ0JBQWdCLFVBQVUsV0FBVyxFQUFFLEtBQUssNEJBQTRCLENBQUM7QUFFL0UsVUFBTSxlQUFlLEtBQUssTUFBTyxLQUFLLGVBQWUsYUFBYSxNQUFRLEdBQUc7QUFDN0UsVUFBTSxXQUFXLFFBQVEsSUFBSSxTQUFPLElBQUksS0FBSyxRQUFRLEVBQUUsTUFBTSxHQUFHLFdBQVcsSUFBSSxDQUFDO0FBQ2hGLFVBQU0sWUFBWSxRQUFRLFVBQVUsV0FBVyxJQUFJLEtBQUssS0FBSyxRQUFRLFVBQVUsV0FBVyxJQUFJLEVBQUUsS0FBSztBQUdyRyxrQkFBYyxNQUFNLFVBQVU7QUFFOUIsUUFBSSxVQUFVO0FBQ2Isb0JBQWMsWUFBWSxLQUFLLGlCQUFpQixXQUFXLElBQUksSUFBSSxTQUFTLEtBQUssSUFBSSxDQUFDLEdBQUcsU0FBUyxLQUFLLFlBQVk7QUFBQSxJQUNwSCxPQUFPO0FBQ04sb0JBQWMsWUFBWSxLQUFLLGlCQUFpQixXQUFXLElBQUksSUFBSSxTQUFTLEtBQUssSUFBSSxDQUFDLEdBQUcsU0FBUyxLQUFLLFlBQVk7QUFBQSxJQUNwSDtBQUdBLFVBQU0sb0JBQW9CLFVBQVUsV0FBVyxFQUFFLEtBQUssZ0NBQWdDLENBQUM7QUFDdkYsc0JBQWtCLFlBQVksS0FBSyxpQkFBaUIsbUJBQW1CLFdBQVcsU0FBUyxNQUFNO0FBQ2pHLHNCQUFrQixNQUFNLFVBQVU7QUFBQTtBQUFBLGdCQUVwQixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBQUEsY0FFNUIsV0FBVyxRQUFRLEtBQUs7QUFBQSxnQkFDdEIsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXhDLHNCQUFrQixRQUFRLFNBQVMseUJBQXlCO0FBRzVELFFBQUksVUFBVTtBQUNiLGdCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsMEJBQWtCLE1BQU0sYUFBYTtBQUFBLE1BQ3RDLENBQUM7QUFDRCxnQkFBVSxpQkFBaUIsWUFBWSxNQUFNO0FBQzVDLGFBQUssa0JBQWtCLE1BQU07QUFDNUIsNEJBQWtCLE1BQU0sYUFBYTtBQUFBLFFBQ3RDLEdBQUcsaUJBQWdCLGdCQUFnQjtBQUFBLE1BQ3BDLENBQUM7QUFBQSxJQUNGLE9BQU87QUFDTixnQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLDBCQUFrQixNQUFNLGFBQWE7QUFBQSxNQUN0QyxDQUFDO0FBQ0QsZ0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QywwQkFBa0IsTUFBTSxhQUFhO0FBQUEsTUFDdEMsQ0FBQztBQUFBLElBQ0Y7QUFHQSxVQUFNLGFBQWEsS0FBSyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDbkYsZUFBVyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQUlsQixXQUFXLFNBQVMsR0FBRztBQUFBLFlBQ3RCLFdBQVcsU0FBUyxHQUFHO0FBQUE7QUFBQTtBQUFBO0FBQUEsbUJBSWhCLFdBQVcsY0FBYyxVQUFVLGtCQUFrQixXQUFXLFNBQVMsS0FBSztBQUFBO0FBQUE7QUFBQSxpQkFHaEYsV0FBVyxTQUFTLE9BQU87QUFBQTtBQUFBLGdCQUU1QixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBSXhDLFVBQU0sbUJBQW1CLFdBQVcsVUFBVSxFQUFFLEtBQUssK0JBQStCLENBQUM7QUFDckYscUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBSXJCLFdBQVcsY0FBYyxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxpQkFLaEMsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUd6QyxVQUFNLGdCQUFnQixpQkFBaUIsV0FBVztBQUNsRCxrQkFBYyxZQUFZLEtBQUssaUJBQWlCLFdBQVcsSUFBSSxlQUFlLFFBQVEsTUFBTTtBQUM1RixrQkFBYyxNQUFNLFVBQVU7QUFHOUIsVUFBTSx1QkFBdUIsSUFBSSxpQ0FBZ0IsZ0JBQWdCO0FBQ2pFLHlCQUFxQixRQUFRLFFBQVEsRUFDbkMsV0FBVyxrQ0FBa0MsRUFDN0MsUUFBUSxZQUFZO0FBQ3BCLFVBQUksS0FBSyxhQUFhO0FBQ3JCLGFBQUssZ0JBQWdCLHVCQUF1QixLQUFLLFlBQVksSUFBSTtBQUNqRSxjQUFNLEtBQUssZUFBZTtBQUFBLE1BQzNCO0FBQUEsSUFDRCxDQUFDO0FBRUYsVUFBTSxjQUFjLHFCQUFxQjtBQUN6QyxnQkFBWSxTQUFTLDRCQUE0QjtBQUNqRCxnQkFBWSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBS2hCLFdBQVcsYUFBYSxTQUFTO0FBQUE7QUFBQTtBQUFBO0FBQUEsZ0JBSS9CLFdBQVcsU0FBUyxNQUFNO0FBQUEsaUJBQ3pCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPekMsUUFBSSxVQUFVO0FBQ2Isa0JBQVksaUJBQWlCLGNBQWMsTUFBTTtBQUNoRCxvQkFBWSxNQUFNLGFBQWE7QUFDL0Isb0JBQVksTUFBTSxjQUFjO0FBQ2hDLG9CQUFZLE1BQU0sUUFBUTtBQUFBLE1BQzNCLENBQUM7QUFDRCxrQkFBWSxpQkFBaUIsWUFBWSxNQUFNO0FBQzlDLG1CQUFXLE1BQU07QUFDaEIsc0JBQVksTUFBTSxhQUFhO0FBQy9CLHNCQUFZLE1BQU0sY0FBYztBQUNoQyxzQkFBWSxNQUFNLFFBQVE7QUFBQSxRQUMzQixHQUFHLGlCQUFnQixnQkFBZ0I7QUFBQSxNQUNwQyxDQUFDO0FBQUEsSUFDRixPQUFPO0FBQ04sa0JBQVksaUJBQWlCLGNBQWMsTUFBTTtBQUNoRCxvQkFBWSxNQUFNLGFBQWE7QUFDL0Isb0JBQVksTUFBTSxjQUFjO0FBQ2hDLG9CQUFZLE1BQU0sUUFBUTtBQUFBLE1BQzNCLENBQUM7QUFDRCxrQkFBWSxpQkFBaUIsY0FBYyxNQUFNO0FBQ2hELG9CQUFZLE1BQU0sYUFBYTtBQUMvQixvQkFBWSxNQUFNLGNBQWM7QUFDaEMsb0JBQVksTUFBTSxRQUFRO0FBQUEsTUFDM0IsQ0FBQztBQUFBLElBQ0Y7QUFHQSxVQUFNLFlBQVksV0FBVyxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUV2RSxZQUFRLFFBQVEsQ0FBQyxLQUFLLFVBQVU7QUFDL0IsWUFBTSxZQUFZLFVBQVUsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDdEUsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUEsZUFJZCxXQUFXLGNBQWMsVUFBVTtBQUFBLHFCQUM3QixRQUFRLFFBQVEsU0FBUyxJQUFJLGdEQUFnRCxNQUFNO0FBQUE7QUFBQSxrQkFFdEYsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUd6QyxZQUFNLFlBQVksVUFBVSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUN0RSxnQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUEsV0FHbEIsV0FBVyxTQUFTLEtBQUs7QUFBQTtBQUFBO0FBQUE7QUFLakMsWUFBTSxTQUFTLFVBQVUsV0FBVztBQUNwQyxhQUFPLFlBQVksS0FBSyxpQkFBaUIsV0FBVztBQUNwRCxhQUFPLE1BQU0sVUFBVTtBQUV2QixZQUFNLFNBQVMsVUFBVSxXQUFXLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNwRSxZQUFNLFNBQVMsSUFBSSxXQUFXLElBQUksSUFBSSxRQUFRLEtBQUs7QUFDbkQsYUFBTyxjQUFjLEdBQUcsSUFBSSxLQUFLLFFBQVEsR0FBRyxNQUFNO0FBQ2xELGFBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVN2QixhQUFPLFFBQVEsU0FBUyxHQUFHLElBQUksS0FBSyxJQUFJLDBCQUEwQjtBQUdsRSxZQUFNLGFBQWEsVUFBVSxXQUFXLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUN4RSxpQkFBVyxjQUFjO0FBQ3pCLGlCQUFXLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBYTNCLFlBQU0sWUFBWSxVQUFVLFNBQVMsVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDakYsZ0JBQVUsWUFBWSxLQUFLLGlCQUFpQixLQUFLLFdBQVcsU0FBUyxNQUFNO0FBQzNFLGdCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsYUFLaEIsV0FBVyxTQUFTLE1BQU07QUFBQSxjQUN6QixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsaUJBS3ZCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBSXhDLGdCQUFVLFFBQVEsU0FBUyxVQUFVLElBQUksS0FBSyxRQUFRLEVBQUU7QUFFeEQsZ0JBQVUsaUJBQWlCLFNBQVMsT0FBTyxNQUFhO0FBQ3ZELFVBQUUsZ0JBQWdCO0FBQ2xCLFlBQUksS0FBSyxhQUFhO0FBQ3JCLGVBQUssZ0JBQWdCLG9CQUFvQixLQUFLLFlBQVksTUFBTSxJQUFJLEtBQUssSUFBSTtBQUM3RSxnQkFBTSxLQUFLLGVBQWU7QUFBQSxRQUMzQjtBQUFBLE1BQ0QsQ0FBQztBQUdELFVBQUksVUFBVTtBQUNiLGtCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsb0JBQVUsTUFBTSxhQUFhO0FBQzdCLG9CQUFVLE1BQU0sUUFBUTtBQUFBLFFBQ3pCLENBQUM7QUFFRCxrQkFBVSxpQkFBaUIsWUFBWSxNQUFNO0FBQzVDLHFCQUFXLE1BQU07QUFDaEIsc0JBQVUsTUFBTSxhQUFhO0FBQzdCLHNCQUFVLE1BQU0sUUFBUTtBQUFBLFVBQ3pCLEdBQUcsaUJBQWdCLGdCQUFnQjtBQUFBLFFBQ3BDLENBQUM7QUFHRCxrQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLG9CQUFVLE1BQU0sYUFBYTtBQUFBLFFBQzlCLENBQUM7QUFFRCxrQkFBVSxpQkFBaUIsWUFBWSxNQUFNO0FBQzVDLHFCQUFXLE1BQU07QUFDaEIsc0JBQVUsTUFBTSxhQUFhO0FBQUEsVUFDOUIsR0FBRyxpQkFBZ0IsZ0JBQWdCO0FBQUEsUUFDcEMsQ0FBQztBQUFBLE1BQ0YsT0FBTztBQUNOLGtCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsb0JBQVUsTUFBTSxhQUFhO0FBQzdCLG9CQUFVLE1BQU0sUUFBUTtBQUFBLFFBQ3pCLENBQUM7QUFFRCxrQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLG9CQUFVLE1BQU0sYUFBYTtBQUM3QixvQkFBVSxNQUFNLFFBQVE7QUFBQSxRQUN6QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFBQSxRQUM5QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFBQSxRQUM5QixDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0QsQ0FBQztBQUdELFFBQUksYUFBYTtBQUVqQixVQUFNLGlCQUFpQixDQUFDLE1BQWtCO0FBQ3pDLFFBQUUsZ0JBQWdCO0FBQ2xCLG1CQUFhLENBQUM7QUFFZCxVQUFJLFlBQVk7QUFDZixtQkFBVyxNQUFNLFVBQVU7QUFDM0IsYUFBSyxpQkFBaUIsTUFBTSxTQUFTO0FBQUEsTUFDdEMsT0FBTztBQUNOLG1CQUFXLE1BQU0sVUFBVTtBQUMzQixhQUFLLGlCQUFpQixNQUFNLFNBQVM7QUFBQSxNQUN0QztBQUFBLElBQ0Q7QUFHQSxjQUFVLGlCQUFpQixTQUFTLGNBQWM7QUFHbEQsVUFBTSxlQUE4QixDQUFDLE1BQWE7QUFDakQsVUFBSSxjQUFjLENBQUMsS0FBSyxpQkFBaUIsU0FBUyxFQUFFLE1BQWMsR0FBRztBQUNwRSxxQkFBYTtBQUNiLG1CQUFXLE1BQU0sVUFBVTtBQUMzQixhQUFLLGlCQUFpQixNQUFNLFNBQVM7QUFBQSxNQUN0QztBQUFBLElBQ0Q7QUFFQSxTQUFLLHdCQUF3QixVQUFVLFNBQVMsWUFBWTtBQUFBLEVBQzdEO0FBQUEsRUFFQSxNQUFjLGlCQUFnQztBQUM3QyxRQUFJLEtBQUssYUFBYTtBQUNyQixZQUFNLFNBQVMsTUFBTSxLQUFLLGdCQUFnQixhQUFhLElBQUksS0FBSyxXQUFXO0FBQzNFLFdBQUssaUJBQWlCLE9BQU87QUFDN0IsV0FBSyx1QkFBdUI7QUFBQSxJQUM3QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsV0FBVyxTQUFrQjtBQTN3QzVDO0FBNndDRSxVQUFNLGNBQWMsV0FBVyxLQUFLLGFBQWEsU0FBUyxFQUFFLEtBQUs7QUFDakUsUUFBSSxDQUFDLFlBQWE7QUFHbEIsVUFBTSxzQkFBc0IsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLHVCQUF1QjtBQUN2RixRQUFJLENBQUMscUJBQXFCO0FBQ3pCLFdBQUssZ0JBQWdCLEtBQUssa0JBQWtCLGdCQUFnQiwrRkFBK0YsQ0FBQztBQUM1SjtBQUFBLElBQ0Q7QUFHQSxRQUFJLFlBQVksV0FBVyxHQUFHLEdBQUc7QUFDaEMsWUFBTSxnQkFBZ0IsTUFBTSxLQUFLLG1CQUFtQixXQUFXO0FBQy9ELFVBQUksZUFBZTtBQUNsQixhQUFLLGFBQWEsU0FBUyxFQUFFO0FBQzdCO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFHQSxRQUFJLG1CQUFtQjtBQUN2QixRQUFJLGtCQUEwQztBQUU5QyxRQUFJLEtBQUssYUFBYTtBQUVyQixVQUFJLENBQUMsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLG1CQUFtQixHQUFHO0FBQ3RFLFlBQUksWUFBWSxTQUFTLElBQUksS0FBSyxZQUFZLFNBQVMsS0FBSyxHQUFHO0FBQzlELGVBQUssV0FBVyxVQUFVLEtBQUssa0JBQWtCLGFBQWEsdUhBQXVILENBQUM7QUFDdEw7QUFBQSxRQUNEO0FBQUEsTUFDRCxPQUFPO0FBRU4sY0FBTSxnQkFBZ0IsTUFBTSxLQUFLLGdCQUFnQixhQUFhLGFBQWEsS0FBSyxXQUFXO0FBQzNGLDJCQUFtQixjQUFjO0FBQ2pDLDBCQUFrQixjQUFjO0FBQ2hDLGFBQUssaUJBQWlCO0FBR3RCLGFBQUssdUJBQXVCO0FBSTVCLGNBQU0sNEJBQTBCLFVBQUssbUJBQUwsbUJBQXFCLGVBQWUsV0FBVTtBQUM5RSxjQUFNLHlCQUF5QixnQkFBZ0IsZUFBZTtBQUM5RCxjQUFNLGFBQWEseUJBQXlCO0FBQzVDLGNBQU0sdUJBQXVCLGlCQUFpQixLQUFLLEVBQUUsV0FBVyxLQUFLO0FBRXJFLFlBQUksc0JBQXNCO0FBRXpCLGdCQUFNLGVBQWUseUJBQXlCO0FBQzlDLGNBQUksZUFBZSxHQUFHO0FBRXJCLGtCQUFNLFVBQVUsZ0JBQWdCLGVBQWUsTUFBTSxDQUFDLFlBQVk7QUFDbEUsa0JBQU0sV0FBVyxRQUFRLElBQUksU0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFLEtBQUssSUFBSTtBQUNoRSxpQkFBSyxrQkFBa0IsS0FBSyxrQkFBa0IsZ0JBQWdCLFNBQVMsWUFBWSxZQUFZLGlCQUFpQixJQUFJLE1BQU0sRUFBRSwyQkFBMkIsUUFBUSxFQUFFLENBQUM7QUFBQSxVQUNuSztBQUdBLGVBQUssYUFBYSxTQUFTLEVBQUU7QUFDN0IsZUFBSyx1QkFBdUI7QUFHNUIsY0FBSSxLQUFLLGdCQUFnQjtBQUN4QixpQkFBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLFVBQ3JDO0FBQ0E7QUFBQSxRQUNEO0FBR0EsWUFBSSxnQkFBZ0IsZUFBZSxTQUFTLEdBQUc7QUFDOUMsZ0JBQU0sVUFBVSxnQkFBZ0I7QUFDaEMsZ0JBQU0sV0FBVyxRQUFRLElBQUksU0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFLEtBQUssSUFBSTtBQUNoRSxnQkFBTSxZQUFZLGdCQUFnQixhQUFhLElBQUksTUFBTSxnQkFBZ0IsVUFBVSxhQUFhO0FBQ2hHLGdCQUFNLGdCQUFjLFVBQUssZ0JBQUwsbUJBQWtCLGFBQVk7QUFDbEQsZUFBSyxXQUFXLFVBQVUsS0FBSyxrQkFBa0IsYUFBYSxZQUFZLFFBQVEsTUFBTSxZQUFZLFFBQVEsV0FBVyxJQUFJLE1BQU0sRUFBRSxnQkFBZ0IsUUFBUSxHQUFHLFNBQVMscUVBQXFFLFdBQVcsR0FBRyxDQUFDO0FBQUEsUUFDNVA7QUFHQSxZQUFJLGdCQUFnQixhQUFhO0FBQ2hDLGNBQUksd0JBQU8sd0ZBQThFLGlCQUFnQixrQkFBa0I7QUFBQSxRQUM1SDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsU0FBSyxXQUFXLFFBQVEsV0FBVztBQUNuQyxTQUFLLGFBQWEsU0FBUyxFQUFFO0FBRzdCLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLElBQ3JDO0FBR0EsVUFBTSxhQUFjLEtBQUssYUFBcUI7QUFDOUMsUUFBSSxXQUFZLFlBQVcsWUFBWSxJQUFJO0FBRTNDLFFBQUk7QUFFSCxZQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUN0RSxnQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWExQixZQUFNLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ3pFLG9CQUFjLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVMxQixZQUFNLFNBQVMsVUFBVSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNuRSxhQUFPLE1BQU0sVUFBVTtBQUd2QixZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUNwRCxVQUFJLFlBQVk7QUFDZixjQUFNLEtBQUssT0FBTyxlQUFlLGVBQWUsV0FBVztBQUFBLE1BQzVEO0FBR0EsWUFBTSxrQkFBa0IsS0FBSyxPQUFPLGNBQWMsaUJBQWlCLEVBQUUsZ0JBQWdCO0FBQ3JGLFVBQUksV0FBMEI7QUFFOUIsVUFBSSxtQkFBbUIsWUFBWTtBQUVsQyxjQUFNLGdCQUFnQixLQUFLLE9BQU8sY0FBYyxhQUFhLGdCQUFnQjtBQUM3RSxtQkFBVyxNQUFNLEtBQUssZUFBZSxhQUFhO0FBQUEsTUFDbkQsT0FBTztBQUVOLGNBQU1DLFVBQVMsTUFBTSxLQUFLLE9BQU8sY0FBYyxzQkFBc0Isa0JBQWtCLGNBQWMsTUFBUztBQUc5RyxZQUFJLG1CQUFtQixnQkFBZ0IsZUFBZTtBQUVyRCxnQkFBTSxxQkFBcUIsR0FBRyxnQkFBZ0IsYUFBYTtBQUFBO0FBQUE7QUFBQTtBQUFBLGdCQUE0QixnQkFBZ0I7QUFHdkcscUJBQVcsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLFNBQVNBLFFBQU8sZ0JBQWdCLElBQUksb0JBQW9CO0FBQUEsWUFDdEcsYUFBYUEsUUFBTyxPQUFPO0FBQUEsWUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsVUFDMUIsQ0FBQztBQUFBLFFBQ0YsT0FBTztBQUVOLHFCQUFXLE1BQU0sS0FBSyxPQUFPLGtCQUFrQixTQUFTQSxRQUFPLGdCQUFnQixJQUFJQSxRQUFPLFlBQVk7QUFBQSxZQUNyRyxhQUFhQSxRQUFPLE9BQU87QUFBQSxZQUMzQixXQUFXQSxRQUFPLE9BQU87QUFBQSxVQUMxQixDQUFDO0FBQUEsUUFDRjtBQUFBLE1BQ0Q7QUFHQSxnQkFBVSxPQUFPO0FBR2pCLFlBQU0sbUJBQW1CLFdBQVcsS0FBSyxzQkFBc0IsUUFBUSxJQUFJO0FBRzNFLFVBQUksY0FBYyxrQkFBa0I7QUFDbkMsY0FBTSxLQUFLLE9BQU8sZUFBZSxvQkFBb0IsZ0JBQWdCO0FBQUEsTUFDdEU7QUFHQSxVQUFJLGtCQUFrQjtBQUVyQixZQUFJLGlCQUFpQixTQUFTLFVBQVUsS0FDdkMsaUJBQWlCLFNBQVMseUJBQXlCLEtBQ25ELGlCQUFpQixTQUFTLFdBQVcsS0FDckMsaUJBQWlCLFNBQVMsMEJBQTBCLEtBQ3BELGlCQUFpQixTQUFTLGtCQUFrQixLQUM1QyxpQkFBaUIsU0FBUyxlQUFlLEdBQUc7QUFDNUMsZUFBSyxnQkFBZ0IsZ0JBQWdCO0FBQUEsUUFDdEMsT0FBTztBQUNOLGVBQUssV0FBVyxhQUFhLGdCQUFnQjtBQUFBLFFBQzlDO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBRWYsWUFBTSxZQUFZLEtBQUssY0FBYyxjQUFjLGVBQWU7QUFDbEUsVUFBSSxVQUFXLFdBQVUsT0FBTztBQUVoQyxXQUFLLGdCQUFnQixLQUFLLGtCQUFrQixZQUFZLGtDQUFtQyxNQUFnQixPQUFPLEVBQUUsQ0FBQztBQUFBLElBQ3RILFVBQUU7QUFFRCxZQUFNQyxjQUFjLEtBQUssYUFBcUI7QUFDOUMsVUFBSUEsWUFBWSxDQUFBQSxZQUFXLFlBQVksS0FBSztBQUU1QyxZQUFNLEtBQUssZUFBZTtBQUFBLElBQzNCO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSx5QkFBeUIsTUFBYztBQUM1QyxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLHlCQUFRO0FBQ2xFLFFBQUksY0FBYyxZQUFZLFlBQVk7QUFDekMsWUFBTSxTQUFVLFdBQW1CO0FBQ25DLFVBQUksUUFBUTtBQUNYLGNBQU0sU0FBUyxPQUFPLFVBQVU7QUFDaEMsZUFBTyxhQUFhLE1BQU0sTUFBTTtBQUFBLE1BQ2pDO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsZUFBZSxTQUE4QztBQUMxRSxRQUFJO0FBRUgsVUFBSSxDQUFDLEtBQUssYUFBYTtBQUN0QixlQUFPLEtBQUssa0JBQWtCLFlBQVkscUZBQXFGO0FBQUEsTUFDaEk7QUFHQSxZQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLFVBQVU7QUFDNUQsVUFBSSxlQUFvQztBQUd4QyxpQkFBVyxRQUFRLFFBQVE7QUFDMUIsY0FBTSxPQUFPLEtBQUs7QUFDbEIsWUFBSSxLQUFLLFNBQVMsS0FBSyxhQUFhO0FBQ25DLHlCQUFlO0FBQ2Y7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUdBLFVBQUksQ0FBQyxjQUFjO0FBQ2xCLGNBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxRQUFRLEtBQUs7QUFDN0MsWUFBSSxNQUFNO0FBQ1QsZ0JBQU0sS0FBSyxTQUFTLEtBQUssV0FBVztBQUNwQyx5QkFBZSxLQUFLO0FBQUEsUUFDckI7QUFBQSxNQUNEO0FBRUEsVUFBSSxDQUFDLGNBQWM7QUFDbEIsZUFBTyxLQUFLLGtCQUFrQixZQUFZLDhCQUE4QixLQUFLLFlBQVksUUFBUSw4Q0FBOEM7QUFBQSxNQUNoSjtBQUlBLFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBQ3BELFVBQUksQ0FBQyxjQUFjLGVBQWUsS0FBSyxhQUFhO0FBRW5ELGFBQUssSUFBSSxVQUFVLGNBQWMsYUFBYSxNQUFNLEVBQUUsT0FBTyxLQUFLLENBQUM7QUFHbkUsY0FBTSxnQkFBZ0IsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUN2RCxZQUFJLENBQUMsaUJBQWlCLGtCQUFrQixLQUFLLGFBQWE7QUFDekQsaUJBQU8sS0FBSyxrQkFBa0IsWUFBWSxrQkFBa0IsS0FBSyxZQUFZLFFBQVEsd0lBQXdJO0FBQUEsUUFDOU47QUFBQSxNQUNEO0FBRUEsVUFBSTtBQUVKLGNBQVEsUUFBUSxRQUFRO0FBQUEsUUFDdkIsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSyxPQUFPLGtCQUFrQixRQUFRLE9BQU87QUFDNUQ7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssT0FBTyxtQkFBbUIsUUFBUSxPQUFPO0FBQzdEO0FBQUEsUUFDRCxLQUFLO0FBQ0osbUJBQVMsTUFBTSxLQUFLLE9BQU8scUJBQXFCLFFBQVEsT0FBTztBQUMvRDtBQUFBLFFBQ0QsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSyxPQUFPLHNCQUFzQixRQUFRLE9BQU87QUFDaEU7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssT0FBTyxzQkFBc0IsUUFBUSxPQUFPO0FBQ2hFO0FBQUEsUUFDRCxLQUFLO0FBQ0osbUJBQVMsTUFBTSxLQUFLLE9BQU8sdUJBQXVCLFFBQVEsT0FBTztBQUNqRTtBQUFBLFFBQ0Q7QUFDQyxpQkFBTyxtQ0FBbUMsUUFBUSxNQUFNO0FBQUEsTUFDMUQ7QUFFQSxVQUFJLE9BQU8sU0FBUztBQUVuQixhQUFLLG9CQUFvQixRQUFRLE1BQU07QUFDdkMsZUFBTztBQUFBLE1BQ1IsT0FBTztBQUNOLGVBQU8sYUFBYSxRQUFRLE1BQU0sS0FBSyxPQUFPLEtBQUs7QUFBQSxNQUNwRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsYUFBTyxLQUFLLGtCQUFrQixZQUFZLDRCQUE2QixNQUFnQixPQUFPLEVBQUU7QUFBQSxJQUNqRztBQUFBLEVBQ0Q7QUFBQSxFQUdBLE1BQWMsZ0NBQWdDO0FBQzdDLFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBR3BELFFBQUksYUFBYTtBQUNqQixRQUFJLENBQUMsWUFBWTtBQUNoQixZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVU7QUFDdEMsVUFBSSxjQUFjLFdBQVcsZ0JBQWdCLCtCQUFjO0FBQzFELHFCQUFhLFdBQVcsS0FBSztBQUFBLE1BQzlCLE9BQU87QUFFTixjQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLFVBQVU7QUFDNUQsWUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixnQkFBTSxPQUFPLE9BQU8sQ0FBQyxFQUFFO0FBQ3ZCLHVCQUFhLEtBQUs7QUFBQSxRQUNuQjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsUUFBSSxDQUFDLGNBQWMsS0FBSyxhQUFhO0FBQ3BDLFdBQUssY0FBYztBQUNuQixXQUFLLGNBQWMsTUFBTTtBQUN6QixXQUFLLGVBQWU7QUFDcEIsV0FBSyxrQkFBa0IsaUNBQWlDO0FBQ3hEO0FBQUEsSUFDRDtBQUdBLFFBQUksQ0FBQyxjQUFjLGVBQWUsS0FBSyxhQUFhO0FBQ25EO0FBQUEsSUFDRDtBQUVBLFNBQUssY0FBYztBQUduQixTQUFLLGNBQWMsTUFBTTtBQUd6QixVQUFNLEtBQUssZUFBZTtBQUUxQixRQUFJO0FBRUgsWUFBTSxpQkFBaUIsTUFBTSxLQUFLLE9BQU8sb0JBQW9CLGtCQUFrQixZQUFZLEVBQUU7QUFFN0YsVUFBSSxlQUFlLFNBQVMsR0FBRztBQUU5Qix1QkFBZSxRQUFRLFNBQU87QUFDN0IsY0FBSSxJQUFJLFNBQVMsVUFBVTtBQUMxQixpQkFBSyxXQUFXLElBQUksTUFBOEIsSUFBSSxPQUFPO0FBQUEsVUFDOUQ7QUFBQSxRQUNELENBQUM7QUFBQSxNQUNGLE9BQU87QUFFTixhQUFLLGtCQUFrQixlQUFlLFdBQVcsUUFBUSxJQUFJO0FBQUEsTUFDOUQ7QUFBQSxJQUNELFNBQVMsT0FBTztBQUdmLFdBQUssa0JBQWtCLGVBQWUsV0FBVyxRQUFRLElBQUk7QUFBQSxJQUM5RDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsWUFBWTtBQUV6QixTQUFLLGNBQWMsTUFBTTtBQUd6QixRQUFJLEtBQUssYUFBYTtBQUNyQixVQUFJO0FBQ0gsY0FBTSxLQUFLLE9BQU8sb0JBQW9CLGtCQUFrQixLQUFLLFdBQVc7QUFFeEUsYUFBSyxnQkFBZ0IsdUJBQXVCLEtBQUssWUFBWSxJQUFJO0FBQ2pFLGFBQUssaUJBQWlCO0FBQ3RCLFlBQUksS0FBSyxrQkFBa0I7QUFDMUIsZUFBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQUEsUUFDdkM7QUFBQSxNQUNELFNBQVMsT0FBTztBQUFBLE1BRWhCO0FBQUEsSUFDRDtBQUdBLFFBQUksS0FBSyxhQUFhO0FBQ3JCLFdBQUssa0JBQWtCLGVBQWU7QUFBQSxJQUN2QyxPQUFPO0FBQ04sV0FBSyxrQkFBa0IsZUFBZTtBQUFBLElBQ3ZDO0FBR0EsUUFBSSx3QkFBTyxzQkFBc0I7QUFBQSxFQUNsQztBQUFBO0FBQUEsRUFHQSxNQUFNLFlBQVksU0FBZ0M7QUFDakQsVUFBTSxhQUFhLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFHNUQsVUFBTUQsVUFBUyxNQUFNLEtBQUssT0FBTyxjQUFjLHNCQUFzQixTQUFTLGNBQWMsTUFBUztBQUdyRyxVQUFNLFVBQVUsS0FBSyxPQUFPLGNBQWMsYUFBYSxPQUFPO0FBRzlELFVBQU0sZUFBZSxDQUFDLE9BQU8sUUFBUSxVQUFVLFdBQVcsV0FBVyxVQUFVO0FBQy9FLFFBQUksYUFBYSxTQUFTLFFBQVEsTUFBTSxHQUFHO0FBSTFDLFlBQU0sb0JBQW9CLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFDbkUsVUFBSSxjQUFjLHFCQUFxQixzQkFBc0IsWUFBWTtBQUN4RSxjQUFNLElBQUksTUFBTSx1RUFBdUUsV0FBVyxRQUFRLGFBQWEsa0JBQWtCLFFBQVEsRUFBRTtBQUFBLE1BQ3BKO0FBR0EsY0FBUSxRQUFRLFFBQVE7QUFBQSxRQUN2QixLQUFLO0FBQ0osZ0JBQU0sS0FBSyxPQUFPLGtCQUFrQixRQUFRLE9BQU87QUFDbkQ7QUFBQSxRQUNELEtBQUs7QUFDSixnQkFBTSxLQUFLLE9BQU8sbUJBQW1CLFFBQVEsT0FBTztBQUNwRDtBQUFBLFFBQ0QsS0FBSztBQUNKLGdCQUFNLEtBQUssT0FBTyxxQkFBcUIsUUFBUSxPQUFPO0FBQ3REO0FBQUEsUUFDRCxLQUFLO0FBQ0osZ0JBQU0sS0FBSyxPQUFPLHNCQUFzQixRQUFRLE9BQU87QUFDdkQ7QUFBQSxRQUNELEtBQUs7QUFDSixnQkFBTSxLQUFLLE9BQU8sc0JBQXNCLFFBQVEsT0FBTztBQUN2RDtBQUFBLFFBQ0QsS0FBSztBQUNKLGdCQUFNLEtBQUssT0FBTyx1QkFBdUIsUUFBUSxPQUFPO0FBQ3hEO0FBQUEsTUFDRjtBQUFBLElBQ0QsT0FBTztBQUVOLFVBQUksWUFBWTtBQUNmLGNBQU0sS0FBSyxPQUFPLG9CQUFvQixlQUFlLFlBQVksU0FBUyxJQUFXO0FBQUEsTUFDdEY7QUFHQSxZQUFNLEtBQUssT0FBTyxrQkFBa0IsU0FBU0EsUUFBTyxnQkFBZ0IsSUFBSUEsUUFBTyxVQUFVO0FBRXpGLFVBQUksWUFBWTtBQUNmLGNBQU0sS0FBSyxPQUFPLG9CQUFvQixvQkFBb0IsWUFBWSxlQUFlLEVBQUUsU0FBUyxNQUFNLFVBQVUsT0FBTyxDQUFRO0FBQUEsTUFDaEk7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSx3QkFBd0IsTUFBMEI7QUFDdkQsVUFBTSxXQUFXLE1BQU0sS0FBSyxPQUFPLG9CQUFvQixrQkFBa0IsTUFBTSxFQUFFO0FBQUEsRUFFbEY7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9BLE1BQWMsd0JBQXVDO0FBQ3BELFVBQU0sc0JBQXNCLE1BQU0sS0FBSyxPQUFPLGtCQUFrQix1QkFBdUI7QUFDdkYsVUFBTSxhQUFjLEtBQUssYUFBcUI7QUFDOUMsUUFBSSxXQUFZLFlBQVcsWUFBWSxDQUFDLG1CQUFtQjtBQUFBLEVBQzVEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUF1QixrQkFBOEM7QUFDbEYsVUFBTSxzQkFBc0IsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLHVCQUF1QjtBQUV2RixRQUFJLHFCQUFxQjtBQUN4QixZQUFNLGtCQUFrQix3QkFBd0I7QUFDaEQsWUFBTSxXQUFXLGtCQUFrQixTQUFTO0FBQzVDLFlBQU0sVUFBVSxrQkFBa0IsaURBQWlEO0FBR25GLG9DQUFRLGtCQUFrQixRQUFRO0FBR2xDLHVCQUFpQixhQUFhLGNBQWMsT0FBTztBQUNuRCx1QkFBaUIsYUFBYSxTQUFTLE9BQU87QUFBQSxJQUMvQyxPQUFPO0FBRU4sb0NBQVEsa0JBQWtCLGFBQWE7QUFDdkMsdUJBQWlCLGFBQWEsY0FBYyxzQkFBc0I7QUFDbEUsdUJBQWlCLGFBQWEsU0FBUyxzQkFBc0I7QUFBQSxJQUM5RDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTVEsc0JBQXNCLFNBQXlCO0FBR3RELFdBQU8sUUFBUSxRQUFRLDZDQUE2QyxFQUFFLEVBQUUsS0FBSztBQUFBLEVBQzlFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHdCQUF1QztBQXB3RHREO0FBc3dERSxRQUFLLEtBQWEsa0JBQWtCO0FBQ25DLFlBQU0sS0FBSyx1QkFBd0IsS0FBYSxnQkFBZ0I7QUFBQSxJQUNqRTtBQUdBLFNBQUssc0JBQXNCO0FBRzNCLFNBQUssVUFBYSw0QkFBYixtQkFBc0MsdUJBQXVCO0FBQ2pFLFlBQU8sS0FBYSx3QkFBd0Isc0JBQXNCO0FBQUEsSUFDbkU7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx1QkFBdUIsV0FBOEI7QUFDNUQsVUFBTSxvQkFBb0IsVUFBVSxVQUFVLEVBQUUsS0FBSyxtQ0FBbUMsQ0FBQztBQUN6RixzQkFBa0IsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPbEMsVUFBTSxpQkFBaUIsa0JBQWtCLFNBQVMsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDM0YsbUJBQWUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZS9CLFVBQU0sZUFBZSxlQUFlLFdBQVcsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUdyRSxVQUFNLGdCQUFnQixlQUFlLFdBQVcsRUFBRSxNQUFNLFNBQUksQ0FBQztBQUM3RCxrQkFBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU85QixVQUFNLGVBQWUsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLDhCQUE4QixDQUFDO0FBQ3ZGLGlCQUFhLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWM3QixRQUFJLGlCQUFpQjtBQUdyQixVQUFNLHdCQUF3QixZQUFZO0FBQ3pDLFlBQU0sc0JBQXNCLE1BQU0sS0FBSyxPQUFPLGtCQUFrQix1QkFBdUI7QUFDdkYsVUFBSSxxQkFBcUI7QUFDeEIsY0FBTSxjQUFjLEtBQUssZ0NBQWdDLG1CQUFtQjtBQUM1RSxxQkFBYSxRQUFRLFdBQVc7QUFBQSxNQUNqQyxPQUFPO0FBQ04sY0FBTSxzQkFBc0IsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLHVCQUF1QjtBQUN2RixxQkFBYSxRQUFRLG1CQUFtQjtBQUFBLE1BQ3pDO0FBQUEsSUFDRDtBQUdBLFVBQU0saUJBQWlCLE1BQU07QUFDNUIsdUJBQWlCLENBQUM7QUFDbEIsbUJBQWEsTUFBTSxVQUFVLGlCQUFpQixVQUFVO0FBQ3hELG9CQUFjLE1BQU0sWUFBWSxpQkFBaUIsbUJBQW1CO0FBRXBFLFVBQUksZ0JBQWdCO0FBQ25CLGFBQUsseUJBQXlCLFlBQVk7QUFBQSxNQUMzQztBQUFBLElBQ0Q7QUFHQSxVQUFNLGdCQUErQixDQUFDLFVBQWlCO0FBQ3RELFVBQUksQ0FBQyxrQkFBa0IsU0FBUyxNQUFNLE1BQWMsR0FBRztBQUN0RCx5QkFBaUI7QUFDakIscUJBQWEsTUFBTSxVQUFVO0FBQzdCLHNCQUFjLE1BQU0sWUFBWTtBQUFBLE1BQ2pDO0FBQUEsSUFDRDtBQUVBLG1CQUFlLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUMvQyxRQUFFLGdCQUFnQjtBQUNsQixxQkFBZTtBQUFBLElBQ2hCLENBQUM7QUFHRCxTQUFLLHdCQUF3QixVQUFVLFNBQVMsYUFBYTtBQUc3RCwwQkFBc0I7QUFHdEIsSUFBQyxLQUFhLDBCQUEwQjtBQUFBLE1BQ3ZDO0FBQUEsTUFDQSxTQUFTLE1BQU0sU0FBUyxvQkFBb0IsU0FBUyxhQUFhO0FBQUEsSUFDbkU7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxtQkFBbUIsY0FBMEQ7QUFDcEYsV0FBTyxtQkFBbUIsY0FBYyxLQUFLLE9BQU8sUUFBUTtBQUFBLEVBQzdEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsY0FBOEI7QUF2NER2RDtBQXc0REUsVUFBTSxZQUFZLEtBQUssT0FBTyxTQUFTO0FBQ3ZDLFVBQU0sZ0JBQWUsZUFBVSxZQUFZLE1BQXRCLG1CQUF5QjtBQUU5QyxRQUFJLGNBQWM7QUFDakIsYUFBTztBQUFBLElBQ1I7QUFHQSxVQUFNLGtCQUFrQixLQUFLLG1CQUFtQixZQUFZO0FBQzVELFdBQU8sZ0JBQWdCLFNBQVMsSUFBSSxnQkFBZ0IsQ0FBQyxFQUFFLFFBQVE7QUFBQSxFQUNoRTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esb0JBQW9CLGNBQXNCLFlBQTRCO0FBQzdFLFVBQU0sU0FBUyxLQUFLLG1CQUFtQixZQUFZO0FBQ25ELFVBQU0sUUFBUSxPQUFPLEtBQUssT0FBSyxFQUFFLFVBQVUsVUFBVTtBQUNyRCxXQUFPLFFBQVEsTUFBTSxRQUFRO0FBQUEsRUFDOUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsY0FBYyxjQUFzQixZQUFtQztBQUVwRixVQUFNLHNCQUFzQixNQUFNLEtBQUssT0FBTyxrQkFBa0IsdUJBQXVCO0FBQ3ZGLFVBQU0sb0JBQW9CLHdCQUF3QjtBQUdsRCxVQUFNLFlBQVksS0FBSyxPQUFPLFNBQVM7QUFDdkMsY0FBVSxZQUFZLEVBQUUsUUFBUTtBQUNoQyxVQUFNLEtBQUssT0FBTyxhQUFhO0FBRS9CLFFBQUksbUJBQW1CO0FBRXRCLFlBQU0sWUFBWSxLQUFLLG9CQUFvQixjQUFjLFVBQVU7QUFDbkUsWUFBTSxlQUFlLEtBQUssdUJBQXVCLFlBQVk7QUFDN0QsWUFBTSxnQkFBZ0IsS0FBSyxrQkFBa0IsY0FBYyxlQUFlLFlBQVksSUFBSSxTQUFTLEVBQUU7QUFDckcsV0FBSyxXQUFXLFVBQVUsYUFBYTtBQUFBLElBQ3hDLE9BQU87QUFFTixZQUFNLEtBQUssaUJBQWlCLFlBQVk7QUFBQSxJQUN6QztBQUdBLFFBQUssS0FBYSx5QkFBeUI7QUFDMUMsTUFBQyxLQUFhLHdCQUF3QixzQkFBc0I7QUFBQSxJQUM3RDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMseUJBQXlCLGNBQTBDO0FBOTdEbEY7QUErN0RFLGlCQUFhLE1BQU07QUFFbkIsVUFBTSxtQkFBbUIsS0FBSyxPQUFPLGtCQUFrQixvQkFBb0I7QUFDM0UsVUFBTSxzQkFBc0IsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLHVCQUF1QjtBQUV2RixlQUFXLGdCQUFnQixrQkFBa0I7QUFDNUMsVUFBSSxpQkFBaUIsT0FBUTtBQUc3QixZQUFNLFlBQVksS0FBSyxPQUFPLFNBQVM7QUFDdkMsWUFBTSxhQUFZLGVBQVUsWUFBWSxNQUF0QixtQkFBeUI7QUFDM0MsVUFBSSxDQUFDLGFBQWEsaUJBQWlCLFNBQVU7QUFFN0MsWUFBTSxTQUFTLEtBQUssbUJBQW1CLFlBQVk7QUFDbkQsWUFBTSxlQUFlLEtBQUssZ0JBQWdCLFlBQVk7QUFDdEQsWUFBTSxjQUFjLEtBQUssdUJBQXVCLFlBQVk7QUFDNUQsWUFBTSxZQUFZLGdCQUFnQjtBQUdsQyxZQUFNLG9CQUFvQixhQUFhLFVBQVUsRUFBRSxLQUFLLDBCQUEwQixDQUFDO0FBR25GLFlBQU0sZUFBZSxrQkFBa0IsVUFBVSxFQUFFLEtBQUssOEJBQThCLENBQUM7QUFDdkYsbUJBQWEsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFhN0IsWUFBTSxjQUFjLGFBQWEsV0FBVztBQUM1QyxrQkFBWSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxrQkFJYixLQUFLLGlCQUFpQixZQUFZLENBQUM7QUFBQTtBQUlsRCxZQUFNLFdBQVcsYUFBYSxXQUFXLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDOUQsZUFBUyxNQUFNLE9BQU87QUFHdEIsVUFBSSxjQUFrQztBQUN0QyxVQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLHNCQUFjLGFBQWEsV0FBVyxFQUFFLE1BQU0sU0FBSSxDQUFDO0FBQ25ELG9CQUFZLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLN0I7QUFHQSxVQUFJLFdBQVc7QUFDZCxxQkFBYSxNQUFNLGFBQWE7QUFDaEMsaUJBQVMsTUFBTSxhQUFhO0FBQUEsTUFDN0I7QUFHQSxVQUFJLGFBQWlDO0FBQ3JDLFVBQUksYUFBYTtBQUVqQixVQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLHFCQUFhLGtCQUFrQixVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUN2RSxtQkFBVyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUEsOEJBR0QsS0FBSyxpQkFBaUIsWUFBWSxDQUFDO0FBQUE7QUFBQTtBQUs3RCxtQkFBVyxTQUFTLFFBQVE7QUFDM0IsZ0JBQU0sWUFBWSxXQUFXLFVBQVUsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQ2pFLG9CQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVkxQixnQkFBTSxXQUFXLFVBQVUsV0FBVztBQUN0QyxtQkFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxvQkFJVixNQUFNLFVBQVUsZUFBZSxLQUFLLGlCQUFpQixZQUFZLElBQUksbUJBQW1CO0FBQUE7QUFHdkcsZ0JBQU0sWUFBWSxVQUFVLFdBQVcsRUFBRSxNQUFNLE1BQU0sTUFBTSxDQUFDO0FBQzVELGNBQUksTUFBTSxVQUFVLGNBQWM7QUFDakMsc0JBQVUsTUFBTSxhQUFhO0FBQUEsVUFDOUI7QUFHQSxvQkFBVSxpQkFBaUIsU0FBUyxPQUFPLE1BQU07QUFDaEQsY0FBRSxnQkFBZ0I7QUFDbEIsa0JBQU0sS0FBSyxjQUFjLGNBQWMsTUFBTSxLQUFLO0FBRWxELHlCQUFhLE1BQU0sVUFBVTtBQUFBLFVBQzlCLENBQUM7QUFHRCxvQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLHNCQUFVLE1BQU0sYUFBYTtBQUFBLFVBQzlCLENBQUM7QUFDRCxvQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLHNCQUFVLE1BQU0sYUFBYTtBQUFBLFVBQzlCLENBQUM7QUFBQSxRQUNGO0FBQUEsTUFDRDtBQUdBLG1CQUFhLGlCQUFpQixTQUFTLE9BQU8sTUFBTTtBQUNuRCxZQUFJLE9BQU8sU0FBUyxHQUFHO0FBRXRCLFlBQUUsZ0JBQWdCO0FBQ2xCLHVCQUFhLENBQUM7QUFDZCxjQUFJLFlBQVk7QUFDZix1QkFBVyxNQUFNLFVBQVUsYUFBYSxVQUFVO0FBQUEsVUFDbkQ7QUFDQSxjQUFJLGFBQWE7QUFDaEIsd0JBQVksTUFBTSxZQUFZLGFBQWEsa0JBQWtCO0FBQUEsVUFDOUQ7QUFBQSxRQUNELE9BQU87QUFFTixjQUFJLENBQUMsV0FBVztBQUNmLGtCQUFNLEtBQUssaUJBQWlCLFlBQVk7QUFDeEMseUJBQWEsTUFBTSxVQUFVO0FBQzdCLGdCQUFLLEtBQWEseUJBQXlCO0FBQzFDLGNBQUMsS0FBYSx3QkFBd0Isc0JBQXNCO0FBQUEsWUFDN0Q7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0QsQ0FBQztBQUdELG1CQUFhLGlCQUFpQixjQUFjLE1BQU07QUFDakQsWUFBSSxDQUFDLFdBQVc7QUFDZix1QkFBYSxNQUFNLGFBQWE7QUFBQSxRQUNqQztBQUFBLE1BQ0QsQ0FBQztBQUVELG1CQUFhLGlCQUFpQixjQUFjLE1BQU07QUFDakQsWUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZO0FBQzlCLHVCQUFhLE1BQU0sYUFBYTtBQUFBLFFBQ2pDO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixVQUFrQixTQUF5QjtBQUNwRSxVQUFNLFVBQVUsS0FBSyxnQkFBZ0IsVUFBVSxNQUFNO0FBRXJELFdBQU8sc0VBQXNFLE9BQU8sU0FBUyxPQUFPO0FBQUEsRUFDckc7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUFpQixVQUFrQixPQUFlLFFBQWdCO0FBQ3pFLFdBQU8sS0FBSyxnQkFBZ0IsVUFBVSxJQUFJO0FBQUEsRUFDM0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixVQUFrQixPQUFlLFFBQWdCO0FBQ3hFLFVBQU0sUUFBZ0M7QUFBQSxNQUNyQyxPQUFPLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQSxNQUdySCxjQUFjLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLNUgsUUFBUSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUl0SCxlQUFlLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLN0gsYUFBYSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFNM0gsbUJBQW1CLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLakksYUFBYSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU8zSCxLQUFLLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BSW5ILGdCQUFnQix5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUk5SCxZQUFZLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFLM0g7QUFFQSxXQUFPLE1BQU0sUUFBUSxLQUFLLE1BQU0sYUFBYTtBQUFBLEVBQzlDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx1QkFBdUIsY0FBOEI7QUFDNUQsVUFBTSxRQUFnQztBQUFBLE1BQ3JDLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFFBQVE7QUFBQSxJQUNUO0FBQ0EsV0FBTyxNQUFNLFlBQVksS0FBSztBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQ0FBZ0MsY0FBOEI7QUFDckUsVUFBTSxTQUFTLEtBQUssbUJBQW1CLFlBQVk7QUFFbkQsUUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixZQUFNLGVBQWUsS0FBSyxnQkFBZ0IsWUFBWTtBQUN0RCxhQUFPLEtBQUssb0JBQW9CLGNBQWMsWUFBWTtBQUFBLElBQzNEO0FBRUEsV0FBTyxLQUFLLHVCQUF1QixZQUFZO0FBQUEsRUFDaEQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUFpQixjQUE4QjtBQUV0RCxVQUFNLFNBQWlDO0FBQUEsTUFDdEMsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsUUFBUTtBQUFBLElBQ1Q7QUFDQSxXQUFPLE9BQU8sWUFBWSxLQUFLO0FBQUEsRUFDaEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsaUJBQWlCLGNBQXFDO0FBQ25FLFFBQUk7QUFFSCxZQUFNLGdCQUFnQixLQUFLLGtCQUFrQixjQUFjLGVBQWUsS0FBSyxnQ0FBZ0MsWUFBWSxDQUFDLEVBQUU7QUFDOUgsV0FBSyxXQUFXLFVBQVUsYUFBYTtBQUd2QyxZQUFNLFdBQVcsMEJBQVMsV0FBVyxXQUFXO0FBQ2hELFdBQUssT0FBTyxTQUFTLGlCQUFpQixRQUFRLEVBQUUsa0JBQWtCO0FBQ2xFLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFHL0IsV0FBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBR2pFLGlCQUFXLE1BQU0sS0FBSyxzQkFBc0IsR0FBRyxHQUFHO0FBQUEsSUFFbkQsU0FBUyxPQUFPO0FBRWYsV0FBSyxnQkFBZ0IsS0FBSyxrQkFBa0IsWUFBWSx1QkFBdUIsS0FBSyxnQ0FBZ0MsWUFBWSxDQUFDLEVBQUUsQ0FBQztBQUFBLElBQ3JJO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMEJBQW1DO0FBRTFDLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQzdELGFBQU87QUFBQSxJQUNSO0FBQ0EsV0FBTyxLQUFLLE9BQU8sU0FBUztBQUFBLEVBQzdCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBMkI7QUFDMUIsU0FBSyxxQkFBcUI7QUFBQSxFQUUzQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQTZCO0FBQzVCLFFBQUksS0FBSyxjQUFjO0FBQ3RCLFdBQUssYUFBYSxxQkFBcUI7QUFBQSxJQUN4QztBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHVCQUE2QjtBQUFBLEVBSXJDO0FBRUQ7QUF6d0VhLGlCQThDWSw4QkFBOEI7QUE5QzFDLGlCQStDWSxrQkFBa0I7QUEvQzlCLGlCQWdEWSxpQkFBaUI7QUFoRDdCLGlCQWlEWSxtQkFBbUI7QUFqRC9CLGlCQWtEWSxxQkFBcUI7QUFsRHZDLElBQU0sa0JBQU47OztBRE5QLElBQU0sZ0JBQWdCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUE0Q2YsSUFBTSxtQkFBaUM7QUFBQSxFQUM3QyxhQUFhO0FBQUEsSUFDWixRQUFRO0FBQUEsTUFDUCxRQUFRO0FBQUEsTUFDUixPQUFPO0FBQUEsTUFDUCxhQUFhO0FBQUEsTUFDYixXQUFXO0FBQUEsSUFDWjtBQUFBLElBQ0EsUUFBUTtBQUFBLE1BQ1AsUUFBUTtBQUFBLE1BQ1IsU0FBUztBQUFBLE1BQ1QsT0FBTztBQUFBLE1BQ1AsYUFBYTtBQUFBLE1BQ2IsV0FBVztBQUFBLElBQ1o7QUFBQSxJQUNBLFFBQVE7QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLE9BQU87QUFBQSxNQUNQLGFBQWE7QUFBQSxNQUNiLFdBQVc7QUFBQSxJQUNaO0FBQUEsSUFDQSxRQUFRO0FBQUEsTUFDUCxTQUFTO0FBQUEsTUFDVCxPQUFPO0FBQUEsTUFDUCxhQUFhO0FBQUEsTUFDYixXQUFXO0FBQUEsSUFDWjtBQUFBLEVBQ0Q7QUFBQSxFQUNBLGtCQUFrQjtBQUFBLElBQ2pCLFNBQVM7QUFBQSxNQUNSLGlCQUFpQjtBQUFBLE1BQ2pCLG1CQUFtQixDQUFDLFVBQVUsVUFBVSxRQUFRO0FBQUEsSUFDakQ7QUFBQSxJQUNBLFFBQVE7QUFBQSxNQUNQLGlCQUFpQjtBQUFBLE1BQ2pCLG1CQUFtQixDQUFDLFVBQVUsUUFBUTtBQUFBLElBQ3ZDO0FBQUEsRUFDRDtBQUFBLEVBQ0EsZ0JBQWdCLENBQUM7QUFBQSxFQUNqQixTQUFTO0FBQUEsSUFDUixvQkFBb0I7QUFBQSxJQUNwQixrQkFBa0I7QUFBQSxJQUNsQixVQUFVO0FBQUEsRUFDWDtBQUFBLEVBQ0EsbUJBQW1CO0FBQUEsRUFDbkIsV0FBVztBQUFBLElBQ1YsWUFBWTtBQUFBLElBQ1oscUJBQXFCO0FBQUEsSUFDckIsYUFBYTtBQUFBLElBQ2IsZUFBZTtBQUFBLE1BQ2QsU0FBUztBQUFBLE1BQ1QsY0FBYztBQUFBLE1BQ2QsZ0JBQWdCO0FBQUEsSUFDakI7QUFBQSxFQUNEO0FBQ0Q7QUFFTyxJQUFNLGlCQUFOLGNBQTZCLGtDQUFpQjtBQUFBLEVBR3BELFlBQVksS0FBVSxRQUFvQjtBQUN6QyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxVQUFnQjtBQUNmLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFDeEIsZ0JBQVksTUFBTTtBQUNsQixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRXZELFNBQUssc0JBQXNCO0FBQzNCLFNBQUssc0JBQXNCO0FBQzNCLFNBQUssdUJBQXVCO0FBQzVCLFNBQUssdUJBQXVCO0FBQzVCLFNBQUssc0JBQXNCO0FBQUEsRUFDNUI7QUFBQSxFQUVRLHdCQUF3QjtBQWhJakM7QUFpSUUsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixVQUFNLG1CQUFtQixZQUFZLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzlFLHFCQUFpQixTQUFTLE1BQU0sRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBR3RFLFVBQU0sU0FBUyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDcEUsV0FBTyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVFuQixVQUFNLGdCQUFjLFVBQUssT0FBTyxtQkFBWixtQkFBNEIsMkJBQTBCO0FBQzFFLFVBQU0sb0JBQW1CLFVBQUssT0FBTyxtQkFBWixtQkFBNEI7QUFFckQsVUFBTSxnQkFBZ0IsaUJBQWlCLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ2pGLFVBQU0sYUFBYSxjQUFjLHdCQUF3QjtBQUN6RCxVQUFNLGFBQWEsY0FBYztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBVXZCO0FBQUEsS0FDUCxhQUFhO0FBQUE7QUFFaEIsa0JBQWMsWUFBWTtBQUFBLG1DQUNPLGNBQWMsY0FBYyxNQUFNO0FBQUEsZ0NBQ3JDLFVBQVU7QUFBQSxnQ0FDVixVQUFVO0FBQUE7QUFBQTtBQUt4QyxRQUFJLGtCQUFrQjtBQUNyQixZQUFNLFdBQVcsaUJBQWlCLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQzFFLFlBQU0sYUFBYSxpQkFBaUIsWUFDakMsWUFBWSxpQkFBaUIsVUFBVSxtQkFBbUIsQ0FBQyxLQUMzRDtBQUNILGVBQVMsWUFBWTtBQUFBO0FBQUEsbUNBRVcsaUJBQWlCLEtBQUs7QUFBQSxvQ0FDckIsVUFBVTtBQUFBO0FBQUE7QUFBQSxJQUc1QztBQUdBLFFBQUkseUJBQVEsZ0JBQWdCLEVBQzFCLFFBQVEsa0NBQWtDLEVBQzFDLFFBQVEsNkVBQTZFLEVBQ3JGLFFBQVEsVUFBUTtBQTFMcEIsVUFBQUU7QUEyTEksV0FBSyxRQUFRLE9BQU87QUFDcEIsV0FBSyxlQUFlLGdDQUFnQyxFQUNsRCxTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsdUJBQXVCLEVBQUUsRUFDakUsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsVUFBVSxzQkFBc0I7QUFDckQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUcvQixZQUFJLEtBQUssT0FBTyxnQkFBZ0I7QUFDL0IsZ0JBQU0sS0FBSyxPQUFPLGVBQWUsdUJBQXVCLFNBQVMsSUFBSTtBQUdyRSxnQkFBTSxTQUFTLEtBQUssT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLHNCQUFzQjtBQUMvRSxjQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLGtCQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsd0JBQVksbUJBQW1CO0FBQUEsVUFDaEM7QUFHQSxlQUFLLFFBQVE7QUFBQSxRQUNkO0FBQUEsTUFDRCxDQUFDO0FBR0YsWUFBTSxrQkFBaUJBLE1BQUEsS0FBSyxRQUFRLGtCQUFiLGdCQUFBQSxJQUE0QixTQUFTLFVBQVU7QUFBQSxRQUNyRSxNQUFNO0FBQUEsUUFDTixLQUFLO0FBQUEsTUFDTjtBQUVBLFVBQUksZ0JBQWdCO0FBQ25CLHVCQUFlLGlCQUFpQixTQUFTLFlBQVk7QUFDcEQsZ0JBQU0sYUFBYSxLQUFLLFFBQVE7QUFDaEMsY0FBSSxDQUFDLFlBQVk7QUFDaEIsaUJBQUssbUJBQW1CLCtDQUErQyxPQUFPO0FBQzlFO0FBQUEsVUFDRDtBQUVBLHlCQUFlLGNBQWM7QUFDN0IseUJBQWUsV0FBVztBQUUxQixjQUFJO0FBQ0gsZ0JBQUksS0FBSyxPQUFPLGdCQUFnQjtBQUMvQixvQkFBTSxLQUFLLE9BQU8sZUFBZSx1QkFBdUIsVUFBVTtBQUNsRSxvQkFBTUMsZUFBYyxLQUFLLE9BQU8sZUFBZSxxQkFBcUI7QUFFcEUsa0JBQUlBLGNBQWE7QUFDaEIscUJBQUssbUJBQW1CLHVFQUF1RSxTQUFTO0FBQ3hHLHFCQUFLLGFBQWE7QUFBQSxjQUNuQixPQUFPO0FBQ04scUJBQUssbUJBQW1CLDZDQUE2QyxPQUFPO0FBQUEsY0FDN0U7QUFHQSxvQkFBTSxTQUFTLEtBQUssT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLHNCQUFzQjtBQUMvRSxrQkFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixzQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLDRCQUFZLG1CQUFtQjtBQUFBLGNBQ2hDO0FBR0EsbUJBQUssUUFBUTtBQUFBLFlBQ2Q7QUFBQSxVQUNELFNBQVMsT0FBTztBQUNmLGlCQUFLLG1CQUFtQix1Q0FBdUMsT0FBTztBQUFBLFVBQ3ZFLFVBQUU7QUFDRCwyQkFBZSxjQUFjO0FBQzdCLDJCQUFlLFdBQVc7QUFBQSxVQUMzQjtBQUFBLFFBQ0QsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNELENBQUM7QUFHRixTQUFLLG9CQUFvQixnQkFBZ0I7QUFHekMsUUFBSSxNQUFnRztBQUNuRyxXQUFLLG9CQUFvQixnQkFBZ0I7QUFBQSxJQUMxQztBQUFBLEVBQ0Q7QUFBQSxFQUVRLG9CQUFvQixXQUF3QjtBQUVuRCxVQUFNLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ3hFLGtCQUFjLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFZM0I7QUFBQSxFQUVRLG9CQUFvQixXQUF3QjtBQUNuRCxVQUFNLGlCQUFpQixVQUFVLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3hFLG1CQUFlLFNBQVMsTUFBTSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFOUQsUUFBSSx5QkFBUSxjQUFjLEVBQ3hCLFFBQVEsWUFBWSxFQUNwQixRQUFRLHFDQUFxQyxFQUM3QyxVQUFVLFlBQVUsT0FDbkIsU0FBUyxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsT0FBTyxFQUM3RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsVUFBVTtBQUN2RCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBRS9CLFVBQUksS0FBSyxPQUFPLGdCQUFnQjtBQUMvQixhQUFLLE9BQU8sZUFBZSxvQkFBb0IsS0FBSyxPQUFPLFNBQVMsVUFBVSxhQUFhO0FBQUEsTUFDNUY7QUFHQSxXQUFLLFFBQVE7QUFBQSxJQUNkLENBQUMsQ0FBQztBQUVKLFFBQUksS0FBSyxPQUFPLFNBQVMsVUFBVSxjQUFjLFNBQVM7QUFDekQsVUFBSSx5QkFBUSxjQUFjLEVBQ3hCLFFBQVEsZUFBZSxFQUN2QixRQUFRLG9FQUFvRSxFQUM1RSxRQUFRLFVBQVEsS0FDZixlQUFlLFlBQVksRUFDM0IsU0FBUyxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsZ0JBQWdCLEVBQUUsRUFDeEUsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsVUFBVSxjQUFjLGVBQWUsU0FBUztBQUNyRSxjQUFNLEtBQUssT0FBTyxhQUFhO0FBRS9CLFlBQUksS0FBSyxPQUFPLGdCQUFnQjtBQUMvQixlQUFLLE9BQU8sZUFBZSxvQkFBb0IsS0FBSyxPQUFPLFNBQVMsVUFBVSxhQUFhO0FBQUEsUUFDNUY7QUFBQSxNQUdELENBQUMsQ0FBQztBQUVKLFVBQUkseUJBQVEsY0FBYyxFQUN4QixRQUFRLHdCQUF3QixFQUNoQyxRQUFRLGlEQUFpRCxFQUN6RCxVQUFVLFlBQVUsT0FDbkIsU0FBUyxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsa0JBQWtCLEtBQUssRUFDN0UsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsVUFBVSxjQUFjLGlCQUFpQjtBQUM5RCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBRS9CLFlBQUksS0FBSyxPQUFPLGdCQUFnQjtBQUMvQixlQUFLLE9BQU8sZUFBZSxvQkFBb0IsS0FBSyxPQUFPLFNBQVMsVUFBVSxhQUFhO0FBQUEsUUFDNUY7QUFHQSxZQUFJLE9BQU87QUFDVixlQUFLLGFBQWE7QUFBQSxRQUNuQjtBQUdBLGNBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsWUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixnQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLHNCQUFZLG1CQUFtQjtBQUFBLFFBQ2hDO0FBR0EsYUFBSyxRQUFRO0FBQUEsTUFDZCxDQUFDLENBQUM7QUFHSixVQUFJLHlCQUFRLGNBQWMsRUFDeEIsUUFBUSxvQkFBb0IsRUFDNUIsUUFBUSwyQ0FBMkMsRUFDbkQsVUFBVSxZQUFVLE9BQ25CLGNBQWMsZ0JBQWdCLEVBQzlCLFdBQVcsRUFDWCxRQUFRLFlBQVk7QUFFcEIsY0FBTSxZQUFZLFFBQVEsOEZBQThGO0FBQ3hILFlBQUksQ0FBQyxVQUFXO0FBR2hCLGFBQUssT0FBTyxTQUFTLFVBQVUsc0JBQXNCO0FBR3JELFlBQUksS0FBSyxPQUFPLFNBQVMsVUFBVSxjQUFjLGdCQUFnQjtBQUNoRSxlQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsaUJBQWlCO0FBQUEsUUFDL0Q7QUFFQSxjQUFNLEtBQUssT0FBTyxhQUFhO0FBRy9CLFlBQUksS0FBSyxPQUFPLGdCQUFnQjtBQUMvQixnQkFBTSxLQUFLLE9BQU8sZUFBZSx1QkFBdUIsSUFBSTtBQUM1RCxlQUFLLE9BQU8sZUFBZSxvQkFBb0IsS0FBSyxPQUFPLFNBQVMsVUFBVSxhQUFhO0FBQUEsUUFDNUY7QUFHQSxjQUFNLFNBQVMsS0FBSyxPQUFPLElBQUksVUFBVSxnQkFBZ0Isc0JBQXNCO0FBQy9FLFlBQUksT0FBTyxTQUFTLEdBQUc7QUFDdEIsZ0JBQU0sY0FBYyxPQUFPLENBQUMsRUFBRTtBQUM5QixzQkFBWSxtQkFBbUI7QUFBQSxRQUNoQztBQUdBLGFBQUssbUJBQW1CLHNDQUFzQyxTQUFTO0FBR3ZFLGFBQUssUUFBUTtBQUFBLE1BQ2QsQ0FBQyxDQUFDO0FBQUEsSUFDTDtBQUFBLEVBQ0Q7QUFBQSxFQUVRLG1CQUFtQixTQUFpQixNQUEyQjtBQUV0RSxVQUFNLGtCQUFrQixLQUFLLFlBQVksY0FBYyx1QkFBdUI7QUFDOUUsUUFBSSxpQkFBaUI7QUFDcEIsc0JBQWdCLE9BQU87QUFBQSxJQUN4QjtBQUVBLFVBQU0sWUFBWSxLQUFLLFlBQVksVUFBVTtBQUFBLE1BQzVDLEtBQUssd0JBQXdCLElBQUk7QUFBQSxNQUNqQyxNQUFNO0FBQUEsSUFDUCxDQUFDO0FBR0QsZUFBVyxNQUFNO0FBQ2hCLGdCQUFVLE9BQU87QUFBQSxJQUNsQixHQUFHLEdBQUk7QUFBQSxFQUNSO0FBQUEsRUFFUSxlQUFlO0FBRXRCLFVBQU0sb0JBQW9CLFNBQVMsY0FBYyxLQUFLO0FBQ3RELHNCQUFrQixZQUFZO0FBQzlCLGFBQVMsS0FBSyxZQUFZLGlCQUFpQjtBQUczQyxVQUFNLE9BQU8sS0FBSyxZQUFZLHNCQUFzQjtBQUNwRCxVQUFNLFVBQVUsS0FBSyxPQUFPLEtBQUssUUFBUTtBQUN6QyxVQUFNLFVBQVUsS0FBSyxNQUFNLEtBQUssSUFBSSxLQUFLLFNBQVMsR0FBRyxHQUFHO0FBR3hELFVBQU0sU0FBUyxDQUFDLFFBQVEsUUFBUSxRQUFRLFNBQVMsT0FBTyxFQUFFO0FBRzFELGFBQVMsSUFBSSxHQUFHLElBQUksS0FBSyxLQUFLO0FBQzdCLFlBQU0sV0FBVyxTQUFTLGNBQWMsS0FBSztBQUM3QyxlQUFTLFlBQVksdUJBQXVCLE9BQU8sS0FBSyxNQUFNLEtBQUssT0FBTyxJQUFJLE9BQU8sTUFBTSxDQUFDLENBQUM7QUFHN0YsZUFBUyxNQUFNLE9BQU8sR0FBRyxPQUFPO0FBQ2hDLGVBQVMsTUFBTSxNQUFNLEdBQUcsT0FBTztBQUcvQixZQUFNLFFBQVMsS0FBSyxLQUFLLElBQUksSUFBSyxPQUFPLEtBQUssT0FBTyxJQUFJLE1BQU07QUFDL0QsWUFBTSxXQUFXLE1BQU0sS0FBSyxPQUFPLElBQUk7QUFDdkMsWUFBTSxXQUFXLEtBQUssSUFBSSxLQUFLLElBQUk7QUFDbkMsWUFBTSxXQUFXLEtBQUssSUFBSSxLQUFLLElBQUksV0FBVztBQUc5QyxlQUFTLE1BQU0sWUFBWSxlQUFlLEdBQUcsUUFBUSxJQUFJO0FBQ3pELGVBQVMsTUFBTSxZQUFZLGVBQWUsR0FBRyxRQUFRLElBQUk7QUFHekQsZUFBUyxNQUFNLGlCQUFpQixHQUFHLEtBQUssT0FBTyxJQUFJLEdBQUc7QUFHdEQsWUFBTSxPQUFPLElBQUksS0FBSyxPQUFPLElBQUk7QUFDakMsZUFBUyxNQUFNLFFBQVEsR0FBRyxJQUFJO0FBQzlCLGVBQVMsTUFBTSxTQUFTLEdBQUcsSUFBSTtBQUcvQixVQUFJLEtBQUssT0FBTyxJQUFJLEtBQUs7QUFDeEIsaUJBQVMsTUFBTSxTQUFTLEdBQUcsT0FBTyxHQUFHO0FBQUEsTUFDdEM7QUFFQSx3QkFBa0IsWUFBWSxRQUFRO0FBQUEsSUFDdkM7QUFHQSxlQUFXLE1BQU07QUFDaEIsd0JBQWtCLE9BQU87QUFBQSxJQUMxQixHQUFHLEdBQUk7QUFBQSxFQUNSO0FBQUEsRUFFUSx3QkFBd0I7QUFDL0IsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRXZELFFBQUkseUJBQVEsV0FBVyxFQUNyQixRQUFRLHFCQUFxQixFQUM3QixRQUFRLGlEQUFpRCxFQUN6RCxVQUFVLFlBQVUsT0FDbkIsVUFBVSxHQUFHLEdBQUcsR0FBRyxFQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLFFBQVEsa0JBQWtCLEVBQ3hELGtCQUFrQixFQUNsQixTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxRQUFRLHFCQUFxQjtBQUNsRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBRUosUUFBSSx5QkFBUSxXQUFXLEVBQ3JCLFFBQVEsb0JBQW9CLEVBQzVCLFFBQVEsZ0NBQWdDLEVBQ3hDLFFBQVEsVUFBUSxLQUNmLGVBQWUsTUFBTSxFQUNyQixTQUFTLEtBQUssT0FBTyxTQUFTLFFBQVEsaUJBQWlCLFNBQVMsQ0FBQyxFQUNqRSxTQUFTLE9BQU8sVUFBVTtBQUMxQixZQUFNLFdBQVcsU0FBUyxLQUFLO0FBQy9CLFVBQUksQ0FBQyxNQUFNLFFBQVEsS0FBSyxXQUFXLEdBQUc7QUFDckMsYUFBSyxPQUFPLFNBQVMsUUFBUSxtQkFBbUI7QUFDaEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDO0FBQUEsSUFDRCxDQUFDLENBQUM7QUFFSixRQUFJLHlCQUFRLFdBQVcsRUFDckIsUUFBUSxvQkFBb0IsRUFDNUIsUUFBUSwwQ0FBMEMsRUFDbEQsVUFBVSxZQUFVLE9BQ25CLFNBQVMsS0FBSyxPQUFPLFNBQVMsUUFBUSxRQUFRLEVBQzlDLFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFFBQVEsV0FBVztBQUN4QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBQUEsRUFFTDtBQUFBLEVBRVEseUJBQXlCO0FBQ2hDLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFHeEIsVUFBTSxXQUFXLFlBQVksVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDekUsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVN6QixVQUFNLFVBQVUsU0FBUyxXQUFXLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUNyRSxZQUFRLFlBQVk7QUFDcEIsWUFBUSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3hCLFVBQU0sVUFBVSxTQUFTLFNBQVMsTUFBTSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDeEUsWUFBUSxNQUFNLFVBQVU7QUFFeEIsVUFBTSxvQkFBb0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNoRixzQkFBa0IsTUFBTSxVQUFVO0FBR2xDLGFBQVMsaUJBQWlCLFNBQVMsTUFBTTtBQUN4QyxZQUFNLFlBQVksa0JBQWtCLE1BQU0sWUFBWTtBQUN0RCx3QkFBa0IsTUFBTSxVQUFVLFlBQVksU0FBUztBQUN2RCxjQUFRLE1BQU0sWUFBWSxZQUFZLGlCQUFpQjtBQUFBLElBQ3hELENBQUM7QUFHRCxVQUFNLFNBQVMsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3hFLFdBQU8sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWtCbkIsU0FBSyxxQkFBcUIsaUJBQWlCO0FBQzNDLFNBQUsscUJBQXFCLGlCQUFpQjtBQUMzQyxTQUFLLHFCQUFxQixpQkFBaUI7QUFDM0MsU0FBSyxxQkFBcUIsaUJBQWlCO0FBQUEsRUFDNUM7QUFBQSxFQUVRLHFCQUFxQixjQUFjLEtBQUssYUFBYTtBQUU1RCxVQUFNLGtCQUFrQixZQUFZLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzlFLG9CQUFnQixTQUFTLE1BQU0sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRTdELFFBQUkseUJBQVEsZUFBZSxFQUN6QixRQUFRLFNBQVMsRUFDakIsUUFBUSx3QkFBd0IsRUFDaEMsUUFBUSxVQUFRLEtBQ2YsZUFBZSxZQUFZLEVBQzNCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFVBQVUsRUFBRSxFQUM3RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUztBQUNqRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBR0osVUFBTSxlQUFlLElBQUkseUJBQVEsZUFBZSxFQUM5QyxRQUFRLE9BQU8sRUFDZixRQUFRLHFCQUFxQjtBQUUvQixRQUFJO0FBRUosaUJBQWEsWUFBWSxjQUFZO0FBQ3BDLHNCQUFnQjtBQUNoQixXQUFLLHFCQUFxQixRQUFRO0FBQ2xDLGFBQU8sU0FDTCxTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxTQUFTLDBCQUEwQixFQUNwRixTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sUUFBUTtBQUNoRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBR0Y7QUFBQSxFQUVRLHFCQUFxQixVQUFlO0FBRTNDLGFBQVMsU0FBUyxNQUFNO0FBR3hCLFVBQU0sZ0JBQWdCLG1CQUFtQixRQUFRO0FBRWpELGtCQUFjLFFBQVEsV0FBUztBQUM5QixlQUFTLFVBQVUsTUFBTSxPQUFPLE1BQU0sS0FBSztBQUFBLElBQzVDLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFJUSxxQkFBcUIsY0FBYyxLQUFLLGFBQWE7QUFFNUQsVUFBTSxrQkFBa0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUM5RSxvQkFBZ0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUUzRCxRQUFJLHlCQUFRLGVBQWUsRUFDekIsUUFBUSxTQUFTLEVBQ2pCLFFBQVEscUJBQXFCLEVBQzdCLFFBQVEsVUFBUSxLQUNmLGVBQWUsUUFBUSxFQUN2QixTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxVQUFVLEVBQUUsRUFDN0QsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVM7QUFDakQsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUdKLFVBQU0sZUFBZSxJQUFJLHlCQUFRLGVBQWUsRUFDOUMsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUI7QUFFL0IsUUFBSTtBQUVKLGlCQUFhLFlBQVksY0FBWTtBQUNwQyxzQkFBZ0I7QUFDaEIsV0FBSyxxQkFBcUIsUUFBUTtBQUNsQyxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUyx5QkFBeUIsRUFDbkYsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFFBQVE7QUFDaEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNILENBQUM7QUFBQSxFQUdGO0FBQUEsRUFFUSxxQkFBcUIsVUFBZTtBQUUzQyxhQUFTLFNBQVMsTUFBTTtBQUd4QixVQUFNLGdCQUFnQixtQkFBbUIsUUFBUTtBQUVqRCxrQkFBYyxRQUFRLFdBQVM7QUFDOUIsZUFBUyxVQUFVLE1BQU0sT0FBTyxNQUFNLEtBQUs7QUFBQSxJQUM1QyxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEscUJBQXFCLGNBQWMsS0FBSyxhQUFhO0FBRTVELFVBQU0sa0JBQWtCLFlBQVksVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDOUUsb0JBQWdCLFNBQVMsTUFBTSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFMUQsUUFBSSx5QkFBUSxlQUFlLEVBQ3pCLFFBQVEsU0FBUyxFQUNqQixRQUFRLHdCQUF3QixFQUNoQyxRQUFRLFVBQVEsS0FDZixlQUFlLE9BQU8sRUFDdEIsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sVUFBVSxFQUFFLEVBQzdELFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxTQUFTO0FBQ2pELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFHSixVQUFNLGVBQWUsSUFBSSx5QkFBUSxlQUFlLEVBQzlDLFFBQVEsT0FBTyxFQUNmLFFBQVEscUJBQXFCO0FBRS9CLFFBQUk7QUFFSixpQkFBYSxZQUFZLGNBQVk7QUFDcEMsc0JBQWdCO0FBQ2hCLFdBQUsscUJBQXFCLFFBQVE7QUFDbEMsYUFBTyxTQUNMLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVMsZ0NBQWdDLEVBQzFGLFNBQVMsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxRQUFRO0FBQ2hELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQyxDQUFDO0FBQUEsSUFDSCxDQUFDO0FBQUEsRUFHRjtBQUFBLEVBRVEscUJBQXFCLFVBQWU7QUFFM0MsYUFBUyxTQUFTLE1BQU07QUFHeEIsVUFBTSxnQkFBZ0IsbUJBQW1CLFFBQVE7QUFFakQsa0JBQWMsUUFBUSxXQUFTO0FBQzlCLGVBQVMsVUFBVSxNQUFNLE9BQU8sTUFBTSxLQUFLO0FBQUEsSUFDNUMsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLHFCQUFxQixjQUFjLEtBQUssYUFBYTtBQUM1RCxVQUFNLGtCQUFrQixZQUFZLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzlFLG9CQUFnQixTQUFTLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRXpELFFBQUkseUJBQVEsZUFBZSxFQUN6QixRQUFRLFVBQVUsRUFDbEIsUUFBUSxtQkFBbUIsRUFDM0IsUUFBUSxVQUFRLEtBQ2YsZUFBZSx3QkFBd0IsRUFDdkMsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sV0FBVyxFQUFFLEVBQzlELFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxVQUFVO0FBQ2xELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFFSixRQUFJLHlCQUFRLGVBQWUsRUFDekIsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSxVQUFRLEtBQ2YsZUFBZSxRQUFRLEVBQ3ZCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVMsRUFBRSxFQUM1RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sUUFBUTtBQUNoRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRVEseUJBQXlCO0FBQ2hDLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFHeEIsVUFBTSxXQUFXLFlBQVksVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDekUsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVN6QixVQUFNLFVBQVUsU0FBUyxXQUFXLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUNyRSxZQUFRLFlBQVk7QUFDcEIsWUFBUSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3hCLFVBQU0sVUFBVSxTQUFTLFNBQVMsTUFBTSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDckUsWUFBUSxNQUFNLFVBQVU7QUFFeEIsVUFBTSxvQkFBb0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNoRixzQkFBa0IsTUFBTSxVQUFVO0FBR2xDLGFBQVMsaUJBQWlCLFNBQVMsTUFBTTtBQUN4QyxZQUFNLFlBQVksa0JBQWtCLE1BQU0sWUFBWTtBQUN0RCx3QkFBa0IsTUFBTSxVQUFVLFlBQVksU0FBUztBQUN2RCxjQUFRLE1BQU0sWUFBWSxZQUFZLGlCQUFpQjtBQUFBLElBQ3hELENBQUM7QUFHRCxVQUFNLFNBQVMsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3hFLFdBQU8sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVFuQixzQkFBa0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDcEQsVUFBTSxrQkFBa0IsSUFBSSx5QkFBUSxpQkFBaUIsRUFDbkQsUUFBUSxrQkFBa0IsRUFDMUIsUUFBUSxpQ0FBaUMsRUFDekMsWUFBWSxjQUFZO0FBQ3hCLFlBQU0sbUJBQW1CLEtBQUssK0JBQStCLFNBQVM7QUFFdEUsdUJBQWlCLFFBQVEsY0FBWTtBQUNwQyxjQUFNLFFBQVEsS0FBSyx1QkFBdUIsUUFBUTtBQUNsRCxpQkFBUyxVQUFVLFVBQVUsS0FBSztBQUFBLE1BQ25DLENBQUM7QUFFRCxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxlQUFlLEVBQ3RFLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxhQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxrQkFBa0I7QUFDaEUsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixZQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsZUFBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsUUFDbEU7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNILENBQUM7QUFFRixzQkFBa0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDbkQsVUFBTSxnQkFBZ0IsSUFBSSx5QkFBUSxpQkFBaUIsRUFDakQsUUFBUSxrQkFBa0IsRUFDMUIsUUFBUSx3Q0FBd0M7QUFFbEQsa0JBQWMsWUFBWSxjQUFZLFNBQ3BDLFVBQVUsUUFBUSxpQkFBaUIsRUFDbkMsVUFBVSxVQUFVLFFBQVEsRUFDNUIsVUFBVSxVQUFVLFFBQVEsRUFDNUIsVUFBVSxVQUFVLFFBQVEsRUFDNUIsU0FBUyxLQUFLLE9BQU8sU0FBUyxpQkFBaUIsT0FBTyxlQUFlLEVBQ3JFLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxXQUFLLE9BQU8sU0FBUyxpQkFBaUIsT0FBTyxrQkFBa0I7QUFDL0QsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixVQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsYUFBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsTUFDbEU7QUFBQSxJQUNELENBQUMsQ0FBQztBQUFBLEVBQ0o7QUFBQSxFQUVRLCtCQUErQixVQUFnRDtBQUV0RixXQUFPLGFBQWEsWUFDakIsQ0FBQyxVQUFVLFVBQVUsVUFBVSxRQUFRLElBQ3ZDLENBQUMsVUFBVSxVQUFVLFFBQVE7QUFBQSxFQUNqQztBQUFBLEVBRVEsdUJBQXVCLFVBQWdDO0FBQzlELFVBQU0sUUFBc0M7QUFBQSxNQUMzQyxVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixRQUFRO0FBQUEsSUFDVDtBQUNBLFdBQU8sTUFBTSxRQUFRLEtBQUs7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxtQkFBbUIsWUFBbUM7QUFDM0QsVUFBTSxXQUFXLDBCQUFTLFdBQVcsV0FBVztBQUNoRCxTQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxFQUFFLGtCQUFrQjtBQUdsRSxRQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsV0FBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsSUFDbEU7QUFBQSxFQUNEO0FBQUEsRUFFUSx3QkFBd0I7QUFDL0IsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUd4QixVQUFNLFdBQVcsWUFBWSxVQUFVLEVBQUUsS0FBSywwQkFBMEIsQ0FBQztBQUN6RSxhQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBU3pCLFVBQU0sVUFBVSxTQUFTLFdBQVcsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ3JFLFlBQVEsWUFBWTtBQUNwQixZQUFRLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPeEIsVUFBTSxVQUFVLFNBQVMsU0FBUyxNQUFNLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNuRSxZQUFRLE1BQU0sVUFBVTtBQUV4QixVQUFNLG1CQUFtQixZQUFZLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzlFLHFCQUFpQixNQUFNLFVBQVU7QUFHakMsYUFBUyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3hDLFlBQU0sWUFBWSxpQkFBaUIsTUFBTSxZQUFZO0FBQ3JELHVCQUFpQixNQUFNLFVBQVUsWUFBWSxTQUFTO0FBQ3RELGNBQVEsTUFBTSxZQUFZLFlBQVksaUJBQWlCO0FBQUEsSUFDeEQsQ0FBQztBQUdELFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQzdELFlBQU0sV0FBVyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDMUUsZUFBUyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVNyQjtBQUFBLElBQ0Q7QUFHQSxVQUFNLFNBQVMsaUJBQWlCLFVBQVUsRUFBRSxLQUFLLDJCQUEyQixDQUFDO0FBQzdFLFdBQU8sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT25CLFFBQUkseUJBQVEsZ0JBQWdCLEVBQzFCLFFBQVEsNkJBQTZCLEVBQ3JDLFFBQVEsMEVBQTBFLEVBQ2xGLFVBQVUsWUFBVSxPQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLGlCQUFpQixFQUMvQyxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxvQkFBb0I7QUFDekMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUcvQixZQUFNLFNBQVMsS0FBSyxPQUFPLElBQUksVUFBVSxnQkFBZ0Isc0JBQXNCO0FBQy9FLFVBQUksT0FBTyxTQUFTLEdBQUc7QUFDdEIsY0FBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLG9CQUFZLHFCQUFxQjtBQUFBLE1BQ2xDO0FBQUEsSUFDRCxDQUFDLENBQUM7QUFHSixVQUFNLFdBQVcsaUJBQWlCLFVBQVUsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQ3ZFLGFBQVMsTUFBTSxVQUFVO0FBRXpCLFFBQUkseUJBQVEsUUFBUSxFQUNsQjtBQUFBLE1BQVUsWUFDVixPQUNFLGNBQWMsc0JBQXNCLEVBQ3BDLE9BQU8sRUFDUCxRQUFRLE1BQU0sS0FBSyxxQkFBcUIsQ0FBQztBQUFBLElBQzVDO0FBR0QsU0FBSyx5QkFBeUIsZ0JBQWdCO0FBQUEsRUFDL0M7QUFBQSxFQUVRLHlCQUF5QixXQUF3QjtBQUV4RCxVQUFNLGVBQWUsVUFBVSxjQUFjLHFCQUFxQjtBQUNsRSxRQUFJLGFBQWMsY0FBYSxPQUFPO0FBRXRDLFVBQU0sZUFBZSxVQUFVLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3RFLFVBQU0sV0FBVyxLQUFLLE9BQU8sU0FBUyxrQkFBa0IsQ0FBQztBQUV6RCxRQUFJLFNBQVMsV0FBVyxHQUFHO0FBQzFCLFlBQU0sVUFBVSxhQUFhLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ3JFLGNBQVEsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNcEI7QUFBQSxJQUNEO0FBRUEsYUFBUyxRQUFRLENBQUMsU0FBUyxVQUFVO0FBQ3BDLFlBQU0sWUFBWSxhQUFhLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ3JFLGdCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVMxQixZQUFNLFdBQVcsVUFBVSxVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUNuRSxlQUFTLE1BQU0sVUFBVTtBQUV6QixZQUFNLFNBQVMsU0FBUyxVQUFVLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUU5RCxZQUFNLFNBQVMsT0FBTyxVQUFVLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUM1RCxhQUFPLGNBQWMsUUFBUTtBQUM3QixhQUFPLE1BQU0sVUFBVTtBQUV2QixZQUFNLFlBQVksT0FBTyxVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUNsRSxnQkFBVSxZQUFZLFVBQVUsUUFBUSxPQUFPO0FBQy9DLGdCQUFVLE1BQU0sVUFBVTtBQUcxQixZQUFNLFlBQVksU0FBUyxVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUNwRSxnQkFBVSxNQUFNLFVBQVU7QUFFMUIsWUFBTSxVQUFVLFVBQVUsU0FBUyxVQUFVLEVBQUUsTUFBTSxPQUFPLENBQUM7QUFDN0QsY0FBUSxNQUFNLFVBQVU7QUFDeEIsY0FBUSxVQUFVLE1BQU0sS0FBSyxzQkFBc0IsS0FBSztBQUV4RCxZQUFNLFlBQVksVUFBVSxTQUFTLFVBQVUsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUNqRSxnQkFBVSxNQUFNLFVBQVU7QUFDMUIsZ0JBQVUsVUFBVSxNQUFNLEtBQUssY0FBYyxLQUFLO0FBR2xELFVBQUksUUFBUSxhQUFhO0FBQ3hCLGNBQU0sU0FBUyxVQUFVLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQy9ELGVBQU8sY0FBYyxRQUFRO0FBQzdCLGVBQU8sTUFBTSxVQUFVO0FBQUEsTUFDeEI7QUFFQSxZQUFNLGFBQWEsVUFBVSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUN2RSxpQkFBVyxZQUFZO0FBQUE7QUFBQSxPQUVuQixRQUFRLFFBQVE7QUFBQTtBQUFBO0FBQUEsSUFHckIsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLHVCQUF1QjtBQUM5QixTQUFLLGtCQUFrQjtBQUFBLEVBQ3hCO0FBQUEsRUFFUSxzQkFBc0IsT0FBZTtBQTNnQzlDO0FBNGdDRSxVQUFNLFdBQVUsVUFBSyxPQUFPLFNBQVMsbUJBQXJCLG1CQUFzQztBQUN0RCxRQUFJLFNBQVM7QUFDWixXQUFLLGtCQUFrQixTQUFTLEtBQUs7QUFBQSxJQUN0QztBQUFBLEVBQ0Q7QUFBQSxFQUVRLGtCQUFrQixpQkFBaUMsV0FBb0I7QUFHOUUsVUFBTSxPQUFPLE9BQU8sa0JBQWlCLG1EQUFpQixTQUFRLEVBQUU7QUFDaEUsUUFBSSxDQUFDLEtBQU07QUFFWCxVQUFNLFVBQVUsT0FBTyxpQ0FBZ0MsbURBQWlCLFlBQVcsRUFBRTtBQUNyRixRQUFJLENBQUMsUUFBUztBQUVkLFVBQU0sY0FBYyxPQUFPLDRCQUEyQixtREFBaUIsZ0JBQWUsRUFBRTtBQUV4RixVQUFNLFdBQVcsT0FBTyxzQkFBcUIsbURBQWlCLGFBQVksRUFBRTtBQUM1RSxRQUFJLENBQUMsU0FBVTtBQUVmLFVBQU0sU0FBd0I7QUFBQSxNQUM3QixLQUFJLG1EQUFpQixPQUFPLFNBQVMsS0FBSyxPQUFPLEVBQUUsU0FBUyxFQUFFLEVBQUUsT0FBTyxHQUFHLENBQUM7QUFBQSxNQUMzRTtBQUFBLE1BQ0EsU0FBUyxRQUFRLFlBQVk7QUFBQSxNQUM3QjtBQUFBLE1BQ0EsYUFBYSxlQUFlO0FBQUEsSUFDN0I7QUFFQSxRQUFJLGNBQWMsUUFBVztBQUU1QixVQUFJLENBQUMsS0FBSyxPQUFPLFNBQVMsZUFBZ0IsTUFBSyxPQUFPLFNBQVMsaUJBQWlCLENBQUM7QUFDakYsV0FBSyxPQUFPLFNBQVMsZUFBZSxTQUFTLElBQUk7QUFBQSxJQUNsRCxPQUFPO0FBRU4sVUFBSSxDQUFDLEtBQUssT0FBTyxTQUFTLGVBQWdCLE1BQUssT0FBTyxTQUFTLGlCQUFpQixDQUFDO0FBQ2pGLFdBQUssT0FBTyxTQUFTLGVBQWUsS0FBSyxNQUFNO0FBQUEsSUFDaEQ7QUFFQSxTQUFLLE9BQU8sYUFBYTtBQUN6QixTQUFLLHlCQUF5QixLQUFLLFlBQVksY0FBYyx1QkFBdUIsQ0FBZ0I7QUFBQSxFQUNyRztBQUFBLEVBRVEsY0FBYyxPQUFlO0FBQ3BDLFFBQUksQ0FBQyxLQUFLLE9BQU8sU0FBUyxlQUFnQjtBQUUxQyxVQUFNLFVBQVUsS0FBSyxPQUFPLFNBQVMsZUFBZSxLQUFLO0FBQ3pELFVBQU0sWUFBWSxRQUFRLG1CQUFtQixRQUFRLElBQUksTUFBTSxRQUFRLE9BQU8sSUFBSTtBQUVsRixRQUFJLFdBQVc7QUFDZCxXQUFLLE9BQU8sU0FBUyxlQUFlLE9BQU8sT0FBTyxDQUFDO0FBQ25ELFdBQUssT0FBTyxhQUFhO0FBQ3pCLFdBQUsseUJBQXlCLEtBQUssWUFBWSxjQUFjLHVCQUF1QixDQUFnQjtBQUFBLElBQ3JHO0FBQUEsRUFDRDtBQUNEOzs7QVNsa0NBLElBQUFDLG1CQUF5Qjs7O0FDQ3pCLElBQUFDLG1CQUEyQjtBQUVwQixJQUFNLGlCQUFOLE1BQTJDO0FBQUEsRUFLakQsWUFBWSxRQUF3QjtBQUpwQyxnQkFBTztBQUVQLFNBQVEsZUFBZ0M7QUFHdkMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsYUFBYSxRQUF3QjtBQUNwQyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxNQUFNLGNBQWdDO0FBQ3JDLFdBQU8sQ0FBQyxDQUFDLEtBQUssT0FBTztBQUFBLEVBQ3RCO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTQSxRQUFPLENBQUM7QUFDaEUsV0FBTyxLQUFLLGVBQWUsVUFBVSxPQUFPO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQUMxRyxVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxxQkFBcUIsVUFBVSxPQUFPO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixRQUFJLENBQUMsS0FBSyxPQUFPLFFBQVE7QUFDeEIsWUFBTSxJQUFJLE1BQU0sK0JBQStCO0FBQUEsSUFDaEQ7QUFFQSxVQUFNLGNBQWMsS0FBSyxVQUFVO0FBQUEsTUFDbEMsUUFBTyxtQ0FBUyxVQUFTLEtBQUssT0FBTyxTQUFTO0FBQUEsTUFDOUMsYUFBWSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDM0QsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLE1BQ2hFLFFBQVEsbUNBQVM7QUFBQSxNQUNqQixVQUFVLFNBQVMsSUFBSSxVQUFRO0FBQUEsUUFDOUIsTUFBTSxJQUFJLFNBQVMsY0FBYyxjQUFjO0FBQUEsUUFDL0MsU0FBUyxJQUFJO0FBQUEsTUFDZCxFQUFFO0FBQUEsSUFDSCxDQUFDO0FBR0QsVUFBTSxhQUFhO0FBQ25CLFVBQU0sWUFBWTtBQUVsQixhQUFTLFVBQVUsR0FBRyxXQUFXLFlBQVksV0FBVztBQUN2RCxVQUFJO0FBQ0gsY0FBTSxXQUFXLFVBQU0sNkJBQVc7QUFBQSxVQUNqQyxLQUFLO0FBQUEsVUFDTCxRQUFRO0FBQUEsVUFDUixTQUFTO0FBQUEsWUFDUixnQkFBZ0I7QUFBQSxZQUNoQixhQUFhLEtBQUssT0FBTztBQUFBLFlBQ3pCLHFCQUFxQjtBQUFBLFVBQ3RCO0FBQUEsVUFDQSxNQUFNO0FBQUEsUUFDUCxDQUFDO0FBRUQsWUFBSSxTQUFTLFdBQVcsS0FBSztBQUM1QixnQkFBTSxPQUFPLFNBQVM7QUFDdEIsaUJBQU8sS0FBSyxRQUFRLENBQUMsRUFBRTtBQUFBLFFBQ3hCO0FBR0EsWUFBSSxTQUFTLFVBQVUsT0FBTyxVQUFVLFlBQVk7QUFDbkQsZ0JBQU0sUUFBUSxZQUFZLEtBQUssSUFBSSxHQUFHLE9BQU87QUFDN0MsZ0JBQU0sSUFBSSxRQUFRLGFBQVcsV0FBVyxTQUFTLEtBQUssQ0FBQztBQUN2RDtBQUFBLFFBQ0Q7QUFHQSxjQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxNQUFNLE1BQU0sU0FBUyxJQUFJLEVBQUU7QUFBQSxNQUUxRSxTQUFTLE9BQU87QUFFZixZQUFJLFVBQVUsY0FBYyxpQkFBaUIsVUFDNUMsTUFBTSxRQUFRLFNBQVMsZUFBZSxLQUN0QyxNQUFNLFFBQVEsU0FBUyxtQkFBbUIsSUFDeEM7QUFDRixnQkFBTSxRQUFRLFlBQVksS0FBSyxJQUFJLEdBQUcsT0FBTztBQUM3QyxnQkFBTSxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsS0FBSyxDQUFDO0FBQ3ZEO0FBQUEsUUFDRDtBQUdBLFlBQUksaUJBQWlCLFNBQVMsTUFBTSxRQUFRLFdBQVcsbUJBQW1CLEdBQUc7QUFDNUUsZ0JBQU07QUFBQSxRQUNQO0FBQ0EsY0FBTSxJQUFJLE1BQU0sb0NBQW9DLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxNQUMvRztBQUFBLElBQ0Q7QUFHQSxVQUFNLElBQUksTUFBTSxzQ0FBc0M7QUFBQSxFQUN2RDtBQUFBLEVBRUEsTUFBTSxTQUFTLGNBQXNCLFlBQW9CLFNBQWdEO0FBQ3hHLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTLFdBQVcsQ0FBQztBQUNwRSxVQUFNLGtCQUFrQixFQUFFLEdBQUcsU0FBUyxhQUFhO0FBQ25ELFdBQU8sS0FBSyxlQUFlLFVBQVUsZUFBZTtBQUFBLEVBQ3JEO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQUduSCxVQUFNLFNBQVMsTUFBTSxLQUFLLGVBQWUsVUFBVSxPQUFPO0FBQzFELFVBQU0sRUFBRSxTQUFTLFFBQVEsTUFBTSxLQUFLO0FBQUEsRUFDckM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXdDO0FBQzdDLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUdBLFFBQUksS0FBSyxjQUFjO0FBQ3RCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFJQSxRQUFJO0FBRUgsWUFBTSxXQUFXLFVBQU0sNkJBQVc7QUFBQSxRQUNqQyxLQUFLO0FBQUEsUUFDTCxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixnQkFBZ0I7QUFBQSxVQUNoQixhQUFhLEtBQUssT0FBTztBQUFBLFVBQ3pCLHFCQUFxQjtBQUFBLFFBQ3RCO0FBQUEsUUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFVBQ3BCLE9BQU87QUFBQSxVQUNQLFlBQVk7QUFBQSxVQUNaLFVBQVUsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTLE9BQU8sQ0FBQztBQUFBLFFBQzdDLENBQUM7QUFBQSxNQUNGLENBQUM7QUFFRCxVQUFJLFNBQVMsV0FBVyxLQUFLO0FBQzVCLGNBQU0sSUFBSSxNQUFNLDhCQUE4QixTQUFTLE1BQU0sTUFBTSxTQUFTLElBQUksRUFBRTtBQUFBLE1BQ25GO0FBR0EsWUFBTSxTQUFTO0FBQUEsUUFDZDtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNEO0FBRUEsV0FBSyxlQUFlO0FBQ3BCLGFBQU87QUFBQSxJQUNSLFNBQVMsT0FBTztBQUNmLFlBQU0sSUFBSSxNQUFNLGtDQUFrQyxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDN0c7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBd0I7QUFDdkIsU0FBSyxlQUFlO0FBQUEsRUFDckI7QUFDRDs7O0FDMUtPLElBQU0saUJBQU4sTUFBMkM7QUFBQSxFQUtqRCxZQUFZLFFBQXdCO0FBSnBDLGdCQUFPO0FBRVAsU0FBUSxlQUFnQztBQUd2QyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxhQUFhLFFBQXdCO0FBQ3BDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLE1BQU0sY0FBZ0M7QUFDckMsV0FBTyxDQUFDLENBQUMsS0FBSyxPQUFPO0FBQUEsRUFDdEI7QUFBQSxFQUVBLE1BQU0sYUFBYUMsU0FBZ0IsU0FBZ0Q7QUFDbEYsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVNBLFFBQU8sQ0FBQztBQUNoRSxXQUFPLEtBQUssZUFBZSxVQUFVLE9BQU87QUFBQSxFQUM3QztBQUFBLEVBRUEsT0FBTyxtQkFBbUJBLFNBQWdCLFNBQWlFO0FBQzFHLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTQSxRQUFPLENBQUM7QUFDaEUsV0FBTyxLQUFLLHFCQUFxQixVQUFVLE9BQU87QUFBQSxFQUNuRDtBQUFBLEVBRUEsTUFBTSxlQUFlLFVBQXVCLFNBQWdEO0FBQzNGLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sa0JBQWtCLENBQUMsR0FBRyxRQUFRO0FBQ3BDLFFBQUksbUNBQVMsY0FBYztBQUMxQixzQkFBZ0IsUUFBUSxFQUFFLE1BQU0sVUFBVSxTQUFTLFFBQVEsYUFBYSxDQUFDO0FBQUEsSUFDMUU7QUFFQSxVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxXQUFXLFFBQVEsU0FBUyxtQkFBbUIsSUFBSSxVQUFVLEdBQUcsT0FBTztBQUU3RSxVQUFNLGNBQWMsS0FBSyxVQUFVO0FBQUEsTUFDbEMsUUFBTyxtQ0FBUyxVQUFTLEtBQUssT0FBTyxTQUFTO0FBQUEsTUFDOUMsVUFBVTtBQUFBLE1BQ1YsYUFBWSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDM0QsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLElBQ2pFLENBQUM7QUFHRCxVQUFNLGFBQWE7QUFDbkIsVUFBTSxZQUFZO0FBRWxCLGFBQVMsVUFBVSxHQUFHLFdBQVcsWUFBWSxXQUFXO0FBQ3ZELFVBQUk7QUFDSCxjQUFNLFdBQVcsTUFBTSxNQUFNLFVBQVU7QUFBQSxVQUN0QyxRQUFRO0FBQUEsVUFDUixTQUFTO0FBQUEsWUFDUixnQkFBZ0I7QUFBQSxZQUNoQixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sTUFBTTtBQUFBLFVBQzlDO0FBQUEsVUFDQSxNQUFNO0FBQUEsUUFDUCxDQUFDO0FBRUQsWUFBSSxTQUFTLElBQUk7QUFDaEIsZ0JBQU0sT0FBTyxNQUFNLFNBQVMsS0FBSztBQUNqQyxpQkFBTyxLQUFLLFFBQVEsQ0FBQyxFQUFFLFFBQVE7QUFBQSxRQUNoQztBQUdBLFlBQUksU0FBUyxVQUFVLE9BQU8sVUFBVSxZQUFZO0FBQ25ELGdCQUFNLFFBQVEsWUFBWSxLQUFLLElBQUksR0FBRyxPQUFPO0FBQzdDLGdCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxLQUFLLENBQUM7QUFDdkQ7QUFBQSxRQUNEO0FBR0EsY0FBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsTUFFM0QsU0FBUyxPQUFPO0FBRWYsWUFBSSxVQUFVLGNBQWMsaUJBQWlCLFNBQVMsTUFBTSxRQUFRLFNBQVMsT0FBTyxHQUFHO0FBQ3RGLGdCQUFNLFFBQVEsWUFBWSxLQUFLLElBQUksR0FBRyxPQUFPO0FBQzdDLGdCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxLQUFLLENBQUM7QUFDdkQ7QUFBQSxRQUNEO0FBR0EsY0FBTTtBQUFBLE1BQ1A7QUFBQSxJQUNEO0FBR0EsVUFBTSxJQUFJLE1BQU0sc0NBQXNDO0FBQUEsRUFDdkQ7QUFBQSxFQUVBLE1BQU0sU0FBUyxjQUFzQixZQUFvQixTQUFnRDtBQUN4RyxVQUFNLFdBQXdCO0FBQUEsTUFDN0IsRUFBRSxNQUFNLFVBQVUsU0FBUyxhQUFhO0FBQUEsTUFDeEMsRUFBRSxNQUFNLFFBQVEsU0FBUyxXQUFXO0FBQUEsSUFDckM7QUFDQSxXQUFPLEtBQUssZUFBZSxVQUFVLE9BQU87QUFBQSxFQUM3QztBQUFBLEVBRUEsT0FBTyxxQkFBcUIsVUFBdUIsU0FBaUU7QUF4R3JIO0FBeUdFLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sa0JBQWtCLENBQUMsR0FBRyxRQUFRO0FBQ3BDLFFBQUksbUNBQVMsY0FBYztBQUMxQixzQkFBZ0IsUUFBUSxFQUFFLE1BQU0sVUFBVSxTQUFTLFFBQVEsYUFBYSxDQUFDO0FBQUEsSUFDMUU7QUFFQSxVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxXQUFXLFFBQVEsU0FBUyxtQkFBbUIsSUFBSSxVQUFVLEdBQUcsT0FBTztBQUM3RSxVQUFNLFdBQVcsTUFBTSxNQUFNLFVBQVU7QUFBQSxNQUN0QyxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxRQUNoQixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sTUFBTTtBQUFBLE1BQzlDO0FBQUEsTUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCLFFBQU8sbUNBQVMsVUFBUyxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzlDLFVBQVU7QUFBQSxRQUNWLGFBQVksbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQzNELGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxRQUNoRSxRQUFRO0FBQUEsTUFDVCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sVUFBUyxjQUFTLFNBQVQsbUJBQWU7QUFDOUIsUUFBSSxDQUFDLFFBQVE7QUFDWixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sVUFBVSxJQUFJLFlBQVk7QUFDaEMsUUFBSSxTQUFTO0FBRWIsUUFBSTtBQUNILGFBQU8sTUFBTTtBQUNaLGNBQU0sRUFBRSxNQUFNLE1BQU0sSUFBSSxNQUFNLE9BQU8sS0FBSztBQUMxQyxZQUFJLEtBQU07QUFFVixrQkFBVSxRQUFRLE9BQU8sT0FBTyxFQUFFLFFBQVEsS0FBSyxDQUFDO0FBQ2hELGNBQU0sUUFBUSxPQUFPLE1BQU0sSUFBSTtBQUMvQixpQkFBUyxNQUFNLElBQUksS0FBSztBQUV4QixtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLFdBQVcsUUFBUSxHQUFHO0FBQzlCLGtCQUFNLE9BQU8sS0FBSyxNQUFNLENBQUM7QUFDekIsZ0JBQUksU0FBUyxVQUFVO0FBQ3RCLG9CQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUNoQztBQUFBLFlBQ0Q7QUFFQSxnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsb0JBQU0sV0FBVSx3QkFBTyxZQUFQLG1CQUFpQixPQUFqQixtQkFBcUIsVUFBckIsbUJBQTRCO0FBQzVDLGtCQUFJLFNBQVM7QUFDWixzQkFBTSxFQUFFLFNBQVMsTUFBTSxNQUFNO0FBQUEsY0FDOUI7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXdDO0FBQzdDLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUdBLFFBQUksS0FBSyxjQUFjO0FBQ3RCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFFQSxRQUFJO0FBQ0gsWUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFlBQU0sV0FBVyxRQUFRLFNBQVMsU0FBUyxJQUFJLFVBQVUsR0FBRyxPQUFPO0FBRW5FLFlBQU0sV0FBVyxNQUFNLE1BQU0sVUFBVTtBQUFBLFFBQ3RDLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGlCQUFpQixVQUFVLEtBQUssT0FBTyxNQUFNO0FBQUEsUUFDOUM7QUFBQSxNQUNELENBQUM7QUFFRCxVQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLGNBQU0sSUFBSSxNQUFNLHVCQUF1QixTQUFTLFVBQVUsRUFBRTtBQUFBLE1BQzdEO0FBRUEsWUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBR2pDLFlBQU0sU0FBUztBQUFBLFFBQ2Q7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUVBLFdBQUssZUFBZTtBQUNwQixhQUFPO0FBQUEsSUFDUixTQUFTLE9BQU87QUFDZixZQUFNLElBQUksTUFBTSxrQ0FBa0MsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQzdHO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQXdCO0FBQ3ZCLFNBQUssZUFBZTtBQUFBLEVBQ3JCO0FBQ0Q7OztBQ3JPTyxJQUFNLGlCQUFOLE1BQTJDO0FBQUEsRUFLakQsWUFBWSxRQUF3QjtBQUpwQyxnQkFBTztBQUVQLFNBQVEsZUFBZ0M7QUFHdkMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsYUFBYSxRQUF3QjtBQUNwQyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxNQUFNLGNBQWdDO0FBQ3JDLFdBQU8sQ0FBQyxDQUFDLEtBQUssT0FBTztBQUFBLEVBQ3RCO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTQSxRQUFPLENBQUM7QUFDaEUsV0FBTyxLQUFLLGVBQWUsVUFBVSxPQUFPO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQUMxRyxVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxxQkFBcUIsVUFBVSxPQUFPO0FBQUEsRUFDbkQ7QUFBQSxFQUVRLHdCQUF3QixVQUF1QixjQUE0QjtBQUNsRixVQUFNLFdBQVcsQ0FBQztBQUVsQixRQUFJLGNBQWM7QUFDakIsZUFBUyxLQUFLO0FBQUEsUUFDYixNQUFNO0FBQUEsUUFDTixPQUFPLENBQUMsRUFBRSxNQUFNLFdBQVcsWUFBWSxHQUFHLENBQUM7QUFBQSxNQUM1QyxDQUFDO0FBQUEsSUFDRjtBQUVBLGVBQVcsV0FBVyxVQUFVO0FBQy9CLFlBQU0sT0FBTyxRQUFRLFNBQVMsY0FBYyxVQUFVO0FBQ3RELGVBQVMsS0FBSztBQUFBLFFBQ2I7QUFBQSxRQUNBLE9BQU8sQ0FBQyxFQUFFLE1BQU0sUUFBUSxRQUFRLENBQUM7QUFBQSxNQUNsQyxDQUFDO0FBQUEsSUFDRjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLGVBQWUsVUFBdUIsU0FBZ0Q7QUFDM0YsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPLFNBQVM7QUFDckQsVUFBTSxNQUFNLDJEQUEyRCxLQUFLLHdCQUF3QixLQUFLLE9BQU8sTUFBTTtBQUV0SCxVQUFNLFdBQVcsTUFBTSxNQUFNLEtBQUs7QUFBQSxNQUNqQyxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxNQUNqQjtBQUFBLE1BQ0EsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQixVQUFVLEtBQUssd0JBQXdCLFVBQVUsbUNBQVMsWUFBWTtBQUFBLFFBQ3RFLGtCQUFrQjtBQUFBLFVBQ2pCLGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxVQUNoRSxrQkFBaUIsbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2pFO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sT0FBTyxNQUFNLFNBQVMsS0FBSztBQUNqQyxXQUFPLEtBQUssV0FBVyxDQUFDLEVBQUUsUUFBUSxNQUFNLENBQUMsRUFBRTtBQUFBLEVBQzVDO0FBQUEsRUFFQSxNQUFNLFNBQVMsY0FBc0IsWUFBb0IsU0FBZ0Q7QUFDeEcsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVMsV0FBVyxDQUFDO0FBQ3BFLFVBQU0sa0JBQWtCLEVBQUUsR0FBRyxTQUFTLGFBQWE7QUFDbkQsV0FBTyxLQUFLLGVBQWUsVUFBVSxlQUFlO0FBQUEsRUFDckQ7QUFBQSxFQUVBLE9BQU8scUJBQXFCLFVBQXVCLFNBQWlFO0FBdEZySDtBQXVGRSxRQUFJLENBQUMsS0FBSyxPQUFPLFFBQVE7QUFDeEIsWUFBTSxJQUFJLE1BQU0sK0JBQStCO0FBQUEsSUFDaEQ7QUFFQSxVQUFNLFNBQVEsbUNBQVMsVUFBUyxLQUFLLE9BQU8sU0FBUztBQUNyRCxVQUFNLE1BQU0sMkRBQTJELEtBQUssOEJBQThCLEtBQUssT0FBTyxNQUFNO0FBRTVILFVBQU0sV0FBVyxNQUFNLE1BQU0sS0FBSztBQUFBLE1BQ2pDLFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxRQUNSLGdCQUFnQjtBQUFBLE1BQ2pCO0FBQUEsTUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCLFVBQVUsS0FBSyx3QkFBd0IsVUFBVSxtQ0FBUyxZQUFZO0FBQUEsUUFDdEUsa0JBQWtCO0FBQUEsVUFDakIsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLFVBQ2hFLGtCQUFpQixtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDakU7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxRQUFJLFNBQVM7QUFFYixRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGtCQUFVLFFBQVEsT0FBTyxPQUFPLEVBQUUsUUFBUSxLQUFLLENBQUM7QUFDaEQsY0FBTSxRQUFRLE9BQU8sTUFBTSxJQUFJO0FBQy9CLGlCQUFTLE1BQU0sSUFBSSxLQUFLO0FBRXhCLG1CQUFXLFFBQVEsT0FBTztBQUN6QixjQUFJLEtBQUssS0FBSyxHQUFHO0FBQ2hCLGdCQUFJO0FBQ0gsb0JBQU0sU0FBUyxLQUFLLE1BQU0sSUFBSTtBQUM5QixvQkFBTSxRQUFPLG9DQUFPLGVBQVAsbUJBQW9CLE9BQXBCLG1CQUF3QixZQUF4QixtQkFBaUMsVUFBakMsbUJBQXlDLE9BQXpDLG1CQUE2QztBQUMxRCxrQkFBSSxNQUFNO0FBQ1Qsc0JBQU0sRUFBRSxTQUFTLE1BQU0sTUFBTSxNQUFNO0FBQUEsY0FDcEM7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXdDO0FBQzdDLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUdBLFFBQUksS0FBSyxjQUFjO0FBQ3RCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFFQSxRQUFJO0FBQ0gsWUFBTSxNQUFNLCtEQUErRCxLQUFLLE9BQU8sTUFBTTtBQUU3RixZQUFNLFdBQVcsTUFBTSxNQUFNLEtBQUs7QUFBQSxRQUNqQyxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixnQkFBZ0I7QUFBQSxRQUNqQjtBQUFBLE1BQ0QsQ0FBQztBQUVELFVBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsY0FBTSxJQUFJLE1BQU0sdUJBQXVCLFNBQVMsVUFBVSxFQUFFO0FBQUEsTUFDN0Q7QUFFQSxZQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFHakMsWUFBTSxTQUFTO0FBQUEsUUFDZDtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0Q7QUFFQSxXQUFLLGVBQWU7QUFDcEIsYUFBTztBQUFBLElBQ1IsU0FBUyxPQUFPO0FBQ2YsWUFBTSxJQUFJLE1BQU0sa0NBQWtDLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUM3RztBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUF3QjtBQUN2QixTQUFLLGVBQWU7QUFBQSxFQUNyQjtBQUNEOzs7QUN0TU8sSUFBTSxpQkFBTixNQUEyQztBQUFBLEVBSWpELFlBQVksUUFBd0I7QUFIcEMsZ0JBQU87QUFJTixTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxhQUFhLFFBQXdCO0FBQ3BDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLE1BQU0sY0FBZ0M7QUFDckMsUUFBSSxDQUFDLEtBQUssT0FBTyxNQUFPLFFBQU87QUFFL0IsUUFBSTtBQUNILFlBQU0sVUFBVSxLQUFLLE9BQU8sV0FBVztBQUN2QyxZQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxhQUFhO0FBQUEsUUFDbkQsUUFBUTtBQUFBLFFBQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUMvQyxDQUFDO0FBQ0QsYUFBTyxTQUFTO0FBQUEsSUFDakIsU0FBUTtBQUNQLGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSxhQUFhQyxTQUFnQixTQUFnRDtBQUNsRixVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPO0FBQzVDLFFBQUksQ0FBQyxPQUFPO0FBQ1gsWUFBTSxJQUFJLE1BQU0sZ0NBQWdDO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxpQkFBaUI7QUFBQSxNQUN2RCxRQUFRO0FBQUEsTUFDUixTQUFTLEVBQUUsZ0JBQWdCLG1CQUFtQjtBQUFBLE1BQzlDLE1BQU0sS0FBSyxVQUFVO0FBQUEsUUFDcEI7QUFBQSxRQUNBLFFBQUFBO0FBQUEsUUFDQSxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsY0FBYSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0Q7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBQ2pDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQTFENUc7QUEyREUsVUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFVBQU0sU0FBUSxtQ0FBUyxVQUFTLEtBQUssT0FBTztBQUM1QyxRQUFJLENBQUMsT0FBTztBQUNYLFlBQU0sSUFBSSxNQUFNLGdDQUFnQztBQUFBLElBQ2pEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSxHQUFHLE9BQU8saUJBQWlCO0FBQUEsTUFDdkQsUUFBUTtBQUFBLE1BQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUM5QyxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxRQUFBQTtBQUFBLFFBQ0EsUUFBUTtBQUFBLFFBQ1IsU0FBUztBQUFBLFVBQ1IsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLFVBQ2hFLGNBQWEsbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQzdEO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sVUFBUyxjQUFTLFNBQVQsbUJBQWU7QUFDOUIsUUFBSSxDQUFDLFFBQVE7QUFDWixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sVUFBVSxJQUFJLFlBQVk7QUFFaEMsUUFBSTtBQUNILGFBQU8sTUFBTTtBQUNaLGNBQU0sRUFBRSxNQUFNLE1BQU0sSUFBSSxNQUFNLE9BQU8sS0FBSztBQUMxQyxZQUFJLEtBQU07QUFFVixjQUFNLFFBQVEsUUFBUSxPQUFPLEtBQUssRUFBRSxNQUFNLElBQUk7QUFDOUMsbUJBQVcsUUFBUSxPQUFPO0FBQ3pCLGNBQUksS0FBSyxLQUFLLEdBQUc7QUFDaEIsZ0JBQUk7QUFDSCxvQkFBTSxTQUFTLEtBQUssTUFBTSxJQUFJO0FBQzlCLGtCQUFJLE9BQU8sVUFBVTtBQUNwQixzQkFBTSxFQUFFLFNBQVMsT0FBTyxVQUFVLE1BQU0sTUFBTTtBQUFBLGNBQy9DO0FBQ0Esa0JBQUksT0FBTyxNQUFNO0FBQ2hCLHNCQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUNoQztBQUFBLGNBQ0Q7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPO0FBQzVDLFFBQUksQ0FBQyxPQUFPO0FBQ1gsWUFBTSxJQUFJLE1BQU0sZ0NBQWdDO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxhQUFhO0FBQUEsTUFDbkQsUUFBUTtBQUFBLE1BQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUM5QyxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxVQUFVLFNBQVMsSUFBSSxVQUFRO0FBQUEsVUFDOUIsTUFBTSxJQUFJO0FBQUEsVUFDVixTQUFTLElBQUk7QUFBQSxRQUNkLEVBQUU7QUFBQSxRQUNGLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxVQUNoRSxjQUFhLG1DQUFTLGNBQWEsS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUM3RDtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFFBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsWUFBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsSUFDM0Q7QUFFQSxVQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFDakMsV0FBTyxLQUFLLFFBQVE7QUFBQSxFQUNyQjtBQUFBLEVBRUEsTUFBTSxTQUFTLGNBQXNCLFlBQW9CLFNBQWdEO0FBQ3hHLFVBQU0sV0FBd0I7QUFBQSxNQUM3QixFQUFFLE1BQU0sVUFBVSxTQUFTLGFBQWE7QUFBQSxNQUN4QyxFQUFFLE1BQU0sUUFBUSxTQUFTLFdBQVc7QUFBQSxJQUNyQztBQUNBLFdBQU8sS0FBSyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQWhLckg7QUFpS0UsVUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFVBQU0sU0FBUSxtQ0FBUyxVQUFTLEtBQUssT0FBTztBQUM1QyxRQUFJLENBQUMsT0FBTztBQUNYLFlBQU0sSUFBSSxNQUFNLGdDQUFnQztBQUFBLElBQ2pEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSxHQUFHLE9BQU8sYUFBYTtBQUFBLE1BQ25ELFFBQVE7QUFBQSxNQUNSLFNBQVMsRUFBRSxnQkFBZ0IsbUJBQW1CO0FBQUEsTUFDOUMsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQjtBQUFBLFFBQ0EsVUFBVSxTQUFTLElBQUksVUFBUTtBQUFBLFVBQzlCLE1BQU0sSUFBSTtBQUFBLFVBQ1YsU0FBUyxJQUFJO0FBQUEsUUFDZCxFQUFFO0FBQUEsUUFDRixRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsY0FBYSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0Q7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUVoQyxRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGNBQU0sUUFBUSxRQUFRLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSTtBQUM5QyxtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLEtBQUssR0FBRztBQUNoQixnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsbUJBQUksWUFBTyxZQUFQLG1CQUFnQixTQUFTO0FBQzVCLHNCQUFNLEVBQUUsU0FBUyxPQUFPLFFBQVEsU0FBUyxNQUFNLE1BQU07QUFBQSxjQUN0RDtBQUNBLGtCQUFJLE9BQU8sTUFBTTtBQUNoQixzQkFBTSxFQUFFLFNBQVMsSUFBSSxNQUFNLEtBQUs7QUFDaEM7QUFBQSxjQUNEO0FBQUEsWUFDRCxTQUFTLEdBQUc7QUFBQSxZQUVaO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRCxVQUFFO0FBQ0QsYUFBTyxZQUFZO0FBQUEsSUFDcEI7QUFFQSxVQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUFBLEVBQ2pDO0FBQ0Q7OztBSnZOTyxJQUFNLG9CQUFOLE1BQXdCO0FBQUEsRUFLOUIsWUFBWSxVQUF3QixnQkFBaUM7QUFKckUsU0FBUSxZQUEyQyxvQkFBSSxJQUFJO0FBSzFELFNBQUssV0FBVztBQUNoQixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxNQUFNLGFBQWE7QUFDbEIsU0FBSyxVQUFVLElBQUksVUFBVSxJQUFJLGVBQWUsS0FBSyxTQUFTLFlBQVksTUFBTSxDQUFDO0FBQ2pGLFNBQUssVUFBVSxJQUFJLFVBQVUsSUFBSSxlQUFlLEtBQUssU0FBUyxZQUFZLE1BQU0sQ0FBQztBQUNqRixTQUFLLFVBQVUsSUFBSSxVQUFVLElBQUksZUFBZSxLQUFLLFNBQVMsWUFBWSxNQUFNLENBQUM7QUFDakYsU0FBSyxVQUFVLElBQUksVUFBVSxJQUFJLGVBQWUsS0FBSyxTQUFTLFlBQVksTUFBTSxDQUFDO0FBQUEsRUFDbEY7QUFBQSxFQUVBLGVBQWUsVUFBd0I7QUFDdEMsU0FBSyxXQUFXO0FBQ2hCLFNBQUssVUFBVSxRQUFRLENBQUMsVUFBVSxTQUFTO0FBNUI3QztBQTZCRyxVQUFJLFNBQVMsVUFBVSxRQUFRLEtBQUssU0FBUyxhQUFhO0FBQ3pELHVCQUFTLGlCQUFULGtDQUF3QixLQUFLLFNBQVMsWUFBWSxJQUFnQztBQUFBLE1BQ25GO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsdUJBQXVDO0FBQzlDLFVBQU0sV0FBVywwQkFBUyxXQUFXLFdBQVc7QUFDaEQsVUFBTSxtQkFBbUIsS0FBSyxTQUFTLGlCQUFpQixRQUFRO0FBQ2hFLFVBQU0sWUFBWSxDQUFDLGlCQUFpQixpQkFBaUIsR0FBRyxpQkFBaUIsaUJBQWlCO0FBRzFGLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFHQSxNQUFjLHVCQUFtRDtBQUNoRSxVQUFNLG1CQUFtQixLQUFLLHFCQUFxQjtBQUduRCxRQUFJLGlCQUFpQixDQUFDLE1BQU0sUUFBUTtBQUNuQyxhQUFPO0FBQUEsSUFDUjtBQUVBLGVBQVcsZ0JBQWdCLGtCQUFrQjtBQUM1QyxVQUFJLGlCQUFpQixPQUFRO0FBQzdCLFlBQU0sV0FBVyxLQUFLLFVBQVUsSUFBSSxZQUFZO0FBQ2hELFVBQUksWUFBWSxNQUFNLFNBQVMsWUFBWSxHQUFHO0FBQzdDLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sV0FBVyxNQUFNLEtBQUsscUJBQXFCO0FBQ2pELFFBQUksQ0FBQyxVQUFVO0FBQ2QsWUFBTSxJQUFJLE1BQU0saURBQWlEO0FBQUEsSUFDbEU7QUFDQSxXQUFPLFNBQVMsYUFBYUEsU0FBUSxPQUFPO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQUMxRyxVQUFNLFdBQVcsTUFBTSxLQUFLLHFCQUFxQjtBQUNqRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUFBLElBQ2xFO0FBQ0EsV0FBTyxTQUFTLG1CQUFtQkEsU0FBUSxPQUFPO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixVQUFNLFdBQVcsTUFBTSxLQUFLLHFCQUFxQjtBQUNqRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUFBLElBQ2xFO0FBQ0EsV0FBTyxTQUFTLGVBQWUsVUFBVSxPQUFPO0FBQUEsRUFDakQ7QUFBQSxFQUVBLE9BQU8scUJBQXFCLFVBQXVCLFNBQWlFO0FBQ25ILFVBQU0sV0FBVyxNQUFNLEtBQUsscUJBQXFCO0FBQ2pELFFBQUksQ0FBQyxVQUFVO0FBQ2QsWUFBTSxJQUFJLE1BQU0saURBQWlEO0FBQUEsSUFDbEU7QUFDQSxXQUFPLFNBQVMscUJBQXFCLFVBQVUsT0FBTztBQUFBLEVBQ3ZEO0FBQUEsRUFFQSxtQkFBNkI7QUFDNUIsV0FBTyxNQUFNLEtBQUssS0FBSyxVQUFVLE9BQU8sQ0FBQyxFQUFFLElBQUksT0FBSyxFQUFFLElBQUk7QUFBQSxFQUMzRDtBQUFBLEVBRUEsTUFBTSx5QkFBMEM7QUFDL0MsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsV0FBTyxXQUFXLFNBQVMsT0FBTztBQUFBLEVBQ25DO0FBQUEsRUFFQSxNQUFNLHlCQUFpRDtBQUN0RCxVQUFNLG1CQUFtQixLQUFLLHFCQUFxQjtBQUNuRCxRQUFJLGlCQUFpQixDQUFDLE1BQU0sUUFBUTtBQUNuQyxhQUFPO0FBQUEsSUFDUjtBQUVBLGVBQVcsZ0JBQWdCLGtCQUFrQjtBQUM1QyxVQUFJLGlCQUFpQixPQUFRO0FBQzdCLFlBQU0sV0FBVyxLQUFLLFVBQVUsSUFBSSxZQUFZO0FBQ2hELFVBQUksWUFBWSxNQUFNLFNBQVMsWUFBWSxHQUFHO0FBQzdDLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLFNBQVMsY0FBc0IsWUFBb0IsU0FBZ0Q7QUFDeEcsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsUUFBSSxDQUFDLFVBQVU7QUFDZCxZQUFNLElBQUksTUFBTSxpREFBaUQ7QUFBQSxJQUNsRTtBQUNBLFdBQU8sU0FBUyxTQUFTLGNBQWMsWUFBWSxPQUFPO0FBQUEsRUFDM0Q7QUFBQSxFQUVBLHNCQUFzQztBQUVyQyxRQUFJLDBCQUFTLFVBQVU7QUFDdEIsYUFBTyxDQUFDLFVBQVUsVUFBVSxRQUFRO0FBQUEsSUFDckM7QUFDQSxXQUFPLENBQUMsVUFBVSxVQUFVLFVBQVUsUUFBUTtBQUFBLEVBQy9DO0FBQUEsRUFFQSxrQkFBa0IsY0FBcUM7QUFFdEQsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLG9CQUFzRDtBQUVyRCxXQUFPLEVBQUUsT0FBTyxVQUFVLE9BQU8sU0FBUztBQUFBLEVBQzNDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUFrQixjQUErQztBQUN0RSxVQUFNLFdBQVcsS0FBSyxVQUFVLElBQUksWUFBWTtBQUNoRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLFlBQVksWUFBWSxZQUFZO0FBQUEsSUFDckQ7QUFHQSxRQUFJLHdCQUF3QixZQUFZLE9BQU8sU0FBUyx1QkFBdUIsWUFBWTtBQUMxRixhQUFPLE1BQU8sU0FBaUIsbUJBQW1CO0FBQUEsSUFDbkQ7QUFHQSxXQUFPLENBQUM7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx3QkFBd0IsY0FBa0M7QUFDekQsVUFBTSxXQUFXLEtBQUssVUFBVSxJQUFJLFlBQVk7QUFDaEQsUUFBSSxDQUFDLFVBQVU7QUFDZDtBQUFBLElBQ0Q7QUFHQSxRQUFJLHFCQUFxQixZQUFZLE9BQU8sU0FBUyxvQkFBb0IsWUFBWTtBQUNwRixNQUFDLFNBQWlCLGdCQUFnQjtBQUFBLElBQ25DO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBVTtBQUNULFNBQUssVUFBVSxNQUFNO0FBQUEsRUFDdEI7QUFDRDs7O0FLbkxBLElBQUFDLG1CQUF5RTs7O0FDUWxFLElBQU0sc0JBQU4sTUFBMEI7QUFBQSxFQU03QixZQUFvQixXQUFzQjtBQUF0QjtBQUxwQixTQUFRLGdCQUErQyxvQkFBSSxJQUFJO0FBQy9ELFNBQVEscUJBQXFCO0FBQzdCO0FBQUEsU0FBUSxhQUFhO0FBQ3JCLFNBQVEsa0JBQWlDO0FBR3JDLFNBQUssa0JBQWtCO0FBQ3ZCLFNBQUsscUJBQXFCO0FBQUEsRUFDOUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsb0JBQW1DO0FBQzdDLFFBQUk7QUFDQSxZQUFNLE9BQU8sTUFBTSxLQUFLLFVBQVUsU0FBUyxLQUFLLFVBQVU7QUFDMUQsVUFBSSxRQUFRLE1BQU0sUUFBUSxJQUFJLEdBQUc7QUFDN0IsbUJBQVcsZ0JBQWdCLE1BQU07QUFDN0IsZUFBSyxjQUFjLElBQUksYUFBYSxVQUFVLFlBQVk7QUFBQSxRQUM5RDtBQUFBLE1BQ0o7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUFBLElBRWhCO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxvQkFBbUM7QUFDN0MsUUFBSTtBQUNBLFlBQU0scUJBQXFCLE1BQU0sS0FBSyxLQUFLLGNBQWMsT0FBTyxDQUFDO0FBQ2pFLFlBQU0sS0FBSyxVQUFVLFNBQVMsS0FBSyxZQUFZLGtCQUFrQjtBQUFBLElBQ3JFLFNBQVMsT0FBTztBQUFBLElBRWhCO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZ0JBQWdCLE1BQStCO0FBQzNDLFVBQU0sV0FBVyxLQUFLO0FBRXRCLFFBQUksQ0FBQyxLQUFLLGNBQWMsSUFBSSxRQUFRLEdBQUc7QUFFbkMsWUFBTSxrQkFBb0M7QUFBQSxRQUN0QztBQUFBLFFBQ0EsVUFBVSxDQUFDO0FBQUEsUUFDWCxhQUFhLEtBQUssSUFBSTtBQUFBLFFBQ3RCLFVBQVU7QUFBQSxVQUNOLFdBQVc7QUFBQSxVQUNYLGtCQUFrQjtBQUFBLFlBQ2QsS0FBSztBQUFBLFlBQ0wsTUFBTTtBQUFBLFlBQ04sUUFBUTtBQUFBLFlBQ1IsU0FBUztBQUFBLFlBQ1QsU0FBUztBQUFBLFlBQ1QsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUNBLFdBQUssY0FBYyxJQUFJLFVBQVUsZUFBZTtBQUFBLElBQ3BEO0FBRUEsV0FBTyxLQUFLLGNBQWMsSUFBSSxRQUFRO0FBQUEsRUFDMUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sZUFDRixNQUNBLFNBQ0EsU0FDNEI7QUFDNUIsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxNQUNwQjtBQUFBLElBQ0o7QUFFQSxpQkFBYSxTQUFTLEtBQUssT0FBTztBQUNsQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUdwQyxRQUFJLFdBQVcsYUFBYSxVQUFVO0FBQ2xDLG1CQUFhLFNBQVMsaUJBQWlCLFFBQVEsTUFBTTtBQUFBLElBQ3pEO0FBRUEsVUFBTSxLQUFLLFlBQVksWUFBWTtBQUNuQyxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxvQkFDRixNQUNBLFNBQ0EsUUFDNEI7QUFDNUIsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxNQUNwQjtBQUFBLElBQ0o7QUFFQSxpQkFBYSxTQUFTLEtBQUssT0FBTztBQUNsQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUdwQyxTQUFJLGlDQUFRLFlBQVcsYUFBYSxVQUFVO0FBQzFDLG1CQUFhLFNBQVM7QUFBQSxJQUMxQjtBQUVBLFVBQU0sS0FBSyxZQUFZLFlBQVk7QUFDbkMsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQWlCLE1BQWEsU0FBK0M7QUFDL0UsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxJQUN4QjtBQUVBLGlCQUFhLFNBQVMsS0FBSyxPQUFPO0FBQ2xDLGlCQUFhLGNBQWMsS0FBSyxJQUFJO0FBRXBDLFVBQU0sS0FBSyxZQUFZLFlBQVk7QUFDbkMsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixNQUFhLFFBQWdCLElBQTJCO0FBQ3RFLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFdBQU8sYUFBYSxTQUFTLE1BQU0sQ0FBQyxLQUFLO0FBQUEsRUFDN0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixNQUFhLE1BQTBEO0FBQ3JGLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFdBQU8sYUFBYSxTQUFTLE9BQU8sU0FBTyxJQUFJLFNBQVMsSUFBSTtBQUFBLEVBQ2hFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBdUIsTUFBYSxjQUFzQixHQUFXO0FBQ2pFLFVBQU0sV0FBVyxLQUFLLGtCQUFrQixNQUFNLFdBQVc7QUFFekQsUUFBSSxTQUFTLFdBQVcsR0FBRztBQUN2QixhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sZUFBZSxTQUFTLElBQUksU0FBTztBQUNyQyxZQUFNLFlBQVksSUFBSSxLQUFLLElBQUksU0FBUyxFQUFFLG1CQUFtQjtBQUM3RCxVQUFJLE9BQU8sSUFBSSxTQUFTLEtBQUssSUFBSSxLQUFLLFlBQVksQ0FBQyxLQUFLLElBQUksT0FBTztBQUVuRSxVQUFJLElBQUksU0FBUztBQUNiLGdCQUFRLGNBQWMsSUFBSSxRQUFRLE1BQU0sSUFBSSxJQUFJLFFBQVEsTUFBTTtBQUFBLE1BQ2xFO0FBRUEsVUFBSSxJQUFJLFFBQVE7QUFDWixnQkFBUSxhQUFhLElBQUksT0FBTyxVQUFVLFlBQVksUUFBUTtBQUFBLE1BQ2xFO0FBRUEsYUFBTztBQUFBLElBQ1gsQ0FBQztBQUVELFdBQU87QUFBQSxFQUEyQixhQUFhLEtBQUssSUFBSSxDQUFDO0FBQUE7QUFBQSxFQUM3RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFBa0IsTUFBNEI7QUFDaEQsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFDOUMsaUJBQWEsV0FBVyxDQUFDO0FBQ3pCLGlCQUFhLGNBQWMsS0FBSyxJQUFJO0FBRXBDLFFBQUksYUFBYSxVQUFVO0FBQ3ZCLG1CQUFhLFNBQVMsWUFBWTtBQUNsQyxtQkFBYSxTQUFTLG1CQUFtQjtBQUFBLFFBQ3JDLEtBQUs7QUFBQSxRQUNMLE1BQU07QUFBQSxRQUNOLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUVBLFVBQU0sS0FBSyxrQkFBa0I7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsU0FBUyxNQUtQO0FBN09OO0FBOE9RLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBRTlDLFFBQUksa0JBQXFDO0FBQ3pDLFFBQUksV0FBVztBQUVmLFFBQUksYUFBYSxVQUFVO0FBQ3ZCLGlCQUFXLENBQUMsUUFBUSxLQUFLLEtBQUssT0FBTyxRQUFRLGFBQWEsU0FBUyxnQkFBZ0IsR0FBRztBQUNsRixZQUFJLFFBQVEsVUFBVTtBQUNsQixxQkFBVztBQUNYLDRCQUFrQjtBQUFBLFFBQ3RCO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxVQUFNLGtCQUFrQixhQUFhLFNBQVMsU0FBUyxJQUNqRCxLQUFLLElBQUksSUFBSSxhQUFhLFNBQVMsQ0FBQyxFQUFFLFlBQ3RDO0FBRU4sV0FBTztBQUFBLE1BQ0gsY0FBYyxhQUFhLFNBQVM7QUFBQSxNQUNwQyxhQUFXLGtCQUFhLGFBQWIsbUJBQXVCLGNBQWE7QUFBQSxNQUMvQztBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsbUJBQW1CLE1BQXFCO0FBQ3BDLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFVBQU0sUUFBUSxDQUFDLDhCQUE4QixLQUFLLElBQUksSUFBSSxFQUFFO0FBRTVELGVBQVcsV0FBVyxhQUFhLFVBQVU7QUFDekMsWUFBTSxZQUFZLElBQUksS0FBSyxRQUFRLFNBQVMsRUFBRSxlQUFlO0FBQzdELFlBQU0sS0FBSyxNQUFNLFFBQVEsS0FBSyxZQUFZLENBQUMsS0FBSyxTQUFTLEdBQUc7QUFDNUQsWUFBTSxLQUFLLFFBQVEsT0FBTztBQUUxQixVQUFJLFFBQVEsU0FBUztBQUNqQixjQUFNLEtBQUssYUFBYSxRQUFRLFFBQVEsTUFBTSxJQUFJLFFBQVEsUUFBUSxNQUFNLEdBQUc7QUFBQSxNQUMvRTtBQUVBLFVBQUksUUFBUSxRQUFRO0FBQ2hCLGNBQU0sS0FBSyxZQUFZLFFBQVEsT0FBTyxVQUFVLFlBQVksUUFBUSxHQUFHO0FBQ3ZFLFlBQUksUUFBUSxPQUFPLE9BQU87QUFDdEIsZ0JBQU0sS0FBSyxXQUFXLFFBQVEsT0FBTyxLQUFLLEdBQUc7QUFBQSxRQUNqRDtBQUFBLE1BQ0o7QUFFQSxZQUFNLEtBQUssRUFBRTtBQUFBLElBQ2pCO0FBRUEsV0FBTyxNQUFNLEtBQUssSUFBSTtBQUFBLEVBQzFCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxvQkFBNEI7QUFDaEMsV0FBTyxPQUFPLEtBQUssSUFBSSxDQUFDLElBQUksS0FBSyxPQUFPLEVBQUUsU0FBUyxFQUFFLEVBQUUsT0FBTyxHQUFHLENBQUMsQ0FBQztBQUFBLEVBQ3ZFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLFlBQVksY0FBK0M7QUFDckUsUUFBSSxhQUFhLFNBQVMsU0FBUyxLQUFLLG9CQUFvQjtBQUV4RCxtQkFBYSxXQUFXLGFBQWEsU0FBUyxNQUFNLENBQUMsS0FBSyxrQkFBa0I7QUFBQSxJQUNoRjtBQUVBLFVBQU0sS0FBSyxrQkFBa0I7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsMEJBQW9DO0FBQ2hDLFdBQU8sTUFBTSxLQUFLLEtBQUssY0FBYyxLQUFLLENBQUM7QUFBQSxFQUMvQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZ0JBQWdCLE1BQXNCO0FBQ2xDLFVBQU0sZUFBZSxLQUFLLGNBQWMsSUFBSSxLQUFLLElBQUk7QUFDckQsV0FBTyxlQUFlLGFBQWEsU0FBUyxTQUFTLElBQUk7QUFBQSxFQUM3RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxlQUFlLFNBQWlCLFNBQWdDO0FBQ2xFLFVBQU0sZUFBZSxLQUFLLGNBQWMsSUFBSSxPQUFPO0FBQ25ELFFBQUksY0FBYztBQUNkLG1CQUFhLFdBQVc7QUFDeEIsV0FBSyxjQUFjLE9BQU8sT0FBTztBQUNqQyxXQUFLLGNBQWMsSUFBSSxTQUFTLFlBQVk7QUFDNUMsWUFBTSxLQUFLLGtCQUFrQjtBQUFBLElBQ2pDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQTZCO0FBRWpDLFNBQUssa0JBQWtCLE9BQU8sWUFBWSxNQUFNO0FBQzVDLFdBQUssd0JBQXdCLElBQUksS0FBSyxLQUFLLEtBQUssR0FBSTtBQUFBLElBQ3hELEdBQUcsS0FBSyxLQUFLLEtBQUssR0FBSTtBQUFBLEVBQzFCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHdCQUF3QixRQUErQjtBQUNqRSxVQUFNLE1BQU0sS0FBSyxJQUFJO0FBQ3JCLFFBQUksVUFBVTtBQUVkLGVBQVcsQ0FBQyxVQUFVLFlBQVksS0FBSyxLQUFLLGNBQWMsUUFBUSxHQUFHO0FBRWpFLFVBQUksYUFBYSxTQUFTLFNBQVMsR0FBRztBQUNsQyxjQUFNLGNBQWMsYUFBYSxTQUFTLGFBQWEsU0FBUyxTQUFTLENBQUM7QUFDMUUsY0FBTSxNQUFNLE1BQU0sWUFBWTtBQUU5QixZQUFJLE1BQU0sUUFBUTtBQUNkLGVBQUssY0FBYyxPQUFPLFFBQVE7QUFDbEMsb0JBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxRQUFJLFNBQVM7QUFDVCxZQUFNLEtBQUssa0JBQWtCO0FBQUEsSUFDakM7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxVQUFnQjtBQUNaLFFBQUksS0FBSyxvQkFBb0IsTUFBTTtBQUMvQixvQkFBYyxLQUFLLGVBQWU7QUFDbEMsV0FBSyxrQkFBa0I7QUFBQSxJQUMzQjtBQUFBLEVBQ0o7QUFDSjs7O0FEeFhPLElBQU0saUJBQU4sTUFBcUI7QUFBQSxFQUd4QixZQUFvQixLQUFVLFdBQXVCO0FBQWpDO0FBRnBCLFNBQVEsc0JBQWtEO0FBR3RELFFBQUksV0FBVztBQUNYLFdBQUssc0JBQXNCLElBQUksb0JBQW9CLFNBQVM7QUFBQSxJQUNoRTtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHVCQUF1QixxQkFBZ0Q7QUFDbkUsU0FBSyxzQkFBc0I7QUFBQSxFQUMvQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWlDO0FBRTdCLFVBQU0sZUFBZSxLQUFLLElBQUksVUFBVTtBQUN4QyxRQUFJLDZDQUFjLFFBQVE7QUFDdEIsYUFBTyxhQUFhO0FBQUEsSUFDeEI7QUFHQSxRQUFJLE9BQU8sS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBRzlELFFBQUksQ0FBQyxNQUFNO0FBQ1AsWUFBTSxTQUFTLEtBQUssSUFBSSxVQUFVLGdCQUFnQixVQUFVO0FBQzVELGlCQUFXLFFBQVEsUUFBUTtBQUN2QixjQUFNLFdBQVcsS0FBSztBQUN0QixZQUFJLG9CQUFvQiwrQkFBYztBQUNsQyxpQkFBTztBQUNQO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBRUEsUUFBSSxDQUFDLE1BQU07QUFDUCxhQUFPO0FBQUEsSUFDWDtBQUdBLFVBQU0sU0FBUyxLQUFLO0FBRXBCLFdBQU8sVUFBVTtBQUFBLEVBQ3JCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBOEI7QUFDMUIsV0FBTyxLQUFLLElBQUksVUFBVSxjQUFjO0FBQUEsRUFDNUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUEwQjtBQUN0QixVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsUUFBSSxDQUFDLE9BQVEsUUFBTztBQUVwQixXQUFPLE9BQU8sYUFBYTtBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxvQkFBMkM7QUFDdkMsVUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBQ3BDLFFBQUksQ0FBQyxPQUFRLFFBQU87QUFFcEIsV0FBTyxPQUFPLFVBQVU7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxxQkFBc0Q7QUFDeEQsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFFcEMsUUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRO0FBQ2xCLGFBQU87QUFBQSxJQUNYO0FBRUEsVUFBTSxVQUFVLE9BQU8sU0FBUztBQUNoQyxVQUFNLGVBQWUsS0FBSyxnQkFBZ0I7QUFDMUMsVUFBTSxpQkFBaUIsS0FBSyxrQkFBa0I7QUFHOUMsVUFBTSxXQUFXLEtBQUssZ0JBQWdCLE9BQU87QUFHN0MsVUFBTSxtQkFBbUIsaUJBQ3JCLEtBQUssb0JBQW9CLFNBQVMsZUFBZSxJQUFJLElBQ3JEO0FBRUosV0FBTztBQUFBLE1BQ0g7QUFBQSxNQUNBLFVBQVUsS0FBSztBQUFBLE1BQ2Y7QUFBQSxNQUNBO0FBQUEsTUFDQSxjQUFjLGdCQUFnQjtBQUFBLE1BQzlCLGdCQUFnQixrQkFBa0I7QUFBQSxNQUNsQztBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsU0FBZ0M7QUFDcEQsVUFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBQ2hDLFVBQU0sV0FBMEIsQ0FBQztBQUNqQyxRQUFJLFlBQVk7QUFFaEIsVUFBTSxRQUFRLENBQUMsTUFBTSxVQUFVO0FBQzNCLFlBQU0sZUFBZSxLQUFLLE1BQU0sbUJBQW1CO0FBQ25ELFVBQUksY0FBYztBQUNkLGNBQU0sUUFBUSxhQUFhLENBQUMsRUFBRTtBQUM5QixjQUFNLE9BQU8sYUFBYSxDQUFDO0FBRTNCLGlCQUFTLEtBQUs7QUFBQSxVQUNWO0FBQUEsVUFDQTtBQUFBLFVBQ0EsTUFBTTtBQUFBLFVBQ04sVUFBVTtBQUFBLFlBQ04sT0FBTztBQUFBLFlBQ1AsS0FBSyxZQUFZLEtBQUs7QUFBQSxVQUMxQjtBQUFBLFFBQ0osQ0FBQztBQUFBLE1BQ0w7QUFHQSxtQkFBYSxLQUFLLFNBQVM7QUFBQSxJQUMvQixDQUFDO0FBRUQsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUNKLFNBQ0EsYUFDQSxjQUFzQixHQUNlO0FBQ3JDLFVBQU0sUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUVoQyxVQUFNLFlBQVksS0FBSyxJQUFJLEdBQUcsY0FBYyxXQUFXO0FBQ3ZELFVBQU0sVUFBVSxLQUFLLElBQUksTUFBTSxTQUFTLEdBQUcsY0FBYyxXQUFXO0FBRXBFLFdBQU87QUFBQSxNQUNILFFBQVEsTUFBTSxNQUFNLFdBQVcsV0FBVztBQUFBLE1BQzFDLE9BQU8sTUFBTSxNQUFNLGNBQWMsR0FBRyxVQUFVLENBQUM7QUFBQSxJQUNuRDtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sVUFDRixTQUNBLFVBQ0EsVUFBdUIsQ0FBQyxHQUNMO0FBQ25CLFVBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUNwQyxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBRWhDLFFBQUksQ0FBQyxVQUFVLENBQUMsTUFBTTtBQUNsQixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPO0FBQUEsUUFDUCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFFQSxRQUFJO0FBQ0EsVUFBSTtBQUVKLFVBQUksYUFBYSxVQUFVO0FBRXZCLG9CQUFZLE9BQU8sVUFBVTtBQUM3QixlQUFPLGFBQWEsU0FBUyxTQUFTO0FBQUEsTUFDMUMsV0FBVyxhQUFhLGFBQWE7QUFFakMsY0FBTSxZQUFZLE9BQU8sYUFBYTtBQUN0QyxZQUFJLENBQUMsV0FBVztBQUNaLGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFDQSxvQkFBWSxPQUFPLFVBQVUsTUFBTTtBQUNuQyxlQUFPLGlCQUFpQixPQUFPO0FBQUEsTUFDbkMsV0FBVyxhQUFhLE9BQU87QUFFM0IsY0FBTSxXQUFXLE9BQU8sU0FBUztBQUNqQyxjQUFNLGlCQUFpQixPQUFPLFFBQVEsUUFBUSxFQUFFO0FBQ2hELG9CQUFZLEVBQUUsTUFBTSxVQUFVLElBQUksZUFBZTtBQUVqRCxjQUFNLGlCQUFpQixPQUFPLFNBQVM7QUFDdkMsY0FBTSxhQUFhLGtCQUFrQixlQUFlLFNBQVMsSUFBSSxJQUFJLEtBQUssUUFBUTtBQUdsRixjQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sTUFBTSxVQUFVO0FBQUEsTUFDaEQsT0FBTztBQUVILG9CQUFZO0FBQ1osZUFBTyxhQUFhLFNBQVMsU0FBUztBQUFBLE1BQzFDO0FBR0EsVUFBSSxRQUFRLGVBQWU7QUFDdkIsY0FBTSxTQUFTO0FBQUEsVUFDWCxNQUFNLFVBQVUsT0FBTyxRQUFRLE1BQU0sSUFBSSxFQUFFLFNBQVM7QUFBQSxVQUNwRCxJQUFJLFFBQVEsU0FBUyxJQUFJLElBQ3JCLFFBQVEsTUFBTSxJQUFJLEVBQUUsSUFBSSxFQUFHLFNBQzNCLFVBQVUsS0FBSyxRQUFRO0FBQUEsUUFDL0I7QUFDQSxlQUFPLGFBQWEsV0FBVyxNQUFNO0FBQUEsTUFDekM7QUFFQSxVQUFJLFFBQVEsY0FBYztBQUN0QixlQUFPLGVBQWU7QUFBQSxVQUNsQixNQUFNO0FBQUEsVUFDTixJQUFJO0FBQUEsUUFDUixHQUFHLElBQUk7QUFBQSxNQUNYO0FBRUEsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1Q7QUFBQSxRQUNBLFVBQVUsYUFBYSxjQUFjLFlBQzVCLGFBQWEsUUFBUSxXQUFXO0FBQUEsUUFDekM7QUFBQSxNQUNKO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sY0FDRixRQUNtQjtBQUNuQixVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsVUFBTSxPQUFPLEtBQUssY0FBYztBQUVoQyxRQUFJLENBQUMsVUFBVSxDQUFDLE1BQU07QUFDbEIsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTztBQUFBLFFBQ1AsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBRUEsUUFBSTtBQUNBLFVBQUksV0FBVyxhQUFhO0FBQ3hCLGNBQU0sWUFBWSxPQUFPLGFBQWE7QUFDdEMsWUFBSSxDQUFDLFdBQVc7QUFDWixpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQ0EsZUFBTyxpQkFBaUIsRUFBRTtBQUMxQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0osV0FBVyxXQUFXLFFBQVE7QUFDMUIsY0FBTSxTQUFTLE9BQU8sVUFBVTtBQUNoQyxjQUFNLE9BQU8sT0FBTztBQUNwQixlQUFPO0FBQUEsVUFBYTtBQUFBLFVBQ2hCLEVBQUUsTUFBTSxJQUFJLEVBQUU7QUFBQSxVQUNkLEVBQUUsTUFBTSxPQUFPLEdBQUcsSUFBSSxFQUFFO0FBQUEsUUFDNUI7QUFDQSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxVQUFVO0FBQUEsVUFDVixXQUFXLEVBQUUsTUFBTSxJQUFJLEVBQUU7QUFBQSxRQUM3QjtBQUFBLE1BQ0o7QUFFQSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPO0FBQUEsUUFDUCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxNQUFNLHFCQUE2QztBQUMvQyxVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsUUFBSSxDQUFDLE9BQVEsUUFBTztBQUVwQixXQUFPLE9BQU8sU0FBUztBQUFBLEVBQzNCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLG1CQUFtQixTQUFzQztBQUMzRCxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBRWhDLFFBQUksQ0FBQyxNQUFNO0FBQ1AsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTztBQUFBLFFBQ1AsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBRUEsUUFBSTtBQUNBLFlBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxNQUFNLE9BQU87QUFFekMsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1Q7QUFBQSxRQUNBLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT0EsTUFBTSxlQUFlLFNBQWlCLFNBQXNDO0FBQ3hFLFFBQUksQ0FBQyxLQUFLLG9CQUFxQjtBQUUvQixVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksTUFBTTtBQUNOLFlBQU0sS0FBSyxvQkFBb0IsZUFBZSxNQUFNLFNBQVMsT0FBTztBQUFBLElBQ3hFO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxvQkFBb0IsU0FBaUIsUUFBb0M7QUFDM0UsUUFBSSxDQUFDLEtBQUssb0JBQXFCO0FBRS9CLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxNQUFNO0FBQ04sWUFBTSxLQUFLLG9CQUFvQixvQkFBb0IsTUFBTSxTQUFTLE1BQU07QUFBQSxJQUM1RTtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQWlCLFNBQWdDO0FBQ25ELFFBQUksQ0FBQyxLQUFLLG9CQUFxQjtBQUUvQixVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksTUFBTTtBQUNOLFlBQU0sS0FBSyxvQkFBb0IsaUJBQWlCLE1BQU0sT0FBTztBQUFBLElBQ2pFO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQXVCLGNBQXNCLEdBQVc7QUFDcEQsUUFBSSxDQUFDLEtBQUssb0JBQXFCLFFBQU87QUFFdEMsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLENBQUMsS0FBTSxRQUFPO0FBRWxCLFdBQU8sS0FBSyxvQkFBb0IsdUJBQXVCLE1BQU0sV0FBVztBQUFBLEVBQzVFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLG9CQUFtQztBQUNyQyxRQUFJLENBQUMsS0FBSyxvQkFBcUI7QUFFL0IsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLE1BQU07QUFDTixZQUFNLEtBQUssb0JBQW9CLGtCQUFrQixJQUFJO0FBQUEsSUFDekQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFLUztBQUNMLFFBQUksQ0FBQyxLQUFLLG9CQUFxQixRQUFPO0FBRXRDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxDQUFDLEtBQU0sUUFBTztBQUVsQixXQUFPLEtBQUssb0JBQW9CLFNBQVMsSUFBSTtBQUFBLEVBQ2pEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBMkI7QUFDdkIsUUFBSSxDQUFDLEtBQUssb0JBQXFCLFFBQU87QUFFdEMsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLENBQUMsS0FBTSxRQUFPO0FBRWxCLFdBQU8sS0FBSyxvQkFBb0IsZ0JBQWdCLElBQUk7QUFBQSxFQUN4RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EscUJBQW9DO0FBQ2hDLFFBQUksQ0FBQyxLQUFLLG9CQUFxQixRQUFPO0FBRXRDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxDQUFDLEtBQU0sUUFBTztBQUVsQixXQUFPLEtBQUssb0JBQW9CLG1CQUFtQixJQUFJO0FBQUEsRUFDM0Q7QUFFSjs7O0FFdGJPLElBQU0saUJBQU4sTUFBcUI7QUFBQSxFQUFyQjtBQUNILFNBQVEsZ0JBQThCO0FBQUEsTUFDbEMsaUJBQWlCO0FBQUEsTUFDakIsa0JBQWtCO0FBQUEsTUFDbEIsZ0JBQWdCO0FBQUEsTUFDaEIsYUFBYTtBQUFBLE1BQ2IsV0FBVztBQUFBLElBQ2Y7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsWUFDSSxTQUNBLGlCQUNBLFVBQWlDLENBQUMsR0FDbEMscUJBQ2U7QUFDZixVQUFNLFNBQVMsRUFBRSxHQUFHLEtBQUssZUFBZSxHQUFHLFFBQVE7QUFFbkQsVUFBTSxlQUFlLEtBQUssa0JBQWtCLFFBQVEsUUFBUSxNQUFNO0FBQ2xFLFVBQU0sY0FBYyxLQUFLLGlCQUFpQixpQkFBaUIsU0FBUyxRQUFRLG1CQUFtQjtBQUMvRixVQUFNLGFBQWEsS0FBSyxnQkFBZ0IsU0FBUyxXQUFXO0FBRTVELFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0EsU0FBUztBQUFBLE1BQ1QsUUFBUTtBQUFBLFFBQ0osYUFBYSxPQUFPLGVBQWU7QUFBQSxRQUNuQyxXQUFXLE9BQU8sYUFBYTtBQUFBLE1BQ25DO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixRQUErQixRQUE4QjtBQUNuRixVQUFNLGFBQWE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVW5CLFVBQU0sd0JBQXdCO0FBQUEsTUFDMUIsT0FBTztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU9QLFFBQVE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFPUixVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BT1YsV0FBVztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU9YLFdBQVc7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFPWCxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBTWhCO0FBRUEsV0FBTyxjQUFjLHNCQUFzQixNQUFNLEtBQUs7QUFBQSxFQUMxRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsaUJBQ0osaUJBQ0EsU0FDQSxRQUNBLHFCQUNNO0FBQ04sUUFBSSxVQUFVLGFBQWEsZ0JBQWdCLFFBQVE7QUFBQTtBQUduRCxRQUFJLE9BQU8sb0JBQW9CLGdCQUFnQixTQUFTLFNBQVMsR0FBRztBQUNoRSxpQkFBVztBQUFBO0FBQ1gsWUFBTSxZQUFZLEtBQUssdUJBQXVCLGdCQUFnQixRQUFRO0FBQ3RFLGlCQUFXLFlBQVk7QUFBQSxJQUMzQjtBQUdBLGVBQVcsS0FBSyxtQkFBbUIsU0FBUyxlQUFlO0FBRzNELFFBQUksdUJBQXVCLE9BQU8sZ0JBQWdCO0FBQzlDLGlCQUFXO0FBQUE7QUFBQSxFQUE0QixtQkFBbUI7QUFBQTtBQUFBLElBQzlEO0FBR0EsZUFBVztBQUFBO0FBQUEsRUFBcUIsZ0JBQWdCLE9BQU87QUFBQTtBQUV2RCxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsbUJBQW1CLFNBQXNCLGlCQUEwQztBQUN2RixZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxZQUFJLGdCQUFnQixjQUFjO0FBQzlCLGlCQUFPO0FBQUE7QUFBQSxFQUFxQixnQkFBZ0IsWUFBWTtBQUFBO0FBQUEsUUFDNUQ7QUFDQSxlQUFPO0FBQUE7QUFBQTtBQUFBLE1BRVgsS0FBSztBQUNELFlBQUksZ0JBQWdCLGtCQUFrQjtBQUNsQyxnQkFBTSxVQUFVO0FBQUE7QUFBQTtBQUNoQixnQkFBTSxTQUFTLGdCQUFnQixpQkFBaUIsT0FBTyxLQUFLLElBQUk7QUFDaEUsZ0JBQU0sUUFBUSxnQkFBZ0IsaUJBQWlCLE1BQU0sS0FBSyxJQUFJO0FBQzlELGlCQUFPLFVBQVU7QUFBQSxFQUFtQixNQUFNO0FBQUE7QUFBQTtBQUFBLEVBQXNCLEtBQUs7QUFBQTtBQUFBLFFBQ3pFO0FBQ0EsZUFBTztBQUFBO0FBQUE7QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUE7QUFBQTtBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQTtBQUFBO0FBQUEsTUFFWDtBQUNJLGVBQU87QUFBQTtBQUFBO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixTQUFzQixhQUE2QjtBQUN2RSxRQUFJQyxVQUFTO0FBRWIsSUFBQUEsV0FBVTtBQUFBLGdCQUFtQixRQUFRLFdBQVc7QUFBQTtBQUdoRCxRQUFJLFFBQVEsU0FBUztBQUNqQixNQUFBQSxXQUFVLDRCQUE0QixRQUFRLE9BQU87QUFBQTtBQUFBLElBQ3pEO0FBR0EsSUFBQUEsV0FBVSxLQUFLLHFCQUFxQixPQUFPO0FBRzNDLElBQUFBLFdBQVUsS0FBSyxzQkFBc0IsT0FBTztBQUU1QyxXQUFPQTtBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHFCQUFxQixTQUE4QjtBQUN2RCxVQUFNLGlCQUFpQjtBQUFBLE1BQ25CLE9BQU87QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLFVBQVU7QUFBQSxNQUNWLFdBQVc7QUFBQSxNQUNYLFdBQVc7QUFBQSxNQUNYLFlBQVk7QUFBQSxJQUNoQjtBQUVBLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELGVBQU87QUFBQSxTQUFZLGVBQWUsUUFBUSxNQUFNLENBQUM7QUFBQTtBQUFBLE1BRXJELEtBQUs7QUFDRCxlQUFPO0FBQUEsU0FBWSxlQUFlLFFBQVEsTUFBTSxDQUFDO0FBQUE7QUFBQSxNQUVyRCxLQUFLO0FBQ0QsZUFBTztBQUFBLFNBQVksZUFBZSxRQUFRLE1BQU0sQ0FBQztBQUFBO0FBQUEsTUFFckQsS0FBSztBQUNELGVBQU87QUFBQTtBQUFBO0FBQUEsTUFFWDtBQUNJLGVBQU87QUFBQSxTQUFZLGVBQWUsUUFBUSxNQUFNLENBQUM7QUFBQTtBQUFBLElBQ3pEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esc0JBQXNCLFNBQThCO0FBQ3hELFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVg7QUFDSSxlQUFPO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHVCQUF1QixVQUErQztBQUMxRSxXQUFPLFNBQVMsSUFBSSxhQUFXO0FBQzNCLFlBQU0sU0FBUyxLQUFLLE9BQU8sUUFBUSxRQUFRLENBQUM7QUFDNUMsYUFBTyxHQUFHLE1BQU0sS0FBSyxRQUFRLElBQUk7QUFBQSxJQUNyQyxDQUFDLEVBQUUsS0FBSyxJQUFJO0FBQUEsRUFDaEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGVBQWVBLFNBQStEO0FBQzFFLFVBQU0sU0FBbUIsQ0FBQztBQUUxQixRQUFJLENBQUNBLFFBQU8sZ0JBQWdCQSxRQUFPLGFBQWEsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUNqRSxhQUFPLEtBQUssd0JBQXdCO0FBQUEsSUFDeEM7QUFFQSxRQUFJLENBQUNBLFFBQU8sY0FBY0EsUUFBTyxXQUFXLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDN0QsYUFBTyxLQUFLLHNCQUFzQjtBQUFBLElBQ3RDO0FBRUEsUUFBSUEsUUFBTyxXQUFXLFNBQVMsS0FBTztBQUNsQyxhQUFPLEtBQUssNkNBQTZDO0FBQUEsSUFDN0Q7QUFFQSxXQUFPO0FBQUEsTUFDSCxPQUFPLE9BQU8sV0FBVztBQUFBLE1BQ3pCO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDNVJBLElBQU0sbUJBQXFDO0FBQUEsRUFDdkM7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxhQUFhLFVBQVU7QUFBQSxFQUNyQztBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLElBQ0EsU0FBUyxDQUFDLFlBQVksS0FBSztBQUFBLEVBQy9CO0FBQUEsRUFDQTtBQUFBLElBQ0ksUUFBUTtBQUFBLElBQ1IsVUFBVTtBQUFBLE1BQ047QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsSUFDQSxTQUFTLENBQUMsV0FBVztBQUFBLEVBQ3pCO0FBQUEsRUFDQTtBQUFBLElBQ0ksUUFBUTtBQUFBLElBQ1IsVUFBVTtBQUFBLE1BQ047QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQTtBQUFBLE1BRUE7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLElBQ0EsU0FBUyxDQUFDLEtBQUs7QUFBQSxFQUNuQjtBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLElBQ0EsU0FBUyxDQUFDLFdBQVc7QUFBQSxFQUN6QjtBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxVQUFVO0FBQUEsRUFDeEI7QUFDSjtBQU1BLElBQU0sa0JBQWtCO0FBQUEsRUFDcEIsRUFBRSxTQUFTLHlEQUF5RCxRQUFRLFlBQVk7QUFBQSxFQUN4RixFQUFFLFNBQVMscURBQXFELFFBQVEsV0FBVztBQUFBLEVBQ25GLEVBQUUsU0FBUyxnQ0FBZ0MsUUFBUSxNQUFNO0FBQzdEO0FBRU8sSUFBTSxnQkFBTixNQUFvQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS3ZCLGFBQWEsT0FBZSxlQUF3QixPQUFvQjtBQUNwRSxVQUFNLGtCQUFrQixNQUFNLEtBQUssRUFBRSxZQUFZO0FBR2pELFVBQU0sU0FBUyxLQUFLLGFBQWEsZUFBZTtBQUdoRCxVQUFNLFNBQVMsS0FBSyxhQUFhLGlCQUFpQixjQUFjLE1BQU07QUFHdEUsVUFBTSxVQUFVLEtBQUssZUFBZSxLQUFLO0FBRXpDLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0EsYUFBYTtBQUFBO0FBQUEsTUFDYjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxhQUFhLE9BQTJCO0FBRTVDLGVBQVcsa0JBQWtCLGtCQUFrQjtBQUMzQyxpQkFBVyxXQUFXLGVBQWUsVUFBVTtBQUMzQyxZQUFJLFFBQVEsS0FBSyxLQUFLLEdBQUc7QUFDckIsaUJBQU8sZUFBZTtBQUFBLFFBQzFCO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFHQSxRQUFJLDJEQUEyRCxLQUFLLEtBQUssR0FBRztBQUN4RSxhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksb0RBQW9ELEtBQUssS0FBSyxHQUFHO0FBQ2pFLGFBQU87QUFBQSxJQUNYO0FBQ0EsUUFBSSxpQ0FBaUMsS0FBSyxLQUFLLEdBQUc7QUFDOUMsYUFBTztBQUFBLElBQ1g7QUFDQSxRQUFJLG9EQUFvRCxLQUFLLEtBQUssR0FBRztBQUNqRSxhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksc0hBQXNILEtBQUssS0FBSyxHQUFHO0FBQ25JLGFBQU87QUFBQSxJQUNYO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGFBQ0osT0FDQSxjQUNBLFFBQ3FCO0FBRXJCLGVBQVcsaUJBQWlCLGlCQUFpQjtBQUN6QyxVQUFJLGNBQWMsUUFBUSxLQUFLLEtBQUssR0FBRztBQUNuQyxlQUFPLGNBQWM7QUFBQSxNQUN6QjtBQUFBLElBQ0o7QUFHQSxRQUFJLGlCQUFpQixXQUFXLFVBQVUsV0FBVyxhQUFhLFdBQVcsV0FBVztBQUNwRixhQUFPO0FBQUEsSUFDWDtBQUdBLFlBQVEsUUFBUTtBQUFBLE1BQ1osS0FBSztBQUNELGVBQU87QUFBQSxNQUNYLEtBQUs7QUFDRCxlQUFPLGVBQWUsY0FBYztBQUFBLE1BQ3hDLEtBQUs7QUFDRCxlQUFPLGVBQWUsY0FBYztBQUFBLE1BQ3hDLEtBQUs7QUFDRCxlQUFPLGVBQWUsY0FBYztBQUFBLE1BQ3hDLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFDWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BQ1g7QUFDSSxlQUFPO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1RLGVBQWUsT0FBdUI7QUFFMUMsVUFBTSxrQkFBa0I7QUFBQSxNQUNwQjtBQUFBLE1BQVU7QUFBQSxNQUFZO0FBQUEsTUFBVTtBQUFBLE1BQWdCO0FBQUEsTUFBWTtBQUFBLE1BQzVEO0FBQUEsTUFBVTtBQUFBLE1BQVc7QUFBQSxNQUFZO0FBQUEsTUFBUztBQUFBLE1BQVc7QUFBQSxNQUNyRDtBQUFBLE1BQVk7QUFBQSxNQUFXO0FBQUEsTUFBWTtBQUFBLE1BQVk7QUFBQSxJQUNuRDtBQUVBLFVBQU0sY0FBYyxnQkFBZ0I7QUFBQSxNQUFPLFdBQ3ZDLE1BQU0sWUFBWSxFQUFFLFNBQVMsS0FBSztBQUFBLElBQ3RDO0FBRUEsUUFBSSxVQUFVO0FBQ2QsUUFBSSxZQUFZLFNBQVMsR0FBRztBQUN4QixpQkFBVyxVQUFVLFlBQVksS0FBSyxJQUFJLENBQUM7QUFBQSxJQUMvQztBQUdBLFFBQUksTUFBTSxTQUFTLE9BQU8sS0FBSyxNQUFNLFNBQVMsT0FBTyxLQUFLLE1BQU0sU0FBUyxTQUFTLEdBQUc7QUFDakYsaUJBQVc7QUFBQSxJQUNmO0FBQ0EsUUFBSSxNQUFNLFNBQVMsTUFBTSxLQUFLLE1BQU0sU0FBUyxVQUFVLEtBQUssTUFBTSxTQUFTLGVBQWUsR0FBRztBQUN6RixpQkFBVztBQUFBLElBQ2Y7QUFHQSxRQUFJLE1BQU0sU0FBUyxRQUFRLEtBQUssTUFBTSxTQUFTLE1BQU0sR0FBRztBQUNwRCxpQkFBVztBQUFBLElBQ2Y7QUFDQSxRQUFJLE1BQU0sU0FBUyxTQUFTLEtBQUssTUFBTSxTQUFTLFVBQVUsR0FBRztBQUN6RCxpQkFBVztBQUFBLElBQ2Y7QUFDQSxRQUFJLE1BQU0sU0FBUyxRQUFRLEtBQUssTUFBTSxTQUFTLFVBQVUsR0FBRztBQUN4RCxpQkFBVztBQUFBLElBQ2Y7QUFHQSxXQUFPLFFBQVEsS0FBSztBQUFBLEVBQ3hCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsU0FBc0IsY0FHcEM7QUFFRSxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxTQUFTLFFBQVEsV0FBVyxhQUFhO0FBQzVELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZUFBZSxjQUFpQztBQUM1QyxVQUFNLGNBQXdCLENBQUM7QUFFL0IsUUFBSSxjQUFjO0FBQ2Qsa0JBQVk7QUFBQSxRQUNSO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUFBLElBQ0osT0FBTztBQUNILGtCQUFZO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHNCQUFzQixPQUE4QjtBQUVoRCxVQUFNLGFBQWE7QUFDbkIsVUFBTSxRQUFRLE1BQU0sTUFBTSxVQUFVO0FBRXBDLFFBQUksTUFBTSxXQUFXLEdBQUc7QUFDcEIsYUFBTyxDQUFDLEtBQUssYUFBYSxLQUFLLENBQUM7QUFBQSxJQUNwQztBQUVBLFdBQU8sTUFDRixJQUFJLFVBQVEsS0FBSyxLQUFLLENBQUMsRUFDdkIsT0FBTyxVQUFRLEtBQUssU0FBUyxDQUFDLEVBQzlCLElBQUksVUFBUSxLQUFLLGFBQWEsSUFBSSxDQUFDO0FBQUEsRUFDNUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHNCQUFzQixTQUE4QjtBQUNoRCxVQUFNLEVBQUUsUUFBUSxPQUFPLElBQUk7QUFFM0IsUUFBSSxjQUFjO0FBRWxCLFlBQVEsUUFBUTtBQUFBLE1BQ1osS0FBSztBQUNELHNCQUFjO0FBQ2Q7QUFBQSxNQUNKLEtBQUs7QUFDRCxzQkFBYztBQUNkO0FBQUEsTUFDSixLQUFLO0FBQ0Qsc0JBQWM7QUFDZDtBQUFBLE1BQ0osS0FBSztBQUNELHNCQUFjO0FBQ2Q7QUFBQSxNQUNKLEtBQUs7QUFDRCxzQkFBYztBQUNkO0FBQUEsTUFDSixLQUFLO0FBQ0Qsc0JBQWM7QUFDZDtBQUFBLElBQ1I7QUFFQSxZQUFRLFFBQVE7QUFBQSxNQUNaLEtBQUs7QUFDRCx1QkFBZTtBQUNmO0FBQUEsTUFDSixLQUFLO0FBQ0QsdUJBQWU7QUFDZjtBQUFBLE1BQ0osS0FBSztBQUNELHVCQUFlO0FBQ2Y7QUFBQSxNQUNKLEtBQUs7QUFDRCx1QkFBZTtBQUNmO0FBQUEsSUFDUjtBQUVBLFdBQU87QUFBQSxFQUNYO0FBQ0o7OztBQ25WTyxJQUFNLGdCQUFOLE1BQW9CO0FBQUEsRUFNdkIsWUFDSSxnQkFDQSxxQkFDRjtBQUNFLFNBQUssaUJBQWlCLElBQUksZUFBZTtBQUN6QyxTQUFLLGlCQUFpQjtBQUN0QixTQUFLLHNCQUFzQjtBQUMzQixTQUFLLGdCQUFnQixJQUFJLGNBQWM7QUFBQSxFQUMzQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxzQkFDRixTQUNBLE1BQ0EsVUFBaUMsQ0FBQyxHQUNWO0FBRXhCLFVBQU0sa0JBQWtCLEtBQUssZ0JBQWdCLE9BQU87QUFFcEQsUUFBSSxtQkFBbUIsTUFBTTtBQUV6QixZQUFNLGdCQUFnQixLQUFLLGNBQWMsYUFBYSxPQUFPO0FBQzdELGFBQU8sS0FBSyxtQkFBbUIsZUFBZSxNQUFNLE9BQU87QUFBQSxJQUMvRCxPQUFPO0FBRUgsYUFBTyxLQUFLLHdCQUF3QixTQUFTLE1BQU0sT0FBTztBQUFBLElBQzlEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQWdCLFNBQTBCO0FBQzlDLFVBQU0sZUFBZSxRQUFRLFlBQVksRUFBRSxLQUFLO0FBR2hELFFBQUksYUFBYSxXQUFXLEdBQUcsR0FBRztBQUM5QixhQUFPO0FBQUEsSUFDWDtBQUdBLFVBQU0sY0FBYztBQUFBLE1BQ2hCO0FBQUEsTUFBTztBQUFBLE1BQVU7QUFBQSxNQUFVO0FBQUEsTUFBVztBQUFBLE1BQVc7QUFBQSxNQUFVO0FBQUEsTUFBUztBQUFBLE1BQ3BFO0FBQUEsTUFBUTtBQUFBLE1BQVU7QUFBQSxNQUFVO0FBQUEsTUFBVTtBQUFBLE1BQVU7QUFBQSxNQUFXO0FBQUEsTUFBVztBQUFBLE1BQ3RFO0FBQUEsTUFBVTtBQUFBLE1BQVU7QUFBQSxNQUFhO0FBQUEsTUFBTztBQUFBLE1BQVM7QUFBQSxNQUNqRDtBQUFBLE1BQU87QUFBQSxNQUFXO0FBQUEsTUFBYTtBQUFBLE1BQVU7QUFBQSxNQUN6QztBQUFBLE1BQVc7QUFBQSxNQUFVO0FBQUEsTUFBWTtBQUFBLE1BQWU7QUFBQSxJQUNwRDtBQUdBLFVBQU0sbUJBQW1CLFlBQVksS0FBSyxVQUFRO0FBQzlDLFlBQU0sY0FBYyxJQUFJLE9BQU8sSUFBSSxJQUFJLE9BQU8sR0FBRztBQUNqRCxhQUFPLFlBQVksS0FBSyxZQUFZO0FBQUEsSUFDeEMsQ0FBQztBQUVELFFBQUksa0JBQWtCO0FBRWxCLFlBQU0scUJBQXFCO0FBQUEsUUFDdkI7QUFBQSxRQUNBO0FBQUE7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxtQkFBbUIsS0FBSyxhQUFXLFFBQVEsS0FBSyxZQUFZLENBQUM7QUFDaEYsVUFBSSxZQUFZO0FBQ1osZUFBTztBQUFBLE1BQ1g7QUFFQSxhQUFPO0FBQUEsSUFDWDtBQUdBLFVBQU0sMEJBQTBCO0FBQUE7QUFBQSxNQUU1QjtBQUFBO0FBQUEsTUFHQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBR0EsZUFBVyxXQUFXLHlCQUF5QjtBQUMzQyxVQUFJLFFBQVEsS0FBSyxZQUFZLEdBQUc7QUFDNUIsZUFBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sbUJBQ0YsU0FDQSxNQUNBLFVBQWlDLENBQUMsR0FDVjtBQUN4QixRQUFJLENBQUMsTUFBTTtBQUNQLFlBQU0sSUFBSSxNQUFNLHNDQUFzQztBQUFBLElBQzFEO0FBR0EsVUFBTSxrQkFBa0IsTUFBTSxLQUFLLG1CQUFtQixJQUFJO0FBRzFELFFBQUk7QUFDSixRQUFJLFFBQVEsZ0JBQWdCO0FBQ3hCLFlBQU0saUJBQWlCLE1BQU0sS0FBSyxvQkFBb0Isa0JBQWtCLE1BQU0sQ0FBQztBQUMvRSw0QkFBc0IsS0FBSywwQkFBMEIsY0FBYztBQUFBLElBQ3ZFO0FBR0EsV0FBTyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixTQUFTLG1CQUFtQjtBQUFBLEVBQ2pHO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHdCQUNGLFNBQ0EsTUFDQSxVQUFpQyxDQUFDLEdBQ1Y7QUFDeEIsUUFBSTtBQUNKLFFBQUksZ0JBQXVDLENBQUM7QUFHNUMsUUFBSSxNQUFNO0FBQ04sd0JBQWtCLE1BQU0sS0FBSyxtQkFBbUIsSUFBSTtBQUdwRCxzQkFBZ0IsTUFBTSxLQUFLLG9CQUFvQixrQkFBa0IsTUFBTSxDQUFDO0FBQUEsSUFDNUU7QUFFQSxXQUFPLEtBQUssZUFBZSx3QkFBd0IsU0FBUyxpQkFBaUIsYUFBYTtBQUFBLEVBQzlGO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBa0IsYUFBcUIsU0FBbUM7QUFDdEUsV0FBTyxLQUFLLGVBQWUsa0JBQWtCLGFBQWEsT0FBTztBQUFBLEVBQ3JFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLG1CQUFtQixNQUF1QztBQUVwRSxVQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBRTdELFFBQUksQ0FBQyxTQUFTO0FBRVYsWUFBTSxVQUFVLE1BQU0sS0FBSyxlQUFlLG1CQUFtQixLQUFLO0FBQ2xFLGFBQU87QUFBQSxRQUNIO0FBQUEsUUFDQSxVQUFVLEtBQUs7QUFBQSxRQUNmO0FBQUEsUUFDQSxVQUFVLENBQUM7QUFBQSxRQUNYLGNBQWM7QUFBQSxRQUNkLGtCQUFrQjtBQUFBLE1BQ3RCO0FBQUEsSUFDSjtBQUdBLFdBQU87QUFBQSxFQUNYO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSwwQkFBMEIsVUFBeUM7QUFDdkUsUUFBSSxTQUFTLFdBQVcsRUFBRyxRQUFPO0FBRWxDLFFBQUksWUFBWTtBQUNoQixhQUFTLFFBQVEsU0FBTztBQUNwQixZQUFNLE9BQU8sSUFBSSxTQUFTLFNBQVMsUUFBUTtBQUMzQyxtQkFBYSxHQUFHLElBQUksS0FBSyxJQUFJLE9BQU87QUFBQTtBQUFBLElBQ3hDLENBQUM7QUFFRCxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsMEJBQTBCQyxTQUEwQztBQUNoRSxVQUFNLGFBQWEsS0FBSyxlQUFlLGVBQWVBLE9BQU07QUFFNUQsUUFBSSxDQUFDLFdBQVcsT0FBTztBQUluQixVQUFJLGtCQUFrQixFQUFFLEdBQUdBLFFBQU87QUFHbEMsWUFBTSxhQUFhLEtBQUssZUFBZSxtQkFBbUJBLE9BQU07QUFDaEUsVUFBSSxhQUFhLEtBQU07QUFFbkIsY0FBTSxtQkFBbUIsS0FBSyxNQUFNQSxRQUFPLFFBQVEsU0FBUyxHQUFHO0FBQy9ELHdCQUFnQixVQUFVQSxRQUFPLFFBQVEsVUFBVSxHQUFHLGdCQUFnQixJQUFJO0FBQUEsTUFDOUU7QUFHQSxVQUFJQSxRQUFPLE9BQU8sY0FBYyxLQUFLQSxRQUFPLE9BQU8sY0FBYyxHQUFHO0FBQ2hFLHdCQUFnQixPQUFPLGNBQWMsS0FBSyxJQUFJLEdBQUcsS0FBSyxJQUFJLEdBQUdBLFFBQU8sT0FBTyxXQUFXLENBQUM7QUFBQSxNQUMzRjtBQUdBLFVBQUlBLFFBQU8sT0FBTyxZQUFZLE1BQU1BLFFBQU8sT0FBTyxZQUFZLEtBQU07QUFDaEUsd0JBQWdCLE9BQU8sWUFBWSxLQUFLLElBQUksSUFBSSxLQUFLLElBQUksS0FBTUEsUUFBTyxPQUFPLFNBQVMsQ0FBQztBQUFBLE1BQzNGO0FBRUEsYUFBTztBQUFBLElBQ1g7QUFFQSxXQUFPQTtBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGNBQWNBLFNBQWlDO0FBQzNDLFdBQU8sS0FBSyxlQUFlLG1CQUFtQkEsT0FBTTtBQUFBLEVBQ3hEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGlCQUNGLFFBQ0EsYUFDQSxNQUN3QjtBQUN4QixVQUFNLFVBQXVCO0FBQUEsTUFDekI7QUFBQSxNQUNBLFFBQVE7QUFBQSxNQUNSO0FBQUEsTUFDQSxTQUFTO0FBQUEsSUFDYjtBQUVBLFFBQUksTUFBTTtBQUNOLGFBQU8sS0FBSyxtQkFBbUIsU0FBUyxNQUFNO0FBQUEsUUFDMUMsaUJBQWlCO0FBQUEsUUFDakIsa0JBQWtCO0FBQUEsUUFDbEIsZ0JBQWdCO0FBQUEsTUFDcEIsQ0FBQztBQUFBLElBQ0wsT0FBTztBQUNILGFBQU8sS0FBSyxrQkFBa0IsV0FBVztBQUFBLElBQzdDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFDRixjQUNBLGFBQ0EsTUFDd0I7QUFDeEIsUUFBSSxVQUFVO0FBRWQsUUFBSSxNQUFNO0FBQ04sWUFBTSxrQkFBa0IsTUFBTSxLQUFLLG1CQUFtQixJQUFJO0FBQzFELGdCQUFVLGFBQWEsZ0JBQWdCLFFBQVE7QUFBQSxFQUFLLGdCQUFnQixPQUFPO0FBQUEsSUFDL0U7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0EsWUFBWTtBQUFBLE1BQ1o7QUFBQSxNQUNBLFFBQVE7QUFBQSxRQUNKLGFBQWE7QUFBQSxRQUNiLFdBQVc7QUFBQSxNQUNmO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDclNPLElBQU0sYUFBTixNQUFpQjtBQUFBLEVBQ3BCLFlBQ1ksS0FDQSxnQkFDQSxnQkFDQSxpQkFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFDVDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0gsTUFBTSxRQUFRLFNBQStDO0FBQ3pELFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsT0FBTztBQUMvQyxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sbUJBQW1CLEtBQUssZUFBZSxlQUFlQSxPQUFNO0FBQ2xFLFVBQUksQ0FBQyxpQkFBaUIsT0FBTztBQUN6QixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixpQkFBaUIsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ3RFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFFQSxjQUFNLEtBQUssZUFBZSxlQUFlLFFBQVEsYUFBYSxPQUFPO0FBRXJFLGNBQU0sVUFBVSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsVUFDdkNBLFFBQU87QUFBQSxVQUNQO0FBQUEsWUFDSSxjQUFjQSxRQUFPO0FBQUEsWUFDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsWUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsVUFDN0I7QUFBQSxRQUNKO0FBRUEsWUFBSSxDQUFDLFdBQVcsUUFBUSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ3pDLGdCQUFNQyxVQUFTO0FBQUEsWUFDWCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUdBLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IsOEJBQThCQSxPQUFNO0FBQ2xGLGlCQUFPQTtBQUFBLFFBQ1g7QUFHQSxjQUFNLFNBQVMsTUFBTSxLQUFLLGNBQWMsU0FBUyxpQkFBaUIsT0FBTztBQUd6RSxZQUFJLENBQUMsT0FBTyxTQUFTO0FBQ2pCLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IseUJBQXlCLE1BQU07QUFBQSxRQUNqRixPQUFPO0FBQ0gsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiw4QkFBOEIsTUFBTTtBQUFBLFFBQ3RGO0FBRUEsZUFBTztBQUFBLE1BRVgsU0FBUyxPQUFPO0FBQ1osY0FBTSxTQUFTO0FBQUEsVUFDWCxTQUFTO0FBQUEsVUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBR0EsY0FBTSxLQUFLLGVBQWU7QUFBQSxVQUN0QixVQUFVLE9BQU8sS0FBSztBQUFBLFVBQ3RCO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsY0FDVixTQUNBLGlCQUNBLFNBQ21CO0FBQ25CLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFVBQzdCO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxZQUNJLGNBQWM7QUFBQSxZQUNkLGVBQWU7QUFBQSxVQUNuQjtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSixPQUFPO0FBRUgsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSjtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLHVCQUF1QixRQUFRLE1BQU07QUFBQSxVQUM1QyxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsU0FBOEQ7QUFFbEYsUUFBSSxRQUFRLFdBQVcsT0FBTztBQUMxQixhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLENBQUMsUUFBUSxlQUFlLFFBQVEsWUFBWSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ2pFLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUNKOzs7QUMvTU8sSUFBTSxjQUFOLE1BQWtCO0FBQUEsRUFDckIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBK0M7QUFDekQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxLQUFLLGdCQUFnQixTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsWUFBWTtBQUMvRSxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sbUJBQW1CLEtBQUssZUFBZSxlQUFlQSxPQUFNO0FBQ2xFLFVBQUksQ0FBQyxpQkFBaUIsT0FBTztBQUN6QixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixpQkFBaUIsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ3RFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFFQSxjQUFNLEtBQUssZUFBZSxlQUFlLFFBQVEsYUFBYSxPQUFPO0FBRXJFLGNBQU0sVUFBVSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsVUFDdkNBLFFBQU87QUFBQSxVQUNQO0FBQUEsWUFDSSxjQUFjQSxRQUFPO0FBQUEsWUFDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsWUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsVUFDN0I7QUFBQSxRQUNKO0FBRUEsWUFBSSxDQUFDLFdBQVcsUUFBUSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ3pDLGdCQUFNQyxVQUFTO0FBQUEsWUFDWCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUdBLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IsOEJBQThCQSxPQUFNO0FBQ2xGLGlCQUFPQTtBQUFBLFFBQ1g7QUFHQSxjQUFNLFNBQVMsTUFBTSxLQUFLLFVBQVUsU0FBUyxpQkFBaUIsT0FBTztBQUdyRSxZQUFJLENBQUMsT0FBTyxTQUFTO0FBQ2pCLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IsMEJBQTBCLE1BQU07QUFBQSxRQUNsRixPQUFPO0FBQ0gsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiwrQkFBK0IsTUFBTTtBQUFBLFFBQ3ZGO0FBRUEsZUFBTztBQUFBLE1BRVgsU0FBUyxPQUFPO0FBQ1osY0FBTSxTQUFTO0FBQUEsVUFDWCxTQUFTO0FBQUEsVUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBR0EsY0FBTSxLQUFLLGVBQWU7QUFBQSxVQUN0QixVQUFVLE9BQU8sS0FBSztBQUFBLFVBQ3RCO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsVUFDVixTQUNBLGlCQUNBLFNBQ21CO0FBQ25CLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSixPQUFPO0FBQ0gsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZSxtQkFBbUIsT0FBTztBQUFBLE1BRS9ELEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLHdCQUF3QixRQUFRLE1BQU07QUFBQSxVQUM3QyxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFDSixTQUNBLGNBQ2tDO0FBRWxDLFFBQUksUUFBUSxXQUFXLGVBQWUsQ0FBQyxjQUFjO0FBQ2pELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLFFBQVE7QUFDM0IsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBR0EsUUFBSSxDQUFDLFFBQVEsZUFBZSxRQUFRLFlBQVksS0FBSyxFQUFFLFdBQVcsR0FBRztBQUNqRSxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFFQSxXQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsRUFDekI7QUFDSjs7O0FDOU1PLElBQU0sZ0JBQU4sTUFBb0I7QUFBQSxFQUN2QixZQUNZLEtBQ0EsZ0JBQ0EsZ0JBQ0EsaUJBQ1Y7QUFKVTtBQUNBO0FBQ0E7QUFDQTtBQUFBLEVBQ1Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtILE1BQU0sUUFBUSxTQUErQztBQUN6RCxRQUFJO0FBRUEsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFVBQUksQ0FBQyxpQkFBaUI7QUFDbEIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFVBQ1AsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsWUFBTSxhQUFhLEtBQUssZ0JBQWdCLFNBQVMsQ0FBQyxDQUFDLGdCQUFnQixZQUFZO0FBQy9FLFVBQUksQ0FBQyxXQUFXLE9BQU87QUFDbkIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyxXQUFXO0FBQUEsVUFDbEIsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsWUFBTSxTQUFTLE1BQU0sS0FBSyxjQUFjLFNBQVMsZUFBZTtBQUdoRSxVQUFJLFFBQVEsZUFBZSxRQUFRLFlBQVksS0FBSyxFQUFFLFNBQVMsR0FBRztBQUM5RCxjQUFNLEtBQUssZUFBZSxlQUFlLFFBQVEsYUFBYSxPQUFPO0FBRXJFLFlBQUksT0FBTyxTQUFTO0FBQ2hCLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IsZ0NBQWdDLE1BQU07QUFBQSxRQUN4RixPQUFPO0FBQ0gsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiw0QkFBNEIsTUFBTTtBQUFBLFFBQ3BGO0FBQUEsTUFDSjtBQUVBLGFBQU87QUFBQSxJQUVYLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDaEQsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxjQUNWLFNBQ0EsaUJBQ21CO0FBQ25CLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSixPQUFPO0FBQ0gsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWUsY0FBYyxNQUFNO0FBQUEsTUFFekQsS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWUsbUJBQW1CLEVBQUU7QUFBQSxNQUUxRCxLQUFLO0FBRUQsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFVBQ1AsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUVKO0FBQ0ksZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTywwQkFBMEIsUUFBUSxNQUFNO0FBQUEsVUFDL0MsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxJQUNSO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQ0osU0FDQSxjQUNrQztBQUVsQyxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxVQUFVO0FBQzdCLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUNKOzs7QUN0SU8sSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBQ3hCLFlBQ1ksS0FDQSxnQkFDQSxnQkFDQSxpQkFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFDVDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0gsTUFBTSxRQUFRLFNBQStDO0FBQ3pELFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsU0FBUyxDQUFDLENBQUMsZ0JBQWdCLFlBQVk7QUFDL0UsVUFBSSxDQUFDLFdBQVcsT0FBTztBQUNuQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLFdBQVc7QUFBQSxVQUNsQixVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLHNCQUFzQixLQUFLLGVBQWUsdUJBQXVCO0FBQ3ZFLFlBQU0sZUFBZSxzQkFBc0IsRUFBRSxnQkFBZ0IsS0FBSyxJQUFJLENBQUM7QUFDdkUsWUFBTUMsVUFBUyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixjQUFjLG1CQUFtQjtBQUcxRyxZQUFNLG1CQUFtQixLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUNsRSxVQUFJLENBQUMsaUJBQWlCLE9BQU87QUFDekIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyw2QkFBNkIsaUJBQWlCLE9BQU8sS0FBSyxJQUFJLENBQUM7QUFBQSxVQUN0RSxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxVQUFJO0FBRUEsY0FBTSxLQUFLLGVBQWUsZUFBZSxRQUFRLGFBQWEsT0FBTztBQUVyRSxjQUFNLFVBQVUsTUFBTSxLQUFLLGdCQUFnQjtBQUFBLFVBQ3ZDQSxRQUFPO0FBQUEsVUFDUDtBQUFBLFlBQ0ksY0FBY0EsUUFBTztBQUFBLFlBQ3JCLGFBQWFBLFFBQU8sT0FBTztBQUFBLFlBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFVBQzdCO0FBQUEsUUFDSjtBQUVBLFlBQUksQ0FBQyxXQUFXLFFBQVEsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUN6QyxnQkFBTUMsVUFBUztBQUFBLFlBQ1gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFHQSxnQkFBTSxLQUFLLGVBQWUsb0JBQW9CLHlCQUF5QkEsT0FBTTtBQUM3RSxpQkFBT0E7QUFBQSxRQUNYO0FBR0EsY0FBTSxTQUFTLE1BQU0sS0FBSyxnQkFBZ0IsU0FBUyxpQkFBaUIsT0FBTztBQUczRSxZQUFJLENBQUMsT0FBTyxTQUFTO0FBQ2pCLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IseUJBQXlCLE1BQU07QUFBQSxRQUNqRixPQUFPO0FBQ0gsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiw4QkFBOEIsTUFBTTtBQUFBLFFBQ3RGO0FBRUEsZUFBTztBQUFBLE1BRVgsU0FBUyxPQUFPO0FBQ1osY0FBTSxTQUFTO0FBQUEsVUFDWCxTQUFTO0FBQUEsVUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBR0EsY0FBTSxLQUFLLGVBQWU7QUFBQSxVQUN0QixVQUFVLE9BQU8sS0FBSztBQUFBLFVBQ3RCO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsZ0JBQ1YsU0FDQSxpQkFDQSxTQUNtQjtBQUNuQixZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxZQUFJLGdCQUFnQixjQUFjO0FBQzlCLGlCQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsWUFDN0I7QUFBQSxZQUNBO0FBQUEsWUFDQTtBQUFBLGNBQ0ksY0FBYztBQUFBLGNBQ2QsZUFBZTtBQUFBLFlBQ25CO0FBQUEsVUFDSjtBQUFBLFFBQ0osT0FBTztBQUNILGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlLG1CQUFtQixPQUFPO0FBQUEsTUFFL0QsS0FBSztBQUdELGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFVBQ1AsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUVKO0FBQ0ksZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTywyQkFBMkIsUUFBUSxNQUFNO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxJQUNSO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQ0osU0FDQSxjQUNrQztBQUVsQyxRQUFJLFFBQVEsV0FBVyxXQUFXO0FBQzlCLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLGVBQWUsQ0FBQyxjQUFjO0FBQ2pELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFFBQUksUUFBUSxXQUFXLGVBQWUsUUFBUSxXQUFXLFlBQVk7QUFDakUsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBRUEsV0FBTyxFQUFFLE9BQU8sS0FBSztBQUFBLEVBQ3pCO0FBQ0o7OztBQ3hNTyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFDeEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBK0M7QUFDekQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxLQUFLLGdCQUFnQixPQUFPO0FBQy9DLFVBQUksQ0FBQyxXQUFXLE9BQU87QUFDbkIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyxXQUFXO0FBQUEsVUFDbEIsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsWUFBTSxzQkFBc0IsS0FBSyxlQUFlLHVCQUF1QjtBQUN2RSxZQUFNLGVBQWUsc0JBQXNCLEVBQUUsZ0JBQWdCLEtBQUssSUFBSSxDQUFDO0FBQ3ZFLFlBQU1DLFVBQVMsS0FBSyxlQUFlLFlBQVksU0FBUyxpQkFBaUIsY0FBYyxtQkFBbUI7QUFHMUcsWUFBTSxtQkFBbUIsS0FBSyxlQUFlLGVBQWVBLE9BQU07QUFDbEUsVUFBSSxDQUFDLGlCQUFpQixPQUFPO0FBQ3pCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sNkJBQTZCLGlCQUFpQixPQUFPLEtBQUssSUFBSSxDQUFDO0FBQUEsVUFDdEUsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsVUFBSTtBQUVBLGNBQU0sS0FBSyxlQUFlLGVBQWUsUUFBUSxhQUFhLE9BQU87QUFFckUsY0FBTSxVQUFVLE1BQU0sS0FBSyxnQkFBZ0I7QUFBQSxVQUN2Q0EsUUFBTztBQUFBLFVBQ1A7QUFBQSxZQUNJLGNBQWNBLFFBQU87QUFBQSxZQUNyQixhQUFhQSxRQUFPLE9BQU87QUFBQSxZQUMzQixXQUFXQSxRQUFPLE9BQU87QUFBQSxVQUM3QjtBQUFBLFFBQ0o7QUFFQSxZQUFJLENBQUMsV0FBVyxRQUFRLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDekMsZ0JBQU1DLFVBQVM7QUFBQSxZQUNYLFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBR0EsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiw4QkFBOEJBLE9BQU07QUFDbEYsaUJBQU9BO0FBQUEsUUFDWDtBQUdBLGNBQU0sU0FBUyxNQUFNLEtBQUssYUFBYSxTQUFTLGlCQUFpQixPQUFPO0FBR3hFLFlBQUksQ0FBQyxPQUFPLFNBQVM7QUFDakIsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiw2QkFBNkIsTUFBTTtBQUFBLFFBQ3JGLE9BQU87QUFDSCxnQkFBTSxLQUFLLGVBQWUsb0JBQW9CLGtDQUFrQyxNQUFNO0FBQUEsUUFDMUY7QUFFQSxlQUFPO0FBQUEsTUFFWCxTQUFTLE9BQU87QUFDWixjQUFNLFNBQVM7QUFBQSxVQUNYLFNBQVM7QUFBQSxVQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFHQSxjQUFNLEtBQUssZUFBZTtBQUFBLFVBQ3RCLFVBQVUsT0FBTyxLQUFLO0FBQUEsVUFDdEI7QUFBQSxRQUNKO0FBRUEsZUFBTztBQUFBLE1BQ1g7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDaEQsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxhQUNWLFNBQ0EsaUJBQ0EsU0FDbUI7QUFDbkIsWUFBUSxRQUFRLFFBQVE7QUFBQSxNQUNwQixLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZSxtQkFBbUIsT0FBTztBQUFBLE1BRS9ELEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSixPQUFPO0FBQ0gsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSjtBQUNJLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sMkJBQTJCLFFBQVEsTUFBTTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBQUEsSUFDUjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixTQUE4RDtBQUVsRixRQUFJLFFBQVEsV0FBVyxXQUFXO0FBQzlCLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksQ0FBQyxRQUFRLGVBQWUsUUFBUSxZQUFZLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDakUsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBRUEsV0FBTyxFQUFFLE9BQU8sS0FBSztBQUFBLEVBQ3pCO0FBQ0o7OztBQ2pNTyxJQUFNLGtCQUFOLE1BQXNCO0FBQUEsRUFDekIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBMkM7QUFDckQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sYUFBYSxLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUM1RCxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sNkJBQTZCLFdBQVcsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ2hFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsUUFDMUNBLFFBQU87QUFBQSxRQUNQQSxRQUFPO0FBQUEsUUFDUDtBQUFBLFVBQ0ksYUFBYUEsUUFBTyxPQUFPO0FBQUEsVUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBR0EsWUFBTSxVQUFVLEtBQUsscUJBQXFCLFVBQVU7QUFDcEQsVUFBSSxDQUFDLFdBQVcsT0FBTyxLQUFLLE9BQU8sRUFBRSxXQUFXLEdBQUc7QUFDL0MsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFVBQ1AsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsWUFBTSxpQkFBaUIsS0FBSyxrQkFBa0IsZ0JBQWdCLFNBQVMsT0FBTztBQUc5RSxZQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sZ0JBQWdCLE1BQU0sY0FBYztBQUVoRSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxXQUFXLEVBQUUsTUFBTSxHQUFHLElBQUksRUFBRTtBQUFBLFFBQzVCLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLDhCQUErQixNQUFnQixPQUFPO0FBQUEsUUFDN0QsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EscUJBQXFCLFVBQThDO0FBQ3ZFLFFBQUk7QUFFQSxZQUFNLFlBQVksU0FBUyxNQUFNLDRCQUE0QjtBQUM3RCxVQUFJLFdBQVc7QUFDWCxlQUFPLEtBQUssTUFBTSxVQUFVLENBQUMsQ0FBQztBQUFBLE1BQ2xDO0FBR0EsWUFBTSxVQUErQixDQUFDO0FBQ3RDLFlBQU0sUUFBUSxTQUFTLE1BQU0sSUFBSTtBQUVqQyxpQkFBVyxRQUFRLE9BQU87QUFFdEIsY0FBTSxRQUFRLEtBQUssTUFBTSx5QkFBeUI7QUFDbEQsWUFBSSxPQUFPO0FBQ1AsZ0JBQU0sTUFBTSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBQzFCLGNBQUksUUFBUSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBRzFCLGNBQUk7QUFDQSxvQkFBUSxLQUFLLE1BQU0sS0FBSztBQUFBLFVBQzVCLFNBQVE7QUFHSixnQkFBSyxNQUFNLFdBQVcsR0FBRyxLQUFLLE1BQU0sU0FBUyxHQUFHLEtBQzNDLE1BQU0sV0FBVyxHQUFHLEtBQUssTUFBTSxTQUFTLEdBQUcsR0FBSTtBQUNoRCxzQkFBUSxNQUFNLE1BQU0sR0FBRyxFQUFFO0FBQUEsWUFDN0I7QUFBQSxVQUNKO0FBRUEsa0JBQVEsR0FBRyxJQUFJO0FBQUEsUUFDbkI7QUFBQSxNQUNKO0FBRUEsYUFBTyxPQUFPLEtBQUssT0FBTyxFQUFFLFNBQVMsSUFBSSxVQUFVO0FBQUEsSUFDdkQsU0FBUyxPQUFPO0FBRVosYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxrQkFBa0IsU0FBaUIsU0FBc0M7QUFDN0UsVUFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBR2hDLFFBQUksTUFBTSxDQUFDLE1BQU0sT0FBTztBQUVwQixVQUFJLFdBQVc7QUFDZixlQUFTLElBQUksR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ25DLFlBQUksTUFBTSxDQUFDLE1BQU0sT0FBTztBQUNwQixxQkFBVztBQUNYO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFFQSxVQUFJLFdBQVcsR0FBRztBQUVkLGNBQU0sZ0JBQXFDLENBQUM7QUFDNUMsaUJBQVMsSUFBSSxHQUFHLElBQUksVUFBVSxLQUFLO0FBQy9CLGdCQUFNLFFBQVEsTUFBTSxDQUFDLEVBQUUsTUFBTSxtQkFBbUI7QUFDaEQsY0FBSSxPQUFPO0FBQ1Asa0JBQU0sTUFBTSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBQzFCLGdCQUFJLFFBQVEsTUFBTSxDQUFDLEVBQUUsS0FBSztBQUcxQixnQkFBSTtBQUNBLHNCQUFRLEtBQUssTUFBTSxLQUFLO0FBQUEsWUFDNUIsU0FBUTtBQUFBLFlBRVI7QUFFQSwwQkFBYyxHQUFHLElBQUk7QUFBQSxVQUN6QjtBQUFBLFFBQ0o7QUFHQSxjQUFNLGNBQWMsRUFBRSxHQUFHLGVBQWUsR0FBRyxRQUFRO0FBR25ELGNBQU1DLGtCQUFpQixDQUFDLEtBQUs7QUFDN0IsbUJBQVcsQ0FBQyxLQUFLLEtBQUssS0FBSyxPQUFPLFFBQVEsV0FBVyxHQUFHO0FBQ3BELGNBQUksVUFBVSxRQUFRLFVBQVUsUUFBVztBQUV2QztBQUFBLFVBQ0o7QUFFQSxnQkFBTSxpQkFBaUIsT0FBTyxVQUFVLFdBQ2xDLEtBQUssVUFBVSxLQUFLLElBQ3BCLE9BQU8sS0FBSztBQUVsQixVQUFBQSxnQkFBZSxLQUFLLEdBQUcsR0FBRyxLQUFLLGNBQWMsRUFBRTtBQUFBLFFBQ25EO0FBQ0EsUUFBQUEsZ0JBQWUsS0FBSyxLQUFLO0FBR3pCLGVBQU87QUFBQSxVQUNILEdBQUdBO0FBQUEsVUFDSCxHQUFHLE1BQU0sTUFBTSxXQUFXLENBQUM7QUFBQSxRQUMvQixFQUFFLEtBQUssSUFBSTtBQUFBLE1BQ2Y7QUFBQSxJQUNKO0FBR0EsVUFBTSxpQkFBaUIsQ0FBQyxLQUFLO0FBQzdCLGVBQVcsQ0FBQyxLQUFLLEtBQUssS0FBSyxPQUFPLFFBQVEsT0FBTyxHQUFHO0FBQ2hELFVBQUksVUFBVSxRQUFRLFVBQVUsUUFBVztBQUN2QztBQUFBLE1BQ0o7QUFFQSxZQUFNLGlCQUFpQixPQUFPLFVBQVUsV0FDbEMsS0FBSyxVQUFVLEtBQUssSUFDcEIsT0FBTyxLQUFLO0FBRWxCLHFCQUFlLEtBQUssR0FBRyxHQUFHLEtBQUssY0FBYyxFQUFFO0FBQUEsSUFDbkQ7QUFDQSxtQkFBZSxLQUFLLE9BQU8sRUFBRTtBQUc3QixXQUFPLGVBQWUsS0FBSyxJQUFJLElBQUk7QUFBQSxFQUN2QztBQUNKOzs7QUMvTU8sSUFBTSxxQkFBdUQ7QUFBQTtBQUFBLEVBRWhFLFlBQVk7QUFBQSxJQUNSLGVBQWU7QUFBQTtBQUFBLElBQ2YsYUFBYTtBQUFBO0FBQUEsSUFDYixhQUFhO0FBQUEsRUFDakI7QUFBQTtBQUFBLEVBR0EsY0FBYztBQUFBLElBQ1YsZUFBZTtBQUFBO0FBQUEsSUFDZixhQUFhO0FBQUE7QUFBQSxJQUNiLGFBQWE7QUFBQSxFQUNqQjtBQUFBO0FBQUEsRUFHQSxzQkFBc0I7QUFBQSxJQUNsQixlQUFlO0FBQUE7QUFBQSxJQUNmLGFBQWE7QUFBQTtBQUFBLElBQ2IsYUFBYTtBQUFBLEVBQ2pCO0FBQ0o7QUFNTyxJQUFNLGdCQUFnQjtBQUFBLEVBQ3pCO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFBQSxFQUNBO0FBQUE7QUFDSjs7O0FDOUNPLElBQU0saUJBQU4sTUFBcUI7QUFBQSxFQU0zQixZQUNTLGtCQUNSLGVBQ0M7QUFGTztBQU5ULFNBQVEsV0FBcUMsb0JBQUksSUFBSTtBQUNyRCxTQUFRLG1CQUE0QztBQUNwRCxTQUFRLGNBQXVCO0FBQy9CLFNBQVEsZ0JBQStCLEVBQUUsU0FBUyxNQUFNO0FBTXZELFFBQUksZUFBZTtBQUNsQixXQUFLLGdCQUFnQjtBQUFBLElBQ3RCO0FBQ0EsU0FBSyx1QkFBdUI7QUFBQSxFQUM3QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9RLHlCQUErQjtBQUV0QyxrQkFBYyxRQUFRLGdCQUFjO0FBQ25DLFdBQUssZ0JBQWdCO0FBQUEsUUFDcEIsS0FBSztBQUFBLFFBQ0wsU0FBUztBQUFBLFFBQ1QsYUFBYSxLQUFLLDBCQUEwQixVQUFVO0FBQUEsTUFDdkQsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUdELFdBQU8sUUFBUSxrQkFBa0IsRUFBRSxRQUFRLENBQUMsQ0FBQyxLQUFLLE1BQU0sTUFBTTtBQUM3RCxZQUFNLFVBQVUsS0FBSywwQkFBMEIsS0FBSyxNQUFNO0FBQzFELFdBQUssZ0JBQWdCO0FBQUEsUUFDcEI7QUFBQSxRQUNBO0FBQUEsUUFDQSxhQUFhLE9BQU87QUFBQSxRQUNwQixhQUFhO0FBQUEsUUFDYixpQkFBaUIsQ0FBQyxLQUFLLHFCQUFxQixNQUFNO0FBQUEsTUFDbkQsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUFBLEVBQ0Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDBCQUEwQixLQUFxQjtBQUN0RCxVQUFNLGVBQXVDO0FBQUEsTUFDNUMsaUJBQWlCO0FBQUEsTUFDakIsb0JBQW9CO0FBQUEsTUFDcEIsc0JBQXNCO0FBQUEsTUFDdEIsc0JBQXNCO0FBQUEsTUFDdEIsaUJBQWlCO0FBQUEsTUFDakIsa0JBQWtCO0FBQUEsTUFDbEIsZ0JBQWdCO0FBQUEsTUFDaEIsb0JBQW9CO0FBQUEsSUFDckI7QUFDQSxXQUFPLGFBQWEsR0FBRyxLQUFLO0FBQUEsRUFDN0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDBCQUEwQixZQUFvQixRQUFtQztBQUN4RixVQUFNLE1BQU0sS0FBSyxlQUFlO0FBQ2hDLFVBQU0sZ0JBQWdCLElBQUksS0FBSyxPQUFPLGFBQWE7QUFDbkQsVUFBTSxjQUFjLElBQUksS0FBSyxPQUFPLFdBQVc7QUFHL0MsUUFBSSxPQUFPLGFBQWE7QUFDdkIsYUFBTztBQUFBLElBQ1I7QUFHQSxRQUFJLEtBQUssZUFBZSxLQUFLLE9BQU8sZUFBZTtBQUNsRCxhQUFPO0FBQUEsSUFDUjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxxQkFBcUIsUUFBbUM7QUFDL0QsVUFBTSxNQUFNLEtBQUssZUFBZTtBQUNoQyxVQUFNLGNBQWMsSUFBSSxLQUFLLE9BQU8sV0FBVztBQUMvQyxXQUFPLE9BQU87QUFBQSxFQUNmO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxpQkFBdUI7QUFDOUIsUUFBSSxLQUFLLGNBQWMsV0FBVyxLQUFLLGNBQWMsY0FBYztBQUNsRSxhQUFPLElBQUksS0FBSyxLQUFLLGNBQWMsWUFBWTtBQUFBLElBQ2hEO0FBQ0EsV0FBTyxvQkFBSSxLQUFLO0FBQUEsRUFDakI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUEwQjtBQUNqQyxRQUFJLEtBQUssY0FBYyxXQUFXLEtBQUssY0FBYyxtQkFBbUIsUUFBVztBQUNsRixhQUFPLEtBQUssY0FBYztBQUFBLElBQzNCO0FBQ0EsV0FBTyxLQUFLO0FBQUEsRUFDYjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZ0JBQWdCLE1BQXlCO0FBQ3hDLFNBQUssU0FBUyxJQUFJLEtBQUssS0FBSyxJQUFJO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sdUJBQXVCLFlBQTBDO0FBQ3RFLFFBQUksQ0FBQyxZQUFZO0FBQ2hCLFdBQUssbUJBQW1CO0FBQ3hCLFdBQUssY0FBYztBQUFBLElBQ3BCLE9BQU87QUFDTixZQUFNLGFBQWEsTUFBTSxLQUFLLGlCQUFpQix5QkFBeUIsVUFBVTtBQUNsRixVQUFJLFdBQVcsU0FBUyxXQUFXLFNBQVM7QUFDM0MsYUFBSyxtQkFBbUIsV0FBVztBQUNuQyxhQUFLLGNBQWM7QUFBQSxNQUNwQixPQUFPO0FBQ04sYUFBSyxtQkFBbUI7QUFDeEIsYUFBSyxjQUFjO0FBQUEsTUFDcEI7QUFBQSxJQUNEO0FBR0EsU0FBSyx1QkFBdUI7QUFBQSxFQUM3QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQWdDO0FBQy9CLFdBQU8sS0FBSyxlQUFlO0FBQUEsRUFDNUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHNCQUErQztBQUM5QyxXQUFPLEtBQUs7QUFBQSxFQUNiO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxpQkFBaUIsWUFBNkI7QUFqSy9DO0FBbUtFLFFBQUksS0FBSyxtQkFBbUIsVUFBVSxHQUFHO0FBQ3hDLGFBQU87QUFBQSxJQUNSO0FBRUEsVUFBTSxVQUFVLEtBQUssU0FBUyxJQUFJLFVBQVU7QUFDNUMsWUFBTyx3Q0FBUyxZQUFULFlBQW9CO0FBQUEsRUFDNUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG1CQUFtQixLQUFzQjtBQUNoRCxVQUFNLGFBQWE7QUFBQSxNQUNsQjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNEO0FBQ0EsV0FBTyxXQUFXLFNBQVMsR0FBRztBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxtQkFBbUIsWUFBeUM7QUFFM0QsUUFBSSxLQUFLLG1CQUFtQixVQUFVLEdBQUc7QUFDeEMsYUFBTyxFQUFFLFNBQVMsS0FBSztBQUFBLElBQ3hCO0FBRUEsVUFBTSxVQUFVLEtBQUssU0FBUyxJQUFJLFVBQVU7QUFFNUMsUUFBSSxDQUFDLFNBQVM7QUFDYixhQUFPO0FBQUEsUUFDTixTQUFTO0FBQUEsUUFDVCxRQUFRLFlBQVksVUFBVTtBQUFBLE1BQy9CO0FBQUEsSUFDRDtBQUVBLFFBQUksUUFBUSxTQUFTO0FBQ3BCLGFBQU8sRUFBRSxTQUFTLEtBQUs7QUFBQSxJQUN4QjtBQUdBLFFBQUksUUFBUSxhQUFhO0FBQ3hCLFlBQU0sU0FBUyxtQkFBbUIsVUFBVTtBQUM1QyxVQUFJLFFBQVE7QUFDWCxjQUFNLE1BQU0sS0FBSyxlQUFlO0FBQ2hDLGNBQU0sY0FBYyxJQUFJLEtBQUssT0FBTyxXQUFXO0FBQy9DLGNBQU0sZ0JBQWdCLElBQUksS0FBSyxPQUFPLGFBQWE7QUFFbkQsWUFBSSxLQUFLLGVBQWUsS0FBSyxNQUFNLGVBQWU7QUFDakQsaUJBQU87QUFBQSxZQUNOLFNBQVM7QUFBQSxZQUNULFFBQVEsNkRBQTZELE9BQU8sYUFBYTtBQUFBLFlBQ3pGLG9CQUFvQjtBQUFBLFlBQ3BCLGVBQWU7QUFBQSxVQUNoQjtBQUFBLFFBQ0QsV0FBVyxDQUFDLEtBQUssZUFBZSxLQUFLLE1BQU0sYUFBYTtBQUN2RCxpQkFBTztBQUFBLFlBQ04sU0FBUztBQUFBLFlBQ1QsUUFBUSw0R0FBNEcsT0FBTyxXQUFXO0FBQUEsWUFDdEksb0JBQW9CO0FBQUEsWUFDcEIsZUFBZTtBQUFBLFVBQ2hCO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBRUEsV0FBTztBQUFBLE1BQ04sU0FBUztBQUFBLE1BQ1QsUUFBUTtBQUFBLElBQ1Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBb0M7QUFDbkMsV0FBTyxNQUFNLEtBQUssS0FBSyxTQUFTLE9BQU8sQ0FBQyxFQUFFLE9BQU8sYUFBVyxRQUFRLE9BQU87QUFBQSxFQUM1RTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQXNDO0FBQ3JDLFdBQU8sTUFBTSxLQUFLLEtBQUssU0FBUyxPQUFPLENBQUMsRUFBRTtBQUFBLE1BQU8sYUFDaEQsUUFBUSxlQUFlLFFBQVE7QUFBQSxJQUNoQztBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUFvQixVQUErQjtBQUNsRCxTQUFLLGdCQUFnQjtBQUVyQixTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxtQkFBa0M7QUFDakMsV0FBTyxFQUFFLEdBQUcsS0FBSyxjQUFjO0FBQUEsRUFDaEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUlFO0FBQ0QsVUFBTSxVQUFvQixDQUFDO0FBQzNCLFVBQU0sYUFBZ0YsQ0FBQztBQUV2RixlQUFXLENBQUMsS0FBSyxPQUFPLEtBQUssS0FBSyxVQUFVO0FBQzNDLFVBQUksUUFBUSxTQUFTO0FBQ3BCLGdCQUFRLEtBQUssR0FBRztBQUFBLE1BQ2pCLFdBQVcsUUFBUSxhQUFhO0FBQy9CLGNBQU0sU0FBUyxtQkFBbUIsR0FBRztBQUNyQyxZQUFJLFFBQVE7QUFDWCxnQkFBTSxrQkFBa0IsS0FBSyxlQUFlO0FBQzVDLHFCQUFXLEtBQUs7QUFBQSxZQUNmO0FBQUEsWUFDQSxlQUFlLGtCQUFrQixPQUFPLGdCQUFnQixPQUFPO0FBQUEsWUFDL0QsYUFBYTtBQUFBLFVBQ2QsQ0FBQztBQUFBLFFBQ0Y7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxNQUNOLGFBQWEsS0FBSyxlQUFlO0FBQUEsTUFDakM7QUFBQSxNQUNBO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFDRDs7O0FDcFRPLElBQU0sbUJBQU4sTUFBdUI7QUFBQSxFQUF2QjtBQUVOO0FBQUEsU0FBaUIsYUFBYTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLOUIsTUFBTSxnQkFBZ0IsWUFBc0Q7QUFDM0UsUUFBSTtBQUNILFlBQU0sVUFBVSxLQUFLLGdCQUFnQixVQUFVO0FBQy9DLFVBQUksQ0FBQyxTQUFTO0FBQ2IsZUFBTztBQUFBLFVBQ04sT0FBTztBQUFBLFVBQ1A7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxzQkFBc0IsT0FBTztBQUNoRSxVQUFJLGlCQUFpQjtBQUNwQixlQUFPO0FBQUEsVUFDTixPQUFPO0FBQUEsVUFDUDtBQUFBLFVBQ0EsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBRUEsYUFBTztBQUFBLFFBQ04sT0FBTztBQUFBLFFBQ1A7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixhQUFPO0FBQUEsUUFDTixPQUFPO0FBQUEsUUFDUDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQWdCLFlBQW9DO0FBQzNELFFBQUk7QUFFSCxZQUFNLFVBQVUsS0FBSyxhQUFhLFVBQVU7QUFDNUMsWUFBTSxRQUFRLFFBQVEsTUFBTSxHQUFHO0FBRS9CLFVBQUksTUFBTSxXQUFXLEdBQUc7QUFDdkIsZUFBTztBQUFBLE1BQ1I7QUFFQSxZQUFNLENBQUMsT0FBTyxNQUFNLGNBQWMsYUFBYSxTQUFTLElBQUk7QUFLNUQsWUFBTSxZQUFZLGlCQUFpQixhQUFhLE9BQU8sSUFBSSxLQUFLLFlBQVk7QUFDNUUsWUFBTSxXQUFXLElBQUksS0FBSyxXQUFXO0FBR3JDLFVBQUksTUFBTSxTQUFTLFFBQVEsQ0FBQyxHQUFHO0FBQzlCLGVBQU87QUFBQSxNQUNSO0FBRUEsVUFBSSxhQUFhLE1BQU0sVUFBVSxRQUFRLENBQUMsR0FBRztBQUM1QyxlQUFPO0FBQUEsTUFDUjtBQUVBLGFBQU87QUFBQSxRQUNOO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0Q7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsYUFBYSxLQUFxQjtBQUN6QyxRQUFJLE9BQU8sU0FBUyxhQUFhO0FBQ2hDLGFBQU8sS0FBSyxHQUFHO0FBQUEsSUFDaEI7QUFFQSxXQUFPLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxTQUFTLE1BQU07QUFBQSxFQUNsRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsYUFBYSxLQUFxQjtBQUN6QyxRQUFJLE9BQU8sU0FBUyxhQUFhO0FBQ2hDLGFBQU8sS0FBSyxHQUFHO0FBQUEsSUFDaEI7QUFFQSxXQUFPLE9BQU8sS0FBSyxLQUFLLE1BQU0sRUFBRSxTQUFTLFFBQVE7QUFBQSxFQUNsRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxzQkFBc0IsU0FBZ0Q7QUFFbkYsVUFBTSxvQkFBb0IsTUFBTSxLQUFLO0FBQUEsTUFDcEMsUUFBUTtBQUFBLE1BQ1I7QUFBQTtBQUFBLE1BQ0EsUUFBUTtBQUFBLE1BQ1IsUUFBUTtBQUFBLElBQ1Q7QUFFQSxRQUFJLFFBQVEsY0FBYyxtQkFBbUI7QUFDNUM7QUFBQSxJQUNEO0FBR0EsUUFBSSxRQUFRLGFBQWEsb0JBQUksS0FBSyxJQUFJLFFBQVEsV0FBVztBQUN4RDtBQUFBLElBQ0Q7QUFHQSxRQUFJLFFBQVEsV0FBVyxvQkFBSSxLQUFLLEdBQUc7QUFDbEM7QUFBQSxJQUNEO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsa0JBQ2IsT0FDQSxNQUNBLFdBQ0EsVUFDa0I7QUFDbEIsVUFBTSxPQUFPLEdBQUcsS0FBSyxJQUFJLElBQUksS0FBSSx1Q0FBVyxrQkFBaUIsVUFBVSxJQUFJLFNBQVMsWUFBWSxDQUFDO0FBRWpHLFVBQU0sVUFBVSxJQUFJLFlBQVk7QUFDaEMsVUFBTSxVQUFVLFFBQVEsT0FBTyxLQUFLLFVBQVU7QUFDOUMsVUFBTSxjQUFjLFFBQVEsT0FBTyxJQUFJO0FBRXZDLFVBQU0sWUFBWSxNQUFNLE9BQU8sT0FBTztBQUFBLE1BQ3JDO0FBQUEsTUFDQTtBQUFBLE1BQ0EsRUFBRSxNQUFNLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDaEM7QUFBQSxNQUNBLENBQUMsTUFBTTtBQUFBLElBQ1I7QUFFQSxVQUFNLFlBQVksTUFBTSxPQUFPLE9BQU8sS0FBSyxRQUFRLFdBQVcsV0FBVztBQUN6RSxXQUFPLE1BQU0sS0FBSyxJQUFJLFdBQVcsU0FBUyxDQUFDLEVBQ3pDLElBQUksT0FBSyxFQUFFLFNBQVMsRUFBRSxFQUFFLFNBQVMsR0FBRyxHQUFHLENBQUMsRUFDeEMsS0FBSyxFQUFFO0FBQUEsRUFDVjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFBa0IsT0FBZSxNQUFjLGVBQWUsTUFBdUI7QUFDMUYsVUFBTSxXQUFXLG9CQUFJLEtBQUs7QUFDMUIsVUFBTSxZQUFZLGVBQWUsT0FBTyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksTUFBTSxLQUFLLEtBQUssS0FBSyxHQUFJO0FBRXZGLFVBQU0sWUFBWSxNQUFNLEtBQUssa0JBQWtCLE9BQU8sTUFBTSxXQUFXLFFBQVE7QUFFL0UsVUFBTSxjQUFjLEdBQUcsS0FBSyxJQUFJLElBQUksS0FBSSx1Q0FBVyxrQkFBaUIsVUFBVSxJQUFJLFNBQVMsWUFBWSxDQUFDLElBQUksU0FBUztBQUVySCxXQUFPLEtBQUssYUFBYSxXQUFXO0FBQUEsRUFDckM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0seUJBQXlCLFlBQXdEO0FBQ3RGLFFBQUk7QUFDSCxZQUFNLFVBQVUsS0FBSyx5QkFBeUIsVUFBVTtBQUN4RCxVQUFJLENBQUMsU0FBUztBQUNiLGVBQU87QUFBQSxVQUNOLE9BQU87QUFBQSxVQUNQO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssK0JBQStCLE9BQU87QUFDekUsVUFBSSxpQkFBaUI7QUFDcEIsZUFBTztBQUFBLFVBQ04sT0FBTztBQUFBLFVBQ1A7QUFBQSxVQUNBLE9BQU87QUFBQSxRQUNSO0FBQUEsTUFDRDtBQUVBLGFBQU87QUFBQSxRQUNOLE9BQU87QUFBQSxRQUNQO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsYUFBTztBQUFBLFFBQ04sT0FBTztBQUFBLFFBQ1A7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHlCQUF5QixZQUE2QztBQUM3RSxRQUFJO0FBRUgsWUFBTSxVQUFVLEtBQUssYUFBYSxVQUFVO0FBQzVDLFlBQU0sUUFBUSxRQUFRLE1BQU0sR0FBRztBQUUvQixVQUFJLE1BQU0sV0FBVyxHQUFHO0FBQ3ZCLGVBQU87QUFBQSxNQUNSO0FBRUEsWUFBTSxDQUFDLE9BQU8sTUFBTSxjQUFjLGFBQWEsU0FBUyxJQUFJO0FBRzVELFVBQUksU0FBUyxZQUFZLFNBQVMsWUFBWTtBQUM3QyxlQUFPO0FBQUEsTUFDUjtBQUdBLFlBQU0sWUFBWSxpQkFBaUIsYUFBYSxPQUFPLElBQUksS0FBSyxZQUFZO0FBQzVFLFlBQU0sV0FBVyxJQUFJLEtBQUssV0FBVztBQUdyQyxVQUFJLE1BQU0sU0FBUyxRQUFRLENBQUMsR0FBRztBQUM5QixlQUFPO0FBQUEsTUFDUjtBQUVBLFVBQUksYUFBYSxNQUFNLFVBQVUsUUFBUSxDQUFDLEdBQUc7QUFDNUMsZUFBTztBQUFBLE1BQ1I7QUFFQSxhQUFPO0FBQUEsUUFDTjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsYUFBTztBQUFBLElBQ1I7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLCtCQUErQixTQUF5RDtBQUVyRyxVQUFNLG9CQUFvQixNQUFNLEtBQUs7QUFBQSxNQUNwQyxRQUFRO0FBQUEsTUFDUixRQUFRO0FBQUEsTUFDUixRQUFRO0FBQUEsTUFDUixRQUFRO0FBQUEsSUFDVDtBQUVBLFFBQUksUUFBUSxjQUFjLG1CQUFtQjtBQUM1QztBQUFBLElBQ0Q7QUFHQSxRQUFJLFFBQVEsYUFBYSxvQkFBSSxLQUFLLElBQUksUUFBUSxXQUFXO0FBQ3hEO0FBQUEsSUFDRDtBQUdBLFFBQUksUUFBUSxXQUFXLG9CQUFJLEtBQUssR0FBRztBQUNsQztBQUFBLElBQ0Q7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYywyQkFDYixPQUNBLE1BQ0EsV0FDQSxVQUNrQjtBQUNsQixVQUFNLE9BQU8sR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUM7QUFFakcsVUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxVQUFNLFVBQVUsUUFBUSxPQUFPLEtBQUssVUFBVTtBQUM5QyxVQUFNLGNBQWMsUUFBUSxPQUFPLElBQUk7QUFFdkMsVUFBTSxZQUFZLE1BQU0sT0FBTyxPQUFPO0FBQUEsTUFDckM7QUFBQSxNQUNBO0FBQUEsTUFDQSxFQUFFLE1BQU0sUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNoQztBQUFBLE1BQ0EsQ0FBQyxNQUFNO0FBQUEsSUFDUjtBQUVBLFVBQU0sWUFBWSxNQUFNLE9BQU8sT0FBTyxLQUFLLFFBQVEsV0FBVyxXQUFXO0FBQ3pFLFdBQU8sTUFBTSxLQUFLLElBQUksV0FBVyxTQUFTLENBQUMsRUFDekMsSUFBSSxPQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsU0FBUyxHQUFHLEdBQUcsQ0FBQyxFQUN4QyxLQUFLLEVBQUU7QUFBQSxFQUNWO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLDJCQUEyQixPQUFlLE1BQThDO0FBQzdGLFVBQU0sV0FBVyxvQkFBSSxLQUFLO0FBQzFCLFVBQU0sWUFBWSxTQUFTLGFBQWEsT0FBTyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksTUFBTSxLQUFLLEtBQUssS0FBSyxHQUFJO0FBRTlGLFVBQU0sWUFBWSxNQUFNLEtBQUssMkJBQTJCLE9BQU8sTUFBTSxXQUFXLFFBQVE7QUFFeEYsVUFBTSxjQUFjLEdBQUcsS0FBSyxJQUFJLElBQUksS0FBSSx1Q0FBVyxrQkFBaUIsVUFBVSxJQUFJLFNBQVMsWUFBWSxDQUFDLElBQUksU0FBUztBQUVySCxXQUFPLEtBQUssYUFBYSxXQUFXO0FBQUEsRUFDckM7QUFDRDs7O0E1QnBUQSxJQUFNQyxpQkFBZ0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWtCdEIsSUFBcUIsYUFBckIsY0FBd0MseUJBQU87QUFBQSxFQW1COUMsTUFBTSxTQUFTO0FBQ2QsUUFBSTtBQUNILGNBQVEsSUFBSSwwQkFBMEI7QUFDdEMsWUFBTSxLQUFLLGFBQWE7QUFDeEIsY0FBUSxJQUFJLHVCQUF1QjtBQUduQyxXQUFLLG1CQUFtQixJQUFJLGlCQUFpQjtBQUM3QyxXQUFLLGlCQUFpQixJQUFJO0FBQUEsUUFDekIsS0FBSztBQUFBLFFBQ0wsS0FBSyxTQUFTLFVBQVU7QUFBQSxNQUN6QjtBQUdBLFVBQUksS0FBSyxTQUFTLFVBQVUsWUFBWTtBQUN2QyxjQUFNLEtBQUssZUFBZSx1QkFBdUIsS0FBSyxTQUFTLFVBQVUsVUFBVTtBQUFBLE1BQ3BGO0FBQ0EsY0FBUSxJQUFJLG1DQUFtQztBQUcvQyxXQUFLLElBQUksVUFBVSxjQUFjLE1BQU07QUFDdEMsY0FBTSxTQUFTLEtBQUssSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDeEUsWUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixnQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLHNCQUFZLG1CQUFtQjtBQUFBLFFBQ2hDO0FBQUEsTUFDRCxDQUFDO0FBTUQscUNBQVEsYUFBYUEsY0FBYTtBQUNsQyxjQUFRLElBQUksdUJBQXVCO0FBRW5DLFdBQUssb0JBQW9CLElBQUksa0JBQWtCLEtBQUssVUFBVSxLQUFLLGNBQWM7QUFDakYsWUFBTSxLQUFLLGtCQUFrQixXQUFXO0FBQ3hDLGNBQVEsSUFBSSx1Q0FBdUM7QUFHbkQsWUFBTSxZQUFZO0FBQUEsUUFDakIsVUFBVSxDQUFDLFFBQWdCLEtBQUssZ0JBQWdCLEdBQUc7QUFBQSxRQUNuRCxVQUFVLENBQUMsS0FBYSxTQUFjLEtBQUssZ0JBQWdCLEtBQUssSUFBSTtBQUFBLE1BQ3JFO0FBQ0EsV0FBSyxzQkFBc0IsSUFBSSxvQkFBb0IsU0FBUztBQUM1RCxXQUFLLGlCQUFpQixJQUFJLGVBQWUsS0FBSyxLQUFLLFNBQVM7QUFDNUQsV0FBSyxlQUFlLHVCQUF1QixLQUFLLG1CQUFtQjtBQUNuRSxXQUFLLGlCQUFpQixJQUFJLGVBQWU7QUFDekMsV0FBSyxnQkFBZ0IsSUFBSSxjQUFjO0FBQ3ZDLFdBQUssZ0JBQWdCLElBQUksY0FBYyxLQUFLLGdCQUFnQixLQUFLLG1CQUFtQjtBQUdwRixXQUFLLG9CQUFvQixJQUFJLFdBQVcsS0FBSyxLQUFLLEtBQUssZ0JBQWdCLEtBQUssZ0JBQWdCLEtBQUssaUJBQWlCO0FBQ2xILFdBQUsscUJBQXFCLElBQUksWUFBWSxLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDcEgsV0FBSyx1QkFBdUIsSUFBSSxjQUFjLEtBQUssS0FBSyxLQUFLLGdCQUFnQixLQUFLLGdCQUFnQixLQUFLLGlCQUFpQjtBQUN4SCxXQUFLLHdCQUF3QixJQUFJLGVBQWUsS0FBSyxLQUFLLEtBQUssZ0JBQWdCLEtBQUssZ0JBQWdCLEtBQUssaUJBQWlCO0FBQzFILFdBQUssd0JBQXdCLElBQUksZUFBZSxLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDMUgsV0FBSyx5QkFBeUIsSUFBSSxnQkFBZ0IsS0FBSyxLQUFLLEtBQUssZ0JBQWdCLEtBQUssZ0JBQWdCLEtBQUssaUJBQWlCO0FBQzVILGNBQVEsSUFBSSxnREFBZ0Q7QUFFNUQsV0FBSztBQUFBLFFBQ0o7QUFBQSxRQUNBLENBQUMsU0FBUyxJQUFJLGdCQUFnQixNQUFNLElBQUk7QUFBQSxNQUN6QztBQUNBLGNBQVEsSUFBSSx1QkFBdUI7QUFJbkMsWUFBTSxhQUFhLEtBQUssY0FBYyxhQUFhLFdBQVcsQ0FBQyxRQUFvQjtBQUNsRixhQUFLLGFBQWE7QUFBQSxNQUNuQixDQUFDO0FBQ0QsY0FBUSxJQUFJLHlCQUF5QjtBQUNyQyxjQUFRLElBQUksOEJBQThCLFVBQVU7QUFDcEQsY0FBUSxJQUFJLGdDQUFnQyxXQUFXLFNBQVM7QUFDaEUsY0FBUSxJQUFJLGdDQUFnQyxXQUFXLFVBQVUsU0FBUyxDQUFDO0FBRzNFLFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sUUFBZ0IsUUFBeUM7QUFDL0UsZ0JBQU0sS0FBSyxpQkFBaUI7QUFBQSxRQUM3QjtBQUFBLE1BQ0QsQ0FBQztBQUVELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sUUFBZ0IsUUFBeUM7QUFDL0UsZ0JBQU0sS0FBSyxrQkFBa0I7QUFBQSxRQUM5QjtBQUFBLE1BQ0QsQ0FBQztBQUVELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sUUFBZ0IsUUFBeUM7QUFDL0UsZ0JBQU0sS0FBSyxvQkFBb0I7QUFBQSxRQUNoQztBQUFBLE1BQ0QsQ0FBQztBQUVELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sUUFBZ0IsUUFBeUM7QUFDL0UsZ0JBQU0sS0FBSyxxQkFBcUI7QUFBQSxRQUNqQztBQUFBLE1BQ0QsQ0FBQztBQUVELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sUUFBZ0IsUUFBeUM7QUFDL0UsZ0JBQU0sS0FBSyxxQkFBcUI7QUFBQSxRQUNqQztBQUFBLE1BQ0QsQ0FBQztBQUVELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sVUFBVSxNQUFNO0FBQ2YsZUFBSyxhQUFhO0FBQUEsUUFDbkI7QUFBQSxNQUNELENBQUM7QUFDRCxjQUFRLElBQUksMkJBQTJCO0FBRXZDLFdBQUssYUFBYSxJQUFJLGVBQWUsS0FBSyxLQUFLLElBQUk7QUFDcEQsV0FBSyxjQUFjLEtBQUssVUFBVTtBQUNqQyxjQUFRLElBQUksMEJBQTBCO0FBQ3RDLGNBQVEsSUFBSSxxQ0FBcUM7QUFBQSxJQUNsRCxTQUFTLE9BQU87QUFDZixjQUFRLE1BQU0sMEJBQTBCLEtBQUs7QUFBQSxJQUM5QztBQUFBLEVBQ0Q7QUFBQSxFQUVBLFdBQVc7QUEvTFo7QUFnTUUsZUFBSyxzQkFBTCxtQkFBd0I7QUFDeEIsZUFBSyx3QkFBTCxtQkFBMEI7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDMUU7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQXhNdEI7QUF5TUUsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQ2pDLGVBQUssc0JBQUwsbUJBQXdCLGVBQWUsS0FBSztBQUFBLEVBQzdDO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDcEIsVUFBTSxFQUFFLFVBQVUsSUFBSSxLQUFLO0FBRTNCLFFBQUk7QUFDSixVQUFNLFNBQVMsVUFBVSxnQkFBZ0Isc0JBQXNCO0FBRS9ELFFBQUksT0FBTyxTQUFTLEdBQUc7QUFDdEIsYUFBTyxPQUFPLENBQUM7QUFBQSxJQUNoQixPQUFPO0FBQ04sYUFBTyxVQUFVLGFBQWEsS0FBSztBQUNuQyxhQUFNLDZCQUFNLGFBQWEsRUFBRSxNQUFNLHdCQUF3QixRQUFRLEtBQUs7QUFBQSxJQUN2RTtBQUVBLGNBQVUsV0FBVyxJQUFLO0FBRzFCLFNBQUksNkJBQU0saUJBQWdCLGlCQUFpQjtBQUMxQyxXQUFLLGNBQWMsS0FBSztBQUFBLElBQ3pCO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxtQkFBa0M7QUFDL0MsVUFBTSxjQUFjLE1BQU0sS0FBSyxxQkFBcUIsNkJBQTZCO0FBQ2pGLFFBQUksQ0FBQyxZQUFhO0FBRWxCLFFBQUk7QUFDSCxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsWUFBTSxlQUFlLENBQUMsRUFBRSxtREFBaUI7QUFDekMsWUFBTSxVQUFVLEtBQUssY0FBYyxhQUFhLGFBQWEsWUFBWTtBQUN6RSxZQUFNLFNBQVMsTUFBTSxLQUFLLGtCQUFrQixRQUFRLE9BQU87QUFFM0QsVUFBSSxPQUFPLFNBQVM7QUFDbkIsWUFBSSx5QkFBTyw0QkFBNEI7QUFBQSxNQUN4QyxPQUFPO0FBQ04sWUFBSSx5QkFBTywwQkFBMEIsT0FBTyxLQUFLLEVBQUU7QUFBQSxNQUNwRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsVUFBSSx5QkFBTyxVQUFVLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUNoRjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsb0JBQW1DO0FBQ2hELFVBQU0sY0FBYyxNQUFNLEtBQUsscUJBQXFCLHlDQUF5QztBQUM3RixRQUFJLENBQUMsWUFBYTtBQUVsQixRQUFJO0FBQ0gsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFlBQU0sZUFBZSxDQUFDLEVBQUUsbURBQWlCO0FBQ3pDLFlBQU0sVUFBVSxLQUFLLGNBQWMsYUFBYSxhQUFhLFlBQVk7QUFDekUsWUFBTSxTQUFTLE1BQU0sS0FBSyxtQkFBbUIsUUFBUSxPQUFPO0FBRTVELFVBQUksT0FBTyxTQUFTO0FBQ25CLFlBQUkseUJBQU8sNkJBQTZCO0FBQUEsTUFDekMsT0FBTztBQUNOLFlBQUkseUJBQU8sMkJBQTJCLE9BQU8sS0FBSyxFQUFFO0FBQUEsTUFDckQ7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLFVBQUkseUJBQU8sVUFBVSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDaEY7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHNCQUFxQztBQUNsRCxVQUFNLGNBQWMsTUFBTSxLQUFLLHFCQUFxQixnQ0FBZ0M7QUFDcEYsUUFBSSxDQUFDLFlBQWE7QUFFbEIsUUFBSTtBQUNILFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxZQUFNLGVBQWUsQ0FBQyxFQUFFLG1EQUFpQjtBQUN6QyxZQUFNLFVBQVUsS0FBSyxjQUFjLGFBQWEsYUFBYSxZQUFZO0FBQ3pFLFlBQU0sU0FBUyxNQUFNLEtBQUsscUJBQXFCLFFBQVEsT0FBTztBQUU5RCxVQUFJLE9BQU8sU0FBUztBQUNuQixZQUFJLHlCQUFPLDhCQUE4QjtBQUFBLE1BQzFDLE9BQU87QUFDTixZQUFJLHlCQUFPLDZCQUE2QixPQUFPLEtBQUssRUFBRTtBQUFBLE1BQ3ZEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixVQUFJLHlCQUFPLFVBQVUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQ2hGO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyx1QkFBc0M7QUFDbkQsVUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFFBQUksQ0FBQyxpQkFBaUI7QUFDckIsVUFBSSx5QkFBTywwQkFBMEI7QUFDckM7QUFBQSxJQUNEO0FBR0EsUUFBSSxTQUFtQztBQUN2QyxRQUFJLGNBQWM7QUFFbEIsUUFBSSxnQkFBZ0IsY0FBYztBQUNqQyxlQUFTO0FBQ1Qsb0JBQWM7QUFBQSxJQUNmO0FBRUEsUUFBSTtBQUNILFlBQU0sVUFBVTtBQUFBLFFBQ2YsUUFBUTtBQUFBLFFBQ1I7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUVBLFlBQU0sU0FBUyxNQUFNLEtBQUssc0JBQXNCLFFBQVEsT0FBTztBQUUvRCxVQUFJLE9BQU8sU0FBUztBQUNuQixZQUFJLHlCQUFPLGdDQUFnQztBQUFBLE1BQzVDLE9BQU87QUFDTixZQUFJLHlCQUFPLDhCQUE4QixPQUFPLEtBQUssRUFBRTtBQUFBLE1BQ3hEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixVQUFJLHlCQUFPLFVBQVUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQ2hGO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyx1QkFBc0M7QUFDbkQsVUFBTSxjQUFjLE1BQU0sS0FBSyxxQkFBcUIsNENBQTRDO0FBQ2hHLFFBQUksQ0FBQyxZQUFhO0FBRWxCLFFBQUk7QUFDSCxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsWUFBTSxlQUFlLENBQUMsRUFBRSxtREFBaUI7QUFDekMsWUFBTSxVQUFVLEtBQUssY0FBYyxhQUFhLGFBQWEsWUFBWTtBQUN6RSxZQUFNLFNBQVMsTUFBTSxLQUFLLHNCQUFzQixRQUFRLE9BQU87QUFFL0QsVUFBSSxPQUFPLFNBQVM7QUFDbkIsWUFBSSx5QkFBTyxnQ0FBZ0M7QUFBQSxNQUM1QyxPQUFPO0FBQ04sWUFBSSx5QkFBTyw4QkFBOEIsT0FBTyxLQUFLLEVBQUU7QUFBQSxNQUN4RDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsVUFBSSx5QkFBTyxVQUFVLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUNoRjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMscUJBQXFCLGFBQTZDO0FBQy9FLFdBQU8sSUFBSSxRQUFRLENBQUMsWUFBWTtBQUMvQixZQUFNLFFBQVEsU0FBUyxjQUFjLEtBQUs7QUFDMUMsWUFBTSxZQUFZO0FBQ2xCLFlBQU0sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx3RUFTbUQsV0FBVztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFVaEYsWUFBTSxRQUFRLE1BQU0sY0FBYyx5QkFBeUI7QUFDM0QsWUFBTSxZQUFZLE1BQU0sY0FBYyxrQkFBa0I7QUFDeEQsWUFBTSxZQUFZLE1BQU0sY0FBYyxrQkFBa0I7QUFFeEQsWUFBTSxlQUFlLE1BQU07QUFDMUIsY0FBTSxRQUFRLE1BQU0sTUFBTSxLQUFLO0FBQy9CLGNBQU0sT0FBTztBQUNiLGdCQUFRLFNBQVMsSUFBSTtBQUFBLE1BQ3RCO0FBRUEsWUFBTSxlQUFlLE1BQU07QUFDMUIsY0FBTSxPQUFPO0FBQ2IsZ0JBQVEsSUFBSTtBQUFBLE1BQ2I7QUFFQSxZQUFNLGlCQUFpQixXQUFXLENBQUMsTUFBTTtBQUN4QyxZQUFJLEVBQUUsUUFBUSxTQUFTO0FBQ3RCLFlBQUUsZUFBZTtBQUNqQix1QkFBYTtBQUFBLFFBQ2QsV0FBVyxFQUFFLFFBQVEsVUFBVTtBQUM5QixZQUFFLGVBQWU7QUFDakIsdUJBQWE7QUFBQSxRQUNkO0FBQUEsTUFDRCxDQUFDO0FBRUQsZ0JBQVUsaUJBQWlCLFNBQVMsWUFBWTtBQUNoRCxnQkFBVSxpQkFBaUIsU0FBUyxZQUFZO0FBRWhELGVBQVMsS0FBSyxZQUFZLEtBQUs7QUFDL0IsWUFBTSxNQUFNO0FBQUEsSUFDYixDQUFDO0FBQUEsRUFDRjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMEJBQWdDO0FBQ3ZDLFVBQU0sUUFBUSxTQUFTLGNBQWMsS0FBSztBQUMxQyxVQUFNLFlBQVk7QUFDbEIsVUFBTSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFpQ2xCLFVBQU0sYUFBYSxNQUFNLGNBQWMsbUJBQW1CO0FBQzFELFVBQU0sV0FBVyxNQUFNLGNBQWMsaUJBQWlCO0FBQ3RELFVBQU0sVUFBVSxNQUFNLGNBQWMsV0FBVztBQUUvQyxVQUFNLGFBQWEsTUFBTTtBQUN4QixZQUFNLE9BQU87QUFBQSxJQUNkO0FBRUEsZUFBVyxpQkFBaUIsU0FBUyxNQUFNO0FBQzFDLGFBQU8sS0FBSyxpQ0FBaUMsUUFBUTtBQUNyRCxpQkFBVztBQUFBLElBQ1osQ0FBQztBQUVELGFBQVMsaUJBQWlCLFNBQVMsVUFBVTtBQUM3QyxZQUFRLGlCQUFpQixTQUFTLFVBQVU7QUFFNUMsYUFBUyxLQUFLLFlBQVksS0FBSztBQUcvQixRQUFJLHlCQUFPLGlEQUFpRCxHQUFJO0FBQUEsRUFDakU7QUFBQTtBQUFBLEVBR0EsTUFBTSxnQkFBZ0IsS0FBMkI7QUFDaEQsVUFBTSxVQUFVLE1BQU0sS0FBSyxTQUFTO0FBQ3BDLFdBQU8sVUFBVSxRQUFRLEdBQUcsSUFBSTtBQUFBLEVBQ2pDO0FBQUEsRUFFQSxNQUFNLGdCQUFnQixLQUFhLE1BQTBCO0FBQzVELFVBQU0sVUFBVSxNQUFNLEtBQUssU0FBUyxLQUFLLENBQUM7QUFDMUMsWUFBUSxHQUFHLElBQUk7QUFDZixXQUFPLE1BQU0sS0FBSyxTQUFTLE9BQU87QUFBQSxFQUNuQztBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJleGlzdGluZyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAic2VuZEJ1dHRvbiIsICJfYSIsICJpc1N1cGVybm92YSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAibmV3RnJvbnRtYXR0ZXIiLCAiTk9WQV9JQ09OX1NWRyJdCn0K
