/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-sonnet-4",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-2.5-flash-preview-05-20",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  licensing: {
    licenseKey: "",
    catalystLicenseKey: "",
    isCatalyst: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceCatalyst: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Catalyst Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>All Features Available</h4>
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Catalyst supporters get early access to new features before they're released to everyone.</p>
			</div>
		`;
    const isCatalyst = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getIsCatalystSupporter()) || false;
    const catalystLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getCatalystLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-catalyst-status" });
    const statusText = isCatalyst ? "Catalyst Supporter" : "Nova User";
    const statusIcon = isCatalyst ? "\u26A1" : "\u2605";
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isCatalyst ? "catalyst" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (catalystLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = catalystLicense.expiresAt ? `Expires: ${catalystLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${catalystLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian.Setting(licenseContainer).setName("Catalyst License Key (Optional)").setDesc("Enter your Catalyst supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Catalyst license key...").setValue(this.plugin.settings.licensing.catalystLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.catalystLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateCatalystLicense(value || null);
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Catalyst license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateCatalystLicense(licenseKey);
              const isCatalyst2 = this.plugin.featureManager.getIsCatalystSupporter();
              if (isCatalyst2) {
                this.showLicenseMessage("Valid Catalyst license! You now have early access to new features.", "success");
              } else {
                this.showLicenseMessage("Invalid or expired Catalyst license key.", "error");
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Catalyst license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createFeatureComparison(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createFeatureComparison(container) {
    var _a;
    const comparisonContainer = container.createDiv({ cls: "nova-feature-comparison" });
    comparisonContainer.createEl("h4", { text: "Nova Features" });
    const summaryEl = comparisonContainer.createDiv({ cls: "nova-feature-summary" });
    summaryEl.innerHTML = `
			<div class="nova-available-now">
				<h5>Available Now (Free with Your API Keys)</h5>
				<ul>
					<li>All AI Providers (Claude, OpenAI, Gemini, Ollama)</li>
					<li>Complete Document Editing Suite</li>
					<li>Chat Interface with Conversation History</li>
					<li>Provider Switching</li>
					<li>Full Mobile Support</li>
					<li>File-Scoped Conversations</li>
				</ul>
			</div>
		`;
    const featureSummary = (_a = this.plugin.featureManager) == null ? void 0 : _a.getFeatureSummary();
    if (featureSummary && featureSummary.comingSoon.length > 0) {
      const upcomingEl = comparisonContainer.createDiv({ cls: "nova-upcoming-features" });
      upcomingEl.innerHTML = `
				<div class="nova-catalyst-preview">
					<h5>Coming Soon for Catalyst Supporters</h5>
					<ul>
						${featureSummary.comingSoon.map((feature) => `
							<li>Available ${feature.availableDate} ${feature.isCatalyst ? "(You have early access!)" : ""}</li>
						`).join("")}
					</ul>
				</div>
			`;
    }
    const catalystInfo = comparisonContainer.createDiv({ cls: "nova-catalyst-info" });
    catalystInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Catalyst Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        this.display();
      }));
      new import_obsidian.Setting(debugContainer).setName("Force Catalyst Status").setDesc("Override Catalyst supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceCatalyst || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceCatalyst = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "AI Provider Settings" });
    const infoEl = containerEl.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
		`;
    this.createOllamaSettings();
    this.createClaudeSettings();
    this.createGoogleSettings();
    this.createOpenAISettings();
  }
  createClaudeSettings() {
    const { containerEl } = this;
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(claudeContainer).setName("Model").setDesc("Claude model to use").addDropdown((dropdown) => dropdown.addOption("claude-sonnet-4", "Claude Sonnet 4").addOption("claude-opus-4", "Claude Opus 4").addOption("claude-3-haiku-20240307", "Claude 3 Haiku").addOption("claude-3-sonnet-20240229", "Claude 3 Sonnet").addOption("claude-3-opus-20240229", "Claude 3 Opus").setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createOpenAISettings() {
    const { containerEl } = this;
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "OpenAI" });
    new import_obsidian.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(openaiContainer).setName("Base URL").setDesc("OpenAI API base URL (for custom endpoints)").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.aiProviders.openai.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use").addDropdown((dropdown) => dropdown.addOption("gpt-4o", "GPT-4o").addOption("gpt-3.5-turbo", "GPT-3.5 Turbo").addOption("gpt-4", "GPT-4").addOption("gpt-4-turbo-preview", "GPT-4 Turbo").setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4o").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createGoogleSettings() {
    const { containerEl } = this;
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(googleContainer).setName("Model").setDesc("Gemini model to use").addDropdown((dropdown) => dropdown.addOption("gemini-2.5-flash-preview-05-20", "Gemini 2.5 Flash Preview").addOption("gemini-2.5-pro-preview-06-05", "Gemini 2.5 Pro Preview").addOption("gemini-1.5-flash", "Gemini 1.5 Flash").addOption("gemini-1.5-pro", "Gemini 1.5 Pro").setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-05-20").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createOllamaSettings() {
    const { containerEl } = this;
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Platform Settings" });
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "OpenAI",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.createEl("h3", { text: "Custom Commands" });
    if (!this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 12px; background: var(--background-modifier-hover); border-radius: 8px; margin-bottom: 16px;">
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently in early access for Catalyst supporters. 
						They will be available to all users on September 15, 2025.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    this.renderCustomCommandsList(commandContainer);
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-top: 16px;";
    const addButton = new import_obsidian.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian2 = require("obsidian");

// src/ai/providers/claude.ts
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.content[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        stream: true,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              if (parsed.type === "content_block_delta" && ((_b = parsed.delta) == null ? void 0 : _b.text)) {
                yield { content: parsed.delta.text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const response = await fetch(this.config.baseUrl || "https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.choices[0].message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const response = await fetch(this.config.baseUrl || "https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.candidates[0].content.parts[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian2.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  cleanup() {
    this.providers.clear();
  }
};

// src/ui/sidebar-view.ts
var import_obsidian4 = require("obsidian");

// src/ui/wikilink-suggest.ts
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea) {
    this.suggestionPopup = null;
    this.suggestions = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.currentQuery = "";
    this.currentTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.setupEventListeners();
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
    this.textArea.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textArea.addEventListener("blur", () => {
      setTimeout(() => this.hideSuggestions(), 150);
    });
    document.addEventListener("click", (e) => {
      if (this.suggestionPopup && !this.suggestionPopup.contains(e.target) && e.target !== this.textArea) {
        this.hideSuggestions();
      }
    });
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (linkMatch) {
      this.currentQuery = linkMatch[2] || "";
      this.currentTriggerPos = cursorPos - linkMatch[0].length;
      this.showSuggestions();
    } else {
      this.hideSuggestions();
    }
  }
  handleKeydown(e) {
    if (!this.isVisible) return;
    switch (e.key) {
      case "ArrowDown":
        e.preventDefault();
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);
        this.updateSelection();
        break;
      case "ArrowUp":
        e.preventDefault();
        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
        this.updateSelection();
        break;
      case "Enter":
      case "Tab":
        if (this.selectedIndex >= 0) {
          e.preventDefault();
          this.selectSuggestion(this.suggestions[this.selectedIndex]);
        }
        break;
      case "Escape":
        e.preventDefault();
        this.hideSuggestions();
        break;
    }
  }
  showSuggestions() {
    this.suggestions = this.getSuggestions(this.currentQuery);
    if (this.suggestions.length === 0) {
      this.hideSuggestions();
      return;
    }
    if (!this.suggestionPopup) {
      this.createSuggestionPopup();
    }
    this.renderSuggestions();
    this.positionPopup();
    this.isVisible = true;
    this.selectedIndex = -1;
  }
  hideSuggestions() {
    if (this.suggestionPopup) {
      this.suggestionPopup.style.display = "none";
    }
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  createSuggestionPopup() {
    var _a;
    this.suggestionPopup = document.createElement("div");
    this.suggestionPopup.className = "nova-wikilink-suggestions";
    this.suggestionPopup.style.cssText = `
            position: absolute;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            min-width: 200px;
        `;
    (_a = this.textArea.parentElement) == null ? void 0 : _a.appendChild(this.suggestionPopup);
  }
  renderSuggestions() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.empty();
    this.suggestions.forEach((suggestion, index) => {
      const item = this.suggestionPopup.createDiv({ cls: "nova-suggestion-item" });
      item.style.cssText = `
                padding: 8px 12px;
                cursor: pointer;
                border-bottom: 1px solid var(--background-modifier-border-hover);
                transition: background-color 0.2s;
            `;
      const nameEl = item.createDiv({ cls: "nova-suggestion-name" });
      nameEl.textContent = suggestion.file.basename;
      nameEl.style.cssText = `
                font-weight: 500;
                color: var(--text-normal);
                margin-bottom: 2px;
            `;
      if (suggestion.file.path !== suggestion.file.name) {
        const pathEl = item.createDiv({ cls: "nova-suggestion-path" });
        pathEl.textContent = suggestion.file.path;
        pathEl.style.cssText = `
                    font-size: 0.85em;
                    color: var(--text-muted);
                `;
      }
      item.addEventListener("click", () => {
        this.selectSuggestion(suggestion);
      });
      item.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.suggestionPopup.style.display = "block";
  }
  updateSelection() {
    if (!this.suggestionPopup) return;
    const items = this.suggestionPopup.querySelectorAll(".nova-suggestion-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.backgroundColor = "var(--background-modifier-hover)";
      } else {
        element.style.backgroundColor = "";
      }
    });
  }
  positionPopup() {
    if (!this.suggestionPopup) return;
    const rect = this.textArea.getBoundingClientRect();
    const popupHeight = Math.min(200, this.suggestions.length * 50);
    this.suggestionPopup.style.position = "absolute";
    this.suggestionPopup.style.left = "0";
    this.suggestionPopup.style.bottom = "100%";
    this.suggestionPopup.style.marginBottom = "4px";
    this.suggestionPopup.style.width = `${rect.width}px`;
  }
  selectSuggestion(suggestion) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (!linkMatch) return;
    const isPersistent = !!linkMatch[1];
    const startPos = cursorPos - linkMatch[0].length;
    const linkText = `[[${suggestion.file.basename}]]`;
    const replacement = isPersistent ? `+${linkText}` : linkText;
    const newText = text.substring(0, startPos) + replacement + text.substring(cursorPos);
    this.textArea.value = newText;
    const newCursorPos = startPos + replacement.length;
    this.textArea.setSelectionRange(newCursorPos, newCursorPos);
    this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    this.hideSuggestions();
    this.textArea.focus();
  }
  getSuggestions(query) {
    const files = this.app.vault.getMarkdownFiles();
    const suggestions = [];
    for (const file of files) {
      const score = this.scoreFile(file, query);
      if (score > 0) {
        suggestions.push({
          file,
          displayText: file.basename,
          score
        });
      }
    }
    return suggestions.sort((a, b) => b.score - a.score).slice(0, 8);
  }
  scoreFile(file, query) {
    if (!query) return 50;
    const basename = file.basename.toLowerCase();
    const path = file.path.toLowerCase();
    const queryLower = query.toLowerCase();
    if (basename === queryLower) return 100;
    if (basename.startsWith(queryLower)) return 80;
    if (basename.includes(queryLower)) return 60;
    if (path.includes(queryLower)) return 40;
    if (this.fuzzyMatch(basename, queryLower)) return 20;
    return 0;
  }
  fuzzyMatch(text, query) {
    let textIndex = 0;
    let queryIndex = 0;
    while (textIndex < text.length && queryIndex < query.length) {
      if (text[textIndex] === query[queryIndex]) {
        queryIndex++;
      }
      textIndex++;
    }
    return queryIndex === query.length;
  }
  destroy() {
    if (this.suggestionPopup) {
      this.suggestionPopup.remove();
    }
  }
};

// src/core/multi-doc-context.ts
var import_obsidian3 = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
      var _a;
      if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
        console.warn(`Removing stale file reference: ${((_a = docRef == null ? void 0 : docRef.file) == null ? void 0 : _a.path) || "unknown"}`);
        return false;
      }
      return true;
    });
    if (allPersistentDocs.length !== rawPersistentDocs.length) {
      if (allPersistentDocs.length > 0) {
        this.persistentContext.set(currentFile.path, allPersistentDocs);
      } else {
        this.persistentContext.delete(currentFile.path);
      }
    }
    const contextParts = [];
    const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
    if (currentFileContext) {
      contextParts.push(currentFileContext);
    }
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      console.error(`Failed to read full context from ${file.path}:`, error);
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    var _a;
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        console.warn(`File no longer exists: ${(file == null ? void 0 : file.path) || "unknown"}`);
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      console.error(`Failed to read context from ${((_a = docRef == null ? void 0 : docRef.file) == null ? void 0 : _a.path) || "unknown file"}:`, error);
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian3.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian3.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian3.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var NovaSidebarView = class extends import_obsidian4.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.currentContext = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian4.Platform.isDesktopApp ? "25px" : "0"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 10px;
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: 1.1em; display: flex; align-items: center; gap: 6px;";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: 8px;";
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian4.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.loadConversationForActiveFile();
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
    this.commandPickerItems = [];
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.empty();
    }
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: 10px;
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: 8px;
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.inputContainer.style.cssText = `
			display: flex;
			flex-direction: column;
			gap: 8px;
			padding: 10px;
			border-top: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
			position: relative;
		`;
    const inputRow = this.inputContainer.createDiv({ cls: "nova-input-row" });
    inputRow.style.cssText = `
			display: flex;
			align-items: center;
			gap: 8px;
		`;
    const textAreaContainer = inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian4.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova to help edit your document...");
    const lineHeight = 1.5;
    const paddingVertical = 20;
    const borderWidth = 2;
    const baseLines = import_obsidian4.Platform.isMobile ? 2 : 3;
    const maxLines = import_obsidian4.Platform.isMobile ? 8 : 6;
    const fontSize = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--font-text-size") || "14px");
    const initialHeight = baseLines * lineHeight * fontSize + paddingVertical + borderWidth;
    this.textArea.inputEl.style.cssText = `
			width: 100%;
			min-height: ${initialHeight}px;
			max-height: ${maxLines * lineHeight * fontSize + paddingVertical + borderWidth}px;
			height: ${initialHeight}px;
			resize: none;
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			padding: 10px;
			font-size: var(--font-text-size);
			line-height: ${lineHeight};
			overflow-y: hidden;
			transition: height 0.1s ease-out;
		`;
    this.autoGrowTextarea = () => {
      const el = this.textArea.inputEl;
      el.style.height = "auto";
      const contentHeight = el.scrollHeight;
      const minHeight = initialHeight;
      const maxHeight = maxLines * lineHeight * fontSize + paddingVertical + borderWidth;
      const newHeight = Math.max(minHeight, Math.min(contentHeight, maxHeight));
      el.style.height = `${newHeight}px`;
      el.style.overflowY = contentHeight > maxHeight ? "auto" : "hidden";
    };
    this.textArea.inputEl.addEventListener("input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.app, this.textArea.inputEl);
    this.textArea.inputEl.addEventListener("input", () => {
      this.updateLiveContextPreview();
    });
    this.commandButton = new import_obsidian4.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: ${this.plugin.featureManager.isFeatureEnabled("command-button") ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: 8px;
		`;
    this.sendButton = new import_obsidian4.ButtonComponent(inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.setCta();
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
		`;
    this.textArea.inputEl.addEventListener("keydown", (event) => {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        this.handleCommandPickerSelection() || this.handleSend();
      } else if (event.key === "Escape") {
        this.hideCommandPicker();
      } else if (event.key === "ArrowDown" || event.key === "ArrowUp") {
        if (this.isCommandPickerVisible()) {
          event.preventDefault();
          this.navigateCommandPicker(event.key === "ArrowDown" ? 1 : -1);
        }
      }
    });
    this.textArea.inputEl.addEventListener("input", () => {
      this.handleInputChange();
    });
    this.createCommandPicker();
    this.createCommandMenu();
    this.createContextIndicator();
    this.contextPreview = this.createContextPreview();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: 10px;
			padding: 8px 12px;
			border-radius: 8px;
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: 0.9em;" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: 0.8em;
			opacity: 0.7;
			margin-bottom: 4px;
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: 12px;
			margin: 16px auto;
			padding: 16px 20px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 18px;
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: 32px;
			height: 32px;
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Welcome to Nova" });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "Your AI thinking partner. Ask me to help edit your document!" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: #4caf50; display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("command-system")) {
      this.addMessage("system", this.createIconMessage("zap", "Command system is currently in early access for Catalyst supporters. Available to all users September 15, 2025."));
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addMessage("system", this.createIconMessage("refresh-cw", `Switched to ${this.getProviderDisplayName(providerId)}`));
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.textArea.setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addMessage("system", this.createIconMessage("edit", `Loaded template: ${customCommand.name}`));
        return true;
      }
    }
    this.addMessage("system", this.createIconMessage("help-circle", `Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`));
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.textArea.getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("command-system")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item" });
      item.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
				display: flex;
				align-items: center;
				gap: 8px;
			`;
      const triggerEl = item.createSpan({ cls: "nova-command-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.cssText = `
				font-family: var(--font-monospace);
				background: var(--background-modifier-hover);
				padding: 2px 6px;
				border-radius: 4px;
				font-size: 0.9em;
				color: var(--interactive-accent);
			`;
      const nameEl = item.createSpan({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1; color: var(--text-normal);";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "font-size: 0.8em; color: var(--text-muted);";
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.style.backgroundColor = "";
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].style.backgroundColor = "var(--background-modifier-hover)";
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.textArea.setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    const commands = [
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" },
      { trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" }
    ];
    if (this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      customCommands.forEach((cmd) => {
        commands.push({
          trigger: cmd.trigger,
          name: cmd.name,
          ...cmd.description && { description: cmd.description }
        });
      });
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("command-button")) {
      this.addMessage("system", this.createIconMessage("zap", "Command button is currently in early access for Catalyst supporters. Available to all users August 15, 2025."));
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header" });
    headerEl.style.cssText = `
			padding: 12px 16px;
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 600;
			font-size: 0.9em;
			color: var(--text-normal);
		`;
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item" });
      item.style.cssText = `
				padding: 12px 16px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
				display: flex;
				flex-direction: column;
				gap: 4px;
				transition: background-color 0.2s;
			`;
      const nameEl = item.createDiv({ cls: "nova-command-menu-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
			`;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.cssText = `
				font-family: var(--font-monospace);
				font-size: 0.8em;
				color: var(--interactive-accent);
				opacity: 0.8;
			`;
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-muted);
				`;
      }
      item.addEventListener("mouseenter", () => {
        item.style.backgroundColor = "var(--background-modifier-hover)";
      });
      item.addEventListener("mouseleave", () => {
        item.style.backgroundColor = "";
      });
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  executeCommandFromMenu(trigger) {
    this.hideCommandMenu();
    this.textArea.setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.textArea.getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian4.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const isMobile = import_obsidian4.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: block;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px;";
    if (isMobile) {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}%)`;
    } else {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, 150);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian4.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("eraser").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, 150);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
			`;
      nameEl.setAttr("title", doc.file.path);
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.innerHTML = this.createInlineIcon("x", isMobile ? "18px" : "14px");
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: bold;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, 150);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, 150);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      const result = await this.multiDocHandler.buildContext("", this.currentFile);
      this.currentContext = result.context;
      this.updateContextIndicator();
    }
  }
  async handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    if (message.startsWith(":")) {
      const commandResult = await this.handleColonCommand(message);
      if (commandResult) {
        this.textArea.setValue("");
        setTimeout(() => this.autoGrowTextarea(), 0);
        return;
      }
    }
    let processedMessage = message;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (message.includes("[[") || message.includes("+[[")) {
          this.addMessage("system", this.createIconMessage("book-open", "Multi-document context is currently in early access for Catalyst supporters. Available to all users August 15, 2025."));
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(message, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_a = this.currentContext) == null ? void 0 : _a.persistentDocs.length) || 0;
        const currentPersistentCount = multiDocContext.persistentDocs.length;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.map((doc) => doc.file.basename).join(", ");
            this.addMessage("system", this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
          }
          this.textArea.setValue("");
          setTimeout(() => this.autoGrowTextarea(), 0);
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (multiDocContext.persistentDocs.length > 0) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.map((doc) => doc.file.basename).join(", ");
          const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
          this.addMessage("system", this.createIconMessage("book-open", `Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}`));
        }
        if (multiDocContext.isNearLimit) {
          new import_obsidian4.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", 5e3);
        }
      }
    }
    this.addMessage("user", message);
    this.textArea.setValue("");
    setTimeout(() => this.autoGrowTextarea(), 0);
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    this.sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(message);
      }
      const isLikelyCommand = this.plugin.promptBuilder["isLikelyCommand"](processedMessage);
      let response = null;
      if (isLikelyCommand && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedUserPrompt = `${multiDocContext.contextString}

---

User Request: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      loadingEl.remove();
      if (activeFile && response) {
        await this.plugin.documentEngine.addAssistantMessage(response);
      }
      if (response) {
        this.addMessage("assistant", response);
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addMessage("assistant", `Sorry, I encountered an error: ${error.message}`);
    } finally {
      this.sendButton.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian4.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      let result;
      switch (command.action) {
        case "add":
          result = await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          result = await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          result = await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return this.createIconMessage("x-circle", `Error executing command: ${error.message}`);
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian4.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFile = targetFile;
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
      }
    } catch (error) {
      console.warn("Failed to load conversation history:", error);
      this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
        console.warn("Failed to clear conversation:", error);
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared! Ready to help you with "${this.currentFile.basename}". What would you like to do?`);
    } else {
      this.addWelcomeMessage("Chat cleared! Ready to help. What would you like to do?");
    }
    new import_obsidian4.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite"];
    if (validActions.includes(command.action)) {
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Create static provider status display
   */
  createStaticProviderStatus(container) {
    const providerStatus = container.createDiv({ cls: "nova-header-provider" });
    providerStatus.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			font-size: 0.75em;
			color: var(--text-muted);
			opacity: 0.8;
		`;
    const headerStatusDot = providerStatus.createSpan({ cls: "nova-status-dot-small" });
    headerStatusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const headerProviderName = providerStatus.createSpan({ text: "Loading..." });
    this.plugin.aiProviderManager.getCurrentProviderName().then((name) => {
      headerProviderName.setText(name);
    });
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-muted);
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const statusDot = providerButton.createSpan({ cls: "nova-status-dot-small" });
    statusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
      providerName.setText(currentProviderName);
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providerItem = dropdownMenu.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				transition: background-color 0.2s ease;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const displayName = this.getProviderDisplayName(providerType);
      const nameSpan = providerItem.createSpan({ text: displayName });
      const isCurrent = displayName === currentProviderName;
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      providerItem.addEventListener("click", async () => {
        if (!isCurrent) {
          await this.switchToProvider(providerType);
          dropdownMenu.style.display = "none";
          if (this.currentProviderDropdown) {
            this.currentProviderDropdown.updateCurrentProvider();
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "GPT-4 (OpenAI)",
      "google": "Gemini (Google)",
      "ollama": "Ollama (Local)",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "#D2691E",
      "openai": "#10A37F",
      "google": "#4285F4",
      "ollama": "#7C3AED",
      "none": "#999"
    };
    return colors[providerType] || "#4caf50";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${this.getProviderDisplayName(providerType)}`);
      this.addMessage("system", switchMessage);
      const platform = import_obsidian4.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    } catch (error) {
      console.error("Error switching provider:", error);
      this.addMessage("system", this.createIconMessage("x-circle", `Failed to switch to ${this.getProviderDisplayName(providerType)}`));
    }
  }
};

// src/core/document-engine.ts
var import_obsidian5 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
      console.warn("Failed to load conversation data:", error);
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
      console.error("Failed to save conversation data:", error);
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance
   */
  getActiveEditor() {
    const activeEditor = this.app.workspace.activeEditor;
    if (activeEditor == null ? void 0 : activeEditor.editor) {
      return activeEditor.editor;
    }
    let view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
    if (!view) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of leaves) {
        const leafView = leaf.view;
        if (leafView instanceof import_obsidian5.MarkdownView) {
          view = leafView;
          break;
        }
      }
    }
    if (!view) {
      return null;
    }
    const editor = view.editor;
    return editor || null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at a specific location
   */
  async deleteContent(target, location) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      } else if (target === "section" && location) {
        const section = await this.findSection(location);
        if (!section) {
          return {
            success: false,
            error: `Section "${location}" not found`,
            editType: "delete"
          };
        }
        const content = editor.getValue();
        const lines = content.split("\n");
        const newLines = lines.filter(
          (_, index) => index < section.range.start || index > section.range.end
        );
        await this.app.vault.modify(file, newLines.join("\n"));
        return {
          success: true,
          editType: "delete",
          appliedAt: { line: section.range.start, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Find a section by heading name
   */
  async findSection(headingText) {
    const context = await this.getDocumentContext();
    if (!context) return null;
    const headingIndex = context.headings.findIndex(
      (h) => h.text.toLowerCase().includes(headingText.toLowerCase())
    );
    if (headingIndex === -1) return null;
    const heading = context.headings[headingIndex];
    const nextHeading = context.headings[headingIndex + 1];
    const lines = context.content.split("\n");
    const endLine = nextHeading ? nextHeading.line - 1 : lines.length - 1;
    const sectionLines = lines.slice(heading.line + 1, endLine + 1);
    const sectionContent = sectionLines.join("\n").trim();
    return {
      heading: heading.text,
      level: heading.level,
      content: sectionContent,
      range: {
        start: heading.line,
        end: endLine
      }
    };
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor() {
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: 0.7,
      maxTokens: 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents directly. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Be concise and focused on the specific request
- Do not add section headers unless specifically requested`;
    const actionSpecificPrompts = {
      add: `
TASK: Add new content to the document.
- Create well-structured, relevant content that fits the document's purpose
- Use appropriate markdown formatting (headings, lists, emphasis)
- Ensure smooth flow with existing content
- Match the document's style and tone`,
      edit: `
TASK: Edit and improve existing content.
- Enhance clarity, readability, and flow
- Preserve the original meaning unless changes are requested
- Improve word choice and sentence structure
- Maintain the original formatting and structure`,
      delete: `
TASK: Remove specified content from the document.
- Identify the exact content to be removed
- Ensure remaining content flows naturally
- Preserve document structure and formatting
- Confirm the deletion is appropriate for the context`,
      grammar: `
TASK: Fix grammar, spelling, and language issues.
- Correct spelling errors, grammar mistakes, and typos
- Improve sentence structure and clarity
- Maintain the original voice and style
- Preserve all formatting and markdown syntax
- Make minimal changes - only fix actual errors`,
      rewrite: `
TASK: Rewrite or restructure content.
- Create new content that serves the same purpose
- Improve organization, clarity, and flow
- Use more effective language and structure
- Maintain key information and concepts
- Adapt to any specified style requirements`,
      metadata: `
TASK: Update document metadata/properties.
- Modify, add, or remove frontmatter properties
- Handle tags, titles, dates, and custom properties
- Maintain proper YAML formatting
- Preserve existing properties unless specifically changing them
- Provide ONLY the property updates in JSON format`
    };
    return basePrompt + actionSpecificPrompts[action];
  }
  /**
   * Build user prompt with specific instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = `${contextInfo}

USER REQUEST: ${command.instruction}`;
    if (command.context && command.context.trim()) {
      prompt2 += `

ADDITIONAL REQUIREMENTS: ${command.context}`;
    }
    const targetInstructions = this.getTargetInstructions(command);
    if (targetInstructions) {
      prompt2 += `

${targetInstructions}`;
    }
    const actionInstructions = this.getActionInstructions(command);
    if (actionInstructions) {
      prompt2 += `

${actionInstructions}`;
    }
    return prompt2;
  }
  /**
   * Get target-specific instructions
   */
  getTargetInstructions(command) {
    switch (command.target) {
      case "selection":
        return "FOCUS: Work with the selected text only. Provide the improved version of the selected content.";
      case "section":
        if (command.location) {
          return `FOCUS: Work with the "${command.location}" section. ${command.action === "add" ? "Add content to this section." : "Modify only this section."}`;
        }
        return "FOCUS: Work with the current section.";
      case "document":
        return "FOCUS: Apply changes to the entire document while preserving its structure.";
      case "end":
        return "FOCUS: Add content at the end of the document. Ensure it flows naturally from existing content.";
      case "paragraph":
        return "FOCUS: Work with the current paragraph or create a new paragraph.";
      default:
        return "";
    }
  }
  /**
   * Get action-specific instructions
   */
  getActionInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added. Include appropriate headings if adding a section.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide only the corrected text with grammar and spelling fixes.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return 'OUTPUT: Provide ONLY a JSON object with the property updates. Example: {"title": "New Title", "tags": ["tag1", "tag2"], "date": "2025-01-01"}';
      default:
        return "";
    }
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeHistory && conversationContext && conversationContext.trim()) {
      context += `
${conversationContext}
`;
    }
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += "\nDOCUMENT STRUCTURE:\n";
      documentContext.headings.forEach((heading) => {
        const indent = "  ".repeat(heading.level - 1);
        context += `${indent}- ${heading.text}
`;
      });
    }
    if (documentContext.selectedText && command.target === "selection") {
      context += `
SELECTED TEXT:
${documentContext.selectedText}
`;
    }
    if (command.target === "section" && command.location) {
      const section = this.findSectionInContent(documentContext.content, command.location);
      if (section) {
        context += `
CURRENT SECTION "${command.location}":
${section}
`;
      }
    } else if (command.target === "paragraph" && documentContext.surroundingLines) {
      context += "\nCURRENT CONTEXT:\n";
      if (documentContext.surroundingLines.before.length > 0) {
        context += `Before: ${documentContext.surroundingLines.before.join(" ")}
`;
      }
      if (documentContext.surroundingLines.after.length > 0) {
        context += `After: ${documentContext.surroundingLines.after.join(" ")}
`;
      }
    }
    const contentLines = documentContext.content.split("\n");
    if (contentLines.length > config.maxContextLines) {
      const start = Math.max(0, contentLines.length - config.maxContextLines);
      context += `
RECENT CONTENT (last ${config.maxContextLines} lines):
`;
      context += contentLines.slice(start).join("\n");
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}`;
    }
    return context;
  }
  /**
   * Find a specific section in content
   */
  findSectionInContent(content, sectionName) {
    const lines = content.split("\n");
    const normalizedSectionName = sectionName.toLowerCase().trim();
    let sectionStart = -1;
    let sectionLevel = 0;
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const heading = headingMatch[2].toLowerCase().trim();
        if (heading === normalizedSectionName || heading.includes(normalizedSectionName)) {
          sectionStart = i;
          sectionLevel = level;
          break;
        }
      }
    }
    if (sectionStart === -1) return null;
    let sectionEnd = lines.length;
    for (let i = sectionStart + 1; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+/);
      if (headingMatch && headingMatch[1].length <= sectionLevel) {
        sectionEnd = i;
        break;
      }
    }
    return lines.slice(sectionStart, sectionEnd).join("\n");
  }
  /**
   * Create a simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner. Provide helpful, concise responses to user requests. Focus on being practical and actionable.`;
    let userPrompt = instruction;
    if (context) {
      userPrompt = `Context: ${context}

Request: ${instruction}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 500
      }
    };
  }
  /**
   * Build prompt for conversation context
   */
  buildConversationPrompt(message, documentContext, recentHistory = []) {
    let systemPrompt = `You are Nova, an AI writing partner that helps users with their documents. You can:
- Answer questions about writing and editing
- Provide suggestions for improvement
- Help plan document structure
- Assist with research and content development

Be helpful, concise, and practical in your responses.`;
    let userPrompt = message;
    let context = "";
    if (documentContext) {
      context += `Current document: ${documentContext.filename}
`;
      if (documentContext.headings.length > 0) {
        context += "Document structure:\n";
        documentContext.headings.forEach((heading) => {
          const indent = "  ".repeat(heading.level - 1);
          context += `${indent}- ${heading.text}
`;
        });
      }
    }
    if (recentHistory.length > 0) {
      context += "\nRecent conversation:\n";
      recentHistory.slice(-3).forEach((msg) => {
        if (msg.role === "user") {
          context += `You: ${msg.content}
`;
        } else if (msg.role === "assistant") {
          context += `Nova: ${msg.content}
`;
        }
      });
    }
    if (context) {
      userPrompt = `${context}

Current message: ${message}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context,
      config: {
        temperature: 0.8,
        maxTokens: 800
      }
    };
  }
  /**
   * Estimate token count for a prompt
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Validate prompt generation
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    const tokenCount = this.estimateTokenCount(prompt2);
    if (tokenCount > 8e3) {
      issues.push(`Prompt is too long (${tokenCount} tokens, max 8000)`);
    }
    if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
      issues.push("Temperature must be between 0 and 1");
    }
    if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
      issues.push("Max tokens must be between 10 and 4000");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document", "paragraph"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection", "section", "line"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert)\b(?!\s+.*\b(better|clearer|more|less)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i
    ],
    targets: ["end", "section", "paragraph"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection", "section", "paragraph"]
  },
  {
    action: "metadata",
    patterns: [
      /\b(update|set|change|modify|add)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      /\b(add|remove|update)\s+.*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  }
];
var LOCATION_PATTERNS = [
  /\b(?:to|in|at|under|within|inside)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:section|heading|part)\s+["']([^"']+?)["']/i,
  /\b(?:section|heading)\s+(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:the\s+)?([a-zA-Z][a-zA-Z\s&]*?)\s+(?:section|heading)\b/i
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:this|current|selected)\s+(?:paragraph|line)/i, target: "paragraph" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" },
  { pattern: /\b(?:section|heading|part)/i, target: "section" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const location = this.extractLocation(input);
    const context = this.extractContext(input);
    return {
      action,
      target,
      location,
      instruction: input,
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return input.includes("section") || input.includes("heading") ? "section" : "end";
      case "edit":
        return hasSelection ? "selection" : "paragraph";
      case "delete":
        return hasSelection ? "selection" : "section";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return "end";
      default:
        return "paragraph";
    }
  }
  /**
   * Extract location information from the input
   */
  extractLocation(input) {
    for (const pattern of LOCATION_PATTERNS) {
      const match = pattern.exec(input);
      if (match && match[1]) {
        return match[1].trim();
      }
    }
    return void 0;
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "delete" && !command.location) {
      return {
        valid: false,
        error: "Please specify which section to delete"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection, hasHeadings) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add a conclusion section",
        "Fix grammar in this document",
        "Add an introduction",
        "Create a summary"
      );
    }
    if (hasHeadings) {
      suggestions.push(
        "Add content to the introduction section",
        "Expand the methodology section"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target, location } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new sections";
        break;
    }
    if (location) {
      description += ` in "${location}"`;
    } else {
      switch (target) {
        case "selection":
          description += " in selected text";
          break;
        case "section":
          description += " in current section";
          break;
        case "paragraph":
          description += " in current paragraph";
          break;
        case "document":
          description += " in entire document";
          break;
        case "end":
          description += " at end of document";
          break;
      }
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const commandWords = [
      "add",
      "create",
      "write",
      "insert",
      "include",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "fix",
      "correct",
      "grammar",
      "spell",
      "proofread",
      "polish",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const lowerMessage = message.toLowerCase();
    return commandWords.some((word) => lowerMessage.includes(word));
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    return this.contextBuilder.buildConversationPrompt(message, documentContext, recentHistory);
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    return this.contextBuilder.buildSimplePrompt(instruction, context);
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      console.warn("Prompt validation issues:", validation.issues);
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.contextBuilder.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.contextBuilder.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      location: void 0,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "insert"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.documentEngine.applyEdit(
          content,
          await this.determineInsertPosition(command, documentContext),
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Determine where to insert new content
   */
  async determineInsertPosition(command, documentContext) {
    switch (command.target) {
      case "end":
        return "end";
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            return { line: section.range.end, ch: 0 };
          }
        }
        return "cursor";
      case "paragraph":
        return "cursor";
      case "document":
        return "end";
      default:
        return "cursor";
    }
  }
  /**
   * Validate add command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    if (command.target === "section" && !command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for add commands
   */
  getSuggestions(documentContext) {
    const suggestions = [
      "Add a conclusion section",
      "Add an introduction",
      "Create a summary",
      "Add examples",
      "Create a methodology section"
    ];
    if (documentContext.headings.length > 0) {
      const sectionNames = documentContext.headings.map((h) => h.text);
      if (!sectionNames.some((name) => name.toLowerCase().includes("introduction"))) {
        suggestions.unshift("Add an introduction section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("conclusion"))) {
        suggestions.push("Add a conclusion section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("summary"))) {
        suggestions.push("Add a summary section");
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what content would be added (without actually adding it)
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let positionDescription = "";
      switch (command.target) {
        case "end":
          positionDescription = "at the end of the document";
          break;
        case "section":
          if (command.location) {
            positionDescription = `in the "${command.location}" section`;
          } else {
            positionDescription = "in the current section";
          }
          break;
        case "paragraph":
          positionDescription = "at the cursor position";
          break;
        case "document":
          positionDescription = "at the end of the document";
          break;
        default:
          positionDescription = "at the cursor position";
      }
      return {
        success: true,
        preview: `Will add new content ${positionDescription}`,
        position: positionDescription
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyEdit(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          content,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${content}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid edit target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "edit" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for edit commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Make this more professional",
        "Make this more detailed",
        "Improve clarity and flow",
        "Make this more formal",
        "Simplify this text",
        "Expand on this point",
        "Make this more engaging"
      );
    } else {
      suggestions.push(
        "Improve the writing style",
        "Make the document more professional",
        "Enhance clarity throughout",
        "Improve the introduction",
        "Polish the conclusion",
        "Make it more concise",
        "Add more detail",
        "Improve the flow between sections"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Improve the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be edited
   */
  async preview(command) {
    var _a, _b;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will edit the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will edit the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will edit content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will edit content at cursor position";
          if (documentContext.surroundingLines) {
            const currentLine = (_b = (_a = documentContext.cursorPosition) == null ? void 0 : _a.line) != null ? _b : 0;
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              affectedContent = editor.getLine(currentLine);
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will edit the entire document";
          break;
        case "end":
          previewText = "Will add edited content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid edit target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get edit targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of changes
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const conversationContext = this.documentEngine.getConversationContext();
        const promptConfig = conversationContext ? { includeHistory: true } : {};
        const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
        const promptValidation = this.contextBuilder.validatePrompt(prompt2);
        if (!promptValidation.valid) {
          return {
            success: false,
            error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
            editType: "delete"
          };
        }
        try {
          const aiResponse = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
        } catch (error) {
          const result2 = {
            success: false,
            error: error instanceof Error ? error.message : "AI analysis failed",
            editType: "delete"
          };
          await this.documentEngine.addAssistantMessage(
            `Error: ${result2.error}`,
            result2
          );
          return result2;
        }
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0 && !result.success) {
        await this.documentEngine.addAssistantMessage("Failed to delete content", result);
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "delete"
              };
            }
            editor.replaceRange("", startPos, endPos);
            return {
              success: true,
              content: "",
              editType: "delete",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "delete"
            };
          }
        } else {
          return {
            success: false,
            error: "Section name required for section deletion",
            editType: "delete"
          };
        }
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "delete"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          const lineContent = editor.getLine(currentLine);
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine + 1, ch: 0 };
          editor.replaceRange("", startPos, endPos);
          return {
            success: true,
            content: "",
            editType: "delete",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "delete"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end of document. Use a different target.",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: "Invalid deletion target",
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && !command.location) {
      return {
        valid: false,
        error: "Section name required for section deletion"
      };
    }
    if (command.target === "end") {
      return {
        valid: false,
        error: "Cannot delete from end of document. Use a different target."
      };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for delete commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Delete the selected text",
        "Remove this content",
        "Clear the selection"
      );
    } else {
      suggestions.push(
        "Delete the current paragraph",
        "Remove empty sections",
        "Clear redundant content",
        "Delete duplicate information"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Delete the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what would be deleted
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will delete the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = `${section.heading}

${section.content}`;
              previewText = `Will delete the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            return {
              success: false,
              error: "Section name required for preview"
            };
          }
          break;
        case "paragraph":
          previewText = "Will delete the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will delete all document content";
          break;
        case "end":
          return {
            success: false,
            error: "Cannot delete from end of document"
          };
        default:
          return {
            success: false,
            error: "Invalid deletion target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get delete targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-1, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of deletion
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length + section.heading.length;
            linesAffected = section.range.end - section.range.start + 1;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "Invalid target for deletion";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const correctedContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: 0.3,
            // Lower temperature for grammar corrections
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!correctedContent || correctedContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate corrected content", result2);
          return result2;
        }
        const result = await this.applyGrammarCorrection(command, documentContext, correctedContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to correct grammar", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Grammar correction failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar correction based on command target
   */
  async applyGrammarCorrection(command, documentContext, correctedContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${correctedContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(correctedContent, startPos, endPos);
          return {
            success: true,
            content: correctedContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(correctedContent);
      case "end":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid grammar correction target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "grammar" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for grammar commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Fix grammar in selected text",
        "Correct spelling and punctuation",
        "Improve sentence structure",
        "Fix capitalization errors",
        "Correct verb tenses",
        "Fix subject-verb agreement",
        "Improve readability"
      );
    } else {
      suggestions.push(
        "Check grammar throughout document",
        "Fix spelling errors",
        "Correct punctuation",
        "Improve sentence structure",
        "Fix grammatical errors in current paragraph",
        "Check for common mistakes",
        "Proofread the document"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Check grammar in "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be grammar-corrected
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const potentialIssues = [];
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will check grammar in the selected text";
            potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will check grammar in the "${command.location}" section`;
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will check grammar at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will check grammar in the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will check grammar throughout the entire document";
          potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          break;
        case "end":
          previewText = "Will add grammar-corrected content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid grammar correction target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        potentialIssues: potentialIssues.slice(0, 5)
        // Limit to 5 issues
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Detect potential grammar issues in text
   */
  detectPotentialIssues(text) {
    const issues = [];
    const patterns = [
      { pattern: /\bi\s/gi, issue: 'Lowercase "i" should be capitalized' },
      { pattern: /\.\s*[a-z]/g, issue: "Sentence should start with capital letter" },
      { pattern: /\s{2,}/g, issue: "Multiple spaces detected" },
      { pattern: /[.!?]{2,}/g, issue: "Multiple punctuation marks" },
      { pattern: /\s+[.!?,:;]/g, issue: "Space before punctuation" },
      { pattern: /[.!?]\w/g, issue: "Missing space after punctuation" },
      { pattern: /\bteh\b/gi, issue: 'Common typo: "teh" should be "the"' },
      { pattern: /\band\s+and\b/gi, issue: 'Duplicate "and"' },
      { pattern: /\bthe\s+the\b/gi, issue: 'Duplicate "the"' },
      { pattern: /\bis\s+is\b/gi, issue: 'Duplicate "is"' }
    ];
    patterns.forEach(({ pattern, issue }) => {
      if (pattern.test(text)) {
        issues.push(issue);
      }
    });
    return issues;
  }
  /**
   * Get grammar check targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of grammar correction
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        estimatedIssues: 0
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const estimatedIssues = this.detectPotentialIssues(contentToAnalyze).length;
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      estimatedIssues
    };
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const rewrittenContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!rewrittenContent || rewrittenContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate rewritten content", result2);
          return result2;
        }
        const result = await this.applyRewrite(command, documentContext, rewrittenContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Rewrite generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, rewrittenContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${rewrittenContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(rewrittenContent, startPos, endPos);
          return {
            success: true,
            content: rewrittenContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(rewrittenContent);
      case "end":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid rewrite target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "rewrite" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for rewrite commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Rewrite in a more formal tone",
        "Rewrite in a casual tone",
        "Make this more concise",
        "Expand with more detail",
        "Rewrite for clarity",
        "Simplify the language",
        "Make it more engaging",
        "Rewrite in bullet points",
        "Convert to narrative form"
      );
    } else {
      suggestions.push(
        "Rewrite the current paragraph",
        "Rewrite in a different style",
        "Make the writing more engaging",
        "Simplify complex language",
        "Rewrite for different audience",
        "Convert to more formal tone",
        "Make the content more concise"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Rewrite the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be rewritten
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const rewriteStyle = this.inferRewriteStyle(command.instruction);
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = `Will rewrite the selected text`;
            if (rewriteStyle) {
              previewText += ` (${rewriteStyle})`;
            }
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will rewrite the "${command.location}" section`;
              if (rewriteStyle) {
                previewText += ` (${rewriteStyle})`;
              }
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will rewrite content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will rewrite the current paragraph";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will rewrite the entire document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        case "end":
          previewText = "Will add rewritten content at the end of the document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        default:
          return {
            success: false,
            error: "Invalid rewrite target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        rewriteStyle
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Infer rewrite style from instruction
   */
  inferRewriteStyle(instruction) {
    const lowerInstruction = instruction.toLowerCase();
    if (lowerInstruction.includes("formal")) return "formal tone";
    if (lowerInstruction.includes("casual") || lowerInstruction.includes("informal")) return "casual tone";
    if (lowerInstruction.includes("concise") || lowerInstruction.includes("shorter")) return "more concise";
    if (lowerInstruction.includes("expand") || lowerInstruction.includes("detail")) return "more detailed";
    if (lowerInstruction.includes("simple") || lowerInstruction.includes("simplify")) return "simplified language";
    if (lowerInstruction.includes("engaging") || lowerInstruction.includes("interesting")) return "more engaging";
    if (lowerInstruction.includes("professional")) return "professional tone";
    if (lowerInstruction.includes("bullet") || lowerInstruction.includes("list")) return "bullet point format";
    if (lowerInstruction.includes("narrative") || lowerInstruction.includes("story")) return "narrative style";
    if (lowerInstruction.includes("technical")) return "technical style";
    if (lowerInstruction.includes("creative")) return "creative style";
    return "";
  }
  /**
   * Get rewrite targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of rewriting
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        rewriteComplexity: "low"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const rewriteComplexity = this.estimateComplexity(contentToAnalyze, command.instruction);
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      rewriteComplexity
    };
  }
  /**
   * Estimate rewrite complexity
   */
  estimateComplexity(content, instruction) {
    const contentLength = content.length;
    const lowerInstruction = instruction.toLowerCase();
    let complexity = "low";
    if (contentLength > 1e3) complexity = "high";
    else if (contentLength > 300) complexity = "medium";
    const complexInstructions = [
      "restructure",
      "reorganize",
      "completely rewrite",
      "transform",
      "change style",
      "different audience",
      "technical",
      "academic"
    ];
    if (complexInstructions.some((term) => lowerInstruction.includes(term))) {
      if (complexity === "low") complexity = "medium";
      else if (complexity === "medium") complexity = "high";
    }
    return complexity;
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      console.error("Failed to parse property updates:", error);
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
};

// src/licensing/feature-config.ts
var CATALYST_FEATURES = {
  // Command system - 3 month early access
  "command-system": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-09-15",
    // 3 months later
    description: "Command system with : triggers and provider switching"
  },
  // Multi-document context - 2 month early access  
  "multi-doc-context": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Reference other documents with [[doc]] syntax"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Command button - 2 month early access
  "command-button": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Command button for mobile and discovery"
  },
  // Custom commands - 3 month early access
  "custom-commands": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-09-15",
    // 3 months later
    description: "User-defined custom command shortcuts"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context"
  // Current document context
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.catalystLicense = null;
    this.isCatalyst = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Catalyst status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(CATALYST_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const catalystDate = new Date(config.catalystDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsCatalyst() && now >= catalystDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Catalyst status (can be overridden in debug mode)
   */
  getIsCatalyst() {
    if (this.debugSettings.enabled && this.debugSettings.forceCatalyst !== void 0) {
      return this.debugSettings.forceCatalyst;
    }
    return this.isCatalyst;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Catalyst license and recalculate feature availability
   */
  async updateCatalystLicense(licenseKey) {
    if (!licenseKey) {
      this.catalystLicense = null;
      this.isCatalyst = false;
    } else {
      const validation = await this.licenseValidator.validateCatalystLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.catalystLicense = validation.license;
        this.isCatalyst = true;
      } else {
        this.catalystLicense = null;
        this.isCatalyst = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Catalyst status
   */
  getIsCatalystSupporter() {
    return this.getIsCatalyst();
  }
  /**
   * Get current Catalyst license
   */
  getCatalystLicense() {
    return this.catalystLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = CATALYST_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const catalystDate = new Date(config.catalystDate);
        if (this.getIsCatalyst() && now < catalystDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Catalyst supporters on ${config.catalystDate}`,
            isCatalystFeature: true,
            availableDate: catalystDate
          };
        } else if (!this.getIsCatalyst() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Catalyst supporters. It will be available to all users on ${config.generalDate}`,
            isCatalystFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Catalyst early access features
   */
  getCatalystFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = CATALYST_FEATURES[key];
        if (config) {
          const isCatalystUser = this.getIsCatalyst();
          comingSoon.push({
            key,
            availableDate: isCatalystUser ? config.catalystDate : config.generalDate,
            isCatalyst: isCatalystUser
          });
        }
      }
    }
    return {
      isCatalyst: this.getIsCatalyst(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Catalyst license key
   */
  async validateCatalystLicense(licenseKey) {
    try {
      const license = this.parseCatalystLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateCatalystLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Catalyst license key string
   */
  parseCatalystLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Catalyst license object
   */
  async validateCatalystLicenseObject(license) {
    const expectedSignature = await this.generateCatalystSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Catalyst license
   */
  async generateCatalystSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Catalyst license for development
   */
  async createTestCatalystLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateCatalystSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// main.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian6.Plugin {
  async onload() {
    try {
      console.log("Nova: onload starting...");
      await this.loadSettings();
      console.log("Nova: settings loaded");
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateCatalystLicense(this.settings.licensing.licenseKey);
      }
      console.log("Nova: feature manager initialized");
      (0, import_obsidian6.addIcon)("nova-star", NOVA_ICON_SVG);
      console.log("Nova: icon registered");
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      console.log("Nova: AI provider manager initialized");
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder();
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      console.log("Nova: document engine and commands initialized");
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      console.log("Nova: view registered");
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      console.log("Nova: ribbon icon added");
      console.log("Nova: ribbon icon element:", ribbonIcon);
      console.log("Nova: ribbon icon innerHTML:", ribbonIcon.innerHTML);
      console.log("Nova: ribbon icon classList:", ribbonIcon.classList.toString());
      this.addCommand({
        id: "nova-add-content",
        name: "Nova: Add content",
        editorCallback: async (editor, ctx) => {
          await this.handleAddCommand();
        }
      });
      this.addCommand({
        id: "nova-edit-content",
        name: "Nova: Edit content",
        editorCallback: async (editor, ctx) => {
          await this.handleEditCommand();
        }
      });
      this.addCommand({
        id: "nova-delete-content",
        name: "Nova: Delete content",
        editorCallback: async (editor, ctx) => {
          await this.handleDeleteCommand();
        }
      });
      this.addCommand({
        id: "nova-fix-grammar",
        name: "Nova: Fix grammar",
        editorCallback: async (editor, ctx) => {
          await this.handleGrammarCommand();
        }
      });
      this.addCommand({
        id: "nova-rewrite-content",
        name: "Nova: Rewrite content",
        editorCallback: async (editor, ctx) => {
          await this.handleRewriteCommand();
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      console.log("Nova: commands registered");
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
      console.log("Nova: settings tab added");
      console.log("Nova: onload completed successfully");
    } catch (error) {
      console.error("Nova: Error in onload:", error);
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
  }
  /**
   * Handle add content command with user input
   */
  async handleAddCommand() {
    const instruction = await this.promptForInstruction("What would you like to add?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.addCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content added successfully");
      } else {
        new import_obsidian6.Notice(`Failed to add content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle edit content command with user input
   */
  async handleEditCommand() {
    const instruction = await this.promptForInstruction("How would you like to edit the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.editCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content edited successfully");
      } else {
        new import_obsidian6.Notice(`Failed to edit content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle delete content command with user input
   */
  async handleDeleteCommand() {
    const instruction = await this.promptForInstruction("What would you like to delete?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.deleteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content deleted successfully");
      } else {
        new import_obsidian6.Notice(`Failed to delete content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle grammar correction command
   */
  async handleGrammarCommand() {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      new import_obsidian6.Notice("No active document found");
      return;
    }
    let target = "document";
    let instruction = "Fix grammar and spelling errors";
    if (documentContext.selectedText) {
      target = "selection";
      instruction = "Fix grammar and spelling errors in the selected text";
    }
    try {
      const command = {
        action: "grammar",
        target,
        instruction
      };
      const result = await this.grammarCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Grammar corrected successfully");
      } else {
        new import_obsidian6.Notice(`Failed to correct grammar: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle rewrite content command with user input
   */
  async handleRewriteCommand() {
    const instruction = await this.promptForInstruction("How would you like to rewrite the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.rewriteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content rewritten successfully");
      } else {
        new import_obsidian6.Notice(`Failed to rewrite content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Prompt user for instruction input
   */
  async promptForInstruction(placeholder) {
    return new Promise((resolve) => {
      const modal = document.createElement("div");
      modal.className = "modal nova-input-modal";
      modal.innerHTML = `
				<div class="modal-container">
					<div class="modal-bg" onclick="this.parentElement.parentElement.remove(); resolve(null);"></div>
					<div class="modal-content">
						<div class="modal-header">
							<h3>Nova AI Command</h3>
							<button class="modal-close-button" onclick="this.closest('.modal').remove(); resolve(null);">\xD7</button>
						</div>
						<div class="modal-body">
							<input type="text" class="nova-instruction-input" placeholder="${placeholder}" autofocus>
						</div>
						<div class="modal-footer">
							<button class="mod-cta nova-submit-btn">Execute</button>
							<button class="nova-cancel-btn">Cancel</button>
						</div>
					</div>
				</div>
			`;
      const input = modal.querySelector(".nova-instruction-input");
      const submitBtn = modal.querySelector(".nova-submit-btn");
      const cancelBtn = modal.querySelector(".nova-cancel-btn");
      const handleSubmit = () => {
        const value = input.value.trim();
        modal.remove();
        resolve(value || null);
      };
      const handleCancel = () => {
        modal.remove();
        resolve(null);
      };
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          handleSubmit();
        } else if (e.key === "Escape") {
          e.preventDefault();
          handleCancel();
        }
      });
      submitBtn.addEventListener("click", handleSubmit);
      cancelBtn.addEventListener("click", handleCancel);
      document.body.appendChild(modal);
      input.focus();
    });
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian6.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXIudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9jbGF1ZGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vcGVuYWkudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9nb29nbGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vbGxhbWEudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvdWkvd2lraWxpbmstc3VnZ2VzdC50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvY29yZS9kb2N1bWVudC1lbmdpbmUudHMiLCAic3JjL2NvcmUvY29udmVyc2F0aW9uLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvY29udGV4dC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmQtcGFyc2VyLnRzIiwgInNyYy9jb3JlL3Byb21wdC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2VkaXQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9kZWxldGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL21ldGFkYXRhLWNvbW1hbmQudHMiLCAic3JjL2xpY2Vuc2luZy9mZWF0dXJlLWNvbmZpZy50cyIsICJzcmMvbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlci50cyIsICJzcmMvbGljZW5zaW5nL2xpY2Vuc2UtdmFsaWRhdG9yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIFdvcmtzcGFjZUxlYWYsIEl0ZW1WaWV3LCBhZGRJY29uLCBOb3RpY2UsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNYXJrZG93bkZpbGVJbmZvLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncywgTm92YVNldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3NyYy9zZXR0aW5ncyc7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4vc3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgTm92YVNpZGViYXJWaWV3LCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSIH0gZnJvbSAnLi9zcmMvdWkvc2lkZWJhci12aWV3JztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi9zcmMvY29yZS9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyc2VyIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kLXBhcnNlcic7XG5pbXBvcnQgeyBQcm9tcHRCdWlsZGVyIH0gZnJvbSAnLi9zcmMvY29yZS9wcm9tcHQtYnVpbGRlcic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyIH0gZnJvbSAnLi9zcmMvY29yZS9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5pbXBvcnQgeyBBZGRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9hZGQtY29tbWFuZCc7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZWRpdC1jb21tYW5kJztcbmltcG9ydCB7IERlbGV0ZUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2RlbGV0ZS1jb21tYW5kJztcbmltcG9ydCB7IEdyYW1tYXJDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQnO1xuaW1wb3J0IHsgUmV3cml0ZUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL3Jld3JpdGUtY29tbWFuZCc7XG5pbXBvcnQgeyBNZXRhZGF0YUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL21ldGFkYXRhLWNvbW1hbmQnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcbmltcG9ydCB7IExpY2Vuc2VWYWxpZGF0b3IgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi9zcmMvdWkvd2lraWxpbmstc3VnZ2VzdCc7XG5cbmNvbnN0IE5PVkFfSUNPTl9TVkcgPSBgXG48c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPCEtLSBDZW50cmFsIHN0YXIgY29yZSAtLT5cbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuICBcbiAgPCEtLSBQcmltYXJ5IHJheXMgKDQgbWFpbiBkaXJlY3Rpb25zKSAtLT5cbiAgPHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIFxuICA8IS0tIFNlY29uZGFyeSByYXlzIChkaWFnb25hbHMpIC0tPlxuICA8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuPC9zdmc+YDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm92YVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzITogTm92YVNldHRpbmdzO1xuXHRhaVByb3ZpZGVyTWFuYWdlciE6IEFJUHJvdmlkZXJNYW5hZ2VyO1xuXHRkb2N1bWVudEVuZ2luZSE6IERvY3VtZW50RW5naW5lO1xuXHRjb250ZXh0QnVpbGRlciE6IENvbnRleHRCdWlsZGVyO1xuXHRjb21tYW5kUGFyc2VyITogQ29tbWFuZFBhcnNlcjtcblx0cHJvbXB0QnVpbGRlciE6IFByb21wdEJ1aWxkZXI7XG5cdGNvbnZlcnNhdGlvbk1hbmFnZXIhOiBDb252ZXJzYXRpb25NYW5hZ2VyO1xuXHRhZGRDb21tYW5kSGFuZGxlciE6IEFkZENvbW1hbmQ7XG5cdGVkaXRDb21tYW5kSGFuZGxlciE6IEVkaXRDb21tYW5kO1xuXHRkZWxldGVDb21tYW5kSGFuZGxlciE6IERlbGV0ZUNvbW1hbmQ7XG5cdGdyYW1tYXJDb21tYW5kSGFuZGxlciE6IEdyYW1tYXJDb21tYW5kO1xuXHRyZXdyaXRlQ29tbWFuZEhhbmRsZXIhOiBSZXdyaXRlQ29tbWFuZDtcblx0bWV0YWRhdGFDb21tYW5kSGFuZGxlciE6IE1ldGFkYXRhQ29tbWFuZDtcblx0ZmVhdHVyZU1hbmFnZXIhOiBGZWF0dXJlTWFuYWdlcjtcblx0bGljZW5zZVZhbGlkYXRvciE6IExpY2Vuc2VWYWxpZGF0b3I7XG5cdHNldHRpbmdUYWIhOiBOb3ZhU2V0dGluZ1RhYjtcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBvbmxvYWQgc3RhcnRpbmcuLi4nKTtcblx0XHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgbG9hZGVkJyk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgbGljZW5zaW5nIHN5c3RlbVxuXHRcdFx0dGhpcy5saWNlbnNlVmFsaWRhdG9yID0gbmV3IExpY2Vuc2VWYWxpZGF0b3IoKTtcblx0XHRcdHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBuZXcgRmVhdHVyZU1hbmFnZXIoXG5cdFx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvcixcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5nc1xuXHRcdFx0KTtcblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIGxpY2Vuc2UgZnJvbSBzZXR0aW5nc1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5mZWF0dXJlTWFuYWdlci51cGRhdGVDYXRhbHlzdExpY2Vuc2UodGhpcy5zZXR0aW5ncy5saWNlbnNpbmcubGljZW5zZUtleSk7XG5cdFx0XHR9XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogZmVhdHVyZSBtYW5hZ2VyIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdC8vIE5vdGU6IE1vYmlsZSBhY2Nlc3MgcmVzdHJpY3Rpb25zIGFyZSBub3cgaGFuZGxlZCBpbiBzaWRlYmFyIFVJXG5cdFx0XHQvLyBUaGlzIGFsbG93cyBDb3JlIG1vYmlsZSB1c2VycyB0byBzZWUgdGhlIHVwZ3JhZGUgaW50ZXJmYWNlIHJhdGhlciB0aGFuIGEgYnJva2VuIHBsdWdpblxuXG5cdFx0XHQvLyBSZWdpc3RlciBjdXN0b20gaWNvblxuXHRcdFx0YWRkSWNvbignbm92YS1zdGFyJywgTk9WQV9JQ09OX1NWRyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogaWNvbiByZWdpc3RlcmVkJyk7XG5cblx0XHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXIgPSBuZXcgQUlQcm92aWRlck1hbmFnZXIodGhpcy5zZXR0aW5ncywgdGhpcy5mZWF0dXJlTWFuYWdlcik7XG5cdFx0XHRhd2FpdCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyLmluaXRpYWxpemUoKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBBSSBwcm92aWRlciBtYW5hZ2VyIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgY29udmVyc2F0aW9uIG1hbmFnZXIgYW5kIGRvY3VtZW50IGVuZ2luZVxuXHRcdFx0Y29uc3QgZGF0YVN0b3JlID0ge1xuXHRcdFx0XHRsb2FkRGF0YTogKGtleTogc3RyaW5nKSA9PiB0aGlzLmxvYWREYXRhV2l0aEtleShrZXkpLFxuXHRcdFx0XHRzYXZlRGF0YTogKGtleTogc3RyaW5nLCBkYXRhOiBhbnkpID0+IHRoaXMuc2F2ZURhdGFXaXRoS2V5KGtleSwgZGF0YSlcblx0XHRcdH07XG5cdFx0XHR0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuXHRcdFx0dGhpcy5kb2N1bWVudEVuZ2luZSA9IG5ldyBEb2N1bWVudEVuZ2luZSh0aGlzLmFwcCwgZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0Q29udmVyc2F0aW9uTWFuYWdlcih0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpO1xuXHRcdFx0dGhpcy5jb250ZXh0QnVpbGRlciA9IG5ldyBDb250ZXh0QnVpbGRlcigpO1xuXHRcdFx0dGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcblx0XHRcdHRoaXMucHJvbXB0QnVpbGRlciA9IG5ldyBQcm9tcHRCdWlsZGVyKHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcik7XG5cdFx0XHRcblx0XHRcdC8vIEluaXRpYWxpemUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbnNcblx0XHRcdHRoaXMuYWRkQ29tbWFuZEhhbmRsZXIgPSBuZXcgQWRkQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmVkaXRDb21tYW5kSGFuZGxlciA9IG5ldyBFZGl0Q29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmRlbGV0ZUNvbW1hbmRIYW5kbGVyID0gbmV3IERlbGV0ZUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5ncmFtbWFyQ29tbWFuZEhhbmRsZXIgPSBuZXcgR3JhbW1hckNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5yZXdyaXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgUmV3cml0ZUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyID0gbmV3IE1ldGFkYXRhQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogZG9jdW1lbnQgZW5naW5lIGFuZCBjb21tYW5kcyBpbml0aWFsaXplZCcpO1xuXG5cdFx0XHR0aGlzLnJlZ2lzdGVyVmlldyhcblx0XHRcdFx0VklFV19UWVBFX05PVkFfU0lERUJBUixcblx0XHRcdFx0KGxlYWYpID0+IG5ldyBOb3ZhU2lkZWJhclZpZXcobGVhZiwgdGhpcylcblx0XHRcdCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogdmlldyByZWdpc3RlcmVkJyk7XG5cblx0XHRcdC8vIE5vdGU6IFdpa2lsaW5rIGF1dG9jb21wbGV0ZSBpcyBub3cgaGFuZGxlZCBkaXJlY3RseSBpbiBzaWRlYmFyIHZpZXdcblxuXHRcdFx0Y29uc3QgcmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbignbm92YS1zdGFyJywgJ05vdmEgQUknLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBhZGRlZCcpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGVsZW1lbnQ6JywgcmliYm9uSWNvbik7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gaW5uZXJIVE1MOicsIHJpYmJvbkljb24uaW5uZXJIVE1MKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBjbGFzc0xpc3Q6JywgcmliYm9uSWNvbi5jbGFzc0xpc3QudG9TdHJpbmcoKSk7XG5cblx0XHRcdC8vIFJlZ2lzdGVyIGNvcmUgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWFkZC1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IEFkZCBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVBZGRDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtZWRpdC1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IEVkaXQgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlRWRpdENvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1kZWxldGUtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBEZWxldGUgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlRGVsZXRlQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWZpeC1ncmFtbWFyJyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IEZpeCBncmFtbWFyJyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVHcmFtbWFyQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLXJld3JpdGUtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBSZXdyaXRlIGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVJld3JpdGVDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ29wZW4tbm92YS1zaWRlYmFyJyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IE9wZW4gc2lkZWJhcicsXG5cdFx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogY29tbWFuZHMgcmVnaXN0ZXJlZCcpO1xuXG5cdFx0XHR0aGlzLnNldHRpbmdUYWIgPSBuZXcgTm92YVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpO1xuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYih0aGlzLnNldHRpbmdUYWIpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHNldHRpbmdzIHRhYiBhZGRlZCcpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IG9ubG9hZCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ05vdmE6IEVycm9yIGluIG9ubG9hZDonLCBlcnJvcik7XG5cdFx0fVxuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlcj8uY2xlYW51cCgpO1xuXHRcdHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcj8uY2xlYW51cCgpO1xuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlcj8udXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XG5cdFx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuXG5cdFx0bGV0IGxlYWY6IFdvcmtzcGFjZUxlYWYgfCBudWxsO1xuXHRcdGNvbnN0IGxlYXZlcyA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cblx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGxlYWYgPSBsZWF2ZXNbMF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxlYWYgPSB3b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWY/LnNldFZpZXdTdGF0ZSh7IHR5cGU6IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsIGFjdGl2ZTogdHJ1ZSB9KTtcblx0XHR9XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmISk7XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGFkZCBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUFkZENvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW5zdHJ1Y3Rpb24gPSBhd2FpdCB0aGlzLnByb21wdEZvckluc3RydWN0aW9uKCdXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGFkZD8nKTtcblx0XHRpZiAoIWluc3RydWN0aW9uKSByZXR1cm47XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKGRvY3VtZW50Q29udGV4dD8uc2VsZWN0ZWRUZXh0KTtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGluc3RydWN0aW9uLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBhZGRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBhZGQgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZWRpdCBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUVkaXRDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignSG93IHdvdWxkIHlvdSBsaWtlIHRvIGVkaXQgdGhlIGNvbnRlbnQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdDb250ZW50IGVkaXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBlZGl0IGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGRlbGV0ZSBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZURlbGV0ZUNvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW5zdHJ1Y3Rpb24gPSBhd2FpdCB0aGlzLnByb21wdEZvckluc3RydWN0aW9uKCdXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGRlbGV0ZT8nKTtcblx0XHRpZiAoIWluc3RydWN0aW9uKSByZXR1cm47XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKGRvY3VtZW50Q29udGV4dD8uc2VsZWN0ZWRUZXh0KTtcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGluc3RydWN0aW9uLCBoYXNTZWxlY3Rpb24pO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBkZWxldGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBncmFtbWFyIGNvcnJlY3Rpb24gY29tbWFuZFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVHcmFtbWFyQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG5cdFx0XHRuZXcgTm90aWNlKCdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBEZXRlcm1pbmUgdGFyZ2V0IGJhc2VkIG9uIHNlbGVjdGlvblxuXHRcdGxldCB0YXJnZXQ6ICdzZWxlY3Rpb24nIHwgJ2RvY3VtZW50JyA9ICdkb2N1bWVudCc7XG5cdFx0bGV0IGluc3RydWN0aW9uID0gJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZyBlcnJvcnMnO1xuXHRcdFxuXHRcdGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG5cdFx0XHR0YXJnZXQgPSAnc2VsZWN0aW9uJztcblx0XHRcdGluc3RydWN0aW9uID0gJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZyBlcnJvcnMgaW4gdGhlIHNlbGVjdGVkIHRleHQnO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBjb21tYW5kID0ge1xuXHRcdFx0XHRhY3Rpb246ICdncmFtbWFyJyBhcyBjb25zdCxcblx0XHRcdFx0dGFyZ2V0LFxuXHRcdFx0XHRpbnN0cnVjdGlvblxuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0dyYW1tYXIgY29ycmVjdGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGNvcnJlY3QgZ3JhbW1hcjogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgcmV3cml0ZSBjb250ZW50IGNvbW1hbmQgd2l0aCB1c2VyIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVJld3JpdGVDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignSG93IHdvdWxkIHlvdSBsaWtlIHRvIHJld3JpdGUgdGhlIGNvbnRlbnQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucmV3cml0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdDb250ZW50IHJld3JpdHRlbiBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUHJvbXB0IHVzZXIgZm9yIGluc3RydWN0aW9uIGlucHV0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHByb21wdEZvckluc3RydWN0aW9uKHBsYWNlaG9sZGVyOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRcdGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRtb2RhbC5jbGFzc05hbWUgPSAnbW9kYWwgbm92YS1pbnB1dC1tb2RhbCc7XG5cdFx0XHRtb2RhbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250YWluZXJcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYmdcIiBvbmNsaWNrPVwidGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7IHJlc29sdmUobnVsbCk7XCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj5cblx0XHRcdFx0XHRcdFx0PGgzPk5vdmEgQUkgQ29tbWFuZDwvaDM+XG5cdFx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJtb2RhbC1jbG9zZS1idXR0b25cIiBvbmNsaWNrPVwidGhpcy5jbG9zZXN0KCcubW9kYWwnKS5yZW1vdmUoKTsgcmVzb2x2ZShudWxsKTtcIj5cdTAwRDc8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cblx0XHRcdFx0XHRcdFx0PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJub3ZhLWluc3RydWN0aW9uLWlucHV0XCIgcGxhY2Vob2xkZXI9XCIke3BsYWNlaG9sZGVyfVwiIGF1dG9mb2N1cz5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kLWN0YSBub3ZhLXN1Ym1pdC1idG5cIj5FeGVjdXRlPC9idXR0b24+XG5cdFx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJub3ZhLWNhbmNlbC1idG5cIj5DYW5jZWw8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IGlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtaW5zdHJ1Y3Rpb24taW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXHRcdFx0Y29uc3Qgc3VibWl0QnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtc3VibWl0LWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdFx0Y29uc3QgY2FuY2VsQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtY2FuY2VsLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXG5cdFx0XHRjb25zdCBoYW5kbGVTdWJtaXQgPSAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWUudHJpbSgpO1xuXHRcdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHRcdFx0cmVzb2x2ZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdH07XG5cblx0XHRcdGNvbnN0IGhhbmRsZUNhbmNlbCA9ICgpID0+IHtcblx0XHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0XHRcdHJlc29sdmUobnVsbCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcblx0XHRcdFx0aWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGhhbmRsZVN1Ym1pdCgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRoYW5kbGVDYW5jZWwoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVN1Ym1pdCk7XG5cdFx0XHRjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDYW5jZWwpO1xuXG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcblx0XHRcdGlucHV0LmZvY3VzKCk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogU2hvdyB1cGdyYWRlIHByb21wdCBmb3IgQ29yZSB0aWVyIG1vYmlsZSB1c2Vyc1xuXHQgKi9cblx0cHJpdmF0ZSBzaG93TW9iaWxlVXBncmFkZVByb21wdCgpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdG1vZGFsLmNsYXNzTmFtZSA9ICdtb2RhbCBub3ZhLW1vYmlsZS11cGdyYWRlLW1vZGFsJztcblx0XHRtb2RhbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1iZ1wiPjwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj5cblx0XHRcdFx0XHRcdDxoMz5Ob3ZhIFN1cGVyTm92YSBSZXF1aXJlZDwvaDM+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpZXItYmFkZ2UgY29yZVwiIHN0eWxlPVwibWFyZ2luLWJvdHRvbTogMWVtO1wiPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItaWNvblwiPkZSRUU8L3NwYW4+XG5cdFx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwidGllci1uYW1lXCI+Q29yZSAoRnJlZSk8L3NwYW4+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxwPk1vYmlsZSBhY2Nlc3MgaXMgYXZhaWxhYmxlIHdpdGggTm92YSBTdXBlck5vdmEuPC9wPlxuXHRcdFx0XHRcdFx0PHA+Q29yZSB0aWVyIGlzIGxpbWl0ZWQgdG8gZGVza3RvcCB1c2Ugb25seS48L3A+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1mZWF0dXJlLWxpc3RcIj5cblx0XHRcdFx0XHRcdFx0PGg0PlN1cGVyTm92YSBpbmNsdWRlczo8L2g0PlxuXHRcdFx0XHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPk1vYmlsZSBkZXZpY2Ugc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPk11bHRpcGxlIEFJIHByb3ZpZGVyczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkluLWNoYXQgcHJvdmlkZXIgc3dpdGNoaW5nPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+QWR2YW5jZWQgdGVtcGxhdGVzPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+UHJpb3JpdHkgc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdDwvdWw+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kLWN0YSBub3ZhLXVwZ3JhZGUtYnRuXCI+VXBncmFkZSB0byBTdXBlck5vdmE8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJub3ZhLWNsb3NlLWJ0blwiPkNsb3NlPC9idXR0b24+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdGNvbnN0IHVwZ3JhZGVCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS11cGdyYWRlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IGNsb3NlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtY2xvc2UtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0Y29uc3QgbW9kYWxCZyA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1iZycpIGFzIEhUTUxFbGVtZW50O1xuXG5cdFx0Y29uc3QgY2xvc2VNb2RhbCA9ICgpID0+IHtcblx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdH07XG5cblx0XHR1cGdyYWRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0d2luZG93Lm9wZW4oJ2h0dHBzOi8vbm92YXdyaXRlci5haS91cGdyYWRlJywgJ19ibGFuaycpO1xuXHRcdFx0Y2xvc2VNb2RhbCgpO1xuXHRcdH0pO1xuXG5cdFx0Y2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcblx0XHRtb2RhbEJnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcblxuXHRcdC8vIFNob3cgbm90aWNlIGFzIHdlbGxcblx0XHRuZXcgTm90aWNlKCdOb3ZhIG1vYmlsZSBhY2Nlc3MgcmVxdWlyZXMgU3VwZXJOb3ZhIGxpY2Vuc2UnLCA4MDAwKTtcblx0fVxuXG5cdC8vIERhdGFTdG9yZSBpbnRlcmZhY2UgaW1wbGVtZW50YXRpb24gZm9yIENvbnZlcnNhdGlvbk1hbmFnZXJcblx0YXN5bmMgbG9hZERhdGFXaXRoS2V5KGtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcblx0XHRjb25zdCBhbGxEYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuXHRcdHJldHVybiBhbGxEYXRhID8gYWxsRGF0YVtrZXldIDogdW5kZWZpbmVkO1xuXHR9XG5cblx0YXN5bmMgc2F2ZURhdGFXaXRoS2V5KGtleTogc3RyaW5nLCBkYXRhOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhbGxEYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpIHx8IHt9O1xuXHRcdGFsbERhdGFba2V5XSA9IGRhdGE7XG5cdFx0cmV0dXJuIGF3YWl0IHRoaXMuc2F2ZURhdGEoYWxsRGF0YSk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgQUlQcm92aWRlclNldHRpbmdzLCBQbGF0Zm9ybVNldHRpbmdzLCBQcm92aWRlclR5cGUgfSBmcm9tICcuL2FpL3R5cGVzJztcbmltcG9ydCB7IERlYnVnU2V0dGluZ3MgfSBmcm9tICcuL2xpY2Vuc2luZy90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tQ29tbWFuZCB7XG5cdGlkOiBzdHJpbmc7XG5cdG5hbWU6IHN0cmluZztcblx0dHJpZ2dlcjogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3ZhU2V0dGluZ3Mge1xuXHRhaVByb3ZpZGVyczogQUlQcm92aWRlclNldHRpbmdzO1xuXHRwbGF0Zm9ybVNldHRpbmdzOiBQbGF0Zm9ybVNldHRpbmdzO1xuXHRjdXN0b21Db21tYW5kcz86IEN1c3RvbUNvbW1hbmRbXTtcblx0Z2VuZXJhbDoge1xuXHRcdGRlZmF1bHRUZW1wZXJhdHVyZTogbnVtYmVyO1xuXHRcdGRlZmF1bHRNYXhUb2tlbnM6IG51bWJlcjtcblx0XHRhdXRvU2F2ZTogYm9vbGVhbjtcblx0fTtcblx0bGljZW5zaW5nOiB7XG5cdFx0bGljZW5zZUtleTogc3RyaW5nO1xuXHRcdGNhdGFseXN0TGljZW5zZUtleT86IHN0cmluZztcblx0XHRpc0NhdGFseXN0PzogYm9vbGVhbjtcblx0XHRkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzO1xuXHR9O1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTm92YVNldHRpbmdzID0ge1xuXHRhaVByb3ZpZGVyczoge1xuXHRcdGNsYXVkZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnY2xhdWRlLXNvbm5ldC00Jyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9wZW5haToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdGJhc2VVcmw6ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJyxcblx0XHRcdG1vZGVsOiAnZ3B0LTRvJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdGdvb2dsZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA1LTIwJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9sbGFtYToge1xuXHRcdFx0YmFzZVVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuXHRcdFx0bW9kZWw6ICcnLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH1cblx0fSxcblx0cGxhdGZvcm1TZXR0aW5nczoge1xuXHRcdGRlc2t0b3A6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ29sbGFtYScsXG5cdFx0XHRmYWxsYmFja1Byb3ZpZGVyczogWydvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0fSxcblx0XHRtb2JpbGU6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ25vbmUnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZSddXG5cdFx0fVxuXHR9LFxuXHRjdXN0b21Db21tYW5kczogW10sXG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IDAuNyxcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiAxMDAwLFxuXHRcdGF1dG9TYXZlOiB0cnVlXG5cdH0sXG5cdGxpY2Vuc2luZzoge1xuXHRcdGxpY2Vuc2VLZXk6ICcnLFxuXHRcdGNhdGFseXN0TGljZW5zZUtleTogJycsXG5cdFx0aXNDYXRhbHlzdDogZmFsc2UsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRvdmVycmlkZURhdGU6IHVuZGVmaW5lZCxcblx0XHRcdGZvcmNlQ2F0YWx5c3Q6IGZhbHNlXG5cdFx0fVxuXHR9XG59O1xuXG5leHBvcnQgY2xhc3MgTm92YVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBOb3ZhUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE5vdmFQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdOb3ZhIEFJIFNldHRpbmdzJyB9KTtcblxuXHRcdHRoaXMuY3JlYXRlTGljZW5zZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVHZW5lcmFsU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZUNvbW1hbmRTZXR0aW5ncygpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVMaWNlbnNlU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb25zdCBsaWNlbnNlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXNlY3Rpb24nIH0pO1xuXHRcdGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ2F0YWx5c3QgU3VwcG9ydGVyIFN0YXR1cycgfSk7XG5cblx0XHQvLyBJbmZvIGFib3V0IHRoZSBuZXcgbW9kZWxcblx0XHRjb25zdCBpbmZvRWwgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbW9kZWwtaW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDQ+QWxsIEZlYXR1cmVzIEF2YWlsYWJsZTwvaDQ+XG5cdFx0XHRcdDxwPk5vdmEgcHJvdmlkZXMgYWxsIGZlYXR1cmVzIGZvciBmcmVlIHdoZW4geW91IHVzZSB5b3VyIG93biBBSSBwcm92aWRlciBBUEkga2V5cy4gXG5cdFx0XHRcdENhdGFseXN0IHN1cHBvcnRlcnMgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMgYmVmb3JlIHRoZXkncmUgcmVsZWFzZWQgdG8gZXZlcnlvbmUuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgQ2F0YWx5c3Qgc3RhdHVzXG5cdFx0Y29uc3QgaXNDYXRhbHlzdCA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRJc0NhdGFseXN0U3VwcG9ydGVyKCkgfHwgZmFsc2U7XG5cdFx0Y29uc3QgY2F0YWx5c3RMaWNlbnNlID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmdldENhdGFseXN0TGljZW5zZSgpO1xuXHRcdFxuXHRcdGNvbnN0IHN0YXR1c0Rpc3BsYXkgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY2F0YWx5c3Qtc3RhdHVzJyB9KTtcblx0XHRjb25zdCBzdGF0dXNUZXh0ID0gaXNDYXRhbHlzdCA/ICdDYXRhbHlzdCBTdXBwb3J0ZXInIDogJ05vdmEgVXNlcic7XG5cdFx0Y29uc3Qgc3RhdHVzSWNvbiA9IGlzQ2F0YWx5c3QgPyAnXHUyNkExJyA6ICdcdTI2MDUnOyAvLyBMaWdodG5pbmcgZm9yIENhdGFseXN0LCBTdGFyIGZvciBOb3ZhXG5cdFx0c3RhdHVzRGlzcGxheS5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1zdGF0dXMtYmFkZ2UgJHtpc0NhdGFseXN0ID8gJ2NhdGFseXN0JyA6ICdub3ZhJ31cIj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJzdGF0dXMtaWNvblwiPiR7c3RhdHVzSWNvbn08L3NwYW4+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLW5hbWVcIj4ke3N0YXR1c1RleHR9PC9zcGFuPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIENhdGFseXN0IGxpY2Vuc2Ugc3RhdHVzXG5cdFx0aWYgKGNhdGFseXN0TGljZW5zZSkge1xuXHRcdFx0Y29uc3Qgc3RhdHVzRWwgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zdGF0dXMnIH0pO1xuXHRcdFx0Y29uc3QgZXhwaXJ5VGV4dCA9IGNhdGFseXN0TGljZW5zZS5leHBpcmVzQXQgXG5cdFx0XHRcdD8gYEV4cGlyZXM6ICR7Y2F0YWx5c3RMaWNlbnNlLmV4cGlyZXNBdC50b0xvY2FsZURhdGVTdHJpbmcoKX1gXG5cdFx0XHRcdDogJ0xpZmV0aW1lIFN1cHBvcnQnO1xuXHRcdFx0c3RhdHVzRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibGljZW5zZS1pbmZvXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJsaWNlbnNlLWVtYWlsXCI+JHtjYXRhbHlzdExpY2Vuc2UuZW1haWx9PC9zcGFuPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1leHBpcnlcIj4ke2V4cGlyeVRleHR9PC9zcGFuPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fVxuXG5cdFx0Ly8gQ2F0YWx5c3QgbGljZW5zZSBrZXkgaW5wdXRcblx0XHRuZXcgU2V0dGluZyhsaWNlbnNlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0NhdGFseXN0IExpY2Vuc2UgS2V5IChPcHRpb25hbCknKVxuXHRcdFx0LnNldERlc2MoJ0VudGVyIHlvdXIgQ2F0YWx5c3Qgc3VwcG9ydGVyIGxpY2Vuc2Uga2V5IGZvciBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4ge1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG5cdFx0XHRcdHRleHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIENhdGFseXN0IGxpY2Vuc2Uga2V5Li4uJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmNhdGFseXN0TGljZW5zZUtleSB8fCAnJylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuY2F0YWx5c3RMaWNlbnNlS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gVXBkYXRlIENhdGFseXN0IGxpY2Vuc2UgaW4gZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlQ2F0YWx5c3RMaWNlbnNlKHZhbHVlIHx8IG51bGwpO1xuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBkaXNwbGF5IHRvIHNob3cgdXBkYXRlZCBzdGF0dXNcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gQWRkIHZhbGlkYXRpb24gYnV0dG9uXG5cdFx0XHRcdGNvbnN0IHZhbGlkYXRlQnV0dG9uID0gdGV4dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/LmNyZWF0ZUVsKCdidXR0b24nLCB7XG5cdFx0XHRcdFx0dGV4dDogJ1ZhbGlkYXRlJyxcblx0XHRcdFx0XHRjbHM6ICdub3ZhLXZhbGlkYXRlLWJ0bidcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAodmFsaWRhdGVCdXR0b24pIHtcblx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IGxpY2Vuc2VLZXkgPSB0ZXh0LmlucHV0RWwudmFsdWU7XG5cdFx0XHRcdFx0XHRpZiAoIWxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1BsZWFzZSBlbnRlciBhIENhdGFseXN0IGxpY2Vuc2Uga2V5IGZpcnN0LicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLnRleHRDb250ZW50ID0gJ1ZhbGlkYXRpbmcuLi4nO1xuXHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVDYXRhbHlzdExpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXNDYXRhbHlzdCA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmdldElzQ2F0YWx5c3RTdXBwb3J0ZXIoKTtcblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHRpZiAoaXNDYXRhbHlzdCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1ZhbGlkIENhdGFseXN0IGxpY2Vuc2UhIFlvdSBub3cgaGF2ZSBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLicsICdzdWNjZXNzJyk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdJbnZhbGlkIG9yIGV4cGlyZWQgQ2F0YWx5c3QgbGljZW5zZSBrZXkuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnRXJyb3IgdmFsaWRhdGluZyBDYXRhbHlzdCBsaWNlbnNlLicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24udGV4dENvbnRlbnQgPSAnVmFsaWRhdGUnO1xuXHRcdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdC8vIEZlYXR1cmVzIGNvbXBhcmlzb25cblx0XHR0aGlzLmNyZWF0ZUZlYXR1cmVDb21wYXJpc29uKGxpY2Vuc2VDb250YWluZXIpO1xuXG5cdFx0Ly8gRGVidWcgc2V0dGluZ3MgKGRldmVsb3BtZW50IG9ubHkpXG5cdFx0aWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnIHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdHRoaXMuY3JlYXRlRGVidWdTZXR0aW5ncyhsaWNlbnNlQ29udGFpbmVyKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUZlYXR1cmVDb21wYXJpc29uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBjb21wYXJpc29uQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtZmVhdHVyZS1jb21wYXJpc29uJyB9KTtcblx0XHRjb21wYXJpc29uQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ05vdmEgRmVhdHVyZXMnIH0pO1xuXG5cdFx0Ly8gRmVhdHVyZSBzdW1tYXJ5XG5cdFx0Y29uc3Qgc3VtbWFyeUVsID0gY29tcGFyaXNvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWZlYXR1cmUtc3VtbWFyeScgfSk7XG5cdFx0c3VtbWFyeUVsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWF2YWlsYWJsZS1ub3dcIj5cblx0XHRcdFx0PGg1PkF2YWlsYWJsZSBOb3cgKEZyZWUgd2l0aCBZb3VyIEFQSSBLZXlzKTwvaDU+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+QWxsIEFJIFByb3ZpZGVycyAoQ2xhdWRlLCBPcGVuQUksIEdlbWluaSwgT2xsYW1hKTwvbGk+XG5cdFx0XHRcdFx0PGxpPkNvbXBsZXRlIERvY3VtZW50IEVkaXRpbmcgU3VpdGU8L2xpPlxuXHRcdFx0XHRcdDxsaT5DaGF0IEludGVyZmFjZSB3aXRoIENvbnZlcnNhdGlvbiBIaXN0b3J5PC9saT5cblx0XHRcdFx0XHQ8bGk+UHJvdmlkZXIgU3dpdGNoaW5nPC9saT5cblx0XHRcdFx0XHQ8bGk+RnVsbCBNb2JpbGUgU3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0PGxpPkZpbGUtU2NvcGVkIENvbnZlcnNhdGlvbnM8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEdldCB1cGNvbWluZyBmZWF0dXJlcyBmb3IgQ2F0YWx5c3Qgc3VwcG9ydGVyc1xuXHRcdGNvbnN0IGZlYXR1cmVTdW1tYXJ5ID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmdldEZlYXR1cmVTdW1tYXJ5KCk7XG5cdFx0aWYgKGZlYXR1cmVTdW1tYXJ5ICYmIGZlYXR1cmVTdW1tYXJ5LmNvbWluZ1Nvb24ubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgdXBjb21pbmdFbCA9IGNvbXBhcmlzb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS11cGNvbWluZy1mZWF0dXJlcycgfSk7XG5cdFx0XHR1cGNvbWluZ0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtY2F0YWx5c3QtcHJldmlld1wiPlxuXHRcdFx0XHRcdDxoNT5Db21pbmcgU29vbiBmb3IgQ2F0YWx5c3QgU3VwcG9ydGVyczwvaDU+XG5cdFx0XHRcdFx0PHVsPlxuXHRcdFx0XHRcdFx0JHtmZWF0dXJlU3VtbWFyeS5jb21pbmdTb29uLm1hcChmZWF0dXJlID0+IGBcblx0XHRcdFx0XHRcdFx0PGxpPkF2YWlsYWJsZSAke2ZlYXR1cmUuYXZhaWxhYmxlRGF0ZX0gJHtmZWF0dXJlLmlzQ2F0YWx5c3QgPyAnKFlvdSBoYXZlIGVhcmx5IGFjY2VzcyEpJyA6ICcnfTwvbGk+XG5cdFx0XHRcdFx0XHRgKS5qb2luKCcnKX1cblx0XHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fVxuXG5cdFx0Ly8gQ2F0YWx5c3Qgc3VwcG9ydGVyIGluZm9ybWF0aW9uXG5cdFx0Y29uc3QgY2F0YWx5c3RJbmZvID0gY29tcGFyaXNvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNhdGFseXN0LWluZm8nIH0pO1xuXHRcdGNhdGFseXN0SW5mby5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg1PkJlY29tZSBhIENhdGFseXN0IFN1cHBvcnRlcjwvaDU+XG5cdFx0XHRcdDxwPlN1cHBvcnQgTm92YSBkZXZlbG9wbWVudCBhbmQgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuIEFsbCBmZWF0dXJlcyBldmVudHVhbGx5IGJlY29tZSBmcmVlIGZvciBldmVyeW9uZS48L3A+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+RWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcyAoMy02IG1vbnRocyBiZWZvcmUgZ2VuZXJhbCByZWxlYXNlKTwvbGk+XG5cdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQgYW5kIGZlYXR1cmUgcmVxdWVzdHM8L2xpPlxuXHRcdFx0XHRcdDxsaT5TdXBwb3J0ZXIgYmFkZ2UgYW5kIHJlY29nbml0aW9uPC9saT5cblx0XHRcdFx0XHQ8bGk+RGlyZWN0bHkgc3VwcG9ydCBvcGVuLXNvdXJjZSBkZXZlbG9wbWVudDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1NldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBkZWJ1Z0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0RldmVsb3BtZW50IFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0RlYnVnIE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXZlbG9wbWVudCB0ZXN0aW5nIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIGRlYnVnIG9wdGlvbnNcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnT3ZlcnJpZGUgRGF0ZScpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBjdXJyZW50IGRhdGUgZm9yIHRlc3RpbmcgdGltZS1nYXRlZCBmZWF0dXJlcyAoWVlZWS1NTS1ERCknKVxuXHRcdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzIwMjUtMTItMDEnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5XG5cdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnRm9yY2UgQ2F0YWx5c3QgU3RhdHVzJylcblx0XHRcdFx0LnNldERlc2MoJ092ZXJyaWRlIENhdGFseXN0IHN1cHBvcnRlciBzdGF0dXMgZm9yIHRlc3RpbmcnKVxuXHRcdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VDYXRhbHlzdCB8fCBmYWxzZSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZUNhdGFseXN0ID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXlcblx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdH0pKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dMaWNlbnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIHR5cGU6ICdzdWNjZXNzJyB8ICdlcnJvcicpIHtcblx0XHQvLyBDcmVhdGUgb3IgdXBkYXRlIG1lc3NhZ2UgZWxlbWVudFxuXHRcdGNvbnN0IGV4aXN0aW5nTWVzc2FnZSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtbGljZW5zZS1tZXNzYWdlJyk7XG5cdFx0aWYgKGV4aXN0aW5nTWVzc2FnZSkge1xuXHRcdFx0ZXhpc3RpbmdNZXNzYWdlLnJlbW92ZSgpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgXG5cdFx0XHRjbHM6IGBub3ZhLWxpY2Vuc2UtbWVzc2FnZSAke3R5cGV9YCxcblx0XHRcdHRleHQ6IG1lc3NhZ2Vcblx0XHR9KTtcblxuXHRcdC8vIEF1dG8tcmVtb3ZlIGFmdGVyIDUgc2Vjb25kc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0bWVzc2FnZUVsLnJlbW92ZSgpO1xuXHRcdH0sIDUwMDApO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHZW5lcmFsU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdHZW5lcmFsIFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgVGVtcGVyYXR1cmUnKVxuXHRcdFx0LnNldERlc2MoJ0NvbnRyb2xzIHJhbmRvbW5lc3MgaW4gQUkgcmVzcG9uc2VzICgwLjAgLSAxLjApJylcblx0XHRcdC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuXHRcdFx0XHQuc2V0TGltaXRzKDAsIDEsIDAuMSlcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlKVxuXHRcdFx0XHQuc2V0RHluYW1pY1Rvb2x0aXAoKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0VGVtcGVyYXR1cmUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBNYXggVG9rZW5zJylcblx0XHRcdC5zZXREZXNjKCdNYXhpbXVtIGxlbmd0aCBvZiBBSSByZXNwb25zZXMnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignMTAwMCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnMudG9TdHJpbmcoKSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IG51bVZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuXHRcdFx0XHRcdGlmICghaXNOYU4obnVtVmFsdWUpICYmIG51bVZhbHVlID4gMCkge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zID0gbnVtVmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0F1dG8tc2F2ZSBzZXR0aW5ncycpXG5cdFx0XHQuc2V0RGVzYygnQXV0b21hdGljYWxseSBzYXZlIHNldHRpbmdzIHdoZW4gY2hhbmdlZCcpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuYXV0b1NhdmUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0FJIFByb3ZpZGVyIFNldHRpbmdzJyB9KTtcblxuXHRcdC8vIEluZm8gYWJvdXQgQVBJIGtleXNcblx0XHRjb25zdCBpbmZvRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0PkNvbmZpZ3VyZSBZb3VyIEFQSSBLZXlzPC9oND5cblx0XHRcdFx0PHA+Tm92YSBjb25uZWN0cyB0byBBSSBwcm92aWRlcnMgdXNpbmcgeW91ciBvd24gQVBJIGtleXMuIEFsbCBwcm92aWRlcnMgYXJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgLSBcblx0XHRcdFx0anVzdCBhZGQgeW91ciBBUEkga2V5cyBiZWxvdyB0byBnZXQgc3RhcnRlZC48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gU2hvdyBhbGwgcHJvdmlkZXJzIC0gbm8gcmVzdHJpY3Rpb25zXG5cdFx0dGhpcy5jcmVhdGVPbGxhbWFTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlQ2xhdWRlU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZUdvb2dsZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVPcGVuQUlTZXR0aW5ncygpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDbGF1ZGVTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdGNvbnN0IGNsYXVkZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0Y2xhdWRlQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NsYXVkZSAoQW50aHJvcGljKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjbGF1ZGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBBbnRocm9waWMgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay1hbnQtLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNsYXVkZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnQ2xhdWRlIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cblx0XHRcdFx0LmFkZE9wdGlvbignY2xhdWRlLXNvbm5ldC00JywgJ0NsYXVkZSBTb25uZXQgNCcpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZS1vcHVzLTQnLCAnQ2xhdWRlIE9wdXMgNCcpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZS0zLWhhaWt1LTIwMjQwMzA3JywgJ0NsYXVkZSAzIEhhaWt1Jylcblx0XHRcdFx0LmFkZE9wdGlvbignY2xhdWRlLTMtc29ubmV0LTIwMjQwMjI5JywgJ0NsYXVkZSAzIFNvbm5ldCcpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZS0zLW9wdXMtMjAyNDAyMjknLCAnQ2xhdWRlIDMgT3B1cycpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUubW9kZWwgfHwgJ2NsYXVkZS1zb25uZXQtNCcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblxuXHRwcml2YXRlIGNyZWF0ZU9wZW5BSVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0XG5cdFx0Y29uc3Qgb3BlbmFpQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRvcGVuYWlDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnT3BlbkFJJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIE9wZW5BSSBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ3NrLS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQmFzZSBVUkwnKVxuXHRcdFx0LnNldERlc2MoJ09wZW5BSSBBUEkgYmFzZSBVUkwgKGZvciBjdXN0b20gZW5kcG9pbnRzKScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5iYXNlVXJsIHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmJhc2VVcmwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdPcGVuQUkgbW9kZWwgdG8gdXNlJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0XHQuYWRkT3B0aW9uKCdncHQtNG8nLCAnR1BULTRvJylcblx0XHRcdFx0LmFkZE9wdGlvbignZ3B0LTMuNS10dXJibycsICdHUFQtMy41IFR1cmJvJylcblx0XHRcdFx0LmFkZE9wdGlvbignZ3B0LTQnLCAnR1BULTQnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdncHQtNC10dXJiby1wcmV2aWV3JywgJ0dQVC00IFR1cmJvJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCB8fCAnZ3B0LTRvJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUdvb2dsZVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0XG5cdFx0Y29uc3QgZ29vZ2xlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRnb29nbGVDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnR29vZ2xlIChHZW1pbmkpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGdvb2dsZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEdvb2dsZSBBSSBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0FJLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGdvb2dsZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnR2VtaW5pIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cblx0XHRcdFx0LmFkZE9wdGlvbignZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA1LTIwJywgJ0dlbWluaSAyLjUgRmxhc2ggUHJldmlldycpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dlbWluaS0yLjUtcHJvLXByZXZpZXctMDYtMDUnLCAnR2VtaW5pIDIuNSBQcm8gUHJldmlldycpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dlbWluaS0xLjUtZmxhc2gnLCAnR2VtaW5pIDEuNSBGbGFzaCcpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dlbWluaS0xLjUtcHJvJywgJ0dlbWluaSAxLjUgUHJvJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5tb2RlbCB8fCAnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA1LTIwJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZU9sbGFtYVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29uc3Qgb2xsYW1hQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRvbGxhbWFDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnT2xsYW1hIChMb2NhbCknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcob2xsYW1hQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Jhc2UgVVJMJylcblx0XHRcdC5zZXREZXNjKCdPbGxhbWEgc2VydmVyIFVSTCcpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdodHRwOi8vbG9jYWxob3N0OjExNDM0Jylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsIHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcob2xsYW1hQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdPbGxhbWEgbW9kZWwgdG8gdXNlJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2xsYW1hMicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEubW9kZWwgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQbGF0Zm9ybVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUGxhdGZvcm0gU2V0dGluZ3MnIH0pO1xuXG5cdFx0Y29uc3QgcGxhdGZvcm1Db250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXBsYXRmb3JtLXNlY3Rpb24nIH0pO1xuXHRcdFxuXHRcdC8vIEluZm8gYWJvdXQgcGxhdGZvcm0gc2V0dGluZ3Ncblx0XHRjb25zdCBpbmZvRWwgPSBwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXBsYXRmb3JtLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0Plx1RDgzRFx1RERBNVx1RkUwRiBQbGF0Zm9ybSBDb25maWd1cmF0aW9uPC9oND5cblx0XHRcdFx0PHA+Q29uZmlndXJlIHdoaWNoIEFJIHByb3ZpZGVyIHRvIHVzZSBhcyB5b3VyIHByaW1hcnkgcHJvdmlkZXIgb24gZGlmZmVyZW50IHBsYXRmb3Jtcy4gXG5cdFx0XHRcdE5vdmEgd29ya3Mgc2VhbWxlc3NseSBhY3Jvc3MgZGVza3RvcCBhbmQgbW9iaWxlIHdpdGggYWxsIHByb3ZpZGVycy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHRcdFxuXHRcdHBsYXRmb3JtQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0Rlc2t0b3AnIH0pO1xuXHRcdGNvbnN0IGRlc2t0b3BEcm9wZG93biA9IG5ldyBTZXR0aW5nKHBsYXRmb3JtQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1ByaW1hcnkgUHJvdmlkZXInKVxuXHRcdFx0LnNldERlc2MoJ1ByaW1hcnkgQUkgcHJvdmlkZXIgZm9yIGRlc2t0b3AnKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMuZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKCdkZXNrdG9wJyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRhbGxvd2VkUHJvdmlkZXJzLmZvckVhY2gocHJvdmlkZXIgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGxhYmVsID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyKTtcblx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24ocHJvdmlkZXIsIGxhYmVsKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnByaW1hcnlQcm92aWRlcilcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdHBsYXRmb3JtQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ01vYmlsZScgfSk7XG5cdFx0Y29uc3QgbW9iaWxlU2V0dGluZyA9IG5ldyBTZXR0aW5nKHBsYXRmb3JtQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1ByaW1hcnkgUHJvdmlkZXInKVxuXHRcdFx0LnNldERlc2MoJ1ByaW1hcnkgQUkgcHJvdmlkZXIgZm9yIG1vYmlsZSBkZXZpY2VzJyk7XG5cdFx0XHRcblx0XHRtb2JpbGVTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG5cdFx0XHQuYWRkT3B0aW9uKCdub25lJywgJ05vbmUgKERpc2FibGVkKScpXG5cdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUnLCAnQ2xhdWRlJylcblx0XHRcdC5hZGRPcHRpb24oJ29wZW5haScsICdPcGVuQUknKVxuXHRcdFx0LmFkZE9wdGlvbignZ29vZ2xlJywgJ0dvb2dsZScpXG5cdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUucHJpbWFyeVByb3ZpZGVyKVxuXHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlciA9IHZhbHVlIGFzIFByb3ZpZGVyVHlwZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBbGxvd2VkUHJvdmlkZXJzRm9yUGxhdGZvcm0ocGxhdGZvcm06ICdkZXNrdG9wJyB8ICdtb2JpbGUnKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgaW4gdGhlIENhdGFseXN0IG1vZGVsXG5cdFx0cmV0dXJuIHBsYXRmb3JtID09PSAnZGVza3RvcCcgXG5cdFx0XHQ/IFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ11cblx0XHRcdDogWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZSddO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyOiBQcm92aWRlclR5cGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8UHJvdmlkZXJUeXBlLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdDbGF1ZGUgKEFudGhyb3BpYyknLFxuXHRcdFx0J29wZW5haSc6ICdPcGVuQUknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUgKEdlbWluaSknLCBcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hIChMb2NhbCknLFxuXHRcdFx0J25vbmUnOiAnTm9uZSAoRGlzYWJsZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIG5hbWVzW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcblx0fVxuXG5cdGFzeW5jIHNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0ucHJpbWFyeVByb3ZpZGVyID0gcHJvdmlkZXJJZCBhcyBQcm92aWRlclR5cGU7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBwcm92aWRlciBtYW5hZ2VyIHdpdGggbmV3IHNldHRpbmdzXG5cdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb25zdCBjb21tYW5kQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXNlY3Rpb24nIH0pO1xuXHRcdGNvbW1hbmRDb250YWluZXIuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ3VzdG9tIENvbW1hbmRzJyB9KTtcblxuXHRcdC8vIEZlYXR1cmUgYXZhaWxhYmlsaXR5IG5vdGljZVxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY3VzdG9tLWNvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IG5vdGljZUVsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWZlYXR1cmUtbm90aWNlJyB9KTtcblx0XHRcdG5vdGljZUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cInBhZGRpbmc6IDEycHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBib3JkZXItcmFkaXVzOiA4cHg7IG1hcmdpbi1ib3R0b206IDE2cHg7XCI+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJtYXJnaW46IDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTtcIj5cblx0XHRcdFx0XHRcdEN1c3RvbSBjb21tYW5kcyBhcmUgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgQ2F0YWx5c3Qgc3VwcG9ydGVycy4gXG5cdFx0XHRcdFx0XHRUaGV5IHdpbGwgYmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyBvbiBTZXB0ZW1iZXIgMTUsIDIwMjUuXG5cdFx0XHRcdFx0PC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGVzY3JpcHRpb25cblx0XHRjb25zdCBkZXNjRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjcmlwdGlvbicgfSk7XG5cdFx0ZGVzY0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxwIHN0eWxlPVwiY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiAxNnB4O1wiPlxuXHRcdFx0XHRDcmVhdGUgY3VzdG9tIGNvbW1hbmQgc2hvcnRjdXRzIHRoYXQgaW5zZXJ0IHByZWRlZmluZWQgdGV4dCB0ZW1wbGF0ZXMgd2hlbiB0cmlnZ2VyZWQgd2l0aCA8Y29kZT46dHJpZ2dlcjwvY29kZT4uXG5cdFx0XHQ8L3A+XG5cdFx0YDtcblxuXHRcdC8vIENvbW1hbmRzIGxpc3Rcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdChjb21tYW5kQ29udGFpbmVyKTtcblxuXHRcdC8vIEFkZCBuZXcgY29tbWFuZCBidXR0b25cblx0XHRjb25zdCBidXR0b25FbCA9IGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1hZGQtY29tbWFuZCcgfSk7XG5cdFx0YnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tdG9wOiAxNnB4Oyc7XG5cdFx0XG5cdFx0Y29uc3QgYWRkQnV0dG9uID0gbmV3IFNldHRpbmcoYnV0dG9uRWwpXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBcblx0XHRcdFx0YnV0dG9uXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJysgQWRkIEN1c3RvbSBDb21tYW5kJylcblx0XHRcdFx0XHQuc2V0Q3RhKClcblx0XHRcdFx0XHQub25DbGljaygoKSA9PiB0aGlzLnNob3dBZGRDb21tYW5kRGlhbG9nKCkpXG5cdFx0XHQpO1xuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIGNvbW1hbmRzIGxpc3Rcblx0XHRjb25zdCBleGlzdGluZ0xpc3QgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZHMtbGlzdCcpO1xuXHRcdGlmIChleGlzdGluZ0xpc3QpIGV4aXN0aW5nTGlzdC5yZW1vdmUoKTtcblxuXHRcdGNvbnN0IGNvbW1hbmRzTGlzdCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWxpc3QnIH0pO1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgfHwgW107XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRjb25zdCBlbXB0eUVsID0gY29tbWFuZHNMaXN0LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZHMtZW1wdHknIH0pO1xuXHRcdFx0ZW1wdHlFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmc6IDI0cHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcIj5cblx0XHRcdFx0XHQ8cD5ObyBjdXN0b20gY29tbWFuZHMgeWV0LjwvcD5cblx0XHRcdFx0XHQ8cCBzdHlsZT1cImZvbnQtc2l6ZTogMC45ZW07XCI+Q3JlYXRlIHlvdXIgZmlyc3QgY29tbWFuZCB0byBnZXQgc3RhcnRlZCE8L3A+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKChjb21tYW5kLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgY29tbWFuZEVsID0gY29tbWFuZHNMaXN0LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pdGVtJyB9KTtcblx0XHRcdGNvbW1hbmRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdFx0cGFkZGluZzogMTZweDtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogMTJweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIENvbW1hbmQgaGVhZGVyXG5cdFx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaGVhZGVyJyB9KTtcblx0XHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogZmxleC1zdGFydDsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cblx0XHRcdGNvbnN0IGluZm9FbCA9IGhlYWRlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pbmZvJyB9KTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1uYW1lJyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA2MDA7IG1hcmdpbi1ib3R0b206IDRweDsnO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpbmZvRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLmlubmVySFRNTCA9IGA8Y29kZT46JHtjb21tYW5kLnRyaWdnZXJ9PC9jb2RlPmA7XG5cdFx0XHR0cmlnZ2VyRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgZm9udC1zaXplOiAwLjllbTsnO1xuXG5cdFx0XHQvLyBBY3Rpb25zXG5cdFx0XHRjb25zdCBhY3Rpb25zRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtYWN0aW9ucycgfSk7XG5cdFx0XHRhY3Rpb25zRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBnYXA6IDhweDsnO1xuXG5cdFx0XHRjb25zdCBlZGl0QnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdFZGl0JyB9KTtcblx0XHRcdGVkaXRCdG4uc3R5bGUuY3NzVGV4dCA9ICdwYWRkaW5nOiA0cHggOHB4OyBmb250LXNpemU6IDAuOGVtOyBib3JkZXItcmFkaXVzOiA0cHg7Jztcblx0XHRcdGVkaXRCdG4ub25jbGljayA9ICgpID0+IHRoaXMuc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4KTtcblxuXHRcdFx0Y29uc3QgZGVsZXRlQnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdEZWxldGUnIH0pO1xuXHRcdFx0ZGVsZXRlQnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnO1xuXHRcdFx0ZGVsZXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmRlbGV0ZUNvbW1hbmQoaW5kZXgpO1xuXG5cdFx0XHQvLyBEZXNjcmlwdGlvbiBhbmQgdGVtcGxhdGUgcHJldmlld1xuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdFx0ZGVzY0VsLnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtOyBtYXJnaW4tYm90dG9tOiA4cHg7Jztcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdGVtcGxhdGVFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtdGVtcGxhdGUnIH0pO1xuXHRcdFx0dGVtcGxhdGVFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgcGFkZGluZzogOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7IGZvbnQtc2l6ZTogMC44ZW07IHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsgbWF4LWhlaWdodDogNjBweDsgb3ZlcmZsb3cteTogYXV0bztcIj5cblx0XHRcdFx0XHQke2NvbW1hbmQudGVtcGxhdGV9XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0FkZENvbW1hbmREaWFsb2coKSB7XG5cdFx0dGhpcy5zaG93Q29tbWFuZERpYWxvZygpO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93RWRpdENvbW1hbmREaWFsb2coaW5kZXg6IG51bWJlcikge1xuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uW2luZGV4XTtcblx0XHRpZiAoY29tbWFuZCkge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZERpYWxvZyhjb21tYW5kLCBpbmRleCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZERpYWxvZyhleGlzdGluZ0NvbW1hbmQ/OiBDdXN0b21Db21tYW5kLCBlZGl0SW5kZXg/OiBudW1iZXIpIHtcblx0XHQvLyBGb3Igbm93LCB1c2UgYSBzaW1wbGUgcHJvbXB0LWJhc2VkIGFwcHJvYWNoXG5cdFx0Ly8gVE9ETzogSW1wbGVtZW50IHByb3BlciBtb2RhbCB3aGVuIE1vZGFsIGNsYXNzIGlzIHByb3Blcmx5IGF2YWlsYWJsZVxuXHRcdGNvbnN0IG5hbWUgPSBwcm9tcHQoJ0NvbW1hbmQgbmFtZTonLCBleGlzdGluZ0NvbW1hbmQ/Lm5hbWUgfHwgJycpO1xuXHRcdGlmICghbmFtZSkgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IHRyaWdnZXIgPSBwcm9tcHQoJ0NvbW1hbmQgdHJpZ2dlciAod2l0aG91dCA6KTonLCBleGlzdGluZ0NvbW1hbmQ/LnRyaWdnZXIgfHwgJycpO1xuXHRcdGlmICghdHJpZ2dlcikgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IGRlc2NyaXB0aW9uID0gcHJvbXB0KCdEZXNjcmlwdGlvbiAob3B0aW9uYWwpOicsIGV4aXN0aW5nQ29tbWFuZD8uZGVzY3JpcHRpb24gfHwgJycpO1xuXHRcdFxuXHRcdGNvbnN0IHRlbXBsYXRlID0gcHJvbXB0KCdUZW1wbGF0ZSBjb250ZW50OicsIGV4aXN0aW5nQ29tbWFuZD8udGVtcGxhdGUgfHwgJycpO1xuXHRcdGlmICghdGVtcGxhdGUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCByZXN1bHQ6IEN1c3RvbUNvbW1hbmQgPSB7XG5cdFx0XHRpZDogZXhpc3RpbmdDb21tYW5kPy5pZCB8fCAoJ2NtZF8nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpKSxcblx0XHRcdG5hbWUsXG5cdFx0XHR0cmlnZ2VyOiB0cmlnZ2VyLnRvTG93ZXJDYXNlKCksXG5cdFx0XHR0ZW1wbGF0ZSxcblx0XHRcdGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCB1bmRlZmluZWRcblx0XHR9O1xuXHRcdFxuXHRcdGlmIChlZGl0SW5kZXggIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0Ly8gRWRpdCBleGlzdGluZyBjb21tYW5kXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyA9IFtdO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbZWRpdEluZGV4XSA9IHJlc3VsdDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gQWRkIG5ldyBjb21tYW5kXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyA9IFtdO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMucHVzaChyZXN1bHQpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdCh0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmQtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50KTtcblx0fVxuXG5cdHByaXZhdGUgZGVsZXRlQ29tbWFuZChpbmRleDogbnVtYmVyKSB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kc1tpbmRleF07XG5cdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybShgRGVsZXRlIGNvbW1hbmQgXCIke2NvbW1hbmQubmFtZX1cIiAoJHtjb21tYW5kLnRyaWdnZXJ9KT9gKTtcblx0XHRcblx0XHRpZiAoY29uZmlybWVkKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdCh0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmQtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50KTtcblx0XHR9XG5cdH1cbn0iLCAiaW1wb3J0IHsgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyLCBQcm92aWRlclR5cGUsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgQUlQcm92aWRlclNldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDbGF1ZGVQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2NsYXVkZSc7XG5pbXBvcnQgeyBPcGVuQUlQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL29wZW5haSc7XG5pbXBvcnQgeyBHb29nbGVQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2dvb2dsZSc7XG5pbXBvcnQgeyBPbGxhbWFQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL29sbGFtYSc7XG5pbXBvcnQgeyBOb3ZhU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4uL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgQUlQcm92aWRlck1hbmFnZXIge1xuXHRwcml2YXRlIHByb3ZpZGVyczogTWFwPFByb3ZpZGVyVHlwZSwgQUlQcm92aWRlcj4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc2V0dGluZ3M6IE5vdmFTZXR0aW5ncztcblx0cHJpdmF0ZSBmZWF0dXJlTWFuYWdlcj86IEZlYXR1cmVNYW5hZ2VyO1xuXG5cdGNvbnN0cnVjdG9yKHNldHRpbmdzOiBOb3ZhU2V0dGluZ3MsIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXIpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdFx0dGhpcy5mZWF0dXJlTWFuYWdlciA9IGZlYXR1cmVNYW5hZ2VyO1xuXHR9XG5cblx0YXN5bmMgaW5pdGlhbGl6ZSgpIHtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2NsYXVkZScsIG5ldyBDbGF1ZGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb3BlbmFpJywgbmV3IE9wZW5BSVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdnb29nbGUnLCBuZXcgR29vZ2xlUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ29sbGFtYScsIG5ldyBPbGxhbWFQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYSkpO1xuXHR9XG5cblx0dXBkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IE5vdmFTZXR0aW5ncykge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLnByb3ZpZGVycy5mb3JFYWNoKChwcm92aWRlciwgdHlwZSkgPT4ge1xuXHRcdFx0aWYgKHR5cGUgIT09ICdub25lJyAmJiB0eXBlIGluIHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMpIHtcblx0XHRcdFx0cHJvdmlkZXIudXBkYXRlQ29uZmlnPy4odGhpcy5zZXR0aW5ncy5haVByb3ZpZGVyc1t0eXBlIGFzIGtleW9mIEFJUHJvdmlkZXJTZXR0aW5nc10pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRQbGF0Zm9ybVByb3ZpZGVycygpOiBQcm92aWRlclR5cGVbXSB7XG5cdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdGNvbnN0IHBsYXRmb3JtU2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dO1xuXHRcdGNvbnN0IHByb3ZpZGVycyA9IFtwbGF0Zm9ybVNldHRpbmdzLnByaW1hcnlQcm92aWRlciwgLi4ucGxhdGZvcm1TZXR0aW5ncy5mYWxsYmFja1Byb3ZpZGVyc107XG5cdFx0XG5cdFx0Ly8gTm8gcmVzdHJpY3Rpb25zIC0gYWxsIHVzZXJzIGNhbiB1c2UgYWxsIHByb3ZpZGVycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHRcdHJldHVybiBwcm92aWRlcnM7XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTogUHJvbWlzZTxBSVByb3ZpZGVyIHwgbnVsbD4ge1xuXHRcdGNvbnN0IG9yZGVyZWRQcm92aWRlcnMgPSB0aGlzLmdldFBsYXRmb3JtUHJvdmlkZXJzKCk7XG5cdFx0XG5cdFx0Ly8gSWYgcHJpbWFyeSBwcm92aWRlciBpcyAnbm9uZScsIE5vdmEgaXMgZGlzYWJsZWQgb24gdGhpcyBwbGF0Zm9ybVxuXHRcdGlmIChvcmRlcmVkUHJvdmlkZXJzWzBdID09PSAnbm9uZScpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBvcmRlcmVkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRcdGlmIChwcm92aWRlciAmJiBhd2FpdCBwcm92aWRlci5pc0F2YWlsYWJsZSgpKSB7XG5cdFx0XHRcdHJldHVybiBwcm92aWRlcjtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlci5nZW5lcmF0ZVRleHQocHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0eWllbGQqIHByb3ZpZGVyLmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHR5aWVsZCogcHJvdmlkZXIuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0Z2V0UHJvdmlkZXJOYW1lcygpOiBzdHJpbmdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5wcm92aWRlcnMudmFsdWVzKCkpLm1hcChwID0+IHAubmFtZSk7XG5cdH1cblxuXHRhc3luYyBnZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0cmV0dXJuIHByb3ZpZGVyID8gcHJvdmlkZXIubmFtZSA6ICdOb25lJztcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlci5jb21wbGV0ZShzeXN0ZW1Qcm9tcHQsIHVzZXJQcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0Z2V0QWxsb3dlZFByb3ZpZGVycygpOiBQcm92aWRlclR5cGVbXSB7XG5cdFx0Ly8gQWxsIHByb3ZpZGVycyBhcmUgYWxsb3dlZCBmb3IgYWxsIHVzZXJzXG5cdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ107XG5cdH1cblxuXHRpc1Byb3ZpZGVyQWxsb3dlZChwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IGJvb2xlYW4ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGFsbG93ZWRcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGdldFByb3ZpZGVyTGltaXRzKCk6IHsgbG9jYWw6IG51bWJlcjsgY2xvdWQ6IG51bWJlciB9IHtcblx0XHQvLyBObyBsaW1pdHMgaW4gdGhlIENhdGFseXN0IG1vZGVsXG5cdFx0cmV0dXJuIHsgbG9jYWw6IEluZmluaXR5LCBjbG91ZDogSW5maW5pdHkgfTtcblx0fVxuXG5cdGNsZWFudXAoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuY2xlYXIoKTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQ2xhdWRlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdDbGF1ZGUgKEFudGhyb3BpYyknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlID09PSAnYXNzaXN0YW50JyA/ICdhc3Npc3RhbnQnIDogJ3VzZXInLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2xhdWRlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEuY29udGVudFswXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJywge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCd4LWFwaS1rZXknOiB0aGlzLmNvbmZpZy5hcGlLZXksXG5cdFx0XHRcdCdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdjbGF1ZGUtMy1oYWlrdS0yMDI0MDMwNycsXG5cdFx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0c3lzdGVtOiBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnYXNzaXN0YW50JyA6ICd1c2VyJyxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSlcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENsYXVkZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG5cdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLnR5cGUgPT09ICdjb250ZW50X2Jsb2NrX2RlbHRhJyAmJiBwYXJzZWQuZGVsdGE/LnRleHQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHBhcnNlZC5kZWx0YS50ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPcGVuQUlQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ09wZW5BSSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjdcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXHRcdGxldCBidWZmZXIgPSAnJztcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0Y29uc3QgbGluZXMgPSBidWZmZXIuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJztcblxuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGF0YSA9IGxpbmUuc2xpY2UoNik7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YSA9PT0gJ1tET05FXScpIHtcblx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBwYXJzZWQuY2hvaWNlcz8uWzBdPy5kZWx0YT8uY29udGVudDtcblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdvb2dsZVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnR29vZ2xlIChHZW1pbmkpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgc3lzdGVtUHJvbXB0Pzogc3RyaW5nKTogYW55IHtcblx0XHRjb25zdCBjb250ZW50cyA9IFtdO1xuXHRcdFxuXHRcdGlmIChzeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlOiAndXNlcicsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBgU3lzdGVtOiAke3N5c3RlbVByb21wdH1gIH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgbWVzc2FnZXMpIHtcblx0XHRcdGNvbnN0IHJvbGUgPSBtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ21vZGVsJyA6ICd1c2VyJztcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogbWVzc2FnZS5jb250ZW50IH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29udGVudHM7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdHb29nbGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS1wcm8nO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRcdGdlbmVyYXRpb25Db25maWc6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktcHJvJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzLCBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGV4dCA9IHBhcnNlZC5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XG5cdFx0XHRcdFx0XHRcdGlmICh0ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiB0ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPbGxhbWFQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ09sbGFtYSAoTG9jYWwpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLm1vZGVsKSByZXR1cm4gZmFsc2U7IC8vIFJlcXVpcmUgbW9kZWwgdG8gYmUgc2V0XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL3RhZ3NgLCB7XG5cdFx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiByZXNwb25zZS5vaztcblx0XHR9IGNhdGNoIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2dlbmVyYXRlYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdHByb21wdCxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5yZXNwb25zZTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5yZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogcGFyc2VkLnJlc3BvbnNlLCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2NoYXRgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSksXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEubWVzc2FnZS5jb250ZW50O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9jaGF0YCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpLFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5tZXNzYWdlPy5jb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQubWVzc2FnZS5jb250ZW50LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlLCBOb3RpY2UsIE1hcmtkb3duVmlldywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS90eXBlcyc7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3dpa2lsaW5rLXN1Z2dlc3QnO1xuaW1wb3J0IHsgTXVsdGlEb2NDb250ZXh0SGFuZGxlciwgTXVsdGlEb2NDb250ZXh0IH0gZnJvbSAnLi4vY29yZS9tdWx0aS1kb2MtY29udGV4dCc7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSID0gJ25vdmEtc2lkZWJhcic7XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2lkZWJhclZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaW5wdXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0ZXh0QXJlYSE6IFRleHRBcmVhQ29tcG9uZW50O1xuXHRwcml2YXRlIHNlbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgY29tbWFuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0cHJpdmF0ZSBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBjb21tYW5kUGlja2VyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY29tbWFuZFBpY2tlckl0ZW1zOiBIVE1MRWxlbWVudFtdID0gW107XG5cdHByaXZhdGUgc2VsZWN0ZWRDb21tYW5kSW5kZXg6IG51bWJlciA9IC0xO1xuXHRwcml2YXRlIGNvbW1hbmRNZW51ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaXNDb21tYW5kTWVudVZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBhdXRvR3Jvd1RleHRhcmVhITogKCkgPT4gdm9pZDtcblx0cHJpdmF0ZSB3aWtpbGlua0F1dG9jb21wbGV0ZSE6IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZTtcblx0cHJpdmF0ZSBjb250ZXh0UHJldmlldyE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIG11bHRpRG9jSGFuZGxlciE6IE11bHRpRG9jQ29udGV4dEhhbmRsZXI7XG5cdHByaXZhdGUgY29udGV4dEluZGljYXRvciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGN1cnJlbnRDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XG5cdC8vIEV2ZW50IGxpc3RlbmVyIGNsZWFudXAgdHJhY2tpbmdcblx0cHJpdmF0ZSBkb2N1bWVudEV2ZW50TGlzdGVuZXJzOiBBcnJheTx7ZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXJ9PiA9IFtdO1xuXHRwcml2YXRlIHRpbWVvdXRzOiBOb2RlSlMuVGltZW91dFtdID0gW107XG5cblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIobGVhZik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIgPSBuZXcgTXVsdGlEb2NDb250ZXh0SGFuZGxlcih0aGlzLmFwcCk7XG5cdH1cblxuXHRnZXRWaWV3VHlwZSgpIHtcblx0XHRyZXR1cm4gVklFV19UWVBFX05PVkFfU0lERUJBUjtcblx0fVxuXG5cdGdldERpc3BsYXlUZXh0KCkge1xuXHRcdHJldHVybiAnTm92YSBBSSc7XG5cdH1cblxuXHRnZXRJY29uKCkge1xuXHRcdHJldHVybiAnbm92YS1zdGFyJztcblx0fVxuXG5cdGFzeW5jIG9uT3BlbigpIHtcblx0XHRjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNoaWxkcmVuWzFdIGFzIEhUTUxFbGVtZW50O1xuXHRcdGNvbnRhaW5lci5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbm92YS1zaWRlYmFyLWNvbnRhaW5lcicpO1xuXG5cdFx0Ly8gTW9iaWxlIGFjY2VzcyBpcyBub3cgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB3cmFwcGVyIHdpdGggcHJvcGVyIGZsZXggbGF5b3V0XG5cdFx0Y29uc3Qgd3JhcHBlckVsID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtd3JhcHBlcicgfSk7XG5cdFx0d3JhcHBlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGhlaWdodDogMTAwJTtcblx0XHRcdG92ZXJmbG93OiBoaWRkZW47XG5cdFx0XHRwYWRkaW5nLWJvdHRvbTogJHtQbGF0Zm9ybS5pc0Rlc2t0b3BBcHAgPyAnMjVweCcgOiAnMCd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyIHdpdGggcHJvdmlkZXIgaW5mb1xuXHRcdGNvbnN0IGhlYWRlckVsID0gd3JhcHBlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRwYWRkaW5nOiAxMHB4O1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gTGVmdCBzaWRlOiBUaXRsZSB3aXRoIE5vdmEgaWNvblxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDQnKTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmb250LXNpemU6IDEuMWVtOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdHRpdGxlRWwuaW5uZXJIVE1MID0gYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IDE4cHg7IGhlaWdodDogMThweDtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5Ob3ZhYDtcblx0XHRcblx0XHQvLyBSaWdodCBzaWRlOiBQcm92aWRlciBzdGF0dXMgYW5kIENsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IHJpZ2h0Q29udGFpbmVyID0gaGVhZGVyRWwuY3JlYXRlRGl2KCk7XG5cdFx0cmlnaHRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDhweDsnO1xuXHRcdFxuXHRcdC8vIEFsbCB1c2VycyBjYW4gc3dpdGNoIHByb3ZpZGVycyBmcmVlbHlcblx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyRHJvcGRvd24ocmlnaHRDb250YWluZXIpO1xuXHRcdFxuXHRcdC8vIENsZWFyIENoYXQgYnV0dG9uIGluIHJpZ2h0IGNvbnRhaW5lclxuXHRcdGNvbnN0IGNsZWFyQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChyaWdodENvbnRhaW5lcik7XG5cdFx0Y2xlYXJCdXR0b24uc2V0SWNvbignZXJhc2VyJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBjb252ZXJzYXRpb24gaGlzdG9yeScpXG5cdFx0XHQub25DbGljaygoKSA9PiB0aGlzLmNsZWFyQ2hhdCgpKTtcblxuXHRcdHRoaXMuY3JlYXRlQ2hhdEludGVyZmFjZSh3cmFwcGVyRWwpO1xuXHRcdHRoaXMuY3JlYXRlSW5wdXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHRcblx0XHQvLyBSZWdpc3RlciBldmVudCBsaXN0ZW5lciBmb3IgYWN0aXZlIGZpbGUgY2hhbmdlc1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdFx0XHR9KVxuXHRcdCk7XG5cdFx0XG5cdFx0Ly8gTG9hZCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuXHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0fVxuXG5cdGFzeW5jIG9uQ2xvc2UoKSB7XG5cdFx0Ly8gQ2xlYW4gdXAgcHJvdmlkZXIgZHJvcGRvd24gZXZlbnQgbGlzdGVuZXJcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8uY2xlYW51cCkge1xuXHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi5jbGVhbnVwKCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFuIHVwIHdpa2lsaW5rIGF1dG9jb21wbGV0ZVxuXHRcdGlmICh0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlKSB7XG5cdFx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlLmRlc3Ryb3koKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgdHJhY2tlZCBldmVudCBsaXN0ZW5lcnNcblx0XHR0aGlzLmNsZWFudXBFdmVudExpc3RlbmVycygpO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCB0aW1lb3V0c1xuXHRcdHRoaXMuY2xlYXJUaW1lb3V0cygpO1xuXHRcdFxuXHRcdC8vIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHRcdHRoaXMuY2xlYW51cERPTUVsZW1lbnRzKCk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGQgZXZlbnQgbGlzdGVuZXIgd2l0aCBhdXRvbWF0aWMgY2xlYW51cCB0cmFja2luZ1xuXHQgKi9cblx0cHJpdmF0ZSBhZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzLnB1c2goeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEFkZCB0aW1lb3V0IHdpdGggYXV0b21hdGljIGNsZWFudXAgdHJhY2tpbmdcblx0ICovXG5cdHByaXZhdGUgYWRkVHJhY2tlZFRpbWVvdXQoY2FsbGJhY2s6ICgpID0+IHZvaWQsIGRlbGF5OiBudW1iZXIpOiBOb2RlSlMuVGltZW91dCB7XG5cdFx0Y29uc3QgaWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGNhbGxiYWNrKCk7XG5cdFx0XHR0aGlzLnRpbWVvdXRzID0gdGhpcy50aW1lb3V0cy5maWx0ZXIodCA9PiB0ICE9PSBpZCk7XG5cdFx0fSwgZGVsYXkpO1xuXHRcdHRoaXMudGltZW91dHMucHVzaChpZCk7XG5cdFx0cmV0dXJuIGlkO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ2xlYW4gdXAgYWxsIHRyYWNrZWQgZXZlbnQgbGlzdGVuZXJzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFudXBFdmVudExpc3RlbmVycygpOiB2b2lkIHtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KSA9PiB7XG5cdFx0XHRlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdH0pO1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycyA9IFtdO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ2xlYXIgYWxsIHRyYWNrZWQgdGltZW91dHNcblx0ICovXG5cdHByaXZhdGUgY2xlYXJUaW1lb3V0cygpOiB2b2lkIHtcblx0XHR0aGlzLnRpbWVvdXRzLmZvckVhY2goaWQgPT4gY2xlYXJUaW1lb3V0KGlkKSk7XG5cdFx0dGhpcy50aW1lb3V0cyA9IFtdO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ2xlYW4gdXAgRE9NIGVsZW1lbnRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFudXBET01FbGVtZW50cygpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5yZW1vdmUoKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnJlbW92ZSgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2hhdEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY2hhdC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRwYWRkaW5nOiAxMHB4O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRnYXA6IDhweDtcblx0XHRgO1xuXG5cdFx0Ly8gV2VsY29tZSBtZXNzYWdlIHdpdGggTm92YSBicmFuZGluZ1xuXHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlSW5wdXRJbnRlcmZhY2UoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMuaW5wdXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuaW5wdXRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0Z2FwOiA4cHg7XG5cdFx0XHRwYWRkaW5nOiAxMHB4O1xuXHRcdFx0Ym9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHQvLyBTaW1wbGlmaWVkIGlucHV0IHJvdyB3aXRoIGp1c3QgdGV4dGFyZWEgYW5kIHNlbmQgYnV0dG9uXG5cdFx0Y29uc3QgaW5wdXRSb3cgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtcm93JyB9KTtcblx0XHRpbnB1dFJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDhweDtcblx0XHRgO1xuXG5cdFx0Ly8gVGV4dCBhcmVhIHRha2VzIG1vc3Qgc3BhY2Vcblx0XHRjb25zdCB0ZXh0QXJlYUNvbnRhaW5lciA9IGlucHV0Um93LmNyZWF0ZURpdigpO1xuXHRcdHRleHRBcmVhQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZmxleDogMTsgcG9zaXRpb246IHJlbGF0aXZlOyc7XG5cdFx0dGhpcy50ZXh0QXJlYSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudCh0ZXh0QXJlYUNvbnRhaW5lcik7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRQbGFjZWhvbGRlcignQXNrIE5vdmEgdG8gaGVscCBlZGl0IHlvdXIgZG9jdW1lbnQuLi4nKTtcblx0XHRcblx0XHQvLyBQbGF0Zm9ybS1hd2FyZSBkZWZhdWx0cyBhbmQgYXV0by1ncm93aW5nIHNldHVwXG5cdFx0Y29uc3QgbGluZUhlaWdodCA9IDEuNTsgLy8gZW0gdW5pdHNcblx0XHRjb25zdCBwYWRkaW5nVmVydGljYWwgPSAyMDsgLy8gcHggKDEwcHggdG9wICsgMTBweCBib3R0b20pXG5cdFx0Y29uc3QgYm9yZGVyV2lkdGggPSAyOyAvLyBweCAoMXB4IHRvcCArIDFweCBib3R0b20pXG5cdFx0Y29uc3QgYmFzZUxpbmVzID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAyIDogMztcblx0XHRjb25zdCBtYXhMaW5lcyA9IFBsYXRmb3JtLmlzTW9iaWxlID8gOCA6IDY7XG5cdFx0XG5cdFx0Ly8gQ2FsY3VsYXRlIGluaXRpYWwgaGVpZ2h0IGJhc2VkIG9uIHBsYXRmb3JtXG5cdFx0Y29uc3QgZm9udFNpemUgPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKCctLWZvbnQtdGV4dC1zaXplJykgfHwgJzE0cHgnKTtcblx0XHRjb25zdCBpbml0aWFsSGVpZ2h0ID0gKGJhc2VMaW5lcyAqIGxpbmVIZWlnaHQgKiBmb250U2l6ZSkgKyBwYWRkaW5nVmVydGljYWwgKyBib3JkZXJXaWR0aDtcblx0XHRcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0bWluLWhlaWdodDogJHtpbml0aWFsSGVpZ2h0fXB4O1xuXHRcdFx0bWF4LWhlaWdodDogJHsobWF4TGluZXMgKiBsaW5lSGVpZ2h0ICogZm9udFNpemUpICsgcGFkZGluZ1ZlcnRpY2FsICsgYm9yZGVyV2lkdGh9cHg7XG5cdFx0XHRoZWlnaHQ6ICR7aW5pdGlhbEhlaWdodH1weDtcblx0XHRcdHJlc2l6ZTogbm9uZTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdHBhZGRpbmc6IDEwcHg7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdGV4dC1zaXplKTtcblx0XHRcdGxpbmUtaGVpZ2h0OiAke2xpbmVIZWlnaHR9O1xuXHRcdFx0b3ZlcmZsb3cteTogaGlkZGVuO1xuXHRcdFx0dHJhbnNpdGlvbjogaGVpZ2h0IDAuMXMgZWFzZS1vdXQ7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBdXRvLWdyb3cgZnVuY3Rpb25hbGl0eVxuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSA9ICgpID0+IHtcblx0XHRcdGNvbnN0IGVsID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsO1xuXHRcdFx0XG5cdFx0XHQvLyBSZXNldCBoZWlnaHQgdG8gYXV0byB0byBnZXQgdGhlIGNvcnJlY3Qgc2Nyb2xsSGVpZ2h0XG5cdFx0XHRlbC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG5cdFx0XHRcblx0XHRcdC8vIENhbGN1bGF0ZSBuZXcgaGVpZ2h0IGJhc2VkIG9uIGNvbnRlbnRcblx0XHRcdGNvbnN0IGNvbnRlbnRIZWlnaHQgPSBlbC5zY3JvbGxIZWlnaHQ7XG5cdFx0XHRjb25zdCBtaW5IZWlnaHQgPSBpbml0aWFsSGVpZ2h0O1xuXHRcdFx0Y29uc3QgbWF4SGVpZ2h0ID0gKG1heExpbmVzICogbGluZUhlaWdodCAqIGZvbnRTaXplKSArIHBhZGRpbmdWZXJ0aWNhbCArIGJvcmRlcldpZHRoO1xuXHRcdFx0XG5cdFx0XHQvLyBDbGFtcCBoZWlnaHQgYmV0d2VlbiBtaW4gYW5kIG1heFxuXHRcdFx0Y29uc3QgbmV3SGVpZ2h0ID0gTWF0aC5tYXgobWluSGVpZ2h0LCBNYXRoLm1pbihjb250ZW50SGVpZ2h0LCBtYXhIZWlnaHQpKTtcblx0XHRcdFxuXHRcdFx0Ly8gQXBwbHkgbmV3IGhlaWdodFxuXHRcdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gYCR7bmV3SGVpZ2h0fXB4YDtcblx0XHRcdFxuXHRcdFx0Ly8gU2hvdyBzY3JvbGxiYXIgb25seSB3aGVuIGNvbnRlbnQgZXhjZWVkcyBtYXggaGVpZ2h0XG5cdFx0XHRlbC5zdHlsZS5vdmVyZmxvd1kgPSBjb250ZW50SGVpZ2h0ID4gbWF4SGVpZ2h0ID8gJ2F1dG8nIDogJ2hpZGRlbic7XG5cdFx0fTtcblx0XHRcblx0XHQvLyBBZGQgaW5wdXQgZXZlbnQgbGlzdGVuZXIgZm9yIGF1dG8tZ3Jvd1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHRoaXMuYXV0b0dyb3dUZXh0YXJlYSk7XG5cdFx0XG5cdFx0Ly8gQWxzbyB0cmlnZ2VyIG9uIGluaXRpYWwgbG9hZCBhbmQgd2hlbiB2YWx1ZSBjaGFuZ2VzIHByb2dyYW1tYXRpY2FsbHlcblx0XHRzZXRUaW1lb3V0KHRoaXMuYXV0b0dyb3dUZXh0YXJlYSwgMCk7XG5cdFx0XG5cdFx0Ly8gSW5pdGlhbGl6ZSB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlID0gbmV3IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSh0aGlzLmFwcCwgdGhpcy50ZXh0QXJlYS5pbnB1dEVsKTtcblx0XHRcblx0XHQvLyBBZGQgcmVhbC10aW1lIGNvbnRleHQgcHJldmlld1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcblx0XHRcdHRoaXMudXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk7XG5cdFx0fSk7XG5cblx0XHQvLyBDb21tYW5kIGJ1dHRvbiAobGlnaHRuaW5nKSAtIGNvbmRpdGlvbmFsbHkgc2hvd25cblx0XHR0aGlzLmNvbW1hbmRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Um93KTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uc2V0SWNvbignemFwJyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldFRvb2x0aXAoJ0NvbW1hbmRzJyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy50b2dnbGVDb21tYW5kTWVudSgpKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiAzNnB4O1xuXHRcdFx0aGVpZ2h0OiAzNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogJHt0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kLWJ1dHRvbicpID8gJ2ZsZXgnIDogJ25vbmUnfTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdGA7XG5cblx0XHQvLyBTZW5kIGJ1dHRvbiB2ZXJ0aWNhbGx5IGNlbnRlcmVkXG5cdFx0dGhpcy5zZW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEljb24oJ3NlbmQnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0VG9vbHRpcCgnU2VuZCBtZXNzYWdlJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEN0YSgpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuaGFuZGxlU2VuZCgpKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiAzNnB4O1xuXHRcdFx0aGVpZ2h0OiAzNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXG5cdFx0Ly8gRW50ZXIga2V5IGhhbmRsaW5nIGFuZCBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInICYmICFldmVudC5zaGlmdEtleSkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR0aGlzLmhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKSB8fCB0aGlzLmhhbmRsZVNlbmQoKTtcblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicgfHwgZXZlbnQua2V5ID09PSAnQXJyb3dVcCcpIHtcblx0XHRcdFx0aWYgKHRoaXMuaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR0aGlzLm5hdmlnYXRlQ29tbWFuZFBpY2tlcihldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nID8gMSA6IC0xKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSW5wdXQgY2hhbmdlIGhhbmRsaW5nIGZvciBjb21tYW5kIHBpY2tlciAoYWxyZWFkeSBoYXMgYXV0b0dyb3cgbGlzdGVuZXIpXG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuXHRcdFx0dGhpcy5oYW5kbGVJbnB1dENoYW5nZSgpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgcGlja2VyXG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kUGlja2VyKCk7XG5cblx0XHQvLyBDcmVhdGUgY29tbWFuZCBtZW51XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kTWVudSgpO1xuXG5cdFx0Ly8gQ3JlYXRlIGNvbnRleHQgaW5kaWNhdG9yIGFuZCBwcmV2aWV3XG5cdFx0dGhpcy5jcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0dGhpcy5jb250ZXh0UHJldmlldyA9IHRoaXMuY3JlYXRlQ29udGV4dFByZXZpZXcoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IDEwcHg7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdG1heC13aWR0aDogODUlO1xuXHRcdFx0JHtyb2xlID09PSAndXNlcicgXG5cdFx0XHRcdD8gJ21hcmdpbi1sZWZ0OiBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpOycgXG5cdFx0XHRcdDogcm9sZSA9PT0gJ3N5c3RlbSdcblx0XHRcdFx0PyAnbWFyZ2luOiAwIGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IHRleHQtYWxpZ246IGNlbnRlcjsgZm9udC1zaXplOiAwLjllbTsnXG5cdFx0XHRcdDogJ2JhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsnXG5cdFx0XHR9XG5cdFx0YDtcblxuXHRcdGNvbnN0IHJvbGVFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBcblx0XHRcdHRleHQ6IHJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogcm9sZSA9PT0gJ3N5c3RlbScgPyAnU3lzdGVtJyA6ICdOb3ZhJyxcblx0XHRcdGNsczogJ25vdmEtbWVzc2FnZS1yb2xlJ1xuXHRcdH0pO1xuXHRcdHJvbGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdG9wYWNpdHk6IDAuNztcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0Ly8gVXNlIGlubmVySFRNTCBmb3Igc3lzdGVtIG1lc3NhZ2VzIHRvIHN1cHBvcnQgaWNvbnMsIHRleHRDb250ZW50IGZvciBvdGhlcnMgZm9yIHNlY3VyaXR5XG5cdFx0aWYgKHJvbGUgPT09ICdzeXN0ZW0nICYmIGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tIHdpdGggc21vb3RoIGFuaW1hdGlvblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZykge1xuXHRcdGNvbnN0IHdlbGNvbWVFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUnIH0pO1xuXHRcdHdlbGNvbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDEycHg7XG5cdFx0XHRtYXJnaW46IDE2cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDE2cHggMjBweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxOHB4O1xuXHRcdFx0bWF4LXdpZHRoOiA5MCU7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjVzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBOb3ZhIHN0YXIgaWNvbiAoc3RhdGljLCBub3QgYW5pbWF0ZWQpXG5cdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUtaWNvbicgfSk7XG5cdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0d2lkdGg6IDMycHg7XG5cdFx0XHRoZWlnaHQ6IDMycHg7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdGljb25Db250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0PHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogMzJweDsgaGVpZ2h0OiAzMnB4OyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPlxuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gV2VsY29tZSB0ZXh0XG5cdFx0Y29uc3QgdGV4dENvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSB0ZXh0Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6ICdXZWxjb21lIHRvIE5vdmEnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXRleHQtc2l6ZSk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdWJ0aXRsZUVsID0gdGV4dENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBtZXNzYWdlIHx8ICdZb3VyIEFJIHRoaW5raW5nIHBhcnRuZXIuIEFzayBtZSB0byBoZWxwIGVkaXQgeW91ciBkb2N1bWVudCEnIH0pO1xuXHRcdHN1YnRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGZvbnQtc2l6ZTogMC45ZW07XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3VjY2Vzc0luZGljYXRvcihhY3Rpb246IHN0cmluZykge1xuXHRcdGNvbnN0IGluZGljYXRvckVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VjY2Vzcy1pbmRpY2F0b3InIH0pO1xuXHRcdGluZGljYXRvckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0bWFyZ2luOiA4cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDZweCAxMnB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSg3NiwgMTc1LCA4MCwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoNzYsIDE3NSwgODAsIDAuMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdG1heC13aWR0aDogMjAwcHg7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjNzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBZGQgY2hlY2ttYXJrIGFuZCB0ZXh0XG5cdFx0aW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBzdHlsZT1cIndpZHRoOiAxMnB4OyBoZWlnaHQ6IDEycHg7IG1hcmdpbi1yaWdodDogNnB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyO1wiPlxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwid2lkdGg6IDRweDsgaGVpZ2h0OiAycHg7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgd2hpdGU7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB3aGl0ZTsgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKSB0cmFuc2xhdGUoLTAuNXB4LCAtMC41cHgpO1wiPjwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQke3RoaXMuZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbil9XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRzd2l0Y2ggKGFjdGlvbikge1xuXHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGFkZGVkJztcblx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgZWRpdGVkJztcblx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBkZWxldGVkJztcblx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRyZXR1cm4gJ0dyYW1tYXIgZml4ZWQnO1xuXHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCByZXdyaXR0ZW4nO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuICdDb21tYW5kIGNvbXBsZXRlZCc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0Ly8gQ2hlY2sgaWYgY29tbWFuZCBzeXN0ZW0gZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kLXN5c3RlbScpKSB7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3phcCcsICdDb21tYW5kIHN5c3RlbSBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBDYXRhbHlzdCBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIFNlcHRlbWJlciAxNSwgMjAyNS4nKSk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kID0gbWVzc2FnZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgJzonIGFuZCBub3JtYWxpemVcblxuXHRcdC8vIFByb3ZpZGVyIHN3aXRjaGluZyBjb21tYW5kc1xuXHRcdGNvbnN0IHByb3ZpZGVyQ29tbWFuZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ2NsYXVkZScsXG5cdFx0XHQnY2hhdGdwdCc6ICdvcGVuYWknLFxuXHRcdFx0J29wZW5haSc6ICdvcGVuYWknLFxuXHRcdFx0J2dlbWluaSc6ICdnb29nbGUnLFxuXHRcdFx0J2dvb2dsZSc6ICdnb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdvbGxhbWEnXG5cdFx0fTtcblxuXHRcdGlmIChwcm92aWRlckNvbW1hbmRzW2NvbW1hbmRdKSB7XG5cdFx0XHRjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNldHRpbmdUYWIuc2V0Q3VycmVudFByb3ZpZGVyKHByb3ZpZGVySWQpO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJJZCl9YCkpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgZm9yIGN1c3RvbSBjb21tYW5kcyAoaWYgZmVhdHVyZSBlbmFibGVkKVxuXHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjdXN0b20tY29tbWFuZHMnKSkge1xuXHRcdFx0Y29uc3QgY3VzdG9tQ29tbWFuZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzPy5maW5kKGNtZCA9PiBjbWQudHJpZ2dlciA9PT0gY29tbWFuZCk7XG5cdFx0XHRpZiAoY3VzdG9tQ29tbWFuZCkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIGN1c3RvbSBjb21tYW5kXG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoY3VzdG9tQ29tbWFuZC50ZW1wbGF0ZSk7XG5cdFx0XHRcdC8vIFRyaWdnZXIgYXV0by1ncm93IGFmdGVyIHNldHRpbmcgdGVtcGxhdGVcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKSwgMCk7XG5cdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnZWRpdCcsIGBMb2FkZWQgdGVtcGxhdGU6ICR7Y3VzdG9tQ29tbWFuZC5uYW1lfWApKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gVW5rbm93biBjb21tYW5kXG5cdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdoZWxwLWNpcmNsZScsIGBVbmtub3duIGNvbW1hbmQgJzoke2NvbW1hbmR9Jy4gVHJ5IDpjbGF1ZGUsIDpjaGF0Z3B0LCA6Z2VtaW5pLCBvciA6b2xsYW1hYCkpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlcicgfSk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRib3gtc2hhZG93OiAwIC00cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlSW5wdXRDaGFuZ2UoKTogdm9pZCB7XG5cdFx0Y29uc3QgdmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XG5cdFx0aWYgKHZhbHVlLnN0YXJ0c1dpdGgoJzonKSAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kLXN5c3RlbScpKSB7XG5cdFx0XHRjb25zdCBxdWVyeSA9IHZhbHVlLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kUGlja2VyKHF1ZXJ5KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRQaWNrZXIocXVlcnk6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpLmZpbHRlcihjbWQgPT4gXG5cdFx0XHRjbWQudHJpZ2dlci50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSB8fCBjbWQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KVxuXHRcdCk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuZW1wdHkoKTtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblxuXHRcdGlmIChjb21tYW5kcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKChjb21tYW5kLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZFBpY2tlci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogOHB4O1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLnRleHRDb250ZW50ID0gYDoke2NvbW1hbmQudHJpZ2dlcn1gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0XHRwYWRkaW5nOiAycHggNnB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMC45ZW07XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLW5hbWUnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZmxleDogMTsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTsnO1xuXG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYycgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtc2l6ZTogMC44ZW07IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsnO1xuXHRcdFx0fVxuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNlbGVjdENvbW1hbmQoY29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2V0U2VsZWN0ZWRDb21tYW5kKGluZGV4KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHR9XG5cblx0cHJpdmF0ZSBoaWRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cdH1cblxuXHRwcml2YXRlIGlzQ29tbWFuZFBpY2tlclZpc2libGUoKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snO1xuXHR9XG5cblx0cHJpdmF0ZSBuYXZpZ2F0ZUNvbW1hbmRQaWNrZXIoZGlyZWN0aW9uOiBudW1iZXIpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cblx0XHRjb25zdCBuZXdJbmRleCA9IE1hdGgubWF4KDAsIE1hdGgubWluKFxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoIC0gMSxcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggKyBkaXJlY3Rpb25cblx0XHQpKTtcblxuXHRcdHRoaXMuc2V0U2VsZWN0ZWRDb21tYW5kKG5ld0luZGV4KTtcblx0fVxuXG5cdHByaXZhdGUgc2V0U2VsZWN0ZWRDb21tYW5kKGluZGV4OiBudW1iZXIpOiB2b2lkIHtcblx0XHQvLyBSZW1vdmUgcHJldmlvdXMgc2VsZWN0aW9uXG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMuZm9yRWFjaChpdGVtID0+IHtcblx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gaW5kZXg7XG5cblx0XHRpZiAoaW5kZXggPj0gMCAmJiBpbmRleCA8IHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCkge1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXNbaW5kZXhdLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uc2Nyb2xsSW50b1ZpZXcoeyBibG9jazogJ25lYXJlc3QnIH0pO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAoIXRoaXMuaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpIHx8IHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPT09IC0xKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRDb21tYW5kID0gY29tbWFuZHNbdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleF07XG5cdFx0XG5cdFx0aWYgKHNlbGVjdGVkQ29tbWFuZCkge1xuXHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKHNlbGVjdGVkQ29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZCh0cmlnZ2VyOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHQvLyBUcmlnZ2VyIHRoZSBjb21tYW5kIGltbWVkaWF0ZWx5XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGdldEF2YWlsYWJsZUNvbW1hbmRzKCk6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiB7XG5cdFx0Y29uc3QgY29tbWFuZHM6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiA9IFtcblx0XHRcdHsgdHJpZ2dlcjogJ2NsYXVkZScsIG5hbWU6ICdTd2l0Y2ggdG8gQ2xhdWRlJywgZGVzY3JpcHRpb246ICdBbnRocm9waWMgQ2xhdWRlIEFJJyB9LFxuXHRcdFx0eyB0cmlnZ2VyOiAnY2hhdGdwdCcsIG5hbWU6ICdTd2l0Y2ggdG8gQ2hhdEdQVCcsIGRlc2NyaXB0aW9uOiAnT3BlbkFJIEdQVCBtb2RlbHMnIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdnZW1pbmknLCBuYW1lOiAnU3dpdGNoIHRvIEdlbWluaScsIGRlc2NyaXB0aW9uOiAnR29vZ2xlIEdlbWluaSBBSScgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ29sbGFtYScsIG5hbWU6ICdTd2l0Y2ggdG8gT2xsYW1hJywgZGVzY3JpcHRpb246ICdMb2NhbCBBSSBtb2RlbHMnIH1cblx0XHRdO1xuXG5cdFx0Ly8gQWRkIGN1c3RvbSBjb21tYW5kcyBpZiBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY3VzdG9tLWNvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgfHwgW107XG5cdFx0XHRjdXN0b21Db21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRcdGNvbW1hbmRzLnB1c2goe1xuXHRcdFx0XHRcdHRyaWdnZXI6IGNtZC50cmlnZ2VyLFxuXHRcdFx0XHRcdG5hbWU6IGNtZC5uYW1lLFxuXHRcdFx0XHRcdC4uLihjbWQuZGVzY3JpcHRpb24gJiYgeyBkZXNjcmlwdGlvbjogY21kLmRlc2NyaXB0aW9uIH0pXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbW1hbmRzO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudScgfSk7XG5cdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWluLXdpZHRoOiAyNDBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDMwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cblx0XHQvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51LmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSAmJiBcblx0XHRcdFx0IXRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyKTtcblx0fVxuXG5cdHByaXZhdGUgdG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kLWJ1dHRvbicpKSB7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3phcCcsICdDb21tYW5kIGJ1dHRvbiBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBDYXRhbHlzdCBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUpIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCk7XG5cdFx0XG5cdFx0dGhpcy5jb21tYW5kTWVudS5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIEhlYWRlclxuXHRcdGNvbnN0IGhlYWRlckVsID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwYWRkaW5nOiAxMnB4IDE2cHg7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRcdGZvbnQtc2l6ZTogMC45ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdGA7XG5cdFx0aGVhZGVyRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd6YXAnKSArICcgQ29tbWFuZHMnO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdGNvbW1hbmRzLmZvckVhY2goY29tbWFuZCA9PiB7XG5cdFx0XHRjb25zdCBpdGVtID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1pdGVtJyB9KTtcblx0XHRcdGl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogMTJweCAxNnB4O1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRcdGdhcDogNHB4O1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LW5hbWUnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLnRleHRDb250ZW50ID0gYDoke2NvbW1hbmQudHJpZ2dlcn1gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0XHRvcGFjaXR5OiAwLjg7XG5cdFx0XHRgO1xuXG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWRlc2MnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0YDtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR9KTtcblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuXHRcdFx0fSk7XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZXhlY3V0ZUNvbW1hbmRGcm9tTWVudShjb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSB0cnVlO1xuXHR9XG5cblx0cHJpdmF0ZSBoaWRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgZXhlY3V0ZUNvbW1hbmRGcm9tTWVudSh0cmlnZ2VyOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdFxuXHRcdC8vIEV4ZWN1dGUgdGhlIGNvbW1hbmQgZGlyZWN0bHlcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0UHJldmlldygpOiBIVE1MRWxlbWVudCB7XG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHQvLyBSZXR1cm4gYSBkdW1teSBlbGVtZW50IHRoYXQgd29uJ3QgYmUgdXNlZFxuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhIHByZXZpZXcgYXJlYSB0aGF0IHNob3dzIGxpdmUgY29udGV4dCBhcyB1c2VyIHR5cGVzXG5cdFx0Y29uc3QgcHJldmlld0NvbnRhaW5lciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXcnIH0pO1xuXHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA0cHg7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdUZXh0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctdGV4dCcgfSk7XG5cdFx0cHJldmlld1RleHQuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArICcgQ29udGV4dCB3aWxsIGluY2x1ZGU6ICc7XG5cdFx0cHJldmlld1RleHQuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0UHJldmlldyB8fCAhdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0aWYgKCFtZXNzYWdlKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUGFyc2UgZG9jdW1lbnQgcmVmZXJlbmNlcyBmcm9tIGN1cnJlbnQgbWVzc2FnZVxuXHRcdC8vIE5vdGU6IEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRjb25zdCBmb3VuZFJlZnM6IEFycmF5PHtuYW1lOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nfT4gPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcblx0XHRcdFxuXHRcdFx0Ly8gVHJ5IHRvIGZpbmQgdGhlIGZpbGUgdG8gdmFsaWRhdGUgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZUJ5TmFtZShkb2NOYW1lKTtcblx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdGZvdW5kUmVmcy5wdXNoKHtcblx0XHRcdFx0XHRuYW1lOiBkb2NOYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHRcdGNvbnN0IHBlcnNpc3RlbnREb2NzID0gdGhpcy5tdWx0aURvY0hhbmRsZXIuZ2V0UGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZT8ucGF0aCB8fCAnJyk7XG5cdFx0cGVyc2lzdGVudERvY3MuZm9yRWFjaChkb2MgPT4ge1xuXHRcdFx0Ly8gT25seSBhZGQgaWYgbm90IGFscmVhZHkgaW4gZm91bmRSZWZzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcblx0XHRcdGNvbnN0IGV4aXN0cyA9IGZvdW5kUmVmcy5zb21lKHJlZiA9PiByZWYubmFtZSA9PT0gZG9jLmZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0aWYgKCFleGlzdHMpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvYy5maWxlLmJhc2VuYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5OiBkb2MucHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBVcGRhdGUgcHJldmlld1xuXHRcdGlmIChmb3VuZFJlZnMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgcHJldmlld0xpc3QgPSB0aGlzLmNvbnRleHRQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBmb3VuZFJlZnMubWFwKHJlZiA9PiB7XG5cdFx0XHRcdFx0Y29uc3Qgc3VmZml4ID0gcmVmLnByb3BlcnR5ID8gYCMke3JlZi5wcm9wZXJ0eX1gIDogJyc7XG5cdFx0XHRcdFx0cmV0dXJuIGAke3JlZi5uYW1lfSR7c3VmZml4fWA7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRwcmV2aWV3TGlzdC50ZXh0Q29udGVudCA9IGRvY05hbWVzLmpvaW4oJywgJyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBmaW5kRmlsZUJ5TmFtZShuYW1lT3JQYXRoOiBzdHJpbmcpOiBURmlsZSB8IG51bGwge1xuXHRcdC8vIEZpcnN0IHRyeSBleGFjdCBwYXRoIG1hdGNoXG5cdFx0bGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCk7XG5cdFx0XG5cdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0Ly8gVHJ5IHdpdGggLm1kIGV4dGVuc2lvblxuXHRcdFx0ZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoICsgJy5tZCcpO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBTZWFyY2ggYnkgYmFzZW5hbWVcblx0XHRcdGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXHRcdFx0ZmlsZSA9IGZpbGVzLmZpbmQoZiA9PiBcblx0XHRcdFx0Zi5iYXNlbmFtZSA9PT0gbmFtZU9yUGF0aCB8fCBcblx0XHRcdFx0Zi5uYW1lID09PSBuYW1lT3JQYXRoIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoKSB8fFxuXHRcdFx0XHRmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCArICcubWQnKVxuXHRcdFx0KSB8fCBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gZmlsZSA6IG51bGw7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IuZW1wdHkoKTtcblx0XHRcblx0XHRpZiAoIXRoaXMuY3VycmVudENvbnRleHQpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBhbGxEb2NzID0gdGhpcy5jdXJyZW50Q29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcblx0XHRpZiAoYWxsRG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFNob3cgYXMgdGhpbiBsaW5lIHdpdGggbW9iaWxlLW9wdGltaXplZCBzaXppbmdcblx0XHRjb25zdCBpc01vYmlsZSA9IFBsYXRmb3JtLmlzTW9iaWxlO1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogYmxvY2s7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzAuOWVtJyA6ICcwLjhlbSd9O1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0Ly8gU2luZ2xlIGxpbmUgc3VtbWFyeSAoc2FtZSBzdHlsZSBhcyBsaXZlIHByZXZpZXcpXG5cdFx0Y29uc3Qgc3VtbWFyeUVsID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1zdW1tYXJ5JyB9KTtcblx0XHRzdW1tYXJ5RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0d2lkdGg6IDEwMCU7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwb2ludGVyLWV2ZW50czogYXV0bztcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHN1bW1hcnlUZXh0RWwgPSBzdW1tYXJ5RWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1zdW1tYXJ5LXRleHQnIH0pO1xuXHRcdFxuXHRcdGNvbnN0IHRva2VuUGVyY2VudCA9IE1hdGgucm91bmQoKHRoaXMuY3VycmVudENvbnRleHQudG9rZW5Db3VudCAvIDgwMDApICogMTAwKTtcblx0XHRjb25zdCBkb2NOYW1lcyA9IGFsbERvY3MubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuc2xpY2UoMCwgaXNNb2JpbGUgPyAxIDogMik7XG5cdFx0Y29uc3QgbW9yZUNvdW50ID0gYWxsRG9jcy5sZW5ndGggPiAoaXNNb2JpbGUgPyAxIDogMikgPyBgICske2FsbERvY3MubGVuZ3RoIC0gKGlzTW9iaWxlID8gMSA6IDIpfWAgOiAnJztcblx0XHRcblx0XHQvLyBNb2JpbGUtb3B0aW1pemVkIHRleHQgKHNob3J0ZXIgb24gbW9iaWxlKSB3aXRoIHByb3BlciBmbGV4IGFsaWdubWVudFxuXHRcdHN1bW1hcnlUZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZsZXg6IDE7IHBvaW50ZXItZXZlbnRzOiBub25lOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0c3VtbWFyeVRleHRFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCAke2RvY05hbWVzLmpvaW4oJywgJyl9JHttb3JlQ291bnR9ICgke3Rva2VuUGVyY2VudH0lKWA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlUZXh0RWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgJHtkb2NOYW1lcy5qb2luKCcsICcpfSR7bW9yZUNvdW50fSAoJHt0b2tlblBlcmNlbnR9JSB0b2tlbnMpYDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gTW9iaWxlLWZyaWVuZGx5IG1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRjb25zdCBleHBhbmRJbmRpY2F0b3JFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZC1pbmRpY2F0b3InIH0pO1xuXHRcdGV4cGFuZEluZGljYXRvckVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignbW9yZS1ob3Jpem9udGFsJywgaXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCcpOyAvLyBNb3JlIG1lbnUgaW5kaWNhdG9yXG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE2cHgnIDogJzE0cHgnfTtcblx0XHRcdG9wYWNpdHk6IDAuODtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnOHB4JyA6ICc0cHgnfTtcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBub25lO1xuXHRcdGA7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc2V0QXR0cigndGl0bGUnLCAnVGFwIHRvIG1hbmFnZSBkb2N1bWVudHMnKTtcblx0XHRcblx0XHQvLyBWaXN1YWwgZmVlZGJhY2sgb24gdGhlIHdob2xlIHN1bW1hcnkgbGluZSBpbnN0ZWFkIG9mIGp1c3QgdGhlIGluZGljYXRvclxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKSc7XG5cdFx0XHR9KTtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0dGhpcy5hZGRUcmFja2VkVGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpJztcblx0XHRcdH0pO1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvLyBFeHBhbmRlZCBzdGF0ZSAtIG1vYmlsZS1yZXNwb25zaXZlIG92ZXJsYXlcblx0XHRjb25zdCBleHBhbmRlZEVsID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZCcgfSk7XG5cdFx0ZXhwYW5kZWRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdGxlZnQ6ICR7aXNNb2JpbGUgPyAnLThweCcgOiAnMCd9O1xuXHRcdFx0cmlnaHQ6ICR7aXNNb2JpbGUgPyAnLThweCcgOiAnMCd9O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRib3gtc2hhZG93OiAwICR7aXNNb2JpbGUgPyAnLTRweCAxNnB4JyA6ICctMnB4IDhweCd9IHJnYmEoMCwgMCwgMCwgJHtpc01vYmlsZSA/ICcwLjE1JyA6ICcwLjEnfSk7XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMnB4O1xuXHRcdFx0bWF4LWhlaWdodDogJHtpc01vYmlsZSA/ICc2MHZoJyA6ICcyMDBweCd9O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICcxMDAlJyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHRcblx0XHQvLyBIZWFkZXIgZm9yIGV4cGFuZGVkIHN0YXRlIHdpdGggbW9iaWxlLW9wdGltaXplZCBjbGVhciBidXR0b25cblx0XHRjb25zdCBleHBhbmRlZEhlYWRlckVsID0gZXhwYW5kZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kZWQtaGVhZGVyJyB9KTtcblx0XHRleHBhbmRlZEhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGhlYWRlclRpdGxlRWwgPSBleHBhbmRlZEhlYWRlckVsLmNyZWF0ZVNwYW4oKTtcblx0XHRoZWFkZXJUaXRsZUVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJykgKyBgIERvY3VtZW50cyAoJHthbGxEb2NzLmxlbmd0aH0pYDtcblx0XHRoZWFkZXJUaXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7Jztcblx0XHRcblx0XHQvLyBDbGVhciBhbGwgYnV0dG9uIHVzaW5nIHNhbWUgaWNvbiBhcyBtYWluIHNpZGViYXJcblx0XHRjb25zdCBjbGVhckFsbEJ0bkNvbXBvbmVudCA9IG5ldyBCdXR0b25Db21wb25lbnQoZXhwYW5kZWRIZWFkZXJFbCk7XG5cdFx0Y2xlYXJBbGxCdG5Db21wb25lbnQuc2V0SWNvbignZXJhc2VyJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBhbGwgZG9jdW1lbnRzIGZyb20gY29udGV4dCcpXG5cdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIuY2xlYXJQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlLnBhdGgpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XG5cdFx0Y29uc3QgY2xlYXJBbGxCdG4gPSBjbGVhckFsbEJ0bkNvbXBvbmVudC5idXR0b25FbDtcblx0XHRjbGVhckFsbEJ0bi5hZGRDbGFzcygnbm92YS1jb250ZXh0LWNsZWFyLWFsbC1idG4nKTtcblx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogbm9uZTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHggMTJweCcgOiAnNHB4IDhweCd9O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBUb3VjaC1mcmllbmRseSBmZWVkYmFjayBmb3IgY2xlYXIgYnV0dG9uXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0sIDE1MCk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0fSk7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHQvLyBEb2N1bWVudCBsaXN0IGZvciBleHBhbmRlZCBzdGF0ZVxuXHRcdGNvbnN0IGRvY0xpc3RFbCA9IGV4cGFuZGVkRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1saXN0JyB9KTtcblx0XHRcblx0XHRhbGxEb2NzLmZvckVhY2goKGRvYywgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGRvY0l0ZW1FbCA9IGRvY0xpc3RFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWl0ZW0nIH0pO1xuXHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRcdGJvcmRlci1ib3R0b206ICR7aW5kZXggPCBhbGxEb2NzLmxlbmd0aCAtIDEgPyAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScgOiAnbm9uZSd9O1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG5cdFx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNTZweCcgOiAnYXV0byd9O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgZG9jSW5mb0VsID0gZG9jSXRlbUVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtaW5mbycgfSk7XG5cdFx0XHRkb2NJbmZvRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiAke2lzTW9iaWxlID8gJzEycHgnIDogJzhweCd9O1xuXHRcdFx0XHRmbGV4OiAxO1xuXHRcdFx0XHRtaW4td2lkdGg6IDA7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBpY29uRWwgPSBkb2NJbmZvRWwuY3JlYXRlU3BhbigpO1xuXHRcdFx0aWNvbkVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignZmlsZS10ZXh0Jyk7XG5cdFx0XHRpY29uRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmb250LXNpemU6IDFlbTsnO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBuYW1lRWwgPSBkb2NJbmZvRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtbmFtZScgfSk7XG5cdFx0XHRjb25zdCBzdWZmaXggPSBkb2MucHJvcGVydHkgPyBgIyR7ZG9jLnByb3BlcnR5fWAgOiAnJztcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGAke2RvYy5maWxlLmJhc2VuYW1lfSR7c3VmZml4fWA7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDQwMDtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0dGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG5cdFx0XHRcdG92ZXJmbG93OiBoaWRkZW47XG5cdFx0XHRcdHdoaXRlLXNwYWNlOiBub3dyYXA7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdFx0XHRsaW5lLWhlaWdodDogMS40O1xuXHRcdFx0YDtcblx0XHRcdG5hbWVFbC5zZXRBdHRyKCd0aXRsZScsIGRvYy5maWxlLnBhdGgpO1xuXHRcdFx0XG5cdFx0XHQvLyBNb2JpbGUtb3B0aW1pemVkIHJlbW92ZSBidXR0b24gd2l0aCBsYXJnZXIgdG91Y2ggdGFyZ2V0XG5cdFx0XHRjb25zdCByZW1vdmVCdG4gPSBkb2NJdGVtRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1yZW1vdmUnIH0pO1xuXHRcdFx0cmVtb3ZlQnRuLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbigneCcsIGlzTW9iaWxlID8gJzE4cHgnIDogJzE0cHgnKTtcblx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHR3aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcxOHB4JyA6ICcxNHB4J307XG5cdFx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0XHRmb250LXdlaWdodDogYm9sZDtcblx0XHRcdGA7XG5cdFx0XHRyZW1vdmVCdG4uc2V0QXR0cigndGl0bGUnLCBgUmVtb3ZlICR7ZG9jLmZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIucmVtb3ZlUGVyc2lzdGVudERvYyh0aGlzLmN1cnJlbnRGaWxlLnBhdGgsIGRvYy5maWxlLnBhdGgpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdC8vIFBsYXRmb3JtLXNwZWNpZmljIGludGVyYWN0aW9uIGZlZWRiYWNrXG5cdFx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdH0sIDE1MCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVG91Y2ggZmVlZGJhY2sgZm9yIGRvY3VtZW50IGl0ZW1zXG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gQ2xpY2sgdG8gZXhwYW5kIG1hbmFnZW1lbnQgb3ZlcmxheVxuXHRcdGxldCBpc0V4cGFuZGVkID0gZmFsc2U7XG5cdFx0XG5cdFx0Y29uc3QgdG9nZ2xlRXhwYW5kZWQgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGlzRXhwYW5kZWQgPSAhaXNFeHBhbmRlZDtcblx0XHRcdFxuXHRcdFx0aWYgKGlzRXhwYW5kZWQpIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICcxMDAxJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9O1xuXHRcdFxuXHRcdC8vIENsaWNrIG9uIHRoZSBlbnRpcmUgc3VtbWFyeSBsaW5lIHRvIGV4cGFuZFxuXHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUV4cGFuZGVkKTtcblx0XHRcblx0XHQvLyBDbG9zZSB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjbG9zZUhhbmRsZXI6IEV2ZW50TGlzdGVuZXIgPSAoZTogRXZlbnQpID0+IHtcblx0XHRcdGlmIChpc0V4cGFuZGVkICYmICF0aGlzLmNvbnRleHRJbmRpY2F0b3IuY29udGFpbnMoZS50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0aXNFeHBhbmRlZCA9IGZhbHNlO1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnYXV0byc7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZUhhbmRsZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZWZyZXNoQ29udGV4dCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KCcnLCB0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSByZXN1bHQuY29udGV4dDtcblx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlU2VuZCgpIHtcblx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHJldHVybjtcblxuXHRcdC8vIENoZWNrIGZvciBjb21tYW5kIHN5c3RlbSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdGlmIChtZXNzYWdlLnN0YXJ0c1dpdGgoJzonKSkge1xuXHRcdFx0Y29uc3QgY29tbWFuZFJlc3VsdCA9IGF3YWl0IHRoaXMuaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2UpO1xuXHRcdFx0aWYgKGNvbW1hbmRSZXN1bHQpIHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdC8vIFJlc2V0IHRleHRhcmVhIGhlaWdodCBhZnRlciBjbGVhcmluZ1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZCBhbmQgcGFyc2UgcmVmZXJlbmNlc1xuXHRcdGxldCBwcm9jZXNzZWRNZXNzYWdlID0gbWVzc2FnZTtcblx0XHRsZXQgbXVsdGlEb2NDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XHRcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Ly8gQ2hlY2sgZm9yIGVhcmx5IGFjY2Vzc1xuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRcdGlmIChtZXNzYWdlLmluY2x1ZGVzKCdbWycpIHx8IG1lc3NhZ2UuaW5jbHVkZXMoJytbWycpKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdib29rLW9wZW4nLCAnTXVsdGktZG9jdW1lbnQgY29udGV4dCBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBDYXRhbHlzdCBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nKSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBQYXJzZSBhbmQgYnVpbGQgY29udGV4dFxuXHRcdFx0XHRjb25zdCBjb250ZXh0UmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2UsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRwcm9jZXNzZWRNZXNzYWdlID0gY29udGV4dFJlc3VsdC5jbGVhbmVkTWVzc2FnZTtcblx0XHRcdFx0bXVsdGlEb2NDb250ZXh0ID0gY29udGV4dFJlc3VsdC5jb250ZXh0O1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbXVsdGlEb2NDb250ZXh0O1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVXBkYXRlIFVJIGluZGljYXRvclxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIG1lc3NhZ2UgaXMganVzdCBkb2N1bWVudCByZWZlcmVuY2VzIChjb250ZXh0LW9ubHkgbW9kZSlcblx0XHRcdFx0Ly8gU2luY2UgYWxsIGRvY3MgYXJlIG5vdyBwZXJzaXN0ZW50LCBjaGVjayBpZiB3ZSBoYXZlIG5ldyBkb2NzIGFuZCBlbXB0eSBtZXNzYWdlXG5cdFx0XHRcdGNvbnN0IHByZXZpb3VzUGVyc2lzdGVudENvdW50ID0gdGhpcy5jdXJyZW50Q29udGV4dD8ucGVyc2lzdGVudERvY3MubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuXHRcdFx0XHRjb25zdCBoYXNOZXdEb2NzID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCA+IHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRjb25zdCBpc0NvbnRleHRPbmx5TWVzc2FnZSA9IHByb2Nlc3NlZE1lc3NhZ2UudHJpbSgpLmxlbmd0aCA9PT0gMCAmJiBoYXNOZXdEb2NzO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGlzQ29udGV4dE9ubHlNZXNzYWdlKSB7XG5cdFx0XHRcdFx0Ly8gSGFuZGxlIGNvbnRleHQtb25seSBjb21tYW5kcyAtIHNob3cgbmV3bHkgYWRkZWQgZG9jdW1lbnRzXG5cdFx0XHRcdFx0Y29uc3QgbmV3RG9jc0NvdW50ID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCAtIHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRcdGlmIChuZXdEb2NzQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0XHQvLyBHZXQgdGhlIG5ld2x5IGFkZGVkIGRvY3VtZW50cyAobGFzdCBOIGRvY3VtZW50cylcblx0XHRcdFx0XHRcdGNvbnN0IG5ld0RvY3MgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3Muc2xpY2UoLW5ld0RvY3NDb3VudCk7XG5cdFx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IG5ld0RvY3MubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKTtcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnY2hlY2stY2lyY2xlJywgYEFkZGVkICR7bmV3RG9jc0NvdW50fSBkb2N1bWVudCR7bmV3RG9jc0NvdW50ICE9PSAxID8gJ3MnIDogJyd9IHRvIHBlcnNpc3RlbnQgY29udGV4dDogJHtkb2NOYW1lc31gKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIENsZWFyIGlucHV0IGFuZCB1cGRhdGUgY29udGV4dCBpbmRpY2F0b3Jcblx0XHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBkb25lXG5cdFx0XHRcdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdFx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBTaG93IGNvbnRleHQgY29uZmlybWF0aW9uIGlmIGRvY3VtZW50cyB3ZXJlIGluY2x1ZGVkIGluIGEgcmVndWxhciBtZXNzYWdlXG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IGFsbERvY3MgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3M7XG5cdFx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBhbGxEb2NzLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0Y29uc3QgdG9rZW5JbmZvID0gbXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnQgPiAwID8gYCAofiR7bXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnR9IHRva2VucylgIDogJyc7XG5cdFx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdib29rLW9wZW4nLCBgSW5jbHVkZWQgJHthbGxEb2NzLmxlbmd0aH0gZG9jdW1lbnQke2FsbERvY3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9IGluIGNvbnRleHQ6ICR7ZG9jTmFtZXN9JHt0b2tlbkluZm99YCkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayB0b2tlbiBsaW1pdFxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0LmlzTmVhckxpbWl0KSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIEFwcHJvYWNoaW5nIHRva2VuIGxpbWl0LiBDb25zaWRlciByZW1vdmluZyBzb21lIGRvY3VtZW50cyBmcm9tIGNvbnRleHQuJywgNTAwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGQgdXNlciBtZXNzYWdlIChzaG93IG9yaWdpbmFsIHdpdGggcmVmZXJlbmNlcylcblx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHQvLyBSZXNldCB0ZXh0YXJlYSBoZWlnaHQgYWZ0ZXIgY2xlYXJpbmdcblx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcblx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBzZW5kaW5nIHRoZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldERpc2FibGVkKHRydWUpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBsb2FkaW5nIGluZGljYXRvciB3aXRoIGFuaW1hdGVkIG5vdmFcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxvYWRpbmcnIH0pO1xuXHRcdFx0bG9hZGluZ0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAxMnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDEwcHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBDcmVhdGUgYW5pbWF0ZWQgbm92YSBidXJzdFxuXHRcdFx0Y29uc3Qgbm92YUNvbnRhaW5lciA9IGxvYWRpbmdFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJ1cnN0LWNvbnRhaW5lcicgfSk7XG5cdFx0XHRub3ZhQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYnVyc3RcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jb3JlXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTJcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0zXCI+PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgdGV4dEVsID0gbG9hZGluZ0VsLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTm92YSBpcyB0aGlua2luZy4uLicgfSk7XG5cdFx0XHR0ZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gU3RvcmUgbWVzc2FnZSBpbiBjb252ZXJzYXRpb24gbWFuYWdlclxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShtZXNzYWdlKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIGNvbW1hbmQgb3IgY29udmVyc2F0aW9uXG5cdFx0XHRjb25zdCBpc0xpa2VseUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyWydpc0xpa2VseUNvbW1hbmQnXShwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdGxldCByZXNwb25zZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdFx0XHRcblx0XHRcdGlmIChpc0xpa2VseUNvbW1hbmQgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBQYXJzZSBhcyBjb21tYW5kIGFuZCByb3V0ZSB0byBhcHByb3ByaWF0ZSBoYW5kbGVyXG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGFzIGNvbnZlcnNhdGlvbiB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0XHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKHByb2Nlc3NlZE1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBtdWx0aS1kb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0ICYmIG11bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nKSB7XG5cdFx0XHRcdFx0Ly8gVGhlIGNvbnRleHQgYWxyZWFkeSBpbmNsdWRlcyB0aGUgY3VycmVudCBmaWxlLCBzbyB3ZSBjYW4gdXNlIGl0IGRpcmVjdGx5XG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRVc2VyUHJvbXB0ID0gYCR7bXVsdGlEb2NDb250ZXh0LmNvbnRleHRTdHJpbmd9XFxuXFxuLS0tXFxuXFxuVXNlciBSZXF1ZXN0OiAke3Byb2Nlc3NlZE1lc3NhZ2V9YDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIGVuaGFuY2VkVXNlclByb21wdCwge1xuXHRcdFx0XHRcdFx0dGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0XHRtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0LCBwcm9tcHQudXNlclByb21wdCwge1xuXHRcdFx0XHRcdFx0dGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0XHRtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yXG5cdFx0XHRsb2FkaW5nRWwucmVtb3ZlKCk7XG5cdFx0XHRcblx0XHRcdC8vIFN0b3JlIHJlc3BvbnNlIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChpZiByZXNwb25zZSBleGlzdHMpXG5cdFx0XHRpZiAoYWN0aXZlRmlsZSAmJiByZXNwb25zZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKHJlc3BvbnNlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQWRkIEFJIHJlc3BvbnNlIChvbmx5IGlmIHRoZXJlIGlzIGEgcmVzcG9uc2UpXG5cdFx0XHRpZiAocmVzcG9uc2UpIHtcblx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCByZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvciBpZiBpdCBleGlzdHNcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubm92YS1sb2FkaW5nJyk7XG5cdFx0XHRpZiAobG9hZGluZ0VsKSBsb2FkaW5nRWwucmVtb3ZlKCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgYFNvcnJ5LCBJIGVuY291bnRlcmVkIGFuIGVycm9yOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKTtcblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0dGhpcy5zZW5kQnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcblx0XHRcdC8vIFJlZnJlc2ggY29udGV4dCBpbmRpY2F0b3IgdG8gc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50c1xuXHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGluc2VydFRleHRJbnRvQWN0aXZlTm90ZSh0ZXh0OiBzdHJpbmcpIHtcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoSXRlbVZpZXcpO1xuXHRcdGlmIChhY3RpdmVWaWV3ICYmICdlZGl0b3InIGluIGFjdGl2ZVZpZXcpIHtcblx0XHRcdGNvbnN0IGVkaXRvciA9IChhY3RpdmVWaWV3IGFzIGFueSkuZWRpdG9yO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCwgY3Vyc29yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlJ3MgYSBjdXJyZW50IGZpbGUgKHRoZSBvbmUgd2UncmUgY2hhdHRpbmcgYWJvdXQpXG5cdFx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgJ05vIG1hcmtkb3duIGZpbGUgaXMgb3Blbi4gUGxlYXNlIG9wZW4gYSBmaWxlIGluIHRoZSBlZGl0b3IgdG8gdXNlIGVkaXRpbmcgY29tbWFuZHMuJyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEVuc3VyZSB0aGVyZSdzIGEgbWFya2Rvd24gdmlldyB3aXRoIHRoaXMgZmlsZVxuXHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdGxldCBtYXJrZG93blZpZXc6IE1hcmtkb3duVmlldyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIHRoZSB2aWV3IHdpdGggb3VyIGZpbGVcblx0XHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdGlmICh2aWV3LmZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSB2aWV3O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIElmIG5vdCBmb3VuZCwgdHJ5IHRvIG9wZW4gdGhlIGZpbGVcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRcdGlmIChsZWFmKSB7XG5cdFx0XHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gYWNjZXNzIHRoZSBmaWxlIFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiLiBQbGVhc2UgbWFrZSBzdXJlIGl0J3Mgb3BlbiBpbiB0aGUgZWRpdG9yLmApO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRsZXQgcmVzdWx0O1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdtZXRhZGF0YSc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4ubWV0YWRhdGFDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHJldHVybiBgSSBkb24ndCB1bmRlcnN0YW5kIHRoZSBjb21tYW5kIFwiJHtjb21tYW5kLmFjdGlvbn1cIi4gVHJ5IGFza2luZyBtZSB0byBhZGQsIGVkaXQsIGRlbGV0ZSwgZml4IGdyYW1tYXIsIHJld3JpdGUgY29udGVudCwgb3IgdXBkYXRlIG1ldGFkYXRhL3Byb3BlcnRpZXMuYDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdC8vIEFkZCBjb21wYWN0IHN1Y2Nlc3MgaW5kaWNhdG9yIGluc3RlYWQgb2YgZnVsbCBtZXNzYWdlXG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc0luZGljYXRvcihjb21tYW5kLmFjdGlvbik7XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBEb24ndCByZXR1cm4gdGV4dCBmb3IgcmVndWxhciBtZXNzYWdlXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gYEZhaWxlZCB0byAke2NvbW1hbmQuYWN0aW9ufTogJHtyZXN1bHQuZXJyb3J9YDtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEVycm9yIGV4ZWN1dGluZyBjb21tYW5kOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKTtcblx0XHR9XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKSB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gSWYgbm8gYWN0aXZlIGZpbGUsIHRyeSB0byBmaW5kIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxlYWYncyBmaWxlXG5cdFx0bGV0IHRhcmdldEZpbGUgPSBhY3RpdmVGaWxlO1xuXHRcdGlmICghdGFyZ2V0RmlsZSkge1xuXHRcdFx0Y29uc3QgYWN0aXZlTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmO1xuXHRcdFx0aWYgKGFjdGl2ZUxlYWYgJiYgYWN0aXZlTGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHRhcmdldEZpbGUgPSBhY3RpdmVMZWFmLnZpZXcuZmlsZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGwgYmFjayB0byBhbnkgb3BlbiBtYXJrZG93biBmaWxlIG9ubHkgaWYgbm8gYWN0aXZlIGxlYWZcblx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0XHR0YXJnZXRGaWxlID0gdmlldy5maWxlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIG5vIGZpbGUgb3Igc2FtZSBmaWxlLCBkbyBub3RoaW5nXG5cdFx0aWYgKCF0YXJnZXRGaWxlIHx8IHRhcmdldEZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50RmlsZSA9IHRhcmdldEZpbGU7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY3VycmVudCBjaGF0XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGZvciBuZXcgZmlsZSAodGhpcyB3aWxsIHNob3cgcGVyc2lzdGVudCBkb2N1bWVudHMgaWYgYW55KVxuXHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gTG9hZCBjb252ZXJzYXRpb24gaGlzdG9yeSBpZiBpdCBleGlzdHNcblx0XHRcdGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyh0YXJnZXRGaWxlLCAxMCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZWNlbnRNZXNzYWdlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vIERpc3BsYXkgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG5cdFx0XHRcdHJlY2VudE1lc3NhZ2VzLmZvckVhY2gobXNnID0+IHtcblx0XHRcdFx0XHRpZiAobXNnLnJvbGUgIT09ICdzeXN0ZW0nKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UobXNnLnJvbGUgYXMgJ3VzZXInIHwgJ2Fzc2lzdGFudCcsIG1zZy5jb250ZW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2UgZm9yIG5ldyBmaWxlXG5cdFx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYFJlYWR5IHRvIGhlbHAgeW91IHdpdGggXCIke3RhcmdldEZpbGUuYmFzZW5hbWV9XCIuIFdoYXQgd291bGQgeW91IGxpa2UgdG8gZG8/YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGhpc3Rvcnk6JywgZXJyb3IpO1xuXHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2Ugb24gZXJyb3Jcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYFJlYWR5IHRvIGhlbHAgeW91IHdpdGggXCIke3RhcmdldEZpbGUuYmFzZW5hbWV9XCIuIFdoYXQgd291bGQgeW91IGxpa2UgdG8gZG8/YCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjbGVhckNoYXQoKSB7XG5cdFx0Ly8gQ2xlYXIgdGhlIGNoYXQgY29udGFpbmVyXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY29udmVyc2F0aW9uIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24odGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdC8vIEFsc28gY2xlYXIgbXVsdGktZG9jIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNsZWFyIGNvbnZlcnNhdGlvbjonLCBlcnJvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgZnJlc2ggd2VsY29tZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYENoYXQgY2xlYXJlZCEgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShcIkNoYXQgY2xlYXJlZCEgUmVhZHkgdG8gaGVscC4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9cIik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgbm90aWNlIHRvIHVzZXJcblx0XHRuZXcgTm90aWNlKCdDaGF0IGhpc3RvcnkgY2xlYXJlZCcpO1xuXHR9XG5cblx0Ly8gUHVibGljIG1ldGhvZHMgZm9yIHRlc3Rpbmdcblx0YXN5bmMgc2VuZE1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBCdWlsZCBwcm9tcHQgdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKG1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcblx0XHQvLyBUcnkgdG8gcGFyc2UgYXMgY29tbWFuZCBmaXJzdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiBpdCdzIGEgdmFsaWQgY29tbWFuZCBhY3Rpb25cblx0XHRjb25zdCB2YWxpZEFjdGlvbnMgPSBbJ2FkZCcsICdlZGl0JywgJ2RlbGV0ZScsICdncmFtbWFyJywgJ3Jld3JpdGUnXTtcblx0XHRpZiAodmFsaWRBY3Rpb25zLmluY2x1ZGVzKGNvbW1hbmQuYWN0aW9uKSkge1xuXHRcdFx0Ly8gRXhlY3V0ZSBjb21tYW5kXG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBSZWd1bGFyIGNvbnZlcnNhdGlvblxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShhY3RpdmVGaWxlLCBtZXNzYWdlLCBudWxsIGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIENhbGwgQUkgcHJvdmlkZXJcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIHByb21wdC51c2VyUHJvbXB0KTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGFjdGl2ZUZpbGUsICdBSSByZXNwb25zZScsIHsgc3VjY2VzczogdHJ1ZSwgZWRpdFR5cGU6ICdub25lJyB9IGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkoZmlsZTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHQvLyBJbiByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGRpc3BsYXkgbWVzc2FnZXMgaW4gdGhlIFVJXG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHN0YXRpYyBwcm92aWRlciBzdGF0dXMgZGlzcGxheVxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVTdGF0aWNQcm92aWRlclN0YXR1cyhjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgcHJvdmlkZXJTdGF0dXMgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXItcHJvdmlkZXInIH0pO1xuXHRcdHByb3ZpZGVyU3RhdHVzLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRvcGFjaXR5OiAwLjg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJTdGF0dXNEb3QgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtZG90LXNtYWxsJyB9KTtcblx0XHRoZWFkZXJTdGF0dXNEb3Quc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiA2cHg7XG5cdFx0XHRoZWlnaHQ6IDZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGJhY2tncm91bmQ6ICM0Y2FmNTA7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJQcm92aWRlck5hbWUgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nIH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBuYW1lIGFzeW5jaHJvbm91c2x5XG5cdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpLnRoZW4obmFtZSA9PiB7XG5cdFx0XHRoZWFkZXJQcm92aWRlck5hbWUuc2V0VGV4dChuYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlckRyb3Bkb3duKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWNvbnRhaW5lcicgfSk7XG5cdFx0ZHJvcGRvd25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHByb3ZpZGVyIGJ1dHRvblxuXHRcdGNvbnN0IHByb3ZpZGVyQnV0dG9uID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1wcm92aWRlci1idXR0b24nIH0pO1xuXHRcdHByb3ZpZGVyQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogNHB4IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gU3RhdHVzIGRvdFxuXHRcdGNvbnN0IHN0YXR1c0RvdCA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXN0YXR1cy1kb3Qtc21hbGwnIH0pO1xuXHRcdHN0YXR1c0RvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0d2lkdGg6IDZweDtcblx0XHRcdGhlaWdodDogNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0YmFja2dyb3VuZDogIzRjYWY1MDtcblx0XHRgO1xuXG5cdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTG9hZGluZy4uLicgfSk7XG5cblx0XHQvLyBEcm9wZG93biBhcnJvd1xuXHRcdGNvbnN0IGRyb3Bkb3duQXJyb3cgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCQycgfSk7XG5cdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdG1hcmdpbi1sZWZ0OiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBEcm9wZG93biBtZW51IChpbml0aWFsbHkgaGlkZGVuKVxuXHRcdGNvbnN0IGRyb3Bkb3duTWVudSA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudScgfSk7XG5cdFx0ZHJvcGRvd25NZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdG1pbi13aWR0aDogMTUwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdGA7XG5cblx0XHRsZXQgaXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblxuXHRcdC8vIFVwZGF0ZSBjdXJyZW50IHByb3ZpZGVyIGRpc3BsYXlcblx0XHRjb25zdCB1cGRhdGVDdXJyZW50UHJvdmlkZXIgPSBhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXHRcdFx0cHJvdmlkZXJOYW1lLnNldFRleHQoY3VycmVudFByb3ZpZGVyTmFtZSk7XG5cdFx0fTtcblxuXHRcdC8vIFRvZ2dsZSBkcm9wZG93blxuXHRcdGNvbnN0IHRvZ2dsZURyb3Bkb3duID0gKCkgPT4ge1xuXHRcdFx0aXNEcm9wZG93bk9wZW4gPSAhaXNEcm9wZG93bk9wZW47XG5cdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9IGlzRHJvcGRvd25PcGVuID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gaXNEcm9wZG93bk9wZW4gPyAncm90YXRlKDE4MGRlZyknIDogJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHRcblx0XHRcdGlmIChpc0Ryb3Bkb3duT3Blbikge1xuXHRcdFx0XHR0aGlzLnBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBDbG9zZSBkcm9wZG93biB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjbG9zZURyb3Bkb3duOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCFkcm9wZG93bkNvbnRhaW5lci5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0aXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblx0XHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHByb3ZpZGVyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR0b2dnbGVEcm9wZG93bigpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQWRkIGdsb2JhbCBjbGljayBsaXN0ZW5lclxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlRHJvcGRvd24pO1xuXG5cdFx0Ly8gVXBkYXRlIHByb3ZpZGVyIG5hbWUgaW5pdGlhbGx5XG5cdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIGNsZWFudXBcblx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duID0ge1xuXHRcdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyLFxuXHRcdFx0Y2xlYW51cDogKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZURyb3Bkb3duKVxuXHRcdH07XG5cdH1cblxuXHQvKipcblx0ICogUG9wdWxhdGUgcHJvdmlkZXIgZHJvcGRvd24gd2l0aCBhdmFpbGFibGUgcHJvdmlkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnU6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cblx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBhbGxvd2VkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBwcm92aWRlckl0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1pdGVtJyB9KTtcblx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgaWNvbi9kb3Rcblx0XHRcdGNvbnN0IHByb3ZpZGVyRG90ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdHByb3ZpZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHdpZHRoOiA4cHg7XG5cdFx0XHRcdGhlaWdodDogOHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGJhY2tncm91bmQ6ICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdFx0Y29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IG5hbWVTcGFuID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiBkaXNwbGF5TmFtZSB9KTtcblxuXHRcdFx0Ly8gTWFyayBjdXJyZW50IHByb3ZpZGVyXG5cdFx0XHRjb25zdCBpc0N1cnJlbnQgPSBkaXNwbGF5TmFtZSA9PT0gY3VycmVudFByb3ZpZGVyTmFtZTtcblx0XHRcdGlmIChpc0N1cnJlbnQpIHtcblx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHRuYW1lU3Bhbi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDbGljayBoYW5kbGVyXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdFx0Ly8gQ2xvc2UgZHJvcGRvd25cblx0XHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIb3ZlciBlZmZlY3Rcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdDbGF1ZGUgKEFudGhyb3BpYyknLFxuXHRcdFx0J29wZW5haSc6ICdHUFQtNCAoT3BlbkFJKScsXG5cdFx0XHQnZ29vZ2xlJzogJ0dlbWluaSAoR29vZ2xlKScsXG5cdFx0XHQnb2xsYW1hJzogJ09sbGFtYSAoTG9jYWwpJyxcblx0XHRcdCdub25lJzogJ05vbmUnXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJUeXBlXSB8fCBwcm92aWRlclR5cGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGNvbG9yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnI0QyNjkxRScsXG5cdFx0XHQnb3BlbmFpJzogJyMxMEEzN0YnLFxuXHRcdFx0J2dvb2dsZSc6ICcjNDI4NUY0Jyxcblx0XHRcdCdvbGxhbWEnOiAnIzdDM0FFRCcsXG5cdFx0XHQnbm9uZSc6ICcjOTk5J1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICcjNGNhZjUwJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgcHJvdmlkZXIgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBhIHN5c3RlbSBtZXNzYWdlIGFib3V0IHByb3ZpZGVyIHN3aXRjaGluZ1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKTtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgc3dpdGNoTWVzc2FnZSk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0aGUgcGxhdGZvcm0gc2V0dGluZ3MgdG8gdXNlIHRoZSBuZXcgcHJvdmlkZXJcblx0XHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVyVHlwZSBhcyBhbnk7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmUtaW5pdGlhbGl6ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN3aXRjaGluZyBwcm92aWRlcjonLCBlcnJvcik7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEZhaWxlZCB0byBzd2l0Y2ggdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKSk7XG5cdFx0fVxuXHR9XG5cbn0iLCAiLyoqXG4gKiBDdXN0b20gd2lraWxpbmsgYXV0b2NvbXBsZXRlIGZvciBOb3ZhIHRleHRhcmVhXG4gKiBQcm92aWRlcyBbW2RvY3VtZW50XV0gc3VnZ2VzdGlvbnMgd2hlbiB0eXBpbmcgaW4gTm92YSdzIHRleHRhcmVhXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUsIEFwcCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBXaWtpbGlua1N1Z2dlc3Rpb24ge1xuICAgIGZpbGU6IFRGaWxlO1xuICAgIGRpc3BsYXlUZXh0OiBzdHJpbmc7XG4gICAgc2NvcmU6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgIHByaXZhdGUgc3VnZ2VzdGlvblBvcHVwOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgc3VnZ2VzdGlvbnM6IFdpa2lsaW5rU3VnZ2VzdGlvbltdID0gW107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZEluZGV4OiBudW1iZXIgPSAtMTtcbiAgICBwcml2YXRlIGlzVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgY3VycmVudFF1ZXJ5OiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIGN1cnJlbnRUcmlnZ2VyUG9zOiBudW1iZXIgPSAtMTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuICAgICAgICB0aGlzLnNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleWRvd24uYmluZCh0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbG9zZSBvbiBmb2N1cyBsb3NzXG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsICgpID0+IHtcbiAgICAgICAgICAgIC8vIERlbGF5IHRvIGFsbG93IHNlbGVjdGlvbiBjbGlja3NcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKSwgMTUwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgY2xpY2sgb3V0c2lkZVxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9uUG9wdXAgJiYgIXRoaXMuc3VnZ2VzdGlvblBvcHVwLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpICYmIGUudGFyZ2V0ICE9PSB0aGlzLnRleHRBcmVhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVJbnB1dCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dEFyZWEudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIFxuICAgICAgICAvLyBMb29rIGZvciBbWyBwYXR0ZXJuIGJlZm9yZSBjdXJzb3JcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC8oXFwrKT9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxpbmtNYXRjaCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlcnkgPSBsaW5rTWF0Y2hbMl0gfHwgJyc7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUcmlnZ2VyUG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuc2hvd1N1Z2dlc3Rpb25zKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlkb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWF4KHRoaXMuc2VsZWN0ZWRJbmRleCAtIDEsIC0xKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgICAgY2FzZSAnVGFiJzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24odGhpcy5zdWdnZXN0aW9uc1t0aGlzLnNlbGVjdGVkSW5kZXhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdFc2NhcGUnOlxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93U3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKHRoaXMuY3VycmVudFF1ZXJ5KTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVTdWdnZXN0aW9uUG9wdXAoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJTdWdnZXN0aW9ucygpO1xuICAgICAgICB0aGlzLnBvc2l0aW9uUG9wdXAoKTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhpZGVTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU3VnZ2VzdGlvblBvcHVwKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5jbGFzc05hbWUgPSAnbm92YS13aWtpbGluay1zdWdnZXN0aW9ucyc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuICAgICAgICAgICAgbWF4LWhlaWdodDogMjAwcHg7XG4gICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgICBtaW4td2lkdGg6IDIwMHB4O1xuICAgICAgICBgO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5zZXJ0IGFmdGVyIHRoZSB0ZXh0YXJlYVxuICAgICAgICB0aGlzLnRleHRBcmVhLnBhcmVudEVsZW1lbnQ/LmFwcGVuZENoaWxkKHRoaXMuc3VnZ2VzdGlvblBvcHVwKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlclN1Z2dlc3Rpb25zKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuc3VnZ2VzdGlvblBvcHVwKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5mb3JFYWNoKChzdWdnZXN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvblBvcHVwIS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Z2dlc3Rpb24taXRlbScgfSk7XG4gICAgICAgICAgICBpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgcGFkZGluZzogOHB4IDEycHg7XG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmlsZSBuYW1lXG4gICAgICAgICAgICBjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VnZ2VzdGlvbi1uYW1lJyB9KTtcbiAgICAgICAgICAgIG5hbWVFbC50ZXh0Q29udGVudCA9IHN1Z2dlc3Rpb24uZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgICAgIG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAycHg7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGaWxlIHBhdGggKGlmIGRpZmZlcmVudCBmcm9tIG5hbWUpXG4gICAgICAgICAgICBpZiAoc3VnZ2VzdGlvbi5maWxlLnBhdGggIT09IHN1Z2dlc3Rpb24uZmlsZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aEVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Z2dlc3Rpb24tcGF0aCcgfSk7XG4gICAgICAgICAgICAgICAgcGF0aEVsLnRleHRDb250ZW50ID0gc3VnZ2VzdGlvbi5maWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgcGF0aEVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NWVtO1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcubm92YS1zdWdnZXN0aW9uLWl0ZW0nKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBpdGVtIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcG9zaXRpb25Qb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgLy8gUG9zaXRpb24gYWJvdmUgdGhlIHRleHRhcmVhXG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLnRleHRBcmVhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBjb25zdCBwb3B1cEhlaWdodCA9IE1hdGgubWluKDIwMCwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggKiA1MCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmxlZnQgPSAnMCc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmJvdHRvbSA9ICcxMDAlJztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUubWFyZ2luQm90dG9tID0gJzRweCc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLndpZHRoID0gYCR7cmVjdC53aWR0aH1weGA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IFdpa2lsaW5rU3VnZ2VzdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0QXJlYS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy50ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIFtbIHBhdHRlcm4gdG8gcmVwbGFjZVxuICAgICAgICBjb25zdCBiZWZvcmVDdXJzb3IgPSB0ZXh0LnN1YnN0cmluZygwLCBjdXJzb3JQb3MpO1xuICAgICAgICBjb25zdCBsaW5rTWF0Y2ggPSBiZWZvcmVDdXJzb3IubWF0Y2goLyhcXCspP1xcW1xcWyhbXlxcXV0qPykkLyk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWxpbmtNYXRjaCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaXNQZXJzaXN0ZW50ID0gISFsaW5rTWF0Y2hbMV07XG4gICAgICAgIGNvbnN0IHN0YXJ0UG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgcmVwbGFjZW1lbnQgdGV4dFxuICAgICAgICBjb25zdCBsaW5rVGV4dCA9IGBbWyR7c3VnZ2VzdGlvbi5maWxlLmJhc2VuYW1lfV1dYDtcbiAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBpc1BlcnNpc3RlbnQgPyBgKyR7bGlua1RleHR9YCA6IGxpbmtUZXh0O1xuICAgICAgICBcbiAgICAgICAgLy8gUmVwbGFjZSB0aGUgdGV4dFxuICAgICAgICBjb25zdCBuZXdUZXh0ID0gdGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRQb3MpICsgcmVwbGFjZW1lbnQgKyB0ZXh0LnN1YnN0cmluZyhjdXJzb3JQb3MpO1xuICAgICAgICB0aGlzLnRleHRBcmVhLnZhbHVlID0gbmV3VGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhZnRlciB0aGUgbGlua1xuICAgICAgICBjb25zdCBuZXdDdXJzb3JQb3MgPSBzdGFydFBvcyArIHJlcGxhY2VtZW50Lmxlbmd0aDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5zZXRTZWxlY3Rpb25SYW5nZShuZXdDdXJzb3JQb3MsIG5ld0N1cnNvclBvcyk7XG4gICAgICAgIFxuICAgICAgICAvLyBUcmlnZ2VyIGlucHV0IGV2ZW50IHRvIHVwZGF0ZSBhbnkgYXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5mb2N1cygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFdpa2lsaW5rU3VnZ2VzdGlvbltdIHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBzY29yZSA9IHRoaXMuc2NvcmVGaWxlKGZpbGUsIHF1ZXJ5KTtcbiAgICAgICAgICAgIGlmIChzY29yZSA+IDApIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVRleHQ6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3JlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNvcnQgYnkgc2NvcmUgKGhpZ2hlc3QgZmlyc3QpIGFuZCBsaW1pdCByZXN1bHRzXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKVxuICAgICAgICAgICAgLnNsaWNlKDAsIDgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2NvcmVGaWxlKGZpbGU6IFRGaWxlLCBxdWVyeTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKCFxdWVyeSkgcmV0dXJuIDUwOyAvLyBTaG93IGFsbCBmaWxlcyB3aGVuIG5vIHF1ZXJ5XG4gICAgICAgIFxuICAgICAgICBjb25zdCBiYXNlbmFtZSA9IGZpbGUuYmFzZW5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBxdWVyeUxvd2VyID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4YWN0IG1hdGNoXG4gICAgICAgIGlmIChiYXNlbmFtZSA9PT0gcXVlcnlMb3dlcikgcmV0dXJuIDEwMDtcbiAgICAgICAgXG4gICAgICAgIC8vIFN0YXJ0cyB3aXRoIHF1ZXJ5XG4gICAgICAgIGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKHF1ZXJ5TG93ZXIpKSByZXR1cm4gODA7XG4gICAgICAgIFxuICAgICAgICAvLyBDb250YWlucyBxdWVyeVxuICAgICAgICBpZiAoYmFzZW5hbWUuaW5jbHVkZXMocXVlcnlMb3dlcikpIHJldHVybiA2MDtcbiAgICAgICAgXG4gICAgICAgIC8vIFBhdGggY29udGFpbnMgcXVlcnlcbiAgICAgICAgaWYgKHBhdGguaW5jbHVkZXMocXVlcnlMb3dlcikpIHJldHVybiA0MDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZ1enp5IG1hdGNoXG4gICAgICAgIGlmICh0aGlzLmZ1enp5TWF0Y2goYmFzZW5hbWUsIHF1ZXJ5TG93ZXIpKSByZXR1cm4gMjA7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZ1enp5TWF0Y2godGV4dDogc3RyaW5nLCBxdWVyeTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB0ZXh0SW5kZXggPSAwO1xuICAgICAgICBsZXQgcXVlcnlJbmRleCA9IDA7XG4gICAgICAgIFxuICAgICAgICB3aGlsZSAodGV4dEluZGV4IDwgdGV4dC5sZW5ndGggJiYgcXVlcnlJbmRleCA8IHF1ZXJ5Lmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHRleHRbdGV4dEluZGV4XSA9PT0gcXVlcnlbcXVlcnlJbmRleF0pIHtcbiAgICAgICAgICAgICAgICBxdWVyeUluZGV4Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ZXh0SW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHF1ZXJ5SW5kZXggPT09IHF1ZXJ5Lmxlbmd0aDtcbiAgICB9XG5cbiAgICBkZXN0cm95KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9uUG9wdXApIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIE11bHRpLWRvY3VtZW50IGNvbnRleHQgaGFuZGxlciBmb3IgTm92YVxuICogUGFyc2VzIFtbZG9jXV0gYW5kICtbW2RvY11dIHN5bnRheCBmb3IgYWRkaXRpb25hbCBjb250ZXh0XG4gKi9cblxuaW1wb3J0IHsgQXBwLCBURmlsZSwgQ2FjaGVkTWV0YWRhdGEgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRSZWZlcmVuY2Uge1xuICAgIC8qKiBUaGUgZmlsZSBiZWluZyByZWZlcmVuY2VkICovXG4gICAgZmlsZTogVEZpbGU7XG4gICAgXG4gICAgLyoqIFdoZXRoZXIgdGhpcyBpcyBwZXJzaXN0ZW50IGNvbnRleHQgKCtbW2RvY11dKSAqL1xuICAgIGlzUGVyc2lzdGVudDogYm9vbGVhbjtcbiAgICBcbiAgICAvKiogVGhlIHJhdyByZWZlcmVuY2UgdGV4dCAoZS5nLiwgXCJbW015IERvY3VtZW50XV1cIikgKi9cbiAgICByYXdSZWZlcmVuY2U6IHN0cmluZztcbiAgICBcbiAgICAvKiogU3BlY2lmaWMgcHJvcGVydHkgdG8gZXh0cmFjdCAoZS5nLiwgXCJbW2RvYyNwcm9wZXJ0eV1dXCIpICovXG4gICAgcHJvcGVydHk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTXVsdGlEb2NDb250ZXh0IHtcbiAgICAvKiogRG9jdW1lbnRzIGluIHBlcnNpc3RlbnQgY29udGV4dCAqL1xuICAgIHBlcnNpc3RlbnREb2NzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIFxuICAgIC8qKiBDb21iaW5lZCBjb250ZXh0IHN0cmluZyAqL1xuICAgIGNvbnRleHRTdHJpbmc6IHN0cmluZztcbiAgICBcbiAgICAvKiogRXN0aW1hdGVkIHRva2VuIGNvdW50ICovXG4gICAgdG9rZW5Db3VudDogbnVtYmVyO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHdlJ3JlIGFwcHJvYWNoaW5nIHRva2VuIGxpbWl0ICovXG4gICAgaXNOZWFyTGltaXQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBNdWx0aURvY0NvbnRleHRIYW5kbGVyIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGVyc2lzdGVudENvbnRleHQ6IE1hcDxzdHJpbmcsIERvY3VtZW50UmVmZXJlbmNlW10+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgVE9LRU5fTElNSVQgPSA4MDAwO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgV0FSTklOR19USFJFU0hPTEQgPSAwLjg7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIG1lc3NhZ2UgZm9yIGRvY3VtZW50IHJlZmVyZW5jZXNcbiAgICAgKi9cbiAgICBwYXJzZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCBjb252ZXJzYXRpb25GaWxlUGF0aDogc3RyaW5nKToge1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIH0ge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdID0gW107XG4gICAgICAgIGxldCBjbGVhbmVkTWVzc2FnZSA9IG1lc3NhZ2U7XG5cbiAgICAgICAgLy8gUGF0dGVybiB0byBtYXRjaCBbW2RvY11dIGFuZCArW1tkb2NdXSB3aXRoIG9wdGlvbmFsIHByb3BlcnR5XG4gICAgICAgIC8vIE5vdGU6IEFsbCBkb2N1bWVudCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuICAgICAgICBjb25zdCByZWZQYXR0ZXJuID0gLyhcXCspP1xcW1xcWyhbXlxcXV0rPykoPzojKFteXFxdXSs/KSk/XFxdXFxdL2c7XG4gICAgICAgIFxuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuICAgICAgICAgICAgY29uc3QgcmF3UmVmZXJlbmNlID0gbWF0Y2hbMF07XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBmaWxlXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZShkb2NOYW1lKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICBpc1BlcnNpc3RlbnQ6IHRydWUsIC8vIEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudFxuICAgICAgICAgICAgICAgICAgICByYXdSZWZlcmVuY2UsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgYWxsIGZvdW5kIHJlZmVyZW5jZXMgZnJvbSBtZXNzYWdlXG4gICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZShyZWYucmF3UmVmZXJlbmNlLCAnICcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYW4gdXAgZXhjZXNzaXZlIHNwYWNlcyBidXQgcHJlc2VydmUgbmVjZXNzYXJ5IHNwYWNpbmdcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2UgPSBjbGVhbmVkTWVzc2FnZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJykudHJpbSgpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgIGNvbnN0IHBlcnNpc3RlbnRSZWZzID0gcmVmZXJlbmNlcy5maWx0ZXIocmVmID0+IHJlZi5pc1BlcnNpc3RlbnQpO1xuICAgICAgICBpZiAocGVyc2lzdGVudFJlZnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjb252ZXJzYXRpb25GaWxlUGF0aCkgfHwgW107XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcGVyc2lzdGVudFJlZnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY29udmVyc2F0aW9uRmlsZVBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IGNsZWFuZWRNZXNzYWdlLCByZWZlcmVuY2VzIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29tcGxldGUgY29udGV4dCBpbmNsdWRpbmcgcGVyc2lzdGVudCBkb2N1bWVudHNcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbnRleHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgY3VycmVudEZpbGU6IFRGaWxlLFxuICAgICAgICBjb252ZXJzYXRpb25EYXRhPzogQ29udmVyc2F0aW9uRGF0YVxuICAgICk6IFByb21pc2U8e1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICBjb250ZXh0OiBNdWx0aURvY0NvbnRleHQ7XG4gICAgfT4ge1xuICAgICAgICAvLyBQYXJzZSBjdXJyZW50IG1lc3NhZ2VcbiAgICAgICAgY29uc3QgeyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9ID0gdGhpcy5wYXJzZU1lc3NhZ2UobWVzc2FnZSwgY3VycmVudEZpbGUucGF0aCk7XG5cbiAgICAgICAgLy8gR2V0IGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgdGhpcyBjb252ZXJzYXRpb25cbiAgICAgICAgY29uc3QgZXhpc3RpbmdQZXJzaXN0ZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY3VycmVudEZpbGUucGF0aCkgfHwgW107XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdG8gcGVyc2lzdGVudCBjb250ZXh0IChhbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQpXG4gICAgICAgIGlmIChyZWZlcmVuY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRQZXJzaXN0ZW50ID0gWy4uLmV4aXN0aW5nUGVyc2lzdGVudF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcmVmZXJlbmNlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHVwZGF0ZWRQZXJzaXN0ZW50LnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcuZmlsZS5wYXRoID09PSByZWYuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGVyc2lzdGVudC5wdXNoKHJlZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjdXJyZW50RmlsZS5wYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmaW5hbCBwZXJzaXN0ZW50IGNvbnRleHQgKGluY2x1ZGluZyBuZXdseSBhZGRlZCBkb2NzKVxuICAgICAgICBjb25zdCByYXdQZXJzaXN0ZW50RG9jcyA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsdGVyIG91dCBhbnkgc3RhbGUgZmlsZSByZWZlcmVuY2VzIChmaWxlcyB0aGF0IG5vIGxvbmdlciBleGlzdClcbiAgICAgICAgY29uc3QgYWxsUGVyc2lzdGVudERvY3MgPSByYXdQZXJzaXN0ZW50RG9jcy5maWx0ZXIoZG9jUmVmID0+IHtcbiAgICAgICAgICAgIGlmICghZG9jUmVmPy5maWxlIHx8ICF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZG9jUmVmLmZpbGUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFJlbW92aW5nIHN0YWxlIGZpbGUgcmVmZXJlbmNlOiAke2RvY1JlZj8uZmlsZT8ucGF0aCB8fCAndW5rbm93bid9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBwZXJzaXN0ZW50IGNvbnRleHQgdG8gcmVtb3ZlIHN0YWxlIHJlZmVyZW5jZXNcbiAgICAgICAgaWYgKGFsbFBlcnNpc3RlbnREb2NzLmxlbmd0aCAhPT0gcmF3UGVyc2lzdGVudERvY3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoYWxsUGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGN1cnJlbnRGaWxlLnBhdGgsIGFsbFBlcnNpc3RlbnREb2NzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoY3VycmVudEZpbGUucGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IHN0cmluZyBmcm9tIGFsbCBkb2N1bWVudHNcbiAgICAgICAgY29uc3QgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQUxXQVlTIGluY2x1ZGUgY3VycmVudCBmaWxlIGNvbnRlbnQgYW5kIG1ldGFkYXRhIGZpcnN0IChpbXBsaWNpdCBjb250ZXh0KVxuICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNvbnRleHQgPSBhd2FpdCB0aGlzLmdldEZ1bGxEb2N1bWVudENvbnRleHQoY3VycmVudEZpbGUsIHRydWUsIDEwMCk7XG4gICAgICAgIGlmIChjdXJyZW50RmlsZUNvbnRleHQpIHtcbiAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGN1cnJlbnRGaWxlQ29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRoZW4gYWRkIGFsbCBwZXJzaXN0ZW50IGRvY3VtZW50cyB3aXRoIHRoZWlyIG1ldGFkYXRhXG4gICAgICAgIGZvciAoY29uc3QgZG9jUmVmIG9mIGFsbFBlcnNpc3RlbnREb2NzKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0UGFydCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGRvY1JlZik7XG4gICAgICAgICAgICBpZiAoY29udGV4dFBhcnQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChjb250ZXh0UGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0U3RyaW5nID0gY29udGV4dFBhcnRzLmpvaW4oJ1xcblxcbi0tLVxcblxcbicpO1xuICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5lc3RpbWF0ZVRva2Vucyhjb250ZXh0U3RyaW5nKTtcbiAgICAgICAgY29uc3QgaXNOZWFyTGltaXQgPSB0b2tlbkNvdW50ID4gKHRoaXMuVE9LRU5fTElNSVQgKiB0aGlzLldBUk5JTkdfVEhSRVNIT0xEKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2xlYW5lZE1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgcGVyc2lzdGVudERvY3M6IGFsbFBlcnNpc3RlbnREb2NzLFxuICAgICAgICAgICAgICAgIGNvbnRleHRTdHJpbmcsXG4gICAgICAgICAgICAgICAgdG9rZW5Db3VudCxcbiAgICAgICAgICAgICAgICBpc05lYXJMaW1pdFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmdWxsIGRvY3VtZW50IGNvbnRleHQgaW5jbHVkaW5nIG1ldGFkYXRhL3Byb3BlcnRpZXNcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldEZ1bGxEb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUsIGluY2x1ZGVDb250ZW50OiBib29sZWFuID0gdHJ1ZSwgbWF4TGluZXM6IG51bWJlciA9IDUwKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgZG9jdW1lbnQgaGVhZGVyXG4gICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChgIyMgRG9jdW1lbnQ6ICR7ZmlsZS5iYXNlbmFtZX1gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IGFuZCBhZGQgbWV0YWRhdGEvcHJvcGVydGllcyBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyICYmIE9iamVjdC5rZXlzKGNhY2hlLmZyb250bWF0dGVyKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJ1xcbiMjIyBQcm9wZXJ0aWVzL01ldGFkYXRhOicpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNhY2hlLmZyb250bWF0dGVyKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3JtYXQgdGhlIHByb3BlcnR5IHZhbHVlIChoYW5kbGUgYXJyYXlzLCBvYmplY3RzLCBldGMuKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goYC0gJHtrZXl9OiAke2Zvcm1hdHRlZFZhbHVlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGNvbnRlbnQgaWYgcmVxdWVzdGVkXG4gICAgICAgICAgICBpZiAoaW5jbHVkZUNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCBmcm9udG1hdHRlciBpbiBjb250ZW50IGRpc3BsYXkgKGJldHdlZW4gLS0tIG1hcmtlcnMpXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50U3RhcnRJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsaW5lc1swXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZXNbaV0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRTdGFydEluZGV4ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudExpbmVzID0gbGluZXMuc2xpY2UoY29udGVudFN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gY29udGVudExpbmVzLnNsaWNlKDAsIG1heExpbmVzKS5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2FzVHJ1bmNhdGVkID0gY29udGVudExpbmVzLmxlbmd0aCA+IG1heExpbmVzO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJ1xcbiMjIyBDb250ZW50OicpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCh0cnVuY2F0ZWRDb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdhc1RydW5jYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJ1xcblsuLi4gdHJ1bmNhdGVkIGZvciBicmV2aXR5IC4uLl0nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHRQYXJ0cy5qb2luKCdcXG4nKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byByZWFkIGZ1bGwgY29udGV4dCBmcm9tICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb250ZXh0IGZvciBhIHNwZWNpZmljIGRvY3VtZW50IHJlZmVyZW5jZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KGRvY1JlZjogRG9jdW1lbnRSZWZlcmVuY2UpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHsgZmlsZSwgcHJvcGVydHkgfSA9IGRvY1JlZjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgZmlsZSBzdGlsbCBleGlzdHMgaW4gdGhlIHZhdWx0XG4gICAgICAgICAgICBpZiAoIWZpbGUgfHwgIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBGaWxlIG5vIGxvbmdlciBleGlzdHM6ICR7ZmlsZT8ucGF0aCB8fCAndW5rbm93bid9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBzcGVjaWZpYyBwcm9wZXJ0eSBmcm9tIGZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyICYmIGNhY2hlLmZyb250bWF0dGVyW3Byb3BlcnR5XSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYCMjICR7ZmlsZS5iYXNlbmFtZX0gLSAke3Byb3BlcnR5fVxcbiR7Y2FjaGUuZnJvbnRtYXR0ZXJbcHJvcGVydHldfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgZnVsbCBkb2N1bWVudCBjb250ZXh0IHdpdGggbWV0YWRhdGFcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGdWxsRG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHJlYWQgY29udGV4dCBmcm9tICR7ZG9jUmVmPy5maWxlPy5wYXRoIHx8ICd1bmtub3duIGZpbGUnfTpgLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgYSBmaWxlIGJ5IG5hbWUgb3IgcGF0aFxuICAgICAqL1xuICAgIHByaXZhdGUgZmluZEZpbGUobmFtZU9yUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcbiAgICAgICAgbGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG4gICAgICAgICAgICBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgIC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgICAgICBmaWxlID0gZmlsZXMuZmluZChmID0+IFxuICAgICAgICAgICAgICAgIGYuYmFzZW5hbWUgPT09IG5hbWVPclBhdGggfHwgXG4gICAgICAgICAgICAgICAgZi5uYW1lID09PSBuYW1lT3JQYXRoIHx8XG4gICAgICAgICAgICAgICAgZi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG4gICAgICAgICAgICAgICAgZi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGggKyAnLm1kJylcbiAgICAgICAgICAgICkgfHwgbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGZpbGUgOiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgYSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBjbGVhclBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoZmlsZVBhdGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgZ2V0UGVyc2lzdGVudENvbnRleHQoZmlsZVBhdGg6IHN0cmluZyk6IERvY3VtZW50UmVmZXJlbmNlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoZmlsZVBhdGgpIHx8IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHNwZWNpZmljIGRvY3VtZW50IGZyb20gcGVyc2lzdGVudCBjb250ZXh0XG4gICAgICovXG4gICAgcmVtb3ZlUGVyc2lzdGVudERvYyhmaWxlUGF0aDogc3RyaW5nLCBkb2NUb1JlbW92ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChmaWxlUGF0aCkgfHwgW107XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gY3VycmVudC5maWx0ZXIocmVmID0+IHJlZi5maWxlLnBhdGggIT09IGRvY1RvUmVtb3ZlKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChmaWxlUGF0aCwgZmlsdGVyZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoZmlsZVBhdGgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdG9rZW4gY291bnQgKHJvdWdoIGFwcHJveGltYXRpb24pXG4gICAgICovXG4gICAgcHJpdmF0ZSBlc3RpbWF0ZVRva2Vucyh0ZXh0OiBzdHJpbmcpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0ZTogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0ZXh0Lmxlbmd0aCAvIDQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB2aXN1YWwgaW5kaWNhdG9ycyBmb3IgY29udGV4dCBzdGF0ZVxuICAgICAqL1xuICAgIGdldENvbnRleHRJbmRpY2F0b3JzKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBjbGFzc05hbWU6IHN0cmluZztcbiAgICAgICAgdG9vbHRpcDogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBkb2NDb3VudCA9IGNvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuICAgICAgICBjb25zdCBwZXJjZW50YWdlID0gTWF0aC5yb3VuZCgoY29udGV4dC50b2tlbkNvdW50IC8gdGhpcy5UT0tFTl9MSU1JVCkgKiAxMDApO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNsYXNzTmFtZSA9ICdub3ZhLWNvbnRleHQtaW5kaWNhdG9yJztcbiAgICAgICAgbGV0IHRvb2x0aXAgPSBgQ29udGV4dDogJHtkb2NDb3VudH0gZG9jdW1lbnQke2RvY0NvdW50ICE9PSAxID8gJ3MnIDogJyd9LCB+JHtjb250ZXh0LnRva2VuQ291bnR9IHRva2Vuc2A7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udGV4dC5pc05lYXJMaW1pdCkge1xuICAgICAgICAgICAgY2xhc3NOYW1lICs9ICcgbm92YS1jb250ZXh0LXdhcm5pbmcnO1xuICAgICAgICAgICAgdG9vbHRpcCArPSAnIChhcHByb2FjaGluZyBsaW1pdCknO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0ZXh0ID0gYCR7ZG9jQ291bnR9IGRvY3MgJHtwZXJjZW50YWdlfSVgO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHsgdGV4dCwgY2xhc3NOYW1lLCB0b29sdGlwIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9ybWF0IGNvbnRleHQgZm9yIGRpc3BsYXkgaW4gVUlcbiAgICAgKi9cbiAgICBmb3JtYXRDb250ZXh0Rm9yRGlzcGxheShjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHBlcnNpc3RlbnQgZG9jdW1lbnRzXG4gICAgICAgIGZvciAoY29uc3QgZG9jIG9mIGNvbnRleHQucGVyc2lzdGVudERvY3MpIHtcbiAgICAgICAgICAgIGl0ZW1zLnB1c2goYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtkb2MucHJvcGVydHkgPyBgIyR7ZG9jLnByb3BlcnR5fWAgOiAnJ31gKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb3JlIGRvY3VtZW50IGVuZ2luZSBmb3IgTm92YVxuICogSGFuZGxlcyBhbGwgZG9jdW1lbnQgbWFuaXB1bGF0aW9uIGFuZCBlZGl0b3IgaW50ZXJhY3Rpb25zXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgVEZpbGUsIEVkaXRvclBvc2l0aW9uLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudENvbnRleHQsIEhlYWRpbmdJbmZvLCBFZGl0UmVzdWx0LCBFZGl0T3B0aW9ucywgRG9jdW1lbnRTZWN0aW9uLCBFZGl0Q29tbWFuZCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciwgRGF0YVN0b3JlIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudEVuZ2luZSB7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyIHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBkYXRhU3RvcmU/OiBEYXRhU3RvcmUpIHtcbiAgICAgICAgaWYgKGRhdGFTdG9yZSkge1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjb252ZXJzYXRpb24gbWFuYWdlciAoZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uKVxuICAgICAqL1xuICAgIHNldENvbnZlcnNhdGlvbk1hbmFnZXIoY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBjb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYWN0aXZlIGVkaXRvciBpbnN0YW5jZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUVkaXRvcigpOiBFZGl0b3IgfCBudWxsIHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5IHRoZSB3b3Jrc3BhY2UgbWV0aG9kXG4gICAgICAgIGNvbnN0IGFjdGl2ZUVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVFZGl0b3I7XG4gICAgICAgIGlmIChhY3RpdmVFZGl0b3I/LmVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZUVkaXRvci5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBnZXQgdGhlIGFjdGl2ZSBtYXJrZG93biB2aWV3XG4gICAgICAgIGxldCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG5vIGFjdGl2ZSBtYXJrZG93biB2aWV3LCB0cnkgdG8gZmluZCBhbnkgbWFya2Rvd24gdmlld1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZlZpZXcgPSBsZWFmLnZpZXc7XG4gICAgICAgICAgICAgICAgaWYgKGxlYWZWaWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcgPSBsZWFmVmlldztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUcnkgZGlmZmVyZW50IHdheXMgdG8gZ2V0IHRoZSBlZGl0b3JcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdmlldy5lZGl0b3I7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yIHx8IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZmlsZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUZpbGUoKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgdGV4dFxuICAgICAqL1xuICAgIGdldFNlbGVjdGVkVGV4dCgpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgZ2V0Q3Vyc29yUG9zaXRpb24oKTogRWRpdG9yUG9zaXRpb24gfCBudWxsIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGNvbXByZWhlbnNpdmUgZG9jdW1lbnQgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGdldERvY3VtZW50Q29udGV4dCgpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICFlZGl0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSB0aGlzLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHRoaXMuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSB0aGUgZG9jdW1lbnRcbiAgICAgICAgY29uc3QgaGVhZGluZ3MgPSB0aGlzLmV4dHJhY3RIZWFkaW5ncyhjb250ZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBzdXJyb3VuZGluZyBsaW5lcyBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBzdXJyb3VuZGluZ0xpbmVzID0gY3Vyc29yUG9zaXRpb24gPyBcbiAgICAgICAgICAgIHRoaXMuZ2V0U3Vycm91bmRpbmdMaW5lcyhjb250ZW50LCBjdXJzb3JQb3NpdGlvbi5saW5lKSA6IFxuICAgICAgICAgICAgdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgaGVhZGluZ3MsXG4gICAgICAgICAgICBzZWxlY3RlZFRleHQ6IHNlbGVjdGVkVGV4dCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBjdXJzb3JQb3NpdGlvbjogY3Vyc29yUG9zaXRpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0SGVhZGluZ3MoY29udGVudDogc3RyaW5nKTogSGVhZGluZ0luZm9bXSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGhlYWRpbmdzOiBIZWFkaW5nSW5mb1tdID0gW107XG4gICAgICAgIGxldCBjaGFyQ291bnQgPSAwO1xuXG4gICAgICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGhlYWRpbmdNYXRjaFsyXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWFkaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGNoYXJDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogY2hhckNvdW50ICsgbGluZS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbGluZSBsZW5ndGggKyBuZXdsaW5lIGNoYXJhY3RlclxuICAgICAgICAgICAgY2hhckNvdW50ICs9IGxpbmUubGVuZ3RoICsgMTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGhlYWRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBsaW5lcyBzdXJyb3VuZGluZyB0aGUgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRTdXJyb3VuZGluZ0xpbmVzKFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjdXJyZW50TGluZTogbnVtYmVyLCBcbiAgICAgICAgY29udGV4dFNpemU6IG51bWJlciA9IDVcbiAgICApOiB7IGJlZm9yZTogc3RyaW5nW107IGFmdGVyOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IE1hdGgubWF4KDAsIGN1cnJlbnRMaW5lIC0gY29udGV4dFNpemUpO1xuICAgICAgICBjb25zdCBlbmRMaW5lID0gTWF0aC5taW4obGluZXMubGVuZ3RoIC0gMSwgY3VycmVudExpbmUgKyBjb250ZXh0U2l6ZSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmVmb3JlOiBsaW5lcy5zbGljZShzdGFydExpbmUsIGN1cnJlbnRMaW5lKSxcbiAgICAgICAgICAgIGFmdGVyOiBsaW5lcy5zbGljZShjdXJyZW50TGluZSArIDEsIGVuZExpbmUgKyAxKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGFuIGVkaXQgdG8gdGhlIGRvY3VtZW50XG4gICAgICovXG4gICAgYXN5bmMgYXBwbHlFZGl0KFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgICAgIHBvc2l0aW9uOiAnY3Vyc29yJyB8ICdzZWxlY3Rpb24nIHwgJ2VuZCcgfCB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9LFxuICAgICAgICBvcHRpb25zOiBFZGl0T3B0aW9ucyA9IHt9XG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBvciBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGFwcGxpZWRBdDogRWRpdG9yUG9zaXRpb247XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2N1cnNvcicpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oY29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnZW5kJykge1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZSA9IGVkaXRvci5sYXN0TGluZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gZWRpdG9yLmdldExpbmUobGFzdExpbmUpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSB7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50Q29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBjdXJyZW50Q29udGVudCArIChjdXJyZW50Q29udGVudC5lbmRzV2l0aCgnXFxuJykgPyAnJyA6ICdcXG4nKSArIGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXNlIHZhdWx0Lm1vZGlmeSBmb3IgdW5kby9yZWRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBzcGVjaWZpYyBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGFuZGxlIHBvc3QtZWRpdCBvcHRpb25zXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zZWxlY3ROZXdUZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0ge1xuICAgICAgICAgICAgICAgICAgICBsaW5lOiBhcHBsaWVkQXQubGluZSArIGNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjb250ZW50LmluY2x1ZGVzKCdcXG4nKSA/IFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5zcGxpdCgnXFxuJykucG9wKCkhLmxlbmd0aCA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0LmNoICsgY29udGVudC5sZW5ndGhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTZWxlY3Rpb24oYXBwbGllZEF0LCBlbmRQb3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zY3JvbGxUb0VkaXQpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBhcHBsaWVkQXQsXG4gICAgICAgICAgICAgICAgICAgIHRvOiBhcHBsaWVkQXRcbiAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6IHBvc2l0aW9uID09PSAnc2VsZWN0aW9uJyA/ICdyZXBsYWNlJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID09PSAnZW5kJyA/ICdhcHBlbmQnIDogJ2luc2VydCcsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgY29udGVudCBhdCBhIHNwZWNpZmljIGxvY2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlQ29udGVudChcbiAgICAgICAgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdsaW5lJyB8ICdzZWN0aW9uJyxcbiAgICAgICAgbG9jYXRpb24/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCcnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdsaW5lJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gY3Vyc29yLmxpbmU7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZSwgY2g6IDAgfSwgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogbGluZSArIDEsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmUsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmZpbmRTZWN0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtsb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgc2VjdGlvbiBpbmNsdWRpbmcgaXRzIGhlYWRpbmdcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaW5lcyA9IGxpbmVzLmZpbHRlcigoXywgaW5kZXgpID0+IFxuICAgICAgICAgICAgICAgICAgICBpbmRleCA8IHNlY3Rpb24ucmFuZ2Uuc3RhcnQgfHwgaW5kZXggPiBzZWN0aW9uLnJhbmdlLmVuZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0xpbmVzLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRlIHRhcmdldCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc2VjdGlvbiBieSBoZWFkaW5nIG5hbWVcbiAgICAgKi9cbiAgICBhc3luYyBmaW5kU2VjdGlvbihoZWFkaW5nVGV4dDogc3RyaW5nKTogUHJvbWlzZTxEb2N1bWVudFNlY3Rpb24gfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWNvbnRleHQpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IGhlYWRpbmdJbmRleCA9IGNvbnRleHQuaGVhZGluZ3MuZmluZEluZGV4KGggPT4gXG4gICAgICAgICAgICBoLnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhoZWFkaW5nVGV4dC50b0xvd2VyQ2FzZSgpKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChoZWFkaW5nSW5kZXggPT09IC0xKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBoZWFkaW5nID0gY29udGV4dC5oZWFkaW5nc1toZWFkaW5nSW5kZXhdO1xuICAgICAgICBjb25zdCBuZXh0SGVhZGluZyA9IGNvbnRleHQuaGVhZGluZ3NbaGVhZGluZ0luZGV4ICsgMV07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBuZXh0SGVhZGluZyA/IG5leHRIZWFkaW5nLmxpbmUgLSAxIDogbGluZXMubGVuZ3RoIC0gMTtcblxuICAgICAgICAvLyBFeHRyYWN0IHNlY3Rpb24gY29udGVudCAoZXhjbHVkaW5nIHRoZSBoZWFkaW5nIGxpbmUpXG4gICAgICAgIGNvbnN0IHNlY3Rpb25MaW5lcyA9IGxpbmVzLnNsaWNlKGhlYWRpbmcubGluZSArIDEsIGVuZExpbmUgKyAxKTtcbiAgICAgICAgY29uc3Qgc2VjdGlvbkNvbnRlbnQgPSBzZWN0aW9uTGluZXMuam9pbignXFxuJykudHJpbSgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoZWFkaW5nOiBoZWFkaW5nLnRleHQsXG4gICAgICAgICAgICBsZXZlbDogaGVhZGluZy5sZXZlbCxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHNlY3Rpb25Db250ZW50LFxuICAgICAgICAgICAgcmFuZ2U6IHtcbiAgICAgICAgICAgICAgICBzdGFydDogaGVhZGluZy5saW5lLFxuICAgICAgICAgICAgICAgIGVuZDogZW5kTGluZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZW50KCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZW50aXJlIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBzZXREb2N1bWVudENvbnRlbnQoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJzYXRpb24gbWFuYWdlbWVudCBtZXRob2RzXG5cbiAgICAvKipcbiAgICAgKiBBZGQgdXNlciBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgY29tbWFuZD86IEVkaXRDb21tYW5kKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoZmlsZSwgY29udGVudCwgY29tbWFuZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYXNzaXN0YW50IHJlc3BvbnNlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoY29udGVudDogc3RyaW5nLCByZXN1bHQ/OiBFZGl0UmVzdWx0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShmaWxlLCBjb250ZW50LCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN5c3RlbSBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkU3lzdGVtTWVzc2FnZShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBmb3IgQUkgcHJvbXB0c1xuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbkNvbnRleHQobWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljcyBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uU3RhdHMoKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFN0YXRzKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGN1cnJlbnQgZmlsZSBoYXMgYW4gYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbigpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmhhc0NvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZXhwb3J0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlciBmb3IgTm92YVxuICogSGFuZGxlcyBmaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gc3RvcmFnZSBhbmQgcmV0cmlldmFsXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhLCBDb252ZXJzYXRpb25NZXNzYWdlLCBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRWRpdEFjdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTdG9yZSB7XG4gICAgbG9hZERhdGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gICAgc2F2ZURhdGEoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbnM6IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbkRhdGE+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgbWF4TWVzc2FnZXNQZXJGaWxlID0gMTAwOyAvLyBMaW1pdCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgIHByaXZhdGUgc3RvcmFnZUtleSA9ICdub3ZhLWNvbnZlcnNhdGlvbnMnO1xuICAgIHByaXZhdGUgY2xlYW51cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0YVN0b3JlOiBEYXRhU3RvcmUpIHtcbiAgICAgICAgdGhpcy5sb2FkQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBjb252ZXJzYXRpb25zIGZyb20gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZGF0YVN0b3JlLmxvYWREYXRhKHRoaXMuc3RvcmFnZUtleSk7XG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb252ZXJzYXRpb24gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGNvbnZlcnNhdGlvbi5maWxlUGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBkYXRhOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhdmUgY29udmVyc2F0aW9ucyB0byBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25zQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy52YWx1ZXMoKSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRhdGFTdG9yZS5zYXZlRGF0YSh0aGlzLnN0b3JhZ2VLZXksIGNvbnZlcnNhdGlvbnNBcnJheSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBjb252ZXJzYXRpb24gZGF0YTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGZvciBhIHNwZWNpZmljIGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBDb252ZXJzYXRpb25EYXRhIHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9ucy5oYXMoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNvbnZlcnNhdGlvbiBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICBjb25zdCBuZXdDb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZEZyZXF1ZW5jeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXdyaXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGZpbGVQYXRoLCBuZXdDb252ZXJzYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZVBhdGgpITtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSB1c2VyIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIGNvbW1hbmRcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBVcGRhdGUgY29tbWFuZCBmcmVxdWVuY3kgaWYgY29tbWFuZCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZCAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5W2NvbW1hbmQuYWN0aW9uXSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gYXNzaXN0YW50IHJlc3BvbnNlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSxcbiAgICAgICAgY29udGVudDogc3RyaW5nLFxuICAgICAgICByZXN1bHQ/OiBFZGl0UmVzdWx0XG4gICAgKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICByZXN1bHRcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBJbmNyZW1lbnQgZWRpdCBjb3VudCBpZiByZXN1bHQgaW5kaWNhdGVzIHN1Y2Nlc3NmdWwgZWRpdFxuICAgICAgICBpZiAocmVzdWx0Py5zdWNjZXNzICYmIGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmVkaXRDb3VudCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBzeXN0ZW0gbWVzc2FnZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkU3lzdGVtTWVzc2FnZShmaWxlOiBURmlsZSwgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCByZWNlbnQgbWVzc2FnZXMgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRSZWNlbnRNZXNzYWdlcyhmaWxlOiBURmlsZSwgY291bnQ6IG51bWJlciA9IDEwKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLWNvdW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbWVzc2FnZXMgYnkgcm9sZVxuICAgICAqL1xuICAgIGdldE1lc3NhZ2VzQnlSb2xlKGZpbGU6IFRGaWxlLCByb2xlOiBDb252ZXJzYXRpb25NZXNzYWdlWydyb2xlJ10pOiBDb252ZXJzYXRpb25NZXNzYWdlW10ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5yb2xlID09PSByb2xlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGU6IFRGaWxlLCBtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0TGluZXMgPSBtZXNzYWdlcy5tYXAobXNnID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZygpO1xuICAgICAgICAgICAgbGV0IGxpbmUgPSBgWyR7dGltZXN0YW1wfV0gJHttc2cucm9sZS50b1VwcGVyQ2FzZSgpfTogJHttc2cuY29udGVudH1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobXNnLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKENvbW1hbmQ6ICR7bXNnLmNvbW1hbmQuYWN0aW9ufSAke21zZy5jb21tYW5kLnRhcmdldH0pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKFJlc3VsdDogJHttc2cucmVzdWx0LnN1Y2Nlc3MgPyAnc3VjY2VzcycgOiAnZmFpbGVkJ30pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBgUHJldmlvdXMgY29udmVyc2F0aW9uOlxcbiR7Y29udGV4dExpbmVzLmpvaW4oJ1xcbicpfVxcbmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gW107XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50ID0gMDtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5ID0ge1xuICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzXG4gICAgICovXG4gICAgZ2V0U3RhdHMoZmlsZTogVEZpbGUpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgbWF4Q291bnQgPSAwO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBbYWN0aW9uLCBjb3VudF0gb2YgT2JqZWN0LmVudHJpZXMoY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kID0gYWN0aW9uIGFzIEVkaXRBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IERhdGUubm93KCkgLSBjb252ZXJzYXRpb24ubWVzc2FnZXNbMF0udGltZXN0YW1wXG4gICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2VDb3VudDogY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCxcbiAgICAgICAgICAgIGVkaXRDb3VudDogY29udmVyc2F0aW9uLm1ldGFkYXRhPy5lZGl0Q291bnQgfHwgMCxcbiAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkFnZVxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0IGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgZXhwb3J0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gW2AjIENvbnZlcnNhdGlvbiBIaXN0b3J5IGZvciAke2ZpbGUubmFtZX1gLCAnJ107XG5cbiAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGNvbnZlcnNhdGlvbi5tZXNzYWdlcykge1xuICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUobWVzc2FnZS50aW1lc3RhbXApLnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKGAjIyAke21lc3NhZ2Uucm9sZS50b1VwcGVyQ2FzZSgpfSAoJHt0aW1lc3RhbXB9KWApO1xuICAgICAgICAgICAgbGluZXMucHVzaChtZXNzYWdlLmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkNvbW1hbmQ6ICR7bWVzc2FnZS5jb21tYW5kLmFjdGlvbn0gJHttZXNzYWdlLmNvbW1hbmQudGFyZ2V0fSpgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKlJlc3VsdDogJHttZXNzYWdlLnJlc3VsdC5zdWNjZXNzID8gJ1N1Y2Nlc3MnIDogJ0ZhaWxlZCd9KmApO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqRXJyb3I6ICR7bWVzc2FnZS5yZXN1bHQuZXJyb3J9KmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGluZXMucHVzaCgnJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGluZXMuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgdW5pcXVlIG1lc3NhZ2UgSURcbiAgICAgKi9cbiAgICBwcml2YXRlIGdlbmVyYXRlTWVzc2FnZUlkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgbXNnXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmltIGNvbnZlcnNhdGlvbiB0byBtYXggbGVuZ3RoIGFuZCBzYXZlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB0cmltQW5kU2F2ZShjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiB0aGlzLm1heE1lc3NhZ2VzUGVyRmlsZSkge1xuICAgICAgICAgICAgLy8gS2VlcCB0aGUgbW9zdCByZWNlbnQgbWVzc2FnZXNcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5zbGljZSgtdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjb252ZXJzYXRpb24gZmlsZSBwYXRoc1xuICAgICAqL1xuICAgIGdldEFsbENvbnZlcnNhdGlvbkZpbGVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5jb252ZXJzYXRpb25zLmtleXMoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZmlsZSBoYXMgYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGUucGF0aCk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24gPyBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjb252ZXJzYXRpb24gZmlsZSBwYXRoIChmb3IgZmlsZSByZW5hbWVzKVxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZUZpbGVQYXRoKG9sZFBhdGg6IHN0cmluZywgbmV3UGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQob2xkUGF0aCk7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5maWxlUGF0aCA9IG5ld1BhdGg7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKG9sZFBhdGgpO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChuZXdQYXRoLCBjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcGVyaW9kaWMgY2xlYW51cCBvZiBvbGQgY29udmVyc2F0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRQZXJpb2RpY0NsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIC8vIENsZWFuIHVwIGV2ZXJ5IDI0IGhvdXJzXG4gICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cE9sZENvbnZlcnNhdGlvbnMoNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyA3IGRheXNcbiAgICAgICAgfSwgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgY29udmVyc2F0aW9ucyBvbGRlciB0aGFuIHRoZSBzcGVjaWZpZWQgYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBjbGVhbnVwT2xkQ29udmVyc2F0aW9ucyhtYXhBZ2U6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBsZXQgY2xlYW5lZCA9IGZhbHNlO1xuXG4gICAgICAgIGZvciAoY29uc3QgW2ZpbGVQYXRoLCBjb252ZXJzYXRpb25dIG9mIHRoaXMuY29udmVyc2F0aW9ucy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGNvbnZlcnNhdGlvbiBpcyBvbGQgYmFzZWQgb24gbGFzdCBtZXNzYWdlXG4gICAgICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlc1tjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgY29uc3QgYWdlID0gbm93IC0gbGFzdE1lc3NhZ2UudGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChhZ2UgPiBtYXhBZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShmaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFuZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjbGVhbmVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbnVwIG1ldGhvZCB0byBjYWxsIHdoZW4gcGx1Z2luIGlzIGRpc2FibGVkXG4gICAgICovXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY2xlYW51cEludGVydmFsICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuY2xlYW51cEludGVydmFsKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBDb250ZXh0IGJ1aWxkZXIgZm9yIE5vdmFcbiAqIEdlbmVyYXRlcyBhcHByb3ByaWF0ZSBwcm9tcHRzIGZvciBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIERvY3VtZW50U2VjdGlvbiwgUHJvbXB0Q29uZmlnLCBDb252ZXJzYXRpb25NZXNzYWdlIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogR2VuZXJhdGVkIHByb21wdCBmb3IgQUkgY29tcGxldGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlZFByb21wdCB7XG4gICAgLyoqIFN5c3RlbSBwcm9tcHQgZm9yIEFJIGNvbnRleHQgKi9cbiAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogVXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnMgKi9cbiAgICB1c2VyUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEFkZGl0aW9uYWwgY29udGV4dCBmb3IgdGhlIEFJICovXG4gICAgY29udGV4dDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBDb25maWd1cmF0aW9uIGZvciBBSSBnZW5lcmF0aW9uICovXG4gICAgY29uZmlnOiB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gICAgICAgIG1heFRva2VuczogbnVtYmVyO1xuICAgIH07XG59XG5cbi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBnZW5lcmF0aW5nIEFJIHByb21wdHNcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGRlZmF1bHRDb25maWc6IFByb21wdENvbmZpZyA9IHtcbiAgICAgICAgbWF4Q29udGV4dExpbmVzOiAyMCxcbiAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogdHJ1ZSxcbiAgICAgICAgaW5jbHVkZUhpc3Rvcnk6IGZhbHNlLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHNwZWNpZmljIGNvbW1hbmRcbiAgICAgKi9cbiAgICBidWlsZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fSxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHsgLi4udGhpcy5kZWZhdWx0Q29uZmlnLCAuLi5vcHRpb25zIH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSB0aGlzLmJ1aWxkU3lzdGVtUHJvbXB0KGNvbW1hbmQuYWN0aW9uLCBjb25maWcpO1xuICAgICAgICBjb25zdCBjb250ZXh0SW5mbyA9IHRoaXMuYnVpbGRDb250ZXh0SW5mbyhkb2N1bWVudENvbnRleHQsIGNvbW1hbmQsIGNvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgIGNvbnN0IHVzZXJQcm9tcHQgPSB0aGlzLmJ1aWxkVXNlclByb21wdChjb21tYW5kLCBjb250ZXh0SW5mbyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHRJbmZvLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IGNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBjb25maWcubWF4VG9rZW5zIHx8IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzeXN0ZW0gcHJvbXB0IGJhc2VkIG9uIGFjdGlvbiB0eXBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFN5c3RlbVByb21wdChhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSwgY29uZmlnOiBQcm9tcHRDb25maWcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBiYXNlUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyIHRoYXQgaGVscHMgdXNlcnMgZWRpdCBkb2N1bWVudHMgZGlyZWN0bHkuIFlvdSB3b3JrIHdpdGggTWFya2Rvd24gZG9jdW1lbnRzIGluIE9ic2lkaWFuLlxuXG5JTVBPUlRBTlQgR1VJREVMSU5FUzpcbi0gUHJvdmlkZSBPTkxZIHRoZSBjb250ZW50IHRvIGJlIGluc2VydGVkL21vZGlmaWVkLCBubyBleHBsYW5hdGlvbnMgb3IgbWV0YS10ZXh0XG4tIE1haW50YWluIHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIHN0eWxlIGFuZCB0b25lIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIFByZXNlcnZlIGZvcm1hdHRpbmcsIHN0cnVjdHVyZSwgYW5kIG1hcmtkb3duIHN5bnRheFxuLSBCZSBjb25jaXNlIGFuZCBmb2N1c2VkIG9uIHRoZSBzcGVjaWZpYyByZXF1ZXN0XG4tIERvIG5vdCBhZGQgc2VjdGlvbiBoZWFkZXJzIHVubGVzcyBzcGVjaWZpY2FsbHkgcmVxdWVzdGVkYDtcblxuICAgICAgICBjb25zdCBhY3Rpb25TcGVjaWZpY1Byb21wdHMgPSB7XG4gICAgICAgICAgICBhZGQ6IGBcblRBU0s6IEFkZCBuZXcgY29udGVudCB0byB0aGUgZG9jdW1lbnQuXG4tIENyZWF0ZSB3ZWxsLXN0cnVjdHVyZWQsIHJlbGV2YW50IGNvbnRlbnQgdGhhdCBmaXRzIHRoZSBkb2N1bWVudCdzIHB1cnBvc2Vcbi0gVXNlIGFwcHJvcHJpYXRlIG1hcmtkb3duIGZvcm1hdHRpbmcgKGhlYWRpbmdzLCBsaXN0cywgZW1waGFzaXMpXG4tIEVuc3VyZSBzbW9vdGggZmxvdyB3aXRoIGV4aXN0aW5nIGNvbnRlbnRcbi0gTWF0Y2ggdGhlIGRvY3VtZW50J3Mgc3R5bGUgYW5kIHRvbmVgLFxuXG4gICAgICAgICAgICBlZGl0OiBgXG5UQVNLOiBFZGl0IGFuZCBpbXByb3ZlIGV4aXN0aW5nIGNvbnRlbnQuXG4tIEVuaGFuY2UgY2xhcml0eSwgcmVhZGFiaWxpdHksIGFuZCBmbG93XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBtZWFuaW5nIHVubGVzcyBjaGFuZ2VzIGFyZSByZXF1ZXN0ZWRcbi0gSW1wcm92ZSB3b3JkIGNob2ljZSBhbmQgc2VudGVuY2Ugc3RydWN0dXJlXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCBmb3JtYXR0aW5nIGFuZCBzdHJ1Y3R1cmVgLFxuXG4gICAgICAgICAgICBkZWxldGU6IGBcblRBU0s6IFJlbW92ZSBzcGVjaWZpZWQgY29udGVudCBmcm9tIHRoZSBkb2N1bWVudC5cbi0gSWRlbnRpZnkgdGhlIGV4YWN0IGNvbnRlbnQgdG8gYmUgcmVtb3ZlZFxuLSBFbnN1cmUgcmVtYWluaW5nIGNvbnRlbnQgZmxvd3MgbmF0dXJhbGx5XG4tIFByZXNlcnZlIGRvY3VtZW50IHN0cnVjdHVyZSBhbmQgZm9ybWF0dGluZ1xuLSBDb25maXJtIHRoZSBkZWxldGlvbiBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIGNvbnRleHRgLFxuXG4gICAgICAgICAgICBncmFtbWFyOiBgXG5UQVNLOiBGaXggZ3JhbW1hciwgc3BlbGxpbmcsIGFuZCBsYW5ndWFnZSBpc3N1ZXMuXG4tIENvcnJlY3Qgc3BlbGxpbmcgZXJyb3JzLCBncmFtbWFyIG1pc3Rha2VzLCBhbmQgdHlwb3Ncbi0gSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUgYW5kIGNsYXJpdHlcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIHZvaWNlIGFuZCBzdHlsZVxuLSBQcmVzZXJ2ZSBhbGwgZm9ybWF0dGluZyBhbmQgbWFya2Rvd24gc3ludGF4XG4tIE1ha2UgbWluaW1hbCBjaGFuZ2VzIC0gb25seSBmaXggYWN0dWFsIGVycm9yc2AsXG5cbiAgICAgICAgICAgIHJld3JpdGU6IGBcblRBU0s6IFJld3JpdGUgb3IgcmVzdHJ1Y3R1cmUgY29udGVudC5cbi0gQ3JlYXRlIG5ldyBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2Vcbi0gSW1wcm92ZSBvcmdhbml6YXRpb24sIGNsYXJpdHksIGFuZCBmbG93XG4tIFVzZSBtb3JlIGVmZmVjdGl2ZSBsYW5ndWFnZSBhbmQgc3RydWN0dXJlXG4tIE1haW50YWluIGtleSBpbmZvcm1hdGlvbiBhbmQgY29uY2VwdHNcbi0gQWRhcHQgdG8gYW55IHNwZWNpZmllZCBzdHlsZSByZXF1aXJlbWVudHNgLFxuXG4gICAgICAgICAgICBtZXRhZGF0YTogYFxuVEFTSzogVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhL3Byb3BlcnRpZXMuXG4tIE1vZGlmeSwgYWRkLCBvciByZW1vdmUgZnJvbnRtYXR0ZXIgcHJvcGVydGllc1xuLSBIYW5kbGUgdGFncywgdGl0bGVzLCBkYXRlcywgYW5kIGN1c3RvbSBwcm9wZXJ0aWVzXG4tIE1haW50YWluIHByb3BlciBZQU1MIGZvcm1hdHRpbmdcbi0gUHJlc2VydmUgZXhpc3RpbmcgcHJvcGVydGllcyB1bmxlc3Mgc3BlY2lmaWNhbGx5IGNoYW5naW5nIHRoZW1cbi0gUHJvdmlkZSBPTkxZIHRoZSBwcm9wZXJ0eSB1cGRhdGVzIGluIEpTT04gZm9ybWF0YFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBiYXNlUHJvbXB0ICsgYWN0aW9uU3BlY2lmaWNQcm9tcHRzW2FjdGlvbl07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBgJHtjb250ZXh0SW5mb31cXG5cXG5VU0VSIFJFUVVFU1Q6ICR7Y29tbWFuZC5pbnN0cnVjdGlvbn1gO1xuXG4gICAgICAgIC8vIEFkZCBzcGVjaWZpYyBjb250ZXh0IGlmIHByb3ZpZGVkXG4gICAgICAgIGlmIChjb21tYW5kLmNvbnRleHQgJiYgY29tbWFuZC5jb250ZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBcXG5cXG5BRERJVElPTkFMIFJFUVVJUkVNRU5UUzogJHtjb21tYW5kLmNvbnRleHR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCB0YXJnZXQtc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICAgIGNvbnN0IHRhcmdldEluc3RydWN0aW9ucyA9IHRoaXMuZ2V0VGFyZ2V0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuICAgICAgICBpZiAodGFyZ2V0SW5zdHJ1Y3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbiR7dGFyZ2V0SW5zdHJ1Y3Rpb25zfWA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgYWN0aW9uLXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAgICBjb25zdCBhY3Rpb25JbnN0cnVjdGlvbnMgPSB0aGlzLmdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kKTtcbiAgICAgICAgaWYgKGFjdGlvbkluc3RydWN0aW9ucykge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBcXG5cXG4ke2FjdGlvbkluc3RydWN0aW9uc31gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGFyZ2V0LXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VGFyZ2V0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBXb3JrIHdpdGggdGhlIHNlbGVjdGVkIHRleHQgb25seS4gUHJvdmlkZSB0aGUgaW1wcm92ZWQgdmVyc2lvbiBvZiB0aGUgc2VsZWN0ZWQgY29udGVudC4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYEZPQ1VTOiBXb3JrIHdpdGggdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb24uICR7Y29tbWFuZC5hY3Rpb24gPT09ICdhZGQnID8gJ0FkZCBjb250ZW50IHRvIHRoaXMgc2VjdGlvbi4nIDogJ01vZGlmeSBvbmx5IHRoaXMgc2VjdGlvbi4nfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IFdvcmsgd2l0aCB0aGUgY3VycmVudCBzZWN0aW9uLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBBcHBseSBjaGFuZ2VzIHRvIHRoZSBlbnRpcmUgZG9jdW1lbnQgd2hpbGUgcHJlc2VydmluZyBpdHMgc3RydWN0dXJlLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogQWRkIGNvbnRlbnQgYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQuIEVuc3VyZSBpdCBmbG93cyBuYXR1cmFsbHkgZnJvbSBleGlzdGluZyBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogV29yayB3aXRoIHRoZSBjdXJyZW50IHBhcmFncmFwaCBvciBjcmVhdGUgYSBuZXcgcGFyYWdyYXBoLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFjdGlvbi1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgbmV3IGNvbnRlbnQgdG8gYmUgYWRkZWQuIEluY2x1ZGUgYXBwcm9wcmlhdGUgaGVhZGluZ3MgaWYgYWRkaW5nIGEgc2VjdGlvbi4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlLCBvciByZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGNvcnJlY3RlZCB0ZXh0IHdpdGggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZml4ZXMuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvbXBsZXRlbHkgcmV3cml0dGVuIGNvbnRlbnQgdGhhdCBzZXJ2ZXMgdGhlIHNhbWUgcHVycG9zZS4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgT05MWSBhIEpTT04gb2JqZWN0IHdpdGggdGhlIHByb3BlcnR5IHVwZGF0ZXMuIEV4YW1wbGU6IHtcInRpdGxlXCI6IFwiTmV3IFRpdGxlXCIsIFwidGFnc1wiOiBbXCJ0YWcxXCIsIFwidGFnMlwiXSwgXCJkYXRlXCI6IFwiMjAyNS0wMS0wMVwifSc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29udGV4dCBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb21wdFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRDb250ZXh0SW5mbyhcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBjb25maWc6IFByb21wdENvbmZpZyxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gYERPQ1VNRU5UOiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGUgYW5kIHJlcXVlc3RlZFxuICAgICAgICBpZiAoY29uZmlnLmluY2x1ZGVIaXN0b3J5ICYmIGNvbnZlcnNhdGlvbkNvbnRleHQgJiYgY29udmVyc2F0aW9uQ29udGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbiR7Y29udmVyc2F0aW9uQ29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IHN0cnVjdHVyZSBpZiByZXF1ZXN0ZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlU3RydWN0dXJlICYmIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5ET0NVTUVOVCBTVFJVQ1RVUkU6XFxuJztcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGVudCA9ICcgICcucmVwZWF0KGhlYWRpbmcubGV2ZWwgLSAxKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBzZWxlY3RlZCB0ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcblNFTEVDVEVEIFRFWFQ6XFxuJHtkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVsZXZhbnQgY29udGV4dCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IHRoaXMuZmluZFNlY3Rpb25JbkNvbnRlbnQoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5DVVJSRU5UIFNFQ1RJT04gXCIke2NvbW1hbmQubG9jYXRpb259XCI6XFxuJHtzZWN0aW9ufVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdwYXJhZ3JhcGgnICYmIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5DVVJSRU5UIENPTlRFWFQ6XFxuJztcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYEJlZm9yZTogJHtkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUuam9pbignICcpfVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYWZ0ZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYEFmdGVyOiAke2RvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJyAnKX1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGxpbWl0ZWQgZG9jdW1lbnQgY29udGVudCBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBjb250ZW50TGluZXMgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGlmIChjb250ZW50TGluZXMubGVuZ3RoID4gY29uZmlnLm1heENvbnRleHRMaW5lcykge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heCgwLCBjb250ZW50TGluZXMubGVuZ3RoIC0gY29uZmlnLm1heENvbnRleHRMaW5lcyk7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5SRUNFTlQgQ09OVEVOVCAobGFzdCAke2NvbmZpZy5tYXhDb250ZXh0TGluZXN9IGxpbmVzKTpcXG5gO1xuICAgICAgICAgICAgY29udGV4dCArPSBjb250ZW50TGluZXMuc2xpY2Uoc3RhcnQpLmpvaW4oJ1xcbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuRlVMTCBET0NVTUVOVDpcXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc3BlY2lmaWMgc2VjdGlvbiBpbiBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBmaW5kU2VjdGlvbkluQ29udGVudChjb250ZW50OiBzdHJpbmcsIHNlY3Rpb25OYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFNlY3Rpb25OYW1lID0gc2VjdGlvbk5hbWUudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgc2VjdGlvblN0YXJ0ID0gLTE7XG4gICAgICAgIGxldCBzZWN0aW9uTGV2ZWwgPSAwO1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgc2VjdGlvbiBoZWFkaW5nXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaGVhZGluZ01hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRpbmcgPSBoZWFkaW5nTWF0Y2hbMl0udG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGhlYWRpbmcgPT09IG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSB8fCBoZWFkaW5nLmluY2x1ZGVzKG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvblN0YXJ0ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbkxldmVsID0gbGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHNlY3Rpb25TdGFydCA9PT0gLTEpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uXG4gICAgICAgIGxldCBzZWN0aW9uRW5kID0gbGluZXMubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpID0gc2VjdGlvblN0YXJ0ICsgMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrLyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2ggJiYgaGVhZGluZ01hdGNoWzFdLmxlbmd0aCA8PSBzZWN0aW9uTGV2ZWwpIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uRW5kID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGxpbmVzLnNsaWNlKHNlY3Rpb25TdGFydCwgc2VjdGlvbkVuZCkuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIuIFByb3ZpZGUgaGVscGZ1bCwgY29uY2lzZSByZXNwb25zZXMgdG8gdXNlciByZXF1ZXN0cy4gRm9jdXMgb24gYmVpbmcgcHJhY3RpY2FsIGFuZCBhY3Rpb25hYmxlLmA7XG4gICAgICAgIFxuICAgICAgICBsZXQgdXNlclByb21wdCA9IGluc3RydWN0aW9uO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBDb250ZXh0OiAke2NvbnRleHR9XFxuXFxuUmVxdWVzdDogJHtpbnN0cnVjdGlvbn1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0IHx8ICcnLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDUwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgKi9cbiAgICBidWlsZENvbnZlcnNhdGlvblByb21wdChcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ/OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdXG4gICAgKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgbGV0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIHdpdGggdGhlaXIgZG9jdW1lbnRzLiBZb3UgY2FuOlxuLSBBbnN3ZXIgcXVlc3Rpb25zIGFib3V0IHdyaXRpbmcgYW5kIGVkaXRpbmdcbi0gUHJvdmlkZSBzdWdnZXN0aW9ucyBmb3IgaW1wcm92ZW1lbnRcbi0gSGVscCBwbGFuIGRvY3VtZW50IHN0cnVjdHVyZVxuLSBBc3Npc3Qgd2l0aCByZXNlYXJjaCBhbmQgY29udGVudCBkZXZlbG9wbWVudFxuXG5CZSBoZWxwZnVsLCBjb25jaXNlLCBhbmQgcHJhY3RpY2FsIGluIHlvdXIgcmVzcG9uc2VzLmA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBtZXNzYWdlO1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBDdXJyZW50IGRvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9ICdEb2N1bWVudCBzdHJ1Y3R1cmU6XFxuJztcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgIGlmIChyZWNlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1xcblJlY2VudCBjb252ZXJzYXRpb246XFxuJztcbiAgICAgICAgICAgIHJlY2VudEhpc3Rvcnkuc2xpY2UoLTMpLmZvckVhY2gobXNnID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobXNnLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBZb3U6ICR7bXNnLmNvbnRlbnR9XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5yb2xlID09PSAnYXNzaXN0YW50Jykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBOb3ZhOiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGAke2NvbnRleHR9XFxuXFxuQ3VycmVudCBtZXNzYWdlOiAke21lc3NhZ2V9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjgsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiA4MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBlc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0aW9uOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgICAgICBjb25zdCB0b3RhbFRleHQgPSBwcm9tcHQuc3lzdGVtUHJvbXB0ICsgcHJvbXB0LnVzZXJQcm9tcHQgKyBwcm9tcHQuY29udGV4dDtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcHJvbXB0IGdlbmVyYXRpb25cbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKGBQcm9tcHQgaXMgdG9vIGxvbmcgKCR7dG9rZW5Db3VudH0gdG9rZW5zLCBtYXggODAwMClgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1RlbXBlcmF0dXJlIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdNYXggdG9rZW5zIG11c3QgYmUgYmV0d2VlbiAxMCBhbmQgNDAwMCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgaXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIENvbW1hbmQgcGFyc2VyIGZvciBOb3ZhXG4gKiBDb252ZXJ0cyBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gc3RydWN0dXJlZCBFZGl0Q29tbWFuZCBvYmplY3RzXG4gKi9cblxuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRBY3Rpb24gfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQYXR0ZXJucyBmb3IgZGV0ZWN0aW5nIGRpZmZlcmVudCBjb21tYW5kIHR5cGVzXG4gKi9cbmludGVyZmFjZSBDb21tYW5kUGF0dGVybiB7XG4gICAgYWN0aW9uOiBFZGl0QWN0aW9uO1xuICAgIHBhdHRlcm5zOiBSZWdFeHBbXTtcbiAgICB0YXJnZXRzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBDb21tYW5kIHBhcnNpbmcgcnVsZXNcbiAqL1xuY29uc3QgQ09NTUFORF9QQVRURVJOUzogQ29tbWFuZFBhdHRlcm5bXSA9IFtcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2dyYW1tYXInLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihncmFtbWFyfHNwZWxsfHNwZWxsaW5nfHByb29mcmVhZHxwb2xpc2gpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY2hlY2tcXGIuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGdyYW1tYXRpY2FsfGNvcnJlY3R8cHJvcGVyKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmZpeFxccysuKlxcYihncmFtbWFyfGVycm9yc3xtaXN0YWtlc3x0eXBvcylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJjb3JyZWN0XFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nLCAnZG9jdW1lbnQnLCAncGFyYWdyYXBoJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAncmV3cml0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHJld3JpdGV8cmV3b3JkfHJlcGhyYXNlfHJlc3RydWN0dXJlfHJlb3JnYW5pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxid3JpdGVcXHMrLipcXGIobmV3fGRpZmZlcmVudHxhbHRlcm5hdGl2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnLCAnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZGVsZXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGV8Y3V0fGVyYXNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdldFxccytyaWRcXHMrb2ZcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ0YWtlXFxzK291dFxcYi9pLFxuICAgICAgICAgICAgL1xcYmRyb3BcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxwYXJ0KVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ3NlY3Rpb24nLCAnbGluZSddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2FkZCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGUpXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8aGVhZGluZ3xjb250ZW50fHRleHR8cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnQpXFxiKD8hXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzcylcXGIpL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9ufHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXGIuKlxcYihzZWN0aW9ufGNvbnRlbnR8dGV4dClcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2VuZCcsICdzZWN0aW9uJywgJ3BhcmFncmFwaCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2VkaXQnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihlZGl0fG1vZGlmeXxjaGFuZ2V8dXBkYXRlfHJldmlzZXxpbXByb3ZlfGVuaGFuY2UpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihiZXR0ZXJ8Y2xlYXJlcnxtb3JlfGxlc3N8Zm9ybWFsfHByb2Zlc3Npb25hbHxkZXRhaWxlZHxjb21wcmVoZW5zaXZlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihmaXh8Y29ycmVjdHxhZGp1c3QpXFxiKD8hLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiKS9pLFxuICAgICAgICAgICAgL1xcYihleHBhbmR8c2hvcnRlbnxjb25kZW5zZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbicsICdzZWN0aW9uJywgJ3BhcmFncmFwaCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ21ldGFkYXRhJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5fGFkZClcXHMrLipcXGIocHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcnx0YWd8dGFncylcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoc2V0fHVwZGF0ZXxjaGFuZ2V8YWRkKVxccysuKlxcYih0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXMpXFxiL2ksXG4gICAgICAgICAgICAvXFxidXBkYXRlXFxzKy4qXFxiZnJvbnRtYXR0ZXJcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfHJlbW92ZXx1cGRhdGUpXFxzKy4qXFxidGFnW3NdP1xcYi9pLFxuICAgICAgICAgICAgL1xcYnNldFxccysuKlxcYnByb3BlcnR5XFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydkb2N1bWVudCddXG4gICAgfVxuXTtcblxuLyoqXG4gKiBMb2NhdGlvbiBleHRyYWN0aW9uIHBhdHRlcm5zXG4gKi9cbmNvbnN0IExPQ0FUSU9OX1BBVFRFUk5TID0gW1xuICAgIC9cXGIoPzp0b3xpbnxhdHx1bmRlcnx3aXRoaW58aW5zaWRlKVxccysoPzp0aGVcXHMrKT9bXCInXShbXlwiJ10rPylbXCInXVxccysoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSxcbiAgICAvXFxiKD86dGhlXFxzKyk/W1wiJ10oW15cIiddKz8pW1wiJ11cXHMrKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpL2ksXG4gICAgL1xcYig/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KVxccytbXCInXShbXlwiJ10rPylbXCInXS9pLFxuICAgIC9cXGIoPzpzZWN0aW9ufGhlYWRpbmcpXFxzKyg/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OnRoZVxccyspPyhbYS16QS1aXVthLXpBLVpcXHMmXSo/KVxccysoPzpzZWN0aW9ufGhlYWRpbmcpXFxiL2lcbl07XG5cbi8qKlxuICogVGFyZ2V0IHR5cGUgZGV0ZWN0aW9uIHBhdHRlcm5zXG4gKi9cbmNvbnN0IFRBUkdFVF9QQVRURVJOUyA9IFtcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWxlY3RlZHxoaWdobGlnaHRlZHxjaG9zZW4pXFxzKyg/OnRleHR8Y29udGVudCkvaSwgdGFyZ2V0OiAnc2VsZWN0aW9uJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OnRoaXN8Y3VycmVudHxzZWxlY3RlZClcXHMrKD86cGFyYWdyYXBofGxpbmUpL2ksIHRhcmdldDogJ3BhcmFncmFwaCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbnRpcmV8d2hvbGV8ZnVsbClcXHMrKD86ZG9jdW1lbnR8ZmlsZXxub3RlKS9pLCB0YXJnZXQ6ICdkb2N1bWVudCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbmR8Ym90dG9tfGNvbmNsdXNpb24pL2ksIHRhcmdldDogJ2VuZCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSwgdGFyZ2V0OiAnc2VjdGlvbicgfVxuXTtcblxuZXhwb3J0IGNsYXNzIENvbW1hbmRQYXJzZXIge1xuICAgIC8qKlxuICAgICAqIFBhcnNlIG5hdHVyYWwgbGFuZ3VhZ2UgaW5wdXQgaW50byBhbiBFZGl0Q29tbWFuZFxuICAgICAqL1xuICAgIHBhcnNlQ29tbWFuZChpbnB1dDogc3RyaW5nLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4gPSBmYWxzZSk6IEVkaXRDb21tYW5kIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElucHV0ID0gaW5wdXQudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIGFjdGlvbiB0eXBlXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGV0ZWN0QWN0aW9uKG5vcm1hbGl6ZWRJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIHRhcmdldCB0eXBlXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGV0ZWN0VGFyZ2V0KG5vcm1hbGl6ZWRJbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsb2NhdGlvbiBpZiBzcGVjaWZpZWRcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSB0aGlzLmV4dHJhY3RMb2NhdGlvbihpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IGZyb20gdGhlIGlucHV0XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmV4dHJhY3RDb250ZXh0KGlucHV0KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQsXG4gICAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICAgIGluc3RydWN0aW9uOiBpbnB1dCxcbiAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZSBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0QWN0aW9uKGlucHV0OiBzdHJpbmcpOiBFZGl0QWN0aW9uIHtcbiAgICAgICAgLy8gQ2hlY2sgcGF0dGVybnMgaW4gb3JkZXIgb2Ygc3BlY2lmaWNpdHlcbiAgICAgICAgZm9yIChjb25zdCBjb21tYW5kUGF0dGVybiBvZiBDT01NQU5EX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgY29tbWFuZFBhdHRlcm4ucGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tbWFuZFBhdHRlcm4uYWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGVmYXVsdCBmYWxsYmFjayBsb2dpYyB3aXRoIG1vcmUgc3BlY2lmaWMgY2hlY2tzXG4gICAgICAgIGlmICgvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8Z2VuZXJhdGUuKnNlY3Rpb24pXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnYWRkJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihmaXh8Y29ycmVjdHxncmFtbWFyfHNwZWxsfHByb29mcmVhZHxwb2xpc2gpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZ3JhbW1hcic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGUpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZGVsZXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihyZXdyaXRlfHJlcGhyYXNlfHJlc3RydWN0dXJlfGdlbmVyYXRlLipuZXcpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAncmV3cml0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5fGFkZCkuKlxcYihwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyfHRhZ3x0YWdzfHRpdGxlfGF1dGhvcnxkYXRlfHN0YXR1cylcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdtZXRhZGF0YSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgdG8gZWRpdCBmb3IgYW1iaWd1b3VzIGNhc2VzXG4gICAgICAgIHJldHVybiAnZWRpdCc7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdFRhcmdldChcbiAgICAgICAgaW5wdXQ6IHN0cmluZywgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgXG4gICAgICAgIGFjdGlvbjogRWRpdEFjdGlvblxuICAgICk6IEVkaXRDb21tYW5kWyd0YXJnZXQnXSB7XG4gICAgICAgIC8vIENoZWNrIGV4cGxpY2l0IHRhcmdldCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHRhcmdldFBhdHRlcm4gb2YgVEFSR0VUX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0UGF0dGVybi5wYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFBhdHRlcm4udGFyZ2V0IGFzIEVkaXRDb21tYW5kWyd0YXJnZXQnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ29udGV4dC1iYXNlZCB0YXJnZXQgZGV0ZWN0aW9uXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24gJiYgKGFjdGlvbiA9PT0gJ2VkaXQnIHx8IGFjdGlvbiA9PT0gJ2dyYW1tYXInIHx8IGFjdGlvbiA9PT0gJ2RlbGV0ZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3NlbGVjdGlvbic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFjdGlvbi1zcGVjaWZpYyBkZWZhdWx0c1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQuaW5jbHVkZXMoJ3NlY3Rpb24nKSB8fCBpbnB1dC5pbmNsdWRlcygnaGVhZGluZycpID8gJ3NlY3Rpb24nIDogJ2VuZCc7XG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAncGFyYWdyYXBoJztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ3NlY3Rpb24nO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdwYXJhZ3JhcGgnO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgbG9jYXRpb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RMb2NhdGlvbihpbnB1dDogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIExPQ0FUSU9OX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHBhdHRlcm4uZXhlYyhpbnB1dCk7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGFkZGl0aW9uYWwgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdENvbnRleHQoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3Qgc3R5bGUvdG9uZSBpbmRpY2F0b3JzXG4gICAgICAgIGNvbnN0IHN0eWxlSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICdmb3JtYWwnLCAnaW5mb3JtYWwnLCAnY2FzdWFsJywgJ3Byb2Zlc3Npb25hbCcsICdhY2FkZW1pYycsICd0ZWNobmljYWwnLFxuICAgICAgICAgICAgJ3NpbXBsZScsICdjb21wbGV4JywgJ2RldGFpbGVkJywgJ2JyaWVmJywgJ2NvbmNpc2UnLCAndmVyYm9zZScsXG4gICAgICAgICAgICAnZnJpZW5kbHknLCAnc2VyaW91cycsICdodW1vcm91cycsICdjcmVhdGl2ZScsICdhbmFseXRpY2FsJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZm91bmRTdHlsZXMgPSBzdHlsZUluZGljYXRvcnMuZmlsdGVyKHN0eWxlID0+IFxuICAgICAgICAgICAgaW5wdXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHlsZSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIGlmIChmb3VuZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBTdHlsZTogJHtmb3VuZFN0eWxlcy5qb2luKCcsICcpfS4gYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsZW5ndGggaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ3Nob3J0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2JyaWVmJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbmNpc2UnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnS2VlcCBpdCBicmllZi4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2xvbmcnKSB8fCBpbnB1dC5pbmNsdWRlcygnZGV0YWlsZWQnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29tcHJlaGVuc2l2ZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdQcm92aWRlIGRldGFpbGVkIGNvbnRlbnQuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3Qgc3BlY2lmaWMgcmVxdWlyZW1lbnRzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnYnVsbGV0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2xpc3QnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIGJ1bGxldCBwb2ludHMgb3IgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdleGFtcGxlJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGVzJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0luY2x1ZGUgZXhhbXBsZXMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdudW1iZXInKSB8fCBpbnB1dC5pbmNsdWRlcygnbnVtYmVyZWQnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIG51bWJlcmVkIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGV4dC50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIGEgY29tbWFuZCBjYW4gYmUgZXhlY3V0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2RlbGV0ZScgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNwZWNpZnkgd2hpY2ggc2VjdGlvbiB0byBkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24tdGFyZ2V0IGNvbWJpbmF0aW9uc1xuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdhZGQnICYmIGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0ZWQgY29tbWFuZHMgYmFzZWQgb24gY29udGV4dFxuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgaGFzSGVhZGluZ3M6IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBhIGNvbmNsdXNpb24gc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNIZWFkaW5ncykge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnQWRkIGNvbnRlbnQgdG8gdGhlIGludHJvZHVjdGlvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIHRoZSBtZXRob2RvbG9neSBzZWN0aW9uJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBtdWx0aXBsZSBjb21tYW5kcyBmcm9tIGEgc2luZ2xlIGlucHV0XG4gICAgICovXG4gICAgcGFyc2VNdWx0aXBsZUNvbW1hbmRzKGlucHV0OiBzdHJpbmcpOiBFZGl0Q29tbWFuZFtdIHtcbiAgICAgICAgLy8gU3BsaXQgb24gY29tbW9uIGNvbW1hbmQgc2VwYXJhdG9yc1xuICAgICAgICBjb25zdCBzZXBhcmF0b3JzID0gL1xcYig/OnRoZW58YWxzb3xhbmQgdGhlbnxhZnRlciB0aGF0fG5leHR8YWRkaXRpb25hbGx5KVxcYi9pO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGlucHV0LnNwbGl0KHNlcGFyYXRvcnMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnBhcnNlQ29tbWFuZChpbnB1dCldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFydHNcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5wYXJzZUNvbW1hbmQocGFydCkpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgY29tbWFuZCBkZXNjcmlwdGlvbiBmb3IgZGlzcGxheVxuICAgICAqL1xuICAgIGdldENvbW1hbmREZXNjcmlwdGlvbihjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCB0YXJnZXQsIGxvY2F0aW9uIH0gPSBjb21tYW5kO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdBZGQgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRWRpdCBleGlzdGluZyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0dlbmVyYXRlIG5ldyBzZWN0aW9ucyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChsb2NhdGlvbikge1xuICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gYCBpbiBcIiR7bG9jYXRpb259XCJgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBjdXJyZW50IHNlY3Rpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgZW5kIG9mIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9XG59IiwgIi8qKlxuICogUHJvbXB0IGJ1aWxkZXIgc2VydmljZSBmb3IgTm92YVxuICogSW50ZWdyYXRlcyBDb250ZXh0QnVpbGRlciB3aXRoIGRvY3VtZW50IGVuZ2luZSBhbmQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyLCBHZW5lcmF0ZWRQcm9tcHQgfSBmcm9tICcuL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFByb21wdCBidWlsZGluZyBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9tcHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcjtcbiAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZTtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb21tYW5kUGFyc2VyOiBDb21tYW5kUGFyc2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICAgICAgdGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgdXNlciBtZXNzYWdlIC0gZGV0ZXJtaW5lcyBpZiBpdCdzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFByb21wdEZvck1lc3NhZ2UoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgbGlrZWx5IGEgY29tbWFuZCBiYXNlZCBvbiBhY3Rpb24gd29yZHNcbiAgICAgICAgY29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5pc0xpa2VseUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNMaWtlbHlDb21tYW5kICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChwYXJzZWRDb21tYW5kLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0J3MgYSBjb252ZXJzYXRpb24gLSBidWlsZCBjb252ZXJzYXRpb24gcHJvbXB0XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbnZlcnNhdGlvblByb21wdChtZXNzYWdlLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgbWVzc2FnZSBpcyBsaWtlbHkgYSBjb21tYW5kIHZzIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICAvLyBDaGVjayBmb3IgY29tbW9uIGNvbW1hbmQgYWN0aW9uIHdvcmRzXG4gICAgICAgIGNvbnN0IGNvbW1hbmRXb3JkcyA9IFtcbiAgICAgICAgICAgICdhZGQnLCAnY3JlYXRlJywgJ3dyaXRlJywgJ2luc2VydCcsICdpbmNsdWRlJywgJ2dlbmVyYXRlJyxcbiAgICAgICAgICAgICdlZGl0JywgJ21vZGlmeScsICdjaGFuZ2UnLCAndXBkYXRlJywgJ3JldmlzZScsICdpbXByb3ZlJywgJ2VuaGFuY2UnLFxuICAgICAgICAgICAgJ2RlbGV0ZScsICdyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2N1dCcsICdlcmFzZScsXG4gICAgICAgICAgICAnZml4JywgJ2NvcnJlY3QnLCAnZ3JhbW1hcicsICdzcGVsbCcsICdwcm9vZnJlYWQnLCAncG9saXNoJyxcbiAgICAgICAgICAgICdyZXdyaXRlJywgJ3Jld29yZCcsICdyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZW9yZ2FuaXplJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gY29tbWFuZFdvcmRzLnNvbWUod29yZCA9PiBsb3dlck1lc3NhZ2UuaW5jbHVkZXMod29yZCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb21tYW5kUHJvbXB0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIGlzIHJlcXVpcmVkIGZvciBjb21tYW5kIHByb21wdHMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBsZXQgY29udmVyc2F0aW9uQ29udGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAob3B0aW9ucy5pbmNsdWRlSGlzdG9yeSkge1xuICAgICAgICAgICAgY29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNSk7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5mb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KHJlY2VudE1lc3NhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBwcm9tcHRcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBvcHRpb25zLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGNvbnZlcnNhdGlvbiAobm9uLWNvbW1hbmQgbWVzc2FnZXMpXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCB8IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdO1xuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0IGlmIGZpbGUgaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgICAgICByZWNlbnRIaXN0b3J5ID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQobWVzc2FnZSwgZG9jdW1lbnRDb250ZXh0LCByZWNlbnRIaXN0b3J5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzaW1wbGUgcHJvbXB0IGZvciBiYXNpYyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb246IHN0cmluZywgY29udGV4dD86IHN0cmluZyk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZG9jdW1lbnQgY29udGV4dCBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dD4ge1xuICAgICAgICAvLyBVc2UgdGhlIGRvY3VtZW50IGVuZ2luZSdzIGJ1aWx0LWluIGNvbnRleHQgZ2F0aGVyaW5nXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjazogY3JlYXRlIG1pbmltYWwgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZW50KCkgfHwgJyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBoZWFkaW5nczogW10sXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSBjb250ZXh0IGFzLWlzLCBzaW5jZSBpdCdzIGFscmVhZHkgaW4gdGhlIGNvcnJlY3QgZm9ybWF0XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb252ZXJzYXRpb24gaGlzdG9yeSBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShtZXNzYWdlczogQ29udmVyc2F0aW9uTWVzc2FnZVtdKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnO1xuXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSAnUkVDRU5UIENPTlZFUlNBVElPTjpcXG4nO1xuICAgICAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCByb2xlID0gbXNnLnJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogJ05vdmEnO1xuICAgICAgICAgICAgZm9ybWF0dGVkICs9IGAke3JvbGV9OiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIG9wdGltaXplIHByb21wdCBiZWZvcmUgc2VuZGluZyB0byBBSVxuICAgICAqL1xuICAgIHZhbGlkYXRlQW5kT3B0aW1pemVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Byb21wdCB2YWxpZGF0aW9uIGlzc3VlczonLCB2YWxpZGF0aW9uLmlzc3Vlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBmaXggY29tbW9uIGlzc3Vlc1xuICAgICAgICAgICAgbGV0IG9wdGltaXplZFByb21wdCA9IHsgLi4ucHJvbXB0IH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRydW5jYXRlIGlmIHRvbyBsb25nXG4gICAgICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5jb250ZXh0QnVpbGRlci5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICh0b2tlbkNvdW50ID4gODAwMCkge1xuICAgICAgICAgICAgICAgIC8vIFJlZHVjZSBjb250ZXh0IHNpemUgbW9yZSBhZ2dyZXNzaXZlbHlcbiAgICAgICAgICAgICAgICBjb25zdCBtYXhDb250ZXh0TGVuZ3RoID0gTWF0aC5mbG9vcihwcm9tcHQuY29udGV4dC5sZW5ndGggKiAwLjYpO1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb250ZXh0ID0gcHJvbXB0LmNvbnRleHQuc3Vic3RyaW5nKDAsIG1heENvbnRleHRMZW5ndGgpICsgJ1xcbltDb250ZXh0IHRydW5jYXRlZC4uLl0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCB0ZW1wZXJhdHVyZVxuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPCAwIHx8IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPiAxKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHByb21wdC5jb25maWcudGVtcGVyYXR1cmUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgbWF4IHRva2Vuc1xuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcubWF4VG9rZW5zIDwgMTAgfHwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPiA0MDAwKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPSBNYXRoLm1heCgxMCwgTWF0aC5taW4oNDAwMCwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIG9wdGltaXplZFByb21wdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRva2VuIGNvdW50IGVzdGltYXRlIGZvciBhIHByb21wdFxuICAgICAqL1xuICAgIGdldFRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgcHJvbXB0IGZvciBhIHNwZWNpZmljIGFjdGlvbiB3aXRoIG1pbmltYWwgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkUXVpY2tQcm9tcHQoXG4gICAgICAgIGFjdGlvbjogRWRpdENvbW1hbmRbJ2FjdGlvbiddLFxuICAgICAgICBpbnN0cnVjdGlvbjogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBjb25zdCBjb21tYW5kOiBFZGl0Q29tbWFuZCA9IHtcbiAgICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICAgIHRhcmdldDogJ2RvY3VtZW50JyxcbiAgICAgICAgICAgIGluc3RydWN0aW9uLFxuICAgICAgICAgICAgbG9jYXRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQoY29tbWFuZCwgZmlsZSwgeyBcbiAgICAgICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDEwLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IHdpdGggY3VzdG9tIHN5c3RlbSBwcm9tcHQgb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZEN1c3RvbVByb21wdChcbiAgICAgICAgc3lzdGVtUHJvbXB0OiBzdHJpbmcsXG4gICAgICAgIHVzZXJNZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICBjb250ZXh0ID0gYERvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdDogdXNlck1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogQWRkIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgYWRkaW5nIG5ldyBjb250ZW50IHRvIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFkZENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGVkaXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZXRlcm1pbmVJbnNlcnRQb3NpdGlvbihjb21tYW5kLCBkb2N1bWVudENvbnRleHQpLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gYWRkIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmUgd2hlcmUgdG8gaW5zZXJ0IG5ldyBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBkZXRlcm1pbmVJbnNlcnRQb3NpdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dFxuICAgICk6IFByb21pc2U8J2N1cnNvcicgfCAnc2VsZWN0aW9uJyB8ICdlbmQnIHwgeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfT4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjayB0byBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCBhdCB0aGUgZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuICdlbmQnO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFkZCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBBZGQgY29tbWFuZCBjYW5ub3QgdGFyZ2V0IHNlbGVjdGlvblxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBhZGQgY29udGVudCB0byBhIHNlbGVjdGlvbi4gVXNlIFwiZWRpdFwiIHRvIG1vZGlmeSBzZWxlY3RlZCB0ZXh0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRhcmdldGluZyBhIHNlY3Rpb24sIGxvY2F0aW9uIHNob3VsZCBiZSBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiAhY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgLy8gVGhpcyBpcyBzdGlsbCB2YWxpZCAtIHdlJ2xsIGFkZCB0byBjdXJyZW50IHNlY3Rpb24gb3IgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGlvbnMgZm9yIGFkZCBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXG4gICAgICAgICAgICAnQWRkIGEgY29uY2x1c2lvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICdDcmVhdGUgYSBzdW1tYXJ5JyxcbiAgICAgICAgICAgICdBZGQgZXhhbXBsZXMnLFxuICAgICAgICAgICAgJ0NyZWF0ZSBhIG1ldGhvZG9sb2d5IHNlY3Rpb24nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnMgYmFzZWQgb24gZXhpc3RpbmcgaGVhZGluZ3NcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uTmFtZXMgPSBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubWFwKGggPT4gaC50ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaW50cm9kdWN0aW9uJykpKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMudW5zaGlmdCgnQWRkIGFuIGludHJvZHVjdGlvbiBzZWN0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghc2VjdGlvbk5hbWVzLnNvbWUobmFtZSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NvbmNsdXNpb24nKSkpIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgYSBjb25jbHVzaW9uIHNlY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc3VtbWFyeScpKSkge1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0FkZCBhIHN1bW1hcnkgc2VjdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDgpOyAvLyBMaW1pdCB0byA4IHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IGNvbnRlbnQgd291bGQgYmUgYWRkZWQgKHdpdGhvdXQgYWN0dWFsbHkgYWRkaW5nIGl0KVxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIHBvc2l0aW9uPzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHdoZXJlIGNvbnRlbnQgd291bGQgYmUgcGxhY2VkXG4gICAgICAgICAgICBsZXQgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSBgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICdpbiB0aGUgY3VycmVudCBzZWN0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogYFdpbGwgYWRkIG5ldyBjb250ZW50ICR7cG9zaXRpb25EZXNjcmlwdGlvbn1gLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbkRlc2NyaXB0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBFZGl0IGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgbW9kaWZ5aW5nIGFuZCBpbXByb3ZpbmcgZXhpc3RpbmcgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBlZGl0IGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGVkaXQgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBlbnRpcmUgc2VjdGlvbiBjb250ZW50IChleGNsdWRpbmcgaGVhZGluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHRvIHJlcGxhY2UgZnJvbSBoZWFkaW5nIGxpbmUgdG8gc2VjdGlvbiBlbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgZWRpdCBjb21tYW5kcyB0YXJnZXRpbmcgZW5kLCB0cmVhdCBhcyBhZGRpbmcgdG8gZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBlZGl0IHRhcmdldCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZWRpdCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIGxvY2F0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgcHJvdmlkZWQgZm9yIHNlY3Rpb24gZWRpdHNcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdlZGl0JyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiBlZGl0c1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBlZGl0IGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGRldGFpbGVkJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBjbGFyaXR5IGFuZCBmbG93JyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgZm9ybWFsJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgdGhpcyB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIG9uIHRoaXMgcG9pbnQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBlbmdhZ2luZydcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdJbXByb3ZlIHRoZSB3cml0aW5nIHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgZG9jdW1lbnQgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFbmhhbmNlIGNsYXJpdHkgdGhyb3VnaG91dCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgdGhlIGludHJvZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgJ1BvbGlzaCB0aGUgY29uY2x1c2lvbicsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBjb25jaXNlJyxcbiAgICAgICAgICAgICAgICAnQWRkIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSB0aGUgZmxvdyBiZXR3ZWVuIHNlY3Rpb25zJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBJbXByb3ZlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCAxMCk7IC8vIExpbWl0IHRvIDEwIHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IHdvdWxkIGJlIGVkaXRlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBhZmZlY3RlZENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGxldCBwcmV2aWV3VGV4dCA9ICcnO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgdGhlIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGVkaXQgdGhlIGVudGlyZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uPy5saW5lID8/IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGFkZCBlZGl0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVkaXQgdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZWRpdCB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGNoYW5nZXNcbiAgICAgKi9cbiAgICBhc3luYyBlc3RpbWF0ZVNjb3BlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgbGluZXNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBzY29wZURlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBzZWN0aW9uLmNvbnRlbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IHNlY3Rpb24ucmFuZ2UuZW5kIC0gc2VjdGlvbi5yYW5nZS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDsgLy8gTmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ05ldyBjb250ZW50IGF0IGVuZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogRGVsZXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgcmVtb3ZpbmcgY29udGVudCBmcm9tIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHNtYXJ0IGRlbGV0aW9uLCB3ZSBtYXkgbmVlZCBBSSB0byBkZXRlcm1pbmUgd2hhdCB0byBkZWxldGVcbiAgICAgICAgICAgIGlmIChjb21tYW5kLmluc3RydWN0aW9uICYmIGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB0byBpZGVudGlmeSB3aGF0IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBc2sgQUkgd2hhdCBjb250ZW50IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGRldGVybWluZSBkZWxldGlvbiBhY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIE1WUCwgd2UnbGwgcHJvY2VlZCB3aXRoIHRoZSB0YXJnZXQtYmFzZWQgZGVsZXRpb25cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBhbmFseXNpcyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBkZWxldGlvbiByZXN1bHQgKG9ubHkgZmFpbHVyZXMpXG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwICYmICFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZGVsZXRpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RGVsZXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHRcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZGVsZXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgZW50aXJlIHNlY3Rpb24gaW5jbHVkaW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3Igc2VjdGlvbiBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgcGFyYWdyYXBoIGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXMgKGVtcHR5IGxpbmVzIG9yIGhlYWRpbmcgbWFya2VycylcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudCgnJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGNvbnRlbnQgZnJvbSBlbmQgLSBub3QgbWVhbmluZ2Z1bCBmb3IgZGVsZXRlIGNvbW1hbmRcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LicsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZGVsZXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgZm9yIHNlY3Rpb24gZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnU2VjdGlvbiBuYW1lIHJlcXVpcmVkIGZvciBzZWN0aW9uIGRlbGV0aW9uJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIHRhcmdldCBpcyBhcHByb3ByaWF0ZSBmb3IgZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnZW5kJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgZGVsZXRlIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnUmVtb3ZlIHRoaXMgY29udGVudCcsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHRoZSBzZWxlY3Rpb24nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ1JlbW92ZSBlbXB0eSBzZWN0aW9ucycsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHJlZHVuZGFudCBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAnRGVsZXRlIGR1cGxpY2F0ZSBpbmZvcm1hdGlvbidcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIGRlbGV0aW9uIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChgRGVsZXRlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCA4KTsgLy8gTGltaXQgdG8gOCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBkZWxldGVkXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGFmZmVjdGVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgbGV0IHByZXZpZXdUZXh0ID0gJyc7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IGlzIGN1cnJlbnRseSBzZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtzZWN0aW9uLmNvbnRlbnR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGRlbGV0ZSB0aGUgZW50aXJlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3IgcHJldmlldydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGRlbGV0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY3VycmVudCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFncmFwaExpbmVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHN0YXJ0IG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2TGluZS50cmltKCkgPT09ICcnIHx8IHByZXZMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5lLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgZW5kIG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dExpbmUgPSBlZGl0b3IuZ2V0TGluZShlbmRMaW5lICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydExpbmU7IGkgPD0gZW5kTGluZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaExpbmVzLnB1c2goZWRpdG9yLmdldExpbmUoaSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBwYXJhZ3JhcGhMaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIGFsbCBkb2N1bWVudCBjb250ZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgZnJvbSBlbmQgb2YgZG9jdW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRpb24gdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGVsZXRlIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnXTtcblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgdGFyZ2V0cy51bnNoaWZ0KCdzZWxlY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoLTEsIDAsICdzZWN0aW9uJyk7IC8vIEluc2VydCBiZWZvcmUgJ2RvY3VtZW50J1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGRlbGV0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogJ05vIGRvY3VtZW50IGF2YWlsYWJsZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aCArIHNlY3Rpb24uaGVhZGluZy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0ludmFsaWQgdGFyZ2V0IGZvciBkZWxldGlvbic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogR3JhbW1hciBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGdyYW1tYXIgY2hlY2tpbmcgYW5kIGNvcnJlY3Rpb24gb2YgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdyYW1tYXJDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uIHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb24gZm9yIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcnJlY3RlZENvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLCAvLyBMb3dlciB0ZW1wZXJhdHVyZSBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29ycmVjdGVkQ29udGVudCB8fCBjb3JyZWN0ZWRDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb3JyZWN0ZWQgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5R3JhbW1hckNvcnJlY3Rpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb3JyZWN0ZWRDb250ZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gY29ycmVjdCBncmFtbWFyJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdHcmFtbWFyIGNvcnJlY3Rpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlHcmFtbWFyQ29ycmVjdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29ycmVjdGVkQ29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb3JyZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlY3Rpb24gY29udGVudCB3aGlsZSBwcmVzZXJ2aW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29ycmVjdGVkQ29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3U2VjdGlvbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3U2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZhbGwgdGhyb3VnaCB0byBwYXJhZ3JhcGggaWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCBjb3JyZWN0ZWQgY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29ycmVjdGVkQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvcnJlY3RlZENvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciBncmFtbWFyIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyBjb3JyZWN0ZWQgY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3Igc2VjdGlvbiB0YXJnZXRzLCBsb2NhdGlvbiBzaG91bGQgYmUgcHJvdmlkZWQgZm9yIGJldHRlciBhY2N1cmFjeVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2dyYW1tYXInICYmIGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIC8vIExvY2F0aW9uIGlzIHByb3ZpZGVkLCB3aGljaCBpcyBnb29kIGZvciBzZWN0aW9uIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBncmFtbWFyIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXIgaW4gc2VsZWN0ZWQgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ0NvcnJlY3Qgc3BlbGxpbmcgYW5kIHB1bmN0dWF0aW9uJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUnLFxuICAgICAgICAgICAgICAgICdGaXggY2FwaXRhbGl6YXRpb24gZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCB2ZXJiIHRlbnNlcycsXG4gICAgICAgICAgICAgICAgJ0ZpeCBzdWJqZWN0LXZlcmIgYWdyZWVtZW50JyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSByZWFkYWJpbGl0eSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdDaGVjayBncmFtbWFyIHRocm91Z2hvdXQgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdGaXggc3BlbGxpbmcgZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCBwdW5jdHVhdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgc2VudGVuY2Ugc3RydWN0dXJlJyxcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXRpY2FsIGVycm9ycyBpbiBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ0NoZWNrIGZvciBjb21tb24gbWlzdGFrZXMnLFxuICAgICAgICAgICAgICAgICdQcm9vZnJlYWQgdGhlIGRvY3VtZW50J1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgZ3JhbW1hciBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYENoZWNrIGdyYW1tYXIgaW4gXCIke2hlYWRpbmcudGV4dH1cIiBzZWN0aW9uYCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgMTApOyAvLyBMaW1pdCB0byAxMCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBncmFtbWFyLWNvcnJlY3RlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgcG90ZW50aWFsSXNzdWVzPzogc3RyaW5nW107XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHBvdGVudGlhbElzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGluIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmFzaWMgZ3JhbW1hciBpc3N1ZSBkZXRlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhMaW5lczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnRMaW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ291bnQgPSBlZGl0b3IubGluZUNvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dExpbmUudHJpbSgpID09PSAnJyB8fCBuZXh0TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRMaW5lOyBpIDw9IGVuZExpbmU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGhMaW5lcy5wdXNoKGVkaXRvci5nZXRMaW5lKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gcGFyYWdyYXBoTGluZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgdGhyb3VnaG91dCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBhZGQgZ3JhbW1hci1jb3JyZWN0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3VlczogcG90ZW50aWFsSXNzdWVzLnNsaWNlKDAsIDUpIC8vIExpbWl0IHRvIDUgaXNzdWVzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdCBwb3RlbnRpYWwgZ3JhbW1hciBpc3N1ZXMgaW4gdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0UG90ZW50aWFsSXNzdWVzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQmFzaWMgcGF0dGVybiBtYXRjaGluZyBmb3IgY29tbW9uIGlzc3Vlc1xuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYmlcXHMvZ2ksIGlzc3VlOiAnTG93ZXJjYXNlIFwiaVwiIHNob3VsZCBiZSBjYXBpdGFsaXplZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcLlxccypbYS16XS9nLCBpc3N1ZTogJ1NlbnRlbmNlIHNob3VsZCBzdGFydCB3aXRoIGNhcGl0YWwgbGV0dGVyJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHNwYWNlcyBkZXRlY3RlZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1suIT9dezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHB1bmN0dWF0aW9uIG1hcmtzJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzK1suIT8sOjtdL2csIGlzc3VlOiAnU3BhY2UgYmVmb3JlIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvWy4hP11cXHcvZywgaXNzdWU6ICdNaXNzaW5nIHNwYWNlIGFmdGVyIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxidGVoXFxiL2dpLCBpc3N1ZTogJ0NvbW1vbiB0eXBvOiBcInRlaFwiIHNob3VsZCBiZSBcInRoZVwiJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxiYW5kXFxzK2FuZFxcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJhbmRcIicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYnRoZVxccyt0aGVcXGIvZ2ksIGlzc3VlOiAnRHVwbGljYXRlIFwidGhlXCInIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXGJpc1xccytpc1xcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJpc1wiJyB9XG4gICAgICAgIF07XG5cbiAgICAgICAgcGF0dGVybnMuZm9yRWFjaCgoeyBwYXR0ZXJuLCBpc3N1ZSB9KSA9PiB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KHRleHQpKSB7XG4gICAgICAgICAgICAgICAgaXNzdWVzLnB1c2goaXNzdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaXNzdWVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBncmFtbWFyIGNoZWNrIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnLCAnZW5kJ107XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgIHRhcmdldHMudW5zaGlmdCgnc2VsZWN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRhcmdldHMuc3BsaWNlKC0yLCAwLCAnc2VjdGlvbicpOyAvLyBJbnNlcnQgYmVmb3JlICdkb2N1bWVudCcgYW5kICdlbmQnXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGFyZ2V0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0aGUgc2NvcGUgb2YgZ3JhbW1hciBjb3JyZWN0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgICBlc3RpbWF0ZWRJc3N1ZXM6IG51bWJlcjtcbiAgICB9PiB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb246ICdObyBkb2N1bWVudCBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZElzc3VlczogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIGxldCBjb250ZW50VG9BbmFseXplID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBzZWN0aW9uLnJhbmdlLmVuZCAtIHNlY3Rpb24ucmFuZ2Uuc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gYFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAvLyBFc3RpbWF0ZSBzaW5nbGUgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMTAwOyAvLyBSb3VnaCBlc3RpbWF0ZVxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAxO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnQ3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgIC8vIEZvciBlc3RpbWF0aW9uIHB1cnBvc2VzLCB1c2Ugc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7IC8vIE5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdOZXcgY29udGVudCBhdCBlbmQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXN0aW1hdGUgcG90ZW50aWFsIGlzc3Vlc1xuICAgICAgICBjb25zdCBlc3RpbWF0ZWRJc3N1ZXMgPSB0aGlzLmRldGVjdFBvdGVudGlhbElzc3Vlcyhjb250ZW50VG9BbmFseXplKS5sZW5ndGg7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgZXN0aW1hdGVkSXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIFJld3JpdGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZXdyaXRpbmcgY29udGVudCB3aXRoIGRpZmZlcmVudCBzdHlsZXMgYW5kIGFwcHJvYWNoZXNcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgZm9yIHJld3JpdGluZyB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uIGZvciByZXdyaXRpbmdcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXdyaXR0ZW5Db250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFyZXdyaXR0ZW5Db250ZW50IHx8IHJld3JpdHRlbkNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIHJld3JpdHRlbiBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgcmV3cml0ZSBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmV3cml0ZShjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Jld3JpdGUgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcmV3cml0ZSBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlSZXdyaXRlKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICByZXdyaXR0ZW5Db250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugc2VjdGlvbiBjb250ZW50IHdoaWxlIHByZXNlcnZpbmcgaGVhZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3U2VjdGlvbkNvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtyZXdyaXR0ZW5Db250ZW50fWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgcmV3cml0ZSB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCByZXdyaXR0ZW4gY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UocmV3cml0dGVuQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciByZXdyaXRlIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyByZXdyaXR0ZW4gY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJld3JpdGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSByZXdyaXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIHNlY3Rpb24gdGFyZ2V0cywgbG9jYXRpb24gc2hvdWxkIGJlIHByb3ZpZGVkIGZvciBiZXR0ZXIgYWNjdXJhY3lcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdyZXdyaXRlJyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiByZXdyaXRpbmdcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgcmV3cml0ZSBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYSBtb3JlIGZvcm1hbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBpbiBhIGNhc3VhbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCB3aXRoIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBmb3IgY2xhcml0eScsXG4gICAgICAgICAgICAgICAgJ1NpbXBsaWZ5IHRoZSBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBlbmdhZ2luZycsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYnVsbGV0IHBvaW50cycsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbmFycmF0aXZlIGZvcm0nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnLFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGluIGEgZGlmZmVyZW50IHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgd3JpdGluZyBtb3JlIGVuZ2FnaW5nJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgY29tcGxleCBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgZm9yIGRpZmZlcmVudCBhdWRpZW5jZScsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbW9yZSBmb3JtYWwgdG9uZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhlIGNvbnRlbnQgbW9yZSBjb25jaXNlJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgcmV3cml0ZSBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYFJld3JpdGUgdGhlIFwiJHtoZWFkaW5nLnRleHR9XCIgc2VjdGlvbmApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDEwKTsgLy8gTGltaXQgdG8gMTAgc3VnZ2VzdGlvbnNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2aWV3IHdoYXQgd291bGQgYmUgcmV3cml0dGVuXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICByZXdyaXRlU3R5bGU/OiBzdHJpbmc7XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHJld3JpdGVTdHlsZSA9IHRoaXMuaW5mZXJSZXdyaXRlU3R5bGUoY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgc2VsZWN0ZWQgdGV4dGA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBpcyBjdXJyZW50bHkgc2VsZWN0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gc2VjdGlvbi5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIHJld3JpdGUgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXdyaXRlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ICs9IGAgKCR7cmV3cml0ZVN0eWxlfSlgO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYWdyYXBoTGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBwYXJhZ3JhcGggYm91bmRhcmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkxpbmUgPSBlZGl0b3IuZ2V0TGluZShzdGFydExpbmUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChlbmRMaW5lIDwgbGluZUNvdW50IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0TGluZTsgaSA8PSBlbmRMaW5lOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYWdyYXBoTGluZXMucHVzaChlZGl0b3IuZ2V0TGluZShpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHBhcmFncmFwaExpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgYWRkIHJld3JpdHRlbiBjb250ZW50IGF0IHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmV3cml0ZSB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHJld3JpdGVTdHlsZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmZlciByZXdyaXRlIHN0eWxlIGZyb20gaW5zdHJ1Y3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGluZmVyUmV3cml0ZVN0eWxlKGluc3RydWN0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdmb3JtYWwnKSkgcmV0dXJuICdmb3JtYWwgdG9uZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjYXN1YWwnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdpbmZvcm1hbCcpKSByZXR1cm4gJ2Nhc3VhbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2NvbmNpc2UnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdzaG9ydGVyJykpIHJldHVybiAnbW9yZSBjb25jaXNlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2V4cGFuZCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2RldGFpbCcpKSByZXR1cm4gJ21vcmUgZGV0YWlsZWQnO1xuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxlJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxpZnknKSkgcmV0dXJuICdzaW1wbGlmaWVkIGxhbmd1YWdlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2VuZ2FnaW5nJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnaW50ZXJlc3RpbmcnKSkgcmV0dXJuICdtb3JlIGVuZ2FnaW5nJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3Byb2Zlc3Npb25hbCcpKSByZXR1cm4gJ3Byb2Zlc3Npb25hbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2J1bGxldCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2xpc3QnKSkgcmV0dXJuICdidWxsZXQgcG9pbnQgZm9ybWF0JztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ25hcnJhdGl2ZScpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3N0b3J5JykpIHJldHVybiAnbmFycmF0aXZlIHN0eWxlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3RlY2huaWNhbCcpKSByZXR1cm4gJ3RlY2huaWNhbCBzdHlsZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjcmVhdGl2ZScpKSByZXR1cm4gJ2NyZWF0aXZlIHN0eWxlJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmV3cml0ZSB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIHJld3JpdGluZ1xuICAgICAqL1xuICAgIGFzeW5jIGVzdGltYXRlU2NvcGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBsaW5lc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIHNjb3BlRGVzY3JpcHRpb246IHN0cmluZztcbiAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICByZXdyaXRlQ29tcGxleGl0eTogJ2xvdydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBsZXQgY29udGVudFRvQW5hbHl6ZSA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IHNlY3Rpb24uY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9IGBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAvLyBGb3IgZXN0aW1hdGlvbiBwdXJwb3NlcywgdXNlIHN1cnJvdW5kaW5nIGNvbnRleHRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5qb2luKCdcXG4nKSArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xcbicgKyBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwOyAvLyBOZXcgY29udGVudFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnTmV3IGNvbnRlbnQgYXQgZW5kJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERldGVybWluZSByZXdyaXRlIGNvbXBsZXhpdHkgYmFzZWQgb24gY29udGVudCBsZW5ndGggYW5kIGluc3RydWN0aW9uXG4gICAgICAgIGNvbnN0IHJld3JpdGVDb21wbGV4aXR5ID0gdGhpcy5lc3RpbWF0ZUNvbXBsZXhpdHkoY29udGVudFRvQW5hbHl6ZSwgY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSByZXdyaXRlIGNvbXBsZXhpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlQ29tcGxleGl0eShjb250ZW50OiBzdHJpbmcsIGluc3RydWN0aW9uOiBzdHJpbmcpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHtcbiAgICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IGNvbnRlbnQubGVuZ3RoO1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEJhc2UgY29tcGxleGl0eSBvbiBjb250ZW50IGxlbmd0aFxuICAgICAgICBsZXQgY29tcGxleGl0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyA9ICdsb3cnO1xuICAgICAgICBpZiAoY29udGVudExlbmd0aCA+IDEwMDApIGNvbXBsZXhpdHkgPSAnaGlnaCc7XG4gICAgICAgIGVsc2UgaWYgKGNvbnRlbnRMZW5ndGggPiAzMDApIGNvbXBsZXhpdHkgPSAnbWVkaXVtJztcbiAgICAgICAgXG4gICAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBpbnN0cnVjdGlvbiBjb21wbGV4aXR5XG4gICAgICAgIGNvbnN0IGNvbXBsZXhJbnN0cnVjdGlvbnMgPSBbXG4gICAgICAgICAgICAncmVzdHJ1Y3R1cmUnLCAncmVvcmdhbml6ZScsICdjb21wbGV0ZWx5IHJld3JpdGUnLCAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgICdjaGFuZ2Ugc3R5bGUnLCAnZGlmZmVyZW50IGF1ZGllbmNlJywgJ3RlY2huaWNhbCcsICdhY2FkZW1pYydcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb21wbGV4SW5zdHJ1Y3Rpb25zLnNvbWUodGVybSA9PiBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKHRlcm0pKSkge1xuICAgICAgICAgICAgaWYgKGNvbXBsZXhpdHkgPT09ICdsb3cnKSBjb21wbGV4aXR5ID0gJ21lZGl1bSc7XG4gICAgICAgICAgICBlbHNlIGlmIChjb21wbGV4aXR5ID09PSAnbWVkaXVtJykgY29tcGxleGl0eSA9ICdoaWdoJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbXBsZXhpdHk7XG4gICAgfVxufSIsICIvKipcbiAqIE1ldGFkYXRhIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogSGFuZGxlcyB1cGRhdGluZyBkb2N1bWVudCBwcm9wZXJ0aWVzL2Zyb250bWF0dGVyXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEhhbmRsZXMgbWV0YWRhdGEvcHJvcGVydHkgdXBkYXRlIGNvbW1hbmRzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBtZXRhZGF0YSB1cGRhdGUgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0gdGhpcy5wYXJzZVByb3BlcnR5VXBkYXRlcyhhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlcyB8fCBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBwcm9wZXJ0eSB1cGRhdGVzIGZvdW5kIGluIEFJIHJlc3BvbnNlJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFdyaXRlIHRoZSB1cGRhdGVkIGNvbnRlbnQgYmFjayB0byB0aGUgZmlsZSBkaXJlY3RseVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGRvY3VtZW50Q29udGV4dC5maWxlLCB1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byB1cGRhdGUgbWV0YWRhdGE6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VQcm9wZXJ0eVVwZGF0ZXMocmVzcG9uc2U6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OIGZpcnN0XG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIFlBTUwtbGlrZSBmb3JtYXRcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAvLyBNYXRjaCBwYXR0ZXJucyBsaWtlIFwia2V5OiB2YWx1ZVwiIG9yIFwiLSBrZXk6IHZhbHVlXCJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL15bLVxcc10qKFteOl0rKTpcXHMqKC4rKSQvKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdmFsdWUgYXMgSlNPTiAoZm9yIGFycmF5cy9vYmplY3RzKVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBub3QgSlNPTiwgdHJlYXQgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVvdGVzIGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuc3RhcnRzV2l0aCgnXCInKSAmJiB2YWx1ZS5lbmRzV2l0aCgnXCInKSkgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlLnN0YXJ0c1dpdGgoXCInXCIpICYmIHZhbHVlLmVuZHNXaXRoKFwiJ1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID4gMCA/IHVwZGF0ZXMgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHByb3BlcnR5IHVwZGF0ZXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyIGluIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZywgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBmcm9udG1hdHRlciBleGlzdHNcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY2xvc2luZyAtLS1cbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlbmRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvcHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZEluZGV4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9wc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgdXBkYXRlcyB3aXRoIGV4aXN0aW5nIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IHsgLi4uZXhpc3RpbmdQcm9wcywgLi4udXBkYXRlcyB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlYnVpbGQgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobWVyZ2VkUHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIG51bGwvdW5kZWZpbmVkIHZhbHVlcyAoYWxsb3dzIGRlbGV0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goJy0tLScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugb2xkIGZyb250bWF0dGVyIHdpdGggbmV3XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgLi4ubmV3RnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKGVuZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBleGlzdHMsIGNyZWF0ZSBuZXdcbiAgICAgICAgY29uc3QgbmV3RnJvbnRtYXR0ZXIgPSBbJy0tLSddO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZyb250bWF0dGVyIHRvIGJlZ2lubmluZyBvZiBkb2N1bWVudFxuICAgICAgICByZXR1cm4gbmV3RnJvbnRtYXR0ZXIuam9pbignXFxuJykgKyBjb250ZW50O1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBjYXRhbHlzdERhdGU6IHN0cmluZzsgIC8vIFlZWVktTU0tREQgZm9ybWF0XG4gICAgZ2VuZXJhbERhdGU6IHN0cmluZzsgICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRmVhdHVyZSByZWxlYXNlIGNvbmZpZ3VyYXRpb24gZm9yIENhdGFseXN0IGVhcmx5IGFjY2VzcyBtb2RlbFxuICogQ2F0YWx5c3Qgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gY2F0YWx5c3REYXRlXG4gKiBBbGwgdXNlcnMgZ2V0IGZlYXR1cmVzIG9uIGdlbmVyYWxEYXRlXG4gKiBcbiAqIERhdGVzIGFyZSBpbiBZWVlZLU1NLUREIGZvcm1hdCBhbmQgZWFzeSB0byBtb2RpZnkgcG9zdC1sYXVuY2hcbiAqL1xuZXhwb3J0IGNvbnN0IENBVEFMWVNUX0ZFQVRVUkVTOiBSZWNvcmQ8c3RyaW5nLCBUaW1lR2F0ZWRGZWF0dXJlPiA9IHtcbiAgICAvLyBDb21tYW5kIHN5c3RlbSAtIDMgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmQtc3lzdGVtJzoge1xuICAgICAgICBjYXRhbHlzdERhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA5LTE1JywgICAvLyAzIG1vbnRocyBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbW1hbmQgc3lzdGVtIHdpdGggOiB0cmlnZ2VycyBhbmQgcHJvdmlkZXIgc3dpdGNoaW5nJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gTXVsdGktZG9jdW1lbnQgY29udGV4dCAtIDIgbW9udGggZWFybHkgYWNjZXNzICBcbiAgICAnbXVsdGktZG9jLWNvbnRleHQnOiB7XG4gICAgICAgIGNhdGFseXN0RGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDgtMTUnLCAgIC8vIDIgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUmVmZXJlbmNlIG90aGVyIGRvY3VtZW50cyB3aXRoIFtbZG9jXV0gc3ludGF4J1xuICAgIH0sXG4gICAgXG4gICAgLy8gQXV0by1ncm93aW5nIGlucHV0IC0gMSBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnYXV0by1pbnB1dCc6IHtcbiAgICAgICAgY2F0YWx5c3REYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wNy0xNScsICAgLy8gMSBtb250aCBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0F1dG8tZ3Jvd2luZyBpbnB1dCBhcmVhIHdpdGggc21vb3RoIHRyYW5zaXRpb25zJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gQ29tbWFuZCBidXR0b24gLSAyIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdjb21tYW5kLWJ1dHRvbic6IHtcbiAgICAgICAgY2F0YWx5c3REYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOC0xNScsICAgLy8gMiBtb250aHMgbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb21tYW5kIGJ1dHRvbiBmb3IgbW9iaWxlIGFuZCBkaXNjb3ZlcnknXG4gICAgfSxcbiAgICBcbiAgICAvLyBDdXN0b20gY29tbWFuZHMgLSAzIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdjdXN0b20tY29tbWFuZHMnOiB7XG4gICAgICAgIGNhdGFseXN0RGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDktMTUnLCAgIC8vIDMgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVXNlci1kZWZpbmVkIGN1c3RvbSBjb21tYW5kIHNob3J0Y3V0cydcbiAgICB9LFxuICAgIFxuICAgIC8vIEVuaGFuY2VkIHByb3ZpZGVyIG1hbmFnZW1lbnQgLSAyIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdlbmhhbmNlZC1wcm92aWRlcnMnOiB7XG4gICAgICAgIGNhdGFseXN0RGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDgtMTUnLCAgIC8vIDIgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWR2YW5jZWQgcHJvdmlkZXIgY29uZmlndXJhdGlvbiBhbmQgc3dpdGNoaW5nJ1xuICAgIH1cbn07XG5cbi8qKlxuICogQ29yZSBmZWF0dXJlcyB0aGF0IGFyZSBhbHdheXMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuICogVGhlc2UgYXJlIE5PVCB0aW1lLWdhdGVkXG4gKi9cbmV4cG9ydCBjb25zdCBDT1JFX0ZFQVRVUkVTID0gW1xuICAgICdiYXNpY19lZGl0aW5nJywgICAgICAgICAgLy8gQWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUgY29tbWFuZHNcbiAgICAnYWxsX2FpX3Byb3ZpZGVycycsICAgICAgIC8vIENsYXVkZSwgT3BlbkFJLCBHb29nbGUsIE9sbGFtYVxuICAgICdmaWxlX2NvbnZlcnNhdGlvbnMnLCAgICAgLy8gRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICAncHJvdmlkZXJfc3dpdGNoaW5nJywgICAgIC8vIFN3aXRjaCBwcm92aWRlcnMgaW4gY2hhdFxuICAgICdtb2JpbGVfYWNjZXNzJywgICAgICAgICAgLy8gRnVsbCBtb2JpbGUgc3VwcG9ydFxuICAgICdhcGlfa2V5X2NvbmZpZycsICAgICAgICAgLy8gQ29uZmlndXJlIG93biBBUEkga2V5c1xuICAgICdzaWRlYmFyX2NoYXQnLCAgICAgICAgICAgLy8gQ2hhdCBpbnRlcmZhY2UgaW4gc2lkZWJhclxuICAgICdkb2N1bWVudF9jb250ZXh0JyAgICAgICAgLy8gQ3VycmVudCBkb2N1bWVudCBjb250ZXh0XG5dOyIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBDYXRhbHlzdExpY2Vuc2UsIEZlYXR1cmVGbGFnLCBGZWF0dXJlQWNjZXNzUmVzdWx0LCBEZWJ1Z1NldHRpbmdzLCBDYXRhbHlzdFZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENBVEFMWVNUX0ZFQVRVUkVTLCBDT1JFX0ZFQVRVUkVTLCBUaW1lR2F0ZWRGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlLWNvbmZpZyc7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTWFuYWdlciB7XG5cdHByaXZhdGUgZmVhdHVyZXM6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBjYXRhbHlzdExpY2Vuc2U6IENhdGFseXN0TGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzQ2F0YWx5c3Q6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbGljZW5zZVZhbGlkYXRvcjogTGljZW5zZVZhbGlkYXRvcixcblx0XHRkZWJ1Z1NldHRpbmdzPzogRGVidWdTZXR0aW5nc1xuXHQpIHtcblx0XHRpZiAoZGVidWdTZXR0aW5ncykge1xuXHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0gZGVidWdTZXR0aW5ncztcblx0XHR9XG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZSBhbGwgZmVhdHVyZSBmbGFnc1xuXHQgKiBDb3JlIGZlYXR1cmVzIGFyZSBhbHdheXMgZW5hYmxlZFxuXHQgKiBUaW1lLWdhdGVkIGZlYXR1cmVzIGRlcGVuZCBvbiBjdXJyZW50IGRhdGUgYW5kIENhdGFseXN0IHN0YXR1c1xuXHQgKi9cblx0cHJpdmF0ZSBpbml0aWFsaXplRmVhdHVyZUZsYWdzKCk6IHZvaWQge1xuXHRcdC8vIENvcmUgZmVhdHVyZXMgLSBhbHdheXMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuXHRcdENPUkVfRkVBVFVSRVMuZm9yRWFjaChmZWF0dXJlS2V5ID0+IHtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5OiBmZWF0dXJlS2V5LFxuXHRcdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogdGhpcy5nZXRDb3JlRmVhdHVyZURlc2NyaXB0aW9uKGZlYXR1cmVLZXkpXG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIFRpbWUtZ2F0ZWQgZmVhdHVyZXMgLSBhdmFpbGFibGUgYmFzZWQgb24gZGF0ZVxuXHRcdE9iamVjdC5lbnRyaWVzKENBVEFMWVNUX0ZFQVRVUkVTKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XG5cdFx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5pc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGtleSwgY29uZmlnKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5LFxuXHRcdFx0XHRlbmFibGVkLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuXHRcdFx0XHRpc1RpbWVHYXRlZDogdHJ1ZSxcblx0XHRcdFx0ZWFybHlBY2Nlc3NPbmx5OiAhdGhpcy5pc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWcpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVzY3JpcHRpb24gZm9yIGNvcmUgZmVhdHVyZXNcblx0ICovXG5cdHByaXZhdGUgZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihrZXk6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgZGVzY3JpcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2Jhc2ljX2VkaXRpbmcnOiAnQmFzaWMgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kcyAoYWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUpJyxcblx0XHRcdCdhbGxfYWlfcHJvdmlkZXJzJzogJ0FjY2VzcyB0byBhbGwgQUkgcHJvdmlkZXJzIChDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWEpJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnOiAnRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZyc6ICdTd2l0Y2ggQUkgcHJvdmlkZXJzIGRpcmVjdGx5IGluIGNoYXQgaW50ZXJmYWNlJyxcblx0XHRcdCdtb2JpbGVfYWNjZXNzJzogJ0Z1bGwgbW9iaWxlIGRldmljZSBzdXBwb3J0Jyxcblx0XHRcdCdhcGlfa2V5X2NvbmZpZyc6ICdDb25maWd1cmUgeW91ciBvd24gQVBJIGtleXMnLFxuXHRcdFx0J3NpZGViYXJfY2hhdCc6ICdDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyJyxcblx0XHRcdCdkb2N1bWVudF9jb250ZXh0JzogJ0N1cnJlbnQgZG9jdW1lbnQgY29udGV4dCBpbiBjb252ZXJzYXRpb25zJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGRlc2NyaXB0aW9uc1trZXldIHx8IGtleTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIHRpbWUtZ2F0ZWQgZmVhdHVyZSBzaG91bGQgYmUgZW5hYmxlZFxuXHQgKi9cblx0cHJpdmF0ZSBpc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZywgY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGNhdGFseXN0RGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5jYXRhbHlzdERhdGUpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblxuXHRcdC8vIEZlYXR1cmUgaXMgYXZhaWxhYmxlIHRvIGV2ZXJ5b25lIGFmdGVyIGdlbmVyYWwgZGF0ZVxuXHRcdGlmIChub3cgPj0gZ2VuZXJhbERhdGUpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIEZlYXR1cmUgaXMgYXZhaWxhYmxlIHRvIENhdGFseXN0IHN1cHBvcnRlcnMgYWZ0ZXIgY2F0YWx5c3QgZGF0ZVxuXHRcdGlmICh0aGlzLmdldElzQ2F0YWx5c3QoKSAmJiBub3cgPj0gY2F0YWx5c3REYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBDYXRhbHlzdCBzdGF0dXMgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldElzQ2F0YWx5c3QoKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuZGVidWdTZXR0aW5ncy5lbmFibGVkICYmIHRoaXMuZGVidWdTZXR0aW5ncy5mb3JjZUNhdGFseXN0ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VDYXRhbHlzdDtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuaXNDYXRhbHlzdDtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWdpc3RlciBhIG5ldyBmZWF0dXJlIGZsYWdcblx0ICovXG5cdHJlZ2lzdGVyRmVhdHVyZShmbGFnOiBGZWF0dXJlRmxhZyk6IHZvaWQge1xuXHRcdHRoaXMuZmVhdHVyZXMuc2V0KGZsYWcua2V5LCBmbGFnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgQ2F0YWx5c3QgbGljZW5zZSBhbmQgcmVjYWxjdWxhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0ICovXG5cdGFzeW5jIHVwZGF0ZUNhdGFseXN0TGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHR0aGlzLmNhdGFseXN0TGljZW5zZSA9IG51bGw7XG5cdFx0XHR0aGlzLmlzQ2F0YWx5c3QgPSBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMubGljZW5zZVZhbGlkYXRvci52YWxpZGF0ZUNhdGFseXN0TGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICh2YWxpZGF0aW9uLnZhbGlkICYmIHZhbGlkYXRpb24ubGljZW5zZSkge1xuXHRcdFx0XHR0aGlzLmNhdGFseXN0TGljZW5zZSA9IHZhbGlkYXRpb24ubGljZW5zZTtcblx0XHRcdFx0dGhpcy5pc0NhdGFseXN0ID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY2F0YWx5c3RMaWNlbnNlID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pc0NhdGFseXN0ID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVpbml0aWFsaXplIGZlYXR1cmVzIHdpdGggdXBkYXRlZCBDYXRhbHlzdCBzdGF0dXNcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBDYXRhbHlzdCBzdGF0dXNcblx0ICovXG5cdGdldElzQ2F0YWx5c3RTdXBwb3J0ZXIoKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0SXNDYXRhbHlzdCgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IENhdGFseXN0IGxpY2Vuc2Vcblx0ICovXG5cdGdldENhdGFseXN0TGljZW5zZSgpOiBDYXRhbHlzdExpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5jYXRhbHlzdExpY2Vuc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgYSBmZWF0dXJlIGlzIGVuYWJsZWRcblx0ICovXG5cdGlzRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gSGFuZGxlIG9sZCBmZWF0dXJlIGtleXMgdGhhdCBtaWdodCBzdGlsbCBiZSByZWZlcmVuY2VkXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTsgLy8gQWxsIGxlZ2FjeSBmZWF0dXJlcyBhcmUgbm93IGVuYWJsZWQgZm9yIGV2ZXJ5b25lXG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdHJldHVybiBmZWF0dXJlPy5lbmFibGVkID8/IGZhbHNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoaXMgaXMgYSBsZWdhY3kgZmVhdHVyZSBrZXkgdGhhdCBzaG91bGQgYWx3YXlzIGJlIGVuYWJsZWRcblx0ICovXG5cdHByaXZhdGUgaXNMZWdhY3lGZWF0dXJlS2V5KGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Y29uc3QgbGVnYWN5S2V5cyA9IFtcblx0XHRcdCdiYXNpY19lZGl0aW5nJyxcblx0XHRcdCdsb2NhbF9haV9wcm92aWRlcnMnLFxuXHRcdFx0J2ZpbGVfY29udmVyc2F0aW9ucycsXG5cdFx0XHQnc2luZ2xlX2Nsb3VkX3Byb3ZpZGVyJyxcblx0XHRcdCd1bmxpbWl0ZWRfY2xvdWRfYWknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZycsXG5cdFx0XHQnbW9iaWxlX2FjY2VzcycsXG5cdFx0XHQnYWR2YW5jZWRfdGVtcGxhdGVzJyxcblx0XHRcdCdiYXRjaF9vcGVyYXRpb25zJyxcblx0XHRcdCdjcm9zc19kb2N1bWVudF9jb250ZXh0Jyxcblx0XHRcdCdwcmlvcml0eV9zdXBwb3J0J1xuXHRcdF07XG5cdFx0cmV0dXJuIGxlZ2FjeUtleXMuaW5jbHVkZXMoa2V5KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBmZWF0dXJlIGFjY2VzcyB3aXRoIGRldGFpbGVkIHJlc3VsdFxuXHQgKi9cblx0Y2hlY2tGZWF0dXJlQWNjZXNzKGZlYXR1cmVLZXk6IHN0cmluZyk6IEZlYXR1cmVBY2Nlc3NSZXN1bHQge1xuXHRcdC8vIEhhbmRsZSBsZWdhY3kgZmVhdHVyZXNcblx0XHRpZiAodGhpcy5pc0xlZ2FjeUZlYXR1cmVLZXkoZmVhdHVyZUtleSkpIHtcblx0XHRcdHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcblx0XHR9XG5cblx0XHRjb25zdCBmZWF0dXJlID0gdGhpcy5mZWF0dXJlcy5nZXQoZmVhdHVyZUtleSk7XG5cdFx0XG5cdFx0aWYgKCFmZWF0dXJlKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0YWxsb3dlZDogZmFsc2UsIFxuXHRcdFx0XHRyZWFzb246IGBGZWF0dXJlICcke2ZlYXR1cmVLZXl9JyBub3QgZm91bmRgIFxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRpZiAoZmVhdHVyZS5lbmFibGVkKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHRpbWUtZ2F0ZWQgZmVhdHVyZXMsIHByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvblxuXHRcdGlmIChmZWF0dXJlLmlzVGltZUdhdGVkKSB7XG5cdFx0XHRjb25zdCBjb25maWcgPSBDQVRBTFlTVF9GRUFUVVJFU1tmZWF0dXJlS2V5XTtcblx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdFx0XHRjb25zdCBnZW5lcmFsRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5nZW5lcmFsRGF0ZSk7XG5cdFx0XHRcdGNvbnN0IGNhdGFseXN0RGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5jYXRhbHlzdERhdGUpO1xuXG5cdFx0XHRcdGlmICh0aGlzLmdldElzQ2F0YWx5c3QoKSAmJiBub3cgPCBjYXRhbHlzdERhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgd2lsbCBiZSBhdmFpbGFibGUgdG8gQ2F0YWx5c3Qgc3VwcG9ydGVycyBvbiAke2NvbmZpZy5jYXRhbHlzdERhdGV9YCxcblx0XHRcdFx0XHRcdGlzQ2F0YWx5c3RGZWF0dXJlOiB0cnVlLFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogY2F0YWx5c3REYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIGlmICghdGhpcy5nZXRJc0NhdGFseXN0KCkgJiYgbm93IDwgZ2VuZXJhbERhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgQ2F0YWx5c3Qgc3VwcG9ydGVycy4gSXQgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uICR7Y29uZmlnLmdlbmVyYWxEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc0NhdGFseXN0RmVhdHVyZTogdHJ1ZSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGdlbmVyYWxEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdHJlYXNvbjogJ0ZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZSdcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgZW5hYmxlZCBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0RW5hYmxlZEZlYXR1cmVzKCk6IEZlYXR1cmVGbGFnW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMuZmVhdHVyZXMudmFsdWVzKCkpLmZpbHRlcihmZWF0dXJlID0+IGZlYXR1cmUuZW5hYmxlZCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFsbCBDYXRhbHlzdCBlYXJseSBhY2Nlc3MgZmVhdHVyZXNcblx0ICovXG5cdGdldENhdGFseXN0RmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHRmZWF0dXJlLmlzVGltZUdhdGVkICYmIGZlYXR1cmUuZWFybHlBY2Nlc3NPbmx5XG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IHRlc3Rpbmdcblx0ICovXG5cdHVwZGF0ZURlYnVnU2V0dGluZ3Moc2V0dGluZ3M6IERlYnVnU2V0dGluZ3MpOiB2b2lkIHtcblx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCBuZXcgZGVidWcgc2V0dGluZ3Ncblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeVxuXHQgKi9cblx0Z2V0RmVhdHVyZVN1bW1hcnkoKTogeyBcblx0XHRpc0NhdGFseXN0OiBib29sZWFuOyBcblx0XHRlbmFibGVkOiBzdHJpbmdbXTsgXG5cdFx0Y29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzQ2F0YWx5c3Q6IGJvb2xlYW59PiBcblx0fSB7XG5cdFx0Y29uc3QgZW5hYmxlZDogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBjb21pbmdTb29uOiBBcnJheTx7a2V5OiBzdHJpbmc7IGF2YWlsYWJsZURhdGU6IHN0cmluZzsgaXNDYXRhbHlzdDogYm9vbGVhbn0+ID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZlYXR1cmUuaXNUaW1lR2F0ZWQpIHtcblx0XHRcdFx0Y29uc3QgY29uZmlnID0gQ0FUQUxZU1RfRkVBVFVSRVNba2V5XTtcblx0XHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRcdGNvbnN0IGlzQ2F0YWx5c3RVc2VyID0gdGhpcy5nZXRJc0NhdGFseXN0KCk7XG5cdFx0XHRcdFx0Y29taW5nU29vbi5wdXNoKHtcblx0XHRcdFx0XHRcdGtleSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGlzQ2F0YWx5c3RVc2VyID8gY29uZmlnLmNhdGFseXN0RGF0ZSA6IGNvbmZpZy5nZW5lcmFsRGF0ZSxcblx0XHRcdFx0XHRcdGlzQ2F0YWx5c3Q6IGlzQ2F0YWx5c3RVc2VyXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4geyBcblx0XHRcdGlzQ2F0YWx5c3Q6IHRoaXMuZ2V0SXNDYXRhbHlzdCgpLCBcblx0XHRcdGVuYWJsZWQsIFxuXHRcdFx0Y29taW5nU29vbiBcblx0XHR9O1xuXHR9XG59IiwgImltcG9ydCB7IExpY2Vuc2UsIENhdGFseXN0TGljZW5zZSwgTGljZW5zZVZhbGlkYXRpb25SZXN1bHQsIENhdGFseXN0VmFsaWRhdGlvblJlc3VsdCwgTGljZW5zZUVycm9yIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBMaWNlbnNlVmFsaWRhdG9yIHtcblx0Ly8gRW1iZWRkZWQgc2lnbmluZyBrZXkgLSBpbiBwcm9kdWN0aW9uIHRoaXMgd291bGQgYmUgb2JmdXNjYXRlZFxuXHRwcml2YXRlIHJlYWRvbmx5IFNFQ1JFVF9LRVkgPSAnbm92YS1saWNlbnNlLXNpZ25pbmcta2V5LTIwMjUnO1xuXHRcblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIGxpY2Vuc2Uga2V5IGFuZCByZXR1cm5zIHZhbGlkYXRpb24gcmVzdWx0XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nKTogUHJvbWlzZTxMaWNlbnNlVmFsaWRhdGlvblJlc3VsdD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBsaWNlbnNlID0gdGhpcy5wYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleSk7XG5cdFx0XHRpZiAoIWxpY2Vuc2UpIHtcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLklOVkFMSURfRk9STUFUIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBhd2FpdCB0aGlzLnZhbGlkYXRlTGljZW5zZU9iamVjdChsaWNlbnNlKTtcblx0XHRcdGlmICh2YWxpZGF0aW9uRXJyb3IpIHtcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0XHRsaWNlbnNlLFxuXHRcdFx0XHRcdGVycm9yOiB2YWxpZGF0aW9uRXJyb3IgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogdHJ1ZSwgXG5cdFx0XHRcdGxpY2Vuc2UgXG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5NQUxGT1JNRURfREFUQSBcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBhcnNlcyBhIGxpY2Vuc2Uga2V5IHN0cmluZyBpbnRvIGEgTGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgcGFyc2VMaWNlbnNlS2V5KGxpY2Vuc2VLZXk6IHN0cmluZyk6IExpY2Vuc2UgfCBudWxsIHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gTGljZW5zZSBrZXkgZm9ybWF0OiBiYXNlNjQoZW1haWx8dGllcnxleHBpcmVzQXR8aXNzdWVkQXR8c2lnbmF0dXJlKVxuXHRcdFx0Y29uc3QgZGVjb2RlZCA9IHRoaXMuYmFzZTY0RGVjb2RlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBkZWNvZGVkLnNwbGl0KCd8Jyk7XG5cdFx0XHRcblx0XHRcdGlmIChwYXJ0cy5sZW5ndGggIT09IDUpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IFtlbWFpbCwgdGllciwgZXhwaXJlc0F0U3RyLCBpc3N1ZWRBdFN0ciwgc2lnbmF0dXJlXSA9IHBhcnRzO1xuXG5cdFx0XHQvLyBTa2lwIHRpZXIgdmFsaWRhdGlvbiBzaW5jZSB3ZSdyZSByZW1vdmluZyB0aWVyc1xuXG5cdFx0XHQvLyBQYXJzZSBkYXRlc1xuXHRcdFx0Y29uc3QgZXhwaXJlc0F0ID0gZXhwaXJlc0F0U3RyID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKGV4cGlyZXNBdFN0cik7XG5cdFx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKGlzc3VlZEF0U3RyKTtcblxuXHRcdFx0Ly8gVmFsaWRhdGUgZGF0ZXNcblx0XHRcdGlmIChpc05hTihpc3N1ZWRBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXhwaXJlc0F0ICYmIGlzTmFOKGV4cGlyZXNBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRlbWFpbCxcblx0XHRcdFx0ZXhwaXJlc0F0LFxuXHRcdFx0XHRpc3N1ZWRBdCxcblx0XHRcdFx0c2lnbmF0dXJlLFxuXHRcdFx0XHRsaWNlbnNlS2V5XG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU2FmZSBiYXNlNjQgZGVjb2RlIHRoYXQgaGFuZGxlcyBib3RoIGJyb3dzZXIgYW5kIE5vZGUuanMgZW52aXJvbm1lbnRzXG5cdCAqL1xuXHRwcml2YXRlIGJhc2U2NERlY29kZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHR5cGVvZiBhdG9iICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIGF0b2Ioc3RyKTtcblx0XHR9XG5cdFx0Ly8gRmFsbGJhY2sgZm9yIE5vZGUuanMgZW52aXJvbm1lbnRcblx0XHRyZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAnYmFzZTY0JykudG9TdHJpbmcoJ3V0ZjgnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBlbmNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RW5jb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGJ0b2EgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYnRvYShzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICd1dGY4JykudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIGxpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHZhbGlkYXRlTGljZW5zZU9iamVjdChsaWNlbnNlOiBMaWNlbnNlKTogUHJvbWlzZTxMaWNlbnNlRXJyb3IgfCBudWxsPiB7XG5cdFx0Ly8gMS4gVmVyaWZ5IEhNQUMgc2lnbmF0dXJlXG5cdFx0Y29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKFxuXHRcdFx0bGljZW5zZS5lbWFpbCxcblx0XHRcdCdsZWdhY3knLCAvLyBVc2UgbGVnYWN5IGZvciBvbGQgbGljZW5zZXNcblx0XHRcdGxpY2Vuc2UuZXhwaXJlc0F0LFxuXHRcdFx0bGljZW5zZS5pc3N1ZWRBdFxuXHRcdCk7XG5cblx0XHRpZiAobGljZW5zZS5zaWduYXR1cmUgIT09IGV4cGVjdGVkU2lnbmF0dXJlKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLklOVkFMSURfU0lHTkFUVVJFO1xuXHRcdH1cblxuXHRcdC8vIDIuIENoZWNrIGV4cGlyYXRpb25cblx0XHRpZiAobGljZW5zZS5leHBpcmVzQXQgJiYgbmV3IERhdGUoKSA+IGxpY2Vuc2UuZXhwaXJlc0F0KSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkVYUElSRUQ7XG5cdFx0fVxuXG5cdFx0Ly8gMy4gVmFsaWRhdGUgaXNzdWUgZGF0ZSAocHJldmVudCBmdXR1cmUtZGF0ZWQgbGljZW5zZXMpXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBsaWNlbnNlIGRhdGFcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0ZW1haWw6IHN0cmluZyxcblx0XHR0aWVyOiBzdHJpbmcsXG5cdFx0ZXhwaXJlc0F0OiBEYXRlIHwgbnVsbCxcblx0XHRpc3N1ZWRBdDogRGF0ZVxuXHQpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGRhdGEgPSBgJHtlbWFpbH18JHt0aWVyfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9YDtcblx0XHRcblx0XHRjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG5cdFx0Y29uc3Qga2V5RGF0YSA9IGVuY29kZXIuZW5jb2RlKHRoaXMuU0VDUkVUX0tFWSk7XG5cdFx0Y29uc3QgbWVzc2FnZURhdGEgPSBlbmNvZGVyLmVuY29kZShkYXRhKTtcblx0XHRcblx0XHRjb25zdCBjcnlwdG9LZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcblx0XHRcdCdyYXcnLFxuXHRcdFx0a2V5RGF0YSxcblx0XHRcdHsgbmFtZTogJ0hNQUMnLCBoYXNoOiAnU0hBLTI1NicgfSxcblx0XHRcdGZhbHNlLFxuXHRcdFx0WydzaWduJ11cblx0XHQpO1xuXHRcdFxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuc2lnbignSE1BQycsIGNyeXB0b0tleSwgbWVzc2FnZURhdGEpO1xuXHRcdHJldHVybiBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZSkpXG5cdFx0XHQubWFwKGIgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKSlcblx0XHRcdC5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgdGVzdCBsaWNlbnNlIGZvciBkZXZlbG9wbWVudCBwdXJwb3Nlc1xuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdExpY2Vuc2UoZW1haWw6IHN0cmluZywgdGllcjogc3RyaW5nLCBsaWZldGltZU1vZGUgPSB0cnVlKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gbGlmZXRpbWVNb2RlID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKGVtYWlsLCB0aWVyLCBleHBpcmVzQXQsIGlzc3VlZEF0KTtcblx0XHRcblx0XHRjb25zdCBsaWNlbnNlRGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX18JHtzaWduYXR1cmV9YDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5iYXNlNjRFbmNvZGUobGljZW5zZURhdGEpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIENhdGFseXN0IGxpY2Vuc2Uga2V5XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZUNhdGFseXN0TGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPENhdGFseXN0VmFsaWRhdGlvblJlc3VsdD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBsaWNlbnNlID0gdGhpcy5wYXJzZUNhdGFseXN0TGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVDYXRhbHlzdExpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBDYXRhbHlzdCBsaWNlbnNlIGtleSBzdHJpbmdcblx0ICovXG5cdHByaXZhdGUgcGFyc2VDYXRhbHlzdExpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogQ2F0YWx5c3RMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENhdGFseXN0IGxpY2Vuc2Uga2V5IGZvcm1hdDogYmFzZTY0KGVtYWlsfHR5cGV8ZXhwaXJlc0F0fGlzc3VlZEF0fHNpZ25hdHVyZSlcblx0XHRcdGNvbnN0IGRlY29kZWQgPSB0aGlzLmJhc2U2NERlY29kZShsaWNlbnNlS2V5KTtcblx0XHRcdGNvbnN0IHBhcnRzID0gZGVjb2RlZC5zcGxpdCgnfCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAocGFydHMubGVuZ3RoICE9PSA1KSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBbZW1haWwsIHR5cGUsIGV4cGlyZXNBdFN0ciwgaXNzdWVkQXRTdHIsIHNpZ25hdHVyZV0gPSBwYXJ0cztcblxuXHRcdFx0Ly8gVmFsaWRhdGUgdHlwZVxuXHRcdFx0aWYgKHR5cGUgIT09ICdhbm51YWwnICYmIHR5cGUgIT09ICdsaWZldGltZScpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHR0eXBlOiB0eXBlIGFzICdhbm51YWwnIHwgJ2xpZmV0aW1lJyxcblx0XHRcdFx0ZXhwaXJlc0F0LFxuXHRcdFx0XHRpc3N1ZWRBdCxcblx0XHRcdFx0c2lnbmF0dXJlLFxuXHRcdFx0XHRsaWNlbnNlS2V5XG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgQ2F0YWx5c3QgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVDYXRhbHlzdExpY2Vuc2VPYmplY3QobGljZW5zZTogQ2F0YWx5c3RMaWNlbnNlKTogUHJvbWlzZTxMaWNlbnNlRXJyb3IgfCBudWxsPiB7XG5cdFx0Ly8gMS4gVmVyaWZ5IEhNQUMgc2lnbmF0dXJlXG5cdFx0Y29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ2F0YWx5c3RTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50eXBlLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBDYXRhbHlzdCBsaWNlbnNlXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdlbmVyYXRlQ2F0YWx5c3RTaWduYXR1cmUoXG5cdFx0ZW1haWw6IHN0cmluZyxcblx0XHR0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScsXG5cdFx0ZXhwaXJlc0F0OiBEYXRlIHwgbnVsbCxcblx0XHRpc3N1ZWRBdDogRGF0ZVxuXHQpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGRhdGEgPSBgJHtlbWFpbH18JHt0eXBlfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9YDtcblx0XHRcblx0XHRjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG5cdFx0Y29uc3Qga2V5RGF0YSA9IGVuY29kZXIuZW5jb2RlKHRoaXMuU0VDUkVUX0tFWSk7XG5cdFx0Y29uc3QgbWVzc2FnZURhdGEgPSBlbmNvZGVyLmVuY29kZShkYXRhKTtcblx0XHRcblx0XHRjb25zdCBjcnlwdG9LZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcblx0XHRcdCdyYXcnLFxuXHRcdFx0a2V5RGF0YSxcblx0XHRcdHsgbmFtZTogJ0hNQUMnLCBoYXNoOiAnU0hBLTI1NicgfSxcblx0XHRcdGZhbHNlLFxuXHRcdFx0WydzaWduJ11cblx0XHQpO1xuXHRcdFxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuc2lnbignSE1BQycsIGNyeXB0b0tleSwgbWVzc2FnZURhdGEpO1xuXHRcdHJldHVybiBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZSkpXG5cdFx0XHQubWFwKGIgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKSlcblx0XHRcdC5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgdGVzdCBDYXRhbHlzdCBsaWNlbnNlIGZvciBkZXZlbG9wbWVudFxuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdENhdGFseXN0TGljZW5zZShlbWFpbDogc3RyaW5nLCB0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSB0eXBlID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ2F0YWx5c3RTaWduYXR1cmUoZW1haWwsIHR5cGUsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dHlwZX18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cbn0i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WTtBQUVoRCxlQUFTLEtBQUssWUFBWSxLQUFLO0FBQy9CLFlBQU0sTUFBTTtBQUFBLElBQ2IsQ0FBQztBQUFBLEVBQ0Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDBCQUFnQztBQUN2QyxVQUFNLFFBQVEsU0FBUyxjQUFjLEtBQUs7QUFDMUMsVUFBTSxZQUFZO0FBQ2xCLFVBQU0sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBaUNsQixVQUFNLGFBQWEsTUFBTSxjQUFjLG1CQUFtQjtBQUMxRCxVQUFNLFdBQVcsTUFBTSxjQUFjLGlCQUFpQjtBQUN0RCxVQUFNLFVBQVUsTUFBTSxjQUFjLFdBQVc7QUFFL0MsVUFBTSxhQUFhLE1BQU07QUFDeEIsWUFBTSxPQUFPO0FBQUEsSUFDZDtBQUVBLGVBQVcsaUJBQWlCLFNBQVMsTUFBTTtBQUMxQyxhQUFPLEtBQUssaUNBQWlDLFFBQVE7QUFDckQsaUJBQVc7QUFBQSxJQUNaLENBQUM7QUFFRCxhQUFTLGlCQUFpQixTQUFTLFVBQVU7QUFDN0MsWUFBUSxpQkFBaUIsU0FBUyxVQUFVO0FBRTVDLGFBQVMsS0FBSyxZQUFZLEtBQUs7QUFHL0IsUUFBSSx3QkFBTyxpREFBaUQsR0FBSTtBQUFBLEVBQ2pFO0FBQUE7QUFBQSxFQUdBLE1BQU0sZ0JBQWdCLEtBQTJCO0FBQ2hELFVBQU0sVUFBVSxNQUFNLEtBQUssU0FBUztBQUNwQyxXQUFPLFVBQVUsUUFBUSxHQUFHLElBQUk7QUFBQSxFQUNqQztBQUFBLEVBRUEsTUFBTSxnQkFBZ0IsS0FBYSxNQUEwQjtBQUM1RCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVMsS0FBSyxDQUFDO0FBQzFDLFlBQVEsR0FBRyxJQUFJO0FBQ2YsV0FBTyxNQUFNLEtBQUssU0FBUyxPQUFPO0FBQUEsRUFDbkM7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgImlzQ2F0YWx5c3QiLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJleGlzdGluZyIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJuZXdGcm9udG1hdHRlciJdCn0K
