/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian16 = require("obsidian");

// src/settings.ts
var import_obsidian12 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian11 = require("obsidian");

// src/core/document-analysis.ts
var DocumentAnalyzer = class {
  static analyzeStructure(content) {
    const lines = content.split("\n");
    const headings = [];
    const emptyHeadings = [];
    const incompleteBullets = [];
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i].trim();
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        const hasContent = this.hasContentAfterHeading(lines, i);
        const isEmpty = !hasContent;
        headings.push({ level, text, isEmpty });
        if (isEmpty) {
          emptyHeadings.push(text);
        }
      }
      if (line.match(/^[-*+]\s*(.*)\.\.\.?\s*$/) || line.match(/^[-*+]\s*$/) || line.match(/^[-*+]\s*(TODO|TBD)/i)) {
        incompleteBullets.push(line);
      }
    }
    const wordCount = content.split(/\s+/).filter((word) => word.length > 0).length;
    return {
      headings,
      wordCount,
      emptyHeadings,
      incompleteBullets
    };
  }
  static hasContentAfterHeading(lines, headingIndex) {
    var _a;
    const currentHeading = lines[headingIndex].trim();
    const currentLevel = ((_a = currentHeading.match(/^(#{1,6})/)) == null ? void 0 : _a[1].length) || 0;
    for (let i = headingIndex + 1; i < lines.length; i++) {
      const line = lines[i].trim();
      const headingMatch = line.match(/^(#{1,6})\s/);
      if (headingMatch) {
        const nextLevel = headingMatch[1].length;
        if (nextLevel <= currentLevel) {
          return false;
        }
      }
      if (line.length > 0) return true;
    }
    return false;
  }
};

// src/core/multi-doc-context.ts
var import_obsidian = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
      if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
        return false;
      }
      return true;
    });
    if (allPersistentDocs.length !== rawPersistentDocs.length) {
      if (allPersistentDocs.length > 0) {
        this.persistentContext.set(currentFile.path, allPersistentDocs);
      } else {
        this.persistentContext.delete(currentFile.path);
      }
    }
    const contextParts = [];
    const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
    if (currentFileContext) {
      contextParts.push(currentFileContext);
    }
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ai/models.ts
function getAvailableModels(providerType, settings) {
  var _a, _b;
  switch (providerType) {
    case "claude":
      return [
        { value: "claude-opus-4-20250514", label: "Claude Opus 4" },
        { value: "claude-sonnet-4-20250514", label: "Claude Sonnet 4" },
        { value: "claude-3-7-sonnet-latest", label: "Claude 3.7 Sonnet" },
        { value: "claude-3-5-sonnet-latest", label: "Claude 3.5 Sonnet" },
        { value: "claude-3-5-sonnet-20241022", label: "Claude 3.5 Sonnet (Oct 22)" },
        { value: "claude-3-5-haiku-latest", label: "Claude 3.5 Haiku" }
      ];
    case "openai":
      return [
        { value: "gpt-4.1-2025-04-14", label: "GPT-4.1" },
        { value: "gpt-4.1-mini-2025-04-14", label: "GPT-4.1 Mini" },
        { value: "gpt-4.1-nano-2025-04-14", label: "GPT-4.1 Nano" },
        { value: "gpt-4o", label: "GPT-4o" },
        { value: "gpt-4o-mini", label: "GPT-4o Mini" }
      ];
    case "google":
      return [
        { value: "gemini-2.5-flash-preview-04-17", label: "Gemini 2.5 Flash" },
        { value: "gemini-2.5-pro-preview-03-25", label: "Gemini 2.5 Pro" },
        { value: "gemini-2.0-flash", label: "Gemini 2.0 Flash" },
        { value: "gemini-2.0-flash-lite", label: "Gemini 2.0 Flash-Lite" }
      ];
    case "ollama":
      const ollamaModel = (_b = (_a = settings == null ? void 0 : settings.aiProviders) == null ? void 0 : _a.ollama) == null ? void 0 : _b.model;
      if (ollamaModel && ollamaModel.trim()) {
        return [{ value: ollamaModel, label: ollamaModel }];
      }
      return [];
    default:
      return [];
  }
}

// src/ui/input-handler.ts
var import_obsidian3 = require("obsidian");

// src/ui/wikilink-suggest.ts
var import_obsidian2 = require("obsidian");
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea, container) {
    // Reference to NovaSidebarView
    this.lastTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.setupEventListeners();
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch && cursorPos !== this.lastTriggerPos) {
      this.lastTriggerPos = cursorPos;
      this.showNativeFileModal();
    }
  }
  showNativeFileModal() {
    const modal = new WikilinkFileModal(
      this.app,
      async (file) => {
        await this.selectFile(file);
      },
      () => {
        this.lastTriggerPos = -1;
      }
    );
    modal.open();
  }
  async selectFile(file) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch) {
      const startPos = cursorPos - linkMatch[0].length;
      const newText = text.substring(0, startPos) + text.substring(cursorPos);
      this.textArea.value = newText;
      this.textArea.setSelectionRange(startPos, startPos);
      this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    }
    if (this.sidebarView && this.sidebarView.addFilesToContext) {
      await this.sidebarView.addFilesToContext([file.basename]);
    }
    this.lastTriggerPos = -1;
    this.textArea.focus();
  }
  destroy() {
  }
};
var WikilinkFileModal = class extends import_obsidian2.FuzzySuggestModal {
  constructor(app, onSelect, onCancel) {
    super(app);
    this.allFiles = [];
    this.onSelectCallback = onSelect;
    this.onCancelCallback = onCancel;
    this.setPlaceholder("Search files to add to context...");
    this.loadFiles();
  }
  onOpen() {
    super.onOpen();
    this.addInstructions();
  }
  addInstructions() {
    const instructionsEl = this.modalEl.createDiv({ cls: "prompt-instructions" });
    const navInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    navInstruction.createSpan({ cls: "prompt-instruction-command", text: "\u2191\u2193" });
    navInstruction.createSpan({ text: "to navigate" });
    const useInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    useInstruction.createSpan({ cls: "prompt-instruction-command", text: "\u21B5" });
    useInstruction.createSpan({ text: "to use" });
    const escInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    escInstruction.createSpan({ cls: "prompt-instruction-command", text: "esc" });
    escInstruction.createSpan({ text: "to dismiss" });
  }
  loadFiles() {
    this.allFiles = this.app.vault.getMarkdownFiles();
    this.allFiles.sort((a, b) => b.stat.mtime - a.stat.mtime);
  }
  getItems() {
    return this.allFiles;
  }
  getItemText(file) {
    return file.basename;
  }
  onChooseItem(file) {
    this.onSelectCallback(file);
  }
  renderSuggestion(match, el) {
    const file = match.item;
    const container = el.createDiv({ cls: "suggestion-content" });
    const title = container.createDiv({ cls: "suggestion-title" });
    title.textContent = file.basename;
    const aux = container.createDiv({ cls: "suggestion-aux" });
    aux.textContent = file.path;
  }
  onClose() {
    super.onClose();
    if (this.onCancelCallback) {
      this.onCancelCallback();
    }
  }
};

// src/ui/input-handler.ts
var _InputHandler = class _InputHandler {
  constructor(plugin, container, contextManager) {
    this.dropZoneOverlay = null;
    this.isDragging = false;
    // Reference to NovaSidebarView for context operations
    // Event cleanup tracking
    this.eventListeners = [];
    this.plugin = plugin;
    this.container = container;
    this.contextManager = contextManager;
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.setSidebarView(sidebarView);
    }
  }
  setCommandSystem(commandSystem) {
    this.commandSystem = commandSystem;
    const sendButtonEl = this.sendButton.buttonEl;
    sendButtonEl.remove();
    this.commandSystem.createCommandButton(this.inputRow);
    this.inputRow.appendChild(sendButtonEl);
    this.commandSystem.createCommandPickerInContainer(this.inputRow);
  }
  getTextArea() {
    return this.textArea;
  }
  createInputInterface(chatContainer) {
    this.container = this.container.createDiv({ cls: "nova-input-container" });
    this.container.style.cssText = `
			flex-shrink: 0;
			padding: var(--size-4-3);
			border-top: 1px solid var(--background-modifier-border);
			position: relative;
		`;
    this.inputRow = this.container.createDiv({ cls: "nova-input-row" });
    this.inputRow.style.cssText = `
			display: flex;
			gap: var(--size-2-3);
			align-items: center;
			position: relative;
		`;
    const textAreaContainer = this.inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian3.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("How can I help with your writing?");
    this.textArea.inputEl.style.cssText = `
			min-height: 80px;
			max-height: 200px;
			resize: none;
			overflow-y: auto;
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			border: 1px solid var(--background-modifier-border);
			background: var(--background-primary);
			color: var(--text-normal);
			font-family: var(--font-interface);
			font-size: var(--font-ui-medium);
			line-height: 1.4;
			width: 100%;
			box-sizing: border-box;
		`;
    this.autoGrowTextarea = () => {
      const textarea = this.textArea.inputEl;
      textarea.style.height = "auto";
      textarea.style.height = Math.min(textarea.scrollHeight, 200) + "px";
    };
    this.addEventListener(this.textArea.inputEl, "input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.plugin.app, this.textArea.inputEl, this.inputRow);
    if (this.sidebarView) {
      this.wikilinkAutocomplete.setSidebarView(this.sidebarView);
    }
    this.addEventListener(this.textArea.inputEl, "input", () => {
      this.contextManager.updateLiveContextPreview(this.textArea.getValue());
    });
    this.sendButton = new import_obsidian3.ButtonComponent(this.inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
		`;
    this.addEventListener(this.textArea.inputEl, "keydown", (event) => {
      var _a, _b, _c, _d;
      const keyEvent = event;
      if (keyEvent.key === "Enter" && !keyEvent.shiftKey) {
        event.preventDefault();
        ((_a = this.commandSystem) == null ? void 0 : _a.handleCommandPickerSelection()) || false || this.handleSend();
      } else if (keyEvent.key === "Escape") {
        (_b = this.commandSystem) == null ? void 0 : _b.hideCommandPicker();
      } else if (keyEvent.key === "ArrowUp" || keyEvent.key === "ArrowDown") {
        if ((_c = this.commandSystem) == null ? void 0 : _c.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      } else if (keyEvent.key === "Tab") {
        if ((_d = this.commandSystem) == null ? void 0 : _d.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      }
    });
    this.addEventListener(this.textArea.inputEl, "input", () => {
      if (this.commandSystem) {
        this.commandSystem.handleInputChange();
      }
    });
    this.setupDragAndDrop();
  }
  focus() {
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _InputHandler.FOCUS_DELAY_MS);
  }
  handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.textArea.setValue("");
    this.autoGrowTextarea();
    this.contextManager.hideContextPreview();
    (_a = this.onSendMessage) == null ? void 0 : _a.call(this, message);
  }
  setOnSendMessage(callback) {
    this.onSendMessage = callback;
  }
  getValue() {
    return this.textArea.getValue();
  }
  setValue(value) {
    this.textArea.setValue(value);
    this.autoGrowTextarea();
  }
  insertText(text) {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + text + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const newPosition = start + text.length;
    setTimeout(() => {
      textarea.setSelectionRange(newPosition, newPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  insertTextWithCursor(beforeCursor, afterCursor = "") {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + beforeCursor + afterCursor + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const cursorPosition = start + beforeCursor.length;
    setTimeout(() => {
      textarea.setSelectionRange(cursorPosition, cursorPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.eventListeners.push({ element, event, handler });
  }
  setupDragAndDrop() {
    const dropZone = this.textArea.inputEl;
    this.addEventListener(dropZone, "dragenter", (e) => {
      e.preventDefault();
      this.handleDragEnter();
    });
    this.addEventListener(dropZone, "dragover", (e) => {
      e.preventDefault();
      e.dataTransfer.dropEffect = "copy";
    });
    this.addEventListener(dropZone, "dragleave", (e) => {
      if (e.target === dropZone) {
        this.handleDragLeave();
      }
    });
    this.addEventListener(dropZone, "drop", (e) => {
      e.preventDefault();
      this.handleDrop(e);
    });
  }
  handleDragEnter() {
    if (this.isDragging) return;
    this.isDragging = true;
    if (!this.dropZoneOverlay) {
      this.dropZoneOverlay = document.createElement("div");
      this.dropZoneOverlay.className = "nova-drop-zone-overlay";
      this.dropZoneOverlay.style.cssText = `
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: var(--interactive-accent);
				opacity: 0;
				border: 2px dashed var(--interactive-accent);
				border-radius: var(--radius-s);
				display: flex;
				align-items: center;
				justify-content: center;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 10;
			`;
      const iconContainer = document.createElement("div");
      iconContainer.style.cssText = `
				background: var(--background-primary);
				border-radius: 50%;
				width: 48px;
				height: 48px;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
				opacity: 0;
				transform: scale(0.8);
				transition: all 0.2s ease;
			`;
      const icon = document.createElement("div");
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>`;
      icon.style.cssText = `
				color: var(--interactive-accent);
				display: flex;
				align-items: center;
				justify-content: center;
			`;
      iconContainer.appendChild(icon);
      this.dropZoneOverlay.appendChild(iconContainer);
    }
    const textAreaContainer = this.textArea.inputEl.parentElement;
    textAreaContainer.style.position = "relative";
    textAreaContainer.appendChild(this.dropZoneOverlay);
    setTimeout(() => {
      if (this.dropZoneOverlay) {
        this.dropZoneOverlay.style.opacity = "0.1";
        const icon = this.dropZoneOverlay.querySelector("div");
        if (icon) {
          icon.style.opacity = "1";
          icon.style.transform = "scale(1)";
        }
      }
    }, 10);
  }
  handleDragLeave() {
    this.isDragging = false;
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.style.opacity = "0";
      const icon = this.dropZoneOverlay.querySelector("div");
      if (icon) {
        icon.style.opacity = "0";
        icon.style.transform = "scale(0.8)";
      }
      setTimeout(() => {
        var _a;
        (_a = this.dropZoneOverlay) == null ? void 0 : _a.remove();
        this.dropZoneOverlay = null;
      }, 200);
    }
  }
  handleDrop(e) {
    var _a;
    this.handleDragLeave();
    const files = [];
    const textPlainData = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
    if (textPlainData && textPlainData.includes("obsidian://open?")) {
      const urls = textPlainData.split(/[\n\r]/).filter((line) => line.trim().startsWith("obsidian://open?"));
      for (const urlString of urls) {
        try {
          const url = new URL(urlString.trim());
          const filePath = url.searchParams.get("file");
          if (filePath) {
            const decodedPath = decodeURIComponent(filePath);
            const pathParts = decodedPath.split(/[/\\]/);
            const filename = pathParts[pathParts.length - 1];
            if (filename.endsWith(".md")) {
              const baseName = filename.replace(".md", "");
              if (baseName && !files.includes(baseName)) {
                files.push(baseName);
              }
            } else {
              if (filename && !files.includes(filename)) {
                files.push(filename);
              }
            }
          }
        } catch (error) {
          console.warn("Failed to parse Obsidian URL:", urlString, error);
        }
      }
    }
    if (files.length > 0) {
      this.addFilesToContext(files);
    } else if (textPlainData && textPlainData.includes("obsidian://open?")) {
      new import_obsidian3.Notice("Only markdown files can be added to context", 3e3);
    } else if (textPlainData && textPlainData.trim() && !textPlainData.includes("://")) {
      new import_obsidian3.Notice("Folders cannot be added to context. Please select individual files.", 3e3);
    }
  }
  async addFilesToContext(filenames) {
    if (filenames.length === 0) return;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      new import_obsidian3.Notice("Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025.", 3e3);
      return;
    }
    if (this.sidebarView) {
      await this.sidebarView.addFilesToContext(filenames);
    }
  }
  refreshCommandButton() {
    if (this.commandSystem) {
      this.commandSystem.updateCommandButtonVisibility();
    }
  }
  updateContextState(hasContext) {
    if (this.container) {
      if (hasContext) {
        this.container.classList.add("has-context");
      } else {
        this.container.classList.remove("has-context");
      }
    }
  }
  cleanup() {
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.remove();
      this.dropZoneOverlay = null;
    }
    this.eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.eventListeners = [];
  }
};
_InputHandler.FOCUS_DELAY_MS = 150;
var InputHandler = _InputHandler;

// src/ui/command-system.ts
var import_obsidian4 = require("obsidian");
var CommandSystem = class {
  constructor(plugin, container, textArea) {
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.plugin = plugin;
    this.container = container;
    this.textArea = textArea;
  }
  createCommandButton(inputRow) {
    this.commandButton = new import_obsidian4.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: var(--size-2-3);
		`;
    return this.commandButton;
  }
  createCommandPicker() {
    this.createCommandPickerInContainer(this.container);
  }
  createCommandPickerInContainer(container) {
    this.commandPicker = container.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			margin-bottom: 4px;
		`;
  }
  shouldShowCommandButton() {
    return import_obsidian4.Platform.isMobile && this.plugin.settings.showCommandButton && this.plugin.featureManager.isFeatureEnabled("commands");
  }
  updateCommandButtonVisibility() {
    if (this.commandButton) {
      const shouldShow = this.shouldShowCommandButton();
      this.commandButton.buttonEl.style.display = shouldShow ? "flex" : "none";
    }
  }
  toggleCommandMenu() {
    if (!this.commandMenu) {
      this.createCommandMenu();
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  createCommandMenu() {
    this.commandMenu = this.container.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			box-shadow: var(--shadow-s);
			min-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			padding: var(--size-2-2);
		`;
    const commands = [
      { name: "Improve Writing", description: "Enhance clarity and flow", command: "improve writing" },
      { name: "Fix Grammar", description: "Correct grammar and spelling", command: "fix grammar" },
      { name: "Summarize", description: "Create a concise summary", command: "summarize" },
      { name: "Expand Ideas", description: "Develop thoughts further", command: "expand" },
      { name: "Explain", description: "Clarify complex concepts", command: "explain this" },
      { name: "Continue Writing", description: "Extend the current text", command: "continue writing" }
    ];
    const title = this.commandMenu.createEl("div", { text: "Quick Commands" });
    title.style.cssText = `
			font-size: var(--font-ui-medium);
			font-weight: 600;
			margin-bottom: var(--size-2-3);
			color: var(--text-normal);
		`;
    commands.forEach((cmd) => {
      const cmdEl = this.commandMenu.createDiv({ cls: "nova-command-item" });
      cmdEl.style.cssText = `
				padding: var(--size-2-2) var(--size-2-3);
				border-radius: var(--radius-xs);
				cursor: pointer;
				margin-bottom: var(--size-2-1);
				transition: background-color 0.1s;
			`;
      const nameEl = cmdEl.createEl("div", { text: cmd.name });
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
				margin-bottom: var(--size-2-1);
			`;
      const descEl = cmdEl.createEl("div", { text: cmd.description });
      descEl.style.cssText = `
				font-size: var(--font-ui-smaller);
				color: var(--text-muted);
			`;
      cmdEl.addEventListener("click", () => {
        this.textArea.setValue(cmd.command + " ");
        this.textArea.inputEl.focus();
        this.hideCommandMenu();
      });
      cmdEl.addEventListener("mouseenter", () => {
        cmdEl.style.background = "var(--background-modifier-hover)";
      });
      cmdEl.addEventListener("mouseleave", () => {
        cmdEl.style.background = "transparent";
      });
    });
  }
  showCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "block";
      this.isCommandMenuVisible = true;
    }
  }
  hideCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "none";
      this.isCommandMenuVisible = false;
    }
  }
  handleInputChange() {
    if (!this.textArea) {
      return;
    }
    const input = this.textArea.getValue();
    if (input.startsWith(":")) {
      this.showStructuredCommandPicker(input);
    } else {
      this.hideCommandPicker();
    }
  }
  /**
   * Show structured command picker for ":" trigger  
   */
  showStructuredCommandPicker(input) {
    if (!this.commandPicker) {
      return;
    }
    const structuredCommands = this.getStructuredCommands();
    const filterText = input.slice(1).toLowerCase();
    const filtered = structuredCommands.filter(
      (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
    );
    this.commandPickerItems = [];
    this.commandPicker.empty();
    this.selectedCommandIndex = -1;
    if (filtered.length > 0) {
      filtered.forEach((cmd, index) => {
        const item = this.commandPicker.createDiv({ cls: "nova-command-picker-item" });
        item.style.cssText = `
					padding: 8px 12px;
					cursor: pointer;
					border-bottom: 1px solid var(--background-modifier-border-hover);
					transition: background-color 0.2s;
				`;
        const nameEl = item.createEl("div", { text: cmd.name });
        nameEl.style.cssText = `
					font-weight: 500;
					color: var(--text-normal);
					margin-bottom: 4px;
				`;
        const descEl = item.createEl("div", { text: cmd.description });
        descEl.style.cssText = `
					font-size: 0.85em;
					color: var(--text-muted);
					margin-bottom: 4px;
				`;
        const exampleEl = item.createEl("div", { text: `Example: ${cmd.example}` });
        exampleEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-accent);
					font-family: var(--font-monospace);
				`;
        item.addEventListener("click", () => {
          this.selectStructuredCommand(cmd.template);
        });
        item.addEventListener("mouseenter", () => {
          this.selectedCommandIndex = index;
          this.updateCommandPickerSelection();
        });
        this.commandPickerItems.push(item);
      });
      this.commandPicker.style.display = "block";
    } else {
      this.hideCommandPicker();
    }
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
  }
  handleCommandPickerNavigation(key) {
    if (this.commandPickerItems.length === 0) return false;
    if (key === "ArrowDown") {
      this.selectedCommandIndex = Math.min(this.selectedCommandIndex + 1, this.commandPickerItems.length - 1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "ArrowUp") {
      this.selectedCommandIndex = Math.max(this.selectedCommandIndex - 1, -1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "Tab" && this.selectedCommandIndex >= 0) {
      return this.handleCommandPickerSelection();
    }
    return false;
  }
  handleCommandPickerSelection() {
    if (this.selectedCommandIndex >= 0 && this.commandPickerItems.length > 0) {
      const commands = this.getStructuredCommands();
      const input = this.textArea.getValue();
      if (input.startsWith(":")) {
        const filterText = input.slice(1).toLowerCase();
        const filtered = commands.filter(
          (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
        );
        if (this.selectedCommandIndex < filtered.length) {
          const selectedCmd = filtered[this.selectedCommandIndex];
          this.selectStructuredCommand(selectedCmd.template);
          return true;
        }
      }
    }
    return false;
  }
  updateCommandPickerSelection() {
    this.commandPickerItems.forEach((item, index) => {
      if (index === this.selectedCommandIndex) {
        item.style.background = "var(--background-modifier-hover)";
      } else {
        item.style.background = "transparent";
      }
    });
  }
  selectCommand(command) {
    this.textArea.setValue(command + " ");
    this.textArea.inputEl.focus();
    const length = this.textArea.getValue().length;
    this.textArea.inputEl.setSelectionRange(length, length);
    this.hideCommandPicker();
  }
  /**
   * Get structured commands for ":" trigger
   */
  getStructuredCommands() {
    return [
      {
        name: "Add Content",
        description: "Add new content at cursor position",
        command: "add",
        template: "add {cursor}",
        example: ":add paragraph about methodology",
        keywords: ["create", "new", "insert", "write"]
      },
      {
        name: "Edit Selection",
        description: "Edit the selected text",
        command: "edit",
        template: "edit to {cursor}",
        example: ":edit to be more formal",
        keywords: ["modify", "update", "change", "revise"]
      },
      {
        name: "Delete Selection",
        description: "Remove the selected text",
        command: "delete",
        template: "delete {cursor}",
        example: ":delete selected text",
        keywords: ["remove", "eliminate", "erase"]
      },
      {
        name: "Rewrite",
        description: "Rewrite content with specific style",
        command: "rewrite",
        template: "rewrite as {cursor}",
        example: ":rewrite as bullet points",
        keywords: ["rephrase", "restructure", "reword"]
      },
      {
        name: "Fix Grammar",
        description: "Correct grammar and spelling errors",
        command: "grammar",
        template: "fix grammar {cursor}",
        example: ":fix grammar in selection",
        keywords: ["correct", "proofread", "spelling"]
      },
      {
        name: "Continue",
        description: "Continue writing from current position",
        command: "continue",
        template: "continue {cursor}",
        example: ":continue with examples",
        keywords: ["extend", "expand", "proceed"]
      },
      {
        name: "Update Metadata",
        description: "Update document properties",
        command: "metadata",
        template: "update {cursor} property",
        example: ":update tags property",
        keywords: ["frontmatter", "properties", "tags"]
      }
    ];
  }
  /**
   * Select a structured command and insert template
   */
  selectStructuredCommand(template) {
    this.hideCommandPicker();
    const cursorPos = template.indexOf("{cursor}");
    if (cursorPos !== -1) {
      const beforeCursor = template.slice(0, cursorPos);
      const afterCursor = template.slice(cursorPos + 8);
      this.textArea.setValue(beforeCursor + afterCursor);
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(cursorPos, cursorPos);
        this.textArea.inputEl.focus();
      }, 0);
    } else {
      this.textArea.setValue(template);
      this.textArea.inputEl.focus();
    }
  }
  cleanup() {
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.remove();
    }
  }
};

// src/ui/context-manager.ts
var import_obsidian5 = require("obsidian");
var _ContextManager = class _ContextManager {
  constructor(plugin, app, container) {
    this.currentContext = null;
    this.plugin = plugin;
    this.app = app;
    this.container = container;
    this.multiDocHandler = new MultiDocContextHandler(app);
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  createContextIndicator() {
    this.contextIndicator = this.container.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			position: absolute;
			top: -2px;
			right: var(--size-4-3);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-1) var(--size-2-2);
			font-size: var(--font-ui-smaller);
			color: var(--text-muted);
			display: none;
			z-index: 100;
			max-width: 200px;
			box-shadow: var(--shadow-s);
		`;
  }
  createContextPreview() {
    const previewContainer = this.container.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			margin-bottom: var(--size-2-2);
			font-size: var(--font-ui-small);
			display: none;
		`;
    const previewLabel = previewContainer.createSpan({ text: "Context: " });
    previewLabel.style.cssText = "color: var(--text-muted); font-weight: 600;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview(message) {
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      foundRefs.push({ name: docName, property });
    }
    if (foundRefs.length === 0) {
      this.contextPreview.style.display = "none";
      return;
    }
    const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
    if (previewList) {
      const refsText = foundRefs.map(
        (ref) => ref.property ? `${ref.name}#${ref.property}` : ref.name
      ).join(", ");
      previewList.textContent = refsText;
    }
    this.contextPreview.style.display = "block";
  }
  async buildContext(message, currentFile) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context") || !currentFile) {
      return null;
    }
    try {
      const result = await this.multiDocHandler.buildContext(message, currentFile);
      this.currentContext = result.context;
      if ((_a = result.context) == null ? void 0 : _a.persistentDocs.length) {
        this.updateContextIndicator(result.context);
        if (result.context.isNearLimit) {
          new import_obsidian5.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _ContextManager.NOTICE_DURATION_MS);
        }
      }
      return result.context;
    } catch (error) {
      return null;
    }
  }
  updateContextIndicator(context) {
    if (!this.contextIndicator) return;
    const docCount = context.persistentDocs.length;
    if (docCount > 0) {
      this.contextIndicator.textContent = `${docCount} doc${docCount > 1 ? "s" : ""}`;
      this.contextIndicator.style.display = "block";
      this.contextIndicator.style.cursor = "pointer";
      this.contextIndicator.onclick = () => {
        this.showContextDetails(context);
      };
      this.contextIndicator.addEventListener("mouseenter", () => {
        this.contextIndicator.style.background = "var(--interactive-hover)";
      });
      this.contextIndicator.addEventListener("mouseleave", () => {
        this.contextIndicator.style.background = "var(--background-primary)";
      });
    } else {
      this.contextIndicator.style.display = "none";
    }
  }
  showContextDetails(context) {
    const modal = this.container.createDiv({ cls: "nova-context-modal" });
    modal.style.cssText = `
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 10000;
		`;
    const content = modal.createDiv();
    content.style.cssText = `
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-4-4);
			max-width: 80%;
			max-height: 80%;
			overflow-y: auto;
			box-shadow: var(--shadow-s);
		`;
    const header = content.createEl("h3", { text: "Context Documents" });
    header.style.cssText = "margin-top: 0; margin-bottom: var(--size-4-3);";
    context.persistentDocs.forEach((doc) => {
      const docEl = content.createDiv();
      docEl.style.cssText = `
				padding: var(--size-2-2);
				margin-bottom: var(--size-2-2);
				background: var(--background-modifier-hover);
				border-radius: var(--radius-xs);
			`;
      const nameEl = docEl.createEl("div", { text: doc.file.basename });
      nameEl.style.cssText = "font-weight: 600; margin-bottom: var(--size-2-1);";
      if (doc.property) {
        const propEl = docEl.createEl("div", { text: `Property: ${doc.property}` });
        propEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted);";
      }
      const previewEl = docEl.createEl("div", { text: doc.file.path });
      previewEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted); margin-top: var(--size-2-1);";
    });
    const buttonContainer = content.createDiv();
    buttonContainer.style.cssText = `
			margin-top: var(--size-4-3);
			display: flex;
			gap: var(--size-2-2);
			justify-content: flex-end;
		`;
    const closeBtn = buttonContainer.createEl("button", { text: "Close" });
    closeBtn.style.cssText = `
			padding: var(--size-2-2) var(--size-4-3);
			background: var(--background-secondary);
			color: var(--text-normal);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			cursor: pointer;
		`;
    closeBtn.onclick = () => modal.remove();
    modal.onclick = (e) => {
      if (e.target === modal) modal.remove();
    };
  }
  hideContextPreview() {
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
  }
  hideContextIndicator() {
    if (this.contextIndicator) {
      this.contextIndicator.style.display = "none";
    }
  }
  clearCurrentContext() {
    this.currentContext = null;
    this.hideContextIndicator();
    this.hideContextPreview();
  }
  getCurrentContext() {
    return this.currentContext;
  }
  cleanup() {
    this.clearCurrentContext();
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.contextPreview) {
      this.contextPreview.remove();
    }
  }
};
// Reference to NovaSidebarView for adding files
_ContextManager.NOTICE_DURATION_MS = 5e3;
var ContextManager = _ContextManager;

// src/ui/chat-renderer.ts
var _ChatRenderer = class _ChatRenderer {
  constructor(plugin, chatContainer) {
    this.plugin = plugin;
    this.chatContainer = chatContainer;
  }
  /**
   * Add a chat message with role header
   */
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom(true);
  }
  /**
   * Unified message creation - determines CSS class at creation time
   */
  addStatusMessage(content, options) {
    const cssClass = this.getMessageCSSClass(content, options);
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${cssClass}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    if (options.persist) {
      const activeFile = this.plugin.app.workspace.getActiveFile();
      if (activeFile) {
        this.plugin.conversationManager.addSystemMessage(
          activeFile,
          content,
          { messageType: cssClass }
          // Store CSS class as metadata
        );
      }
    }
    this.scrollToBottom();
  }
  getMessageCSSClass(content, options) {
    if (options.type === "pill") {
      return `nova-pill-${options.variant}`;
    } else {
      return `nova-bubble-${options.variant}`;
    }
  }
  // Simple wrapper methods for backward compatibility
  addSuccessMessage(content, persist = false) {
    if (!content.startsWith("\u2713 ") && !content.includes("<svg")) {
      content = "\u2713 " + content;
    }
    this.addStatusMessage(content, { type: "pill", variant: "success", persist });
  }
  addErrorMessage(content, persist = false) {
    if (!content.startsWith("\u274C ") && !content.includes("<svg")) {
      content = "\u274C " + content;
    }
    const type = content.length <= 30 ? "pill" : "bubble";
    this.addStatusMessage(content, { type, variant: "error", persist });
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			padding: var(--size-4-4);
			margin-bottom: var(--size-4-3);
			background: var(--background-primary);
			border-radius: var(--radius-s);
			border: 1px solid var(--background-modifier-border);
		`;
    const content = message || `
			<div style="display: flex; flex-direction: column; align-items: center;">
				<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent); margin-bottom: var(--size-4-2);">
					<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
					<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				</svg>
				<p style="margin: 0; margin-left: var(--size-2-3); color: var(--text-muted); font-size: var(--font-ui-medium); line-height: 1.4; text-align: left; align-self: flex-start;">
					I'm your AI writing partner. Ask questions in chat or give commands to edit at your cursor position.<br><br>CTRL/CMD-Z once or twice to undo changes.
				</p>
			</div>
		`;
    welcomeEl.innerHTML = content;
    this.scrollToBottom(true);
  }
  clearChat() {
    this.chatContainer.empty();
  }
  scrollToBottom(smooth = false) {
    setTimeout(() => {
      if (smooth) {
        this.chatContainer.scrollTo({
          top: this.chatContainer.scrollHeight,
          behavior: "smooth"
        });
      } else {
        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
      }
    }, _ChatRenderer.SCROLL_DELAY_MS);
  }
  async loadConversationHistory(file) {
    var _a;
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
    if (messages.length === 0) {
      this.addWelcomeMessage();
      return;
    }
    for (const message of messages) {
      if (message.role === "system" && ((_a = message.metadata) == null ? void 0 : _a.messageType)) {
        const messageEl = this.chatContainer.createDiv({
          cls: `nova-message ${message.metadata.messageType}`
        });
        const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
        if (message.content.includes("<svg")) {
          contentEl.innerHTML = message.content;
        } else {
          contentEl.textContent = message.content;
        }
      } else {
        this.addMessage(message.role, message.content);
      }
    }
    this.scrollToBottom();
  }
};
_ChatRenderer.SCROLL_DELAY_MS = 50;
var ChatRenderer = _ChatRenderer;

// src/ui/streaming-manager.ts
var import_obsidian6 = require("obsidian");
var _StreamingManager = class _StreamingManager {
  constructor() {
    this.dotsAnimationInterval = null;
    this.thinkingNotice = null;
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Show thinking notice with context-aware phrase and animated dots
   */
  showThinkingNotice(actionType) {
    try {
      const phrases = _StreamingManager.THINKING_PHRASES[actionType] || _StreamingManager.THINKING_PHRASES["chat"];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      this.thinkingNotice = new import_obsidian6.Notice(`Nova: ${randomPhrase}.`, 0);
      const initialNoticeText = `Nova: ${randomPhrase}.`;
      const noticeEl = this.thinkingNotice.noticeEl;
      if (noticeEl) {
        noticeEl.textContent = initialNoticeText;
      }
      this.startNoticeDotsAnimation(randomPhrase);
    } catch (error) {
      console.warn("Failed to create thinking notice:", error);
    }
  }
  /**
   * Start streaming at a specific position with hybrid approach
   * For selection replacement: startPos and endPos define the range to replace
   * For cursor insertion: startPos is the cursor position, endPos should be null
   */
  startStreaming(editor, startPos, endPos, options = {}) {
    this.originalPosition = { from: startPos, to: endPos };
    if (endPos) {
      editor.replaceRange("", startPos, endPos);
      this.currentStreamingEndPos = startPos;
    } else {
      this.currentStreamingEndPos = startPos;
    }
    this.streamingStartPos = null;
    const updateStream = (newText, isComplete) => {
      this.updateStreamingText(editor, newText, isComplete, options);
    };
    const stopStream = () => {
      this.stopAnimation();
      this.cleanup();
    };
    return { updateStream, stopStream };
  }
  /**
   * Update streaming text with proper position tracking
   */
  updateStreamingText(editor, newText, isComplete, options) {
    try {
      if (this.currentStreamingEndPos) {
        if (this.thinkingNotice) {
          this.stopDotsAnimation();
        }
        if (!this.streamingStartPos) {
          this.streamingStartPos = { ...this.currentStreamingEndPos };
        }
        const lines = newText.split("\n");
        const newEndPos = {
          line: this.streamingStartPos.line + lines.length - 1,
          ch: lines.length > 1 ? lines[lines.length - 1].length : this.streamingStartPos.ch + newText.length
        };
        editor.replaceRange(newText, this.streamingStartPos, this.currentStreamingEndPos);
        this.currentStreamingEndPos = newEndPos;
        if (options.onChunk) {
          options.onChunk(newText, isComplete);
        }
      }
      if (isComplete) {
        editor.setCursor(this.currentStreamingEndPos);
        this.cleanup();
        if (options.onComplete) {
          options.onComplete();
        }
      }
    } catch (error) {
      console.warn("Error updating streaming text:", error);
      this.cleanup();
      if (options.onError) {
        options.onError(error instanceof Error ? error : new Error(String(error)));
      }
    }
  }
  /**
   * Animate dots in notice text
   */
  startNoticeDotsAnimation(basePhrase) {
    let dotCount = 1;
    this.dotsAnimationInterval = setInterval(() => {
      try {
        if (!this.thinkingNotice) return;
        dotCount++;
        if (dotCount > 5) {
          dotCount = 1;
        }
        const dots = ".".repeat(dotCount);
        const noticeText = `Nova: ${basePhrase}${dots}`;
        const noticeEl = this.thinkingNotice.noticeEl;
        if (noticeEl) {
          noticeEl.textContent = noticeText;
        }
      } catch (error) {
        console.warn("Error in notice dots animation:", error);
        this.stopDotsAnimation();
      }
    }, 400);
  }
  /**
   * Stop the dots animation and dismiss notice
   */
  stopDotsAnimation() {
    if (this.dotsAnimationInterval) {
      clearInterval(this.dotsAnimationInterval);
      this.dotsAnimationInterval = null;
    }
    if (this.thinkingNotice) {
      this.thinkingNotice.hide();
      this.thinkingNotice = null;
    }
  }
  /**
   * Stop all animations and clean up
   */
  stopAnimation() {
    this.stopDotsAnimation();
  }
  /**
   * Clean up all internal state
   */
  cleanup() {
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Get the original position before streaming started
   */
  getOriginalPosition() {
    return this.originalPosition;
  }
  /**
   * Check if currently streaming
   */
  isStreaming() {
    return this.currentStreamingEndPos !== null;
  }
};
// Comprehensive thinking phrases for all action types
_StreamingManager.THINKING_PHRASES = {
  "improve": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "longer": [
    "expanding...",
    "developing...",
    "elaborating...",
    "building...",
    "enriching...",
    "deepening...",
    "growing...",
    "extending...",
    "amplifying...",
    "unfolding..."
  ],
  "shorter": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ],
  "tone": [
    "adjusting tone...",
    "reshaping...",
    "reframing...",
    "adapting...",
    "transforming...",
    "modulating...",
    "recasting...",
    "shifting...",
    "reforming...",
    "reimagining..."
  ],
  "custom": [
    "working on it...",
    "considering...",
    "thinking...",
    "processing...",
    "analyzing...",
    "contemplating...",
    "understanding...",
    "interpreting...",
    "exploring...",
    "evaluating..."
  ],
  "chat": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "add": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "edit": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "rewrite": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "grammar": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "delete": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ]
};
var StreamingManager = _StreamingManager;

// src/ui/selection-context-menu.ts
var import_obsidian10 = require("obsidian");

// src/core/commands/selection-edit-command.ts
var import_obsidian7 = require("obsidian");
var SelectionEditCommand = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Execute a selection-based edit action
   */
  async execute(action, editor, selectedText, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const loadingNotice = new import_obsidian7.Notice("Nova is processing your request...", 0);
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      const response = await this.plugin.aiProviderManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt
      );
      loadingNotice.hide();
      const transformedText = this.cleanAIResponse(response);
      return {
        success: true,
        transformedText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit command error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Execute a selection-based edit action with streaming
   */
  async executeStreaming(action, editor, selectedText, onChunk, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      await new Promise((resolve) => setTimeout(resolve, 1e3));
      let fullResponse = "";
      const stream = this.plugin.aiProviderManager.generateTextStream(prompt2.userPrompt, {
        systemPrompt: prompt2.systemPrompt
      });
      for await (const chunk of stream) {
        if (chunk.error) {
          throw new Error(chunk.error);
        }
        fullResponse += chunk.content;
        if (fullResponse.trim().length > 0 || chunk.done) {
          const cleanedChunk = this.cleanAIResponse(fullResponse);
          onChunk(cleanedChunk, chunk.done);
        }
        if (chunk.done) {
          break;
        }
        await new Promise((resolve) => setTimeout(resolve, 50));
      }
      const finalText = this.cleanAIResponse(fullResponse);
      if (!finalText.trim()) {
        return {
          success: false,
          error: "AI provider returned empty response",
          originalRange: selectionRange
        };
      }
      return {
        success: true,
        transformedText: finalText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit streaming error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Build prompt for the AI based on the action type
   */
  buildPrompt(action, selectedText, customInstruction) {
    const baseSystemPrompt = `You are Nova, an AI writing assistant. Your task is to transform the provided text according to the user's request. 

CRITICAL RULES:
- Provide ONLY the transformed text, no explanations or meta-commentary
- Maintain the original meaning unless specifically asked to change it
- Preserve the original format (markdown, structure, etc.) unless instructed otherwise
- Do not add introductory phrases like "Here's the improved text:" or similar
- Return only the content that should replace the selected text`;
    let specificPrompt = "";
    let userPrompt = "";
    switch (action) {
      case "improve":
        specificPrompt = `
TASK: Improve the writing quality
- Make the text clearer and more concise
- Improve flow and readability
- Fix any awkward phrasing
- Preserve the original tone and meaning`;
        userPrompt = `Improve this text:

${selectedText}`;
        break;
      case "longer":
        specificPrompt = `
TASK: Expand the text with more detail
- Add relevant examples, context, or explanations
- Maintain the original style and voice
- Expand ideas without changing the core message
- Make it more comprehensive and detailed`;
        userPrompt = `Make this text longer and more detailed:

${selectedText}`;
        break;
      case "shorter":
        specificPrompt = `
TASK: Condense the text to essential points
- Remove redundancy and unnecessary words
- Keep all key information and meaning
- Make it more concise and direct
- Preserve the original tone`;
        userPrompt = `Make this text shorter and more concise:

${selectedText}`;
        break;
      case "tone":
        const toneMap = {
          "formal": "professional and structured, suitable for business or academic contexts",
          "casual": "relaxed and conversational, suitable for informal communication",
          "academic": "scholarly and precise, using technical vocabulary where appropriate",
          "friendly": "warm and approachable, building connection with the reader"
        };
        const toneDescription = toneMap[customInstruction || "formal"] || toneMap.formal;
        specificPrompt = `
TASK: Change the tone to be ${toneDescription}
- Adjust language and vocabulary to match the requested tone
- Keep the same content and meaning
- Maintain appropriate formality level for the chosen tone`;
        userPrompt = `Rewrite this text in a ${customInstruction || "formal"} tone:

${selectedText}`;
        break;
      case "custom":
        specificPrompt = `
TASK: Apply custom transformation
- Follow the user's specific instruction exactly
- Maintain content integrity unless asked to change it
- Apply the requested changes precisely`;
        userPrompt = `Apply this instruction to the text: "${customInstruction}"

Text to transform:

${selectedText}`;
        break;
      default:
        specificPrompt = `
TASK: General text improvement
- Enhance clarity and readability
- Preserve original meaning and tone`;
        userPrompt = `Improve this text:

${selectedText}`;
    }
    return {
      systemPrompt: baseSystemPrompt + "\n" + specificPrompt,
      userPrompt
    };
  }
  /**
   * Clean AI response to extract only the transformed text
   */
  cleanAIResponse(response) {
    let cleaned = response.trim();
    const introPatterns = [
      /^Here's the improved text:?\s*/i,
      /^Here's the rewritten text:?\s*/i,
      /^Here's the transformed text:?\s*/i,
      /^Improved version:?\s*/i,
      /^Rewritten:?\s*/i,
      /^Result:?\s*/i,
      /^Output:?\s*/i
    ];
    for (const pattern of introPatterns) {
      cleaned = cleaned.replace(pattern, "");
    }
    cleaned = cleaned.split(/\n\s*---+\s*/).shift() || cleaned;
    cleaned = cleaned.split(/\n\s*\*\*?Explanation\*?\*?:/i).shift() || cleaned;
    return cleaned.trim();
  }
};

// src/ui/tone-selection-modal.ts
var import_obsidian8 = require("obsidian");
var TONE_OPTIONS = [
  {
    id: "formal",
    label: "Formal",
    description: "Professional, structured language suitable for business or academic contexts"
  },
  {
    id: "casual",
    label: "Casual",
    description: "Relaxed, conversational tone for informal communication"
  },
  {
    id: "academic",
    label: "Academic",
    description: "Scholarly, precise language with technical vocabulary"
  },
  {
    id: "friendly",
    label: "Friendly",
    description: "Warm, approachable tone that builds connection"
  }
];
var ToneSelectionModal = class extends import_obsidian8.FuzzySuggestModal {
  constructor(app, onSelect, onCancel) {
    super(app);
    this.onSelect = onSelect;
    this.onCancel = onCancel;
    this.setPlaceholder("Choose a writing tone...");
    this.setInstructions([
      { command: "\u2191\u2193", purpose: "to navigate" },
      { command: "\u21B5", purpose: "to apply tone" },
      { command: "esc", purpose: "to cancel" }
    ]);
  }
  getItems() {
    return TONE_OPTIONS;
  }
  getItemText(tone) {
    return `${tone.label} - ${tone.description}`;
  }
  onChooseItem(tone, evt) {
    this.onSelect(tone.id);
  }
  onClose() {
    const { contentEl } = this;
    if (contentEl.parentElement) {
      this.onCancel();
    }
  }
};

// src/ui/custom-instruction-modal.ts
var import_obsidian9 = require("obsidian");
var CustomInstructionModal = class extends import_obsidian9.Modal {
  constructor(app, onSubmit, onCancel) {
    super(app);
    this.instruction = "";
    this.onSubmit = onSubmit;
    this.onCancel = onCancel;
  }
  onOpen() {
    var _a;
    const { contentEl } = this;
    contentEl.empty();
    this.modalEl.addClass("nova-custom-instruction-modal");
    contentEl.createEl("h2", { text: "Tell Nova" });
    new import_obsidian9.Setting(contentEl).setName("Instruction").setDesc("Describe how you want Nova to transform your selected text");
    const textAreaSetting = new import_obsidian9.Setting(contentEl).addTextArea((text) => {
      text.setPlaceholder('e.g., "make this more persuasive", "add statistics", "write in bullet points"').setValue(this.instruction).onChange((value) => {
        this.instruction = value;
      });
      text.inputEl.rows = 4;
      text.inputEl.style.width = "100%";
      text.inputEl.style.minHeight = "100px";
      setTimeout(() => text.inputEl.focus(), 50);
      text.inputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && (e.ctrlKey || e.metaKey)) {
          e.preventDefault();
          this.submit();
        }
      });
      return text;
    });
    textAreaSetting.settingEl.style.border = "none";
    (_a = textAreaSetting.settingEl.querySelector(".setting-item-info")) == null ? void 0 : _a.remove();
    const control = textAreaSetting.settingEl.querySelector(".setting-item-control");
    if (control instanceof HTMLElement) {
      control.style.width = "100%";
    }
    new import_obsidian9.Setting(contentEl).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
      this.onCancel();
    })).addButton((btn) => btn.setButtonText("Transform Text").setCta().onClick(() => this.submit()));
  }
  submit() {
    if (this.instruction.trim()) {
      this.close();
      this.onSubmit(this.instruction.trim());
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/ui/selection-context-menu.ts
var SELECTION_ACTIONS = [
  {
    id: "improve",
    label: "Improve Writing",
    icon: "sparkles",
    description: "Make text clearer, more concise, better flow"
  },
  {
    id: "longer",
    label: "Make Longer",
    icon: "plus-circle",
    description: "Expand ideas with more detail and examples"
  },
  {
    id: "shorter",
    label: "Make Shorter",
    icon: "minus-circle",
    description: "Condense to essential points"
  },
  {
    id: "tone",
    label: "Change Tone",
    icon: "palette",
    description: "Adjust writing style and tone"
  },
  {
    id: "custom",
    label: "Tell Nova...",
    icon: "message-circle",
    description: "Custom instruction for transformation"
  }
];
var _SelectionContextMenu = class _SelectionContextMenu {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    /**
     * Update text with streaming effect
     */
    this.currentStreamingEndPos = null;
    this.streamingTextContainer = null;
    this.streamingStartPos = null;
    this.animatedSelection = null;
    this.dotsAnimationInterval = null;
    this.thinkingNotice = null;
    this.originalSelectionRange = null;
    this.selectionEditCommand = new SelectionEditCommand(plugin);
  }
  /**
   * Register the context menu with Obsidian's editor
   */
  register() {
    this.plugin.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor) => {
        this.addNovaSubmenu(menu, editor);
      })
    );
  }
  /**
   * Add Nova submenu to the context menu if text is selected
   */
  addNovaSubmenu(menu, editor) {
    const selectedText = editor.getSelection();
    if (!selectedText || selectedText.trim().length === 0) {
      return;
    }
    menu.addSeparator();
    SELECTION_ACTIONS.forEach((action) => {
      menu.addItem((item) => {
        item.setTitle(`Nova: ${action.label}`).setIcon(action.icon || "edit").onClick(() => {
          this.handleSelectionAction(action.id, editor, selectedText);
        });
      });
    });
  }
  /**
   * Handle selection action when menu item is clicked
   */
  async handleSelectionAction(actionId, editor, selectedText, customInstruction) {
    try {
      if (actionId === "tone" && !customInstruction) {
        this.showToneSelectionModal(editor, selectedText);
        return;
      }
      if (actionId === "custom" && !customInstruction) {
        this.showCustomInstructionModal(editor, selectedText);
        return;
      }
      await this.executeSelectionEdit(actionId, editor, selectedText, customInstruction);
    } catch (error) {
      console.error("Error executing Nova selection action:", error);
      new import_obsidian10.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show tone selection modal
   */
  showToneSelectionModal(editor, selectedText) {
    const modal = new ToneSelectionModal(
      this.app,
      async (selectedTone) => {
        await this.executeSelectionEdit("tone", editor, selectedText, selectedTone);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Show custom instruction modal
   */
  showCustomInstructionModal(editor, selectedText) {
    const modal = new CustomInstructionModal(
      this.app,
      async (instruction) => {
        await this.executeSelectionEdit("custom", editor, selectedText, instruction);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Execute the selection edit command with streaming
   */
  async executeSelectionEdit(actionId, editor, selectedText, customInstruction) {
    this.startSelectionAnimation(editor);
    const originalRange = {
      from: editor.getCursor("from"),
      to: editor.getCursor("to")
    };
    try {
      await this.showThinkingAnimation(editor, originalRange.from, originalRange.to, actionId);
      const result = await this.selectionEditCommand.executeStreaming(
        actionId,
        editor,
        selectedText,
        (chunk, isComplete) => {
          this.updateStreamingText(editor, chunk, originalRange.from, isComplete);
        },
        customInstruction
      );
      if (result.success) {
        const actionName = this.getActionDisplayName(actionId);
        new import_obsidian10.Notice(`Nova: Text ${actionName} successfully`, 2e3);
        this.addSuccessChatMessage(actionId, selectedText, customInstruction);
      } else {
        new import_obsidian10.Notice(`Nova: ${result.error || "Failed to process text"}`, 3e3);
        this.addFailureChatMessage(actionId, result.error || "Failed to process text");
        this.restoreOriginalText(editor);
      }
    } catch (error) {
      console.error("Error in streaming selection edit:", error);
      new import_obsidian10.Notice("Failed to execute Nova action. Please try again.", 3e3);
      this.restoreOriginalText(editor);
    } finally {
      this.stopSelectionAnimation();
      this.stopDotsAnimation();
    }
  }
  updateStreamingText(editor, newText, startPos, isComplete) {
    try {
      if (this.currentStreamingEndPos) {
        if (this.thinkingNotice) {
          this.stopDotsAnimation();
        }
        if (!this.streamingStartPos) {
          this.streamingStartPos = { ...this.currentStreamingEndPos };
        }
        if (newText.trim().length > 0) {
          const lines = newText.split("\n");
          const newEndPos = {
            line: this.streamingStartPos.line + lines.length - 1,
            ch: lines.length > 1 ? lines[lines.length - 1].length : this.streamingStartPos.ch + newText.length
          };
          editor.replaceRange(newText, this.streamingStartPos, this.currentStreamingEndPos);
          this.currentStreamingEndPos = newEndPos;
        }
      }
      if (isComplete) {
        if (this.currentStreamingEndPos) {
          editor.setCursor(this.currentStreamingEndPos);
        }
        this.currentStreamingEndPos = null;
        this.streamingStartPos = null;
        this.originalSelectionRange = null;
      }
    } catch (error) {
      console.warn("Error updating streaming text:", error);
      if (this.originalSelectionRange && this.originalSelectionRange.text) {
        try {
          const restorePos = this.streamingStartPos || this.currentStreamingEndPos;
          if (restorePos) {
            editor.replaceRange(this.originalSelectionRange.text, restorePos, this.currentStreamingEndPos || restorePos);
            const lines = this.originalSelectionRange.text.split("\n");
            const endPos = {
              line: restorePos.line + lines.length - 1,
              ch: lines.length > 1 ? lines[lines.length - 1].length : restorePos.ch + this.originalSelectionRange.text.length
            };
            editor.setCursor(endPos);
          }
        } catch (restoreError) {
          console.warn("Could not restore original text:", restoreError);
        }
      }
      this.currentStreamingEndPos = null;
      this.streamingStartPos = null;
      this.originalSelectionRange = null;
    }
  }
  /**
   * Restore original text if streaming fails completely
   */
  restoreOriginalText(editor) {
    if (this.originalSelectionRange && this.originalSelectionRange.text) {
      try {
        const restorePos = this.streamingStartPos || this.currentStreamingEndPos || this.originalSelectionRange.from;
        if (restorePos) {
          const currentEndPos = this.currentStreamingEndPos || restorePos;
          editor.replaceRange(this.originalSelectionRange.text, restorePos, currentEndPos);
          const lines = this.originalSelectionRange.text.split("\n");
          const endPos = {
            line: restorePos.line + lines.length - 1,
            ch: lines.length > 1 ? lines[lines.length - 1].length : restorePos.ch + this.originalSelectionRange.text.length
          };
          editor.setCursor(endPos);
        }
      } catch (restoreError) {
        console.warn("Could not restore original text after failure:", restoreError);
      }
    }
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalSelectionRange = null;
  }
  /**
   * Start pulsing animation on selected text
   */
  startSelectionAnimation(editor) {
    var _a;
    try {
      const editorContainer = ((_a = editor.cm) == null ? void 0 : _a.dom) || document.querySelector(".cm-editor");
      if (editorContainer) {
        editorContainer.classList.add("nova-selection-processing");
      }
      const selection = editor.getSelection();
      if (selection) {
        this.animatedSelection = {
          from: editor.getCursor("from"),
          to: editor.getCursor("to")
        };
      }
    } catch (error) {
      console.warn("Failed to start selection animation:", error);
    }
  }
  /**
   * Stop pulsing animation
   */
  stopSelectionAnimation() {
    try {
      const editorElements = document.querySelectorAll(".CodeMirror, .cm-editor");
      editorElements.forEach((el) => {
        el.classList.remove("nova-selection-processing");
      });
      this.animatedSelection = null;
    } catch (error) {
      console.warn("Failed to stop selection animation:", error);
    }
  }
  /**
   * Show Nova thinking animation with notice + document placeholder
   */
  async showThinkingAnimation(editor, startPos, endPos, actionId) {
    try {
      const phrases = _SelectionContextMenu.THINKING_PHRASES[actionId] || _SelectionContextMenu.THINKING_PHRASES["custom"];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      this.showThinkingNotice(randomPhrase);
      const originalText = editor.getRange(startPos, endPos);
      editor.replaceRange("", startPos, endPos);
      this.currentStreamingEndPos = startPos;
      this.originalSelectionRange = {
        from: startPos,
        to: endPos,
        text: originalText
        // Store original text for restoration
      };
    } catch (error) {
      console.warn("Failed to show thinking animation:", error);
    }
  }
  /**
   * Show thinking notice with animated dots
   */
  showThinkingNotice(basePhrase) {
    try {
      this.thinkingNotice = new import_obsidian10.Notice(`Nova: ${basePhrase}.`, 0);
      const initialNoticeText = `Nova: ${basePhrase}.`;
      const noticeEl = this.thinkingNotice.noticeEl;
      if (noticeEl) {
        noticeEl.textContent = initialNoticeText;
      }
      this.startNoticeDotsAnimation(basePhrase);
    } catch (error) {
      console.warn("Failed to create thinking notice:", error);
    }
  }
  /**
   * Animate dots in notice text
   */
  startNoticeDotsAnimation(basePhrase) {
    let dotCount = 1;
    this.dotsAnimationInterval = setInterval(() => {
      try {
        if (!this.thinkingNotice) return;
        dotCount++;
        if (dotCount > 5) {
          dotCount = 1;
        }
        const dots = ".".repeat(dotCount);
        const noticeText = `Nova: ${basePhrase}${dots}`;
        const noticeEl = this.thinkingNotice.noticeEl;
        if (noticeEl) {
          noticeEl.textContent = noticeText;
        }
      } catch (error) {
        console.warn("Error in notice dots animation:", error);
        this.stopDotsAnimation();
      }
    }, 400);
  }
  /**
   * Stop the dots animation and dismiss notice
   */
  stopDotsAnimation() {
    if (this.dotsAnimationInterval) {
      clearInterval(this.dotsAnimationInterval);
      this.dotsAnimationInterval = null;
    }
    if (this.thinkingNotice) {
      this.thinkingNotice.hide();
      this.thinkingNotice = null;
    }
  }
  /**
   * Get display name for action
   */
  getActionDisplayName(actionId) {
    switch (actionId) {
      case "improve":
        return "improved";
      case "longer":
        return "expanded";
      case "shorter":
        return "condensed";
      case "tone":
        return "tone adjusted";
      case "custom":
        return "transformed";
      default:
        return "processed";
    }
  }
  /**
   * Add success message to chat using unified system
   */
  addSuccessChatMessage(actionId, originalText, customInstruction) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView == null ? void 0 : sidebarView.chatRenderer) {
          const actionDescription = this.getActionDescription(actionId, customInstruction);
          const truncatedText = originalText.length > 50 ? originalText.substring(0, 50) + "..." : originalText;
          const message = `\u2713 ${actionDescription} text: "${truncatedText}"`;
          sidebarView.chatRenderer.addSuccessMessage(message, true);
        }
      }
    } catch (error) {
      console.warn("Failed to add success chat message:", error);
    }
  }
  /**
   * Add failure message to chat using unified system
   */
  addFailureChatMessage(actionId, errorMessage) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView == null ? void 0 : sidebarView.chatRenderer) {
          const actionName = this.getActionDisplayName(actionId);
          const message = `\u2717 Failed to ${actionName.replace("ed", "")} text: ${errorMessage}`;
          sidebarView.chatRenderer.addErrorMessage(message, true);
        }
      }
    } catch (error) {
      console.warn("Failed to add error chat message:", error);
    }
  }
  /**
   * Get detailed action description for chat
   */
  getActionDescription(actionId, customInstruction) {
    switch (actionId) {
      case "improve":
        return "Improved";
      case "longer":
        return "Expanded";
      case "shorter":
        return "Condensed";
      case "tone":
        return `Changed tone to ${customInstruction || "formal"}`;
      case "custom":
        return `Applied "${customInstruction}"`;
      default:
        return "Processed";
    }
  }
};
// Dynamic thinking phrases for each action type
_SelectionContextMenu.THINKING_PHRASES = {
  "improve": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "longer": [
    "expanding...",
    "developing...",
    "elaborating...",
    "building...",
    "enriching...",
    "deepening...",
    "growing...",
    "extending...",
    "amplifying...",
    "unfolding..."
  ],
  "shorter": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ],
  "tone": [
    "adjusting tone...",
    "reshaping...",
    "reframing...",
    "adapting...",
    "transforming...",
    "modulating...",
    "recasting...",
    "shifting...",
    "reforming...",
    "reimagining..."
  ],
  "custom": [
    "working on it...",
    "considering...",
    "thinking...",
    "processing...",
    "analyzing...",
    "contemplating...",
    "understanding...",
    "interpreting...",
    "exploring...",
    "evaluating..."
  ]
};
var SelectionContextMenu = _SelectionContextMenu;

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var _NovaSidebarView = class _NovaSidebarView extends import_obsidian11.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.currentContext = null;
    // Command system delegation
    this._commandPickerItems = [];
    this._selectedCommandIndex = -1;
    this._isCommandMenuVisible = false;
    // Cursor position tracking - file-scoped like conversation history
    this.currentFileCursorPosition = null;
    // Performance optimization - debouncing and timing constants
    this.contextPreviewDebounceTimeout = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  // Cursor-only architecture - delegate to new components
  get textArea() {
    var _a;
    return (_a = this.inputHandler) == null ? void 0 : _a.getTextArea();
  }
  get wikilinkAutocomplete() {
    return this.inputHandler ? { destroy: () => {
    } } : null;
  }
  get autoGrowTextarea() {
    return () => {
    };
  }
  get commandPickerItems() {
    return this._commandPickerItems;
  }
  set commandPickerItems(value) {
    this._commandPickerItems = value;
  }
  get selectedCommandIndex() {
    return this._selectedCommandIndex;
  }
  set selectedCommandIndex(value) {
    this._selectedCommandIndex = value;
  }
  get isCommandMenuVisible() {
    return this._isCommandMenuVisible;
  }
  set isCommandMenuVisible(value) {
    this._isCommandMenuVisible = value;
  }
  // Context system delegation
  get contextPreview() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextPreview;
  }
  get contextIndicator() {
    var _a;
    return this._contextIndicator || ((_a = this.contextManager) == null ? void 0 : _a.contextIndicator);
  }
  set contextIndicator(value) {
    this._contextIndicator = value;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    if (import_obsidian11.Platform.isMobile) {
      container.addClass("is-mobile");
    } else {
      container.addClass("is-desktop");
    }
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian11.Platform.isDesktopApp ? "var(--size-4-6)" : "var(--size-4-5)"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			flex-direction: column;
			padding: var(--size-4-2);
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const topRowEl = headerEl.createDiv();
    topRowEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
		`;
    const titleEl = topRowEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: var(--font-ui-medium); display: flex; align-items: center; gap: var(--size-2-2); color: var(--interactive-accent);";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size); height: var(--icon-size);">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = topRowEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: var(--size-2-3);";
    const privacyIndicator = rightContainer.createSpan({ cls: "nova-privacy-indicator" });
    privacyIndicator.style.cssText = `
			display: flex;
			align-items: center;
			padding: 4px;
			color: var(--icon-color);
			font-weight: var(--font-weight-medium);
		`;
    this.updatePrivacyIndicator(privacyIndicator);
    this.privacyIndicator = privacyIndicator;
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian11.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-change", (editor) => {
        this.trackCursorPosition(editor);
      })
    );
    this.loadConversationForActiveFile();
    setTimeout(() => this.refreshProviderStatus(), 100);
  }
  /**
   * Track cursor position changes in the active editor (file-scoped)
   */
  trackCursorPosition(editor) {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile || !editor) {
      return;
    }
    if (this.currentFile && activeFile.path === this.currentFile.path) {
      const cursorPos = editor.getCursor();
      if (cursorPos) {
        this.currentFileCursorPosition = cursorPos;
      }
    }
  }
  /**
   * Restore cursor position for current file (file-scoped)
   */
  restoreCursorPosition() {
    if (this.currentFileCursorPosition) {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (editor) {
        editor.setCursor(this.currentFileCursorPosition);
      }
    }
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
      this.contextPreviewDebounceTimeout = null;
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: var(--size-4-2);
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: var(--size-2-3);
		`;
    this.chatRenderer = new ChatRenderer(this.plugin, this.chatContainer);
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements using new architecture
   */
  createInputArea() {
    this.inputContainer.empty();
    this.contextManager = new ContextManager(this.plugin, this.app, this.inputContainer);
    this.streamingManager = new StreamingManager();
    this.selectionContextMenu = new SelectionContextMenu(this.app, this.plugin);
    this.inputHandler = new InputHandler(this.plugin, this.inputContainer, this.contextManager);
    this.inputHandler.setSidebarView(this);
    this.contextManager.setSidebarView(this);
    this.inputHandler.createInputInterface(this.chatContainer);
    this.commandSystem = new CommandSystem(this.plugin, this.inputContainer, this.inputHandler.getTextArea());
    this.inputHandler.setCommandSystem(this.commandSystem);
    this.inputHandler.setOnSendMessage((message) => {
      this.handleSend(message);
    });
    this.contextManager.createContextIndicator();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-text-size);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  // REPLACE with simple delegation to ChatRenderer:
  addSuccessMessage(content) {
    this.chatRenderer.addSuccessMessage(content, true);
  }
  addErrorMessage(content) {
    this.chatRenderer.addErrorMessage(content, true);
  }
  addWelcomeMessage(message) {
    this.chatRenderer.addWelcomeMessage(message);
  }
  addSuccessIndicator(action) {
    const messages = {
      "add": "\u2713 Content added",
      "edit": "\u2713 Content edited",
      "delete": "\u2713 Content deleted",
      "grammar": "\u2713 Grammar fixed",
      "rewrite": "\u2713 Content rewritten"
    };
    const message = messages[action] || "\u2713 Command completed";
    this.addSuccessMessage(message);
  }
  addErrorIndicator(action, error) {
    const messages = {
      "add": "\u274C Failed to add content",
      "edit": "\u274C Failed to edit content",
      "delete": "\u274C Failed to delete content",
      "grammar": "\u274C Failed to fix grammar",
      "rewrite": "\u274C Failed to rewrite content",
      "execute": "\u274C Command execution error"
    };
    let message = messages[action] || "\u274C Command failed";
    if (error) {
      message += `: ${error}`;
    }
    this.addErrorMessage(message);
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addErrorMessage("Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025.");
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addSuccessMessage(`\u2713 Switched to ${this.getProviderWithModelDisplayName(providerId)}`);
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.inputHandler.getTextArea().setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addSuccessMessage(`\u2713 Loaded template: ${customCommand.name}`);
        return true;
      }
    }
    this.addErrorMessage(`\u274C Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`);
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker nova-panel-base" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.inputHandler.getTextArea().getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("commands")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item nova-panel-item" });
      const triggerEl = item.createSpan({ cls: "nova-command-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      const nameEl = item.createSpan({ cls: "nova-command-name nova-panel-text" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1;";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.removeClass("selected");
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].addClass("selected");
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    var _a;
    const commands = [];
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
    const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
    if (selectedText && selectedText.trim().length > 0) {
      SELECTION_ACTIONS.forEach((action) => {
        commands.push({
          trigger: action.id,
          name: `Nova: ${action.label}`,
          description: action.description
        });
      });
      commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Provider Commands" });
    }
    commands.push(
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" }
    );
    if (import_obsidian11.Platform.isDesktopApp) {
      commands.push({ trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" });
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      if (customCommands.length > 0) {
        commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Custom Commands" });
        customCommands.forEach((cmd) => {
          commands.push({
            trigger: cmd.trigger,
            name: cmd.name,
            ...cmd.description && { description: cmd.description }
          });
        });
      }
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu nova-panel-base" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addErrorMessage("Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025.");
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header nova-panel-header" });
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      if (command.trigger === "---") {
        const separator = this.commandMenu.createDiv({ cls: "nova-command-menu-separator" });
        separator.style.cssText = `
					padding: 8px 16px 4px 16px;
					font-size: 0.75em;
					color: var(--text-muted);
					font-weight: 600;
					text-transform: uppercase;
					letter-spacing: 0.5px;
					border-top: 1px solid var(--background-modifier-border);
					margin-top: 4px;
					cursor: default;
				`;
        separator.textContent = command.description || "";
        return;
      }
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item nova-panel-item-vertical" });
      const nameEl = item.createDiv({ cls: "nova-command-menu-name nova-panel-text" });
      nameEl.textContent = command.name;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.opacity = "0.8";
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  async executeCommandFromMenu(trigger) {
    var _a;
    this.hideCommandMenu();
    const selectionAction = SELECTION_ACTIONS.find((action) => action.id === trigger);
    if (selectionAction) {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
      const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
      if ((activeView == null ? void 0 : activeView.editor) && selectedText && selectedText.trim().length > 0) {
        await this.selectionContextMenu.handleSelectionAction(trigger, activeView.editor, selectedText);
      } else {
        new import_obsidian11.Notice("No text selected. Please select text to use Nova editing commands.", 3e3);
      }
      return;
    }
    if (trigger === "---") {
      return;
    }
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  /**
   * Debounced version of updateLiveContextPreview for performance
   */
  debouncedUpdateContextPreview() {
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
    }
    this.contextPreviewDebounceTimeout = setTimeout(() => {
      this.updateLiveContextPreview();
      this.contextPreviewDebounceTimeout = null;
    }, _NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS);
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.inputHandler.getTextArea().getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian11.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian11.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian11.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext || !this.currentContext.persistentDocs) {
      this.contextIndicator.style.display = "none";
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (!allDocs || allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    if (this.inputHandler) {
      this.inputHandler.updateContextState(true);
    }
    const isMobile = import_obsidian11.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: flex;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			height: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.filter((doc) => {
      var _a;
      return (_a = doc == null ? void 0 : doc.file) == null ? void 0 : _a.basename;
    }).map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px; min-width: 0;";
    const filenamePartEl = summaryTextEl.createSpan();
    filenamePartEl.style.cssText = "display: flex; align-items: center; gap: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; min-width: 0; flex: 1;";
    const iconSpan = filenamePartEl.createSpan();
    iconSpan.innerHTML = this.createInlineIcon("book-open");
    iconSpan.style.cssText = "flex-shrink: 0; display: flex; align-items: center;";
    const textSpan = filenamePartEl.createSpan();
    textSpan.textContent = `${docNames.join(", ")}${moreCount}`;
    textSpan.style.cssText = "overflow: hidden; text-overflow: ellipsis; min-width: 0;";
    const tokenPartEl = summaryTextEl.createSpan();
    tokenPartEl.style.cssText = "white-space: nowrap; flex-shrink: 0; margin-left: 8px;";
    if (isMobile) {
      tokenPartEl.textContent = `(${tokenPercent}%)`;
    } else {
      tokenPartEl.textContent = `(${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian11.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("trash-2").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.filter((doc) => {
      var _a;
      return (_a = doc == null ? void 0 : doc.file) == null ? void 0 : _a.basename;
    }).forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em; flex-shrink: 0;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
				flex: 1;
				min-width: 0;
				margin-right: 8px;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
				flex-shrink: 0;
				margin-right: 8px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.textContent = "\xD7";
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 4px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: normal;
				line-height: 1;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      try {
        const persistentDocs = this.multiDocHandler.getPersistentContext(this.currentFile.path) || [];
        if (persistentDocs.length > 0) {
          this.currentContext = {
            persistentDocs,
            contextString: "",
            // Not needed for UI
            tokenCount: 0,
            // Not needed for UI refresh
            isNearLimit: false
          };
        } else {
          this.currentContext = null;
        }
        this.updateContextIndicator();
      } catch (error) {
        this.currentContext = null;
        this.updateContextIndicator();
      }
    } else {
      this.currentContext = null;
      this.updateContextIndicator();
    }
  }
  async handleSend(message) {
    var _a, _b, _c, _d, _e, _f;
    const messageText = message || this.inputHandler.getValue().trim();
    if (!messageText) return;
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (!currentProviderType) {
      this.addErrorMessage(this.createIconMessage("alert-circle", "Nova is disabled or no AI provider is available. Please configure an AI provider in settings."));
      return;
    }
    if (messageText.startsWith(":")) {
      const commandResult = await this.handleColonCommand(messageText);
      if (commandResult) {
        this.inputHandler.setValue("");
        return;
      }
    }
    let processedMessage = messageText;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (messageText.includes("[[")) {
          this.addErrorMessage("Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025.");
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(messageText, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_b = (_a = this.currentContext) == null ? void 0 : _a.persistentDocs) == null ? void 0 : _b.length) || 0;
        const currentPersistentCount = ((_c = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _c.length) || 0;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0 && (multiDocContext == null ? void 0 : multiDocContext.persistentDocs) && multiDocContext.persistentDocs.length > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.filter((doc) => {
              var _a2;
              return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
            }).map((doc) => doc.file.basename).join(", ");
            if (docNames) {
              this.addSuccessMessage(this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
            }
          }
          this.inputHandler.setValue("");
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (((_d = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _d.length) > 0) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.filter((doc) => {
            var _a2;
            return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
          }).map((doc) => doc.file.basename).join(", ");
          if (docNames && allDocs.length > 0) {
            const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
            const currentFile = ((_e = this.currentFile) == null ? void 0 : _e.basename) || "current file";
            this.addSuccessMessage(`\u2713 Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`);
          }
        }
        if (multiDocContext == null ? void 0 : multiDocContext.isNearLimit) {
          new import_obsidian11.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _NovaSidebarView.NOTICE_DURATION_MS);
        }
      }
    }
    this.inputHandler.setValue("");
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(true);
    try {
      console.log("\u{1F680} CHAT INPUT HANDLING:", { messageText });
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        console.log("\u{1F4BE} About to persist user message:", { file: activeFile.path, messageText });
        await this.plugin.conversationManager.addUserMessage(activeFile, messageText, null);
        console.log("\u{1F4FA} About to display user message in UI");
        this.addMessage("user", messageText);
      }
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
      const selectedText = (_f = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _f.getSelection();
      const hasSelection = !!(selectedText && selectedText.trim().length > 0);
      const intent = await this.plugin.aiIntentClassifier.classifyIntent(processedMessage, hasSelection);
      let contextualCommand;
      if (intent === "METADATA" || intent === "CONTENT") {
        contextualCommand = this.plugin.commandParser.parseCommand(processedMessage);
      }
      const initialPhrase = this.getContextualThinkingPhrase(contextualCommand, processedMessage);
      const loadingTextEl = loadingEl.createSpan({ text: initialPhrase });
      loadingTextEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      this.startThinkingPhraseRotation(loadingTextEl, contextualCommand, processedMessage);
      let response = null;
      if (intent === "METADATA" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else if (intent === "CONTENT" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedSystemPrompt = (prompt2.systemPrompt || "") + `

MULTI-DOCUMENT CONTEXT INSTRUCTIONS:
- You have access to multiple documents as REFERENCE CONTEXT ONLY
- These documents are for your understanding and background knowledge
- DO NOT echo, quote, or output content from these context documents unless specifically requested
- When responding, focus on the user's request, not the content of context documents
- Context documents are read-only; you can only edit the current working document
- If the user asks about context documents, you may reference and discuss their content`;
          const enhancedUserPrompt = `REFERENCE CONTEXT (for your understanding only):
${multiDocContext.contextString}

---

USER REQUEST: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(enhancedSystemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      const loadingTextSpan = loadingEl.querySelector("span");
      if (loadingTextSpan) {
        this.stopThinkingPhraseRotation(loadingTextSpan);
      }
      loadingEl.remove();
      const filteredResponse = response ? this.filterThinkingContent(response) : response;
      if (activeFile && filteredResponse) {
        await this.plugin.documentEngine.addAssistantMessage(filteredResponse);
      }
      if (filteredResponse) {
        if (filteredResponse.includes("x-circle") || filteredResponse.includes("Error executing command") || filteredResponse.includes("Failed to") || filteredResponse.includes("No markdown file is open") || filteredResponse.includes("Unable to access") || filteredResponse.includes("Unable to set")) {
          this.addErrorMessage(filteredResponse);
        } else {
          this.addMessage("assistant", filteredResponse);
        }
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) {
        const loadingTextSpan = loadingEl.querySelector("span");
        if (loadingTextSpan) {
          this.stopThinkingPhraseRotation(loadingTextSpan);
        }
        loadingEl.remove();
      }
      const errorMessage = error.message;
      let displayMessage;
      if (errorMessage.includes("Google API error")) {
        displayMessage = errorMessage;
      } else if (errorMessage.includes("OpenAI API error")) {
        displayMessage = errorMessage;
      } else if (errorMessage.includes("API key")) {
        displayMessage = `${errorMessage}. Please check your settings.`;
      } else if (errorMessage.includes("Failed to fetch") || errorMessage.includes("NetworkError")) {
        displayMessage = "Network error. Please check your internet connection and try again.";
      } else {
        displayMessage = `Sorry, I encountered an error: ${errorMessage}`;
      }
      this.addErrorMessage(displayMessage);
    } finally {
      const sendButton2 = this.inputHandler.sendButton;
      if (sendButton2) sendButton2.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: false });
        await new Promise((resolve) => setTimeout(resolve, 50));
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      const currentPos = this.plugin.documentEngine.getCursorPosition();
      if (currentPos) {
        this.currentFileCursorPosition = currentPos;
      }
      this.restoreCursorPosition();
      let result;
      switch (command.action) {
        case "add":
          result = await this.executeAddCommandWithStreaming(command);
          break;
        case "edit":
          result = await this.executeEditCommandWithStreaming(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.executeGrammarCommandWithStreaming(command);
          break;
        case "rewrite":
          result = await this.executeRewriteCommandWithStreaming(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        this.addErrorIndicator(command.action, result.error);
        return null;
      }
    } catch (error) {
      this.addErrorIndicator("execute", error.message);
      return null;
    }
  }
  async loadConversationForActiveFile() {
    var _a, _b;
    const activeFile = this.app.workspace.getActiveFile();
    console.log("\u{1F504} FILE SWITCH EVENT:", {
      activeFile: activeFile == null ? void 0 : activeFile.path,
      currentFile: (_a = this.currentFile) == null ? void 0 : _a.path
    });
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian11.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      console.log("\u{1F5D1}\uFE0F Clearing chat - no target file");
      this.currentFile = null;
      this.chatContainer.empty();
      this.refreshContext();
      this.addWelcomeMessage("Open a document to get started.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      console.log("\u23ED\uFE0F Skipping file switch - same file or no file");
      return;
    }
    this.currentFileCursorPosition = null;
    console.log("\u{1F504} SWITCHING TO FILE:", {
      from: (_b = this.currentFile) == null ? void 0 : _b.path,
      to: targetFile.path
    });
    this.currentFile = targetFile;
    this.updateDocumentStats();
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian11.MarkdownView);
    if (activeView && activeView.editor) {
      this.trackCursorPosition(activeView.editor);
    }
    console.log("\u{1F9F9} CLEARING CHAT for file switch");
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      console.log("\u{1F4DA} LOADING CONVERSATION HISTORY via ChatRenderer");
      await this.chatRenderer.loadConversationHistory(targetFile);
      await this.showDocumentInsights(targetFile);
    } catch (error) {
      console.log("\u274C CONVERSATION LOADING ERROR:", error);
      this.addWelcomeMessage();
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
      }
    }
    new import_obsidian11.Notice("Chat cleared");
  }
  async updateDocumentStats() {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile) return;
    try {
      const content = await this.app.vault.read(activeFile);
      if (!content) return;
      const wordCount = content.split(/\s+/).filter((word) => word.length > 0).length;
      const headingCount = (content.match(/^#{1,6}\s/gm) || []).length;
      const headerEl = this.containerEl.querySelector(".nova-header");
      if (headerEl) {
        let statsEl = headerEl.querySelector(".nova-document-stats");
        if (!statsEl) {
          statsEl = headerEl.createEl("div", { cls: "nova-document-stats" });
        }
        if (statsEl && wordCount > 0) {
          statsEl.textContent = `${wordCount} words \u2022 ${headingCount} sections`;
          statsEl.style.cssText = `
						font-size: 0.75em;
						color: var(--text-muted);
						margin-top: var(--size-2-2);
					`;
        }
      }
    } catch (error) {
    }
  }
  async showDocumentInsights(file) {
    try {
      const content = await this.app.vault.read(file);
      const analysis = DocumentAnalyzer.analyzeStructure(content);
      if (analysis.emptyHeadings.length > 0 || analysis.incompleteBullets.length > 0) {
        const insights = [];
        if (analysis.emptyHeadings.length > 0) {
          insights.push(`${analysis.emptyHeadings.length} empty heading${analysis.emptyHeadings.length > 1 ? "s" : ""} to fill`);
        }
        if (analysis.incompleteBullets.length > 0) {
          insights.push(`${analysis.incompleteBullets.length} incomplete bullet${analysis.incompleteBullets.length > 1 ? "s" : ""}`);
        }
        if (insights.length > 0) {
          const bulletList = insights.map((insight) => `\u2022 ${insight}`).join("\n");
          const messageEl = this.chatContainer.createDiv({ cls: "nova-message nova-message-assistant nova-insights" });
          messageEl.style.cssText = `
						margin-bottom: var(--size-4-2);
						padding: var(--size-2-3) var(--size-4-3);
						border-radius: var(--radius-s);
						max-width: 85%;
						background: var(--background-modifier-hover);
						color: var(--text-muted);
						font-size: var(--font-text-size);
						text-align: left;
						margin-left: 0;
						margin-right: auto;
					`;
          const roleEl = messageEl.createEl("div", {
            text: "Nova",
            cls: "nova-message-role"
          });
          roleEl.style.cssText = `
						font-size: var(--font-ui-smaller);
						opacity: 0.7;
						margin-bottom: var(--size-2-1);
						font-weight: 600;
					`;
          const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
          contentEl.style.cssText = "white-space: pre-line; text-align: left;";
          contentEl.textContent = `I noticed:

${bulletList}

Let me help.`;
          setTimeout(() => {
            this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
          }, 50);
        }
      }
    } catch (error) {
    }
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  // REMOVED: Now using ChatRenderer's loadConversationHistory method directly
  /**
   * Update send button enabled/disabled state based on provider availability
   */
  async updateSendButtonState() {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(!currentProviderType);
  }
  /**
   * Update privacy indicator icon and tooltip based on current provider
   */
  async updatePrivacyIndicator(privacyIndicator) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (currentProviderType) {
      const isLocalProvider = currentProviderType === "ollama";
      const iconName = isLocalProvider ? "lock" : "unlock";
      const tooltip = isLocalProvider ? "Local processing - data stays on your device" : "Cloud processing - data sent to provider";
      (0, import_obsidian11.setIcon)(privacyIndicator, iconName);
      privacyIndicator.setAttribute("aria-label", tooltip);
      privacyIndicator.setAttribute("title", tooltip);
    } else {
      (0, import_obsidian11.setIcon)(privacyIndicator, "help-circle");
      privacyIndicator.setAttribute("aria-label", "No provider selected");
      privacyIndicator.setAttribute("title", "No provider selected");
    }
  }
  /**
   * Filter thinking content from AI responses
   * Removes content between <think>/<thinking> and </think>/<thinking> tags
   */
  filterThinkingContent(content) {
    return content.replace(/<think(?:ing)?[\s\S]*?<\/think(?:ing)?>/gi, "").trim();
  }
  /**
   * Refresh all provider status indicators in the UI
   */
  async refreshProviderStatus() {
    var _a;
    if (this.privacyIndicator) {
      await this.updatePrivacyIndicator(this.privacyIndicator);
    }
    this.updateSendButtonState();
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      await this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-normal);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
      if (currentProviderType) {
        const displayText = this.getProviderWithModelDisplayName(currentProviderType);
        providerName.setText(displayText);
      } else {
        const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
        providerName.setText(currentProviderName);
      }
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Get available models for a provider type
   */
  getAvailableModels(providerType) {
    return getAvailableModels(providerType, this.plugin.settings);
  }
  /**
   * Get current model for a provider type
   */
  getCurrentModel(providerType) {
    var _a;
    const providers = this.plugin.settings.aiProviders;
    const currentModel = (_a = providers[providerType]) == null ? void 0 : _a.model;
    if (currentModel) {
      return currentModel;
    }
    const availableModels = this.getAvailableModels(providerType);
    return availableModels.length > 0 ? availableModels[0].value : "";
  }
  /**
   * Get model display name from model value
   */
  getModelDisplayName(providerType, modelValue) {
    const models = this.getAvailableModels(providerType);
    const model = models.find((m) => m.value === modelValue);
    return model ? model.label : modelValue;
  }
  /**
   * Switch to a specific model for a provider
   */
  async switchToModel(providerType, modelValue) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const isCurrentProvider = currentProviderType === providerType;
    const providers = this.plugin.settings.aiProviders;
    providers[providerType].model = modelValue;
    await this.plugin.saveSettings();
    if (isCurrentProvider) {
      const modelName = this.getModelDisplayName(providerType, modelValue);
      const providerName = this.getProviderDisplayName(providerType);
      this.addSuccessMessage(`\u2713 Switched to ${providerName} ${modelName}`);
    } else {
      await this.switchToProvider(providerType);
    }
    if (this.currentProviderDropdown) {
      this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    var _a;
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providers = this.plugin.settings.aiProviders;
      const hasApiKey = (_a = providers[providerType]) == null ? void 0 : _a.apiKey;
      if (!hasApiKey && providerType !== "ollama") continue;
      const models = this.getAvailableModels(providerType);
      const currentModel = this.getCurrentModel(providerType);
      const displayName = this.getProviderDisplayName(providerType);
      const isCurrent = displayName === currentProviderName;
      const providerContainer = dropdownMenu.createDiv({ cls: "nova-provider-container" });
      const providerItem = providerContainer.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				color: var(--text-normal);
				transition: background-color 0.2s ease;
				position: relative;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const nameSpan = providerItem.createSpan({ text: displayName });
      nameSpan.style.flex = "1";
      let expandArrow = null;
      if (models.length > 0) {
        expandArrow = providerItem.createSpan({ text: "\u25B6" });
        expandArrow.style.cssText = `
					font-size: 0.6em;
					transition: transform 0.2s ease;
					color: var(--text-muted);
				`;
      }
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      let modelsMenu = null;
      let isExpanded = false;
      if (models.length > 0) {
        modelsMenu = providerContainer.createDiv({ cls: "nova-models-submenu" });
        modelsMenu.style.cssText = `
					display: none;
					background: var(--background-primary);
					border-left: 2px solid ${this.getProviderColor(providerType)};
					margin-left: 16px;
				`;
        for (const model of models) {
          const modelItem = modelsMenu.createDiv({ cls: "nova-model-item" });
          modelItem.style.cssText = `
						padding: 6px 12px;
						cursor: pointer;
						font-size: 0.8em;
						color: var(--text-normal);
						transition: background-color 0.2s ease;
						display: flex;
						align-items: center;
						gap: 8px;
					`;
          const modelDot = modelItem.createSpan();
          modelDot.style.cssText = `
						width: 4px;
						height: 4px;
						border-radius: 50%;
						background: ${model.value === currentModel ? this.getProviderColor(providerType) : "var(--text-muted)"};
					`;
          const modelName = modelItem.createSpan({ text: model.label });
          if (model.value === currentModel) {
            modelName.style.fontWeight = "bold";
          }
          modelItem.addEventListener("click", async (e) => {
            e.stopPropagation();
            await this.switchToModel(providerType, model.value);
            dropdownMenu.style.display = "none";
          });
          modelItem.addEventListener("mouseenter", () => {
            modelItem.style.background = "var(--background-modifier-border-hover)";
          });
          modelItem.addEventListener("mouseleave", () => {
            modelItem.style.background = "transparent";
          });
        }
      }
      providerItem.addEventListener("click", async (e) => {
        if (models.length > 0) {
          e.stopPropagation();
          isExpanded = !isExpanded;
          if (modelsMenu) {
            modelsMenu.style.display = isExpanded ? "block" : "none";
          }
          if (expandArrow) {
            expandArrow.style.transform = isExpanded ? "rotate(90deg)" : "rotate(0deg)";
          }
        } else {
          if (!isCurrent) {
            await this.switchToProvider(providerType);
            dropdownMenu.style.display = "none";
            if (this.currentProviderDropdown) {
              this.currentProviderDropdown.updateCurrentProvider();
            }
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent && !isExpanded) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "trash-2": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M8 6V4A2 2 0 0 1 10 2H14A2 2 0 0 1 16 4V6M19 6V20A2 2 0 0 1 17 22H7A2 2 0 0 1 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Anthropic",
      "openai": "OpenAI",
      "google": "Google",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get display name for header (just model name if available, otherwise provider name)
   */
  getProviderWithModelDisplayName(providerType) {
    const models = this.getAvailableModels(providerType);
    if (models.length > 0) {
      const currentModel = this.getCurrentModel(providerType);
      return this.getModelDisplayName(providerType, currentModel);
    }
    return this.getProviderDisplayName(providerType);
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "var(--color-orange)",
      "openai": "var(--color-green)",
      "google": "var(--color-blue)",
      "ollama": "var(--color-purple)",
      "none": "var(--text-muted)"
    };
    return colors[providerType] || "var(--text-success)";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      this.addSuccessMessage(`\u2713 Switched to ${this.getProviderWithModelDisplayName(providerType)}`);
      const platform = import_obsidian11.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      setTimeout(() => this.refreshProviderStatus(), 100);
    } catch (error) {
      this.addErrorMessage(`\u274C Failed to switch to ${this.getProviderWithModelDisplayName(providerType)}`);
    }
  }
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    if (this.inputHandler) {
      this.inputHandler.refreshCommandButton();
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
  /**
   * Execute add command with streaming support
   */
  async executeAddCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.addCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming add command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute edit command with streaming support
   */
  async executeEditCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.editCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming edit command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeRewriteCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.rewriteCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming rewrite command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeGrammarCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition
      );
      try {
        const result = await this.plugin.grammarCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming grammar command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Add files to persistent context
   */
  async addFilesToContext(filenames) {
    if (!this.currentFile) {
      new import_obsidian11.Notice("No file is open. Please open a file to add context.", 3e3);
      return;
    }
    const addedFiles = [];
    const alreadyExistingFiles = [];
    const notFoundFiles = [];
    const existingPersistent = this.multiDocHandler.getPersistentContext(this.currentFile.path) || [];
    const updatedPersistent = [...existingPersistent];
    for (const filename of filenames) {
      let file = this.app.vault.getAbstractFileByPath(filename);
      if (!file || !(file instanceof import_obsidian11.TFile)) {
        file = this.app.vault.getAbstractFileByPath(filename + ".md");
      }
      if (!file || !(file instanceof import_obsidian11.TFile)) {
        const files = this.app.vault.getMarkdownFiles();
        file = files.find(
          (f) => f.basename === filename || f.name === filename || f.path.endsWith("/" + filename) || f.path.endsWith("/" + filename + ".md")
        ) || null;
      }
      if (file instanceof import_obsidian11.TFile) {
        const exists = updatedPersistent.some((ref) => ref.file.path === file.path);
        if (!exists) {
          updatedPersistent.push({
            file,
            property: void 0,
            isPersistent: true,
            rawReference: `+[[${file.basename}]]`
          });
          addedFiles.push(file.basename);
        } else {
          alreadyExistingFiles.push(file.basename);
        }
      } else {
        notFoundFiles.push(filename);
      }
    }
    if (addedFiles.length > 0 || alreadyExistingFiles.length > 0) {
      const handler = this.multiDocHandler;
      handler.persistentContext.set(this.currentFile.path, updatedPersistent);
    }
    await this.refreshContext();
    const totalFiles = filenames.length;
    const messages = [];
    if (addedFiles.length > 0) {
      if (addedFiles.length === 1) {
        messages.push(`Added "${addedFiles[0]}" to context`);
      } else {
        messages.push(`Added ${addedFiles.length} files to context`);
      }
    }
    if (alreadyExistingFiles.length > 0) {
      if (alreadyExistingFiles.length === 1) {
        messages.push(`"${alreadyExistingFiles[0]}" already in context`);
      } else {
        messages.push(`${alreadyExistingFiles.length} already in context`);
      }
    }
    if (notFoundFiles.length > 0) {
      if (notFoundFiles.length === 1) {
        messages.push(`"${notFoundFiles[0]}" not found`);
      } else {
        messages.push(`${notFoundFiles.length} not found`);
      }
    }
    if (messages.length > 0) {
      const combinedMessage = messages.join(", ");
      const duration = notFoundFiles.length > 0 ? 3e3 : 2e3;
      new import_obsidian11.Notice(combinedMessage, duration);
    }
  }
  /**
   * Get contextual thinking phrase based on command type or message content
   */
  getContextualThinkingPhrase(command, messageText) {
    if (command) {
      switch (command.action) {
        case "grammar":
        case "edit":
          return this.getRandomPhrase("improve");
        case "add":
          return this.getRandomPhrase("generate");
        case "rewrite":
          return this.getRandomPhrase("improve");
        case "delete":
          return this.getRandomPhrase("process");
        default:
          return this.getRandomPhrase("chat");
      }
    } else if (messageText) {
      if (messageText.includes("improve") || messageText.includes("fix") || messageText.includes("grammar")) {
        return this.getRandomPhrase("improve");
      } else if (messageText.includes("add") || messageText.includes("create") || messageText.includes("write")) {
        return this.getRandomPhrase("generate");
      } else if (messageText.includes("switch") || messageText.includes("/")) {
        return this.getRandomPhrase("switch");
      }
    }
    return this.getRandomPhrase("chat");
  }
  /**
   * Get random phrase from specified category
   */
  getRandomPhrase(category) {
    const phrases = {
      "improve": ["refining...", "polishing...", "enhancing...", "crafting...", "perfecting...", "smoothing...", "sharpening...", "elevating...", "fine-tuning...", "sculpting..."],
      "generate": ["thinking...", "crafting...", "developing...", "composing...", "writing...", "creating...", "formulating...", "building...", "constructing...", "drafting..."],
      "switch": ["connecting...", "switching...", "updating...", "configuring...", "setting up...", "syncing...", "preparing...", "activating...", "initializing...", "establishing..."],
      "process": ["processing...", "analyzing...", "working...", "computing...", "calculating...", "examining...", "evaluating...", "interpreting...", "reviewing...", "scanning..."],
      "chat": ["thinking...", "processing...", "considering...", "analyzing...", "understanding...", "contemplating...", "exploring...", "evaluating...", "working on it...", "composing..."]
    };
    const categoryPhrases = phrases[category] || phrases.chat;
    return categoryPhrases[Math.floor(Math.random() * categoryPhrases.length)];
  }
  /**
   * Start phrase rotation animation for thinking text
   */
  startThinkingPhraseRotation(textEl, command, messageText) {
    const rotationInterval = setInterval(() => {
      const newPhrase = this.getContextualThinkingPhrase(command, messageText);
      textEl.textContent = newPhrase;
    }, 2e3);
    textEl.rotationInterval = rotationInterval;
  }
  /**
   * Stop phrase rotation animation and cleanup
   */
  stopThinkingPhraseRotation(textEl) {
    if (textEl.rotationInterval) {
      clearInterval(textEl.rotationInterval);
      textEl.rotationInterval = null;
    }
  }
};
_NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS = 300;
_NovaSidebarView.SCROLL_DELAY_MS = 50;
_NovaSidebarView.FOCUS_DELAY_MS = 150;
_NovaSidebarView.HOVER_TIMEOUT_MS = 150;
_NovaSidebarView.NOTICE_DURATION_MS = 5e3;
var NovaSidebarView = _NovaSidebarView;

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-3-5-sonnet-20241022",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-1.5-flash",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian12.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isSupernova ? "supernova" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian12.Setting(licenseContainer).setName("Supernova License Key (Optional)").setDesc("Enter your Supernova supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Supernova license key...").setValue(this.plugin.settings.licensing.supernovaLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Supernova license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
              const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
              if (isSupernova2) {
                this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
                this.showConfetti();
              } else {
                this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
              }
              const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
              if (leaves.length > 0) {
                const sidebarView = leaves[0].view;
                sidebarView.refreshSupernovaUI();
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Supernova license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createSupernovaInfo(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian12.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian12.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian12.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.display();
      }));
      new import_obsidian12.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian12.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian12.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "AI Provider Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const providerContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    providerContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = providerContainer.style.display !== "none";
      providerContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = providerContainer.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
			<div class="nova-info-card nova-model-guidance">
				<h4>Recommended Defaults</h4>
				<ul class="nova-model-recommendations">
					<li><strong>Claude Sonnet 4</strong> - Latest generation with excellent instruction following for collaborative editing</li>
					<li><strong>GPT-4.1 Mini</strong> - Current-generation model that outperforms GPT-4o while remaining cost-effective</li>
					<li><strong>Gemini 2.5 Flash</strong> - Best price/performance with "thinking" capabilities and strong coding support</li>
				</ul>
				<p class="nova-guidance-note">These defaults offer modern AI capabilities without premium pricing.</p>
			</div>
		`;
    this.createOllamaSettings(providerContainer);
    this.createClaudeSettings(providerContainer);
    this.createGoogleSettings(providerContainer);
    this.createOpenAISettings(providerContainer);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian12.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian12.Setting(claudeContainer).setName("Model").setDesc("Claude model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateClaudeModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4-20250514").onChange(async (value) => {
        this.plugin.settings.aiProviders.claude.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateClaudeModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("claude");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    new import_obsidian12.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian12.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateOpenAIModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4.1-mini-2025-04-14").onChange(async (value) => {
        this.plugin.settings.aiProviders.openai.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateOpenAIModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("openai");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian12.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian12.Setting(googleContainer).setName("Model").setDesc("Gemini model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateGoogleModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-04-17").onChange(async (value) => {
        this.plugin.settings.aiProviders.google.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateGoogleModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("google");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian12.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Platform Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    platformContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = platformContainer.style.display !== "none";
      platformContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian12.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian12.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian12.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Custom Commands" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = commandContainer.style.display !== "none";
      commandContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian12.Setting(commandContainer).setName("Show Command Button in Chat (Mobile)").setDesc("Show the Commands button beside the Send button for mobile quick access to Nova commands and selection actions").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian12.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(commandContainer);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian14 = require("obsidian");

// src/ai/providers/claude.ts
var import_obsidian13 = require("obsidian");
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-5-haiku-latest",
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
      system: options == null ? void 0 : options.systemPrompt,
      messages: messages.map((msg) => ({
        role: msg.role === "assistant" ? "assistant" : "user",
        content: msg.content
      }))
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await (0, import_obsidian13.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": this.config.apiKey,
            "anthropic-version": "2023-06-01"
          },
          body: requestBody
        });
        if (response.status === 200) {
          const data = response.json;
          return data.content[0].text;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`Claude API error: ${response.status} - ${response.text}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && (error.message.includes("Network error") || error.message.includes("Failed to connect"))) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        if (error instanceof Error && error.message.startsWith("Claude API error:")) {
          throw error;
        }
        throw new Error(`Failed to connect to Claude API: ${error instanceof Error ? error.message : "Network error"}`);
      }
    }
    throw new Error("Claude API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    const result = await this.chatCompletion(messages, options);
    const chunkSize = 3;
    for (let i = 0; i < result.length; i += chunkSize) {
      const chunk = result.slice(i, i + chunkSize);
      yield { content: chunk, done: false };
      await new Promise((resolve) => setTimeout(resolve, 20));
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await (0, import_obsidian13.requestUrl)({
        url: "https://api.anthropic.com/v1/messages",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-5-haiku-latest",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (response.status !== 200) {
        throw new Error(`API key validation failed: ${response.status} - ${response.text}`);
      }
      const models = [
        "claude-opus-4-20250514",
        "claude-sonnet-4-20250514",
        "claude-3-7-sonnet-latest",
        "claude-3-5-sonnet-latest",
        "claude-3-5-haiku-latest"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
      messages: requestMessages,
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${this.config.apiKey}`
          },
          body: requestBody
        });
        if (response.ok) {
          const data = await response.json();
          return data.choices[0].message.content;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`OpenAI API error: ${response.statusText}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && error.message.includes("fetch")) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw error;
      }
    }
    throw new Error("OpenAI API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                const chunkSize = 3;
                for (let i = 0; i < content.length; i += chunkSize) {
                  const chunk = content.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gpt-4.1-2025-04-14",
        "gpt-4.1-mini-2025-04-14",
        "gpt-4.1-nano-2025-04-14",
        "gpt-4o",
        "gpt-4o-mini"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages) {
    const contents = [];
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    if (contents.length === 0) {
      throw new Error("No messages provided for Google API");
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const requestBody = {
      contents: this.formatMessagesForGemini(messages),
      generationConfig: {
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
      }
    };
    if ((options == null ? void 0 : options.systemPrompt) && options.systemPrompt.trim()) {
      requestBody.systemInstruction = {
        parts: [{ text: options.systemPrompt }]
      };
    }
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(requestBody)
    });
    if (!response.ok) {
      const errorText = await response.text();
      let errorMessage = "";
      try {
        const errorData = JSON.parse(errorText);
        if (errorData.error) {
          const code = errorData.error.code || response.status;
          const message = errorData.error.message || errorData.error.status || response.statusText;
          errorMessage = `[${code}]: ${message}`;
          if (response.status === 400) {
            errorMessage += " (Check request format or model name)";
          } else if (response.status === 401) {
            errorMessage += " (Check API key in settings)";
          } else if (response.status === 404) {
            errorMessage += " (Model may not be available)";
          } else if (response.status === 429) {
            errorMessage += " (Rate limit exceeded)";
          }
        } else {
          errorMessage = `[${response.status}]: ${errorText}`;
        }
      } catch (e) {
        errorMessage = `[${response.status}]: ${errorText || response.statusText}`;
      }
      console.error("Google API Error Details:", {
        status: response.status,
        statusText: response.statusText,
        errorText,
        requestBody,
        model,
        url
      });
      throw new Error(`Google API error ${errorMessage}`);
    }
    const data = await response.json();
    if (!data.candidates || data.candidates.length === 0) {
      if (data.error) {
        throw new Error(`Google API error: ${data.error.message || JSON.stringify(data.error)}`);
      }
      throw new Error("Google API returned no candidates");
    }
    if (data.candidates[0].finishReason === "SAFETY" || data.candidates[0].finishReason === "BLOCKED") {
      throw new Error("Google API blocked the response due to safety filters");
    }
    if (data.candidates[0].finishReason === "MAX_TOKENS" && (!data.candidates[0].content || !data.candidates[0].content.parts || data.candidates[0].content.parts.length === 0)) {
      throw new Error('API hit token limit before generating any content. Please increase "Default Max Tokens" in settings.');
    }
    if (data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
      const text = data.candidates[0].content.parts[0].text;
      if (data.candidates[0].finishReason === "MAX_TOKENS") {
        throw new Error('Response was truncated due to token limit. Please increase "Default Max Tokens" in settings.');
      }
      if (!text || text.trim().length === 0) {
        console.error("Google API returned empty text content");
        throw new Error("Google API returned empty text content");
      }
      return text;
    }
    throw new Error("Google API returned empty response");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        },
        ...(options == null ? void 0 : options.systemPrompt) && options.systemPrompt.trim() ? {
          systemInstruction: {
            parts: [{ text: options.systemPrompt }]
          }
        } : {}
      })
    });
    if (!response.ok) {
      const errorText = await response.text();
      let errorMessage = "";
      try {
        const errorData = JSON.parse(errorText);
        if (errorData.error) {
          const code = errorData.error.code || response.status;
          const message = errorData.error.message || errorData.error.status || response.statusText;
          errorMessage = `[${code}]: ${message}`;
        } else {
          errorMessage = `[${response.status}]: ${errorText}`;
        }
      } catch (e) {
        errorMessage = `[${response.status}]: ${errorText || response.statusText}`;
      }
      throw new Error(`Google API error ${errorMessage}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    let jsonBuffer = "";
    let braceCount = 0;
    let inJson = false;
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        for (let i = 0; i < buffer.length; i++) {
          const char = buffer[i];
          if (char === "{") {
            if (!inJson) {
              inJson = true;
              jsonBuffer = "";
            }
            braceCount++;
            jsonBuffer += char;
          } else if (char === "}") {
            jsonBuffer += char;
            braceCount--;
            if (braceCount === 0 && inJson) {
              try {
                const parsed = JSON.parse(jsonBuffer);
                const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
                if (text) {
                  const chunkSize = 3;
                  for (let i2 = 0; i2 < text.length; i2 += chunkSize) {
                    const chunk = text.slice(i2, i2 + chunkSize);
                    yield { content: chunk, done: false };
                    await new Promise((resolve) => setTimeout(resolve, 20));
                  }
                }
              } catch (e) {
              }
              inJson = false;
              jsonBuffer = "";
            }
          } else if (inJson) {
            jsonBuffer += char;
          }
        }
        buffer = "";
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gemini-2.5-flash-preview-04-17",
        "gemini-2.5-pro-preview-03-25",
        "gemini-2.0-flash",
        "gemini-2.0-flash-lite"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                const chunkSize = 3;
                for (let i = 0; i < parsed.response.length; i += chunkSize) {
                  const chunk = parsed.response.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                const chunkSize = 3;
                for (let i = 0; i < parsed.message.content.length; i += chunkSize) {
                  const chunk = parsed.message.content.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian14.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      const isAvailable = provider ? await provider.isAvailable() : false;
      if (provider && isAvailable) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async getCurrentProviderType() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return providerType;
      }
    }
    return null;
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    if (import_obsidian14.Platform.isMobile) {
      return ["claude", "openai", "google"];
    }
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
  /**
   * Get the default max tokens from settings
   */
  getDefaultMaxTokens() {
    return this.settings.general.defaultMaxTokens;
  }
};

// src/core/document-engine.ts
var import_obsidian15 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content, metadata) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now(),
      metadata
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance - ensures we get the editor for the active file
   */
  getActiveEditor() {
    const activeFile = this.getActiveFile();
    if (!activeFile) {
      return null;
    }
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    for (const leaf of leaves) {
      const view2 = leaf.view;
      if (view2 instanceof import_obsidian15.MarkdownView && view2.file === activeFile) {
        return view2.editor;
      }
    }
    const activeEditor = this.app.workspace.activeEditor;
    if ((activeEditor == null ? void 0 : activeEditor.editor) && activeEditor.file === activeFile) {
      return activeEditor.editor;
    }
    const view = this.app.workspace.getActiveViewOfType(import_obsidian15.MarkdownView);
    if (view && view.file === activeFile) {
      return view.editor;
    }
    return null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Set the cursor position (optionally focus the editor)
   */
  setCursorPosition(position, shouldFocus = false) {
    const editor = this.getActiveEditor();
    if (!editor) return;
    editor.setCursor(position);
    if (shouldFocus) {
      editor.focus();
    }
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at cursor location
   */
  async deleteContent(target) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
  /**
   * Replace selected text with new content
   * Handles undo/redo properly and preserves cursor position
   */
  async replaceSelection(newText, from, to) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "replace"
      };
    }
    try {
      const fromPos = from || editor.getCursor("from");
      const toPos = to || editor.getCursor("to");
      editor.replaceRange(newText, fromPos, toPos);
      const newCursorPos = {
        line: fromPos.line + (newText.split("\n").length - 1),
        ch: newText.includes("\n") ? newText.split("\n").pop().length : fromPos.ch + newText.length
      };
      editor.setCursor(newCursorPos);
      editor.focus();
      return {
        success: true,
        content: newText,
        appliedAt: fromPos,
        editType: "replace"
      };
    } catch (error) {
      console.error("Error replacing selection:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor(settings) {
    var _a, _b, _c, _d;
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: (_b = (_a = settings == null ? void 0 : settings.general) == null ? void 0 : _a.defaultTemperature) != null ? _b : 0.7,
      maxTokens: (_d = (_c = settings == null ? void 0 : settings.general) == null ? void 0 : _c.defaultMaxTokens) != null ? _d : 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents at their cursor position. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Work at the user's cursor position - every edit happens where they are focused
- Do not add headers unless specifically requested
- Focus on the user's immediate editing context`;
    const actionSpecificPrompts = {
      "add": `

ACTION: ADD CONTENT
- Generate EXACTLY what the user requested - follow their instruction literally
- Do NOT create content related to the document theme unless specifically asked
- Focus on the user's specific request, not the document's existing content
- Match basic formatting style but prioritize the user's exact request`,
      "edit": `

ACTION: EDIT CONTENT  
- Improve, modify, or enhance the specified content
- Preserve the original intent while following user instructions
- Apply style, tone, or structural changes as requested`,
      "delete": `

ACTION: DELETE CONTENT
- Confirm what should be deleted by providing the exact text to remove
- Be precise about deletion boundaries
- Respond "CONFIRMED" if the deletion is clear`,
      "grammar": `

ACTION: GRAMMAR & SPELLING
- Fix grammar, spelling, and punctuation errors
- Improve clarity while preserving meaning
- Maintain the original tone and style`,
      "rewrite": `

ACTION: REWRITE CONTENT
- Generate alternative content that serves the same purpose
- Apply requested style, tone, or structural changes
- Create fresh content while maintaining core meaning`,
      "metadata": `

ACTION: UPDATE METADATA
- Modify frontmatter properties, tags, or document metadata
- Return ONLY a JSON object with the properties to update
- For tags, return as an array: {"tags": ["tag1", "tag2"]}
- For other properties: {"title": "New Title", "author": "Name"}
- Do NOT include properties that shouldn't be changed
- Do NOT return any explanatory text, ONLY the JSON object`
    };
    return basePrompt + (actionSpecificPrompts[action] || "");
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += `DOCUMENT STRUCTURE:
`;
      const structure = this.buildDocumentStructure(documentContext.headings);
      context += structure + "\n";
    }
    context += this.buildTargetContext(command, documentContext);
    if (conversationContext && config.includeHistory) {
      context += `
CONVERSATION CONTEXT:
${conversationContext}
`;
    }
    if (command.action === "add" && command.target === "cursor") {
      if (documentContext.surroundingLines) {
        const before = documentContext.surroundingLines.before.slice(-3).join("\n");
        const after = documentContext.surroundingLines.after.slice(0, 3).join("\n");
        context += `
LOCAL CONTEXT (for style reference only):
Before cursor:
${before}

After cursor:
${after}
`;
      }
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}
`;
    }
    return context;
  }
  /**
   * Build target-specific context
   */
  buildTargetContext(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return `
SELECTED TEXT:
${documentContext.selectedText}
`;
        }
        return `
No text currently selected.
`;
      case "cursor":
        if (documentContext.surroundingLines) {
          const context = `
CURSOR CONTEXT:
`;
          const before = documentContext.surroundingLines.before.join("\n");
          const after = documentContext.surroundingLines.after.join("\n");
          return context + `Before cursor:
${before}

After cursor:
${after}
`;
        }
        return `
Cursor position context not available.
`;
      case "document":
        return `
Targeting entire document.
`;
      case "end":
        return `
Targeting end of document.
`;
      default:
        return `
Working at cursor position.
`;
    }
  }
  /**
   * Build user prompt with instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = contextInfo;
    prompt2 += `
USER REQUEST: ${command.instruction}
`;
    if (command.context) {
      prompt2 += `ADDITIONAL REQUIREMENTS: ${command.context}
`;
    }
    prompt2 += this.getFocusInstructions(command);
    prompt2 += this.getOutputInstructions(command);
    return prompt2;
  }
  /**
   * Get focus instructions based on target
   */
  getFocusInstructions(command) {
    const actionGuidance = {
      "add": "Add new content",
      "edit": "Modify existing content",
      "delete": "Remove specified content",
      "rewrite": "Generate alternative content",
      "grammar": "Fix grammar and spelling",
      "metadata": "Update document metadata"
    };
    switch (command.target) {
      case "selection":
        return `
FOCUS: ${actionGuidance[command.action]} in the selected text.
`;
      case "cursor":
        return `
FOCUS: ${actionGuidance[command.action]} at the current cursor position.
`;
      case "document":
        return `
FOCUS: ${actionGuidance[command.action]} for the entire document.
`;
      case "end":
        return `
FOCUS: Add content at the very end of the document, after all existing content. Ensure it flows naturally.
`;
      default:
        return `
FOCUS: ${actionGuidance[command.action]} at the cursor position.
`;
    }
  }
  /**
   * Get output instructions based on action
   */
  getOutputInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide the corrected version with proper grammar and spelling.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return "OUTPUT: Provide the updated metadata in proper YAML format.";
      default:
        return "OUTPUT: Provide only the requested content changes.";
    }
  }
  /**
   * Build document structure from headings
   */
  buildDocumentStructure(headings) {
    return headings.map((heading) => {
      const indent = "  ".repeat(heading.level - 1);
      return `${indent}- ${heading.text}`;
    }).join("\n");
  }
  /**
   * Validate generated prompt
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    if (prompt2.userPrompt.length > 1e4) {
      issues.push("User prompt is too long (>10000 characters)");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document"]
  },
  {
    action: "metadata",
    patterns: [
      // Tag-specific patterns with colon format (highest priority)
      /^(add|set|update|remove)\s+tags?:/i,
      // Tag optimization patterns
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i,
      /^add tags$/i,
      // Simple "add tags" for AI suggestions
      // General metadata patterns
      /\b(update|set|change|modify)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      // Tag-specific patterns that exclude content/text/section
      /\b(add|remove|update)\s+(?!.*\b(content|text|section|paragraph|about)\b).*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include|append|prepend)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert|append|prepend)\b(?!\s+.*\b(better|clearer|more|less|tags?|property|properties|metadata|frontmatter)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i,
      // Specific patterns for append/prepend with location
      /\b(append|add)\b.*\b(after|following)\b/i,
      /\b(prepend|add)\b.*\b(before|preceding)\b/i
    ],
    targets: ["end"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection"]
  }
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const context = this.extractContext(input);
    return {
      action,
      target,
      instruction: input,
      // Keep original input for display
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input (simplified for cursor-only editing)
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return "cursor";
      // Changed from 'end' to 'cursor' for cursor-only editing
      case "edit":
        return hasSelection ? "selection" : "cursor";
      case "delete":
        return hasSelection ? "selection" : "cursor";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return hasSelection ? "selection" : "cursor";
      // Changed from 'end' to support cursor-only
      case "metadata":
        return "document";
      default:
        return "cursor";
    }
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add content at cursor",
        "Fix grammar in this document",
        "Add conclusion at end",
        "Create a summary"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new content";
        break;
      case "metadata":
        description = "Update document metadata";
        break;
    }
    switch (target) {
      case "selection":
        description += " in selected text";
        break;
      case "cursor":
        description += " at cursor position";
        break;
      case "document":
        description += " in entire document";
        break;
      case "end":
        description += " at end of document";
        break;
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const lowerMessage = message.toLowerCase().trim();
    if (lowerMessage.startsWith(":")) {
      return true;
    }
    const actionVerbs = [
      "add",
      "insert",
      "append",
      "prepend",
      "include",
      "create",
      "write",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "replace",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "drop",
      "fix",
      "correct",
      "proofread",
      "polish",
      "check",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const startsWithAction = actionVerbs.some((verb) => {
      const verbPattern = new RegExp(`^${verb}\\b`, "i");
      return verbPattern.test(lowerMessage);
    });
    if (startsWithAction) {
      const questionIndicators = [
        /^(how|what|why|when|where|which|who|can|could|should|would|will|is|are|am|do|does|did)/i,
        /\?/,
        // Contains question mark
        /\b(help|advice|suggest|recommend|think|opinion)\b/i
      ];
      const isQuestion = questionIndicators.some((pattern) => pattern.test(lowerMessage));
      if (isQuestion) {
        return false;
      }
      return true;
    }
    const explicitCommandPatterns = [
      // Grammar/spelling commands that don't start with action verbs
      /\b(grammar|spell|spelling|proofread|polish)\b.*\b(check|fix|correct)\b/i,
      // Metadata commands with different structures
      /\bset\s+(the\s+)?(title|tags|metadata|properties)/i,
      /\bupdate\s+(the\s+)?(title|tags|metadata|properties)/i,
      // Tag-specific patterns
      /^(add|set|update|remove)\s+tags?:/i,
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i
    ];
    for (const pattern of explicitCommandPatterns) {
      if (pattern.test(lowerMessage)) {
        return true;
      }
    }
    return false;
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Key capabilities:
- Answer questions about documents and content
- Provide writing assistance and suggestions
- Help with research and analysis
- Engage in natural conversation about the user's work

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional
- Reference document context when relevant`;
    let userPrompt = `USER REQUEST: ${message}`;
    if (documentContext && file) {
      userPrompt = `Current document: ${documentContext.filename}

${userPrompt}`;
    }
    if (recentHistory.length > 0) {
      const historyString = this.formatConversationHistory(recentHistory);
      userPrompt = `RECENT CONVERSATION:
${historyString}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: (documentContext == null ? void 0 : documentContext.content) || "",
      config: {
        temperature: options.temperature || 0.7,
        maxTokens: options.maxTokens || 2e3
      }
    };
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional`;
    let userPrompt = `USER REQUEST: ${instruction}`;
    if (context) {
      userPrompt = `Context: ${context}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 2e3
      }
    };
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Simple token count estimation
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "insert"
            };
          }
          result = await this.applyAddition(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Apply addition based on command target
   */
  async applyAddition(command, documentContext, content) {
    switch (command.target) {
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return await this.documentEngine.applyEdit(
            content,
            "cursor",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        }
      default:
        return {
          success: false,
          error: `Invalid add target: ${command.target}`,
          editType: "insert"
        };
    }
  }
  /**
   * Validate add command
   */
  validateCommand(command) {
    if (command.action !== "add") {
      return {
        valid: false,
        error: "Command action must be add"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Add instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute add command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "insert"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "insert",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "insert"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyEdit(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for editing",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid edit target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to edit"
      };
    }
    if (command.action !== "edit") {
      return {
        valid: false,
        error: "Command action must be edit"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Edit instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute edit command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      const result = await this.applyDeletion(command, documentContext);
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "cursor":
        return await this.documentEngine.deleteContent("line");
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end - use cursor or selection instead",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: `Invalid delete target: ${command.target}`,
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to delete"
      };
    }
    if (command.action !== "delete") {
      return {
        valid: false,
        error: "Command action must be delete"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyGrammarFix(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar fix based on command target
   */
  async applyGrammarFix(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for grammar correction",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "cursor":
        return {
          success: false,
          error: 'Please select text to correct grammar, or use "document" to fix entire document',
          editType: "replace"
        };
      case "end":
        return {
          success: false,
          error: 'Grammar correction requires selecting text or specifying "document"',
          editType: "replace"
        };
      default:
        return {
          success: false,
          error: `Invalid grammar target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command
   */
  validateCommand(command, hasSelection) {
    if (command.action !== "grammar") {
      return {
        valid: false,
        error: "Command action must be grammar"
      };
    }
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to correct grammar"
      };
    }
    if (command.target !== "selection" && command.target !== "document") {
      return {
        valid: false,
        error: "Grammar correction requires selecting text or targeting entire document"
      };
    }
    return { valid: true };
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyRewrite(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, content) {
    switch (command.target) {
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for rewriting",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid rewrite target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command
   */
  validateCommand(command) {
    if (command.action !== "rewrite") {
      return {
        valid: false,
        error: "Command action must be rewrite"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Rewrite instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const tagResult = await this.handleDirectTagOperation(command.instruction, documentContext);
      if (tagResult) {
        return tagResult;
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        console.error("Failed to parse metadata updates. AI response:", aiResponse);
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      console.log("Metadata updates:", updates);
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      const successMessage = this.generateSuccessMessage(updates);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
  /**
   * Handle direct tag operations (add, remove, set tags)
   */
  async handleDirectTagOperation(instruction, documentContext) {
    const lowerInstruction = instruction.toLowerCase().trim();
    const colonMatch = lowerInstruction.match(/^(add|set|update|remove)\s+tags?:\s*(.*)$/);
    if (colonMatch) {
      const action = colonMatch[1];
      const tagString = colonMatch[2];
      const newTags = tagString ? tagString.split(",").map((t) => t.trim()).filter((t) => t) : [];
      if (action === "add" && newTags.length === 0) {
        return await this.handleAITagOperation("add suggested tags", documentContext);
      }
      const currentTags = this.getCurrentTags(documentContext.content);
      let updatedTags = [];
      let message = "";
      switch (action) {
        case "add":
          const tagsToAdd = newTags.filter(
            (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
          );
          updatedTags = [...currentTags, ...tagsToAdd];
          message = tagsToAdd.length > 0 ? `Added ${tagsToAdd.length} tag${tagsToAdd.length !== 1 ? "s" : ""}: ${tagsToAdd.join(", ")}` : "No new tags to add (duplicates filtered)";
          break;
        case "remove":
          const lowerNewTags = newTags.map((t) => t.toLowerCase());
          const beforeCount = currentTags.length;
          updatedTags = currentTags.filter(
            (tag) => !lowerNewTags.includes(tag.toLowerCase())
          );
          const removedCount = beforeCount - updatedTags.length;
          message = removedCount > 0 ? `Removed ${removedCount} tag${removedCount !== 1 ? "s" : ""}` : "No tags found to remove";
          break;
        case "set":
        case "update":
          updatedTags = [...new Set(newTags.map((t) => t.toLowerCase()))];
          message = `Set ${updatedTags.length} tag${updatedTags.length !== 1 ? "s" : ""}`;
          break;
      }
      const updates = { tags: updatedTags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    }
    if (/\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i.test(lowerInstruction) || /\b(suggest|recommend)\s+.*\btags?\b/i.test(lowerInstruction) || /^add suggested tags$/i.test(lowerInstruction) || /^add tags$/i.test(lowerInstruction) || // Handle simple "add tags" as AI suggestion
    /^update tags$/i.test(lowerInstruction)) {
      return await this.handleAITagOperation(instruction, documentContext);
    }
    return null;
  }
  /**
   * Handle AI-powered tag operations (suggest, optimize, clean up)
   */
  async handleAITagOperation(instruction, documentContext) {
    const currentTags = this.getCurrentTags(documentContext.content);
    const systemPrompt = `You are an expert at document tagging and metadata organization. Your task is to analyze documents and provide optimal tags.

Rules for tags:
- Tags should be lowercase
- Use hyphens for multi-word tags (e.g., "machine-learning")
- Be specific but not overly granular
- Aim for 5-10 tags per document
- Focus on key concepts, topics, and themes FROM THE ACTUAL DOCUMENT CONTENT
- Tags must be directly relevant to the document's subject matter
- Avoid generic tags like "document" or "text"
- Consider the document's purpose, audience, and main topics
- Extract tags based on the document's actual content, not random topics

IMPORTANT: Base your tag suggestions ONLY on the content provided. Do not invent unrelated tags.

Return ONLY a JSON object with a "tags" array and a "reasoning" field explaining your choices.`;
    let userPrompt = "";
    if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
      userPrompt = `Carefully analyze the following document and suggest relevant tags based on its actual content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Based on the above document content, suggest additional tags that:
1. Reflect the actual topics discussed in the document
2. Capture key concepts, technologies, or themes mentioned
3. Would help with discoverability and organization
4. Are directly relevant to what this document is about

DO NOT suggest tags about topics not mentioned in the document.`;
    } else if (/clean up|cleanup/i.test(instruction)) {
      userPrompt = `Clean up and optimize the tags for this document by analyzing both the current tags and the document content.

Current tags: ${currentTags.join(", ")}

DOCUMENT CONTENT:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Remove duplicate or redundant tags
2. Consolidate similar tags (e.g., "js" and "javascript")
3. Remove tags that aren't relevant to the document content
4. Standardize tag format (lowercase, hyphenated)
5. Ensure remaining tags accurately reflect the document

Provide a cleaned-up tag list based on the actual document content.`;
    } else if (/optimize|improve|review|analyze|update/i.test(instruction)) {
      userPrompt = `Analyze this document thoroughly and provide an optimized set of tags that accurately represents its content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Review the document content carefully
2. Remove any tags that aren't relevant to the actual content
3. Add tags for important concepts, topics, or themes that are missing
4. Ensure all tags directly relate to what's discussed in the document
5. Aim for 5-10 highly relevant tags

Provide an optimized tag list that best represents THIS SPECIFIC document's content.`;
    }
    try {
      const defaultMaxTokens = this.providerManager.getDefaultMaxTokens();
      const aiResponse = await this.providerManager.complete(systemPrompt, userPrompt, {
        temperature: 0.3,
        maxTokens: defaultMaxTokens
      });
      const parsed = this.parseAITagResponse(aiResponse);
      if (!parsed || !parsed.tags || parsed.tags.length === 0) {
        const preview = aiResponse.length > 100 ? aiResponse.substring(0, 100) + "..." : aiResponse;
        return {
          success: false,
          error: `Could not parse AI tag suggestions. AI response: "${preview}"`,
          editType: "replace"
        };
      }
      const updates = { tags: parsed.tags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      let message = "";
      if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
        const addedTags = parsed.tags.filter(
          (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
        );
        message = `Added ${addedTags.length} suggested tag${addedTags.length !== 1 ? "s" : ""}: ${addedTags.join(", ")}`;
      } else if (/clean up|cleanup/i.test(instruction)) {
        message = `Cleaned up tags: ${currentTags.length} \u2192 ${parsed.tags.length} tags`;
      } else {
        message = `Optimized tags: ${parsed.tags.length} tag${parsed.tags.length !== 1 ? "s" : ""} (was ${currentTags.length})`;
      }
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to process tag operation: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Get current tags from document content
   */
  getCurrentTags(content) {
    if (!content) return [];
    const lines = content.split("\n");
    if (lines.length > 0 && lines[0] === "---") {
      let inFrontmatter = true;
      for (let i = 1; i < lines.length && inFrontmatter; i++) {
        if (lines[i] === "---") {
          break;
        }
        const tagMatch = lines[i].match(/^tags:\s*(.*)$/);
        if (tagMatch) {
          const tagValue = tagMatch[1].trim();
          if (!tagValue) return [];
          try {
            const parsed = JSON.parse(tagValue);
            if (Array.isArray(parsed)) {
              return parsed.filter((t) => t);
            }
          } catch (e) {
            return tagValue.split(",").map((t) => t.trim()).filter((t) => t);
          }
        }
      }
    }
    return [];
  }
  /**
   * Parse AI response for tag operations
   */
  parseAITagResponse(response) {
    try {
      const cleanResponse = response.trim();
      const jsonMatch = cleanResponse.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        try {
          const parsed = JSON.parse(jsonMatch[0]);
          if (parsed.tags && Array.isArray(parsed.tags)) {
            return {
              tags: parsed.tags.map((t) => String(t).toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t),
              reasoning: parsed.reasoning
            };
          }
        } catch (e) {
        }
      }
      const patterns = [
        // JSON array: tags: ["tag1", "tag2"]
        /tags?:\s*\[([^\]]+)\]/i,
        // Comma list: Tags: tag1, tag2, tag3
        /tags?:\s*([^\n]+?)(?:\n|$)/i,
        // Bullet list: - tag1\n- tag2
        /(?:tags?:)?\s*(?:\n)?(\s*[-*]\s*.+(?:\n\s*[-*]\s*.+)*)/i
      ];
      for (const pattern of patterns) {
        const match = cleanResponse.match(pattern);
        if (match) {
          let tagString = match[1];
          let tags = [];
          if (tagString.includes("-") || tagString.includes("\u2022") || tagString.includes("*")) {
            tags = tagString.split(/\n/).map((line) => line.replace(/^\s*[-*]\s*/, "").trim()).filter((t) => t);
          } else {
            tags = tagString.split(",").map((t) => t.trim().replace(/["']/g, "")).filter((t) => t);
          }
          if (tags.length > 0) {
            return {
              tags: tags.map((t) => t.toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t)
            };
          }
        }
      }
      const suggestMatch = cleanResponse.match(/(?:suggest|recommend|propose|here are|tags are)[:\s]+([^.]+)/i);
      if (suggestMatch) {
        const tags = suggestMatch[1].split(/[,\n]/).map((t) => t.trim().replace(/["']/g, "").replace(/^and\s+/i, "")).filter((t) => t);
        if (tags.length > 0) {
          return {
            tags: tags.map((t) => t.toLowerCase().trim()).filter((t) => t)
          };
        }
      }
      const lines = cleanResponse.split("\n").map((line) => line.trim()).filter((line) => line);
      const validTags = lines.filter((line) => {
        return line.length > 0 && line.length < 50 && !line.includes(":") && !line.toLowerCase().includes("tag") && !line.toLowerCase().includes("here") && !line.toLowerCase().includes("suggest");
      }).map((line) => {
        return line.toLowerCase().replace(/^[-*#]\s*/, "").replace(/^\d+\.\s*/, "").trim().replace(/\s+/g, "-");
      }).filter((tag) => tag);
      if (validTags.length > 0) {
        return { tags: validTags };
      }
      console.error("Failed to parse AI tag response:", cleanResponse);
      return null;
    } catch (error) {
      console.error("Error parsing AI tag response:", error, "Response was:", response);
      return null;
    }
  }
  /**
   * Generate success message based on updates
   */
  generateSuccessMessage(updates) {
    const keys = Object.keys(updates);
    if (keys.length === 0) return "Metadata updated";
    if (keys.length === 1) {
      const key = keys[0];
      if (key === "tags") {
        const count = Array.isArray(updates.tags) ? updates.tags.length : 0;
        return `Updated tags (${count} tag${count !== 1 ? "s" : ""})`;
      }
      return `Updated ${key}`;
    }
    return `Updated ${keys.length} properties`;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Commands (unified) - 2 month early access
  "commands": {
    supernovaDate: "2025-07-31",
    // Supernova early access
    generalDate: "2025-09-30",
    // General availability 
    description: "Command system with : triggers, command button, and custom commands"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context",
  // Current document context
  "multi-doc-context"
  // Reference other documents with [[doc]] syntax
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Supernova status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsSupernova() && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// src/core/ai-intent-classifier.ts
var AIIntentClassifier = class {
  constructor(providerManager) {
    this.providerManager = providerManager;
  }
  /**
   * Classify user input into one of three intents
   */
  async classifyIntent(userInput, hasSelection = false) {
    if (userInput.startsWith(":")) {
      return "CHAT";
    }
    return this.fallbackClassification(userInput);
  }
  /**
   * Simple heuristic fallback for when AI classification fails
   */
  fallbackClassification(userInput) {
    const lowerInput = userInput.toLowerCase().trim();
    if (lowerInput.includes("?") || lowerInput.startsWith("what") || lowerInput.startsWith("why") || lowerInput.startsWith("how") || lowerInput.startsWith("when") || lowerInput.startsWith("where") || lowerInput.startsWith("who") || lowerInput.startsWith("can you") || lowerInput.startsWith("could you") || lowerInput.includes("explain") || lowerInput.includes("help me understand")) {
      return "CHAT";
    }
    if (
      // Tag-specific patterns
      /\btags?\b/i.test(lowerInput) || /\btagging\b/i.test(lowerInput) || // Property patterns
      /\b(title|author|date|status|category|categories)\b/i.test(lowerInput) || // Metadata/frontmatter patterns
      /\b(metadata|frontmatter|properties|property)\b/i.test(lowerInput) || // Common metadata actions
      /^(add|update|set|remove|clean|optimize)\s+(tags?|title|author|metadata)/i.test(lowerInput)
    ) {
      return "METADATA";
    }
    if (/^(add|write|create|insert)\s+(a\s+)?(section|paragraph|conclusion|introduction|summary)/i.test(lowerInput) || /^(fix|correct|improve)\s+(grammar|spelling|writing)/i.test(lowerInput) || /^(make|rewrite|edit|modify|change)/i.test(lowerInput) || /^(delete|remove)\s+(the\s+)?(section|paragraph|sentence)/i.test(lowerInput)) {
      return "CONTENT";
    }
    return "CONTENT";
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian16.Plugin {
  async onload() {
    try {
      await this.loadSettings();
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      this.app.workspace.onLayoutReady(() => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
      });
      (0, import_obsidian16.addIcon)("nova-star", NOVA_ICON_SVG2);
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder(this.settings);
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.aiIntentClassifier = new AIIntentClassifier(this.aiProviderManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      this.addCommand({
        id: "nova-improve-writing",
        name: "Improve Writing",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("improve", editor);
        }
      });
      this.addCommand({
        id: "nova-make-longer",
        name: "Make Longer",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("longer", editor);
        }
      });
      this.addCommand({
        id: "nova-make-shorter",
        name: "Make Shorter",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("shorter", editor);
        }
      });
      TONE_OPTIONS.forEach((tone) => {
        this.addCommand({
          id: `nova-make-${tone.id}`,
          name: `Make ${tone.label}`,
          editorCallback: async (editor) => {
            await this.handleToneCommand(tone.id, editor);
          }
        });
      });
      this.addCommand({
        id: "nova-tell-nova",
        name: "Tell Nova...",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("custom", editor);
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      this.selectionContextMenu = new SelectionContextMenu(this.app, this);
      this.selectionContextMenu.register();
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
    } catch (error) {
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle selection-based commands
   */
  async handleSelectionCommand(actionId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian16.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction(actionId, editor, selectedText);
    } catch (error) {
      console.error("Error executing Nova selection command:", error);
      new import_obsidian16.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Handle tone-specific commands
   */
  async handleToneCommand(toneId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian16.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction("tone", editor, selectedText, toneId);
    } catch (error) {
      console.error("Error executing Nova tone command:", error);
      new import_obsidian16.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian16.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9kb2N1bWVudC1hbmFseXNpcy50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvYWkvbW9kZWxzLnRzIiwgInNyYy91aS9pbnB1dC1oYW5kbGVyLnRzIiwgInNyYy91aS93aWtpbGluay1zdWdnZXN0LnRzIiwgInNyYy91aS9jb21tYW5kLXN5c3RlbS50cyIsICJzcmMvdWkvY29udGV4dC1tYW5hZ2VyLnRzIiwgInNyYy91aS9jaGF0LXJlbmRlcmVyLnRzIiwgInNyYy91aS9zdHJlYW1pbmctbWFuYWdlci50cyIsICJzcmMvdWkvc2VsZWN0aW9uLWNvbnRleHQtbWVudS50cyIsICJzcmMvY29yZS9jb21tYW5kcy9zZWxlY3Rpb24tZWRpdC1jb21tYW5kLnRzIiwgInNyYy91aS90b25lLXNlbGVjdGlvbi1tb2RhbC50cyIsICJzcmMvdWkvY3VzdG9tLWluc3RydWN0aW9uLW1vZGFsLnRzIiwgInNyYy9haS9wcm92aWRlci1tYW5hZ2VyLnRzIiwgInNyYy9haS9wcm92aWRlcnMvY2xhdWRlLnRzIiwgInNyYy9haS9wcm92aWRlcnMvb3BlbmFpLnRzIiwgInNyYy9haS9wcm92aWRlcnMvZ29vZ2xlLnRzIiwgInNyYy9haS9wcm92aWRlcnMvb2xsYW1hLnRzIiwgInNyYy9jb3JlL2RvY3VtZW50LWVuZ2luZS50cyIsICJzcmMvY29yZS9jb252ZXJzYXRpb24tbWFuYWdlci50cyIsICJzcmMvY29yZS9jb250ZXh0LWJ1aWxkZXIudHMiLCAic3JjL2NvcmUvY29tbWFuZC1wYXJzZXIudHMiLCAic3JjL2NvcmUvcHJvbXB0LWJ1aWxkZXIudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvYWRkLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZWRpdC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2RlbGV0ZS1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9yZXdyaXRlLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZC50cyIsICJzcmMvbGljZW5zaW5nL2ZlYXR1cmUtY29uZmlnLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyLnRzIiwgInNyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3IudHMiLCAic3JjL2NvcmUvYWktaW50ZW50LWNsYXNzaWZpZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgV29ya3NwYWNlTGVhZiwgSXRlbVZpZXcsIGFkZEljb24sIE5vdGljZSwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzLCBOb3ZhU2V0dGluZ1RhYiwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBOb3ZhU2lkZWJhclZpZXcsIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgfSBmcm9tICcuL3NyYy91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL3NyYy9jb3JlL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IFByb21wdEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL3Byb21wdC1idWlsZGVyJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IEFkZENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgRGVsZXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgR3JhbW1hckNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZCc7XG5pbXBvcnQgeyBSZXdyaXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kJztcbmltcG9ydCB7IE1ldGFkYXRhQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZCc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3NyYy91aS93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IFNlbGVjdGlvbkNvbnRleHRNZW51IH0gZnJvbSAnLi9zcmMvdWkvc2VsZWN0aW9uLWNvbnRleHQtbWVudSc7XG5pbXBvcnQgeyBUT05FX09QVElPTlMgfSBmcm9tICcuL3NyYy91aS90b25lLXNlbGVjdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBBSUludGVudENsYXNzaWZpZXIgfSBmcm9tICcuL3NyYy9jb3JlL2FpLWludGVudC1jbGFzc2lmaWVyJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3ZhUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBOb3ZhU2V0dGluZ3M7XG5cdGFpUHJvdmlkZXJNYW5hZ2VyITogQUlQcm92aWRlck1hbmFnZXI7XG5cdGRvY3VtZW50RW5naW5lITogRG9jdW1lbnRFbmdpbmU7XG5cdGNvbnRleHRCdWlsZGVyITogQ29udGV4dEJ1aWxkZXI7XG5cdGNvbW1hbmRQYXJzZXIhOiBDb21tYW5kUGFyc2VyO1xuXHRwcm9tcHRCdWlsZGVyITogUHJvbXB0QnVpbGRlcjtcblx0Y29udmVyc2F0aW9uTWFuYWdlciE6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG5cdGFpSW50ZW50Q2xhc3NpZmllciE6IEFJSW50ZW50Q2xhc3NpZmllcjtcblx0YWRkQ29tbWFuZEhhbmRsZXIhOiBBZGRDb21tYW5kO1xuXHRlZGl0Q29tbWFuZEhhbmRsZXIhOiBFZGl0Q29tbWFuZDtcblx0ZGVsZXRlQ29tbWFuZEhhbmRsZXIhOiBEZWxldGVDb21tYW5kO1xuXHRncmFtbWFyQ29tbWFuZEhhbmRsZXIhOiBHcmFtbWFyQ29tbWFuZDtcblx0cmV3cml0ZUNvbW1hbmRIYW5kbGVyITogUmV3cml0ZUNvbW1hbmQ7XG5cdG1ldGFkYXRhQ29tbWFuZEhhbmRsZXIhOiBNZXRhZGF0YUNvbW1hbmQ7XG5cdGZlYXR1cmVNYW5hZ2VyITogRmVhdHVyZU1hbmFnZXI7XG5cdGxpY2Vuc2VWYWxpZGF0b3IhOiBMaWNlbnNlVmFsaWRhdG9yO1xuXHRzZXR0aW5nVGFiITogTm92YVNldHRpbmdUYWI7XG5cdHNpZGViYXJWaWV3ITogTm92YVNpZGViYXJWaWV3O1xuXHRzZWxlY3Rpb25Db250ZXh0TWVudSE6IFNlbGVjdGlvbkNvbnRleHRNZW51O1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXG5cdFx0XHQvLyBJbml0aWFsaXplIGxpY2Vuc2luZyBzeXN0ZW1cblx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvciA9IG5ldyBMaWNlbnNlVmFsaWRhdG9yKCk7XG5cdFx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gbmV3IEZlYXR1cmVNYW5hZ2VyKFxuXHRcdFx0XHR0aGlzLmxpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Ncblx0XHRcdCk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBsaWNlbnNlIGZyb20gc2V0dGluZ3Ncblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVmcmVzaCBTdXBlcm5vdmEgVUkgYWZ0ZXIgbGljZW5zZSB2YWxpZGF0aW9uIHRvIGhhbmRsZSBleHBpcmVkIGxpY2Vuc2VzXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gTm90ZTogTW9iaWxlIGFjY2VzcyByZXN0cmljdGlvbnMgYXJlIG5vdyBoYW5kbGVkIGluIHNpZGViYXIgVUlcblx0XHRcdC8vIFRoaXMgYWxsb3dzIENvcmUgbW9iaWxlIHVzZXJzIHRvIHNlZSB0aGUgdXBncmFkZSBpbnRlcmZhY2UgcmF0aGVyIHRoYW4gYSBicm9rZW4gcGx1Z2luXG5cblx0XHRcdC8vIFJlZ2lzdGVyIGN1c3RvbSBpY29uXG5cdFx0XHRhZGRJY29uKCdub3ZhLXN0YXInLCBOT1ZBX0lDT05fU1ZHKTtcblxuXHRcdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlciA9IG5ldyBBSVByb3ZpZGVyTWFuYWdlcih0aGlzLnNldHRpbmdzLCB0aGlzLmZlYXR1cmVNYW5hZ2VyKTtcblx0XHRcdGF3YWl0IHRoaXMuYWlQcm92aWRlck1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGFuZCBkb2N1bWVudCBlbmdpbmVcblx0XHRcdGNvbnN0IGRhdGFTdG9yZSA9IHtcblx0XHRcdFx0bG9hZERhdGE6IChrZXk6IHN0cmluZykgPT4gdGhpcy5sb2FkRGF0YVdpdGhLZXkoa2V5KSxcblx0XHRcdFx0c2F2ZURhdGE6IChrZXk6IHN0cmluZywgZGF0YTogYW55KSA9PiB0aGlzLnNhdmVEYXRhV2l0aEtleShrZXksIGRhdGEpXG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBuZXcgRG9jdW1lbnRFbmdpbmUodGhpcy5hcHAsIGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lLnNldENvbnZlcnNhdGlvbk1hbmFnZXIodGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdHRoaXMuY29udGV4dEJ1aWxkZXIgPSBuZXcgQ29udGV4dEJ1aWxkZXIodGhpcy5zZXR0aW5ncyk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQYXJzZXIgPSBuZXcgQ29tbWFuZFBhcnNlcigpO1xuXHRcdFx0dGhpcy5wcm9tcHRCdWlsZGVyID0gbmV3IFByb21wdEJ1aWxkZXIodGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdHRoaXMuYWlJbnRlbnRDbGFzc2lmaWVyID0gbmV3IEFJSW50ZW50Q2xhc3NpZmllcih0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdFxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kSGFuZGxlciA9IG5ldyBBZGRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZWRpdENvbW1hbmRIYW5kbGVyID0gbmV3IEVkaXRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgRGVsZXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmdyYW1tYXJDb21tYW5kSGFuZGxlciA9IG5ldyBHcmFtbWFyQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlciA9IG5ldyBSZXdyaXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIgPSBuZXcgTWV0YWRhdGFDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblxuXHRcdFx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0XHRcdFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsXG5cdFx0XHRcdChsZWFmKSA9PiBuZXcgTm92YVNpZGViYXJWaWV3KGxlYWYsIHRoaXMpXG5cdFx0XHQpO1xuXG5cdFx0XHQvLyBOb3RlOiBXaWtpbGluayBhdXRvY29tcGxldGUgaXMgbm93IGhhbmRsZWQgZGlyZWN0bHkgaW4gc2lkZWJhciB2aWV3XG5cblx0XHRcdGNvbnN0IHJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ25vdmEtc3RhcicsICdOb3ZhIEFJJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIFJlZ2lzdGVyIHNlbGVjdGlvbi1iYXNlZCBjb21tYW5kc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWltcHJvdmUtd3JpdGluZycsXG5cdFx0XHRcdG5hbWU6ICdJbXByb3ZlIFdyaXRpbmcnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVTZWxlY3Rpb25Db21tYW5kKCdpbXByb3ZlJywgZWRpdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1tYWtlLWxvbmdlcicsXG5cdFx0XHRcdG5hbWU6ICdNYWtlIExvbmdlcicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ2xvbmdlcicsIGVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtbWFrZS1zaG9ydGVyJyxcblx0XHRcdFx0bmFtZTogJ01ha2UgU2hvcnRlcicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ3Nob3J0ZXInLCBlZGl0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gSW5kaXZpZHVhbCB0b25lIGNvbW1hbmRzXG5cdFx0XHRUT05FX09QVElPTlMuZm9yRWFjaCh0b25lID0+IHtcblx0XHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0XHRpZDogYG5vdmEtbWFrZS0ke3RvbmUuaWR9YCxcblx0XHRcdFx0XHRuYW1lOiBgTWFrZSAke3RvbmUubGFiZWx9YCxcblx0XHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVRvbmVDb21tYW5kKHRvbmUuaWQsIGVkaXRvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtdGVsbC1ub3ZhJyxcblx0XHRcdFx0bmFtZTogJ1RlbGwgTm92YS4uLicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ2N1c3RvbScsIGVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ29wZW4tbm92YS1zaWRlYmFyJyxcblx0XHRcdFx0bmFtZTogJ09wZW4gc2lkZWJhcicsXG5cdFx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgc2VsZWN0aW9uIGNvbnRleHQgbWVudVxuXHRcdFx0dGhpcy5zZWxlY3Rpb25Db250ZXh0TWVudSA9IG5ldyBTZWxlY3Rpb25Db250ZXh0TWVudSh0aGlzLmFwcCwgdGhpcyk7XG5cdFx0XHR0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51LnJlZ2lzdGVyKCk7XG5cblx0XHRcdHRoaXMuc2V0dGluZ1RhYiA9IG5ldyBOb3ZhU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcyk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKHRoaXMuc2V0dGluZ1RhYik7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHR9XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcblx0fVxuXG5cdGFzeW5jIGFjdGl2YXRlVmlldygpIHtcblx0XHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gdGhpcy5hcHA7XG5cblx0XHRsZXQgbGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGw7XG5cdFx0Y29uc3QgbGVhdmVzID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblxuXHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0bGVhZiA9IGxlYXZlc1swXTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuXHRcdFx0YXdhaXQgbGVhZj8uc2V0Vmlld1N0YXRlKHsgdHlwZTogVklFV19UWVBFX05PVkFfU0lERUJBUiwgYWN0aXZlOiB0cnVlIH0pO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYhKTtcblx0XHRcblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgdG8gc2lkZWJhciB2aWV3XG5cdFx0aWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBOb3ZhU2lkZWJhclZpZXcpIHtcblx0XHRcdHRoaXMuc2lkZWJhclZpZXcgPSBsZWFmLnZpZXc7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBzZWxlY3Rpb24tYmFzZWQgY29tbWFuZHNcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlU2VsZWN0aW9uQ29tbWFuZChhY3Rpb25JZDogc3RyaW5nLCBlZGl0b3I6IEVkaXRvcik6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBzZWxlY3RlZFRleHQgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG5cdFx0XHRpZiAoIXNlbGVjdGVkVGV4dCB8fCBzZWxlY3RlZFRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdQbGVhc2Ugc2VsZWN0IHNvbWUgdGV4dCBmaXJzdCcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGF3YWl0IHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKGFjdGlvbklkLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyBOb3ZhIHNlbGVjdGlvbiBjb21tYW5kOicsIGVycm9yKTtcblx0XHRcdG5ldyBOb3RpY2UoJ0ZhaWxlZCB0byBleGVjdXRlIE5vdmEgYWN0aW9uLiBQbGVhc2UgdHJ5IGFnYWluLicsIDMwMDApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgdG9uZS1zcGVjaWZpYyBjb21tYW5kc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVUb25lQ29tbWFuZCh0b25lSWQ6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXHRcdFx0aWYgKCFzZWxlY3RlZFRleHQgfHwgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCBzb21lIHRleHQgZmlyc3QnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDYWxsIGhhbmRsZVNlbGVjdGlvbkFjdGlvbiB3aXRoIHRvbmUgYWN0aW9uIGFuZCB0aGUgc3BlY2lmaWMgdG9uZVxuXHRcdFx0YXdhaXQgdGhpcy5zZWxlY3Rpb25Db250ZXh0TWVudS5oYW5kbGVTZWxlY3Rpb25BY3Rpb24oJ3RvbmUnLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCwgdG9uZUlkKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIE5vdmEgdG9uZSBjb21tYW5kOicsIGVycm9yKTtcblx0XHRcdG5ldyBOb3RpY2UoJ0ZhaWxlZCB0byBleGVjdXRlIE5vdmEgYWN0aW9uLiBQbGVhc2UgdHJ5IGFnYWluLicsIDMwMDApO1xuXHRcdH1cblx0fVxuXG5cblx0LyoqXG5cdCAqIFNob3cgdXBncmFkZSBwcm9tcHQgZm9yIENvcmUgdGllciBtb2JpbGUgdXNlcnNcblx0ICovXG5cdHByaXZhdGUgc2hvd01vYmlsZVVwZ3JhZGVQcm9tcHQoKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRtb2RhbC5jbGFzc05hbWUgPSAnbW9kYWwgbm92YS1tb2JpbGUtdXBncmFkZS1tb2RhbCc7XG5cdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYmdcIj48L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHQ8aDM+Tm92YSBTdXBlck5vdmEgUmVxdWlyZWQ8L2gzPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aWVyLWJhZGdlIGNvcmVcIiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDFlbTtcIj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLWljb25cIj5GUkVFPC9zcGFuPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItbmFtZVwiPkNvcmUgKEZyZWUpPC9zcGFuPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8cD5Nb2JpbGUgYWNjZXNzIGlzIGF2YWlsYWJsZSB3aXRoIE5vdmEgU3VwZXJOb3ZhLjwvcD5cblx0XHRcdFx0XHRcdDxwPkNvcmUgdGllciBpcyBsaW1pdGVkIHRvIGRlc2t0b3AgdXNlIG9ubHkuPC9wPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtZmVhdHVyZS1saXN0XCI+XG5cdFx0XHRcdFx0XHRcdDxoND5TdXBlck5vdmEgaW5jbHVkZXM6PC9oND5cblx0XHRcdFx0XHRcdFx0PHVsPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Nb2JpbGUgZGV2aWNlIHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5NdWx0aXBsZSBBSSBwcm92aWRlcnM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Jbi1jaGF0IHByb3ZpZGVyIHN3aXRjaGluZzwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkFkdmFuY2VkIHRlbXBsYXRlczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS11cGdyYWRlLWJ0blwiPlVwZ3JhZGUgdG8gU3VwZXJOb3ZhPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jbG9zZS1idG5cIj5DbG9zZTwvYnV0dG9uPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHRjb25zdCB1cGdyYWRlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtdXBncmFkZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBjbG9zZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNsb3NlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IG1vZGFsQmcgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYmcnKSBhcyBIVE1MRWxlbWVudDtcblxuXHRcdGNvbnN0IGNsb3NlTW9kYWwgPSAoKSA9PiB7XG5cdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHR9O1xuXG5cdFx0dXBncmFkZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHdpbmRvdy5vcGVuKCdodHRwczovL25vdmF3cml0ZXIuYWkvdXBncmFkZScsICdfYmxhbmsnKTtcblx0XHRcdGNsb3NlTW9kYWwoKTtcblx0XHR9KTtcblxuXHRcdGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cdFx0bW9kYWxCZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cblx0XHQvLyBTaG93IG5vdGljZSBhcyB3ZWxsXG5cdFx0bmV3IE5vdGljZSgnTm92YSBtb2JpbGUgYWNjZXNzIHJlcXVpcmVzIFN1cGVyTm92YSBsaWNlbnNlJywgODAwMCk7XG5cdH1cblxuXHQvLyBEYXRhU3RvcmUgaW50ZXJmYWNlIGltcGxlbWVudGF0aW9uIGZvciBDb252ZXJzYXRpb25NYW5hZ2VyXG5cdGFzeW5jIGxvYWREYXRhV2l0aEtleShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcblx0XHRyZXR1cm4gYWxsRGF0YSA/IGFsbERhdGFba2V5XSA6IHVuZGVmaW5lZDtcblx0fVxuXG5cdGFzeW5jIHNhdmVEYXRhV2l0aEtleShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKSB8fCB7fTtcblx0XHRhbGxEYXRhW2tleV0gPSBkYXRhO1xuXHRcdHJldHVybiBhd2FpdCB0aGlzLnNhdmVEYXRhKGFsbERhdGEpO1xuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXJTZXR0aW5ncywgUGxhdGZvcm1TZXR0aW5ncywgUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi9haS90eXBlcyc7XG5pbXBvcnQgeyBEZWJ1Z1NldHRpbmdzIH0gZnJvbSAnLi9saWNlbnNpbmcvdHlwZXMnO1xuaW1wb3J0IHsgVklFV19UWVBFX05PVkFfU0lERUJBUiwgTm92YVNpZGViYXJWaWV3IH0gZnJvbSAnLi91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgZ2V0QXZhaWxhYmxlTW9kZWxzIH0gZnJvbSAnLi9haS9tb2RlbHMnO1xuXG5jb25zdCBOT1ZBX0lDT05fU1ZHID0gYFxuPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XG4gIDwhLS0gQ2VudHJhbCBzdGFyIGNvcmUgLS0+XG4gIDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cbiAgXG4gIDwhLS0gUHJpbWFyeSByYXlzICg0IG1haW4gZGlyZWN0aW9ucykgLS0+XG4gIDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICBcbiAgPCEtLSBTZWNvbmRhcnkgcmF5cyAoZGlhZ29uYWxzKSAtLT5cbiAgPHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbjwvc3ZnPmA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tQ29tbWFuZCB7XG5cdGlkOiBzdHJpbmc7XG5cdG5hbWU6IHN0cmluZztcblx0dHJpZ2dlcjogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3ZhU2V0dGluZ3Mge1xuXHRhaVByb3ZpZGVyczogQUlQcm92aWRlclNldHRpbmdzO1xuXHRwbGF0Zm9ybVNldHRpbmdzOiBQbGF0Zm9ybVNldHRpbmdzO1xuXHRjdXN0b21Db21tYW5kcz86IEN1c3RvbUNvbW1hbmRbXTtcblx0Z2VuZXJhbDoge1xuXHRcdGRlZmF1bHRUZW1wZXJhdHVyZTogbnVtYmVyO1xuXHRcdGRlZmF1bHRNYXhUb2tlbnM6IG51bWJlcjtcblx0XHRhdXRvU2F2ZTogYm9vbGVhbjtcblx0fTtcblx0c2hvd0NvbW1hbmRCdXR0b246IGJvb2xlYW47XG5cdGxpY2Vuc2luZzoge1xuXHRcdGxpY2Vuc2VLZXk6IHN0cmluZztcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5Pzogc3RyaW5nO1xuXHRcdGlzU3VwZXJub3ZhPzogYm9vbGVhbjtcblx0XHRkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzO1xuXHR9O1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTm92YVNldHRpbmdzID0ge1xuXHRhaVByb3ZpZGVyczoge1xuXHRcdGNsYXVkZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0b3BlbmFpOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0YmFzZVVybDogJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnLFxuXHRcdFx0bW9kZWw6ICdncHQtNG8nLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0Z29vZ2xlOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0bW9kZWw6ICdnZW1pbmktMS41LWZsYXNoJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9sbGFtYToge1xuXHRcdFx0YmFzZVVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuXHRcdFx0bW9kZWw6ICcnLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH1cblx0fSxcblx0cGxhdGZvcm1TZXR0aW5nczoge1xuXHRcdGRlc2t0b3A6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ29sbGFtYScsXG5cdFx0XHRmYWxsYmFja1Byb3ZpZGVyczogWydvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0fSxcblx0XHRtb2JpbGU6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ25vbmUnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZSddXG5cdFx0fVxuXHR9LFxuXHRjdXN0b21Db21tYW5kczogW10sXG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IDAuNyxcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiAxMDAwLFxuXHRcdGF1dG9TYXZlOiB0cnVlXG5cdH0sXG5cdHNob3dDb21tYW5kQnV0dG9uOiB0cnVlLFxuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiAnJyxcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5OiAnJyxcblx0XHRpc1N1cGVybm92YTogZmFsc2UsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRvdmVycmlkZURhdGU6IHVuZGVmaW5lZCxcblx0XHRcdGZvcmNlU3VwZXJub3ZhOiBmYWxzZVxuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGNsYXNzIE5vdmFTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnTm92YSBBSSBTZXR0aW5ncycgfSk7XG5cblx0XHR0aGlzLmNyZWF0ZUxpY2Vuc2VTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlR2VuZXJhbFNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQbGF0Zm9ybVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlclNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kU2V0dGluZ3MoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlTGljZW5zZVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29uc3QgbGljZW5zZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zZWN0aW9uJyB9KTtcblx0XHRsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1N1cGVybm92YSBTdXBwb3J0ZXIgU3RhdHVzJyB9KTtcblxuXHRcdC8vIEluZm8gYWJvdXQgdGhlIG5ldyBtb2RlbFxuXHRcdGNvbnN0IGluZm9FbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tb2RlbC1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkIGNvbXBhY3RcIj5cblx0XHRcdFx0PHA+Tm92YSBwcm92aWRlcyBhbGwgZmVhdHVyZXMgZm9yIGZyZWUgd2hlbiB5b3UgdXNlIHlvdXIgb3duIEFJIHByb3ZpZGVyIEFQSSBrZXlzLiBcblx0XHRcdFx0U3VwZXJub3ZhIHN1cHBvcnRlcnMgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmlzU3VwZXJub3ZhU3VwcG9ydGVyKCkgfHwgZmFsc2U7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhTGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRTdXBlcm5vdmFMaWNlbnNlKCk7XG5cdFx0XG5cdFx0Y29uc3Qgc3RhdHVzRGlzcGxheSA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdXBlcm5vdmEtc3RhdHVzJyB9KTtcblx0XHRjb25zdCBzdGF0dXNUZXh0ID0gaXNTdXBlcm5vdmEgPyAnU3VwZXJub3ZhIFN1cHBvcnRlcicgOiAnTm92YSBVc2VyJztcblx0XHRjb25zdCBzdGF0dXNJY29uID0gaXNTdXBlcm5vdmEgPyBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3R5bGU9XCJ3aWR0aDogMTRweDsgaGVpZ2h0OiAxNHB4OyBjb2xvcjogIzkzMzNlYTsgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgNHB4IHJnYmEoMTQ3LCA1MSwgMjM0LCAwLjYpKTtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5gIDogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0eWxlPVwid2lkdGg6IDE0cHg7IGhlaWdodDogMTRweDsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj5cblx0XHRcdCR7Tk9WQV9JQ09OX1NWR31cblx0XHQ8L3N2Zz5gO1xuXHRcdHN0YXR1c0Rpc3BsYXkuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3RhdHVzLWJhZGdlICR7aXNTdXBlcm5vdmEgPyAnc3VwZXJub3ZhJyA6ICdub3ZhJ31cIj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJzdGF0dXMtaWNvblwiPiR7c3RhdHVzSWNvbn08L3NwYW4+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLW5hbWVcIj4ke3N0YXR1c1RleHR9PC9zcGFuPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIHN0YXR1c1xuXHRcdGlmIChzdXBlcm5vdmFMaWNlbnNlKSB7XG5cdFx0XHRjb25zdCBzdGF0dXNFbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXN0YXR1cycgfSk7XG5cdFx0XHRjb25zdCBleHBpcnlUZXh0ID0gc3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQgXG5cdFx0XHRcdD8gYEV4cGlyZXM6ICR7c3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdFx0XHQ6ICdMaWZldGltZSBTdXBwb3J0Jztcblx0XHRcdHN0YXR1c0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cImxpY2Vuc2UtaW5mb1wiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1lbWFpbFwiPiR7c3VwZXJub3ZhTGljZW5zZS5lbWFpbH08L3NwYW4+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJsaWNlbnNlLWV4cGlyeVwiPiR7ZXhwaXJ5VGV4dH08L3NwYW4+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHR9XG5cblx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgaW5wdXRcblx0XHRuZXcgU2V0dGluZyhsaWNlbnNlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1N1cGVybm92YSBMaWNlbnNlIEtleSAoT3B0aW9uYWwpJylcblx0XHRcdC5zZXREZXNjKCdFbnRlciB5b3VyIFN1cGVybm92YSBzdXBwb3J0ZXIgbGljZW5zZSBrZXkgZm9yIGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3Bhc3N3b3JkJztcblx0XHRcdFx0dGV4dC5zZXRQbGFjZWhvbGRlcignRW50ZXIgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5Li4uJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgU3VwZXJub3ZhIGxpY2Vuc2UgaW4gZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBkaXNwbGF5IHRvIHNob3cgdXBkYXRlZCBzdGF0dXNcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gQWRkIHZhbGlkYXRpb24gYnV0dG9uXG5cdFx0XHRcdGNvbnN0IHZhbGlkYXRlQnV0dG9uID0gdGV4dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/LmNyZWF0ZUVsKCdidXR0b24nLCB7XG5cdFx0XHRcdFx0dGV4dDogJ1ZhbGlkYXRlJyxcblx0XHRcdFx0XHRjbHM6ICdub3ZhLXZhbGlkYXRlLWJ0bidcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAodmFsaWRhdGVCdXR0b24pIHtcblx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IGxpY2Vuc2VLZXkgPSB0ZXh0LmlucHV0RWwudmFsdWU7XG5cdFx0XHRcdFx0XHRpZiAoIWxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1BsZWFzZSBlbnRlciBhIFN1cGVybm92YSBsaWNlbnNlIGtleSBmaXJzdC4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdWYWxpZGF0aW5nLi4uJztcblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzU3VwZXJub3ZhU3VwcG9ydGVyKCk7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnVmFsaWQgU3VwZXJub3ZhIGxpY2Vuc2UhIFlvdSBub3cgaGF2ZSBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLicsICdzdWNjZXNzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dDb25mZXR0aSgpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnSW52YWxpZCBvciBleHBpcmVkIFN1cGVybm92YSBsaWNlbnNlIGtleS4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdFcnJvciB2YWxpZGF0aW5nIFN1cGVybm92YSBsaWNlbnNlLicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24udGV4dENvbnRlbnQgPSAnVmFsaWRhdGUnO1xuXHRcdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdC8vIFN1cGVybm92YSBzdXBwb3J0ZXIgaW5mb3JtYXRpb24gb25seVxuXHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhSW5mbyhsaWNlbnNlQ29udGFpbmVyKTtcblxuXHRcdC8vIERlYnVnIHNldHRpbmdzIChkZXZlbG9wbWVudCBvbmx5KVxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyB8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHR0aGlzLmNyZWF0ZURlYnVnU2V0dGluZ3MobGljZW5zZUNvbnRhaW5lcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFJbmZvKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBTdXBlcm5vdmEgc3VwcG9ydGVyIGluZm9ybWF0aW9uXG5cdFx0Y29uc3Qgc3VwZXJub3ZhSW5mbyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1cGVybm92YS1pbmZvJyB9KTtcblx0XHRzdXBlcm5vdmFJbmZvLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDU+QmVjb21lIGEgU3VwZXJub3ZhIFN1cHBvcnRlcjwvaDU+XG5cdFx0XHRcdDxwPlN1cHBvcnQgTm92YSBkZXZlbG9wbWVudCBhbmQgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuIEFsbCBmZWF0dXJlcyBldmVudHVhbGx5IGJlY29tZSBmcmVlIGZvciBldmVyeW9uZS48L3A+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+RWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcyAoMy02IG1vbnRocyBiZWZvcmUgZ2VuZXJhbCByZWxlYXNlKTwvbGk+XG5cdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQgYW5kIGZlYXR1cmUgcmVxdWVzdHM8L2xpPlxuXHRcdFx0XHRcdDxsaT5TdXBwb3J0ZXIgYmFkZ2UgYW5kIHJlY29nbml0aW9uPC9saT5cblx0XHRcdFx0XHQ8bGk+RGlyZWN0bHkgc3VwcG9ydCBvcGVuLXNvdXJjZSBkZXZlbG9wbWVudDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1NldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBkZWJ1Z0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0RldmVsb3BtZW50IFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0RlYnVnIE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXZlbG9wbWVudCB0ZXN0aW5nIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIGRlYnVnIG9wdGlvbnNcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnT3ZlcnJpZGUgRGF0ZScpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBjdXJyZW50IGRhdGUgZm9yIHRlc3RpbmcgdGltZS1nYXRlZCBmZWF0dXJlcyAoWVlZWS1NTS1ERCknKVxuXHRcdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzIwMjUtMTItMDEnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgcmVmcmVzaCBkaXNwbGF5IG9uIGV2ZXJ5IGtleXN0cm9rZSAtIGp1c3QgdXBkYXRlIHRoZSBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnRm9yY2UgU3VwZXJub3ZhIFN0YXR1cycpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBTdXBlcm5vdmEgc3VwcG9ydGVyIHN0YXR1cyBmb3IgdGVzdGluZycpXG5cdFx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSB8fCBmYWxzZSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gU2hvdyBjb25mZXR0aSB3aGVuIHR1cm5pbmcgT04gRm9yY2UgU3VwZXJub3ZhXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93Q29uZmV0dGkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdyB1cGRhdGVkIGZlYXR1cmUgc3RhdHVzXG5cdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdC8vIENsZWFyIGxpY2Vuc2VzIGJ1dHRvblxuXHRcdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKCdDbGVhciBBbGwgTGljZW5zZXMnKVxuXHRcdFx0XHQuc2V0RGVzYygnUmVtb3ZlIGFsbCBhcHBsaWVkIGxpY2Vuc2VzIChmb3IgdGVzdGluZyknKVxuXHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgTGljZW5zZXMnKVxuXHRcdFx0XHRcdC5zZXRXYXJuaW5nKClcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBDb25maXJtIGFjdGlvblxuXHRcdFx0XHRcdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBsaWNlbnNlcz8gVGhpcyB3aWxsIHJlbW92ZSBhbnkgYXBwbGllZCBTdXBlcm5vdmEgbGljZW5zZS4nKTtcblx0XHRcdFx0XHRcdGlmICghY29uZmlybWVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdC8vIENsZWFyIGxpY2Vuc2Uga2V5XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9ICcnO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBDbGVhciBGb3JjZSBTdXBlcm5vdmEgaWYgZW5hYmxlZFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShudWxsKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhclxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuXHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0FsbCBsaWNlbnNlcyBjbGVhcmVkIHN1Y2Nlc3NmdWxseS4nLCAnc3VjY2VzcycpO1xuXG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXlcblx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdH0pKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dMaWNlbnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIHR5cGU6ICdzdWNjZXNzJyB8ICdlcnJvcicpIHtcblx0XHQvLyBDcmVhdGUgb3IgdXBkYXRlIG1lc3NhZ2UgZWxlbWVudFxuXHRcdGNvbnN0IGV4aXN0aW5nTWVzc2FnZSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtbGljZW5zZS1tZXNzYWdlJyk7XG5cdFx0aWYgKGV4aXN0aW5nTWVzc2FnZSkge1xuXHRcdFx0ZXhpc3RpbmdNZXNzYWdlLnJlbW92ZSgpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgXG5cdFx0XHRjbHM6IGBub3ZhLWxpY2Vuc2UtbWVzc2FnZSAke3R5cGV9YCxcblx0XHRcdHRleHQ6IG1lc3NhZ2Vcblx0XHR9KTtcblxuXHRcdC8vIEF1dG8tcmVtb3ZlIGFmdGVyIDUgc2Vjb25kc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0bWVzc2FnZUVsLnJlbW92ZSgpO1xuXHRcdH0sIDUwMDApO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29uZmV0dGkoKSB7XG5cdFx0Ly8gQ3JlYXRlIGNvbmZldHRpIGNvbnRhaW5lclxuXHRcdGNvbnN0IGNvbmZldHRpQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0Y29uZmV0dGlDb250YWluZXIuY2xhc3NOYW1lID0gJ25vdmEtY29uZmV0dGktY29udGFpbmVyJztcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbmZldHRpQ29udGFpbmVyKTtcblxuXHRcdC8vIEdldCBzZXR0aW5ncyBjb250YWluZXIgcG9zaXRpb24gZm9yIGV4cGxvc2lvbiBjZW50ZXJcblx0XHRjb25zdCByZWN0ID0gdGhpcy5jb250YWluZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRjb25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7XG5cdFx0Y29uc3QgY2VudGVyWSA9IHJlY3QudG9wICsgTWF0aC5taW4ocmVjdC5oZWlnaHQgLyAyLCAzMDApO1xuXG5cdFx0Ly8gQ29sb3JzIGZvciBjb25mZXR0aVxuXHRcdGNvbnN0IGNvbG9ycyA9IFsnZ29sZCcsICdibHVlJywgJ3BpbmsnLCAnZ3JlZW4nLCAncmVkJywgJyddOyAgLy8gZW1wdHkgc3RyaW5nID0gZGVmYXVsdCBwdXJwbGVcblxuXHRcdC8vIENyZWF0ZSBjb25mZXR0aSBwaWVjZXNcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7XG5cdFx0XHRjb25zdCBjb25mZXR0aSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0Y29uZmV0dGkuY2xhc3NOYW1lID0gYG5vdmEtY29uZmV0dGktcGllY2UgJHtjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldfWA7XG5cdFx0XHRcblx0XHRcdC8vIFBvc2l0aW9uIGF0IGV4cGxvc2lvbiBjZW50ZXJcblx0XHRcdGNvbmZldHRpLnN0eWxlLmxlZnQgPSBgJHtjZW50ZXJYfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLnRvcCA9IGAke2NlbnRlcll9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgZXhwbG9zaW9uIHRyYWplY3Rvcnlcblx0XHRcdGNvbnN0IGFuZ2xlID0gKE1hdGguUEkgKiAyICogaSkgLyAxNTAgKyAoTWF0aC5yYW5kb20oKSAqIDAuMiAtIDAuMSk7XG5cdFx0XHRjb25zdCB2ZWxvY2l0eSA9IDI1MCArIE1hdGgucmFuZG9tKCkgKiAzNTA7IC8vIHBpeGVsc1xuXHRcdFx0Y29uc3QgZXhwbG9kZVggPSBNYXRoLmNvcyhhbmdsZSkgKiB2ZWxvY2l0eTtcblx0XHRcdGNvbnN0IGV4cGxvZGVZID0gTWF0aC5zaW4oYW5nbGUpICogdmVsb2NpdHkgLSAxNTA7IC8vIFN0cm9uZyB1cHdhcmQgYmlhc1xuXHRcdFx0XG5cdFx0XHQvLyBTZXQgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzIGZvciBhbmltYXRpb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLnNldFByb3BlcnR5KCctLWV4cGxvZGUteCcsIGAke2V4cGxvZGVYfXB4YCk7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1leHBsb2RlLXknLCBgJHtleHBsb2RlWX1weGApO1xuXHRcdFx0XG5cdFx0XHQvLyBSYW5kb20gZGVsYXkgZm9yIHN0YWdnZXJlZCBleHBsb3Npb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gYCR7TWF0aC5yYW5kb20oKSAqIDAuMn1zYDtcblx0XHRcdFxuXHRcdFx0Ly8gUmFuZG9tIHNpemVcblx0XHRcdGNvbnN0IHNpemUgPSA2ICsgTWF0aC5yYW5kb20oKSAqIDE0O1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUud2lkdGggPSBgJHtzaXplfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemV9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBNYWtlIHNvbWUgY29uZmV0dGkgcmVjdGFuZ3VsYXJcblx0XHRcdGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG5cdFx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemUgKiAwLjR9cHhgO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb25mZXR0aSk7XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGNvbnRhaW5lciBhZnRlciBhbmltYXRpb24gY29tcGxldGVzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5yZW1vdmUoKTtcblx0XHR9LCA0MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR2VuZXJhbFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnR2VuZXJhbCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IFRlbXBlcmF0dXJlJylcblx0XHRcdC5zZXREZXNjKCdDb250cm9scyByYW5kb21uZXNzIGluIEFJIHJlc3BvbnNlcyAoMC4wIC0gMS4wKScpXG5cdFx0XHQuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcblx0XHRcdFx0LnNldExpbWl0cygwLCAxLCAwLjEpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSlcblx0XHRcdFx0LnNldER5bmFtaWNUb29sdGlwKClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgTWF4IFRva2VucycpXG5cdFx0XHQuc2V0RGVzYygnTWF4aW11bSBsZW5ndGggb2YgQUkgcmVzcG9uc2VzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzEwMDAnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zLnRvU3RyaW5nKCkpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zdCBudW1WYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcblx0XHRcdFx0XHRpZiAoIWlzTmFOKG51bVZhbHVlKSAmJiBudW1WYWx1ZSA+IDApIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2VucyA9IG51bVZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdBdXRvLXNhdmUgc2V0dGluZ3MnKVxuXHRcdFx0LnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgc2F2ZSBzZXR0aW5ncyB3aGVuIGNoYW5nZWQnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5hdXRvU2F2ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb2xsYXBzaWJsZSBoZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29sbGFwc2libGUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiA4cHggMDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAxNnB4O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgYXJyb3dFbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWFycm93JyB9KTtcblx0XHRhcnJvd0VsLmlubmVySFRNTCA9ICdcdTI1QjYnO1xuXHRcdGFycm93RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRcdGZvbnQtc2l6ZTogMTJweDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdBSSBQcm92aWRlciBTZXR0aW5ncycgfSk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZmxleDogMTsnO1xuXG5cdFx0Y29uc3QgcHJvdmlkZXJDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdHByb3ZpZGVyQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogbm9uZTsnOyAvLyBTdGFydCBjb2xsYXBzZWRcblx0XHRcblx0XHQvLyBUb2dnbGUgZnVuY3Rpb25hbGl0eVxuXHRcdGhlYWRlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgaXNWaXNpYmxlID0gcHJvdmlkZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuXHRcdFx0cHJvdmlkZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXG5cdFx0Ly8gSW5mbyBhYm91dCBBUEkga2V5cyBhbmQgbW9kZWwgcmVjb21tZW5kYXRpb25zXG5cdFx0Y29uc3QgaW5mb0VsID0gcHJvdmlkZXJDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5Db25maWd1cmUgWW91ciBBUEkgS2V5czwvaDQ+XG5cdFx0XHRcdDxwPk5vdmEgY29ubmVjdHMgdG8gQUkgcHJvdmlkZXJzIHVzaW5nIHlvdXIgb3duIEFQSSBrZXlzLiBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIC0gXG5cdFx0XHRcdGp1c3QgYWRkIHlvdXIgQVBJIGtleXMgYmVsb3cgdG8gZ2V0IHN0YXJ0ZWQuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmQgbm92YS1tb2RlbC1ndWlkYW5jZVwiPlxuXHRcdFx0XHQ8aDQ+UmVjb21tZW5kZWQgRGVmYXVsdHM8L2g0PlxuXHRcdFx0XHQ8dWwgY2xhc3M9XCJub3ZhLW1vZGVsLXJlY29tbWVuZGF0aW9uc1wiPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkNsYXVkZSBTb25uZXQgNDwvc3Ryb25nPiAtIExhdGVzdCBnZW5lcmF0aW9uIHdpdGggZXhjZWxsZW50IGluc3RydWN0aW9uIGZvbGxvd2luZyBmb3IgY29sbGFib3JhdGl2ZSBlZGl0aW5nPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HUFQtNC4xIE1pbmk8L3N0cm9uZz4gLSBDdXJyZW50LWdlbmVyYXRpb24gbW9kZWwgdGhhdCBvdXRwZXJmb3JtcyBHUFQtNG8gd2hpbGUgcmVtYWluaW5nIGNvc3QtZWZmZWN0aXZlPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HZW1pbmkgMi41IEZsYXNoPC9zdHJvbmc+IC0gQmVzdCBwcmljZS9wZXJmb3JtYW5jZSB3aXRoIFwidGhpbmtpbmdcIiBjYXBhYmlsaXRpZXMgYW5kIHN0cm9uZyBjb2Rpbmcgc3VwcG9ydDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHRcdDxwIGNsYXNzPVwibm92YS1ndWlkYW5jZS1ub3RlXCI+VGhlc2UgZGVmYXVsdHMgb2ZmZXIgbW9kZXJuIEFJIGNhcGFiaWxpdGllcyB3aXRob3V0IHByZW1pdW0gcHJpY2luZy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gU2hvdyBhbGwgcHJvdmlkZXJzIC0gbm8gcmVzdHJpY3Rpb25zXG5cdFx0dGhpcy5jcmVhdGVPbGxhbWFTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVDbGF1ZGVTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVHb29nbGVTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVPcGVuQUlTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNsYXVkZVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IGNsYXVkZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0Y2xhdWRlQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NsYXVkZSAoQW50aHJvcGljKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjbGF1ZGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBBbnRocm9waWMgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay1hbnQtLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIE1vZGVsIHNldHRpbmcgd2l0aCByZWZyZXNoIGJ1dHRvblxuXHRcdGNvbnN0IG1vZGVsU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNsYXVkZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnQ2xhdWRlIG1vZGVsIHRvIHVzZScpO1xuXG5cdFx0bGV0IG1vZGVsRHJvcGRvd246IGFueTtcblx0XHRcblx0XHRtb2RlbFNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0bW9kZWxEcm9wZG93biA9IGRyb3Bkb3duO1xuXHRcdFx0dGhpcy5wb3B1bGF0ZUNsYXVkZU1vZGVscyhkcm9wZG93bik7XG5cdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5tb2RlbCB8fCAnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0Jylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIENsYXVkZSBtb2RlbHMgYXJlIGhhcmRjb2RlZCAtIG5vIHJlZnJlc2ggbmVlZGVkXG5cdH1cblxuXHRwcml2YXRlIHBvcHVsYXRlQ2xhdWRlTW9kZWxzKGRyb3Bkb3duOiBhbnkpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG5cdFx0ZHJvcGRvd24uc2VsZWN0RWwuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBVc2UgY2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnNcblx0XHRjb25zdCBjdXJyZW50TW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzKCdjbGF1ZGUnKTtcblxuXHRcdGN1cnJlbnRNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTtcblx0XHR9KTtcblx0fVxuXG5cblxuXHRwcml2YXRlIGNyZWF0ZU9wZW5BSVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IG9wZW5haUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0b3BlbmFpQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NoYXRHUFQgKE9wZW5BSSknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgT3BlbkFJIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignc2stLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIE1vZGVsIHNldHRpbmcgd2l0aCByZWZyZXNoIGJ1dHRvblxuXHRcdGNvbnN0IG1vZGVsU2V0dGluZyA9IG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT3BlbkFJIG1vZGVsIHRvIHVzZScpO1xuXG5cdFx0bGV0IG1vZGVsRHJvcGRvd246IGFueTtcblx0XHRcblx0XHRtb2RlbFNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0bW9kZWxEcm9wZG93biA9IGRyb3Bkb3duO1xuXHRcdFx0dGhpcy5wb3B1bGF0ZU9wZW5BSU1vZGVscyhkcm9wZG93bik7XG5cdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCB8fCAnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gT3BlbkFJIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVPcGVuQUlNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ29wZW5haScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHb29nbGVTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRcblx0XHRjb25zdCBnb29nbGVDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdGdvb2dsZUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdHb29nbGUgKEdlbWluaSknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgR29vZ2xlIEFJIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignQUkuLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdHZW1pbmkgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHR0aGlzLnBvcHVsYXRlR29vZ2xlTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsIHx8ICdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gR29vZ2xlIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVHb29nbGVNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ2dvb2dsZScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVPbGxhbWFTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRjb25zdCBvbGxhbWFDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdG9sbGFtYUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdPbGxhbWEgKExvY2FsKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQmFzZSBVUkwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBzZXJ2ZXIgVVJMJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBtb2RlbCB0byB1c2UnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignbGxhbWEyJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUGxhdGZvcm0gU2V0dGluZ3MnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZsZXg6IDE7JztcblxuXHRcdGNvbnN0IHBsYXRmb3JtQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1zZWN0aW9uJyB9KTtcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IG5vbmU7JzsgLy8gU3RhcnQgY29sbGFwc2VkXG5cdFx0XG5cdFx0Ly8gVG9nZ2xlIGZ1bmN0aW9uYWxpdHlcblx0XHRoZWFkZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdGNvbnN0IGlzVmlzaWJsZSA9IHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpc1Zpc2libGUgPyAnbm9uZScgOiAnYmxvY2snO1xuXHRcdFx0YXJyb3dFbC5zdHlsZS50cmFuc2Zvcm0gPSBpc1Zpc2libGUgPyAncm90YXRlKDBkZWcpJyA6ICdyb3RhdGUoOTBkZWcpJztcblx0XHR9KTtcblx0XHRcblx0XHQvLyBJbmZvIGFib3V0IHBsYXRmb3JtIHNldHRpbmdzXG5cdFx0Y29uc3QgaW5mb0VsID0gcGxhdGZvcm1Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5cdUQ4M0RcdUREQTVcdUZFMEYgUGxhdGZvcm0gQ29uZmlndXJhdGlvbjwvaDQ+XG5cdFx0XHRcdDxwPkNvbmZpZ3VyZSB3aGljaCBBSSBwcm92aWRlciB0byB1c2UgYXMgeW91ciBwcmltYXJ5IHByb3ZpZGVyIG9uIGRpZmZlcmVudCBwbGF0Zm9ybXMuIFxuXHRcdFx0XHROb3ZhIHdvcmtzIHNlYW1sZXNzbHkgYWNyb3NzIGRlc2t0b3AgYW5kIG1vYmlsZSB3aXRoIGFsbCBwcm92aWRlcnMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXNrdG9wJyB9KTtcblx0XHRjb25zdCBkZXNrdG9wRHJvcGRvd24gPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBkZXNrdG9wJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRcdGNvbnN0IGFsbG93ZWRQcm92aWRlcnMgPSB0aGlzLmdldEFsbG93ZWRQcm92aWRlcnNGb3JQbGF0Zm9ybSgnZGVza3RvcCcpO1xuXHRcdFx0XHRcblx0XHRcdFx0YWxsb3dlZFByb3ZpZGVycy5mb3JFYWNoKHByb3ZpZGVyID0+IHtcblx0XHRcdFx0XHRjb25zdCBsYWJlbCA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcik7XG5cdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHByb3ZpZGVyLCBsYWJlbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AucHJpbWFyeVByb3ZpZGVyID0gdmFsdWUgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdNb2JpbGUnIH0pO1xuXHRcdGNvbnN0IG1vYmlsZVNldHRpbmcgPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBtb2JpbGUgZGV2aWNlcycpO1xuXHRcdFx0XG5cdFx0bW9iaWxlU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0LmFkZE9wdGlvbignbm9uZScsICdOb25lIChEaXNhYmxlZCknKVxuXHRcdFx0LmFkZE9wdGlvbignY2xhdWRlJywgJ0NsYXVkZScpXG5cdFx0XHQuYWRkT3B0aW9uKCdvcGVuYWknLCAnT3BlbkFJJylcblx0XHRcdC5hZGRPcHRpb24oJ2dvb2dsZScsICdHb29nbGUnKVxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlcilcblx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKHBsYXRmb3JtOiAnZGVza3RvcCcgfCAnbW9iaWxlJyk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4gcGxhdGZvcm0gPT09ICdkZXNrdG9wJyBcblx0XHRcdD8gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdFx0OiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdH1cblxuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXI6IFByb3ZpZGVyVHlwZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbmFtZXM6IFJlY29yZDxQcm92aWRlclR5cGUsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ0NsYXVkZSAoQW50aHJvcGljKScsXG5cdFx0XHQnb3BlbmFpJzogJ0NoYXRHUFQgKE9wZW5BSSknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUgKEdlbWluaSknLCBcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hIChMb2NhbCknLFxuXHRcdFx0J25vbmUnOiAnTm9uZSAoRGlzYWJsZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIG5hbWVzW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcblx0fVxuXG5cdGFzeW5jIHNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0ucHJpbWFyeVByb3ZpZGVyID0gcHJvdmlkZXJJZCBhcyBQcm92aWRlclR5cGU7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBwcm92aWRlciBtYW5hZ2VyIHdpdGggbmV3IHNldHRpbmdzXG5cdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ3VzdG9tIENvbW1hbmRzJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmbGV4OiAxOyc7XG5cblx0XHRjb25zdCBjb21tYW5kQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXNlY3Rpb24nIH0pO1xuXHRcdGNvbW1hbmRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBub25lOyc7IC8vIFN0YXJ0IGNvbGxhcHNlZFxuXHRcdFxuXHRcdC8vIFRvZ2dsZSBmdW5jdGlvbmFsaXR5XG5cdFx0aGVhZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRjb25zdCBpc1Zpc2libGUgPSBjb21tYW5kQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdGNvbW1hbmRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXG5cdFx0Ly8gRmVhdHVyZSBhdmFpbGFiaWxpdHkgY2hlY2tcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IG5vdGljZUVsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWZlYXR1cmUtbm90aWNlJyB9KTtcblx0XHRcdG5vdGljZUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cInBhZGRpbmc6IDE2cHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBib3JkZXItcmFkaXVzOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcIj5cblx0XHRcdFx0XHQ8aDQgc3R5bGU9XCJtYXJnaW46IDAgMCA4cHggMDsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj5TdXBlcm5vdmEgU3VwcG9ydGVyIEZlYXR1cmU8L2g0PlxuXHRcdFx0XHRcdDxwIHN0eWxlPVwibWFyZ2luOiAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07XCI+XG5cdFx0XHRcdFx0XHRDdXN0b20gY29tbWFuZHMgYXJlIGN1cnJlbnRseSBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMuIFxuXHRcdFx0XHRcdFx0VGhleSB3aWxsIGJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgb24gPHN0cm9uZz5PY3RvYmVyIDEsIDIwMjU8L3N0cm9uZz4uXG5cdFx0XHRcdFx0PC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGVzY3JpcHRpb25cblx0XHRjb25zdCBkZXNjRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjcmlwdGlvbicgfSk7XG5cdFx0ZGVzY0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxwIHN0eWxlPVwiY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiAxNnB4O1wiPlxuXHRcdFx0XHRDcmVhdGUgY3VzdG9tIGNvbW1hbmQgc2hvcnRjdXRzIHRoYXQgaW5zZXJ0IHByZWRlZmluZWQgdGV4dCB0ZW1wbGF0ZXMgd2hlbiB0cmlnZ2VyZWQgd2l0aCA8Y29kZT46dHJpZ2dlcjwvY29kZT4uXG5cdFx0XHQ8L3A+XG5cdFx0YDtcblxuXHRcdC8vIFNob3cgQ29tbWFuZCBCdXR0b24gc2V0dGluZyAoU3VwZXJub3ZhLW9ubHksIE1vYmlsZS1vbmx5KVxuXHRcdG5ldyBTZXR0aW5nKGNvbW1hbmRDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnU2hvdyBDb21tYW5kIEJ1dHRvbiBpbiBDaGF0IChNb2JpbGUpJylcblx0XHRcdC5zZXREZXNjKCdTaG93IHRoZSBDb21tYW5kcyBidXR0b24gYmVzaWRlIHRoZSBTZW5kIGJ1dHRvbiBmb3IgbW9iaWxlIHF1aWNrIGFjY2VzcyB0byBOb3ZhIGNvbW1hbmRzIGFuZCBzZWxlY3Rpb24gYWN0aW9ucycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b24gPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBGaW5kIGFuZCByZWZyZXNoIHNpZGViYXIgdmlld1xuXHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gQWRkIG5ldyBjb21tYW5kIGJ1dHRvbiBhdCB0aGUgdG9wXG5cdFx0Y29uc3QgYnV0dG9uRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYWRkLWNvbW1hbmQnIH0pO1xuXHRcdGJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luLWJvdHRvbTogMTZweDsnO1xuXHRcdFxuXHRcdG5ldyBTZXR0aW5nKGJ1dHRvbkVsKVxuXHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gXG5cdFx0XHRcdGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCcrIEFkZCBDdXN0b20gQ29tbWFuZCcpXG5cdFx0XHRcdFx0LnNldEN0YSgpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5zaG93QWRkQ29tbWFuZERpYWxvZygpKVxuXHRcdFx0KTtcblxuXHRcdC8vIENvbW1hbmRzIGxpc3Rcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdChjb21tYW5kQ29udGFpbmVyKTtcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBjb21tYW5kcyBsaXN0XG5cdFx0Y29uc3QgZXhpc3RpbmdMaXN0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmRzLWxpc3QnKTtcblx0XHRpZiAoZXhpc3RpbmdMaXN0KSBleGlzdGluZ0xpc3QucmVtb3ZlKCk7XG5cblx0XHRjb25zdCBjb21tYW5kc0xpc3QgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kcy1saXN0JyB9KTtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXG5cdFx0aWYgKGNvbW1hbmRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Y29uc3QgZW1wdHlFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWVtcHR5JyB9KTtcblx0XHRcdGVtcHR5RWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAyNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XCI+XG5cdFx0XHRcdFx0PHA+Tm8gY3VzdG9tIGNvbW1hbmRzIHlldC48L3A+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJmb250LXNpemU6IDAuOWVtO1wiPkNyZWF0ZSB5b3VyIGZpcnN0IGNvbW1hbmQgdG8gZ2V0IHN0YXJ0ZWQhPC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGNvbW1hbmRFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRjb21tYW5kRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRcdHBhZGRpbmc6IDE2cHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDEycHg7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRgO1xuXG5cdFx0XHQvLyBDb21tYW5kIGhlYWRlclxuXHRcdFx0Y29uc3QgaGVhZGVyRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWhlYWRlcicgfSk7XG5cdFx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IG1hcmdpbi1ib3R0b206IDhweDsnO1xuXG5cdFx0XHRjb25zdCBpbmZvRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaW5mbycgfSk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGluZm9FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbmFtZScgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNjAwOyBtYXJnaW4tYm90dG9tOiA0cHg7JztcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC5pbm5lckhUTUwgPSBgPGNvZGU+OiR7Y29tbWFuZC50cmlnZ2VyfTwvY29kZT5gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gQWN0aW9uc1xuXHRcdFx0Y29uc3QgYWN0aW9uc0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWFjdGlvbnMnIH0pO1xuXHRcdFx0YWN0aW9uc0VsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7JztcblxuXHRcdFx0Y29uc3QgZWRpdEJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRWRpdCcgfSk7XG5cdFx0XHRlZGl0QnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4Oyc7XG5cdFx0XHRlZGl0QnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnNob3dFZGl0Q29tbWFuZERpYWxvZyhpbmRleCk7XG5cblx0XHRcdGNvbnN0IGRlbGV0ZUJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRGVsZXRlJyB9KTtcblx0XHRcdGRlbGV0ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGZvbnQtc2l6ZTogMC44ZW07IGJvcmRlci1yYWRpdXM6IDRweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvcik7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7Jztcblx0XHRcdGRlbGV0ZUJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5kZWxldGVDb21tYW5kKGluZGV4KTtcblxuXHRcdFx0Ly8gRGVzY3JpcHRpb24gYW5kIHRlbXBsYXRlIHByZXZpZXdcblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYycgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHRlbXBsYXRlRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRlbXBsYXRlJyB9KTtcblx0XHRcdHRlbXBsYXRlRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IHBhZGRpbmc6IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBmb250LXNpemU6IDAuOGVtOyB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7IG1heC1oZWlnaHQ6IDYwcHg7IG92ZXJmbG93LXk6IGF1dG87XCI+XG5cdFx0XHRcdFx0JHtjb21tYW5kLnRlbXBsYXRlfVxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dBZGRDb21tYW5kRGlhbG9nKCkge1xuXHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coKTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4OiBudW1iZXIpIHtcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHM/LltpbmRleF07XG5cdFx0aWYgKGNvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coY29tbWFuZCwgaW5kZXgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmREaWFsb2coZXhpc3RpbmdDb21tYW5kPzogQ3VzdG9tQ29tbWFuZCwgZWRpdEluZGV4PzogbnVtYmVyKSB7XG5cdFx0Ly8gRm9yIG5vdywgdXNlIGEgc2ltcGxlIHByb21wdC1iYXNlZCBhcHByb2FjaFxuXHRcdC8vIFRPRE86IEltcGxlbWVudCBwcm9wZXIgbW9kYWwgd2hlbiBNb2RhbCBjbGFzcyBpcyBwcm9wZXJseSBhdmFpbGFibGVcblx0XHRjb25zdCBuYW1lID0gcHJvbXB0KCdDb21tYW5kIG5hbWU6JywgZXhpc3RpbmdDb21tYW5kPy5uYW1lIHx8ICcnKTtcblx0XHRpZiAoIW5hbWUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCB0cmlnZ2VyID0gcHJvbXB0KCdDb21tYW5kIHRyaWdnZXIgKHdpdGhvdXQgOik6JywgZXhpc3RpbmdDb21tYW5kPy50cmlnZ2VyIHx8ICcnKTtcblx0XHRpZiAoIXRyaWdnZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBkZXNjcmlwdGlvbiA9IHByb21wdCgnRGVzY3JpcHRpb24gKG9wdGlvbmFsKTonLCBleGlzdGluZ0NvbW1hbmQ/LmRlc2NyaXB0aW9uIHx8ICcnKTtcblx0XHRcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IHByb21wdCgnVGVtcGxhdGUgY29udGVudDonLCBleGlzdGluZ0NvbW1hbmQ/LnRlbXBsYXRlIHx8ICcnKTtcblx0XHRpZiAoIXRlbXBsYXRlKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgcmVzdWx0OiBDdXN0b21Db21tYW5kID0ge1xuXHRcdFx0aWQ6IGV4aXN0aW5nQ29tbWFuZD8uaWQgfHwgKCdjbWRfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KSksXG5cdFx0XHRuYW1lLFxuXHRcdFx0dHJpZ2dlcjogdHJpZ2dlci50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0dGVtcGxhdGUsXG5cdFx0XHRkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgdW5kZWZpbmVkXG5cdFx0fTtcblx0XHRcblx0XHRpZiAoZWRpdEluZGV4ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdC8vIEVkaXQgZXhpc3RpbmcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzW2VkaXRJbmRleF0gPSByZXN1bHQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEFkZCBuZXcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzLnB1c2gocmVzdWx0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblxuXHRwcml2YXRlIGRlbGV0ZUNvbW1hbmQoaW5kZXg6IG51bWJlcikge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbaW5kZXhdO1xuXHRcdGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oYERlbGV0ZSBjb21tYW5kIFwiJHtjb21tYW5kLm5hbWV9XCIgKCR7Y29tbWFuZC50cmlnZ2VyfSk/YCk7XG5cdFx0XG5cdFx0aWYgKGNvbmZpcm1lZCkge1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmLCBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSwgTm90aWNlLCBNYXJrZG93blZpZXcsIFBsYXRmb3JtLCBzZXRJY29uLCBFZGl0b3JQb3NpdGlvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50QW5hbHl6ZXIgfSBmcm9tICcuLi9jb3JlL2RvY3VtZW50LWFuYWx5c2lzJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgfSBmcm9tICcuLi9jb3JlL3R5cGVzJztcbmltcG9ydCB7IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB9IGZyb20gJy4vd2lraWxpbmstc3VnZ2VzdCc7XG5pbXBvcnQgeyBNdWx0aURvY0NvbnRleHRIYW5kbGVyLCBNdWx0aURvY0NvbnRleHQgfSBmcm9tICcuLi9jb3JlL211bHRpLWRvYy1jb250ZXh0JztcbmltcG9ydCB7IGdldEF2YWlsYWJsZU1vZGVscyB9IGZyb20gJy4uL2FpL21vZGVscyc7XG5pbXBvcnQgeyBJbnB1dEhhbmRsZXIgfSBmcm9tICcuL2lucHV0LWhhbmRsZXInO1xuaW1wb3J0IHsgQ29tbWFuZFN5c3RlbSB9IGZyb20gJy4vY29tbWFuZC1zeXN0ZW0nO1xuaW1wb3J0IHsgQ29udGV4dE1hbmFnZXIgfSBmcm9tICcuL2NvbnRleHQtbWFuYWdlcic7XG5pbXBvcnQgeyBDaGF0UmVuZGVyZXIgfSBmcm9tICcuL2NoYXQtcmVuZGVyZXInO1xuaW1wb3J0IHsgU3RyZWFtaW5nTWFuYWdlciB9IGZyb20gJy4vc3RyZWFtaW5nLW1hbmFnZXInO1xuaW1wb3J0IHsgU2VsZWN0aW9uQ29udGV4dE1lbnUsIFNFTEVDVElPTl9BQ1RJT05TIH0gZnJvbSAnLi9zZWxlY3Rpb24tY29udGV4dC1tZW51JztcblxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgPSAnbm92YS1zaWRlYmFyJztcblxuZXhwb3J0IGNsYXNzIE5vdmFTaWRlYmFyVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcblx0cGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNoYXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpbnB1dENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIG11bHRpRG9jSGFuZGxlciE6IE11bHRpRG9jQ29udGV4dEhhbmRsZXI7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcblx0Ly8gTmV3IGFyY2hpdGVjdHVyZSBjb21wb25lbnRzXG5cdHByaXZhdGUgaW5wdXRIYW5kbGVyITogSW5wdXRIYW5kbGVyO1xuXHRwcml2YXRlIGNvbW1hbmRTeXN0ZW0hOiBDb21tYW5kU3lzdGVtO1xuXHRwcml2YXRlIGNvbnRleHRNYW5hZ2VyITogQ29udGV4dE1hbmFnZXI7XG5cdHByaXZhdGUgY2hhdFJlbmRlcmVyITogQ2hhdFJlbmRlcmVyO1xuXHRwcml2YXRlIHN0cmVhbWluZ01hbmFnZXIhOiBTdHJlYW1pbmdNYW5hZ2VyO1xuXHRwcml2YXRlIHNlbGVjdGlvbkNvbnRleHRNZW51ITogU2VsZWN0aW9uQ29udGV4dE1lbnU7XG5cdFxuXHQvLyBDdXJzb3Itb25seSBhcmNoaXRlY3R1cmUgLSBkZWxlZ2F0ZSB0byBuZXcgY29tcG9uZW50c1xuXHRwcml2YXRlIGdldCB0ZXh0QXJlYSgpIHsgcmV0dXJuIHRoaXMuaW5wdXRIYW5kbGVyPy5nZXRUZXh0QXJlYSgpOyB9XG5cdHByaXZhdGUgZ2V0IHdpa2lsaW5rQXV0b2NvbXBsZXRlKCkgeyByZXR1cm4gdGhpcy5pbnB1dEhhbmRsZXIgPyB7IGRlc3Ryb3k6ICgpID0+IHt9IH0gOiBudWxsOyB9XG5cdHByaXZhdGUgZ2V0IGF1dG9Hcm93VGV4dGFyZWEoKSB7IHJldHVybiAoKSA9PiB7fTsgfVxuXHRcblx0Ly8gQ29tbWFuZCBzeXN0ZW0gZGVsZWdhdGlvblxuXHRwcml2YXRlIF9jb21tYW5kUGlja2VySXRlbXM6IGFueVtdID0gW107XG5cdHByaXZhdGUgZ2V0IGNvbW1hbmRQaWNrZXJJdGVtcygpIHsgcmV0dXJuIHRoaXMuX2NvbW1hbmRQaWNrZXJJdGVtczsgfVxuXHRwcml2YXRlIHNldCBjb21tYW5kUGlja2VySXRlbXModmFsdWU6IGFueVtdKSB7IHRoaXMuX2NvbW1hbmRQaWNrZXJJdGVtcyA9IHZhbHVlOyB9XG5cdHByaXZhdGUgX3NlbGVjdGVkQ29tbWFuZEluZGV4OiBudW1iZXIgPSAtMTtcblx0cHJpdmF0ZSBnZXQgc2VsZWN0ZWRDb21tYW5kSW5kZXgoKSB7IHJldHVybiB0aGlzLl9zZWxlY3RlZENvbW1hbmRJbmRleDsgfVxuXHRwcml2YXRlIHNldCBzZWxlY3RlZENvbW1hbmRJbmRleCh2YWx1ZTogbnVtYmVyKSB7IHRoaXMuX3NlbGVjdGVkQ29tbWFuZEluZGV4ID0gdmFsdWU7IH1cblx0cHJpdmF0ZSBfaXNDb21tYW5kTWVudVZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBnZXQgaXNDb21tYW5kTWVudVZpc2libGUoKSB7IHJldHVybiB0aGlzLl9pc0NvbW1hbmRNZW51VmlzaWJsZTsgfVxuXHRwcml2YXRlIHNldCBpc0NvbW1hbmRNZW51VmlzaWJsZSh2YWx1ZTogYm9vbGVhbikgeyB0aGlzLl9pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHZhbHVlOyB9XG5cdFxuXHQvLyBDb250ZXh0IHN5c3RlbSBkZWxlZ2F0aW9uXG5cdHByaXZhdGUgZ2V0IGNvbnRleHRQcmV2aWV3KCkgeyByZXR1cm4gdGhpcy5jb250ZXh0TWFuYWdlcj8uY29udGV4dFByZXZpZXc7IH1cblx0cHJpdmF0ZSBfY29udGV4dEluZGljYXRvcjogYW55O1xuXHRwcml2YXRlIGdldCBjb250ZXh0SW5kaWNhdG9yKCkgeyByZXR1cm4gdGhpcy5fY29udGV4dEluZGljYXRvciB8fCB0aGlzLmNvbnRleHRNYW5hZ2VyPy5jb250ZXh0SW5kaWNhdG9yOyB9XG5cdHByaXZhdGUgc2V0IGNvbnRleHRJbmRpY2F0b3IodmFsdWU6IGFueSkgeyB0aGlzLl9jb250ZXh0SW5kaWNhdG9yID0gdmFsdWU7IH1cblx0XG5cdC8vIENvbXBvbmVudCByZWZlcmVuY2VzXG5cdHByaXZhdGUgY29tbWFuZFBpY2tlciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRNZW51ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY29tbWFuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0XG5cdC8vIEN1cnNvciBwb3NpdGlvbiB0cmFja2luZyAtIGZpbGUtc2NvcGVkIGxpa2UgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0cHJpdmF0ZSBjdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uOiBFZGl0b3JQb3NpdGlvbiB8IG51bGwgPSBudWxsO1xuXHRcblx0XG5cdC8vIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiAtIGRlYm91bmNpbmcgYW5kIHRpbWluZyBjb25zdGFudHNcblx0cHJpdmF0ZSBjb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ09OVEVYVF9QUkVWSUVXX0RFQk9VTkNFX01TID0gMzAwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBTQ1JPTExfREVMQVlfTVMgPSA1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRk9DVVNfREVMQVlfTVMgPSAxNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEhPVkVSX1RJTUVPVVRfTVMgPSAxNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE5PVElDRV9EVVJBVElPTl9NUyA9IDUwMDA7XG5cdFxuXHQvLyBFdmVudCBsaXN0ZW5lciBjbGVhbnVwIHRyYWNraW5nXG5cdHByaXZhdGUgZG9jdW1lbnRFdmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblx0cHJpdmF0ZSB0aW1lb3V0czogTm9kZUpTLlRpbWVvdXRbXSA9IFtdO1xuXG5cdGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGxlYWYpO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyID0gbmV3IE11bHRpRG9jQ29udGV4dEhhbmRsZXIodGhpcy5hcHApO1xuXHR9XG5cblx0Z2V0Vmlld1R5cGUoKSB7XG5cdFx0cmV0dXJuIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVI7XG5cdH1cblxuXHRnZXREaXNwbGF5VGV4dCgpIHtcblx0XHRyZXR1cm4gJ05vdmEnO1xuXHR9XG5cblx0Z2V0SWNvbigpIHtcblx0XHRyZXR1cm4gJ25vdmEtc3Rhcic7XG5cdH1cblxuXHRhc3luYyBvbk9wZW4oKSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcblx0XHRjb250YWluZXIuZW1wdHkoKTtcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ25vdmEtc2lkZWJhci1jb250YWluZXInKTtcblx0XHRcblx0XHQvLyBBZGQgcGxhdGZvcm0tc3BlY2lmaWMgY2xhc3MgZm9yIHN0eWxpbmdcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdGNvbnRhaW5lci5hZGRDbGFzcygnaXMtbW9iaWxlJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRhaW5lci5hZGRDbGFzcygnaXMtZGVza3RvcCcpO1xuXHRcdH1cblxuXHRcdC8vIE1vYmlsZSBhY2Nlc3MgaXMgbm93IGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0XHRcblx0XHQvLyBDcmVhdGUgd3JhcHBlciB3aXRoIHByb3BlciBmbGV4IGxheW91dFxuXHRcdGNvbnN0IHdyYXBwZXJFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdyYXBwZXInIH0pO1xuXHRcdHdyYXBwZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRoZWlnaHQ6IDEwMCU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0cGFkZGluZy1ib3R0b206ICR7UGxhdGZvcm0uaXNEZXNrdG9wQXBwID8gJ3ZhcigtLXNpemUtNC02KScgOiAndmFyKC0tc2l6ZS00LTUpJ307XG5cdFx0YDtcblx0XHRcblx0XHQvLyBIZWFkZXIgd2l0aCBwcm92aWRlciBpbmZvXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB3cmFwcGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvcCByb3cgY29udGFpbmVyIGZvciB0aXRsZSBhbmQgY29udHJvbHNcblx0XHRjb25zdCB0b3BSb3dFbCA9IGhlYWRlckVsLmNyZWF0ZURpdigpO1xuXHRcdHRvcFJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIExlZnQgc2lkZTogVGl0bGUgd2l0aCBOb3ZhIGljb25cblx0XHRjb25zdCB0aXRsZUVsID0gdG9wUm93RWwuY3JlYXRlRWwoJ2g0Jyk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogdmFyKC0tc2l6ZS0yLTIpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsnO1xuXHRcdHRpdGxlRWwuaW5uZXJIVE1MID0gYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IHZhcigtLWljb24tc2l6ZSk7IGhlaWdodDogdmFyKC0taWNvbi1zaXplKTtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5Ob3ZhYDtcblx0XHRcblx0XHQvLyBSaWdodCBzaWRlOiBQcm92aWRlciBzdGF0dXMgYW5kIENsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IHJpZ2h0Q29udGFpbmVyID0gdG9wUm93RWwuY3JlYXRlRGl2KCk7XG5cdFx0cmlnaHRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IHZhcigtLXNpemUtMi0zKTsnO1xuXHRcdFxuXHRcdC8vIFByaXZhY3kgaW5kaWNhdG9yIGljb25cblx0XHRjb25zdCBwcml2YWN5SW5kaWNhdG9yID0gcmlnaHRDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtcHJpdmFjeS1pbmRpY2F0b3InIH0pO1xuXHRcdHByaXZhY3lJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0cGFkZGluZzogNHB4O1xuXHRcdFx0Y29sb3I6IHZhcigtLWljb24tY29sb3IpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IHZhcigtLWZvbnQtd2VpZ2h0LW1lZGl1bSk7XG5cdFx0YDtcblx0XHR0aGlzLnVwZGF0ZVByaXZhY3lJbmRpY2F0b3IocHJpdmFjeUluZGljYXRvcik7XG5cdFx0XG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciB1cGRhdGVzXG5cdFx0KHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yID0gcHJpdmFjeUluZGljYXRvcjtcblx0XHRcblx0XHQvLyBBbGwgdXNlcnMgY2FuIHN3aXRjaCBwcm92aWRlcnMgZnJlZWx5XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlckRyb3Bkb3duKHJpZ2h0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDbGVhciBDaGF0IGJ1dHRvbiBpbiByaWdodCBjb250YWluZXJcblx0XHRjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQocmlnaHRDb250YWluZXIpO1xuXHRcdGNsZWFyQnV0dG9uLnNldEljb24oJ2VyYXNlcicpXG5cdFx0XHQuc2V0VG9vbHRpcCgnQ2xlYXIgY29udmVyc2F0aW9uIGhpc3RvcnknKVxuXHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5jbGVhckNoYXQoKSk7XG5cblx0XHR0aGlzLmNyZWF0ZUNoYXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHR0aGlzLmNyZWF0ZUlucHV0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0XG5cdFx0Ly8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXIgZm9yIGFjdGl2ZSBmaWxlIGNoYW5nZXNcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcblx0XHRcdFx0dGhpcy5sb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGN1cnNvciBwb3NpdGlvbiB0cmFja2luZyBmb3IgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1jaGFuZ2UnLCAoZWRpdG9yKSA9PiB7XG5cdFx0XHRcdHRoaXMudHJhY2tDdXJzb3JQb3NpdGlvbihlZGl0b3IpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIExvYWQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcblx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gSW5pdGlhbCBzdGF0dXMgcmVmcmVzaCB0byBlbnN1cmUgYWxsIGluZGljYXRvcnMgYXJlIHVwIHRvIGRhdGVcblx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzKCksIDEwMCk7XG5cdFx0XG5cdFx0Ly8gTm90ZTogQXV0by1mb2N1cyByZW1vdmVkIHRvIHByZXZlbnQgc3RlYWxpbmcgY3Vyc29yIGZyb20gZWRpdG9yXG5cdH1cblxuXHQvKipcblx0ICogVHJhY2sgY3Vyc29yIHBvc2l0aW9uIGNoYW5nZXMgaW4gdGhlIGFjdGl2ZSBlZGl0b3IgKGZpbGUtc2NvcGVkKVxuXHQgKi9cblx0cHJpdmF0ZSB0cmFja0N1cnNvclBvc2l0aW9uKGVkaXRvcjogYW55KSB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0aWYgKCFhY3RpdmVGaWxlIHx8ICFlZGl0b3IpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gT25seSB0cmFjayBjdXJzb3IgcG9zaXRpb24gaWYgdGhpcyBpcyB0aGUgY3VycmVudCBmaWxlIHdlJ3JlIHdvcmtpbmcgd2l0aFxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlICYmIGFjdGl2ZUZpbGUucGF0aCA9PT0gdGhpcy5jdXJyZW50RmlsZS5wYXRoKSB7XG5cdFx0XHRjb25zdCBjdXJzb3JQb3MgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRpZiAoY3Vyc29yUG9zKSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbiA9IGN1cnNvclBvcztcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiBmb3IgY3VycmVudCBmaWxlIChmaWxlLXNjb3BlZClcblx0ICovXG5cdHByaXZhdGUgcmVzdG9yZUN1cnNvclBvc2l0aW9uKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlQ3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdC8vIFJlc3RvcmUgd2l0aG91dCBzdGVhbGluZyBmb2N1c1xuXHRcdFx0Y29uc3QgZWRpdG9yID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG5cdFx0XHRpZiAoZWRpdG9yKSB7XG5cdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IodGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBvbkNsb3NlKCkge1xuXHRcdC8vIENsZWFuIHVwIHByb3ZpZGVyIGRyb3Bkb3duIGV2ZW50IGxpc3RlbmVyXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LmNsZWFudXApIHtcblx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24uY2xlYW51cCgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5kZXN0cm95KCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFyIGRlYm91bmNlIHRpbWVvdXRcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpO1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCA9IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFuIHVwIHRyYWNrZWQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0dGhpcy5jbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcblx0XHQvLyBDbGVhciBhbGwgdGltZW91dHNcblx0XHR0aGlzLmNsZWFyVGltZW91dHMoKTtcblx0XHRcblx0XHQvLyBDbGVhbiB1cCBET00gZWxlbWVudHNcblx0XHR0aGlzLmNsZWFudXBET01FbGVtZW50cygpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIGV2ZW50IGxpc3RlbmVyIHdpdGggYXV0b21hdGljIGNsZWFudXAgdHJhY2tpbmdcblx0ICovXG5cdHByaXZhdGUgYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGQgdGltZW91dCB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRUaW1lb3V0KGNhbGxiYWNrOiAoKSA9PiB2b2lkLCBkZWxheTogbnVtYmVyKTogTm9kZUpTLlRpbWVvdXQge1xuXHRcdGNvbnN0IGlkID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0dGhpcy50aW1lb3V0cyA9IHRoaXMudGltZW91dHMuZmlsdGVyKHQgPT4gdCAhPT0gaWQpO1xuXHRcdH0sIGRlbGF5KTtcblx0XHR0aGlzLnRpbWVvdXRzLnB1c2goaWQpO1xuXHRcdHJldHVybiBpZDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIGFsbCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFyIGFsbCB0cmFja2VkIHRpbWVvdXRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFyVGltZW91dHMoKTogdm9pZCB7XG5cdFx0dGhpcy50aW1lb3V0cy5mb3JFYWNoKGlkID0+IGNsZWFyVGltZW91dChpZCkpO1xuXHRcdHRoaXMudGltZW91dHMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRE9NRWxlbWVudHMoKTogdm9pZCB7XG5cdFx0Ly8gQ2xlYW51cCBpcyBub3cgaGFuZGxlZCBieSBpbmRpdmlkdWFsIGNvbXBvbmVudCBjbGVhbnVwIG1ldGhvZHNcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2hhdEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY2hhdC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdGA7XG5cblx0XHQvLyBJbml0aWFsaXplIGNoYXRSZW5kZXJlciBub3cgdGhhdCBjaGF0Q29udGFpbmVyIGV4aXN0c1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyID0gbmV3IENoYXRSZW5kZXJlcih0aGlzLnBsdWdpbiwgdGhpcy5jaGF0Q29udGFpbmVyKTtcblxuXHRcdC8vIFdlbGNvbWUgbWVzc2FnZSB3aXRoIE5vdmEgYnJhbmRpbmdcblx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUlucHV0SW50ZXJmYWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNyZWF0ZUlucHV0QXJlYSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSB0aGUgaW5wdXQgYXJlYSBVSSBlbGVtZW50cyB1c2luZyBuZXcgYXJjaGl0ZWN0dXJlXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZUlucHV0QXJlYSgpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBpbnB1dCBhcmVhIGNvbnRlbnRcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSW5pdGlhbGl6ZSBjb250ZXh0IG1hbmFnZXIsIHN0cmVhbWluZyBtYW5hZ2VyLCBhbmQgc2VsZWN0aW9uIG1lbnUgZmlyc3Rcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyID0gbmV3IENvbnRleHRNYW5hZ2VyKHRoaXMucGx1Z2luLCB0aGlzLmFwcCwgdGhpcy5pbnB1dENvbnRhaW5lcik7XG5cdFx0dGhpcy5zdHJlYW1pbmdNYW5hZ2VyID0gbmV3IFN0cmVhbWluZ01hbmFnZXIoKTtcblx0XHR0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51ID0gbmV3IFNlbGVjdGlvbkNvbnRleHRNZW51KHRoaXMuYXBwLCB0aGlzLnBsdWdpbik7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIElucHV0SGFuZGxlciB3aGljaCB3aWxsIGhhbmRsZSBhbGwgaW5wdXQgVUkgY3JlYXRpb25cblx0XHR0aGlzLmlucHV0SGFuZGxlciA9IG5ldyBJbnB1dEhhbmRsZXIodGhpcy5wbHVnaW4sIHRoaXMuaW5wdXRDb250YWluZXIsIHRoaXMuY29udGV4dE1hbmFnZXIpO1xuXHRcdFxuXHRcdC8vIFBhc3Mgc2lkZWJhciB2aWV3IHJlZmVyZW5jZSBmb3IgY29udGV4dCBvcGVyYXRpb25zXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0U2lkZWJhclZpZXcodGhpcyk7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5zZXRTaWRlYmFyVmlldyh0aGlzKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgdGhlIGlucHV0IGludGVyZmFjZSB1c2luZyBuZXcgSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuY3JlYXRlSW5wdXRJbnRlcmZhY2UodGhpcy5jaGF0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgQ29tbWFuZFN5c3RlbSB3aXRoIHRoZSBhY3R1YWwgdGV4dEFyZWEgZnJvbSBJbnB1dEhhbmRsZXJcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0gPSBuZXcgQ29tbWFuZFN5c3RlbSh0aGlzLnBsdWdpbiwgdGhpcy5pbnB1dENvbnRhaW5lciwgdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VGV4dEFyZWEoKSk7XG5cdFx0XG5cdFx0Ly8gQ29ubmVjdCB0aGUgQ29tbWFuZFN5c3RlbSB0byB0aGUgSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0Q29tbWFuZFN5c3RlbSh0aGlzLmNvbW1hbmRTeXN0ZW0pO1xuXHRcdFxuXHRcdC8vIFNldCB1cCBzZW5kIG1lc3NhZ2UgY2FsbGJhY2tcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRPblNlbmRNZXNzYWdlKChtZXNzYWdlOiBzdHJpbmcpID0+IHtcblx0XHRcdHRoaXMuaGFuZGxlU2VuZChtZXNzYWdlKTtcblx0XHR9KTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29udGV4dCBpbmRpY2F0b3IgYW5kIHByZXZpZXcgdXNpbmcgQ29udGV4dE1hbmFnZXJcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLmNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcblx0fVxuXG5cdHByaXZhdGUgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0zKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC10ZXh0LXNpemUpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbSB3aXRoIHNtb290aCBhbmltYXRpb25cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdC8vIFJFUExBQ0Ugd2l0aCBzaW1wbGUgZGVsZWdhdGlvbiB0byBDaGF0UmVuZGVyZXI6XG5cdHByaXZhdGUgYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jaGF0UmVuZGVyZXIuYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudCwgdHJ1ZSk7IC8vIEFsd2F5cyBwZXJzaXN0XG5cdH1cblxuXHRwcml2YXRlIGFkZEVycm9yTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmNoYXRSZW5kZXJlci5hZGRFcnJvck1lc3NhZ2UoY29udGVudCwgdHJ1ZSk7IC8vIEFsd2F5cyBwZXJzaXN0ICBcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyLmFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTdWNjZXNzSW5kaWNhdG9yKGFjdGlvbjogc3RyaW5nKSB7XG5cdFx0Ly8gVXNlIHVuaWZpZWQgc3lzdGVtIGluc3RlYWQgb2YgZHluYW1pYyBzdHlsaW5nXG5cdFx0Y29uc3QgbWVzc2FnZXMgPSB7XG5cdFx0XHQnYWRkJzogJ1x1MjcxMyBDb250ZW50IGFkZGVkJyxcblx0XHRcdCdlZGl0JzogJ1x1MjcxMyBDb250ZW50IGVkaXRlZCcsIFxuXHRcdFx0J2RlbGV0ZSc6ICdcdTI3MTMgQ29udGVudCBkZWxldGVkJyxcblx0XHRcdCdncmFtbWFyJzogJ1x1MjcxMyBHcmFtbWFyIGZpeGVkJyxcblx0XHRcdCdyZXdyaXRlJzogJ1x1MjcxMyBDb250ZW50IHJld3JpdHRlbidcblx0XHR9O1xuXHRcdFxuXHRcdGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1thY3Rpb24gYXMga2V5b2YgdHlwZW9mIG1lc3NhZ2VzXSB8fCAnXHUyNzEzIENvbW1hbmQgY29tcGxldGVkJztcblx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRFcnJvckluZGljYXRvcihhY3Rpb246IHN0cmluZywgZXJyb3I/OiBzdHJpbmcpIHtcblx0XHQvLyBVc2UgdW5pZmllZCBzeXN0ZW0gZm9yIGVycm9yIG1lc3NhZ2VzIG1hdGNoaW5nIHN1Y2Nlc3MgbWVzc2FnZXNcblx0XHRjb25zdCBtZXNzYWdlcyA9IHtcblx0XHRcdCdhZGQnOiAnXHUyNzRDIEZhaWxlZCB0byBhZGQgY29udGVudCcsXG5cdFx0XHQnZWRpdCc6ICdcdTI3NEMgRmFpbGVkIHRvIGVkaXQgY29udGVudCcsIFxuXHRcdFx0J2RlbGV0ZSc6ICdcdTI3NEMgRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50Jyxcblx0XHRcdCdncmFtbWFyJzogJ1x1Mjc0QyBGYWlsZWQgdG8gZml4IGdyYW1tYXInLFxuXHRcdFx0J3Jld3JpdGUnOiAnXHUyNzRDIEZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLFxuXHRcdFx0J2V4ZWN1dGUnOiAnXHUyNzRDIENvbW1hbmQgZXhlY3V0aW9uIGVycm9yJ1xuXHRcdH07XG5cdFx0XG5cdFx0bGV0IG1lc3NhZ2UgPSBtZXNzYWdlc1thY3Rpb24gYXMga2V5b2YgdHlwZW9mIG1lc3NhZ2VzXSB8fCAnXHUyNzRDIENvbW1hbmQgZmFpbGVkJztcblx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdG1lc3NhZ2UgKz0gYDogJHtlcnJvcn1gO1xuXHRcdH1cblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdC8vIENoZWNrIGlmIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoJ0NvbW1hbmRzIGFyZSBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMzAsIDIwMjUuJyk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kID0gbWVzc2FnZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgJzonIGFuZCBub3JtYWxpemVcblxuXHRcdC8vIFByb3ZpZGVyIHN3aXRjaGluZyBjb21tYW5kc1xuXHRcdGNvbnN0IHByb3ZpZGVyQ29tbWFuZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ2NsYXVkZScsXG5cdFx0XHQnY2hhdGdwdCc6ICdvcGVuYWknLFxuXHRcdFx0J29wZW5haSc6ICdvcGVuYWknLFxuXHRcdFx0J2dlbWluaSc6ICdnb29nbGUnLFxuXHRcdFx0J2dvb2dsZSc6ICdnb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdvbGxhbWEnXG5cdFx0fTtcblxuXHRcdGlmIChwcm92aWRlckNvbW1hbmRzW2NvbW1hbmRdKSB7XG5cdFx0XHRjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNldHRpbmdUYWIuc2V0Q3VycmVudFByb3ZpZGVyKHByb3ZpZGVySWQpO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKGBcdTI3MTMgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJJZCl9YCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY3VzdG9tIGNvbW1hbmRzIChpZiBmZWF0dXJlIGVuYWJsZWQpXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uZmluZChjbWQgPT4gY21kLnRyaWdnZXIgPT09IGNvbW1hbmQpO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmQpIHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBjdXN0b20gY29tbWFuZFxuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGN1c3RvbUNvbW1hbmQudGVtcGxhdGUpO1xuXHRcdFx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBhZnRlciBzZXR0aW5nIHRlbXBsYXRlXG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKSwgMCk7XG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UoYFx1MjcxMyBMb2FkZWQgdGVtcGxhdGU6ICR7Y3VzdG9tQ29tbWFuZC5uYW1lfWApO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBVbmtub3duIGNvbW1hbmRcblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShgXHUyNzRDIFVua25vd24gY29tbWFuZCAnOiR7Y29tbWFuZH0nLiBUcnkgOmNsYXVkZSwgOmNoYXRncHQsIDpnZW1pbmksIG9yIDpvbGxhbWFgKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXIgbm92YS1wYW5lbC1iYXNlJyB9KTtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdGxlZnQ6IDA7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGNvbnN0IHZhbHVlID0gdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VGV4dEFyZWEoKS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdGlmICh2YWx1ZS5zdGFydHNXaXRoKCc6JykgJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0Y29uc3QgcXVlcnkgPSB2YWx1ZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZFBpY2tlcihxdWVyeSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kUGlja2VyKHF1ZXJ5OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKS5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLnRyaWdnZXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgY21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSlcblx0XHQpO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0gbm92YS1wYW5lbC1pdGVtJyB9KTtcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLW5hbWUgbm92YS1wYW5lbC10ZXh0JyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7JztcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2Mgbm92YS1wYW5lbC1tdXRlZCcgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHR9XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0Q29tbWFuZChjb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZXRTZWxlY3RlZENvbW1hbmQoaW5kZXgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblx0fVxuXG5cdHByaXZhdGUgaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jayc7XG5cdH1cblxuXHRwcml2YXRlIG5hdmlnYXRlQ29tbWFuZFBpY2tlcihkaXJlY3Rpb246IG51bWJlcik6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuXHRcdGNvbnN0IG5ld0luZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggLSAxLFxuXHRcdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCArIGRpcmVjdGlvblxuXHRcdCkpO1xuXG5cdFx0dGhpcy5zZXRTZWxlY3RlZENvbW1hbmQobmV3SW5kZXgpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXRTZWxlY3RlZENvbW1hbmQoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuXHRcdC8vIFJlbW92ZSBwcmV2aW91cyBzZWxlY3Rpb25cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuXHRcdFx0aXRlbS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcblxuXHRcdGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uc2Nyb2xsSW50b1ZpZXcoeyBibG9jazogJ25lYXJlc3QnIH0pO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAoIXRoaXMuaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpIHx8IHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPT09IC0xKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRDb21tYW5kID0gY29tbWFuZHNbdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleF07XG5cdFx0XG5cdFx0aWYgKHNlbGVjdGVkQ29tbWFuZCkge1xuXHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKHNlbGVjdGVkQ29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZCh0cmlnZ2VyOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHQvLyBUcmlnZ2VyIHRoZSBjb21tYW5kIGltbWVkaWF0ZWx5XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGdldEF2YWlsYWJsZUNvbW1hbmRzKCk6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiB7XG5cdFx0Y29uc3QgY29tbWFuZHM6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiA9IFtdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdXNlciBoYXMgdGV4dCBzZWxlY3RlZCBpbiBhY3RpdmUgZWRpdG9yXG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcblx0XHQvLyBJZiB0ZXh0IGlzIHNlbGVjdGVkLCBwcmlvcml0aXplIE5vdmEgc2VsZWN0aW9uIGFjdGlvbnNcblx0XHRpZiAoc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID4gMCkge1xuXHRcdFx0U0VMRUNUSU9OX0FDVElPTlMuZm9yRWFjaChhY3Rpb24gPT4ge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHR0cmlnZ2VyOiBhY3Rpb24uaWQsXG5cdFx0XHRcdFx0bmFtZTogYE5vdmE6ICR7YWN0aW9uLmxhYmVsfWAsXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IGFjdGlvbi5kZXNjcmlwdGlvblxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgc2VwYXJhdG9yIGNvbW1lbnQgKG5vdCBhIHJlYWwgY29tbWFuZClcblx0XHRcdGNvbW1hbmRzLnB1c2goeyB0cmlnZ2VyOiAnLS0tJywgbmFtZTogJ1x1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCcsIGRlc2NyaXB0aW9uOiAnUHJvdmlkZXIgQ29tbWFuZHMnIH0pO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBwcm92aWRlciBzd2l0Y2hpbmcgY29tbWFuZHNcblx0XHRjb21tYW5kcy5wdXNoKFxuXHRcdFx0eyB0cmlnZ2VyOiAnY2xhdWRlJywgbmFtZTogJ1N3aXRjaCB0byBDbGF1ZGUnLCBkZXNjcmlwdGlvbjogJ0FudGhyb3BpYyBDbGF1ZGUgQUknIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdjaGF0Z3B0JywgbmFtZTogJ1N3aXRjaCB0byBDaGF0R1BUJywgZGVzY3JpcHRpb246ICdPcGVuQUkgR1BUIG1vZGVscycgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2dlbWluaScsIG5hbWU6ICdTd2l0Y2ggdG8gR2VtaW5pJywgZGVzY3JpcHRpb246ICdHb29nbGUgR2VtaW5pIEFJJyB9XG5cdFx0KTtcblxuXHRcdC8vIE9ubHkgYWRkIE9sbGFtYSBvbiBkZXNrdG9wXG5cdFx0aWYgKFBsYXRmb3JtLmlzRGVza3RvcEFwcCkge1xuXHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICdvbGxhbWEnLCBuYW1lOiAnU3dpdGNoIHRvIE9sbGFtYScsIGRlc2NyaXB0aW9uOiAnTG9jYWwgQUkgbW9kZWxzJyB9KTtcblx0XHR9XG5cblx0XHQvLyBBZGQgY3VzdG9tIGNvbW1hbmRzIGlmIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmRzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICctLS0nLCBuYW1lOiAnXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwJywgZGVzY3JpcHRpb246ICdDdXN0b20gQ29tbWFuZHMnIH0pO1xuXHRcdFx0XHRjdXN0b21Db21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRcdFx0Y29tbWFuZHMucHVzaCh7XG5cdFx0XHRcdFx0XHR0cmlnZ2VyOiBjbWQudHJpZ2dlcixcblx0XHRcdFx0XHRcdG5hbWU6IGNtZC5uYW1lLFxuXHRcdFx0XHRcdFx0Li4uKGNtZC5kZXNjcmlwdGlvbiAmJiB7IGRlc2NyaXB0aW9uOiBjbWQuZGVzY3JpcHRpb24gfSlcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbW1hbmRzO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudSBub3ZhLXBhbmVsLWJhc2UnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWluLXdpZHRoOiAyNDBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDMwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cblx0XHQvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51LmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSAmJiBcblx0XHRcdFx0IXRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyKTtcblx0fVxuXG5cdHByaXZhdGUgdG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSgnQ29tbWFuZHMgYXJlIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIFNlcHRlbWJlciAzMCwgMjAyNS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRcblx0XHR0aGlzLmNvbW1hbmRNZW51LmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWhlYWRlciBub3ZhLXBhbmVsLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd6YXAnKSArICcgQ29tbWFuZHMnO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdGNvbW1hbmRzLmZvckVhY2goY29tbWFuZCA9PiB7XG5cdFx0XHQvLyBIYW5kbGUgc2VwYXJhdG9yIGl0ZW1zXG5cdFx0XHRpZiAoY29tbWFuZC50cmlnZ2VyID09PSAnLS0tJykge1xuXHRcdFx0XHRjb25zdCBzZXBhcmF0b3IgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXNlcGFyYXRvcicgfSk7XG5cdFx0XHRcdHNlcGFyYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxNnB4IDRweCAxNnB4O1xuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdFx0bWFyZ2luLXRvcDogNHB4O1xuXHRcdFx0XHRcdGN1cnNvcjogZGVmYXVsdDtcblx0XHRcdFx0YDtcblx0XHRcdFx0c2VwYXJhdG9yLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbiB8fCAnJztcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBpdGVtID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1pdGVtIG5vdmEtcGFuZWwtaXRlbS12ZXJ0aWNhbCcgfSk7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtbmFtZSBub3ZhLXBhbmVsLXRleHQnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5vcGFjaXR5ID0gJzAuOCc7XG5cblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtZGVzYyBub3ZhLXBhbmVsLW11dGVkJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5leGVjdXRlQ29tbWFuZEZyb21NZW51KGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tbWFuZEZyb21NZW51KHRyaWdnZXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIE5vdmEgc2VsZWN0aW9uIGFjdGlvblxuXHRcdGNvbnN0IHNlbGVjdGlvbkFjdGlvbiA9IFNFTEVDVElPTl9BQ1RJT05TLmZpbmQoYWN0aW9uID0+IGFjdGlvbi5pZCA9PT0gdHJpZ2dlcik7XG5cdFx0aWYgKHNlbGVjdGlvbkFjdGlvbikge1xuXHRcdFx0Ly8gSGFuZGxlIHNlbGVjdGlvbiBhY3Rpb25cblx0XHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZVZpZXc/LmVkaXRvciAmJiBzZWxlY3RlZFRleHQgJiYgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vIFVzZSB0aGUgZXhpc3Rpbmcgc2VsZWN0aW9uIGNvbnRleHQgbWVudSBoYW5kbGVyXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKHRyaWdnZXIsIGFjdGl2ZVZpZXcuZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnTm8gdGV4dCBzZWxlY3RlZC4gUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIHVzZSBOb3ZhIGVkaXRpbmcgY29tbWFuZHMuJywgMzAwMCk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNraXAgc2VwYXJhdG9yIGl0ZW1zXG5cdFx0aWYgKHRyaWdnZXIgPT09ICctLS0nKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEV4ZWN1dGUgcmVndWxhciBjb21tYW5kIChwcm92aWRlciBzd2l0Y2hpbmcsIGN1c3RvbSBjb21tYW5kcylcblx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0UHJldmlldygpOiBIVE1MRWxlbWVudCB7XG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHQvLyBSZXR1cm4gYSBkdW1teSBlbGVtZW50IHRoYXQgd29uJ3QgYmUgdXNlZFxuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhIHByZXZpZXcgYXJlYSB0aGF0IHNob3dzIGxpdmUgY29udGV4dCBhcyB1c2VyIHR5cGVzXG5cdFx0Y29uc3QgcHJldmlld0NvbnRhaW5lciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXcnIH0pO1xuXHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA0cHg7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdUZXh0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctdGV4dCcgfSk7XG5cdFx0cHJldmlld1RleHQuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArICcgQ29udGV4dCB3aWxsIGluY2x1ZGU6ICc7XG5cdFx0cHJldmlld1RleHQuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBEZWJvdW5jZWQgdmVyc2lvbiBvZiB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcgZm9yIHBlcmZvcm1hbmNlXG5cdCAqL1xuXHRwcml2YXRlIGRlYm91bmNlZFVwZGF0ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMudXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0ID0gbnVsbDtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuQ09OVEVYVF9QUkVWSUVXX0RFQk9VTkNFX01TKTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0UHJldmlldyB8fCAhdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLmdldFZhbHVlKCk7XG5cdFx0aWYgKCFtZXNzYWdlKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUGFyc2UgZG9jdW1lbnQgcmVmZXJlbmNlcyBmcm9tIGN1cnJlbnQgbWVzc2FnZVxuXHRcdC8vIE5vdGU6IEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRjb25zdCBmb3VuZFJlZnM6IEFycmF5PHtuYW1lOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nfT4gPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcblx0XHRcdFxuXHRcdFx0Ly8gVHJ5IHRvIGZpbmQgdGhlIGZpbGUgdG8gdmFsaWRhdGUgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZUJ5TmFtZShkb2NOYW1lKTtcblx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdGZvdW5kUmVmcy5wdXNoKHtcblx0XHRcdFx0XHRuYW1lOiBkb2NOYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHRcdGNvbnN0IHBlcnNpc3RlbnREb2NzID0gdGhpcy5tdWx0aURvY0hhbmRsZXIuZ2V0UGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZT8ucGF0aCB8fCAnJyk7XG5cdFx0cGVyc2lzdGVudERvY3MuZm9yRWFjaChkb2MgPT4ge1xuXHRcdFx0Ly8gT25seSBhZGQgaWYgbm90IGFscmVhZHkgaW4gZm91bmRSZWZzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcblx0XHRcdGNvbnN0IGV4aXN0cyA9IGZvdW5kUmVmcy5zb21lKHJlZiA9PiByZWYubmFtZSA9PT0gZG9jLmZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0aWYgKCFleGlzdHMpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvYy5maWxlLmJhc2VuYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5OiBkb2MucHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBVcGRhdGUgcHJldmlld1xuXHRcdGlmIChmb3VuZFJlZnMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgcHJldmlld0xpc3QgPSB0aGlzLmNvbnRleHRQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBmb3VuZFJlZnMubWFwKHJlZiA9PiB7XG5cdFx0XHRcdFx0Y29uc3Qgc3VmZml4ID0gcmVmLnByb3BlcnR5ID8gYCMke3JlZi5wcm9wZXJ0eX1gIDogJyc7XG5cdFx0XHRcdFx0cmV0dXJuIGAke3JlZi5uYW1lfSR7c3VmZml4fWA7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRwcmV2aWV3TGlzdC50ZXh0Q29udGVudCA9IGRvY05hbWVzLmpvaW4oJywgJyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBmaW5kRmlsZUJ5TmFtZShuYW1lT3JQYXRoOiBzdHJpbmcpOiBURmlsZSB8IG51bGwge1xuXHRcdC8vIEZpcnN0IHRyeSBleGFjdCBwYXRoIG1hdGNoXG5cdFx0bGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCk7XG5cdFx0XG5cdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0Ly8gVHJ5IHdpdGggLm1kIGV4dGVuc2lvblxuXHRcdFx0ZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoICsgJy5tZCcpO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBTZWFyY2ggYnkgYmFzZW5hbWVcblx0XHRcdGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXHRcdFx0ZmlsZSA9IGZpbGVzLmZpbmQoZiA9PiBcblx0XHRcdFx0Zi5iYXNlbmFtZSA9PT0gbmFtZU9yUGF0aCB8fCBcblx0XHRcdFx0Zi5uYW1lID09PSBuYW1lT3JQYXRoIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoKSB8fFxuXHRcdFx0XHRmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCArICcubWQnKVxuXHRcdFx0KSB8fCBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gZmlsZSA6IG51bGw7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IuZW1wdHkoKTtcblx0XHRcblx0XHRpZiAoIXRoaXMuY3VycmVudENvbnRleHQgfHwgIXRoaXMuY3VycmVudENvbnRleHQucGVyc2lzdGVudERvY3MpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0Ly8gVXBkYXRlIGlucHV0IGNvbnRhaW5lciBzdGF0ZSBmb3IgbW9iaWxlIHNwYWNpbmdcblx0XHRcdGlmICh0aGlzLmlucHV0SGFuZGxlcikge1xuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci51cGRhdGVDb250ZXh0U3RhdGUoZmFsc2UpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBhbGxEb2NzID0gdGhpcy5jdXJyZW50Q29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcblx0XHRpZiAoIWFsbERvY3MgfHwgYWxsRG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0Ly8gVXBkYXRlIGlucHV0IGNvbnRhaW5lciBzdGF0ZSBmb3IgbW9iaWxlIHNwYWNpbmdcblx0XHRcdGlmICh0aGlzLmlucHV0SGFuZGxlcikge1xuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci51cGRhdGVDb250ZXh0U3RhdGUoZmFsc2UpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBpbnB1dCBjb250YWluZXIgc3RhdGUgZm9yIG1vYmlsZSBzcGFjaW5nXG5cdFx0aWYgKHRoaXMuaW5wdXRIYW5kbGVyKSB7XG5cdFx0XHR0aGlzLmlucHV0SGFuZGxlci51cGRhdGVDb250ZXh0U3RhdGUodHJ1ZSk7XG5cdFx0fVxuXG5cdFx0Ly8gU2hvdyBhcyB0aGluIGxpbmUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIHNpemluZ1xuXHRcdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjEpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcwLjllbScgOiAnMC44ZW0nfTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdC8vIFNpbmdsZSBsaW5lIHN1bW1hcnkgKHNhbWUgc3R5bGUgYXMgbGl2ZSBwcmV2aWV3KVxuXHRcdGNvbnN0IHN1bW1hcnlFbCA9IHRoaXMuY29udGV4dEluZGljYXRvci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtc3VtbWFyeScgfSk7XG5cdFx0c3VtbWFyeUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0aGVpZ2h0OiAxMDAlO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IGF1dG87XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdW1tYXJ5VGV4dEVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtc3VtbWFyeS10ZXh0JyB9KTtcblx0XHRcblx0XHRjb25zdCB0b2tlblBlcmNlbnQgPSBNYXRoLnJvdW5kKCh0aGlzLmN1cnJlbnRDb250ZXh0LnRva2VuQ291bnQgLyA4MDAwKSAqIDEwMCk7XG5cdFx0Y29uc3QgZG9jTmFtZXMgPSBhbGxEb2NzLmZpbHRlcihkb2MgPT4gZG9jPy5maWxlPy5iYXNlbmFtZSkubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuc2xpY2UoMCwgaXNNb2JpbGUgPyAxIDogMik7XG5cdFx0Y29uc3QgbW9yZUNvdW50ID0gYWxsRG9jcy5sZW5ndGggPiAoaXNNb2JpbGUgPyAxIDogMikgPyBgICske2FsbERvY3MubGVuZ3RoIC0gKGlzTW9iaWxlID8gMSA6IDIpfWAgOiAnJztcblx0XHRcblx0XHQvLyBTcGxpdCBpbnRvIGZpbGVuYW1lIHBhcnQgYW5kIHRva2VuIHBhcnQgdG8gZW5zdXJlIHRva2VucyBhcmUgYWx3YXlzIHZpc2libGVcblx0XHRzdW1tYXJ5VGV4dEVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDUwMDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmbGV4OiAxOyBwb2ludGVyLWV2ZW50czogbm9uZTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7IG1pbi13aWR0aDogMDsnO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBmaWxlbmFtZSBwYXJ0IHRoYXQgY2FuIHRydW5jYXRlXG5cdFx0Y29uc3QgZmlsZW5hbWVQYXJ0RWwgPSBzdW1tYXJ5VGV4dEVsLmNyZWF0ZVNwYW4oKTtcblx0XHRmaWxlbmFtZVBhcnRFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgbWluLXdpZHRoOiAwOyBmbGV4OiAxOyc7XG5cdFx0Ly8gQ3JlYXRlIGljb24gYW5kIHRleHQgYXMgc2VwYXJhdGUgZWxlbWVudHMgZm9yIHByb3BlciBmbGV4IGFsaWdubWVudFxuXHRcdGNvbnN0IGljb25TcGFuID0gZmlsZW5hbWVQYXJ0RWwuY3JlYXRlU3BhbigpO1xuXHRcdGljb25TcGFuLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJyk7XG5cdFx0aWNvblNwYW4uc3R5bGUuY3NzVGV4dCA9ICdmbGV4LXNocmluazogMDsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsnO1xuXHRcdFxuXHRcdGNvbnN0IHRleHRTcGFuID0gZmlsZW5hbWVQYXJ0RWwuY3JlYXRlU3BhbigpO1xuXHRcdHRleHRTcGFuLnRleHRDb250ZW50ID0gYCR7ZG9jTmFtZXMuam9pbignLCAnKX0ke21vcmVDb3VudH1gO1xuXHRcdHRleHRTcGFuLnN0eWxlLmNzc1RleHQgPSAnb3ZlcmZsb3c6IGhpZGRlbjsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IG1pbi13aWR0aDogMDsnO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB0b2tlbiBwYXJ0IHRoYXQgYWx3YXlzIHN0YXlzIHZpc2libGVcblx0XHRjb25zdCB0b2tlblBhcnRFbCA9IHN1bW1hcnlUZXh0RWwuY3JlYXRlU3BhbigpO1xuXHRcdHRva2VuUGFydEVsLnN0eWxlLmNzc1RleHQgPSAnd2hpdGUtc3BhY2U6IG5vd3JhcDsgZmxleC1zaHJpbms6IDA7IG1hcmdpbi1sZWZ0OiA4cHg7Jztcblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdHRva2VuUGFydEVsLnRleHRDb250ZW50ID0gYCgke3Rva2VuUGVyY2VudH0lKWA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRva2VuUGFydEVsLnRleHRDb250ZW50ID0gYCgke3Rva2VuUGVyY2VudH0lIHRva2VucylgO1xuXHRcdH1cblx0XHRcblx0XHQvLyBNb2JpbGUtZnJpZW5kbHkgbW9yZSBtZW51IGluZGljYXRvclxuXHRcdGNvbnN0IGV4cGFuZEluZGljYXRvckVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kLWluZGljYXRvcicgfSk7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdtb3JlLWhvcml6b250YWwnLCBpc01vYmlsZSA/ICcxNnB4JyA6ICcxNHB4Jyk7IC8vIE1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Y29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCd9O1xuXHRcdFx0b3BhY2l0eTogMC44O1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHgnIDogJzRweCd9O1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0YDtcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zZXRBdHRyKCd0aXRsZScsICdUYXAgdG8gbWFuYWdlIGRvY3VtZW50cycpO1xuXHRcdFxuXHRcdC8vIFZpc3VhbCBmZWVkYmFjayBvbiB0aGUgd2hvbGUgc3VtbWFyeSBsaW5lIGluc3RlYWQgb2YganVzdCB0aGUgaW5kaWNhdG9yXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpJztcblx0XHRcdH0pO1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFkZFRyYWNrZWRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKSc7XG5cdFx0XHR9KTtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gRXhwYW5kZWQgc3RhdGUgLSBtb2JpbGUtcmVzcG9uc2l2ZSBvdmVybGF5XG5cdFx0Y29uc3QgZXhwYW5kZWRFbCA9IHRoaXMuY29udGV4dEluZGljYXRvci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kZWQnIH0pO1xuXHRcdGV4cGFuZGVkRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAke2lzTW9iaWxlID8gJy04cHgnIDogJzAnfTtcblx0XHRcdHJpZ2h0OiAke2lzTW9iaWxlID8gJy04cHgnIDogJzAnfTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCAke2lzTW9iaWxlID8gJy00cHggMTZweCcgOiAnLTJweCA4cHgnfSByZ2JhKDAsIDAsIDAsICR7aXNNb2JpbGUgPyAnMC4xNScgOiAnMC4xJ30pO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDJweDtcblx0XHRcdG1heC1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNjB2aCcgOiAnMjAwcHgnfTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRtaW4td2lkdGg6ICR7aXNNb2JpbGUgPyAnMTAwJScgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyIGZvciBleHBhbmRlZCBzdGF0ZSB3aXRoIG1vYmlsZS1vcHRpbWl6ZWQgY2xlYXIgYnV0dG9uXG5cdFx0Y29uc3QgZXhwYW5kZWRIZWFkZXJFbCA9IGV4cGFuZGVkRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkLWhlYWRlcicgfSk7XG5cdFx0ZXhwYW5kZWRIZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJUaXRsZUVsID0gZXhwYW5kZWRIZWFkZXJFbC5jcmVhdGVTcGFuKCk7XG5cdFx0aGVhZGVyVGl0bGVFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCBEb2N1bWVudHMgKCR7YWxsRG9jcy5sZW5ndGh9KWA7XG5cdFx0aGVhZGVyVGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgYWxsIGJ1dHRvbiB1c2luZyBPYnNpZGlhbiB0cmFzaCBpY29uXG5cdFx0Y29uc3QgY2xlYXJBbGxCdG5Db21wb25lbnQgPSBuZXcgQnV0dG9uQ29tcG9uZW50KGV4cGFuZGVkSGVhZGVyRWwpO1xuXHRcdGNsZWFyQWxsQnRuQ29tcG9uZW50LnNldEljb24oJ3RyYXNoLTInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGFsbCBkb2N1bWVudHMgZnJvbSBjb250ZXh0Jylcblx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcblx0XHRjb25zdCBjbGVhckFsbEJ0biA9IGNsZWFyQWxsQnRuQ29tcG9uZW50LmJ1dHRvbkVsO1xuXHRcdGNsZWFyQWxsQnRuLmFkZENsYXNzKCdub3ZhLWNvbnRleHQtY2xlYXItYWxsLWJ0bicpO1xuXHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCAxMnB4JyA6ICc0cHggOHB4J307XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvdWNoLWZyaWVuZGx5IGZlZWRiYWNrIGZvciBjbGVhciBidXR0b25cblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRG9jdW1lbnQgbGlzdCBmb3IgZXhwYW5kZWQgc3RhdGVcblx0XHRjb25zdCBkb2NMaXN0RWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtbGlzdCcgfSk7XG5cdFx0XG5cdFx0YWxsRG9jcy5maWx0ZXIoZG9jID0+IGRvYz8uZmlsZT8uYmFzZW5hbWUpLmZvckVhY2goKGRvYywgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGRvY0l0ZW1FbCA9IGRvY0xpc3RFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWl0ZW0nIH0pO1xuXHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRcdGJvcmRlci1ib3R0b206ICR7aW5kZXggPCBhbGxEb2NzLmxlbmd0aCAtIDEgPyAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScgOiAnbm9uZSd9O1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG5cdFx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNTZweCcgOiAnYXV0byd9O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgZG9jSW5mb0VsID0gZG9jSXRlbUVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtaW5mbycgfSk7XG5cdFx0XHRkb2NJbmZvRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiAke2lzTW9iaWxlID8gJzEycHgnIDogJzhweCd9O1xuXHRcdFx0XHRmbGV4OiAxO1xuXHRcdFx0XHRtaW4td2lkdGg6IDA7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBpY29uRWwgPSBkb2NJbmZvRWwuY3JlYXRlU3BhbigpO1xuXHRcdFx0aWNvbkVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignZmlsZS10ZXh0Jyk7XG5cdFx0XHRpY29uRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmb250LXNpemU6IDFlbTsgZmxleC1zaHJpbms6IDA7Jztcblx0XHRcdFxuXHRcdFx0Y29uc3QgbmFtZUVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLW5hbWUnIH0pO1xuXHRcdFx0Y29uc3Qgc3VmZml4ID0gZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyc7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBgJHtkb2MuZmlsZS5iYXNlbmFtZX0ke3N1ZmZpeH1gO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA0MDA7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXHRcdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0XHR3aGl0ZS1zcGFjZTogbm93cmFwO1xuXHRcdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdFx0ZmxleDogMTtcblx0XHRcdFx0bWluLXdpZHRoOiAwO1xuXHRcdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdGA7XG5cdFx0XHRuYW1lRWwuc2V0QXR0cigndGl0bGUnLCBgJHtkb2MuZmlsZS5wYXRofSAocmVhZC1vbmx5IGZvciBlZGl0aW5nKWApO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgcmVhZC1vbmx5IGluZGljYXRvclxuXHRcdFx0Y29uc3QgcmVhZE9ubHlFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXJlYWRvbmx5JyB9KTtcblx0XHRcdHJlYWRPbmx5RWwudGV4dENvbnRlbnQgPSAncmVhZC1vbmx5Jztcblx0XHRcdHJlYWRPbmx5RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRcdHBhZGRpbmc6IDFweCA0cHg7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDNweDtcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdFx0dGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcblx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBNb2JpbGUtb3B0aW1pemVkIHJlbW92ZSBidXR0b24gd2l0aCBzaW1wbGUgcmVsaWFibGUgaWNvblxuXHRcdFx0Y29uc3QgcmVtb3ZlQnRuID0gZG9jSXRlbUVsLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25vdmEtY29udGV4dC1kb2MtcmVtb3ZlJyB9KTtcblx0XHRcdHJlbW92ZUJ0bi50ZXh0Q29udGVudCA9ICdcdTAwRDcnO1xuXHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdHdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0aGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE4cHgnIDogJzE0cHgnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiBub3JtYWw7XG5cdFx0XHRcdGxpbmUtaGVpZ2h0OiAxO1xuXHRcdFx0YDtcblx0XHRcdHJlbW92ZUJ0bi5zZXRBdHRyKCd0aXRsZScsIGBSZW1vdmUgJHtkb2MuZmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdFxuXHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIucmVtb3ZlUGVyc2lzdGVudERvYyh0aGlzLmN1cnJlbnRGaWxlLnBhdGgsIGRvYy5maWxlLnBhdGgpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdC8vIFBsYXRmb3JtLXNwZWNpZmljIGludGVyYWN0aW9uIGZlZWRiYWNrXG5cdFx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBUb3VjaCBmZWVkYmFjayBmb3IgZG9jdW1lbnQgaXRlbXNcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIENsaWNrIHRvIGV4cGFuZCBtYW5hZ2VtZW50IG92ZXJsYXlcblx0XHRsZXQgaXNFeHBhbmRlZCA9IGZhbHNlO1xuXHRcdFxuXHRcdGNvbnN0IHRvZ2dsZUV4cGFuZGVkID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRpc0V4cGFuZGVkID0gIWlzRXhwYW5kZWQ7XG5cdFx0XHRcblx0XHRcdGlmIChpc0V4cGFuZGVkKSB7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnMTAwMSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnYXV0byc7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHQvLyBDbGljayBvbiB0aGUgZW50aXJlIHN1bW1hcnkgbGluZSB0byBleHBhbmRcblx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVFeHBhbmRlZCk7XG5cdFx0XG5cdFx0Ly8gQ2xvc2Ugd2hlbiBjbGlja2luZyBvdXRzaWRlXG5cdFx0Y29uc3QgY2xvc2VIYW5kbGVyOiBFdmVudExpc3RlbmVyID0gKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoaXNFeHBhbmRlZCAmJiAhdGhpcy5jb250ZXh0SW5kaWNhdG9yLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdGlzRXhwYW5kZWQgPSBmYWxzZTtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0dGhpcy5hZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihkb2N1bWVudCwgJ2NsaWNrJywgY2xvc2VIYW5kbGVyKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgcmVmcmVzaENvbnRleHQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIERvbid0IGNhbGwgYnVpbGRDb250ZXh0IHdpdGggZW1wdHkgbWVzc2FnZSBhcyBpdCBjYW4gaW50ZXJmZXJlIHdpdGggcGVyc2lzdGVudCBjb250ZXh0XG5cdFx0XHRcdC8vIEluc3RlYWQsIGp1c3QgZ2V0IHBlcnNpc3RlbnQgY29udGV4dCBhbmQgYnVpbGQgYSBtaW5pbWFsIGNvbnRleHQgb2JqZWN0IGZvciBVSSBkaXNwbGF5XG5cdFx0XHRcdGNvbnN0IHBlcnNpc3RlbnREb2NzID0gdGhpcy5tdWx0aURvY0hhbmRsZXIuZ2V0UGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChwZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Ly8gQnVpbGQgYSBtaW5pbWFsIGNvbnRleHQgb2JqZWN0IGZvciBVSSBkaXNwbGF5IG9ubHlcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0ge1xuXHRcdFx0XHRcdFx0cGVyc2lzdGVudERvY3M6IHBlcnNpc3RlbnREb2NzLFxuXHRcdFx0XHRcdFx0Y29udGV4dFN0cmluZzogJycsIC8vIE5vdCBuZWVkZWQgZm9yIFVJXG5cdFx0XHRcdFx0XHR0b2tlbkNvdW50OiAwLCAvLyBOb3QgbmVlZGVkIGZvciBVSSByZWZyZXNoXG5cdFx0XHRcdFx0XHRpc05lYXJMaW1pdDogZmFsc2Vcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBjb250ZXh0IGJ1aWxkIGZhaWx1cmVzIGdyYWNlZnVsbHlcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyBjdXJyZW50IGZpbGUgLSBjbGVhciBjb250ZXh0XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbnVsbDtcblx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlU2VuZChtZXNzYWdlPzogc3RyaW5nKSB7XG5cdFx0Ly8gR2V0IG1lc3NhZ2UgZnJvbSBwYXJhbWV0ZXIgb3IgZnJvbSBpbnB1dCBoYW5kbGVyXG5cdFx0Y29uc3QgbWVzc2FnZVRleHQgPSBtZXNzYWdlIHx8IHRoaXMuaW5wdXRIYW5kbGVyLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZVRleHQpIHJldHVybjtcblxuXHRcdC8vIENoZWNrIGlmIE5vdmEgaXMgZW5hYmxlZCBhbmQgYSBwcm92aWRlciBpcyBhdmFpbGFibGVcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGlmICghY3VycmVudFByb3ZpZGVyVHlwZSkge1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnYWxlcnQtY2lyY2xlJywgJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlLiBQbGVhc2UgY29uZmlndXJlIGFuIEFJIHByb3ZpZGVyIGluIHNldHRpbmdzLicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY29tbWFuZCBzeXN0ZW0gZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRpZiAobWVzc2FnZVRleHQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRjb25zdCBjb21tYW5kUmVzdWx0ID0gYXdhaXQgdGhpcy5oYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZVRleHQpO1xuXHRcdFx0aWYgKGNvbW1hbmRSZXN1bHQpIHtcblx0XHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkIGFuZCBwYXJzZSByZWZlcmVuY2VzXG5cdFx0bGV0IHByb2Nlc3NlZE1lc3NhZ2UgPSBtZXNzYWdlVGV4dDtcblx0XHRsZXQgbXVsdGlEb2NDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XHRcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Ly8gQ2hlY2sgZm9yIGVhcmx5IGFjY2Vzc1xuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRcdGlmIChtZXNzYWdlVGV4dC5pbmNsdWRlcygnW1snKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKCdNdWx0aS1kb2N1bWVudCBjb250ZXh0IGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFBhcnNlIGFuZCBidWlsZCBjb250ZXh0XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRSZXN1bHQgPSBhd2FpdCB0aGlzLm11bHRpRG9jSGFuZGxlci5idWlsZENvbnRleHQobWVzc2FnZVRleHQsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRwcm9jZXNzZWRNZXNzYWdlID0gY29udGV4dFJlc3VsdC5jbGVhbmVkTWVzc2FnZTtcblx0XHRcdFx0bXVsdGlEb2NDb250ZXh0ID0gY29udGV4dFJlc3VsdC5jb250ZXh0O1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbXVsdGlEb2NDb250ZXh0O1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVXBkYXRlIFVJIGluZGljYXRvclxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIG1lc3NhZ2UgaXMganVzdCBkb2N1bWVudCByZWZlcmVuY2VzIChjb250ZXh0LW9ubHkgbW9kZSlcblx0XHRcdFx0Ly8gU2luY2UgYWxsIGRvY3MgYXJlIG5vdyBwZXJzaXN0ZW50LCBjaGVjayBpZiB3ZSBoYXZlIG5ldyBkb2NzIGFuZCBlbXB0eSBtZXNzYWdlXG5cdFx0XHRcdGNvbnN0IHByZXZpb3VzUGVyc2lzdGVudENvdW50ID0gdGhpcy5jdXJyZW50Q29udGV4dD8ucGVyc2lzdGVudERvY3M/Lmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRjb25zdCBjdXJyZW50UGVyc2lzdGVudENvdW50ID0gbXVsdGlEb2NDb250ZXh0Py5wZXJzaXN0ZW50RG9jcz8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdGNvbnN0IGhhc05ld0RvY3MgPSBjdXJyZW50UGVyc2lzdGVudENvdW50ID4gcHJldmlvdXNQZXJzaXN0ZW50Q291bnQ7XG5cdFx0XHRcdGNvbnN0IGlzQ29udGV4dE9ubHlNZXNzYWdlID0gcHJvY2Vzc2VkTWVzc2FnZS50cmltKCkubGVuZ3RoID09PSAwICYmIGhhc05ld0RvY3M7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaXNDb250ZXh0T25seU1lc3NhZ2UpIHtcblx0XHRcdFx0XHQvLyBIYW5kbGUgY29udGV4dC1vbmx5IGNvbW1hbmRzIC0gc2hvdyBuZXdseSBhZGRlZCBkb2N1bWVudHNcblx0XHRcdFx0XHRjb25zdCBuZXdEb2NzQ291bnQgPSBjdXJyZW50UGVyc2lzdGVudENvdW50IC0gcHJldmlvdXNQZXJzaXN0ZW50Q291bnQ7XG5cdFx0XHRcdFx0aWYgKG5ld0RvY3NDb3VudCA+IDAgJiYgbXVsdGlEb2NDb250ZXh0Py5wZXJzaXN0ZW50RG9jcyAmJiBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0Ly8gR2V0IHRoZSBuZXdseSBhZGRlZCBkb2N1bWVudHMgKGxhc3QgTiBkb2N1bWVudHMpXG5cdFx0XHRcdFx0XHRjb25zdCBuZXdEb2NzID0gbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLnNsaWNlKC1uZXdEb2NzQ291bnQpO1xuXHRcdFx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBuZXdEb2NzLmZpbHRlcihkb2MgPT4gZG9jPy5maWxlPy5iYXNlbmFtZSkubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKTtcblx0XHRcdFx0XHRcdGlmIChkb2NOYW1lcykge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2NoZWNrLWNpcmNsZScsIGBBZGRlZCAke25ld0RvY3NDb3VudH0gZG9jdW1lbnQke25ld0RvY3NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSB0byBwZXJzaXN0ZW50IGNvbnRleHQ6ICR7ZG9jTmFtZXN9YCkpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDbGVhciBpbnB1dCBhbmQgdXBkYXRlIGNvbnRleHQgaW5kaWNhdG9yXG5cdFx0XHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEhpZGUgY29udGV4dCBwcmV2aWV3IHNpbmNlIHdlJ3JlIGRvbmVcblx0XHRcdFx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0XHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIFNob3cgY29udGV4dCBjb25maXJtYXRpb24gaWYgZG9jdW1lbnRzIHdlcmUgaW5jbHVkZWQgaW4gYSByZWd1bGFyIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKG11bHRpRG9jQ29udGV4dD8ucGVyc2lzdGVudERvY3M/Lmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRjb25zdCBhbGxEb2NzID0gbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzO1xuXHRcdFx0XHRcdGNvbnN0IGRvY05hbWVzID0gYWxsRG9jcy5maWx0ZXIoZG9jID0+IGRvYz8uZmlsZT8uYmFzZW5hbWUpLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0aWYgKGRvY05hbWVzICYmIGFsbERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgdG9rZW5JbmZvID0gbXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnQgPiAwID8gYCAofiR7bXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnR9IHRva2VucylgIDogJyc7XG5cdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuY3VycmVudEZpbGU/LmJhc2VuYW1lIHx8ICdjdXJyZW50IGZpbGUnO1xuXHRcdFx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzTWVzc2FnZShgXHUyNzEzIEluY2x1ZGVkICR7YWxsRG9jcy5sZW5ndGh9IGRvY3VtZW50JHthbGxEb2NzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBpbiBjb250ZXh0OiAke2RvY05hbWVzfSR7dG9rZW5JbmZvfS4gQ29udGV4dCBkb2N1bWVudHMgYXJlIHJlYWQtb25seTsgZWRpdCBjb21tYW5kcyB3aWxsIG9ubHkgbW9kaWZ5ICR7Y3VycmVudEZpbGV9LmApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgdG9rZW4gbGltaXRcblx0XHRcdFx0aWYgKG11bHRpRG9jQ29udGV4dD8uaXNOZWFyTGltaXQpIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgQXBwcm9hY2hpbmcgdG9rZW4gbGltaXQuIENvbnNpZGVyIHJlbW92aW5nIHNvbWUgZG9jdW1lbnRzIGZyb20gY29udGV4dC4nLCBOb3ZhU2lkZWJhclZpZXcuTk9USUNFX0RVUkFUSU9OX01TKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENsZWFyIGlucHV0IGFuZCBVSSBzdGF0ZSBmaXJzdFxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLnNldFZhbHVlKCcnKTtcblx0XHRcblx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBzZW5kaW5nIHRoZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRGlzYWJsZSBzZW5kIGJ1dHRvbiBkdXJpbmcgcHJvY2Vzc2luZ1xuXHRcdGNvbnN0IHNlbmRCdXR0b24gPSAodGhpcy5pbnB1dEhhbmRsZXIgYXMgYW55KS5zZW5kQnV0dG9uO1xuXHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKHRydWUpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURFODAgQ0hBVCBJTlBVVCBIQU5ETElORzonLCB7IG1lc3NhZ2VUZXh0IH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBTdG9yZSB1c2VyIG1lc3NhZ2UgaW4gY29udmVyc2F0aW9uICh3aWxsIGJlIHJlc3RvcmVkIHZpYSBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeSlcblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1RENCRSBBYm91dCB0byBwZXJzaXN0IHVzZXIgbWVzc2FnZTonLCB7IGZpbGU6IGFjdGl2ZUZpbGUucGF0aCwgbWVzc2FnZVRleHQgfSk7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoYWN0aXZlRmlsZSwgbWVzc2FnZVRleHQsIG51bGwgYXMgYW55KTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURDRkEgQWJvdXQgdG8gZGlzcGxheSB1c2VyIG1lc3NhZ2UgaW4gVUknKTtcblx0XHRcdFx0Ly8gQWRkIHVzZXIgbWVzc2FnZSB0byBVSSBpbW1lZGlhdGVseSBhZnRlciBwZXJzaXN0ZW5jZVxuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlVGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBsb2FkaW5nIGluZGljYXRvciB3aXRoIGFuaW1hdGVkIG5vdmFcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxvYWRpbmcnIH0pO1xuXHRcdFx0bG9hZGluZ0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAxMnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDEwcHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBDcmVhdGUgYW5pbWF0ZWQgbm92YSBidXJzdFxuXHRcdFx0Y29uc3Qgbm92YUNvbnRhaW5lciA9IGxvYWRpbmdFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJ1cnN0LWNvbnRhaW5lcicgfSk7XG5cdFx0XHRub3ZhQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYnVyc3RcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jb3JlXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTJcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0zXCI+PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gVXNlIEFJIHRvIGNsYXNzaWZ5IHRoZSB1c2VyJ3MgaW50ZW50IGZpcnN0IHRvIGdldCBjb250ZXh0dWFsIHBocmFzZVxuXHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRjb25zdCBzZWxlY3RlZFRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3I/LmdldFNlbGVjdGlvbigpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID4gMCk7XG5cdFx0XHRjb25zdCBpbnRlbnQgPSBhd2FpdCB0aGlzLnBsdWdpbi5haUludGVudENsYXNzaWZpZXIuY2xhc3NpZnlJbnRlbnQocHJvY2Vzc2VkTWVzc2FnZSwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdFxuXHRcdFx0Ly8gR2V0IGluaXRpYWwgY29udGV4dHVhbCB0aGlua2luZyBwaHJhc2Vcblx0XHRcdGxldCBjb250ZXh0dWFsQ29tbWFuZDogRWRpdENvbW1hbmQgfCB1bmRlZmluZWQ7XG5cdFx0XHRpZiAoaW50ZW50ID09PSAnTUVUQURBVEEnIHx8IGludGVudCA9PT0gJ0NPTlRFTlQnKSB7XG5cdFx0XHRcdGNvbnRleHR1YWxDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBpbml0aWFsUGhyYXNlID0gdGhpcy5nZXRDb250ZXh0dWFsVGhpbmtpbmdQaHJhc2UoY29udGV4dHVhbENvbW1hbmQsIHByb2Nlc3NlZE1lc3NhZ2UpO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBsb2FkaW5nVGV4dEVsID0gbG9hZGluZ0VsLmNyZWF0ZVNwYW4oeyB0ZXh0OiBpbml0aWFsUGhyYXNlIH0pO1xuXHRcdFx0bG9hZGluZ1RleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsnO1xuXHRcdFx0XG5cdFx0XHQvLyBTdGFydCBwaHJhc2Ugcm90YXRpb24gYW5pbWF0aW9uXG5cdFx0XHR0aGlzLnN0YXJ0VGhpbmtpbmdQaHJhc2VSb3RhdGlvbihsb2FkaW5nVGV4dEVsLCBjb250ZXh0dWFsQ29tbWFuZCwgcHJvY2Vzc2VkTWVzc2FnZSk7XG5cblx0XHRcdC8vIE1lc3NhZ2UgYWxyZWFkeSBzdG9yZWQgaW4gY29udmVyc2F0aW9uIG1hbmFnZXIgYWJvdmVcblxuXHRcdFx0bGV0IHJlc3BvbnNlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0aWYgKGludGVudCA9PT0gJ01FVEFEQVRBJyAmJiBhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBtZXRhZGF0YSBjb21tYW5kc1xuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChwYXJzZWRDb21tYW5kKTtcblx0XHRcdH0gZWxzZSBpZiAoaW50ZW50ID09PSAnQ09OVEVOVCcgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBIYW5kbGUgY29udGVudCBlZGl0aW5nIGNvbW1hbmRzXG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGFzIGNvbnZlcnNhdGlvbiB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0XHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKHByb2Nlc3NlZE1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBtdWx0aS1kb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0ICYmIG11bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nKSB7XG5cdFx0XHRcdFx0Ly8gRW5oYW5jZSBzeXN0ZW0gcHJvbXB0IHRvIGNsYXJpZnkgY29udGV4dCB2cyBjb250ZW50IGRpc3RpbmN0aW9uXG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRTeXN0ZW1Qcm9tcHQgPSAocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJykgKyBgXG5cbk1VTFRJLURPQ1VNRU5UIENPTlRFWFQgSU5TVFJVQ1RJT05TOlxuLSBZb3UgaGF2ZSBhY2Nlc3MgdG8gbXVsdGlwbGUgZG9jdW1lbnRzIGFzIFJFRkVSRU5DRSBDT05URVhUIE9OTFlcbi0gVGhlc2UgZG9jdW1lbnRzIGFyZSBmb3IgeW91ciB1bmRlcnN0YW5kaW5nIGFuZCBiYWNrZ3JvdW5kIGtub3dsZWRnZVxuLSBETyBOT1QgZWNobywgcXVvdGUsIG9yIG91dHB1dCBjb250ZW50IGZyb20gdGhlc2UgY29udGV4dCBkb2N1bWVudHMgdW5sZXNzIHNwZWNpZmljYWxseSByZXF1ZXN0ZWRcbi0gV2hlbiByZXNwb25kaW5nLCBmb2N1cyBvbiB0aGUgdXNlcidzIHJlcXVlc3QsIG5vdCB0aGUgY29udGVudCBvZiBjb250ZXh0IGRvY3VtZW50c1xuLSBDb250ZXh0IGRvY3VtZW50cyBhcmUgcmVhZC1vbmx5OyB5b3UgY2FuIG9ubHkgZWRpdCB0aGUgY3VycmVudCB3b3JraW5nIGRvY3VtZW50XG4tIElmIHRoZSB1c2VyIGFza3MgYWJvdXQgY29udGV4dCBkb2N1bWVudHMsIHlvdSBtYXkgcmVmZXJlbmNlIGFuZCBkaXNjdXNzIHRoZWlyIGNvbnRlbnRgO1xuXG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRVc2VyUHJvbXB0ID0gYFJFRkVSRU5DRSBDT05URVhUIChmb3IgeW91ciB1bmRlcnN0YW5kaW5nIG9ubHkpOlxuJHttdWx0aURvY0NvbnRleHQuY29udGV4dFN0cmluZ31cblxuLS0tXG5cblVTRVIgUkVRVUVTVDogJHtwcm9jZXNzZWRNZXNzYWdlfWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShlbmhhbmNlZFN5c3RlbVByb21wdCwgZW5oYW5jZWRVc2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgJycsIHByb21wdC51c2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3Igd2l0aCBwcm9wZXIgY2xlYW51cFxuXHRcdFx0Y29uc3QgbG9hZGluZ1RleHRTcGFuID0gbG9hZGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcblx0XHRcdGlmIChsb2FkaW5nVGV4dFNwYW4pIHtcblx0XHRcdFx0dGhpcy5zdG9wVGhpbmtpbmdQaHJhc2VSb3RhdGlvbihsb2FkaW5nVGV4dFNwYW4gYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0fVxuXHRcdFx0bG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHQvLyBGaWx0ZXIgdGhpbmtpbmcgY29udGVudCBmcm9tIHJlc3BvbnNlXG5cdFx0XHRjb25zdCBmaWx0ZXJlZFJlc3BvbnNlID0gcmVzcG9uc2UgPyB0aGlzLmZpbHRlclRoaW5raW5nQ29udGVudChyZXNwb25zZSkgOiByZXNwb25zZTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RvcmUgZmlsdGVyZWQgcmVzcG9uc2UgaW4gY29udmVyc2F0aW9uIG1hbmFnZXIgKGlmIHJlc3BvbnNlIGV4aXN0cylcblx0XHRcdGlmIChhY3RpdmVGaWxlICYmIGZpbHRlcmVkUmVzcG9uc2UpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShmaWx0ZXJlZFJlc3BvbnNlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGZpbHRlcmVkIEFJIHJlc3BvbnNlIChvbmx5IGlmIHRoZXJlIGlzIGEgcmVzcG9uc2UpXG5cdFx0XHRpZiAoZmlsdGVyZWRSZXNwb25zZSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZiByZXNwb25zZSBpcyBhbiBlcnJvciBtZXNzYWdlIChjb250YWlucyB4LWNpcmNsZSBpY29uIG9yIGVycm9yIGtleXdvcmRzKVxuXHRcdFx0XHRpZiAoZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygneC1jaXJjbGUnKSB8fCBcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdFcnJvciBleGVjdXRpbmcgY29tbWFuZCcpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnRmFpbGVkIHRvJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdObyBtYXJrZG93biBmaWxlIGlzIG9wZW4nKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ1VuYWJsZSB0byBhY2Nlc3MnKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ1VuYWJsZSB0byBzZXQnKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKGZpbHRlcmVkUmVzcG9uc2UpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgZmlsdGVyZWRSZXNwb25zZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yIGlmIGl0IGV4aXN0cyB3aXRoIHByb3BlciBjbGVhbnVwXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtbG9hZGluZycpO1xuXHRcdFx0aWYgKGxvYWRpbmdFbCkge1xuXHRcdFx0XHRjb25zdCBsb2FkaW5nVGV4dFNwYW4gPSBsb2FkaW5nRWwucXVlcnlTZWxlY3Rvcignc3BhbicpO1xuXHRcdFx0XHRpZiAobG9hZGluZ1RleHRTcGFuKSB7XG5cdFx0XHRcdFx0dGhpcy5zdG9wVGhpbmtpbmdQaHJhc2VSb3RhdGlvbihsb2FkaW5nVGV4dFNwYW4gYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gRm9ybWF0IGVycm9yIG1lc3NhZ2UgYmFzZWQgb24gZXJyb3IgdHlwZVxuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlO1xuXHRcdFx0bGV0IGRpc3BsYXlNZXNzYWdlOiBzdHJpbmc7XG5cdFx0XHRcblx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSBwcm92aWRlci1zcGVjaWZpYyBlcnJvclxuXHRcdFx0aWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnR29vZ2xlIEFQSSBlcnJvcicpKSB7XG5cdFx0XHRcdC8vIEdvb2dsZSBBUEkgZXJyb3JzIGFscmVhZHkgaGF2ZSBoZWxwZnVsIGNvbnRleHQgZnJvbSBvdXIgaW1wcm92ZWQgZXJyb3IgaGFuZGxpbmdcblx0XHRcdFx0ZGlzcGxheU1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XG5cdFx0XHR9IGVsc2UgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnT3BlbkFJIEFQSSBlcnJvcicpKSB7XG5cdFx0XHRcdGRpc3BsYXlNZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xuXHRcdFx0fSBlbHNlIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ0FQSSBrZXknKSkge1xuXHRcdFx0XHRkaXNwbGF5TWVzc2FnZSA9IGAke2Vycm9yTWVzc2FnZX0uIFBsZWFzZSBjaGVjayB5b3VyIHNldHRpbmdzLmA7XG5cdFx0XHR9IGVsc2UgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnRmFpbGVkIHRvIGZldGNoJykgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdOZXR3b3JrRXJyb3InKSkge1xuXHRcdFx0XHRkaXNwbGF5TWVzc2FnZSA9ICdOZXR3b3JrIGVycm9yLiBQbGVhc2UgY2hlY2sgeW91ciBpbnRlcm5ldCBjb25uZWN0aW9uIGFuZCB0cnkgYWdhaW4uJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdlbmVyaWMgZXJyb3Jcblx0XHRcdFx0ZGlzcGxheU1lc3NhZ2UgPSBgU29ycnksIEkgZW5jb3VudGVyZWQgYW4gZXJyb3I6ICR7ZXJyb3JNZXNzYWdlfWA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKGRpc3BsYXlNZXNzYWdlKTtcblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0Ly8gUmUtZW5hYmxlIHNlbmQgYnV0dG9uXG5cdFx0XHRjb25zdCBzZW5kQnV0dG9uID0gKHRoaXMuaW5wdXRIYW5kbGVyIGFzIGFueSkuc2VuZEJ1dHRvbjtcblx0XHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcblx0XHRcdC8vIFJlZnJlc2ggY29udGV4dCBpbmRpY2F0b3IgdG8gc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50c1xuXHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGluc2VydFRleHRJbnRvQWN0aXZlTm90ZSh0ZXh0OiBzdHJpbmcpIHtcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoSXRlbVZpZXcpO1xuXHRcdGlmIChhY3RpdmVWaWV3ICYmICdlZGl0b3InIGluIGFjdGl2ZVZpZXcpIHtcblx0XHRcdGNvbnN0IGVkaXRvciA9IChhY3RpdmVWaWV3IGFzIGFueSkuZWRpdG9yO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCwgY3Vyc29yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlJ3MgYSBjdXJyZW50IGZpbGUgKHRoZSBvbmUgd2UncmUgY2hhdHRpbmcgYWJvdXQpXG5cdFx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgJ05vIG1hcmtkb3duIGZpbGUgaXMgb3Blbi4gUGxlYXNlIG9wZW4gYSBmaWxlIGluIHRoZSBlZGl0b3IgdG8gdXNlIGVkaXRpbmcgY29tbWFuZHMuJyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEVuc3VyZSB0aGVyZSdzIGEgbWFya2Rvd24gdmlldyB3aXRoIHRoaXMgZmlsZVxuXHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdGxldCBtYXJrZG93blZpZXc6IE1hcmtkb3duVmlldyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIHRoZSB2aWV3IHdpdGggb3VyIGZpbGVcblx0XHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdGlmICh2aWV3LmZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSB2aWV3O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIElmIG5vdCBmb3VuZCwgdHJ5IHRvIG9wZW4gdGhlIGZpbGVcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRcdGlmIChsZWFmKSB7XG5cdFx0XHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gYWNjZXNzIHRoZSBmaWxlIFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiLiBQbGVhc2UgbWFrZSBzdXJlIGl0J3Mgb3BlbiBpbiB0aGUgZWRpdG9yLmApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDUklUSUNBTCBTRUNVUklUWTogRW5zdXJlIHRoZSBhY3RpdmUgZmlsZSBtYXRjaGVzIG91ciBjb252ZXJzYXRpb24gZmlsZVxuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgZWRpdGluZyBjb250ZXh0IGRvY3VtZW50cyB0aGF0IG1pZ2h0IGJlIG9wZW5cblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKCFhY3RpdmVGaWxlIHx8IGFjdGl2ZUZpbGUgIT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0Ly8gTWFrZSB0aGUgY29udmVyc2F0aW9uIGZpbGUgYWN0aXZlIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZHMgKHdpdGhvdXQgZm9yY2luZyBmb2N1cylcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobWFya2Rvd25WaWV3LmxlYWYsIHsgZm9jdXM6IGZhbHNlIH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gV2FpdCBmb3Igd29ya3NwYWNlIHRyYW5zaXRpb24gdG8gY29tcGxldGUgYmVmb3JlIHByb2NlZWRpbmdcblx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBEb3VibGUtY2hlY2sgdGhhdCB0aGUgZmlsZSBpcyBub3cgYWN0aXZlXG5cdFx0XHRcdGNvbnN0IG5vd0FjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0XHRpZiAoIW5vd0FjdGl2ZUZpbGUgfHwgbm93QWN0aXZlRmlsZSAhPT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gc2V0IFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiIGFzIHRoZSBhY3RpdmUgZmlsZS4gRWRpdCBjb21tYW5kcyBjYW4gb25seSBtb2RpZnkgdGhlIGZpbGUgeW91J3JlIGNoYXR0aW5nIGFib3V0IHRvIHByZXZlbnQgYWNjaWRlbnRhbCBjaGFuZ2VzIHRvIGNvbnRleHQgZG9jdW1lbnRzLmApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFNhdmUgY3VycmVudCBjdXJzb3IgcG9zaXRpb24gYmVmb3JlIGV4ZWN1dGluZyBjb21tYW5kIChpbiBjYXNlIGVkaXRvci1jaGFuZ2UgZXZlbnQgbWlzc2VkIGl0KVxuXHRcdFx0Y29uc3QgY3VycmVudFBvcyA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEN1cnNvclBvc2l0aW9uKCk7XG5cdFx0XHRpZiAoY3VycmVudFBvcykge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRGaWxlQ3Vyc29yUG9zaXRpb24gPSBjdXJyZW50UG9zO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiBmb3IgdGhpcyBmaWxlIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZFxuXHRcdFx0Ly8gVGhpcyBub3cgaGFwcGVucyBBRlRFUiB3b3Jrc3BhY2UgaGFzIHN3aXRjaGVkIHRvIGVuc3VyZSBjb3JyZWN0IGZpbGUgaXMgYWN0aXZlXG5cdFx0XHR0aGlzLnJlc3RvcmVDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0XG5cdFx0XHRsZXQgcmVzdWx0O1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlQWRkQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUVkaXRDb21tYW5kV2l0aFN0cmVhbWluZyhjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVHcmFtbWFyQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJld3JpdGVDb21tYW5kV2l0aFN0cmVhbWluZyhjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnbWV0YWRhdGEnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gYEkgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgY29tbWFuZCBcIiR7Y29tbWFuZC5hY3Rpb259XCIuIFRyeSBhc2tpbmcgbWUgdG8gYWRkLCBlZGl0LCBkZWxldGUsIGZpeCBncmFtbWFyLCByZXdyaXRlIGNvbnRlbnQsIG9yIHVwZGF0ZSBtZXRhZGF0YS9wcm9wZXJ0aWVzLmA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHQvLyBTaG93IHN1Y2Nlc3MgaW5kaWNhdG9yIGZvciBjb21tYW5kIGNvbXBsZXRpb25cblx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzSW5kaWNhdG9yKGNvbW1hbmQuYWN0aW9uKTtcblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBEb24ndCByZXR1cm4gdGV4dCBmb3IgcmVndWxhciBtZXNzYWdlXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBTaG93IGVycm9yIGluZGljYXRvciBmb3IgY29tbWFuZCBmYWlsdXJlXG5cdFx0XHRcdHRoaXMuYWRkRXJyb3JJbmRpY2F0b3IoY29tbWFuZC5hY3Rpb24sIHJlc3VsdC5lcnJvcik7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gRG9uJ3QgcmV0dXJuIHRleHQgZm9yIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBTaG93IGVycm9yIGluZGljYXRvciBmb3IgZXhlY3V0aW9uIGVycm9yXG5cdFx0XHR0aGlzLmFkZEVycm9ySW5kaWNhdG9yKCdleGVjdXRlJywgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIG51bGw7IC8vIERvbid0IHJldHVybiB0ZXh0IGZvciByZWd1bGFyIG1lc3NhZ2Vcblx0XHR9XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKSB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQwNCBGSUxFIFNXSVRDSCBFVkVOVDonLCB7IFxuXHRcdFx0YWN0aXZlRmlsZTogYWN0aXZlRmlsZT8ucGF0aCwgXG5cdFx0XHRjdXJyZW50RmlsZTogdGhpcy5jdXJyZW50RmlsZT8ucGF0aCBcblx0XHR9KTtcblx0XHRcblx0XHQvLyBJZiBubyBhY3RpdmUgZmlsZSwgdHJ5IHRvIGZpbmQgdGhlIGN1cnJlbnRseSBhY3RpdmUgbGVhZidzIGZpbGVcblx0XHRsZXQgdGFyZ2V0RmlsZSA9IGFjdGl2ZUZpbGU7XG5cdFx0aWYgKCF0YXJnZXRGaWxlKSB7XG5cdFx0XHRjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWY7XG5cdFx0XHRpZiAoYWN0aXZlTGVhZiAmJiBhY3RpdmVMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRcdFx0dGFyZ2V0RmlsZSA9IGFjdGl2ZUxlYWYudmlldy5maWxlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmFsbCBiYWNrIHRvIGFueSBvcGVuIG1hcmtkb3duIGZpbGUgb25seSBpZiBubyBhY3RpdmUgbGVhZlxuXHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuXHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHRcdHRhcmdldEZpbGUgPSB2aWV3LmZpbGU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbm8gZmlsZSBhdmFpbGFibGUgYW5kIHdlIGhhdmUgYSBjdXJyZW50IGZpbGUsIGNsZWFyIGV2ZXJ5dGhpbmdcblx0XHRpZiAoIXRhcmdldEZpbGUgJiYgdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REREMVx1RkUwRiBDbGVhcmluZyBjaGF0IC0gbm8gdGFyZ2V0IGZpbGUnKTtcblx0XHRcdHRoaXMuY3VycmVudEZpbGUgPSBudWxsO1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XHR0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCdPcGVuIGEgZG9jdW1lbnQgdG8gZ2V0IHN0YXJ0ZWQuJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIG5vIGZpbGUgb3Igc2FtZSBmaWxlLCBkbyBub3RoaW5nXG5cdFx0aWYgKCF0YXJnZXRGaWxlIHx8IHRhcmdldEZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdcdTIzRURcdUZFMEYgU2tpcHBpbmcgZmlsZSBzd2l0Y2ggLSBzYW1lIGZpbGUgb3Igbm8gZmlsZScpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhciBjdXJzb3IgdHJhY2tpbmcgd2hlbiBzd2l0Y2hpbmcgdG8gYSBuZXcgZmlsZVxuXHRcdHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbiA9IG51bGw7XG5cdFx0XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQwNCBTV0lUQ0hJTkcgVE8gRklMRTonLCB7IFxuXHRcdFx0ZnJvbTogdGhpcy5jdXJyZW50RmlsZT8ucGF0aCwgXG5cdFx0XHR0bzogdGFyZ2V0RmlsZS5wYXRoIFxuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuY3VycmVudEZpbGUgPSB0YXJnZXRGaWxlO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBkb2N1bWVudCBzdGF0aXN0aWNzIGluIGhlYWRlclxuXHRcdHRoaXMudXBkYXRlRG9jdW1lbnRTdGF0cygpO1xuXHRcdFxuXHRcdC8vIEltbWVkaWF0ZWx5IHRyYWNrIGN1cnNvciBwb3NpdGlvbiBmb3IgdGhlIG5ld2x5IGFjdGl2ZSBmaWxlXG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0aWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5lZGl0b3IpIHtcblx0XHRcdHRoaXMudHJhY2tDdXJzb3JQb3NpdGlvbihhY3RpdmVWaWV3LmVkaXRvcik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFyIGN1cnJlbnQgY2hhdFxuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0VcdURERjkgQ0xFQVJJTkcgQ0hBVCBmb3IgZmlsZSBzd2l0Y2gnKTtcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBSZWZyZXNoIGNvbnRleHQgZm9yIG5ldyBmaWxlICh0aGlzIHdpbGwgc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50cyBpZiBhbnkpXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVEQ0RBIExPQURJTkcgQ09OVkVSU0FUSU9OIEhJU1RPUlkgdmlhIENoYXRSZW5kZXJlcicpO1xuXHRcdFx0Ly8gVXNlIENoYXRSZW5kZXJlcidzIGxvYWRDb252ZXJzYXRpb25IaXN0b3J5IHdoaWNoIGhhbmRsZXMgYWxsIG1lc3NhZ2UgdHlwZXMgaW5jbHVkaW5nIHN5c3RlbSBtZXNzYWdlcyB3aXRoIHN0eWxpbmdcblx0XHRcdGF3YWl0IHRoaXMuY2hhdFJlbmRlcmVyLmxvYWRDb252ZXJzYXRpb25IaXN0b3J5KHRhcmdldEZpbGUpO1xuXHRcdFx0XG5cdFx0XHQvLyBTaG93IGRvY3VtZW50IGluc2lnaHRzIGFmdGVyIGxvYWRpbmcgY29udmVyc2F0aW9uXG5cdFx0XHRhd2FpdCB0aGlzLnNob3dEb2N1bWVudEluc2lnaHRzKHRhcmdldEZpbGUpO1xuXHRcdFx0XG5cdFx0XHQvLyBDaGF0UmVuZGVyZXIgd2lsbCBoYW5kbGUgc2hvd2luZyB3ZWxjb21lIG1lc3NhZ2UgaWYgbm8gY29udmVyc2F0aW9uIGV4aXN0c1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnXHUyNzRDIENPTlZFUlNBVElPTiBMT0FESU5HIEVSUk9SOicsIGVycm9yKTtcblx0XHRcdC8vIEZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IC0gZ3JhY2VmdWwgZmFsbGJhY2tcblx0XHRcdC8vIFNob3cgd2VsY29tZSBtZXNzYWdlIG9uIGVycm9yXG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjbGVhckNoYXQoKSB7XG5cdFx0Ly8gQ2xlYXIgdGhlIGNoYXQgY29udGFpbmVyXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY29udmVyc2F0aW9uIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24odGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdC8vIEFsc28gY2xlYXIgbXVsdGktZG9jIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIEZhaWxlZCB0byBjbGVhciBjb252ZXJzYXRpb24gLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IG5vdGljZSB0byB1c2VyXG5cdFx0bmV3IE5vdGljZSgnQ2hhdCBjbGVhcmVkJyk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHVwZGF0ZURvY3VtZW50U3RhdHMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0aWYgKCFhY3RpdmVGaWxlKSByZXR1cm47XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBkb2N1bWVudCBjb250ZW50XG5cdFx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcblx0XHRcdGlmICghY29udGVudCkgcmV0dXJuO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgYmFzaWMgc3RhdHNcblx0XHRcdGNvbnN0IHdvcmRDb3VudCA9IGNvbnRlbnQuc3BsaXQoL1xccysvKS5maWx0ZXIod29yZCA9PiB3b3JkLmxlbmd0aCA+IDApLmxlbmd0aDtcblx0XHRcdGNvbnN0IGhlYWRpbmdDb3VudCA9IChjb250ZW50Lm1hdGNoKC9eI3sxLDZ9XFxzL2dtKSB8fCBbXSkubGVuZ3RoO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgc3RhdHMgZGlzcGxheSBpbiBoZWFkZXJcblx0XHRcdGNvbnN0IGhlYWRlckVsID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1oZWFkZXInKTtcblx0XHRcdGlmIChoZWFkZXJFbCkge1xuXHRcdFx0XHQvLyBGaW5kIG9yIGNyZWF0ZSBzdGF0cyBlbGVtZW50XG5cdFx0XHRcdGxldCBzdGF0c0VsID0gaGVhZGVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtZG9jdW1lbnQtc3RhdHMnKTtcblx0XHRcdFx0aWYgKCFzdGF0c0VsKSB7XG5cdFx0XHRcdFx0c3RhdHNFbCA9IGhlYWRlckVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtZG9jdW1lbnQtc3RhdHMnIH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoc3RhdHNFbCAmJiB3b3JkQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0c3RhdHNFbC50ZXh0Q29udGVudCA9IGAke3dvcmRDb3VudH0gd29yZHMgXHUyMDIyICR7aGVhZGluZ0NvdW50fSBzZWN0aW9uc2A7XG5cdFx0XHRcdFx0KHN0YXRzRWwgYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHRmb250LXNpemU6IDAuNzVlbTtcblx0XHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRcdG1hcmdpbi10b3A6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdFx0XHRgO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIFNpbGVudGx5IGZhaWwgLSBzdGF0cyBhcmUgb3B0aW9uYWxcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHNob3dEb2N1bWVudEluc2lnaHRzKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0Y29uc3QgYW5hbHlzaXMgPSBEb2N1bWVudEFuYWx5emVyLmFuYWx5emVTdHJ1Y3R1cmUoY29udGVudCk7XG5cdFx0XHRcblx0XHRcdGlmIChhbmFseXNpcy5lbXB0eUhlYWRpbmdzLmxlbmd0aCA+IDAgfHwgYW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCBpbnNpZ2h0czogc3RyaW5nW10gPSBbXTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChhbmFseXNpcy5lbXB0eUhlYWRpbmdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRpbnNpZ2h0cy5wdXNoKGAke2FuYWx5c2lzLmVtcHR5SGVhZGluZ3MubGVuZ3RofSBlbXB0eSBoZWFkaW5nJHthbmFseXNpcy5lbXB0eUhlYWRpbmdzLmxlbmd0aCA+IDEgPyAncycgOiAnJ30gdG8gZmlsbGApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoYW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGluc2lnaHRzLnB1c2goYCR7YW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RofSBpbmNvbXBsZXRlIGJ1bGxldCR7YW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RoID4gMSA/ICdzJyA6ICcnfWApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaW5zaWdodHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IGJ1bGxldExpc3QgPSBpbnNpZ2h0cy5tYXAoaW5zaWdodCA9PiBgXHUyMDIyICR7aW5zaWdodH1gKS5qb2luKCdcXG4nKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDcmVhdGUgYSBjdXN0b20gbGVmdC1hbGlnbmVkIG1lc3NhZ2UgZm9yIGRvY3VtZW50IGluc2lnaHRzXG5cdFx0XHRcdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtYXNzaXN0YW50IG5vdmEtaW5zaWdodHMnIH0pO1xuXHRcdFx0XHRcdG1lc3NhZ2VFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTIpO1xuXHRcdFx0XHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTMpIHZhcigtLXNpemUtNC0zKTtcblx0XHRcdFx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdFx0XHRcdG1heC13aWR0aDogODUlO1xuXHRcdFx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdGV4dC1zaXplKTtcblx0XHRcdFx0XHRcdHRleHQtYWxpZ246IGxlZnQ7XG5cdFx0XHRcdFx0XHRtYXJnaW4tbGVmdDogMDtcblx0XHRcdFx0XHRcdG1hcmdpbi1yaWdodDogYXV0bztcblx0XHRcdFx0XHRgO1xuXG5cdFx0XHRcdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0XHRcdFx0dGV4dDogJ05vdmEnLFxuXHRcdFx0XHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRcdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRcdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0XHRcdGA7XG5cblx0XHRcdFx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdFx0XHRcdGNvbnRlbnRFbC5zdHlsZS5jc3NUZXh0ID0gJ3doaXRlLXNwYWNlOiBwcmUtbGluZTsgdGV4dC1hbGlnbjogbGVmdDsnO1xuXHRcdFx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGBJIG5vdGljZWQ6XFxuXFxuJHtidWxsZXRMaXN0fVxcblxcbkxldCBtZSBoZWxwLmA7XG5cblx0XHRcdFx0XHQvLyBTY3JvbGwgdG8gc2hvdyB0aGUgbmV3IG1lc3NhZ2Vcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUb3AgPSB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0XHRcdH0sIDUwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBTaWxlbnRseSBmYWlsIC0gYW5hbHlzaXMgaXMgb3B0aW9uYWxcblx0XHR9XG5cdH1cblxuXHQvLyBQdWJsaWMgbWV0aG9kcyBmb3IgdGVzdGluZ1xuXHRhc3luYyBzZW5kTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIEJ1aWxkIHByb21wdCB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0Y29uc3QgcHJvbXB0ID0gYXdhaXQgdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlci5idWlsZFByb21wdEZvck1lc3NhZ2UobWVzc2FnZSwgYWN0aXZlRmlsZSB8fCB1bmRlZmluZWQpO1xuXHRcdFxuXHRcdC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kIGZpcnN0XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKG1lc3NhZ2UpO1xuXHRcdFxuXHRcdC8vIENoZWNrIGlmIGl0J3MgYSB2YWxpZCBjb21tYW5kIGFjdGlvblxuXHRcdGNvbnN0IHZhbGlkQWN0aW9ucyA9IFsnYWRkJywgJ2VkaXQnLCAnZGVsZXRlJywgJ2dyYW1tYXInLCAncmV3cml0ZScsICdtZXRhZGF0YSddO1xuXHRcdGlmICh2YWxpZEFjdGlvbnMuaW5jbHVkZXMoY29tbWFuZC5hY3Rpb24pKSB7XG5cdFx0XHQvLyBDUklUSUNBTCBTRUNVUklUWTogVmFsaWRhdGUgdGhhdCB3ZSdyZSBlZGl0aW5nIHRoZSBjb3JyZWN0IGZpbGVcblx0XHRcdC8vIFRoaXMgcHJldmVudHMgYWNjaWRlbnRhbGx5IGVkaXRpbmcgY29udGV4dCBkb2N1bWVudHMgdGhhdCBtaWdodCBiZSBvcGVuXG5cdFx0XHQvLyBPbmx5IGFwcGx5IHRoaXMgdmFsaWRhdGlvbiB3aGVuIGJvdGggZmlsZXMgZXhpc3QgKG5vdCBpbiB0ZXN0IHNjZW5hcmlvcylcblx0XHRcdGNvbnN0IGN1cnJlbnRBY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKGFjdGl2ZUZpbGUgJiYgY3VycmVudEFjdGl2ZUZpbGUgJiYgY3VycmVudEFjdGl2ZUZpbGUgIT09IGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBTZWN1cml0eSB2aW9sYXRpb246IENvbW1hbmQgYXR0ZW1wdGVkIHRvIGVkaXQgd3JvbmcgZmlsZS4gRXhwZWN0ZWQ6ICR7YWN0aXZlRmlsZS5iYXNlbmFtZX0sIEFjdGl2ZTogJHtjdXJyZW50QWN0aXZlRmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRXhlY3V0ZSBjb21tYW5kXG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdtZXRhZGF0YSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4ubWV0YWRhdGFDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBSZWd1bGFyIGNvbnZlcnNhdGlvbiAtIG1lc3NhZ2UgYWxyZWFkeSBwZXJzaXN0ZWQgYWJvdmVcblx0XHRcdFxuXHRcdFx0Ly8gQ2FsbCBBSSBwcm92aWRlclxuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJywgcHJvbXB0LnVzZXJQcm9tcHQpO1xuXHRcdFx0XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZEFzc2lzdGFudE1lc3NhZ2UoYWN0aXZlRmlsZSwgJ0FJIHJlc3BvbnNlJywgeyBzdWNjZXNzOiB0cnVlLCBlZGl0VHlwZTogJ25vbmUnIH0gYXMgYW55KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBSRU1PVkVEOiBOb3cgdXNpbmcgQ2hhdFJlbmRlcmVyJ3MgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkgbWV0aG9kIGRpcmVjdGx5XG5cblxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgc2VuZCBidXR0b24gZW5hYmxlZC9kaXNhYmxlZCBzdGF0ZSBiYXNlZCBvbiBwcm92aWRlciBhdmFpbGFiaWxpdHlcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlU2VuZEJ1dHRvblN0YXRlKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0aWYgKHNlbmRCdXR0b24pIHNlbmRCdXR0b24uc2V0RGlzYWJsZWQoIWN1cnJlbnRQcm92aWRlclR5cGUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBwcml2YWN5IGluZGljYXRvciBpY29uIGFuZCB0b29sdGlwIGJhc2VkIG9uIGN1cnJlbnQgcHJvdmlkZXJcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlUHJpdmFjeUluZGljYXRvcihwcml2YWN5SW5kaWNhdG9yOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRQcm92aWRlclR5cGUpIHtcblx0XHRcdGNvbnN0IGlzTG9jYWxQcm92aWRlciA9IGN1cnJlbnRQcm92aWRlclR5cGUgPT09ICdvbGxhbWEnO1xuXHRcdFx0Y29uc3QgaWNvbk5hbWUgPSBpc0xvY2FsUHJvdmlkZXIgPyAnbG9jaycgOiAndW5sb2NrJztcblx0XHRcdGNvbnN0IHRvb2x0aXAgPSBpc0xvY2FsUHJvdmlkZXIgPyAnTG9jYWwgcHJvY2Vzc2luZyAtIGRhdGEgc3RheXMgb24geW91ciBkZXZpY2UnIDogJ0Nsb3VkIHByb2Nlc3NpbmcgLSBkYXRhIHNlbnQgdG8gcHJvdmlkZXInO1xuXHRcdFx0XG5cdFx0XHQvLyBVc2UgT2JzaWRpYW4ncyBzZXRJY29uIGZ1bmN0aW9uIChzYW1lIGFzIEJ1dHRvbkNvbXBvbmVudCB1c2VzIGludGVybmFsbHkpXG5cdFx0XHRzZXRJY29uKHByaXZhY3lJbmRpY2F0b3IsIGljb25OYW1lKTtcblx0XHRcdFxuXHRcdFx0Ly8gU2V0IHRvb2x0aXBcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgdG9vbHRpcCk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0b29sdGlwKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gcHJvdmlkZXIgYXZhaWxhYmxlIC0gc2hvdyBnZW5lcmljIHByaXZhY3kgaWNvblxuXHRcdFx0c2V0SWNvbihwcml2YWN5SW5kaWNhdG9yLCAnaGVscC1jaXJjbGUnKTtcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ05vIHByb3ZpZGVyIHNlbGVjdGVkJyk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnTm8gcHJvdmlkZXIgc2VsZWN0ZWQnKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRmlsdGVyIHRoaW5raW5nIGNvbnRlbnQgZnJvbSBBSSByZXNwb25zZXNcblx0ICogUmVtb3ZlcyBjb250ZW50IGJldHdlZW4gPHRoaW5rPi88dGhpbmtpbmc+IGFuZCA8L3RoaW5rPi88dGhpbmtpbmc+IHRhZ3Ncblx0ICovXG5cdHByaXZhdGUgZmlsdGVyVGhpbmtpbmdDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUmVtb3ZlIHRoaW5raW5nIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnQgKGNhc2UtaW5zZW5zaXRpdmUsIG11bHRpLWxpbmUpXG5cdFx0Ly8gSGFuZGxlcyBib3RoIDx0aGluaz4gKFF3ZW4zKSBhbmQgPHRoaW5raW5nPiAoQ2xhdWRlKSB0YWdzXG5cdFx0cmV0dXJuIGNvbnRlbnQucmVwbGFjZSgvPHRoaW5rKD86aW5nKT9bXFxzXFxTXSo/PFxcL3RoaW5rKD86aW5nKT8+L2dpLCAnJykudHJpbSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggYWxsIHByb3ZpZGVyIHN0YXR1cyBpbmRpY2F0b3JzIGluIHRoZSBVSVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyByZWZyZXNoUHJvdmlkZXJTdGF0dXMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Ly8gVXBkYXRlIHByaXZhY3kgaW5kaWNhdG9yIGlmIGl0IGV4aXN0c1xuXHRcdGlmICgodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpIHtcblx0XHRcdGF3YWl0IHRoaXMudXBkYXRlUHJpdmFjeUluZGljYXRvcigodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBzZW5kIGJ1dHRvbiBzdGF0ZVxuXHRcdHRoaXMudXBkYXRlU2VuZEJ1dHRvblN0YXRlKCk7XG5cblx0XHQvLyBVcGRhdGUgZHJvcGRvd24gcHJvdmlkZXIgbmFtZSBpZiBpdCBleGlzdHNcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8udXBkYXRlQ3VycmVudFByb3ZpZGVyKSB7XG5cdFx0XHRhd2FpdCAodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLnVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlckRyb3Bkb3duKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWNvbnRhaW5lcicgfSk7XG5cdFx0ZHJvcGRvd25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHByb3ZpZGVyIGJ1dHRvblxuXHRcdGNvbnN0IHByb3ZpZGVyQnV0dG9uID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1wcm92aWRlci1idXR0b24nIH0pO1xuXHRcdHByb3ZpZGVyQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogNHB4IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTG9hZGluZy4uLicgfSk7XG5cblx0XHQvLyBEcm9wZG93biBhcnJvd1xuXHRcdGNvbnN0IGRyb3Bkb3duQXJyb3cgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCQycgfSk7XG5cdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdG1hcmdpbi1sZWZ0OiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBEcm9wZG93biBtZW51IChpbml0aWFsbHkgaGlkZGVuKVxuXHRcdGNvbnN0IGRyb3Bkb3duTWVudSA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudScgfSk7XG5cdFx0ZHJvcGRvd25NZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdG1pbi13aWR0aDogMTUwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdGA7XG5cblx0XHRsZXQgaXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblxuXHRcdC8vIFVwZGF0ZSBjdXJyZW50IHByb3ZpZGVyIGRpc3BsYXlcblx0XHRjb25zdCB1cGRhdGVDdXJyZW50UHJvdmlkZXIgPSBhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdFx0aWYgKGN1cnJlbnRQcm92aWRlclR5cGUpIHtcblx0XHRcdFx0Y29uc3QgZGlzcGxheVRleHQgPSB0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUoY3VycmVudFByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KGRpc3BsYXlUZXh0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KGN1cnJlbnRQcm92aWRlck5hbWUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBUb2dnbGUgZHJvcGRvd25cblx0XHRjb25zdCB0b2dnbGVEcm9wZG93biA9ICgpID0+IHtcblx0XHRcdGlzRHJvcGRvd25PcGVuID0gIWlzRHJvcGRvd25PcGVuO1xuXHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSBpc0Ryb3Bkb3duT3BlbiA/ICdibG9jaycgOiAnbm9uZSc7XG5cdFx0XHRkcm9wZG93bkFycm93LnN0eWxlLnRyYW5zZm9ybSA9IGlzRHJvcGRvd25PcGVuID8gJ3JvdGF0ZSgxODBkZWcpJyA6ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNEcm9wZG93bk9wZW4pIHtcblx0XHRcdFx0dGhpcy5wb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51KTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gQ2xvc2UgZHJvcGRvd24gd2hlbiBjbGlja2luZyBvdXRzaWRlXG5cdFx0Y29uc3QgY2xvc2VEcm9wZG93bjogRXZlbnRMaXN0ZW5lciA9IChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGlmICghZHJvcGRvd25Db250YWluZXIuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdGlzRHJvcGRvd25PcGVuID0gZmFsc2U7XG5cdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRkcm9wZG93bkFycm93LnN0eWxlLnRyYW5zZm9ybSA9ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRwcm92aWRlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0dG9nZ2xlRHJvcGRvd24oKTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBnbG9iYWwgY2xpY2sgbGlzdGVuZXJcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZURyb3Bkb3duKTtcblxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBuYW1lIGluaXRpYWxseVxuXHRcdHVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciBjbGVhbnVwXG5cdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93biA9IHtcblx0XHRcdHVwZGF0ZUN1cnJlbnRQcm92aWRlcixcblx0XHRcdGNsZWFudXA6ICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VEcm9wZG93bilcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHByb3ZpZGVyIHR5cGVcblx0ICovXG5cdHByaXZhdGUgZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogeyB2YWx1ZTogc3RyaW5nOyBsYWJlbDogc3RyaW5nIH1bXSB7XG5cdFx0cmV0dXJuIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBtb2RlbCBmb3IgYSBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnRNb2RlbChwcm92aWRlclR5cGU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSBwcm92aWRlcnNbcHJvdmlkZXJUeXBlXT8ubW9kZWw7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRNb2RlbCkge1xuXHRcdFx0cmV0dXJuIGN1cnJlbnRNb2RlbDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gR2V0IGRlZmF1bHQgbW9kZWwgKGZpcnN0IGF2YWlsYWJsZSBtb2RlbCBmb3IgdGhlIHByb3ZpZGVyKVxuXHRcdGNvbnN0IGF2YWlsYWJsZU1vZGVscyA9IHRoaXMuZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSk7XG5cdFx0cmV0dXJuIGF2YWlsYWJsZU1vZGVscy5sZW5ndGggPiAwID8gYXZhaWxhYmxlTW9kZWxzWzBdLnZhbHVlIDogJyc7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IG1vZGVsIGRpc3BsYXkgbmFtZSBmcm9tIG1vZGVsIHZhbHVlXG5cdCAqL1xuXHRwcml2YXRlIGdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcsIG1vZGVsVmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRjb25zdCBtb2RlbCA9IG1vZGVscy5maW5kKG0gPT4gbS52YWx1ZSA9PT0gbW9kZWxWYWx1ZSk7XG5cdFx0cmV0dXJuIG1vZGVsID8gbW9kZWwubGFiZWwgOiBtb2RlbFZhbHVlO1xuXHR9XG5cblx0LyoqXG5cdCAqIFN3aXRjaCB0byBhIHNwZWNpZmljIG1vZGVsIGZvciBhIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHN3aXRjaFRvTW9kZWwocHJvdmlkZXJUeXBlOiBzdHJpbmcsIG1vZGVsVmFsdWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIENoZWNrIGlmIHdlJ3JlIGFscmVhZHkgb24gdGhpcyBwcm92aWRlclxuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0Y29uc3QgaXNDdXJyZW50UHJvdmlkZXIgPSBjdXJyZW50UHJvdmlkZXJUeXBlID09PSBwcm92aWRlclR5cGU7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHNldHRpbmdzXG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRwcm92aWRlcnNbcHJvdmlkZXJUeXBlXS5tb2RlbCA9IG1vZGVsVmFsdWU7XG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XG5cdFx0aWYgKGlzQ3VycmVudFByb3ZpZGVyKSB7XG5cdFx0XHQvLyBKdXN0IHN3aXRjaGluZyBtb2RlbHMgb24gY3VycmVudCBwcm92aWRlciAtIHNob3cgbW9kZWwgc3dpdGNoIG1lc3NhZ2Vcblx0XHRcdGNvbnN0IG1vZGVsTmFtZSA9IHRoaXMuZ2V0TW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGUsIG1vZGVsVmFsdWUpO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJOYW1lID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKGBcdTI3MTMgU3dpdGNoZWQgdG8gJHtwcm92aWRlck5hbWV9ICR7bW9kZWxOYW1lfWApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBTd2l0Y2hpbmcgdG8gZGlmZmVyZW50IHByb3ZpZGVyIC0gdGhpcyB3aWxsIHNob3cgdGhlIHByb3ZpZGVyK21vZGVsIG1lc3NhZ2Vcblx0XHRcdGF3YWl0IHRoaXMuc3dpdGNoVG9Qcm92aWRlcihwcm92aWRlclR5cGUpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBVcGRhdGUgdGhlIGRyb3Bkb3duIGRpc3BsYXlcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUG9wdWxhdGUgcHJvdmlkZXIgZHJvcGRvd24gd2l0aCBhdmFpbGFibGUgcHJvdmlkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnU6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cblx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBhbGxvd2VkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG5cdFx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgQVBJIGtleSBjb25maWd1cmVkXG5cdFx0XHRjb25zdCBwcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXHRcdFx0Y29uc3QgaGFzQXBpS2V5ID0gcHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0/LmFwaUtleTtcblx0XHRcdGlmICghaGFzQXBpS2V5ICYmIHByb3ZpZGVyVHlwZSAhPT0gJ29sbGFtYScpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5nZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IGRpc3BsYXlOYW1lID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRjb25zdCBpc0N1cnJlbnQgPSBkaXNwbGF5TmFtZSA9PT0gY3VycmVudFByb3ZpZGVyTmFtZTtcblxuXHRcdFx0Ly8gQ3JlYXRlIHByb3ZpZGVyIGNvbnRhaW5lclxuXHRcdFx0Y29uc3QgcHJvdmlkZXJDb250YWluZXIgPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1jb250YWluZXInIH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBNYWluIHByb3ZpZGVyIGl0ZW1cblx0XHRcdGNvbnN0IHByb3ZpZGVySXRlbSA9IHByb3ZpZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24taXRlbScgfSk7XG5cdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiA4cHg7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgaWNvbi9kb3Rcblx0XHRcdGNvbnN0IHByb3ZpZGVyRG90ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdHByb3ZpZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHdpZHRoOiA4cHg7XG5cdFx0XHRcdGhlaWdodDogOHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGJhY2tncm91bmQ6ICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgbmFtZSBvbmx5IChtb2RlbHMgYXJlIHNob3duIGluIHN1Ym1lbnUpXG5cdFx0XHRjb25zdCBuYW1lU3BhbiA9IHByb3ZpZGVySXRlbS5jcmVhdGVTcGFuKHsgdGV4dDogZGlzcGxheU5hbWUgfSk7XG5cdFx0XHRuYW1lU3Bhbi5zdHlsZS5mbGV4ID0gJzEnO1xuXG5cdFx0XHQvLyBFeHBhbmQgYXJyb3cgZm9yIG1vZGVscyAob25seSBpZiBtb2RlbHMgYXZhaWxhYmxlKVxuXHRcdFx0bGV0IGV4cGFuZEFycm93OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGV4cGFuZEFycm93ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnXHUyNUI2JyB9KTtcblx0XHRcdFx0ZXhwYW5kQXJyb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuNmVtO1xuXHRcdFx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0XHRgO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYXJrIGN1cnJlbnQgcHJvdmlkZXJcblx0XHRcdGlmIChpc0N1cnJlbnQpIHtcblx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHRuYW1lU3Bhbi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNb2RlbHMgc3VibWVudVxuXHRcdFx0bGV0IG1vZGVsc01lbnU6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdFx0XHRsZXQgaXNFeHBhbmRlZCA9IGZhbHNlO1xuXG5cdFx0XHRpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0bW9kZWxzTWVudSA9IHByb3ZpZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbW9kZWxzLXN1Ym1lbnUnIH0pO1xuXHRcdFx0XHRtb2RlbHNNZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRcdGJvcmRlci1sZWZ0OiAycHggc29saWQgJHt0aGlzLmdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlKX07XG5cdFx0XHRcdFx0bWFyZ2luLWxlZnQ6IDE2cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Ly8gUG9wdWxhdGUgbW9kZWxzXG5cdFx0XHRcdGZvciAoY29uc3QgbW9kZWwgb2YgbW9kZWxzKSB7XG5cdFx0XHRcdFx0Y29uc3QgbW9kZWxJdGVtID0gbW9kZWxzTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWl0ZW0nIH0pO1xuXHRcdFx0XHRcdG1vZGVsSXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0cGFkZGluZzogNnB4IDEycHg7XG5cdFx0XHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdFx0XHRgO1xuXG5cdFx0XHRcdFx0Ly8gTW9kZWwgaW5kaWNhdG9yXG5cdFx0XHRcdFx0Y29uc3QgbW9kZWxEb3QgPSBtb2RlbEl0ZW0uY3JlYXRlU3BhbigpO1xuXHRcdFx0XHRcdG1vZGVsRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHR3aWR0aDogNHB4O1xuXHRcdFx0XHRcdFx0aGVpZ2h0OiA0cHg7XG5cdFx0XHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdFx0XHRiYWNrZ3JvdW5kOiAke21vZGVsLnZhbHVlID09PSBjdXJyZW50TW9kZWwgPyB0aGlzLmdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlKSA6ICd2YXIoLS10ZXh0LW11dGVkKSd9O1xuXHRcdFx0XHRcdGA7XG5cblx0XHRcdFx0XHRjb25zdCBtb2RlbE5hbWUgPSBtb2RlbEl0ZW0uY3JlYXRlU3Bhbih7IHRleHQ6IG1vZGVsLmxhYmVsIH0pO1xuXHRcdFx0XHRcdGlmIChtb2RlbC52YWx1ZSA9PT0gY3VycmVudE1vZGVsKSB7XG5cdFx0XHRcdFx0XHRtb2RlbE5hbWUuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBNb2RlbCBjbGljayBoYW5kbGVyXG5cdFx0XHRcdFx0bW9kZWxJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnN3aXRjaFRvTW9kZWwocHJvdmlkZXJUeXBlLCBtb2RlbC52YWx1ZSk7XG5cdFx0XHRcdFx0XHQvLyBDbG9zZSBkcm9wZG93blxuXHRcdFx0XHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBNb2RlbCBob3ZlciBlZmZlY3Rcblx0XHRcdFx0XHRtb2RlbEl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRcdG1vZGVsSXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0bW9kZWxJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHRtb2RlbEl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gUHJvdmlkZXIgY2xpY2sgaGFuZGxlclxuXHRcdFx0cHJvdmlkZXJJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcblx0XHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Ly8gVG9nZ2xlIHN1Ym1lbnVcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGlzRXhwYW5kZWQgPSAhaXNFeHBhbmRlZDtcblx0XHRcdFx0XHRpZiAobW9kZWxzTWVudSkge1xuXHRcdFx0XHRcdFx0bW9kZWxzTWVudS5zdHlsZS5kaXNwbGF5ID0gaXNFeHBhbmRlZCA/ICdibG9jaycgOiAnbm9uZSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChleHBhbmRBcnJvdykge1xuXHRcdFx0XHRcdFx0ZXhwYW5kQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gaXNFeHBhbmRlZCA/ICdyb3RhdGUoOTBkZWcpJyA6ICdyb3RhdGUoMGRlZyknO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBTd2l0Y2ggcHJvdmlkZXIgZGlyZWN0bHkgKGZvciBPbGxhbWEgb3IgcHJvdmlkZXJzIHdpdGhvdXQgbW9kZWxzKVxuXHRcdFx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnN3aXRjaFRvUHJvdmlkZXIocHJvdmlkZXJUeXBlKTtcblx0XHRcdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24pIHtcblx0XHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIb3ZlciBlZmZlY3Rcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQgJiYgIWlzRXhwYW5kZWQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3RyYXNoLTInOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTMgNkg1SDIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04IDZWNEEyIDIgMCAwIDEgMTAgMkgxNEEyIDIgMCAwIDEgMTYgNFY2TTE5IDZWMjBBMiAyIDAgMCAxIDE3IDIySDdBMiAyIDAgMCAxIDUgMjBWNkgxOVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDExVjE3XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAxMVYxN1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdBbnRocm9waWMnLFxuXHRcdFx0J29wZW5haSc6ICdPcGVuQUknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdPbGxhbWEnLFxuXHRcdFx0J25vbmUnOiAnTm9uZSdcblx0XHR9O1xuXHRcdHJldHVybiBuYW1lc1twcm92aWRlclR5cGVdIHx8IHByb3ZpZGVyVHlwZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBoZWFkZXIgKGp1c3QgbW9kZWwgbmFtZSBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSBwcm92aWRlciBuYW1lKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFxuXHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5nZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlKTtcblx0XHRcdHJldHVybiB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBjdXJyZW50TW9kZWwpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFVzZSB0aGVtZS1jb21wYXRpYmxlIGNvbG9ycyBpbnN0ZWFkIG9mIGhhcmRjb2RlZCBoZXggdmFsdWVzXG5cdFx0Y29uc3QgY29sb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICd2YXIoLS1jb2xvci1vcmFuZ2UpJyxcblx0XHRcdCdvcGVuYWknOiAndmFyKC0tY29sb3ItZ3JlZW4pJyxcblx0XHRcdCdnb29nbGUnOiAndmFyKC0tY29sb3ItYmx1ZSknLFxuXHRcdFx0J29sbGFtYSc6ICd2YXIoLS1jb2xvci1wdXJwbGUpJyxcblx0XHRcdCdub25lJzogJ3ZhcigtLXRleHQtbXV0ZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICd2YXIoLS10ZXh0LXN1Y2Nlc3MpJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgcHJvdmlkZXIgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBhIHN5c3RlbSBtZXNzYWdlIGFib3V0IHByb3ZpZGVyIHN3aXRjaGluZ1xuXHRcdFx0dGhpcy5hZGRTdWNjZXNzTWVzc2FnZShgXHUyNzEzIFN3aXRjaGVkIHRvICR7dGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSl9YCk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0aGUgcGxhdGZvcm0gc2V0dGluZ3MgdG8gdXNlIHRoZSBuZXcgcHJvdmlkZXJcblx0XHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVyVHlwZSBhcyBhbnk7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmUtaW5pdGlhbGl6ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZWZyZXNoIHN0YXR1cyBpbmRpY2F0b3JzXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzKCksIDEwMCk7XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRXJyb3Igc3dpdGNoaW5nIHByb3ZpZGVyIC0gaGFuZGxlZCBieSBVSSBmZWVkYmFja1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoYFx1Mjc0QyBGYWlsZWQgdG8gc3dpdGNoIHRvICR7dGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSl9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoZSBjb21tYW5kIGJ1dHRvbiBzaG91bGQgYmUgc2hvd24gYmFzZWQgb24gZmVhdHVyZSBhdmFpbGFiaWxpdHkgYW5kIHVzZXIgcHJlZmVyZW5jZVxuXHQgKi9cblx0cHJpdmF0ZSBzaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpOiBib29sZWFuIHtcblx0XHQvLyBDb21tYW5kIGJ1dHRvbiBpcyBnYXRlZCBiZWhpbmQgdGhlIGNvbW1hbmRzIGZlYXR1cmUgXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIGFsbCBTdXBlcm5vdmEtZ2F0ZWQgVUkgZWxlbWVudHMgd2hlbiBsaWNlbnNlIHN0YXR1cyBjaGFuZ2VzXG5cdCAqL1xuXHRyZWZyZXNoU3VwZXJub3ZhVUkoKTogdm9pZCB7XG5cdFx0dGhpcy5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdC8vIEZ1dHVyZSBTdXBlcm5vdmEgZmVhdHVyZXMgY2FuIGFkZCB0aGVpciByZWZyZXNoIGxvZ2ljIGhlcmVcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIHRoZSBjb21tYW5kIGJ1dHRvbiB2aXNpYmlsaXR5IHdoZW4gc2V0dGluZ3MgY2hhbmdlXG5cdCAqL1xuXHRyZWZyZXNoQ29tbWFuZEJ1dHRvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBpbnB1dCByb3cgbGF5b3V0IHdoZW4gY29tbWFuZCBidXR0b24gdmlzaWJpbGl0eSBjaGFuZ2VzXG5cdCAqL1xuXHRwcml2YXRlIHVwZGF0ZUlucHV0Um93TGF5b3V0KCk6IHZvaWQge1xuXHRcdC8vIE5vIG5lZWQgdG8gbWFudWFsbHkgYWRqdXN0IHRleHRhcmVhIHdpZHRoIC0gZmxleGJveCBoYW5kbGVzIGl0XG5cdFx0Ly8gVGhlIHRleHRhcmVhIGNvbnRhaW5lciBoYXMgZmxleDogMSwgc28gaXQgd2lsbCBleHBhbmQvY29udHJhY3QgYXV0b21hdGljYWxseVxuXHRcdC8vIHdoZW4gdGhlIGNvbW1hbmQgYnV0dG9uIGlzIHNob3duL2hpZGRlblxuXHR9XG5cblx0LyoqXG5cdCAqIEV4ZWN1dGUgYWRkIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQWRkQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb25cblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb25cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgYWRkIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgY2FsbGJhY2tcblx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBhZGQgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVFZGl0Q29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb25cblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb25cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgZWRpdCBjb21tYW5kIHdpdGggc3RyZWFtaW5nIGNhbGxiYWNrXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQsIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0dXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmdcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nIG9uIGVycm9yXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaW4gc3RyZWFtaW5nIGVkaXQgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlIHJld3JpdGUgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVSZXdyaXRlQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb25cblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb25cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kIHdpdGggc3RyZWFtaW5nIGNhbGxiYWNrXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQsIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0dXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmdcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nIG9uIGVycm9yXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaW4gc3RyZWFtaW5nIHJld3JpdGUgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVHcmFtbWFyQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb25cblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb25cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgZ3JhbW1hciBjb21tYW5kIHdpdGggc3RyZWFtaW5nIGNhbGxiYWNrXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQsIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0dXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmdcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nIG9uIGVycm9yXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaW4gc3RyZWFtaW5nIGdyYW1tYXIgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgZmlsZXMgdG8gcGVyc2lzdGVudCBjb250ZXh0XG5cdCAqL1xuXHRhc3luYyBhZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdObyBmaWxlIGlzIG9wZW4uIFBsZWFzZSBvcGVuIGEgZmlsZSB0byBhZGQgY29udGV4dC4nLCAzMDAwKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb25zdCBhZGRlZEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGFscmVhZHlFeGlzdGluZ0ZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IG5vdEZvdW5kRmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XG5cdFx0Ly8gR2V0IGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBkaXJlY3RseSAod2l0aG91dCBjbGVhcmluZyBpdClcblx0XHRjb25zdCBleGlzdGluZ1BlcnNpc3RlbnQgPSB0aGlzLm11bHRpRG9jSGFuZGxlci5nZXRQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuXHRcdGNvbnN0IHVwZGF0ZWRQZXJzaXN0ZW50ID0gWy4uLmV4aXN0aW5nUGVyc2lzdGVudF07XG5cdFx0XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBmaWxlbmFtZSBvZiBmaWxlbmFtZXMpIHtcblx0XHRcdC8vIEZpbmQgdGhlIGZpbGUgYnkgbmFtZVxuXHRcdFx0bGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZW5hbWUpO1xuXHRcdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVuYW1lICsgJy5tZCcpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblx0XHRcdFx0ZmlsZSA9IGZpbGVzLmZpbmQoXG5cdFx0XHRcdFx0KGYpID0+IGYuYmFzZW5hbWUgPT09IGZpbGVuYW1lIHx8IGYubmFtZSA9PT0gZmlsZW5hbWUgfHwgZi5wYXRoLmVuZHNXaXRoKCcvJyArIGZpbGVuYW1lKSB8fCBmLnBhdGguZW5kc1dpdGgoJy8nICsgZmlsZW5hbWUgKyAnLm1kJylcblx0XHRcdFx0KSB8fCBudWxsO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIGFscmVhZHkgaW4gcGVyc2lzdGVudCBjb250ZXh0IChjaGVjayBib3RoIGV4aXN0aW5nIGFuZCBuZXdseSBhZGRlZCBpbiB0aGlzIGJhdGNoKVxuXHRcdFx0XHRjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKHJlZiA9PiByZWYuZmlsZS5wYXRoID09PSAoZmlsZSBhcyBURmlsZSkucGF0aCk7XG5cdFx0XHRcdGlmICghZXhpc3RzKSB7XG5cdFx0XHRcdFx0Ly8gQWRkIHRvIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHRcdHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2goe1xuXHRcdFx0XHRcdFx0ZmlsZTogZmlsZSxcblx0XHRcdFx0XHRcdHByb3BlcnR5OiB1bmRlZmluZWQsXG5cdFx0XHRcdFx0XHRpc1BlcnNpc3RlbnQ6IHRydWUsXG5cdFx0XHRcdFx0XHRyYXdSZWZlcmVuY2U6IGArW1ske2ZpbGUuYmFzZW5hbWV9XV1gXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0YWRkZWRGaWxlcy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIEZpbGUgYWxyZWFkeSBleGlzdHMgaW4gY29udGV4dFxuXHRcdFx0XHRcdGFscmVhZHlFeGlzdGluZ0ZpbGVzLnB1c2goZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgbm90IGZvdW5kXG5cdFx0XHRcdG5vdEZvdW5kRmlsZXMucHVzaChmaWxlbmFtZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHQgaWYgd2UgbWFkZSBhbnkgY2hhbmdlc1xuXHRcdGlmIChhZGRlZEZpbGVzLmxlbmd0aCA+IDAgfHwgYWxyZWFkeUV4aXN0aW5nRmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0Ly8gVXNlIHJlZmxlY3Rpb24gdG8gYWNjZXNzIHByaXZhdGUgcHJvcGVydHkgKHNpbmNlIFR5cGVTY3JpcHQgZG9lc24ndCBleHBvc2UgaXQpXG5cdFx0XHRjb25zdCBoYW5kbGVyID0gdGhpcy5tdWx0aURvY0hhbmRsZXIgYXMgYW55O1xuXHRcdFx0aGFuZGxlci5wZXJzaXN0ZW50Q29udGV4dC5zZXQodGhpcy5jdXJyZW50RmlsZS5wYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFJlZnJlc2ggY29udGV4dCBVSVxuXHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcblx0XHQvLyBTaG93IGEgc2luZ2xlIGNvbXByZWhlbnNpdmUgbm90aWZpY2F0aW9uIGZvciBiZXR0ZXIgVVhcblx0XHRjb25zdCB0b3RhbEZpbGVzID0gZmlsZW5hbWVzLmxlbmd0aDtcblx0XHRjb25zdCBtZXNzYWdlczogc3RyaW5nW10gPSBbXTtcblx0XHRcblx0XHRpZiAoYWRkZWRGaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAoYWRkZWRGaWxlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgQWRkZWQgXCIke2FkZGVkRmlsZXNbMF19XCIgdG8gY29udGV4dGApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgQWRkZWQgJHthZGRlZEZpbGVzLmxlbmd0aH0gZmlsZXMgdG8gY29udGV4dGApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZiAoYWxyZWFkeUV4aXN0aW5nRmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKGFscmVhZHlFeGlzdGluZ0ZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBcIiR7YWxyZWFkeUV4aXN0aW5nRmlsZXNbMF19XCIgYWxyZWFkeSBpbiBjb250ZXh0YCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGAke2FscmVhZHlFeGlzdGluZ0ZpbGVzLmxlbmd0aH0gYWxyZWFkeSBpbiBjb250ZXh0YCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChub3RGb3VuZEZpbGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChub3RGb3VuZEZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBcIiR7bm90Rm91bmRGaWxlc1swXX1cIiBub3QgZm91bmRgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYCR7bm90Rm91bmRGaWxlcy5sZW5ndGh9IG5vdCBmb3VuZGApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IHNpbmdsZSBjb21iaW5lZCBtZXNzYWdlIGlmIHdlIGhhdmUgYW55IHJlc3VsdHNcblx0XHRpZiAobWVzc2FnZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgY29tYmluZWRNZXNzYWdlID0gbWVzc2FnZXMuam9pbignLCAnKTtcblx0XHRcdGNvbnN0IGR1cmF0aW9uID0gbm90Rm91bmRGaWxlcy5sZW5ndGggPiAwID8gMzAwMCA6IDIwMDA7IC8vIExvbmdlciBkdXJhdGlvbiBpZiB0aGVyZSBhcmUgZXJyb3JzXG5cdFx0XHRuZXcgTm90aWNlKGNvbWJpbmVkTWVzc2FnZSwgZHVyYXRpb24pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY29udGV4dHVhbCB0aGlua2luZyBwaHJhc2UgYmFzZWQgb24gY29tbWFuZCB0eXBlIG9yIG1lc3NhZ2UgY29udGVudFxuXHQgKi9cblx0cHJpdmF0ZSBnZXRDb250ZXh0dWFsVGhpbmtpbmdQaHJhc2UoY29tbWFuZD86IEVkaXRDb21tYW5kLCBtZXNzYWdlVGV4dD86IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gRGV0ZXJtaW5lIGNvbnRleHQgYmFzZWQgb24gY29tbWFuZCB0eXBlIG9yIG1lc3NhZ2UgY29udGVudFxuXHRcdGlmIChjb21tYW5kKSB7XG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2ltcHJvdmUnKTtcblx0XHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2dlbmVyYXRlJyk7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnaW1wcm92ZScpO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgncHJvY2VzcycpO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnY2hhdCcpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobWVzc2FnZVRleHQpIHtcblx0XHRcdC8vIEFuYWx5emUgbWVzc2FnZSBjb250ZW50IGZvciBjb250ZXh0XG5cdFx0XHRpZiAobWVzc2FnZVRleHQuaW5jbHVkZXMoJ2ltcHJvdmUnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnZml4JykgfHwgbWVzc2FnZVRleHQuaW5jbHVkZXMoJ2dyYW1tYXInKSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2ltcHJvdmUnKTtcblx0XHRcdH0gZWxzZSBpZiAobWVzc2FnZVRleHQuaW5jbHVkZXMoJ2FkZCcpIHx8IG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdjcmVhdGUnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnd3JpdGUnKSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2dlbmVyYXRlJyk7XG5cdFx0XHR9IGVsc2UgaWYgKG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdzd2l0Y2gnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnLycpKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnc3dpdGNoJyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnY2hhdCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCByYW5kb20gcGhyYXNlIGZyb20gc3BlY2lmaWVkIGNhdGVnb3J5XG5cdCAqL1xuXHRwcml2YXRlIGdldFJhbmRvbVBocmFzZShjYXRlZ29yeTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBwaHJhc2VzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG5cdFx0XHQnaW1wcm92ZSc6IFsncmVmaW5pbmcuLi4nLCAncG9saXNoaW5nLi4uJywgJ2VuaGFuY2luZy4uLicsICdjcmFmdGluZy4uLicsICdwZXJmZWN0aW5nLi4uJywgJ3Ntb290aGluZy4uLicsICdzaGFycGVuaW5nLi4uJywgJ2VsZXZhdGluZy4uLicsICdmaW5lLXR1bmluZy4uLicsICdzY3VscHRpbmcuLi4nXSxcblx0XHRcdCdnZW5lcmF0ZSc6IFsndGhpbmtpbmcuLi4nLCAnY3JhZnRpbmcuLi4nLCAnZGV2ZWxvcGluZy4uLicsICdjb21wb3NpbmcuLi4nLCAnd3JpdGluZy4uLicsICdjcmVhdGluZy4uLicsICdmb3JtdWxhdGluZy4uLicsICdidWlsZGluZy4uLicsICdjb25zdHJ1Y3RpbmcuLi4nLCAnZHJhZnRpbmcuLi4nXSxcblx0XHRcdCdzd2l0Y2gnOiBbJ2Nvbm5lY3RpbmcuLi4nLCAnc3dpdGNoaW5nLi4uJywgJ3VwZGF0aW5nLi4uJywgJ2NvbmZpZ3VyaW5nLi4uJywgJ3NldHRpbmcgdXAuLi4nLCAnc3luY2luZy4uLicsICdwcmVwYXJpbmcuLi4nLCAnYWN0aXZhdGluZy4uLicsICdpbml0aWFsaXppbmcuLi4nLCAnZXN0YWJsaXNoaW5nLi4uJ10sXG5cdFx0XHQncHJvY2Vzcyc6IFsncHJvY2Vzc2luZy4uLicsICdhbmFseXppbmcuLi4nLCAnd29ya2luZy4uLicsICdjb21wdXRpbmcuLi4nLCAnY2FsY3VsYXRpbmcuLi4nLCAnZXhhbWluaW5nLi4uJywgJ2V2YWx1YXRpbmcuLi4nLCAnaW50ZXJwcmV0aW5nLi4uJywgJ3Jldmlld2luZy4uLicsICdzY2FubmluZy4uLiddLFxuXHRcdFx0J2NoYXQnOiBbJ3RoaW5raW5nLi4uJywgJ3Byb2Nlc3NpbmcuLi4nLCAnY29uc2lkZXJpbmcuLi4nLCAnYW5hbHl6aW5nLi4uJywgJ3VuZGVyc3RhbmRpbmcuLi4nLCAnY29udGVtcGxhdGluZy4uLicsICdleHBsb3JpbmcuLi4nLCAnZXZhbHVhdGluZy4uLicsICd3b3JraW5nIG9uIGl0Li4uJywgJ2NvbXBvc2luZy4uLiddXG5cdFx0fTtcblx0XHRcblx0XHRjb25zdCBjYXRlZ29yeVBocmFzZXMgPSBwaHJhc2VzW2NhdGVnb3J5XSB8fCBwaHJhc2VzLmNoYXQ7XG5cdFx0cmV0dXJuIGNhdGVnb3J5UGhyYXNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjYXRlZ29yeVBocmFzZXMubGVuZ3RoKV07XG5cdH1cblxuXHQvKipcblx0ICogU3RhcnQgcGhyYXNlIHJvdGF0aW9uIGFuaW1hdGlvbiBmb3IgdGhpbmtpbmcgdGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBzdGFydFRoaW5raW5nUGhyYXNlUm90YXRpb24odGV4dEVsOiBIVE1MRWxlbWVudCwgY29tbWFuZD86IEVkaXRDb21tYW5kLCBtZXNzYWdlVGV4dD86IHN0cmluZyk6IHZvaWQge1xuXHRcdC8vIENoYW5nZSBwaHJhc2UgZXZlcnkgMiBzZWNvbmRzIGR1cmluZyBwcm9jZXNzaW5nXG5cdFx0Y29uc3Qgcm90YXRpb25JbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcblx0XHRcdGNvbnN0IG5ld1BocmFzZSA9IHRoaXMuZ2V0Q29udGV4dHVhbFRoaW5raW5nUGhyYXNlKGNvbW1hbmQsIG1lc3NhZ2VUZXh0KTtcblx0XHRcdHRleHRFbC50ZXh0Q29udGVudCA9IG5ld1BocmFzZTtcblx0XHR9LCAyMDAwKTtcblx0XHRcblx0XHQvLyBTdG9yZSBpbnRlcnZhbCBJRCBmb3IgY2xlYW51cFxuXHRcdCh0ZXh0RWwgYXMgYW55KS5yb3RhdGlvbkludGVydmFsID0gcm90YXRpb25JbnRlcnZhbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBTdG9wIHBocmFzZSByb3RhdGlvbiBhbmltYXRpb24gYW5kIGNsZWFudXBcblx0ICovXG5cdHByaXZhdGUgc3RvcFRoaW5raW5nUGhyYXNlUm90YXRpb24odGV4dEVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGlmICgodGV4dEVsIGFzIGFueSkucm90YXRpb25JbnRlcnZhbCkge1xuXHRcdFx0Y2xlYXJJbnRlcnZhbCgodGV4dEVsIGFzIGFueSkucm90YXRpb25JbnRlcnZhbCk7XG5cdFx0XHQodGV4dEVsIGFzIGFueSkucm90YXRpb25JbnRlcnZhbCA9IG51bGw7XG5cdFx0fVxuXHR9XG5cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudFN0cnVjdHVyZSB7XG5cdGhlYWRpbmdzOiBBcnJheTx7IGxldmVsOiBudW1iZXI7IHRleHQ6IHN0cmluZzsgaXNFbXB0eTogYm9vbGVhbiB9Pjtcblx0d29yZENvdW50OiBudW1iZXI7XG5cdGVtcHR5SGVhZGluZ3M6IHN0cmluZ1tdO1xuXHRpbmNvbXBsZXRlQnVsbGV0czogc3RyaW5nW107XG59XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudEFuYWx5emVyIHtcblx0c3RhdGljIGFuYWx5emVTdHJ1Y3R1cmUoY29udGVudDogc3RyaW5nKTogRG9jdW1lbnRTdHJ1Y3R1cmUge1xuXHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0Y29uc3QgaGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nOyBpc0VtcHR5OiBib29sZWFuIH0+ID0gW107XG5cdFx0Y29uc3QgZW1wdHlIZWFkaW5nczogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBpbmNvbXBsZXRlQnVsbGV0czogc3RyaW5nW10gPSBbXTtcblx0XHRcblx0XHQvLyBGaW5kIGhlYWRpbmdzIGFuZCBhbmFseXplIGNvbnRlbnQgYWZ0ZXIgZWFjaFxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7XG5cdFx0XHRjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcblx0XHRcdFxuXHRcdFx0aWYgKGhlYWRpbmdNYXRjaCkge1xuXHRcdFx0XHRjb25zdCBsZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG5cdFx0XHRcdGNvbnN0IHRleHQgPSBoZWFkaW5nTWF0Y2hbMl07XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayBpZiBoZWFkaW5nIGhhcyBjb250ZW50IGFmdGVyIGl0XG5cdFx0XHRcdGNvbnN0IGhhc0NvbnRlbnQgPSB0aGlzLmhhc0NvbnRlbnRBZnRlckhlYWRpbmcobGluZXMsIGkpO1xuXHRcdFx0XHRjb25zdCBpc0VtcHR5ID0gIWhhc0NvbnRlbnQ7XG5cdFx0XHRcdFxuXHRcdFx0XHRoZWFkaW5ncy5wdXNoKHsgbGV2ZWwsIHRleHQsIGlzRW1wdHkgfSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaXNFbXB0eSkge1xuXHRcdFx0XHRcdGVtcHR5SGVhZGluZ3MucHVzaCh0ZXh0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIGluY29tcGxldGUgYnVsbGV0IHBvaW50cyAoZW5kaW5nIHdpdGggXCIuLi5cIiBvciBlbXB0eSlcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eWy0qK11cXHMqKC4qKVxcLlxcLlxcLj9cXHMqJC8pIHx8IGxpbmUubWF0Y2goL15bLSorXVxccyokLykgfHwgbGluZS5tYXRjaCgvXlstKitdXFxzKihUT0RPfFRCRCkvaSkpIHtcblx0XHRcdFx0aW5jb21wbGV0ZUJ1bGxldHMucHVzaChsaW5lKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Y29uc3Qgd29yZENvdW50ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMCkubGVuZ3RoO1xuXHRcdFxuXHRcdHJldHVybiB7XG5cdFx0XHRoZWFkaW5ncyxcblx0XHRcdHdvcmRDb3VudCxcblx0XHRcdGVtcHR5SGVhZGluZ3MsXG5cdFx0XHRpbmNvbXBsZXRlQnVsbGV0c1xuXHRcdH07XG5cdH1cblx0XG5cdHByaXZhdGUgc3RhdGljIGhhc0NvbnRlbnRBZnRlckhlYWRpbmcobGluZXM6IHN0cmluZ1tdLCBoZWFkaW5nSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGN1cnJlbnRIZWFkaW5nID0gbGluZXNbaGVhZGluZ0luZGV4XS50cmltKCk7XG5cdFx0Y29uc3QgY3VycmVudExldmVsID0gY3VycmVudEhlYWRpbmcubWF0Y2goL14oI3sxLDZ9KS8pPy5bMV0ubGVuZ3RoIHx8IDA7XG5cdFx0XG5cdFx0Zm9yIChsZXQgaSA9IGhlYWRpbmdJbmRleCArIDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcblx0XHRcdFxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIGhlYWRpbmdcblx0XHRcdGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccy8pO1xuXHRcdFx0aWYgKGhlYWRpbmdNYXRjaCkge1xuXHRcdFx0XHRjb25zdCBuZXh0TGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gSWYgbmV4dCBoZWFkaW5nIGlzIHNhbWUgb3IgaGlnaGVyIGxldmVsIChsb3dlciBudW1iZXIpLCBcblx0XHRcdFx0Ly8gYW5kIHdlIGhhdmVuJ3QgZm91bmQgY29udGVudCB5ZXQsIHRoaXMgc2VjdGlvbiBpcyBlbXB0eVxuXHRcdFx0XHRpZiAobmV4dExldmVsIDw9IGN1cnJlbnRMZXZlbCkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBJZiBpdCdzIGEgc3ViLWhlYWRpbmcgKGhpZ2hlciBudW1iZXIpLCBjb250aW51ZSBsb29raW5nIGZvciBjb250ZW50XG5cdFx0XHRcdC8vIFRoaXMgYWxsb3dzIGZvciBIMSBcdTIxOTIgSDIgc3RydWN0dXJlIHdpdGhvdXQgY291bnRpbmcgYXMgZW1wdHlcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gSWYgd2UgZmluZCBzdWJzdGFudGlhbCBjb250ZW50IChub3QganVzdCB3aGl0ZXNwYWNlKSwgaGVhZGluZyBpcyBub3QgZW1wdHlcblx0XHRcdGlmIChsaW5lLmxlbmd0aCA+IDApIHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRcblx0XHQvLyBJZiB3ZSByZWFjaCBlbmQgb2YgZG9jdW1lbnQgd2l0aG91dCBmaW5kaW5nIGNvbnRlbnQsIGl0J3MgZW1wdHlcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn0iLCAiLyoqXG4gKiBNdWx0aS1kb2N1bWVudCBjb250ZXh0IGhhbmRsZXIgZm9yIE5vdmFcbiAqIFBhcnNlcyBbW2RvY11dIGFuZCArW1tkb2NdXSBzeW50YXggZm9yIGFkZGl0aW9uYWwgY29udGV4dFxuICovXG5cbmltcG9ydCB7IEFwcCwgVEZpbGUsIENhY2hlZE1ldGFkYXRhIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvY3VtZW50UmVmZXJlbmNlIHtcbiAgICAvKiogVGhlIGZpbGUgYmVpbmcgcmVmZXJlbmNlZCAqL1xuICAgIGZpbGU6IFRGaWxlO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHRoaXMgaXMgcGVyc2lzdGVudCBjb250ZXh0ICgrW1tkb2NdXSkgKi9cbiAgICBpc1BlcnNpc3RlbnQ6IGJvb2xlYW47XG4gICAgXG4gICAgLyoqIFRoZSByYXcgcmVmZXJlbmNlIHRleHQgKGUuZy4sIFwiW1tNeSBEb2N1bWVudF1dXCIpICovXG4gICAgcmF3UmVmZXJlbmNlOiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFNwZWNpZmljIHByb3BlcnR5IHRvIGV4dHJhY3QgKGUuZy4sIFwiW1tkb2MjcHJvcGVydHldXVwiKSAqL1xuICAgIHByb3BlcnR5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpRG9jQ29udGV4dCB7XG4gICAgLyoqIERvY3VtZW50cyBpbiBwZXJzaXN0ZW50IGNvbnRleHQgKi9cbiAgICBwZXJzaXN0ZW50RG9jczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICBcbiAgICAvKiogQ29tYmluZWQgY29udGV4dCBzdHJpbmcgKi9cbiAgICBjb250ZXh0U3RyaW5nOiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEVzdGltYXRlZCB0b2tlbiBjb3VudCAqL1xuICAgIHRva2VuQ291bnQ6IG51bWJlcjtcbiAgICBcbiAgICAvKiogV2hldGhlciB3ZSdyZSBhcHByb2FjaGluZyB0b2tlbiBsaW1pdCAqL1xuICAgIGlzTmVhckxpbWl0OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgTXVsdGlEb2NDb250ZXh0SGFuZGxlciB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHBlcnNpc3RlbnRDb250ZXh0OiBNYXA8c3RyaW5nLCBEb2N1bWVudFJlZmVyZW5jZVtdPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IFRPS0VOX0xJTUlUID0gODAwMDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IFdBUk5JTkdfVEhSRVNIT0xEID0gMC44O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBtZXNzYWdlIGZvciBkb2N1bWVudCByZWZlcmVuY2VzXG4gICAgICovXG4gICAgcGFyc2VNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgY29udmVyc2F0aW9uRmlsZVBhdGg6IHN0cmluZyk6IHtcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgcmVmZXJlbmNlczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICB9IHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlczogRG9jdW1lbnRSZWZlcmVuY2VbXSA9IFtdO1xuICAgICAgICBsZXQgY2xlYW5lZE1lc3NhZ2UgPSBtZXNzYWdlO1xuXG4gICAgICAgIC8vIFBhdHRlcm4gdG8gbWF0Y2ggW1tkb2NdXSBhbmQgK1tbZG9jXV0gd2l0aCBvcHRpb25hbCBwcm9wZXJ0eVxuICAgICAgICAvLyBOb3RlOiBBbGwgZG9jdW1lbnQgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQgZm9yIHNpbXBsaWZpZWQgVVhcbiAgICAgICAgY29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcbiAgICAgICAgICAgIGNvbnN0IHJhd1JlZmVyZW5jZSA9IG1hdGNoWzBdO1xuXG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCB0aGUgZmlsZVxuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZmluZEZpbGUoZG9jTmFtZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgaXNQZXJzaXN0ZW50OiB0cnVlLCAvLyBBbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnRcbiAgICAgICAgICAgICAgICAgICAgcmF3UmVmZXJlbmNlLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBmb3VuZCByZWZlcmVuY2VzIGZyb20gbWVzc2FnZVxuICAgICAgICBmb3IgKGNvbnN0IHJlZiBvZiByZWZlcmVuY2VzKSB7XG4gICAgICAgICAgICBjbGVhbmVkTWVzc2FnZSA9IGNsZWFuZWRNZXNzYWdlLnJlcGxhY2UocmVmLnJhd1JlZmVyZW5jZSwgJyAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENsZWFuIHVwIGV4Y2Vzc2l2ZSBzcGFjZXMgYnV0IHByZXNlcnZlIG5lY2Vzc2FyeSBzcGFjaW5nXG4gICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZSgvXFxzezIsfS9nLCAnICcpLnRyaW0oKTtcblxuICAgICAgICAvLyBVcGRhdGUgcGVyc2lzdGVudCBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBjb25zdCBwZXJzaXN0ZW50UmVmcyA9IHJlZmVyZW5jZXMuZmlsdGVyKHJlZiA9PiByZWYuaXNQZXJzaXN0ZW50KTtcbiAgICAgICAgaWYgKHBlcnNpc3RlbnRSZWZzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY29udmVyc2F0aW9uRmlsZVBhdGgpIHx8IFtdO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFBlcnNpc3RlbnQgPSBbLi4uZXhpc3RpbmddO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdGhhdCBhcmVuJ3QgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHBlcnNpc3RlbnRSZWZzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShleGlzdGluZyA9PiBleGlzdGluZy5maWxlLnBhdGggPT09IHJlZi5maWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGNvbnZlcnNhdGlvbkZpbGVQYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGNvbXBsZXRlIGNvbnRleHQgaW5jbHVkaW5nIHBlcnNpc3RlbnQgZG9jdW1lbnRzXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb250ZXh0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGN1cnJlbnRGaWxlOiBURmlsZSxcbiAgICAgICAgY29udmVyc2F0aW9uRGF0YT86IENvbnZlcnNhdGlvbkRhdGFcbiAgICApOiBQcm9taXNlPHtcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgY29udGV4dDogTXVsdGlEb2NDb250ZXh0O1xuICAgIH0+IHtcbiAgICAgICAgLy8gUGFyc2UgY3VycmVudCBtZXNzYWdlXG4gICAgICAgIGNvbnN0IHsgY2xlYW5lZE1lc3NhZ2UsIHJlZmVyZW5jZXMgfSA9IHRoaXMucGFyc2VNZXNzYWdlKG1lc3NhZ2UsIGN1cnJlbnRGaWxlLnBhdGgpO1xuXG4gICAgICAgIC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIHRoaXMgY29udmVyc2F0aW9uXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nUGVyc2lzdGVudCA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIG5ldyByZWZlcmVuY2VzIHRvIHBlcnNpc3RlbnQgY29udGV4dCAoYWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50KVxuICAgICAgICBpZiAocmVmZXJlbmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ1BlcnNpc3RlbnRdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdGhhdCBhcmVuJ3QgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgdXBkYXRlZFBlcnNpc3RlbnQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZmluYWwgcGVyc2lzdGVudCBjb250ZXh0IChpbmNsdWRpbmcgbmV3bHkgYWRkZWQgZG9jcylcbiAgICAgICAgY29uc3QgcmF3UGVyc2lzdGVudERvY3MgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbHRlciBvdXQgYW55IHN0YWxlIGZpbGUgcmVmZXJlbmNlcyAoZmlsZXMgdGhhdCBubyBsb25nZXIgZXhpc3QpXG4gICAgICAgIGNvbnN0IGFsbFBlcnNpc3RlbnREb2NzID0gcmF3UGVyc2lzdGVudERvY3MuZmlsdGVyKGRvY1JlZiA9PiB7XG4gICAgICAgICAgICBpZiAoIWRvY1JlZj8uZmlsZSB8fCAhdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRvY1JlZi5maWxlLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBwZXJzaXN0ZW50IGNvbnRleHQgdG8gcmVtb3ZlIHN0YWxlIHJlZmVyZW5jZXNcbiAgICAgICAgaWYgKGFsbFBlcnNpc3RlbnREb2NzLmxlbmd0aCAhPT0gcmF3UGVyc2lzdGVudERvY3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoYWxsUGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGN1cnJlbnRGaWxlLnBhdGgsIGFsbFBlcnNpc3RlbnREb2NzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoY3VycmVudEZpbGUucGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IHN0cmluZyBmcm9tIGFsbCBkb2N1bWVudHNcbiAgICAgICAgY29uc3QgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQUxXQVlTIGluY2x1ZGUgY3VycmVudCBmaWxlIGNvbnRlbnQgYW5kIG1ldGFkYXRhIGZpcnN0IChpbXBsaWNpdCBjb250ZXh0KVxuICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNvbnRleHQgPSBhd2FpdCB0aGlzLmdldEZ1bGxEb2N1bWVudENvbnRleHQoY3VycmVudEZpbGUsIHRydWUsIDEwMCk7XG4gICAgICAgIGlmIChjdXJyZW50RmlsZUNvbnRleHQpIHtcbiAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGN1cnJlbnRGaWxlQ29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRoZW4gYWRkIGFsbCBwZXJzaXN0ZW50IGRvY3VtZW50cyB3aXRoIHRoZWlyIG1ldGFkYXRhXG4gICAgICAgIGZvciAoY29uc3QgZG9jUmVmIG9mIGFsbFBlcnNpc3RlbnREb2NzKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0UGFydCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGRvY1JlZik7XG4gICAgICAgICAgICBpZiAoY29udGV4dFBhcnQpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChjb250ZXh0UGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0U3RyaW5nID0gY29udGV4dFBhcnRzLmpvaW4oJ1xcblxcbi0tLVxcblxcbicpO1xuICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5lc3RpbWF0ZVRva2Vucyhjb250ZXh0U3RyaW5nKTtcbiAgICAgICAgY29uc3QgaXNOZWFyTGltaXQgPSB0b2tlbkNvdW50ID4gKHRoaXMuVE9LRU5fTElNSVQgKiB0aGlzLldBUk5JTkdfVEhSRVNIT0xEKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2xlYW5lZE1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgcGVyc2lzdGVudERvY3M6IGFsbFBlcnNpc3RlbnREb2NzLFxuICAgICAgICAgICAgICAgIGNvbnRleHRTdHJpbmcsXG4gICAgICAgICAgICAgICAgdG9rZW5Db3VudCxcbiAgICAgICAgICAgICAgICBpc05lYXJMaW1pdFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmdWxsIGRvY3VtZW50IGNvbnRleHQgaW5jbHVkaW5nIG1ldGFkYXRhL3Byb3BlcnRpZXNcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldEZ1bGxEb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUsIGluY2x1ZGVDb250ZW50OiBib29sZWFuID0gdHJ1ZSwgbWF4TGluZXM6IG51bWJlciA9IDUwKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgZG9jdW1lbnQgaGVhZGVyXG4gICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChgIyMgRG9jdW1lbnQ6ICR7ZmlsZS5iYXNlbmFtZX1gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IGFuZCBhZGQgbWV0YWRhdGEvcHJvcGVydGllcyBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyICYmIE9iamVjdC5rZXlzKGNhY2hlLmZyb250bWF0dGVyKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJ1xcbiMjIyBQcm9wZXJ0aWVzL01ldGFkYXRhOicpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNhY2hlLmZyb250bWF0dGVyKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3JtYXQgdGhlIHByb3BlcnR5IHZhbHVlIChoYW5kbGUgYXJyYXlzLCBvYmplY3RzLCBldGMuKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goYC0gJHtrZXl9OiAke2Zvcm1hdHRlZFZhbHVlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGNvbnRlbnQgaWYgcmVxdWVzdGVkXG4gICAgICAgICAgICBpZiAoaW5jbHVkZUNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCBmcm9udG1hdHRlciBpbiBjb250ZW50IGRpc3BsYXkgKGJldHdlZW4gLS0tIG1hcmtlcnMpXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50U3RhcnRJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsaW5lc1swXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZXNbaV0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRTdGFydEluZGV4ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudExpbmVzID0gbGluZXMuc2xpY2UoY29udGVudFN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gY29udGVudExpbmVzLnNsaWNlKDAsIG1heExpbmVzKS5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2FzVHJ1bmNhdGVkID0gY29udGVudExpbmVzLmxlbmd0aCA+IG1heExpbmVzO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJ1xcbiMjIyBDb250ZW50OicpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCh0cnVuY2F0ZWRDb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdhc1RydW5jYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJ1xcblsuLi4gdHJ1bmNhdGVkIGZvciBicmV2aXR5IC4uLl0nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHRQYXJ0cy5qb2luKCdcXG4nKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxlZCB0byByZWFkIGZ1bGwgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb250ZXh0IGZvciBhIHNwZWNpZmljIGRvY3VtZW50IHJlZmVyZW5jZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KGRvY1JlZjogRG9jdW1lbnRSZWZlcmVuY2UpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHsgZmlsZSwgcHJvcGVydHkgfSA9IGRvY1JlZjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgZmlsZSBzdGlsbCBleGlzdHMgaW4gdGhlIHZhdWx0XG4gICAgICAgICAgICBpZiAoIWZpbGUgfHwgIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgLy8gRmlsZSBubyBsb25nZXIgZXhpc3RzIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHNwZWNpZmljIHByb3BlcnR5IGZyb20gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgICAgIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIgJiYgY2FjaGUuZnJvbnRtYXR0ZXJbcHJvcGVydHldKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgIyMgJHtmaWxlLmJhc2VuYW1lfSAtICR7cHJvcGVydHl9XFxuJHtjYWNoZS5mcm9udG1hdHRlcltwcm9wZXJ0eV19YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEdldCBmdWxsIGRvY3VtZW50IGNvbnRleHQgd2l0aCBtZXRhZGF0YVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZ1bGxEb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gcmVhZCBjb250ZXh0IC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmluZCBhIGZpbGUgYnkgbmFtZSBvciBwYXRoXG4gICAgICovXG4gICAgcHJpdmF0ZSBmaW5kRmlsZShuYW1lT3JQYXRoOiBzdHJpbmcpOiBURmlsZSB8IG51bGwge1xuICAgICAgICAvLyBGaXJzdCB0cnkgZXhhY3QgcGF0aCBtYXRjaFxuICAgICAgICBsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgIC8vIFRyeSB3aXRoIC5tZCBleHRlbnNpb25cbiAgICAgICAgICAgIGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCArICcubWQnKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgLy8gU2VhcmNoIGJ5IGJhc2VuYW1lXG4gICAgICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICAgICAgICAgIGZpbGUgPSBmaWxlcy5maW5kKGYgPT4gXG4gICAgICAgICAgICAgICAgZi5iYXNlbmFtZSA9PT0gbmFtZU9yUGF0aCB8fCBcbiAgICAgICAgICAgICAgICBmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcbiAgICAgICAgICAgICAgICBmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCkgfHxcbiAgICAgICAgICAgICAgICBmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCArICcubWQnKVxuICAgICAgICAgICAgKSB8fCBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gZmlsZSA6IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgcGVyc2lzdGVudCBjb250ZXh0IGZvciBhIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGNsZWFyUGVyc2lzdGVudENvbnRleHQoZmlsZVBhdGg6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShmaWxlUGF0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHBlcnNpc3RlbnQgY29udGV4dCBmb3IgYSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBnZXRQZXJzaXN0ZW50Q29udGV4dChmaWxlUGF0aDogc3RyaW5nKTogRG9jdW1lbnRSZWZlcmVuY2VbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChmaWxlUGF0aCkgfHwgW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgc3BlY2lmaWMgZG9jdW1lbnQgZnJvbSBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICByZW1vdmVQZXJzaXN0ZW50RG9jKGZpbGVQYXRoOiBzdHJpbmcsIGRvY1RvUmVtb3ZlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGZpbGVQYXRoKSB8fCBbXTtcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBjdXJyZW50LmZpbHRlcihyZWYgPT4gcmVmLmZpbGUucGF0aCAhPT0gZG9jVG9SZW1vdmUpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGZpbGVQYXRoLCBmaWx0ZXJlZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShmaWxlUGF0aCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCAocm91Z2ggYXBwcm94aW1hdGlvbilcbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlVG9rZW5zKHRleHQ6IHN0cmluZyk6IG51bWJlciB7XG4gICAgICAgIC8vIFJvdWdoIGVzdGltYXRlOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHZpc3VhbCBpbmRpY2F0b3JzIGZvciBjb250ZXh0IHN0YXRlXG4gICAgICovXG4gICAgZ2V0Q29udGV4dEluZGljYXRvcnMoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KToge1xuICAgICAgICB0ZXh0OiBzdHJpbmc7XG4gICAgICAgIGNsYXNzTmFtZTogc3RyaW5nO1xuICAgICAgICB0b29sdGlwOiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGRvY0NvdW50ID0gY29udGV4dC5wZXJzaXN0ZW50RG9jcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKChjb250ZXh0LnRva2VuQ291bnQgLyB0aGlzLlRPS0VOX0xJTUlUKSAqIDEwMCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgY2xhc3NOYW1lID0gJ25vdmEtY29udGV4dC1pbmRpY2F0b3InO1xuICAgICAgICBsZXQgdG9vbHRpcCA9IGBDb250ZXh0OiAke2RvY0NvdW50fSBkb2N1bWVudCR7ZG9jQ291bnQgIT09IDEgPyAncycgOiAnJ30sIH4ke2NvbnRleHQudG9rZW5Db3VudH0gdG9rZW5zYDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb250ZXh0LmlzTmVhckxpbWl0KSB7XG4gICAgICAgICAgICBjbGFzc05hbWUgKz0gJyBub3ZhLWNvbnRleHQtd2FybmluZyc7XG4gICAgICAgICAgICB0b29sdGlwICs9ICcgKGFwcHJvYWNoaW5nIGxpbWl0KSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHRleHQgPSBgJHtkb2NDb3VudH0gZG9jcyAke3BlcmNlbnRhZ2V9JWA7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyB0ZXh0LCBjbGFzc05hbWUsIHRvb2x0aXAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgY29udGV4dCBmb3IgZGlzcGxheSBpbiBVSVxuICAgICAqL1xuICAgIGZvcm1hdENvbnRleHRGb3JEaXNwbGF5KGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaXRlbXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgcGVyc2lzdGVudCBkb2N1bWVudHNcbiAgICAgICAgZm9yIChjb25zdCBkb2Mgb2YgY29udGV4dC5wZXJzaXN0ZW50RG9jcykge1xuICAgICAgICAgICAgaXRlbXMucHVzaChgJHtkb2MuZmlsZS5iYXNlbmFtZX0ke2RvYy5wcm9wZXJ0eSA/IGAjJHtkb2MucHJvcGVydHl9YCA6ICcnfWApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaXRlbXM7XG4gICAgfVxufSIsICIvKipcbiAqIENlbnRyYWxpemVkIG1vZGVsIGRlZmluaXRpb25zIGZvciBhbGwgQUkgcHJvdmlkZXJzXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBNb2RlbERlZmluaXRpb24ge1xuXHR2YWx1ZTogc3RyaW5nO1xuXHRsYWJlbDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vZGVsQ29uZmlnIHtcblx0Z2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBzZXR0aW5ncz86IGFueSk6IE1vZGVsRGVmaW5pdGlvbltdO1xufVxuXG4vKipcbiAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHByb3ZpZGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlOiBzdHJpbmcsIHNldHRpbmdzPzogYW55KTogTW9kZWxEZWZpbml0aW9uW10ge1xuXHRzd2l0Y2ggKHByb3ZpZGVyVHlwZSkge1xuXHRcdGNhc2UgJ2NsYXVkZSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLW9wdXMtNC0yMDI1MDUxNCcsIGxhYmVsOiAnQ2xhdWRlIE9wdXMgNCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS1zb25uZXQtNC0yMDI1MDUxNCcsIGxhYmVsOiAnQ2xhdWRlIFNvbm5ldCA0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNy1zb25uZXQtbGF0ZXN0JywgbGFiZWw6ICdDbGF1ZGUgMy43IFNvbm5ldCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtc29ubmV0LWxhdGVzdCcsIGxhYmVsOiAnQ2xhdWRlIDMuNSBTb25uZXQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy01LXNvbm5ldC0yMDI0MTAyMicsIGxhYmVsOiAnQ2xhdWRlIDMuNSBTb25uZXQgKE9jdCAyMiknIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCcsIGxhYmVsOiAnQ2xhdWRlIDMuNSBIYWlrdScgfVxuXHRcdFx0XTtcblx0XHRjYXNlICdvcGVuYWknOlxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00LjEtMjAyNS0wNC0xNCcsIGxhYmVsOiAnR1BULTQuMScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00LjEtbWluaS0yMDI1LTA0LTE0JywgbGFiZWw6ICdHUFQtNC4xIE1pbmknIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNC4xLW5hbm8tMjAyNS0wNC0xNCcsIGxhYmVsOiAnR1BULTQuMSBOYW5vJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTRvJywgbGFiZWw6ICdHUFQtNG8nIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNG8tbWluaScsIGxhYmVsOiAnR1BULTRvIE1pbmknIH1cblx0XHRcdF07XG5cdFx0Y2FzZSAnZ29vZ2xlJzpcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnLCBsYWJlbDogJ0dlbWluaSAyLjUgRmxhc2gnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMi41LXByby1wcmV2aWV3LTAzLTI1JywgbGFiZWw6ICdHZW1pbmkgMi41IFBybycgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjAtZmxhc2gnLCBsYWJlbDogJ0dlbWluaSAyLjAgRmxhc2gnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMi4wLWZsYXNoLWxpdGUnLCBsYWJlbDogJ0dlbWluaSAyLjAgRmxhc2gtTGl0ZScgfVxuXHRcdFx0XTtcblx0XHRjYXNlICdvbGxhbWEnOlxuXHRcdFx0Ly8gUmV0dXJuIHRoZSBjb25maWd1cmVkIG1vZGVsIGZyb20gc2V0dGluZ3Ncblx0XHRcdGNvbnN0IG9sbGFtYU1vZGVsID0gc2V0dGluZ3M/LmFpUHJvdmlkZXJzPy5vbGxhbWE/Lm1vZGVsO1xuXHRcdFx0aWYgKG9sbGFtYU1vZGVsICYmIG9sbGFtYU1vZGVsLnRyaW0oKSkge1xuXHRcdFx0XHRyZXR1cm4gW3sgdmFsdWU6IG9sbGFtYU1vZGVsLCBsYWJlbDogb2xsYW1hTW9kZWwgfV07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gW107XG5cdFx0ZGVmYXVsdDpcblx0XHRcdHJldHVybiBbXTtcblx0fVxufSIsICJpbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBQbGF0Zm9ybSwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3dpa2lsaW5rLXN1Z2dlc3QnO1xuaW1wb3J0IHsgQ29tbWFuZFN5c3RlbSB9IGZyb20gJy4vY29tbWFuZC1zeXN0ZW0nO1xuaW1wb3J0IHsgQ29udGV4dE1hbmFnZXIgfSBmcm9tICcuL2NvbnRleHQtbWFuYWdlcic7XG5cbi8qKlxuICogSGFuZGxlcyB0ZXh0YXJlYSBpbnB1dCwgYXV0by1ncm93LCBzZW5kIGJ1dHRvbiwgYW5kIGlucHV0IGV2ZW50c1xuICovXG5leHBvcnQgY2xhc3MgSW5wdXRIYW5kbGVyIHtcblx0cHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0ZXh0QXJlYSE6IFRleHRBcmVhQ29tcG9uZW50O1xuXHRwcml2YXRlIHNlbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgYXV0b0dyb3dUZXh0YXJlYSE6ICgpID0+IHZvaWQ7XG5cdHByaXZhdGUgd2lraWxpbmtBdXRvY29tcGxldGUhOiBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGU7XG5cdHByaXZhdGUgY29tbWFuZFN5c3RlbSE6IENvbW1hbmRTeXN0ZW07XG5cdHByaXZhdGUgY29udGV4dE1hbmFnZXI6IENvbnRleHRNYW5hZ2VyO1xuXHRwcml2YXRlIGlucHV0Um93ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEZPQ1VTX0RFTEFZX01TID0gMTUwO1xuXHRwcml2YXRlIGRyb3Bab25lT3ZlcmxheTogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBpc0RyYWdnaW5nOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgc2lkZWJhclZpZXc6IGFueTsgLy8gUmVmZXJlbmNlIHRvIE5vdmFTaWRlYmFyVmlldyBmb3IgY29udGV4dCBvcGVyYXRpb25zXG5cblx0Ly8gRXZlbnQgY2xlYW51cCB0cmFja2luZ1xuXHRwcml2YXRlIGV2ZW50TGlzdGVuZXJzOiBBcnJheTx7ZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXJ9PiA9IFtdO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHBsdWdpbjogTm92YVBsdWdpbiwgXG5cdFx0Y29udGFpbmVyOiBIVE1MRWxlbWVudCwgXG5cdFx0Y29udGV4dE1hbmFnZXI6IENvbnRleHRNYW5hZ2VyXG5cdCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdHRoaXMuY29udGV4dE1hbmFnZXIgPSBjb250ZXh0TWFuYWdlcjtcblx0fVxuXG5cdHNldFNpZGViYXJWaWV3KHNpZGViYXJWaWV3OiBhbnkpOiB2b2lkIHtcblx0XHR0aGlzLnNpZGViYXJWaWV3ID0gc2lkZWJhclZpZXc7XG5cdFx0Ly8gQWxzbyBwYXNzIHRvIHdpa2lsaW5rIGF1dG9jb21wbGV0ZSBpZiBpdCBleGlzdHNcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5zZXRTaWRlYmFyVmlldyhzaWRlYmFyVmlldyk7XG5cdFx0fVxuXHR9XG5cblx0c2V0Q29tbWFuZFN5c3RlbShjb21tYW5kU3lzdGVtOiBDb21tYW5kU3lzdGVtKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kU3lzdGVtID0gY29tbWFuZFN5c3RlbTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29tbWFuZCBidXR0b24gYmVmb3JlIHNlbmQgYnV0dG9uIGZvciBwcm9wZXIgRE9NIG9yZGVyXG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbkVsID0gdGhpcy5zZW5kQnV0dG9uLmJ1dHRvbkVsO1xuXHRcdHNlbmRCdXR0b25FbC5yZW1vdmUoKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29tbWFuZCBidXR0b25cblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0uY3JlYXRlQ29tbWFuZEJ1dHRvbih0aGlzLmlucHV0Um93KTtcblx0XHRcblx0XHQvLyBSZS1hZGQgc2VuZCBidXR0b24gKHdpbGwgYmUgbGFzdCBpbiBET00gb3JkZXIpXG5cdFx0dGhpcy5pbnB1dFJvdy5hcHBlbmRDaGlsZChzZW5kQnV0dG9uRWwpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMuY29tbWFuZFN5c3RlbS5jcmVhdGVDb21tYW5kUGlja2VySW5Db250YWluZXIodGhpcy5pbnB1dFJvdyk7XG5cdH1cblxuXHRnZXRUZXh0QXJlYSgpOiBUZXh0QXJlYUNvbXBvbmVudCB7XG5cdFx0cmV0dXJuIHRoaXMudGV4dEFyZWE7XG5cdH1cblxuXHRjcmVhdGVJbnB1dEludGVyZmFjZShjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdHRoaXMuY29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0YDtcblxuXHRcdHRoaXMuaW5wdXRSb3cgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LXJvdycgfSk7XG5cdFx0dGhpcy5pbnB1dFJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRgO1xuXG5cdFx0Ly8gVGV4dGFyZWEgY29udGFpbmVyXG5cdFx0Y29uc3QgdGV4dEFyZWFDb250YWluZXIgPSB0aGlzLmlucHV0Um93LmNyZWF0ZURpdigpO1xuXHRcdHRleHRBcmVhQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZmxleDogMTsgcG9zaXRpb246IHJlbGF0aXZlOyc7XG5cblx0XHQvLyBDcmVhdGUgdGV4dGFyZWFcblx0XHR0aGlzLnRleHRBcmVhID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHRleHRBcmVhQ29udGFpbmVyKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFBsYWNlaG9sZGVyKCdIb3cgY2FuIEkgaGVscCB3aXRoIHlvdXIgd3JpdGluZz8nKTtcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1pbi1oZWlnaHQ6IDgwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAyMDBweDtcblx0XHRcdHJlc2l6ZTogbm9uZTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LWZhbWlseTogdmFyKC0tZm9udC1pbnRlcmZhY2UpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7XG5cdFx0XHRsaW5lLWhlaWdodDogMS40O1xuXHRcdFx0d2lkdGg6IDEwMCU7XG5cdFx0XHRib3gtc2l6aW5nOiBib3JkZXItYm94O1xuXHRcdGA7XG5cblx0XHQvLyBBdXRvLWdyb3cgZnVuY3Rpb25hbGl0eVxuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSA9ICgpID0+IHtcblx0XHRcdGNvbnN0IHRleHRhcmVhID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsO1xuXHRcdFx0dGV4dGFyZWEuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuXHRcdFx0dGV4dGFyZWEuc3R5bGUuaGVpZ2h0ID0gTWF0aC5taW4odGV4dGFyZWEuc2Nyb2xsSGVpZ2h0LCAyMDApICsgJ3B4Jztcblx0XHR9O1xuXG5cdFx0Ly8gQWRkIGlucHV0IGV2ZW50IGxpc3RlbmVyIGZvciBhdXRvLWdyb3dcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAnaW5wdXQnLCB0aGlzLmF1dG9Hcm93VGV4dGFyZWEpO1xuXG5cdFx0Ly8gVHJpZ2dlciBhdXRvLWdyb3cgb24gaW5pdGlhbCBsb2FkXG5cdFx0c2V0VGltZW91dCh0aGlzLmF1dG9Hcm93VGV4dGFyZWEsIDApO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSB3aWtpbGluayBhdXRvY29tcGxldGUgd2l0aCBpbnB1dFJvdyBmb3IgY29uc2lzdGVudCB3aWR0aFxuXHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUgPSBuZXcgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlKHRoaXMucGx1Z2luLmFwcCwgdGhpcy50ZXh0QXJlYS5pbnB1dEVsLCB0aGlzLmlucHV0Um93KTtcblx0XHRcblx0XHQvLyBQYXNzIHNpZGViYXIgdmlldyByZWZlcmVuY2Ugd2hlbiBhdmFpbGFibGVcblx0XHRpZiAodGhpcy5zaWRlYmFyVmlldykge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5zZXRTaWRlYmFyVmlldyh0aGlzLnNpZGViYXJWaWV3KTtcblx0XHR9XG5cblx0XHQvLyBBZGQgZGVib3VuY2VkIGNvbnRleHQgcHJldmlld1xuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdpbnB1dCcsICgpID0+IHtcblx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIudXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKSk7XG5cdFx0fSk7XG5cblx0XHQvLyBDb21tYW5kIGJ1dHRvbiB3aWxsIGJlIGNyZWF0ZWQgbGF0ZXIgd2hlbiBDb21tYW5kU3lzdGVtIGlzIHNldFxuXG5cdFx0Ly8gU2VuZCBidXR0b25cblx0XHR0aGlzLnNlbmRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHRoaXMuaW5wdXRSb3cpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRJY29uKCdzZW5kJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldFRvb2x0aXAoJ1NlbmQgbWVzc2FnZScpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuaGFuZGxlU2VuZCgpKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1pbi13aWR0aDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0aGVpZ2h0OiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0cGFkZGluZzogMDtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7XG5cdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0YDtcblxuXHRcdC8vIEVudGVyIGtleSBoYW5kbGluZyBhbmQgY29tbWFuZC9zZWN0aW9uIHBpY2tlclxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdrZXlkb3duJywgKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0Y29uc3Qga2V5RXZlbnQgPSBldmVudCBhcyBLZXlib2FyZEV2ZW50O1xuXG5cdFx0XHRpZiAoa2V5RXZlbnQua2V5ID09PSAnRW50ZXInICYmICFrZXlFdmVudC5zaGlmdEtleSkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQodGhpcy5jb21tYW5kU3lzdGVtPy5oYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCkgfHwgZmFsc2UpIHx8IHRoaXMuaGFuZGxlU2VuZCgpO1xuXHRcdFx0fSBlbHNlIGlmIChrZXlFdmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XG5cdFx0XHRcdHRoaXMuY29tbWFuZFN5c3RlbT8uaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnQXJyb3dVcCcgfHwga2V5RXZlbnQua2V5ID09PSAnQXJyb3dEb3duJykge1xuXHRcdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtPy5oYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXlFdmVudC5rZXkpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChrZXlFdmVudC5rZXkgPT09ICdUYWInKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNvbW1hbmRTeXN0ZW0/LmhhbmRsZUNvbW1hbmRQaWNrZXJOYXZpZ2F0aW9uKGtleUV2ZW50LmtleSkpIHtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBJbnB1dCBjaGFuZ2UgaGFuZGxpbmcgZm9yIGNvbW1hbmQgcGlja2VyXG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2lucHV0JywgKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbSkge1xuXHRcdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0uaGFuZGxlSW5wdXRDaGFuZ2UoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFNldHVwIGRyYWcgYW5kIGRyb3AgZm9yIGZpbGUgY29udGV4dFxuXHRcdHRoaXMuc2V0dXBEcmFnQW5kRHJvcCgpO1xuXHR9XG5cblx0Zm9jdXMoKTogdm9pZCB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy50ZXh0QXJlYT8uaW5wdXRFbCkge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdH1cblx0XHR9LCBJbnB1dEhhbmRsZXIuRk9DVVNfREVMQVlfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVTZW5kKCk6IHZvaWQge1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZSkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2xlYXIgaW5wdXRcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLmhpZGVDb250ZXh0UHJldmlldygpO1xuXG5cdFx0Ly8gVGhpcyB3b3VsZCB0eXBpY2FsbHkgY2FsbCBhIGNhbGxiYWNrIG9yIGVtaXQgYW4gZXZlbnRcblx0XHQvLyBGb3Igbm93LCB3ZSdsbCBhc3N1bWUgdGhlIHBhcmVudCBoYW5kbGVzIHRoZSBhY3R1YWwgc2VuZGluZ1xuXHRcdHRoaXMub25TZW5kTWVzc2FnZT8uKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBvblNlbmRNZXNzYWdlPzogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZDtcblxuXHRzZXRPblNlbmRNZXNzYWdlKGNhbGxiYWNrOiAobWVzc2FnZTogc3RyaW5nKSA9PiB2b2lkKTogdm9pZCB7XG5cdFx0dGhpcy5vblNlbmRNZXNzYWdlID0gY2FsbGJhY2s7XG5cdH1cblxuXHRnZXRWYWx1ZSgpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdH1cblxuXHRzZXRWYWx1ZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSh2YWx1ZSk7XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdH1cblxuXHRpbnNlcnRUZXh0KHRleHQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRjb25zdCB0ZXh0YXJlYSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRjb25zdCBzdGFydCA9IHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0O1xuXHRcdGNvbnN0IGVuZCA9IHRleHRhcmVhLnNlbGVjdGlvbkVuZDtcblxuXHRcdGNvbnN0IG5ld1ZhbHVlID0gY3VycmVudFZhbHVlLnNsaWNlKDAsIHN0YXJ0KSArIHRleHQgKyBjdXJyZW50VmFsdWUuc2xpY2UoZW5kKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhZnRlciBpbnNlcnRlZCB0ZXh0XG5cdFx0Y29uc3QgbmV3UG9zaXRpb24gPSBzdGFydCArIHRleHQubGVuZ3RoO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UobmV3UG9zaXRpb24sIG5ld1Bvc2l0aW9uKTtcblx0XHRcdHRleHRhcmVhLmZvY3VzKCk7XG5cdFx0fSwgMCk7XG5cblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0fVxuXG5cdGluc2VydFRleHRXaXRoQ3Vyc29yKGJlZm9yZUN1cnNvcjogc3RyaW5nLCBhZnRlckN1cnNvcjogc3RyaW5nID0gJycpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0Y29uc3Qgc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDtcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XG5cblx0XHRjb25zdCBuZXdWYWx1ZSA9IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBzdGFydCkgKyBiZWZvcmVDdXJzb3IgKyBhZnRlckN1cnNvciArIGN1cnJlbnRWYWx1ZS5zbGljZShlbmQpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUobmV3VmFsdWUpO1xuXG5cdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGJldHdlZW4gYmVmb3JlIGFuZCBhZnRlciB0ZXh0XG5cdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSBzdGFydCArIGJlZm9yZUN1cnNvci5sZW5ndGg7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0ZXh0YXJlYS5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3JQb3NpdGlvbiwgY3Vyc29yUG9zaXRpb24pO1xuXHRcdFx0dGV4dGFyZWEuZm9jdXMoKTtcblx0XHR9LCAwKTtcblxuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRFdmVudExpc3RlbmVyKGVsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyKTogdm9pZCB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2goeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KTtcblx0fVxuXG5cdHByaXZhdGUgc2V0dXBEcmFnQW5kRHJvcCgpOiB2b2lkIHtcblx0XHRjb25zdCBkcm9wWm9uZSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblxuXHRcdC8vIFByZXZlbnQgZGVmYXVsdCBkcmFnIGJlaGF2aW9yc1xuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihkcm9wWm9uZSwgJ2RyYWdlbnRlcicsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy5oYW5kbGVEcmFnRW50ZXIoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihkcm9wWm9uZSwgJ2RyYWdvdmVyJywgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHQvLyBTZXQgZHJvcCBlZmZlY3QgdG8gc2hvdyBpdCdzIGFsbG93ZWRcblx0XHRcdChlIGFzIERyYWdFdmVudCkuZGF0YVRyYW5zZmVyIS5kcm9wRWZmZWN0ID0gJ2NvcHknO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKGRyb3Bab25lLCAnZHJhZ2xlYXZlJywgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHQvLyBPbmx5IGhpZGUgb3ZlcmxheSBpZiB3ZSdyZSBsZWF2aW5nIHRoZSBkcm9wIHpvbmUgZW50aXJlbHlcblx0XHRcdGlmIChlLnRhcmdldCA9PT0gZHJvcFpvbmUpIHtcblx0XHRcdFx0dGhpcy5oYW5kbGVEcmFnTGVhdmUoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihkcm9wWm9uZSwgJ2Ryb3AnLCAoZTogRXZlbnQpID0+IHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMuaGFuZGxlRHJvcChlIGFzIERyYWdFdmVudCk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyYWdFbnRlcigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5pc0RyYWdnaW5nKSByZXR1cm47XG5cdFx0dGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcblxuXHRcdC8vIENyZWF0ZSBvdmVybGF5IGZvciB2aXN1YWwgZmVlZGJhY2tcblx0XHRpZiAoIXRoaXMuZHJvcFpvbmVPdmVybGF5KSB7XG5cdFx0XHR0aGlzLmRyb3Bab25lT3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuY2xhc3NOYW1lID0gJ25vdmEtZHJvcC16b25lLW92ZXJsYXknO1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0XHR0b3A6IDA7XG5cdFx0XHRcdGxlZnQ6IDA7XG5cdFx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0XHRib3R0b206IDA7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRcdG9wYWNpdHk6IDA7XG5cdFx0XHRcdGJvcmRlcjogMnB4IGRhc2hlZCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0XHRwb2ludGVyLWV2ZW50czogbm9uZTtcblx0XHRcdFx0dHJhbnNpdGlvbjogb3BhY2l0eSAwLjJzIGVhc2U7XG5cdFx0XHRcdHotaW5kZXg6IDEwO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gQWRkIGljb24gY29udGFpbmVyXG5cdFx0XHRjb25zdCBpY29uQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRpY29uQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdFx0d2lkdGg6IDQ4cHg7XG5cdFx0XHRcdGhlaWdodDogNDhweDtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRcdGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0XHRvcGFjaXR5OiAwO1xuXHRcdFx0XHR0cmFuc2Zvcm06IHNjYWxlKDAuOCk7XG5cdFx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRgO1xuXG5cdFx0XHQvLyBBZGQgT2JzaWRpYW4ncyBwbHVzIGljb25cblx0XHRcdGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdGljb24uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMjRcIiBoZWlnaHQ9XCIyNFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48bGluZSB4MT1cIjEyXCIgeTE9XCI1XCIgeDI9XCIxMlwiIHkyPVwiMTlcIj48L2xpbmU+PGxpbmUgeDE9XCI1XCIgeTE9XCIxMlwiIHgyPVwiMTlcIiB5Mj1cIjEyXCI+PC9saW5lPjwvc3ZnPmA7XG5cdFx0XHRpY29uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdGA7XG5cblx0XHRcdGljb25Db250YWluZXIuYXBwZW5kQ2hpbGQoaWNvbik7XG5cdFx0XHR0aGlzLmRyb3Bab25lT3ZlcmxheS5hcHBlbmRDaGlsZChpY29uQ29udGFpbmVyKTtcblx0XHR9XG5cblx0XHQvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byB0ZXh0YXJlYVxuXHRcdGNvbnN0IHRleHRBcmVhQ29udGFpbmVyID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsLnBhcmVudEVsZW1lbnQhO1xuXHRcdHRleHRBcmVhQ29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmRyb3Bab25lT3ZlcmxheSk7XG5cblx0XHQvLyBBbmltYXRlIGluXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy5kcm9wWm9uZU92ZXJsYXkpIHtcblx0XHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuc3R5bGUub3BhY2l0eSA9ICcwLjEnO1xuXHRcdFx0XHRjb25zdCBpY29uID0gdGhpcy5kcm9wWm9uZU92ZXJsYXkucXVlcnlTZWxlY3RvcignZGl2JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGlmIChpY29uKSB7XG5cdFx0XHRcdFx0aWNvbi5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuXHRcdFx0XHRcdGljb24uc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sIDEwKTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlRHJhZ0xlYXZlKCk6IHZvaWQge1xuXHRcdHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuXHRcdGlmICh0aGlzLmRyb3Bab25lT3ZlcmxheSkge1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuc3R5bGUub3BhY2l0eSA9ICcwJztcblx0XHRcdGNvbnN0IGljb24gPSB0aGlzLmRyb3Bab25lT3ZlcmxheS5xdWVyeVNlbGVjdG9yKCdkaXYnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChpY29uKSB7XG5cdFx0XHRcdGljb24uc3R5bGUub3BhY2l0eSA9ICcwJztcblx0XHRcdFx0aWNvbi5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMC44KSc7XG5cdFx0XHR9XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXk/LnJlbW92ZSgpO1xuXHRcdFx0XHR0aGlzLmRyb3Bab25lT3ZlcmxheSA9IG51bGw7XG5cdFx0XHR9LCAyMDApO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlRHJvcChlOiBEcmFnRXZlbnQpOiB2b2lkIHtcblx0XHR0aGlzLmhhbmRsZURyYWdMZWF2ZSgpO1xuXG5cdFx0Y29uc3QgZmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XG5cdFx0Ly8gUGFyc2UgT2JzaWRpYW4ncyBvYnNpZGlhbjovLyBVUkxzIC0gcHJlZmVyIHRleHQvcGxhaW4gYXMgaXQgaGFzIHByb3BlciBuZXdsaW5lc1xuXHRcdGNvbnN0IHRleHRQbGFpbkRhdGEgPSBlLmRhdGFUcmFuc2Zlcj8uZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuXHRcdFxuXHRcdGlmICh0ZXh0UGxhaW5EYXRhICYmIHRleHRQbGFpbkRhdGEuaW5jbHVkZXMoJ29ic2lkaWFuOi8vb3Blbj8nKSkge1xuXHRcdFx0Ly8gSGFuZGxlIG11bHRpcGxlIFVSTHMgc2VwYXJhdGVkIGJ5IG5ld2xpbmVzXG5cdFx0XHRjb25zdCB1cmxzID0gdGV4dFBsYWluRGF0YS5zcGxpdCgvW1xcblxccl0vKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdvYnNpZGlhbjovL29wZW4/JykpO1xuXHRcdFx0XG5cdFx0XHRmb3IgKGNvbnN0IHVybFN0cmluZyBvZiB1cmxzKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Y29uc3QgdXJsID0gbmV3IFVSTCh1cmxTdHJpbmcudHJpbSgpKTtcblx0XHRcdFx0XHRjb25zdCBmaWxlUGF0aCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdmaWxlJyk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKGZpbGVQYXRoKSB7XG5cdFx0XHRcdFx0XHQvLyBEZWNvZGUgdGhlIFVSTC1lbmNvZGVkIHBhdGhcblx0XHRcdFx0XHRcdGNvbnN0IGRlY29kZWRQYXRoID0gZGVjb2RlVVJJQ29tcG9uZW50KGZpbGVQYXRoKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gRXh0cmFjdCBmaWxlbmFtZSBmcm9tIHBhdGggKGhhbmRsZSBib3RoIC8gYW5kIFxcIHNlcGFyYXRvcnMpXG5cdFx0XHRcdFx0XHRjb25zdCBwYXRoUGFydHMgPSBkZWNvZGVkUGF0aC5zcGxpdCgvWy9cXFxcXS8pO1xuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZW5hbWUgPSBwYXRoUGFydHNbcGF0aFBhcnRzLmxlbmd0aCAtIDFdO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBPbmx5IHByb2Nlc3MgbWFya2Rvd24gZmlsZXNcblx0XHRcdFx0XHRcdGlmIChmaWxlbmFtZS5lbmRzV2l0aCgnLm1kJykpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgYmFzZU5hbWUgPSBmaWxlbmFtZS5yZXBsYWNlKCcubWQnLCAnJyk7XG5cdFx0XHRcdFx0XHRcdGlmIChiYXNlTmFtZSAmJiAhZmlsZXMuaW5jbHVkZXMoYmFzZU5hbWUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZmlsZXMucHVzaChiYXNlTmFtZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIEZvciBmaWxlcyB3aXRob3V0IC5tZCBleHRlbnNpb24sIGFzc3VtZSB0aGV5J3JlIG1hcmtkb3duIG5vdGVzXG5cdFx0XHRcdFx0XHRcdC8vIChPYnNpZGlhbiBzb21ldGltZXMgb21pdHMgdGhlIC5tZCBleHRlbnNpb24gaW4gcGF0aHMpXG5cdFx0XHRcdFx0XHRcdGlmIChmaWxlbmFtZSAmJiAhZmlsZXMuaW5jbHVkZXMoZmlsZW5hbWUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZmlsZXMucHVzaChmaWxlbmFtZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKCdGYWlsZWQgdG8gcGFyc2UgT2JzaWRpYW4gVVJMOicsIHVybFN0cmluZywgZXJyb3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGZpbGVzIHRvIGNvbnRleHQgaWYgd2UgZ290IGFueVxuXHRcdGlmIChmaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLmFkZEZpbGVzVG9Db250ZXh0KGZpbGVzKTtcblx0XHR9IGVsc2UgaWYgKHRleHRQbGFpbkRhdGEgJiYgdGV4dFBsYWluRGF0YS5pbmNsdWRlcygnb2JzaWRpYW46Ly9vcGVuPycpKSB7XG5cdFx0XHQvLyBVc2VyIGRyb3BwZWQgc29tZXRoaW5nIGZyb20gT2JzaWRpYW4gYnV0IG5vIGZpbGVzIHdlcmUgZXh0cmFjdGVkXG5cdFx0XHQvLyBUaGlzIGxpa2VseSBtZWFucyB0aGV5IGRyb3BwZWQgbm9uLW1hcmtkb3duIGZpbGVzXG5cdFx0XHRuZXcgTm90aWNlKCdPbmx5IG1hcmtkb3duIGZpbGVzIGNhbiBiZSBhZGRlZCB0byBjb250ZXh0JywgMzAwMCk7XG5cdFx0fSBlbHNlIGlmICh0ZXh0UGxhaW5EYXRhICYmIHRleHRQbGFpbkRhdGEudHJpbSgpICYmICF0ZXh0UGxhaW5EYXRhLmluY2x1ZGVzKCc6Ly8nKSkge1xuXHRcdFx0Ly8gVXNlciBkcm9wcGVkIGEgZm9sZGVyIChwbGFpbiB0ZXh0IHBhdGggd2l0aG91dCBwcm90b2NvbClcblx0XHRcdG5ldyBOb3RpY2UoJ0ZvbGRlcnMgY2Fubm90IGJlIGFkZGVkIHRvIGNvbnRleHQuIFBsZWFzZSBzZWxlY3QgaW5kaXZpZHVhbCBmaWxlcy4nLCAzMDAwKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGFkZEZpbGVzVG9Db250ZXh0KGZpbGVuYW1lczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoZmlsZW5hbWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdNdWx0aS1kb2N1bWVudCBjb250ZXh0IGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nLCAzMDAwKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBBZGQgZmlsZXMgdG8gY29udGV4dFxuXHRcdGlmICh0aGlzLnNpZGViYXJWaWV3KSB7XG5cdFx0XHRhd2FpdCB0aGlzLnNpZGViYXJWaWV3LmFkZEZpbGVzVG9Db250ZXh0KGZpbGVuYW1lcyk7XG5cdFx0fVxuXHR9XG5cblxuXHRyZWZyZXNoQ29tbWFuZEJ1dHRvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0udXBkYXRlQ29tbWFuZEJ1dHRvblZpc2liaWxpdHkoKTtcblx0XHR9XG5cdH1cblxuXHR1cGRhdGVDb250ZXh0U3RhdGUoaGFzQ29udGV4dDogYm9vbGVhbik6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRhaW5lcikge1xuXHRcdFx0aWYgKGhhc0NvbnRleHQpIHtcblx0XHRcdFx0dGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgnaGFzLWNvbnRleHQnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hhcy1jb250ZXh0Jyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHQvLyBDbGVhbiB1cCB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5kZXN0cm95KCk7XG5cdFx0fVxuXG5cdFx0Ly8gQ2xlYW4gdXAgZHJvcCB6b25lIG92ZXJsYXlcblx0XHRpZiAodGhpcy5kcm9wWm9uZU92ZXJsYXkpIHtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBudWxsO1xuXHRcdH1cblxuXHRcdC8vIENsZWFuIHVwIGV2ZW50IGxpc3RlbmVyc1xuXHRcdHRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KSA9PiB7XG5cdFx0XHRlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdH0pO1xuXHRcdHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBbXTtcblx0fVxufSIsICIvKipcbiAqIE5hdGl2ZSB3aWtpbGluayBhdXRvY29tcGxldGUgZm9yIE5vdmEgdGV4dGFyZWFcbiAqIFVzZXMgT2JzaWRpYW4ncyBuYXRpdmUgRnV6enlTdWdnZXN0TW9kYWwgZm9yIGNvbnNpc3RlbnQgVVhcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSwgQXBwLCBGdXp6eVN1Z2dlc3RNb2RhbCwgRnV6enlNYXRjaCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgIHByaXZhdGUgc2lkZWJhclZpZXc6IGFueTsgLy8gUmVmZXJlbmNlIHRvIE5vdmFTaWRlYmFyVmlld1xuICAgIHByaXZhdGUgbGFzdFRyaWdnZXJQb3M6IG51bWJlciA9IC0xO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50LCBjb250YWluZXI/OiBIVE1MRWxlbWVudCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuICAgICAgICB0aGlzLnNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBzZXRTaWRlYmFyVmlldyhzaWRlYmFyVmlldzogYW55KTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2lkZWJhclZpZXcgPSBzaWRlYmFyVmlldztcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0LmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlSW5wdXQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHRBcmVhLnZhbHVlO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICBcbiAgICAgICAgLy8gTG9vayBmb3IgW1sgcGF0dGVybiBiZWZvcmUgY3Vyc29yXG4gICAgICAgIGNvbnN0IGJlZm9yZUN1cnNvciA9IHRleHQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmtNYXRjaCA9IGJlZm9yZUN1cnNvci5tYXRjaCgvXFxbXFxbKFteXFxdXSo/KSQvKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5rTWF0Y2ggJiYgY3Vyc29yUG9zICE9PSB0aGlzLmxhc3RUcmlnZ2VyUG9zKSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RUcmlnZ2VyUG9zID0gY3Vyc29yUG9zO1xuICAgICAgICAgICAgdGhpcy5zaG93TmF0aXZlRmlsZU1vZGFsKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dOYXRpdmVGaWxlTW9kYWwoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFdpa2lsaW5rRmlsZU1vZGFsKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICBhc3luYyAoZmlsZTogVEZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNlbGVjdEZpbGUoZmlsZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgY2FuY2VsbGVkIC0gcmVzZXQgdHJpZ2dlciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFRyaWdnZXJQb3MgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgbW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2VsZWN0RmlsZShmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0QXJlYS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy50ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIFtbIHBhdHRlcm4gdG8gcmVtb3ZlXG4gICAgICAgIGNvbnN0IGJlZm9yZUN1cnNvciA9IHRleHQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmtNYXRjaCA9IGJlZm9yZUN1cnNvci5tYXRjaCgvXFxbXFxbKFteXFxdXSo/KSQvKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5rTWF0Y2gpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBpbmNvbXBsZXRlIFtbIHBhdHRlcm4gZnJvbSB0aGUgaW5wdXRcbiAgICAgICAgICAgIGNvbnN0IG5ld1RleHQgPSB0ZXh0LnN1YnN0cmluZygwLCBzdGFydFBvcykgKyB0ZXh0LnN1YnN0cmluZyhjdXJzb3JQb3MpO1xuICAgICAgICAgICAgdGhpcy50ZXh0QXJlYS52YWx1ZSA9IG5ld1RleHQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgY2xlYXJlZCBwb3NpdGlvblxuICAgICAgICAgICAgdGhpcy50ZXh0QXJlYS5zZXRTZWxlY3Rpb25SYW5nZShzdGFydFBvcywgc3RhcnRQb3MpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIGlucHV0IGV2ZW50IHRvIHVwZGF0ZSBhbnkgYXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgICAgIHRoaXMudGV4dEFyZWEuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZpbGUgdG8gY29udGV4dCBhdXRvbWF0aWNhbGx5IFxuICAgICAgICBpZiAodGhpcy5zaWRlYmFyVmlldyAmJiB0aGlzLnNpZGViYXJWaWV3LmFkZEZpbGVzVG9Db250ZXh0KSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNpZGViYXJWaWV3LmFkZEZpbGVzVG9Db250ZXh0KFtmaWxlLmJhc2VuYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2V0IHRyaWdnZXIgcG9zaXRpb25cbiAgICAgICAgdGhpcy5sYXN0VHJpZ2dlclBvcyA9IC0xO1xuICAgICAgICB0aGlzLnRleHRBcmVhLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgLy8gTm8gY2xlYW51cCBuZWVkZWQgZm9yIG5hdGl2ZSBtb2RhbFxuICAgIH1cbn1cblxuLyoqXG4gKiBOYXRpdmUgT2JzaWRpYW4gZmlsZSBtb2RhbCBmb3Igd2lraWxpbmsgc2VsZWN0aW9uXG4gKi9cbmNsYXNzIFdpa2lsaW5rRmlsZU1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VEZpbGU+IHtcbiAgICBwcml2YXRlIG9uU2VsZWN0Q2FsbGJhY2s6IChmaWxlOiBURmlsZSkgPT4gdm9pZDtcbiAgICBwcml2YXRlIG9uQ2FuY2VsQ2FsbGJhY2s/OiAoKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgYWxsRmlsZXM6IFRGaWxlW10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhcHA6IEFwcCxcbiAgICAgICAgb25TZWxlY3Q6IChmaWxlOiBURmlsZSkgPT4gdm9pZCxcbiAgICAgICAgb25DYW5jZWw/OiAoKSA9PiB2b2lkXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMub25TZWxlY3RDYWxsYmFjayA9IG9uU2VsZWN0O1xuICAgICAgICB0aGlzLm9uQ2FuY2VsQ2FsbGJhY2sgPSBvbkNhbmNlbDtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ1NlYXJjaCBmaWxlcyB0byBhZGQgdG8gY29udGV4dC4uLicpO1xuICAgICAgICB0aGlzLmxvYWRGaWxlcygpO1xuICAgIH1cblxuICAgIG9uT3BlbigpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIub25PcGVuKCk7XG4gICAgICAgIHRoaXMuYWRkSW5zdHJ1Y3Rpb25zKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRJbnN0cnVjdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIC8vIEFkZCB0aGUgaW5zdHJ1Y3Rpb24gZm9vdGVyIGxpa2UgbmF0aXZlIE9ic2lkaWFuIG1vZGFsc1xuICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnNFbCA9IHRoaXMubW9kYWxFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb25zJyB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5hdkluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb25zRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KTtcbiAgICAgICAgbmF2SW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogJ1x1MjE5MVx1MjE5MycgfSk7XG4gICAgICAgIG5hdkluc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAndG8gbmF2aWdhdGUnIH0pO1xuXG4gICAgICAgIGNvbnN0IHVzZUluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb25zRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KTtcbiAgICAgICAgdXNlSW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogJ1x1MjFCNScgfSk7XG4gICAgICAgIHVzZUluc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAndG8gdXNlJyB9KTtcblxuICAgICAgICBjb25zdCBlc2NJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbicgfSk7XG4gICAgICAgIGVzY0luc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24tY29tbWFuZCcsIHRleHQ6ICdlc2MnIH0pO1xuICAgICAgICBlc2NJbnN0cnVjdGlvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ3RvIGRpc21pc3MnIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgbG9hZEZpbGVzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFsbEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICAvLyBTb3J0IGJ5IG1vZGlmaWNhdGlvbiB0aW1lIChtb3N0IHJlY2VudCBmaXJzdClcbiAgICAgICAgdGhpcy5hbGxGaWxlcy5zb3J0KChhLCBiKSA9PiBiLnN0YXQubXRpbWUgLSBhLnN0YXQubXRpbWUpO1xuICAgIH1cblxuICAgIGdldEl0ZW1zKCk6IFRGaWxlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5hbGxGaWxlcztcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBmaWxlLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbShmaWxlOiBURmlsZSk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uU2VsZWN0Q2FsbGJhY2soZmlsZSk7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihtYXRjaDogRnV6enlNYXRjaDxURmlsZT4sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlID0gbWF0Y2guaXRlbTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBjb250YWluZXIgd2l0aCBuYXRpdmUgT2JzaWRpYW4gc3VnZ2VzdGlvbiBzdHlsaW5nXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaXRsZVxuICAgICAgICBjb25zdCB0aXRsZSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcbiAgICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSBmaWxlLmJhc2VuYW1lO1xuICAgICAgICBcbiAgICAgICAgLy8gQXV4aWxpYXJ5IGluZm8gKHBhdGgpXG4gICAgICAgIGNvbnN0IGF1eCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XG4gICAgICAgIGF1eC50ZXh0Q29udGVudCA9IGZpbGUucGF0aDtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBzdXBlci5vbkNsb3NlKCk7XG4gICAgICAgIGlmICh0aGlzLm9uQ2FuY2VsQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMub25DYW5jZWxDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgfSBmcm9tICcuLi9jb3JlL3R5cGVzJztcblxuaW50ZXJmYWNlIFN0cnVjdHVyZWRDb21tYW5kIHtcblx0bmFtZTogc3RyaW5nO1xuXHRkZXNjcmlwdGlvbjogc3RyaW5nO1xuXHRjb21tYW5kOiBzdHJpbmc7XG5cdHRlbXBsYXRlOiBzdHJpbmc7XG5cdGV4YW1wbGU6IHN0cmluZztcblx0a2V5d29yZHM6IHN0cmluZ1tdO1xufVxuXG5cbi8qKlxuICogSGFuZGxlcyBjb21tYW5kIHBpY2tlciwgY29tbWFuZCBtZW51LCBhbmQgY29tbWFuZCBleGVjdXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIENvbW1hbmRTeXN0ZW0ge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHRleHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudDtcblx0cHJpdmF0ZSBjb21tYW5kQnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjb21tYW5kUGlja2VySXRlbXM6IEhUTUxFbGVtZW50W10gPSBbXTtcblx0cHJpdmF0ZSBzZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyID0gLTE7XG5cdHByaXZhdGUgY29tbWFuZE1lbnUhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpc0NvbW1hbmRNZW51VmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogTm92YVBsdWdpbiwgY29udGFpbmVyOiBIVE1MRWxlbWVudCwgdGV4dEFyZWE6IFRleHRBcmVhQ29tcG9uZW50KSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG5cdFx0dGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZEJ1dHRvbihpbnB1dFJvdzogSFRNTEVsZW1lbnQpOiBCdXR0b25Db21wb25lbnQge1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRSb3cpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5zZXRJY29uKCd6YXAnKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uc2V0VG9vbHRpcCgnQ29tbWFuZHMnKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLnRvZ2dsZUNvbW1hbmRNZW51KCkpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWluLXdpZHRoOiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRoZWlnaHQ6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGRpc3BsYXk6ICR7dGhpcy5zaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpID8gJ2ZsZXgnIDogJ25vbmUnfTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdG1hcmdpbi1yaWdodDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdGA7XG5cdFx0cmV0dXJuIHRoaXMuY29tbWFuZEJ1dHRvbjtcblx0fVxuXG5cdGNyZWF0ZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kUGlja2VySW5Db250YWluZXIodGhpcy5jb250YWluZXIpO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlcicgfSk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0YDtcblx0fVxuXG5cdHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiBQbGF0Zm9ybS5pc01vYmlsZSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbiAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpO1xuXHR9XG5cblx0dXBkYXRlQ29tbWFuZEJ1dHRvblZpc2liaWxpdHkoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZEJ1dHRvbikge1xuXHRcdFx0Y29uc3Qgc2hvdWxkU2hvdyA9IHRoaXMuc2hvdWxkU2hvd0NvbW1hbmRCdXR0b24oKTtcblx0XHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gc2hvdWxkU2hvdyA/ICdmbGV4JyA6ICdub25lJztcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY3JlYXRlQ29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUpIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRcdG1pbi13aWR0aDogMjUwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ29tbWFuZHMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gW1xuXHRcdFx0eyBuYW1lOiAnSW1wcm92ZSBXcml0aW5nJywgZGVzY3JpcHRpb246ICdFbmhhbmNlIGNsYXJpdHkgYW5kIGZsb3cnLCBjb21tYW5kOiAnaW1wcm92ZSB3cml0aW5nJyB9LFxuXHRcdFx0eyBuYW1lOiAnRml4IEdyYW1tYXInLCBkZXNjcmlwdGlvbjogJ0NvcnJlY3QgZ3JhbW1hciBhbmQgc3BlbGxpbmcnLCBjb21tYW5kOiAnZml4IGdyYW1tYXInIH0sXG5cdFx0XHR7IG5hbWU6ICdTdW1tYXJpemUnLCBkZXNjcmlwdGlvbjogJ0NyZWF0ZSBhIGNvbmNpc2Ugc3VtbWFyeScsIGNvbW1hbmQ6ICdzdW1tYXJpemUnIH0sXG5cdFx0XHR7IG5hbWU6ICdFeHBhbmQgSWRlYXMnLCBkZXNjcmlwdGlvbjogJ0RldmVsb3AgdGhvdWdodHMgZnVydGhlcicsIGNvbW1hbmQ6ICdleHBhbmQnIH0sXG5cdFx0XHR7IG5hbWU6ICdFeHBsYWluJywgZGVzY3JpcHRpb246ICdDbGFyaWZ5IGNvbXBsZXggY29uY2VwdHMnLCBjb21tYW5kOiAnZXhwbGFpbiB0aGlzJyB9LFxuXHRcdFx0eyBuYW1lOiAnQ29udGludWUgV3JpdGluZycsIGRlc2NyaXB0aW9uOiAnRXh0ZW5kIHRoZSBjdXJyZW50IHRleHQnLCBjb21tYW5kOiAnY29udGludWUgd3JpdGluZycgfVxuXHRcdF07XG5cblx0XHRjb25zdCB0aXRsZSA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogJ1F1aWNrIENvbW1hbmRzJyB9KTtcblx0XHR0aXRsZS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRgO1xuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaChjbWQgPT4ge1xuXHRcdFx0Y29uc3QgY21kRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pdGVtJyB9KTtcblx0XHRcdGNtZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKSB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy14cyk7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMXM7XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBjbWRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQubmFtZSB9KTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBkZXNjRWwgPSBjbWRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQuZGVzY3JpcHRpb24gfSk7XG5cdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRgO1xuXG5cdFx0XHRjbWRFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShjbWQuY29tbWFuZCArICcgJyk7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNtZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGNtZEVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNtZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNtZEVsLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy50ZXh0QXJlYSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBpbnB1dCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRcblx0XHQvLyBIYW5kbGUgZGlmZmVyZW50IHRyaWdnZXJzXG5cdFx0aWYgKGlucHV0LnN0YXJ0c1dpdGgoJzonKSkge1xuXHRcdFx0Ly8gQ3VzdG9tIGNvbW1hbmQgdHJpZ2dlciAtIHNob3cgc3RydWN0dXJlZCBjb21tYW5kc1xuXHRcdFx0dGhpcy5zaG93U3RydWN0dXJlZENvbW1hbmRQaWNrZXIoaW5wdXQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyB0cmlnZ2VycyBhY3RpdmUgLSBoaWRlIGNvbW1hbmQgcGlja2VyXG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblxuXHQvKipcblx0ICogU2hvdyBzdHJ1Y3R1cmVkIGNvbW1hbmQgcGlja2VyIGZvciBcIjpcIiB0cmlnZ2VyICBcblx0ICovXG5cdHByaXZhdGUgc2hvd1N0cnVjdHVyZWRDb21tYW5kUGlja2VyKGlucHV0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBzdHJ1Y3R1cmVkQ29tbWFuZHMgPSB0aGlzLmdldFN0cnVjdHVyZWRDb21tYW5kcygpO1xuXHRcdGNvbnN0IGZpbHRlclRleHQgPSBpbnB1dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgXCI6XCJcblx0XHRcblx0XHRjb25zdCBmaWx0ZXJlZCA9IHN0cnVjdHVyZWRDb21tYW5kcy5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0Y21kLmNvbW1hbmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0Y21kLmtleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBrZXl3b3JkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkpXG5cdFx0KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zID0gW107XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXG5cdFx0aWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcblx0XHRcdGZpbHRlcmVkLmZvckVhY2goKGNtZCwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZFBpY2tlci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtcGlja2VyLWl0ZW0nIH0pO1xuXHRcdFx0XHRpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG5cdFx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLm5hbWUgfSk7XG5cdFx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQuZGVzY3JpcHRpb24gfSk7XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Y29uc3QgZXhhbXBsZUVsID0gaXRlbS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBgRXhhbXBsZTogJHtjbWQuZXhhbXBsZX1gIH0pO1xuXHRcdFx0XHRleGFtcGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWFjY2VudCk7XG5cdFx0XHRcdFx0Zm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0U3RydWN0dXJlZENvbW1hbmQoY21kLnRlbXBsYXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRoaWRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblx0fVxuXG5cdGhhbmRsZUNvbW1hbmRQaWNrZXJOYXZpZ2F0aW9uKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0aWYgKGtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1pbih0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgMSwgdGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoIC0gMSk7XG5cdFx0XHR0aGlzLnVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0gZWxzZSBpZiAoa2V5ID09PSAnQXJyb3dVcCcpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1heCh0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4IC0gMSwgLTEpO1xuXHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ1RhYicgJiYgdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA+PSAwKSB7XG5cdFx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbiBmb3IgVGFiXG5cdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0aGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA+PSAwICYmIHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA+IDApIHtcblx0XHRcdC8vIEZvciBzdHJ1Y3R1cmVkIGNvbW1hbmRzLCB3ZSBuZWVkIHRvIGdldCB0aGUgc2VsZWN0ZWQgY29tbWFuZCBmcm9tIHRoZSBmaWx0ZXJlZCBsaXN0XG5cdFx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0U3RydWN0dXJlZENvbW1hbmRzKCk7XG5cdFx0XHRjb25zdCBpbnB1dCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRcdGlmIChpbnB1dC5zdGFydHNXaXRoKCc6JykpIHtcblx0XHRcdFx0Y29uc3QgZmlsdGVyVGV4dCA9IGlucHV0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdGNvbnN0IGZpbHRlcmVkID0gY29tbWFuZHMuZmlsdGVyKGNtZCA9PiBcblx0XHRcdFx0XHRjbWQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpIHx8XG5cdFx0XHRcdFx0Y21kLmNvbW1hbmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0XHRcdGNtZC5rZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4ga2V5d29yZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpKVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPCBmaWx0ZXJlZC5sZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBzZWxlY3RlZENtZCA9IGZpbHRlcmVkW3RoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXhdO1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0U3RydWN0dXJlZENvbW1hbmQoc2VsZWN0ZWRDbWQudGVtcGxhdGUpO1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuXHRcdFx0aWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4KSB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzZWxlY3RDb21tYW5kKGNvbW1hbmQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoY29tbWFuZCArICcgJyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XG5cdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IGVuZFxuXHRcdGNvbnN0IGxlbmd0aCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKS5sZW5ndGg7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKGxlbmd0aCwgbGVuZ3RoKTtcblx0XHRcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdH1cblxuXG5cdC8qKlxuXHQgKiBHZXQgc3RydWN0dXJlZCBjb21tYW5kcyBmb3IgXCI6XCIgdHJpZ2dlclxuXHQgKi9cblx0cHJpdmF0ZSBnZXRTdHJ1Y3R1cmVkQ29tbWFuZHMoKTogU3RydWN0dXJlZENvbW1hbmRbXSB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0FkZCBDb250ZW50Jyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgbmV3IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uJyxcblx0XHRcdFx0Y29tbWFuZDogJ2FkZCcsXG5cdFx0XHRcdHRlbXBsYXRlOiAnYWRkIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzphZGQgcGFyYWdyYXBoIGFib3V0IG1ldGhvZG9sb2d5Jyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY3JlYXRlJywgJ25ldycsICdpbnNlcnQnLCAnd3JpdGUnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0VkaXQgU2VsZWN0aW9uJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdFZGl0IHRoZSBzZWxlY3RlZCB0ZXh0Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2VkaXQnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2VkaXQgdG8ge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmVkaXQgdG8gYmUgbW9yZSBmb3JtYWwnLFxuXHRcdFx0XHRrZXl3b3JkczogWydtb2RpZnknLCAndXBkYXRlJywgJ2NoYW5nZScsICdyZXZpc2UnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0RlbGV0ZSBTZWxlY3Rpb24nLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogJ1JlbW92ZSB0aGUgc2VsZWN0ZWQgdGV4dCcsXG5cdFx0XHRcdGNvbW1hbmQ6ICdkZWxldGUnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2RlbGV0ZSB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6ZGVsZXRlIHNlbGVjdGVkIHRleHQnLFxuXHRcdFx0XHRrZXl3b3JkczogWydyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2VyYXNlJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdSZXdyaXRlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdSZXdyaXRlIGNvbnRlbnQgd2l0aCBzcGVjaWZpYyBzdHlsZScsXG5cdFx0XHRcdGNvbW1hbmQ6ICdyZXdyaXRlJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdyZXdyaXRlIGFzIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzpyZXdyaXRlIGFzIGJ1bGxldCBwb2ludHMnLFxuXHRcdFx0XHRrZXl3b3JkczogWydyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZXdvcmQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0ZpeCBHcmFtbWFyJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdDb3JyZWN0IGdyYW1tYXIgYW5kIHNwZWxsaW5nIGVycm9ycycsXG5cdFx0XHRcdGNvbW1hbmQ6ICdncmFtbWFyJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdmaXggZ3JhbW1hciB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6Zml4IGdyYW1tYXIgaW4gc2VsZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY29ycmVjdCcsICdwcm9vZnJlYWQnLCAnc3BlbGxpbmcnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0NvbnRpbnVlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdDb250aW51ZSB3cml0aW5nIGZyb20gY3VycmVudCBwb3NpdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdjb250aW51ZScsXG5cdFx0XHRcdHRlbXBsYXRlOiAnY29udGludWUge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmNvbnRpbnVlIHdpdGggZXhhbXBsZXMnLFxuXHRcdFx0XHRrZXl3b3JkczogWydleHRlbmQnLCAnZXhwYW5kJywgJ3Byb2NlZWQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ1VwZGF0ZSBNZXRhZGF0YScsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnVXBkYXRlIGRvY3VtZW50IHByb3BlcnRpZXMnLFxuXHRcdFx0XHRjb21tYW5kOiAnbWV0YWRhdGEnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ3VwZGF0ZSB7Y3Vyc29yfSBwcm9wZXJ0eScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6dXBkYXRlIHRhZ3MgcHJvcGVydHknLFxuXHRcdFx0XHRrZXl3b3JkczogWydmcm9udG1hdHRlcicsICdwcm9wZXJ0aWVzJywgJ3RhZ3MnXVxuXHRcdFx0fVxuXHRcdF07XG5cdH1cblxuXHQvKipcblx0ICogU2VsZWN0IGEgc3RydWN0dXJlZCBjb21tYW5kIGFuZCBpbnNlcnQgdGVtcGxhdGVcblx0ICovXG5cdHByaXZhdGUgc2VsZWN0U3RydWN0dXJlZENvbW1hbmQodGVtcGxhdGU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcblx0XHQvLyBSZXBsYWNlIGN1cnNvciBwbGFjZWhvbGRlciBhbmQgaW5zZXJ0IHRlbXBsYXRlXG5cdFx0Y29uc3QgY3Vyc29yUG9zID0gdGVtcGxhdGUuaW5kZXhPZigne2N1cnNvcn0nKTtcblx0XHRpZiAoY3Vyc29yUG9zICE9PSAtMSkge1xuXHRcdFx0Y29uc3QgYmVmb3JlQ3Vyc29yID0gdGVtcGxhdGUuc2xpY2UoMCwgY3Vyc29yUG9zKTtcblx0XHRcdGNvbnN0IGFmdGVyQ3Vyc29yID0gdGVtcGxhdGUuc2xpY2UoY3Vyc29yUG9zICsgOCk7IC8vIExlbmd0aCBvZiAne2N1cnNvcn0nXG5cdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGJlZm9yZUN1cnNvciArIGFmdGVyQ3Vyc29yKTtcblx0XHRcdFxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIHdoZXJlIHtjdXJzb3J9IHdhc1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3JQb3MsIGN1cnNvclBvcyk7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0fSwgMCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodGVtcGxhdGUpO1xuXHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5yZW1vdmUoKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLnJlbW92ZSgpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsYXRmb3JtLCBURmlsZSwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBNdWx0aURvY0NvbnRleHRIYW5kbGVyLCBNdWx0aURvY0NvbnRleHQgfSBmcm9tICcuLi9jb3JlL211bHRpLWRvYy1jb250ZXh0JztcblxuLyoqXG4gKiBIYW5kbGVzIG11bHRpLWRvY3VtZW50IGNvbnRleHQgVUkgYW5kIG1hbmFnZW1lbnRcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRNYW5hZ2VyIHtcblx0cHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgYXBwOiBBcHA7XG5cdHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBtdWx0aURvY0hhbmRsZXI6IE11bHRpRG9jQ29udGV4dEhhbmRsZXI7XG5cdHB1YmxpYyBjb250ZXh0SW5kaWNhdG9yITogSFRNTEVsZW1lbnQ7XG5cdHB1YmxpYyBjb250ZXh0UHJldmlldyE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGN1cnJlbnRDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBzaWRlYmFyVmlldzogYW55OyAvLyBSZWZlcmVuY2UgdG8gTm92YVNpZGViYXJWaWV3IGZvciBhZGRpbmcgZmlsZXNcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTk9USUNFX0RVUkFUSU9OX01TID0gNTAwMDtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE5vdmFQbHVnaW4sIGFwcDogQXBwLCBjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5hcHAgPSBhcHA7XG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG5cdFx0dGhpcy5tdWx0aURvY0hhbmRsZXIgPSBuZXcgTXVsdGlEb2NDb250ZXh0SGFuZGxlcihhcHApO1xuXHR9XG5cblx0c2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXc6IGFueSk6IHZvaWQge1xuXHRcdHRoaXMuc2lkZWJhclZpZXcgPSBzaWRlYmFyVmlldztcblx0fVxuXG5cdGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IC0ycHg7XG5cdFx0XHRyaWdodDogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0xKSB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0ei1pbmRleDogMTAwO1xuXHRcdFx0bWF4LXdpZHRoOiAyMDBweDtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRgO1xuXHR9XG5cblx0Y3JlYXRlQ29udGV4dFByZXZpZXcoKTogSFRNTEVsZW1lbnQge1xuXHRcdGNvbnN0IHByZXZpZXdDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsKTtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdMYWJlbCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IHRleHQ6ICdDb250ZXh0OiAnIH0pO1xuXHRcdHByZXZpZXdMYWJlbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC13ZWlnaHQ6IDYwMDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dFByZXZpZXcgfHwgIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0Zm91bmRSZWZzLnB1c2goeyBuYW1lOiBkb2NOYW1lLCBwcm9wZXJ0eSB9KTtcblx0XHR9XG5cblx0XHRpZiAoZm91bmRSZWZzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3IGRpc3BsYXlcblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdGNvbnN0IHJlZnNUZXh0ID0gZm91bmRSZWZzLm1hcChyZWYgPT4gXG5cdFx0XHRcdHJlZi5wcm9wZXJ0eSA/IGAke3JlZi5uYW1lfSMke3JlZi5wcm9wZXJ0eX1gIDogcmVmLm5hbWVcblx0XHRcdCkuam9pbignLCAnKTtcblx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gcmVmc1RleHQ7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdGFzeW5jIGJ1aWxkQ29udGV4dChtZXNzYWdlOiBzdHJpbmcsIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPE11bHRpRG9jQ29udGV4dCB8IG51bGw+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykgfHwgIWN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2UsIGN1cnJlbnRGaWxlKTtcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSByZXN1bHQuY29udGV4dDtcblxuXHRcdFx0aWYgKHJlc3VsdC5jb250ZXh0Py5wZXJzaXN0ZW50RG9jcy5sZW5ndGgpIHtcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKHJlc3VsdC5jb250ZXh0KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIHRva2VuIGxpbWl0XG5cdFx0XHRcdGlmIChyZXN1bHQuY29udGV4dC5pc05lYXJMaW1pdCkge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1x1MjZBMFx1RkUwRiBBcHByb2FjaGluZyB0b2tlbiBsaW1pdC4gQ29uc2lkZXIgcmVtb3Zpbmcgc29tZSBkb2N1bWVudHMgZnJvbSBjb250ZXh0LicsIENvbnRleHRNYW5hZ2VyLk5PVElDRV9EVVJBVElPTl9NUyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJlc3VsdC5jb250ZXh0O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBGYWlsZWQgdG8gYnVpbGQgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHJldHVybjtcblxuXHRcdGNvbnN0IGRvY0NvdW50ID0gY29udGV4dC5wZXJzaXN0ZW50RG9jcy5sZW5ndGg7XG5cdFx0aWYgKGRvY0NvdW50ID4gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnRleHRDb250ZW50ID0gYCR7ZG9jQ291bnR9IGRvYyR7ZG9jQ291bnQgPiAxID8gJ3MnIDogJyd9YDtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblxuXHRcdFx0Ly8gQWRkIGV4cGFuZCBmdW5jdGlvbmFsaXR5XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLm9uY2xpY2sgPSAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2hvd0NvbnRleHREZXRhaWxzKGNvbnRleHQpO1xuXHRcdFx0fTtcblxuXHRcdFx0Ly8gQWRkIGhvdmVyIGVmZmVjdFxuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWludGVyYWN0aXZlLWhvdmVyKSc7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtcHJpbWFyeSknO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbnRleHREZXRhaWxzKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHZvaWQge1xuXHRcdC8vIENyZWF0ZSBtb2RhbCBvciBleHBhbmRlZCB2aWV3XG5cdFx0Y29uc3QgbW9kYWwgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtbW9kYWwnIH0pO1xuXHRcdG1vZGFsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogZml4ZWQ7XG5cdFx0XHR0b3A6IDA7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRib3R0b206IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0ei1pbmRleDogMTAwMDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5jcmVhdGVEaXYoKTtcblx0XHRjb250ZW50LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTQpO1xuXHRcdFx0bWF4LXdpZHRoOiA4MCU7XG5cdFx0XHRtYXgtaGVpZ2h0OiA4MCU7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0Ym94LXNoYWRvdzogdmFyKC0tc2hhZG93LXMpO1xuXHRcdGA7XG5cblx0XHRjb25zdCBoZWFkZXIgPSBjb250ZW50LmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0NvbnRleHQgRG9jdW1lbnRzJyB9KTtcblx0XHRoZWFkZXIuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tdG9wOiAwOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMyk7JztcblxuXHRcdGNvbnRleHQucGVyc2lzdGVudERvY3MuZm9yRWFjaChkb2MgPT4ge1xuXHRcdFx0Y29uc3QgZG9jRWwgPSBjb250ZW50LmNyZWF0ZURpdigpO1xuXHRcdFx0ZG9jRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMteHMpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gZG9jRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogZG9jLmZpbGUuYmFzZW5hbWUgfSk7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNjAwOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7JztcblxuXHRcdFx0aWYgKGRvYy5wcm9wZXJ0eSkge1xuXHRcdFx0XHRjb25zdCBwcm9wRWwgPSBkb2NFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBgUHJvcGVydHk6ICR7ZG9jLnByb3BlcnR5fWAgfSk7XG5cdFx0XHRcdHByb3BFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyc7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNob3cgZmlsZSBwYXRoIGFzIHByZXZpZXcgc2luY2UgY29udGVudCBpc24ndCBkaXJlY3RseSBhdmFpbGFibGVcblx0XHRcdGNvbnN0IHByZXZpZXdFbCA9IGRvY0VsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGRvYy5maWxlLnBhdGggfSk7XG5cdFx0XHRwcmV2aWV3RWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLXRvcDogdmFyKC0tc2l6ZS0yLTEpOyc7XG5cdFx0fSk7XG5cblx0XHQvLyBCdXR0b24gY29udGFpbmVyXG5cdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudC5jcmVhdGVEaXYoKTtcblx0XHRidXR0b25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi10b3A6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRnYXA6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG5cdFx0YDtcblxuXG5cdFx0Ly8gQ2xvc2UgYnV0dG9uXG5cdFx0Y29uc3QgY2xvc2VCdG4gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0Nsb3NlJyB9KTtcblx0XHRjbG9zZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0YDtcblxuXHRcdGNsb3NlQnRuLm9uY2xpY2sgPSAoKSA9PiBtb2RhbC5yZW1vdmUoKTtcblx0XHRtb2RhbC5vbmNsaWNrID0gKGUpID0+IHtcblx0XHRcdGlmIChlLnRhcmdldCA9PT0gbW9kYWwpIG1vZGFsLnJlbW92ZSgpO1xuXHRcdH07XG5cdH1cblxuXHRoaWRlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRoaWRlQ29udGV4dEluZGljYXRvcigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRjbGVhckN1cnJlbnRDb250ZXh0KCk6IHZvaWQge1xuXHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdHRoaXMuaGlkZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHR0aGlzLmhpZGVDb250ZXh0UHJldmlldygpO1xuXHR9XG5cblx0Z2V0Q3VycmVudENvbnRleHQoKTogTXVsdGlEb2NDb250ZXh0IHwgbnVsbCB7XG5cdFx0cmV0dXJuIHRoaXMuY3VycmVudENvbnRleHQ7XG5cdH1cblxuXG5cdGNsZWFudXAoKTogdm9pZCB7XG5cdFx0dGhpcy5jbGVhckN1cnJlbnRDb250ZXh0KCk7XG5cdFx0aWYgKHRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5yZW1vdmUoKTtcblx0XHR9XG5cdH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcblxuLyoqXG4gKiBNZXNzYWdlIG9wdGlvbnMgZm9yIHVuaWZpZWQgbWVzc2FnZSBjcmVhdGlvblxuICovXG5pbnRlcmZhY2UgTWVzc2FnZU9wdGlvbnMge1xuXHR0eXBlOiAncGlsbCcgfCAnYnViYmxlJztcblx0dmFyaWFudDogJ3N1Y2Nlc3MnIHwgJ2Vycm9yJyB8ICdzeXN0ZW0nIHwgJ3VzZXInIHwgJ2Fzc2lzdGFudCc7XG5cdHBlcnNpc3Q/OiBib29sZWFuOyAvLyBXaGV0aGVyIHRvIHNhdmUgdG8gY29udmVyc2F0aW9uIG1hbmFnZXJcbn1cblxuLyoqXG4gKiBIYW5kbGVzIGFsbCBjaGF0IG1lc3NhZ2UgcmVuZGVyaW5nIGFuZCBkaXNwbGF5IGxvZ2ljXG4gKi9cbmV4cG9ydCBjbGFzcyBDaGF0UmVuZGVyZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgU0NST0xMX0RFTEFZX01TID0gNTA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGNoYXRDb250YWluZXI7XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGEgY2hhdCBtZXNzYWdlIHdpdGggcm9sZSBoZWFkZXJcblx0ICovXG5cdGFkZE1lc3NhZ2Uocm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtJHtyb2xlfWAgfSk7XG5cdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMykgdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHQke3JvbGUgPT09ICd1c2VyJyBcblx0XHRcdFx0PyAnbWFyZ2luLWxlZnQ6IGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7JyBcblx0XHRcdFx0OiByb2xlID09PSAnc3lzdGVtJ1xuXHRcdFx0XHQ/ICdtYXJnaW46IDAgYXV0bzsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG5cdH1cblxuXHQvKipcblx0ICogVW5pZmllZCBtZXNzYWdlIGNyZWF0aW9uIC0gZGV0ZXJtaW5lcyBDU1MgY2xhc3MgYXQgY3JlYXRpb24gdGltZVxuXHQgKi9cblx0YWRkU3RhdHVzTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIG9wdGlvbnM6IE1lc3NhZ2VPcHRpb25zKTogdm9pZCB7XG5cdFx0Ly8gRGV0ZXJtaW5lIENTUyBjbGFzcyBiYXNlZCBvbiB0eXBlIGFuZCB2YXJpYW50XG5cdFx0Y29uc3QgY3NzQ2xhc3MgPSB0aGlzLmdldE1lc3NhZ2VDU1NDbGFzcyhjb250ZW50LCBvcHRpb25zKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgbWVzc2FnZSBlbGVtZW50IHdpdGggc3RhdGljIENTUyBjbGFzc1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2UgJHtjc3NDbGFzc31gIH0pO1xuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0XG5cdFx0aWYgKGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0Ly8gU2F2ZSB0byBjb252ZXJzYXRpb24gbWFuYWdlciBpZiByZXF1ZXN0ZWRcblx0XHRpZiAob3B0aW9ucy5wZXJzaXN0KSB7XG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFN5c3RlbU1lc3NhZ2UoXG5cdFx0XHRcdFx0YWN0aXZlRmlsZSwgXG5cdFx0XHRcdFx0Y29udGVudCxcblx0XHRcdFx0XHR7IG1lc3NhZ2VUeXBlOiBjc3NDbGFzcyB9IC8vIFN0b3JlIENTUyBjbGFzcyBhcyBtZXRhZGF0YVxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0TWVzc2FnZUNTU0NsYXNzKGNvbnRlbnQ6IHN0cmluZywgb3B0aW9uczogTWVzc2FnZU9wdGlvbnMpOiBzdHJpbmcge1xuXHRcdGlmIChvcHRpb25zLnR5cGUgPT09ICdwaWxsJykge1xuXHRcdFx0cmV0dXJuIGBub3ZhLXBpbGwtJHtvcHRpb25zLnZhcmlhbnR9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGBub3ZhLWJ1YmJsZS0ke29wdGlvbnMudmFyaWFudH1gO1xuXHRcdH1cblx0fVxuXG5cdC8vIFNpbXBsZSB3cmFwcGVyIG1ldGhvZHMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblx0YWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nLCBwZXJzaXN0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcblx0XHQvLyBBdXRvLXByZXBlbmQgY2hlY2ttYXJrIGlmIG5vdCBhbHJlYWR5IHByZXNlbnRcblx0XHRpZiAoIWNvbnRlbnQuc3RhcnRzV2l0aCgnXHUyNzEzICcpICYmICFjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnQgPSAnXHUyNzEzICcgKyBjb250ZW50O1xuXHRcdH1cblx0XHQvLyBBbHdheXMgdXNlIHBpbGxzIGZvciBzdWNjZXNzIG1lc3NhZ2VzIHRvIG1haW50YWluIGNvbnNpc3RlbmN5XG5cdFx0dGhpcy5hZGRTdGF0dXNNZXNzYWdlKGNvbnRlbnQsIHsgdHlwZTogJ3BpbGwnLCB2YXJpYW50OiAnc3VjY2VzcycsIHBlcnNpc3QgfSk7XG5cdH1cblxuXHRhZGRFcnJvck1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBwZXJzaXN0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcblx0XHQvLyBBdXRvLXByZXBlbmQgWCBpZiBub3QgYWxyZWFkeSBwcmVzZW50XG5cdFx0aWYgKCFjb250ZW50LnN0YXJ0c1dpdGgoJ1x1Mjc0QyAnKSAmJiAhY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50ID0gJ1x1Mjc0QyAnICsgY29udGVudDtcblx0XHR9XG5cdFx0Y29uc3QgdHlwZSA9IGNvbnRlbnQubGVuZ3RoIDw9IDMwID8gJ3BpbGwnIDogJ2J1YmJsZSc7XG5cdFx0dGhpcy5hZGRTdGF0dXNNZXNzYWdlKGNvbnRlbnQsIHsgdHlwZSwgdmFyaWFudDogJ2Vycm9yJywgcGVyc2lzdCB9KTtcblx0fVxuXG5cdGFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2U/OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCB3ZWxjb21lRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lJyB9KTtcblx0XHR3ZWxjb21lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC00KTtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBtZXNzYWdlIHx8IGBcblx0XHRcdDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPlxuXHRcdFx0XHQ8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAzMnB4OyBoZWlnaHQ6IDMycHg7IGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XCI+XG5cdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDwvc3ZnPlxuXHRcdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgbWFyZ2luLWxlZnQ6IHZhcigtLXNpemUtMi0zKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTsgbGluZS1oZWlnaHQ6IDEuNDsgdGV4dC1hbGlnbjogbGVmdDsgYWxpZ24tc2VsZjogZmxleC1zdGFydDtcIj5cblx0XHRcdFx0XHRJJ20geW91ciBBSSB3cml0aW5nIHBhcnRuZXIuIEFzayBxdWVzdGlvbnMgaW4gY2hhdCBvciBnaXZlIGNvbW1hbmRzIHRvIGVkaXQgYXQgeW91ciBjdXJzb3IgcG9zaXRpb24uPGJyPjxicj5DVFJML0NNRC1aIG9uY2Ugb3IgdHdpY2UgdG8gdW5kbyBjaGFuZ2VzLlxuXHRcdFx0XHQ8L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0d2VsY29tZUVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cblx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKHRydWUpO1xuXHR9XG5cblxuXHRjbGVhckNoYXQoKTogdm9pZCB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdH1cblxuXHRwcml2YXRlIHNjcm9sbFRvQm90dG9tKHNtb290aDogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAoc21vb3RoKSB7XG5cdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJ1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUb3AgPSB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0fVxuXHRcdH0sIENoYXRSZW5kZXJlci5TQ1JPTExfREVMQVlfTVMpO1xuXHR9XG5cblx0YXN5bmMgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNTApO1xuXHRcdFxuXHRcdGlmIChtZXNzYWdlcy5sZW5ndGggPT09IDApIHtcblx0XHRcdC8vIE5vIGNvbnZlcnNhdGlvbiBleGlzdHMgLSBzaG93IHdlbGNvbWUgbWVzc2FnZVxuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgbWVzc2FnZXMpIHtcblx0XHRcdGlmIChtZXNzYWdlLnJvbGUgPT09ICdzeXN0ZW0nICYmIG1lc3NhZ2UubWV0YWRhdGE/Lm1lc3NhZ2VUeXBlKSB7XG5cdFx0XHRcdC8vIFJlc3RvcmUgc3lzdGVtIG1lc3NhZ2Ugd2l0aCBvcmlnaW5hbCBzdHlsaW5nXG5cdFx0XHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBcblx0XHRcdFx0XHRjbHM6IGBub3ZhLW1lc3NhZ2UgJHttZXNzYWdlLm1ldGFkYXRhLm1lc3NhZ2VUeXBlfWAgXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKG1lc3NhZ2UuY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IG1lc3NhZ2UuY29udGVudDtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBtZXNzYWdlLmNvbnRlbnQ7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFJlZ3VsYXIgdXNlci9hc3Npc3RhbnQgbWVzc2FnZXNcblx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKG1lc3NhZ2Uucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBtZXNzYWdlLmNvbnRlbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKCk7XG5cdH1cbn0iLCAiLyoqXG4gKiBVbmlmaWVkIHN0cmVhbWluZyBhbmQgbm90aWNlIG1hbmFnZW1lbnQgZm9yIE5vdmFcbiAqIFByb3ZpZGVzIGNvbnNpc3RlbnQgdmlzdWFsIGZlZWRiYWNrIGFuZCBzdHJlYW1pbmcgYWNyb3NzIGFsbCBjb21tYW5kIHR5cGVzXG4gKi9cblxuaW1wb3J0IHsgRWRpdG9yLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RyZWFtaW5nT3B0aW9ucyB7XG4gICAgb25DaHVuaz86IChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB2b2lkO1xuICAgIG9uQ29tcGxldGU/OiAoKSA9PiB2b2lkO1xuICAgIG9uRXJyb3I/OiAoZXJyb3I6IEVycm9yKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgdHlwZSBBY3Rpb25UeXBlID0gJ2ltcHJvdmUnIHwgJ2xvbmdlcicgfCAnc2hvcnRlcicgfCAndG9uZScgfCAnY3VzdG9tJyB8ICdjaGF0JyB8ICdhZGQnIHwgJ2VkaXQnIHwgJ3Jld3JpdGUnIHwgJ2dyYW1tYXInIHwgJ2RlbGV0ZSc7XG5cbmV4cG9ydCBjbGFzcyBTdHJlYW1pbmdNYW5hZ2VyIHtcbiAgICBwcml2YXRlIGRvdHNBbmltYXRpb25JbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIHRoaW5raW5nTm90aWNlOiBOb3RpY2UgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIGN1cnJlbnRTdHJlYW1pbmdFbmRQb3M6IGFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdHJlYW1pbmdTdGFydFBvczogYW55ID0gbnVsbDtcbiAgICBwcml2YXRlIG9yaWdpbmFsUG9zaXRpb246IGFueSA9IG51bGw7XG5cbiAgICAvLyBDb21wcmVoZW5zaXZlIHRoaW5raW5nIHBocmFzZXMgZm9yIGFsbCBhY3Rpb24gdHlwZXNcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBUSElOS0lOR19QSFJBU0VTOiBSZWNvcmQ8QWN0aW9uVHlwZSwgc3RyaW5nW10+ID0ge1xuICAgICAgICAnaW1wcm92ZSc6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2xvbmdlcic6IFtcbiAgICAgICAgICAgICdleHBhbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2RldmVsb3BpbmcuLi4nLFxuICAgICAgICAgICAgJ2VsYWJvcmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdidWlsZGluZy4uLicsXG4gICAgICAgICAgICAnZW5yaWNoaW5nLi4uJyxcbiAgICAgICAgICAgICdkZWVwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2dyb3dpbmcuLi4nLFxuICAgICAgICAgICAgJ2V4dGVuZGluZy4uLicsXG4gICAgICAgICAgICAnYW1wbGlmeWluZy4uLicsXG4gICAgICAgICAgICAndW5mb2xkaW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnc2hvcnRlcic6IFtcbiAgICAgICAgICAgICdjb25kZW5zaW5nLi4uJyxcbiAgICAgICAgICAgICdkaXN0aWxsaW5nLi4uJyxcbiAgICAgICAgICAgICd0aWdodGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdmb2N1c2luZy4uLicsXG4gICAgICAgICAgICAnc3RyZWFtbGluaW5nLi4uJyxcbiAgICAgICAgICAgICdjb21wcmVzc2luZy4uLicsXG4gICAgICAgICAgICAndHJpbW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2NsYXJpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ3NpbXBsaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdjb25jZW50cmF0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAndG9uZSc6IFtcbiAgICAgICAgICAgICdhZGp1c3RpbmcgdG9uZS4uLicsXG4gICAgICAgICAgICAncmVzaGFwaW5nLi4uJyxcbiAgICAgICAgICAgICdyZWZyYW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2FkYXB0aW5nLi4uJyxcbiAgICAgICAgICAgICd0cmFuc2Zvcm1pbmcuLi4nLFxuICAgICAgICAgICAgJ21vZHVsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlY2FzdGluZy4uLicsXG4gICAgICAgICAgICAnc2hpZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlZm9ybWluZy4uLicsXG4gICAgICAgICAgICAncmVpbWFnaW5pbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdjdXN0b20nOiBbXG4gICAgICAgICAgICAnd29ya2luZyBvbiBpdC4uLicsXG4gICAgICAgICAgICAnY29uc2lkZXJpbmcuLi4nLFxuICAgICAgICAgICAgJ3RoaW5raW5nLi4uJyxcbiAgICAgICAgICAgICdwcm9jZXNzaW5nLi4uJyxcbiAgICAgICAgICAgICdhbmFseXppbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbnRlbXBsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3VuZGVyc3RhbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ludGVycHJldGluZy4uLicsXG4gICAgICAgICAgICAnZXhwbG9yaW5nLi4uJyxcbiAgICAgICAgICAgICdldmFsdWF0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnY2hhdCc6IFtcbiAgICAgICAgICAgICdjb21wb3NpbmcuLi4nLFxuICAgICAgICAgICAgJ2RyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdjcmVhdGluZy4uLicsXG4gICAgICAgICAgICAnZ2VuZXJhdGluZy4uLicsXG4gICAgICAgICAgICAnd3JpdGluZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ2Zvcm11bGF0aW5nLi4uJyxcbiAgICAgICAgICAgICdkZXZlbG9waW5nLi4uJyxcbiAgICAgICAgICAgICdidWlsZGluZy4uLicsXG4gICAgICAgICAgICAnY29uc3RydWN0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnYWRkJzogW1xuICAgICAgICAgICAgJ2NvbXBvc2luZy4uLicsXG4gICAgICAgICAgICAnZHJhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyZWF0aW5nLi4uJyxcbiAgICAgICAgICAgICdnZW5lcmF0aW5nLi4uJyxcbiAgICAgICAgICAgICd3cml0aW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAnZm9ybXVsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2RldmVsb3BpbmcuLi4nLFxuICAgICAgICAgICAgJ2J1aWxkaW5nLi4uJyxcbiAgICAgICAgICAgICdjb25zdHJ1Y3RpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdlZGl0JzogW1xuICAgICAgICAgICAgJ3JlZmluaW5nLi4uJyxcbiAgICAgICAgICAgICdwb2xpc2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2VuaGFuY2luZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3BlcmZlY3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3Ntb290aGluZy4uLicsXG4gICAgICAgICAgICAnc2hhcnBlbmluZy4uLicsXG4gICAgICAgICAgICAnZWxldmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdmaW5lLXR1bmluZy4uLicsXG4gICAgICAgICAgICAnc2N1bHB0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAncmV3cml0ZSc6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2dyYW1tYXInOiBbXG4gICAgICAgICAgICAncmVmaW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3BvbGlzaGluZy4uLicsXG4gICAgICAgICAgICAnZW5oYW5jaW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAncGVyZmVjdGluZy4uLicsXG4gICAgICAgICAgICAnc21vb3RoaW5nLi4uJyxcbiAgICAgICAgICAgICdzaGFycGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdlbGV2YXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ZpbmUtdHVuaW5nLi4uJyxcbiAgICAgICAgICAgICdzY3VscHRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdkZWxldGUnOiBbXG4gICAgICAgICAgICAnY29uZGVuc2luZy4uLicsXG4gICAgICAgICAgICAnZGlzdGlsbGluZy4uLicsXG4gICAgICAgICAgICAndGlnaHRlbmluZy4uLicsXG4gICAgICAgICAgICAnZm9jdXNpbmcuLi4nLFxuICAgICAgICAgICAgJ3N0cmVhbWxpbmluZy4uLicsXG4gICAgICAgICAgICAnY29tcHJlc3NpbmcuLi4nLFxuICAgICAgICAgICAgJ3RyaW1taW5nLi4uJyxcbiAgICAgICAgICAgICdjbGFyaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdzaW1wbGlmeWluZy4uLicsXG4gICAgICAgICAgICAnY29uY2VudHJhdGluZy4uLidcbiAgICAgICAgXVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoaW5raW5nIG5vdGljZSB3aXRoIGNvbnRleHQtYXdhcmUgcGhyYXNlIGFuZCBhbmltYXRlZCBkb3RzXG4gICAgICovXG4gICAgc2hvd1RoaW5raW5nTm90aWNlKGFjdGlvblR5cGU6IEFjdGlvblR5cGUpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNlbGVjdCByYW5kb20gcGhyYXNlIGJhc2VkIG9uIGFjdGlvbiB0eXBlXG4gICAgICAgICAgICBjb25zdCBwaHJhc2VzID0gU3RyZWFtaW5nTWFuYWdlci5USElOS0lOR19QSFJBU0VTW2FjdGlvblR5cGVdIHx8IFN0cmVhbWluZ01hbmFnZXIuVEhJTktJTkdfUEhSQVNFU1snY2hhdCddO1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tUGhyYXNlID0gcGhyYXNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwaHJhc2VzLmxlbmd0aCldO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGVyc2lzdGVudCBub3RpY2UgKDAgdGltZW91dCA9IG1hbnVhbCBkaXNtaXNzYWwpXG4gICAgICAgICAgICB0aGlzLnRoaW5raW5nTm90aWNlID0gbmV3IE5vdGljZShgTm92YTogJHtyYW5kb21QaHJhc2V9LmAsIDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaG93IGluaXRpYWwgc3RhdGUgd2l0aCAxIGRvdCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgY29uc3QgaW5pdGlhbE5vdGljZVRleHQgPSBgTm92YTogJHtyYW5kb21QaHJhc2V9LmA7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VFbCA9ICh0aGlzLnRoaW5raW5nTm90aWNlIGFzIGFueSkubm90aWNlRWw7XG4gICAgICAgICAgICBpZiAobm90aWNlRWwpIHtcbiAgICAgICAgICAgICAgICBub3RpY2VFbC50ZXh0Q29udGVudCA9IGluaXRpYWxOb3RpY2VUZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdGFydCBkb3RzIGFuaW1hdGlvbiBpbiBub3RpY2VcbiAgICAgICAgICAgIHRoaXMuc3RhcnROb3RpY2VEb3RzQW5pbWF0aW9uKHJhbmRvbVBocmFzZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNyZWF0ZSB0aGlua2luZyBub3RpY2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgc3RyZWFtaW5nIGF0IGEgc3BlY2lmaWMgcG9zaXRpb24gd2l0aCBoeWJyaWQgYXBwcm9hY2hcbiAgICAgKiBGb3Igc2VsZWN0aW9uIHJlcGxhY2VtZW50OiBzdGFydFBvcyBhbmQgZW5kUG9zIGRlZmluZSB0aGUgcmFuZ2UgdG8gcmVwbGFjZVxuICAgICAqIEZvciBjdXJzb3IgaW5zZXJ0aW9uOiBzdGFydFBvcyBpcyB0aGUgY3Vyc29yIHBvc2l0aW9uLCBlbmRQb3Mgc2hvdWxkIGJlIG51bGxcbiAgICAgKi9cbiAgICBzdGFydFN0cmVhbWluZyhcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBzdGFydFBvczogYW55LCBcbiAgICAgICAgZW5kUG9zPzogYW55LCBcbiAgICAgICAgb3B0aW9uczogU3RyZWFtaW5nT3B0aW9ucyA9IHt9XG4gICAgKToge1xuICAgICAgICB1cGRhdGVTdHJlYW06IChuZXdUZXh0OiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHZvaWQ7XG4gICAgICAgIHN0b3BTdHJlYW06ICgpID0+IHZvaWQ7XG4gICAgfSB7XG4gICAgICAgIC8vIFN0b3JlIG9yaWdpbmFsIHBvc2l0aW9uKHMpXG4gICAgICAgIHRoaXMub3JpZ2luYWxQb3NpdGlvbiA9IHsgZnJvbTogc3RhcnRQb3MsIHRvOiBlbmRQb3MgfTtcbiAgICAgICAgXG4gICAgICAgIGlmIChlbmRQb3MpIHtcbiAgICAgICAgICAgIC8vIFNlbGVjdGlvbiByZXBsYWNlbWVudCBtb2RlIC0gY2xlYXIgdGhlIHNlbGVjdGlvblxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBzdGFydFBvcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEN1cnNvciBpbnNlcnRpb24gbW9kZSAtIHNldCBwb3NpdGlvbiBmb3Igc3RyZWFtaW5nXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBzdGFydFBvcztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IG51bGw7IC8vIFdpbGwgYmUgc2V0IG9uIGZpcnN0IGNodW5rXG5cbiAgICAgICAgY29uc3QgdXBkYXRlU3RyZWFtID0gKG5ld1RleHQ6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdHJlYW1pbmdUZXh0KGVkaXRvciwgbmV3VGV4dCwgaXNDb21wbGV0ZSwgb3B0aW9ucyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgc3RvcFN0cmVhbSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHN0cmVhbWluZyB0ZXh0IHdpdGggcHJvcGVyIHBvc2l0aW9uIHRyYWNraW5nXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVTdHJlYW1pbmdUZXh0KFxuICAgICAgICBlZGl0b3I6IEVkaXRvciwgXG4gICAgICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgICAgIGlzQ29tcGxldGU6IGJvb2xlYW4sXG4gICAgICAgIG9wdGlvbnM6IFN0cmVhbWluZ09wdGlvbnNcbiAgICApOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpIHtcbiAgICAgICAgICAgICAgICAvLyBTdG9wIHRoZSBub3RpY2UgYW5pbWF0aW9uIHNpbmNlIHN0cmVhbWluZyBpcyBzdGFydGluZyAob25seSBvbiBmaXJzdCBjaHVuaylcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aGlua2luZ05vdGljZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSBzdGFydCBwb3NpdGlvbiB5ZXQsIHNldCBpdFxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdHJlYW1pbmdTdGFydFBvcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0geyAuLi50aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBlbmQgcG9zaXRpb24gYmFzZWQgb24gdGhlIGNvbXBsZXRlIG5ldyB0ZXh0XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBuZXdUZXh0LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdFbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MubGluZSArIGxpbmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBsaW5lcy5sZW5ndGggPiAxID8gbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoIDogdGhpcy5zdHJlYW1pbmdTdGFydFBvcy5jaCArIG5ld1RleHQubGVuZ3RoXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYWxsIGNvbnRlbnQgZnJvbSBzdGFydCB0byBjdXJyZW50IGVuZCB3aXRoIG5ldyB0ZXh0XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdUZXh0LCB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zLCB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG5ld0VuZFBvcztcblxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgY2h1bmsgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5vbkNodW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMub25DaHVuayhuZXdUZXh0LCBpc0NvbXBsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNldCBjdXJzb3IgYXQgdGhlIGVuZCBvZiB0aGUgbmV3IHRleHQgb25seSB3aGVuIGNvbXBsZXRlXG4gICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IodGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIGNvbXBsZXRpb24gY2FsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMub25Db21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgdXBkYXRpbmcgc3RyZWFtaW5nIHRleHQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgZXJyb3IgY2FsbGJhY2tcbiAgICAgICAgICAgIGlmIChvcHRpb25zLm9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm9uRXJyb3IoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFuaW1hdGUgZG90cyBpbiBub3RpY2UgdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROb3RpY2VEb3RzQW5pbWF0aW9uKGJhc2VQaHJhc2U6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgZG90Q291bnQgPSAxO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5kb3RzQW5pbWF0aW9uSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aGlua2luZ05vdGljZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGRvdENvdW50Kys7XG4gICAgICAgICAgICAgICAgaWYgKGRvdENvdW50ID4gNSkge1xuICAgICAgICAgICAgICAgICAgICBkb3RDb3VudCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGRvdHMgPSAnLicucmVwZWF0KGRvdENvdW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBub3RpY2VUZXh0ID0gYE5vdmE6ICR7YmFzZVBocmFzZX0ke2RvdHN9YDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgbm90aWNlIHRleHQgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICBjb25zdCBub3RpY2VFbCA9ICh0aGlzLnRoaW5raW5nTm90aWNlIGFzIGFueSkubm90aWNlRWw7XG4gICAgICAgICAgICAgICAgaWYgKG5vdGljZUVsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGljZUVsLnRleHRDb250ZW50ID0gbm90aWNlVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgaW4gbm90aWNlIGRvdHMgYW5pbWF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDQwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcCB0aGUgZG90cyBhbmltYXRpb24gYW5kIGRpc21pc3Mgbm90aWNlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdG9wRG90c0FuaW1hdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsKTtcbiAgICAgICAgICAgIHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGlzbWlzcyB0aGlua2luZyBub3RpY2VcbiAgICAgICAgaWYgKHRoaXMudGhpbmtpbmdOb3RpY2UpIHtcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy50aGlua2luZ05vdGljZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIGFsbCBhbmltYXRpb25zIGFuZCBjbGVhbiB1cFxuICAgICAqL1xuICAgIHN0b3BBbmltYXRpb24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RvcERvdHNBbmltYXRpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBhbGwgaW50ZXJuYWwgc3RhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGNsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgPSBudWxsO1xuICAgICAgICB0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgb3JpZ2luYWwgcG9zaXRpb24gYmVmb3JlIHN0cmVhbWluZyBzdGFydGVkXG4gICAgICovXG4gICAgZ2V0T3JpZ2luYWxQb3NpdGlvbigpOiB7IGZyb206IGFueTsgdG8/OiBhbnkgfSB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy5vcmlnaW5hbFBvc2l0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGN1cnJlbnRseSBzdHJlYW1pbmdcbiAgICAgKi9cbiAgICBpc1N0cmVhbWluZygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyAhPT0gbnVsbDtcbiAgICB9XG59IiwgIi8qKlxuICogU2VsZWN0aW9uLWJhc2VkIGNvbnRleHQgbWVudSBmb3IgTm92YVxuICogQWRkcyBOb3ZhIHN1Ym1lbnUgdG8gT2JzaWRpYW4ncyByaWdodC1jbGljayBjb250ZXh0IG1lbnUgd2hlbiB0ZXh0IGlzIHNlbGVjdGVkXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1lbnUsIE1lbnVJdGVtLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IFNlbGVjdGlvbkVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS9jb21tYW5kcy9zZWxlY3Rpb24tZWRpdC1jb21tYW5kJztcbmltcG9ydCB7IFRvbmVTZWxlY3Rpb25Nb2RhbCB9IGZyb20gJy4vdG9uZS1zZWxlY3Rpb24tbW9kYWwnO1xuaW1wb3J0IHsgQ3VzdG9tSW5zdHJ1Y3Rpb25Nb2RhbCB9IGZyb20gJy4vY3VzdG9tLWluc3RydWN0aW9uLW1vZGFsJztcblxuZXhwb3J0IGludGVyZmFjZSBTZWxlY3Rpb25BY3Rpb24ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbGFiZWw6IHN0cmluZztcbiAgICBpY29uPzogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgU0VMRUNUSU9OX0FDVElPTlM6IFNlbGVjdGlvbkFjdGlvbltdID0gW1xuICAgIHtcbiAgICAgICAgaWQ6ICdpbXByb3ZlJyxcbiAgICAgICAgbGFiZWw6ICdJbXByb3ZlIFdyaXRpbmcnLFxuICAgICAgICBpY29uOiAnc3BhcmtsZXMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ01ha2UgdGV4dCBjbGVhcmVyLCBtb3JlIGNvbmNpc2UsIGJldHRlciBmbG93J1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2xvbmdlcicsXG4gICAgICAgIGxhYmVsOiAnTWFrZSBMb25nZXInLFxuICAgICAgICBpY29uOiAncGx1cy1jaXJjbGUnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0V4cGFuZCBpZGVhcyB3aXRoIG1vcmUgZGV0YWlsIGFuZCBleGFtcGxlcydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdzaG9ydGVyJyxcbiAgICAgICAgbGFiZWw6ICdNYWtlIFNob3J0ZXInLFxuICAgICAgICBpY29uOiAnbWludXMtY2lyY2xlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb25kZW5zZSB0byBlc3NlbnRpYWwgcG9pbnRzJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ3RvbmUnLFxuICAgICAgICBsYWJlbDogJ0NoYW5nZSBUb25lJyxcbiAgICAgICAgaWNvbjogJ3BhbGV0dGUnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FkanVzdCB3cml0aW5nIHN0eWxlIGFuZCB0b25lJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2N1c3RvbScsXG4gICAgICAgIGxhYmVsOiAnVGVsbCBOb3ZhLi4uJyxcbiAgICAgICAgaWNvbjogJ21lc3NhZ2UtY2lyY2xlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDdXN0b20gaW5zdHJ1Y3Rpb24gZm9yIHRyYW5zZm9ybWF0aW9uJ1xuICAgIH1cbl07XG5cbmV4cG9ydCBjbGFzcyBTZWxlY3Rpb25Db250ZXh0TWVudSB7XG4gICAgcHJpdmF0ZSBzZWxlY3Rpb25FZGl0Q29tbWFuZDogU2VsZWN0aW9uRWRpdENvbW1hbmQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW5cbiAgICApIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25FZGl0Q29tbWFuZCA9IG5ldyBTZWxlY3Rpb25FZGl0Q29tbWFuZChwbHVnaW4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIHRoZSBjb250ZXh0IG1lbnUgd2l0aCBPYnNpZGlhbidzIGVkaXRvclxuICAgICAqL1xuICAgIHJlZ2lzdGVyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51OiBNZW51LCBlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkTm92YVN1Ym1lbnUobWVudSwgZWRpdG9yKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIE5vdmEgc3VibWVudSB0byB0aGUgY29udGV4dCBtZW51IGlmIHRleHQgaXMgc2VsZWN0ZWRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZE5vdmFTdWJtZW51KG1lbnU6IE1lbnUsIGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE9ubHkgc2hvdyBOb3ZhIHN1Ym1lbnUgd2hlbiB0ZXh0IGlzIHNlbGVjdGVkXG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0IHx8IHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgc2VwYXJhdG9yIGJlZm9yZSBOb3ZhIHN1Ym1lbnUgZm9yIHZpc3VhbCBjbGFyaXR5XG4gICAgICAgIG1lbnUuYWRkU2VwYXJhdG9yKCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIE5vdmEgYWN0aW9uIGl0ZW1zIGRpcmVjdGx5IChubyBzdGFuZGFsb25lIE5vdmEgaXRlbSlcbiAgICAgICAgU0VMRUNUSU9OX0FDVElPTlMuZm9yRWFjaChhY3Rpb24gPT4ge1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtOiBNZW51SXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKGBOb3ZhOiAke2FjdGlvbi5sYWJlbH1gKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihhY3Rpb24uaWNvbiB8fCAnZWRpdCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKGFjdGlvbi5pZCwgZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBzZWxlY3Rpb24gYWN0aW9uIHdoZW4gbWVudSBpdGVtIGlzIGNsaWNrZWRcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaGFuZGxlU2VsZWN0aW9uQWN0aW9uKGFjdGlvbklkOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSB0b25lIHNlbGVjdGlvbiB3aXRoIG1vZGFsICh3aGVuIG5vIHNwZWNpZmljIHRvbmUgcHJvdmlkZWQpXG4gICAgICAgICAgICBpZiAoYWN0aW9uSWQgPT09ICd0b25lJyAmJiAhY3VzdG9tSW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dUb25lU2VsZWN0aW9uTW9kYWwoZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGFjdGlvbklkID09PSAnY3VzdG9tJyAmJiAhY3VzdG9tSW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dDdXN0b21JbnN0cnVjdGlvbk1vZGFsKGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIHNlbGVjdGlvbiBlZGl0IGNvbW1hbmQgZm9yIG90aGVyIGFjdGlvbnMgb3IgZGlyZWN0IHRvbmUvY3VzdG9tIGNhbGxzXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVTZWxlY3Rpb25FZGl0KGFjdGlvbklkLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCwgY3VzdG9tSW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIE5vdmEgc2VsZWN0aW9uIGFjdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdG9uZSBzZWxlY3Rpb24gbW9kYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dUb25lU2VsZWN0aW9uTW9kYWwoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFRvbmVTZWxlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgYXN5bmMgKHNlbGVjdGVkVG9uZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0b25lIGNoYW5nZSB3aXRoIHRoZSBzZWxlY3RlZCB0b25lXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlU2VsZWN0aW9uRWRpdCgndG9uZScsIGVkaXRvciwgc2VsZWN0ZWRUZXh0LCBzZWxlY3RlZFRvbmUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIGNhbmNlbGxlZCwgZG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBjdXN0b20gaW5zdHJ1Y3Rpb24gbW9kYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dDdXN0b21JbnN0cnVjdGlvbk1vZGFsKGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBDdXN0b21JbnN0cnVjdGlvbk1vZGFsKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICBhc3luYyAoaW5zdHJ1Y3Rpb246IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgY3VzdG9tIHRyYW5zZm9ybWF0aW9uIHdpdGggdGhlIGluc3RydWN0aW9uXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlU2VsZWN0aW9uRWRpdCgnY3VzdG9tJywgZWRpdG9yLCBzZWxlY3RlZFRleHQsIGluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBjYW5jZWxsZWQsIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgbW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgdGhlIHNlbGVjdGlvbiBlZGl0IGNvbW1hbmQgd2l0aCBzdHJlYW1pbmdcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVTZWxlY3Rpb25FZGl0KFxuICAgICAgICBhY3Rpb25JZDogc3RyaW5nLCBcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBzZWxlY3RlZFRleHQ6IHN0cmluZywgXG4gICAgICAgIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIFN0YXJ0IHNlbGVjdGlvbiBhbmltYXRpb25cbiAgICAgICAgdGhpcy5zdGFydFNlbGVjdGlvbkFuaW1hdGlvbihlZGl0b3IpO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgc2VsZWN0aW9uIHJhbmdlXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUmFuZ2UgPSB7XG4gICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICB0bzogZWRpdG9yLmdldEN1cnNvcigndG8nKVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNob3cgTm92YSB0aGlua2luZyBhbmltYXRpb24gd2hpbGUgd2FpdGluZyBmb3Igc3RyZWFtXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNob3dUaGlua2luZ0FuaW1hdGlvbihlZGl0b3IsIG9yaWdpbmFsUmFuZ2UuZnJvbSwgb3JpZ2luYWxSYW5nZS50bywgYWN0aW9uSWQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIHRvIHByb2dyZXNzaXZlbHkgcmVwbGFjZSB0ZXh0XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnNlbGVjdGlvbkVkaXRDb21tYW5kLmV4ZWN1dGVTdHJlYW1pbmcoXG4gICAgICAgICAgICAgICAgYWN0aW9uSWQsIFxuICAgICAgICAgICAgICAgIGVkaXRvciwgXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0LFxuICAgICAgICAgICAgICAgIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFByb2dyZXNzaXZlIHRleHQgcmVwbGFjZW1lbnQgd2l0aCB0eXBld3JpdGVyIGVmZmVjdFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0cmVhbWluZ1RleHQoZWRpdG9yLCBjaHVuaywgb3JpZ2luYWxSYW5nZS5mcm9tLCBpc0NvbXBsZXRlKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGN1c3RvbUluc3RydWN0aW9uXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3Rpb25OYW1lID0gdGhpcy5nZXRBY3Rpb25EaXNwbGF5TmFtZShhY3Rpb25JZCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm92YTogVGV4dCAke2FjdGlvbk5hbWV9IHN1Y2Nlc3NmdWxseWAsIDIwMDApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFkZCBzdWNjZXNzIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgICAgIHRoaXMuYWRkU3VjY2Vzc0NoYXRNZXNzYWdlKGFjdGlvbklkLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm92YTogJHtyZXN1bHQuZXJyb3IgfHwgJ0ZhaWxlZCB0byBwcm9jZXNzIHRleHQnfWAsIDMwMDApO1xuICAgICAgICAgICAgICAgIC8vIEFkZCBmYWlsdXJlIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgICAgIHRoaXMuYWRkRmFpbHVyZUNoYXRNZXNzYWdlKGFjdGlvbklkLCByZXN1bHQuZXJyb3IgfHwgJ0ZhaWxlZCB0byBwcm9jZXNzIHRleHQnKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIHRleHQgd2hlbiBzdHJlYW1pbmcgZmFpbHNcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3RvcmVPcmlnaW5hbFRleHQoZWRpdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBzZWxlY3Rpb24gZWRpdDonLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCB0ZXh0IG9uIGNvbXBsZXRlIGZhaWx1cmVcbiAgICAgICAgICAgIHRoaXMucmVzdG9yZU9yaWdpbmFsVGV4dChlZGl0b3IpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgLy8gQWx3YXlzIHN0b3AgYW5pbWF0aW9ucyBhbmQgY2xlYW4gdXBcbiAgICAgICAgICAgIHRoaXMuc3RvcFNlbGVjdGlvbkFuaW1hdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRleHQgd2l0aCBzdHJlYW1pbmcgZWZmZWN0XG4gICAgICovXG4gICAgcHJpdmF0ZSBjdXJyZW50U3RyZWFtaW5nRW5kUG9zOiBhbnkgPSBudWxsO1xuICAgIHByaXZhdGUgc3RyZWFtaW5nVGV4dENvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cbiAgICBwcml2YXRlIHN0cmVhbWluZ1N0YXJ0UG9zOiBhbnkgPSBudWxsO1xuXG4gICAgcHJpdmF0ZSB1cGRhdGVTdHJlYW1pbmdUZXh0KFxuICAgICAgICBlZGl0b3I6IEVkaXRvciwgXG4gICAgICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgICAgIHN0YXJ0UG9zOiBhbnksIFxuICAgICAgICBpc0NvbXBsZXRlOiBib29sZWFuXG4gICAgKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zKSB7XG4gICAgICAgICAgICAgICAgLy8gU3RvcCB0aGUgbm90aWNlIGFuaW1hdGlvbiBzaW5jZSBzdHJlYW1pbmcgaXMgc3RhcnRpbmcgKG9ubHkgb24gZmlyc3QgY2h1bmspXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGhpbmtpbmdOb3RpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBPbiBmaXJzdCBjaHVuaywgc2V0IHRoZSBzdGFydCBwb3NpdGlvbiB0byBjdXJyZW50IHN0cmVhbWluZyBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdHJlYW1pbmdTdGFydFBvcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0geyAuLi50aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gT25seSB1cGRhdGUgaWYgd2UgaGF2ZSBhY3R1YWwgY29udGVudFxuICAgICAgICAgICAgICAgIGlmIChuZXdUZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBuZXcgZW5kIHBvc2l0aW9uIGJhc2VkIG9uIHRoZSBjb21wbGV0ZSBuZXcgdGV4dCBmcm9tIHN0YXJ0IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gbmV3VGV4dC5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0VuZFBvcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MubGluZSArIGxpbmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBjaDogbGluZXMubGVuZ3RoID4gMSA/IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLmxlbmd0aCA6IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MuY2ggKyBuZXdUZXh0Lmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgY29udGVudCBmcm9tIHN0YXJ0IHBvc2l0aW9uIHRvIGN1cnJlbnQgZW5kIHBvc2l0aW9uIHdpdGggbmV3IHRleHRcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdUZXh0LCB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zLCB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBlbmQgcG9zaXRpb24gZm9yIG5leHQgY2h1bmtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zID0gbmV3RW5kUG9zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGN1cnNvciBhdCB0aGUgZW5kIG9mIHRoZSBuZXcgdGV4dCBvbmx5IHdoZW4gY29tcGxldGVcbiAgICAgICAgICAgIGlmIChpc0NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcykge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFJlc2V0IGZvciBuZXh0IHVzZVxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgdXBkYXRpbmcgc3RyZWFtaW5nIHRleHQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8gT24gZXJyb3IsIHRyeSB0byByZXN0b3JlIG9yaWdpbmFsIHRleHQgaWYgd2UgaGF2ZSBpdFxuICAgICAgICAgICAgaWYgKHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZSAmJiB0aGlzLm9yaWdpbmFsU2VsZWN0aW9uUmFuZ2UudGV4dCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIHRleHQgYXQgdGhlIHN0YXJ0IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3RvcmVQb3MgPSB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zIHx8IHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3RvcmVQb3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlLnRleHQsIHJlc3RvcmVQb3MsIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyB8fCByZXN0b3JlUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhZnRlciByZXN0b3JlZCB0ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZS50ZXh0LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiByZXN0b3JlUG9zLmxpbmUgKyBsaW5lcy5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoOiBsaW5lcy5sZW5ndGggPiAxID8gbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoIDogcmVzdG9yZVBvcy5jaCArIHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZS50ZXh0Lmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoZW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHJlc3RvcmVFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCByZXN0b3JlIG9yaWdpbmFsIHRleHQ6JywgcmVzdG9yZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsU2VsZWN0aW9uUmFuZ2UgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzdG9yZSBvcmlnaW5hbCB0ZXh0IGlmIHN0cmVhbWluZyBmYWlscyBjb21wbGV0ZWx5XG4gICAgICovXG4gICAgcHJpdmF0ZSByZXN0b3JlT3JpZ2luYWxUZXh0KGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLm9yaWdpbmFsU2VsZWN0aW9uUmFuZ2UgJiYgdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlLnRleHQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgcG9zaXRpb24gdG8gcmVzdG9yZSB0byAtIGVpdGhlciB3aGVyZSBzdHJlYW1pbmcgc3RhcnRlZCBvciBjdXJyZW50IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdG9yZVBvcyA9IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgfHwgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zIHx8IHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZS5mcm9tO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChyZXN0b3JlUG9zKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYW55IGNvbnRlbnQgYXQgY3VycmVudCBwb3NpdGlvbiB3aXRoIG9yaWdpbmFsIHRleHRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEVuZFBvcyA9IHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyB8fCByZXN0b3JlUG9zO1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHRoaXMub3JpZ2luYWxTZWxlY3Rpb25SYW5nZS50ZXh0LCByZXN0b3JlUG9zLCBjdXJyZW50RW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhZnRlciByZXN0b3JlZCB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlLnRleHQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiByZXN0b3JlUG9zLmxpbmUgKyBsaW5lcy5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2g6IGxpbmVzLmxlbmd0aCA+IDEgPyBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5sZW5ndGggOiByZXN0b3JlUG9zLmNoICsgdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlLnRleHQubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoZW5kUG9zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChyZXN0b3JlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCByZXN0b3JlIG9yaWdpbmFsIHRleHQgYWZ0ZXIgZmFpbHVyZTonLCByZXN0b3JlRXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhbiB1cCBzdGF0ZVxuICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBudWxsO1xuICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBwdWxzaW5nIGFuaW1hdGlvbiBvbiBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGFydFNlbGVjdGlvbkFuaW1hdGlvbihlZGl0b3I6IEVkaXRvcik6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgZWRpdG9yIGNvbnRhaW5lciBpbiB0aGUgRE9NXG4gICAgICAgICAgICBjb25zdCBlZGl0b3JDb250YWluZXIgPSAoZWRpdG9yIGFzIGFueSkuY20/LmRvbSB8fCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY20tZWRpdG9yJyk7XG4gICAgICAgICAgICBpZiAoZWRpdG9yQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ25vdmEtc2VsZWN0aW9uLXByb2Nlc3NpbmcnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG9yaWdpbmFsIHNlbGVjdGlvbiBmb3IgbGF0ZXIgY2xlYW51cFxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZWRTZWxlY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKSxcbiAgICAgICAgICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc3RhcnQgc2VsZWN0aW9uIGFuaW1hdGlvbjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIHB1bHNpbmcgYW5pbWF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdG9wU2VsZWN0aW9uQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGFuaW1hdGlvbiBjbGFzcyBmcm9tIGFsbCBwb3NzaWJsZSBlZGl0b3IgZWxlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvckVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLkNvZGVNaXJyb3IsIC5jbS1lZGl0b3InKTtcbiAgICAgICAgICAgIGVkaXRvckVsZW1lbnRzLmZvckVhY2goZWwgPT4ge1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ25vdmEtc2VsZWN0aW9uLXByb2Nlc3NpbmcnKTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZWRTZWxlY3Rpb24gPSBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc3RvcCBzZWxlY3Rpb24gYW5pbWF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYW5pbWF0ZWRTZWxlY3Rpb246IHsgZnJvbTogYW55OyB0bzogYW55IH0gfCBudWxsID0gbnVsbDtcblxuICAgIC8vIER5bmFtaWMgdGhpbmtpbmcgcGhyYXNlcyBmb3IgZWFjaCBhY3Rpb24gdHlwZVxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFRISU5LSU5HX1BIUkFTRVMgPSB7XG4gICAgICAgICdpbXByb3ZlJzogW1xuICAgICAgICAgICAgJ3JlZmluaW5nLi4uJyxcbiAgICAgICAgICAgICdwb2xpc2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2VuaGFuY2luZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3BlcmZlY3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3Ntb290aGluZy4uLicsXG4gICAgICAgICAgICAnc2hhcnBlbmluZy4uLicsXG4gICAgICAgICAgICAnZWxldmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdmaW5lLXR1bmluZy4uLicsXG4gICAgICAgICAgICAnc2N1bHB0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnbG9uZ2VyJzogW1xuICAgICAgICAgICAgJ2V4cGFuZGluZy4uLicsXG4gICAgICAgICAgICAnZGV2ZWxvcGluZy4uLicsXG4gICAgICAgICAgICAnZWxhYm9yYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2J1aWxkaW5nLi4uJyxcbiAgICAgICAgICAgICdlbnJpY2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2RlZXBlbmluZy4uLicsXG4gICAgICAgICAgICAnZ3Jvd2luZy4uLicsXG4gICAgICAgICAgICAnZXh0ZW5kaW5nLi4uJyxcbiAgICAgICAgICAgICdhbXBsaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICd1bmZvbGRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdzaG9ydGVyJzogW1xuICAgICAgICAgICAgJ2NvbmRlbnNpbmcuLi4nLFxuICAgICAgICAgICAgJ2Rpc3RpbGxpbmcuLi4nLFxuICAgICAgICAgICAgJ3RpZ2h0ZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2ZvY3VzaW5nLi4uJyxcbiAgICAgICAgICAgICdzdHJlYW1saW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbXByZXNzaW5nLi4uJyxcbiAgICAgICAgICAgICd0cmltbWluZy4uLicsXG4gICAgICAgICAgICAnY2xhcmlmeWluZy4uLicsXG4gICAgICAgICAgICAnc2ltcGxpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbmNlbnRyYXRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICd0b25lJzogW1xuICAgICAgICAgICAgJ2FkanVzdGluZyB0b25lLi4uJyxcbiAgICAgICAgICAgICdyZXNoYXBpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlZnJhbWluZy4uLicsXG4gICAgICAgICAgICAnYWRhcHRpbmcuLi4nLFxuICAgICAgICAgICAgJ3RyYW5zZm9ybWluZy4uLicsXG4gICAgICAgICAgICAnbW9kdWxhdGluZy4uLicsXG4gICAgICAgICAgICAncmVjYXN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzaGlmdGluZy4uLicsXG4gICAgICAgICAgICAncmVmb3JtaW5nLi4uJyxcbiAgICAgICAgICAgICdyZWltYWdpbmluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2N1c3RvbSc6IFtcbiAgICAgICAgICAgICd3b3JraW5nIG9uIGl0Li4uJyxcbiAgICAgICAgICAgICdjb25zaWRlcmluZy4uLicsXG4gICAgICAgICAgICAndGhpbmtpbmcuLi4nLFxuICAgICAgICAgICAgJ3Byb2Nlc3NpbmcuLi4nLFxuICAgICAgICAgICAgJ2FuYWx5emluZy4uLicsXG4gICAgICAgICAgICAnY29udGVtcGxhdGluZy4uLicsXG4gICAgICAgICAgICAndW5kZXJzdGFuZGluZy4uLicsXG4gICAgICAgICAgICAnaW50ZXJwcmV0aW5nLi4uJyxcbiAgICAgICAgICAgICdleHBsb3JpbmcuLi4nLFxuICAgICAgICAgICAgJ2V2YWx1YXRpbmcuLi4nXG4gICAgICAgIF1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU2hvdyBOb3ZhIHRoaW5raW5nIGFuaW1hdGlvbiB3aXRoIG5vdGljZSArIGRvY3VtZW50IHBsYWNlaG9sZGVyXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzaG93VGhpbmtpbmdBbmltYXRpb24oZWRpdG9yOiBFZGl0b3IsIHN0YXJ0UG9zOiBhbnksIGVuZFBvczogYW55LCBhY3Rpb25JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBTZWxlY3QgcmFuZG9tIHBocmFzZSBiYXNlZCBvbiBhY3Rpb24gdHlwZVxuICAgICAgICAgICAgY29uc3QgcGhyYXNlcyA9IFNlbGVjdGlvbkNvbnRleHRNZW51LlRISU5LSU5HX1BIUkFTRVNbYWN0aW9uSWQgYXMga2V5b2YgdHlwZW9mIFNlbGVjdGlvbkNvbnRleHRNZW51LlRISU5LSU5HX1BIUkFTRVNdIHx8IFNlbGVjdGlvbkNvbnRleHRNZW51LlRISU5LSU5HX1BIUkFTRVNbJ2N1c3RvbSddO1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tUGhyYXNlID0gcGhyYXNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwaHJhc2VzLmxlbmd0aCldO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaG93IHRoaW5raW5nIG5vdGljZSBmb3IgdXNlciBmZWVkYmFja1xuICAgICAgICAgICAgdGhpcy5zaG93VGhpbmtpbmdOb3RpY2UocmFuZG9tUGhyYXNlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgdGV4dCBiZWZvcmUgY2xlYXJpbmcgaXQgKGZvciBlcnJvciByZWNvdmVyeSlcbiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsVGV4dCA9IGVkaXRvci5nZXRSYW5nZShzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIHNlbGVjdGlvbiBpbiBkb2N1bWVudCB0byBjcmVhdGUgY2xlYW4gc3RyZWFtaW5nIHBvc2l0aW9uXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IHN0cmVhbWluZyBwb3NpdGlvbiB0byB3aGVyZSBzZWxlY3Rpb24gd2FzIGNsZWFyZWRcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IHN0YXJ0UG9zO1xuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFNlbGVjdGlvblJhbmdlID0geyBcbiAgICAgICAgICAgICAgICBmcm9tOiBzdGFydFBvcywgXG4gICAgICAgICAgICAgICAgdG86IGVuZFBvcywgXG4gICAgICAgICAgICAgICAgdGV4dDogb3JpZ2luYWxUZXh0ICAvLyBTdG9yZSBvcmlnaW5hbCB0ZXh0IGZvciByZXN0b3JhdGlvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc2hvdyB0aGlua2luZyBhbmltYXRpb246JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkb3RzQW5pbWF0aW9uSW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSB0aGlua2luZ05vdGljZTogTm90aWNlIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBvcmlnaW5hbFNlbGVjdGlvblJhbmdlOiB7IGZyb206IGFueTsgdG86IGFueTsgdGV4dD86IHN0cmluZyB9IHwgbnVsbCA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoaW5raW5nIG5vdGljZSB3aXRoIGFuaW1hdGVkIGRvdHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dUaGlua2luZ05vdGljZShiYXNlUGhyYXNlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBwZXJzaXN0ZW50IG5vdGljZSAoMCB0aW1lb3V0ID0gbWFudWFsIGRpc21pc3NhbClcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UgPSBuZXcgTm90aWNlKGBOb3ZhOiAke2Jhc2VQaHJhc2V9LmAsIDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaG93IGluaXRpYWwgc3RhdGUgd2l0aCAxIGRvdCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgY29uc3QgaW5pdGlhbE5vdGljZVRleHQgPSBgTm92YTogJHtiYXNlUGhyYXNlfS5gO1xuICAgICAgICAgICAgY29uc3Qgbm90aWNlRWwgPSAodGhpcy50aGlua2luZ05vdGljZSBhcyBhbnkpLm5vdGljZUVsO1xuICAgICAgICAgICAgaWYgKG5vdGljZUVsKSB7XG4gICAgICAgICAgICAgICAgbm90aWNlRWwudGV4dENvbnRlbnQgPSBpbml0aWFsTm90aWNlVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RhcnQgZG90cyBhbmltYXRpb24gaW4gbm90aWNlXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Tm90aWNlRG90c0FuaW1hdGlvbihiYXNlUGhyYXNlKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY3JlYXRlIHRoaW5raW5nIG5vdGljZTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbmltYXRlIGRvdHMgaW4gbm90aWNlIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0Tm90aWNlRG90c0FuaW1hdGlvbihiYXNlUGhyYXNlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgbGV0IGRvdENvdW50ID0gMTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudGhpbmtpbmdOb3RpY2UpIHJldHVybjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBkb3RDb3VudCsrO1xuICAgICAgICAgICAgICAgIGlmIChkb3RDb3VudCA+IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgZG90Q291bnQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBkb3RzID0gJy4nLnJlcGVhdChkb3RDb3VudCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm90aWNlVGV4dCA9IGBOb3ZhOiAke2Jhc2VQaHJhc2V9JHtkb3RzfWA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIG5vdGljZSB0ZXh0IGRpcmVjdGx5XG4gICAgICAgICAgICAgICAgY29uc3Qgbm90aWNlRWwgPSAodGhpcy50aGlua2luZ05vdGljZSBhcyBhbnkpLm5vdGljZUVsO1xuICAgICAgICAgICAgICAgIGlmIChub3RpY2VFbCkge1xuICAgICAgICAgICAgICAgICAgICBub3RpY2VFbC50ZXh0Q29udGVudCA9IG5vdGljZVRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Vycm9yIGluIG5vdGljZSBkb3RzIGFuaW1hdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCA0MDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3AgdGhlIGRvdHMgYW5pbWF0aW9uIGFuZCBkaXNtaXNzIG5vdGljZVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RvcERvdHNBbmltYXRpb24oKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERpc21pc3MgdGhpbmtpbmcgbm90aWNlXG4gICAgICAgIGlmICh0aGlzLnRoaW5raW5nTm90aWNlKSB7XG4gICAgICAgICAgICB0aGlzLnRoaW5raW5nTm90aWNlLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBhY3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkRpc3BsYXlOYW1lKGFjdGlvbklkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbklkKSB7XG4gICAgICAgICAgICBjYXNlICdpbXByb3ZlJzogcmV0dXJuICdpbXByb3ZlZCc7XG4gICAgICAgICAgICBjYXNlICdsb25nZXInOiByZXR1cm4gJ2V4cGFuZGVkJztcbiAgICAgICAgICAgIGNhc2UgJ3Nob3J0ZXInOiByZXR1cm4gJ2NvbmRlbnNlZCc7XG4gICAgICAgICAgICBjYXNlICd0b25lJzogcmV0dXJuICd0b25lIGFkanVzdGVkJztcbiAgICAgICAgICAgIGNhc2UgJ2N1c3RvbSc6IHJldHVybiAndHJhbnNmb3JtZWQnO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuICdwcm9jZXNzZWQnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN1Y2Nlc3MgbWVzc2FnZSB0byBjaGF0IHVzaW5nIHVuaWZpZWQgc3lzdGVtXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRTdWNjZXNzQ2hhdE1lc3NhZ2UoYWN0aW9uSWQ6IHN0cmluZywgb3JpZ2luYWxUZXh0OiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBhY3RpdmUgTm92YSBzaWRlYmFyIHZpZXcgYW5kIGFkZCBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ25vdmEtc2lkZWJhcicpO1xuICAgICAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBhbnk7XG4gICAgICAgICAgICAgICAgaWYgKHNpZGViYXJWaWV3Py5jaGF0UmVuZGVyZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uRGVzY3JpcHRpb24gPSB0aGlzLmdldEFjdGlvbkRlc2NyaXB0aW9uKGFjdGlvbklkLCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZFRleHQgPSBvcmlnaW5hbFRleHQubGVuZ3RoID4gNTAgXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG9yaWdpbmFsVGV4dC5zdWJzdHJpbmcoMCwgNTApICsgJy4uLicgXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG9yaWdpbmFsVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgXHUyNzEzICR7YWN0aW9uRGVzY3JpcHRpb259IHRleHQ6IFwiJHt0cnVuY2F0ZWRUZXh0fVwiYDtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB1bmlmaWVkIHN5c3RlbSB3aXRoIHBlcnNpc3RlbmNlXG4gICAgICAgICAgICAgICAgICAgIHNpZGViYXJWaWV3LmNoYXRSZW5kZXJlci5hZGRTdWNjZXNzTWVzc2FnZShtZXNzYWdlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBhZGQgc3VjY2VzcyBjaGF0IG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGZhaWx1cmUgbWVzc2FnZSB0byBjaGF0IHVzaW5nIHVuaWZpZWQgc3lzdGVtXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRGYWlsdXJlQ2hhdE1lc3NhZ2UoYWN0aW9uSWQ6IHN0cmluZywgZXJyb3JNZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGFjdGl2ZSBOb3ZhIHNpZGViYXIgdmlldyBhbmQgYWRkIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbm92YS1zaWRlYmFyJyk7XG4gICAgICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIGFueTtcbiAgICAgICAgICAgICAgICBpZiAoc2lkZWJhclZpZXc/LmNoYXRSZW5kZXJlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpb25OYW1lID0gdGhpcy5nZXRBY3Rpb25EaXNwbGF5TmFtZShhY3Rpb25JZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgXHUyNzE3IEZhaWxlZCB0byAke2FjdGlvbk5hbWUucmVwbGFjZSgnZWQnLCAnJyl9IHRleHQ6ICR7ZXJyb3JNZXNzYWdlfWA7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdW5pZmllZCBzeXN0ZW0gd2l0aCBwZXJzaXN0ZW5jZVxuICAgICAgICAgICAgICAgICAgICBzaWRlYmFyVmlldy5jaGF0UmVuZGVyZXIuYWRkRXJyb3JNZXNzYWdlKG1lc3NhZ2UsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGFkZCBlcnJvciBjaGF0IG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRldGFpbGVkIGFjdGlvbiBkZXNjcmlwdGlvbiBmb3IgY2hhdFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0QWN0aW9uRGVzY3JpcHRpb24oYWN0aW9uSWQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbklkKSB7XG4gICAgICAgICAgICBjYXNlICdpbXByb3ZlJzogcmV0dXJuICdJbXByb3ZlZCc7XG4gICAgICAgICAgICBjYXNlICdsb25nZXInOiByZXR1cm4gJ0V4cGFuZGVkJztcbiAgICAgICAgICAgIGNhc2UgJ3Nob3J0ZXInOiByZXR1cm4gJ0NvbmRlbnNlZCc7XG4gICAgICAgICAgICBjYXNlICd0b25lJzogcmV0dXJuIGBDaGFuZ2VkIHRvbmUgdG8gJHtjdXN0b21JbnN0cnVjdGlvbiB8fCAnZm9ybWFsJ31gO1xuICAgICAgICAgICAgY2FzZSAnY3VzdG9tJzogcmV0dXJuIGBBcHBsaWVkIFwiJHtjdXN0b21JbnN0cnVjdGlvbn1cImA7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gJ1Byb2Nlc3NlZCc7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogU2VsZWN0aW9uLWJhc2VkIGVkaXRpbmcgY29tbWFuZCBoYW5kbGVyIGZvciBOb3ZhXG4gKiBQcm9jZXNzZXMgQUkgdHJhbnNmb3JtYXRpb25zIG9uIHNlbGVjdGVkIHRleHRcbiAqL1xuXG5pbXBvcnQgeyBFZGl0b3IsIEVkaXRvclBvc2l0aW9uLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi8uLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXIgfSBmcm9tICcuLi8uLi9haS90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0aW9uRWRpdFJlc3VsdCB7XG4gICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICB0cmFuc2Zvcm1lZFRleHQ/OiBzdHJpbmc7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgb3JpZ2luYWxSYW5nZT86IHtcbiAgICAgICAgZnJvbTogRWRpdG9yUG9zaXRpb247XG4gICAgICAgIHRvOiBFZGl0b3JQb3NpdGlvbjtcbiAgICB9O1xufVxuXG5leHBvcnQgY2xhc3MgU2VsZWN0aW9uRWRpdENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIHNlbGVjdGlvbi1iYXNlZCBlZGl0IGFjdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoYWN0aW9uOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBQcm9taXNlPFNlbGVjdGlvbkVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBzZWxlY3Rpb24gcmFuZ2UgZm9yIGxhdGVyIHJlcGxhY2VtZW50XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25SYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFNob3cgbG9hZGluZyBpbmRpY2F0b3JcbiAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdOb3RpY2UgPSBuZXcgTm90aWNlKCdOb3ZhIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0Li4uJywgMCk7XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHByb21wdCBiYXNlZCBvbiBhY3Rpb25cbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQoYWN0aW9uLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKFxuICAgICAgICAgICAgICAgIHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGxvYWRpbmdOb3RpY2UuaGlkZSgpO1xuXG4gICAgICAgICAgICAvLyBDbGVhbiB1cCBBSSByZXNwb25zZSAocmVtb3ZlIGFueSBleHBsYW5hdGlvbiB0ZXh0KVxuICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtZWRUZXh0ID0gdGhpcy5jbGVhbkFJUmVzcG9uc2UocmVzcG9uc2UpO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRUZXh0LFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2U6IHNlbGVjdGlvblJhbmdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTZWxlY3Rpb24gZWRpdCBjb21tYW5kIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIHNlbGVjdGlvbi1iYXNlZCBlZGl0IGFjdGlvbiB3aXRoIHN0cmVhbWluZ1xuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGVTdHJlYW1pbmcoXG4gICAgICAgIGFjdGlvbjogc3RyaW5nLCBcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBzZWxlY3RlZFRleHQ6IHN0cmluZywgXG4gICAgICAgIG9uQ2h1bms6IChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB2b2lkLFxuICAgICAgICBjdXN0b21JbnN0cnVjdGlvbj86IHN0cmluZ1xuICAgICk6IFByb21pc2U8U2VsZWN0aW9uRWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IHNlbGVjdGlvbiByYW5nZSBmb3IgbGF0ZXIgcmVwbGFjZW1lbnRcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvblJhbmdlID0ge1xuICAgICAgICAgICAgICAgIGZyb206IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKSxcbiAgICAgICAgICAgICAgICB0bzogZWRpdG9yLmdldEN1cnNvcigndG8nKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgcHJvbXB0IGJhc2VkIG9uIGFjdGlvblxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5idWlsZFByb21wdChhY3Rpb24sIHNlbGVjdGVkVGV4dCwgY3VzdG9tSW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgMS1zZWNvbmQgbWluaW11bSBkZWxheSB0byBndWFyYW50ZWUgdGhpbmtpbmcgYW5pbWF0aW9uIHZpc2liaWxpdHlcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCBmdWxsUmVzcG9uc2UgPSAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RyZWFtIEFJIHJlc3BvbnNlXG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0LnVzZXJQcm9tcHQsIHtcbiAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGlmIChjaHVuay5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoY2h1bmsuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmdWxsUmVzcG9uc2UgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGNhbGwgb25DaHVuayBpZiB3ZSBoYXZlIGNvbnRlbnQgb3IgaWYgaXQncyB0aGUgZmluYWwgY2h1bmtcbiAgICAgICAgICAgICAgICBpZiAoZnVsbFJlc3BvbnNlLnRyaW0oKS5sZW5ndGggPiAwIHx8IGNodW5rLmRvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5lZENodW5rID0gdGhpcy5jbGVhbkFJUmVzcG9uc2UoZnVsbFJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgb25DaHVuayhjbGVhbmVkQ2h1bmssIGNodW5rLmRvbmUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQWRkIHNtYWxsIGRlbGF5IHRvIHNsb3cgZG93biBzdHJlYW1pbmcgZm9yIGJldHRlciB2aXN1YWwgZWZmZWN0XG4gICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlIGFjdHVhbGx5IGdvdCBhIHJlc3BvbnNlXG4gICAgICAgICAgICBjb25zdCBmaW5hbFRleHQgPSB0aGlzLmNsZWFuQUlSZXNwb25zZShmdWxsUmVzcG9uc2UpO1xuICAgICAgICAgICAgaWYgKCFmaW5hbFRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgcmVzcG9uc2UnLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbFJhbmdlOiBzZWxlY3Rpb25SYW5nZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1lZFRleHQ6IGZpbmFsVGV4dCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFJhbmdlOiBzZWxlY3Rpb25SYW5nZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU2VsZWN0aW9uIGVkaXQgc3RyZWFtaW5nIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciB0aGUgQUkgYmFzZWQgb24gdGhlIGFjdGlvbiB0eXBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFByb21wdChhY3Rpb246IHN0cmluZywgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKToge1xuICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICAgICAgdXNlclByb21wdDogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBiYXNlU3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBhc3Npc3RhbnQuIFlvdXIgdGFzayBpcyB0byB0cmFuc2Zvcm0gdGhlIHByb3ZpZGVkIHRleHQgYWNjb3JkaW5nIHRvIHRoZSB1c2VyJ3MgcmVxdWVzdC4gXG5cbkNSSVRJQ0FMIFJVTEVTOlxuLSBQcm92aWRlIE9OTFkgdGhlIHRyYW5zZm9ybWVkIHRleHQsIG5vIGV4cGxhbmF0aW9ucyBvciBtZXRhLWNvbW1lbnRhcnlcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIG1lYW5pbmcgdW5sZXNzIHNwZWNpZmljYWxseSBhc2tlZCB0byBjaGFuZ2UgaXRcbi0gUHJlc2VydmUgdGhlIG9yaWdpbmFsIGZvcm1hdCAobWFya2Rvd24sIHN0cnVjdHVyZSwgZXRjLikgdW5sZXNzIGluc3RydWN0ZWQgb3RoZXJ3aXNlXG4tIERvIG5vdCBhZGQgaW50cm9kdWN0b3J5IHBocmFzZXMgbGlrZSBcIkhlcmUncyB0aGUgaW1wcm92ZWQgdGV4dDpcIiBvciBzaW1pbGFyXG4tIFJldHVybiBvbmx5IHRoZSBjb250ZW50IHRoYXQgc2hvdWxkIHJlcGxhY2UgdGhlIHNlbGVjdGVkIHRleHRgO1xuXG4gICAgICAgIGxldCBzcGVjaWZpY1Byb21wdCA9ICcnO1xuICAgICAgICBsZXQgdXNlclByb21wdCA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdpbXByb3ZlJzpcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IEltcHJvdmUgdGhlIHdyaXRpbmcgcXVhbGl0eVxuLSBNYWtlIHRoZSB0ZXh0IGNsZWFyZXIgYW5kIG1vcmUgY29uY2lzZVxuLSBJbXByb3ZlIGZsb3cgYW5kIHJlYWRhYmlsaXR5XG4tIEZpeCBhbnkgYXdrd2FyZCBwaHJhc2luZ1xuLSBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgdG9uZSBhbmQgbWVhbmluZ2A7XG4gICAgICAgICAgICAgICAgdXNlclByb21wdCA9IGBJbXByb3ZlIHRoaXMgdGV4dDpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdsb25nZXInOlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogRXhwYW5kIHRoZSB0ZXh0IHdpdGggbW9yZSBkZXRhaWxcbi0gQWRkIHJlbGV2YW50IGV4YW1wbGVzLCBjb250ZXh0LCBvciBleHBsYW5hdGlvbnNcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIHN0eWxlIGFuZCB2b2ljZVxuLSBFeHBhbmQgaWRlYXMgd2l0aG91dCBjaGFuZ2luZyB0aGUgY29yZSBtZXNzYWdlXG4tIE1ha2UgaXQgbW9yZSBjb21wcmVoZW5zaXZlIGFuZCBkZXRhaWxlZGA7XG4gICAgICAgICAgICAgICAgdXNlclByb21wdCA9IGBNYWtlIHRoaXMgdGV4dCBsb25nZXIgYW5kIG1vcmUgZGV0YWlsZWQ6XFxuXFxuJHtzZWxlY3RlZFRleHR9YDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc2hvcnRlcic6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBDb25kZW5zZSB0aGUgdGV4dCB0byBlc3NlbnRpYWwgcG9pbnRzXG4tIFJlbW92ZSByZWR1bmRhbmN5IGFuZCB1bm5lY2Vzc2FyeSB3b3Jkc1xuLSBLZWVwIGFsbCBrZXkgaW5mb3JtYXRpb24gYW5kIG1lYW5pbmdcbi0gTWFrZSBpdCBtb3JlIGNvbmNpc2UgYW5kIGRpcmVjdFxuLSBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgdG9uZWA7XG4gICAgICAgICAgICAgICAgdXNlclByb21wdCA9IGBNYWtlIHRoaXMgdGV4dCBzaG9ydGVyIGFuZCBtb3JlIGNvbmNpc2U6XFxuXFxuJHtzZWxlY3RlZFRleHR9YDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAndG9uZSc6XG4gICAgICAgICAgICAgICAgY29uc3QgdG9uZU1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAgICAgICAgICAgICAgICAgJ2Zvcm1hbCc6ICdwcm9mZXNzaW9uYWwgYW5kIHN0cnVjdHVyZWQsIHN1aXRhYmxlIGZvciBidXNpbmVzcyBvciBhY2FkZW1pYyBjb250ZXh0cycsXG4gICAgICAgICAgICAgICAgICAgICdjYXN1YWwnOiAncmVsYXhlZCBhbmQgY29udmVyc2F0aW9uYWwsIHN1aXRhYmxlIGZvciBpbmZvcm1hbCBjb21tdW5pY2F0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgJ2FjYWRlbWljJzogJ3NjaG9sYXJseSBhbmQgcHJlY2lzZSwgdXNpbmcgdGVjaG5pY2FsIHZvY2FidWxhcnkgd2hlcmUgYXBwcm9wcmlhdGUnLFxuICAgICAgICAgICAgICAgICAgICAnZnJpZW5kbHknOiAnd2FybSBhbmQgYXBwcm9hY2hhYmxlLCBidWlsZGluZyBjb25uZWN0aW9uIHdpdGggdGhlIHJlYWRlcidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHRvbmVEZXNjcmlwdGlvbiA9IHRvbmVNYXBbY3VzdG9tSW5zdHJ1Y3Rpb24gfHwgJ2Zvcm1hbCddIHx8IHRvbmVNYXAuZm9ybWFsO1xuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogQ2hhbmdlIHRoZSB0b25lIHRvIGJlICR7dG9uZURlc2NyaXB0aW9ufVxuLSBBZGp1c3QgbGFuZ3VhZ2UgYW5kIHZvY2FidWxhcnkgdG8gbWF0Y2ggdGhlIHJlcXVlc3RlZCB0b25lXG4tIEtlZXAgdGhlIHNhbWUgY29udGVudCBhbmQgbWVhbmluZ1xuLSBNYWludGFpbiBhcHByb3ByaWF0ZSBmb3JtYWxpdHkgbGV2ZWwgZm9yIHRoZSBjaG9zZW4gdG9uZWA7XG4gICAgICAgICAgICAgICAgdXNlclByb21wdCA9IGBSZXdyaXRlIHRoaXMgdGV4dCBpbiBhICR7Y3VzdG9tSW5zdHJ1Y3Rpb24gfHwgJ2Zvcm1hbCd9IHRvbmU6XFxuXFxuJHtzZWxlY3RlZFRleHR9YDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnY3VzdG9tJzpcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IEFwcGx5IGN1c3RvbSB0cmFuc2Zvcm1hdGlvblxuLSBGb2xsb3cgdGhlIHVzZXIncyBzcGVjaWZpYyBpbnN0cnVjdGlvbiBleGFjdGx5XG4tIE1haW50YWluIGNvbnRlbnQgaW50ZWdyaXR5IHVubGVzcyBhc2tlZCB0byBjaGFuZ2UgaXRcbi0gQXBwbHkgdGhlIHJlcXVlc3RlZCBjaGFuZ2VzIHByZWNpc2VseWA7XG4gICAgICAgICAgICAgICAgdXNlclByb21wdCA9IGBBcHBseSB0aGlzIGluc3RydWN0aW9uIHRvIHRoZSB0ZXh0OiBcIiR7Y3VzdG9tSW5zdHJ1Y3Rpb259XCJcXG5cXG5UZXh0IHRvIHRyYW5zZm9ybTpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogR2VuZXJhbCB0ZXh0IGltcHJvdmVtZW50XG4tIEVuaGFuY2UgY2xhcml0eSBhbmQgcmVhZGFiaWxpdHlcbi0gUHJlc2VydmUgb3JpZ2luYWwgbWVhbmluZyBhbmQgdG9uZWA7XG4gICAgICAgICAgICAgICAgdXNlclByb21wdCA9IGBJbXByb3ZlIHRoaXMgdGV4dDpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdDogYmFzZVN5c3RlbVByb21wdCArICdcXG4nICsgc3BlY2lmaWNQcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBvbmx5IHRoZSB0cmFuc2Zvcm1lZCB0ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBjbGVhbkFJUmVzcG9uc2UocmVzcG9uc2U6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIFJlbW92ZSBjb21tb24gQUkgcmVzcG9uc2UgcGF0dGVybnNcbiAgICAgICAgbGV0IGNsZWFuZWQgPSByZXNwb25zZS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgaW50cm9kdWN0b3J5IHBocmFzZXNcbiAgICAgICAgY29uc3QgaW50cm9QYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC9eSGVyZSdzIHRoZSBpbXByb3ZlZCB0ZXh0Oj9cXHMqL2ksXG4gICAgICAgICAgICAvXkhlcmUncyB0aGUgcmV3cml0dGVuIHRleHQ6P1xccyovaSxcbiAgICAgICAgICAgIC9eSGVyZSdzIHRoZSB0cmFuc2Zvcm1lZCB0ZXh0Oj9cXHMqL2ksXG4gICAgICAgICAgICAvXkltcHJvdmVkIHZlcnNpb246P1xccyovaSxcbiAgICAgICAgICAgIC9eUmV3cml0dGVuOj9cXHMqL2ksXG4gICAgICAgICAgICAvXlJlc3VsdDo/XFxzKi9pLFxuICAgICAgICAgICAgL15PdXRwdXQ6P1xccyovaVxuICAgICAgICBdO1xuXG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBpbnRyb1BhdHRlcm5zKSB7XG4gICAgICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKHBhdHRlcm4sICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbW92ZSB0cmFpbGluZyBleHBsYW5hdGlvbnMgKHRleHQgYWZ0ZXIgXCItLS1cIiBvciBzaW1pbGFyIHBhdHRlcm5zKVxuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5zcGxpdCgvXFxuXFxzKi0tLStcXHMqLykuc2hpZnQoKSB8fCBjbGVhbmVkO1xuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5zcGxpdCgvXFxuXFxzKlxcKlxcKj9FeHBsYW5hdGlvblxcKj9cXCo/Oi9pKS5zaGlmdCgpIHx8IGNsZWFuZWQ7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY2xlYW5lZC50cmltKCk7XG4gICAgfVxufSIsICIvKipcbiAqIE5hdGl2ZSB0b25lIHNlbGVjdGlvbiBtb2RhbCBmb3IgTm92YSB1c2luZyBPYnNpZGlhbidzIEZ1enp5U3VnZ2VzdE1vZGFsXG4gKiBQcm92aWRlcyBjb25zaXN0ZW50IFVYIHdpdGggY29yZSBPYnNpZGlhbiBmZWF0dXJlc1xuICovXG5cbmltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIEZ1enp5TWF0Y2ggfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVG9uZU9wdGlvbiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBsYWJlbDogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBUT05FX09QVElPTlM6IFRvbmVPcHRpb25bXSA9IFtcbiAgICB7XG4gICAgICAgIGlkOiAnZm9ybWFsJyxcbiAgICAgICAgbGFiZWw6ICdGb3JtYWwnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Byb2Zlc3Npb25hbCwgc3RydWN0dXJlZCBsYW5ndWFnZSBzdWl0YWJsZSBmb3IgYnVzaW5lc3Mgb3IgYWNhZGVtaWMgY29udGV4dHMnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnY2FzdWFsJyxcbiAgICAgICAgbGFiZWw6ICdDYXN1YWwnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1JlbGF4ZWQsIGNvbnZlcnNhdGlvbmFsIHRvbmUgZm9yIGluZm9ybWFsIGNvbW11bmljYXRpb24nXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnYWNhZGVtaWMnLFxuICAgICAgICBsYWJlbDogJ0FjYWRlbWljJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdTY2hvbGFybHksIHByZWNpc2UgbGFuZ3VhZ2Ugd2l0aCB0ZWNobmljYWwgdm9jYWJ1bGFyeSdcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdmcmllbmRseScsXG4gICAgICAgIGxhYmVsOiAnRnJpZW5kbHknLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1dhcm0sIGFwcHJvYWNoYWJsZSB0b25lIHRoYXQgYnVpbGRzIGNvbm5lY3Rpb24nXG4gICAgfVxuXTtcblxuZXhwb3J0IGNsYXNzIFRvbmVTZWxlY3Rpb25Nb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPFRvbmVPcHRpb24+IHtcbiAgICBwcml2YXRlIG9uU2VsZWN0OiAodG9uZTogc3RyaW5nKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgb25DYW5jZWw6ICgpID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIG9uU2VsZWN0OiAodG9uZTogc3RyaW5nKSA9PiB2b2lkLFxuICAgICAgICBvbkNhbmNlbDogKCkgPT4gdm9pZFxuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XG4gICAgICAgIHRoaXMub25DYW5jZWwgPSBvbkNhbmNlbDtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCBwbGFjZWhvbGRlciB0ZXh0XG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ0Nob29zZSBhIHdyaXRpbmcgdG9uZS4uLicpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGluc3RydWN0aW9uXG4gICAgICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKFtcbiAgICAgICAgICAgIHsgY29tbWFuZDogJ1x1MjE5MVx1MjE5MycsIHB1cnBvc2U6ICd0byBuYXZpZ2F0ZScgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogJ1x1MjFCNScsIHB1cnBvc2U6ICd0byBhcHBseSB0b25lJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiAnZXNjJywgcHVycG9zZTogJ3RvIGNhbmNlbCcgfVxuICAgICAgICBdKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBUb25lT3B0aW9uW10ge1xuICAgICAgICByZXR1cm4gVE9ORV9PUFRJT05TO1xuICAgIH1cblxuICAgIGdldEl0ZW1UZXh0KHRvbmU6IFRvbmVPcHRpb24pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCR7dG9uZS5sYWJlbH0gLSAke3RvbmUuZGVzY3JpcHRpb259YDtcbiAgICB9XG5cbiAgICBvbkNob29zZUl0ZW0odG9uZTogVG9uZU9wdGlvbiwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uU2VsZWN0KHRvbmUuaWQpO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIC8vIElmIG5vIHNlbGVjdGlvbiB3YXMgbWFkZSwgY2FsbCBvbkNhbmNlbFxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgaWYgKGNvbnRlbnRFbC5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLm9uQ2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogTmF0aXZlIGN1c3RvbSBpbnN0cnVjdGlvbiBtb2RhbCBmb3IgTm92YSB1c2luZyBPYnNpZGlhbidzIE1vZGFsIGNsYXNzXG4gKiBTaW1wbGlmaWVkIGRlc2lnbiBmb2xsb3dpbmcgT2JzaWRpYW4ncyBuYXRpdmUgcGF0dGVybnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgQ3VzdG9tSW5zdHJ1Y3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIGluc3RydWN0aW9uOiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIG9uU3VibWl0OiAoaW5zdHJ1Y3Rpb246IHN0cmluZykgPT4gdm9pZDtcbiAgICBwcml2YXRlIG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBvblN1Ym1pdDogKGluc3RydWN0aW9uOiBzdHJpbmcpID0+IHZvaWQsXG4gICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB2b2lkXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgICAgICAgdGhpcy5vbkNhbmNlbCA9IG9uQ2FuY2VsO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gVXNlIG5hdGl2ZSBtb2RhbCBzdHlsaW5nXG4gICAgICAgIHRoaXMubW9kYWxFbC5hZGRDbGFzcygnbm92YS1jdXN0b20taW5zdHJ1Y3Rpb24tbW9kYWwnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRpdGxlXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdUZWxsIE5vdmEnIH0pO1xuXG4gICAgICAgIC8vIERlc2NyaXB0aW9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdJbnN0cnVjdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnRGVzY3JpYmUgaG93IHlvdSB3YW50IE5vdmEgdG8gdHJhbnNmb3JtIHlvdXIgc2VsZWN0ZWQgdGV4dCcpO1xuXG4gICAgICAgIC8vIFRleHQgYXJlYSB1c2luZyBTZXR0aW5nIGNvbXBvbmVudCBmb3IgY29uc2lzdGVudCBzdHlsaW5nXG4gICAgICAgIGNvbnN0IHRleHRBcmVhU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZS5nLiwgXCJtYWtlIHRoaXMgbW9yZSBwZXJzdWFzaXZlXCIsIFwiYWRkIHN0YXRpc3RpY3NcIiwgXCJ3cml0ZSBpbiBidWxsZXQgcG9pbnRzXCInKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5pbnN0cnVjdGlvbilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zdHJ1Y3Rpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWFrZSB0aGUgdGV4dCBhcmVhIGxhcmdlclxuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnN0eWxlLm1pbkhlaWdodCA9ICcxMDBweCc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gRm9jdXMgb24gdGhlIHRleHQgYXJlYVxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGV4dC5pbnB1dEVsLmZvY3VzKCksIDUwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgQ3RybC9DbWQrRW50ZXIgdG8gc3VibWl0XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEhpZGUgdGhlIHNldHRpbmcgbmFtZS9kZXNjcmlwdGlvbiBhcmVhIHRvIGdpdmUgZnVsbCB3aWR0aCB0byB0ZXh0YXJlYVxuICAgICAgICB0ZXh0QXJlYVNldHRpbmcuc2V0dGluZ0VsLnN0eWxlLmJvcmRlciA9ICdub25lJztcbiAgICAgICAgdGV4dEFyZWFTZXR0aW5nLnNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLWluZm8nKT8ucmVtb3ZlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYWtlIHRoZSBjb250cm9sIHRha2UgZnVsbCB3aWR0aFxuICAgICAgICBjb25zdCBjb250cm9sID0gdGV4dEFyZWFTZXR0aW5nLnNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLWNvbnRyb2wnKTtcbiAgICAgICAgaWYgKGNvbnRyb2wgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgY29udHJvbC5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1dHRvbnMgdXNpbmcgU2V0dGluZyBjb21wb25lbnRcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0NhbmNlbCcpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25DYW5jZWwoKTtcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdUcmFuc2Zvcm0gVGV4dCcpXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4gdGhpcy5zdWJtaXQoKSkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3VibWl0KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pbnN0cnVjdGlvbi50cmltKCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXQodGhpcy5pbnN0cnVjdGlvbi50cmltKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyLCBQcm92aWRlclR5cGUsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgQUlQcm92aWRlclNldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDbGF1ZGVQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2NsYXVkZSc7XG5pbXBvcnQgeyBPcGVuQUlQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL29wZW5haSc7XG5pbXBvcnQgeyBHb29nbGVQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2dvb2dsZSc7XG5pbXBvcnQgeyBPbGxhbWFQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL29sbGFtYSc7XG5pbXBvcnQgeyBOb3ZhU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4uL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgQUlQcm92aWRlck1hbmFnZXIge1xuXHRwcml2YXRlIHByb3ZpZGVyczogTWFwPFByb3ZpZGVyVHlwZSwgQUlQcm92aWRlcj4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc2V0dGluZ3M6IE5vdmFTZXR0aW5ncztcblx0cHJpdmF0ZSBmZWF0dXJlTWFuYWdlcj86IEZlYXR1cmVNYW5hZ2VyO1xuXG5cdGNvbnN0cnVjdG9yKHNldHRpbmdzOiBOb3ZhU2V0dGluZ3MsIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXIpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdFx0dGhpcy5mZWF0dXJlTWFuYWdlciA9IGZlYXR1cmVNYW5hZ2VyO1xuXHR9XG5cblx0YXN5bmMgaW5pdGlhbGl6ZSgpIHtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2NsYXVkZScsIG5ldyBDbGF1ZGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb3BlbmFpJywgbmV3IE9wZW5BSVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdnb29nbGUnLCBuZXcgR29vZ2xlUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ29sbGFtYScsIG5ldyBPbGxhbWFQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYSkpO1xuXHR9XG5cblx0dXBkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IE5vdmFTZXR0aW5ncykge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLnByb3ZpZGVycy5mb3JFYWNoKChwcm92aWRlciwgdHlwZSkgPT4ge1xuXHRcdFx0aWYgKHR5cGUgIT09ICdub25lJyAmJiB0eXBlIGluIHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMpIHtcblx0XHRcdFx0cHJvdmlkZXIudXBkYXRlQ29uZmlnPy4odGhpcy5zZXR0aW5ncy5haVByb3ZpZGVyc1t0eXBlIGFzIGtleW9mIEFJUHJvdmlkZXJTZXR0aW5nc10pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRQbGF0Zm9ybVByb3ZpZGVycygpOiBQcm92aWRlclR5cGVbXSB7XG5cdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdGNvbnN0IHBsYXRmb3JtU2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dO1xuXHRcdGNvbnN0IHByb3ZpZGVycyA9IFtwbGF0Zm9ybVNldHRpbmdzLnByaW1hcnlQcm92aWRlciwgLi4ucGxhdGZvcm1TZXR0aW5ncy5mYWxsYmFja1Byb3ZpZGVyc107XG5cdFx0XG5cdFx0Ly8gTm8gcmVzdHJpY3Rpb25zIC0gYWxsIHVzZXJzIGNhbiB1c2UgYWxsIHByb3ZpZGVycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHRcdHJldHVybiBwcm92aWRlcnM7XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTogUHJvbWlzZTxBSVByb3ZpZGVyIHwgbnVsbD4ge1xuXHRcdGNvbnN0IG9yZGVyZWRQcm92aWRlcnMgPSB0aGlzLmdldFBsYXRmb3JtUHJvdmlkZXJzKCk7XG5cdFx0XG5cdFx0Ly8gSWYgcHJpbWFyeSBwcm92aWRlciBpcyAnbm9uZScsIE5vdmEgaXMgZGlzYWJsZWQgb24gdGhpcyBwbGF0Zm9ybVxuXHRcdGlmIChvcmRlcmVkUHJvdmlkZXJzWzBdID09PSAnbm9uZScpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBvcmRlcmVkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IGlzQXZhaWxhYmxlID0gcHJvdmlkZXIgPyBhd2FpdCBwcm92aWRlci5pc0F2YWlsYWJsZSgpIDogZmFsc2U7XG5cdFx0XHRcblx0XHRcdGlmIChwcm92aWRlciAmJiBpc0F2YWlsYWJsZSkge1xuXHRcdFx0XHRyZXR1cm4gcHJvdmlkZXI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gcHJvdmlkZXIuZ2VuZXJhdGVUZXh0KHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdFxuXHRcdHlpZWxkKiBwcm92aWRlci5nZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0eWllbGQqIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGdldFByb3ZpZGVyTmFtZXMoKTogc3RyaW5nW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMucHJvdmlkZXJzLnZhbHVlcygpKS5tYXAocCA9PiBwLm5hbWUpO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdHJldHVybiBwcm92aWRlciA/IHByb3ZpZGVyLm5hbWUgOiAnTm9uZSc7XG5cdH1cblxuXHRhc3luYyBnZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuXHRcdGNvbnN0IG9yZGVyZWRQcm92aWRlcnMgPSB0aGlzLmdldFBsYXRmb3JtUHJvdmlkZXJzKCk7XG5cdFx0aWYgKG9yZGVyZWRQcm92aWRlcnNbMF0gPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGZvciAoY29uc3QgcHJvdmlkZXJUeXBlIG9mIG9yZGVyZWRQcm92aWRlcnMpIHtcblx0XHRcdGlmIChwcm92aWRlclR5cGUgPT09ICdub25lJykgY29udGludWU7XG5cdFx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHByb3ZpZGVyLmlzQXZhaWxhYmxlKCkpIHtcblx0XHRcdFx0cmV0dXJuIHByb3ZpZGVyVHlwZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGdldEFsbG93ZWRQcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIE9sbGFtYSByZXF1aXJlcyBsb2NhbCBzZXJ2ZXIgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZVxuXHRcdGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuXHRcdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnXTtcblx0XHR9XG5cdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ107XG5cdH1cblxuXHRpc1Byb3ZpZGVyQWxsb3dlZChwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IGJvb2xlYW4ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGFsbG93ZWRcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGdldFByb3ZpZGVyTGltaXRzKCk6IHsgbG9jYWw6IG51bWJlcjsgY2xvdWQ6IG51bWJlciB9IHtcblx0XHQvLyBObyBsaW1pdHMgaW4gdGhlIFN1cGVybm92YSBtb2RlbFxuXHRcdHJldHVybiB7IGxvY2FsOiBJbmZpbml0eSwgY2xvdWQ6IEluZmluaXR5IH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGF2YWlsYWJsZSBtb2RlbHMgZm9yIGEgc3BlY2lmaWMgcHJvdmlkZXJcblx0ICovXG5cdGFzeW5jIGdldFByb3ZpZGVyTW9kZWxzKHByb3ZpZGVyVHlwZTogUHJvdmlkZXJUeXBlKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBQcm92aWRlciAke3Byb3ZpZGVyVHlwZX0gbm90IGZvdW5kYCk7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIGdldEF2YWlsYWJsZU1vZGVscyBtZXRob2Rcblx0XHRpZiAoJ2dldEF2YWlsYWJsZU1vZGVscycgaW4gcHJvdmlkZXIgJiYgdHlwZW9mIHByb3ZpZGVyLmdldEF2YWlsYWJsZU1vZGVscyA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0cmV0dXJuIGF3YWl0IChwcm92aWRlciBhcyBhbnkpLmdldEF2YWlsYWJsZU1vZGVscygpO1xuXHRcdH1cblxuXHRcdC8vIEZvciBwcm92aWRlcnMgd2l0aG91dCBBUEkgbW9kZWwgbGlzdGluZyAobGlrZSBPbGxhbWEpLCByZXR1cm4gZW1wdHkgYXJyYXlcblx0XHRyZXR1cm4gW107XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgbW9kZWwgY2FjaGUgZm9yIGEgc3BlY2lmaWMgcHJvdmlkZXJcblx0ICovXG5cdGNsZWFyUHJvdmlkZXJNb2RlbENhY2hlKHByb3ZpZGVyVHlwZTogUHJvdmlkZXJUeXBlKTogdm9pZCB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIGNsZWFyTW9kZWxDYWNoZSBtZXRob2Rcblx0XHRpZiAoJ2NsZWFyTW9kZWxDYWNoZScgaW4gcHJvdmlkZXIgJiYgdHlwZW9mIHByb3ZpZGVyLmNsZWFyTW9kZWxDYWNoZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0KHByb3ZpZGVyIGFzIGFueSkuY2xlYXJNb2RlbENhY2hlKCk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpIHtcblx0XHR0aGlzLnByb3ZpZGVycy5jbGVhcigpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCB0aGUgZGVmYXVsdCBtYXggdG9rZW5zIGZyb20gc2V0dGluZ3Ncblx0ICovXG5cdGdldERlZmF1bHRNYXhUb2tlbnMoKTogbnVtYmVyIHtcblx0XHRyZXR1cm4gdGhpcy5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnM7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBDbGF1ZGVQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ0NsYXVkZSAoQW50aHJvcGljKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblx0cHJpdmF0ZSBjYWNoZWRNb2RlbHM6IHN0cmluZ1tdIHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdEJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0Jyxcblx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRzeXN0ZW06IG9wdGlvbnM/LnN5c3RlbVByb21wdCxcblx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdHJvbGU6IG1zZy5yb2xlID09PSAnYXNzaXN0YW50JyA/ICdhc3Npc3RhbnQnIDogJ3VzZXInLFxuXHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0fSkpXG5cdFx0fSk7XG5cblx0XHQvLyBSZXRyeSBsb2dpYyBmb3IgNTAwLWxldmVsIGVycm9yc1xuXHRcdGNvbnN0IG1heFJldHJpZXMgPSAzO1xuXHRcdGNvbnN0IGJhc2VEZWxheSA9IDEwMDA7IC8vIDEgc2Vjb25kXG5cblx0XHRmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8PSBtYXhSZXRyaWVzOyBhdHRlbXB0KyspIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHRcdFx0dXJsOiAnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsXG5cdFx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0XHRcdCd4LWFwaS1rZXknOiB0aGlzLmNvbmZpZy5hcGlLZXksXG5cdFx0XHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGJvZHk6IHJlcXVlc3RCb2R5XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuXHRcdFx0XHRcdGNvbnN0IGRhdGEgPSByZXNwb25zZS5qc29uO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhLmNvbnRlbnRbMF0udGV4dDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSA1MDAtbGV2ZWwgZXJyb3IgdGhhdCB3ZSBzaG91bGQgcmV0cnlcblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA+PSA1MDAgJiYgYXR0ZW1wdCA8IG1heFJldHJpZXMpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpOyAvLyBFeHBvbmVudGlhbCBiYWNrb2ZmXG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG5cdFx0XHRcdFx0Y29udGludWU7IC8vIFJldHJ5XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBGb3IgYWxsIG90aGVyIGVycm9ycyBvciBmaW5hbCBhdHRlbXB0LCB0aHJvdyBlcnJvclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENsYXVkZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7cmVzcG9uc2UudGV4dH1gKTtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gTmV0d29yay9jb25uZWN0aW9uIGVycm9ycyAtIHJldHJ5IGlmIG5vdCBmaW5hbCBhdHRlbXB0XG5cdFx0XHRcdGlmIChhdHRlbXB0IDwgbWF4UmV0cmllcyAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIChcblx0XHRcdFx0XHRlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdOZXR3b3JrIGVycm9yJykgfHwgXG5cdFx0XHRcdFx0ZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRmFpbGVkIHRvIGNvbm5lY3QnKVxuXHRcdFx0XHQpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTtcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gUmUtdGhyb3cgdGhlIGVycm9yIGlmIGl0J3MgdGhlIGZpbmFsIGF0dGVtcHQgb3Igbm90IGEgcmV0cnlhYmxlIGVycm9yXG5cdFx0XHRcdGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2Uuc3RhcnRzV2l0aCgnQ2xhdWRlIEFQSSBlcnJvcjonKSkge1xuXHRcdFx0XHRcdHRocm93IGVycm9yOyAvLyBBbHJlYWR5IGZvcm1hdHRlZCBlcnJvclxuXHRcdFx0XHR9XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNvbm5lY3QgdG8gQ2xhdWRlIEFQSTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdOZXR3b3JrIGVycm9yJ31gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBUaGlzIHNob3VsZCBuZXZlciBiZSByZWFjaGVkLCBidXQgVHlwZVNjcmlwdCB3YW50cyBpdFxuXHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSTogTWF4aW11bSByZXRyaWVzIGV4Y2VlZGVkJyk7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1dO1xuXHRcdGNvbnN0IGNvbXBsZXRlT3B0aW9ucyA9IHsgLi4ub3B0aW9ucywgc3lzdGVtUHJvbXB0IH07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIGNvbXBsZXRlT3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHQvLyBHZXQgdGhlIGZ1bGwgcmVzcG9uc2UgZnJvbSBDbGF1ZGUsIHRoZW4gc2ltdWxhdGUgc3RyZWFtaW5nIHdpdGggY29uc2lzdGVudCBjaHVua2luZ1xuXHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHRcdFxuXHRcdC8vIFNwbGl0IHJlc3VsdCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciBjb25zaXN0ZW50IHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRjb25zdCBjaHVuayA9IHJlc3VsdC5zbGljZShpLCBpICsgY2h1bmtTaXplKTtcblx0XHRcdHlpZWxkIHsgY29udGVudDogY2h1bmssIGRvbmU6IGZhbHNlIH07XG5cdFx0XHQvLyBTbWFsbCBkZWxheSBiZXR3ZWVuIGNodW5rcyB0byBjcmVhdGUgc21vb3RoIHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjApKTtcblx0XHR9XG5cdFx0XG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBDbGF1ZGUgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdC8vIEZvciBDbGF1ZGUsIHdlJ2xsIHVzZSBhIGhhcmRjb2RlZCBsaXN0IHNpbmNlIEFudGhyb3BpYyBkb2Vzbid0IHByb3ZpZGUgYSBtb2RlbHMgZW5kcG9pbnRcblx0XHQvLyBCdXQgd2UgY2FuIHZhbGlkYXRlIHRoZSBBUEkga2V5IGJ5IG1ha2luZyBhIHRlc3QgY2FsbFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBWYWxpZGF0ZSBBUEkga2V5IHdpdGggYSBtaW5pbWFsIHJlcXVlc3Rcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHRcdHVybDogJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLFxuXHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdFx0fSxcblx0XHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRcdG1vZGVsOiAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLFxuXHRcdFx0XHRcdG1heF90b2tlbnM6IDEsXG5cdFx0XHRcdFx0bWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dXG5cdFx0XHRcdH0pXG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQVBJIGtleSB2YWxpZGF0aW9uIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtyZXNwb25zZS50ZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZXR1cm4gY3VycmVudCBhdmFpbGFibGUgbW9kZWxzIChmcm9tIEFQSSBkb2NzKVxuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnY2xhdWRlLW9wdXMtNC0yMDI1MDUxNCcsXG5cdFx0XHRcdCdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnLFxuXHRcdFx0XHQnY2xhdWRlLTMtNy1zb25uZXQtbGF0ZXN0Jyxcblx0XHRcdFx0J2NsYXVkZS0zLTUtc29ubmV0LWxhdGVzdCcsXG5cdFx0XHRcdCdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggQ2xhdWRlIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT3BlbkFJUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPcGVuQUknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlcXVlc3RNZXNzYWdlcyA9IFsuLi5tZXNzYWdlc107XG5cdFx0aWYgKG9wdGlvbnM/LnN5c3RlbVByb21wdCkge1xuXHRcdFx0cmVxdWVzdE1lc3NhZ2VzLnVuc2hpZnQoeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogb3B0aW9ucy5zeXN0ZW1Qcm9tcHQgfSk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdGNvbnN0IGVuZHBvaW50ID0gYmFzZVVybC5lbmRzV2l0aCgnL2NoYXQvY29tcGxldGlvbnMnKSA/IGJhc2VVcmwgOiBgJHtiYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYDtcblx0XHRcblx0XHRjb25zdCByZXF1ZXN0Qm9keSA9IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnZ3B0LTMuNS10dXJibycsXG5cdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuN1xuXHRcdH0pO1xuXG5cdFx0Ly8gUmV0cnkgbG9naWMgZm9yIDUwMC1sZXZlbCBlcnJvcnNcblx0XHRjb25zdCBtYXhSZXRyaWVzID0gMztcblx0XHRjb25zdCBiYXNlRGVsYXkgPSAxMDAwOyAvLyAxIHNlY29uZFxuXG5cdFx0Zm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRib2R5OiByZXF1ZXN0Qm9keVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAocmVzcG9uc2Uub2spIHtcblx0XHRcdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIDUwMC1sZXZlbCBlcnJvciB0aGF0IHdlIHNob3VsZCByZXRyeVxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCAmJiBhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gUmV0cnlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvciBhbGwgb3RoZXIgZXJyb3JzIG9yIGZpbmFsIGF0dGVtcHQsIHRocm93IGVycm9yXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBOZXR3b3JrIGVycm9ycyAtIHJldHJ5IGlmIG5vdCBmaW5hbCBhdHRlbXB0XG5cdFx0XHRcdGlmIChhdHRlbXB0IDwgbWF4UmV0cmllcyAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2ZldGNoJykpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZS10aHJvdyB0aGUgZXJyb3IgaWYgaXQncyB0aGUgZmluYWwgYXR0ZW1wdCBvciBub3QgYSBuZXR3b3JrIGVycm9yXG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWQsIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIGl0XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJOiBNYXhpbXVtIHJldHJpZXMgZXhjZWVkZWQnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRpZiAob3B0aW9ucz8uc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRyZXF1ZXN0TWVzc2FnZXMudW5zaGlmdCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBvcHRpb25zLnN5c3RlbVByb21wdCB9KTtcblx0XHR9XG5cblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSc7XG5cdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvY2hhdC9jb21wbGV0aW9ucycpID8gYmFzZVVybCA6IGAke2Jhc2VVcmx9L2NoYXQvY29tcGxldGlvbnNgO1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdncHQtMy41LXR1cmJvJyxcblx0XHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRzdHJlYW06IHRydWVcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG5cdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gcGFyc2VkLmNob2ljZXM/LlswXT8uZGVsdGE/LmNvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgY29udGVudCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciBjb25zaXN0ZW50IHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRlbnQubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmsgPSBjb250ZW50LnNsaWNlKGksIGkgKyBjaHVua1NpemUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gY2h1bmtzIHRvIGNyZWF0ZSBzbW9vdGggdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMCkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gT3BlbkFJIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvbW9kZWxzJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vbW9kZWxzYDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ3B0LTQuMS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbWluaS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbmFuby0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00bycsXG5cdFx0XHRcdCdncHQtNG8tbWluaSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggT3BlbkFJIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgR29vZ2xlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdHb29nbGUgKEdlbWluaSknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSk6IGFueSB7XG5cdFx0Y29uc3QgY29udGVudHMgPSBbXTtcblxuXHRcdGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuXHRcdFx0Y29uc3Qgcm9sZSA9IG1lc3NhZ2Uucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnbW9kZWwnIDogJ3VzZXInO1xuXHRcdFx0Y29udGVudHMucHVzaCh7XG5cdFx0XHRcdHJvbGUsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBtZXNzYWdlLmNvbnRlbnQgfV1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEVuc3VyZSB3ZSBoYXZlIGF0IGxlYXN0IG9uZSBtZXNzYWdlXG5cdFx0aWYgKGNvbnRlbnRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdObyBtZXNzYWdlcyBwcm92aWRlZCBmb3IgR29vZ2xlIEFQSScpO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb250ZW50cztcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gVXNlIGEgbmV3ZXIgbW9kZWwgYnkgZGVmYXVsdCBpZiBubyBtb2RlbCBpcyBzcGVjaWZpZWRcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktMi4wLWZsYXNoJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cdFx0XG5cblx0XHRjb25zdCByZXF1ZXN0Qm9keTogYW55ID0ge1xuXHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMpLFxuXHRcdFx0Z2VuZXJhdGlvbkNvbmZpZzoge1xuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBBZGQgc3lzdGVtIGluc3RydWN0aW9uIGlmIHByb3ZpZGVkIChHb29nbGUncyBwcm9wZXIgZm9ybWF0KVxuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQgJiYgb3B0aW9ucy5zeXN0ZW1Qcm9tcHQudHJpbSgpKSB7XG5cdFx0XHRyZXF1ZXN0Qm9keS5zeXN0ZW1JbnN0cnVjdGlvbiA9IHtcblx0XHRcdFx0cGFydHM6IFt7IHRleHQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH1dXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0Y29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXHRcdFx0bGV0IGVycm9yTWVzc2FnZSA9ICcnO1xuXHRcdFx0XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBlcnJvckRhdGEgPSBKU09OLnBhcnNlKGVycm9yVGV4dCk7XG5cdFx0XHRcdGlmIChlcnJvckRhdGEuZXJyb3IpIHtcblx0XHRcdFx0XHQvLyBGb3JtYXQgYXMgW0NPREVdOiBtZXNzYWdlXG5cdFx0XHRcdFx0Y29uc3QgY29kZSA9IGVycm9yRGF0YS5lcnJvci5jb2RlIHx8IHJlc3BvbnNlLnN0YXR1cztcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gZXJyb3JEYXRhLmVycm9yLm1lc3NhZ2UgfHwgZXJyb3JEYXRhLmVycm9yLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXNUZXh0O1xuXHRcdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtjb2RlfV06ICR7bWVzc2FnZX1gO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEFkZCBzcGVjaWZpYyBndWlkYW5jZSBmb3IgY29tbW9uIGVycm9yc1xuXHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMCkge1xuXHRcdFx0XHRcdFx0ZXJyb3JNZXNzYWdlICs9ICcgKENoZWNrIHJlcXVlc3QgZm9ybWF0IG9yIG1vZGVsIG5hbWUpJztcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cdFx0XHRcdFx0XHRlcnJvck1lc3NhZ2UgKz0gJyAoQ2hlY2sgQVBJIGtleSBpbiBzZXR0aW5ncyknO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcblx0XHRcdFx0XHRcdGVycm9yTWVzc2FnZSArPSAnIChNb2RlbCBtYXkgbm90IGJlIGF2YWlsYWJsZSknO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHtcblx0XHRcdFx0XHRcdGVycm9yTWVzc2FnZSArPSAnIChSYXRlIGxpbWl0IGV4Y2VlZGVkKSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtyZXNwb25zZS5zdGF0dXN9XTogJHtlcnJvclRleHR9YDtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRlcnJvck1lc3NhZ2UgPSBgWyR7cmVzcG9uc2Uuc3RhdHVzfV06ICR7ZXJyb3JUZXh0IHx8IHJlc3BvbnNlLnN0YXR1c1RleHR9YDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gTG9nIGRldGFpbGVkIGVycm9yIGZvciBkZWJ1Z2dpbmdcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0dvb2dsZSBBUEkgRXJyb3IgRGV0YWlsczonLCB7XG5cdFx0XHRcdHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuXHRcdFx0XHRzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuXHRcdFx0XHRlcnJvclRleHQ6IGVycm9yVGV4dCxcblx0XHRcdFx0cmVxdWVzdEJvZHk6IHJlcXVlc3RCb2R5LFxuXHRcdFx0XHRtb2RlbDogbW9kZWwsXG5cdFx0XHRcdHVybDogdXJsXG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yICR7ZXJyb3JNZXNzYWdlfWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgcmVzcG9uc2UgaGFzIHZhbGlkIHN0cnVjdHVyZVxuXHRcdGlmICghZGF0YS5jYW5kaWRhdGVzIHx8IGRhdGEuY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHtcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlJ3MgYW4gZXJyb3IgbWVzc2FnZSBpbiB0aGUgcmVzcG9uc2Vcblx0XHRcdGlmIChkYXRhLmVycm9yKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgR29vZ2xlIEFQSSBlcnJvcjogJHtkYXRhLmVycm9yLm1lc3NhZ2UgfHwgSlNPTi5zdHJpbmdpZnkoZGF0YS5lcnJvcil9YCk7XG5cdFx0XHR9XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkgcmV0dXJuZWQgbm8gY2FuZGlkYXRlcycpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGUgcmVzcG9uc2Ugd2FzIGJsb2NrZWQgb3IgZmlsdGVyZWRcblx0XHRpZiAoZGF0YS5jYW5kaWRhdGVzWzBdLmZpbmlzaFJlYXNvbiA9PT0gJ1NBRkVUWScgfHwgZGF0YS5jYW5kaWRhdGVzWzBdLmZpbmlzaFJlYXNvbiA9PT0gJ0JMT0NLRUQnKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkgYmxvY2tlZCB0aGUgcmVzcG9uc2UgZHVlIHRvIHNhZmV0eSBmaWx0ZXJzJyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHdlIGhpdCB0aGUgdG9rZW4gbGltaXQgYmVmb3JlIGdlbmVyYXRpbmcgY29udGVudFxuXHRcdGlmIChkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnTUFYX1RPS0VOUycgJiYgXG5cdFx0ICAgICghZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQgfHwgIWRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzIHx8IGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzLmxlbmd0aCA9PT0gMCkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQVBJIGhpdCB0b2tlbiBsaW1pdCBiZWZvcmUgZ2VuZXJhdGluZyBhbnkgY29udGVudC4gUGxlYXNlIGluY3JlYXNlIFwiRGVmYXVsdCBNYXggVG9rZW5zXCIgaW4gc2V0dGluZ3MuJyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHJlc3BvbnNlIGhhcyBjb250ZW50XG5cdFx0aWYgKGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50ICYmIGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzICYmIGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IHRleHQgPSBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuXHRcdFx0XG5cdFx0XHRcblx0XHRcdC8vIElmIHJlc3BvbnNlIHdhcyB0cnVuY2F0ZWQsIHRocm93IGVycm9yIGluc3RlYWQgb2YgcmV0dXJuaW5nIHBhcnRpYWwgY29udGVudFxuXHRcdFx0aWYgKGRhdGEuY2FuZGlkYXRlc1swXS5maW5pc2hSZWFzb24gPT09ICdNQVhfVE9LRU5TJykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1Jlc3BvbnNlIHdhcyB0cnVuY2F0ZWQgZHVlIHRvIHRva2VuIGxpbWl0LiBQbGVhc2UgaW5jcmVhc2UgXCJEZWZhdWx0IE1heCBUb2tlbnNcIiBpbiBzZXR0aW5ncy4nKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gTWFrZSBzdXJlIHdlIGhhdmUgYWN0dWFsIHRleHQgY29udGVudFxuXHRcdFx0aWYgKCF0ZXh0IHx8IHRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdHb29nbGUgQVBJIHJldHVybmVkIGVtcHR5IHRleHQgY29udGVudCcpO1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkgcmV0dXJuZWQgZW1wdHkgdGV4dCBjb250ZW50Jyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiB0ZXh0O1xuXHRcdH1cblx0XHRcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkgcmV0dXJuZWQgZW1wdHkgcmVzcG9uc2UnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gVXNlIGEgbmV3ZXIgbW9kZWwgYnkgZGVmYXVsdCBpZiBubyBtb2RlbCBpcyBzcGVjaWZpZWRcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktMi4wLWZsYXNoJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzKSxcblx0XHRcdFx0Z2VuZXJhdGlvbkNvbmZpZzoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bWF4T3V0cHV0VG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fSxcblx0XHRcdFx0Li4uKG9wdGlvbnM/LnN5c3RlbVByb21wdCAmJiBvcHRpb25zLnN5c3RlbVByb21wdC50cmltKCkgPyB7XG5cdFx0XHRcdFx0c3lzdGVtSW5zdHJ1Y3Rpb246IHtcblx0XHRcdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBvcHRpb25zLnN5c3RlbVByb21wdCB9XVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSA6IHt9KVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcblx0XHRcdGxldCBlcnJvck1lc3NhZ2UgPSAnJztcblx0XHRcdFxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgZXJyb3JEYXRhID0gSlNPTi5wYXJzZShlcnJvclRleHQpO1xuXHRcdFx0XHRpZiAoZXJyb3JEYXRhLmVycm9yKSB7XG5cdFx0XHRcdFx0Y29uc3QgY29kZSA9IGVycm9yRGF0YS5lcnJvci5jb2RlIHx8IHJlc3BvbnNlLnN0YXR1cztcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gZXJyb3JEYXRhLmVycm9yLm1lc3NhZ2UgfHwgZXJyb3JEYXRhLmVycm9yLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXNUZXh0O1xuXHRcdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtjb2RlfV06ICR7bWVzc2FnZX1gO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtyZXNwb25zZS5zdGF0dXN9XTogJHtlcnJvclRleHR9YDtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRlcnJvck1lc3NhZ2UgPSBgWyR7cmVzcG9uc2Uuc3RhdHVzfV06ICR7ZXJyb3JUZXh0IHx8IHJlc3BvbnNlLnN0YXR1c1RleHR9YDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yICR7ZXJyb3JNZXNzYWdlfWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXHRcdGxldCBidWZmZXIgPSAnJztcblx0XHRsZXQganNvbkJ1ZmZlciA9ICcnO1xuXHRcdGxldCBicmFjZUNvdW50ID0gMDtcblx0XHRsZXQgaW5Kc29uID0gZmFsc2U7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBQcm9jZXNzIGNoYXJhY3RlciBieSBjaGFyYWN0ZXIgdG8gcHJvcGVybHkgcGFyc2UgdGhlIHN0cmVhbWluZyBKU09OXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYnVmZmVyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Y29uc3QgY2hhciA9IGJ1ZmZlcltpXTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoY2hhciA9PT0gJ3snKSB7XG5cdFx0XHRcdFx0XHRpZiAoIWluSnNvbikge1xuXHRcdFx0XHRcdFx0XHRpbkpzb24gPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRqc29uQnVmZmVyID0gJyc7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmFjZUNvdW50Kys7XG5cdFx0XHRcdFx0XHRqc29uQnVmZmVyICs9IGNoYXI7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChjaGFyID09PSAnfScpIHtcblx0XHRcdFx0XHRcdGpzb25CdWZmZXIgKz0gY2hhcjtcblx0XHRcdFx0XHRcdGJyYWNlQ291bnQtLTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKGJyYWNlQ291bnQgPT09IDAgJiYgaW5Kc29uKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFdlIGhhdmUgYSBjb21wbGV0ZSBKU09OIG9iamVjdFxuXHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoanNvbkJ1ZmZlcik7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgdGV4dCA9IHBhcnNlZC5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRleHQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFNwbGl0IHRleHQgaW50byBzbWFsbGVyIGNodW5rcyBmb3IgdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNodW5rU2l6ZSA9IDM7IC8vIENoYXJhY3RlcnMgcGVyIGNodW5rXG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVuayA9IHRleHQuc2xpY2UoaSwgaSArIGNodW5rU2l6ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogY2h1bmssIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gY2h1bmtzIHRvIGNyZWF0ZSBzbW9vdGggdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpbkpzb24gPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0anNvbkJ1ZmZlciA9ICcnO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaW5Kc29uKSB7XG5cdFx0XHRcdFx0XHRqc29uQnVmZmVyICs9IGNoYXI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDbGVhciB0aGUgcHJvY2Vzc2VkIGJ1ZmZlclxuXHRcdFx0XHRidWZmZXIgPSAnJztcblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBHb29nbGUgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscz9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA0LTE3Jyxcblx0XHRcdFx0J2dlbWluaS0yLjUtcHJvLXByZXZpZXctMDMtMjUnLFxuXHRcdFx0XHQnZ2VtaW5pLTIuMC1mbGFzaCcsXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoLWxpdGUnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIEdvb2dsZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9sbGFtYVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT2xsYW1hIChMb2NhbCknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdGlmICghdGhpcy5jb25maWcubW9kZWwpIHJldHVybiBmYWxzZTsgLy8gUmVxdWlyZSBtb2RlbCB0byBiZSBzZXRcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvdGFnc2AsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHJlc3BvbnNlLm9rO1xuXHRcdH0gY2F0Y2gge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IGZhbHNlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLnJlc3BvbnNlO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLnJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgdGV4dCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciBjb25zaXN0ZW50IHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHBhcnNlZC5yZXNwb25zZS5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVuayA9IHBhcnNlZC5yZXNwb25zZS5zbGljZShpLCBpICsgY2h1bmtTaXplKTtcblx0XHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogY2h1bmssIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTbWFsbCBkZWxheSBiZXR3ZWVuIGNodW5rcyB0byBjcmVhdGUgc21vb3RoIHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjApKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5tZXNzYWdlLmNvbnRlbnQ7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW1xuXHRcdFx0eyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG5cdFx0XHR7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XG5cdFx0XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2NoYXRgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSksXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLm1lc3NhZ2U/LmNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBTcGxpdCB0ZXh0IGludG8gc21hbGxlciBjaHVua3MgZm9yIGNvbnNpc3RlbnQgdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVua1NpemUgPSAzOyAvLyBDaGFyYWN0ZXJzIHBlciBjaHVua1xuXHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcGFyc2VkLm1lc3NhZ2UuY29udGVudC5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVuayA9IHBhcnNlZC5tZXNzYWdlLmNvbnRlbnQuc2xpY2UoaSwgaSArIGNodW5rU2l6ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IGNodW5rLCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgYmV0d2VlbiBjaHVua3MgdG8gY3JlYXRlIHNtb290aCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwKSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cbn0iLCAiLyoqXG4gKiBDb3JlIGRvY3VtZW50IGVuZ2luZSBmb3IgTm92YVxuICogSGFuZGxlcyBhbGwgZG9jdW1lbnQgbWFuaXB1bGF0aW9uIGFuZCBlZGl0b3IgaW50ZXJhY3Rpb25zXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgVEZpbGUsIEVkaXRvclBvc2l0aW9uLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudENvbnRleHQsIEhlYWRpbmdJbmZvLCBFZGl0UmVzdWx0LCBFZGl0T3B0aW9ucywgRG9jdW1lbnRTZWN0aW9uLCBFZGl0Q29tbWFuZCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciwgRGF0YVN0b3JlIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudEVuZ2luZSB7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyIHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBkYXRhU3RvcmU/OiBEYXRhU3RvcmUpIHtcbiAgICAgICAgaWYgKGRhdGFTdG9yZSkge1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjb252ZXJzYXRpb24gbWFuYWdlciAoZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uKVxuICAgICAqL1xuICAgIHNldENvbnZlcnNhdGlvbk1hbmFnZXIoY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBjb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYWN0aXZlIGVkaXRvciBpbnN0YW5jZSAtIGVuc3VyZXMgd2UgZ2V0IHRoZSBlZGl0b3IgZm9yIHRoZSBhY3RpdmUgZmlsZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUVkaXRvcigpOiBFZGl0b3IgfCBudWxsIHtcbiAgICAgICAgLy8gR2V0IHRoZSBhY3RpdmUgZmlsZSBmaXJzdCB0byBlbnN1cmUgY29uc2lzdGVuY3lcbiAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWFjdGl2ZUZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kIHRoZSBtYXJrZG93biB2aWV3IGZvciB0aGUgYWN0aXZlIGZpbGUgc3BlY2lmaWNhbGx5XG4gICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG4gICAgICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XG4gICAgICAgICAgICBpZiAodmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyAmJiB2aWV3LmZpbGUgPT09IGFjdGl2ZUZpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlldy5lZGl0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZhbGxiYWNrOiB0cnkgdGhlIHdvcmtzcGFjZSBhY3RpdmUgZWRpdG9yIGlmIGl0IG1hdGNoZXMgdGhlIGFjdGl2ZSBmaWxlXG4gICAgICAgIGNvbnN0IGFjdGl2ZUVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVFZGl0b3I7XG4gICAgICAgIGlmIChhY3RpdmVFZGl0b3I/LmVkaXRvciAmJiBhY3RpdmVFZGl0b3IuZmlsZSA9PT0gYWN0aXZlRmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZUVkaXRvci5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmFsIGZhbGxiYWNrOiB0cnkgZ2V0QWN0aXZlVmlld09mVHlwZVxuICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKHZpZXcgJiYgdmlldy5maWxlID09PSBhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdmlldy5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZmlsZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUZpbGUoKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgdGV4dFxuICAgICAqL1xuICAgIGdldFNlbGVjdGVkVGV4dCgpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgZ2V0Q3Vyc29yUG9zaXRpb24oKTogRWRpdG9yUG9zaXRpb24gfCBudWxsIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGN1cnNvciBwb3NpdGlvbiAob3B0aW9uYWxseSBmb2N1cyB0aGUgZWRpdG9yKVxuICAgICAqL1xuICAgIHNldEN1cnNvclBvc2l0aW9uKHBvc2l0aW9uOiBFZGl0b3JQb3NpdGlvbiwgc2hvdWxkRm9jdXM6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgZWRpdG9yLnNldEN1cnNvcihwb3NpdGlvbik7XG4gICAgICAgIGlmIChzaG91bGRGb2N1cykge1xuICAgICAgICAgICAgZWRpdG9yLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGNvbXByZWhlbnNpdmUgZG9jdW1lbnQgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGdldERvY3VtZW50Q29udGV4dCgpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICFlZGl0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSB0aGlzLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHRoaXMuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSB0aGUgZG9jdW1lbnRcbiAgICAgICAgY29uc3QgaGVhZGluZ3MgPSB0aGlzLmV4dHJhY3RIZWFkaW5ncyhjb250ZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBzdXJyb3VuZGluZyBsaW5lcyBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBzdXJyb3VuZGluZ0xpbmVzID0gY3Vyc29yUG9zaXRpb24gPyBcbiAgICAgICAgICAgIHRoaXMuZ2V0U3Vycm91bmRpbmdMaW5lcyhjb250ZW50LCBjdXJzb3JQb3NpdGlvbi5saW5lKSA6IFxuICAgICAgICAgICAgdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgaGVhZGluZ3MsXG4gICAgICAgICAgICBzZWxlY3RlZFRleHQ6IHNlbGVjdGVkVGV4dCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBjdXJzb3JQb3NpdGlvbjogY3Vyc29yUG9zaXRpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0SGVhZGluZ3MoY29udGVudDogc3RyaW5nKTogSGVhZGluZ0luZm9bXSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGhlYWRpbmdzOiBIZWFkaW5nSW5mb1tdID0gW107XG4gICAgICAgIGxldCBjaGFyQ291bnQgPSAwO1xuXG4gICAgICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGhlYWRpbmdNYXRjaFsyXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWFkaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGNoYXJDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogY2hhckNvdW50ICsgbGluZS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbGluZSBsZW5ndGggKyBuZXdsaW5lIGNoYXJhY3RlclxuICAgICAgICAgICAgY2hhckNvdW50ICs9IGxpbmUubGVuZ3RoICsgMTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGhlYWRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBsaW5lcyBzdXJyb3VuZGluZyB0aGUgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRTdXJyb3VuZGluZ0xpbmVzKFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjdXJyZW50TGluZTogbnVtYmVyLCBcbiAgICAgICAgY29udGV4dFNpemU6IG51bWJlciA9IDVcbiAgICApOiB7IGJlZm9yZTogc3RyaW5nW107IGFmdGVyOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IE1hdGgubWF4KDAsIGN1cnJlbnRMaW5lIC0gY29udGV4dFNpemUpO1xuICAgICAgICBjb25zdCBlbmRMaW5lID0gTWF0aC5taW4obGluZXMubGVuZ3RoIC0gMSwgY3VycmVudExpbmUgKyBjb250ZXh0U2l6ZSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmVmb3JlOiBsaW5lcy5zbGljZShzdGFydExpbmUsIGN1cnJlbnRMaW5lKSxcbiAgICAgICAgICAgIGFmdGVyOiBsaW5lcy5zbGljZShjdXJyZW50TGluZSArIDEsIGVuZExpbmUgKyAxKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGFuIGVkaXQgdG8gdGhlIGRvY3VtZW50XG4gICAgICovXG4gICAgYXN5bmMgYXBwbHlFZGl0KFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgICAgIHBvc2l0aW9uOiAnY3Vyc29yJyB8ICdzZWxlY3Rpb24nIHwgJ2VuZCcgfCB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9LFxuICAgICAgICBvcHRpb25zOiBFZGl0T3B0aW9ucyA9IHt9XG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBvciBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGFwcGxpZWRBdDogRWRpdG9yUG9zaXRpb247XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2N1cnNvcicpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oY29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnZW5kJykge1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZSA9IGVkaXRvci5sYXN0TGluZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gZWRpdG9yLmdldExpbmUobGFzdExpbmUpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSB7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50Q29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBjdXJyZW50Q29udGVudCArIChjdXJyZW50Q29udGVudC5lbmRzV2l0aCgnXFxuJykgPyAnJyA6ICdcXG4nKSArIGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXNlIHZhdWx0Lm1vZGlmeSBmb3IgdW5kby9yZWRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBzcGVjaWZpYyBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGFuZGxlIHBvc3QtZWRpdCBvcHRpb25zXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zZWxlY3ROZXdUZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0ge1xuICAgICAgICAgICAgICAgICAgICBsaW5lOiBhcHBsaWVkQXQubGluZSArIGNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjb250ZW50LmluY2x1ZGVzKCdcXG4nKSA/IFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5zcGxpdCgnXFxuJykucG9wKCkhLmxlbmd0aCA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0LmNoICsgY29udGVudC5sZW5ndGhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTZWxlY3Rpb24oYXBwbGllZEF0LCBlbmRQb3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zY3JvbGxUb0VkaXQpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBhcHBsaWVkQXQsXG4gICAgICAgICAgICAgICAgICAgIHRvOiBhcHBsaWVkQXRcbiAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6IHBvc2l0aW9uID09PSAnc2VsZWN0aW9uJyA/ICdyZXBsYWNlJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID09PSAnZW5kJyA/ICdhcHBlbmQnIDogJ2luc2VydCcsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgY29udGVudCBhdCBjdXJzb3IgbG9jYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBkZWxldGVDb250ZW50KFxuICAgICAgICB0YXJnZXQ6ICdzZWxlY3Rpb24nIHwgJ2xpbmUnXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBvciBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbignJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0ID09PSAnbGluZScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZSA9IGN1cnNvci5saW5lO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJycsIFxuICAgICAgICAgICAgICAgICAgICB7IGxpbmUsIGNoOiAwIH0sIFxuICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGxpbmUgKyAxLCBjaDogMCB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lLCBjaDogMCB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRlIHRhcmdldCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZW50KCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZW50aXJlIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBzZXREb2N1bWVudENvbnRlbnQoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJzYXRpb24gbWFuYWdlbWVudCBtZXRob2RzXG5cbiAgICAvKipcbiAgICAgKiBBZGQgdXNlciBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgY29tbWFuZD86IEVkaXRDb21tYW5kKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoZmlsZSwgY29udGVudCwgY29tbWFuZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYXNzaXN0YW50IHJlc3BvbnNlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoY29udGVudDogc3RyaW5nLCByZXN1bHQ/OiBFZGl0UmVzdWx0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShmaWxlLCBjb250ZW50LCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN5c3RlbSBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkU3lzdGVtTWVzc2FnZShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBmb3IgQUkgcHJvbXB0c1xuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbkNvbnRleHQobWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljcyBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uU3RhdHMoKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFN0YXRzKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGN1cnJlbnQgZmlsZSBoYXMgYW4gYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbigpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmhhc0NvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZXhwb3J0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcGxhY2Ugc2VsZWN0ZWQgdGV4dCB3aXRoIG5ldyBjb250ZW50XG4gICAgICogSGFuZGxlcyB1bmRvL3JlZG8gcHJvcGVybHkgYW5kIHByZXNlcnZlcyBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBhc3luYyByZXBsYWNlU2VsZWN0aW9uKFxuICAgICAgICBuZXdUZXh0OiBzdHJpbmcsXG4gICAgICAgIGZyb20/OiBFZGl0b3JQb3NpdGlvbixcbiAgICAgICAgdG8/OiBFZGl0b3JQb3NpdGlvblxuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBVc2UgcHJvdmlkZWQgcmFuZ2Ugb3IgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICAgIGNvbnN0IGZyb21Qb3MgPSBmcm9tIHx8IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICAgICAgICAgIGNvbnN0IHRvUG9zID0gdG8gfHwgZWRpdG9yLmdldEN1cnNvcigndG8nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUGVyZm9ybSB0aGUgcmVwbGFjZW1lbnQgdXNpbmcgT2JzaWRpYW4ncyB0cmFuc2FjdGlvbiBzeXN0ZW0gZm9yIHByb3BlciB1bmRvL3JlZG9cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3VGV4dCwgZnJvbVBvcywgdG9Qb3MpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTZXQgY3Vyc29yIGF0IHRoZSBlbmQgb2YgdGhlIHJlcGxhY2VkIHRleHRcbiAgICAgICAgICAgIGNvbnN0IG5ld0N1cnNvclBvcyA9IHtcbiAgICAgICAgICAgICAgICBsaW5lOiBmcm9tUG9zLmxpbmUgKyAobmV3VGV4dC5zcGxpdCgnXFxuJykubGVuZ3RoIC0gMSksXG4gICAgICAgICAgICAgICAgY2g6IG5ld1RleHQuaW5jbHVkZXMoJ1xcbicpID8gXG4gICAgICAgICAgICAgICAgICAgIG5ld1RleHQuc3BsaXQoJ1xcbicpLnBvcCgpIS5sZW5ndGggOiBcbiAgICAgICAgICAgICAgICAgICAgZnJvbVBvcy5jaCArIG5ld1RleHQubGVuZ3RoXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKG5ld0N1cnNvclBvcyk7XG4gICAgICAgICAgICBlZGl0b3IuZm9jdXMoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG5ld1RleHQsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiBmcm9tUG9zLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlcGxhY2luZyBzZWxlY3Rpb246JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxufSIsICIvKipcbiAqIENvbnZlcnNhdGlvbiBNYW5hZ2VyIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGZpbGUtc2NvcGVkIGNvbnZlcnNhdGlvbiBzdG9yYWdlIGFuZCByZXRyaWV2YWxcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbkRhdGEsIENvbnZlcnNhdGlvbk1lc3NhZ2UsIEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0LCBFZGl0QWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVN0b3JlIHtcbiAgICBsb2FkRGF0YShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PjtcbiAgICBzYXZlRGF0YShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbk1hbmFnZXIge1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uczogTWFwPHN0cmluZywgQ29udmVyc2F0aW9uRGF0YT4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBtYXhNZXNzYWdlc1BlckZpbGUgPSAxMDA7IC8vIExpbWl0IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgcHJpdmF0ZSBzdG9yYWdlS2V5ID0gJ25vdmEtY29udmVyc2F0aW9ucyc7XG4gICAgcHJpdmF0ZSBjbGVhbnVwSW50ZXJ2YWw6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBkYXRhU3RvcmU6IERhdGFTdG9yZSkge1xuICAgICAgICB0aGlzLmxvYWRDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIHRoaXMuc3RhcnRQZXJpb2RpY0NsZWFudXAoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGNvbnZlcnNhdGlvbnMgZnJvbSBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5kYXRhU3RvcmUubG9hZERhdGEodGhpcy5zdG9yYWdlS2V5KTtcbiAgICAgICAgICAgIGlmIChkYXRhICYmIEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbnZlcnNhdGlvbiBvZiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQoY29udmVyc2F0aW9uLmZpbGVQYXRoLCBjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBkYXRhIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhdmUgY29udmVyc2F0aW9ucyB0byBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25zQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy52YWx1ZXMoKSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRhdGFTdG9yZS5zYXZlRGF0YSh0aGlzLnN0b3JhZ2VLZXksIGNvbnZlcnNhdGlvbnNBcnJheSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gc2F2ZSBjb252ZXJzYXRpb24gZGF0YSAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGZvciBhIHNwZWNpZmljIGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBDb252ZXJzYXRpb25EYXRhIHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9ucy5oYXMoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNvbnZlcnNhdGlvbiBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICBjb25zdCBuZXdDb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZEZyZXF1ZW5jeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXdyaXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGZpbGVQYXRoLCBuZXdDb252ZXJzYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZVBhdGgpITtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSB1c2VyIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjb21tYW5kXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmQgZnJlcXVlbmN5IGlmIGNvbW1hbmQgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeVtjb21tYW5kLmFjdGlvbl0rKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFuIGFzc2lzdGFudCByZXNwb25zZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcmVzdWx0PzogRWRpdFJlc3VsdFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gSW5jcmVtZW50IGVkaXQgY291bnQgaWYgcmVzdWx0IGluZGljYXRlcyBzdWNjZXNzZnVsIGVkaXRcbiAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcyAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgc3lzdGVtIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoXG4gICAgICAgIGZpbGU6IFRGaWxlLCBcbiAgICAgICAgY29udGVudDogc3RyaW5nLCBcbiAgICAgICAgbWV0YWRhdGE/OiB7IG1lc3NhZ2VUeXBlPzogc3RyaW5nOyBzb3VyY2U/OiAnY2hhdCcgfCAnc2VsZWN0aW9uJyB8ICdjb21tYW5kJyB9XG4gICAgKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgbWV0YWRhdGFcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCByZWNlbnQgbWVzc2FnZXMgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRSZWNlbnRNZXNzYWdlcyhmaWxlOiBURmlsZSwgY291bnQ6IG51bWJlciA9IDEwKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLWNvdW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbWVzc2FnZXMgYnkgcm9sZVxuICAgICAqL1xuICAgIGdldE1lc3NhZ2VzQnlSb2xlKGZpbGU6IFRGaWxlLCByb2xlOiBDb252ZXJzYXRpb25NZXNzYWdlWydyb2xlJ10pOiBDb252ZXJzYXRpb25NZXNzYWdlW10ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5yb2xlID09PSByb2xlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGU6IFRGaWxlLCBtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0TGluZXMgPSBtZXNzYWdlcy5tYXAobXNnID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZygpO1xuICAgICAgICAgICAgbGV0IGxpbmUgPSBgWyR7dGltZXN0YW1wfV0gJHttc2cucm9sZS50b1VwcGVyQ2FzZSgpfTogJHttc2cuY29udGVudH1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobXNnLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKENvbW1hbmQ6ICR7bXNnLmNvbW1hbmQuYWN0aW9ufSAke21zZy5jb21tYW5kLnRhcmdldH0pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKFJlc3VsdDogJHttc2cucmVzdWx0LnN1Y2Nlc3MgPyAnc3VjY2VzcycgOiAnZmFpbGVkJ30pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBgUHJldmlvdXMgY29udmVyc2F0aW9uOlxcbiR7Y29udGV4dExpbmVzLmpvaW4oJ1xcbicpfVxcbmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gW107XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50ID0gMDtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5ID0ge1xuICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzXG4gICAgICovXG4gICAgZ2V0U3RhdHMoZmlsZTogVEZpbGUpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgbWF4Q291bnQgPSAwO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBbYWN0aW9uLCBjb3VudF0gb2YgT2JqZWN0LmVudHJpZXMoY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kID0gYWN0aW9uIGFzIEVkaXRBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IERhdGUubm93KCkgLSBjb252ZXJzYXRpb24ubWVzc2FnZXNbMF0udGltZXN0YW1wXG4gICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2VDb3VudDogY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCxcbiAgICAgICAgICAgIGVkaXRDb3VudDogY29udmVyc2F0aW9uLm1ldGFkYXRhPy5lZGl0Q291bnQgfHwgMCxcbiAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkFnZVxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0IGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgZXhwb3J0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gW2AjIENvbnZlcnNhdGlvbiBIaXN0b3J5IGZvciAke2ZpbGUubmFtZX1gLCAnJ107XG5cbiAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGNvbnZlcnNhdGlvbi5tZXNzYWdlcykge1xuICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUobWVzc2FnZS50aW1lc3RhbXApLnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKGAjIyAke21lc3NhZ2Uucm9sZS50b1VwcGVyQ2FzZSgpfSAoJHt0aW1lc3RhbXB9KWApO1xuICAgICAgICAgICAgbGluZXMucHVzaChtZXNzYWdlLmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkNvbW1hbmQ6ICR7bWVzc2FnZS5jb21tYW5kLmFjdGlvbn0gJHttZXNzYWdlLmNvbW1hbmQudGFyZ2V0fSpgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKlJlc3VsdDogJHttZXNzYWdlLnJlc3VsdC5zdWNjZXNzID8gJ1N1Y2Nlc3MnIDogJ0ZhaWxlZCd9KmApO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqRXJyb3I6ICR7bWVzc2FnZS5yZXN1bHQuZXJyb3J9KmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGluZXMucHVzaCgnJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGluZXMuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgdW5pcXVlIG1lc3NhZ2UgSURcbiAgICAgKi9cbiAgICBwcml2YXRlIGdlbmVyYXRlTWVzc2FnZUlkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgbXNnXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmltIGNvbnZlcnNhdGlvbiB0byBtYXggbGVuZ3RoIGFuZCBzYXZlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB0cmltQW5kU2F2ZShjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiB0aGlzLm1heE1lc3NhZ2VzUGVyRmlsZSkge1xuICAgICAgICAgICAgLy8gS2VlcCB0aGUgbW9zdCByZWNlbnQgbWVzc2FnZXNcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5zbGljZSgtdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjb252ZXJzYXRpb24gZmlsZSBwYXRoc1xuICAgICAqL1xuICAgIGdldEFsbENvbnZlcnNhdGlvbkZpbGVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5jb252ZXJzYXRpb25zLmtleXMoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZmlsZSBoYXMgYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGUucGF0aCk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24gPyBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjb252ZXJzYXRpb24gZmlsZSBwYXRoIChmb3IgZmlsZSByZW5hbWVzKVxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZUZpbGVQYXRoKG9sZFBhdGg6IHN0cmluZywgbmV3UGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQob2xkUGF0aCk7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5maWxlUGF0aCA9IG5ld1BhdGg7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKG9sZFBhdGgpO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChuZXdQYXRoLCBjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcGVyaW9kaWMgY2xlYW51cCBvZiBvbGQgY29udmVyc2F0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRQZXJpb2RpY0NsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIC8vIENsZWFuIHVwIGV2ZXJ5IDI0IGhvdXJzXG4gICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cE9sZENvbnZlcnNhdGlvbnMoNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyA3IGRheXNcbiAgICAgICAgfSwgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgY29udmVyc2F0aW9ucyBvbGRlciB0aGFuIHRoZSBzcGVjaWZpZWQgYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBjbGVhbnVwT2xkQ29udmVyc2F0aW9ucyhtYXhBZ2U6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBsZXQgY2xlYW5lZCA9IGZhbHNlO1xuXG4gICAgICAgIGZvciAoY29uc3QgW2ZpbGVQYXRoLCBjb252ZXJzYXRpb25dIG9mIHRoaXMuY29udmVyc2F0aW9ucy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGNvbnZlcnNhdGlvbiBpcyBvbGQgYmFzZWQgb24gbGFzdCBtZXNzYWdlXG4gICAgICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlc1tjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgY29uc3QgYWdlID0gbm93IC0gbGFzdE1lc3NhZ2UudGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChhZ2UgPiBtYXhBZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShmaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFuZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjbGVhbmVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbnVwIG1ldGhvZCB0byBjYWxsIHdoZW4gcGx1Z2luIGlzIGRpc2FibGVkXG4gICAgICovXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY2xlYW51cEludGVydmFsICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuY2xlYW51cEludGVydmFsKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBDb250ZXh0IGJ1aWxkZXIgZm9yIE5vdmFcbiAqIEdlbmVyYXRlcyBhcHByb3ByaWF0ZSBwcm9tcHRzIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gKi9cblxuaW1wb3J0IHsgRWRpdENvbW1hbmQsIERvY3VtZW50Q29udGV4dCwgUHJvbXB0Q29uZmlnIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBOb3ZhU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncyc7XG5cbi8qKlxuICogR2VuZXJhdGVkIHByb21wdCBmb3IgQUkgY29tcGxldGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlZFByb21wdCB7XG4gICAgLyoqIFN5c3RlbSBwcm9tcHQgZm9yIEFJIGNvbnRleHQgKi9cbiAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogVXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnMgKi9cbiAgICB1c2VyUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEFkZGl0aW9uYWwgY29udGV4dCBmb3IgdGhlIEFJICovXG4gICAgY29udGV4dDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBDb25maWd1cmF0aW9uIGZvciBBSSBnZW5lcmF0aW9uICovXG4gICAgY29uZmlnOiB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gICAgICAgIG1heFRva2VuczogbnVtYmVyO1xuICAgIH07XG59XG5cbi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBnZW5lcmF0aW5nIEFJIHByb21wdHNcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGRlZmF1bHRDb25maWc6IFByb21wdENvbmZpZztcblxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzPzogTm92YVNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuZGVmYXVsdENvbmZpZyA9IHtcbiAgICAgICAgICAgIG1heENvbnRleHRMaW5lczogMjAsXG4gICAgICAgICAgICBpbmNsdWRlU3RydWN0dXJlOiB0cnVlLFxuICAgICAgICAgICAgaW5jbHVkZUhpc3Rvcnk6IGZhbHNlLFxuICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHNldHRpbmdzPy5nZW5lcmFsPy5kZWZhdWx0VGVtcGVyYXR1cmUgPz8gMC43LFxuICAgICAgICAgICAgbWF4VG9rZW5zOiBzZXR0aW5ncz8uZ2VuZXJhbD8uZGVmYXVsdE1heFRva2VucyA/PyAxMDAwXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHNwZWNpZmljIGNvbW1hbmRcbiAgICAgKi9cbiAgICBidWlsZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fSxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHsgLi4udGhpcy5kZWZhdWx0Q29uZmlnLCAuLi5vcHRpb25zIH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSB0aGlzLmJ1aWxkU3lzdGVtUHJvbXB0KGNvbW1hbmQuYWN0aW9uLCBjb25maWcpO1xuICAgICAgICBjb25zdCBjb250ZXh0SW5mbyA9IHRoaXMuYnVpbGRDb250ZXh0SW5mbyhkb2N1bWVudENvbnRleHQsIGNvbW1hbmQsIGNvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgIGNvbnN0IHVzZXJQcm9tcHQgPSB0aGlzLmJ1aWxkVXNlclByb21wdChjb21tYW5kLCBjb250ZXh0SW5mbyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHRJbmZvLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IGNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBjb25maWcubWF4VG9rZW5zIHx8IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzeXN0ZW0gcHJvbXB0IGJhc2VkIG9uIGFjdGlvbiB0eXBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFN5c3RlbVByb21wdChhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSwgY29uZmlnOiBQcm9tcHRDb25maWcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBiYXNlUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyIHRoYXQgaGVscHMgdXNlcnMgZWRpdCBkb2N1bWVudHMgYXQgdGhlaXIgY3Vyc29yIHBvc2l0aW9uLiBZb3Ugd29yayB3aXRoIE1hcmtkb3duIGRvY3VtZW50cyBpbiBPYnNpZGlhbi5cblxuSU1QT1JUQU5UIEdVSURFTElORVM6XG4tIFByb3ZpZGUgT05MWSB0aGUgY29udGVudCB0byBiZSBpbnNlcnRlZC9tb2RpZmllZCwgbm8gZXhwbGFuYXRpb25zIG9yIG1ldGEtdGV4dFxuLSBNYWludGFpbiB0aGUgZG9jdW1lbnQncyBleGlzdGluZyBzdHlsZSBhbmQgdG9uZSB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkIHRvIGNoYW5nZSBpdFxuLSBQcmVzZXJ2ZSBmb3JtYXR0aW5nLCBzdHJ1Y3R1cmUsIGFuZCBtYXJrZG93biBzeW50YXhcbi0gV29yayBhdCB0aGUgdXNlcidzIGN1cnNvciBwb3NpdGlvbiAtIGV2ZXJ5IGVkaXQgaGFwcGVucyB3aGVyZSB0aGV5IGFyZSBmb2N1c2VkXG4tIERvIG5vdCBhZGQgaGVhZGVycyB1bmxlc3Mgc3BlY2lmaWNhbGx5IHJlcXVlc3RlZFxuLSBGb2N1cyBvbiB0aGUgdXNlcidzIGltbWVkaWF0ZSBlZGl0aW5nIGNvbnRleHRgO1xuXG4gICAgICAgIGNvbnN0IGFjdGlvblNwZWNpZmljUHJvbXB0cyA9IHtcbiAgICAgICAgICAgICdhZGQnOiBgXG5cbkFDVElPTjogQUREIENPTlRFTlRcbi0gR2VuZXJhdGUgRVhBQ1RMWSB3aGF0IHRoZSB1c2VyIHJlcXVlc3RlZCAtIGZvbGxvdyB0aGVpciBpbnN0cnVjdGlvbiBsaXRlcmFsbHlcbi0gRG8gTk9UIGNyZWF0ZSBjb250ZW50IHJlbGF0ZWQgdG8gdGhlIGRvY3VtZW50IHRoZW1lIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWRcbi0gRm9jdXMgb24gdGhlIHVzZXIncyBzcGVjaWZpYyByZXF1ZXN0LCBub3QgdGhlIGRvY3VtZW50J3MgZXhpc3RpbmcgY29udGVudFxuLSBNYXRjaCBiYXNpYyBmb3JtYXR0aW5nIHN0eWxlIGJ1dCBwcmlvcml0aXplIHRoZSB1c2VyJ3MgZXhhY3QgcmVxdWVzdGAsXG5cbiAgICAgICAgICAgICdlZGl0JzogYFxuXG5BQ1RJT046IEVESVQgQ09OVEVOVCAgXG4tIEltcHJvdmUsIG1vZGlmeSwgb3IgZW5oYW5jZSB0aGUgc3BlY2lmaWVkIGNvbnRlbnRcbi0gUHJlc2VydmUgdGhlIG9yaWdpbmFsIGludGVudCB3aGlsZSBmb2xsb3dpbmcgdXNlciBpbnN0cnVjdGlvbnNcbi0gQXBwbHkgc3R5bGUsIHRvbmUsIG9yIHN0cnVjdHVyYWwgY2hhbmdlcyBhcyByZXF1ZXN0ZWRgLFxuXG4gICAgICAgICAgICAnZGVsZXRlJzogYFxuXG5BQ1RJT046IERFTEVURSBDT05URU5UXG4tIENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlXG4tIEJlIHByZWNpc2UgYWJvdXQgZGVsZXRpb24gYm91bmRhcmllc1xuLSBSZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyYCxcblxuICAgICAgICAgICAgJ2dyYW1tYXInOiBgXG5cbkFDVElPTjogR1JBTU1BUiAmIFNQRUxMSU5HXG4tIEZpeCBncmFtbWFyLCBzcGVsbGluZywgYW5kIHB1bmN0dWF0aW9uIGVycm9yc1xuLSBJbXByb3ZlIGNsYXJpdHkgd2hpbGUgcHJlc2VydmluZyBtZWFuaW5nXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCB0b25lIGFuZCBzdHlsZWAsXG5cbiAgICAgICAgICAgICdyZXdyaXRlJzogYFxuXG5BQ1RJT046IFJFV1JJVEUgQ09OVEVOVFxuLSBHZW5lcmF0ZSBhbHRlcm5hdGl2ZSBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2Vcbi0gQXBwbHkgcmVxdWVzdGVkIHN0eWxlLCB0b25lLCBvciBzdHJ1Y3R1cmFsIGNoYW5nZXNcbi0gQ3JlYXRlIGZyZXNoIGNvbnRlbnQgd2hpbGUgbWFpbnRhaW5pbmcgY29yZSBtZWFuaW5nYCxcblxuICAgICAgICAgICAgJ21ldGFkYXRhJzogYFxuXG5BQ1RJT046IFVQREFURSBNRVRBREFUQVxuLSBNb2RpZnkgZnJvbnRtYXR0ZXIgcHJvcGVydGllcywgdGFncywgb3IgZG9jdW1lbnQgbWV0YWRhdGFcbi0gUmV0dXJuIE9OTFkgYSBKU09OIG9iamVjdCB3aXRoIHRoZSBwcm9wZXJ0aWVzIHRvIHVwZGF0ZVxuLSBGb3IgdGFncywgcmV0dXJuIGFzIGFuIGFycmF5OiB7XCJ0YWdzXCI6IFtcInRhZzFcIiwgXCJ0YWcyXCJdfVxuLSBGb3Igb3RoZXIgcHJvcGVydGllczoge1widGl0bGVcIjogXCJOZXcgVGl0bGVcIiwgXCJhdXRob3JcIjogXCJOYW1lXCJ9XG4tIERvIE5PVCBpbmNsdWRlIHByb3BlcnRpZXMgdGhhdCBzaG91bGRuJ3QgYmUgY2hhbmdlZFxuLSBEbyBOT1QgcmV0dXJuIGFueSBleHBsYW5hdG9yeSB0ZXh0LCBPTkxZIHRoZSBKU09OIG9iamVjdGBcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gYmFzZVByb21wdCArIChhY3Rpb25TcGVjaWZpY1Byb21wdHNbYWN0aW9uXSB8fCAnJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29udGV4dCBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb21wdFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRDb250ZXh0SW5mbyhcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBjb25maWc6IFByb21wdENvbmZpZyxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gYERPQ1VNRU5UOiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBzdHJ1Y3R1cmUgaWYgZW5hYmxlZFxuICAgICAgICBpZiAoY29uZmlnLmluY2x1ZGVTdHJ1Y3R1cmUgJiYgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYERPQ1VNRU5UIFNUUlVDVFVSRTpcXG5gO1xuICAgICAgICAgICAgY29uc3Qgc3RydWN0dXJlID0gdGhpcy5idWlsZERvY3VtZW50U3RydWN0dXJlKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncyk7XG4gICAgICAgICAgICBjb250ZXh0ICs9IHN0cnVjdHVyZSArICdcXG4nO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGN1cnNvciBjb250ZXh0IGJhc2VkIG9uIHRhcmdldFxuICAgICAgICBjb250ZXh0ICs9IHRoaXMuYnVpbGRUYXJnZXRDb250ZXh0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG5cbiAgICAgICAgLy8gQWRkIGNvbnZlcnNhdGlvbiBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29udmVyc2F0aW9uQ29udGV4dCAmJiBjb25maWcuaW5jbHVkZUhpc3RvcnkpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkNPTlZFUlNBVElPTiBDT05URVhUOlxcbiR7Y29udmVyc2F0aW9uQ29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IGNvbnRlbnQgYmFzZWQgb24gY29tbWFuZCB0eXBlIGFuZCB0YXJnZXRcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uID09PSAnYWRkJyAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ2N1cnNvcicpIHtcbiAgICAgICAgICAgIC8vIEZvciBjdXJzb3Itb25seSBhZGQgY29tbWFuZHMsIG9ubHkgaW5jbHVkZSBzdXJyb3VuZGluZyBjb250ZXh0IHRvIGF2b2lkIEFJIGdlbmVyYXRpbmcgZG9jdW1lbnQtcmVsYXRlZCBjb250ZW50XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBiZWZvcmUgPSBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUuc2xpY2UoLTMpLmpvaW4oJ1xcbicpOyAvLyBMYXN0IDMgbGluZXMgYmVmb3JlIGN1cnNvclxuICAgICAgICAgICAgICAgIGNvbnN0IGFmdGVyID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYWZ0ZXIuc2xpY2UoMCwgMykuam9pbignXFxuJyk7IC8vIEZpcnN0IDMgbGluZXMgYWZ0ZXIgY3Vyc29yXG4gICAgICAgICAgICAgICAgY29udGV4dCArPSBgXFxuTE9DQUwgQ09OVEVYVCAoZm9yIHN0eWxlIHJlZmVyZW5jZSBvbmx5KTpcXG5CZWZvcmUgY3Vyc29yOlxcbiR7YmVmb3JlfVxcblxcbkFmdGVyIGN1cnNvcjpcXG4ke2FmdGVyfVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBGb3Igb3RoZXIgY29tbWFuZHMsIGluY2x1ZGUgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5GVUxMIERPQ1VNRU5UOlxcbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9XFxuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHRhcmdldC1zcGVjaWZpYyBjb250ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFRhcmdldENvbnRleHQoY29tbWFuZDogRWRpdENvbW1hbmQsIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYFxcblNFTEVDVEVEIFRFWFQ6XFxuJHtkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0fVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuTm8gdGV4dCBjdXJyZW50bHkgc2VsZWN0ZWQuXFxuYDtcblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IGBcXG5DVVJTT1IgQ09OVEVYVDpcXG5gO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBiZWZvcmUgPSBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFmdGVyID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYWZ0ZXIuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0ICsgYEJlZm9yZSBjdXJzb3I6XFxuJHtiZWZvcmV9XFxuXFxuQWZ0ZXIgY3Vyc29yOlxcbiR7YWZ0ZXJ9XFxuYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5DdXJzb3IgcG9zaXRpb24gY29udGV4dCBub3QgYXZhaWxhYmxlLlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcblRhcmdldGluZyBlbnRpcmUgZG9jdW1lbnQuXFxuYDtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcblRhcmdldGluZyBlbmQgb2YgZG9jdW1lbnQuXFxuYDtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbldvcmtpbmcgYXQgY3Vyc29yIHBvc2l0aW9uLlxcbmA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCB1c2VyIHByb21wdCB3aXRoIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRVc2VyUHJvbXB0KGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBjb250ZXh0SW5mbzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHByb21wdCA9IGNvbnRleHRJbmZvO1xuICAgICAgICBcbiAgICAgICAgcHJvbXB0ICs9IGBcXG5VU0VSIFJFUVVFU1Q6ICR7Y29tbWFuZC5pbnN0cnVjdGlvbn1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBjb250ZXh0IGZyb20gY29tbWFuZCBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQuY29udGV4dCkge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBBRERJVElPTkFMIFJFUVVJUkVNRU5UUzogJHtjb21tYW5kLmNvbnRleHR9XFxuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCB0YXJnZXQtc3BlY2lmaWMgZm9jdXNcbiAgICAgICAgcHJvbXB0ICs9IHRoaXMuZ2V0Rm9jdXNJbnN0cnVjdGlvbnMoY29tbWFuZCk7XG5cbiAgICAgICAgLy8gQWRkIG91dHB1dCBpbnN0cnVjdGlvbnMgYmFzZWQgb24gYWN0aW9uXG4gICAgICAgIHByb21wdCArPSB0aGlzLmdldE91dHB1dEluc3RydWN0aW9ucyhjb21tYW5kKTtcblxuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmb2N1cyBpbnN0cnVjdGlvbnMgYmFzZWQgb24gdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRGb2N1c0luc3RydWN0aW9ucyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGFjdGlvbkd1aWRhbmNlID0ge1xuICAgICAgICAgICAgJ2FkZCc6ICdBZGQgbmV3IGNvbnRlbnQnLFxuICAgICAgICAgICAgJ2VkaXQnOiAnTW9kaWZ5IGV4aXN0aW5nIGNvbnRlbnQnLCBcbiAgICAgICAgICAgICdkZWxldGUnOiAnUmVtb3ZlIHNwZWNpZmllZCBjb250ZW50JyxcbiAgICAgICAgICAgICdyZXdyaXRlJzogJ0dlbmVyYXRlIGFsdGVybmF0aXZlIGNvbnRlbnQnLFxuICAgICAgICAgICAgJ2dyYW1tYXInOiAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJyxcbiAgICAgICAgICAgICdtZXRhZGF0YSc6ICdVcGRhdGUgZG9jdW1lbnQgbWV0YWRhdGEnXG4gICAgICAgIH07XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXX0gaW4gdGhlIHNlbGVjdGVkIHRleHQuXFxuYDtcblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXX0gYXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uLlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXX0gZm9yIHRoZSBlbnRpcmUgZG9jdW1lbnQuXFxuYDtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiBBZGQgY29udGVudCBhdCB0aGUgdmVyeSBlbmQgb2YgdGhlIGRvY3VtZW50LCBhZnRlciBhbGwgZXhpc3RpbmcgY29udGVudC4gRW5zdXJlIGl0IGZsb3dzIG5hdHVyYWxseS5cXG5gO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuRk9DVVM6ICR7YWN0aW9uR3VpZGFuY2VbY29tbWFuZC5hY3Rpb25dfSBhdCB0aGUgY3Vyc29yIHBvc2l0aW9uLlxcbmA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgb3V0cHV0IGluc3RydWN0aW9ucyBiYXNlZCBvbiBhY3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldE91dHB1dEluc3RydWN0aW9ucyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgbmV3IGNvbnRlbnQgdG8gYmUgYWRkZWQuJztcblxuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgaW1wcm92ZWQgdmVyc2lvbiBvZiB0aGUgY29udGVudC4nO1xuXG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBDb25maXJtIHdoYXQgc2hvdWxkIGJlIGRlbGV0ZWQgYnkgcHJvdmlkaW5nIHRoZSBleGFjdCB0ZXh0IHRvIHJlbW92ZSwgb3IgcmVzcG9uZCBcIkNPTkZJUk1FRFwiIGlmIHRoZSBkZWxldGlvbiBpcyBjbGVhci4nO1xuXG4gICAgICAgICAgICBjYXNlICdncmFtbWFyJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSB0aGUgY29ycmVjdGVkIHZlcnNpb24gd2l0aCBwcm9wZXIgZ3JhbW1hciBhbmQgc3BlbGxpbmcuJztcblxuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvbXBsZXRlbHkgcmV3cml0dGVuIGNvbnRlbnQgdGhhdCBzZXJ2ZXMgdGhlIHNhbWUgcHVycG9zZS4nO1xuXG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIHVwZGF0ZWQgbWV0YWRhdGEgaW4gcHJvcGVyIFlBTUwgZm9ybWF0Lic7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgcmVxdWVzdGVkIGNvbnRlbnQgY2hhbmdlcy4nO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgZG9jdW1lbnQgc3RydWN0dXJlIGZyb20gaGVhZGluZ3NcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkRG9jdW1lbnRTdHJ1Y3R1cmUoaGVhZGluZ3M6IERvY3VtZW50Q29udGV4dFsnaGVhZGluZ3MnXSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBoZWFkaW5ncy5tYXAoaGVhZGluZyA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRlbnQgPSAnICAnLnJlcGVhdChoZWFkaW5nLmxldmVsIC0gMSk7XG4gICAgICAgICAgICByZXR1cm4gYCR7aW5kZW50fS0gJHtoZWFkaW5nLnRleHR9YDtcbiAgICAgICAgfSkuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZ2VuZXJhdGVkIHByb21wdFxuICAgICAqL1xuICAgIHZhbGlkYXRlUHJvbXB0KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogeyB2YWxpZDogYm9vbGVhbjsgaXNzdWVzOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmICghcHJvbXB0LnN5c3RlbVByb21wdCB8fCBwcm9tcHQuc3lzdGVtUHJvbXB0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdTeXN0ZW0gcHJvbXB0IGlzIGVtcHR5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXByb21wdC51c2VyUHJvbXB0IHx8IHByb21wdC51c2VyUHJvbXB0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdVc2VyIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByb21wdC51c2VyUHJvbXB0Lmxlbmd0aCA+IDEwMDAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgdG9vIGxvbmcgKD4xMDAwMCBjaGFyYWN0ZXJzKScpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgaXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIENvbW1hbmQgcGFyc2VyIGZvciBOb3ZhXG4gKiBDb252ZXJ0cyBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gc3RydWN0dXJlZCBFZGl0Q29tbWFuZCBvYmplY3RzXG4gKi9cblxuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRBY3Rpb24gfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQYXR0ZXJucyBmb3IgZGV0ZWN0aW5nIGRpZmZlcmVudCBjb21tYW5kIHR5cGVzXG4gKi9cbmludGVyZmFjZSBDb21tYW5kUGF0dGVybiB7XG4gICAgYWN0aW9uOiBFZGl0QWN0aW9uO1xuICAgIHBhdHRlcm5zOiBSZWdFeHBbXTtcbiAgICB0YXJnZXRzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBDb21tYW5kIHBhcnNpbmcgcnVsZXNcbiAqL1xuY29uc3QgQ09NTUFORF9QQVRURVJOUzogQ29tbWFuZFBhdHRlcm5bXSA9IFtcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2dyYW1tYXInLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihncmFtbWFyfHNwZWxsfHNwZWxsaW5nfHByb29mcmVhZHxwb2xpc2gpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY2hlY2tcXGIuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGdyYW1tYXRpY2FsfGNvcnJlY3R8cHJvcGVyKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmZpeFxccysuKlxcYihncmFtbWFyfGVycm9yc3xtaXN0YWtlc3x0eXBvcylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJjb3JyZWN0XFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nLCAnZG9jdW1lbnQnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdtZXRhZGF0YScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvLyBUYWctc3BlY2lmaWMgcGF0dGVybnMgd2l0aCBjb2xvbiBmb3JtYXQgKGhpZ2hlc3QgcHJpb3JpdHkpXG4gICAgICAgICAgICAvXihhZGR8c2V0fHVwZGF0ZXxyZW1vdmUpXFxzK3RhZ3M/Oi9pLFxuICAgICAgICAgICAgLy8gVGFnIG9wdGltaXphdGlvbiBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYihjbGVhbiB1cHxjbGVhbnVwfG9wdGltaXplfGltcHJvdmV8cmV2aWV3fGFuYWx5emUpXFxzKy4qXFxidGFncz9cXGIvaSxcbiAgICAgICAgICAgIC9cXGIoc3VnZ2VzdHxyZWNvbW1lbmQpXFxzKy4qXFxidGFncz9cXGIvaSxcbiAgICAgICAgICAgIC9eYWRkIHN1Z2dlc3RlZCB0YWdzJC9pLFxuICAgICAgICAgICAgL15hZGQgdGFncyQvaSwgIC8vIFNpbXBsZSBcImFkZCB0YWdzXCIgZm9yIEFJIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICAvLyBHZW5lcmFsIG1ldGFkYXRhIHBhdHRlcm5zXG4gICAgICAgICAgICAvXFxiKHVwZGF0ZXxzZXR8Y2hhbmdlfG1vZGlmeSlcXHMrLipcXGIocHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcnx0YWd8dGFncylcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoc2V0fHVwZGF0ZXxjaGFuZ2V8YWRkKVxccysuKlxcYih0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXMpXFxiL2ksXG4gICAgICAgICAgICAvXFxidXBkYXRlXFxzKy4qXFxiZnJvbnRtYXR0ZXJcXGIvaSxcbiAgICAgICAgICAgIC8vIFRhZy1zcGVjaWZpYyBwYXR0ZXJucyB0aGF0IGV4Y2x1ZGUgY29udGVudC90ZXh0L3NlY3Rpb25cbiAgICAgICAgICAgIC9cXGIoYWRkfHJlbW92ZXx1cGRhdGUpXFxzKyg/IS4qXFxiKGNvbnRlbnR8dGV4dHxzZWN0aW9ufHBhcmFncmFwaHxhYm91dClcXGIpLipcXGJ0YWdbc10/XFxiL2ksXG4gICAgICAgICAgICAvXFxic2V0XFxzKy4qXFxicHJvcGVydHlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2RvY3VtZW50J11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAncmV3cml0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHJld3JpdGV8cmV3b3JkfHJlcGhyYXNlfHJlc3RydWN0dXJlfHJlb3JnYW5pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxid3JpdGVcXHMrLipcXGIobmV3fGRpZmZlcmVudHxhbHRlcm5hdGl2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnLCAnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZGVsZXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGV8Y3V0fGVyYXNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdldFxccytyaWRcXHMrb2ZcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ0YWtlXFxzK291dFxcYi9pLFxuICAgICAgICAgICAgL1xcYmRyb3BcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxwYXJ0KVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnYWRkJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnR8aW5jbHVkZXxhcHBlbmR8cHJlcGVuZClcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxoZWFkaW5nfGNvbnRlbnR8dGV4dHxwYXJ0KVxcYi9pLFxuICAgICAgICAgICAgL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxhcHBlbmR8cHJlcGVuZClcXGIoPyFcXHMrLipcXGIoYmV0dGVyfGNsZWFyZXJ8bW9yZXxsZXNzfHRhZ3M/fHByb3BlcnR5fHByb3BlcnRpZXN8bWV0YWRhdGF8ZnJvbnRtYXR0ZXIpXFxiKS9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoc2VjdGlvbnxwYXJ0KVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdlbmVyYXRlXFxiLipcXGIoc2VjdGlvbnxjb250ZW50fHRleHQpXFxiL2ksXG4gICAgICAgICAgICAvLyBTcGVjaWZpYyBwYXR0ZXJucyBmb3IgYXBwZW5kL3ByZXBlbmQgd2l0aCBsb2NhdGlvblxuICAgICAgICAgICAgL1xcYihhcHBlbmR8YWRkKVxcYi4qXFxiKGFmdGVyfGZvbGxvd2luZylcXGIvaSxcbiAgICAgICAgICAgIC9cXGIocHJlcGVuZHxhZGQpXFxiLipcXGIoYmVmb3JlfHByZWNlZGluZylcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2VuZCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2VkaXQnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihlZGl0fG1vZGlmeXxjaGFuZ2V8dXBkYXRlfHJldmlzZXxpbXByb3ZlfGVuaGFuY2UpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihiZXR0ZXJ8Y2xlYXJlcnxtb3JlfGxlc3N8Zm9ybWFsfHByb2Zlc3Npb25hbHxkZXRhaWxlZHxjb21wcmVoZW5zaXZlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihmaXh8Y29ycmVjdHxhZGp1c3QpXFxiKD8hLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiKS9pLFxuICAgICAgICAgICAgL1xcYihleHBhbmR8c2hvcnRlbnxjb25kZW5zZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbiddXG4gICAgfVxuXTtcblxuXG4vKipcbiAqIFRhcmdldCB0eXBlIGRldGVjdGlvbiBwYXR0ZXJucyAtIHNpbXBsaWZpZWQgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmdcbiAqL1xuY29uc3QgVEFSR0VUX1BBVFRFUk5TID0gW1xuICAgIHsgcGF0dGVybjogL1xcYig/OnNlbGVjdGVkfGhpZ2hsaWdodGVkfGNob3NlbilcXHMrKD86dGV4dHxjb250ZW50KS9pLCB0YXJnZXQ6ICdzZWxlY3Rpb24nIH0sXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86ZW50aXJlfHdob2xlfGZ1bGwpXFxzKyg/OmRvY3VtZW50fGZpbGV8bm90ZSkvaSwgdGFyZ2V0OiAnZG9jdW1lbnQnIH0sXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86ZW5kfGJvdHRvbXxjb25jbHVzaW9uKS9pLCB0YXJnZXQ6ICdlbmQnIH1cbl07XG5cbmV4cG9ydCBjbGFzcyBDb21tYW5kUGFyc2VyIHtcbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gYW4gRWRpdENvbW1hbmRcbiAgICAgKi9cbiAgICBwYXJzZUNvbW1hbmQoaW5wdXQ6IHN0cmluZywgaGFzU2VsZWN0aW9uOiBib29sZWFuID0gZmFsc2UpOiBFZGl0Q29tbWFuZCB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJbnB1dCA9IGlucHV0LnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZVxuICAgICAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmRldGVjdEFjdGlvbihub3JtYWxpemVkSW5wdXQpO1xuICAgICAgICBcbiAgICAgICAgLy8gRGV0ZWN0IHRoZSB0YXJnZXQgdHlwZSAoc2ltcGxpZmllZCBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZylcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5kZXRlY3RUYXJnZXQobm9ybWFsaXplZElucHV0LCBoYXNTZWxlY3Rpb24sIGFjdGlvbik7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IGZyb20gdGhlIGlucHV0XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmV4dHJhY3RDb250ZXh0KGlucHV0KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQsXG4gICAgICAgICAgICBpbnN0cnVjdGlvbjogaW5wdXQsIC8vIEtlZXAgb3JpZ2luYWwgaW5wdXQgZm9yIGRpc3BsYXlcbiAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZSBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0QWN0aW9uKGlucHV0OiBzdHJpbmcpOiBFZGl0QWN0aW9uIHtcbiAgICAgICAgLy8gQ2hlY2sgcGF0dGVybnMgaW4gb3JkZXIgb2Ygc3BlY2lmaWNpdHlcbiAgICAgICAgZm9yIChjb25zdCBjb21tYW5kUGF0dGVybiBvZiBDT01NQU5EX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgY29tbWFuZFBhdHRlcm4ucGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tbWFuZFBhdHRlcm4uYWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGVmYXVsdCBmYWxsYmFjayBsb2dpYyB3aXRoIG1vcmUgc3BlY2lmaWMgY2hlY2tzXG4gICAgICAgIGlmICgvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8Z2VuZXJhdGUuKnNlY3Rpb24pXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnYWRkJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihmaXh8Y29ycmVjdHxncmFtbWFyfHNwZWxsfHByb29mcmVhZHxwb2xpc2gpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZ3JhbW1hcic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGUpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZGVsZXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihyZXdyaXRlfHJlcGhyYXNlfHJlc3RydWN0dXJlfGdlbmVyYXRlLipuZXcpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAncmV3cml0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5fGFkZCkuKlxcYihwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyfHRhZ3x0YWdzfHRpdGxlfGF1dGhvcnxkYXRlfHN0YXR1cylcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdtZXRhZGF0YSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgdG8gZWRpdCBmb3IgYW1iaWd1b3VzIGNhc2VzXG4gICAgICAgIHJldHVybiAnZWRpdCc7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgZnJvbSB0aGUgaW5wdXQgKHNpbXBsaWZpZWQgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmcpXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZXRlY3RUYXJnZXQoXG4gICAgICAgIGlucHV0OiBzdHJpbmcsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW4sIFxuICAgICAgICBhY3Rpb246IEVkaXRBY3Rpb25cbiAgICApOiBFZGl0Q29tbWFuZFsndGFyZ2V0J10ge1xuICAgICAgICAvLyBDaGVjayBleHBsaWNpdCB0YXJnZXQgcGF0dGVybnNcbiAgICAgICAgZm9yIChjb25zdCB0YXJnZXRQYXR0ZXJuIG9mIFRBUkdFVF9QQVRURVJOUykge1xuICAgICAgICAgICAgaWYgKHRhcmdldFBhdHRlcm4ucGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRQYXR0ZXJuLnRhcmdldCBhcyBFZGl0Q29tbWFuZFsndGFyZ2V0J107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENvbnRleHQtYmFzZWQgdGFyZ2V0IGRldGVjdGlvblxuICAgICAgICBpZiAoaGFzU2VsZWN0aW9uICYmIChhY3Rpb24gPT09ICdlZGl0JyB8fCBhY3Rpb24gPT09ICdncmFtbWFyJyB8fCBhY3Rpb24gPT09ICdkZWxldGUnKSkge1xuICAgICAgICAgICAgcmV0dXJuICdzZWxlY3Rpb24nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBY3Rpb24tc3BlY2lmaWMgZGVmYXVsdHMgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmdcbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdjdXJzb3InOyAgLy8gQ2hhbmdlZCBmcm9tICdlbmQnIHRvICdjdXJzb3InIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAnY3Vyc29yJztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2N1cnNvcic7XG4gICAgICAgICAgICBjYXNlICdncmFtbWFyJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAnZG9jdW1lbnQnO1xuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2N1cnNvcic7ICAvLyBDaGFuZ2VkIGZyb20gJ2VuZCcgdG8gc3VwcG9ydCBjdXJzb3Itb25seVxuICAgICAgICAgICAgY2FzZSAnbWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZG9jdW1lbnQnO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBhZGRpdGlvbmFsIGNvbnRleHQgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RDb250ZXh0KGlucHV0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICAvLyBFeHRyYWN0IHN0eWxlL3RvbmUgaW5kaWNhdG9yc1xuICAgICAgICBjb25zdCBzdHlsZUluZGljYXRvcnMgPSBbXG4gICAgICAgICAgICAnZm9ybWFsJywgJ2luZm9ybWFsJywgJ2Nhc3VhbCcsICdwcm9mZXNzaW9uYWwnLCAnYWNhZGVtaWMnLCAndGVjaG5pY2FsJyxcbiAgICAgICAgICAgICdzaW1wbGUnLCAnY29tcGxleCcsICdkZXRhaWxlZCcsICdicmllZicsICdjb25jaXNlJywgJ3ZlcmJvc2UnLFxuICAgICAgICAgICAgJ2ZyaWVuZGx5JywgJ3NlcmlvdXMnLCAnaHVtb3JvdXMnLCAnY3JlYXRpdmUnLCAnYW5hbHl0aWNhbCdcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZvdW5kU3R5bGVzID0gc3R5bGVJbmRpY2F0b3JzLmZpbHRlcihzdHlsZSA9PiBcbiAgICAgICAgICAgIGlucHV0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc3R5bGUpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuICAgICAgICBpZiAoZm91bmRTdHlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29udGV4dCArPSBgU3R5bGU6ICR7Zm91bmRTdHlsZXMuam9pbignLCAnKX0uIGA7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgbGVuZ3RoIGluZGljYXRvcnNcbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdzaG9ydCcpIHx8IGlucHV0LmluY2x1ZGVzKCdicmllZicpIHx8IGlucHV0LmluY2x1ZGVzKCdjb25jaXNlJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0tlZXAgaXQgYnJpZWYuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdsb25nJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2RldGFpbGVkJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbXByZWhlbnNpdmUnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnUHJvdmlkZSBkZXRhaWxlZCBjb250ZW50LiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IHNwZWNpZmljIHJlcXVpcmVtZW50c1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2J1bGxldCcpIHx8IGlucHV0LmluY2x1ZGVzKCdsaXN0JykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1VzZSBidWxsZXQgcG9pbnRzIG9yIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnZXhhbXBsZScpIHx8IGlucHV0LmluY2x1ZGVzKCdleGFtcGxlcycpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdJbmNsdWRlIGV4YW1wbGVzLiAnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnbnVtYmVyJykgfHwgaW5wdXQuaW5jbHVkZXMoJ251bWJlcmVkJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1VzZSBudW1iZXJlZCBsaXN0cy4gJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjb250ZXh0LnRyaW0oKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgaWYgYSBjb21tYW5kIGNhbiBiZSBleGVjdXRlZFxuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZCwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24tdGFyZ2V0IGNvbWJpbmF0aW9uc1xuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdhZGQnICYmIGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0ZWQgY29tbWFuZHMgYmFzZWQgb24gY29udGV4dFxuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICBpZiAoaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBjb25jaXNlJyxcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXIgaW4gdGhpcyB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgcHJvZmVzc2lvbmFsJyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIG9uIHRoaXMgcG9pbnQnXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnQWRkIGNvbnRlbnQgYXQgY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXIgaW4gdGhpcyBkb2N1bWVudCcsXG4gICAgICAgICAgICAgICAgJ0FkZCBjb25jbHVzaW9uIGF0IGVuZCcsXG4gICAgICAgICAgICAgICAgJ0NyZWF0ZSBhIHN1bW1hcnknXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFBhcnNlIG11bHRpcGxlIGNvbW1hbmRzIGZyb20gYSBzaW5nbGUgaW5wdXRcbiAgICAgKi9cbiAgICBwYXJzZU11bHRpcGxlQ29tbWFuZHMoaW5wdXQ6IHN0cmluZyk6IEVkaXRDb21tYW5kW10ge1xuICAgICAgICAvLyBTcGxpdCBvbiBjb21tb24gY29tbWFuZCBzZXBhcmF0b3JzXG4gICAgICAgIGNvbnN0IHNlcGFyYXRvcnMgPSAvXFxiKD86dGhlbnxhbHNvfGFuZCB0aGVufGFmdGVyIHRoYXR8bmV4dHxhZGRpdGlvbmFsbHkpXFxiL2k7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gaW5wdXQuc3BsaXQoc2VwYXJhdG9ycyk7XG4gICAgICAgIFxuICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gW3RoaXMucGFyc2VDb21tYW5kKGlucHV0KV07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBwYXJ0c1xuICAgICAgICAgICAgLm1hcChwYXJ0ID0+IHBhcnQudHJpbSgpKVxuICAgICAgICAgICAgLmZpbHRlcihwYXJ0ID0+IHBhcnQubGVuZ3RoID4gMClcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiB0aGlzLnBhcnNlQ29tbWFuZChwYXJ0KSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBjb21tYW5kIGRlc2NyaXB0aW9uIGZvciBkaXNwbGF5XG4gICAgICovXG4gICAgZ2V0Q29tbWFuZERlc2NyaXB0aW9uKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgeyBhY3Rpb24sIHRhcmdldCB9ID0gY29tbWFuZDtcbiAgICAgICAgXG4gICAgICAgIGxldCBkZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBcbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnQWRkIG5ldyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0VkaXQgZXhpc3RpbmcgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ1JlbW92ZSBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdHZW5lcmF0ZSBuZXcgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc3dpdGNoICh0YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgaW4gZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBhdCBlbmQgb2YgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGVzY3JpcHRpb247XG4gICAgfVxufSIsICIvKipcbiAqIFByb21wdCBidWlsZGVyIHNlcnZpY2UgZm9yIE5vdmFcbiAqIEludGVncmF0ZXMgQ29udGV4dEJ1aWxkZXIgd2l0aCBkb2N1bWVudCBlbmdpbmUgYW5kIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciwgR2VuZXJhdGVkUHJvbXB0IH0gZnJvbSAnLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyc2VyIH0gZnJvbSAnLi9jb21tYW5kLXBhcnNlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRG9jdW1lbnRDb250ZXh0LCBQcm9tcHRDb25maWcsIENvbnZlcnNhdGlvbk1lc3NhZ2UgfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQcm9tcHQgYnVpbGRpbmcgc2VydmljZVxuICovXG5leHBvcnQgY2xhc3MgUHJvbXB0QnVpbGRlciB7XG4gICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXI7XG4gICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmU7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgIHByaXZhdGUgY29tbWFuZFBhcnNlcjogQ29tbWFuZFBhcnNlcjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXJcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb250ZXh0QnVpbGRlciA9IG5ldyBDb250ZXh0QnVpbGRlcigpO1xuICAgICAgICB0aGlzLmRvY3VtZW50RW5naW5lID0gZG9jdW1lbnRFbmdpbmU7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IGNvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgICAgIHRoaXMuY29tbWFuZFBhcnNlciA9IG5ldyBDb21tYW5kUGFyc2VyKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHVzZXIgbWVzc2FnZSAtIGRldGVybWluZXMgaWYgaXQncyBhIGNvbW1hbmQgb3IgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRQcm9tcHRGb3JNZXNzYWdlKFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGxpa2VseSBhIGNvbW1hbmQgYmFzZWQgb24gYWN0aW9uIHdvcmRzXG4gICAgICAgIGNvbnN0IGlzTGlrZWx5Q29tbWFuZCA9IHRoaXMuaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2UpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlzTGlrZWx5Q29tbWFuZCAmJiBmaWxlKSB7XG4gICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgY29tbWFuZFxuICAgICAgICAgICAgY29uc3QgcGFyc2VkQ29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQocGFyc2VkQ29tbWFuZCwgZmlsZSwgb3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJdCdzIGEgY29udmVyc2F0aW9uIC0gYnVpbGQgY29udmVyc2F0aW9uIHByb21wdFxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQobWVzc2FnZSwgZmlsZSwgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhIG1lc3NhZ2UgaXMgbGlrZWx5IGEgY29tbWFuZCB2cyBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGlzTGlrZWx5Q29tbWFuZChtZXNzYWdlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIDEuIEV4cGxpY2l0IGNvbW1hbmQgc3ludGF4IChjb2xvbiBjb21tYW5kcylcbiAgICAgICAgaWYgKGxvd2VyTWVzc2FnZS5zdGFydHNXaXRoKCc6JykpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyAyLiBDaGVjayBmb3IgYWN0aW9uIHZlcmJzIHRoYXQgaW5kaWNhdGUgZG9jdW1lbnQgbW9kaWZpY2F0aW9uIGNvbW1hbmRzXG4gICAgICAgIGNvbnN0IGFjdGlvblZlcmJzID0gW1xuICAgICAgICAgICAgJ2FkZCcsICdpbnNlcnQnLCAnYXBwZW5kJywgJ3ByZXBlbmQnLCAnaW5jbHVkZScsICdjcmVhdGUnLCAnd3JpdGUnLCAnZ2VuZXJhdGUnLFxuICAgICAgICAgICAgJ2VkaXQnLCAnbW9kaWZ5JywgJ2NoYW5nZScsICd1cGRhdGUnLCAncmV2aXNlJywgJ2ltcHJvdmUnLCAnZW5oYW5jZScsICdyZXBsYWNlJyxcbiAgICAgICAgICAgICdkZWxldGUnLCAncmVtb3ZlJywgJ2VsaW1pbmF0ZScsICdjdXQnLCAnZXJhc2UnLCAnZHJvcCcsXG4gICAgICAgICAgICAnZml4JywgJ2NvcnJlY3QnLCAncHJvb2ZyZWFkJywgJ3BvbGlzaCcsICdjaGVjaycsXG4gICAgICAgICAgICAncmV3cml0ZScsICdyZXdvcmQnLCAncmVwaHJhc2UnLCAncmVzdHJ1Y3R1cmUnLCAncmVvcmdhbml6ZSdcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIG1lc3NhZ2Ugc3RhcnRzIHdpdGggYW4gYWN0aW9uIHZlcmIgKGltcGVyYXRpdmUgY29tbWFuZCBzdHJ1Y3R1cmUpXG4gICAgICAgIGNvbnN0IHN0YXJ0c1dpdGhBY3Rpb24gPSBhY3Rpb25WZXJicy5zb21lKHZlcmIgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmVyYlBhdHRlcm4gPSBuZXcgUmVnRXhwKGBeJHt2ZXJifVxcXFxiYCwgJ2knKTtcbiAgICAgICAgICAgIHJldHVybiB2ZXJiUGF0dGVybi50ZXN0KGxvd2VyTWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHN0YXJ0c1dpdGhBY3Rpb24pIHtcbiAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgZmlsdGVyaW5nOiBleGNsdWRlIHF1ZXN0aW9ucyBhbmQgZGlzY3Vzc2lvbnNcbiAgICAgICAgICAgIGNvbnN0IHF1ZXN0aW9uSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICAgICAvXihob3d8d2hhdHx3aHl8d2hlbnx3aGVyZXx3aGljaHx3aG98Y2FufGNvdWxkfHNob3VsZHx3b3VsZHx3aWxsfGlzfGFyZXxhbXxkb3xkb2VzfGRpZCkvaSxcbiAgICAgICAgICAgICAgICAvXFw/LywgIC8vIENvbnRhaW5zIHF1ZXN0aW9uIG1hcmtcbiAgICAgICAgICAgICAgICAvXFxiKGhlbHB8YWR2aWNlfHN1Z2dlc3R8cmVjb21tZW5kfHRoaW5rfG9waW5pb24pXFxiL2lcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIElmIGl0J3MgYSBxdWVzdGlvbiBvciBkaXNjdXNzaW9uLCByb3V0ZSB0byBjb252ZXJzYXRpb25cbiAgICAgICAgICAgIGNvbnN0IGlzUXVlc3Rpb24gPSBxdWVzdGlvbkluZGljYXRvcnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChsb3dlck1lc3NhZ2UpKTtcbiAgICAgICAgICAgIGlmIChpc1F1ZXN0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gMy4gQ2hlY2sgZm9yIGV4cGxpY2l0IGNvbW1hbmQgcGF0dGVybnMgKGZvciBlZGdlIGNhc2VzKVxuICAgICAgICBjb25zdCBleHBsaWNpdENvbW1hbmRQYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC8vIEdyYW1tYXIvc3BlbGxpbmcgY29tbWFuZHMgdGhhdCBkb24ndCBzdGFydCB3aXRoIGFjdGlvbiB2ZXJic1xuICAgICAgICAgICAgL1xcYihncmFtbWFyfHNwZWxsfHNwZWxsaW5nfHByb29mcmVhZHxwb2xpc2gpXFxiLipcXGIoY2hlY2t8Zml4fGNvcnJlY3QpXFxiL2ksXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE1ldGFkYXRhIGNvbW1hbmRzIHdpdGggZGlmZmVyZW50IHN0cnVjdHVyZXNcbiAgICAgICAgICAgIC9cXGJzZXRcXHMrKHRoZVxccyspPyh0aXRsZXx0YWdzfG1ldGFkYXRhfHByb3BlcnRpZXMpL2ksXG4gICAgICAgICAgICAvXFxidXBkYXRlXFxzKyh0aGVcXHMrKT8odGl0bGV8dGFnc3xtZXRhZGF0YXxwcm9wZXJ0aWVzKS9pLFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUYWctc3BlY2lmaWMgcGF0dGVybnNcbiAgICAgICAgICAgIC9eKGFkZHxzZXR8dXBkYXRlfHJlbW92ZSlcXHMrdGFncz86L2ksXG4gICAgICAgICAgICAvXFxiKGNsZWFuIHVwfGNsZWFudXB8b3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZSlcXHMrLipcXGJ0YWdzP1xcYi9pLFxuICAgICAgICAgICAgL1xcYihzdWdnZXN0fHJlY29tbWVuZClcXHMrLipcXGJ0YWdzP1xcYi9pLFxuICAgICAgICAgICAgL15hZGQgc3VnZ2VzdGVkIHRhZ3MkL2lcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIG1lc3NhZ2UgbWF0Y2hlcyBleHBsaWNpdCBjb21tYW5kIHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBleHBsaWNpdENvbW1hbmRQYXR0ZXJucykge1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChsb3dlck1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDQuIEV2ZXJ5dGhpbmcgZWxzZSBnb2VzIHRvIGNvbnZlcnNhdGlvbiBtb2RlXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29tbWFuZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBpcyByZXF1aXJlZCBmb3IgY29tbWFuZCBwcm9tcHRzJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBuZWVkZWRcbiAgICAgICAgbGV0IGNvbnZlcnNhdGlvbkNvbnRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKG9wdGlvbnMuaW5jbHVkZUhpc3RvcnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShyZWNlbnRNZXNzYWdlcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCB0aGUgcHJvbXB0XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgb3B0aW9ucywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBjb252ZXJzYXRpb24gKG5vbi1jb21tYW5kIG1lc3NhZ2VzKVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCByZWNlbnRIaXN0b3J5OiBDb252ZXJzYXRpb25NZXNzYWdlW10gPSBbXTtcblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dCBpZiBmaWxlIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IHJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICAgICAgICAgcmVjZW50SGlzdG9yeSA9IGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIGNvbnZlcnNhdGlvbi1zdHlsZSBwcm9tcHQgKG5vdCBjb21tYW5kIGZvcm1hdClcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyIHRoYXQgaGVscHMgdXNlcnMgd2l0aCB0aGVpciBkb2N1bWVudHMgYW5kIHdyaXRpbmcgdGFza3MuXG5cbktleSBjYXBhYmlsaXRpZXM6XG4tIEFuc3dlciBxdWVzdGlvbnMgYWJvdXQgZG9jdW1lbnRzIGFuZCBjb250ZW50XG4tIFByb3ZpZGUgd3JpdGluZyBhc3Npc3RhbmNlIGFuZCBzdWdnZXN0aW9uc1xuLSBIZWxwIHdpdGggcmVzZWFyY2ggYW5kIGFuYWx5c2lzXG4tIEVuZ2FnZSBpbiBuYXR1cmFsIGNvbnZlcnNhdGlvbiBhYm91dCB0aGUgdXNlcidzIHdvcmtcblxuR3VpZGVsaW5lczpcbi0gUHJvdmlkZSBoZWxwZnVsLCBhY2N1cmF0ZSByZXNwb25zZXNcbi0gU3RheSBmb2N1c2VkIG9uIHRoZSB1c2VyJ3MgbmVlZHNcbi0gQmUgY29udmVyc2F0aW9uYWwgYnV0IHByb2Zlc3Npb25hbFxuLSBSZWZlcmVuY2UgZG9jdW1lbnQgY29udGV4dCB3aGVuIHJlbGV2YW50YDtcblxuICAgICAgICBsZXQgdXNlclByb21wdCA9IGBVU0VSIFJFUVVFU1Q6ICR7bWVzc2FnZX1gO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IGNvbnRleHQgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQgJiYgZmlsZSkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBDdXJyZW50IGRvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cblxuJHt1c2VyUHJvbXB0fWA7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gaGlzdG9yeSBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKHJlY2VudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgaGlzdG9yeVN0cmluZyA9IHRoaXMuZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShyZWNlbnRIaXN0b3J5KTtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgUkVDRU5UIENPTlZFUlNBVElPTjpcbiR7aGlzdG9yeVN0cmluZ31cblxuJHt1c2VyUHJvbXB0fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGRvY3VtZW50Q29udGV4dD8uY29udGVudCB8fCAnJyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBvcHRpb25zLnRlbXBlcmF0dXJlIHx8IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IG9wdGlvbnMubWF4VG9rZW5zIHx8IDIwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzaW1wbGUgcHJvbXB0IGZvciBiYXNpYyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb246IHN0cmluZywgY29udGV4dD86IHN0cmluZyk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIHdpdGggdGhlaXIgZG9jdW1lbnRzIGFuZCB3cml0aW5nIHRhc2tzLlxuXG5HdWlkZWxpbmVzOlxuLSBQcm92aWRlIGhlbHBmdWwsIGFjY3VyYXRlIHJlc3BvbnNlc1xuLSBTdGF5IGZvY3VzZWQgb24gdGhlIHVzZXIncyBuZWVkc1xuLSBCZSBjb252ZXJzYXRpb25hbCBidXQgcHJvZmVzc2lvbmFsYDtcblxuICAgICAgICBsZXQgdXNlclByb21wdCA9IGBVU0VSIFJFUVVFU1Q6ICR7aW5zdHJ1Y3Rpb259YDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENvbnRleHQ6ICR7Y29udGV4dH1cblxuJHt1c2VyUHJvbXB0fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHQgfHwgJycsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogMjAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBkb2N1bWVudCBjb250ZXh0IGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldERvY3VtZW50Q29udGV4dChmaWxlOiBURmlsZSk6IFByb21pc2U8RG9jdW1lbnRDb250ZXh0PiB7XG4gICAgICAgIC8vIFVzZSB0aGUgZG9jdW1lbnQgZW5naW5lJ3MgYnVpbHQtaW4gY29udGV4dCBnYXRoZXJpbmdcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrOiBjcmVhdGUgbWluaW1hbCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRlbnQoKSB8fCAnJztcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmlsZTogZmlsZSxcbiAgICAgICAgICAgICAgICBmaWxlbmFtZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgIGhlYWRpbmdzOiBbXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFRleHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBzdXJyb3VuZGluZ0xpbmVzOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXR1cm4gdGhlIGNvbnRleHQgYXMtaXMsIHNpbmNlIGl0J3MgYWxyZWFkeSBpbiB0aGUgY29ycmVjdCBmb3JtYXRcbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9ybWF0IGNvbnZlcnNhdGlvbiBoaXN0b3J5IGZvciBjb250ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBmb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KG1lc3NhZ2VzOiBDb252ZXJzYXRpb25NZXNzYWdlW10pOiBzdHJpbmcge1xuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm4gJyc7XG5cbiAgICAgICAgbGV0IGZvcm1hdHRlZCA9ICdSRUNFTlQgQ09OVkVSU0FUSU9OOlxcbic7XG4gICAgICAgIG1lc3NhZ2VzLmZvckVhY2gobXNnID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJvbGUgPSBtc2cucm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiAnTm92YSc7XG4gICAgICAgICAgICBmb3JtYXR0ZWQgKz0gYCR7cm9sZX06ICR7bXNnLmNvbnRlbnR9XFxuYDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBhbmQgb3B0aW1pemUgcHJvbXB0IGJlZm9yZSBzZW5kaW5nIHRvIEFJXG4gICAgICovXG4gICAgdmFsaWRhdGVBbmRPcHRpbWl6ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgIC8vIFByb21wdCB2YWxpZGF0aW9uIGlzc3VlcyAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBmaXggY29tbW9uIGlzc3Vlc1xuICAgICAgICAgICAgbGV0IG9wdGltaXplZFByb21wdCA9IHsgLi4ucHJvbXB0IH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRydW5jYXRlIGlmIHRvbyBsb25nXG4gICAgICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICh0b2tlbkNvdW50ID4gODAwMCkge1xuICAgICAgICAgICAgICAgIC8vIFJlZHVjZSBjb250ZXh0IHNpemUgbW9yZSBhZ2dyZXNzaXZlbHlcbiAgICAgICAgICAgICAgICBjb25zdCBtYXhDb250ZXh0TGVuZ3RoID0gTWF0aC5mbG9vcihwcm9tcHQuY29udGV4dC5sZW5ndGggKiAwLjYpO1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb250ZXh0ID0gcHJvbXB0LmNvbnRleHQuc3Vic3RyaW5nKDAsIG1heENvbnRleHRMZW5ndGgpICsgJ1xcbltDb250ZXh0IHRydW5jYXRlZC4uLl0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCB0ZW1wZXJhdHVyZVxuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPCAwIHx8IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPiAxKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHByb21wdC5jb25maWcudGVtcGVyYXR1cmUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgbWF4IHRva2Vuc1xuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcubWF4VG9rZW5zIDwgMTAgfHwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPiA0MDAwKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPSBNYXRoLm1heCgxMCwgTWF0aC5taW4oNDAwMCwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIG9wdGltaXplZFByb21wdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRva2VuIGNvdW50IGVzdGltYXRlIGZvciBhIHByb21wdFxuICAgICAqL1xuICAgIGdldFRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgcHJvbXB0IGZvciBhIHNwZWNpZmljIGFjdGlvbiB3aXRoIG1pbmltYWwgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkUXVpY2tQcm9tcHQoXG4gICAgICAgIGFjdGlvbjogRWRpdENvbW1hbmRbJ2FjdGlvbiddLFxuICAgICAgICBpbnN0cnVjdGlvbjogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBjb25zdCBjb21tYW5kOiBFZGl0Q29tbWFuZCA9IHtcbiAgICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICAgIHRhcmdldDogJ2RvY3VtZW50JyxcbiAgICAgICAgICAgIGluc3RydWN0aW9uLFxuICAgICAgICAgICAgY29udGV4dDogdW5kZWZpbmVkXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChjb21tYW5kLCBmaWxlLCB7IFxuICAgICAgICAgICAgICAgIG1heENvbnRleHRMaW5lczogMTAsXG4gICAgICAgICAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgaW5jbHVkZUhpc3Rvcnk6IGZhbHNlIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaW1wbGUgdG9rZW4gY291bnQgZXN0aW1hdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogbnVtYmVyIHtcbiAgICAgICAgLy8gUm91Z2ggZXN0aW1hdGlvbjogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cbiAgICAgICAgY29uc3QgdG90YWxUZXh0ID0gcHJvbXB0LnN5c3RlbVByb21wdCArIHByb21wdC51c2VyUHJvbXB0ICsgcHJvbXB0LmNvbnRleHQ7XG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodG90YWxUZXh0Lmxlbmd0aCAvIDQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCB3aXRoIGN1c3RvbSBzeXN0ZW0gcHJvbXB0IG92ZXJyaWRlXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDdXN0b21Qcm9tcHQoXG4gICAgICAgIHN5c3RlbVByb21wdDogc3RyaW5nLFxuICAgICAgICB1c2VyTWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgY29udGV4dCA9IGBEb2N1bWVudDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQ6IHVzZXJNZXNzYWdlLFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIEFkZCBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFkZGluZyBuZXcgY29udGVudCB0byBkb2N1bWVudHMgYXQgY3Vyc29yIHBvc2l0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU3RyZWFtaW5nTWFuYWdlciB9IGZyb20gJy4uLy4uL3VpL3N0cmVhbWluZy1tYW5hZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBTdHJlYW1pbmdDYWxsYmFjayB7XG4gICAgKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgQWRkQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhZGQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBzdHJlYW1pbmdDYWxsYmFjaz86IFN0cmVhbWluZ0NhbGxiYWNrKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kKTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIG1lc3NhZ2UgYWxyZWFkeSBsb2dnZWQgYnkgY2hhdCBpbnB1dCBoYW5kbGVyXG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgYWRkaXRpb24gYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlBZGRpdGlvbihjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIExvZyBvbmx5IGZhaWx1cmVzIGFzIGFzc2lzdGFudCBtZXNzYWdlc1xuICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3Mgd2lsbCBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBzdWNjZXNzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIC8vIEZhaWx1cmUgd2lsbCBhbHNvIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIGVycm9yIGluZGljYXRvclxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgYWRkaXRpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5QWRkaXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBBZGQgdG8gZG9jdW1lbnQgKHR5cGljYWxseSBhcHBlbmQgdG8gZW5kKVxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBzZWxlY3Rpb24gd2l0aCBuZXcgY29udGVudFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5vIHNlbGVjdGlvbiwgYWRkIGF0IGN1cnNvciBpbnN0ZWFkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIGFkZCB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFkZCBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBhZGRcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnYWRkJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIGFkZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBpbnN0cnVjdGlvbiBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoIWNvbW1hbmQuaW5zdHJ1Y3Rpb24gfHwgY29tbWFuZC5pbnN0cnVjdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0FkZCBpbnN0cnVjdGlvbiBpcyByZXF1aXJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYWRkIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdpdGhTdHJlYW1pbmcoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHByb21wdDogYW55LFxuICAgICAgICBzdHJlYW1pbmdDYWxsYmFjazogU3RyZWFtaW5nQ2FsbGJhY2tcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIGNvbnRlbnQgd2l0aCBzdHJlYW1pbmdcbiAgICAgICAgICAgIGxldCBmdWxsQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVc2UgdGhlIHN0cmVhbWluZyBnZW5lcmF0b3JcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dFN0cmVhbShcbiAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGlmIChjaHVuay5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxDb250ZW50ICs9IGNodW5rLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcndhcmQgdG8gdGhlIHN0cmVhbWluZyBjYWxsYmFjayB3aGljaCBoYW5kbGVzIGRvY3VtZW50IHVwZGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNpZ25hbCBjb21wbGV0aW9uXG4gICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICghZnVsbENvbnRlbnQgfHwgZnVsbENvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3Igc3RyZWFtaW5nIG1vZGUsIHRoZSBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQgdmlhIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBKdXN0IHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGZpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24gfHwgeyBsaW5lOiAwLCBjaDogMCB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdTdHJlYW1pbmcgZmFpbGVkJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogRWRpdCBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIG1vZGlmeWluZyBhbmQgaW1wcm92aW5nIGV4aXN0aW5nIGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU3RyZWFtaW5nQ2FsbGJhY2sgfSBmcm9tICcuL2FkZC1jb21tYW5kJztcblxuZXhwb3J0IGNsYXNzIEVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBzdHJlYW1pbmdDYWxsYmFjaz86IFN0cmVhbWluZ0NhbGxiYWNrKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgbWVzc2FnZSBhbHJlYWR5IGxvZ2dlZCBieSBjaGF0IGlucHV0IGhhbmRsZXJcblxuICAgICAgICAgICAgICAgIGxldCBjb250ZW50OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogRWRpdFJlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1pbmdDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIG1vZGVcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV2l0aFN0cmVhbWluZyhjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdCwgc3RyZWFtaW5nQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0cmFkaXRpb25hbCBzeW5jaHJvbm91cyBtb2RlIChmYWxsYmFjaylcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUVkaXQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgb25seSBmYWlsdXJlcyBhcyBhc3Npc3RhbnQgbWVzc2FnZXNcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIHdpbGwgYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3Mgc3VjY2VzcyBpbmRpY2F0b3JcbiAgICAgICAgICAgICAgICAvLyBGYWlsdXJlIHdpbGwgYWxzbyBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBlcnJvciBpbmRpY2F0b3JcblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZWRpdCBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlFZGl0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQgZm9yIGVkaXRpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBlbnRpcmUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoY29udGVudCk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBlZGl0IHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gZWRpdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24gaXMgZWRpdFxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdlZGl0Jykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIGVkaXQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgaW5zdHJ1Y3Rpb24gaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKCFjb21tYW5kLmluc3RydWN0aW9uIHx8IGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdFZGl0IGluc3RydWN0aW9uIGlzIHJlcXVpcmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBlZGl0IGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdpdGhTdHJlYW1pbmcoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHByb21wdDogYW55LFxuICAgICAgICBzdHJlYW1pbmdDYWxsYmFjazogU3RyZWFtaW5nQ2FsbGJhY2tcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIGNvbnRlbnQgd2l0aCBzdHJlYW1pbmdcbiAgICAgICAgICAgIGxldCBmdWxsQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVc2UgdGhlIHN0cmVhbWluZyBnZW5lcmF0b3JcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dFN0cmVhbShcbiAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGlmIChjaHVuay5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxDb250ZW50ICs9IGNodW5rLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcndhcmQgdG8gdGhlIHN0cmVhbWluZyBjYWxsYmFjayB3aGljaCBoYW5kbGVzIGRvY3VtZW50IHVwZGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNpZ25hbCBjb21wbGV0aW9uXG4gICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICghZnVsbENvbnRlbnQgfHwgZnVsbENvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHN0cmVhbWluZyBtb2RlLCB0aGUgZG9jdW1lbnQgaGFzIGFscmVhZHkgYmVlbiB1cGRhdGVkIHZpYSBjYWxsYmFja1xuICAgICAgICAgICAgLy8gSnVzdCByZXR1cm4gc3VjY2VzcyB3aXRoIHRoZSBmaW5hbCBjb250ZW50XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogZnVsbENvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbiB8fCB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1N0cmVhbWluZyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogRGVsZXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgcmVtb3ZpbmcgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBEZWxldGVDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGRlbGV0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBkZWxldGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlEZWxldGlvbihjb21tYW5kLCBkb2N1bWVudENvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBMb2cgb25seSBmYWlsdXJlcyBhcyBhc3Npc3RhbnQgbWVzc2FnZXNcbiAgICAgICAgICAgIC8vIFN1Y2Nlc3Mgd2lsbCBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBzdWNjZXNzIGluZGljYXRvclxuICAgICAgICAgICAgLy8gRmFpbHVyZSB3aWxsIGFsc28gYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3MgZXJyb3IgaW5kaWNhdG9yXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGRlbGV0aW9uIGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseURlbGV0aW9uKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0XG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQgZm9yIGRlbGV0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgY3VycmVudCBsaW5lIGF0IGN1cnNvclxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmRlbGV0ZUNvbnRlbnQoJ2xpbmUnKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIENsZWFyIGVudGlyZSBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudCgnJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRyYWlsaW5nIGNvbnRlbnQgKG5vdCB0eXBpY2FsbHkgdXNlZCBmb3IgZGVsZXRlKVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgZnJvbSBlbmQgLSB1c2UgY3Vyc29yIG9yIHNlbGVjdGlvbiBpbnN0ZWFkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIGRlbGV0ZSB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGRlbGV0ZSBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhblxuICAgICk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGRlbGV0ZVxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdkZWxldGUnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxufSIsICIvKipcbiAqIEdyYW1tYXIgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBmaXhpbmcgZ3JhbW1hciBhbmQgc3BlbGxpbmcgYXQgY3Vyc29yIHBvc2l0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU3RyZWFtaW5nQ2FsbGJhY2sgfSBmcm9tICcuL2FkZC1jb21tYW5kJztcblxuZXhwb3J0IGNsYXNzIEdyYW1tYXJDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBzdHJlYW1pbmdDYWxsYmFjaz86IFN0cmVhbWluZ0NhbGxiYWNrKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgbWVzc2FnZSBhbHJlYWR5IGxvZ2dlZCBieSBjaGF0IGlucHV0IGhhbmRsZXJcblxuICAgICAgICAgICAgICAgIGxldCBjb250ZW50OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogRWRpdFJlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1pbmdDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIG1vZGVcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV2l0aFN0cmVhbWluZyhjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdCwgc3RyZWFtaW5nQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0cmFkaXRpb25hbCBzeW5jaHJvbm91cyBtb2RlIChmYWxsYmFjaylcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZ3JhbW1hciBmaXggYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlHcmFtbWFyRml4KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTG9nIG9ubHkgZmFpbHVyZXMgYXMgYXNzaXN0YW50IG1lc3NhZ2VzXG4gICAgICAgICAgICAgICAgLy8gU3VjY2VzcyB3aWxsIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIHN1Y2Nlc3MgaW5kaWNhdG9yXG4gICAgICAgICAgICAgICAgLy8gRmFpbHVyZSB3aWxsIGFsc28gYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3MgZXJyb3IgaW5kaWNhdG9yXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgZml4IGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUdyYW1tYXJGaXgoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGVudGlyZSBkb2N1bWVudCB3aXRoIGNvcnJlY3RlZCB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEdyYW1tYXIgY29ycmVjdGlvbiBhdCBjdXJzb3IgZG9lc24ndCBtYWtlIG11Y2ggc2Vuc2UsIFxuICAgICAgICAgICAgICAgIC8vIHN1Z2dlc3Qgc2VsZWN0aW5nIHRleHQgaW5zdGVhZFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBjb3JyZWN0IGdyYW1tYXIsIG9yIHVzZSBcImRvY3VtZW50XCIgdG8gZml4IGVudGlyZSBkb2N1bWVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEdyYW1tYXIgY29ycmVjdGlvbiBhdCBlbmQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnR3JhbW1hciBjb3JyZWN0aW9uIHJlcXVpcmVzIHNlbGVjdGluZyB0ZXh0IG9yIHNwZWNpZnlpbmcgXCJkb2N1bWVudFwiJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBncmFtbWFyIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGdyYW1tYXJcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZ3JhbW1hcicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBncmFtbWFyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBncmFtbWFyLCB3ZSBuZWVkIGVpdGhlciBzZWxlY3Rpb24gb3IgZG9jdW1lbnQgdGFyZ2V0XG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gY29ycmVjdCBncmFtbWFyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCAhPT0gJ3NlbGVjdGlvbicgJiYgY29tbWFuZC50YXJnZXQgIT09ICdkb2N1bWVudCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnR3JhbW1hciBjb3JyZWN0aW9uIHJlcXVpcmVzIHNlbGVjdGluZyB0ZXh0IG9yIHRhcmdldGluZyBlbnRpcmUgZG9jdW1lbnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3Igc3RyZWFtaW5nIG1vZGUsIHRoZSBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQgdmlhIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBKdXN0IHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGZpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uIHx8IHsgbGluZTogMCwgY2g6IDAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3RyZWFtaW5nIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBSZXdyaXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgZ2VuZXJhdGluZyBhbHRlcm5hdGl2ZSBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ0NhbGxiYWNrIH0gZnJvbSAnLi9hZGQtY29tbWFuZCc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBtZXNzYWdlIGFscmVhZHkgbG9nZ2VkIGJ5IGNoYXQgaW5wdXQgaGFuZGxlclxuXG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0OiBFZGl0UmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbWluZ0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBzdHJlYW1pbmcgbW9kZVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoU3RyZWFtaW5nKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0LCBzdHJlYW1pbmdDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHRyYWRpdGlvbmFsIHN5bmNocm9ub3VzIG1vZGUgKGZhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSByZXdyaXRlIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmV3cml0ZShjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIExvZyBvbmx5IGZhaWx1cmVzIGFzIGFzc2lzdGFudCBtZXNzYWdlc1xuICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3Mgd2lsbCBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBzdWNjZXNzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIC8vIEZhaWx1cmUgd2lsbCBhbHNvIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIGVycm9yIGluZGljYXRvclxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSByZXdyaXRlIGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseVJld3JpdGUoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBlbnRpcmUgZG9jdW1lbnQgd2l0aCByZXdyaXR0ZW4gdmVyc2lvblxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBZGQgcmV3cml0dGVuIGNvbnRlbnQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAvLyBSZXdyaXRlIHNlbGVjdGVkIGNvbnRlbnRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQgZm9yIHJld3JpdGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCByZXdyaXR0ZW4gY29udGVudCBhdCBjdXJzb3JcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgcmV3cml0ZSB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIHJld3JpdGVcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAncmV3cml0ZScpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSByZXdyaXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUmV3cml0ZSBpbnN0cnVjdGlvbiBpcyByZXF1aXJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoU3RyZWFtaW5nKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBwcm9tcHQ6IGFueSxcbiAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2s6IFN0cmVhbWluZ0NhbGxiYWNrXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBjb250ZW50IHdpdGggc3RyZWFtaW5nXG4gICAgICAgICAgICBsZXQgZnVsbENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIHRoZSBzdHJlYW1pbmcgZ2VuZXJhdG9yXG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHRTdHJlYW0oXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsQ29udGVudCArPSBjaHVuay5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3J3YXJkIHRvIHRoZSBzdHJlYW1pbmcgY2FsbGJhY2sgd2hpY2ggaGFuZGxlcyBkb2N1bWVudCB1cGRhdGVzXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaWduYWwgY29tcGxldGlvblxuICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoIWZ1bGxDb250ZW50IHx8IGZ1bGxDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJlYW1pbmcgbW9kZSwgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZCB2aWEgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIEp1c3QgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgZmluYWwgY29udGVudFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxDb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24gfHwgeyBsaW5lOiAwLCBjaDogMCB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdTdHJlYW1pbmcgZmFpbGVkJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIE1ldGFkYXRhIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogSGFuZGxlcyB1cGRhdGluZyBkb2N1bWVudCBwcm9wZXJ0aWVzL2Zyb250bWF0dGVyXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogSGFuZGxlcyBtZXRhZGF0YS9wcm9wZXJ0eSB1cGRhdGUgY29tbWFuZHNcbiAqL1xuZXhwb3J0IGNsYXNzIE1ldGFkYXRhQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIG1ldGFkYXRhIHVwZGF0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgZGlyZWN0IHRhZyBvcGVyYXRpb25cbiAgICAgICAgICAgIGNvbnN0IHRhZ1Jlc3VsdCA9IGF3YWl0IHRoaXMuaGFuZGxlRGlyZWN0VGFnT3BlcmF0aW9uKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBpZiAodGFnUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhZ1Jlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0gdGhpcy5wYXJzZVByb3BlcnR5VXBkYXRlcyhhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlcyB8fCBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBtZXRhZGF0YSB1cGRhdGVzLiBBSSByZXNwb25zZTonLCBhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBwcm9wZXJ0eSB1cGRhdGVzIGZvdW5kIGluIEFJIHJlc3BvbnNlJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyB3aGF0IHdlJ3JlIHVwZGF0aW5nIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNZXRhZGF0YSB1cGRhdGVzOicsIHVwZGF0ZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IHRoaXMudXBkYXRlRnJvbnRtYXR0ZXIoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIHVwZGF0ZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBXcml0ZSB0aGUgdXBkYXRlZCBjb250ZW50IGJhY2sgdG8gdGhlIGZpbGUgZGlyZWN0bHlcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShkb2N1bWVudENvbnRleHQuZmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBzdWNjZXNzIG1lc3NhZ2UgYmFzZWQgb24gdXBkYXRlc1xuICAgICAgICAgICAgY29uc3Qgc3VjY2Vzc01lc3NhZ2UgPSB0aGlzLmdlbmVyYXRlU3VjY2Vzc01lc3NhZ2UodXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byB1cGRhdGUgbWV0YWRhdGE6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VQcm9wZXJ0eVVwZGF0ZXMocmVzcG9uc2U6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OIGZpcnN0XG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIFlBTUwtbGlrZSBmb3JtYXRcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAvLyBNYXRjaCBwYXR0ZXJucyBsaWtlIFwia2V5OiB2YWx1ZVwiIG9yIFwiLSBrZXk6IHZhbHVlXCJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL15bLVxcc10qKFteOl0rKTpcXHMqKC4rKSQvKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdmFsdWUgYXMgSlNPTiAoZm9yIGFycmF5cy9vYmplY3RzKVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBub3QgSlNPTiwgdHJlYXQgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVvdGVzIGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuc3RhcnRzV2l0aCgnXCInKSAmJiB2YWx1ZS5lbmRzV2l0aCgnXCInKSkgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlLnN0YXJ0c1dpdGgoXCInXCIpICYmIHZhbHVlLmVuZHNXaXRoKFwiJ1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID4gMCA/IHVwZGF0ZXMgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHBhcnNlIHByb3BlcnR5IHVwZGF0ZXMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyIGluIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZywgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBmcm9udG1hdHRlciBleGlzdHNcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY2xvc2luZyAtLS1cbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlbmRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvcHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZEluZGV4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9wc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgdXBkYXRlcyB3aXRoIGV4aXN0aW5nIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IHsgLi4uZXhpc3RpbmdQcm9wcywgLi4udXBkYXRlcyB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlYnVpbGQgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobWVyZ2VkUHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIG51bGwvdW5kZWZpbmVkIHZhbHVlcyAoYWxsb3dzIGRlbGV0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goJy0tLScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugb2xkIGZyb250bWF0dGVyIHdpdGggbmV3XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgLi4ubmV3RnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKGVuZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBleGlzdHMsIGNyZWF0ZSBuZXdcbiAgICAgICAgY29uc3QgbmV3RnJvbnRtYXR0ZXIgPSBbJy0tLSddO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZyb250bWF0dGVyIHRvIGJlZ2lubmluZyBvZiBkb2N1bWVudFxuICAgICAgICByZXR1cm4gbmV3RnJvbnRtYXR0ZXIuam9pbignXFxuJykgKyBjb250ZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBkaXJlY3QgdGFnIG9wZXJhdGlvbnMgKGFkZCwgcmVtb3ZlLCBzZXQgdGFncylcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZURpcmVjdFRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbjogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IFByb21pc2U8RWRpdFJlc3VsdCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUGFyc2UgdGFnIGNvbW1hbmRzIHdpdGggY29sb24gZm9ybWF0XG4gICAgICAgIGNvbnN0IGNvbG9uTWF0Y2ggPSBsb3dlckluc3RydWN0aW9uLm1hdGNoKC9eKGFkZHxzZXR8dXBkYXRlfHJlbW92ZSlcXHMrdGFncz86XFxzKiguKikkLyk7XG4gICAgICAgIGlmIChjb2xvbk1hdGNoKSB7XG4gICAgICAgICAgICBjb25zdCBhY3Rpb24gPSBjb2xvbk1hdGNoWzFdO1xuICAgICAgICAgICAgY29uc3QgdGFnU3RyaW5nID0gY29sb25NYXRjaFsyXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1RhZ3MgPSB0YWdTdHJpbmcgPyB0YWdTdHJpbmcuc3BsaXQoJywnKS5tYXAodCA9PiB0LnRyaW0oKSkuZmlsdGVyKHQgPT4gdCkgOiBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgXCJhZGQgdGFnc1wiIHdpdGggbm8gc3BlY2lmaWMgdGFncywgdHJlYXQgYXMgQUktcG93ZXJlZCBzdWdnZXN0aW9uXG4gICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnYWRkJyAmJiBuZXdUYWdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmhhbmRsZUFJVGFnT3BlcmF0aW9uKCdhZGQgc3VnZ2VzdGVkIHRhZ3MnLCBkb2N1bWVudENvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgY3VycmVudCB0YWdzXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50VGFncyA9IHRoaXMuZ2V0Q3VycmVudFRhZ3MoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgdXBkYXRlZFRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdGFncyB3aXRob3V0IGR1cGxpY2F0ZXNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnc1RvQWRkID0gbmV3VGFncy5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgIWN1cnJlbnRUYWdzLnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcudG9Mb3dlckNhc2UoKSA9PT0gdGFnLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gWy4uLmN1cnJlbnRUYWdzLCAuLi50YWdzVG9BZGRdO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gdGFnc1RvQWRkLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGBBZGRlZCAke3RhZ3NUb0FkZC5sZW5ndGh9IHRhZyR7dGFnc1RvQWRkLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfTogJHt0YWdzVG9BZGQuam9pbignLCAnKX1gXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICdObyBuZXcgdGFncyB0byBhZGQgKGR1cGxpY2F0ZXMgZmlsdGVyZWQpJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZSc6XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBzcGVjaWZpZWQgdGFnc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb3dlck5ld1RhZ3MgPSBuZXdUYWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZUNvdW50ID0gY3VycmVudFRhZ3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVGFncyA9IGN1cnJlbnRUYWdzLmZpbHRlcih0YWcgPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICAhbG93ZXJOZXdUYWdzLmluY2x1ZGVzKHRhZy50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVkQ291bnQgPSBiZWZvcmVDb3VudCAtIHVwZGF0ZWRUYWdzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IHJlbW92ZWRDb3VudCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYFJlbW92ZWQgJHtyZW1vdmVkQ291bnR9IHRhZyR7cmVtb3ZlZENvdW50ICE9PSAxID8gJ3MnIDogJyd9YFxuICAgICAgICAgICAgICAgICAgICAgICAgOiAnTm8gdGFncyBmb3VuZCB0byByZW1vdmUnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FzZSAnc2V0JzpcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGFsbCB0YWdzXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gWy4uLm5ldyBTZXQobmV3VGFncy5tYXAodCA9PiB0LnRvTG93ZXJDYXNlKCkpKV07XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgU2V0ICR7dXBkYXRlZFRhZ3MubGVuZ3RofSB0YWcke3VwZGF0ZWRUYWdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfWA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgY29udGVudFxuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHsgdGFnczogdXBkYXRlZFRhZ3MgfTtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiAwLCBjaDogMCB9LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgc3VjY2Vzc01lc3NhZ2U6IG1lc3NhZ2VcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBBSS1wb3dlcmVkIHRhZyBvcGVyYXRpb25zXG4gICAgICAgIGlmICgvXFxiKGNsZWFuIHVwfGNsZWFudXB8b3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZSlcXHMrLipcXGJ0YWdzP1xcYi9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHxcbiAgICAgICAgICAgIC9cXGIoc3VnZ2VzdHxyZWNvbW1lbmQpXFxzKy4qXFxidGFncz9cXGIvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pIHx8XG4gICAgICAgICAgICAvXmFkZCBzdWdnZXN0ZWQgdGFncyQvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pIHx8XG4gICAgICAgICAgICAvXmFkZCB0YWdzJC9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHwgIC8vIEhhbmRsZSBzaW1wbGUgXCJhZGQgdGFnc1wiIGFzIEFJIHN1Z2dlc3Rpb25cbiAgICAgICAgICAgIC9edXBkYXRlIHRhZ3MkL2kudGVzdChsb3dlckluc3RydWN0aW9uKSkgeyAgLy8gSGFuZGxlIFwidXBkYXRlIHRhZ3NcIiBhcyBBSSBvcGVyYXRpb25cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlQUlUYWdPcGVyYXRpb24oaW5zdHJ1Y3Rpb24sIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBBSS1wb3dlcmVkIHRhZyBvcGVyYXRpb25zIChzdWdnZXN0LCBvcHRpbWl6ZSwgY2xlYW4gdXApXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVBSVRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbjogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBjdXJyZW50VGFncyA9IHRoaXMuZ2V0Q3VycmVudFRhZ3MoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgQUkgcHJvbXB0IGZvciB0YWcgb3BlcmF0aW9uXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBhdCBkb2N1bWVudCB0YWdnaW5nIGFuZCBtZXRhZGF0YSBvcmdhbml6YXRpb24uIFlvdXIgdGFzayBpcyB0byBhbmFseXplIGRvY3VtZW50cyBhbmQgcHJvdmlkZSBvcHRpbWFsIHRhZ3MuXG5cblJ1bGVzIGZvciB0YWdzOlxuLSBUYWdzIHNob3VsZCBiZSBsb3dlcmNhc2Vcbi0gVXNlIGh5cGhlbnMgZm9yIG11bHRpLXdvcmQgdGFncyAoZS5nLiwgXCJtYWNoaW5lLWxlYXJuaW5nXCIpXG4tIEJlIHNwZWNpZmljIGJ1dCBub3Qgb3Zlcmx5IGdyYW51bGFyXG4tIEFpbSBmb3IgNS0xMCB0YWdzIHBlciBkb2N1bWVudFxuLSBGb2N1cyBvbiBrZXkgY29uY2VwdHMsIHRvcGljcywgYW5kIHRoZW1lcyBGUk9NIFRIRSBBQ1RVQUwgRE9DVU1FTlQgQ09OVEVOVFxuLSBUYWdzIG11c3QgYmUgZGlyZWN0bHkgcmVsZXZhbnQgdG8gdGhlIGRvY3VtZW50J3Mgc3ViamVjdCBtYXR0ZXJcbi0gQXZvaWQgZ2VuZXJpYyB0YWdzIGxpa2UgXCJkb2N1bWVudFwiIG9yIFwidGV4dFwiXG4tIENvbnNpZGVyIHRoZSBkb2N1bWVudCdzIHB1cnBvc2UsIGF1ZGllbmNlLCBhbmQgbWFpbiB0b3BpY3Ncbi0gRXh0cmFjdCB0YWdzIGJhc2VkIG9uIHRoZSBkb2N1bWVudCdzIGFjdHVhbCBjb250ZW50LCBub3QgcmFuZG9tIHRvcGljc1xuXG5JTVBPUlRBTlQ6IEJhc2UgeW91ciB0YWcgc3VnZ2VzdGlvbnMgT05MWSBvbiB0aGUgY29udGVudCBwcm92aWRlZC4gRG8gbm90IGludmVudCB1bnJlbGF0ZWQgdGFncy5cblxuUmV0dXJuIE9OTFkgYSBKU09OIG9iamVjdCB3aXRoIGEgXCJ0YWdzXCIgYXJyYXkgYW5kIGEgXCJyZWFzb25pbmdcIiBmaWVsZCBleHBsYWluaW5nIHlvdXIgY2hvaWNlcy5gO1xuXG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoL2FkZCBzdWdnZXN0ZWQvaS50ZXN0KGluc3RydWN0aW9uKSB8fCAvXmFkZCB0YWdzJC9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENhcmVmdWxseSBhbmFseXplIHRoZSBmb2xsb3dpbmcgZG9jdW1lbnQgYW5kIHN1Z2dlc3QgcmVsZXZhbnQgdGFncyBiYXNlZCBvbiBpdHMgYWN0dWFsIGNvbnRlbnQuXG5cbkN1cnJlbnQgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGggPiAwID8gY3VycmVudFRhZ3Muam9pbignLCAnKSA6ICdub25lJ31cblxuRE9DVU1FTlQgVE8gQU5BTFlaRTpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cbkJhc2VkIG9uIHRoZSBhYm92ZSBkb2N1bWVudCBjb250ZW50LCBzdWdnZXN0IGFkZGl0aW9uYWwgdGFncyB0aGF0OlxuMS4gUmVmbGVjdCB0aGUgYWN0dWFsIHRvcGljcyBkaXNjdXNzZWQgaW4gdGhlIGRvY3VtZW50XG4yLiBDYXB0dXJlIGtleSBjb25jZXB0cywgdGVjaG5vbG9naWVzLCBvciB0aGVtZXMgbWVudGlvbmVkXG4zLiBXb3VsZCBoZWxwIHdpdGggZGlzY292ZXJhYmlsaXR5IGFuZCBvcmdhbml6YXRpb25cbjQuIEFyZSBkaXJlY3RseSByZWxldmFudCB0byB3aGF0IHRoaXMgZG9jdW1lbnQgaXMgYWJvdXRcblxuRE8gTk9UIHN1Z2dlc3QgdGFncyBhYm91dCB0b3BpY3Mgbm90IG1lbnRpb25lZCBpbiB0aGUgZG9jdW1lbnQuYDtcbiAgICAgICAgfSBlbHNlIGlmICgvY2xlYW4gdXB8Y2xlYW51cC9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENsZWFuIHVwIGFuZCBvcHRpbWl6ZSB0aGUgdGFncyBmb3IgdGhpcyBkb2N1bWVudCBieSBhbmFseXppbmcgYm90aCB0aGUgY3VycmVudCB0YWdzIGFuZCB0aGUgZG9jdW1lbnQgY29udGVudC5cblxuQ3VycmVudCB0YWdzOiAke2N1cnJlbnRUYWdzLmpvaW4oJywgJyl9XG5cbkRPQ1VNRU5UIENPTlRFTlQ6XG49PT1TVEFSVCBPRiBET0NVTUVOVD09PVxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1cbj09PUVORCBPRiBET0NVTUVOVD09PVxuXG5UYXNrczpcbjEuIFJlbW92ZSBkdXBsaWNhdGUgb3IgcmVkdW5kYW50IHRhZ3NcbjIuIENvbnNvbGlkYXRlIHNpbWlsYXIgdGFncyAoZS5nLiwgXCJqc1wiIGFuZCBcImphdmFzY3JpcHRcIilcbjMuIFJlbW92ZSB0YWdzIHRoYXQgYXJlbid0IHJlbGV2YW50IHRvIHRoZSBkb2N1bWVudCBjb250ZW50XG40LiBTdGFuZGFyZGl6ZSB0YWcgZm9ybWF0IChsb3dlcmNhc2UsIGh5cGhlbmF0ZWQpXG41LiBFbnN1cmUgcmVtYWluaW5nIHRhZ3MgYWNjdXJhdGVseSByZWZsZWN0IHRoZSBkb2N1bWVudFxuXG5Qcm92aWRlIGEgY2xlYW5lZC11cCB0YWcgbGlzdCBiYXNlZCBvbiB0aGUgYWN0dWFsIGRvY3VtZW50IGNvbnRlbnQuYDtcbiAgICAgICAgfSBlbHNlIGlmICgvb3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZXx1cGRhdGUvaS50ZXN0KGluc3RydWN0aW9uKSkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBBbmFseXplIHRoaXMgZG9jdW1lbnQgdGhvcm91Z2hseSBhbmQgcHJvdmlkZSBhbiBvcHRpbWl6ZWQgc2V0IG9mIHRhZ3MgdGhhdCBhY2N1cmF0ZWx5IHJlcHJlc2VudHMgaXRzIGNvbnRlbnQuXG5cbkN1cnJlbnQgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGggPiAwID8gY3VycmVudFRhZ3Muam9pbignLCAnKSA6ICdub25lJ31cblxuRE9DVU1FTlQgVE8gQU5BTFlaRTpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cblRhc2tzOlxuMS4gUmV2aWV3IHRoZSBkb2N1bWVudCBjb250ZW50IGNhcmVmdWxseVxuMi4gUmVtb3ZlIGFueSB0YWdzIHRoYXQgYXJlbid0IHJlbGV2YW50IHRvIHRoZSBhY3R1YWwgY29udGVudFxuMy4gQWRkIHRhZ3MgZm9yIGltcG9ydGFudCBjb25jZXB0cywgdG9waWNzLCBvciB0aGVtZXMgdGhhdCBhcmUgbWlzc2luZ1xuNC4gRW5zdXJlIGFsbCB0YWdzIGRpcmVjdGx5IHJlbGF0ZSB0byB3aGF0J3MgZGlzY3Vzc2VkIGluIHRoZSBkb2N1bWVudFxuNS4gQWltIGZvciA1LTEwIGhpZ2hseSByZWxldmFudCB0YWdzXG5cblByb3ZpZGUgYW4gb3B0aW1pemVkIHRhZyBsaXN0IHRoYXQgYmVzdCByZXByZXNlbnRzIFRISVMgU1BFQ0lGSUMgZG9jdW1lbnQncyBjb250ZW50LmA7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVXNlIHVuaWZpZWQgYXBwcm9hY2ggZm9yIGFsbCBwcm92aWRlcnNcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRNYXhUb2tlbnMgPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZXREZWZhdWx0TWF4VG9rZW5zKCk7XG4gICAgICAgICAgICBjb25zdCBhaVJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IGRlZmF1bHRNYXhUb2tlbnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSBBSSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZUFJVGFnUmVzcG9uc2UoYWlSZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoIXBhcnNlZCB8fCAhcGFyc2VkLnRhZ3MgfHwgcGFyc2VkLnRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gU2hvdyB0aGUgYWN0dWFsIEFJIHJlc3BvbnNlIGluIHRoZSBlcnJvciBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlldyA9IGFpUmVzcG9uc2UubGVuZ3RoID4gMTAwIFxuICAgICAgICAgICAgICAgICAgICA/IGFpUmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJyBcbiAgICAgICAgICAgICAgICAgICAgOiBhaVJlc3BvbnNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYENvdWxkIG5vdCBwYXJzZSBBSSB0YWcgc3VnZ2VzdGlvbnMuIEFJIHJlc3BvbnNlOiBcIiR7cHJldmlld31cImAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGFnc1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHsgdGFnczogcGFyc2VkLnRhZ3MgfTtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgYXBwcm9wcmlhdGUgbWVzc2FnZVxuICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgICAgICAgICAgIGlmICgvYWRkIHN1Z2dlc3RlZC9pLnRlc3QoaW5zdHJ1Y3Rpb24pIHx8IC9eYWRkIHRhZ3MkL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhZGRlZFRhZ3MgPSBwYXJzZWQudGFncy5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgICAgICAgICAhY3VycmVudFRhZ3Muc29tZShleGlzdGluZyA9PiBleGlzdGluZy50b0xvd2VyQ2FzZSgpID09PSB0YWcudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgQWRkZWQgJHthZGRlZFRhZ3MubGVuZ3RofSBzdWdnZXN0ZWQgdGFnJHthZGRlZFRhZ3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9OiAke2FkZGVkVGFncy5qb2luKCcsICcpfWA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKC9jbGVhbiB1cHxjbGVhbnVwL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYENsZWFuZWQgdXAgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGh9IFx1MjE5MiAke3BhcnNlZC50YWdzLmxlbmd0aH0gdGFnc2A7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgT3B0aW1pemVkIHRhZ3M6ICR7cGFyc2VkLnRhZ3MubGVuZ3RofSB0YWcke3BhcnNlZC50YWdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSAod2FzICR7Y3VycmVudFRhZ3MubGVuZ3RofSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogdXBkYXRlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmU6IDAsIGNoOiAwIH0sXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZTogbWVzc2FnZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGBGYWlsZWQgdG8gcHJvY2VzcyB0YWcgb3BlcmF0aW9uOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCB0YWdzIGZyb20gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Q3VycmVudFRhZ3MoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBpZiAoIWNvbnRlbnQpIHJldHVybiBbXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobGluZXMubGVuZ3RoID4gMCAmJiBsaW5lc1swXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgIGxldCBpbkZyb250bWF0dGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoICYmIGluRnJvbnRtYXR0ZXI7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ01hdGNoID0gbGluZXNbaV0ubWF0Y2goL150YWdzOlxccyooLiopJC8pO1xuICAgICAgICAgICAgICAgIGlmICh0YWdNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdWYWx1ZSA9IHRhZ01hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFnVmFsdWUpIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSBwYXJzaW5nIGFzIEpTT04gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UodGFnVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyc2VkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZWQuZmlsdGVyKHQgPT4gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IEpTT04sIHRyeSBjb21tYS1zZXBhcmF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWdWYWx1ZS5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKS5maWx0ZXIodCA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTm8gZnJvbnRtYXR0ZXIgb3Igbm8gdGFncyBmb3VuZFxuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgQUkgcmVzcG9uc2UgZm9yIHRhZyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBwYXJzZUFJVGFnUmVzcG9uc2UocmVzcG9uc2U6IHN0cmluZyk6IHsgdGFnczogc3RyaW5nW10sIHJlYXNvbmluZz86IHN0cmluZyB9IHwgbnVsbCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDbGVhbiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuUmVzcG9uc2UgPSByZXNwb25zZS50cmltKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gZnJvbSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QganNvbk1hdGNoID0gY2xlYW5SZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkLnRhZ3MgJiYgQXJyYXkuaXNBcnJheShwYXJzZWQudGFncykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogcGFyc2VkLnRhZ3MubWFwKCh0OiBhbnkpID0+IFN0cmluZyh0KS50b0xvd2VyQ2FzZSgpLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICctJykpLmZpbHRlcigodDogc3RyaW5nKSA9PiB0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25pbmc6IHBhcnNlZC5yZWFzb25pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEpTT04gcGFyc2UgZmFpbGVkLCBjb250aW51ZSB0byBvdGhlciBmb3JtYXRzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdmFyaW91cyBsaXN0IGZvcm1hdHNcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm5zID0gW1xuICAgICAgICAgICAgICAgIC8vIEpTT04gYXJyYXk6IHRhZ3M6IFtcInRhZzFcIiwgXCJ0YWcyXCJdXG4gICAgICAgICAgICAgICAgL3RhZ3M/OlxccypcXFsoW15cXF1dKylcXF0vaSxcbiAgICAgICAgICAgICAgICAvLyBDb21tYSBsaXN0OiBUYWdzOiB0YWcxLCB0YWcyLCB0YWczXG4gICAgICAgICAgICAgICAgL3RhZ3M/OlxccyooW15cXG5dKz8pKD86XFxufCQpL2ksXG4gICAgICAgICAgICAgICAgLy8gQnVsbGV0IGxpc3Q6IC0gdGFnMVxcbi0gdGFnMlxuICAgICAgICAgICAgICAgIC8oPzp0YWdzPzopP1xccyooPzpcXG4pPyhcXHMqWy1cdTIwMjIqXVxccyouKyg/OlxcblxccypbLVx1MjAyMipdXFxzKi4rKSopL2ksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGNsZWFuUmVzcG9uc2UubWF0Y2gocGF0dGVybik7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0YWdTdHJpbmcgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgYnVsbGV0IGxpc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWdTdHJpbmcuaW5jbHVkZXMoJy0nKSB8fCB0YWdTdHJpbmcuaW5jbHVkZXMoJ1x1MjAyMicpIHx8IHRhZ1N0cmluZy5pbmNsdWRlcygnKicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzID0gdGFnU3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9cXG4vKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKGxpbmU6IHN0cmluZykgPT4gbGluZS5yZXBsYWNlKC9eXFxzKlstXHUyMDIyKl1cXHMqLywgJycpLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh0OiBzdHJpbmcpID0+IHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGNvbW1hLXNlcGFyYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFncyA9IHRhZ1N0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgodDogc3RyaW5nKSA9PiB0LnRyaW0oKS5yZXBsYWNlKC9bXCInXS9nLCAnJykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigodDogc3RyaW5nKSA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogdGFncy5tYXAodCA9PiB0LnRvTG93ZXJDYXNlKCkudHJpbSgpLnJlcGxhY2UoL1xccysvZywgJy0nKSkuZmlsdGVyKHQgPT4gdClcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExhc3QgcmVzb3J0OiBleHRyYWN0IGFueSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBhZnRlciBcInN1Z2dlc3RcIiBvciBcInJlY29tbWVuZFwiXG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0TWF0Y2ggPSBjbGVhblJlc3BvbnNlLm1hdGNoKC8oPzpzdWdnZXN0fHJlY29tbWVuZHxwcm9wb3NlfGhlcmUgYXJlfHRhZ3MgYXJlKVs6XFxzXSsoW14uXSspL2kpO1xuICAgICAgICAgICAgaWYgKHN1Z2dlc3RNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3MgPSBzdWdnZXN0TWF0Y2hbMV1cbiAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9bLFxcbl0vKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHQgPT4gdC50cmltKCkucmVwbGFjZSgvW1wiJ10vZywgJycpLnJlcGxhY2UoL15hbmRcXHMrL2ksICcnKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0ID0+IHQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiB0YWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKS50cmltKCkpLmZpbHRlcih0ID0+IHQpXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGaW5hbCBmYWxsYmFjazogdHJlYXQgZWFjaCBsaW5lIGFzIGEgdGFnIChmb3IgR29vZ2xlJ3Mgc2ltcGxlIGZvcm1hdClcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY2xlYW5SZXNwb25zZS5zcGxpdCgnXFxuJykubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihsaW5lID0+IGxpbmUpO1xuICAgICAgICAgICAgY29uc3QgdmFsaWRUYWdzID0gbGluZXNcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGxpbmVzIHRoYXQgYXJlIGNsZWFybHkgbm90IHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUubGVuZ3RoID4gMCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUubGVuZ3RoIDwgNTAgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS5pbmNsdWRlcygnOicpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0YWcnKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaGVyZScpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzdWdnZXN0Jyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cCB0aGUgbGluZSBhbmQgY29udmVydCBzcGFjZXMgdG8gaHlwaGVuc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXlstXHUyMDIyKiNdXFxzKi8sICcnKSAvLyBSZW1vdmUgYnVsbGV0IHBvaW50cyBhbmQgaGFzaHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9eXFxkK1xcLlxccyovLCAnJykgLy8gUmVtb3ZlIG51bWJlcmVkIGxpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnLScpOyAvLyBDb252ZXJ0IHNwYWNlcyB0byBoeXBoZW5zXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHRhZyA9PiB0YWcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodmFsaWRUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB0YWdzOiB2YWxpZFRhZ3MgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgd2Ugc3RpbGwgY2FuJ3QgcGFyc2UsIGxvZyB0aGUgcmVzcG9uc2UgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIEFJIHRhZyByZXNwb25zZTonLCBjbGVhblJlc3BvbnNlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBBSSB0YWcgcmVzcG9uc2U6JywgZXJyb3IsICdSZXNwb25zZSB3YXM6JywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBzdWNjZXNzIG1lc3NhZ2UgYmFzZWQgb24gdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVTdWNjZXNzTWVzc2FnZSh1cGRhdGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpO1xuICAgICAgICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHJldHVybiAnTWV0YWRhdGEgdXBkYXRlZCc7XG4gICAgICAgIFxuICAgICAgICBpZiAoa2V5cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGtleXNbMF07XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAndGFncycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb3VudCA9IEFycmF5LmlzQXJyYXkodXBkYXRlcy50YWdzKSA/IHVwZGF0ZXMudGFncy5sZW5ndGggOiAwO1xuICAgICAgICAgICAgICAgIHJldHVybiBgVXBkYXRlZCB0YWdzICgke2NvdW50fSB0YWcke2NvdW50ICE9PSAxID8gJ3MnIDogJyd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYFVwZGF0ZWQgJHtrZXl9YDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGBVcGRhdGVkICR7a2V5cy5sZW5ndGh9IHByb3BlcnRpZXNgO1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBzdXBlcm5vdmFEYXRlOiBzdHJpbmc7ICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGdlbmVyYWxEYXRlOiBzdHJpbmc7ICAgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIEZlYXR1cmUgcmVsZWFzZSBjb25maWd1cmF0aW9uIGZvciBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIG1vZGVsXG4gKiBTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gc3VwZXJub3ZhRGF0ZVxuICogQWxsIHVzZXJzIGdldCBmZWF0dXJlcyBvbiBnZW5lcmFsRGF0ZVxuICogXG4gKiBEYXRlcyBhcmUgaW4gWVlZWS1NTS1ERCBmb3JtYXQgYW5kIGVhc3kgdG8gbW9kaWZ5IHBvc3QtbGF1bmNoXG4gKi9cbmV4cG9ydCBjb25zdCBTVVBFUk5PVkFfRkVBVFVSRVM6IFJlY29yZDxzdHJpbmcsIFRpbWVHYXRlZEZlYXR1cmU+ID0ge1xuICAgIC8vIENvbW1hbmRzICh1bmlmaWVkKSAtIDIgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmRzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNy0zMScsICAvLyBTdXBlcm5vdmEgZWFybHkgYWNjZXNzXG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOS0zMCcsICAgLy8gR2VuZXJhbCBhdmFpbGFiaWxpdHkgXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29tbWFuZCBzeXN0ZW0gd2l0aCA6IHRyaWdnZXJzLCBjb21tYW5kIGJ1dHRvbiwgYW5kIGN1c3RvbSBjb21tYW5kcydcbiAgICB9LFxuICAgIFxuICAgIC8vIEF1dG8tZ3Jvd2luZyBpbnB1dCAtIDEgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2F1dG8taW5wdXQnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA3LTE1JywgICAvLyAxIG1vbnRoIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0by1ncm93aW5nIGlucHV0IGFyZWEgd2l0aCBzbW9vdGggdHJhbnNpdGlvbnMnXG4gICAgfSxcbiAgICBcbiAgICAvLyBFbmhhbmNlZCBwcm92aWRlciBtYW5hZ2VtZW50IC0gMiBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnZW5oYW5jZWQtcHJvdmlkZXJzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOC0xNScsICAgLy8gMiBtb250aHMgbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZHZhbmNlZCBwcm92aWRlciBjb25maWd1cmF0aW9uIGFuZCBzd2l0Y2hpbmcnXG4gICAgfVxufTtcblxuLyoqXG4gKiBDb3JlIGZlYXR1cmVzIHRoYXQgYXJlIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG4gKiBUaGVzZSBhcmUgTk9UIHRpbWUtZ2F0ZWRcbiAqL1xuZXhwb3J0IGNvbnN0IENPUkVfRkVBVFVSRVMgPSBbXG4gICAgJ2Jhc2ljX2VkaXRpbmcnLCAgICAgICAgICAvLyBBZGQsIGVkaXQsIGRlbGV0ZSwgZ3JhbW1hciwgcmV3cml0ZSBjb21tYW5kc1xuICAgICdhbGxfYWlfcHJvdmlkZXJzJywgICAgICAgLy8gQ2xhdWRlLCBPcGVuQUksIEdvb2dsZSwgT2xsYW1hXG4gICAgJ2ZpbGVfY29udmVyc2F0aW9ucycsICAgICAvLyBGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICdwcm92aWRlcl9zd2l0Y2hpbmcnLCAgICAgLy8gU3dpdGNoIHByb3ZpZGVycyBpbiBjaGF0XG4gICAgJ21vYmlsZV9hY2Nlc3MnLCAgICAgICAgICAvLyBGdWxsIG1vYmlsZSBzdXBwb3J0XG4gICAgJ2FwaV9rZXlfY29uZmlnJywgICAgICAgICAvLyBDb25maWd1cmUgb3duIEFQSSBrZXlzXG4gICAgJ3NpZGViYXJfY2hhdCcsICAgICAgICAgICAvLyBDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyXG4gICAgJ2RvY3VtZW50X2NvbnRleHQnLCAgICAgICAvLyBDdXJyZW50IGRvY3VtZW50IGNvbnRleHRcbiAgICAnbXVsdGktZG9jLWNvbnRleHQnICAgICAgIC8vIFJlZmVyZW5jZSBvdGhlciBkb2N1bWVudHMgd2l0aCBbW2RvY11dIHN5bnRheFxuXTsiLCAiaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgU3VwZXJub3ZhTGljZW5zZSwgRmVhdHVyZUZsYWcsIEZlYXR1cmVBY2Nlc3NSZXN1bHQsIERlYnVnU2V0dGluZ3MsIFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IFNVUEVSTk9WQV9GRUFUVVJFUywgQ09SRV9GRUFUVVJFUywgVGltZUdhdGVkRmVhdHVyZSB9IGZyb20gJy4vZmVhdHVyZS1jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgRmVhdHVyZU1hbmFnZXIge1xuXHRwcml2YXRlIGZlYXR1cmVzOiBNYXA8c3RyaW5nLCBGZWF0dXJlRmxhZz4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc3VwZXJub3ZhTGljZW5zZTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzU3VwZXJub3ZhOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIGxpY2Vuc2VWYWxpZGF0b3I6IExpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0ZGVidWdTZXR0aW5ncz86IERlYnVnU2V0dGluZ3Ncblx0KSB7XG5cdFx0aWYgKGRlYnVnU2V0dGluZ3MpIHtcblx0XHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IGRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemUgYWxsIGZlYXR1cmUgZmxhZ3Ncblx0ICogQ29yZSBmZWF0dXJlcyBhcmUgYWx3YXlzIGVuYWJsZWRcblx0ICogVGltZS1nYXRlZCBmZWF0dXJlcyBkZXBlbmQgb24gY3VycmVudCBkYXRlIGFuZCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRwcml2YXRlIGluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTogdm9pZCB7XG5cdFx0Ly8gQ29yZSBmZWF0dXJlcyAtIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG5cdFx0Q09SRV9GRUFUVVJFUy5mb3JFYWNoKGZlYXR1cmVLZXkgPT4ge1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXk6IGZlYXR1cmVLZXksXG5cdFx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiB0aGlzLmdldENvcmVGZWF0dXJlRGVzY3JpcHRpb24oZmVhdHVyZUtleSlcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gVGltZS1nYXRlZCBmZWF0dXJlcyAtIGF2YWlsYWJsZSBiYXNlZCBvbiBkYXRlXG5cdFx0T2JqZWN0LmVudHJpZXMoU1VQRVJOT1ZBX0ZFQVRVUkVTKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XG5cdFx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5pc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGtleSwgY29uZmlnKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5LFxuXHRcdFx0XHRlbmFibGVkLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuXHRcdFx0XHRpc1RpbWVHYXRlZDogdHJ1ZSxcblx0XHRcdFx0ZWFybHlBY2Nlc3NPbmx5OiAhdGhpcy5pc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWcpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVzY3JpcHRpb24gZm9yIGNvcmUgZmVhdHVyZXNcblx0ICovXG5cdHByaXZhdGUgZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihrZXk6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgZGVzY3JpcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2Jhc2ljX2VkaXRpbmcnOiAnQmFzaWMgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kcyAoYWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUpJyxcblx0XHRcdCdhbGxfYWlfcHJvdmlkZXJzJzogJ0FjY2VzcyB0byBhbGwgQUkgcHJvdmlkZXJzIChDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWEpJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnOiAnRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZyc6ICdTd2l0Y2ggQUkgcHJvdmlkZXJzIGRpcmVjdGx5IGluIGNoYXQgaW50ZXJmYWNlJyxcblx0XHRcdCdtb2JpbGVfYWNjZXNzJzogJ0Z1bGwgbW9iaWxlIGRldmljZSBzdXBwb3J0Jyxcblx0XHRcdCdhcGlfa2V5X2NvbmZpZyc6ICdDb25maWd1cmUgeW91ciBvd24gQVBJIGtleXMnLFxuXHRcdFx0J3NpZGViYXJfY2hhdCc6ICdDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyJyxcblx0XHRcdCdkb2N1bWVudF9jb250ZXh0JzogJ0N1cnJlbnQgZG9jdW1lbnQgY29udGV4dCBpbiBjb252ZXJzYXRpb25zJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGRlc2NyaXB0aW9uc1trZXldIHx8IGtleTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIHRpbWUtZ2F0ZWQgZmVhdHVyZSBzaG91bGQgYmUgZW5hYmxlZFxuXHQgKi9cblx0cHJpdmF0ZSBpc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZywgY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IHN1cGVybm92YURhdGUgPSBuZXcgRGF0ZShjb25maWcuc3VwZXJub3ZhRGF0ZSk7XG5cdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gZXZlcnlvbmUgYWZ0ZXIgZ2VuZXJhbCBkYXRlXG5cdFx0aWYgKG5vdyA+PSBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgYWZ0ZXIgc3VwZXJub3ZhIGRhdGVcblx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA+PSBzdXBlcm5vdmFEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBTdXBlcm5vdmEgc3RhdHVzIChjYW4gYmUgb3ZlcnJpZGRlbiBpbiBkZWJ1ZyBtb2RlKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRJc1N1cGVybm92YSgpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgJiYgdGhpcy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmlzU3VwZXJub3ZhO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGEgbmV3IGZlYXR1cmUgZmxhZ1xuXHQgKi9cblx0cmVnaXN0ZXJGZWF0dXJlKGZsYWc6IEZlYXR1cmVGbGFnKTogdm9pZCB7XG5cdFx0dGhpcy5mZWF0dXJlcy5zZXQoZmxhZy5rZXksIGZsYWcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBhbmQgcmVjYWxjdWxhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0ICovXG5cdGFzeW5jIHVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghbGljZW5zZUtleSkge1xuXHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gbnVsbDtcblx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMubGljZW5zZVZhbGlkYXRvci52YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbi52YWxpZCAmJiB2YWxpZGF0aW9uLmxpY2Vuc2UpIHtcblx0XHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gdmFsaWRhdGlvbi5saWNlbnNlO1xuXHRcdFx0XHR0aGlzLmlzU3VwZXJub3ZhID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuc3VwZXJub3ZhTGljZW5zZSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCB1cGRhdGVkIFN1cGVybm92YSBzdGF0dXNcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRpc1N1cGVybm92YVN1cHBvcnRlcigpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRJc1N1cGVybm92YSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IFN1cGVybm92YSBsaWNlbnNlXG5cdCAqL1xuXHRnZXRTdXBlcm5vdmFMaWNlbnNlKCk6IFN1cGVybm92YUxpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5zdXBlcm5vdmFMaWNlbnNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgZmVhdHVyZSBpcyBlbmFibGVkXG5cdCAqL1xuXHRpc0ZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdC8vIEhhbmRsZSBvbGQgZmVhdHVyZSBrZXlzIHRoYXQgbWlnaHQgc3RpbGwgYmUgcmVmZXJlbmNlZFxuXHRcdGlmICh0aGlzLmlzTGVnYWN5RmVhdHVyZUtleShmZWF0dXJlS2V5KSkge1xuXHRcdFx0cmV0dXJuIHRydWU7IC8vIEFsbCBsZWdhY3kgZmVhdHVyZXMgYXJlIG5vdyBlbmFibGVkIGZvciBldmVyeW9uZVxuXHRcdH1cblxuXHRcdGNvbnN0IGZlYXR1cmUgPSB0aGlzLmZlYXR1cmVzLmdldChmZWF0dXJlS2V5KTtcblx0XHRyZXR1cm4gZmVhdHVyZT8uZW5hYmxlZCA/PyBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiB0aGlzIGlzIGEgbGVnYWN5IGZlYXR1cmUga2V5IHRoYXQgc2hvdWxkIGFsd2F5cyBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzTGVnYWN5RmVhdHVyZUtleShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGxlZ2FjeUtleXMgPSBbXG5cdFx0XHQnYmFzaWNfZWRpdGluZycsXG5cdFx0XHQnbG9jYWxfYWlfcHJvdmlkZXJzJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnLFxuXHRcdFx0J3NpbmdsZV9jbG91ZF9wcm92aWRlcicsXG5cdFx0XHQndW5saW1pdGVkX2Nsb3VkX2FpJyxcblx0XHRcdCdwcm92aWRlcl9zd2l0Y2hpbmcnLFxuXHRcdFx0J21vYmlsZV9hY2Nlc3MnLFxuXHRcdFx0J2FkdmFuY2VkX3RlbXBsYXRlcycsXG5cdFx0XHQnYmF0Y2hfb3BlcmF0aW9ucycsXG5cdFx0XHQnY3Jvc3NfZG9jdW1lbnRfY29udGV4dCcsXG5cdFx0XHQncHJpb3JpdHlfc3VwcG9ydCdcblx0XHRdO1xuXHRcdHJldHVybiBsZWdhY3lLZXlzLmluY2x1ZGVzKGtleSk7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgZmVhdHVyZSBhY2Nlc3Mgd2l0aCBkZXRhaWxlZCByZXN1bHRcblx0ICovXG5cdGNoZWNrRmVhdHVyZUFjY2VzcyhmZWF0dXJlS2V5OiBzdHJpbmcpOiBGZWF0dXJlQWNjZXNzUmVzdWx0IHtcblx0XHQvLyBIYW5kbGUgbGVnYWN5IGZlYXR1cmVzXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdFxuXHRcdGlmICghZmVhdHVyZSkge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLCBcblx0XHRcdFx0cmVhc29uOiBgRmVhdHVyZSAnJHtmZWF0dXJlS2V5fScgbm90IGZvdW5kYCBcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0cmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xuXHRcdH1cblxuXHRcdC8vIEZvciB0aW1lLWdhdGVkIGZlYXR1cmVzLCBwcm92aWRlIG1vcmUgaW5mb3JtYXRpb25cblx0XHRpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2ZlYXR1cmVLZXldO1xuXHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0XHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRcdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblxuXHRcdFx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IHN1cGVybm92YURhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgd2lsbCBiZSBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgb24gJHtjb25maWcuc3VwZXJub3ZhRGF0ZX1gLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmFGZWF0dXJlOiB0cnVlLFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogc3VwZXJub3ZhRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIXRoaXMuZ2V0SXNTdXBlcm5vdmEoKSAmJiBub3cgPCBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gSXQgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uICR7Y29uZmlnLmdlbmVyYWxEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBnZW5lcmFsRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRyZWFzb246ICdGZWF0dXJlIGlzIG5vdCBhdmFpbGFibGUnXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYWxsIGVuYWJsZWQgZmVhdHVyZXNcblx0ICovXG5cdGdldEVuYWJsZWRGZWF0dXJlcygpOiBGZWF0dXJlRmxhZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmZlYXR1cmVzLnZhbHVlcygpKS5maWx0ZXIoZmVhdHVyZSA9PiBmZWF0dXJlLmVuYWJsZWQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgU3VwZXJub3ZhIGVhcmx5IGFjY2VzcyBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0U3VwZXJub3ZhRmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHRmZWF0dXJlLmlzVGltZUdhdGVkICYmIGZlYXR1cmUuZWFybHlBY2Nlc3NPbmx5XG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IHRlc3Rpbmdcblx0ICovXG5cdHVwZGF0ZURlYnVnU2V0dGluZ3Moc2V0dGluZ3M6IERlYnVnU2V0dGluZ3MpOiB2b2lkIHtcblx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCBuZXcgZGVidWcgc2V0dGluZ3Ncblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeVxuXHQgKi9cblx0Z2V0RmVhdHVyZVN1bW1hcnkoKTogeyBcblx0XHRpc1N1cGVybm92YTogYm9vbGVhbjsgXG5cdFx0ZW5hYmxlZDogc3RyaW5nW107IFxuXHRcdGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+IFxuXHR9IHtcblx0XHRjb25zdCBlbmFibGVkOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+ID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZlYXR1cmUuaXNUaW1lR2F0ZWQpIHtcblx0XHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2tleV07XG5cdFx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YVVzZXIgPSB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cdFx0XHRcdFx0Y29taW5nU29vbi5wdXNoKHtcblx0XHRcdFx0XHRcdGtleSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGlzU3VwZXJub3ZhVXNlciA/IGNvbmZpZy5zdXBlcm5vdmFEYXRlIDogY29uZmlnLmdlbmVyYWxEYXRlLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmE6IGlzU3VwZXJub3ZhVXNlclxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHsgXG5cdFx0XHRpc1N1cGVybm92YTogdGhpcy5nZXRJc1N1cGVybm92YSgpLCBcblx0XHRcdGVuYWJsZWQsIFxuXHRcdFx0Y29taW5nU29vbiBcblx0XHR9O1xuXHR9XG59IiwgImltcG9ydCB7IExpY2Vuc2UsIFN1cGVybm92YUxpY2Vuc2UsIExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0LCBTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0LCBMaWNlbnNlRXJyb3IgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIExpY2Vuc2VWYWxpZGF0b3Ige1xuXHQvLyBFbWJlZGRlZCBzaWduaW5nIGtleSAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSBvYmZ1c2NhdGVkXG5cdHByaXZhdGUgcmVhZG9ubHkgU0VDUkVUX0tFWSA9ICdub3ZhLWxpY2Vuc2Utc2lnbmluZy1rZXktMjAyNSc7XG5cdFxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBrZXkgYW5kIHJldHVybnMgdmFsaWRhdGlvbiByZXN1bHRcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgbGljZW5zZSBrZXkgc3RyaW5nIGludG8gYSBMaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBMaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0aWVyfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0aWVyLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFNraXAgdGllciB2YWxpZGF0aW9uIHNpbmNlIHdlJ3JlIHJlbW92aW5nIHRpZXJzXG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBkZWNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RGVjb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYXRvYihzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGVuY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjRFbmNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBidG9hKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IExpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0J2xlZ2FjeScsIC8vIFVzZSBsZWdhY3kgZm9yIG9sZCBsaWNlbnNlc1xuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlIChwcmV2ZW50IGZ1dHVyZS1kYXRlZCBsaWNlbnNlcylcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIGxpY2Vuc2UgZGF0YVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHRpZXI6IHN0cmluZyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50IHB1cnBvc2VzXG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0TGljZW5zZShlbWFpbDogc3RyaW5nLCB0aWVyOiBzdHJpbmcsIGxpZmV0aW1lTW9kZSA9IHRydWUpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSBsaWZldGltZU1vZGUgPyBudWxsIDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyAxIHllYXJcblxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoZW1haWwsIHRpZXIsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nKTogUHJvbWlzZTxTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlU3VwZXJub3ZhTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IHN0cmluZ1xuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZVN1cGVybm92YUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgZm9ybWF0OiBiYXNlNjQoZW1haWx8dHlwZXxleHBpcmVzQXR8aXNzdWVkQXR8c2lnbmF0dXJlKVxuXHRcdFx0Y29uc3QgZGVjb2RlZCA9IHRoaXMuYmFzZTY0RGVjb2RlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBkZWNvZGVkLnNwbGl0KCd8Jyk7XG5cdFx0XHRcblx0XHRcdGlmIChwYXJ0cy5sZW5ndGggIT09IDUpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IFtlbWFpbCwgdHlwZSwgZXhwaXJlc0F0U3RyLCBpc3N1ZWRBdFN0ciwgc2lnbmF0dXJlXSA9IHBhcnRzO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSB0eXBlXG5cdFx0XHRpZiAodHlwZSAhPT0gJ2FubnVhbCcgJiYgdHlwZSAhPT0gJ2xpZmV0aW1lJykge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdHR5cGU6IHR5cGUgYXMgJ2FubnVhbCcgfCAnbGlmZXRpbWUnLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IFN1cGVybm92YUxpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdXBlcm5vdmFTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50eXBlLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBTdXBlcm5vdmEgbGljZW5zZVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHR5cGU6ICdhbm51YWwnIHwgJ2xpZmV0aW1lJyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3R5cGV9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IFN1cGVybm92YSBsaWNlbnNlIGZvciBkZXZlbG9wbWVudFxuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdFN1cGVybm92YUxpY2Vuc2UoZW1haWw6IHN0cmluZywgdHlwZTogJ2FubnVhbCcgfCAnbGlmZXRpbWUnKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gdHlwZSA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDEgeWVhclxuXG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShlbWFpbCwgdHlwZSwgZXhwaXJlc0F0LCBpc3N1ZWRBdCk7XG5cdFx0XG5cdFx0Y29uc3QgbGljZW5zZURhdGEgPSBgJHtlbWFpbH18JHt0eXBlfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9fCR7c2lnbmF0dXJlfWA7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmFzZTY0RW5jb2RlKGxpY2Vuc2VEYXRhKTtcblx0fVxufSIsICIvKipcbiAqIEFJIEludGVudCBDbGFzc2lmaWVyIGZvciBOb3ZhXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdXNlciBpbnB1dCBpcyBhIGNoYXQsIG1ldGFkYXRhIGNvbW1hbmQsIG9yIGNvbnRlbnQgY29tbWFuZFxuICovXG5cbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5cbmV4cG9ydCB0eXBlIFVzZXJJbnRlbnQgPSAnQ0hBVCcgfCAnTUVUQURBVEEnIHwgJ0NPTlRFTlQnO1xuXG5leHBvcnQgY2xhc3MgQUlJbnRlbnRDbGFzc2lmaWVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogQ2xhc3NpZnkgdXNlciBpbnB1dCBpbnRvIG9uZSBvZiB0aHJlZSBpbnRlbnRzXG4gICAgICovXG4gICAgYXN5bmMgY2xhc3NpZnlJbnRlbnQodXNlcklucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxVc2VySW50ZW50PiB7XG4gICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIHN5bnRheCBmaXJzdFxuICAgICAgICBpZiAodXNlcklucHV0LnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgLy8gQ29sb24gY29tbWFuZHMgYXJlIHR5cGljYWxseSBwcm92aWRlciBzd2l0Y2hlcyBvciBjdXN0b20gY29tbWFuZHNcbiAgICAgICAgICAgIHJldHVybiAnQ0hBVCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbHdheXMgdXNlIGZhbGxiYWNrIGZvciBub3cgLSBBSSBjbGFzc2lmaWNhdGlvbiBpcyBjYXVzaW5nIGlzc3Vlc1xuICAgICAgICAvLyBXZSBjYW4gcmUtZW5hYmxlIHRoaXMgb25jZSB3ZSBoYXZlIGEgbW9yZSByZWxpYWJsZSBhcHByb2FjaFxuICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvKiBEaXNhYmxlZCBBSSBjbGFzc2lmaWNhdGlvbiBkdWUgdG8gcHJvdmlkZXIgY29tcGF0aWJpbGl0eSBpc3N1ZXNcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNpbXBsaWZpZWQgcHJvbXB0IGZvciBiZXR0ZXIgY29tcGF0aWJpbGl0eVxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYENsYXNzaWZ5IHRoaXMgdGV4dCBhcyBDSEFULCBNRVRBREFUQSwgb3IgQ09OVEVOVDpcblwiJHt1c2VySW5wdXR9XCJcblxuQ0hBVCA9IHF1ZXN0aW9ucy9kaXNjdXNzaW9uXG5NRVRBREFUQSA9IHRhZ3MvcHJvcGVydGllcy9mcm9udG1hdHRlclxuQ09OVEVOVCA9IGVkaXQgZG9jdW1lbnQgdGV4dFxuXG5BbnN3ZXIgd2l0aCBvbmUgd29yZCBvbmx5OmA7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoJycsIHByb21wdCwge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAxMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gcmVzcG9uc2UudHJpbSgpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHJlc3BvbnNlXG4gICAgICAgICAgICBpZiAoY2xhc3NpZmljYXRpb24gPT09ICdDSEFUJyB8fCBjbGFzc2lmaWNhdGlvbiA9PT0gJ01FVEFEQVRBJyB8fCBjbGFzc2lmaWNhdGlvbiA9PT0gJ0NPTlRFTlQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzaWZpY2F0aW9uIGFzIFVzZXJJbnRlbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIGhldXJpc3RpYyBpZiBBSSBnaXZlcyB1bmV4cGVjdGVkIHJlc3BvbnNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBSSBpbnRlbnQgY2xhc3NpZmljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgICAgIC8vIFVzZSBmYWxsYmFjayBoZXVyaXN0aWNcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0KTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNpbXBsZSBoZXVyaXN0aWMgZmFsbGJhY2sgZm9yIHdoZW4gQUkgY2xhc3NpZmljYXRpb24gZmFpbHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0OiBzdHJpbmcpOiBVc2VySW50ZW50IHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnB1dCA9IHVzZXJJbnB1dC50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgcXVlc3Rpb24gaW5kaWNhdG9ycyBGSVJTVFxuICAgICAgICBpZiAobG93ZXJJbnB1dC5pbmNsdWRlcygnPycpIHx8IFxuICAgICAgICAgICAgbG93ZXJJbnB1dC5zdGFydHNXaXRoKCd3aGF0JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2h5JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnaG93JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hlbicpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ3doZXJlJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hvJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnY2FuIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ2NvdWxkIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LmluY2x1ZGVzKCdleHBsYWluJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuaW5jbHVkZXMoJ2hlbHAgbWUgdW5kZXJzdGFuZCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0NIQVQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIG1ldGFkYXRhIGtleXdvcmRzIC0gYmUgbW9yZSBzcGVjaWZpY1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICAvLyBUYWctc3BlY2lmaWMgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGJ0YWdzP1xcYi9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC9cXGJ0YWdnaW5nXFxiL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgLy8gUHJvcGVydHkgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIodGl0bGV8YXV0aG9yfGRhdGV8c3RhdHVzfGNhdGVnb3J5fGNhdGVnb3JpZXMpXFxiL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgLy8gTWV0YWRhdGEvZnJvbnRtYXR0ZXIgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIobWV0YWRhdGF8ZnJvbnRtYXR0ZXJ8cHJvcGVydGllc3xwcm9wZXJ0eSlcXGIvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBDb21tb24gbWV0YWRhdGEgYWN0aW9uc1xuICAgICAgICAgICAgL14oYWRkfHVwZGF0ZXxzZXR8cmVtb3ZlfGNsZWFufG9wdGltaXplKVxccysodGFncz98dGl0bGV8YXV0aG9yfG1ldGFkYXRhKS9pLnRlc3QobG93ZXJJbnB1dClcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gJ01FVEFEQVRBJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbW1vbiBjb250ZW50IGVkaXRpbmcgcGF0dGVybnNcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgL14oYWRkfHdyaXRlfGNyZWF0ZXxpbnNlcnQpXFxzKyhhXFxzKyk/KHNlY3Rpb258cGFyYWdyYXBofGNvbmNsdXNpb258aW50cm9kdWN0aW9ufHN1bW1hcnkpL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgL14oZml4fGNvcnJlY3R8aW1wcm92ZSlcXHMrKGdyYW1tYXJ8c3BlbGxpbmd8d3JpdGluZykvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvXihtYWtlfHJld3JpdGV8ZWRpdHxtb2RpZnl8Y2hhbmdlKS9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC9eKGRlbGV0ZXxyZW1vdmUpXFxzKyh0aGVcXHMrKT8oc2VjdGlvbnxwYXJhZ3JhcGh8c2VudGVuY2UpL2kudGVzdChsb3dlcklucHV0KVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiAnQ09OVEVOVCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IHRvIGNvbnRlbnQgZWRpdGluZyBmb3Igb3RoZXIgY29tbWFuZHNcbiAgICAgICAgcmV0dXJuICdDT05URU5UJztcbiAgICB9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxvQkFBbUg7OztBQ0FuSCxJQUFBQyxvQkFBeUQ7OztBQ0F6RCxJQUFBQyxvQkFBNEk7OztBQ09ySSxJQUFNLG1CQUFOLE1BQXVCO0FBQUEsRUFDN0IsT0FBTyxpQkFBaUIsU0FBb0M7QUFDM0QsVUFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBQ2hDLFVBQU0sV0FBcUUsQ0FBQztBQUM1RSxVQUFNLGdCQUEwQixDQUFDO0FBQ2pDLFVBQU0sb0JBQThCLENBQUM7QUFHckMsYUFBUyxJQUFJLEdBQUcsSUFBSSxNQUFNLFFBQVEsS0FBSztBQUN0QyxZQUFNLE9BQU8sTUFBTSxDQUFDLEVBQUUsS0FBSztBQUMzQixZQUFNLGVBQWUsS0FBSyxNQUFNLG1CQUFtQjtBQUVuRCxVQUFJLGNBQWM7QUFDakIsY0FBTSxRQUFRLGFBQWEsQ0FBQyxFQUFFO0FBQzlCLGNBQU0sT0FBTyxhQUFhLENBQUM7QUFHM0IsY0FBTSxhQUFhLEtBQUssdUJBQXVCLE9BQU8sQ0FBQztBQUN2RCxjQUFNLFVBQVUsQ0FBQztBQUVqQixpQkFBUyxLQUFLLEVBQUUsT0FBTyxNQUFNLFFBQVEsQ0FBQztBQUV0QyxZQUFJLFNBQVM7QUFDWix3QkFBYyxLQUFLLElBQUk7QUFBQSxRQUN4QjtBQUFBLE1BQ0Q7QUFHQSxVQUFJLEtBQUssTUFBTSwwQkFBMEIsS0FBSyxLQUFLLE1BQU0sWUFBWSxLQUFLLEtBQUssTUFBTSxzQkFBc0IsR0FBRztBQUM3RywwQkFBa0IsS0FBSyxJQUFJO0FBQUEsTUFDNUI7QUFBQSxJQUNEO0FBRUEsVUFBTSxZQUFZLFFBQVEsTUFBTSxLQUFLLEVBQUUsT0FBTyxVQUFR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QTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ047QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxXQUFXO0FBQUEsSUFDUDtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFFBQVE7QUFBQSxJQUNKO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ047QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxRQUFRO0FBQUEsSUFDSjtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLE9BQU87QUFBQSxJQUNIO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsUUFBUTtBQUFBLElBQ0o7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFB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Z0M7QUFDdkMsVUFBTSxRQUFRLFNBQVMsY0FBYyxLQUFLO0FBQzFDLFVBQU0sWUFBWTtBQUNsQixVQUFNLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlDbEIsVUFBTSxhQUFhLE1BQU0sY0FBYyxtQkFBbUI7QUFDMUQsVUFBTSxXQUFXLE1BQU0sY0FBYyxpQkFBaUI7QUFDdEQsVUFBTSxVQUFVLE1BQU0sY0FBYyxXQUFXO0FBRS9DLFVBQU0sYUFBYSxNQUFNO0FBQ3hCLFlBQU0sT0FBTztBQUFBLElBQ2Q7QUFFQSxlQUFXLGlCQUFpQixTQUFTLE1BQU07QUFDMUMsYUFBTyxLQUFLLGlDQUFpQyxRQUFRO0FBQ3JELGlCQUFXO0FBQUEsSUFDWixDQUFDO0FBRUQsYUFBUyxpQkFBaUIsU0FBUyxVQUFVO0FBQzdDLFlBQVEsaUJBQWlCLFNBQVMsVUFBVTtBQUU1QyxhQUFTLEtBQUssWUFBWSxLQUFLO0FBRy9CLFFBQUkseUJBQU8saURBQWlELEdBQUk7QUFBQSxFQUNqRTtBQUFBO0FBQUEsRUFHQSxNQUFNLGdCQUFnQixLQUEyQjtBQUNoRCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVM7QUFDcEMsV0FBTyxVQUFVLFFBQVEsR0FBRyxJQUFJO0FBQUEsRUFDakM7QUFBQSxFQUVBLE1BQU0sZ0JBQWdCLEtBQWEsTUFBMEI7QUFDNUQsVUFBTSxVQUFVLE1BQU0sS0FBSyxTQUFTLEtBQUssQ0FBQztBQUMxQyxZQUFRLEdBQUcsSUFBSTtBQUNmLFdBQU8sTUFBTSxLQUFLLFNBQVMsT0FBTztBQUFBLEVBQ25DO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImV4aXN0aW5nIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJfYSIsICJwcm9tcHQiLCAic2VuZEJ1dHRvbiIsICJfYSIsICJpc1N1cGVybm92YSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgImkiLCAicHJvbXB0IiwgInByb21wdCIsICJpbXBvcnRfb2JzaWRpYW4iLCAidmlldyIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAibmV3RnJvbnRtYXR0ZXIiLCAiTk9WQV9JQ09OX1NWRyJdCn0K
