/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/settings.ts
var import_obsidian3 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian2 = require("obsidian");

// src/ui/wikilink-suggest.ts
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea) {
    this.suggestionPopup = null;
    this.suggestions = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.currentQuery = "";
    this.currentTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.setupEventListeners();
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
    this.textArea.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textArea.addEventListener("blur", () => {
      setTimeout(() => this.hideSuggestions(), 150);
    });
    document.addEventListener("click", (e) => {
      if (this.suggestionPopup && !this.suggestionPopup.contains(e.target) && e.target !== this.textArea) {
        this.hideSuggestions();
      }
    });
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (linkMatch) {
      this.currentQuery = linkMatch[2] || "";
      this.currentTriggerPos = cursorPos - linkMatch[0].length;
      this.showSuggestions();
    } else {
      this.hideSuggestions();
    }
  }
  handleKeydown(e) {
    if (!this.isVisible) return;
    switch (e.key) {
      case "ArrowDown":
        e.preventDefault();
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);
        this.updateSelection();
        break;
      case "ArrowUp":
        e.preventDefault();
        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
        this.updateSelection();
        break;
      case "Enter":
      case "Tab":
        if (this.selectedIndex >= 0) {
          e.preventDefault();
          this.selectSuggestion(this.suggestions[this.selectedIndex]);
        }
        break;
      case "Escape":
        e.preventDefault();
        this.hideSuggestions();
        break;
    }
  }
  showSuggestions() {
    this.suggestions = this.getSuggestions(this.currentQuery);
    if (this.suggestions.length === 0) {
      this.hideSuggestions();
      return;
    }
    if (!this.suggestionPopup) {
      this.createSuggestionPopup();
    }
    this.renderSuggestions();
    this.positionPopup();
    this.isVisible = true;
    this.selectedIndex = -1;
  }
  hideSuggestions() {
    if (this.suggestionPopup) {
      this.suggestionPopup.style.display = "none";
    }
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  createSuggestionPopup() {
    var _a;
    this.suggestionPopup = document.createElement("div");
    this.suggestionPopup.className = "nova-wikilink-suggestions";
    this.suggestionPopup.style.cssText = `
            position: absolute;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            min-width: 200px;
        `;
    (_a = this.textArea.parentElement) == null ? void 0 : _a.appendChild(this.suggestionPopup);
  }
  renderSuggestions() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.empty();
    this.suggestions.forEach((suggestion, index) => {
      const item = this.suggestionPopup.createDiv({ cls: "nova-suggestion-item" });
      item.style.cssText = `
                padding: 8px 12px;
                cursor: pointer;
                border-bottom: 1px solid var(--background-modifier-border-hover);
                transition: background-color 0.2s;
            `;
      const nameEl = item.createDiv({ cls: "nova-suggestion-name" });
      nameEl.textContent = suggestion.file.basename;
      nameEl.style.cssText = `
                font-weight: 500;
                color: var(--text-normal);
                margin-bottom: 2px;
            `;
      if (suggestion.file.path !== suggestion.file.name) {
        const pathEl = item.createDiv({ cls: "nova-suggestion-path" });
        pathEl.textContent = suggestion.file.path;
        pathEl.style.cssText = `
                    font-size: 0.85em;
                    color: var(--text-muted);
                `;
      }
      item.addEventListener("click", () => {
        this.selectSuggestion(suggestion);
      });
      item.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.suggestionPopup.style.display = "block";
  }
  updateSelection() {
    if (!this.suggestionPopup) return;
    const items = this.suggestionPopup.querySelectorAll(".nova-suggestion-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.backgroundColor = "var(--background-modifier-hover)";
      } else {
        element.style.backgroundColor = "";
      }
    });
  }
  positionPopup() {
    if (!this.suggestionPopup) return;
    const rect = this.textArea.getBoundingClientRect();
    const popupHeight = Math.min(200, this.suggestions.length * 50);
    this.suggestionPopup.style.position = "absolute";
    this.suggestionPopup.style.left = "0";
    this.suggestionPopup.style.bottom = "100%";
    this.suggestionPopup.style.marginBottom = "4px";
    this.suggestionPopup.style.width = `${rect.width}px`;
  }
  selectSuggestion(suggestion) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (!linkMatch) return;
    const isPersistent = !!linkMatch[1];
    const startPos = cursorPos - linkMatch[0].length;
    const linkText = `[[${suggestion.file.basename}]]`;
    const replacement = isPersistent ? `+${linkText}` : linkText;
    const newText = text.substring(0, startPos) + replacement + text.substring(cursorPos);
    this.textArea.value = newText;
    const newCursorPos = startPos + replacement.length;
    this.textArea.setSelectionRange(newCursorPos, newCursorPos);
    this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    this.hideSuggestions();
    this.textArea.focus();
  }
  getSuggestions(query) {
    const files = this.app.vault.getMarkdownFiles();
    const suggestions = [];
    for (const file of files) {
      const score = this.scoreFile(file, query);
      if (score > 0) {
        suggestions.push({
          file,
          displayText: file.basename,
          score
        });
      }
    }
    return suggestions.sort((a, b) => b.score - a.score).slice(0, 8);
  }
  scoreFile(file, query) {
    if (!query) return 50;
    const basename = file.basename.toLowerCase();
    const path = file.path.toLowerCase();
    const queryLower = query.toLowerCase();
    if (basename === queryLower) return 100;
    if (basename.startsWith(queryLower)) return 80;
    if (basename.includes(queryLower)) return 60;
    if (path.includes(queryLower)) return 40;
    if (this.fuzzyMatch(basename, queryLower)) return 20;
    return 0;
  }
  fuzzyMatch(text, query) {
    let textIndex = 0;
    let queryIndex = 0;
    while (textIndex < text.length && queryIndex < query.length) {
      if (text[textIndex] === query[queryIndex]) {
        queryIndex++;
      }
      textIndex++;
    }
    return queryIndex === query.length;
  }
  destroy() {
    if (this.suggestionPopup) {
      this.suggestionPopup.remove();
    }
  }
};

// src/core/multi-doc-context.ts
var import_obsidian = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
      var _a;
      if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
        console.warn(`Removing stale file reference: ${((_a = docRef == null ? void 0 : docRef.file) == null ? void 0 : _a.path) || "unknown"}`);
        return false;
      }
      return true;
    });
    if (allPersistentDocs.length !== rawPersistentDocs.length) {
      if (allPersistentDocs.length > 0) {
        this.persistentContext.set(currentFile.path, allPersistentDocs);
      } else {
        this.persistentContext.delete(currentFile.path);
      }
    }
    const contextParts = [];
    const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
    if (currentFileContext) {
      contextParts.push(currentFileContext);
    }
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      console.error(`Failed to read full context from ${file.path}:`, error);
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    var _a;
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        console.warn(`File no longer exists: ${(file == null ? void 0 : file.path) || "unknown"}`);
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      console.error(`Failed to read context from ${((_a = docRef == null ? void 0 : docRef.file) == null ? void 0 : _a.path) || "unknown file"}:`, error);
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var NovaSidebarView = class extends import_obsidian2.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.currentContext = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian2.Platform.isDesktopApp ? "25px" : "0"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 10px;
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: 1.1em; display: flex; align-items: center; gap: 6px;";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: 8px;";
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian2.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.loadConversationForActiveFile();
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
    this.commandPickerItems = [];
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.empty();
    }
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: 10px;
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: 8px;
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements
   */
  createInputArea() {
    this.inputContainer.empty();
    this.inputContainer.style.cssText = `
			display: flex;
			flex-direction: column;
			gap: 8px;
			padding: 10px;
			border-top: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
			position: relative;
		`;
    const inputRow = this.inputContainer.createDiv({ cls: "nova-input-row" });
    inputRow.style.cssText = `
			display: flex;
			align-items: center;
			gap: 8px;
		`;
    const textAreaContainer = inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian2.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova to help edit your document...");
    const lineHeight = 1.5;
    const paddingVertical = 20;
    const borderWidth = 2;
    const baseLines = import_obsidian2.Platform.isMobile ? 2 : 3;
    const maxLines = import_obsidian2.Platform.isMobile ? 8 : 6;
    const fontSize = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--font-text-size") || "14px");
    const initialHeight = baseLines * lineHeight * fontSize + paddingVertical + borderWidth;
    this.textArea.inputEl.style.cssText = `
			width: 100%;
			min-height: ${initialHeight}px;
			max-height: ${maxLines * lineHeight * fontSize + paddingVertical + borderWidth}px;
			height: ${initialHeight}px;
			resize: none;
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			padding: 10px;
			font-size: var(--font-text-size);
			line-height: ${lineHeight};
			overflow-y: hidden;
			transition: height 0.1s ease-out;
		`;
    this.autoGrowTextarea = () => {
      const el = this.textArea.inputEl;
      el.style.height = "auto";
      const contentHeight = el.scrollHeight;
      const minHeight = initialHeight;
      const maxHeight = maxLines * lineHeight * fontSize + paddingVertical + borderWidth;
      const newHeight = Math.max(minHeight, Math.min(contentHeight, maxHeight));
      el.style.height = `${newHeight}px`;
      el.style.overflowY = contentHeight > maxHeight ? "auto" : "hidden";
    };
    this.textArea.inputEl.addEventListener("input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.app, this.textArea.inputEl);
    this.textArea.inputEl.addEventListener("input", () => {
      this.updateLiveContextPreview();
    });
    this.commandButton = new import_obsidian2.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: 8px;
		`;
    this.sendButton = new import_obsidian2.ButtonComponent(inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.setCta();
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
		`;
    this.textArea.inputEl.addEventListener("keydown", (event) => {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        this.handleCommandPickerSelection() || this.handleSend();
      } else if (event.key === "Escape") {
        this.hideCommandPicker();
      } else if (event.key === "ArrowDown" || event.key === "ArrowUp") {
        if (this.isCommandPickerVisible()) {
          event.preventDefault();
          this.navigateCommandPicker(event.key === "ArrowDown" ? 1 : -1);
        }
      }
    });
    this.textArea.inputEl.addEventListener("input", () => {
      this.handleInputChange();
    });
    this.createCommandPicker();
    this.createCommandMenu();
    this.createContextIndicator();
    this.contextPreview = this.createContextPreview();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: 10px;
			padding: 8px 12px;
			border-radius: 8px;
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: 0.9em;" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: 0.8em;
			opacity: 0.7;
			margin-bottom: 4px;
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: 12px;
			margin: 16px auto;
			padding: 16px 20px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 18px;
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: 32px;
			height: 32px;
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Welcome to Nova" });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "Your AI thinking partner. Ask me to help edit your document!" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: #4caf50; display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("command-system")) {
      this.addMessage("system", this.createIconMessage("zap", "Command system is currently in early access for Supernova supporters. Available to all users September 15, 2025."));
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addMessage("system", this.createIconMessage("refresh-cw", `Switched to ${this.getProviderDisplayName(providerId)}`));
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.textArea.setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addMessage("system", this.createIconMessage("edit", `Loaded template: ${customCommand.name}`));
        return true;
      }
    }
    this.addMessage("system", this.createIconMessage("help-circle", `Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`));
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.textArea.getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("command-system")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item" });
      item.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
				display: flex;
				align-items: center;
				gap: 8px;
			`;
      const triggerEl = item.createSpan({ cls: "nova-command-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.cssText = `
				font-family: var(--font-monospace);
				background: var(--background-modifier-hover);
				padding: 2px 6px;
				border-radius: 4px;
				font-size: 0.9em;
				color: var(--interactive-accent);
			`;
      const nameEl = item.createSpan({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1; color: var(--text-normal);";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "font-size: 0.8em; color: var(--text-muted);";
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.style.backgroundColor = "";
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].style.backgroundColor = "var(--background-modifier-hover)";
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.textArea.setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    const commands = [
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" },
      { trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" }
    ];
    if (this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      customCommands.forEach((cmd) => {
        commands.push({
          trigger: cmd.trigger,
          name: cmd.name,
          ...cmd.description && { description: cmd.description }
        });
      });
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("command-button")) {
      this.addMessage("system", this.createIconMessage("zap", "Command button is currently in early access for Supernova supporters. Available to all users August 15, 2025."));
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header" });
    headerEl.style.cssText = `
			padding: 12px 16px;
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 600;
			font-size: 0.9em;
			color: var(--text-normal);
		`;
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item" });
      item.style.cssText = `
				padding: 12px 16px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
				display: flex;
				flex-direction: column;
				gap: 4px;
				transition: background-color 0.2s;
			`;
      const nameEl = item.createDiv({ cls: "nova-command-menu-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
			`;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.cssText = `
				font-family: var(--font-monospace);
				font-size: 0.8em;
				color: var(--interactive-accent);
				opacity: 0.8;
			`;
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-muted);
				`;
      }
      item.addEventListener("mouseenter", () => {
        item.style.backgroundColor = "var(--background-modifier-hover)";
      });
      item.addEventListener("mouseleave", () => {
        item.style.backgroundColor = "";
      });
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  executeCommandFromMenu(trigger) {
    this.hideCommandMenu();
    this.textArea.setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.textArea.getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian2.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian2.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian2.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const isMobile = import_obsidian2.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: block;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px;";
    if (isMobile) {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}%)`;
    } else {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, 150);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian2.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("eraser").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, 150);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				margin-left: 6px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.innerHTML = this.createInlineIcon("x", isMobile ? "18px" : "14px");
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: bold;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, 150);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, 150);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      const result = await this.multiDocHandler.buildContext("", this.currentFile);
      this.currentContext = result.context;
      this.updateContextIndicator();
    }
  }
  async handleSend() {
    var _a, _b;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    if (message.startsWith(":")) {
      const commandResult = await this.handleColonCommand(message);
      if (commandResult) {
        this.textArea.setValue("");
        setTimeout(() => this.autoGrowTextarea(), 0);
        return;
      }
    }
    let processedMessage = message;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (message.includes("[[") || message.includes("+[[")) {
          this.addMessage("system", this.createIconMessage("book-open", "Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025."));
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(message, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_a = this.currentContext) == null ? void 0 : _a.persistentDocs.length) || 0;
        const currentPersistentCount = multiDocContext.persistentDocs.length;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.map((doc) => doc.file.basename).join(", ");
            this.addMessage("system", this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
          }
          this.textArea.setValue("");
          setTimeout(() => this.autoGrowTextarea(), 0);
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (multiDocContext.persistentDocs.length > 0) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.map((doc) => doc.file.basename).join(", ");
          const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
          const currentFile = ((_b = this.currentFile) == null ? void 0 : _b.basename) || "current file";
          this.addMessage("system", this.createIconMessage("book-open", `Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`));
        }
        if (multiDocContext.isNearLimit) {
          new import_obsidian2.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", 5e3);
        }
      }
    }
    this.addMessage("user", message);
    this.textArea.setValue("");
    setTimeout(() => this.autoGrowTextarea(), 0);
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    this.sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(message);
      }
      const isLikelyCommand = this.plugin.promptBuilder["isLikelyCommand"](processedMessage);
      let response = null;
      if (isLikelyCommand && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedUserPrompt = `${multiDocContext.contextString}

---

User Request: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      loadingEl.remove();
      if (activeFile && response) {
        await this.plugin.documentEngine.addAssistantMessage(response);
      }
      if (response) {
        this.addMessage("assistant", response);
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addMessage("assistant", `Sorry, I encountered an error: ${error.message}`);
    } finally {
      this.sendButton.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian2.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: true });
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      let result;
      switch (command.action) {
        case "add":
          result = await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          result = await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          result = await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return this.createIconMessage("x-circle", `Error executing command: ${error.message}`);
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian2.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      this.currentFile = null;
      this.chatContainer.empty();
      this.refreshContext();
      this.addWelcomeMessage("Open a document to start chatting with Nova.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFile = targetFile;
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
      }
    } catch (error) {
      console.warn("Failed to load conversation history:", error);
      this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
        console.warn("Failed to clear conversation:", error);
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared! Ready to help you with "${this.currentFile.basename}". What would you like to do?`);
    } else {
      this.addWelcomeMessage("Chat cleared! Ready to help. What would you like to do?");
    }
    new import_obsidian2.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Create static provider status display
   */
  createStaticProviderStatus(container) {
    const providerStatus = container.createDiv({ cls: "nova-header-provider" });
    providerStatus.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			font-size: 0.75em;
			color: var(--text-muted);
			opacity: 0.8;
		`;
    const headerStatusDot = providerStatus.createSpan({ cls: "nova-status-dot-small" });
    headerStatusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const headerProviderName = providerStatus.createSpan({ text: "Loading..." });
    this.plugin.aiProviderManager.getCurrentProviderName().then((name) => {
      headerProviderName.setText(name);
    });
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-muted);
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const statusDot = providerButton.createSpan({ cls: "nova-status-dot-small" });
    statusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
      providerName.setText(currentProviderName);
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providerItem = dropdownMenu.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				transition: background-color 0.2s ease;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const displayName = this.getProviderDisplayName(providerType);
      const nameSpan = providerItem.createSpan({ text: displayName });
      const isCurrent = displayName === currentProviderName;
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      providerItem.addEventListener("click", async () => {
        if (!isCurrent) {
          await this.switchToProvider(providerType);
          dropdownMenu.style.display = "none";
          if (this.currentProviderDropdown) {
            this.currentProviderDropdown.updateCurrentProvider();
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "GPT-4 (OpenAI)",
      "google": "Gemini (Google)",
      "ollama": "Ollama (Local)",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "#D2691E",
      "openai": "#10A37F",
      "google": "#4285F4",
      "ollama": "#7C3AED",
      "none": "#999"
    };
    return colors[providerType] || "#4caf50";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${this.getProviderDisplayName(providerType)}`);
      this.addMessage("system", switchMessage);
      const platform = import_obsidian2.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    } catch (error) {
      console.error("Error switching provider:", error);
      this.addMessage("system", this.createIconMessage("x-circle", `Failed to switch to ${this.getProviderDisplayName(providerType)}`));
    }
  }
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("command-button")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    var _a, _b, _c, _d, _e, _f;
    if (!this.inputContainer) return;
    const currentText = ((_a = this.textArea) == null ? void 0 : _a.getValue()) || "";
    const cursorStart = ((_c = (_b = this.textArea) == null ? void 0 : _b.inputEl) == null ? void 0 : _c.selectionStart) || 0;
    const cursorEnd = ((_e = (_d = this.textArea) == null ? void 0 : _d.inputEl) == null ? void 0 : _e.selectionEnd) || 0;
    const hadFocus = ((_f = this.textArea) == null ? void 0 : _f.inputEl) === document.activeElement;
    this.createInputArea();
    if (this.textArea && currentText) {
      this.textArea.setValue(currentText);
      setTimeout(() => {
        var _a2;
        if ((_a2 = this.textArea) == null ? void 0 : _a2.inputEl) {
          this.textArea.inputEl.setSelectionRange(cursorStart, cursorEnd);
          if (hadFocus) {
            this.textArea.inputEl.focus();
          }
        }
      }, 0);
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
};

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-3-5-sonnet-20241022",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-1.5-flash",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isSupernova ? "supernova" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian3.Setting(licenseContainer).setName("Supernova License Key (Optional)").setDesc("Enter your Supernova supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Supernova license key...").setValue(this.plugin.settings.licensing.supernovaLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Supernova license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
              const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
              if (isSupernova2) {
                this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
                this.showConfetti();
              } else {
                this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
              }
              const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
              if (leaves.length > 0) {
                const sidebarView = leaves[0].view;
                sidebarView.refreshSupernovaUI();
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Supernova license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createSupernovaInfo(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian3.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian3.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian3.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.display();
      }));
      new import_obsidian3.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian3.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian3.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "AI Provider Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const providerContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    providerContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = providerContainer.style.display !== "none";
      providerContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = providerContainer.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
		`;
    this.createOllamaSettings(providerContainer);
    this.createClaudeSettings(providerContainer);
    this.createGoogleSettings(providerContainer);
    this.createOpenAISettings(providerContainer);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian3.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian3.Setting(claudeContainer).setName("Model").setDesc("Claude model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateClaudeModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.claude.model || "claude-3-5-sonnet-20241022").onChange(async (value) => {
        this.plugin.settings.aiProviders.claude.model = value;
        await this.plugin.saveSettings();
      });
    });
    modelSetting.addButton((button) => button.setIcon("refresh-cw").setTooltip("Refresh available models").onClick(async () => {
      await this.refreshProviderModels("claude", modelDropdown);
    }));
  }
  populateClaudeModels(dropdown) {
    dropdown.selectEl.empty();
    const defaultModels = [
      { value: "claude-3-5-sonnet-20241022", label: "Claude 3.5 Sonnet" },
      { value: "claude-3-5-haiku-20241022", label: "Claude 3.5 Haiku" },
      { value: "claude-3-opus-20240229", label: "Claude 3 Opus" },
      { value: "claude-3-sonnet-20240229", label: "Claude 3 Sonnet" },
      { value: "claude-3-haiku-20240307", label: "Claude 3 Haiku" }
    ];
    defaultModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  async refreshProviderModels(providerType, dropdown) {
    var _a;
    const button = (_a = dropdown.selectEl.parentElement) == null ? void 0 : _a.querySelector(".clickable-icon");
    if (button) {
      button.style.opacity = "0.5";
      button.style.pointerEvents = "none";
    }
    try {
      const models = await this.plugin.aiProviderManager.getProviderModels(providerType);
      if (models.length > 0) {
        dropdown.selectEl.empty();
        models.forEach((model) => {
          const label = this.getModelDisplayName(providerType, model);
          dropdown.addOption(model, label);
        });
        const currentModel = this.plugin.settings.aiProviders[providerType].model;
        if (currentModel && models.includes(currentModel)) {
          dropdown.setValue(currentModel);
        } else if (models.length > 0) {
          dropdown.setValue(models[0]);
          this.plugin.settings.aiProviders[providerType].model = models[0];
          await this.plugin.saveSettings();
        }
        this.showRefreshMessage("Models refreshed successfully", "success");
      } else {
        this.showRefreshMessage("No models found or API key invalid", "error");
      }
    } catch (error) {
      console.error(`Failed to refresh ${providerType} models:`, error);
      this.showRefreshMessage(`Failed to refresh models: ${error instanceof Error ? error.message : "Unknown error"}`, "error");
    } finally {
      if (button) {
        button.style.opacity = "1";
        button.style.pointerEvents = "auto";
      }
    }
  }
  getModelDisplayName(providerType, model) {
    if (providerType === "claude") {
      if (model.includes("sonnet")) return model.includes("3-5") ? "Claude 3.5 Sonnet" : "Claude 3 Sonnet";
      if (model.includes("haiku")) return model.includes("3-5") ? "Claude 3.5 Haiku" : "Claude 3 Haiku";
      if (model.includes("opus")) return "Claude 3 Opus";
    } else if (providerType === "openai") {
      if (model.includes("gpt-4o")) return model.includes("mini") ? "GPT-4o Mini" : "GPT-4o";
      if (model.includes("gpt-4")) return "GPT-4";
      if (model.includes("gpt-3.5")) return "GPT-3.5 Turbo";
    } else if (providerType === "google") {
      if (model.includes("2.0")) return "Gemini 2.0 Flash";
      if (model.includes("1.5-pro")) return "Gemini 1.5 Pro";
      if (model.includes("1.5-flash")) return "Gemini 1.5 Flash";
      if (model.includes("1.0-pro")) return "Gemini 1.0 Pro";
    }
    return model;
  }
  showRefreshMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-refresh-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-refresh-message ${type}`,
      text: message
    });
    messageEl.style.cssText = `
			position: fixed;
			top: 20px;
			right: 20px;
			padding: 8px 12px;
			border-radius: 4px;
			font-size: 0.9em;
			z-index: 1000;
			${type === "success" ? "background: var(--background-modifier-success); color: var(--text-success);" : "background: var(--background-modifier-error); color: var(--text-error);"}
		`;
    setTimeout(() => {
      messageEl.remove();
    }, 3e3);
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    new import_obsidian3.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(openaiContainer).setName("Base URL").setDesc("OpenAI API base URL (for custom endpoints)").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.aiProviders.openai.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian3.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateOpenAIModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4o").onChange(async (value) => {
        this.plugin.settings.aiProviders.openai.model = value;
        await this.plugin.saveSettings();
      });
    });
    modelSetting.addButton((button) => button.setIcon("refresh-cw").setTooltip("Refresh available models").onClick(async () => {
      await this.refreshProviderModels("openai", modelDropdown);
    }));
  }
  populateOpenAIModels(dropdown) {
    dropdown.selectEl.empty();
    const defaultModels = [
      { value: "gpt-4o", label: "GPT-4o" },
      { value: "gpt-4o-mini", label: "GPT-4o Mini" },
      { value: "gpt-4-turbo", label: "GPT-4 Turbo" },
      { value: "gpt-4", label: "GPT-4" },
      { value: "gpt-3.5-turbo", label: "GPT-3.5 Turbo" }
    ];
    defaultModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian3.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian3.Setting(googleContainer).setName("Model").setDesc("Gemini model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateGoogleModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.google.model || "gemini-1.5-flash").onChange(async (value) => {
        this.plugin.settings.aiProviders.google.model = value;
        await this.plugin.saveSettings();
      });
    });
    modelSetting.addButton((button) => button.setIcon("refresh-cw").setTooltip("Refresh available models").onClick(async () => {
      await this.refreshProviderModels("google", modelDropdown);
    }));
  }
  populateGoogleModels(dropdown) {
    dropdown.selectEl.empty();
    const defaultModels = [
      { value: "gemini-2.0-flash-exp", label: "Gemini 2.0 Flash (Experimental)" },
      { value: "gemini-1.5-pro", label: "Gemini 1.5 Pro" },
      { value: "gemini-1.5-flash", label: "Gemini 1.5 Flash" },
      { value: "gemini-1.0-pro", label: "Gemini 1.0 Pro" }
    ];
    defaultModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian3.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Platform Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    platformContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = platformContainer.style.display !== "none";
      platformContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian3.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian3.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian3.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Custom Commands" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = commandContainer.style.display !== "none";
      commandContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    if (!this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian3.Setting(commandContainer).setName("Show Command Button in Chat").setDesc("Show the Commands button beside the Send button for quick command access").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian3.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(commandContainer);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian4 = require("obsidian");

// src/ai/providers/claude.ts
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.content[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        stream: true,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              if (parsed.type === "content_block_delta" && ((_b = parsed.delta) == null ? void 0 : _b.text)) {
                yield { content: parsed.delta.text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-haiku-20240307",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (!response.ok) {
        throw new Error(`API key validation failed: ${response.statusText}`);
      }
      const models = [
        "claude-3-5-sonnet-20241022",
        "claude-3-5-haiku-20241022",
        "claude-3-opus-20240229",
        "claude-3-sonnet-20240229",
        "claude-3-haiku-20240307"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.choices[0].message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const chatModels = data.data.filter((model) => {
        const id = model.id.toLowerCase();
        return (id.includes("gpt") || id.includes("chat")) && !id.includes("instruct") && !id.includes("edit") && !id.includes("search") && !id.includes("similarity") && !id.includes("embedding");
      }).map((model) => model.id).sort();
      const models = chatModels.length > 0 ? chatModels : [
        "gpt-4o",
        "gpt-4o-mini",
        "gpt-4-turbo",
        "gpt-4",
        "gpt-3.5-turbo"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.candidates[0].content.parts[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const generativeModels = data.models.filter((model) => {
        return model.supportedGenerationMethods && model.supportedGenerationMethods.includes("generateContent") && model.name.includes("gemini");
      }).map((model) => {
        return model.name.split("/").pop();
      }).sort();
      const models = generativeModels.length > 0 ? generativeModels : [
        "gemini-2.0-flash-exp",
        "gemini-1.5-pro",
        "gemini-1.5-flash",
        "gemini-1.0-pro"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian4.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
};

// src/core/document-engine.ts
var import_obsidian5 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
      console.warn("Failed to load conversation data:", error);
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
      console.error("Failed to save conversation data:", error);
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance
   */
  getActiveEditor() {
    const activeEditor = this.app.workspace.activeEditor;
    if (activeEditor == null ? void 0 : activeEditor.editor) {
      return activeEditor.editor;
    }
    let view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
    if (!view) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of leaves) {
        const leafView = leaf.view;
        if (leafView instanceof import_obsidian5.MarkdownView) {
          view = leafView;
          break;
        }
      }
    }
    if (!view) {
      return null;
    }
    const editor = view.editor;
    return editor || null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at a specific location
   */
  async deleteContent(target, location) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      } else if (target === "section" && location) {
        const section = await this.findSection(location);
        if (!section) {
          return {
            success: false,
            error: `Section "${location}" not found`,
            editType: "delete"
          };
        }
        const content = editor.getValue();
        const lines = content.split("\n");
        const newLines = lines.filter(
          (_, index) => index < section.range.start || index > section.range.end
        );
        await this.app.vault.modify(file, newLines.join("\n"));
        return {
          success: true,
          editType: "delete",
          appliedAt: { line: section.range.start, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Find a section by heading name
   */
  async findSection(headingText) {
    const context = await this.getDocumentContext();
    if (!context) return null;
    const headingIndex = context.headings.findIndex(
      (h) => h.text.toLowerCase().includes(headingText.toLowerCase())
    );
    if (headingIndex === -1) return null;
    const heading = context.headings[headingIndex];
    const nextHeading = context.headings[headingIndex + 1];
    const lines = context.content.split("\n");
    const endLine = nextHeading ? nextHeading.line - 1 : lines.length - 1;
    const sectionLines = lines.slice(heading.line + 1, endLine + 1);
    const sectionContent = sectionLines.join("\n").trim();
    return {
      heading: heading.text,
      level: heading.level,
      content: sectionContent,
      range: {
        start: heading.line,
        end: endLine
      }
    };
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor() {
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: 0.7,
      maxTokens: 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents directly. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Be concise and focused on the specific request
- Do not add section headers unless specifically requested`;
    const actionSpecificPrompts = {
      add: `
TASK: Add new content to the document.
- Create well-structured, relevant content that fits the document's purpose
- Use appropriate markdown formatting (headings, lists, emphasis)
- Ensure smooth flow with existing content
- Match the document's style and tone`,
      edit: `
TASK: Edit and improve existing content.
- Enhance clarity, readability, and flow
- Preserve the original meaning unless changes are requested
- Improve word choice and sentence structure
- Maintain the original formatting and structure`,
      delete: `
TASK: Remove specified content from the document.
- Identify the exact content to be removed
- Ensure remaining content flows naturally
- Preserve document structure and formatting
- Confirm the deletion is appropriate for the context`,
      grammar: `
TASK: Fix grammar, spelling, and language issues.
- Correct spelling errors, grammar mistakes, and typos
- Improve sentence structure and clarity
- Maintain the original voice and style
- Preserve all formatting and markdown syntax
- Make minimal changes - only fix actual errors`,
      rewrite: `
TASK: Rewrite or restructure content.
- Create new content that serves the same purpose
- Improve organization, clarity, and flow
- Use more effective language and structure
- Maintain key information and concepts
- Adapt to any specified style requirements`,
      metadata: `
TASK: Update document metadata/properties.
- Modify, add, or remove frontmatter properties
- Handle tags, titles, dates, and custom properties
- Maintain proper YAML formatting
- Preserve existing properties unless specifically changing them
- Provide ONLY the property updates in JSON format`
    };
    return basePrompt + actionSpecificPrompts[action];
  }
  /**
   * Build user prompt with specific instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = `${contextInfo}

USER REQUEST: ${command.instruction}`;
    if (command.context && command.context.trim()) {
      prompt2 += `

ADDITIONAL REQUIREMENTS: ${command.context}`;
    }
    const targetInstructions = this.getTargetInstructions(command);
    if (targetInstructions) {
      prompt2 += `

${targetInstructions}`;
    }
    const actionInstructions = this.getActionInstructions(command);
    if (actionInstructions) {
      prompt2 += `

${actionInstructions}`;
    }
    return prompt2;
  }
  /**
   * Get target-specific instructions
   */
  getTargetInstructions(command) {
    switch (command.target) {
      case "selection":
        return "FOCUS: Work with the selected text only. Provide the improved version of the selected content.";
      case "section":
        if (command.location) {
          return `FOCUS: Work with the "${command.location}" section. ${command.action === "add" ? "Add content to this section." : "Modify only this section."}`;
        }
        return "FOCUS: Work with the current section.";
      case "document":
        return "FOCUS: Apply changes to the entire document while preserving its structure.";
      case "end":
        return "FOCUS: Add content at the end of the document. Ensure it flows naturally from existing content.";
      case "paragraph":
        return "FOCUS: Work with the current paragraph or create a new paragraph.";
      default:
        return "";
    }
  }
  /**
   * Get action-specific instructions
   */
  getActionInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added. Include appropriate headings if adding a section.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide only the corrected text with grammar and spelling fixes.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return 'OUTPUT: Provide ONLY a JSON object with the property updates. Example: {"title": "New Title", "tags": ["tag1", "tag2"], "date": "2025-01-01"}';
      default:
        return "";
    }
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeHistory && conversationContext && conversationContext.trim()) {
      context += `
${conversationContext}
`;
    }
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += "\nDOCUMENT STRUCTURE:\n";
      documentContext.headings.forEach((heading) => {
        const indent = "  ".repeat(heading.level - 1);
        context += `${indent}- ${heading.text}
`;
      });
    }
    if (documentContext.selectedText && command.target === "selection") {
      context += `
SELECTED TEXT:
${documentContext.selectedText}
`;
    }
    if (command.target === "section" && command.location) {
      const section = this.findSectionInContent(documentContext.content, command.location);
      if (section) {
        context += `
CURRENT SECTION "${command.location}":
${section}
`;
      }
    } else if (command.target === "paragraph" && documentContext.surroundingLines) {
      context += "\nCURRENT CONTEXT:\n";
      if (documentContext.surroundingLines.before.length > 0) {
        context += `Before: ${documentContext.surroundingLines.before.join(" ")}
`;
      }
      if (documentContext.surroundingLines.after.length > 0) {
        context += `After: ${documentContext.surroundingLines.after.join(" ")}
`;
      }
    }
    const contentLines = documentContext.content.split("\n");
    if (contentLines.length > config.maxContextLines) {
      const start = Math.max(0, contentLines.length - config.maxContextLines);
      context += `
RECENT CONTENT (last ${config.maxContextLines} lines):
`;
      context += contentLines.slice(start).join("\n");
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}`;
    }
    return context;
  }
  /**
   * Find a specific section in content
   */
  findSectionInContent(content, sectionName) {
    const lines = content.split("\n");
    const normalizedSectionName = sectionName.toLowerCase().trim();
    let sectionStart = -1;
    let sectionLevel = 0;
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const heading = headingMatch[2].toLowerCase().trim();
        if (heading === normalizedSectionName || heading.includes(normalizedSectionName)) {
          sectionStart = i;
          sectionLevel = level;
          break;
        }
      }
    }
    if (sectionStart === -1) return null;
    let sectionEnd = lines.length;
    for (let i = sectionStart + 1; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+/);
      if (headingMatch && headingMatch[1].length <= sectionLevel) {
        sectionEnd = i;
        break;
      }
    }
    return lines.slice(sectionStart, sectionEnd).join("\n");
  }
  /**
   * Create a simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner. Provide helpful, concise responses to user requests. Focus on being practical and actionable.`;
    let userPrompt = instruction;
    if (context) {
      userPrompt = `Context: ${context}

Request: ${instruction}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 500
      }
    };
  }
  /**
   * Build prompt for conversation context
   */
  buildConversationPrompt(message, documentContext, recentHistory = []) {
    let systemPrompt = `You are Nova, an AI writing partner that helps users with their documents. You can:
- Answer questions about writing and editing
- Provide suggestions for improvement
- Help plan document structure
- Assist with research and content development

Be helpful, concise, and practical in your responses.`;
    let userPrompt = message;
    let context = "";
    if (documentContext) {
      context += `Current document: ${documentContext.filename}
`;
      if (documentContext.headings.length > 0) {
        context += "Document structure:\n";
        documentContext.headings.forEach((heading) => {
          const indent = "  ".repeat(heading.level - 1);
          context += `${indent}- ${heading.text}
`;
        });
      }
    }
    if (recentHistory.length > 0) {
      context += "\nRecent conversation:\n";
      recentHistory.slice(-3).forEach((msg) => {
        if (msg.role === "user") {
          context += `You: ${msg.content}
`;
        } else if (msg.role === "assistant") {
          context += `Nova: ${msg.content}
`;
        }
      });
    }
    if (context) {
      userPrompt = `${context}

Current message: ${message}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context,
      config: {
        temperature: 0.8,
        maxTokens: 800
      }
    };
  }
  /**
   * Estimate token count for a prompt
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Validate prompt generation
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    const tokenCount = this.estimateTokenCount(prompt2);
    if (tokenCount > 8e3) {
      issues.push(`Prompt is too long (${tokenCount} tokens, max 8000)`);
    }
    if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
      issues.push("Temperature must be between 0 and 1");
    }
    if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
      issues.push("Max tokens must be between 10 and 4000");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document", "paragraph"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection", "section", "line"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert)\b(?!\s+.*\b(better|clearer|more|less)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i
    ],
    targets: ["end", "section", "paragraph"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection", "section", "paragraph"]
  },
  {
    action: "metadata",
    patterns: [
      /\b(update|set|change|modify|add)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      /\b(add|remove|update)\s+.*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  }
];
var LOCATION_PATTERNS = [
  /\b(?:to|in|at|under|within|inside)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:section|heading|part)\s+["']([^"']+?)["']/i,
  /\b(?:section|heading)\s+(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:the\s+)?([a-zA-Z][a-zA-Z\s&]*?)\s+(?:section|heading)\b/i
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:this|current|selected)\s+(?:paragraph|line)/i, target: "paragraph" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" },
  { pattern: /\b(?:section|heading|part)/i, target: "section" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const location = this.extractLocation(input);
    const context = this.extractContext(input);
    return {
      action,
      target,
      location,
      instruction: input,
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return input.includes("section") || input.includes("heading") ? "section" : "end";
      case "edit":
        return hasSelection ? "selection" : "paragraph";
      case "delete":
        return hasSelection ? "selection" : "section";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return "end";
      default:
        return "paragraph";
    }
  }
  /**
   * Extract location information from the input
   */
  extractLocation(input) {
    for (const pattern of LOCATION_PATTERNS) {
      const match = pattern.exec(input);
      if (match && match[1]) {
        return match[1].trim();
      }
    }
    return void 0;
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "delete" && !command.location) {
      return {
        valid: false,
        error: "Please specify which section to delete"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection, hasHeadings) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add a conclusion section",
        "Fix grammar in this document",
        "Add an introduction",
        "Create a summary"
      );
    }
    if (hasHeadings) {
      suggestions.push(
        "Add content to the introduction section",
        "Expand the methodology section"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target, location } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new sections";
        break;
    }
    if (location) {
      description += ` in "${location}"`;
    } else {
      switch (target) {
        case "selection":
          description += " in selected text";
          break;
        case "section":
          description += " in current section";
          break;
        case "paragraph":
          description += " in current paragraph";
          break;
        case "document":
          description += " in entire document";
          break;
        case "end":
          description += " at end of document";
          break;
      }
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const commandWords = [
      "add",
      "create",
      "write",
      "insert",
      "include",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "fix",
      "correct",
      "grammar",
      "spell",
      "proofread",
      "polish",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const lowerMessage = message.toLowerCase();
    return commandWords.some((word) => lowerMessage.includes(word));
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    return this.contextBuilder.buildConversationPrompt(message, documentContext, recentHistory);
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    return this.contextBuilder.buildSimplePrompt(instruction, context);
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      console.warn("Prompt validation issues:", validation.issues);
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.contextBuilder.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.contextBuilder.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      location: void 0,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "insert"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.documentEngine.applyEdit(
          content,
          await this.determineInsertPosition(command, documentContext),
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Determine where to insert new content
   */
  async determineInsertPosition(command, documentContext) {
    switch (command.target) {
      case "end":
        return "end";
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            return { line: section.range.end, ch: 0 };
          }
        }
        return "cursor";
      case "paragraph":
        return "cursor";
      case "document":
        return "end";
      default:
        return "cursor";
    }
  }
  /**
   * Validate add command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    if (command.target === "section" && !command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for add commands
   */
  getSuggestions(documentContext) {
    const suggestions = [
      "Add a conclusion section",
      "Add an introduction",
      "Create a summary",
      "Add examples",
      "Create a methodology section"
    ];
    if (documentContext.headings.length > 0) {
      const sectionNames = documentContext.headings.map((h) => h.text);
      if (!sectionNames.some((name) => name.toLowerCase().includes("introduction"))) {
        suggestions.unshift("Add an introduction section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("conclusion"))) {
        suggestions.push("Add a conclusion section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("summary"))) {
        suggestions.push("Add a summary section");
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what content would be added (without actually adding it)
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let positionDescription = "";
      switch (command.target) {
        case "end":
          positionDescription = "at the end of the document";
          break;
        case "section":
          if (command.location) {
            positionDescription = `in the "${command.location}" section`;
          } else {
            positionDescription = "in the current section";
          }
          break;
        case "paragraph":
          positionDescription = "at the cursor position";
          break;
        case "document":
          positionDescription = "at the end of the document";
          break;
        default:
          positionDescription = "at the cursor position";
      }
      return {
        success: true,
        preview: `Will add new content ${positionDescription}`,
        position: positionDescription
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyEdit(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          content,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${content}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid edit target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "edit" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for edit commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Make this more professional",
        "Make this more detailed",
        "Improve clarity and flow",
        "Make this more formal",
        "Simplify this text",
        "Expand on this point",
        "Make this more engaging"
      );
    } else {
      suggestions.push(
        "Improve the writing style",
        "Make the document more professional",
        "Enhance clarity throughout",
        "Improve the introduction",
        "Polish the conclusion",
        "Make it more concise",
        "Add more detail",
        "Improve the flow between sections"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Improve the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be edited
   */
  async preview(command) {
    var _a, _b;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will edit the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will edit the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will edit content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will edit content at cursor position";
          if (documentContext.surroundingLines) {
            const currentLine = (_b = (_a = documentContext.cursorPosition) == null ? void 0 : _a.line) != null ? _b : 0;
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              affectedContent = editor.getLine(currentLine);
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will edit the entire document";
          break;
        case "end":
          previewText = "Will add edited content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid edit target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get edit targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of changes
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const conversationContext = this.documentEngine.getConversationContext();
        const promptConfig = conversationContext ? { includeHistory: true } : {};
        const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
        const promptValidation = this.contextBuilder.validatePrompt(prompt2);
        if (!promptValidation.valid) {
          return {
            success: false,
            error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
            editType: "delete"
          };
        }
        try {
          const aiResponse = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
        } catch (error) {
          const result2 = {
            success: false,
            error: error instanceof Error ? error.message : "AI analysis failed",
            editType: "delete"
          };
          await this.documentEngine.addAssistantMessage(
            `Error: ${result2.error}`,
            result2
          );
          return result2;
        }
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0 && !result.success) {
        await this.documentEngine.addAssistantMessage("Failed to delete content", result);
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "delete"
              };
            }
            editor.replaceRange("", startPos, endPos);
            return {
              success: true,
              content: "",
              editType: "delete",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "delete"
            };
          }
        } else {
          return {
            success: false,
            error: "Section name required for section deletion",
            editType: "delete"
          };
        }
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "delete"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          const lineContent = editor.getLine(currentLine);
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine + 1, ch: 0 };
          editor.replaceRange("", startPos, endPos);
          return {
            success: true,
            content: "",
            editType: "delete",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "delete"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end of document. Use a different target.",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: "Invalid deletion target",
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && !command.location) {
      return {
        valid: false,
        error: "Section name required for section deletion"
      };
    }
    if (command.target === "end") {
      return {
        valid: false,
        error: "Cannot delete from end of document. Use a different target."
      };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for delete commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Delete the selected text",
        "Remove this content",
        "Clear the selection"
      );
    } else {
      suggestions.push(
        "Delete the current paragraph",
        "Remove empty sections",
        "Clear redundant content",
        "Delete duplicate information"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Delete the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what would be deleted
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will delete the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = `${section.heading}

${section.content}`;
              previewText = `Will delete the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            return {
              success: false,
              error: "Section name required for preview"
            };
          }
          break;
        case "paragraph":
          previewText = "Will delete the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will delete all document content";
          break;
        case "end":
          return {
            success: false,
            error: "Cannot delete from end of document"
          };
        default:
          return {
            success: false,
            error: "Invalid deletion target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get delete targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-1, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of deletion
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length + section.heading.length;
            linesAffected = section.range.end - section.range.start + 1;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "Invalid target for deletion";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const correctedContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: 0.3,
            // Lower temperature for grammar corrections
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!correctedContent || correctedContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate corrected content", result2);
          return result2;
        }
        const result = await this.applyGrammarCorrection(command, documentContext, correctedContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to correct grammar", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Grammar correction failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar correction based on command target
   */
  async applyGrammarCorrection(command, documentContext, correctedContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${correctedContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(correctedContent, startPos, endPos);
          return {
            success: true,
            content: correctedContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(correctedContent);
      case "end":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid grammar correction target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "grammar" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for grammar commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Fix grammar in selected text",
        "Correct spelling and punctuation",
        "Improve sentence structure",
        "Fix capitalization errors",
        "Correct verb tenses",
        "Fix subject-verb agreement",
        "Improve readability"
      );
    } else {
      suggestions.push(
        "Check grammar throughout document",
        "Fix spelling errors",
        "Correct punctuation",
        "Improve sentence structure",
        "Fix grammatical errors in current paragraph",
        "Check for common mistakes",
        "Proofread the document"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Check grammar in "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be grammar-corrected
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const potentialIssues = [];
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will check grammar in the selected text";
            potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will check grammar in the "${command.location}" section`;
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will check grammar at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will check grammar in the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will check grammar throughout the entire document";
          potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          break;
        case "end":
          previewText = "Will add grammar-corrected content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid grammar correction target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        potentialIssues: potentialIssues.slice(0, 5)
        // Limit to 5 issues
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Detect potential grammar issues in text
   */
  detectPotentialIssues(text) {
    const issues = [];
    const patterns = [
      { pattern: /\bi\s/gi, issue: 'Lowercase "i" should be capitalized' },
      { pattern: /\.\s*[a-z]/g, issue: "Sentence should start with capital letter" },
      { pattern: /\s{2,}/g, issue: "Multiple spaces detected" },
      { pattern: /[.!?]{2,}/g, issue: "Multiple punctuation marks" },
      { pattern: /\s+[.!?,:;]/g, issue: "Space before punctuation" },
      { pattern: /[.!?]\w/g, issue: "Missing space after punctuation" },
      { pattern: /\bteh\b/gi, issue: 'Common typo: "teh" should be "the"' },
      { pattern: /\band\s+and\b/gi, issue: 'Duplicate "and"' },
      { pattern: /\bthe\s+the\b/gi, issue: 'Duplicate "the"' },
      { pattern: /\bis\s+is\b/gi, issue: 'Duplicate "is"' }
    ];
    patterns.forEach(({ pattern, issue }) => {
      if (pattern.test(text)) {
        issues.push(issue);
      }
    });
    return issues;
  }
  /**
   * Get grammar check targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of grammar correction
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        estimatedIssues: 0
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const estimatedIssues = this.detectPotentialIssues(contentToAnalyze).length;
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      estimatedIssues
    };
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const rewrittenContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!rewrittenContent || rewrittenContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate rewritten content", result2);
          return result2;
        }
        const result = await this.applyRewrite(command, documentContext, rewrittenContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Rewrite generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, rewrittenContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${rewrittenContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(rewrittenContent, startPos, endPos);
          return {
            success: true,
            content: rewrittenContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(rewrittenContent);
      case "end":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid rewrite target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "rewrite" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for rewrite commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Rewrite in a more formal tone",
        "Rewrite in a casual tone",
        "Make this more concise",
        "Expand with more detail",
        "Rewrite for clarity",
        "Simplify the language",
        "Make it more engaging",
        "Rewrite in bullet points",
        "Convert to narrative form"
      );
    } else {
      suggestions.push(
        "Rewrite the current paragraph",
        "Rewrite in a different style",
        "Make the writing more engaging",
        "Simplify complex language",
        "Rewrite for different audience",
        "Convert to more formal tone",
        "Make the content more concise"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Rewrite the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be rewritten
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const rewriteStyle = this.inferRewriteStyle(command.instruction);
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = `Will rewrite the selected text`;
            if (rewriteStyle) {
              previewText += ` (${rewriteStyle})`;
            }
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will rewrite the "${command.location}" section`;
              if (rewriteStyle) {
                previewText += ` (${rewriteStyle})`;
              }
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will rewrite content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will rewrite the current paragraph";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will rewrite the entire document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        case "end":
          previewText = "Will add rewritten content at the end of the document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        default:
          return {
            success: false,
            error: "Invalid rewrite target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        rewriteStyle
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Infer rewrite style from instruction
   */
  inferRewriteStyle(instruction) {
    const lowerInstruction = instruction.toLowerCase();
    if (lowerInstruction.includes("formal")) return "formal tone";
    if (lowerInstruction.includes("casual") || lowerInstruction.includes("informal")) return "casual tone";
    if (lowerInstruction.includes("concise") || lowerInstruction.includes("shorter")) return "more concise";
    if (lowerInstruction.includes("expand") || lowerInstruction.includes("detail")) return "more detailed";
    if (lowerInstruction.includes("simple") || lowerInstruction.includes("simplify")) return "simplified language";
    if (lowerInstruction.includes("engaging") || lowerInstruction.includes("interesting")) return "more engaging";
    if (lowerInstruction.includes("professional")) return "professional tone";
    if (lowerInstruction.includes("bullet") || lowerInstruction.includes("list")) return "bullet point format";
    if (lowerInstruction.includes("narrative") || lowerInstruction.includes("story")) return "narrative style";
    if (lowerInstruction.includes("technical")) return "technical style";
    if (lowerInstruction.includes("creative")) return "creative style";
    return "";
  }
  /**
   * Get rewrite targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of rewriting
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        rewriteComplexity: "low"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const rewriteComplexity = this.estimateComplexity(contentToAnalyze, command.instruction);
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      rewriteComplexity
    };
  }
  /**
   * Estimate rewrite complexity
   */
  estimateComplexity(content, instruction) {
    const contentLength = content.length;
    const lowerInstruction = instruction.toLowerCase();
    let complexity = "low";
    if (contentLength > 1e3) complexity = "high";
    else if (contentLength > 300) complexity = "medium";
    const complexInstructions = [
      "restructure",
      "reorganize",
      "completely rewrite",
      "transform",
      "change style",
      "different audience",
      "technical",
      "academic"
    ];
    if (complexInstructions.some((term) => lowerInstruction.includes(term))) {
      if (complexity === "low") complexity = "medium";
      else if (complexity === "medium") complexity = "high";
    }
    return complexity;
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      console.error("Failed to parse property updates:", error);
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Command system - 3 month early access
  "command-system": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-09-15",
    // 3 months later
    description: "Command system with : triggers and provider switching"
  },
  // Multi-document context - 2 month early access  
  "multi-doc-context": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Reference other documents with [[doc]] syntax"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Command button - 2 month early access
  "command-button": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Command button for mobile and discovery"
  },
  // Custom commands - 3.5 month early access
  "custom-commands": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-10-01",
    // Available to all Oct 1, 2025
    description: "User-defined custom command shortcuts"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context"
  // Current document context
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Supernova status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsSupernova() && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian6.Plugin {
  async onload() {
    try {
      console.log("Nova: onload starting...");
      await this.loadSettings();
      console.log("Nova: settings loaded");
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      console.log("Nova: feature manager initialized");
      this.app.workspace.onLayoutReady(() => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
      });
      (0, import_obsidian6.addIcon)("nova-star", NOVA_ICON_SVG2);
      console.log("Nova: icon registered");
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      console.log("Nova: AI provider manager initialized");
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder();
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      console.log("Nova: document engine and commands initialized");
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      console.log("Nova: view registered");
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      console.log("Nova: ribbon icon added");
      console.log("Nova: ribbon icon element:", ribbonIcon);
      console.log("Nova: ribbon icon innerHTML:", ribbonIcon.innerHTML);
      console.log("Nova: ribbon icon classList:", ribbonIcon.classList.toString());
      this.addCommand({
        id: "nova-add-content",
        name: "Nova: Add content",
        editorCallback: async (editor, ctx) => {
          await this.handleAddCommand();
        }
      });
      this.addCommand({
        id: "nova-edit-content",
        name: "Nova: Edit content",
        editorCallback: async (editor, ctx) => {
          await this.handleEditCommand();
        }
      });
      this.addCommand({
        id: "nova-delete-content",
        name: "Nova: Delete content",
        editorCallback: async (editor, ctx) => {
          await this.handleDeleteCommand();
        }
      });
      this.addCommand({
        id: "nova-fix-grammar",
        name: "Nova: Fix grammar",
        editorCallback: async (editor, ctx) => {
          await this.handleGrammarCommand();
        }
      });
      this.addCommand({
        id: "nova-rewrite-content",
        name: "Nova: Rewrite content",
        editorCallback: async (editor, ctx) => {
          await this.handleRewriteCommand();
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      console.log("Nova: commands registered");
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
      console.log("Nova: settings tab added");
      console.log("Nova: onload completed successfully");
    } catch (error) {
      console.error("Nova: Error in onload:", error);
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle add content command with user input
   */
  async handleAddCommand() {
    const instruction = await this.promptForInstruction("What would you like to add?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.addCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content added successfully");
      } else {
        new import_obsidian6.Notice(`Failed to add content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle edit content command with user input
   */
  async handleEditCommand() {
    const instruction = await this.promptForInstruction("How would you like to edit the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.editCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content edited successfully");
      } else {
        new import_obsidian6.Notice(`Failed to edit content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle delete content command with user input
   */
  async handleDeleteCommand() {
    const instruction = await this.promptForInstruction("What would you like to delete?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.deleteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content deleted successfully");
      } else {
        new import_obsidian6.Notice(`Failed to delete content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle grammar correction command
   */
  async handleGrammarCommand() {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      new import_obsidian6.Notice("No active document found");
      return;
    }
    let target = "document";
    let instruction = "Fix grammar and spelling errors";
    if (documentContext.selectedText) {
      target = "selection";
      instruction = "Fix grammar and spelling errors in the selected text";
    }
    try {
      const command = {
        action: "grammar",
        target,
        instruction
      };
      const result = await this.grammarCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Grammar corrected successfully");
      } else {
        new import_obsidian6.Notice(`Failed to correct grammar: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle rewrite content command with user input
   */
  async handleRewriteCommand() {
    const instruction = await this.promptForInstruction("How would you like to rewrite the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.rewriteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content rewritten successfully");
      } else {
        new import_obsidian6.Notice(`Failed to rewrite content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Prompt user for instruction input
   */
  async promptForInstruction(placeholder) {
    return new Promise((resolve) => {
      const modal = document.createElement("div");
      modal.className = "modal nova-input-modal";
      modal.innerHTML = `
				<div class="modal-container">
					<div class="modal-bg" onclick="this.parentElement.parentElement.remove(); resolve(null);"></div>
					<div class="modal-content">
						<div class="modal-header">
							<h3>Nova AI Command</h3>
							<button class="modal-close-button" onclick="this.closest('.modal').remove(); resolve(null);">\xD7</button>
						</div>
						<div class="modal-body">
							<input type="text" class="nova-instruction-input" placeholder="${placeholder}" autofocus>
						</div>
						<div class="modal-footer">
							<button class="mod-cta nova-submit-btn">Execute</button>
							<button class="nova-cancel-btn">Cancel</button>
						</div>
					</div>
				</div>
			`;
      const input = modal.querySelector(".nova-instruction-input");
      const submitBtn = modal.querySelector(".nova-submit-btn");
      const cancelBtn = modal.querySelector(".nova-cancel-btn");
      const handleSubmit = () => {
        const value = input.value.trim();
        modal.remove();
        resolve(value || null);
      };
      const handleCancel = () => {
        modal.remove();
        resolve(null);
      };
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          handleSubmit();
        } else if (e.key === "Escape") {
          e.preventDefault();
          handleCancel();
        }
      });
      submitBtn.addEventListener("click", handleSubmit);
      cancelBtn.addEventListener("click", handleCancel);
      document.body.appendChild(modal);
      input.focus();
    });
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian6.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvdWkvd2lraWxpbmstc3VnZ2VzdC50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvYWkvcHJvdmlkZXItbWFuYWdlci50cyIsICJzcmMvYWkvcHJvdmlkZXJzL2NsYXVkZS50cyIsICJzcmMvYWkvcHJvdmlkZXJzL29wZW5haS50cyIsICJzcmMvYWkvcHJvdmlkZXJzL2dvb2dsZS50cyIsICJzcmMvYWkvcHJvdmlkZXJzL29sbGFtYS50cyIsICJzcmMvY29yZS9kb2N1bWVudC1lbmdpbmUudHMiLCAic3JjL2NvcmUvY29udmVyc2F0aW9uLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvY29udGV4dC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmQtcGFyc2VyLnRzIiwgInNyYy9jb3JlL3Byb21wdC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2VkaXQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9kZWxldGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL21ldGFkYXRhLWNvbW1hbmQudHMiLCAic3JjL2xpY2Vuc2luZy9mZWF0dXJlLWNvbmZpZy50cyIsICJzcmMvbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlci50cyIsICJzcmMvbGljZW5zaW5nL2xpY2Vuc2UtdmFsaWRhdG9yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIFdvcmtzcGFjZUxlYWYsIEl0ZW1WaWV3LCBhZGRJY29uLCBOb3RpY2UsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNYXJrZG93bkZpbGVJbmZvLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncywgTm92YVNldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3NyYy9zZXR0aW5ncyc7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4vc3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgTm92YVNpZGViYXJWaWV3LCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSIH0gZnJvbSAnLi9zcmMvdWkvc2lkZWJhci12aWV3JztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi9zcmMvY29yZS9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyc2VyIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kLXBhcnNlcic7XG5pbXBvcnQgeyBQcm9tcHRCdWlsZGVyIH0gZnJvbSAnLi9zcmMvY29yZS9wcm9tcHQtYnVpbGRlcic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyIH0gZnJvbSAnLi9zcmMvY29yZS9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5pbXBvcnQgeyBBZGRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9hZGQtY29tbWFuZCc7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZWRpdC1jb21tYW5kJztcbmltcG9ydCB7IERlbGV0ZUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2RlbGV0ZS1jb21tYW5kJztcbmltcG9ydCB7IEdyYW1tYXJDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQnO1xuaW1wb3J0IHsgUmV3cml0ZUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL3Jld3JpdGUtY29tbWFuZCc7XG5pbXBvcnQgeyBNZXRhZGF0YUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL21ldGFkYXRhLWNvbW1hbmQnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcbmltcG9ydCB7IExpY2Vuc2VWYWxpZGF0b3IgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi9zcmMvdWkvd2lraWxpbmstc3VnZ2VzdCc7XG5cbmNvbnN0IE5PVkFfSUNPTl9TVkcgPSBgXG48c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPCEtLSBDZW50cmFsIHN0YXIgY29yZSAtLT5cbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuICBcbiAgPCEtLSBQcmltYXJ5IHJheXMgKDQgbWFpbiBkaXJlY3Rpb25zKSAtLT5cbiAgPHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIFxuICA8IS0tIFNlY29uZGFyeSByYXlzIChkaWFnb25hbHMpIC0tPlxuICA8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuPC9zdmc+YDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm92YVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzITogTm92YVNldHRpbmdzO1xuXHRhaVByb3ZpZGVyTWFuYWdlciE6IEFJUHJvdmlkZXJNYW5hZ2VyO1xuXHRkb2N1bWVudEVuZ2luZSE6IERvY3VtZW50RW5naW5lO1xuXHRjb250ZXh0QnVpbGRlciE6IENvbnRleHRCdWlsZGVyO1xuXHRjb21tYW5kUGFyc2VyITogQ29tbWFuZFBhcnNlcjtcblx0cHJvbXB0QnVpbGRlciE6IFByb21wdEJ1aWxkZXI7XG5cdGNvbnZlcnNhdGlvbk1hbmFnZXIhOiBDb252ZXJzYXRpb25NYW5hZ2VyO1xuXHRhZGRDb21tYW5kSGFuZGxlciE6IEFkZENvbW1hbmQ7XG5cdGVkaXRDb21tYW5kSGFuZGxlciE6IEVkaXRDb21tYW5kO1xuXHRkZWxldGVDb21tYW5kSGFuZGxlciE6IERlbGV0ZUNvbW1hbmQ7XG5cdGdyYW1tYXJDb21tYW5kSGFuZGxlciE6IEdyYW1tYXJDb21tYW5kO1xuXHRyZXdyaXRlQ29tbWFuZEhhbmRsZXIhOiBSZXdyaXRlQ29tbWFuZDtcblx0bWV0YWRhdGFDb21tYW5kSGFuZGxlciE6IE1ldGFkYXRhQ29tbWFuZDtcblx0ZmVhdHVyZU1hbmFnZXIhOiBGZWF0dXJlTWFuYWdlcjtcblx0bGljZW5zZVZhbGlkYXRvciE6IExpY2Vuc2VWYWxpZGF0b3I7XG5cdHNldHRpbmdUYWIhOiBOb3ZhU2V0dGluZ1RhYjtcblx0c2lkZWJhclZpZXchOiBOb3ZhU2lkZWJhclZpZXc7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogb25sb2FkIHN0YXJ0aW5nLi4uJyk7XG5cdFx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHNldHRpbmdzIGxvYWRlZCcpO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIGxpY2Vuc2luZyBzeXN0ZW1cblx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvciA9IG5ldyBMaWNlbnNlVmFsaWRhdG9yKCk7XG5cdFx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gbmV3IEZlYXR1cmVNYW5hZ2VyKFxuXHRcdFx0XHR0aGlzLmxpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Ncblx0XHRcdCk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBsaWNlbnNlIGZyb20gc2V0dGluZ3Ncblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KTtcblx0XHRcdH1cblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBmZWF0dXJlIG1hbmFnZXIgaW5pdGlhbGl6ZWQnKTtcblxuXHRcdFx0Ly8gUmVmcmVzaCBTdXBlcm5vdmEgVUkgYWZ0ZXIgbGljZW5zZSB2YWxpZGF0aW9uIHRvIGhhbmRsZSBleHBpcmVkIGxpY2Vuc2VzXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gTm90ZTogTW9iaWxlIGFjY2VzcyByZXN0cmljdGlvbnMgYXJlIG5vdyBoYW5kbGVkIGluIHNpZGViYXIgVUlcblx0XHRcdC8vIFRoaXMgYWxsb3dzIENvcmUgbW9iaWxlIHVzZXJzIHRvIHNlZSB0aGUgdXBncmFkZSBpbnRlcmZhY2UgcmF0aGVyIHRoYW4gYSBicm9rZW4gcGx1Z2luXG5cblx0XHRcdC8vIFJlZ2lzdGVyIGN1c3RvbSBpY29uXG5cdFx0XHRhZGRJY29uKCdub3ZhLXN0YXInLCBOT1ZBX0lDT05fU1ZHKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBpY29uIHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlciA9IG5ldyBBSVByb3ZpZGVyTWFuYWdlcih0aGlzLnNldHRpbmdzLCB0aGlzLmZlYXR1cmVNYW5hZ2VyKTtcblx0XHRcdGF3YWl0IHRoaXMuYWlQcm92aWRlck1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IEFJIHByb3ZpZGVyIG1hbmFnZXIgaW5pdGlhbGl6ZWQnKTtcblxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb252ZXJzYXRpb24gbWFuYWdlciBhbmQgZG9jdW1lbnQgZW5naW5lXG5cdFx0XHRjb25zdCBkYXRhU3RvcmUgPSB7XG5cdFx0XHRcdGxvYWREYXRhOiAoa2V5OiBzdHJpbmcpID0+IHRoaXMubG9hZERhdGFXaXRoS2V5KGtleSksXG5cdFx0XHRcdHNhdmVEYXRhOiAoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdGhpcy5zYXZlRGF0YVdpdGhLZXkoa2V5LCBkYXRhKVxuXHRcdFx0fTtcblx0XHRcdHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IG5ldyBDb252ZXJzYXRpb25NYW5hZ2VyKGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lID0gbmV3IERvY3VtZW50RW5naW5lKHRoaXMuYXBwLCBkYXRhU3RvcmUpO1xuXHRcdFx0dGhpcy5kb2N1bWVudEVuZ2luZS5zZXRDb252ZXJzYXRpb25NYW5hZ2VyKHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcik7XG5cdFx0XHR0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQYXJzZXIgPSBuZXcgQ29tbWFuZFBhcnNlcigpO1xuXHRcdFx0dGhpcy5wcm9tcHRCdWlsZGVyID0gbmV3IFByb21wdEJ1aWxkZXIodGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdFxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kSGFuZGxlciA9IG5ldyBBZGRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZWRpdENvbW1hbmRIYW5kbGVyID0gbmV3IEVkaXRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgRGVsZXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmdyYW1tYXJDb21tYW5kSGFuZGxlciA9IG5ldyBHcmFtbWFyQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlciA9IG5ldyBSZXdyaXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIgPSBuZXcgTWV0YWRhdGFDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBkb2N1bWVudCBlbmdpbmUgYW5kIGNvbW1hbmRzIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0XHRWSUVXX1RZUEVfTk9WQV9TSURFQkFSLFxuXHRcdFx0XHQobGVhZikgPT4gbmV3IE5vdmFTaWRlYmFyVmlldyhsZWFmLCB0aGlzKVxuXHRcdFx0KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiB2aWV3IHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0Ly8gTm90ZTogV2lraWxpbmsgYXV0b2NvbXBsZXRlIGlzIG5vdyBoYW5kbGVkIGRpcmVjdGx5IGluIHNpZGViYXIgdmlld1xuXG5cdFx0XHRjb25zdCByaWJib25JY29uID0gdGhpcy5hZGRSaWJib25JY29uKCdub3ZhLXN0YXInLCAnTm92YSBBSScsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdH0pO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGFkZGVkJyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gZWxlbWVudDonLCByaWJib25JY29uKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBpbm5lckhUTUw6JywgcmliYm9uSWNvbi5pbm5lckhUTUwpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGNsYXNzTGlzdDonLCByaWJib25JY29uLmNsYXNzTGlzdC50b1N0cmluZygpKTtcblxuXHRcdFx0Ly8gUmVnaXN0ZXIgY29yZSBkb2N1bWVudCBlZGl0aW5nIGNvbW1hbmRzXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtYWRkLWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogQWRkIGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUFkZENvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1lZGl0LWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogRWRpdCBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVFZGl0Q29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWRlbGV0ZS1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IERlbGV0ZSBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVEZWxldGVDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtZml4LWdyYW1tYXInLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogRml4IGdyYW1tYXInLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUdyYW1tYXJDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtcmV3cml0ZS1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IFJld3JpdGUgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlUmV3cml0ZUNvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnb3Blbi1ub3ZhLXNpZGViYXInLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogT3BlbiBzaWRlYmFyJyxcblx0XHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBjb21tYW5kcyByZWdpc3RlcmVkJyk7XG5cblx0XHRcdHRoaXMuc2V0dGluZ1RhYiA9IG5ldyBOb3ZhU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcyk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKHRoaXMuc2V0dGluZ1RhYik7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgdGFiIGFkZGVkJyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogb25sb2FkIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignTm92YTogRXJyb3IgaW4gb25sb2FkOicsIGVycm9yKTtcblx0XHR9XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcblx0fVxuXG5cdGFzeW5jIGFjdGl2YXRlVmlldygpIHtcblx0XHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gdGhpcy5hcHA7XG5cblx0XHRsZXQgbGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGw7XG5cdFx0Y29uc3QgbGVhdmVzID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblxuXHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0bGVhZiA9IGxlYXZlc1swXTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuXHRcdFx0YXdhaXQgbGVhZj8uc2V0Vmlld1N0YXRlKHsgdHlwZTogVklFV19UWVBFX05PVkFfU0lERUJBUiwgYWN0aXZlOiB0cnVlIH0pO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYhKTtcblx0XHRcblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgdG8gc2lkZWJhciB2aWV3XG5cdFx0aWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBOb3ZhU2lkZWJhclZpZXcpIHtcblx0XHRcdHRoaXMuc2lkZWJhclZpZXcgPSBsZWFmLnZpZXc7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBhZGQgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVBZGRDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBhZGQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgYWRkZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gYWRkIGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGVkaXQgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVFZGl0Q29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ0hvdyB3b3VsZCB5b3UgbGlrZSB0byBlZGl0IHRoZSBjb250ZW50PycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBlZGl0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gZWRpdCBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBkZWxldGUgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVEZWxldGVDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkZWxldGU/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgZGVsZXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBkZWxldGUgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZ3JhbW1hciBjb3JyZWN0aW9uIGNvbW1hbmRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlR3JhbW1hckNvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuXHRcdFx0bmV3IE5vdGljZSgnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIHRhcmdldCBiYXNlZCBvbiBzZWxlY3Rpb25cblx0XHRsZXQgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdkb2N1bWVudCcgPSAnZG9jdW1lbnQnO1xuXHRcdGxldCBpbnN0cnVjdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZXJyb3JzJztcblx0XHRcblx0XHRpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuXHRcdFx0dGFyZ2V0ID0gJ3NlbGVjdGlvbic7XG5cdFx0XHRpbnN0cnVjdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZXJyb3JzIGluIHRoZSBzZWxlY3RlZCB0ZXh0Jztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHtcblx0XHRcdFx0YWN0aW9uOiAnZ3JhbW1hcicgYXMgY29uc3QsXG5cdFx0XHRcdHRhcmdldCxcblx0XHRcdFx0aW5zdHJ1Y3Rpb25cblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdHcmFtbWFyIGNvcnJlY3RlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjb3JyZWN0IGdyYW1tYXI6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHJld3JpdGUgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVSZXdyaXRlQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ0hvdyB3b3VsZCB5b3UgbGlrZSB0byByZXdyaXRlIHRoZSBjb250ZW50PycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCByZXdyaXR0ZW4gc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmV3cml0ZSBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFByb21wdCB1c2VyIGZvciBpbnN0cnVjdGlvbiBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwcm9tcHRGb3JJbnN0cnVjdGlvbihwbGFjZWhvbGRlcjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0XHRjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0bW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsIG5vdmEtaW5wdXQtbW9kYWwnO1xuXHRcdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJnXCIgb25jbGljaz1cInRoaXMucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZSgpOyByZXNvbHZlKG51bGwpO1wiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHRcdDxoMz5Ob3ZhIEFJIENvbW1hbmQ8L2gzPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kYWwtY2xvc2UtYnV0dG9uXCIgb25jbGljaz1cInRoaXMuY2xvc2VzdCgnLm1vZGFsJykucmVtb3ZlKCk7IHJlc29sdmUobnVsbCk7XCI+XHUwMEQ3PC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHRcdDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwibm92YS1pbnN0cnVjdGlvbi1pbnB1dFwiIHBsYWNlaG9sZGVyPVwiJHtwbGFjZWhvbGRlcn1cIiBhdXRvZm9jdXM+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cblx0XHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS1zdWJtaXQtYnRuXCI+RXhlY3V0ZTwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jYW5jZWwtYnRuXCI+Q2FuY2VsPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBpbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWluc3RydWN0aW9uLWlucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcblx0XHRcdGNvbnN0IHN1Ym1pdEJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXN1Ym1pdC1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRcdGNvbnN0IGNhbmNlbEJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNhbmNlbC1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblxuXHRcdFx0Y29uc3QgaGFuZGxlU3VibWl0ID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlLnRyaW0oKTtcblx0XHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0XHRcdHJlc29sdmUodmFsdWUgfHwgbnVsbCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRjb25zdCBoYW5kbGVDYW5jZWwgPSAoKSA9PiB7XG5cdFx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdFx0XHRyZXNvbHZlKG51bGwpO1xuXHRcdFx0fTtcblxuXHRcdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG5cdFx0XHRcdGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRoYW5kbGVTdWJtaXQoKTtcblx0XHRcdFx0fSBlbHNlIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0aGFuZGxlQ2FuY2VsKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVTdWJtaXQpO1xuXHRcdFx0Y2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ2FuY2VsKTtcblxuXHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cdFx0XHRpbnB1dC5mb2N1cygpO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNob3cgdXBncmFkZSBwcm9tcHQgZm9yIENvcmUgdGllciBtb2JpbGUgdXNlcnNcblx0ICovXG5cdHByaXZhdGUgc2hvd01vYmlsZVVwZ3JhZGVQcm9tcHQoKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRtb2RhbC5jbGFzc05hbWUgPSAnbW9kYWwgbm92YS1tb2JpbGUtdXBncmFkZS1tb2RhbCc7XG5cdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYmdcIj48L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHQ8aDM+Tm92YSBTdXBlck5vdmEgUmVxdWlyZWQ8L2gzPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aWVyLWJhZGdlIGNvcmVcIiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDFlbTtcIj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLWljb25cIj5GUkVFPC9zcGFuPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItbmFtZVwiPkNvcmUgKEZyZWUpPC9zcGFuPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8cD5Nb2JpbGUgYWNjZXNzIGlzIGF2YWlsYWJsZSB3aXRoIE5vdmEgU3VwZXJOb3ZhLjwvcD5cblx0XHRcdFx0XHRcdDxwPkNvcmUgdGllciBpcyBsaW1pdGVkIHRvIGRlc2t0b3AgdXNlIG9ubHkuPC9wPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtZmVhdHVyZS1saXN0XCI+XG5cdFx0XHRcdFx0XHRcdDxoND5TdXBlck5vdmEgaW5jbHVkZXM6PC9oND5cblx0XHRcdFx0XHRcdFx0PHVsPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Nb2JpbGUgZGV2aWNlIHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5NdWx0aXBsZSBBSSBwcm92aWRlcnM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Jbi1jaGF0IHByb3ZpZGVyIHN3aXRjaGluZzwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkFkdmFuY2VkIHRlbXBsYXRlczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS11cGdyYWRlLWJ0blwiPlVwZ3JhZGUgdG8gU3VwZXJOb3ZhPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jbG9zZS1idG5cIj5DbG9zZTwvYnV0dG9uPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHRjb25zdCB1cGdyYWRlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtdXBncmFkZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBjbG9zZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNsb3NlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IG1vZGFsQmcgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYmcnKSBhcyBIVE1MRWxlbWVudDtcblxuXHRcdGNvbnN0IGNsb3NlTW9kYWwgPSAoKSA9PiB7XG5cdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHR9O1xuXG5cdFx0dXBncmFkZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHdpbmRvdy5vcGVuKCdodHRwczovL25vdmF3cml0ZXIuYWkvdXBncmFkZScsICdfYmxhbmsnKTtcblx0XHRcdGNsb3NlTW9kYWwoKTtcblx0XHR9KTtcblxuXHRcdGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cdFx0bW9kYWxCZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cblx0XHQvLyBTaG93IG5vdGljZSBhcyB3ZWxsXG5cdFx0bmV3IE5vdGljZSgnTm92YSBtb2JpbGUgYWNjZXNzIHJlcXVpcmVzIFN1cGVyTm92YSBsaWNlbnNlJywgODAwMCk7XG5cdH1cblxuXHQvLyBEYXRhU3RvcmUgaW50ZXJmYWNlIGltcGxlbWVudGF0aW9uIGZvciBDb252ZXJzYXRpb25NYW5hZ2VyXG5cdGFzeW5jIGxvYWREYXRhV2l0aEtleShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcblx0XHRyZXR1cm4gYWxsRGF0YSA/IGFsbERhdGFba2V5XSA6IHVuZGVmaW5lZDtcblx0fVxuXG5cdGFzeW5jIHNhdmVEYXRhV2l0aEtleShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKSB8fCB7fTtcblx0XHRhbGxEYXRhW2tleV0gPSBkYXRhO1xuXHRcdHJldHVybiBhd2FpdCB0aGlzLnNhdmVEYXRhKGFsbERhdGEpO1xuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXJTZXR0aW5ncywgUGxhdGZvcm1TZXR0aW5ncywgUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi9haS90eXBlcyc7XG5pbXBvcnQgeyBEZWJ1Z1NldHRpbmdzIH0gZnJvbSAnLi9saWNlbnNpbmcvdHlwZXMnO1xuaW1wb3J0IHsgVklFV19UWVBFX05PVkFfU0lERUJBUiwgTm92YVNpZGViYXJWaWV3IH0gZnJvbSAnLi91aS9zaWRlYmFyLXZpZXcnO1xuXG5jb25zdCBOT1ZBX0lDT05fU1ZHID0gYFxuPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XG4gIDwhLS0gQ2VudHJhbCBzdGFyIGNvcmUgLS0+XG4gIDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cbiAgXG4gIDwhLS0gUHJpbWFyeSByYXlzICg0IG1haW4gZGlyZWN0aW9ucykgLS0+XG4gIDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICBcbiAgPCEtLSBTZWNvbmRhcnkgcmF5cyAoZGlhZ29uYWxzKSAtLT5cbiAgPHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbjwvc3ZnPmA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tQ29tbWFuZCB7XG5cdGlkOiBzdHJpbmc7XG5cdG5hbWU6IHN0cmluZztcblx0dHJpZ2dlcjogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3ZhU2V0dGluZ3Mge1xuXHRhaVByb3ZpZGVyczogQUlQcm92aWRlclNldHRpbmdzO1xuXHRwbGF0Zm9ybVNldHRpbmdzOiBQbGF0Zm9ybVNldHRpbmdzO1xuXHRjdXN0b21Db21tYW5kcz86IEN1c3RvbUNvbW1hbmRbXTtcblx0Z2VuZXJhbDoge1xuXHRcdGRlZmF1bHRUZW1wZXJhdHVyZTogbnVtYmVyO1xuXHRcdGRlZmF1bHRNYXhUb2tlbnM6IG51bWJlcjtcblx0XHRhdXRvU2F2ZTogYm9vbGVhbjtcblx0fTtcblx0c2hvd0NvbW1hbmRCdXR0b246IGJvb2xlYW47XG5cdGxpY2Vuc2luZzoge1xuXHRcdGxpY2Vuc2VLZXk6IHN0cmluZztcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5Pzogc3RyaW5nO1xuXHRcdGlzU3VwZXJub3ZhPzogYm9vbGVhbjtcblx0XHRkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzO1xuXHR9O1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTm92YVNldHRpbmdzID0ge1xuXHRhaVByb3ZpZGVyczoge1xuXHRcdGNsYXVkZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0b3BlbmFpOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0YmFzZVVybDogJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnLFxuXHRcdFx0bW9kZWw6ICdncHQtNG8nLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0Z29vZ2xlOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0bW9kZWw6ICdnZW1pbmktMS41LWZsYXNoJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9sbGFtYToge1xuXHRcdFx0YmFzZVVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuXHRcdFx0bW9kZWw6ICcnLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH1cblx0fSxcblx0cGxhdGZvcm1TZXR0aW5nczoge1xuXHRcdGRlc2t0b3A6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ29sbGFtYScsXG5cdFx0XHRmYWxsYmFja1Byb3ZpZGVyczogWydvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0fSxcblx0XHRtb2JpbGU6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ25vbmUnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZSddXG5cdFx0fVxuXHR9LFxuXHRjdXN0b21Db21tYW5kczogW10sXG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IDAuNyxcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiAxMDAwLFxuXHRcdGF1dG9TYXZlOiB0cnVlXG5cdH0sXG5cdHNob3dDb21tYW5kQnV0dG9uOiB0cnVlLFxuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiAnJyxcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5OiAnJyxcblx0XHRpc1N1cGVybm92YTogZmFsc2UsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRvdmVycmlkZURhdGU6IHVuZGVmaW5lZCxcblx0XHRcdGZvcmNlU3VwZXJub3ZhOiBmYWxzZVxuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGNsYXNzIE5vdmFTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnTm92YSBBSSBTZXR0aW5ncycgfSk7XG5cblx0XHR0aGlzLmNyZWF0ZUxpY2Vuc2VTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlR2VuZXJhbFNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQbGF0Zm9ybVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlclNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kU2V0dGluZ3MoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlTGljZW5zZVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29uc3QgbGljZW5zZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zZWN0aW9uJyB9KTtcblx0XHRsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1N1cGVybm92YSBTdXBwb3J0ZXIgU3RhdHVzJyB9KTtcblxuXHRcdC8vIEluZm8gYWJvdXQgdGhlIG5ldyBtb2RlbFxuXHRcdGNvbnN0IGluZm9FbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tb2RlbC1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkIGNvbXBhY3RcIj5cblx0XHRcdFx0PHA+Tm92YSBwcm92aWRlcyBhbGwgZmVhdHVyZXMgZm9yIGZyZWUgd2hlbiB5b3UgdXNlIHlvdXIgb3duIEFJIHByb3ZpZGVyIEFQSSBrZXlzLiBcblx0XHRcdFx0U3VwZXJub3ZhIHN1cHBvcnRlcnMgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmlzU3VwZXJub3ZhU3VwcG9ydGVyKCkgfHwgZmFsc2U7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhTGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRTdXBlcm5vdmFMaWNlbnNlKCk7XG5cdFx0XG5cdFx0Y29uc3Qgc3RhdHVzRGlzcGxheSA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdXBlcm5vdmEtc3RhdHVzJyB9KTtcblx0XHRjb25zdCBzdGF0dXNUZXh0ID0gaXNTdXBlcm5vdmEgPyAnU3VwZXJub3ZhIFN1cHBvcnRlcicgOiAnTm92YSBVc2VyJztcblx0XHRjb25zdCBzdGF0dXNJY29uID0gaXNTdXBlcm5vdmEgPyBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3R5bGU9XCJ3aWR0aDogMTRweDsgaGVpZ2h0OiAxNHB4OyBjb2xvcjogIzkzMzNlYTsgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgNHB4IHJnYmEoMTQ3LCA1MSwgMjM0LCAwLjYpKTtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5gIDogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0eWxlPVwid2lkdGg6IDE0cHg7IGhlaWdodDogMTRweDsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj5cblx0XHRcdCR7Tk9WQV9JQ09OX1NWR31cblx0XHQ8L3N2Zz5gO1xuXHRcdHN0YXR1c0Rpc3BsYXkuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3RhdHVzLWJhZGdlICR7aXNTdXBlcm5vdmEgPyAnc3VwZXJub3ZhJyA6ICdub3ZhJ31cIj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJzdGF0dXMtaWNvblwiPiR7c3RhdHVzSWNvbn08L3NwYW4+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLW5hbWVcIj4ke3N0YXR1c1RleHR9PC9zcGFuPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIHN0YXR1c1xuXHRcdGlmIChzdXBlcm5vdmFMaWNlbnNlKSB7XG5cdFx0XHRjb25zdCBzdGF0dXNFbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXN0YXR1cycgfSk7XG5cdFx0XHRjb25zdCBleHBpcnlUZXh0ID0gc3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQgXG5cdFx0XHRcdD8gYEV4cGlyZXM6ICR7c3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdFx0XHQ6ICdMaWZldGltZSBTdXBwb3J0Jztcblx0XHRcdHN0YXR1c0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cImxpY2Vuc2UtaW5mb1wiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1lbWFpbFwiPiR7c3VwZXJub3ZhTGljZW5zZS5lbWFpbH08L3NwYW4+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJsaWNlbnNlLWV4cGlyeVwiPiR7ZXhwaXJ5VGV4dH08L3NwYW4+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHR9XG5cblx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgaW5wdXRcblx0XHRuZXcgU2V0dGluZyhsaWNlbnNlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1N1cGVybm92YSBMaWNlbnNlIEtleSAoT3B0aW9uYWwpJylcblx0XHRcdC5zZXREZXNjKCdFbnRlciB5b3VyIFN1cGVybm92YSBzdXBwb3J0ZXIgbGljZW5zZSBrZXkgZm9yIGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3Bhc3N3b3JkJztcblx0XHRcdFx0dGV4dC5zZXRQbGFjZWhvbGRlcignRW50ZXIgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5Li4uJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgU3VwZXJub3ZhIGxpY2Vuc2UgaW4gZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBkaXNwbGF5IHRvIHNob3cgdXBkYXRlZCBzdGF0dXNcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gQWRkIHZhbGlkYXRpb24gYnV0dG9uXG5cdFx0XHRcdGNvbnN0IHZhbGlkYXRlQnV0dG9uID0gdGV4dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/LmNyZWF0ZUVsKCdidXR0b24nLCB7XG5cdFx0XHRcdFx0dGV4dDogJ1ZhbGlkYXRlJyxcblx0XHRcdFx0XHRjbHM6ICdub3ZhLXZhbGlkYXRlLWJ0bidcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAodmFsaWRhdGVCdXR0b24pIHtcblx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IGxpY2Vuc2VLZXkgPSB0ZXh0LmlucHV0RWwudmFsdWU7XG5cdFx0XHRcdFx0XHRpZiAoIWxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1BsZWFzZSBlbnRlciBhIFN1cGVybm92YSBsaWNlbnNlIGtleSBmaXJzdC4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdWYWxpZGF0aW5nLi4uJztcblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzU3VwZXJub3ZhU3VwcG9ydGVyKCk7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnVmFsaWQgU3VwZXJub3ZhIGxpY2Vuc2UhIFlvdSBub3cgaGF2ZSBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLicsICdzdWNjZXNzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dDb25mZXR0aSgpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnSW52YWxpZCBvciBleHBpcmVkIFN1cGVybm92YSBsaWNlbnNlIGtleS4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdFcnJvciB2YWxpZGF0aW5nIFN1cGVybm92YSBsaWNlbnNlLicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24udGV4dENvbnRlbnQgPSAnVmFsaWRhdGUnO1xuXHRcdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdC8vIFN1cGVybm92YSBzdXBwb3J0ZXIgaW5mb3JtYXRpb24gb25seVxuXHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhSW5mbyhsaWNlbnNlQ29udGFpbmVyKTtcblxuXHRcdC8vIERlYnVnIHNldHRpbmdzIChkZXZlbG9wbWVudCBvbmx5KVxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyB8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHR0aGlzLmNyZWF0ZURlYnVnU2V0dGluZ3MobGljZW5zZUNvbnRhaW5lcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFJbmZvKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBTdXBlcm5vdmEgc3VwcG9ydGVyIGluZm9ybWF0aW9uXG5cdFx0Y29uc3Qgc3VwZXJub3ZhSW5mbyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1cGVybm92YS1pbmZvJyB9KTtcblx0XHRzdXBlcm5vdmFJbmZvLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDU+QmVjb21lIGEgU3VwZXJub3ZhIFN1cHBvcnRlcjwvaDU+XG5cdFx0XHRcdDxwPlN1cHBvcnQgTm92YSBkZXZlbG9wbWVudCBhbmQgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuIEFsbCBmZWF0dXJlcyBldmVudHVhbGx5IGJlY29tZSBmcmVlIGZvciBldmVyeW9uZS48L3A+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+RWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcyAoMy02IG1vbnRocyBiZWZvcmUgZ2VuZXJhbCByZWxlYXNlKTwvbGk+XG5cdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQgYW5kIGZlYXR1cmUgcmVxdWVzdHM8L2xpPlxuXHRcdFx0XHRcdDxsaT5TdXBwb3J0ZXIgYmFkZ2UgYW5kIHJlY29nbml0aW9uPC9saT5cblx0XHRcdFx0XHQ8bGk+RGlyZWN0bHkgc3VwcG9ydCBvcGVuLXNvdXJjZSBkZXZlbG9wbWVudDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1NldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBkZWJ1Z0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0RldmVsb3BtZW50IFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0RlYnVnIE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXZlbG9wbWVudCB0ZXN0aW5nIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIGRlYnVnIG9wdGlvbnNcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnT3ZlcnJpZGUgRGF0ZScpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBjdXJyZW50IGRhdGUgZm9yIHRlc3RpbmcgdGltZS1nYXRlZCBmZWF0dXJlcyAoWVlZWS1NTS1ERCknKVxuXHRcdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzIwMjUtMTItMDEnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgcmVmcmVzaCBkaXNwbGF5IG9uIGV2ZXJ5IGtleXN0cm9rZSAtIGp1c3QgdXBkYXRlIHRoZSBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnRm9yY2UgU3VwZXJub3ZhIFN0YXR1cycpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBTdXBlcm5vdmEgc3VwcG9ydGVyIHN0YXR1cyBmb3IgdGVzdGluZycpXG5cdFx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSB8fCBmYWxzZSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gU2hvdyBjb25mZXR0aSB3aGVuIHR1cm5pbmcgT04gRm9yY2UgU3VwZXJub3ZhXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93Q29uZmV0dGkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdyB1cGRhdGVkIGZlYXR1cmUgc3RhdHVzXG5cdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdC8vIENsZWFyIGxpY2Vuc2VzIGJ1dHRvblxuXHRcdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKCdDbGVhciBBbGwgTGljZW5zZXMnKVxuXHRcdFx0XHQuc2V0RGVzYygnUmVtb3ZlIGFsbCBhcHBsaWVkIGxpY2Vuc2VzIChmb3IgdGVzdGluZyknKVxuXHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgTGljZW5zZXMnKVxuXHRcdFx0XHRcdC5zZXRXYXJuaW5nKClcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBDb25maXJtIGFjdGlvblxuXHRcdFx0XHRcdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBsaWNlbnNlcz8gVGhpcyB3aWxsIHJlbW92ZSBhbnkgYXBwbGllZCBTdXBlcm5vdmEgbGljZW5zZS4nKTtcblx0XHRcdFx0XHRcdGlmICghY29uZmlybWVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdC8vIENsZWFyIGxpY2Vuc2Uga2V5XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9ICcnO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBDbGVhciBGb3JjZSBTdXBlcm5vdmEgaWYgZW5hYmxlZFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShudWxsKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhclxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuXHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0FsbCBsaWNlbnNlcyBjbGVhcmVkIHN1Y2Nlc3NmdWxseS4nLCAnc3VjY2VzcycpO1xuXG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXlcblx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdH0pKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dMaWNlbnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIHR5cGU6ICdzdWNjZXNzJyB8ICdlcnJvcicpIHtcblx0XHQvLyBDcmVhdGUgb3IgdXBkYXRlIG1lc3NhZ2UgZWxlbWVudFxuXHRcdGNvbnN0IGV4aXN0aW5nTWVzc2FnZSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtbGljZW5zZS1tZXNzYWdlJyk7XG5cdFx0aWYgKGV4aXN0aW5nTWVzc2FnZSkge1xuXHRcdFx0ZXhpc3RpbmdNZXNzYWdlLnJlbW92ZSgpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgXG5cdFx0XHRjbHM6IGBub3ZhLWxpY2Vuc2UtbWVzc2FnZSAke3R5cGV9YCxcblx0XHRcdHRleHQ6IG1lc3NhZ2Vcblx0XHR9KTtcblxuXHRcdC8vIEF1dG8tcmVtb3ZlIGFmdGVyIDUgc2Vjb25kc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0bWVzc2FnZUVsLnJlbW92ZSgpO1xuXHRcdH0sIDUwMDApO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29uZmV0dGkoKSB7XG5cdFx0Ly8gQ3JlYXRlIGNvbmZldHRpIGNvbnRhaW5lclxuXHRcdGNvbnN0IGNvbmZldHRpQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0Y29uZmV0dGlDb250YWluZXIuY2xhc3NOYW1lID0gJ25vdmEtY29uZmV0dGktY29udGFpbmVyJztcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbmZldHRpQ29udGFpbmVyKTtcblxuXHRcdC8vIEdldCBzZXR0aW5ncyBjb250YWluZXIgcG9zaXRpb24gZm9yIGV4cGxvc2lvbiBjZW50ZXJcblx0XHRjb25zdCByZWN0ID0gdGhpcy5jb250YWluZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRjb25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7XG5cdFx0Y29uc3QgY2VudGVyWSA9IHJlY3QudG9wICsgTWF0aC5taW4ocmVjdC5oZWlnaHQgLyAyLCAzMDApO1xuXG5cdFx0Ly8gQ29sb3JzIGZvciBjb25mZXR0aVxuXHRcdGNvbnN0IGNvbG9ycyA9IFsnZ29sZCcsICdibHVlJywgJ3BpbmsnLCAnZ3JlZW4nLCAncmVkJywgJyddOyAgLy8gZW1wdHkgc3RyaW5nID0gZGVmYXVsdCBwdXJwbGVcblxuXHRcdC8vIENyZWF0ZSBjb25mZXR0aSBwaWVjZXNcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7XG5cdFx0XHRjb25zdCBjb25mZXR0aSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0Y29uZmV0dGkuY2xhc3NOYW1lID0gYG5vdmEtY29uZmV0dGktcGllY2UgJHtjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldfWA7XG5cdFx0XHRcblx0XHRcdC8vIFBvc2l0aW9uIGF0IGV4cGxvc2lvbiBjZW50ZXJcblx0XHRcdGNvbmZldHRpLnN0eWxlLmxlZnQgPSBgJHtjZW50ZXJYfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLnRvcCA9IGAke2NlbnRlcll9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgZXhwbG9zaW9uIHRyYWplY3Rvcnlcblx0XHRcdGNvbnN0IGFuZ2xlID0gKE1hdGguUEkgKiAyICogaSkgLyAxNTAgKyAoTWF0aC5yYW5kb20oKSAqIDAuMiAtIDAuMSk7XG5cdFx0XHRjb25zdCB2ZWxvY2l0eSA9IDI1MCArIE1hdGgucmFuZG9tKCkgKiAzNTA7IC8vIHBpeGVsc1xuXHRcdFx0Y29uc3QgZXhwbG9kZVggPSBNYXRoLmNvcyhhbmdsZSkgKiB2ZWxvY2l0eTtcblx0XHRcdGNvbnN0IGV4cGxvZGVZID0gTWF0aC5zaW4oYW5nbGUpICogdmVsb2NpdHkgLSAxNTA7IC8vIFN0cm9uZyB1cHdhcmQgYmlhc1xuXHRcdFx0XG5cdFx0XHQvLyBTZXQgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzIGZvciBhbmltYXRpb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLnNldFByb3BlcnR5KCctLWV4cGxvZGUteCcsIGAke2V4cGxvZGVYfXB4YCk7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1leHBsb2RlLXknLCBgJHtleHBsb2RlWX1weGApO1xuXHRcdFx0XG5cdFx0XHQvLyBSYW5kb20gZGVsYXkgZm9yIHN0YWdnZXJlZCBleHBsb3Npb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gYCR7TWF0aC5yYW5kb20oKSAqIDAuMn1zYDtcblx0XHRcdFxuXHRcdFx0Ly8gUmFuZG9tIHNpemVcblx0XHRcdGNvbnN0IHNpemUgPSA2ICsgTWF0aC5yYW5kb20oKSAqIDE0O1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUud2lkdGggPSBgJHtzaXplfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemV9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBNYWtlIHNvbWUgY29uZmV0dGkgcmVjdGFuZ3VsYXJcblx0XHRcdGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG5cdFx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemUgKiAwLjR9cHhgO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb25mZXR0aSk7XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGNvbnRhaW5lciBhZnRlciBhbmltYXRpb24gY29tcGxldGVzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5yZW1vdmUoKTtcblx0XHR9LCA0MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR2VuZXJhbFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnR2VuZXJhbCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IFRlbXBlcmF0dXJlJylcblx0XHRcdC5zZXREZXNjKCdDb250cm9scyByYW5kb21uZXNzIGluIEFJIHJlc3BvbnNlcyAoMC4wIC0gMS4wKScpXG5cdFx0XHQuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcblx0XHRcdFx0LnNldExpbWl0cygwLCAxLCAwLjEpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSlcblx0XHRcdFx0LnNldER5bmFtaWNUb29sdGlwKClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgTWF4IFRva2VucycpXG5cdFx0XHQuc2V0RGVzYygnTWF4aW11bSBsZW5ndGggb2YgQUkgcmVzcG9uc2VzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzEwMDAnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zLnRvU3RyaW5nKCkpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zdCBudW1WYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcblx0XHRcdFx0XHRpZiAoIWlzTmFOKG51bVZhbHVlKSAmJiBudW1WYWx1ZSA+IDApIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2VucyA9IG51bVZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdBdXRvLXNhdmUgc2V0dGluZ3MnKVxuXHRcdFx0LnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgc2F2ZSBzZXR0aW5ncyB3aGVuIGNoYW5nZWQnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5hdXRvU2F2ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb2xsYXBzaWJsZSBoZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29sbGFwc2libGUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiA4cHggMDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAxNnB4O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgYXJyb3dFbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWFycm93JyB9KTtcblx0XHRhcnJvd0VsLmlubmVySFRNTCA9ICdcdTI1QjYnO1xuXHRcdGFycm93RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRcdGZvbnQtc2l6ZTogMTJweDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdBSSBQcm92aWRlciBTZXR0aW5ncycgfSk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZmxleDogMTsnO1xuXG5cdFx0Y29uc3QgcHJvdmlkZXJDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdHByb3ZpZGVyQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogbm9uZTsnOyAvLyBTdGFydCBjb2xsYXBzZWRcblx0XHRcblx0XHQvLyBUb2dnbGUgZnVuY3Rpb25hbGl0eVxuXHRcdGhlYWRlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgaXNWaXNpYmxlID0gcHJvdmlkZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuXHRcdFx0cHJvdmlkZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXG5cdFx0Ly8gSW5mbyBhYm91dCBBUEkga2V5c1xuXHRcdGNvbnN0IGluZm9FbCA9IHByb3ZpZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDQ+Q29uZmlndXJlIFlvdXIgQVBJIEtleXM8L2g0PlxuXHRcdFx0XHQ8cD5Ob3ZhIGNvbm5lY3RzIHRvIEFJIHByb3ZpZGVycyB1c2luZyB5b3VyIG93biBBUEkga2V5cy4gQWxsIHByb3ZpZGVycyBhcmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyAtIFxuXHRcdFx0XHRqdXN0IGFkZCB5b3VyIEFQSSBrZXlzIGJlbG93IHRvIGdldCBzdGFydGVkLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBTaG93IGFsbCBwcm92aWRlcnMgLSBubyByZXN0cmljdGlvbnNcblx0XHR0aGlzLmNyZWF0ZU9sbGFtYVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZUNsYXVkZVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZUdvb2dsZVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZU9wZW5BSVNldHRpbmdzKHByb3ZpZGVyQ29udGFpbmVyKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2xhdWRlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3QgY2xhdWRlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRjbGF1ZGVDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQ2xhdWRlIChBbnRocm9waWMpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNsYXVkZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdBUEkgS2V5Jylcblx0XHRcdC5zZXREZXNjKCdZb3VyIEFudGhyb3BpYyBBUEkga2V5Jylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ3NrLWFudC0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcoY2xhdWRlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdDbGF1ZGUgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHR0aGlzLnBvcHVsYXRlQ2xhdWRlTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsIHx8ICdjbGF1ZGUtMy01LXNvbm5ldC0yMDI0MTAyMicpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHRtb2RlbFNldHRpbmcuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdC5zZXRJY29uKCdyZWZyZXNoLWN3Jylcblx0XHRcdC5zZXRUb29sdGlwKCdSZWZyZXNoIGF2YWlsYWJsZSBtb2RlbHMnKVxuXHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hQcm92aWRlck1vZGVscygnY2xhdWRlJywgbW9kZWxEcm9wZG93bik7XG5cdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIHBvcHVsYXRlQ2xhdWRlTW9kZWxzKGRyb3Bkb3duOiBhbnkpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG5cdFx0ZHJvcGRvd24uc2VsZWN0RWwuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBBZGQgZGVmYXVsdCBtb2RlbHNcblx0XHRjb25zdCBkZWZhdWx0TW9kZWxzID0gW1xuXHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJywgbGFiZWw6ICdDbGF1ZGUgMy41IFNvbm5ldCcgfSxcblx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy01LWhhaWt1LTIwMjQxMDIyJywgbGFiZWw6ICdDbGF1ZGUgMy41IEhhaWt1JyB9LFxuXHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLW9wdXMtMjAyNDAyMjknLCBsYWJlbDogJ0NsYXVkZSAzIE9wdXMnIH0sXG5cdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtc29ubmV0LTIwMjQwMjI5JywgbGFiZWw6ICdDbGF1ZGUgMyBTb25uZXQnIH0sXG5cdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLCBsYWJlbDogJ0NsYXVkZSAzIEhhaWt1JyB9XG5cdFx0XTtcblxuXHRcdGRlZmF1bHRNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgcmVmcmVzaFByb3ZpZGVyTW9kZWxzKHByb3ZpZGVyVHlwZTogJ2NsYXVkZScgfCAnb3BlbmFpJyB8ICdnb29nbGUnLCBkcm9wZG93bjogYW55KSB7XG5cdFx0Y29uc3QgYnV0dG9uID0gZHJvcGRvd24uc2VsZWN0RWwucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3RvcignLmNsaWNrYWJsZS1pY29uJyk7XG5cdFx0aWYgKGJ1dHRvbikge1xuXHRcdFx0YnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMC41Jztcblx0XHRcdGJ1dHRvbi5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBtb2RlbHMgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRQcm92aWRlck1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFx0XG5cdFx0XHRpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gQ2xlYXIgZXhpc3Rpbmcgb3B0aW9uc1xuXHRcdFx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQWRkIGZldGNoZWQgbW9kZWxzXG5cdFx0XHRcdG1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdFx0XHRjb25zdCBsYWJlbCA9IHRoaXMuZ2V0TW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGUsIG1vZGVsKTtcblx0XHRcdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwsIGxhYmVsKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gUmVzdG9yZSBjdXJyZW50IHNlbGVjdGlvbiBpZiBpdCBleGlzdHMgaW4gdGhlIG5ldyBsaXN0XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0ubW9kZWw7XG5cdFx0XHRcdGlmIChjdXJyZW50TW9kZWwgJiYgbW9kZWxzLmluY2x1ZGVzKGN1cnJlbnRNb2RlbCkpIHtcblx0XHRcdFx0XHRkcm9wZG93bi5zZXRWYWx1ZShjdXJyZW50TW9kZWwpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Ly8gU2V0IGZpcnN0IG1vZGVsIGFzIGRlZmF1bHQgaWYgY3VycmVudCBtb2RlbCBpcyBub3QgaW4gdGhlIGxpc3Rcblx0XHRcdFx0XHRkcm9wZG93bi5zZXRWYWx1ZShtb2RlbHNbMF0pO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0ubW9kZWwgPSBtb2RlbHNbMF07XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLnNob3dSZWZyZXNoTWVzc2FnZSgnTW9kZWxzIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHknLCAnc3VjY2VzcycpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zaG93UmVmcmVzaE1lc3NhZ2UoJ05vIG1vZGVscyBmb3VuZCBvciBBUEkga2V5IGludmFsaWQnLCAnZXJyb3InKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHJlZnJlc2ggJHtwcm92aWRlclR5cGV9IG1vZGVsczpgLCBlcnJvcik7XG5cdFx0XHR0aGlzLnNob3dSZWZyZXNoTWVzc2FnZShgRmFpbGVkIHRvIHJlZnJlc2ggbW9kZWxzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsICdlcnJvcicpO1xuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRpZiAoYnV0dG9uKSB7XG5cdFx0XHRcdGJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuXHRcdFx0XHRidXR0b24uc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIENyZWF0ZSBodW1hbi1yZWFkYWJsZSBuYW1lcyBmb3IgbW9kZWxzXG5cdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ2NsYXVkZScpIHtcblx0XHRcdGlmIChtb2RlbC5pbmNsdWRlcygnc29ubmV0JykpIHJldHVybiBtb2RlbC5pbmNsdWRlcygnMy01JykgPyAnQ2xhdWRlIDMuNSBTb25uZXQnIDogJ0NsYXVkZSAzIFNvbm5ldCc7XG5cdFx0XHRpZiAobW9kZWwuaW5jbHVkZXMoJ2hhaWt1JykpIHJldHVybiBtb2RlbC5pbmNsdWRlcygnMy01JykgPyAnQ2xhdWRlIDMuNSBIYWlrdScgOiAnQ2xhdWRlIDMgSGFpa3UnO1xuXHRcdFx0aWYgKG1vZGVsLmluY2x1ZGVzKCdvcHVzJykpIHJldHVybiAnQ2xhdWRlIDMgT3B1cyc7XG5cdFx0fSBlbHNlIGlmIChwcm92aWRlclR5cGUgPT09ICdvcGVuYWknKSB7XG5cdFx0XHRpZiAobW9kZWwuaW5jbHVkZXMoJ2dwdC00bycpKSByZXR1cm4gbW9kZWwuaW5jbHVkZXMoJ21pbmknKSA/ICdHUFQtNG8gTWluaScgOiAnR1BULTRvJztcblx0XHRcdGlmIChtb2RlbC5pbmNsdWRlcygnZ3B0LTQnKSkgcmV0dXJuICdHUFQtNCc7XG5cdFx0XHRpZiAobW9kZWwuaW5jbHVkZXMoJ2dwdC0zLjUnKSkgcmV0dXJuICdHUFQtMy41IFR1cmJvJztcblx0XHR9IGVsc2UgaWYgKHByb3ZpZGVyVHlwZSA9PT0gJ2dvb2dsZScpIHtcblx0XHRcdGlmIChtb2RlbC5pbmNsdWRlcygnMi4wJykpIHJldHVybiAnR2VtaW5pIDIuMCBGbGFzaCc7XG5cdFx0XHRpZiAobW9kZWwuaW5jbHVkZXMoJzEuNS1wcm8nKSkgcmV0dXJuICdHZW1pbmkgMS41IFBybyc7XG5cdFx0XHRpZiAobW9kZWwuaW5jbHVkZXMoJzEuNS1mbGFzaCcpKSByZXR1cm4gJ0dlbWluaSAxLjUgRmxhc2gnO1xuXHRcdFx0aWYgKG1vZGVsLmluY2x1ZGVzKCcxLjAtcHJvJykpIHJldHVybiAnR2VtaW5pIDEuMCBQcm8nO1xuXHRcdH1cblx0XHRcblx0XHQvLyBGYWxsYmFjayB0byBtb2RlbCBuYW1lXG5cdFx0cmV0dXJuIG1vZGVsO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93UmVmcmVzaE1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InKSB7XG5cdFx0Ly8gQ3JlYXRlIG9yIHVwZGF0ZSBtZXNzYWdlIGVsZW1lbnRcblx0XHRjb25zdCBleGlzdGluZ01lc3NhZ2UgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXJlZnJlc2gtbWVzc2FnZScpO1xuXHRcdGlmIChleGlzdGluZ01lc3NhZ2UpIHtcblx0XHRcdGV4aXN0aW5nTWVzc2FnZS5yZW1vdmUoKTtcblx0XHR9XG5cblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IFxuXHRcdFx0Y2xzOiBgbm92YS1yZWZyZXNoLW1lc3NhZ2UgJHt0eXBlfWAsXG5cdFx0XHR0ZXh0OiBtZXNzYWdlXG5cdFx0fSk7XG5cblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBmaXhlZDtcblx0XHRcdHRvcDogMjBweDtcblx0XHRcdHJpZ2h0OiAyMHB4O1xuXHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDAuOWVtO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdCR7dHlwZSA9PT0gJ3N1Y2Nlc3MnIFxuXHRcdFx0XHQ/ICdiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLXN1Y2Nlc3MpOyBjb2xvcjogdmFyKC0tdGV4dC1zdWNjZXNzKTsnIFxuXHRcdFx0XHQ6ICdiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKTsgY29sb3I6IHZhcigtLXRleHQtZXJyb3IpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1yZW1vdmUgYWZ0ZXIgMyBzZWNvbmRzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRtZXNzYWdlRWwucmVtb3ZlKCk7XG5cdFx0fSwgMzAwMCk7XG5cdH1cblxuXG5cdHByaXZhdGUgY3JlYXRlT3BlbkFJU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3Qgb3BlbmFpQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRvcGVuYWlDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQ2hhdEdQVCAoT3BlbkFJKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBPcGVuQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Jhc2UgVVJMJylcblx0XHRcdC5zZXREZXNjKCdPcGVuQUkgQVBJIGJhc2UgVVJMIChmb3IgY3VzdG9tIGVuZHBvaW50cyknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYmFzZVVybCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5iYXNlVXJsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIE1vZGVsIHNldHRpbmcgd2l0aCByZWZyZXNoIGJ1dHRvblxuXHRcdGNvbnN0IG1vZGVsU2V0dGluZyA9IG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT3BlbkFJIG1vZGVsIHRvIHVzZScpO1xuXG5cdFx0bGV0IG1vZGVsRHJvcGRvd246IGFueTtcblx0XHRcblx0XHRtb2RlbFNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0bW9kZWxEcm9wZG93biA9IGRyb3Bkb3duO1xuXHRcdFx0dGhpcy5wb3B1bGF0ZU9wZW5BSU1vZGVscyhkcm9wZG93bik7XG5cdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCB8fCAnZ3B0LTRvJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdG1vZGVsU2V0dGluZy5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuXHRcdFx0LnNldEljb24oJ3JlZnJlc2gtY3cnKVxuXHRcdFx0LnNldFRvb2x0aXAoJ1JlZnJlc2ggYXZhaWxhYmxlIG1vZGVscycpXG5cdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaFByb3ZpZGVyTW9kZWxzKCdvcGVuYWknLCBtb2RlbERyb3Bkb3duKTtcblx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVPcGVuQUlNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIEFkZCBkZWZhdWx0IG1vZGVsc1xuXHRcdGNvbnN0IGRlZmF1bHRNb2RlbHMgPSBbXG5cdFx0XHR7IHZhbHVlOiAnZ3B0LTRvJywgbGFiZWw6ICdHUFQtNG8nIH0sXG5cdFx0XHR7IHZhbHVlOiAnZ3B0LTRvLW1pbmknLCBsYWJlbDogJ0dQVC00byBNaW5pJyB9LFxuXHRcdFx0eyB2YWx1ZTogJ2dwdC00LXR1cmJvJywgbGFiZWw6ICdHUFQtNCBUdXJibycgfSxcblx0XHRcdHsgdmFsdWU6ICdncHQtNCcsIGxhYmVsOiAnR1BULTQnIH0sXG5cdFx0XHR7IHZhbHVlOiAnZ3B0LTMuNS10dXJibycsIGxhYmVsOiAnR1BULTMuNSBUdXJibycgfVxuXHRcdF07XG5cblx0XHRkZWZhdWx0TW9kZWxzLmZvckVhY2gobW9kZWwgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKG1vZGVsLnZhbHVlLCBtb2RlbC5sYWJlbCk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUdvb2dsZVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IGdvb2dsZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0Z29vZ2xlQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dvb2dsZSAoR2VtaW5pKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhnb29nbGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBHb29nbGUgQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdBSS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHQvLyBNb2RlbCBzZXR0aW5nIHdpdGggcmVmcmVzaCBidXR0b25cblx0XHRjb25zdCBtb2RlbFNldHRpbmcgPSBuZXcgU2V0dGluZyhnb29nbGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ0dlbWluaSBtb2RlbCB0byB1c2UnKTtcblxuXHRcdGxldCBtb2RlbERyb3Bkb3duOiBhbnk7XG5cdFx0XG5cdFx0bW9kZWxTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdG1vZGVsRHJvcGRvd24gPSBkcm9wZG93bjtcblx0XHRcdHRoaXMucG9wdWxhdGVHb29nbGVNb2RlbHMoZHJvcGRvd24pO1xuXHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUubW9kZWwgfHwgJ2dlbWluaS0xLjUtZmxhc2gnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0bW9kZWxTZXR0aW5nLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG5cdFx0XHQuc2V0SWNvbigncmVmcmVzaC1jdycpXG5cdFx0XHQuc2V0VG9vbHRpcCgnUmVmcmVzaCBhdmFpbGFibGUgbW9kZWxzJylcblx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoUHJvdmlkZXJNb2RlbHMoJ2dvb2dsZScsIG1vZGVsRHJvcGRvd24pO1xuXHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBwb3B1bGF0ZUdvb2dsZU1vZGVscyhkcm9wZG93bjogYW55KSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3Rpbmcgb3B0aW9uc1xuXHRcdGRyb3Bkb3duLnNlbGVjdEVsLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQWRkIGRlZmF1bHQgbW9kZWxzXG5cdFx0Y29uc3QgZGVmYXVsdE1vZGVscyA9IFtcblx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMi4wLWZsYXNoLWV4cCcsIGxhYmVsOiAnR2VtaW5pIDIuMCBGbGFzaCAoRXhwZXJpbWVudGFsKScgfSxcblx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMS41LXBybycsIGxhYmVsOiAnR2VtaW5pIDEuNSBQcm8nIH0sXG5cdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTEuNS1mbGFzaCcsIGxhYmVsOiAnR2VtaW5pIDEuNSBGbGFzaCcgfSxcblx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMS4wLXBybycsIGxhYmVsOiAnR2VtaW5pIDEuMCBQcm8nIH1cblx0XHRdO1xuXG5cdFx0ZGVmYXVsdE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVPbGxhbWFTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRjb25zdCBvbGxhbWFDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdG9sbGFtYUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdPbGxhbWEgKExvY2FsKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQmFzZSBVUkwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBzZXJ2ZXIgVVJMJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBtb2RlbCB0byB1c2UnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignbGxhbWEyJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUGxhdGZvcm0gU2V0dGluZ3MnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZsZXg6IDE7JztcblxuXHRcdGNvbnN0IHBsYXRmb3JtQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1zZWN0aW9uJyB9KTtcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IG5vbmU7JzsgLy8gU3RhcnQgY29sbGFwc2VkXG5cdFx0XG5cdFx0Ly8gVG9nZ2xlIGZ1bmN0aW9uYWxpdHlcblx0XHRoZWFkZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdGNvbnN0IGlzVmlzaWJsZSA9IHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpc1Zpc2libGUgPyAnbm9uZScgOiAnYmxvY2snO1xuXHRcdFx0YXJyb3dFbC5zdHlsZS50cmFuc2Zvcm0gPSBpc1Zpc2libGUgPyAncm90YXRlKDBkZWcpJyA6ICdyb3RhdGUoOTBkZWcpJztcblx0XHR9KTtcblx0XHRcblx0XHQvLyBJbmZvIGFib3V0IHBsYXRmb3JtIHNldHRpbmdzXG5cdFx0Y29uc3QgaW5mb0VsID0gcGxhdGZvcm1Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5cdUQ4M0RcdUREQTVcdUZFMEYgUGxhdGZvcm0gQ29uZmlndXJhdGlvbjwvaDQ+XG5cdFx0XHRcdDxwPkNvbmZpZ3VyZSB3aGljaCBBSSBwcm92aWRlciB0byB1c2UgYXMgeW91ciBwcmltYXJ5IHByb3ZpZGVyIG9uIGRpZmZlcmVudCBwbGF0Zm9ybXMuIFxuXHRcdFx0XHROb3ZhIHdvcmtzIHNlYW1sZXNzbHkgYWNyb3NzIGRlc2t0b3AgYW5kIG1vYmlsZSB3aXRoIGFsbCBwcm92aWRlcnMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXNrdG9wJyB9KTtcblx0XHRjb25zdCBkZXNrdG9wRHJvcGRvd24gPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBkZXNrdG9wJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRcdGNvbnN0IGFsbG93ZWRQcm92aWRlcnMgPSB0aGlzLmdldEFsbG93ZWRQcm92aWRlcnNGb3JQbGF0Zm9ybSgnZGVza3RvcCcpO1xuXHRcdFx0XHRcblx0XHRcdFx0YWxsb3dlZFByb3ZpZGVycy5mb3JFYWNoKHByb3ZpZGVyID0+IHtcblx0XHRcdFx0XHRjb25zdCBsYWJlbCA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcik7XG5cdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHByb3ZpZGVyLCBsYWJlbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AucHJpbWFyeVByb3ZpZGVyID0gdmFsdWUgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdNb2JpbGUnIH0pO1xuXHRcdGNvbnN0IG1vYmlsZVNldHRpbmcgPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBtb2JpbGUgZGV2aWNlcycpO1xuXHRcdFx0XG5cdFx0bW9iaWxlU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0LmFkZE9wdGlvbignbm9uZScsICdOb25lIChEaXNhYmxlZCknKVxuXHRcdFx0LmFkZE9wdGlvbignY2xhdWRlJywgJ0NsYXVkZScpXG5cdFx0XHQuYWRkT3B0aW9uKCdvcGVuYWknLCAnT3BlbkFJJylcblx0XHRcdC5hZGRPcHRpb24oJ2dvb2dsZScsICdHb29nbGUnKVxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlcilcblx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKHBsYXRmb3JtOiAnZGVza3RvcCcgfCAnbW9iaWxlJyk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4gcGxhdGZvcm0gPT09ICdkZXNrdG9wJyBcblx0XHRcdD8gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdFx0OiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdH1cblxuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXI6IFByb3ZpZGVyVHlwZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbmFtZXM6IFJlY29yZDxQcm92aWRlclR5cGUsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ0NsYXVkZSAoQW50aHJvcGljKScsXG5cdFx0XHQnb3BlbmFpJzogJ0NoYXRHUFQgKE9wZW5BSSknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUgKEdlbWluaSknLCBcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hIChMb2NhbCknLFxuXHRcdFx0J25vbmUnOiAnTm9uZSAoRGlzYWJsZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIG5hbWVzW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcblx0fVxuXG5cdGFzeW5jIHNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0ucHJpbWFyeVByb3ZpZGVyID0gcHJvdmlkZXJJZCBhcyBQcm92aWRlclR5cGU7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBwcm92aWRlciBtYW5hZ2VyIHdpdGggbmV3IHNldHRpbmdzXG5cdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ3VzdG9tIENvbW1hbmRzJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmbGV4OiAxOyc7XG5cblx0XHRjb25zdCBjb21tYW5kQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXNlY3Rpb24nIH0pO1xuXHRcdGNvbW1hbmRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBub25lOyc7IC8vIFN0YXJ0IGNvbGxhcHNlZFxuXHRcdFxuXHRcdC8vIFRvZ2dsZSBmdW5jdGlvbmFsaXR5XG5cdFx0aGVhZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRjb25zdCBpc1Zpc2libGUgPSBjb21tYW5kQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdGNvbW1hbmRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXG5cdFx0Ly8gRmVhdHVyZSBhdmFpbGFiaWxpdHkgY2hlY2tcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2N1c3RvbS1jb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBub3RpY2VFbCA9IGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1mZWF0dXJlLW5vdGljZScgfSk7XG5cdFx0XHRub3RpY2VFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAxNnB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgYm9yZGVyLXJhZGl1czogOHB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XCI+XG5cdFx0XHRcdFx0PGg0IHN0eWxlPVwibWFyZ2luOiAwIDAgOHB4IDA7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XCI+U3VwZXJub3ZhIFN1cHBvcnRlciBGZWF0dXJlPC9oND5cblx0XHRcdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtO1wiPlxuXHRcdFx0XHRcdFx0Q3VzdG9tIGNvbW1hbmRzIGFyZSBjdXJyZW50bHkgYXZhaWxhYmxlIHRvIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBcblx0XHRcdFx0XHRcdFRoZXkgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uIDxzdHJvbmc+T2N0b2JlciAxLCAyMDI1PC9zdHJvbmc+LlxuXHRcdFx0XHRcdDwvcD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERlc2NyaXB0aW9uXG5cdFx0Y29uc3QgZGVzY0VsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzY3JpcHRpb24nIH0pO1xuXHRcdGRlc2NFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8cCBzdHlsZT1cImNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLWJvdHRvbTogMTZweDtcIj5cblx0XHRcdFx0Q3JlYXRlIGN1c3RvbSBjb21tYW5kIHNob3J0Y3V0cyB0aGF0IGluc2VydCBwcmVkZWZpbmVkIHRleHQgdGVtcGxhdGVzIHdoZW4gdHJpZ2dlcmVkIHdpdGggPGNvZGU+OnRyaWdnZXI8L2NvZGU+LlxuXHRcdFx0PC9wPlxuXHRcdGA7XG5cblx0XHQvLyBTaG93IENvbW1hbmQgQnV0dG9uIHNldHRpbmcgKFN1cGVybm92YS1vbmx5KVxuXHRcdG5ldyBTZXR0aW5nKGNvbW1hbmRDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnU2hvdyBDb21tYW5kIEJ1dHRvbiBpbiBDaGF0Jylcblx0XHRcdC5zZXREZXNjKCdTaG93IHRoZSBDb21tYW5kcyBidXR0b24gYmVzaWRlIHRoZSBTZW5kIGJ1dHRvbiBmb3IgcXVpY2sgY29tbWFuZCBhY2Nlc3MnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbilcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gRmluZCBhbmQgcmVmcmVzaCBzaWRlYmFyIHZpZXdcblx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaENvbW1hbmRCdXR0b24oKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIEFkZCBuZXcgY29tbWFuZCBidXR0b24gYXQgdGhlIHRvcFxuXHRcdGNvbnN0IGJ1dHRvbkVsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWFkZC1jb21tYW5kJyB9KTtcblx0XHRidXR0b25FbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbi1ib3R0b206IDE2cHg7Jztcblx0XHRcblx0XHRuZXcgU2V0dGluZyhidXR0b25FbClcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IFxuXHRcdFx0XHRidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnKyBBZGQgQ3VzdG9tIENvbW1hbmQnKVxuXHRcdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHRoaXMuc2hvd0FkZENvbW1hbmREaWFsb2coKSlcblx0XHRcdCk7XG5cblx0XHQvLyBDb21tYW5kcyBsaXN0XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29tbWFuZENvbnRhaW5lcik7XG5cdH1cblxuXHRwcml2YXRlIHJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdChjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Ly8gQ2xlYXIgZXhpc3RpbmcgY29tbWFuZHMgbGlzdFxuXHRcdGNvbnN0IGV4aXN0aW5nTGlzdCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kcy1saXN0Jyk7XG5cdFx0aWYgKGV4aXN0aW5nTGlzdCkgZXhpc3RpbmdMaXN0LnJlbW92ZSgpO1xuXG5cdFx0Y29uc3QgY29tbWFuZHNMaXN0ID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZHMtbGlzdCcgfSk7XG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyB8fCBbXTtcblxuXHRcdGlmIChjb21tYW5kcy5sZW5ndGggPT09IDApIHtcblx0XHRcdGNvbnN0IGVtcHR5RWwgPSBjb21tYW5kc0xpc3QuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kcy1lbXB0eScgfSk7XG5cdFx0XHRlbXB0eUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjRweDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1wiPlxuXHRcdFx0XHRcdDxwPk5vIGN1c3RvbSBjb21tYW5kcyB5ZXQuPC9wPlxuXHRcdFx0XHRcdDxwIHN0eWxlPVwiZm9udC1zaXplOiAwLjllbTtcIj5DcmVhdGUgeW91ciBmaXJzdCBjb21tYW5kIHRvIGdldCBzdGFydGVkITwvcD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbW1hbmRzLmZvckVhY2goKGNvbW1hbmQsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBjb21tYW5kRWwgPSBjb21tYW5kc0xpc3QuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0nIH0pO1xuXHRcdFx0Y29tbWFuZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0XHRwYWRkaW5nOiAxNnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiAxMnB4O1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gQ29tbWFuZCBoZWFkZXJcblx0XHRcdGNvbnN0IGhlYWRlckVsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1oZWFkZXInIH0pO1xuXHRcdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OyBtYXJnaW4tYm90dG9tOiA4cHg7JztcblxuXHRcdFx0Y29uc3QgaW5mb0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWluZm8nIH0pO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBuYW1lRWwgPSBpbmZvRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW5hbWUnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDYwMDsgbWFyZ2luLWJvdHRvbTogNHB4Oyc7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGluZm9FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtdHJpZ2dlcicgfSk7XG5cdFx0XHR0cmlnZ2VyRWwuaW5uZXJIVE1MID0gYDxjb2RlPjoke2NvbW1hbmQudHJpZ2dlcn08L2NvZGU+YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7IGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBmb250LXNpemU6IDAuOWVtOyc7XG5cblx0XHRcdC8vIEFjdGlvbnNcblx0XHRcdGNvbnN0IGFjdGlvbnNFbCA9IGhlYWRlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1hY3Rpb25zJyB9KTtcblx0XHRcdGFjdGlvbnNFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGdhcDogOHB4Oyc7XG5cblx0XHRcdGNvbnN0IGVkaXRCdG4gPSBhY3Rpb25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0VkaXQnIH0pO1xuXHRcdFx0ZWRpdEJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGZvbnQtc2l6ZTogMC44ZW07IGJvcmRlci1yYWRpdXM6IDRweDsnO1xuXHRcdFx0ZWRpdEJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5zaG93RWRpdENvbW1hbmREaWFsb2coaW5kZXgpO1xuXG5cdFx0XHRjb25zdCBkZWxldGVCdG4gPSBhY3Rpb25zRWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0RlbGV0ZScgfSk7XG5cdFx0XHRkZWxldGVCdG4uc3R5bGUuY3NzVGV4dCA9ICdwYWRkaW5nOiA0cHggOHB4OyBmb250LXNpemU6IDAuOGVtOyBib3JkZXItcmFkaXVzOiA0cHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpOyBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpOyc7XG5cdFx0XHRkZWxldGVCdG4ub25jbGljayA9ICgpID0+IHRoaXMuZGVsZXRlQ29tbWFuZChpbmRleCk7XG5cblx0XHRcdC8vIERlc2NyaXB0aW9uIGFuZCB0ZW1wbGF0ZSBwcmV2aWV3XG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2MnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07IG1hcmdpbi1ib3R0b206IDhweDsnO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB0ZW1wbGF0ZUVsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC10ZW1wbGF0ZScgfSk7XG5cdFx0XHR0ZW1wbGF0ZUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cImJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBwYWRkaW5nOiA4cHg7IGJvcmRlci1yYWRpdXM6IDRweDsgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTsgZm9udC1zaXplOiAwLjhlbTsgd2hpdGUtc3BhY2U6IHByZS13cmFwOyBtYXgtaGVpZ2h0OiA2MHB4OyBvdmVyZmxvdy15OiBhdXRvO1wiPlxuXHRcdFx0XHRcdCR7Y29tbWFuZC50ZW1wbGF0ZX1cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93QWRkQ29tbWFuZERpYWxvZygpIHtcblx0XHR0aGlzLnNob3dDb21tYW5kRGlhbG9nKCk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dFZGl0Q29tbWFuZERpYWxvZyhpbmRleDogbnVtYmVyKSB7XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzPy5baW5kZXhdO1xuXHRcdGlmIChjb21tYW5kKSB7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kRGlhbG9nKGNvbW1hbmQsIGluZGV4KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kRGlhbG9nKGV4aXN0aW5nQ29tbWFuZD86IEN1c3RvbUNvbW1hbmQsIGVkaXRJbmRleD86IG51bWJlcikge1xuXHRcdC8vIEZvciBub3csIHVzZSBhIHNpbXBsZSBwcm9tcHQtYmFzZWQgYXBwcm9hY2hcblx0XHQvLyBUT0RPOiBJbXBsZW1lbnQgcHJvcGVyIG1vZGFsIHdoZW4gTW9kYWwgY2xhc3MgaXMgcHJvcGVybHkgYXZhaWxhYmxlXG5cdFx0Y29uc3QgbmFtZSA9IHByb21wdCgnQ29tbWFuZCBuYW1lOicsIGV4aXN0aW5nQ29tbWFuZD8ubmFtZSB8fCAnJyk7XG5cdFx0aWYgKCFuYW1lKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgdHJpZ2dlciA9IHByb21wdCgnQ29tbWFuZCB0cmlnZ2VyICh3aXRob3V0IDopOicsIGV4aXN0aW5nQ29tbWFuZD8udHJpZ2dlciB8fCAnJyk7XG5cdFx0aWYgKCF0cmlnZ2VyKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgZGVzY3JpcHRpb24gPSBwcm9tcHQoJ0Rlc2NyaXB0aW9uIChvcHRpb25hbCk6JywgZXhpc3RpbmdDb21tYW5kPy5kZXNjcmlwdGlvbiB8fCAnJyk7XG5cdFx0XG5cdFx0Y29uc3QgdGVtcGxhdGUgPSBwcm9tcHQoJ1RlbXBsYXRlIGNvbnRlbnQ6JywgZXhpc3RpbmdDb21tYW5kPy50ZW1wbGF0ZSB8fCAnJyk7XG5cdFx0aWYgKCF0ZW1wbGF0ZSkgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IHJlc3VsdDogQ3VzdG9tQ29tbWFuZCA9IHtcblx0XHRcdGlkOiBleGlzdGluZ0NvbW1hbmQ/LmlkIHx8ICgnY21kXycgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSkpLFxuXHRcdFx0bmFtZSxcblx0XHRcdHRyaWdnZXI6IHRyaWdnZXIudG9Mb3dlckNhc2UoKSxcblx0XHRcdHRlbXBsYXRlLFxuXHRcdFx0ZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uIHx8IHVuZGVmaW5lZFxuXHRcdH07XG5cdFx0XG5cdFx0aWYgKGVkaXRJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHQvLyBFZGl0IGV4aXN0aW5nIGNvbW1hbmRcblx0XHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzID0gW107XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kc1tlZGl0SW5kZXhdID0gcmVzdWx0O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBBZGQgbmV3IGNvbW1hbmRcblx0XHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzID0gW107XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcy5wdXNoKHJlc3VsdCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZC1zZWN0aW9uJykgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cblx0cHJpdmF0ZSBkZWxldGVDb21tYW5kKGluZGV4OiBudW1iZXIpIHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzW2luZGV4XTtcblx0XHRjb25zdCBjb25maXJtZWQgPSBjb25maXJtKGBEZWxldGUgY29tbWFuZCBcIiR7Y29tbWFuZC5uYW1lfVwiICgke2NvbW1hbmQudHJpZ2dlcn0pP2ApO1xuXHRcdFxuXHRcdGlmIChjb25maXJtZWQpIHtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZC1zZWN0aW9uJykgYXMgSFRNTEVsZW1lbnQpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBJdGVtVmlldywgV29ya3NwYWNlTGVhZiwgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUsIE5vdGljZSwgTWFya2Rvd25WaWV3LCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgfSBmcm9tICcuLi9jb3JlL3R5cGVzJztcbmltcG9ydCB7IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB9IGZyb20gJy4vd2lraWxpbmstc3VnZ2VzdCc7XG5pbXBvcnQgeyBNdWx0aURvY0NvbnRleHRIYW5kbGVyLCBNdWx0aURvY0NvbnRleHQgfSBmcm9tICcuLi9jb3JlL211bHRpLWRvYy1jb250ZXh0JztcblxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgPSAnbm92YS1zaWRlYmFyJztcblxuZXhwb3J0IGNsYXNzIE5vdmFTaWRlYmFyVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcblx0cGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNoYXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpbnB1dENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHRleHRBcmVhITogVGV4dEFyZWFDb21wb25lbnQ7XG5cdHByaXZhdGUgc2VuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0cHJpdmF0ZSBjb21tYW5kQnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjb21tYW5kUGlja2VySXRlbXM6IEhUTUxFbGVtZW50W10gPSBbXTtcblx0cHJpdmF0ZSBzZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyID0gLTE7XG5cdHByaXZhdGUgY29tbWFuZE1lbnUhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpc0NvbW1hbmRNZW51VmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuXHRwcml2YXRlIGF1dG9Hcm93VGV4dGFyZWEhOiAoKSA9PiB2b2lkO1xuXHRwcml2YXRlIHdpa2lsaW5rQXV0b2NvbXBsZXRlITogTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlO1xuXHRwcml2YXRlIGNvbnRleHRQcmV2aWV3ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgbXVsdGlEb2NIYW5kbGVyITogTXVsdGlEb2NDb250ZXh0SGFuZGxlcjtcblx0cHJpdmF0ZSBjb250ZXh0SW5kaWNhdG9yITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcblx0Ly8gRXZlbnQgbGlzdGVuZXIgY2xlYW51cCB0cmFja2luZ1xuXHRwcml2YXRlIGRvY3VtZW50RXZlbnRMaXN0ZW5lcnM6IEFycmF5PHtlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcn0+ID0gW107XG5cdHByaXZhdGUgdGltZW91dHM6IE5vZGVKUy5UaW1lb3V0W10gPSBbXTtcblxuXHRjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IE5vdmFQbHVnaW4pIHtcblx0XHRzdXBlcihsZWFmKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLm11bHRpRG9jSGFuZGxlciA9IG5ldyBNdWx0aURvY0NvbnRleHRIYW5kbGVyKHRoaXMuYXBwKTtcblx0fVxuXG5cdGdldFZpZXdUeXBlKCkge1xuXHRcdHJldHVybiBWSUVXX1RZUEVfTk9WQV9TSURFQkFSO1xuXHR9XG5cblx0Z2V0RGlzcGxheVRleHQoKSB7XG5cdFx0cmV0dXJuICdOb3ZhIEFJJztcblx0fVxuXG5cdGdldEljb24oKSB7XG5cdFx0cmV0dXJuICdub3ZhLXN0YXInO1xuXHR9XG5cblx0YXN5bmMgb25PcGVuKCkge1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG5cdFx0Y29udGFpbmVyLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyLmFkZENsYXNzKCdub3ZhLXNpZGViYXItY29udGFpbmVyJyk7XG5cblx0XHQvLyBNb2JpbGUgYWNjZXNzIGlzIG5vdyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHdyYXBwZXIgd2l0aCBwcm9wZXIgZmxleCBsYXlvdXRcblx0XHRjb25zdCB3cmFwcGVyRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13cmFwcGVyJyB9KTtcblx0XHR3cmFwcGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0aGVpZ2h0OiAxMDAlO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdHBhZGRpbmctYm90dG9tOiAke1BsYXRmb3JtLmlzRGVza3RvcEFwcCA/ICcyNXB4JyA6ICcwJ307XG5cdFx0YDtcblx0XHRcblx0XHQvLyBIZWFkZXIgd2l0aCBwcm92aWRlciBpbmZvXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB3cmFwcGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHBhZGRpbmc6IDEwcHg7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBMZWZ0IHNpZGU6IFRpdGxlIHdpdGggTm92YSBpY29uXG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckVsLmNyZWF0ZUVsKCdoNCcpO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZvbnQtc2l6ZTogMS4xZW07IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cdFx0dGl0bGVFbC5pbm5lckhUTUwgPSBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogMThweDsgaGVpZ2h0OiAxOHB4O1wiPlxuXHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdDwvc3ZnPk5vdmFgO1xuXHRcdFxuXHRcdC8vIFJpZ2h0IHNpZGU6IFByb3ZpZGVyIHN0YXR1cyBhbmQgQ2xlYXIgYnV0dG9uXG5cdFx0Y29uc3QgcmlnaHRDb250YWluZXIgPSBoZWFkZXJFbC5jcmVhdGVEaXYoKTtcblx0XHRyaWdodENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4Oyc7XG5cdFx0XG5cdFx0Ly8gQWxsIHVzZXJzIGNhbiBzd2l0Y2ggcHJvdmlkZXJzIGZyZWVseVxuXHRcdHRoaXMuY3JlYXRlUHJvdmlkZXJEcm9wZG93bihyaWdodENvbnRhaW5lcik7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgQ2hhdCBidXR0b24gaW4gcmlnaHQgY29udGFpbmVyXG5cdFx0Y29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHJpZ2h0Q29udGFpbmVyKTtcblx0XHRjbGVhckJ1dHRvbi5zZXRJY29uKCdlcmFzZXInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGNvbnZlcnNhdGlvbiBoaXN0b3J5Jylcblx0XHRcdC5vbkNsaWNrKCgpID0+IHRoaXMuY2xlYXJDaGF0KCkpO1xuXG5cdFx0dGhpcy5jcmVhdGVDaGF0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0dGhpcy5jcmVhdGVJbnB1dEludGVyZmFjZSh3cmFwcGVyRWwpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyIGZvciBhY3RpdmUgZmlsZSBjaGFuZ2VzXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0XHRcdH0pXG5cdFx0KTtcblx0XHRcblx0XHQvLyBMb2FkIGNvbnZlcnNhdGlvbiBmb3IgY3VycmVudCBmaWxlXG5cdFx0dGhpcy5sb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpO1xuXHR9XG5cblx0YXN5bmMgb25DbG9zZSgpIHtcblx0XHQvLyBDbGVhbiB1cCBwcm92aWRlciBkcm9wZG93biBldmVudCBsaXN0ZW5lclxuXHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy5jbGVhbnVwKSB7XG5cdFx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLmNsZWFudXAoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuZGVzdHJveSgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHRcdHRoaXMuY2xlYW51cEV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgYWxsIHRpbWVvdXRzXG5cdFx0dGhpcy5jbGVhclRpbWVvdXRzKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgRE9NIGVsZW1lbnRzXG5cdFx0dGhpcy5jbGVhbnVwRE9NRWxlbWVudHMoKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEFkZCBldmVudCBsaXN0ZW5lciB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGVsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyKTogdm9pZCB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMucHVzaCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIHRpbWVvdXQgd2l0aCBhdXRvbWF0aWMgY2xlYW51cCB0cmFja2luZ1xuXHQgKi9cblx0cHJpdmF0ZSBhZGRUcmFja2VkVGltZW91dChjYWxsYmFjazogKCkgPT4gdm9pZCwgZGVsYXk6IG51bWJlcik6IE5vZGVKUy5UaW1lb3V0IHtcblx0XHRjb25zdCBpZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdHRoaXMudGltZW91dHMgPSB0aGlzLnRpbWVvdXRzLmZpbHRlcih0ID0+IHQgIT09IGlkKTtcblx0XHR9LCBkZWxheSk7XG5cdFx0dGhpcy50aW1lb3V0cy5wdXNoKGlkKTtcblx0XHRyZXR1cm4gaWQ7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBhbGwgdHJhY2tlZCBldmVudCBsaXN0ZW5lcnNcblx0ICovXG5cdHByaXZhdGUgY2xlYW51cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5mb3JFYWNoKCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pID0+IHtcblx0XHRcdGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0fSk7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzID0gW107XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhciBhbGwgdHJhY2tlZCB0aW1lb3V0c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhclRpbWVvdXRzKCk6IHZvaWQge1xuXHRcdHRoaXMudGltZW91dHMuZm9yRWFjaChpZCA9PiBjbGVhclRpbWVvdXQoaWQpKTtcblx0XHR0aGlzLnRpbWVvdXRzID0gW107XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBET00gZWxlbWVudHNcblx0ICovXG5cdHByaXZhdGUgY2xlYW51cERPTUVsZW1lbnRzKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zID0gW107XG5cdFx0aWYgKHRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb21tYW5kUGlja2VyKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuZW1wdHkoKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY29tbWFuZE1lbnUucmVtb3ZlKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDaGF0SW50ZXJmYWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmNoYXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jaGF0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHBhZGRpbmc6IDEwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogOHB4O1xuXHRcdGA7XG5cblx0XHQvLyBXZWxjb21lIG1lc3NhZ2Ugd2l0aCBOb3ZhIGJyYW5kaW5nXG5cdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVJbnB1dEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5pbnB1dENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jcmVhdGVJbnB1dEFyZWEoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgdGhlIGlucHV0IGFyZWEgVUkgZWxlbWVudHNcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSW5wdXRBcmVhKCkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIGlucHV0IGFyZWEgY29udGVudFxuXHRcdHRoaXMuaW5wdXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogOHB4O1xuXHRcdFx0cGFkZGluZzogMTBweDtcblx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRgO1xuXG5cdFx0Ly8gU2ltcGxpZmllZCBpbnB1dCByb3cgd2l0aCBqdXN0IHRleHRhcmVhIGFuZCBzZW5kIGJ1dHRvblxuXHRcdGNvbnN0IGlucHV0Um93ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LXJvdycgfSk7XG5cdFx0aW5wdXRSb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA4cHg7XG5cdFx0YDtcblxuXHRcdC8vIFRleHQgYXJlYSB0YWtlcyBtb3N0IHNwYWNlXG5cdFx0Y29uc3QgdGV4dEFyZWFDb250YWluZXIgPSBpbnB1dFJvdy5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7IHBvc2l0aW9uOiByZWxhdGl2ZTsnO1xuXHRcdHRoaXMudGV4dEFyZWEgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodGV4dEFyZWFDb250YWluZXIpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0UGxhY2Vob2xkZXIoJ0FzayBOb3ZhIHRvIGhlbHAgZWRpdCB5b3VyIGRvY3VtZW50Li4uJyk7XG5cdFx0XG5cdFx0Ly8gUGxhdGZvcm0tYXdhcmUgZGVmYXVsdHMgYW5kIGF1dG8tZ3Jvd2luZyBzZXR1cFxuXHRcdGNvbnN0IGxpbmVIZWlnaHQgPSAxLjU7IC8vIGVtIHVuaXRzXG5cdFx0Y29uc3QgcGFkZGluZ1ZlcnRpY2FsID0gMjA7IC8vIHB4ICgxMHB4IHRvcCArIDEwcHggYm90dG9tKVxuXHRcdGNvbnN0IGJvcmRlcldpZHRoID0gMjsgLy8gcHggKDFweCB0b3AgKyAxcHggYm90dG9tKVxuXHRcdGNvbnN0IGJhc2VMaW5lcyA9IFBsYXRmb3JtLmlzTW9iaWxlID8gMiA6IDM7XG5cdFx0Y29uc3QgbWF4TGluZXMgPSBQbGF0Zm9ybS5pc01vYmlsZSA/IDggOiA2O1xuXHRcdFxuXHRcdC8vIENhbGN1bGF0ZSBpbml0aWFsIGhlaWdodCBiYXNlZCBvbiBwbGF0Zm9ybVxuXHRcdGNvbnN0IGZvbnRTaXplID0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgnLS1mb250LXRleHQtc2l6ZScpIHx8ICcxNHB4Jyk7XG5cdFx0Y29uc3QgaW5pdGlhbEhlaWdodCA9IChiYXNlTGluZXMgKiBsaW5lSGVpZ2h0ICogZm9udFNpemUpICsgcGFkZGluZ1ZlcnRpY2FsICsgYm9yZGVyV2lkdGg7XG5cdFx0XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aW5pdGlhbEhlaWdodH1weDtcblx0XHRcdG1heC1oZWlnaHQ6ICR7KG1heExpbmVzICogbGluZUhlaWdodCAqIGZvbnRTaXplKSArIHBhZGRpbmdWZXJ0aWNhbCArIGJvcmRlcldpZHRofXB4O1xuXHRcdFx0aGVpZ2h0OiAke2luaXRpYWxIZWlnaHR9cHg7XG5cdFx0XHRyZXNpemU6IG5vbmU7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRwYWRkaW5nOiAxMHB4O1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXRleHQtc2l6ZSk7XG5cdFx0XHRsaW5lLWhlaWdodDogJHtsaW5lSGVpZ2h0fTtcblx0XHRcdG92ZXJmbG93LXk6IGhpZGRlbjtcblx0XHRcdHRyYW5zaXRpb246IGhlaWdodCAwLjFzIGVhc2Utb3V0O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gQXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCBlbCA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRcdFxuXHRcdFx0Ly8gUmVzZXQgaGVpZ2h0IHRvIGF1dG8gdG8gZ2V0IHRoZSBjb3JyZWN0IHNjcm9sbEhlaWdodFxuXHRcdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgbmV3IGhlaWdodCBiYXNlZCBvbiBjb250ZW50XG5cdFx0XHRjb25zdCBjb250ZW50SGVpZ2h0ID0gZWwuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0Y29uc3QgbWluSGVpZ2h0ID0gaW5pdGlhbEhlaWdodDtcblx0XHRcdGNvbnN0IG1heEhlaWdodCA9IChtYXhMaW5lcyAqIGxpbmVIZWlnaHQgKiBmb250U2l6ZSkgKyBwYWRkaW5nVmVydGljYWwgKyBib3JkZXJXaWR0aDtcblx0XHRcdFxuXHRcdFx0Ly8gQ2xhbXAgaGVpZ2h0IGJldHdlZW4gbWluIGFuZCBtYXhcblx0XHRcdGNvbnN0IG5ld0hlaWdodCA9IE1hdGgubWF4KG1pbkhlaWdodCwgTWF0aC5taW4oY29udGVudEhlaWdodCwgbWF4SGVpZ2h0KSk7XG5cdFx0XHRcblx0XHRcdC8vIEFwcGx5IG5ldyBoZWlnaHRcblx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGAke25ld0hlaWdodH1weGA7XG5cdFx0XHRcblx0XHRcdC8vIFNob3cgc2Nyb2xsYmFyIG9ubHkgd2hlbiBjb250ZW50IGV4Y2VlZHMgbWF4IGhlaWdodFxuXHRcdFx0ZWwuc3R5bGUub3ZlcmZsb3dZID0gY29udGVudEhlaWdodCA+IG1heEhlaWdodCA/ICdhdXRvJyA6ICdoaWRkZW4nO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQWRkIGlucHV0IGV2ZW50IGxpc3RlbmVyIGZvciBhdXRvLWdyb3dcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmF1dG9Hcm93VGV4dGFyZWEpO1xuXHRcdFxuXHRcdC8vIEFsc28gdHJpZ2dlciBvbiBpbml0aWFsIGxvYWQgYW5kIHdoZW4gdmFsdWUgY2hhbmdlcyBwcm9ncmFtbWF0aWNhbGx5XG5cdFx0c2V0VGltZW91dCh0aGlzLmF1dG9Hcm93VGV4dGFyZWEsIDApO1xuXHRcdFxuXHRcdC8vIEluaXRpYWxpemUgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSA9IG5ldyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUodGhpcy5hcHAsIHRoaXMudGV4dEFyZWEuaW5wdXRFbCk7XG5cdFx0XG5cdFx0Ly8gQWRkIHJlYWwtdGltZSBjb250ZXh0IHByZXZpZXdcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHR0aGlzLnVwZGF0ZUxpdmVDb250ZXh0UHJldmlldygpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ29tbWFuZCBidXR0b24gKGxpZ2h0bmluZykgLSBjb25kaXRpb25hbGx5IHNob3duXG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldEljb24oJ3phcCcpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5zZXRUb29sdGlwKCdDb21tYW5kcycpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMudG9nZ2xlQ29tbWFuZE1lbnUoKSk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHR3aWR0aDogMzZweDtcblx0XHRcdGhlaWdodDogMzZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGRpc3BsYXk6ICR7dGhpcy5zaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpID8gJ2ZsZXgnIDogJ25vbmUnfTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdGA7XG5cblx0XHQvLyBTZW5kIGJ1dHRvbiB2ZXJ0aWNhbGx5IGNlbnRlcmVkXG5cdFx0dGhpcy5zZW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEljb24oJ3NlbmQnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0VG9vbHRpcCgnU2VuZCBtZXNzYWdlJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldEN0YSgpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuaGFuZGxlU2VuZCgpKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiAzNnB4O1xuXHRcdFx0aGVpZ2h0OiAzNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXG5cdFx0Ly8gRW50ZXIga2V5IGhhbmRsaW5nIGFuZCBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInICYmICFldmVudC5zaGlmdEtleSkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR0aGlzLmhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKSB8fCB0aGlzLmhhbmRsZVNlbmQoKTtcblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicgfHwgZXZlbnQua2V5ID09PSAnQXJyb3dVcCcpIHtcblx0XHRcdFx0aWYgKHRoaXMuaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR0aGlzLm5hdmlnYXRlQ29tbWFuZFBpY2tlcihldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nID8gMSA6IC0xKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSW5wdXQgY2hhbmdlIGhhbmRsaW5nIGZvciBjb21tYW5kIHBpY2tlciAoYWxyZWFkeSBoYXMgYXV0b0dyb3cgbGlzdGVuZXIpXG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuXHRcdFx0dGhpcy5oYW5kbGVJbnB1dENoYW5nZSgpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgcGlja2VyXG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kUGlja2VyKCk7XG5cblx0XHQvLyBDcmVhdGUgY29tbWFuZCBtZW51XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kTWVudSgpO1xuXG5cdFx0Ly8gQ3JlYXRlIGNvbnRleHQgaW5kaWNhdG9yIGFuZCBwcmV2aWV3XG5cdFx0dGhpcy5jcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0dGhpcy5jb250ZXh0UHJldmlldyA9IHRoaXMuY3JlYXRlQ29udGV4dFByZXZpZXcoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IDEwcHg7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdG1heC13aWR0aDogODUlO1xuXHRcdFx0JHtyb2xlID09PSAndXNlcicgXG5cdFx0XHRcdD8gJ21hcmdpbi1sZWZ0OiBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpOycgXG5cdFx0XHRcdDogcm9sZSA9PT0gJ3N5c3RlbSdcblx0XHRcdFx0PyAnbWFyZ2luOiAwIGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IHRleHQtYWxpZ246IGNlbnRlcjsgZm9udC1zaXplOiAwLjllbTsnXG5cdFx0XHRcdDogJ2JhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsnXG5cdFx0XHR9XG5cdFx0YDtcblxuXHRcdGNvbnN0IHJvbGVFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBcblx0XHRcdHRleHQ6IHJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogcm9sZSA9PT0gJ3N5c3RlbScgPyAnU3lzdGVtJyA6ICdOb3ZhJyxcblx0XHRcdGNsczogJ25vdmEtbWVzc2FnZS1yb2xlJ1xuXHRcdH0pO1xuXHRcdHJvbGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdG9wYWNpdHk6IDAuNztcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0Ly8gVXNlIGlubmVySFRNTCBmb3Igc3lzdGVtIG1lc3NhZ2VzIHRvIHN1cHBvcnQgaWNvbnMsIHRleHRDb250ZW50IGZvciBvdGhlcnMgZm9yIHNlY3VyaXR5XG5cdFx0aWYgKHJvbGUgPT09ICdzeXN0ZW0nICYmIGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tIHdpdGggc21vb3RoIGFuaW1hdGlvblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZykge1xuXHRcdGNvbnN0IHdlbGNvbWVFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUnIH0pO1xuXHRcdHdlbGNvbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDEycHg7XG5cdFx0XHRtYXJnaW46IDE2cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDE2cHggMjBweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxOHB4O1xuXHRcdFx0bWF4LXdpZHRoOiA5MCU7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjVzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBOb3ZhIHN0YXIgaWNvbiAoc3RhdGljLCBub3QgYW5pbWF0ZWQpXG5cdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUtaWNvbicgfSk7XG5cdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0d2lkdGg6IDMycHg7XG5cdFx0XHRoZWlnaHQ6IDMycHg7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdGljb25Db250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0PHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogMzJweDsgaGVpZ2h0OiAzMnB4OyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPlxuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gV2VsY29tZSB0ZXh0XG5cdFx0Y29uc3QgdGV4dENvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSB0ZXh0Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6ICdXZWxjb21lIHRvIE5vdmEnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXRleHQtc2l6ZSk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdWJ0aXRsZUVsID0gdGV4dENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBtZXNzYWdlIHx8ICdZb3VyIEFJIHRoaW5raW5nIHBhcnRuZXIuIEFzayBtZSB0byBoZWxwIGVkaXQgeW91ciBkb2N1bWVudCEnIH0pO1xuXHRcdHN1YnRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGZvbnQtc2l6ZTogMC45ZW07XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3VjY2Vzc0luZGljYXRvcihhY3Rpb246IHN0cmluZykge1xuXHRcdGNvbnN0IGluZGljYXRvckVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VjY2Vzcy1pbmRpY2F0b3InIH0pO1xuXHRcdGluZGljYXRvckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0bWFyZ2luOiA4cHggYXV0bztcblx0XHRcdHBhZGRpbmc6IDZweCAxMnB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSg3NiwgMTc1LCA4MCwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoNzYsIDE3NSwgODAsIDAuMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdG1heC13aWR0aDogMjAwcHg7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjNzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBZGQgY2hlY2ttYXJrIGFuZCB0ZXh0XG5cdFx0aW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBzdHlsZT1cIndpZHRoOiAxMnB4OyBoZWlnaHQ6IDEycHg7IG1hcmdpbi1yaWdodDogNnB4OyBib3JkZXItcmFkaXVzOiA1MCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyO1wiPlxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwid2lkdGg6IDRweDsgaGVpZ2h0OiAycHg7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgd2hpdGU7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB3aGl0ZTsgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKSB0cmFuc2xhdGUoLTAuNXB4LCAtMC41cHgpO1wiPjwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQke3RoaXMuZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbil9XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29tcGFjdFN1Y2Nlc3NNZXNzYWdlKGFjdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRzd2l0Y2ggKGFjdGlvbikge1xuXHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGFkZGVkJztcblx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgZWRpdGVkJztcblx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBkZWxldGVkJztcblx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRyZXR1cm4gJ0dyYW1tYXIgZml4ZWQnO1xuXHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCByZXdyaXR0ZW4nO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuICdDb21tYW5kIGNvbXBsZXRlZCc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0Ly8gQ2hlY2sgaWYgY29tbWFuZCBzeXN0ZW0gZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kLXN5c3RlbScpKSB7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3phcCcsICdDb21tYW5kIHN5c3RlbSBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMTUsIDIwMjUuJykpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZCA9IG1lc3NhZ2Uuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsgLy8gUmVtb3ZlICc6JyBhbmQgbm9ybWFsaXplXG5cblx0XHQvLyBQcm92aWRlciBzd2l0Y2hpbmcgY29tbWFuZHNcblx0XHRjb25zdCBwcm92aWRlckNvbW1hbmRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdjbGF1ZGUnLFxuXHRcdFx0J2NoYXRncHQnOiAnb3BlbmFpJyxcblx0XHRcdCdvcGVuYWknOiAnb3BlbmFpJyxcblx0XHRcdCdnZW1pbmknOiAnZ29vZ2xlJyxcblx0XHRcdCdnb29nbGUnOiAnZ29vZ2xlJyxcblx0XHRcdCdvbGxhbWEnOiAnb2xsYW1hJ1xuXHRcdH07XG5cblx0XHRpZiAocHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXSkge1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVyQ29tbWFuZHNbY29tbWFuZF07XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zZXR0aW5nVGFiLnNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkKTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdyZWZyZXNoLWN3JywgYFN3aXRjaGVkIHRvICR7dGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVySWQpfWApKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGZvciBjdXN0b20gY29tbWFuZHMgKGlmIGZlYXR1cmUgZW5hYmxlZClcblx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY3VzdG9tLWNvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uZmluZChjbWQgPT4gY21kLnRyaWdnZXIgPT09IGNvbW1hbmQpO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmQpIHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBjdXN0b20gY29tbWFuZFxuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGN1c3RvbUNvbW1hbmQudGVtcGxhdGUpO1xuXHRcdFx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBhZnRlciBzZXR0aW5nIHRlbXBsYXRlXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5hdXRvR3Jvd1RleHRhcmVhKCksIDApO1xuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2VkaXQnLCBgTG9hZGVkIHRlbXBsYXRlOiAke2N1c3RvbUNvbW1hbmQubmFtZX1gKSk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFVua25vd24gY29tbWFuZFxuXHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnaGVscC1jaXJjbGUnLCBgVW5rbm93biBjb21tYW5kICc6JHtjb21tYW5kfScuIFRyeSA6Y2xhdWRlLCA6Y2hhdGdwdCwgOmdlbWluaSwgb3IgOm9sbGFtYWApKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXInIH0pO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGNvbnN0IHZhbHVlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdGlmICh2YWx1ZS5zdGFydHNXaXRoKCc6JykgJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1zeXN0ZW0nKSkge1xuXHRcdFx0Y29uc3QgcXVlcnkgPSB2YWx1ZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZFBpY2tlcihxdWVyeSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kUGlja2VyKHF1ZXJ5OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKS5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLnRyaWdnZXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgY21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSlcblx0XHQpO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0nIH0pO1xuXHRcdFx0aXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdFx0cGFkZGluZzogMnB4IDZweDtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0XHRmb250LXNpemU6IDAuOWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC1uYW1lJyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7JztcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2MnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXNpemU6IDAuOGVtOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Jztcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChpbmRleCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgaGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXHR9XG5cblx0cHJpdmF0ZSBpc0NvbW1hbmRQaWNrZXJWaXNpYmxlKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgbmF2aWdhdGVDb21tYW5kUGlja2VyKGRpcmVjdGlvbjogbnVtYmVyKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG5cdFx0Y29uc3QgbmV3SW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEsXG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgZGlyZWN0aW9uXG5cdFx0KSk7XG5cblx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChuZXdJbmRleCk7XG5cdH1cblxuXHRwcml2YXRlIHNldFNlbGVjdGVkQ29tbWFuZChpbmRleDogbnVtYmVyKTogdm9pZCB7XG5cdFx0Ly8gUmVtb3ZlIHByZXZpb3VzIHNlbGVjdGlvblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG5cdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IGluZGV4O1xuXG5cdFx0aWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zW2luZGV4XS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXNbaW5kZXhdLnNjcm9sbEludG9WaWV3KHsgYmxvY2s6ICduZWFyZXN0JyB9KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogYm9vbGVhbiB7XG5cdFx0aWYgKCF0aGlzLmlzQ29tbWFuZFBpY2tlclZpc2libGUoKSB8fCB0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID09PSAtMSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpO1xuXHRcdGNvbnN0IHNlbGVjdGVkQ29tbWFuZCA9IGNvbW1hbmRzW3RoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXhdO1xuXHRcdFxuXHRcdGlmIChzZWxlY3RlZENvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2VsZWN0Q29tbWFuZChzZWxlY3RlZENvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIHNlbGVjdENvbW1hbmQodHJpZ2dlcjogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShgOiR7dHJpZ2dlcn1gKTtcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0Ly8gVHJpZ2dlciB0aGUgY29tbWFuZCBpbW1lZGlhdGVseVxuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBdmFpbGFibGVDb21tYW5kcygpOiBBcnJheTx7dHJpZ2dlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nfT4ge1xuXHRcdGNvbnN0IGNvbW1hbmRzOiBBcnJheTx7dHJpZ2dlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nfT4gPSBbXG5cdFx0XHR7IHRyaWdnZXI6ICdjbGF1ZGUnLCBuYW1lOiAnU3dpdGNoIHRvIENsYXVkZScsIGRlc2NyaXB0aW9uOiAnQW50aHJvcGljIENsYXVkZSBBSScgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2NoYXRncHQnLCBuYW1lOiAnU3dpdGNoIHRvIENoYXRHUFQnLCBkZXNjcmlwdGlvbjogJ09wZW5BSSBHUFQgbW9kZWxzJyB9LFxuXHRcdFx0eyB0cmlnZ2VyOiAnZ2VtaW5pJywgbmFtZTogJ1N3aXRjaCB0byBHZW1pbmknLCBkZXNjcmlwdGlvbjogJ0dvb2dsZSBHZW1pbmkgQUknIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdvbGxhbWEnLCBuYW1lOiAnU3dpdGNoIHRvIE9sbGFtYScsIGRlc2NyaXB0aW9uOiAnTG9jYWwgQUkgbW9kZWxzJyB9XG5cdFx0XTtcblxuXHRcdC8vIEFkZCBjdXN0b20gY29tbWFuZHMgaWYgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2N1c3RvbS1jb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXHRcdFx0Y3VzdG9tQ29tbWFuZHMuZm9yRWFjaChjbWQgPT4ge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHR0cmlnZ2VyOiBjbWQudHJpZ2dlcixcblx0XHRcdFx0XHRuYW1lOiBjbWQubmFtZSxcblx0XHRcdFx0XHQuLi4oY21kLmRlc2NyaXB0aW9uICYmIHsgZGVzY3JpcHRpb246IGNtZC5kZXNjcmlwdGlvbiB9KVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb21tYW5kcztcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudSA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1pbi13aWR0aDogMjQwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdGJveC1zaGFkb3c6IDAgLTRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjb21tYW5kTWVudUNsaWNrSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGlmICghdGhpcy5jb21tYW5kTWVudS5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkgJiYgXG5cdFx0XHRcdCF0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjb21tYW5kTWVudUNsaWNrSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIHRvZ2dsZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1idXR0b24nKSkge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd6YXAnLCAnQ29tbWFuZCBidXR0b24gaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgU3VwZXJub3ZhIHN1cHBvcnRlcnMuIEF2YWlsYWJsZSB0byBhbGwgdXNlcnMgQXVndXN0IDE1LCAyMDI1LicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRcblx0XHR0aGlzLmNvbW1hbmRNZW51LmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0Zm9udC1zaXplOiAwLjllbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0YDtcblx0XHRoZWFkZXJFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ3phcCcpICsgJyBDb21tYW5kcyc7XG5cblx0XHQvLyBDb21tYW5kcyBsaXN0XG5cdFx0Y29tbWFuZHMuZm9yRWFjaChjb21tYW5kID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWl0ZW0nIH0pO1xuXHRcdFx0aXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiAxMnB4IDE2cHg7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdFx0Z2FwOiA0cHg7XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtbmFtZScgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtdHJpZ2dlcicgfSk7XG5cdFx0XHR0cmlnZ2VyRWwudGV4dENvbnRlbnQgPSBgOiR7Y29tbWFuZC50cmlnZ2VyfWA7XG5cdFx0XHR0cmlnZ2VyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRcdG9wYWNpdHk6IDAuODtcblx0XHRcdGA7XG5cblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtZGVzYycgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0XHRgO1xuXHRcdFx0fVxuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdH0pO1xuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG5cdFx0XHR9KTtcblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5leGVjdXRlQ29tbWFuZEZyb21NZW51KGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBleGVjdXRlQ29tbWFuZEZyb21NZW51KHRyaWdnZXI6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XG5cdFx0Ly8gRXhlY3V0ZSB0aGUgY29tbWFuZCBkaXJlY3RseVxuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoYDoke3RyaWdnZXJ9YCk7XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtaW5kaWNhdG9yJyB9KTtcblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDhweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdC8vIFJldHVybiBhIGR1bW15IGVsZW1lbnQgdGhhdCB3b24ndCBiZSB1c2VkXG5cdFx0XHRyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIGEgcHJldmlldyBhcmVhIHRoYXQgc2hvd3MgbGl2ZSBjb250ZXh0IGFzIHVzZXIgdHlwZXNcblx0XHRjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRgO1xuXG5cdFx0Y29uc3QgcHJldmlld1RleHQgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy10ZXh0JyB9KTtcblx0XHRwcmV2aWV3VGV4dC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgJyBDb250ZXh0IHdpbGwgaW5jbHVkZTogJztcblx0XHRwcmV2aWV3VGV4dC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnIH0pO1xuXHRcdHByZXZpZXdMaXN0LnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7JztcblxuXHRcdHJldHVybiBwcmV2aWV3Q29udGFpbmVyO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRQcmV2aWV3IHx8ICF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbWVzc2FnZSA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Ly8gTm90ZTogQWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50IGZvciBzaW1wbGlmaWVkIFVYXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0XG5cdFx0XHQvLyBUcnkgdG8gZmluZCB0aGUgZmlsZSB0byB2YWxpZGF0ZSBpdCBleGlzdHNcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmZpbmRGaWxlQnlOYW1lKGRvY05hbWUpO1xuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvY05hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgY3VycmVudCBmaWxlXG5cdFx0Y29uc3QgcGVyc2lzdGVudERvY3MgPSB0aGlzLm11bHRpRG9jSGFuZGxlci5nZXRQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlPy5wYXRoIHx8ICcnKTtcblx0XHRwZXJzaXN0ZW50RG9jcy5mb3JFYWNoKGRvYyA9PiB7XG5cdFx0XHQvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBpbiBmb3VuZFJlZnMgdG8gYXZvaWQgZHVwbGljYXRlc1xuXHRcdFx0Y29uc3QgZXhpc3RzID0gZm91bmRSZWZzLnNvbWUocmVmID0+IHJlZi5uYW1lID09PSBkb2MuZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRmb3VuZFJlZnMucHVzaCh7XG5cdFx0XHRcdFx0bmFtZTogZG9jLmZpbGUuYmFzZW5hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHk6IGRvYy5wcm9wZXJ0eVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3XG5cdFx0aWYgKGZvdW5kUmVmcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChwcmV2aWV3TGlzdCkge1xuXHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGZvdW5kUmVmcy5tYXAocmVmID0+IHtcblx0XHRcdFx0XHRjb25zdCBzdWZmaXggPSByZWYucHJvcGVydHkgPyBgIyR7cmVmLnByb3BlcnR5fWAgOiAnJztcblx0XHRcdFx0XHRyZXR1cm4gYCR7cmVmLm5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gZG9jTmFtZXMuam9pbignLCAnKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGZpbmRGaWxlQnlOYW1lKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdFx0Ly8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG5cdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuXHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRmaWxlID0gZmlsZXMuZmluZChmID0+IFxuXHRcdFx0XHRmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuXHRcdFx0XHRmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG5cdFx0XHQpIHx8IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29udGV4dEluZGljYXRvcigpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5lbXB0eSgpO1xuXHRcdFxuXHRcdGlmICghdGhpcy5jdXJyZW50Q29udGV4dCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGFsbERvY3MgPSB0aGlzLmN1cnJlbnRDb250ZXh0LnBlcnNpc3RlbnREb2NzO1xuXHRcdFxuXHRcdGlmIChhbGxEb2NzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gU2hvdyBhcyB0aGluIGxpbmUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIHNpemluZ1xuXHRcdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBibG9jaztcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMC45ZW0nIDogJzAuOGVtJ307XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHQvLyBTaW5nbGUgbGluZSBzdW1tYXJ5IChzYW1lIHN0eWxlIGFzIGxpdmUgcHJldmlldylcblx0XHRjb25zdCBzdW1tYXJ5RWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXN1bW1hcnknIH0pO1xuXHRcdHN1bW1hcnlFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBhdXRvO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3Qgc3VtbWFyeVRleHRFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXN1bW1hcnktdGV4dCcgfSk7XG5cdFx0XG5cdFx0Y29uc3QgdG9rZW5QZXJjZW50ID0gTWF0aC5yb3VuZCgodGhpcy5jdXJyZW50Q29udGV4dC50b2tlbkNvdW50IC8gODAwMCkgKiAxMDApO1xuXHRcdGNvbnN0IGRvY05hbWVzID0gYWxsRG9jcy5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5zbGljZSgwLCBpc01vYmlsZSA/IDEgOiAyKTtcblx0XHRjb25zdCBtb3JlQ291bnQgPSBhbGxEb2NzLmxlbmd0aCA+IChpc01vYmlsZSA/IDEgOiAyKSA/IGAgKyR7YWxsRG9jcy5sZW5ndGggLSAoaXNNb2JpbGUgPyAxIDogMil9YCA6ICcnO1xuXHRcdFxuXHRcdC8vIE1vYmlsZS1vcHRpbWl6ZWQgdGV4dCAoc2hvcnRlciBvbiBtb2JpbGUpIHdpdGggcHJvcGVyIGZsZXggYWxpZ25tZW50XG5cdFx0c3VtbWFyeVRleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZmxleDogMTsgcG9pbnRlci1ldmVudHM6IG5vbmU7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cdFx0XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5VGV4dEVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJykgKyBgICR7ZG9jTmFtZXMuam9pbignLCAnKX0ke21vcmVDb3VudH0gKCR7dG9rZW5QZXJjZW50fSUpYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3VtbWFyeVRleHRFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCAke2RvY05hbWVzLmpvaW4oJywgJyl9JHttb3JlQ291bnR9ICgke3Rva2VuUGVyY2VudH0lIHRva2VucylgO1xuXHRcdH1cblx0XHRcblx0XHQvLyBNb2JpbGUtZnJpZW5kbHkgbW9yZSBtZW51IGluZGljYXRvclxuXHRcdGNvbnN0IGV4cGFuZEluZGljYXRvckVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kLWluZGljYXRvcicgfSk7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdtb3JlLWhvcml6b250YWwnLCBpc01vYmlsZSA/ICcxNnB4JyA6ICcxNHB4Jyk7IC8vIE1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Y29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCd9O1xuXHRcdFx0b3BhY2l0eTogMC44O1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHgnIDogJzRweCd9O1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0YDtcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zZXRBdHRyKCd0aXRsZScsICdUYXAgdG8gbWFuYWdlIGRvY3VtZW50cycpO1xuXHRcdFxuXHRcdC8vIFZpc3VhbCBmZWVkYmFjayBvbiB0aGUgd2hvbGUgc3VtbWFyeSBsaW5lIGluc3RlYWQgb2YganVzdCB0aGUgaW5kaWNhdG9yXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpJztcblx0XHRcdH0pO1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFkZFRyYWNrZWRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHR9LCAxNTApO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMiknO1xuXHRcdFx0fSk7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEV4cGFuZGVkIHN0YXRlIC0gbW9iaWxlLXJlc3BvbnNpdmUgb3ZlcmxheVxuXHRcdGNvbnN0IGV4cGFuZGVkRWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkJyB9KTtcblx0XHRleHBhbmRlZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRyaWdodDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgJHtpc01vYmlsZSA/ICctNHB4IDE2cHgnIDogJy0ycHggOHB4J30gcmdiYSgwLCAwLCAwLCAke2lzTW9iaWxlID8gJzAuMTUnIDogJzAuMSd9KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAycHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAke2lzTW9iaWxlID8gJzYwdmgnIDogJzIwMHB4J307XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzEwMCUnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciBmb3IgZXhwYW5kZWQgc3RhdGUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIGNsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IGV4cGFuZGVkSGVhZGVyRWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZC1oZWFkZXInIH0pO1xuXHRcdGV4cGFuZGVkSGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgaGVhZGVyVGl0bGVFbCA9IGV4cGFuZGVkSGVhZGVyRWwuY3JlYXRlU3BhbigpO1xuXHRcdGhlYWRlclRpdGxlRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgRG9jdW1lbnRzICgke2FsbERvY3MubGVuZ3RofSlgO1xuXHRcdGhlYWRlclRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCBidXR0b24gdXNpbmcgc2FtZSBpY29uIGFzIG1haW4gc2lkZWJhclxuXHRcdGNvbnN0IGNsZWFyQWxsQnRuQ29tcG9uZW50ID0gbmV3IEJ1dHRvbkNvbXBvbmVudChleHBhbmRlZEhlYWRlckVsKTtcblx0XHRjbGVhckFsbEJ0bkNvbXBvbmVudC5zZXRJY29uKCdlcmFzZXInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGFsbCBkb2N1bWVudHMgZnJvbSBjb250ZXh0Jylcblx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcblx0XHRjb25zdCBjbGVhckFsbEJ0biA9IGNsZWFyQWxsQnRuQ29tcG9uZW50LmJ1dHRvbkVsO1xuXHRcdGNsZWFyQWxsQnRuLmFkZENsYXNzKCdub3ZhLWNvbnRleHQtY2xlYXItYWxsLWJ0bicpO1xuXHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCAxMnB4JyA6ICc0cHggOHB4J307XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvdWNoLWZyaWVuZGx5IGZlZWRiYWNrIGZvciBjbGVhciBidXR0b25cblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERvY3VtZW50IGxpc3QgZm9yIGV4cGFuZGVkIHN0YXRlXG5cdFx0Y29uc3QgZG9jTGlzdEVsID0gZXhwYW5kZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWxpc3QnIH0pO1xuXHRcdFxuXHRcdGFsbERvY3MuZm9yRWFjaCgoZG9jLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgZG9jSXRlbUVsID0gZG9jTGlzdEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtaXRlbScgfSk7XG5cdFx0XHRkb2NJdGVtRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdFx0Ym9yZGVyLWJvdHRvbTogJHtpbmRleCA8IGFsbERvY3MubGVuZ3RoIC0gMSA/ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJyA6ICdub25lJ307XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcblx0XHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc1NnB4JyA6ICdhdXRvJ307XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBkb2NJbmZvRWwgPSBkb2NJdGVtRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1pbmZvJyB9KTtcblx0XHRcdGRvY0luZm9FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6ICR7aXNNb2JpbGUgPyAnMTJweCcgOiAnOHB4J307XG5cdFx0XHRcdGZsZXg6IDE7XG5cdFx0XHRcdG1pbi13aWR0aDogMDtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGljb25FbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKCk7XG5cdFx0XHRpY29uRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdmaWxlLXRleHQnKTtcblx0XHRcdGljb25FbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGZvbnQtc2l6ZTogMWVtOyc7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1uYW1lJyB9KTtcblx0XHRcdGNvbnN0IHN1ZmZpeCA9IGRvYy5wcm9wZXJ0eSA/IGAjJHtkb2MucHJvcGVydHl9YCA6ICcnO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNDAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHR0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcblx0XHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdFx0d2hpdGUtc3BhY2U6IG5vd3JhcDtcblx0XHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0XHRgO1xuXHRcdFx0bmFtZUVsLnNldEF0dHIoJ3RpdGxlJywgYCR7ZG9jLmZpbGUucGF0aH0gKHJlYWQtb25seSBmb3IgZWRpdGluZylgKTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIHJlYWQtb25seSBpbmRpY2F0b3Jcblx0XHRcdGNvbnN0IHJlYWRPbmx5RWwgPSBkb2NJbmZvRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1yZWFkb25seScgfSk7XG5cdFx0XHRyZWFkT25seUVsLnRleHRDb250ZW50ID0gJ3JlYWQtb25seSc7XG5cdFx0XHRyZWFkT25seUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0XHRwYWRkaW5nOiAxcHggNHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAzcHg7XG5cdFx0XHRcdG1hcmdpbi1sZWZ0OiA2cHg7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdGxldHRlci1zcGFjaW5nOiAwLjVweDtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdC8vIE1vYmlsZS1vcHRpbWl6ZWQgcmVtb3ZlIGJ1dHRvbiB3aXRoIGxhcmdlciB0b3VjaCB0YXJnZXRcblx0XHRcdGNvbnN0IHJlbW92ZUJ0biA9IGRvY0l0ZW1FbC5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLXJlbW92ZScgfSk7XG5cdFx0XHRyZW1vdmVCdG4uaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd4JywgaXNNb2JpbGUgPyAnMThweCcgOiAnMTRweCcpO1xuXHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdHdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0aGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE4cHgnIDogJzE0cHgnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiBib2xkO1xuXHRcdFx0YDtcblx0XHRcdHJlbW92ZUJ0bi5zZXRBdHRyKCd0aXRsZScsIGBSZW1vdmUgJHtkb2MuZmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdFxuXHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5yZW1vdmVQZXJzaXN0ZW50RG9jKHRoaXMuY3VycmVudEZpbGUucGF0aCwgZG9jLmZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gUGxhdGZvcm0tc3BlY2lmaWMgaW50ZXJhY3Rpb24gZmVlZGJhY2tcblx0XHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBUb3VjaCBmZWVkYmFjayBmb3IgZG9jdW1lbnQgaXRlbXNcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0XHR9LCAxNTApO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBDbGljayB0byBleHBhbmQgbWFuYWdlbWVudCBvdmVybGF5XG5cdFx0bGV0IGlzRXhwYW5kZWQgPSBmYWxzZTtcblx0XHRcblx0XHRjb25zdCB0b2dnbGVFeHBhbmRlZCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0aXNFeHBhbmRlZCA9ICFpc0V4cGFuZGVkO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNFeHBhbmRlZCkge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJzEwMDEnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQ2xpY2sgb24gdGhlIGVudGlyZSBzdW1tYXJ5IGxpbmUgdG8gZXhwYW5kXG5cdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRXhwYW5kZWQpO1xuXHRcdFxuXHRcdC8vIENsb3NlIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChlOiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKGlzRXhwYW5kZWQgJiYgIXRoaXMuY29udGV4dEluZGljYXRvci5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0V4cGFuZGVkID0gZmFsc2U7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm11bHRpRG9jSGFuZGxlci5idWlsZENvbnRleHQoJycsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IHJlc3VsdC5jb250ZXh0O1xuXHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVTZW5kKCkge1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZSkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2hlY2sgZm9yIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0aWYgKG1lc3NhZ2Uuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRjb25zdCBjb21tYW5kUmVzdWx0ID0gYXdhaXQgdGhpcy5oYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZSk7XG5cdFx0XHRpZiAoY29tbWFuZFJlc3VsdCkge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHRcdFx0Ly8gUmVzZXQgdGV4dGFyZWEgaGVpZ2h0IGFmdGVyIGNsZWFyaW5nXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5hdXRvR3Jvd1RleHRhcmVhKCksIDApO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkIGFuZCBwYXJzZSByZWZlcmVuY2VzXG5cdFx0bGV0IHByb2Nlc3NlZE1lc3NhZ2UgPSBtZXNzYWdlO1xuXHRcdGxldCBtdWx0aURvY0NvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcdFxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHQvLyBDaGVjayBmb3IgZWFybHkgYWNjZXNzXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdFx0aWYgKG1lc3NhZ2UuaW5jbHVkZXMoJ1tbJykgfHwgbWVzc2FnZS5pbmNsdWRlcygnK1tbJykpIHtcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2Jvb2stb3BlbicsICdNdWx0aS1kb2N1bWVudCBjb250ZXh0IGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nKSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBQYXJzZSBhbmQgYnVpbGQgY29udGV4dFxuXHRcdFx0XHRjb25zdCBjb250ZXh0UmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2UsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRwcm9jZXNzZWRNZXNzYWdlID0gY29udGV4dFJlc3VsdC5jbGVhbmVkTWVzc2FnZTtcblx0XHRcdFx0bXVsdGlEb2NDb250ZXh0ID0gY29udGV4dFJlc3VsdC5jb250ZXh0O1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbXVsdGlEb2NDb250ZXh0O1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVXBkYXRlIFVJIGluZGljYXRvclxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIG1lc3NhZ2UgaXMganVzdCBkb2N1bWVudCByZWZlcmVuY2VzIChjb250ZXh0LW9ubHkgbW9kZSlcblx0XHRcdFx0Ly8gU2luY2UgYWxsIGRvY3MgYXJlIG5vdyBwZXJzaXN0ZW50LCBjaGVjayBpZiB3ZSBoYXZlIG5ldyBkb2NzIGFuZCBlbXB0eSBtZXNzYWdlXG5cdFx0XHRcdGNvbnN0IHByZXZpb3VzUGVyc2lzdGVudENvdW50ID0gdGhpcy5jdXJyZW50Q29udGV4dD8ucGVyc2lzdGVudERvY3MubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuXHRcdFx0XHRjb25zdCBoYXNOZXdEb2NzID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCA+IHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRjb25zdCBpc0NvbnRleHRPbmx5TWVzc2FnZSA9IHByb2Nlc3NlZE1lc3NhZ2UudHJpbSgpLmxlbmd0aCA9PT0gMCAmJiBoYXNOZXdEb2NzO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGlzQ29udGV4dE9ubHlNZXNzYWdlKSB7XG5cdFx0XHRcdFx0Ly8gSGFuZGxlIGNvbnRleHQtb25seSBjb21tYW5kcyAtIHNob3cgbmV3bHkgYWRkZWQgZG9jdW1lbnRzXG5cdFx0XHRcdFx0Y29uc3QgbmV3RG9jc0NvdW50ID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCAtIHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0XHRcdGlmIChuZXdEb2NzQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0XHQvLyBHZXQgdGhlIG5ld2x5IGFkZGVkIGRvY3VtZW50cyAobGFzdCBOIGRvY3VtZW50cylcblx0XHRcdFx0XHRcdGNvbnN0IG5ld0RvY3MgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3Muc2xpY2UoLW5ld0RvY3NDb3VudCk7XG5cdFx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IG5ld0RvY3MubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKTtcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnY2hlY2stY2lyY2xlJywgYEFkZGVkICR7bmV3RG9jc0NvdW50fSBkb2N1bWVudCR7bmV3RG9jc0NvdW50ICE9PSAxID8gJ3MnIDogJyd9IHRvIHBlcnNpc3RlbnQgY29udGV4dDogJHtkb2NOYW1lc31gKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIENsZWFyIGlucHV0IGFuZCB1cGRhdGUgY29udGV4dCBpbmRpY2F0b3Jcblx0XHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBkb25lXG5cdFx0XHRcdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdFx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBTaG93IGNvbnRleHQgY29uZmlybWF0aW9uIGlmIGRvY3VtZW50cyB3ZXJlIGluY2x1ZGVkIGluIGEgcmVndWxhciBtZXNzYWdlXG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IGFsbERvY3MgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3M7XG5cdFx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBhbGxEb2NzLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0Y29uc3QgdG9rZW5JbmZvID0gbXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnQgPiAwID8gYCAofiR7bXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnR9IHRva2VucylgIDogJyc7XG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudEZpbGUgPSB0aGlzLmN1cnJlbnRGaWxlPy5iYXNlbmFtZSB8fCAnY3VycmVudCBmaWxlJztcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2Jvb2stb3BlbicsIGBJbmNsdWRlZCAke2FsbERvY3MubGVuZ3RofSBkb2N1bWVudCR7YWxsRG9jcy5sZW5ndGggIT09IDEgPyAncycgOiAnJ30gaW4gY29udGV4dDogJHtkb2NOYW1lc30ke3Rva2VuSW5mb30uIENvbnRleHQgZG9jdW1lbnRzIGFyZSByZWFkLW9ubHk7IGVkaXQgY29tbWFuZHMgd2lsbCBvbmx5IG1vZGlmeSAke2N1cnJlbnRGaWxlfS5gKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIHRva2VuIGxpbWl0XG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQuaXNOZWFyTGltaXQpIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgQXBwcm9hY2hpbmcgdG9rZW4gbGltaXQuIENvbnNpZGVyIHJlbW92aW5nIHNvbWUgZG9jdW1lbnRzIGZyb20gY29udGV4dC4nLCA1MDAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCB1c2VyIG1lc3NhZ2UgKHNob3cgb3JpZ2luYWwgd2l0aCByZWZlcmVuY2VzKVxuXHRcdHRoaXMuYWRkTWVzc2FnZSgndXNlcicsIG1lc3NhZ2UpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoJycpO1xuXHRcdC8vIFJlc2V0IHRleHRhcmVhIGhlaWdodCBhZnRlciBjbGVhcmluZ1xuXHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5hdXRvR3Jvd1RleHRhcmVhKCksIDApO1xuXHRcdFxuXHRcdC8vIEhpZGUgY29udGV4dCBwcmV2aWV3IHNpbmNlIHdlJ3JlIHNlbmRpbmcgdGhlIG1lc3NhZ2Vcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG5cblx0XHR0cnkge1xuXHRcdFx0Ly8gQWRkIGxvYWRpbmcgaW5kaWNhdG9yIHdpdGggYW5pbWF0ZWQgbm92YVxuXHRcdFx0Y29uc3QgbG9hZGluZ0VsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbG9hZGluZycgfSk7XG5cdFx0XHRsb2FkaW5nRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogMTJweCAxNnB4O1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDEycHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDhweDtcblx0XHRcdFx0bWF4LXdpZHRoOiA4MCU7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogMTBweDtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdC8vIENyZWF0ZSBhbmltYXRlZCBub3ZhIGJ1cnN0XG5cdFx0XHRjb25zdCBub3ZhQ29udGFpbmVyID0gbG9hZGluZ0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYnVyc3QtY29udGFpbmVyJyB9KTtcblx0XHRcdG5vdmFDb250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1idXJzdFwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNvcmVcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0xXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMlwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTNcIj48L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCB0ZXh0RWwgPSBsb2FkaW5nRWwuY3JlYXRlU3Bhbih7IHRleHQ6ICdOb3ZhIGlzIHRoaW5raW5nLi4uJyB9KTtcblx0XHRcdHRleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsnO1xuXG5cdFx0XHQvLyBTdG9yZSBtZXNzYWdlIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKG1lc3NhZ2UpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cblx0XHRcdGNvbnN0IGlzTGlrZWx5Q29tbWFuZCA9IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXJbJ2lzTGlrZWx5Q29tbWFuZCddKHByb2Nlc3NlZE1lc3NhZ2UpO1xuXHRcdFx0bGV0IHJlc3BvbnNlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0aWYgKGlzTGlrZWx5Q29tbWFuZCAmJiBhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdC8vIFBhcnNlIGFzIGNvbW1hbmQgYW5kIHJvdXRlIHRvIGFwcHJvcHJpYXRlIGhhbmRsZXJcblx0XHRcdFx0Y29uc3QgcGFyc2VkQ29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKHByb2Nlc3NlZE1lc3NhZ2UpO1xuXHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuZXhlY3V0ZUNvbW1hbmQocGFyc2VkQ29tbWFuZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBIYW5kbGUgYXMgY29udmVyc2F0aW9uIHVzaW5nIFByb21wdEJ1aWxkZXJcblx0XHRcdFx0Y29uc3QgcHJvbXB0ID0gYXdhaXQgdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlci5idWlsZFByb21wdEZvck1lc3NhZ2UocHJvY2Vzc2VkTWVzc2FnZSwgYWN0aXZlRmlsZSB8fCB1bmRlZmluZWQpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQWRkIG11bHRpLWRvY3VtZW50IGNvbnRleHQgaWYgYXZhaWxhYmxlXG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQgJiYgbXVsdGlEb2NDb250ZXh0LmNvbnRleHRTdHJpbmcpIHtcblx0XHRcdFx0XHQvLyBUaGUgY29udGV4dCBhbHJlYWR5IGluY2x1ZGVzIHRoZSBjdXJyZW50IGZpbGUsIHNvIHdlIGNhbiB1c2UgaXQgZGlyZWN0bHlcblx0XHRcdFx0XHRjb25zdCBlbmhhbmNlZFVzZXJQcm9tcHQgPSBgJHttdWx0aURvY0NvbnRleHQuY29udGV4dFN0cmluZ31cXG5cXG4tLS1cXG5cXG5Vc2VyIFJlcXVlc3Q6ICR7cHJvY2Vzc2VkTWVzc2FnZX1gO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEdldCBBSSByZXNwb25zZSB1c2luZyB0aGUgcHJvdmlkZXIgbWFuYWdlclxuXHRcdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCwgZW5oYW5jZWRVc2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIHByb21wdC51c2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3Jcblx0XHRcdGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RvcmUgcmVzcG9uc2UgaW4gY29udmVyc2F0aW9uIG1hbmFnZXIgKGlmIHJlc3BvbnNlIGV4aXN0cylcblx0XHRcdGlmIChhY3RpdmVGaWxlICYmIHJlc3BvbnNlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UocmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBBZGQgQUkgcmVzcG9uc2UgKG9ubHkgaWYgdGhlcmUgaXMgYSByZXNwb25zZSlcblx0XHRcdGlmIChyZXNwb25zZSkge1xuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIHJlc3BvbnNlKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yIGlmIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgbG9hZGluZ0VsID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWxvYWRpbmcnKTtcblx0XHRcdGlmIChsb2FkaW5nRWwpIGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCBgU29ycnksIEkgZW5jb3VudGVyZWQgYW4gZXJyb3I6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApO1xuXHRcdH0gZmluYWxseSB7XG5cdFx0XHR0aGlzLnNlbmRCdXR0b24uc2V0RGlzYWJsZWQoZmFsc2UpO1xuXHRcdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGluZGljYXRvciB0byBzaG93IHBlcnNpc3RlbnQgZG9jdW1lbnRzXG5cdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgaW5zZXJ0VGV4dEludG9BY3RpdmVOb3RlKHRleHQ6IHN0cmluZykge1xuXHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XG5cdFx0aWYgKGFjdGl2ZVZpZXcgJiYgJ2VkaXRvcicgaW4gYWN0aXZlVmlldykge1xuXHRcdFx0Y29uc3QgZWRpdG9yID0gKGFjdGl2ZVZpZXcgYXMgYW55KS5lZGl0b3I7XG5cdFx0XHRpZiAoZWRpdG9yKSB7XG5cdFx0XHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0ZWRpdG9yLnJlcGxhY2VSYW5nZSh0ZXh0LCBjdXJzb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgZXhlY3V0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhIGN1cnJlbnQgZmlsZSAodGhlIG9uZSB3ZSdyZSBjaGF0dGluZyBhYm91dClcblx0XHRcdGlmICghdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCAnTm8gbWFya2Rvd24gZmlsZSBpcyBvcGVuLiBQbGVhc2Ugb3BlbiBhIGZpbGUgaW4gdGhlIGVkaXRvciB0byB1c2UgZWRpdGluZyBjb21tYW5kcy4nKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gRW5zdXJlIHRoZXJlJ3MgYSBtYXJrZG93biB2aWV3IHdpdGggdGhpcyBmaWxlXG5cdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuXHRcdFx0bGV0IG1hcmtkb3duVmlldzogTWFya2Rvd25WaWV3IHwgbnVsbCA9IG51bGw7XG5cdFx0XHRcblx0XHRcdC8vIEZpbmQgdGhlIHZpZXcgd2l0aCBvdXIgZmlsZVxuXHRcdFx0Zm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0aWYgKHZpZXcuZmlsZSA9PT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdG1hcmtkb3duVmlldyA9IHZpZXc7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gSWYgbm90IGZvdW5kLCB0cnkgdG8gb3BlbiB0aGUgZmlsZVxuXHRcdFx0aWYgKCFtYXJrZG93blZpZXcpIHtcblx0XHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdFx0aWYgKGxlYWYpIHtcblx0XHRcdFx0XHRhd2FpdCBsZWFmLm9wZW5GaWxlKHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRcdG1hcmtkb3duVmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKCFtYXJrZG93blZpZXcpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYFVuYWJsZSB0byBhY2Nlc3MgdGhlIGZpbGUgXCIke3RoaXMuY3VycmVudEZpbGUuYmFzZW5hbWV9XCIuIFBsZWFzZSBtYWtlIHN1cmUgaXQncyBvcGVuIGluIHRoZSBlZGl0b3IuYCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENSSVRJQ0FMIFNFQ1VSSVRZOiBFbnN1cmUgdGhlIGFjdGl2ZSBmaWxlIG1hdGNoZXMgb3VyIGNvbnZlcnNhdGlvbiBmaWxlXG5cdFx0XHQvLyBUaGlzIHByZXZlbnRzIGFjY2lkZW50YWxseSBlZGl0aW5nIGNvbnRleHQgZG9jdW1lbnRzIHRoYXQgbWlnaHQgYmUgb3BlblxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoIWFjdGl2ZUZpbGUgfHwgYWN0aXZlRmlsZSAhPT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHQvLyBNYWtlIHRoZSBjb252ZXJzYXRpb24gZmlsZSBhY3RpdmUgYmVmb3JlIGV4ZWN1dGluZyBjb21tYW5kc1xuXHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihtYXJrZG93blZpZXcubGVhZiwgeyBmb2N1czogdHJ1ZSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIERvdWJsZS1jaGVjayB0aGF0IHRoZSBmaWxlIGlzIG5vdyBhY3RpdmVcblx0XHRcdFx0Y29uc3Qgbm93QWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdGlmICghbm93QWN0aXZlRmlsZSB8fCBub3dBY3RpdmVGaWxlICE9PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYFVuYWJsZSB0byBzZXQgXCIke3RoaXMuY3VycmVudEZpbGUuYmFzZW5hbWV9XCIgYXMgdGhlIGFjdGl2ZSBmaWxlLiBFZGl0IGNvbW1hbmRzIGNhbiBvbmx5IG1vZGlmeSB0aGUgZmlsZSB5b3UncmUgY2hhdHRpbmcgYWJvdXQgdG8gcHJldmVudCBhY2NpZGVudGFsIGNoYW5nZXMgdG8gY29udGV4dCBkb2N1bWVudHMuYCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmRlbGV0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnbWV0YWRhdGEnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gYEkgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgY29tbWFuZCBcIiR7Y29tbWFuZC5hY3Rpb259XCIuIFRyeSBhc2tpbmcgbWUgdG8gYWRkLCBlZGl0LCBkZWxldGUsIGZpeCBncmFtbWFyLCByZXdyaXRlIGNvbnRlbnQsIG9yIHVwZGF0ZSBtZXRhZGF0YS9wcm9wZXJ0aWVzLmA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHQvLyBBZGQgY29tcGFjdCBzdWNjZXNzIGluZGljYXRvciBpbnN0ZWFkIG9mIGZ1bGwgbWVzc2FnZVxuXHRcdFx0XHR0aGlzLmFkZFN1Y2Nlc3NJbmRpY2F0b3IoY29tbWFuZC5hY3Rpb24pO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gRG9uJ3QgcmV0dXJuIHRleHQgZm9yIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGBGYWlsZWQgdG8gJHtjb21tYW5kLmFjdGlvbn06ICR7cmVzdWx0LmVycm9yfWA7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBFcnJvciBleGVjdXRpbmcgY29tbWFuZDogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG5cdFx0fVxuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIElmIG5vIGFjdGl2ZSBmaWxlLCB0cnkgdG8gZmluZCB0aGUgY3VycmVudGx5IGFjdGl2ZSBsZWFmJ3MgZmlsZVxuXHRcdGxldCB0YXJnZXRGaWxlID0gYWN0aXZlRmlsZTtcblx0XHRpZiAoIXRhcmdldEZpbGUpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZjtcblx0XHRcdGlmIChhY3RpdmVMZWFmICYmIGFjdGl2ZUxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdFx0XHR0YXJnZXRGaWxlID0gYWN0aXZlTGVhZi52aWV3LmZpbGU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGYWxsIGJhY2sgdG8gYW55IG9wZW4gbWFya2Rvd24gZmlsZSBvbmx5IGlmIG5vIGFjdGl2ZSBsZWFmXG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdFx0dGFyZ2V0RmlsZSA9IHZpZXcuZmlsZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBubyBmaWxlIGF2YWlsYWJsZSBhbmQgd2UgaGF2ZSBhIGN1cnJlbnQgZmlsZSwgY2xlYXIgZXZlcnl0aGluZ1xuXHRcdGlmICghdGFyZ2V0RmlsZSAmJiB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFx0dGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgnT3BlbiBhIGRvY3VtZW50IHRvIHN0YXJ0IGNoYXR0aW5nIHdpdGggTm92YS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbm8gZmlsZSBvciBzYW1lIGZpbGUsIGRvIG5vdGhpbmdcblx0XHRpZiAoIXRhcmdldEZpbGUgfHwgdGFyZ2V0RmlsZSA9PT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmN1cnJlbnRGaWxlID0gdGFyZ2V0RmlsZTtcblx0XHRcblx0XHQvLyBDbGVhciBjdXJyZW50IGNoYXRcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBSZWZyZXNoIGNvbnRleHQgZm9yIG5ldyBmaWxlICh0aGlzIHdpbGwgc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50cyBpZiBhbnkpXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBMb2FkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGlmIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKHRhcmdldEZpbGUsIDEwKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlY2VudE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gRGlzcGxheSByZWNlbnQgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0XHRcdFx0cmVjZW50TWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuXHRcdFx0XHRcdGlmIChtc2cucm9sZSAhPT0gJ3N5c3RlbScpIHtcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZShtc2cucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JywgbXNnLmNvbnRlbnQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBmb3IgbmV3IGZpbGVcblx0XHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBjb252ZXJzYXRpb24gaGlzdG9yeTonLCBlcnJvcik7XG5cdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBvbiBlcnJvclxuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNsZWFyQ2hhdCgpIHtcblx0XHQvLyBDbGVhciB0aGUgY2hhdCBjb250YWluZXJcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBDbGVhciBjb252ZXJzYXRpb24gaW4gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbih0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0Ly8gQWxzbyBjbGVhciBtdWx0aS1kb2MgcGVyc2lzdGVudCBjb250ZXh0XG5cdFx0XHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyLmNsZWFyUGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZS5wYXRoKTtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2xlYXIgY29udmVyc2F0aW9uOicsIGVycm9yKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2hvdyBmcmVzaCB3ZWxjb21lIG1lc3NhZ2Vcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgQ2hhdCBjbGVhcmVkISBSZWFkeSB0byBoZWxwIHlvdSB3aXRoIFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiLiBXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGRvP2ApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKFwiQ2hhdCBjbGVhcmVkISBSZWFkeSB0byBoZWxwLiBXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGRvP1wiKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2hvdyBub3RpY2UgdG8gdXNlclxuXHRcdG5ldyBOb3RpY2UoJ0NoYXQgaGlzdG9yeSBjbGVhcmVkJyk7XG5cdH1cblxuXHQvLyBQdWJsaWMgbWV0aG9kcyBmb3IgdGVzdGluZ1xuXHRhc3luYyBzZW5kTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIEJ1aWxkIHByb21wdCB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0Y29uc3QgcHJvbXB0ID0gYXdhaXQgdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlci5idWlsZFByb21wdEZvck1lc3NhZ2UobWVzc2FnZSwgYWN0aXZlRmlsZSB8fCB1bmRlZmluZWQpO1xuXHRcdFxuXHRcdC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kIGZpcnN0XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKG1lc3NhZ2UpO1xuXHRcdFxuXHRcdC8vIENoZWNrIGlmIGl0J3MgYSB2YWxpZCBjb21tYW5kIGFjdGlvblxuXHRcdGNvbnN0IHZhbGlkQWN0aW9ucyA9IFsnYWRkJywgJ2VkaXQnLCAnZGVsZXRlJywgJ2dyYW1tYXInLCAncmV3cml0ZScsICdtZXRhZGF0YSddO1xuXHRcdGlmICh2YWxpZEFjdGlvbnMuaW5jbHVkZXMoY29tbWFuZC5hY3Rpb24pKSB7XG5cdFx0XHQvLyBDUklUSUNBTCBTRUNVUklUWTogVmFsaWRhdGUgdGhhdCB3ZSdyZSBlZGl0aW5nIHRoZSBjb3JyZWN0IGZpbGVcblx0XHRcdC8vIFRoaXMgcHJldmVudHMgYWNjaWRlbnRhbGx5IGVkaXRpbmcgY29udGV4dCBkb2N1bWVudHMgdGhhdCBtaWdodCBiZSBvcGVuXG5cdFx0XHQvLyBPbmx5IGFwcGx5IHRoaXMgdmFsaWRhdGlvbiB3aGVuIGJvdGggZmlsZXMgZXhpc3QgKG5vdCBpbiB0ZXN0IHNjZW5hcmlvcylcblx0XHRcdGNvbnN0IGN1cnJlbnRBY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKGFjdGl2ZUZpbGUgJiYgY3VycmVudEFjdGl2ZUZpbGUgJiYgY3VycmVudEFjdGl2ZUZpbGUgIT09IGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBTZWN1cml0eSB2aW9sYXRpb246IENvbW1hbmQgYXR0ZW1wdGVkIHRvIGVkaXQgd3JvbmcgZmlsZS4gRXhwZWN0ZWQ6ICR7YWN0aXZlRmlsZS5iYXNlbmFtZX0sIEFjdGl2ZTogJHtjdXJyZW50QWN0aXZlRmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRXhlY3V0ZSBjb21tYW5kXG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdtZXRhZGF0YSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4ubWV0YWRhdGFDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBSZWd1bGFyIGNvbnZlcnNhdGlvblxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShhY3RpdmVGaWxlLCBtZXNzYWdlLCBudWxsIGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIENhbGwgQUkgcHJvdmlkZXJcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIHByb21wdC51c2VyUHJvbXB0KTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGFjdGl2ZUZpbGUsICdBSSByZXNwb25zZScsIHsgc3VjY2VzczogdHJ1ZSwgZWRpdFR5cGU6ICdub25lJyB9IGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkoZmlsZTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHQvLyBJbiByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGRpc3BsYXkgbWVzc2FnZXMgaW4gdGhlIFVJXG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHN0YXRpYyBwcm92aWRlciBzdGF0dXMgZGlzcGxheVxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVTdGF0aWNQcm92aWRlclN0YXR1cyhjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgcHJvdmlkZXJTdGF0dXMgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXItcHJvdmlkZXInIH0pO1xuXHRcdHByb3ZpZGVyU3RhdHVzLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRvcGFjaXR5OiAwLjg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJTdGF0dXNEb3QgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtZG90LXNtYWxsJyB9KTtcblx0XHRoZWFkZXJTdGF0dXNEb3Quc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiA2cHg7XG5cdFx0XHRoZWlnaHQ6IDZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGJhY2tncm91bmQ6ICM0Y2FmNTA7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJQcm92aWRlck5hbWUgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nIH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBuYW1lIGFzeW5jaHJvbm91c2x5XG5cdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpLnRoZW4obmFtZSA9PiB7XG5cdFx0XHRoZWFkZXJQcm92aWRlck5hbWUuc2V0VGV4dChuYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlckRyb3Bkb3duKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWNvbnRhaW5lcicgfSk7XG5cdFx0ZHJvcGRvd25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHByb3ZpZGVyIGJ1dHRvblxuXHRcdGNvbnN0IHByb3ZpZGVyQnV0dG9uID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1wcm92aWRlci1idXR0b24nIH0pO1xuXHRcdHByb3ZpZGVyQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogNHB4IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gU3RhdHVzIGRvdFxuXHRcdGNvbnN0IHN0YXR1c0RvdCA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXN0YXR1cy1kb3Qtc21hbGwnIH0pO1xuXHRcdHN0YXR1c0RvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0d2lkdGg6IDZweDtcblx0XHRcdGhlaWdodDogNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0YmFja2dyb3VuZDogIzRjYWY1MDtcblx0XHRgO1xuXG5cdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTG9hZGluZy4uLicgfSk7XG5cblx0XHQvLyBEcm9wZG93biBhcnJvd1xuXHRcdGNvbnN0IGRyb3Bkb3duQXJyb3cgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCQycgfSk7XG5cdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdG1hcmdpbi1sZWZ0OiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBEcm9wZG93biBtZW51IChpbml0aWFsbHkgaGlkZGVuKVxuXHRcdGNvbnN0IGRyb3Bkb3duTWVudSA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudScgfSk7XG5cdFx0ZHJvcGRvd25NZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdG1pbi13aWR0aDogMTUwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdGA7XG5cblx0XHRsZXQgaXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblxuXHRcdC8vIFVwZGF0ZSBjdXJyZW50IHByb3ZpZGVyIGRpc3BsYXlcblx0XHRjb25zdCB1cGRhdGVDdXJyZW50UHJvdmlkZXIgPSBhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXHRcdFx0cHJvdmlkZXJOYW1lLnNldFRleHQoY3VycmVudFByb3ZpZGVyTmFtZSk7XG5cdFx0fTtcblxuXHRcdC8vIFRvZ2dsZSBkcm9wZG93blxuXHRcdGNvbnN0IHRvZ2dsZURyb3Bkb3duID0gKCkgPT4ge1xuXHRcdFx0aXNEcm9wZG93bk9wZW4gPSAhaXNEcm9wZG93bk9wZW47XG5cdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9IGlzRHJvcGRvd25PcGVuID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gaXNEcm9wZG93bk9wZW4gPyAncm90YXRlKDE4MGRlZyknIDogJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHRcblx0XHRcdGlmIChpc0Ryb3Bkb3duT3Blbikge1xuXHRcdFx0XHR0aGlzLnBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBDbG9zZSBkcm9wZG93biB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjbG9zZURyb3Bkb3duOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCFkcm9wZG93bkNvbnRhaW5lci5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0aXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblx0XHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHByb3ZpZGVyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR0b2dnbGVEcm9wZG93bigpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQWRkIGdsb2JhbCBjbGljayBsaXN0ZW5lclxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlRHJvcGRvd24pO1xuXG5cdFx0Ly8gVXBkYXRlIHByb3ZpZGVyIG5hbWUgaW5pdGlhbGx5XG5cdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIGNsZWFudXBcblx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duID0ge1xuXHRcdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyLFxuXHRcdFx0Y2xlYW51cDogKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZURyb3Bkb3duKVxuXHRcdH07XG5cdH1cblxuXHQvKipcblx0ICogUG9wdWxhdGUgcHJvdmlkZXIgZHJvcGRvd24gd2l0aCBhdmFpbGFibGUgcHJvdmlkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnU6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cblx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBhbGxvd2VkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBwcm92aWRlckl0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1pdGVtJyB9KTtcblx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgaWNvbi9kb3Rcblx0XHRcdGNvbnN0IHByb3ZpZGVyRG90ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdHByb3ZpZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHdpZHRoOiA4cHg7XG5cdFx0XHRcdGhlaWdodDogOHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGJhY2tncm91bmQ6ICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdFx0Y29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IG5hbWVTcGFuID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiBkaXNwbGF5TmFtZSB9KTtcblxuXHRcdFx0Ly8gTWFyayBjdXJyZW50IHByb3ZpZGVyXG5cdFx0XHRjb25zdCBpc0N1cnJlbnQgPSBkaXNwbGF5TmFtZSA9PT0gY3VycmVudFByb3ZpZGVyTmFtZTtcblx0XHRcdGlmIChpc0N1cnJlbnQpIHtcblx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHRuYW1lU3Bhbi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDbGljayBoYW5kbGVyXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdFx0Ly8gQ2xvc2UgZHJvcGRvd25cblx0XHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIb3ZlciBlZmZlY3Rcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdDbGF1ZGUgKEFudGhyb3BpYyknLFxuXHRcdFx0J29wZW5haSc6ICdHUFQtNCAoT3BlbkFJKScsXG5cdFx0XHQnZ29vZ2xlJzogJ0dlbWluaSAoR29vZ2xlKScsXG5cdFx0XHQnb2xsYW1hJzogJ09sbGFtYSAoTG9jYWwpJyxcblx0XHRcdCdub25lJzogJ05vbmUnXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJUeXBlXSB8fCBwcm92aWRlclR5cGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGNvbG9yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnI0QyNjkxRScsXG5cdFx0XHQnb3BlbmFpJzogJyMxMEEzN0YnLFxuXHRcdFx0J2dvb2dsZSc6ICcjNDI4NUY0Jyxcblx0XHRcdCdvbGxhbWEnOiAnIzdDM0FFRCcsXG5cdFx0XHQnbm9uZSc6ICcjOTk5J1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICcjNGNhZjUwJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgcHJvdmlkZXIgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBhIHN5c3RlbSBtZXNzYWdlIGFib3V0IHByb3ZpZGVyIHN3aXRjaGluZ1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKTtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgc3dpdGNoTWVzc2FnZSk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0aGUgcGxhdGZvcm0gc2V0dGluZ3MgdG8gdXNlIHRoZSBuZXcgcHJvdmlkZXJcblx0XHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVyVHlwZSBhcyBhbnk7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmUtaW5pdGlhbGl6ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN3aXRjaGluZyBwcm92aWRlcjonLCBlcnJvcik7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEZhaWxlZCB0byBzd2l0Y2ggdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoZSBjb21tYW5kIGJ1dHRvbiBzaG91bGQgYmUgc2hvd24gYmFzZWQgb24gZmVhdHVyZSBhdmFpbGFiaWxpdHkgYW5kIHVzZXIgcHJlZmVyZW5jZVxuXHQgKi9cblx0cHJpdmF0ZSBzaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpOiBib29sZWFuIHtcblx0XHQvLyBDb21tYW5kIGJ1dHRvbiBpcyBnYXRlZCBiZWhpbmQgdGhlIGNvbW1hbmQtYnV0dG9uIGZlYXR1cmUgKFN1cGVybm92YS1vbmx5KVxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1idXR0b24nKSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b247XG5cdH1cblxuXHQvKipcblx0ICogUmVmcmVzaCBhbGwgU3VwZXJub3ZhLWdhdGVkIFVJIGVsZW1lbnRzIHdoZW4gbGljZW5zZSBzdGF0dXMgY2hhbmdlc1xuXHQgKi9cblx0cmVmcmVzaFN1cGVybm92YVVJKCk6IHZvaWQge1xuXHRcdHRoaXMucmVmcmVzaENvbW1hbmRCdXR0b24oKTtcblx0XHQvLyBGdXR1cmUgU3VwZXJub3ZhIGZlYXR1cmVzIGNhbiBhZGQgdGhlaXIgcmVmcmVzaCBsb2dpYyBoZXJlXG5cdH1cblxuXHQvKipcblx0ICogUmVmcmVzaCB0aGUgY29tbWFuZCBidXR0b24gdmlzaWJpbGl0eSB3aGVuIHNldHRpbmdzIGNoYW5nZVxuXHQgKi9cblx0cmVmcmVzaENvbW1hbmRCdXR0b24oKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmlucHV0Q29udGFpbmVyKSByZXR1cm47XG5cdFx0XG5cdFx0Ly8gU2F2ZSBjdXJyZW50IHRleHRhcmVhIHN0YXRlXG5cdFx0Y29uc3QgY3VycmVudFRleHQgPSB0aGlzLnRleHRBcmVhPy5nZXRWYWx1ZSgpIHx8ICcnO1xuXHRcdGNvbnN0IGN1cnNvclN0YXJ0ID0gdGhpcy50ZXh0QXJlYT8uaW5wdXRFbD8uc2VsZWN0aW9uU3RhcnQgfHwgMDtcblx0XHRjb25zdCBjdXJzb3JFbmQgPSB0aGlzLnRleHRBcmVhPy5pbnB1dEVsPy5zZWxlY3Rpb25FbmQgfHwgMDtcblx0XHRjb25zdCBoYWRGb2N1cyA9IHRoaXMudGV4dEFyZWE/LmlucHV0RWwgPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cdFx0XG5cdFx0Ly8gUmVidWlsZCB0aGUgaW5wdXQgYXJlYVxuXHRcdHRoaXMuY3JlYXRlSW5wdXRBcmVhKCk7XG5cdFx0XG5cdFx0Ly8gUmVzdG9yZSB0ZXh0YXJlYSBzdGF0ZVxuXHRcdGlmICh0aGlzLnRleHRBcmVhICYmIGN1cnJlbnRUZXh0KSB7XG5cdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGN1cnJlbnRUZXh0KTtcblx0XHRcdC8vIFJlc3RvcmUgY3Vyc29yIHBvc2l0aW9uXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMudGV4dEFyZWE/LmlucHV0RWwpIHtcblx0XHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yU3RhcnQsIGN1cnNvckVuZCk7XG5cdFx0XHRcdFx0aWYgKGhhZEZvY3VzKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sIDApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgaW5wdXQgcm93IGxheW91dCB3aGVuIGNvbW1hbmQgYnV0dG9uIHZpc2liaWxpdHkgY2hhbmdlc1xuXHQgKi9cblx0cHJpdmF0ZSB1cGRhdGVJbnB1dFJvd0xheW91dCgpOiB2b2lkIHtcblx0XHQvLyBObyBuZWVkIHRvIG1hbnVhbGx5IGFkanVzdCB0ZXh0YXJlYSB3aWR0aCAtIGZsZXhib3ggaGFuZGxlcyBpdFxuXHRcdC8vIFRoZSB0ZXh0YXJlYSBjb250YWluZXIgaGFzIGZsZXg6IDEsIHNvIGl0IHdpbGwgZXhwYW5kL2NvbnRyYWN0IGF1dG9tYXRpY2FsbHlcblx0XHQvLyB3aGVuIHRoZSBjb21tYW5kIGJ1dHRvbiBpcyBzaG93bi9oaWRkZW5cblx0fVxuXG59IiwgIi8qKlxuICogQ3VzdG9tIHdpa2lsaW5rIGF1dG9jb21wbGV0ZSBmb3IgTm92YSB0ZXh0YXJlYVxuICogUHJvdmlkZXMgW1tkb2N1bWVudF1dIHN1Z2dlc3Rpb25zIHdoZW4gdHlwaW5nIGluIE5vdmEncyB0ZXh0YXJlYVxuICovXG5cbmltcG9ydCB7IFRGaWxlLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2lraWxpbmtTdWdnZXN0aW9uIHtcbiAgICBmaWxlOiBURmlsZTtcbiAgICBkaXNwbGF5VGV4dDogc3RyaW5nO1xuICAgIHNjb3JlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUge1xuICAgIHByaXZhdGUgYXBwOiBBcHA7XG4gICAgcHJpdmF0ZSB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25Qb3B1cDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25zOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSA9IFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRJbmRleDogbnVtYmVyID0gLTE7XG4gICAgcHJpdmF0ZSBpc1Zpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGN1cnJlbnRRdWVyeTogc3RyaW5nID0gJyc7XG4gICAgcHJpdmF0ZSBjdXJyZW50VHJpZ2dlclBvczogbnVtYmVyID0gLTE7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMudGV4dEFyZWEgPSB0ZXh0QXJlYTtcbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5oYW5kbGVJbnB1dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlkb3duLmJpbmQodGhpcykpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xvc2Ugb24gZm9jdXMgbG9zc1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBEZWxheSB0byBhbGxvdyBzZWxlY3Rpb24gY2xpY2tzXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCksIDE1MCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIGNsaWNrIG91dHNpZGVcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwICYmICF0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSAmJiBlLnRhcmdldCAhPT0gdGhpcy50ZXh0QXJlYSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlSW5wdXQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHRBcmVhLnZhbHVlO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICBcbiAgICAgICAgLy8gTG9vayBmb3IgW1sgcGF0dGVybiBiZWZvcmUgY3Vyc29yXG4gICAgICAgIGNvbnN0IGJlZm9yZUN1cnNvciA9IHRleHQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmtNYXRjaCA9IGJlZm9yZUN1cnNvci5tYXRjaCgvKFxcKyk/XFxbXFxbKFteXFxdXSo/KSQvKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5rTWF0Y2gpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFF1ZXJ5ID0gbGlua01hdGNoWzJdIHx8ICcnO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VHJpZ2dlclBvcyA9IGN1cnNvclBvcyAtIGxpbmtNYXRjaFswXS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLnNob3dTdWdnZXN0aW9ucygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlS2V5ZG93bihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWluKHRoaXMuc2VsZWN0ZWRJbmRleCArIDEsIHRoaXMuc3VnZ2VzdGlvbnMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBNYXRoLm1heCh0aGlzLnNlbGVjdGVkSW5kZXggLSAxLCAtMSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ0VudGVyJzpcbiAgICAgICAgICAgIGNhc2UgJ1RhYic6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKHRoaXMuc3VnZ2VzdGlvbnNbdGhpcy5zZWxlY3RlZEluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnRXNjYXBlJzpcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1N1Z2dlc3Rpb25zKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zID0gdGhpcy5nZXRTdWdnZXN0aW9ucyh0aGlzLmN1cnJlbnRRdWVyeSk7XG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlU3VnZ2VzdGlvblBvcHVwKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgdGhpcy5wb3NpdGlvblBvcHVwKCk7XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoaWRlU3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVN1Z2dlc3Rpb25Qb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuY2xhc3NOYW1lID0gJ25vdmEtd2lraWxpbmstc3VnZ2VzdGlvbnMnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICAgICAgICAgIG1heC1oZWlnaHQ6IDIwMHB4O1xuICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgICAgICAgIHotaW5kZXg6IDEwMDA7XG4gICAgICAgICAgICBkaXNwbGF5OiBub25lO1xuICAgICAgICAgICAgbWluLXdpZHRoOiAyMDBweDtcbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIC8vIEluc2VydCBhZnRlciB0aGUgdGV4dGFyZWFcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5wYXJlbnRFbGVtZW50Py5hcHBlbmRDaGlsZCh0aGlzLnN1Z2dlc3Rpb25Qb3B1cCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuZW1wdHkoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMuZm9yRWFjaCgoc3VnZ2VzdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnN1Z2dlc3Rpb25Qb3B1cCEuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdWdnZXN0aW9uLWl0ZW0nIH0pO1xuICAgICAgICAgICAgaXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxMnB4O1xuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcbiAgICAgICAgICAgIGA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEZpbGUgbmFtZVxuICAgICAgICAgICAgY29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Z2dlc3Rpb24tbmFtZScgfSk7XG4gICAgICAgICAgICBuYW1lRWwudGV4dENvbnRlbnQgPSBzdWdnZXN0aW9uLmZpbGUuYmFzZW5hbWU7XG4gICAgICAgICAgICBuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMnB4O1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmlsZSBwYXRoIChpZiBkaWZmZXJlbnQgZnJvbSBuYW1lKVxuICAgICAgICAgICAgaWYgKHN1Z2dlc3Rpb24uZmlsZS5wYXRoICE9PSBzdWdnZXN0aW9uLmZpbGUubmFtZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdWdnZXN0aW9uLXBhdGgnIH0pO1xuICAgICAgICAgICAgICAgIHBhdGhFbC50ZXh0Q29udGVudCA9IHN1Z2dlc3Rpb24uZmlsZS5wYXRoO1xuICAgICAgICAgICAgICAgIHBhdGhFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuODVlbTtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVTZWxlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5zdWdnZXN0aW9uUG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLm5vdmEtc3VnZ2VzdGlvbi1pdGVtJyk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gaXRlbSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHBvc2l0aW9uUG9wdXAoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIC8vIFBvc2l0aW9uIGFib3ZlIHRoZSB0ZXh0YXJlYVxuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy50ZXh0QXJlYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgcG9wdXBIZWlnaHQgPSBNYXRoLm1pbigyMDAsIHRoaXMuc3VnZ2VzdGlvbnMubGVuZ3RoICogNTApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5sZWZ0ID0gJzAnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5ib3R0b20gPSAnMTAwJSc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc0cHgnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS53aWR0aCA9IGAke3JlY3Qud2lkdGh9cHhgO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBXaWtpbGlua1N1Z2dlc3Rpb24pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dEFyZWEudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kIHRoZSBbWyBwYXR0ZXJuIHRvIHJlcGxhY2VcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC8oXFwrKT9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFsaW5rTWF0Y2gpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGlzUGVyc2lzdGVudCA9ICEhbGlua01hdGNoWzFdO1xuICAgICAgICBjb25zdCBzdGFydFBvcyA9IGN1cnNvclBvcyAtIGxpbmtNYXRjaFswXS5sZW5ndGg7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGhlIHJlcGxhY2VtZW50IHRleHRcbiAgICAgICAgY29uc3QgbGlua1RleHQgPSBgW1ske3N1Z2dlc3Rpb24uZmlsZS5iYXNlbmFtZX1dXWA7XG4gICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gaXNQZXJzaXN0ZW50ID8gYCske2xpbmtUZXh0fWAgOiBsaW5rVGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIHRleHRcbiAgICAgICAgY29uc3QgbmV3VGV4dCA9IHRleHQuc3Vic3RyaW5nKDAsIHN0YXJ0UG9zKSArIHJlcGxhY2VtZW50ICsgdGV4dC5zdWJzdHJpbmcoY3Vyc29yUG9zKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS52YWx1ZSA9IG5ld1RleHQ7XG4gICAgICAgIFxuICAgICAgICAvLyBQb3NpdGlvbiBjdXJzb3IgYWZ0ZXIgdGhlIGxpbmtcbiAgICAgICAgY29uc3QgbmV3Q3Vyc29yUG9zID0gc3RhcnRQb3MgKyByZXBsYWNlbWVudC5sZW5ndGg7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UobmV3Q3Vyc29yUG9zLCBuZXdDdXJzb3JQb3MpO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJpZ2dlciBpbnB1dCBldmVudCB0byB1cGRhdGUgYW55IGF1dG8tZ3JvdyBmdW5jdGlvbmFsaXR5XG4gICAgICAgIHRoaXMudGV4dEFyZWEuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSB7XG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogV2lraWxpbmtTdWdnZXN0aW9uW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgY29uc3Qgc2NvcmUgPSB0aGlzLnNjb3JlRmlsZShmaWxlLCBxdWVyeSk7XG4gICAgICAgICAgICBpZiAoc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUZXh0OiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgICAgICBzY29yZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTb3J0IGJ5IHNjb3JlIChoaWdoZXN0IGZpcnN0KSBhbmQgbGltaXQgcmVzdWx0c1xuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSlcbiAgICAgICAgICAgIC5zbGljZSgwLCA4KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNjb3JlRmlsZShmaWxlOiBURmlsZSwgcXVlcnk6IHN0cmluZyk6IG51bWJlciB7XG4gICAgICAgIGlmICghcXVlcnkpIHJldHVybiA1MDsgLy8gU2hvdyBhbGwgZmlsZXMgd2hlbiBubyBxdWVyeVxuICAgICAgICBcbiAgICAgICAgY29uc3QgYmFzZW5hbWUgPSBmaWxlLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IHBhdGggPSBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgcXVlcnlMb3dlciA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFeGFjdCBtYXRjaFxuICAgICAgICBpZiAoYmFzZW5hbWUgPT09IHF1ZXJ5TG93ZXIpIHJldHVybiAxMDA7XG4gICAgICAgIFxuICAgICAgICAvLyBTdGFydHMgd2l0aCBxdWVyeVxuICAgICAgICBpZiAoYmFzZW5hbWUuc3RhcnRzV2l0aChxdWVyeUxvd2VyKSkgcmV0dXJuIDgwO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udGFpbnMgcXVlcnlcbiAgICAgICAgaWYgKGJhc2VuYW1lLmluY2x1ZGVzKHF1ZXJ5TG93ZXIpKSByZXR1cm4gNjA7XG4gICAgICAgIFxuICAgICAgICAvLyBQYXRoIGNvbnRhaW5zIHF1ZXJ5XG4gICAgICAgIGlmIChwYXRoLmluY2x1ZGVzKHF1ZXJ5TG93ZXIpKSByZXR1cm4gNDA7XG4gICAgICAgIFxuICAgICAgICAvLyBGdXp6eSBtYXRjaFxuICAgICAgICBpZiAodGhpcy5mdXp6eU1hdGNoKGJhc2VuYW1lLCBxdWVyeUxvd2VyKSkgcmV0dXJuIDIwO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmdXp6eU1hdGNoKHRleHQ6IHN0cmluZywgcXVlcnk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgdGV4dEluZGV4ID0gMDtcbiAgICAgICAgbGV0IHF1ZXJ5SW5kZXggPSAwO1xuICAgICAgICBcbiAgICAgICAgd2hpbGUgKHRleHRJbmRleCA8IHRleHQubGVuZ3RoICYmIHF1ZXJ5SW5kZXggPCBxdWVyeS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICh0ZXh0W3RleHRJbmRleF0gPT09IHF1ZXJ5W3F1ZXJ5SW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlJbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGV4dEluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBxdWVyeUluZGV4ID09PSBxdWVyeS5sZW5ndGg7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBNdWx0aS1kb2N1bWVudCBjb250ZXh0IGhhbmRsZXIgZm9yIE5vdmFcbiAqIFBhcnNlcyBbW2RvY11dIGFuZCArW1tkb2NdXSBzeW50YXggZm9yIGFkZGl0aW9uYWwgY29udGV4dFxuICovXG5cbmltcG9ydCB7IEFwcCwgVEZpbGUsIENhY2hlZE1ldGFkYXRhIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvY3VtZW50UmVmZXJlbmNlIHtcbiAgICAvKiogVGhlIGZpbGUgYmVpbmcgcmVmZXJlbmNlZCAqL1xuICAgIGZpbGU6IFRGaWxlO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHRoaXMgaXMgcGVyc2lzdGVudCBjb250ZXh0ICgrW1tkb2NdXSkgKi9cbiAgICBpc1BlcnNpc3RlbnQ6IGJvb2xlYW47XG4gICAgXG4gICAgLyoqIFRoZSByYXcgcmVmZXJlbmNlIHRleHQgKGUuZy4sIFwiW1tNeSBEb2N1bWVudF1dXCIpICovXG4gICAgcmF3UmVmZXJlbmNlOiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFNwZWNpZmljIHByb3BlcnR5IHRvIGV4dHJhY3QgKGUuZy4sIFwiW1tkb2MjcHJvcGVydHldXVwiKSAqL1xuICAgIHByb3BlcnR5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpRG9jQ29udGV4dCB7XG4gICAgLyoqIERvY3VtZW50cyBpbiBwZXJzaXN0ZW50IGNvbnRleHQgKi9cbiAgICBwZXJzaXN0ZW50RG9jczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICBcbiAgICAvKiogQ29tYmluZWQgY29udGV4dCBzdHJpbmcgKi9cbiAgICBjb250ZXh0U3RyaW5nOiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEVzdGltYXRlZCB0b2tlbiBjb3VudCAqL1xuICAgIHRva2VuQ291bnQ6IG51bWJlcjtcbiAgICBcbiAgICAvKiogV2hldGhlciB3ZSdyZSBhcHByb2FjaGluZyB0b2tlbiBsaW1pdCAqL1xuICAgIGlzTmVhckxpbWl0OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgTXVsdGlEb2NDb250ZXh0SGFuZGxlciB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHBlcnNpc3RlbnRDb250ZXh0OiBNYXA8c3RyaW5nLCBEb2N1bWVudFJlZmVyZW5jZVtdPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IFRPS0VOX0xJTUlUID0gODAwMDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IFdBUk5JTkdfVEhSRVNIT0xEID0gMC44O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBtZXNzYWdlIGZvciBkb2N1bWVudCByZWZlcmVuY2VzXG4gICAgICovXG4gICAgcGFyc2VNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgY29udmVyc2F0aW9uRmlsZVBhdGg6IHN0cmluZyk6IHtcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgcmVmZXJlbmNlczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICB9IHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlczogRG9jdW1lbnRSZWZlcmVuY2VbXSA9IFtdO1xuICAgICAgICBsZXQgY2xlYW5lZE1lc3NhZ2UgPSBtZXNzYWdlO1xuXG4gICAgICAgIC8vIFBhdHRlcm4gdG8gbWF0Y2ggW1tkb2NdXSBhbmQgK1tbZG9jXV0gd2l0aCBvcHRpb25hbCBwcm9wZXJ0eVxuICAgICAgICAvLyBOb3RlOiBBbGwgZG9jdW1lbnQgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQgZm9yIHNpbXBsaWZpZWQgVVhcbiAgICAgICAgY29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcbiAgICAgICAgICAgIGNvbnN0IHJhd1JlZmVyZW5jZSA9IG1hdGNoWzBdO1xuXG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCB0aGUgZmlsZVxuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZmluZEZpbGUoZG9jTmFtZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgaXNQZXJzaXN0ZW50OiB0cnVlLCAvLyBBbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnRcbiAgICAgICAgICAgICAgICAgICAgcmF3UmVmZXJlbmNlLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBmb3VuZCByZWZlcmVuY2VzIGZyb20gbWVzc2FnZVxuICAgICAgICBmb3IgKGNvbnN0IHJlZiBvZiByZWZlcmVuY2VzKSB7XG4gICAgICAgICAgICBjbGVhbmVkTWVzc2FnZSA9IGNsZWFuZWRNZXNzYWdlLnJlcGxhY2UocmVmLnJhd1JlZmVyZW5jZSwgJyAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENsZWFuIHVwIGV4Y2Vzc2l2ZSBzcGFjZXMgYnV0IHByZXNlcnZlIG5lY2Vzc2FyeSBzcGFjaW5nXG4gICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZSgvXFxzezIsfS9nLCAnICcpLnRyaW0oKTtcblxuICAgICAgICAvLyBVcGRhdGUgcGVyc2lzdGVudCBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBjb25zdCBwZXJzaXN0ZW50UmVmcyA9IHJlZmVyZW5jZXMuZmlsdGVyKHJlZiA9PiByZWYuaXNQZXJzaXN0ZW50KTtcbiAgICAgICAgaWYgKHBlcnNpc3RlbnRSZWZzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY29udmVyc2F0aW9uRmlsZVBhdGgpIHx8IFtdO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFBlcnNpc3RlbnQgPSBbLi4uZXhpc3RpbmddO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdGhhdCBhcmVuJ3QgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHBlcnNpc3RlbnRSZWZzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShleGlzdGluZyA9PiBleGlzdGluZy5maWxlLnBhdGggPT09IHJlZi5maWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGNvbnZlcnNhdGlvbkZpbGVQYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGNvbXBsZXRlIGNvbnRleHQgaW5jbHVkaW5nIHBlcnNpc3RlbnQgZG9jdW1lbnRzXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb250ZXh0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGN1cnJlbnRGaWxlOiBURmlsZSxcbiAgICAgICAgY29udmVyc2F0aW9uRGF0YT86IENvbnZlcnNhdGlvbkRhdGFcbiAgICApOiBQcm9taXNlPHtcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgY29udGV4dDogTXVsdGlEb2NDb250ZXh0O1xuICAgIH0+IHtcbiAgICAgICAgLy8gUGFyc2UgY3VycmVudCBtZXNzYWdlXG4gICAgICAgIGNvbnN0IHsgY2xlYW5lZE1lc3NhZ2UsIHJlZmVyZW5jZXMgfSA9IHRoaXMucGFyc2VNZXNzYWdlKG1lc3NhZ2UsIGN1cnJlbnRGaWxlLnBhdGgpO1xuXG4gICAgICAgIC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIHRoaXMgY29udmVyc2F0aW9uXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nUGVyc2lzdGVudCA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIG5ldyByZWZlcmVuY2VzIHRvIHBlcnNpc3RlbnQgY29udGV4dCAoYWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50KVxuICAgICAgICBpZiAocmVmZXJlbmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ1BlcnNpc3RlbnRdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdGhhdCBhcmVuJ3QgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgdXBkYXRlZFBlcnNpc3RlbnQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZmluYWwgcGVyc2lzdGVudCBjb250ZXh0IChpbmNsdWRpbmcgbmV3bHkgYWRkZWQgZG9jcylcbiAgICAgICAgY29uc3QgcmF3UGVyc2lzdGVudERvY3MgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbHRlciBvdXQgYW55IHN0YWxlIGZpbGUgcmVmZXJlbmNlcyAoZmlsZXMgdGhhdCBubyBsb25nZXIgZXhpc3QpXG4gICAgICAgIGNvbnN0IGFsbFBlcnNpc3RlbnREb2NzID0gcmF3UGVyc2lzdGVudERvY3MuZmlsdGVyKGRvY1JlZiA9PiB7XG4gICAgICAgICAgICBpZiAoIWRvY1JlZj8uZmlsZSB8fCAhdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRvY1JlZi5maWxlLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSZW1vdmluZyBzdGFsZSBmaWxlIHJlZmVyZW5jZTogJHtkb2NSZWY/LmZpbGU/LnBhdGggfHwgJ3Vua25vd24nfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgcGVyc2lzdGVudCBjb250ZXh0IHRvIHJlbW92ZSBzdGFsZSByZWZlcmVuY2VzXG4gICAgICAgIGlmIChhbGxQZXJzaXN0ZW50RG9jcy5sZW5ndGggIT09IHJhd1BlcnNpc3RlbnREb2NzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGFsbFBlcnNpc3RlbnREb2NzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjdXJyZW50RmlsZS5wYXRoLCBhbGxQZXJzaXN0ZW50RG9jcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGN1cnJlbnRGaWxlLnBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBzdHJpbmcgZnJvbSBhbGwgZG9jdW1lbnRzXG4gICAgICAgIGNvbnN0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFMV0FZUyBpbmNsdWRlIGN1cnJlbnQgZmlsZSBjb250ZW50IGFuZCBtZXRhZGF0YSBmaXJzdCAoaW1wbGljaXQgY29udGV4dClcbiAgICAgICAgY29uc3QgY3VycmVudEZpbGVDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXRGdWxsRG9jdW1lbnRDb250ZXh0KGN1cnJlbnRGaWxlLCB0cnVlLCAxMDApO1xuICAgICAgICBpZiAoY3VycmVudEZpbGVDb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChjdXJyZW50RmlsZUNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUaGVuIGFkZCBhbGwgcGVyc2lzdGVudCBkb2N1bWVudHMgd2l0aCB0aGVpciBtZXRhZGF0YVxuICAgICAgICBmb3IgKGNvbnN0IGRvY1JlZiBvZiBhbGxQZXJzaXN0ZW50RG9jcykge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dFBhcnQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChkb2NSZWYpO1xuICAgICAgICAgICAgaWYgKGNvbnRleHRQYXJ0KSB7XG4gICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goY29udGV4dFBhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dFN0cmluZyA9IGNvbnRleHRQYXJ0cy5qb2luKCdcXG5cXG4tLS1cXG5cXG4nKTtcbiAgICAgICAgY29uc3QgdG9rZW5Db3VudCA9IHRoaXMuZXN0aW1hdGVUb2tlbnMoY29udGV4dFN0cmluZyk7XG4gICAgICAgIGNvbnN0IGlzTmVhckxpbWl0ID0gdG9rZW5Db3VudCA+ICh0aGlzLlRPS0VOX0xJTUlUICogdGhpcy5XQVJOSU5HX1RIUkVTSE9MRCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNsZWFuZWRNZXNzYWdlLFxuICAgICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgICAgIHBlcnNpc3RlbnREb2NzOiBhbGxQZXJzaXN0ZW50RG9jcyxcbiAgICAgICAgICAgICAgICBjb250ZXh0U3RyaW5nLFxuICAgICAgICAgICAgICAgIHRva2VuQ291bnQsXG4gICAgICAgICAgICAgICAgaXNOZWFyTGltaXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZnVsbCBkb2N1bWVudCBjb250ZXh0IGluY2x1ZGluZyBtZXRhZGF0YS9wcm9wZXJ0aWVzXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRGdWxsRG9jdW1lbnRDb250ZXh0KGZpbGU6IFRGaWxlLCBpbmNsdWRlQ29udGVudDogYm9vbGVhbiA9IHRydWUsIG1heExpbmVzOiBudW1iZXIgPSA1MCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGRvY3VtZW50IGhlYWRlclxuICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goYCMjIERvY3VtZW50OiAke2ZpbGUuYmFzZW5hbWV9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBhbmQgYWRkIG1ldGFkYXRhL3Byb3BlcnRpZXMgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBPYmplY3Qua2V5cyhjYWNoZS5mcm9udG1hdHRlcikubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKCdcXG4jIyMgUHJvcGVydGllcy9NZXRhZGF0YTonKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjYWNoZS5mcm9udG1hdHRlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9ybWF0IHRoZSBwcm9wZXJ0eSB2YWx1ZSAoaGFuZGxlIGFycmF5cywgb2JqZWN0cywgZXRjLilcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGAtICR7a2V5fTogJHtmb3JtYXR0ZWRWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBjb250ZW50IGlmIHJlcXVlc3RlZFxuICAgICAgICAgICAgaWYgKGluY2x1ZGVDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFNraXAgZnJvbnRtYXR0ZXIgaW4gY29udGVudCBkaXNwbGF5IChiZXR3ZWVuIC0tLSBtYXJrZXJzKVxuICAgICAgICAgICAgICAgICAgICBsZXQgY29udGVudFN0YXJ0SW5kZXggPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGluZXNbMF0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVzW2ldID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RhcnRJbmRleCA9IGkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRMaW5lcyA9IGxpbmVzLnNsaWNlKGNvbnRlbnRTdGFydEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJ1bmNhdGVkQ29udGVudCA9IGNvbnRlbnRMaW5lcy5zbGljZSgwLCBtYXhMaW5lcykuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhc1RydW5jYXRlZCA9IGNvbnRlbnRMaW5lcy5sZW5ndGggPiBtYXhMaW5lcztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKCdcXG4jIyMgQ29udGVudDonKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2godHJ1bmNhdGVkQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh3YXNUcnVuY2F0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKCdcXG5bLi4uIHRydW5jYXRlZCBmb3IgYnJldml0eSAuLi5dJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0UGFydHMuam9pbignXFxuJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gcmVhZCBmdWxsIGNvbnRleHQgZnJvbSAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udGV4dCBmb3IgYSBzcGVjaWZpYyBkb2N1bWVudCByZWZlcmVuY2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldERvY3VtZW50Q29udGV4dChkb2NSZWY6IERvY3VtZW50UmVmZXJlbmNlKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IGZpbGUsIHByb3BlcnR5IH0gPSBkb2NSZWY7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGZpbGUgc3RpbGwgZXhpc3RzIGluIHRoZSB2YXVsdFxuICAgICAgICAgICAgaWYgKCFmaWxlIHx8ICF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZS5wYXRoKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgRmlsZSBubyBsb25nZXIgZXhpc3RzOiAke2ZpbGU/LnBhdGggfHwgJ3Vua25vd24nfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgc3BlY2lmaWMgcHJvcGVydHkgZnJvbSBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBjYWNoZS5mcm9udG1hdHRlcltwcm9wZXJ0eV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAjIyAke2ZpbGUuYmFzZW5hbWV9IC0gJHtwcm9wZXJ0eX1cXG4ke2NhY2hlLmZyb250bWF0dGVyW3Byb3BlcnR5XX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IGZ1bGwgZG9jdW1lbnQgY29udGV4dCB3aXRoIG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byByZWFkIGNvbnRleHQgZnJvbSAke2RvY1JlZj8uZmlsZT8ucGF0aCB8fCAndW5rbm93biBmaWxlJ306YCwgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgZmlsZSBieSBuYW1lIG9yIHBhdGhcbiAgICAgKi9cbiAgICBwcml2YXRlIGZpbmRGaWxlKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG4gICAgICAgIC8vIEZpcnN0IHRyeSBleGFjdCBwYXRoIG1hdGNoXG4gICAgICAgIGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgLy8gVHJ5IHdpdGggLm1kIGV4dGVuc2lvblxuICAgICAgICAgICAgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoICsgJy5tZCcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAvLyBTZWFyY2ggYnkgYmFzZW5hbWVcbiAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICAgICAgZmlsZSA9IGZpbGVzLmZpbmQoZiA9PiBcbiAgICAgICAgICAgICAgICBmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuICAgICAgICAgICAgICAgIGYubmFtZSA9PT0gbmFtZU9yUGF0aCB8fFxuICAgICAgICAgICAgICAgIGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoKSB8fFxuICAgICAgICAgICAgICAgIGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG4gICAgICAgICAgICApIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgY2xlYXJQZXJzaXN0ZW50Q29udGV4dChmaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcGVyc2lzdGVudCBjb250ZXh0IGZvciBhIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGdldFBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiBEb2N1bWVudFJlZmVyZW5jZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGZpbGVQYXRoKSB8fCBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBzcGVjaWZpYyBkb2N1bWVudCBmcm9tIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAqL1xuICAgIHJlbW92ZVBlcnNpc3RlbnREb2MoZmlsZVBhdGg6IHN0cmluZywgZG9jVG9SZW1vdmU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoZmlsZVBhdGgpIHx8IFtdO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZCA9IGN1cnJlbnQuZmlsdGVyKHJlZiA9PiByZWYuZmlsZS5wYXRoICE9PSBkb2NUb1JlbW92ZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoZmlsZVBhdGgsIGZpbHRlcmVkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzdGltYXRlIHRva2VuIGNvdW50IChyb3VnaCBhcHByb3hpbWF0aW9uKVxuICAgICAqL1xuICAgIHByaXZhdGUgZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgLy8gUm91Z2ggZXN0aW1hdGU6IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodGV4dC5sZW5ndGggLyA0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdmlzdWFsIGluZGljYXRvcnMgZm9yIGNvbnRleHQgc3RhdGVcbiAgICAgKi9cbiAgICBnZXRDb250ZXh0SW5kaWNhdG9ycyhjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiB7XG4gICAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgICAgY2xhc3NOYW1lOiBzdHJpbmc7XG4gICAgICAgIHRvb2x0aXA6IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgY29uc3QgZG9jQ291bnQgPSBjb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGNvbnRleHQudG9rZW5Db3VudCAvIHRoaXMuVE9LRU5fTElNSVQpICogMTAwKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjbGFzc05hbWUgPSAnbm92YS1jb250ZXh0LWluZGljYXRvcic7XG4gICAgICAgIGxldCB0b29sdGlwID0gYENvbnRleHQ6ICR7ZG9jQ291bnR9IGRvY3VtZW50JHtkb2NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSwgfiR7Y29udGV4dC50b2tlbkNvdW50fSB0b2tlbnNgO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnRleHQuaXNOZWFyTGltaXQpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAnIG5vdmEtY29udGV4dC13YXJuaW5nJztcbiAgICAgICAgICAgIHRvb2x0aXAgKz0gJyAoYXBwcm9hY2hpbmcgbGltaXQpJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdGV4dCA9IGAke2RvY0NvdW50fSBkb2NzICR7cGVyY2VudGFnZX0lYDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHRleHQsIGNsYXNzTmFtZSwgdG9vbHRpcCB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb250ZXh0IGZvciBkaXNwbGF5IGluIFVJXG4gICAgICovXG4gICAgZm9ybWF0Q29udGV4dEZvckRpc3BsYXkoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBpdGVtczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBwZXJzaXN0ZW50IGRvY3VtZW50c1xuICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiBjb250ZXh0LnBlcnNpc3RlbnREb2NzKSB7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGAke2RvYy5maWxlLmJhc2VuYW1lfSR7ZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyd9YCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9XG59IiwgImltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQUlQcm92aWRlciwgUHJvdmlkZXJUeXBlLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIEFJUHJvdmlkZXJTZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ2xhdWRlUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9jbGF1ZGUnO1xuaW1wb3J0IHsgT3BlbkFJUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9vcGVuYWknO1xuaW1wb3J0IHsgR29vZ2xlUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9nb29nbGUnO1xuaW1wb3J0IHsgT2xsYW1hUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9vbGxhbWEnO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuLi9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIEFJUHJvdmlkZXJNYW5hZ2VyIHtcblx0cHJpdmF0ZSBwcm92aWRlcnM6IE1hcDxQcm92aWRlclR5cGUsIEFJUHJvdmlkZXI+ID0gbmV3IE1hcCgpO1xuXHRwcml2YXRlIHNldHRpbmdzOiBOb3ZhU2V0dGluZ3M7XG5cdHByaXZhdGUgZmVhdHVyZU1hbmFnZXI/OiBGZWF0dXJlTWFuYWdlcjtcblxuXHRjb25zdHJ1Y3RvcihzZXR0aW5nczogTm92YVNldHRpbmdzLCBmZWF0dXJlTWFuYWdlcj86IEZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBmZWF0dXJlTWFuYWdlcjtcblx0fVxuXG5cdGFzeW5jIGluaXRpYWxpemUoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdjbGF1ZGUnLCBuZXcgQ2xhdWRlUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ29wZW5haScsIG5ldyBPcGVuQUlQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnZ29vZ2xlJywgbmV3IEdvb2dsZVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdvbGxhbWEnLCBuZXcgT2xsYW1hUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEpKTtcblx0fVxuXG5cdHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBOb3ZhU2V0dGluZ3MpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdFx0dGhpcy5wcm92aWRlcnMuZm9yRWFjaCgocHJvdmlkZXIsIHR5cGUpID0+IHtcblx0XHRcdGlmICh0eXBlICE9PSAnbm9uZScgJiYgdHlwZSBpbiB0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzKSB7XG5cdFx0XHRcdHByb3ZpZGVyLnVwZGF0ZUNvbmZpZz8uKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnNbdHlwZSBhcyBrZXlvZiBBSVByb3ZpZGVyU2V0dGluZ3NdKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0UGxhdGZvcm1Qcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRjb25zdCBwbGF0Zm9ybVNldHRpbmdzID0gdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXTtcblx0XHRjb25zdCBwcm92aWRlcnMgPSBbcGxhdGZvcm1TZXR0aW5ncy5wcmltYXJ5UHJvdmlkZXIsIC4uLnBsYXRmb3JtU2V0dGluZ3MuZmFsbGJhY2tQcm92aWRlcnNdO1xuXHRcdFxuXHRcdC8vIE5vIHJlc3RyaWN0aW9ucyAtIGFsbCB1c2VycyBjYW4gdXNlIGFsbCBwcm92aWRlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0XHRyZXR1cm4gcHJvdmlkZXJzO1xuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGdldEF2YWlsYWJsZVByb3ZpZGVyKCk6IFByb21pc2U8QUlQcm92aWRlciB8IG51bGw+IHtcblx0XHRjb25zdCBvcmRlcmVkUHJvdmlkZXJzID0gdGhpcy5nZXRQbGF0Zm9ybVByb3ZpZGVycygpO1xuXHRcdFxuXHRcdC8vIElmIHByaW1hcnkgcHJvdmlkZXIgaXMgJ25vbmUnLCBOb3ZhIGlzIGRpc2FibGVkIG9uIHRoaXMgcGxhdGZvcm1cblx0XHRpZiAob3JkZXJlZFByb3ZpZGVyc1swXSA9PT0gJ25vbmUnKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBwcm92aWRlclR5cGUgb2Ygb3JkZXJlZFByb3ZpZGVycykge1xuXHRcdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnKSBjb250aW51ZTtcblx0XHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRpZiAocHJvdmlkZXIgJiYgYXdhaXQgcHJvdmlkZXIuaXNBdmFpbGFibGUoKSkge1xuXHRcdFx0XHRyZXR1cm4gcHJvdmlkZXI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuZ2VuZXJhdGVUZXh0KHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHlpZWxkKiBwcm92aWRlci5nZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0eWllbGQqIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGdldFByb3ZpZGVyTmFtZXMoKTogc3RyaW5nW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMucHJvdmlkZXJzLnZhbHVlcygpKS5tYXAocCA9PiBwLm5hbWUpO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdHJldHVybiBwcm92aWRlciA/IHByb3ZpZGVyLm5hbWUgOiAnTm9uZSc7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGdldEFsbG93ZWRQcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGFsbG93ZWQgZm9yIGFsbCB1c2Vyc1xuXHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHR9XG5cblx0aXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhbGxvd2VkXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRnZXRQcm92aWRlckxpbWl0cygpOiB7IGxvY2FsOiBudW1iZXI7IGNsb3VkOiBudW1iZXIgfSB7XG5cdFx0Ly8gTm8gbGltaXRzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4geyBsb2NhbDogSW5maW5pdHksIGNsb3VkOiBJbmZpbml0eSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRhc3luYyBnZXRQcm92aWRlck1vZGVscyhwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgUHJvdmlkZXIgJHtwcm92aWRlclR5cGV9IG5vdCBmb3VuZGApO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBnZXRBdmFpbGFibGVNb2RlbHMgbWV0aG9kXG5cdFx0aWYgKCdnZXRBdmFpbGFibGVNb2RlbHMnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5nZXRBdmFpbGFibGVNb2RlbHMgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHJldHVybiBhd2FpdCAocHJvdmlkZXIgYXMgYW55KS5nZXRBdmFpbGFibGVNb2RlbHMoKTtcblx0XHR9XG5cblx0XHQvLyBGb3IgcHJvdmlkZXJzIHdpdGhvdXQgQVBJIG1vZGVsIGxpc3RpbmcgKGxpa2UgT2xsYW1hKSwgcmV0dXJuIGVtcHR5IGFycmF5XG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIG1vZGVsIGNhY2hlIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRjbGVhclByb3ZpZGVyTW9kZWxDYWNoZShwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IHZvaWQge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBjbGVhck1vZGVsQ2FjaGUgbWV0aG9kXG5cdFx0aWYgKCdjbGVhck1vZGVsQ2FjaGUnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5jbGVhck1vZGVsQ2FjaGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdChwcm92aWRlciBhcyBhbnkpLmNsZWFyTW9kZWxDYWNoZSgpO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuY2xlYXIoKTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQ2xhdWRlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdDbGF1ZGUgKEFudGhyb3BpYyknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2NsYXVkZS0zLWhhaWt1LTIwMjQwMzA3Jyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRzeXN0ZW06IG9wdGlvbnM/LnN5c3RlbVByb21wdCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnYXNzaXN0YW50JyA6ICd1c2VyJyxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSlcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENsYXVkZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNvbnRlbnRbMF0udGV4dDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ2Fzc2lzdGFudCcgOiAndXNlcicsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBDbGF1ZGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2RhdGE6ICcpKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBkYXRhID0gbGluZS5zbGljZSg2KTtcblx0XHRcdFx0XHRcdGlmIChkYXRhID09PSAnW0RPTkVdJykge1xuXHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC50eXBlID09PSAnY29udGVudF9ibG9ja19kZWx0YScgJiYgcGFyc2VkLmRlbHRhPy50ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQuZGVsdGEudGV4dCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gQ2xhdWRlIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHQvLyBGb3IgQ2xhdWRlLCB3ZSdsbCB1c2UgYSBoYXJkY29kZWQgbGlzdCBzaW5jZSBBbnRocm9waWMgZG9lc24ndCBwcm92aWRlIGEgbW9kZWxzIGVuZHBvaW50XG5cdFx0Ly8gQnV0IHdlIGNhbiB2YWxpZGF0ZSB0aGUgQVBJIGtleSBieSBtYWtpbmcgYSB0ZXN0IGNhbGxcblx0XHR0cnkge1xuXHRcdFx0Ly8gVmFsaWRhdGUgQVBJIGtleSB3aXRoIGEgbWluaW1hbCByZXF1ZXN0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJywge1xuXHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdFx0fSxcblx0XHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRcdG1vZGVsOiAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuXHRcdFx0XHRcdG1heF90b2tlbnM6IDEsXG5cdFx0XHRcdFx0bWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dXG5cdFx0XHRcdH0pXG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSBrZXkgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmV0dXJuIGN1cnJlbnQgYXZhaWxhYmxlIG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLFxuXHRcdFx0XHQnY2xhdWRlLTMtNS1oYWlrdS0yMDI0MTAyMicsIFxuXHRcdFx0XHQnY2xhdWRlLTMtb3B1cy0yMDI0MDIyOScsXG5cdFx0XHRcdCdjbGF1ZGUtMy1zb25uZXQtMjAyNDAyMjknLFxuXHRcdFx0XHQnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIENsYXVkZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9wZW5BSVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT3BlbkFJJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9jaGF0L2NvbXBsZXRpb25zJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2A7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjdcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9jaGF0L2NvbXBsZXRpb25zJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2A7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXHRcdGxldCBidWZmZXIgPSAnJztcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0Y29uc3QgbGluZXMgPSBidWZmZXIuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJztcblxuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGF0YSA9IGxpbmUuc2xpY2UoNik7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YSA9PT0gJ1tET05FXScpIHtcblx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBwYXJzZWQuY2hvaWNlcz8uWzBdPy5kZWx0YT8uY29udGVudDtcblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHQvKipcblx0ICogRmV0Y2ggYXZhaWxhYmxlIG1vZGVscyBmcm9tIE9wZW5BSSBBUElcblx0ICovXG5cdGFzeW5jIGdldEF2YWlsYWJsZU1vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtb2RlbHMsIHJldHVybiB0aGVtXG5cdFx0aWYgKHRoaXMuY2FjaGVkTW9kZWxzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jYWNoZWRNb2RlbHM7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRcdGNvbnN0IGVuZHBvaW50ID0gYmFzZVVybC5lbmRzV2l0aCgnL21vZGVscycpID8gYmFzZVVybCA6IGAke2Jhc2VVcmx9L21vZGVsc2A7XG5cdFx0XHRcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQVBJIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHRcblx0XHRcdC8vIEZpbHRlciB0byBvbmx5IGNoYXQgY29tcGxldGlvbiBtb2RlbHMgYW5kIHNvcnQgYnkgbmFtZVxuXHRcdFx0Y29uc3QgY2hhdE1vZGVscyA9IGRhdGEuZGF0YVxuXHRcdFx0XHQuZmlsdGVyKChtb2RlbDogYW55KSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgaWQgPSBtb2RlbC5pZC50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRcdHJldHVybiAoaWQuaW5jbHVkZXMoJ2dwdCcpIHx8IGlkLmluY2x1ZGVzKCdjaGF0JykpICYmIFxuXHRcdFx0XHRcdFx0ICAgIWlkLmluY2x1ZGVzKCdpbnN0cnVjdCcpICYmIFxuXHRcdFx0XHRcdFx0ICAgIWlkLmluY2x1ZGVzKCdlZGl0JykgJiZcblx0XHRcdFx0XHRcdCAgICFpZC5pbmNsdWRlcygnc2VhcmNoJykgJiZcblx0XHRcdFx0XHRcdCAgICFpZC5pbmNsdWRlcygnc2ltaWxhcml0eScpICYmXG5cdFx0XHRcdFx0XHQgICAhaWQuaW5jbHVkZXMoJ2VtYmVkZGluZycpO1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQubWFwKChtb2RlbDogYW55KSA9PiBtb2RlbC5pZClcblx0XHRcdFx0LnNvcnQoKTtcblxuXHRcdFx0Y29uc3QgbW9kZWxzID0gY2hhdE1vZGVscy5sZW5ndGggPiAwID8gY2hhdE1vZGVscyA6IFtcblx0XHRcdFx0J2dwdC00bycsXG5cdFx0XHRcdCdncHQtNG8tbWluaScsIFxuXHRcdFx0XHQnZ3B0LTQtdHVyYm8nLFxuXHRcdFx0XHQnZ3B0LTQnLFxuXHRcdFx0XHQnZ3B0LTMuNS10dXJibydcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggT3BlbkFJIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgR29vZ2xlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdHb29nbGUgKEdlbWluaSknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgc3lzdGVtUHJvbXB0Pzogc3RyaW5nKTogYW55IHtcblx0XHRjb25zdCBjb250ZW50cyA9IFtdO1xuXHRcdFxuXHRcdGlmIChzeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlOiAndXNlcicsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBgU3lzdGVtOiAke3N5c3RlbVByb21wdH1gIH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgbWVzc2FnZXMpIHtcblx0XHRcdGNvbnN0IHJvbGUgPSBtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ21vZGVsJyA6ICd1c2VyJztcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogbWVzc2FnZS5jb250ZW50IH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29udGVudHM7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdHb29nbGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS1wcm8nO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRcdGdlbmVyYXRpb25Db25maWc6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktcHJvJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzLCBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGV4dCA9IHBhcnNlZC5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XG5cdFx0XHRcdFx0XHRcdGlmICh0ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiB0ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBHb29nbGUgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscz9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gRmlsdGVyIHRvIGdlbmVyYXRpdmUgbW9kZWxzIHRoYXQgc3VwcG9ydCBnZW5lcmF0ZUNvbnRlbnRcblx0XHRcdGNvbnN0IGdlbmVyYXRpdmVNb2RlbHMgPSBkYXRhLm1vZGVsc1xuXHRcdFx0XHQuZmlsdGVyKChtb2RlbDogYW55KSA9PiB7XG5cdFx0XHRcdFx0cmV0dXJuIG1vZGVsLnN1cHBvcnRlZEdlbmVyYXRpb25NZXRob2RzICYmIFxuXHRcdFx0XHRcdFx0ICAgbW9kZWwuc3VwcG9ydGVkR2VuZXJhdGlvbk1ldGhvZHMuaW5jbHVkZXMoJ2dlbmVyYXRlQ29udGVudCcpICYmXG5cdFx0XHRcdFx0XHQgICBtb2RlbC5uYW1lLmluY2x1ZGVzKCdnZW1pbmknKTtcblx0XHRcdFx0fSlcblx0XHRcdFx0Lm1hcCgobW9kZWw6IGFueSkgPT4ge1xuXHRcdFx0XHRcdC8vIEV4dHJhY3QgbW9kZWwgbmFtZSBmcm9tIGZ1bGwgcGF0aCAoZS5nLiwgXCJtb2RlbHMvZ2VtaW5pLXByb1wiIC0+IFwiZ2VtaW5pLXByb1wiKVxuXHRcdFx0XHRcdHJldHVybiBtb2RlbC5uYW1lLnNwbGl0KCcvJykucG9wKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5zb3J0KCk7XG5cblx0XHRcdGNvbnN0IG1vZGVscyA9IGdlbmVyYXRpdmVNb2RlbHMubGVuZ3RoID4gMCA/IGdlbmVyYXRpdmVNb2RlbHMgOiBbXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoLWV4cCcsXG5cdFx0XHRcdCdnZW1pbmktMS41LXBybycsXG5cdFx0XHRcdCdnZW1pbmktMS41LWZsYXNoJyxcblx0XHRcdFx0J2dlbWluaS0xLjAtcHJvJ1xuXHRcdFx0XTtcblxuXHRcdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBtb2RlbHM7XG5cdFx0XHRyZXR1cm4gbW9kZWxzO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBHb29nbGUgbW9kZWxzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBjYWNoZWQgbW9kZWxzXG5cdCAqL1xuXHRjbGVhck1vZGVsQ2FjaGUoKTogdm9pZCB7XG5cdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBudWxsO1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPbGxhbWFQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ09sbGFtYSAoTG9jYWwpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLm1vZGVsKSByZXR1cm4gZmFsc2U7IC8vIFJlcXVpcmUgbW9kZWwgdG8gYmUgc2V0XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL3RhZ3NgLCB7XG5cdFx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiByZXNwb25zZS5vaztcblx0XHR9IGNhdGNoIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2dlbmVyYXRlYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdHByb21wdCxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5yZXNwb25zZTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5yZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogcGFyc2VkLnJlc3BvbnNlLCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2NoYXRgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSksXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEubWVzc2FnZS5jb250ZW50O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9jaGF0YCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpLFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5tZXNzYWdlPy5jb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQubWVzc2FnZS5jb250ZW50LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQuZG9uZSkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2tpcCBtYWxmb3JtZWQgSlNPTlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cbn0iLCAiLyoqXG4gKiBDb3JlIGRvY3VtZW50IGVuZ2luZSBmb3IgTm92YVxuICogSGFuZGxlcyBhbGwgZG9jdW1lbnQgbWFuaXB1bGF0aW9uIGFuZCBlZGl0b3IgaW50ZXJhY3Rpb25zXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgVEZpbGUsIEVkaXRvclBvc2l0aW9uLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudENvbnRleHQsIEhlYWRpbmdJbmZvLCBFZGl0UmVzdWx0LCBFZGl0T3B0aW9ucywgRG9jdW1lbnRTZWN0aW9uLCBFZGl0Q29tbWFuZCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciwgRGF0YVN0b3JlIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudEVuZ2luZSB7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyIHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBkYXRhU3RvcmU/OiBEYXRhU3RvcmUpIHtcbiAgICAgICAgaWYgKGRhdGFTdG9yZSkge1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjb252ZXJzYXRpb24gbWFuYWdlciAoZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uKVxuICAgICAqL1xuICAgIHNldENvbnZlcnNhdGlvbk1hbmFnZXIoY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBjb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYWN0aXZlIGVkaXRvciBpbnN0YW5jZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUVkaXRvcigpOiBFZGl0b3IgfCBudWxsIHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5IHRoZSB3b3Jrc3BhY2UgbWV0aG9kXG4gICAgICAgIGNvbnN0IGFjdGl2ZUVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVFZGl0b3I7XG4gICAgICAgIGlmIChhY3RpdmVFZGl0b3I/LmVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZUVkaXRvci5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBnZXQgdGhlIGFjdGl2ZSBtYXJrZG93biB2aWV3XG4gICAgICAgIGxldCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG5vIGFjdGl2ZSBtYXJrZG93biB2aWV3LCB0cnkgdG8gZmluZCBhbnkgbWFya2Rvd24gdmlld1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZlZpZXcgPSBsZWFmLnZpZXc7XG4gICAgICAgICAgICAgICAgaWYgKGxlYWZWaWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcgPSBsZWFmVmlldztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUcnkgZGlmZmVyZW50IHdheXMgdG8gZ2V0IHRoZSBlZGl0b3JcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdmlldy5lZGl0b3I7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yIHx8IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZmlsZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUZpbGUoKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgdGV4dFxuICAgICAqL1xuICAgIGdldFNlbGVjdGVkVGV4dCgpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgZ2V0Q3Vyc29yUG9zaXRpb24oKTogRWRpdG9yUG9zaXRpb24gfCBudWxsIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGNvbXByZWhlbnNpdmUgZG9jdW1lbnQgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGdldERvY3VtZW50Q29udGV4dCgpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICFlZGl0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSB0aGlzLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHRoaXMuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSB0aGUgZG9jdW1lbnRcbiAgICAgICAgY29uc3QgaGVhZGluZ3MgPSB0aGlzLmV4dHJhY3RIZWFkaW5ncyhjb250ZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBzdXJyb3VuZGluZyBsaW5lcyBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBzdXJyb3VuZGluZ0xpbmVzID0gY3Vyc29yUG9zaXRpb24gPyBcbiAgICAgICAgICAgIHRoaXMuZ2V0U3Vycm91bmRpbmdMaW5lcyhjb250ZW50LCBjdXJzb3JQb3NpdGlvbi5saW5lKSA6IFxuICAgICAgICAgICAgdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgaGVhZGluZ3MsXG4gICAgICAgICAgICBzZWxlY3RlZFRleHQ6IHNlbGVjdGVkVGV4dCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBjdXJzb3JQb3NpdGlvbjogY3Vyc29yUG9zaXRpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0SGVhZGluZ3MoY29udGVudDogc3RyaW5nKTogSGVhZGluZ0luZm9bXSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGhlYWRpbmdzOiBIZWFkaW5nSW5mb1tdID0gW107XG4gICAgICAgIGxldCBjaGFyQ291bnQgPSAwO1xuXG4gICAgICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGhlYWRpbmdNYXRjaFsyXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWFkaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGNoYXJDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogY2hhckNvdW50ICsgbGluZS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbGluZSBsZW5ndGggKyBuZXdsaW5lIGNoYXJhY3RlclxuICAgICAgICAgICAgY2hhckNvdW50ICs9IGxpbmUubGVuZ3RoICsgMTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGhlYWRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBsaW5lcyBzdXJyb3VuZGluZyB0aGUgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRTdXJyb3VuZGluZ0xpbmVzKFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjdXJyZW50TGluZTogbnVtYmVyLCBcbiAgICAgICAgY29udGV4dFNpemU6IG51bWJlciA9IDVcbiAgICApOiB7IGJlZm9yZTogc3RyaW5nW107IGFmdGVyOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IE1hdGgubWF4KDAsIGN1cnJlbnRMaW5lIC0gY29udGV4dFNpemUpO1xuICAgICAgICBjb25zdCBlbmRMaW5lID0gTWF0aC5taW4obGluZXMubGVuZ3RoIC0gMSwgY3VycmVudExpbmUgKyBjb250ZXh0U2l6ZSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmVmb3JlOiBsaW5lcy5zbGljZShzdGFydExpbmUsIGN1cnJlbnRMaW5lKSxcbiAgICAgICAgICAgIGFmdGVyOiBsaW5lcy5zbGljZShjdXJyZW50TGluZSArIDEsIGVuZExpbmUgKyAxKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGFuIGVkaXQgdG8gdGhlIGRvY3VtZW50XG4gICAgICovXG4gICAgYXN5bmMgYXBwbHlFZGl0KFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgICAgIHBvc2l0aW9uOiAnY3Vyc29yJyB8ICdzZWxlY3Rpb24nIHwgJ2VuZCcgfCB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9LFxuICAgICAgICBvcHRpb25zOiBFZGl0T3B0aW9ucyA9IHt9XG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBvciBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGFwcGxpZWRBdDogRWRpdG9yUG9zaXRpb247XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2N1cnNvcicpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oY29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnZW5kJykge1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZSA9IGVkaXRvci5sYXN0TGluZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gZWRpdG9yLmdldExpbmUobGFzdExpbmUpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSB7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50Q29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBjdXJyZW50Q29udGVudCArIChjdXJyZW50Q29udGVudC5lbmRzV2l0aCgnXFxuJykgPyAnJyA6ICdcXG4nKSArIGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXNlIHZhdWx0Lm1vZGlmeSBmb3IgdW5kby9yZWRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBzcGVjaWZpYyBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGFuZGxlIHBvc3QtZWRpdCBvcHRpb25zXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zZWxlY3ROZXdUZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0ge1xuICAgICAgICAgICAgICAgICAgICBsaW5lOiBhcHBsaWVkQXQubGluZSArIGNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjb250ZW50LmluY2x1ZGVzKCdcXG4nKSA/IFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5zcGxpdCgnXFxuJykucG9wKCkhLmxlbmd0aCA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0LmNoICsgY29udGVudC5sZW5ndGhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTZWxlY3Rpb24oYXBwbGllZEF0LCBlbmRQb3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zY3JvbGxUb0VkaXQpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBhcHBsaWVkQXQsXG4gICAgICAgICAgICAgICAgICAgIHRvOiBhcHBsaWVkQXRcbiAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6IHBvc2l0aW9uID09PSAnc2VsZWN0aW9uJyA/ICdyZXBsYWNlJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID09PSAnZW5kJyA/ICdhcHBlbmQnIDogJ2luc2VydCcsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgY29udGVudCBhdCBhIHNwZWNpZmljIGxvY2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlQ29udGVudChcbiAgICAgICAgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdsaW5lJyB8ICdzZWN0aW9uJyxcbiAgICAgICAgbG9jYXRpb24/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCcnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdsaW5lJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gY3Vyc29yLmxpbmU7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZSwgY2g6IDAgfSwgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogbGluZSArIDEsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmUsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmZpbmRTZWN0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtsb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgc2VjdGlvbiBpbmNsdWRpbmcgaXRzIGhlYWRpbmdcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaW5lcyA9IGxpbmVzLmZpbHRlcigoXywgaW5kZXgpID0+IFxuICAgICAgICAgICAgICAgICAgICBpbmRleCA8IHNlY3Rpb24ucmFuZ2Uuc3RhcnQgfHwgaW5kZXggPiBzZWN0aW9uLnJhbmdlLmVuZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0xpbmVzLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRlIHRhcmdldCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc2VjdGlvbiBieSBoZWFkaW5nIG5hbWVcbiAgICAgKi9cbiAgICBhc3luYyBmaW5kU2VjdGlvbihoZWFkaW5nVGV4dDogc3RyaW5nKTogUHJvbWlzZTxEb2N1bWVudFNlY3Rpb24gfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWNvbnRleHQpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IGhlYWRpbmdJbmRleCA9IGNvbnRleHQuaGVhZGluZ3MuZmluZEluZGV4KGggPT4gXG4gICAgICAgICAgICBoLnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhoZWFkaW5nVGV4dC50b0xvd2VyQ2FzZSgpKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChoZWFkaW5nSW5kZXggPT09IC0xKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBoZWFkaW5nID0gY29udGV4dC5oZWFkaW5nc1toZWFkaW5nSW5kZXhdO1xuICAgICAgICBjb25zdCBuZXh0SGVhZGluZyA9IGNvbnRleHQuaGVhZGluZ3NbaGVhZGluZ0luZGV4ICsgMV07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBuZXh0SGVhZGluZyA/IG5leHRIZWFkaW5nLmxpbmUgLSAxIDogbGluZXMubGVuZ3RoIC0gMTtcblxuICAgICAgICAvLyBFeHRyYWN0IHNlY3Rpb24gY29udGVudCAoZXhjbHVkaW5nIHRoZSBoZWFkaW5nIGxpbmUpXG4gICAgICAgIGNvbnN0IHNlY3Rpb25MaW5lcyA9IGxpbmVzLnNsaWNlKGhlYWRpbmcubGluZSArIDEsIGVuZExpbmUgKyAxKTtcbiAgICAgICAgY29uc3Qgc2VjdGlvbkNvbnRlbnQgPSBzZWN0aW9uTGluZXMuam9pbignXFxuJykudHJpbSgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoZWFkaW5nOiBoZWFkaW5nLnRleHQsXG4gICAgICAgICAgICBsZXZlbDogaGVhZGluZy5sZXZlbCxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHNlY3Rpb25Db250ZW50LFxuICAgICAgICAgICAgcmFuZ2U6IHtcbiAgICAgICAgICAgICAgICBzdGFydDogaGVhZGluZy5saW5lLFxuICAgICAgICAgICAgICAgIGVuZDogZW5kTGluZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZW50KCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZW50aXJlIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBzZXREb2N1bWVudENvbnRlbnQoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJzYXRpb24gbWFuYWdlbWVudCBtZXRob2RzXG5cbiAgICAvKipcbiAgICAgKiBBZGQgdXNlciBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgY29tbWFuZD86IEVkaXRDb21tYW5kKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoZmlsZSwgY29udGVudCwgY29tbWFuZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYXNzaXN0YW50IHJlc3BvbnNlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoY29udGVudDogc3RyaW5nLCByZXN1bHQ/OiBFZGl0UmVzdWx0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShmaWxlLCBjb250ZW50LCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN5c3RlbSBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkU3lzdGVtTWVzc2FnZShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBmb3IgQUkgcHJvbXB0c1xuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbkNvbnRleHQobWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljcyBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uU3RhdHMoKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFN0YXRzKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGN1cnJlbnQgZmlsZSBoYXMgYW4gYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbigpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmhhc0NvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZXhwb3J0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlciBmb3IgTm92YVxuICogSGFuZGxlcyBmaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gc3RvcmFnZSBhbmQgcmV0cmlldmFsXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhLCBDb252ZXJzYXRpb25NZXNzYWdlLCBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRWRpdEFjdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTdG9yZSB7XG4gICAgbG9hZERhdGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gICAgc2F2ZURhdGEoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbnM6IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbkRhdGE+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgbWF4TWVzc2FnZXNQZXJGaWxlID0gMTAwOyAvLyBMaW1pdCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgIHByaXZhdGUgc3RvcmFnZUtleSA9ICdub3ZhLWNvbnZlcnNhdGlvbnMnO1xuICAgIHByaXZhdGUgY2xlYW51cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0YVN0b3JlOiBEYXRhU3RvcmUpIHtcbiAgICAgICAgdGhpcy5sb2FkQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBjb252ZXJzYXRpb25zIGZyb20gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZGF0YVN0b3JlLmxvYWREYXRhKHRoaXMuc3RvcmFnZUtleSk7XG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb252ZXJzYXRpb24gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGNvbnZlcnNhdGlvbi5maWxlUGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBkYXRhOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhdmUgY29udmVyc2F0aW9ucyB0byBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25zQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy52YWx1ZXMoKSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRhdGFTdG9yZS5zYXZlRGF0YSh0aGlzLnN0b3JhZ2VLZXksIGNvbnZlcnNhdGlvbnNBcnJheSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBjb252ZXJzYXRpb24gZGF0YTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGZvciBhIHNwZWNpZmljIGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBDb252ZXJzYXRpb25EYXRhIHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9ucy5oYXMoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNvbnZlcnNhdGlvbiBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICBjb25zdCBuZXdDb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZEZyZXF1ZW5jeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXdyaXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGZpbGVQYXRoLCBuZXdDb252ZXJzYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZVBhdGgpITtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSB1c2VyIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIGNvbW1hbmRcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBVcGRhdGUgY29tbWFuZCBmcmVxdWVuY3kgaWYgY29tbWFuZCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZCAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5W2NvbW1hbmQuYWN0aW9uXSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gYXNzaXN0YW50IHJlc3BvbnNlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSxcbiAgICAgICAgY29udGVudDogc3RyaW5nLFxuICAgICAgICByZXN1bHQ/OiBFZGl0UmVzdWx0XG4gICAgKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICByZXN1bHRcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAvLyBJbmNyZW1lbnQgZWRpdCBjb3VudCBpZiByZXN1bHQgaW5kaWNhdGVzIHN1Y2Nlc3NmdWwgZWRpdFxuICAgICAgICBpZiAocmVzdWx0Py5zdWNjZXNzICYmIGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmVkaXRDb3VudCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBzeXN0ZW0gbWVzc2FnZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkU3lzdGVtTWVzc2FnZShmaWxlOiBURmlsZSwgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCByZWNlbnQgbWVzc2FnZXMgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRSZWNlbnRNZXNzYWdlcyhmaWxlOiBURmlsZSwgY291bnQ6IG51bWJlciA9IDEwKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLWNvdW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbWVzc2FnZXMgYnkgcm9sZVxuICAgICAqL1xuICAgIGdldE1lc3NhZ2VzQnlSb2xlKGZpbGU6IFRGaWxlLCByb2xlOiBDb252ZXJzYXRpb25NZXNzYWdlWydyb2xlJ10pOiBDb252ZXJzYXRpb25NZXNzYWdlW10ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5yb2xlID09PSByb2xlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGU6IFRGaWxlLCBtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0TGluZXMgPSBtZXNzYWdlcy5tYXAobXNnID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZygpO1xuICAgICAgICAgICAgbGV0IGxpbmUgPSBgWyR7dGltZXN0YW1wfV0gJHttc2cucm9sZS50b1VwcGVyQ2FzZSgpfTogJHttc2cuY29udGVudH1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobXNnLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKENvbW1hbmQ6ICR7bXNnLmNvbW1hbmQuYWN0aW9ufSAke21zZy5jb21tYW5kLnRhcmdldH0pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKFJlc3VsdDogJHttc2cucmVzdWx0LnN1Y2Nlc3MgPyAnc3VjY2VzcycgOiAnZmFpbGVkJ30pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBgUHJldmlvdXMgY29udmVyc2F0aW9uOlxcbiR7Y29udGV4dExpbmVzLmpvaW4oJ1xcbicpfVxcbmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gW107XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50ID0gMDtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5ID0ge1xuICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzXG4gICAgICovXG4gICAgZ2V0U3RhdHMoZmlsZTogVEZpbGUpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgbWF4Q291bnQgPSAwO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBbYWN0aW9uLCBjb3VudF0gb2YgT2JqZWN0LmVudHJpZXMoY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kID0gYWN0aW9uIGFzIEVkaXRBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IERhdGUubm93KCkgLSBjb252ZXJzYXRpb24ubWVzc2FnZXNbMF0udGltZXN0YW1wXG4gICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2VDb3VudDogY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCxcbiAgICAgICAgICAgIGVkaXRDb3VudDogY29udmVyc2F0aW9uLm1ldGFkYXRhPy5lZGl0Q291bnQgfHwgMCxcbiAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkFnZVxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0IGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgZXhwb3J0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gW2AjIENvbnZlcnNhdGlvbiBIaXN0b3J5IGZvciAke2ZpbGUubmFtZX1gLCAnJ107XG5cbiAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGNvbnZlcnNhdGlvbi5tZXNzYWdlcykge1xuICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUobWVzc2FnZS50aW1lc3RhbXApLnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKGAjIyAke21lc3NhZ2Uucm9sZS50b1VwcGVyQ2FzZSgpfSAoJHt0aW1lc3RhbXB9KWApO1xuICAgICAgICAgICAgbGluZXMucHVzaChtZXNzYWdlLmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkNvbW1hbmQ6ICR7bWVzc2FnZS5jb21tYW5kLmFjdGlvbn0gJHttZXNzYWdlLmNvbW1hbmQudGFyZ2V0fSpgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKlJlc3VsdDogJHttZXNzYWdlLnJlc3VsdC5zdWNjZXNzID8gJ1N1Y2Nlc3MnIDogJ0ZhaWxlZCd9KmApO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqRXJyb3I6ICR7bWVzc2FnZS5yZXN1bHQuZXJyb3J9KmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGluZXMucHVzaCgnJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGluZXMuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgdW5pcXVlIG1lc3NhZ2UgSURcbiAgICAgKi9cbiAgICBwcml2YXRlIGdlbmVyYXRlTWVzc2FnZUlkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgbXNnXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmltIGNvbnZlcnNhdGlvbiB0byBtYXggbGVuZ3RoIGFuZCBzYXZlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB0cmltQW5kU2F2ZShjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiB0aGlzLm1heE1lc3NhZ2VzUGVyRmlsZSkge1xuICAgICAgICAgICAgLy8gS2VlcCB0aGUgbW9zdCByZWNlbnQgbWVzc2FnZXNcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5zbGljZSgtdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjb252ZXJzYXRpb24gZmlsZSBwYXRoc1xuICAgICAqL1xuICAgIGdldEFsbENvbnZlcnNhdGlvbkZpbGVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5jb252ZXJzYXRpb25zLmtleXMoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZmlsZSBoYXMgYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGUucGF0aCk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24gPyBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjb252ZXJzYXRpb24gZmlsZSBwYXRoIChmb3IgZmlsZSByZW5hbWVzKVxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZUZpbGVQYXRoKG9sZFBhdGg6IHN0cmluZywgbmV3UGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQob2xkUGF0aCk7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5maWxlUGF0aCA9IG5ld1BhdGg7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKG9sZFBhdGgpO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChuZXdQYXRoLCBjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcGVyaW9kaWMgY2xlYW51cCBvZiBvbGQgY29udmVyc2F0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRQZXJpb2RpY0NsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIC8vIENsZWFuIHVwIGV2ZXJ5IDI0IGhvdXJzXG4gICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cE9sZENvbnZlcnNhdGlvbnMoNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyA3IGRheXNcbiAgICAgICAgfSwgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgY29udmVyc2F0aW9ucyBvbGRlciB0aGFuIHRoZSBzcGVjaWZpZWQgYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBjbGVhbnVwT2xkQ29udmVyc2F0aW9ucyhtYXhBZ2U6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBsZXQgY2xlYW5lZCA9IGZhbHNlO1xuXG4gICAgICAgIGZvciAoY29uc3QgW2ZpbGVQYXRoLCBjb252ZXJzYXRpb25dIG9mIHRoaXMuY29udmVyc2F0aW9ucy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGNvbnZlcnNhdGlvbiBpcyBvbGQgYmFzZWQgb24gbGFzdCBtZXNzYWdlXG4gICAgICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlc1tjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgY29uc3QgYWdlID0gbm93IC0gbGFzdE1lc3NhZ2UudGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChhZ2UgPiBtYXhBZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShmaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFuZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjbGVhbmVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbnVwIG1ldGhvZCB0byBjYWxsIHdoZW4gcGx1Z2luIGlzIGRpc2FibGVkXG4gICAgICovXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY2xlYW51cEludGVydmFsICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuY2xlYW51cEludGVydmFsKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBDb250ZXh0IGJ1aWxkZXIgZm9yIE5vdmFcbiAqIEdlbmVyYXRlcyBhcHByb3ByaWF0ZSBwcm9tcHRzIGZvciBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIERvY3VtZW50U2VjdGlvbiwgUHJvbXB0Q29uZmlnLCBDb252ZXJzYXRpb25NZXNzYWdlIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogR2VuZXJhdGVkIHByb21wdCBmb3IgQUkgY29tcGxldGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlZFByb21wdCB7XG4gICAgLyoqIFN5c3RlbSBwcm9tcHQgZm9yIEFJIGNvbnRleHQgKi9cbiAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogVXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnMgKi9cbiAgICB1c2VyUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEFkZGl0aW9uYWwgY29udGV4dCBmb3IgdGhlIEFJICovXG4gICAgY29udGV4dDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBDb25maWd1cmF0aW9uIGZvciBBSSBnZW5lcmF0aW9uICovXG4gICAgY29uZmlnOiB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gICAgICAgIG1heFRva2VuczogbnVtYmVyO1xuICAgIH07XG59XG5cbi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBnZW5lcmF0aW5nIEFJIHByb21wdHNcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGRlZmF1bHRDb25maWc6IFByb21wdENvbmZpZyA9IHtcbiAgICAgICAgbWF4Q29udGV4dExpbmVzOiAyMCxcbiAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogdHJ1ZSxcbiAgICAgICAgaW5jbHVkZUhpc3Rvcnk6IGZhbHNlLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHNwZWNpZmljIGNvbW1hbmRcbiAgICAgKi9cbiAgICBidWlsZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fSxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHsgLi4udGhpcy5kZWZhdWx0Q29uZmlnLCAuLi5vcHRpb25zIH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSB0aGlzLmJ1aWxkU3lzdGVtUHJvbXB0KGNvbW1hbmQuYWN0aW9uLCBjb25maWcpO1xuICAgICAgICBjb25zdCBjb250ZXh0SW5mbyA9IHRoaXMuYnVpbGRDb250ZXh0SW5mbyhkb2N1bWVudENvbnRleHQsIGNvbW1hbmQsIGNvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgIGNvbnN0IHVzZXJQcm9tcHQgPSB0aGlzLmJ1aWxkVXNlclByb21wdChjb21tYW5kLCBjb250ZXh0SW5mbyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHRJbmZvLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IGNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBjb25maWcubWF4VG9rZW5zIHx8IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzeXN0ZW0gcHJvbXB0IGJhc2VkIG9uIGFjdGlvbiB0eXBlXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFN5c3RlbVByb21wdChhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSwgY29uZmlnOiBQcm9tcHRDb25maWcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBiYXNlUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyIHRoYXQgaGVscHMgdXNlcnMgZWRpdCBkb2N1bWVudHMgZGlyZWN0bHkuIFlvdSB3b3JrIHdpdGggTWFya2Rvd24gZG9jdW1lbnRzIGluIE9ic2lkaWFuLlxuXG5JTVBPUlRBTlQgR1VJREVMSU5FUzpcbi0gUHJvdmlkZSBPTkxZIHRoZSBjb250ZW50IHRvIGJlIGluc2VydGVkL21vZGlmaWVkLCBubyBleHBsYW5hdGlvbnMgb3IgbWV0YS10ZXh0XG4tIE1haW50YWluIHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIHN0eWxlIGFuZCB0b25lIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIFByZXNlcnZlIGZvcm1hdHRpbmcsIHN0cnVjdHVyZSwgYW5kIG1hcmtkb3duIHN5bnRheFxuLSBCZSBjb25jaXNlIGFuZCBmb2N1c2VkIG9uIHRoZSBzcGVjaWZpYyByZXF1ZXN0XG4tIERvIG5vdCBhZGQgc2VjdGlvbiBoZWFkZXJzIHVubGVzcyBzcGVjaWZpY2FsbHkgcmVxdWVzdGVkYDtcblxuICAgICAgICBjb25zdCBhY3Rpb25TcGVjaWZpY1Byb21wdHMgPSB7XG4gICAgICAgICAgICBhZGQ6IGBcblRBU0s6IEFkZCBuZXcgY29udGVudCB0byB0aGUgZG9jdW1lbnQuXG4tIENyZWF0ZSB3ZWxsLXN0cnVjdHVyZWQsIHJlbGV2YW50IGNvbnRlbnQgdGhhdCBmaXRzIHRoZSBkb2N1bWVudCdzIHB1cnBvc2Vcbi0gVXNlIGFwcHJvcHJpYXRlIG1hcmtkb3duIGZvcm1hdHRpbmcgKGhlYWRpbmdzLCBsaXN0cywgZW1waGFzaXMpXG4tIEVuc3VyZSBzbW9vdGggZmxvdyB3aXRoIGV4aXN0aW5nIGNvbnRlbnRcbi0gTWF0Y2ggdGhlIGRvY3VtZW50J3Mgc3R5bGUgYW5kIHRvbmVgLFxuXG4gICAgICAgICAgICBlZGl0OiBgXG5UQVNLOiBFZGl0IGFuZCBpbXByb3ZlIGV4aXN0aW5nIGNvbnRlbnQuXG4tIEVuaGFuY2UgY2xhcml0eSwgcmVhZGFiaWxpdHksIGFuZCBmbG93XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBtZWFuaW5nIHVubGVzcyBjaGFuZ2VzIGFyZSByZXF1ZXN0ZWRcbi0gSW1wcm92ZSB3b3JkIGNob2ljZSBhbmQgc2VudGVuY2Ugc3RydWN0dXJlXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCBmb3JtYXR0aW5nIGFuZCBzdHJ1Y3R1cmVgLFxuXG4gICAgICAgICAgICBkZWxldGU6IGBcblRBU0s6IFJlbW92ZSBzcGVjaWZpZWQgY29udGVudCBmcm9tIHRoZSBkb2N1bWVudC5cbi0gSWRlbnRpZnkgdGhlIGV4YWN0IGNvbnRlbnQgdG8gYmUgcmVtb3ZlZFxuLSBFbnN1cmUgcmVtYWluaW5nIGNvbnRlbnQgZmxvd3MgbmF0dXJhbGx5XG4tIFByZXNlcnZlIGRvY3VtZW50IHN0cnVjdHVyZSBhbmQgZm9ybWF0dGluZ1xuLSBDb25maXJtIHRoZSBkZWxldGlvbiBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIGNvbnRleHRgLFxuXG4gICAgICAgICAgICBncmFtbWFyOiBgXG5UQVNLOiBGaXggZ3JhbW1hciwgc3BlbGxpbmcsIGFuZCBsYW5ndWFnZSBpc3N1ZXMuXG4tIENvcnJlY3Qgc3BlbGxpbmcgZXJyb3JzLCBncmFtbWFyIG1pc3Rha2VzLCBhbmQgdHlwb3Ncbi0gSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUgYW5kIGNsYXJpdHlcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIHZvaWNlIGFuZCBzdHlsZVxuLSBQcmVzZXJ2ZSBhbGwgZm9ybWF0dGluZyBhbmQgbWFya2Rvd24gc3ludGF4XG4tIE1ha2UgbWluaW1hbCBjaGFuZ2VzIC0gb25seSBmaXggYWN0dWFsIGVycm9yc2AsXG5cbiAgICAgICAgICAgIHJld3JpdGU6IGBcblRBU0s6IFJld3JpdGUgb3IgcmVzdHJ1Y3R1cmUgY29udGVudC5cbi0gQ3JlYXRlIG5ldyBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2Vcbi0gSW1wcm92ZSBvcmdhbml6YXRpb24sIGNsYXJpdHksIGFuZCBmbG93XG4tIFVzZSBtb3JlIGVmZmVjdGl2ZSBsYW5ndWFnZSBhbmQgc3RydWN0dXJlXG4tIE1haW50YWluIGtleSBpbmZvcm1hdGlvbiBhbmQgY29uY2VwdHNcbi0gQWRhcHQgdG8gYW55IHNwZWNpZmllZCBzdHlsZSByZXF1aXJlbWVudHNgLFxuXG4gICAgICAgICAgICBtZXRhZGF0YTogYFxuVEFTSzogVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhL3Byb3BlcnRpZXMuXG4tIE1vZGlmeSwgYWRkLCBvciByZW1vdmUgZnJvbnRtYXR0ZXIgcHJvcGVydGllc1xuLSBIYW5kbGUgdGFncywgdGl0bGVzLCBkYXRlcywgYW5kIGN1c3RvbSBwcm9wZXJ0aWVzXG4tIE1haW50YWluIHByb3BlciBZQU1MIGZvcm1hdHRpbmdcbi0gUHJlc2VydmUgZXhpc3RpbmcgcHJvcGVydGllcyB1bmxlc3Mgc3BlY2lmaWNhbGx5IGNoYW5naW5nIHRoZW1cbi0gUHJvdmlkZSBPTkxZIHRoZSBwcm9wZXJ0eSB1cGRhdGVzIGluIEpTT04gZm9ybWF0YFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBiYXNlUHJvbXB0ICsgYWN0aW9uU3BlY2lmaWNQcm9tcHRzW2FjdGlvbl07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBgJHtjb250ZXh0SW5mb31cXG5cXG5VU0VSIFJFUVVFU1Q6ICR7Y29tbWFuZC5pbnN0cnVjdGlvbn1gO1xuXG4gICAgICAgIC8vIEFkZCBzcGVjaWZpYyBjb250ZXh0IGlmIHByb3ZpZGVkXG4gICAgICAgIGlmIChjb21tYW5kLmNvbnRleHQgJiYgY29tbWFuZC5jb250ZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBcXG5cXG5BRERJVElPTkFMIFJFUVVJUkVNRU5UUzogJHtjb21tYW5kLmNvbnRleHR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCB0YXJnZXQtc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICAgIGNvbnN0IHRhcmdldEluc3RydWN0aW9ucyA9IHRoaXMuZ2V0VGFyZ2V0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuICAgICAgICBpZiAodGFyZ2V0SW5zdHJ1Y3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbiR7dGFyZ2V0SW5zdHJ1Y3Rpb25zfWA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgYWN0aW9uLXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAgICBjb25zdCBhY3Rpb25JbnN0cnVjdGlvbnMgPSB0aGlzLmdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kKTtcbiAgICAgICAgaWYgKGFjdGlvbkluc3RydWN0aW9ucykge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBcXG5cXG4ke2FjdGlvbkluc3RydWN0aW9uc31gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGFyZ2V0LXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VGFyZ2V0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBXb3JrIHdpdGggdGhlIHNlbGVjdGVkIHRleHQgb25seS4gUHJvdmlkZSB0aGUgaW1wcm92ZWQgdmVyc2lvbiBvZiB0aGUgc2VsZWN0ZWQgY29udGVudC4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYEZPQ1VTOiBXb3JrIHdpdGggdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb24uICR7Y29tbWFuZC5hY3Rpb24gPT09ICdhZGQnID8gJ0FkZCBjb250ZW50IHRvIHRoaXMgc2VjdGlvbi4nIDogJ01vZGlmeSBvbmx5IHRoaXMgc2VjdGlvbi4nfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IFdvcmsgd2l0aCB0aGUgY3VycmVudCBzZWN0aW9uLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBBcHBseSBjaGFuZ2VzIHRvIHRoZSBlbnRpcmUgZG9jdW1lbnQgd2hpbGUgcHJlc2VydmluZyBpdHMgc3RydWN0dXJlLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogQWRkIGNvbnRlbnQgYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQuIEVuc3VyZSBpdCBmbG93cyBuYXR1cmFsbHkgZnJvbSBleGlzdGluZyBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogV29yayB3aXRoIHRoZSBjdXJyZW50IHBhcmFncmFwaCBvciBjcmVhdGUgYSBuZXcgcGFyYWdyYXBoLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFjdGlvbi1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgbmV3IGNvbnRlbnQgdG8gYmUgYWRkZWQuIEluY2x1ZGUgYXBwcm9wcmlhdGUgaGVhZGluZ3MgaWYgYWRkaW5nIGEgc2VjdGlvbi4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlLCBvciByZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGNvcnJlY3RlZCB0ZXh0IHdpdGggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZml4ZXMuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvbXBsZXRlbHkgcmV3cml0dGVuIGNvbnRlbnQgdGhhdCBzZXJ2ZXMgdGhlIHNhbWUgcHVycG9zZS4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgT05MWSBhIEpTT04gb2JqZWN0IHdpdGggdGhlIHByb3BlcnR5IHVwZGF0ZXMuIEV4YW1wbGU6IHtcInRpdGxlXCI6IFwiTmV3IFRpdGxlXCIsIFwidGFnc1wiOiBbXCJ0YWcxXCIsIFwidGFnMlwiXSwgXCJkYXRlXCI6IFwiMjAyNS0wMS0wMVwifSc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29udGV4dCBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb21wdFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRDb250ZXh0SW5mbyhcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBjb25maWc6IFByb21wdENvbmZpZyxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gYERPQ1VNRU5UOiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGUgYW5kIHJlcXVlc3RlZFxuICAgICAgICBpZiAoY29uZmlnLmluY2x1ZGVIaXN0b3J5ICYmIGNvbnZlcnNhdGlvbkNvbnRleHQgJiYgY29udmVyc2F0aW9uQ29udGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbiR7Y29udmVyc2F0aW9uQ29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IHN0cnVjdHVyZSBpZiByZXF1ZXN0ZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlU3RydWN0dXJlICYmIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5ET0NVTUVOVCBTVFJVQ1RVUkU6XFxuJztcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGVudCA9ICcgICcucmVwZWF0KGhlYWRpbmcubGV2ZWwgLSAxKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBzZWxlY3RlZCB0ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcblNFTEVDVEVEIFRFWFQ6XFxuJHtkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVsZXZhbnQgY29udGV4dCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IHRoaXMuZmluZFNlY3Rpb25JbkNvbnRlbnQoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5DVVJSRU5UIFNFQ1RJT04gXCIke2NvbW1hbmQubG9jYXRpb259XCI6XFxuJHtzZWN0aW9ufVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdwYXJhZ3JhcGgnICYmIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5DVVJSRU5UIENPTlRFWFQ6XFxuJztcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYEJlZm9yZTogJHtkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUuam9pbignICcpfVxcbmA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYWZ0ZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYEFmdGVyOiAke2RvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJyAnKX1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGxpbWl0ZWQgZG9jdW1lbnQgY29udGVudCBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBjb250ZW50TGluZXMgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGlmIChjb250ZW50TGluZXMubGVuZ3RoID4gY29uZmlnLm1heENvbnRleHRMaW5lcykge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1heCgwLCBjb250ZW50TGluZXMubGVuZ3RoIC0gY29uZmlnLm1heENvbnRleHRMaW5lcyk7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5SRUNFTlQgQ09OVEVOVCAobGFzdCAke2NvbmZpZy5tYXhDb250ZXh0TGluZXN9IGxpbmVzKTpcXG5gO1xuICAgICAgICAgICAgY29udGV4dCArPSBjb250ZW50TGluZXMuc2xpY2Uoc3RhcnQpLmpvaW4oJ1xcbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuRlVMTCBET0NVTUVOVDpcXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc3BlY2lmaWMgc2VjdGlvbiBpbiBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBmaW5kU2VjdGlvbkluQ29udGVudChjb250ZW50OiBzdHJpbmcsIHNlY3Rpb25OYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFNlY3Rpb25OYW1lID0gc2VjdGlvbk5hbWUudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgc2VjdGlvblN0YXJ0ID0gLTE7XG4gICAgICAgIGxldCBzZWN0aW9uTGV2ZWwgPSAwO1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgc2VjdGlvbiBoZWFkaW5nXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaGVhZGluZ01hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRpbmcgPSBoZWFkaW5nTWF0Y2hbMl0udG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGhlYWRpbmcgPT09IG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSB8fCBoZWFkaW5nLmluY2x1ZGVzKG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvblN0YXJ0ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbkxldmVsID0gbGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHNlY3Rpb25TdGFydCA9PT0gLTEpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uXG4gICAgICAgIGxldCBzZWN0aW9uRW5kID0gbGluZXMubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpID0gc2VjdGlvblN0YXJ0ICsgMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrLyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2ggJiYgaGVhZGluZ01hdGNoWzFdLmxlbmd0aCA8PSBzZWN0aW9uTGV2ZWwpIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uRW5kID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGxpbmVzLnNsaWNlKHNlY3Rpb25TdGFydCwgc2VjdGlvbkVuZCkuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIuIFByb3ZpZGUgaGVscGZ1bCwgY29uY2lzZSByZXNwb25zZXMgdG8gdXNlciByZXF1ZXN0cy4gRm9jdXMgb24gYmVpbmcgcHJhY3RpY2FsIGFuZCBhY3Rpb25hYmxlLmA7XG4gICAgICAgIFxuICAgICAgICBsZXQgdXNlclByb21wdCA9IGluc3RydWN0aW9uO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBDb250ZXh0OiAke2NvbnRleHR9XFxuXFxuUmVxdWVzdDogJHtpbnN0cnVjdGlvbn1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0IHx8ICcnLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDUwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgKi9cbiAgICBidWlsZENvbnZlcnNhdGlvblByb21wdChcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ/OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdXG4gICAgKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgbGV0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIHdpdGggdGhlaXIgZG9jdW1lbnRzLiBZb3UgY2FuOlxuLSBBbnN3ZXIgcXVlc3Rpb25zIGFib3V0IHdyaXRpbmcgYW5kIGVkaXRpbmdcbi0gUHJvdmlkZSBzdWdnZXN0aW9ucyBmb3IgaW1wcm92ZW1lbnRcbi0gSGVscCBwbGFuIGRvY3VtZW50IHN0cnVjdHVyZVxuLSBBc3Npc3Qgd2l0aCByZXNlYXJjaCBhbmQgY29udGVudCBkZXZlbG9wbWVudFxuXG5CZSBoZWxwZnVsLCBjb25jaXNlLCBhbmQgcHJhY3RpY2FsIGluIHlvdXIgcmVzcG9uc2VzLmA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBtZXNzYWdlO1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBDdXJyZW50IGRvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9ICdEb2N1bWVudCBzdHJ1Y3R1cmU6XFxuJztcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgIGlmIChyZWNlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1xcblJlY2VudCBjb252ZXJzYXRpb246XFxuJztcbiAgICAgICAgICAgIHJlY2VudEhpc3Rvcnkuc2xpY2UoLTMpLmZvckVhY2gobXNnID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobXNnLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBZb3U6ICR7bXNnLmNvbnRlbnR9XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5yb2xlID09PSAnYXNzaXN0YW50Jykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBOb3ZhOiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGAke2NvbnRleHR9XFxuXFxuQ3VycmVudCBtZXNzYWdlOiAke21lc3NhZ2V9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjgsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiA4MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBlc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0aW9uOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgICAgICBjb25zdCB0b3RhbFRleHQgPSBwcm9tcHQuc3lzdGVtUHJvbXB0ICsgcHJvbXB0LnVzZXJQcm9tcHQgKyBwcm9tcHQuY29udGV4dDtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcHJvbXB0IGdlbmVyYXRpb25cbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKGBQcm9tcHQgaXMgdG9vIGxvbmcgKCR7dG9rZW5Db3VudH0gdG9rZW5zLCBtYXggODAwMClgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1RlbXBlcmF0dXJlIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdNYXggdG9rZW5zIG11c3QgYmUgYmV0d2VlbiAxMCBhbmQgNDAwMCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgaXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIENvbW1hbmQgcGFyc2VyIGZvciBOb3ZhXG4gKiBDb252ZXJ0cyBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gc3RydWN0dXJlZCBFZGl0Q29tbWFuZCBvYmplY3RzXG4gKi9cblxuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRBY3Rpb24gfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQYXR0ZXJucyBmb3IgZGV0ZWN0aW5nIGRpZmZlcmVudCBjb21tYW5kIHR5cGVzXG4gKi9cbmludGVyZmFjZSBDb21tYW5kUGF0dGVybiB7XG4gICAgYWN0aW9uOiBFZGl0QWN0aW9uO1xuICAgIHBhdHRlcm5zOiBSZWdFeHBbXTtcbiAgICB0YXJnZXRzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBDb21tYW5kIHBhcnNpbmcgcnVsZXNcbiAqL1xuY29uc3QgQ09NTUFORF9QQVRURVJOUzogQ29tbWFuZFBhdHRlcm5bXSA9IFtcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2dyYW1tYXInLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihncmFtbWFyfHNwZWxsfHNwZWxsaW5nfHByb29mcmVhZHxwb2xpc2gpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY2hlY2tcXGIuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGdyYW1tYXRpY2FsfGNvcnJlY3R8cHJvcGVyKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmZpeFxccysuKlxcYihncmFtbWFyfGVycm9yc3xtaXN0YWtlc3x0eXBvcylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJjb3JyZWN0XFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nLCAnZG9jdW1lbnQnLCAncGFyYWdyYXBoJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAncmV3cml0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHJld3JpdGV8cmV3b3JkfHJlcGhyYXNlfHJlc3RydWN0dXJlfHJlb3JnYW5pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxid3JpdGVcXHMrLipcXGIobmV3fGRpZmZlcmVudHxhbHRlcm5hdGl2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnLCAnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZGVsZXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGV8Y3V0fGVyYXNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdldFxccytyaWRcXHMrb2ZcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ0YWtlXFxzK291dFxcYi9pLFxuICAgICAgICAgICAgL1xcYmRyb3BcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxwYXJ0KVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ3NlY3Rpb24nLCAnbGluZSddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2FkZCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGUpXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8aGVhZGluZ3xjb250ZW50fHRleHR8cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnQpXFxiKD8hXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzcylcXGIpL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9ufHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXGIuKlxcYihzZWN0aW9ufGNvbnRlbnR8dGV4dClcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2VuZCcsICdzZWN0aW9uJywgJ3BhcmFncmFwaCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2VkaXQnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihlZGl0fG1vZGlmeXxjaGFuZ2V8dXBkYXRlfHJldmlzZXxpbXByb3ZlfGVuaGFuY2UpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihiZXR0ZXJ8Y2xlYXJlcnxtb3JlfGxlc3N8Zm9ybWFsfHByb2Zlc3Npb25hbHxkZXRhaWxlZHxjb21wcmVoZW5zaXZlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihmaXh8Y29ycmVjdHxhZGp1c3QpXFxiKD8hLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiKS9pLFxuICAgICAgICAgICAgL1xcYihleHBhbmR8c2hvcnRlbnxjb25kZW5zZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbicsICdzZWN0aW9uJywgJ3BhcmFncmFwaCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ21ldGFkYXRhJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5fGFkZClcXHMrLipcXGIocHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcnx0YWd8dGFncylcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoc2V0fHVwZGF0ZXxjaGFuZ2V8YWRkKVxccysuKlxcYih0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXMpXFxiL2ksXG4gICAgICAgICAgICAvXFxidXBkYXRlXFxzKy4qXFxiZnJvbnRtYXR0ZXJcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfHJlbW92ZXx1cGRhdGUpXFxzKy4qXFxidGFnW3NdP1xcYi9pLFxuICAgICAgICAgICAgL1xcYnNldFxccysuKlxcYnByb3BlcnR5XFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydkb2N1bWVudCddXG4gICAgfVxuXTtcblxuLyoqXG4gKiBMb2NhdGlvbiBleHRyYWN0aW9uIHBhdHRlcm5zXG4gKi9cbmNvbnN0IExPQ0FUSU9OX1BBVFRFUk5TID0gW1xuICAgIC9cXGIoPzp0b3xpbnxhdHx1bmRlcnx3aXRoaW58aW5zaWRlKVxccysoPzp0aGVcXHMrKT9bXCInXShbXlwiJ10rPylbXCInXVxccysoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSxcbiAgICAvXFxiKD86dGhlXFxzKyk/W1wiJ10oW15cIiddKz8pW1wiJ11cXHMrKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpL2ksXG4gICAgL1xcYig/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KVxccytbXCInXShbXlwiJ10rPylbXCInXS9pLFxuICAgIC9cXGIoPzpzZWN0aW9ufGhlYWRpbmcpXFxzKyg/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OnRoZVxccyspPyhbYS16QS1aXVthLXpBLVpcXHMmXSo/KVxccysoPzpzZWN0aW9ufGhlYWRpbmcpXFxiL2lcbl07XG5cbi8qKlxuICogVGFyZ2V0IHR5cGUgZGV0ZWN0aW9uIHBhdHRlcm5zXG4gKi9cbmNvbnN0IFRBUkdFVF9QQVRURVJOUyA9IFtcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWxlY3RlZHxoaWdobGlnaHRlZHxjaG9zZW4pXFxzKyg/OnRleHR8Y29udGVudCkvaSwgdGFyZ2V0OiAnc2VsZWN0aW9uJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OnRoaXN8Y3VycmVudHxzZWxlY3RlZClcXHMrKD86cGFyYWdyYXBofGxpbmUpL2ksIHRhcmdldDogJ3BhcmFncmFwaCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbnRpcmV8d2hvbGV8ZnVsbClcXHMrKD86ZG9jdW1lbnR8ZmlsZXxub3RlKS9pLCB0YXJnZXQ6ICdkb2N1bWVudCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbmR8Ym90dG9tfGNvbmNsdXNpb24pL2ksIHRhcmdldDogJ2VuZCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSwgdGFyZ2V0OiAnc2VjdGlvbicgfVxuXTtcblxuZXhwb3J0IGNsYXNzIENvbW1hbmRQYXJzZXIge1xuICAgIC8qKlxuICAgICAqIFBhcnNlIG5hdHVyYWwgbGFuZ3VhZ2UgaW5wdXQgaW50byBhbiBFZGl0Q29tbWFuZFxuICAgICAqL1xuICAgIHBhcnNlQ29tbWFuZChpbnB1dDogc3RyaW5nLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4gPSBmYWxzZSk6IEVkaXRDb21tYW5kIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElucHV0ID0gaW5wdXQudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIGFjdGlvbiB0eXBlXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGV0ZWN0QWN0aW9uKG5vcm1hbGl6ZWRJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIHRhcmdldCB0eXBlXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGV0ZWN0VGFyZ2V0KG5vcm1hbGl6ZWRJbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsb2NhdGlvbiBpZiBzcGVjaWZpZWRcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSB0aGlzLmV4dHJhY3RMb2NhdGlvbihpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IGZyb20gdGhlIGlucHV0XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmV4dHJhY3RDb250ZXh0KGlucHV0KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQsXG4gICAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICAgIGluc3RydWN0aW9uOiBpbnB1dCxcbiAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZSBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0QWN0aW9uKGlucHV0OiBzdHJpbmcpOiBFZGl0QWN0aW9uIHtcbiAgICAgICAgLy8gQ2hlY2sgcGF0dGVybnMgaW4gb3JkZXIgb2Ygc3BlY2lmaWNpdHlcbiAgICAgICAgZm9yIChjb25zdCBjb21tYW5kUGF0dGVybiBvZiBDT01NQU5EX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgY29tbWFuZFBhdHRlcm4ucGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tbWFuZFBhdHRlcm4uYWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGVmYXVsdCBmYWxsYmFjayBsb2dpYyB3aXRoIG1vcmUgc3BlY2lmaWMgY2hlY2tzXG4gICAgICAgIGlmICgvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8Z2VuZXJhdGUuKnNlY3Rpb24pXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnYWRkJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihmaXh8Y29ycmVjdHxncmFtbWFyfHNwZWxsfHByb29mcmVhZHxwb2xpc2gpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZ3JhbW1hcic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGUpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZGVsZXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihyZXdyaXRlfHJlcGhyYXNlfHJlc3RydWN0dXJlfGdlbmVyYXRlLipuZXcpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAncmV3cml0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5fGFkZCkuKlxcYihwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyfHRhZ3x0YWdzfHRpdGxlfGF1dGhvcnxkYXRlfHN0YXR1cylcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdtZXRhZGF0YSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgdG8gZWRpdCBmb3IgYW1iaWd1b3VzIGNhc2VzXG4gICAgICAgIHJldHVybiAnZWRpdCc7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdFRhcmdldChcbiAgICAgICAgaW5wdXQ6IHN0cmluZywgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgXG4gICAgICAgIGFjdGlvbjogRWRpdEFjdGlvblxuICAgICk6IEVkaXRDb21tYW5kWyd0YXJnZXQnXSB7XG4gICAgICAgIC8vIENoZWNrIGV4cGxpY2l0IHRhcmdldCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHRhcmdldFBhdHRlcm4gb2YgVEFSR0VUX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0UGF0dGVybi5wYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFBhdHRlcm4udGFyZ2V0IGFzIEVkaXRDb21tYW5kWyd0YXJnZXQnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ29udGV4dC1iYXNlZCB0YXJnZXQgZGV0ZWN0aW9uXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24gJiYgKGFjdGlvbiA9PT0gJ2VkaXQnIHx8IGFjdGlvbiA9PT0gJ2dyYW1tYXInIHx8IGFjdGlvbiA9PT0gJ2RlbGV0ZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3NlbGVjdGlvbic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFjdGlvbi1zcGVjaWZpYyBkZWZhdWx0c1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQuaW5jbHVkZXMoJ3NlY3Rpb24nKSB8fCBpbnB1dC5pbmNsdWRlcygnaGVhZGluZycpID8gJ3NlY3Rpb24nIDogJ2VuZCc7XG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAncGFyYWdyYXBoJztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ3NlY3Rpb24nO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdwYXJhZ3JhcGgnO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgbG9jYXRpb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RMb2NhdGlvbihpbnB1dDogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIExPQ0FUSU9OX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHBhdHRlcm4uZXhlYyhpbnB1dCk7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGFkZGl0aW9uYWwgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdENvbnRleHQoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3Qgc3R5bGUvdG9uZSBpbmRpY2F0b3JzXG4gICAgICAgIGNvbnN0IHN0eWxlSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICdmb3JtYWwnLCAnaW5mb3JtYWwnLCAnY2FzdWFsJywgJ3Byb2Zlc3Npb25hbCcsICdhY2FkZW1pYycsICd0ZWNobmljYWwnLFxuICAgICAgICAgICAgJ3NpbXBsZScsICdjb21wbGV4JywgJ2RldGFpbGVkJywgJ2JyaWVmJywgJ2NvbmNpc2UnLCAndmVyYm9zZScsXG4gICAgICAgICAgICAnZnJpZW5kbHknLCAnc2VyaW91cycsICdodW1vcm91cycsICdjcmVhdGl2ZScsICdhbmFseXRpY2FsJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZm91bmRTdHlsZXMgPSBzdHlsZUluZGljYXRvcnMuZmlsdGVyKHN0eWxlID0+IFxuICAgICAgICAgICAgaW5wdXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHlsZSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIGlmIChmb3VuZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBTdHlsZTogJHtmb3VuZFN0eWxlcy5qb2luKCcsICcpfS4gYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsZW5ndGggaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ3Nob3J0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2JyaWVmJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbmNpc2UnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnS2VlcCBpdCBicmllZi4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2xvbmcnKSB8fCBpbnB1dC5pbmNsdWRlcygnZGV0YWlsZWQnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29tcHJlaGVuc2l2ZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdQcm92aWRlIGRldGFpbGVkIGNvbnRlbnQuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3Qgc3BlY2lmaWMgcmVxdWlyZW1lbnRzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnYnVsbGV0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2xpc3QnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIGJ1bGxldCBwb2ludHMgb3IgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdleGFtcGxlJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGVzJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0luY2x1ZGUgZXhhbXBsZXMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdudW1iZXInKSB8fCBpbnB1dC5pbmNsdWRlcygnbnVtYmVyZWQnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIG51bWJlcmVkIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGV4dC50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIGEgY29tbWFuZCBjYW4gYmUgZXhlY3V0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2RlbGV0ZScgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNwZWNpZnkgd2hpY2ggc2VjdGlvbiB0byBkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24tdGFyZ2V0IGNvbWJpbmF0aW9uc1xuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdhZGQnICYmIGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0ZWQgY29tbWFuZHMgYmFzZWQgb24gY29udGV4dFxuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgaGFzSGVhZGluZ3M6IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBhIGNvbmNsdXNpb24gc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNIZWFkaW5ncykge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnQWRkIGNvbnRlbnQgdG8gdGhlIGludHJvZHVjdGlvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIHRoZSBtZXRob2RvbG9neSBzZWN0aW9uJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBtdWx0aXBsZSBjb21tYW5kcyBmcm9tIGEgc2luZ2xlIGlucHV0XG4gICAgICovXG4gICAgcGFyc2VNdWx0aXBsZUNvbW1hbmRzKGlucHV0OiBzdHJpbmcpOiBFZGl0Q29tbWFuZFtdIHtcbiAgICAgICAgLy8gU3BsaXQgb24gY29tbW9uIGNvbW1hbmQgc2VwYXJhdG9yc1xuICAgICAgICBjb25zdCBzZXBhcmF0b3JzID0gL1xcYig/OnRoZW58YWxzb3xhbmQgdGhlbnxhZnRlciB0aGF0fG5leHR8YWRkaXRpb25hbGx5KVxcYi9pO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGlucHV0LnNwbGl0KHNlcGFyYXRvcnMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnBhcnNlQ29tbWFuZChpbnB1dCldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFydHNcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5wYXJzZUNvbW1hbmQocGFydCkpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgY29tbWFuZCBkZXNjcmlwdGlvbiBmb3IgZGlzcGxheVxuICAgICAqL1xuICAgIGdldENvbW1hbmREZXNjcmlwdGlvbihjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCB0YXJnZXQsIGxvY2F0aW9uIH0gPSBjb21tYW5kO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdBZGQgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRWRpdCBleGlzdGluZyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0dlbmVyYXRlIG5ldyBzZWN0aW9ucyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChsb2NhdGlvbikge1xuICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gYCBpbiBcIiR7bG9jYXRpb259XCJgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBjdXJyZW50IHNlY3Rpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgZW5kIG9mIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9XG59IiwgIi8qKlxuICogUHJvbXB0IGJ1aWxkZXIgc2VydmljZSBmb3IgTm92YVxuICogSW50ZWdyYXRlcyBDb250ZXh0QnVpbGRlciB3aXRoIGRvY3VtZW50IGVuZ2luZSBhbmQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyLCBHZW5lcmF0ZWRQcm9tcHQgfSBmcm9tICcuL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFByb21wdCBidWlsZGluZyBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9tcHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcjtcbiAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZTtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb21tYW5kUGFyc2VyOiBDb21tYW5kUGFyc2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICAgICAgdGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgdXNlciBtZXNzYWdlIC0gZGV0ZXJtaW5lcyBpZiBpdCdzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFByb21wdEZvck1lc3NhZ2UoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgbGlrZWx5IGEgY29tbWFuZCBiYXNlZCBvbiBhY3Rpb24gd29yZHNcbiAgICAgICAgY29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5pc0xpa2VseUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNMaWtlbHlDb21tYW5kICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChwYXJzZWRDb21tYW5kLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0J3MgYSBjb252ZXJzYXRpb24gLSBidWlsZCBjb252ZXJzYXRpb24gcHJvbXB0XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbnZlcnNhdGlvblByb21wdChtZXNzYWdlLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgbWVzc2FnZSBpcyBsaWtlbHkgYSBjb21tYW5kIHZzIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICAvLyBDaGVjayBmb3IgY29tbW9uIGNvbW1hbmQgYWN0aW9uIHdvcmRzXG4gICAgICAgIGNvbnN0IGNvbW1hbmRXb3JkcyA9IFtcbiAgICAgICAgICAgICdhZGQnLCAnY3JlYXRlJywgJ3dyaXRlJywgJ2luc2VydCcsICdpbmNsdWRlJywgJ2dlbmVyYXRlJyxcbiAgICAgICAgICAgICdlZGl0JywgJ21vZGlmeScsICdjaGFuZ2UnLCAndXBkYXRlJywgJ3JldmlzZScsICdpbXByb3ZlJywgJ2VuaGFuY2UnLFxuICAgICAgICAgICAgJ2RlbGV0ZScsICdyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2N1dCcsICdlcmFzZScsXG4gICAgICAgICAgICAnZml4JywgJ2NvcnJlY3QnLCAnZ3JhbW1hcicsICdzcGVsbCcsICdwcm9vZnJlYWQnLCAncG9saXNoJyxcbiAgICAgICAgICAgICdyZXdyaXRlJywgJ3Jld29yZCcsICdyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZW9yZ2FuaXplJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gY29tbWFuZFdvcmRzLnNvbWUod29yZCA9PiBsb3dlck1lc3NhZ2UuaW5jbHVkZXMod29yZCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb21tYW5kUHJvbXB0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIGlzIHJlcXVpcmVkIGZvciBjb21tYW5kIHByb21wdHMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBsZXQgY29udmVyc2F0aW9uQ29udGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAob3B0aW9ucy5pbmNsdWRlSGlzdG9yeSkge1xuICAgICAgICAgICAgY29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNSk7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5mb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KHJlY2VudE1lc3NhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBwcm9tcHRcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBvcHRpb25zLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGNvbnZlcnNhdGlvbiAobm9uLWNvbW1hbmQgbWVzc2FnZXMpXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCB8IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdO1xuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0IGlmIGZpbGUgaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgICAgICByZWNlbnRIaXN0b3J5ID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQobWVzc2FnZSwgZG9jdW1lbnRDb250ZXh0LCByZWNlbnRIaXN0b3J5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBzaW1wbGUgcHJvbXB0IGZvciBiYXNpYyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb246IHN0cmluZywgY29udGV4dD86IHN0cmluZyk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZG9jdW1lbnQgY29udGV4dCBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dD4ge1xuICAgICAgICAvLyBVc2UgdGhlIGRvY3VtZW50IGVuZ2luZSdzIGJ1aWx0LWluIGNvbnRleHQgZ2F0aGVyaW5nXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjazogY3JlYXRlIG1pbmltYWwgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZW50KCkgfHwgJyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBoZWFkaW5nczogW10sXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSBjb250ZXh0IGFzLWlzLCBzaW5jZSBpdCdzIGFscmVhZHkgaW4gdGhlIGNvcnJlY3QgZm9ybWF0XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb252ZXJzYXRpb24gaGlzdG9yeSBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShtZXNzYWdlczogQ29udmVyc2F0aW9uTWVzc2FnZVtdKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnO1xuXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSAnUkVDRU5UIENPTlZFUlNBVElPTjpcXG4nO1xuICAgICAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCByb2xlID0gbXNnLnJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogJ05vdmEnO1xuICAgICAgICAgICAgZm9ybWF0dGVkICs9IGAke3JvbGV9OiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIG9wdGltaXplIHByb21wdCBiZWZvcmUgc2VuZGluZyB0byBBSVxuICAgICAqL1xuICAgIHZhbGlkYXRlQW5kT3B0aW1pemVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Byb21wdCB2YWxpZGF0aW9uIGlzc3VlczonLCB2YWxpZGF0aW9uLmlzc3Vlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBmaXggY29tbW9uIGlzc3Vlc1xuICAgICAgICAgICAgbGV0IG9wdGltaXplZFByb21wdCA9IHsgLi4ucHJvbXB0IH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRydW5jYXRlIGlmIHRvbyBsb25nXG4gICAgICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5jb250ZXh0QnVpbGRlci5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICh0b2tlbkNvdW50ID4gODAwMCkge1xuICAgICAgICAgICAgICAgIC8vIFJlZHVjZSBjb250ZXh0IHNpemUgbW9yZSBhZ2dyZXNzaXZlbHlcbiAgICAgICAgICAgICAgICBjb25zdCBtYXhDb250ZXh0TGVuZ3RoID0gTWF0aC5mbG9vcihwcm9tcHQuY29udGV4dC5sZW5ndGggKiAwLjYpO1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb250ZXh0ID0gcHJvbXB0LmNvbnRleHQuc3Vic3RyaW5nKDAsIG1heENvbnRleHRMZW5ndGgpICsgJ1xcbltDb250ZXh0IHRydW5jYXRlZC4uLl0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCB0ZW1wZXJhdHVyZVxuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPCAwIHx8IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPiAxKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHByb21wdC5jb25maWcudGVtcGVyYXR1cmUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgbWF4IHRva2Vuc1xuICAgICAgICAgICAgaWYgKHByb21wdC5jb25maWcubWF4VG9rZW5zIDwgMTAgfHwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPiA0MDAwKSB7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPSBNYXRoLm1heCgxMCwgTWF0aC5taW4oNDAwMCwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIG9wdGltaXplZFByb21wdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRva2VuIGNvdW50IGVzdGltYXRlIGZvciBhIHByb21wdFxuICAgICAqL1xuICAgIGdldFRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgcHJvbXB0IGZvciBhIHNwZWNpZmljIGFjdGlvbiB3aXRoIG1pbmltYWwgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkUXVpY2tQcm9tcHQoXG4gICAgICAgIGFjdGlvbjogRWRpdENvbW1hbmRbJ2FjdGlvbiddLFxuICAgICAgICBpbnN0cnVjdGlvbjogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBjb25zdCBjb21tYW5kOiBFZGl0Q29tbWFuZCA9IHtcbiAgICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICAgIHRhcmdldDogJ2RvY3VtZW50JyxcbiAgICAgICAgICAgIGluc3RydWN0aW9uLFxuICAgICAgICAgICAgbG9jYXRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQoY29tbWFuZCwgZmlsZSwgeyBcbiAgICAgICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDEwLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IHdpdGggY3VzdG9tIHN5c3RlbSBwcm9tcHQgb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZEN1c3RvbVByb21wdChcbiAgICAgICAgc3lzdGVtUHJvbXB0OiBzdHJpbmcsXG4gICAgICAgIHVzZXJNZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICBjb250ZXh0ID0gYERvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdDogdXNlck1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogQWRkIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgYWRkaW5nIG5ldyBjb250ZW50IHRvIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFkZENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGVkaXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZXRlcm1pbmVJbnNlcnRQb3NpdGlvbihjb21tYW5kLCBkb2N1bWVudENvbnRleHQpLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gYWRkIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmUgd2hlcmUgdG8gaW5zZXJ0IG5ldyBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBkZXRlcm1pbmVJbnNlcnRQb3NpdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dFxuICAgICk6IFByb21pc2U8J2N1cnNvcicgfCAnc2VsZWN0aW9uJyB8ICdlbmQnIHwgeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfT4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjayB0byBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCBhdCB0aGUgZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuICdlbmQnO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFkZCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBBZGQgY29tbWFuZCBjYW5ub3QgdGFyZ2V0IHNlbGVjdGlvblxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBhZGQgY29udGVudCB0byBhIHNlbGVjdGlvbi4gVXNlIFwiZWRpdFwiIHRvIG1vZGlmeSBzZWxlY3RlZCB0ZXh0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRhcmdldGluZyBhIHNlY3Rpb24sIGxvY2F0aW9uIHNob3VsZCBiZSBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiAhY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgLy8gVGhpcyBpcyBzdGlsbCB2YWxpZCAtIHdlJ2xsIGFkZCB0byBjdXJyZW50IHNlY3Rpb24gb3IgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGlvbnMgZm9yIGFkZCBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXG4gICAgICAgICAgICAnQWRkIGEgY29uY2x1c2lvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICdDcmVhdGUgYSBzdW1tYXJ5JyxcbiAgICAgICAgICAgICdBZGQgZXhhbXBsZXMnLFxuICAgICAgICAgICAgJ0NyZWF0ZSBhIG1ldGhvZG9sb2d5IHNlY3Rpb24nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnMgYmFzZWQgb24gZXhpc3RpbmcgaGVhZGluZ3NcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uTmFtZXMgPSBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubWFwKGggPT4gaC50ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaW50cm9kdWN0aW9uJykpKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMudW5zaGlmdCgnQWRkIGFuIGludHJvZHVjdGlvbiBzZWN0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghc2VjdGlvbk5hbWVzLnNvbWUobmFtZSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NvbmNsdXNpb24nKSkpIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgYSBjb25jbHVzaW9uIHNlY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc3VtbWFyeScpKSkge1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0FkZCBhIHN1bW1hcnkgc2VjdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDgpOyAvLyBMaW1pdCB0byA4IHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IGNvbnRlbnQgd291bGQgYmUgYWRkZWQgKHdpdGhvdXQgYWN0dWFsbHkgYWRkaW5nIGl0KVxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIHBvc2l0aW9uPzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHdoZXJlIGNvbnRlbnQgd291bGQgYmUgcGxhY2VkXG4gICAgICAgICAgICBsZXQgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSBgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICdpbiB0aGUgY3VycmVudCBzZWN0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogYFdpbGwgYWRkIG5ldyBjb250ZW50ICR7cG9zaXRpb25EZXNjcmlwdGlvbn1gLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbkRlc2NyaXB0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBFZGl0IGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgbW9kaWZ5aW5nIGFuZCBpbXByb3ZpbmcgZXhpc3RpbmcgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBlZGl0IGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGVkaXQgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBlbnRpcmUgc2VjdGlvbiBjb250ZW50IChleGNsdWRpbmcgaGVhZGluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHRvIHJlcGxhY2UgZnJvbSBoZWFkaW5nIGxpbmUgdG8gc2VjdGlvbiBlbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgZWRpdCBjb21tYW5kcyB0YXJnZXRpbmcgZW5kLCB0cmVhdCBhcyBhZGRpbmcgdG8gZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBlZGl0IHRhcmdldCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZWRpdCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIGxvY2F0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgcHJvdmlkZWQgZm9yIHNlY3Rpb24gZWRpdHNcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdlZGl0JyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiBlZGl0c1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBlZGl0IGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGRldGFpbGVkJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBjbGFyaXR5IGFuZCBmbG93JyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgZm9ybWFsJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgdGhpcyB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIG9uIHRoaXMgcG9pbnQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBlbmdhZ2luZydcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdJbXByb3ZlIHRoZSB3cml0aW5nIHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgZG9jdW1lbnQgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFbmhhbmNlIGNsYXJpdHkgdGhyb3VnaG91dCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgdGhlIGludHJvZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgJ1BvbGlzaCB0aGUgY29uY2x1c2lvbicsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBjb25jaXNlJyxcbiAgICAgICAgICAgICAgICAnQWRkIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSB0aGUgZmxvdyBiZXR3ZWVuIHNlY3Rpb25zJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBJbXByb3ZlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCAxMCk7IC8vIExpbWl0IHRvIDEwIHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IHdvdWxkIGJlIGVkaXRlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBhZmZlY3RlZENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGxldCBwcmV2aWV3VGV4dCA9ICcnO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgdGhlIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGVkaXQgdGhlIGVudGlyZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uPy5saW5lID8/IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGFkZCBlZGl0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVkaXQgdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZWRpdCB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGNoYW5nZXNcbiAgICAgKi9cbiAgICBhc3luYyBlc3RpbWF0ZVNjb3BlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgbGluZXNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBzY29wZURlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBzZWN0aW9uLmNvbnRlbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IHNlY3Rpb24ucmFuZ2UuZW5kIC0gc2VjdGlvbi5yYW5nZS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDsgLy8gTmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ05ldyBjb250ZW50IGF0IGVuZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogRGVsZXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgcmVtb3ZpbmcgY29udGVudCBmcm9tIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHNtYXJ0IGRlbGV0aW9uLCB3ZSBtYXkgbmVlZCBBSSB0byBkZXRlcm1pbmUgd2hhdCB0byBkZWxldGVcbiAgICAgICAgICAgIGlmIChjb21tYW5kLmluc3RydWN0aW9uICYmIGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB0byBpZGVudGlmeSB3aGF0IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBc2sgQUkgd2hhdCBjb250ZW50IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGRldGVybWluZSBkZWxldGlvbiBhY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIE1WUCwgd2UnbGwgcHJvY2VlZCB3aXRoIHRoZSB0YXJnZXQtYmFzZWQgZGVsZXRpb25cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBhbmFseXNpcyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBkZWxldGlvbiByZXN1bHQgKG9ubHkgZmFpbHVyZXMpXG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwICYmICFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZGVsZXRpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RGVsZXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHRcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZGVsZXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgZW50aXJlIHNlY3Rpb24gaW5jbHVkaW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3Igc2VjdGlvbiBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgcGFyYWdyYXBoIGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXMgKGVtcHR5IGxpbmVzIG9yIGhlYWRpbmcgbWFya2VycylcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudCgnJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGNvbnRlbnQgZnJvbSBlbmQgLSBub3QgbWVhbmluZ2Z1bCBmb3IgZGVsZXRlIGNvbW1hbmRcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LicsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZGVsZXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgZm9yIHNlY3Rpb24gZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnU2VjdGlvbiBuYW1lIHJlcXVpcmVkIGZvciBzZWN0aW9uIGRlbGV0aW9uJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIHRhcmdldCBpcyBhcHByb3ByaWF0ZSBmb3IgZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnZW5kJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgZGVsZXRlIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnUmVtb3ZlIHRoaXMgY29udGVudCcsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHRoZSBzZWxlY3Rpb24nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ1JlbW92ZSBlbXB0eSBzZWN0aW9ucycsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHJlZHVuZGFudCBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAnRGVsZXRlIGR1cGxpY2F0ZSBpbmZvcm1hdGlvbidcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIGRlbGV0aW9uIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChgRGVsZXRlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCA4KTsgLy8gTGltaXQgdG8gOCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBkZWxldGVkXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGFmZmVjdGVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgbGV0IHByZXZpZXdUZXh0ID0gJyc7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IGlzIGN1cnJlbnRseSBzZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtzZWN0aW9uLmNvbnRlbnR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGRlbGV0ZSB0aGUgZW50aXJlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3IgcHJldmlldydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGRlbGV0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY3VycmVudCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFncmFwaExpbmVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHN0YXJ0IG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2TGluZS50cmltKCkgPT09ICcnIHx8IHByZXZMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5lLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgZW5kIG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dExpbmUgPSBlZGl0b3IuZ2V0TGluZShlbmRMaW5lICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydExpbmU7IGkgPD0gZW5kTGluZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaExpbmVzLnB1c2goZWRpdG9yLmdldExpbmUoaSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBwYXJhZ3JhcGhMaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIGFsbCBkb2N1bWVudCBjb250ZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgZnJvbSBlbmQgb2YgZG9jdW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRpb24gdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGVsZXRlIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnXTtcblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgdGFyZ2V0cy51bnNoaWZ0KCdzZWxlY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoLTEsIDAsICdzZWN0aW9uJyk7IC8vIEluc2VydCBiZWZvcmUgJ2RvY3VtZW50J1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGRlbGV0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogJ05vIGRvY3VtZW50IGF2YWlsYWJsZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aCArIHNlY3Rpb24uaGVhZGluZy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0ludmFsaWQgdGFyZ2V0IGZvciBkZWxldGlvbic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogR3JhbW1hciBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGdyYW1tYXIgY2hlY2tpbmcgYW5kIGNvcnJlY3Rpb24gb2YgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdyYW1tYXJDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uIHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb24gZm9yIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcnJlY3RlZENvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLCAvLyBMb3dlciB0ZW1wZXJhdHVyZSBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29ycmVjdGVkQ29udGVudCB8fCBjb3JyZWN0ZWRDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb3JyZWN0ZWQgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5R3JhbW1hckNvcnJlY3Rpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb3JyZWN0ZWRDb250ZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gY29ycmVjdCBncmFtbWFyJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdHcmFtbWFyIGNvcnJlY3Rpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlHcmFtbWFyQ29ycmVjdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29ycmVjdGVkQ29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb3JyZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlY3Rpb24gY29udGVudCB3aGlsZSBwcmVzZXJ2aW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29ycmVjdGVkQ29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3U2VjdGlvbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3U2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZhbGwgdGhyb3VnaCB0byBwYXJhZ3JhcGggaWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCBjb3JyZWN0ZWQgY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29ycmVjdGVkQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvcnJlY3RlZENvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciBncmFtbWFyIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyBjb3JyZWN0ZWQgY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3Igc2VjdGlvbiB0YXJnZXRzLCBsb2NhdGlvbiBzaG91bGQgYmUgcHJvdmlkZWQgZm9yIGJldHRlciBhY2N1cmFjeVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2dyYW1tYXInICYmIGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIC8vIExvY2F0aW9uIGlzIHByb3ZpZGVkLCB3aGljaCBpcyBnb29kIGZvciBzZWN0aW9uIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBncmFtbWFyIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXIgaW4gc2VsZWN0ZWQgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ0NvcnJlY3Qgc3BlbGxpbmcgYW5kIHB1bmN0dWF0aW9uJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUnLFxuICAgICAgICAgICAgICAgICdGaXggY2FwaXRhbGl6YXRpb24gZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCB2ZXJiIHRlbnNlcycsXG4gICAgICAgICAgICAgICAgJ0ZpeCBzdWJqZWN0LXZlcmIgYWdyZWVtZW50JyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSByZWFkYWJpbGl0eSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdDaGVjayBncmFtbWFyIHRocm91Z2hvdXQgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdGaXggc3BlbGxpbmcgZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCBwdW5jdHVhdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgc2VudGVuY2Ugc3RydWN0dXJlJyxcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXRpY2FsIGVycm9ycyBpbiBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ0NoZWNrIGZvciBjb21tb24gbWlzdGFrZXMnLFxuICAgICAgICAgICAgICAgICdQcm9vZnJlYWQgdGhlIGRvY3VtZW50J1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgZ3JhbW1hciBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYENoZWNrIGdyYW1tYXIgaW4gXCIke2hlYWRpbmcudGV4dH1cIiBzZWN0aW9uYCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgMTApOyAvLyBMaW1pdCB0byAxMCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBncmFtbWFyLWNvcnJlY3RlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgcG90ZW50aWFsSXNzdWVzPzogc3RyaW5nW107XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHBvdGVudGlhbElzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGluIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmFzaWMgZ3JhbW1hciBpc3N1ZSBkZXRlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhMaW5lczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnRMaW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ291bnQgPSBlZGl0b3IubGluZUNvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dExpbmUudHJpbSgpID09PSAnJyB8fCBuZXh0TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRMaW5lOyBpIDw9IGVuZExpbmU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGhMaW5lcy5wdXNoKGVkaXRvci5nZXRMaW5lKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gcGFyYWdyYXBoTGluZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgdGhyb3VnaG91dCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBhZGQgZ3JhbW1hci1jb3JyZWN0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3VlczogcG90ZW50aWFsSXNzdWVzLnNsaWNlKDAsIDUpIC8vIExpbWl0IHRvIDUgaXNzdWVzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdCBwb3RlbnRpYWwgZ3JhbW1hciBpc3N1ZXMgaW4gdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0UG90ZW50aWFsSXNzdWVzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQmFzaWMgcGF0dGVybiBtYXRjaGluZyBmb3IgY29tbW9uIGlzc3Vlc1xuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYmlcXHMvZ2ksIGlzc3VlOiAnTG93ZXJjYXNlIFwiaVwiIHNob3VsZCBiZSBjYXBpdGFsaXplZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcLlxccypbYS16XS9nLCBpc3N1ZTogJ1NlbnRlbmNlIHNob3VsZCBzdGFydCB3aXRoIGNhcGl0YWwgbGV0dGVyJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHNwYWNlcyBkZXRlY3RlZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1suIT9dezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHB1bmN0dWF0aW9uIG1hcmtzJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzK1suIT8sOjtdL2csIGlzc3VlOiAnU3BhY2UgYmVmb3JlIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvWy4hP11cXHcvZywgaXNzdWU6ICdNaXNzaW5nIHNwYWNlIGFmdGVyIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxidGVoXFxiL2dpLCBpc3N1ZTogJ0NvbW1vbiB0eXBvOiBcInRlaFwiIHNob3VsZCBiZSBcInRoZVwiJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxiYW5kXFxzK2FuZFxcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJhbmRcIicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYnRoZVxccyt0aGVcXGIvZ2ksIGlzc3VlOiAnRHVwbGljYXRlIFwidGhlXCInIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXGJpc1xccytpc1xcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJpc1wiJyB9XG4gICAgICAgIF07XG5cbiAgICAgICAgcGF0dGVybnMuZm9yRWFjaCgoeyBwYXR0ZXJuLCBpc3N1ZSB9KSA9PiB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KHRleHQpKSB7XG4gICAgICAgICAgICAgICAgaXNzdWVzLnB1c2goaXNzdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaXNzdWVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBncmFtbWFyIGNoZWNrIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnLCAnZW5kJ107XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgIHRhcmdldHMudW5zaGlmdCgnc2VsZWN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRhcmdldHMuc3BsaWNlKC0yLCAwLCAnc2VjdGlvbicpOyAvLyBJbnNlcnQgYmVmb3JlICdkb2N1bWVudCcgYW5kICdlbmQnXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGFyZ2V0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0aGUgc2NvcGUgb2YgZ3JhbW1hciBjb3JyZWN0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgICBlc3RpbWF0ZWRJc3N1ZXM6IG51bWJlcjtcbiAgICB9PiB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb246ICdObyBkb2N1bWVudCBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZElzc3VlczogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIGxldCBjb250ZW50VG9BbmFseXplID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBzZWN0aW9uLnJhbmdlLmVuZCAtIHNlY3Rpb24ucmFuZ2Uuc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gYFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAvLyBFc3RpbWF0ZSBzaW5nbGUgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMTAwOyAvLyBSb3VnaCBlc3RpbWF0ZVxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAxO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnQ3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgIC8vIEZvciBlc3RpbWF0aW9uIHB1cnBvc2VzLCB1c2Ugc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7IC8vIE5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdOZXcgY29udGVudCBhdCBlbmQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXN0aW1hdGUgcG90ZW50aWFsIGlzc3Vlc1xuICAgICAgICBjb25zdCBlc3RpbWF0ZWRJc3N1ZXMgPSB0aGlzLmRldGVjdFBvdGVudGlhbElzc3Vlcyhjb250ZW50VG9BbmFseXplKS5sZW5ndGg7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgZXN0aW1hdGVkSXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIFJld3JpdGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZXdyaXRpbmcgY29udGVudCB3aXRoIGRpZmZlcmVudCBzdHlsZXMgYW5kIGFwcHJvYWNoZXNcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgZm9yIHJld3JpdGluZyB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uIGZvciByZXdyaXRpbmdcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXdyaXR0ZW5Db250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFyZXdyaXR0ZW5Db250ZW50IHx8IHJld3JpdHRlbkNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIHJld3JpdHRlbiBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgcmV3cml0ZSBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmV3cml0ZShjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Jld3JpdGUgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcmV3cml0ZSBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlSZXdyaXRlKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICByZXdyaXR0ZW5Db250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugc2VjdGlvbiBjb250ZW50IHdoaWxlIHByZXNlcnZpbmcgaGVhZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3U2VjdGlvbkNvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtyZXdyaXR0ZW5Db250ZW50fWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgcmV3cml0ZSB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCByZXdyaXR0ZW4gY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UocmV3cml0dGVuQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciByZXdyaXRlIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyByZXdyaXR0ZW4gY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJld3JpdGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSByZXdyaXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIHNlY3Rpb24gdGFyZ2V0cywgbG9jYXRpb24gc2hvdWxkIGJlIHByb3ZpZGVkIGZvciBiZXR0ZXIgYWNjdXJhY3lcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdyZXdyaXRlJyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiByZXdyaXRpbmdcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgcmV3cml0ZSBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYSBtb3JlIGZvcm1hbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBpbiBhIGNhc3VhbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCB3aXRoIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBmb3IgY2xhcml0eScsXG4gICAgICAgICAgICAgICAgJ1NpbXBsaWZ5IHRoZSBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBlbmdhZ2luZycsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYnVsbGV0IHBvaW50cycsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbmFycmF0aXZlIGZvcm0nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnLFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGluIGEgZGlmZmVyZW50IHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgd3JpdGluZyBtb3JlIGVuZ2FnaW5nJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgY29tcGxleCBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgZm9yIGRpZmZlcmVudCBhdWRpZW5jZScsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbW9yZSBmb3JtYWwgdG9uZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhlIGNvbnRlbnQgbW9yZSBjb25jaXNlJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgcmV3cml0ZSBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYFJld3JpdGUgdGhlIFwiJHtoZWFkaW5nLnRleHR9XCIgc2VjdGlvbmApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDEwKTsgLy8gTGltaXQgdG8gMTAgc3VnZ2VzdGlvbnNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2aWV3IHdoYXQgd291bGQgYmUgcmV3cml0dGVuXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICByZXdyaXRlU3R5bGU/OiBzdHJpbmc7XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHJld3JpdGVTdHlsZSA9IHRoaXMuaW5mZXJSZXdyaXRlU3R5bGUoY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgc2VsZWN0ZWQgdGV4dGA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBpcyBjdXJyZW50bHkgc2VsZWN0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gc2VjdGlvbi5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIHJld3JpdGUgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXdyaXRlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ICs9IGAgKCR7cmV3cml0ZVN0eWxlfSlgO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYWdyYXBoTGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBwYXJhZ3JhcGggYm91bmRhcmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkxpbmUgPSBlZGl0b3IuZ2V0TGluZShzdGFydExpbmUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChlbmRMaW5lIDwgbGluZUNvdW50IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0TGluZTsgaSA8PSBlbmRMaW5lOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYWdyYXBoTGluZXMucHVzaChlZGl0b3IuZ2V0TGluZShpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHBhcmFncmFwaExpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgYWRkIHJld3JpdHRlbiBjb250ZW50IGF0IHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmV3cml0ZSB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHJld3JpdGVTdHlsZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmZlciByZXdyaXRlIHN0eWxlIGZyb20gaW5zdHJ1Y3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGluZmVyUmV3cml0ZVN0eWxlKGluc3RydWN0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdmb3JtYWwnKSkgcmV0dXJuICdmb3JtYWwgdG9uZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjYXN1YWwnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdpbmZvcm1hbCcpKSByZXR1cm4gJ2Nhc3VhbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2NvbmNpc2UnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdzaG9ydGVyJykpIHJldHVybiAnbW9yZSBjb25jaXNlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2V4cGFuZCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2RldGFpbCcpKSByZXR1cm4gJ21vcmUgZGV0YWlsZWQnO1xuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxlJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxpZnknKSkgcmV0dXJuICdzaW1wbGlmaWVkIGxhbmd1YWdlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2VuZ2FnaW5nJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnaW50ZXJlc3RpbmcnKSkgcmV0dXJuICdtb3JlIGVuZ2FnaW5nJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3Byb2Zlc3Npb25hbCcpKSByZXR1cm4gJ3Byb2Zlc3Npb25hbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2J1bGxldCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2xpc3QnKSkgcmV0dXJuICdidWxsZXQgcG9pbnQgZm9ybWF0JztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ25hcnJhdGl2ZScpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3N0b3J5JykpIHJldHVybiAnbmFycmF0aXZlIHN0eWxlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3RlY2huaWNhbCcpKSByZXR1cm4gJ3RlY2huaWNhbCBzdHlsZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjcmVhdGl2ZScpKSByZXR1cm4gJ2NyZWF0aXZlIHN0eWxlJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmV3cml0ZSB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIHJld3JpdGluZ1xuICAgICAqL1xuICAgIGFzeW5jIGVzdGltYXRlU2NvcGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBsaW5lc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIHNjb3BlRGVzY3JpcHRpb246IHN0cmluZztcbiAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICByZXdyaXRlQ29tcGxleGl0eTogJ2xvdydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBsZXQgY29udGVudFRvQW5hbHl6ZSA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IHNlY3Rpb24uY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9IGBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAvLyBGb3IgZXN0aW1hdGlvbiBwdXJwb3NlcywgdXNlIHN1cnJvdW5kaW5nIGNvbnRleHRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5qb2luKCdcXG4nKSArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xcbicgKyBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwOyAvLyBOZXcgY29udGVudFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnTmV3IGNvbnRlbnQgYXQgZW5kJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERldGVybWluZSByZXdyaXRlIGNvbXBsZXhpdHkgYmFzZWQgb24gY29udGVudCBsZW5ndGggYW5kIGluc3RydWN0aW9uXG4gICAgICAgIGNvbnN0IHJld3JpdGVDb21wbGV4aXR5ID0gdGhpcy5lc3RpbWF0ZUNvbXBsZXhpdHkoY29udGVudFRvQW5hbHl6ZSwgY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSByZXdyaXRlIGNvbXBsZXhpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlQ29tcGxleGl0eShjb250ZW50OiBzdHJpbmcsIGluc3RydWN0aW9uOiBzdHJpbmcpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHtcbiAgICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IGNvbnRlbnQubGVuZ3RoO1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEJhc2UgY29tcGxleGl0eSBvbiBjb250ZW50IGxlbmd0aFxuICAgICAgICBsZXQgY29tcGxleGl0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyA9ICdsb3cnO1xuICAgICAgICBpZiAoY29udGVudExlbmd0aCA+IDEwMDApIGNvbXBsZXhpdHkgPSAnaGlnaCc7XG4gICAgICAgIGVsc2UgaWYgKGNvbnRlbnRMZW5ndGggPiAzMDApIGNvbXBsZXhpdHkgPSAnbWVkaXVtJztcbiAgICAgICAgXG4gICAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBpbnN0cnVjdGlvbiBjb21wbGV4aXR5XG4gICAgICAgIGNvbnN0IGNvbXBsZXhJbnN0cnVjdGlvbnMgPSBbXG4gICAgICAgICAgICAncmVzdHJ1Y3R1cmUnLCAncmVvcmdhbml6ZScsICdjb21wbGV0ZWx5IHJld3JpdGUnLCAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgICdjaGFuZ2Ugc3R5bGUnLCAnZGlmZmVyZW50IGF1ZGllbmNlJywgJ3RlY2huaWNhbCcsICdhY2FkZW1pYydcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb21wbGV4SW5zdHJ1Y3Rpb25zLnNvbWUodGVybSA9PiBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKHRlcm0pKSkge1xuICAgICAgICAgICAgaWYgKGNvbXBsZXhpdHkgPT09ICdsb3cnKSBjb21wbGV4aXR5ID0gJ21lZGl1bSc7XG4gICAgICAgICAgICBlbHNlIGlmIChjb21wbGV4aXR5ID09PSAnbWVkaXVtJykgY29tcGxleGl0eSA9ICdoaWdoJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbXBsZXhpdHk7XG4gICAgfVxufSIsICIvKipcbiAqIE1ldGFkYXRhIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogSGFuZGxlcyB1cGRhdGluZyBkb2N1bWVudCBwcm9wZXJ0aWVzL2Zyb250bWF0dGVyXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEhhbmRsZXMgbWV0YWRhdGEvcHJvcGVydHkgdXBkYXRlIGNvbW1hbmRzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBtZXRhZGF0YSB1cGRhdGUgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0gdGhpcy5wYXJzZVByb3BlcnR5VXBkYXRlcyhhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlcyB8fCBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBwcm9wZXJ0eSB1cGRhdGVzIGZvdW5kIGluIEFJIHJlc3BvbnNlJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFdyaXRlIHRoZSB1cGRhdGVkIGNvbnRlbnQgYmFjayB0byB0aGUgZmlsZSBkaXJlY3RseVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGRvY3VtZW50Q29udGV4dC5maWxlLCB1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byB1cGRhdGUgbWV0YWRhdGE6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VQcm9wZXJ0eVVwZGF0ZXMocmVzcG9uc2U6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OIGZpcnN0XG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIFlBTUwtbGlrZSBmb3JtYXRcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAvLyBNYXRjaCBwYXR0ZXJucyBsaWtlIFwia2V5OiB2YWx1ZVwiIG9yIFwiLSBrZXk6IHZhbHVlXCJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL15bLVxcc10qKFteOl0rKTpcXHMqKC4rKSQvKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdmFsdWUgYXMgSlNPTiAoZm9yIGFycmF5cy9vYmplY3RzKVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBub3QgSlNPTiwgdHJlYXQgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVvdGVzIGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuc3RhcnRzV2l0aCgnXCInKSAmJiB2YWx1ZS5lbmRzV2l0aCgnXCInKSkgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlLnN0YXJ0c1dpdGgoXCInXCIpICYmIHZhbHVlLmVuZHNXaXRoKFwiJ1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID4gMCA/IHVwZGF0ZXMgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHByb3BlcnR5IHVwZGF0ZXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyIGluIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZywgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBmcm9udG1hdHRlciBleGlzdHNcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY2xvc2luZyAtLS1cbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlbmRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvcHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZEluZGV4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9wc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgdXBkYXRlcyB3aXRoIGV4aXN0aW5nIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IHsgLi4uZXhpc3RpbmdQcm9wcywgLi4udXBkYXRlcyB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlYnVpbGQgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobWVyZ2VkUHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIG51bGwvdW5kZWZpbmVkIHZhbHVlcyAoYWxsb3dzIGRlbGV0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goJy0tLScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugb2xkIGZyb250bWF0dGVyIHdpdGggbmV3XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgLi4ubmV3RnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKGVuZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBleGlzdHMsIGNyZWF0ZSBuZXdcbiAgICAgICAgY29uc3QgbmV3RnJvbnRtYXR0ZXIgPSBbJy0tLSddO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZyb250bWF0dGVyIHRvIGJlZ2lubmluZyBvZiBkb2N1bWVudFxuICAgICAgICByZXR1cm4gbmV3RnJvbnRtYXR0ZXIuam9pbignXFxuJykgKyBjb250ZW50O1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBzdXBlcm5vdmFEYXRlOiBzdHJpbmc7ICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGdlbmVyYWxEYXRlOiBzdHJpbmc7ICAgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIEZlYXR1cmUgcmVsZWFzZSBjb25maWd1cmF0aW9uIGZvciBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIG1vZGVsXG4gKiBTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gc3VwZXJub3ZhRGF0ZVxuICogQWxsIHVzZXJzIGdldCBmZWF0dXJlcyBvbiBnZW5lcmFsRGF0ZVxuICogXG4gKiBEYXRlcyBhcmUgaW4gWVlZWS1NTS1ERCBmb3JtYXQgYW5kIGVhc3kgdG8gbW9kaWZ5IHBvc3QtbGF1bmNoXG4gKi9cbmV4cG9ydCBjb25zdCBTVVBFUk5PVkFfRkVBVFVSRVM6IFJlY29yZDxzdHJpbmcsIFRpbWVHYXRlZEZlYXR1cmU+ID0ge1xuICAgIC8vIENvbW1hbmQgc3lzdGVtIC0gMyBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnY29tbWFuZC1zeXN0ZW0nOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA5LTE1JywgICAvLyAzIG1vbnRocyBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbW1hbmQgc3lzdGVtIHdpdGggOiB0cmlnZ2VycyBhbmQgcHJvdmlkZXIgc3dpdGNoaW5nJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gTXVsdGktZG9jdW1lbnQgY29udGV4dCAtIDIgbW9udGggZWFybHkgYWNjZXNzICBcbiAgICAnbXVsdGktZG9jLWNvbnRleHQnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA4LTE1JywgICAvLyAyIG1vbnRocyBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1JlZmVyZW5jZSBvdGhlciBkb2N1bWVudHMgd2l0aCBbW2RvY11dIHN5bnRheCdcbiAgICB9LFxuICAgIFxuICAgIC8vIEF1dG8tZ3Jvd2luZyBpbnB1dCAtIDEgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2F1dG8taW5wdXQnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA3LTE1JywgICAvLyAxIG1vbnRoIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0by1ncm93aW5nIGlucHV0IGFyZWEgd2l0aCBzbW9vdGggdHJhbnNpdGlvbnMnXG4gICAgfSxcbiAgICBcbiAgICAvLyBDb21tYW5kIGJ1dHRvbiAtIDIgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmQtYnV0dG9uJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOC0xNScsICAgLy8gMiBtb250aHMgbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb21tYW5kIGJ1dHRvbiBmb3IgbW9iaWxlIGFuZCBkaXNjb3ZlcnknXG4gICAgfSxcbiAgICBcbiAgICAvLyBDdXN0b20gY29tbWFuZHMgLSAzLjUgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2N1c3RvbS1jb21tYW5kcyc6IHtcbiAgICAgICAgc3VwZXJub3ZhRGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMTAtMDEnLCAgIC8vIEF2YWlsYWJsZSB0byBhbGwgT2N0IDEsIDIwMjVcbiAgICAgICAgZGVzY3JpcHRpb246ICdVc2VyLWRlZmluZWQgY3VzdG9tIGNvbW1hbmQgc2hvcnRjdXRzJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gRW5oYW5jZWQgcHJvdmlkZXIgbWFuYWdlbWVudCAtIDIgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2VuaGFuY2VkLXByb3ZpZGVycyc6IHtcbiAgICAgICAgc3VwZXJub3ZhRGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDgtMTUnLCAgIC8vIDIgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWR2YW5jZWQgcHJvdmlkZXIgY29uZmlndXJhdGlvbiBhbmQgc3dpdGNoaW5nJ1xuICAgIH1cbn07XG5cbi8qKlxuICogQ29yZSBmZWF0dXJlcyB0aGF0IGFyZSBhbHdheXMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuICogVGhlc2UgYXJlIE5PVCB0aW1lLWdhdGVkXG4gKi9cbmV4cG9ydCBjb25zdCBDT1JFX0ZFQVRVUkVTID0gW1xuICAgICdiYXNpY19lZGl0aW5nJywgICAgICAgICAgLy8gQWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUgY29tbWFuZHNcbiAgICAnYWxsX2FpX3Byb3ZpZGVycycsICAgICAgIC8vIENsYXVkZSwgT3BlbkFJLCBHb29nbGUsIE9sbGFtYVxuICAgICdmaWxlX2NvbnZlcnNhdGlvbnMnLCAgICAgLy8gRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICAncHJvdmlkZXJfc3dpdGNoaW5nJywgICAgIC8vIFN3aXRjaCBwcm92aWRlcnMgaW4gY2hhdFxuICAgICdtb2JpbGVfYWNjZXNzJywgICAgICAgICAgLy8gRnVsbCBtb2JpbGUgc3VwcG9ydFxuICAgICdhcGlfa2V5X2NvbmZpZycsICAgICAgICAgLy8gQ29uZmlndXJlIG93biBBUEkga2V5c1xuICAgICdzaWRlYmFyX2NoYXQnLCAgICAgICAgICAgLy8gQ2hhdCBpbnRlcmZhY2UgaW4gc2lkZWJhclxuICAgICdkb2N1bWVudF9jb250ZXh0JyAgICAgICAgLy8gQ3VycmVudCBkb2N1bWVudCBjb250ZXh0XG5dOyIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBTdXBlcm5vdmFMaWNlbnNlLCBGZWF0dXJlRmxhZywgRmVhdHVyZUFjY2Vzc1Jlc3VsdCwgRGVidWdTZXR0aW5ncywgU3VwZXJub3ZhVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgU1VQRVJOT1ZBX0ZFQVRVUkVTLCBDT1JFX0ZFQVRVUkVTLCBUaW1lR2F0ZWRGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlLWNvbmZpZyc7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTWFuYWdlciB7XG5cdHByaXZhdGUgZmVhdHVyZXM6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzdXBlcm5vdmFMaWNlbnNlOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgaXNTdXBlcm5vdmE6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbGljZW5zZVZhbGlkYXRvcjogTGljZW5zZVZhbGlkYXRvcixcblx0XHRkZWJ1Z1NldHRpbmdzPzogRGVidWdTZXR0aW5nc1xuXHQpIHtcblx0XHRpZiAoZGVidWdTZXR0aW5ncykge1xuXHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0gZGVidWdTZXR0aW5ncztcblx0XHR9XG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZSBhbGwgZmVhdHVyZSBmbGFnc1xuXHQgKiBDb3JlIGZlYXR1cmVzIGFyZSBhbHdheXMgZW5hYmxlZFxuXHQgKiBUaW1lLWdhdGVkIGZlYXR1cmVzIGRlcGVuZCBvbiBjdXJyZW50IGRhdGUgYW5kIFN1cGVybm92YSBzdGF0dXNcblx0ICovXG5cdHByaXZhdGUgaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpOiB2b2lkIHtcblx0XHQvLyBDb3JlIGZlYXR1cmVzIC0gYWx3YXlzIGF2YWlsYWJsZSB0byBhbGwgdXNlcnNcblx0XHRDT1JFX0ZFQVRVUkVTLmZvckVhY2goZmVhdHVyZUtleSA9PiB7XG5cdFx0XHR0aGlzLnJlZ2lzdGVyRmVhdHVyZSh7XG5cdFx0XHRcdGtleTogZmVhdHVyZUtleSxcblx0XHRcdFx0ZW5hYmxlZDogdHJ1ZSxcblx0XHRcdFx0ZGVzY3JpcHRpb246IHRoaXMuZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihmZWF0dXJlS2V5KVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyBUaW1lLWdhdGVkIGZlYXR1cmVzIC0gYXZhaWxhYmxlIGJhc2VkIG9uIGRhdGVcblx0XHRPYmplY3QuZW50cmllcyhTVVBFUk5PVkFfRkVBVFVSRVMpLmZvckVhY2goKFtrZXksIGNvbmZpZ10pID0+IHtcblx0XHRcdGNvbnN0IGVuYWJsZWQgPSB0aGlzLmlzVGltZUdhdGVkRmVhdHVyZUVuYWJsZWQoa2V5LCBjb25maWcpO1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXksXG5cdFx0XHRcdGVuYWJsZWQsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiBjb25maWcuZGVzY3JpcHRpb24sXG5cdFx0XHRcdGlzVGltZUdhdGVkOiB0cnVlLFxuXHRcdFx0XHRlYXJseUFjY2Vzc09ubHk6ICF0aGlzLmlzR2VuZXJhbGx5QXZhaWxhYmxlKGNvbmZpZylcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkZXNjcmlwdGlvbiBmb3IgY29yZSBmZWF0dXJlc1xuXHQgKi9cblx0cHJpdmF0ZSBnZXRDb3JlRmVhdHVyZURlc2NyaXB0aW9uKGtleTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBkZXNjcmlwdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnYmFzaWNfZWRpdGluZyc6ICdCYXNpYyBkb2N1bWVudCBlZGl0aW5nIGNvbW1hbmRzIChhZGQsIGVkaXQsIGRlbGV0ZSwgZ3JhbW1hciwgcmV3cml0ZSknLFxuXHRcdFx0J2FsbF9haV9wcm92aWRlcnMnOiAnQWNjZXNzIHRvIGFsbCBBSSBwcm92aWRlcnMgKENsYXVkZSwgT3BlbkFJLCBHb29nbGUsIE9sbGFtYSknLFxuXHRcdFx0J2ZpbGVfY29udmVyc2F0aW9ucyc6ICdGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeScsXG5cdFx0XHQncHJvdmlkZXJfc3dpdGNoaW5nJzogJ1N3aXRjaCBBSSBwcm92aWRlcnMgZGlyZWN0bHkgaW4gY2hhdCBpbnRlcmZhY2UnLFxuXHRcdFx0J21vYmlsZV9hY2Nlc3MnOiAnRnVsbCBtb2JpbGUgZGV2aWNlIHN1cHBvcnQnLFxuXHRcdFx0J2FwaV9rZXlfY29uZmlnJzogJ0NvbmZpZ3VyZSB5b3VyIG93biBBUEkga2V5cycsXG5cdFx0XHQnc2lkZWJhcl9jaGF0JzogJ0NoYXQgaW50ZXJmYWNlIGluIHNpZGViYXInLFxuXHRcdFx0J2RvY3VtZW50X2NvbnRleHQnOiAnQ3VycmVudCBkb2N1bWVudCBjb250ZXh0IGluIGNvbnZlcnNhdGlvbnMnXG5cdFx0fTtcblx0XHRyZXR1cm4gZGVzY3JpcHRpb25zW2tleV0gfHwga2V5O1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgdGltZS1nYXRlZCBmZWF0dXJlIHNob3VsZCBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzVGltZUdhdGVkRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nLCBjb25maWc6IFRpbWVHYXRlZEZlYXR1cmUpOiBib29sZWFuIHtcblx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblx0XHRjb25zdCBnZW5lcmFsRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5nZW5lcmFsRGF0ZSk7XG5cblx0XHQvLyBGZWF0dXJlIGlzIGF2YWlsYWJsZSB0byBldmVyeW9uZSBhZnRlciBnZW5lcmFsIGRhdGVcblx0XHRpZiAobm93ID49IGdlbmVyYWxEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBGZWF0dXJlIGlzIGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycyBhZnRlciBzdXBlcm5vdmEgZGF0ZVxuXHRcdGlmICh0aGlzLmdldElzU3VwZXJub3ZhKCkgJiYgbm93ID49IHN1cGVybm92YURhdGUpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBmZWF0dXJlIGlzIGdlbmVyYWxseSBhdmFpbGFibGUgKHBhc3QgZ2VuZXJhbCBkYXRlKVxuXHQgKi9cblx0cHJpdmF0ZSBpc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWc6IFRpbWVHYXRlZEZlYXR1cmUpOiBib29sZWFuIHtcblx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXHRcdHJldHVybiBub3cgPj0gZ2VuZXJhbERhdGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgZGF0ZSAoY2FuIGJlIG92ZXJyaWRkZW4gaW4gZGVidWcgbW9kZSlcblx0ICovXG5cdHByaXZhdGUgZ2V0Q3VycmVudERhdGUoKTogRGF0ZSB7XG5cdFx0aWYgKHRoaXMuZGVidWdTZXR0aW5ncy5lbmFibGVkICYmIHRoaXMuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUpIHtcblx0XHRcdHJldHVybiBuZXcgRGF0ZSh0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKTtcblx0XHR9XG5cdFx0cmV0dXJuIG5ldyBEYXRlKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IFN1cGVybm92YSBzdGF0dXMgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldElzU3VwZXJub3ZhKCk6IGJvb2xlYW4ge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuaXNTdXBlcm5vdmE7XG5cdH1cblxuXHQvKipcblx0ICogUmVnaXN0ZXIgYSBuZXcgZmVhdHVyZSBmbGFnXG5cdCAqL1xuXHRyZWdpc3RlckZlYXR1cmUoZmxhZzogRmVhdHVyZUZsYWcpOiB2b2lkIHtcblx0XHR0aGlzLmZlYXR1cmVzLnNldChmbGFnLmtleSwgZmxhZyk7XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIFN1cGVybm92YSBsaWNlbnNlIGFuZCByZWNhbGN1bGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHQgKi9cblx0YXN5bmMgdXBkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHR0aGlzLnN1cGVybm92YUxpY2Vuc2UgPSBudWxsO1xuXHRcdFx0dGhpcy5pc1N1cGVybm92YSA9IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCB2YWxpZGF0aW9uID0gYXdhaXQgdGhpcy5saWNlbnNlVmFsaWRhdG9yLnZhbGlkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICh2YWxpZGF0aW9uLnZhbGlkICYmIHZhbGlkYXRpb24ubGljZW5zZSkge1xuXHRcdFx0XHR0aGlzLnN1cGVybm92YUxpY2Vuc2UgPSB2YWxpZGF0aW9uLmxpY2Vuc2U7XG5cdFx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSB0cnVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pc1N1cGVybm92YSA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFJlaW5pdGlhbGl6ZSBmZWF0dXJlcyB3aXRoIHVwZGF0ZWQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IFN1cGVybm92YSBzdGF0dXNcblx0ICovXG5cdGlzU3VwZXJub3ZhU3VwcG9ydGVyKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgU3VwZXJub3ZhIGxpY2Vuc2Vcblx0ICovXG5cdGdldFN1cGVybm92YUxpY2Vuc2UoKTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLnN1cGVybm92YUxpY2Vuc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgYSBmZWF0dXJlIGlzIGVuYWJsZWRcblx0ICovXG5cdGlzRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gSGFuZGxlIG9sZCBmZWF0dXJlIGtleXMgdGhhdCBtaWdodCBzdGlsbCBiZSByZWZlcmVuY2VkXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTsgLy8gQWxsIGxlZ2FjeSBmZWF0dXJlcyBhcmUgbm93IGVuYWJsZWQgZm9yIGV2ZXJ5b25lXG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdHJldHVybiBmZWF0dXJlPy5lbmFibGVkID8/IGZhbHNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoaXMgaXMgYSBsZWdhY3kgZmVhdHVyZSBrZXkgdGhhdCBzaG91bGQgYWx3YXlzIGJlIGVuYWJsZWRcblx0ICovXG5cdHByaXZhdGUgaXNMZWdhY3lGZWF0dXJlS2V5KGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Y29uc3QgbGVnYWN5S2V5cyA9IFtcblx0XHRcdCdiYXNpY19lZGl0aW5nJyxcblx0XHRcdCdsb2NhbF9haV9wcm92aWRlcnMnLFxuXHRcdFx0J2ZpbGVfY29udmVyc2F0aW9ucycsXG5cdFx0XHQnc2luZ2xlX2Nsb3VkX3Byb3ZpZGVyJyxcblx0XHRcdCd1bmxpbWl0ZWRfY2xvdWRfYWknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZycsXG5cdFx0XHQnbW9iaWxlX2FjY2VzcycsXG5cdFx0XHQnYWR2YW5jZWRfdGVtcGxhdGVzJyxcblx0XHRcdCdiYXRjaF9vcGVyYXRpb25zJyxcblx0XHRcdCdjcm9zc19kb2N1bWVudF9jb250ZXh0Jyxcblx0XHRcdCdwcmlvcml0eV9zdXBwb3J0J1xuXHRcdF07XG5cdFx0cmV0dXJuIGxlZ2FjeUtleXMuaW5jbHVkZXMoa2V5KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBmZWF0dXJlIGFjY2VzcyB3aXRoIGRldGFpbGVkIHJlc3VsdFxuXHQgKi9cblx0Y2hlY2tGZWF0dXJlQWNjZXNzKGZlYXR1cmVLZXk6IHN0cmluZyk6IEZlYXR1cmVBY2Nlc3NSZXN1bHQge1xuXHRcdC8vIEhhbmRsZSBsZWdhY3kgZmVhdHVyZXNcblx0XHRpZiAodGhpcy5pc0xlZ2FjeUZlYXR1cmVLZXkoZmVhdHVyZUtleSkpIHtcblx0XHRcdHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcblx0XHR9XG5cblx0XHRjb25zdCBmZWF0dXJlID0gdGhpcy5mZWF0dXJlcy5nZXQoZmVhdHVyZUtleSk7XG5cdFx0XG5cdFx0aWYgKCFmZWF0dXJlKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0YWxsb3dlZDogZmFsc2UsIFxuXHRcdFx0XHRyZWFzb246IGBGZWF0dXJlICcke2ZlYXR1cmVLZXl9JyBub3QgZm91bmRgIFxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRpZiAoZmVhdHVyZS5lbmFibGVkKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHRpbWUtZ2F0ZWQgZmVhdHVyZXMsIHByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvblxuXHRcdGlmIChmZWF0dXJlLmlzVGltZUdhdGVkKSB7XG5cdFx0XHRjb25zdCBjb25maWcgPSBTVVBFUk5PVkFfRkVBVFVSRVNbZmVhdHVyZUtleV07XG5cdFx0XHRpZiAoY29uZmlnKSB7XG5cdFx0XHRcdGNvbnN0IG5vdyA9IHRoaXMuZ2V0Q3VycmVudERhdGUoKTtcblx0XHRcdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXHRcdFx0XHRjb25zdCBzdXBlcm5vdmFEYXRlID0gbmV3IERhdGUoY29uZmlnLnN1cGVybm92YURhdGUpO1xuXG5cdFx0XHRcdGlmICh0aGlzLmdldElzU3VwZXJub3ZhKCkgJiYgbm93IDwgc3VwZXJub3ZhRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSB3aWxsIGJlIGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycyBvbiAke2NvbmZpZy5zdXBlcm5vdmFEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBzdXBlcm5vdmFEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIGlmICghdGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IGdlbmVyYWxEYXRlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLFxuXHRcdFx0XHRcdFx0cmVhc29uOiBgVGhpcyBmZWF0dXJlIGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBJdCB3aWxsIGJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgb24gJHtjb25maWcuZ2VuZXJhbERhdGV9YCxcblx0XHRcdFx0XHRcdGlzU3VwZXJub3ZhRmVhdHVyZTogdHJ1ZSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGdlbmVyYWxEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdHJlYXNvbjogJ0ZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZSdcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgZW5hYmxlZCBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0RW5hYmxlZEZlYXR1cmVzKCk6IEZlYXR1cmVGbGFnW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMuZmVhdHVyZXMudmFsdWVzKCkpLmZpbHRlcihmZWF0dXJlID0+IGZlYXR1cmUuZW5hYmxlZCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFsbCBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIGZlYXR1cmVzXG5cdCAqL1xuXHRnZXRTdXBlcm5vdmFGZWF0dXJlcygpOiBGZWF0dXJlRmxhZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmZlYXR1cmVzLnZhbHVlcygpKS5maWx0ZXIoZmVhdHVyZSA9PiBcblx0XHRcdGZlYXR1cmUuaXNUaW1lR2F0ZWQgJiYgZmVhdHVyZS5lYXJseUFjY2Vzc09ubHlcblx0XHQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBkZWJ1ZyBzZXR0aW5ncyBmb3IgZGV2ZWxvcG1lbnQgdGVzdGluZ1xuXHQgKi9cblx0dXBkYXRlRGVidWdTZXR0aW5ncyhzZXR0aW5nczogRGVidWdTZXR0aW5ncyk6IHZvaWQge1xuXHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdC8vIFJlaW5pdGlhbGl6ZSBmZWF0dXJlcyB3aXRoIG5ldyBkZWJ1ZyBzZXR0aW5nc1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkZWJ1ZyBzZXR0aW5nc1xuXHQgKi9cblx0Z2V0RGVidWdTZXR0aW5ncygpOiBEZWJ1Z1NldHRpbmdzIHtcblx0XHRyZXR1cm4geyAuLi50aGlzLmRlYnVnU2V0dGluZ3MgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZmVhdHVyZSBzdW1tYXJ5XG5cdCAqL1xuXHRnZXRGZWF0dXJlU3VtbWFyeSgpOiB7IFxuXHRcdGlzU3VwZXJub3ZhOiBib29sZWFuOyBcblx0XHRlbmFibGVkOiBzdHJpbmdbXTsgXG5cdFx0Y29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzU3VwZXJub3ZhOiBib29sZWFufT4gXG5cdH0ge1xuXHRcdGNvbnN0IGVuYWJsZWQ6IHN0cmluZ1tdID0gW107XG5cdFx0Y29uc3QgY29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzU3VwZXJub3ZhOiBib29sZWFufT4gPSBbXTtcblxuXHRcdGZvciAoY29uc3QgW2tleSwgZmVhdHVyZV0gb2YgdGhpcy5mZWF0dXJlcykge1xuXHRcdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0XHRlbmFibGVkLnB1c2goa2V5KTtcblx0XHRcdH0gZWxzZSBpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0XHRjb25zdCBjb25maWcgPSBTVVBFUk5PVkFfRkVBVFVSRVNba2V5XTtcblx0XHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRcdGNvbnN0IGlzU3VwZXJub3ZhVXNlciA9IHRoaXMuZ2V0SXNTdXBlcm5vdmEoKTtcblx0XHRcdFx0XHRjb21pbmdTb29uLnB1c2goe1xuXHRcdFx0XHRcdFx0a2V5LFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogaXNTdXBlcm5vdmFVc2VyID8gY29uZmlnLnN1cGVybm92YURhdGUgOiBjb25maWcuZ2VuZXJhbERhdGUsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YTogaXNTdXBlcm5vdmFVc2VyXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4geyBcblx0XHRcdGlzU3VwZXJub3ZhOiB0aGlzLmdldElzU3VwZXJub3ZhKCksIFxuXHRcdFx0ZW5hYmxlZCwgXG5cdFx0XHRjb21pbmdTb29uIFxuXHRcdH07XG5cdH1cbn0iLCAiaW1wb3J0IHsgTGljZW5zZSwgU3VwZXJub3ZhTGljZW5zZSwgTGljZW5zZVZhbGlkYXRpb25SZXN1bHQsIFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQsIExpY2Vuc2VFcnJvciB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgTGljZW5zZVZhbGlkYXRvciB7XG5cdC8vIEVtYmVkZGVkIHNpZ25pbmcga2V5IC0gaW4gcHJvZHVjdGlvbiB0aGlzIHdvdWxkIGJlIG9iZnVzY2F0ZWRcblx0cHJpdmF0ZSByZWFkb25seSBTRUNSRVRfS0VZID0gJ25vdmEtbGljZW5zZS1zaWduaW5nLWtleS0yMDI1Jztcblx0XG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBsaWNlbnNlIGtleSBhbmQgcmV0dXJucyB2YWxpZGF0aW9uIHJlc3VsdFxuXHQgKi9cblx0YXN5bmMgdmFsaWRhdGVMaWNlbnNlKGxpY2Vuc2VLZXk6IHN0cmluZyk6IFByb21pc2U8TGljZW5zZVZhbGlkYXRpb25SZXN1bHQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgbGljZW5zZSA9IHRoaXMucGFyc2VMaWNlbnNlS2V5KGxpY2Vuc2VLZXkpO1xuXHRcdFx0aWYgKCFsaWNlbnNlKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5JTlZBTElEX0ZPUk1BVCBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbkVycm9yID0gYXdhaXQgdGhpcy52YWxpZGF0ZUxpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBsaWNlbnNlIGtleSBzdHJpbmcgaW50byBhIExpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIHBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5OiBzdHJpbmcpOiBMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIExpY2Vuc2Uga2V5IGZvcm1hdDogYmFzZTY0KGVtYWlsfHRpZXJ8ZXhwaXJlc0F0fGlzc3VlZEF0fHNpZ25hdHVyZSlcblx0XHRcdGNvbnN0IGRlY29kZWQgPSB0aGlzLmJhc2U2NERlY29kZShsaWNlbnNlS2V5KTtcblx0XHRcdGNvbnN0IHBhcnRzID0gZGVjb2RlZC5zcGxpdCgnfCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAocGFydHMubGVuZ3RoICE9PSA1KSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBbZW1haWwsIHRpZXIsIGV4cGlyZXNBdFN0ciwgaXNzdWVkQXRTdHIsIHNpZ25hdHVyZV0gPSBwYXJ0cztcblxuXHRcdFx0Ly8gU2tpcCB0aWVyIHZhbGlkYXRpb24gc2luY2Ugd2UncmUgcmVtb3ZpbmcgdGllcnNcblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdGV4cGlyZXNBdCxcblx0XHRcdFx0aXNzdWVkQXQsXG5cdFx0XHRcdHNpZ25hdHVyZSxcblx0XHRcdFx0bGljZW5zZUtleVxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGRlY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjREZWNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYXRvYiAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBhdG9iKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCd1dGY4Jyk7XG5cdH1cblxuXHQvKipcblx0ICogU2FmZSBiYXNlNjQgZW5jb2RlIHRoYXQgaGFuZGxlcyBib3RoIGJyb3dzZXIgYW5kIE5vZGUuanMgZW52aXJvbm1lbnRzXG5cdCAqL1xuXHRwcml2YXRlIGJhc2U2NEVuY29kZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHR5cGVvZiBidG9hICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIGJ0b2Eoc3RyKTtcblx0XHR9XG5cdFx0Ly8gRmFsbGJhY2sgZm9yIE5vZGUuanMgZW52aXJvbm1lbnRcblx0XHRyZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAndXRmOCcpLnRvU3RyaW5nKCdiYXNlNjQnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBsaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyB2YWxpZGF0ZUxpY2Vuc2VPYmplY3QobGljZW5zZTogTGljZW5zZSk6IFByb21pc2U8TGljZW5zZUVycm9yIHwgbnVsbD4ge1xuXHRcdC8vIDEuIFZlcmlmeSBITUFDIHNpZ25hdHVyZVxuXHRcdGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRcdGxpY2Vuc2UuZW1haWwsXG5cdFx0XHQnbGVnYWN5JywgLy8gVXNlIGxlZ2FjeSBmb3Igb2xkIGxpY2Vuc2VzXG5cdFx0XHRsaWNlbnNlLmV4cGlyZXNBdCxcblx0XHRcdGxpY2Vuc2UuaXNzdWVkQXRcblx0XHQpO1xuXG5cdFx0aWYgKGxpY2Vuc2Uuc2lnbmF0dXJlICE9PSBleHBlY3RlZFNpZ25hdHVyZSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5JTlZBTElEX1NJR05BVFVSRTtcblx0XHR9XG5cblx0XHQvLyAyLiBDaGVjayBleHBpcmF0aW9uXG5cdFx0aWYgKGxpY2Vuc2UuZXhwaXJlc0F0ICYmIG5ldyBEYXRlKCkgPiBsaWNlbnNlLmV4cGlyZXNBdCkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5FWFBJUkVEO1xuXHRcdH1cblxuXHRcdC8vIDMuIFZhbGlkYXRlIGlzc3VlIGRhdGUgKHByZXZlbnQgZnV0dXJlLWRhdGVkIGxpY2Vuc2VzKVxuXHRcdGlmIChsaWNlbnNlLmlzc3VlZEF0ID4gbmV3IERhdGUoKSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5GVVRVUkVfREFURUQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIEhNQUMtU0hBMjU2IHNpZ25hdHVyZSBmb3IgbGljZW5zZSBkYXRhXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdlbmVyYXRlU2lnbmF0dXJlKFxuXHRcdGVtYWlsOiBzdHJpbmcsXG5cdFx0dGllcjogc3RyaW5nLFxuXHRcdGV4cGlyZXNBdDogRGF0ZSB8IG51bGwsXG5cdFx0aXNzdWVkQXQ6IERhdGVcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBkYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfWA7XG5cdFx0XG5cdFx0Y29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdGNvbnN0IGtleURhdGEgPSBlbmNvZGVyLmVuY29kZSh0aGlzLlNFQ1JFVF9LRVkpO1xuXHRcdGNvbnN0IG1lc3NhZ2VEYXRhID0gZW5jb2Rlci5lbmNvZGUoZGF0YSk7XG5cdFx0XG5cdFx0Y29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG5cdFx0XHQncmF3Jyxcblx0XHRcdGtleURhdGEsXG5cdFx0XHR7IG5hbWU6ICdITUFDJywgaGFzaDogJ1NIQS0yNTYnIH0sXG5cdFx0XHRmYWxzZSxcblx0XHRcdFsnc2lnbiddXG5cdFx0KTtcblx0XHRcblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBjcnlwdG9LZXksIG1lc3NhZ2VEYXRhKTtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShzaWduYXR1cmUpKVxuXHRcdFx0Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpXG5cdFx0XHQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHRlc3QgbGljZW5zZSBmb3IgZGV2ZWxvcG1lbnQgcHVycG9zZXNcblx0ICovXG5cdGFzeW5jIGNyZWF0ZVRlc3RMaWNlbnNlKGVtYWlsOiBzdHJpbmcsIHRpZXI6IHN0cmluZywgbGlmZXRpbWVNb2RlID0gdHJ1ZSk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZSgpO1xuXHRcdGNvbnN0IGV4cGlyZXNBdCA9IGxpZmV0aW1lTW9kZSA/IG51bGwgOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDEgeWVhclxuXG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVNpZ25hdHVyZShlbWFpbCwgdGllciwgZXhwaXJlc0F0LCBpc3N1ZWRBdCk7XG5cdFx0XG5cdFx0Y29uc3QgbGljZW5zZURhdGEgPSBgJHtlbWFpbH18JHt0aWVyfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9fCR7c2lnbmF0dXJlfWA7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmFzZTY0RW5jb2RlKGxpY2Vuc2VEYXRhKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBrZXlcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgbGljZW5zZSA9IHRoaXMucGFyc2VTdXBlcm5vdmFMaWNlbnNlS2V5KGxpY2Vuc2VLZXkpO1xuXHRcdFx0aWYgKCFsaWNlbnNlKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5JTlZBTElEX0ZPUk1BVCBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbkVycm9yID0gYXdhaXQgdGhpcy52YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBrZXkgc3RyaW5nXG5cdCAqL1xuXHRwcml2YXRlIHBhcnNlU3VwZXJub3ZhTGljZW5zZUtleShsaWNlbnNlS2V5OiBzdHJpbmcpOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0eXBlfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0eXBlLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFZhbGlkYXRlIHR5cGVcblx0XHRcdGlmICh0eXBlICE9PSAnYW5udWFsJyAmJiB0eXBlICE9PSAnbGlmZXRpbWUnKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBQYXJzZSBkYXRlc1xuXHRcdFx0Y29uc3QgZXhwaXJlc0F0ID0gZXhwaXJlc0F0U3RyID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKGV4cGlyZXNBdFN0cik7XG5cdFx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKGlzc3VlZEF0U3RyKTtcblxuXHRcdFx0Ly8gVmFsaWRhdGUgZGF0ZXNcblx0XHRcdGlmIChpc05hTihpc3N1ZWRBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXhwaXJlc0F0ICYmIGlzTmFOKGV4cGlyZXNBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRlbWFpbCxcblx0XHRcdFx0dHlwZTogdHlwZSBhcyAnYW5udWFsJyB8ICdsaWZldGltZScsXG5cdFx0XHRcdGV4cGlyZXNBdCxcblx0XHRcdFx0aXNzdWVkQXQsXG5cdFx0XHRcdHNpZ25hdHVyZSxcblx0XHRcdFx0bGljZW5zZUtleVxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIFN1cGVybm92YSBsaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyB2YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2VPYmplY3QobGljZW5zZTogU3VwZXJub3ZhTGljZW5zZSk6IFByb21pc2U8TGljZW5zZUVycm9yIHwgbnVsbD4ge1xuXHRcdC8vIDEuIFZlcmlmeSBITUFDIHNpZ25hdHVyZVxuXHRcdGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShcblx0XHRcdGxpY2Vuc2UuZW1haWwsXG5cdFx0XHRsaWNlbnNlLnR5cGUsXG5cdFx0XHRsaWNlbnNlLmV4cGlyZXNBdCxcblx0XHRcdGxpY2Vuc2UuaXNzdWVkQXRcblx0XHQpO1xuXG5cdFx0aWYgKGxpY2Vuc2Uuc2lnbmF0dXJlICE9PSBleHBlY3RlZFNpZ25hdHVyZSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5JTlZBTElEX1NJR05BVFVSRTtcblx0XHR9XG5cblx0XHQvLyAyLiBDaGVjayBleHBpcmF0aW9uXG5cdFx0aWYgKGxpY2Vuc2UuZXhwaXJlc0F0ICYmIG5ldyBEYXRlKCkgPiBsaWNlbnNlLmV4cGlyZXNBdCkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5FWFBJUkVEO1xuXHRcdH1cblxuXHRcdC8vIDMuIFZhbGlkYXRlIGlzc3VlIGRhdGVcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIFN1cGVybm92YSBsaWNlbnNlXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdlbmVyYXRlU3VwZXJub3ZhU2lnbmF0dXJlKFxuXHRcdGVtYWlsOiBzdHJpbmcsXG5cdFx0dHlwZTogJ2FubnVhbCcgfCAnbGlmZXRpbWUnLFxuXHRcdGV4cGlyZXNBdDogRGF0ZSB8IG51bGwsXG5cdFx0aXNzdWVkQXQ6IERhdGVcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBkYXRhID0gYCR7ZW1haWx9fCR7dHlwZX18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfWA7XG5cdFx0XG5cdFx0Y29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXHRcdGNvbnN0IGtleURhdGEgPSBlbmNvZGVyLmVuY29kZSh0aGlzLlNFQ1JFVF9LRVkpO1xuXHRcdGNvbnN0IG1lc3NhZ2VEYXRhID0gZW5jb2Rlci5lbmNvZGUoZGF0YSk7XG5cdFx0XG5cdFx0Y29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG5cdFx0XHQncmF3Jyxcblx0XHRcdGtleURhdGEsXG5cdFx0XHR7IG5hbWU6ICdITUFDJywgaGFzaDogJ1NIQS0yNTYnIH0sXG5cdFx0XHRmYWxzZSxcblx0XHRcdFsnc2lnbiddXG5cdFx0KTtcblx0XHRcblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBjcnlwdG9LZXksIG1lc3NhZ2VEYXRhKTtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShzaWduYXR1cmUpKVxuXHRcdFx0Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpXG5cdFx0XHQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHRlc3QgU3VwZXJub3ZhIGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50XG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0U3VwZXJub3ZhTGljZW5zZShlbWFpbDogc3RyaW5nLCB0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSB0eXBlID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU3VwZXJub3ZhU2lnbmF0dXJlKGVtYWlsLCB0eXBlLCBleHBpcmVzQXQsIGlzc3VlZEF0KTtcblx0XHRcblx0XHRjb25zdCBsaWNlbnNlRGF0YSA9IGAke2VtYWlsfXwke3R5cGV9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX18JHtzaWduYXR1cmV9YDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5iYXNlNjRFbmNvZGUobGljZW5zZURhdGEpO1xuXHR9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBbUg7OztBQ0FuSCxJQUFBQyxtQkFBeUQ7OztBQ0F6RCxJQUFBQyxtQkFBbUg7OztBQ2E1RyxJQUFNLDJCQUFOLE1BQStCO0FBQUEsRUFVbEMsWUFBWSxLQUFVLFVBQStCO0FBUHJELFNBQVEsa0JBQXNDO0FBQzlDLFNBQVEsY0FBb0MsQ0FBQztBQUM3QyxTQUFRLGdCQUF3QjtBQUNoQyxTQUFRLFlBQXFCO0FBQzdCLFNBQVEsZUFBdUI7QUFDL0IsU0FBUSxvQkFBNEI7QUFHaEMsU0FBSyxNQUFNO0FBQ1gsU0FBSyxXQUFXO0FBQ2hCLFNBQUssb0JBQW9CO0FBQUEsRUFDN0I7QUFBQSxFQUVRLHNCQUE0QjtBQUNoQyxTQUFLLFNBQVMsaUJBQWlCLFNBQVMsS0FBSyxZQUFZLEtBQUssSUFBSSxDQUFDO0FBQ25FLFNBQUssU0FBUyxpQkFBaUIsV0FBVyxLQUFLLGNBQWMsS0FBSyxJQUFJLENBQUM7QUFHdkUsU0FBSyxTQUFTLGlCQUFpQixRQUFRLE1BQU07QUFFekMsaUJBQVcsTUFBTSxLQUFLLGdCQUFnQixHQUFHLEdBQUc7QUFBQSxJQUNoRCxDQUFDO0FBR0QsYUFBUyxpQkFBaUIsU0FBUyxDQUFDLE1BQU07QUFDdEMsVUFBSSxLQUFLLG1CQUFtQixDQUFDLEtBQUssZ0JBQWdCLFNBQVMsRUFBRSxNQUFjLEtBQUssRUFBRSxXQUFXLEtBQUssVUFBVTtBQUN4RyxhQUFLLGdCQUFnQjtBQUFBLE1BQ3pCO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRVEsY0FBb0I7QUFDeEIsVUFBTSxPQUFPLEtBQUssU0FBUztBQUMzQixVQUFNLFlBQVksS0FBSyxTQUFTO0FBR2hDLFVBQU0sZUFBZSxLQUFLLFVBQVUsR0FBRyxTQUFTO0FBQ2hELFVBQU0sWUFBWSxhQUFhLE1BQU0scUJBQXFCO0FBRTFELFFBQUksV0FBVztBQUNYLFdBQUssZUFBZSxVQUFVLENBQUMsS0FBSztBQUNwQyxXQUFLLG9CQUFvQixZQUFZLFVBQVUsQ0FBQyxFQUFFO0FBQ2xELFdBQUssZ0JBQWdCO0FBQUEsSUFDekIsT0FBTztBQUNILFdBQUssZ0JBQWdCO0FBQUEsSUFDekI7QUFBQSxFQUNKO0FBQUEsRUFFUSxjQUFjLEdBQXdCO0FBQzFDLFFBQUksQ0FBQyxLQUFLLFVBQVc7QUFFckIsWUFBUSxFQUFFLEtBQUs7QUFBQSxNQUNYLEtBQUs7QUFDRCxVQUFFLGVBQWU7QUFDakIsYUFBSyxnQkFBZ0IsS0FBSyxJQUFJLEtBQUssZ0JBQWdCLEdBQUcsS0FBSyxZQUFZLFNBQVMsQ0FBQztBQUNqRixhQUFLLGdCQUFnQjtBQUNyQjtBQUFBLE1BRUosS0FBSztBQUNELFVBQUUsZUFBZTtBQUNqQixhQUFLLGdCQUFnQixLQUFLLElBQUksS0FBSyxnQkFBZ0IsR0FBRyxFQUFFO0FBQ3hELGFBQUssZ0JBQWdCO0FBQ3JCO0FBQUEsTUFFSixLQUFLO0FBQUEsTUFDTCxLQUFLO0FBQ0QsWUFBSSxLQUFLLGlCQUFpQixHQUFHO0FBQ3pCLFlBQUUsZUFBZTtBQUNqQixlQUFLLGlCQUFpQixLQUFLLFlBQVksS0FBSyxhQUFhLENBQUM7QUFBQSxRQUM5RDtBQUNBO0FBQUEsTUFFSixLQUFLO0FBQ0QsVUFBRSxlQUFlO0FBQ2pCLGFBQUssZ0JBQWdCO0FBQ3JCO0FBQUEsSUFDUjtBQUFBLEVBQ0o7QUFBQSxFQUVRLGtCQUF3QjtBQUM1QixTQUFLLGNBQWMsS0FBSyxlQUFlLEtBQUssWUFBWTtBQUV4RCxRQUFJLEtBQUssWUFBWSxXQUFXLEdBQUc7QUFDL0IsV0FBSyxnQkFBZ0I7QUFDckI7QUFBQSxJQUNKO0FBRUEsUUFBSSxDQUFDLEtBQUssaUJBQWlCO0FBQ3ZCLFdBQUssc0JBQXNCO0FBQUEsSUFDL0I7QUFFQSxTQUFLLGtCQUFrQjtBQUN2QixTQUFLLGNBQWM7QUFDbkIsU0FBSyxZQUFZO0FBQ2pCLFNBQUssZ0JBQWdCO0FBQUEsRUFDekI7QUFBQSxFQUVRLGtCQUF3QjtBQUM1QixRQUFJLEtBQUssaUJBQWlCO0FBQ3RCLFdBQUssZ0JBQWdCLE1BQU0sVUFBVTtBQUFBLElBQ3pDO0FBQ0EsU0FBSyxZQUFZO0FBQ2pCLFNBQUssZ0JBQWdCO0FBQUEsRUFDekI7QUFBQSxFQUVRLHdCQUE4QjtBQXpIMUM7QUEwSFEsU0FBSyxrQkFBa0IsU0FBUyxjQUFjLEtBQUs7QUFDbkQsU0FBSyxnQkFBZ0IsWUFBWTtBQUNqQyxTQUFLLGdCQUFnQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBY3JDLGVBQUssU0FBUyxrQkFBZCxtQkFBNkIsWUFBWSxLQUFLO0FBQUEsRUFDbEQ7QUFBQSxFQUVRLG9CQUEwQjtBQUM5QixRQUFJLENBQUMsS0FBSyxnQkFBaUI7QUFFM0IsU0FBSyxnQkFBZ0IsTUFBTTtBQUUzQixTQUFLLFlBQVksUUFBUSxDQUFDLFlBQVksVUFBVTtBQUM1QyxZQUFNLE9BQU8sS0FBSyxnQkFBaUIsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDNUUsV0FBSyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUXJCLFlBQU0sU0FBUyxLQUFLLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzdELGFBQU8sY0FBYyxXQUFXLEtBQUs7QUFDckMsYUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU92QixVQUFJLFdBQVcsS0FBSyxTQUFTLFdBQVcsS0FBSyxNQUFNO0FBQy9DLGNBQU0sU0FBUyxLQUFLLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzdELGVBQU8sY0FBYyxXQUFXLEtBQUs7QUFDckMsZUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUkzQjtBQUVBLFdBQUssaUJBQWlCLFNBQVMsTUFBTTtBQUNqQyxhQUFLLGlCQUFpQixVQUFVO0FBQUEsTUFDcEMsQ0FBQztBQUVELFdBQUssaUJBQWlCLGNBQWMsTUFBTTtBQUN0QyxhQUFLLGdCQUFnQjtBQUNyQixhQUFLLGdCQUFnQjtBQUFBLE1BQ3pCLENBQUM7QUFBQSxJQUNMLENBQUM7QUFFRCxTQUFLLGdCQUFnQixNQUFNLFVBQVU7QUFBQSxFQUN6QztBQUFBLEVBRVEsa0JBQXdCO0FBQzVCLFFBQUksQ0FBQyxLQUFLLGdCQUFpQjtBQUUzQixVQUFNLFFBQVEsS0FBSyxnQkFBZ0IsaUJBQWlCLHVCQUF1QjtBQUMzRSxVQUFNLFFBQVEsQ0FBQyxNQUFNLFVBQVU7QUFDM0IsWUFBTSxVQUFVO0FBQ2hCLFVBQUksVUFBVSxLQUFLLGVBQWU7QUFDOUIsZ0JBQVEsTUFBTSxrQkFBa0I7QUFBQSxNQUNwQyxPQUFPO0FBQ0gsZ0JBQVEsTUFBTSxrQkFBa0I7QUFBQSxNQUNwQztBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVRLGdCQUFzQjtBQUMxQixRQUFJLENBQUMsS0FBSyxnQkFBaUI7QUFHM0IsVUFBTSxPQUFPLEtBQUssU0FBUyxzQkFBc0I7QUFDakQsVUFBTSxjQUFjLEtBQUssSUFBSSxLQUFLLEtBQUssWUFBWSxTQUFTLEVBQUU7QUFFOUQsU0FBSyxnQkFBZ0IsTUFBTSxXQUFXO0FBQ3RDLFNBQUssZ0JBQWdCLE1BQU0sT0FBTztBQUNsQyxTQUFLLGdCQUFnQixNQUFNLFNBQVM7QUFDcEMsU0FBSyxnQkFBZ0IsTUFBTSxlQUFlO0FBQzFDLFNBQUssZ0JBQWdCLE1BQU0sUUFBUSxHQUFHLEtBQUssS0FBSztBQUFBLEVBQ3BEO0FBQUEsRUFFUSxpQkFBaUIsWUFBc0M7QUFDM0QsVUFBTSxPQUFPLEtBQUssU0FBUztBQUMzQixVQUFNLFlBQVksS0FBSyxTQUFTO0FBR2hDLFVBQU0sZUFBZSxLQUFLLFVBQVUsR0FBRyxTQUFTO0FBQ2hELFVBQU0sWUFBWSxhQUFhLE1BQU0scUJBQXFCO0FBRTFELFFBQUksQ0FBQyxVQUFXO0FBRWhCLFVBQU0sZUFBZSxDQUFDLENBQUMsVUFBVSxDQUFDO0FBQ2xDLFVBQU0sV0FBVyxZQUFZLFVBQVUsQ0FBQyxFQUFFO0FBRzFDLFVBQU0sV0FBVyxLQUFLLFdBQVcsS0FBSyxRQUFRO0FBQzlDLFVBQU0sY0FBYyxlQUFlLElBQUksUUFBUSxLQUFLO0FBR3BELFVBQU0sVUFBVSxLQUFLLFVBQVUsR0FBRyxRQUFRLElBQUksY0FBYyxLQUFLLFVBQVUsU0FBUztBQUNwRixTQUFLLFNBQVMsUUFBUTtBQUd0QixVQUFNLGVBQWUsV0FBVyxZQUFZO0FBQzVDLFNBQUssU0FBUyxrQkFBa0IsY0FBYyxZQUFZO0FBRzFELFNBQUssU0FBUyxjQUFjLElBQUksTUFBTSxTQUFTLEVBQUUsU0FBUyxLQUFLLENBQUMsQ0FBQztBQUVqRSxTQUFLLGdCQUFnQjtBQUNyQixTQUFLLFNBQVMsTUFBTTtBQUFBLEVBQ3hCO0FBQUEsRUFFUSxlQUFlLE9BQXFDO0FBQ3hELFVBQU0sUUFBUSxLQUFLLElBQUksTUFBTSxpQkFBaUI7QUFDOUMsVUFBTSxjQUFvQyxDQUFDO0FBRTNDLGVBQVcsUUFBUSxPQUFPO0FBQ3RCLFlBQU0sUUFBUSxLQUFLLFVBQVUsTUFBTSxLQUFLO0FBQ3hDLFVBQUksUUFBUSxHQUFHO0FBQ1gsb0JBQVksS0FBSztBQUFBLFVBQ2I7QUFBQSxVQUNBLGFBQWEsS0FBSztBQUFBLFVBQ2xCO0FBQUEsUUFDSixDQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0o7QUFHQSxXQUFPLFlBQ0YsS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQ2hDLE1BQU0sR0FBRyxDQUFDO0FBQUEsRUFDbkI7QUFBQSxFQUVRLFVBQVUsTUFBYSxPQUF1QjtBQUNsRCxRQUFJLENBQUMsTUFBTyxRQUFPO0FBRW5CLFVBQU0sV0FBVyxLQUFLLFNBQVMsWUFBWTtBQUMzQyxVQUFNLE9BQU8sS0FBSyxLQUFLLFlBQVk7QUFDbkMsVUFBTSxhQUFhLE1BQU0sWUFBWTtBQUdyQyxRQUFJLGFBQWEsV0FBWSxRQUFPO0FBR3BDLFFBQUksU0FBUyxXQUFXLFVBQVUsRUFBRyxRQUFPO0FBRzVDLFFBQUksU0FBUyxTQUFTLFVBQVUsRUFBRyxRQUFPO0FBRzFDLFFBQUksS0FBSyxTQUFTLFVBQVUsRUFBRyxRQUFPO0FBR3RDLFFBQUksS0FBSyxXQUFXLFVBQVUsVUFBVSxFQUFHLFFBQU87QUFFbEQsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVRLFdBQVcsTUFBYyxPQUF3QjtBQUNyRCxRQUFJLFlBQVk7QUFDaEIsUUFBSSxhQUFhO0FBRWpCLFdBQU8sWUFBWSxLQUFLLFVBQVUsYUFBYSxNQUFNLFFBQVE7QUFDekQsVUFBSSxLQUFLLFNBQVMsTUFBTSxNQUFNLFVBQVUsR0FBRztBQUN2QztBQUFBLE1BQ0o7QUFDQTtBQUFBLElBQ0o7QUFFQSxXQUFPLGVBQWUsTUFBTTtBQUFBLEVBQ2hDO0FBQUEsRUFFQSxVQUFnQjtBQUNaLFFBQUksS0FBSyxpQkFBaUI7QUFDdEIsV0FBSyxnQkFBZ0IsT0FBTztBQUFBLElBQ2hDO0FBQUEsRUFDSjtBQUNKOzs7QUNuVEEsc0JBQTJDO0FBK0JwQyxJQUFNLHlCQUFOLE1BQTZCO0FBQUEsRUFNaEMsWUFBWSxLQUFVO0FBSnRCLFNBQVEsb0JBQXNELG9CQUFJLElBQUk7QUFDdEUsU0FBaUIsY0FBYztBQUMvQixTQUFpQixvQkFBb0I7QUFHakMsU0FBSyxNQUFNO0FBQUEsRUFDZjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsYUFBYSxTQUFpQixzQkFHNUI7QUFDRSxVQUFNLGFBQWtDLENBQUM7QUFDekMsUUFBSSxpQkFBaUI7QUFJckIsVUFBTSxhQUFhO0FBRW5CLFFBQUk7QUFDSixZQUFRLFFBQVEsV0FBVyxLQUFLLE9BQU8sT0FBTyxNQUFNO0FBQ2hELFlBQU0sVUFBVSxNQUFNLENBQUM7QUFDdkIsWUFBTSxXQUFXLE1BQU0sQ0FBQztBQUN4QixZQUFNLGVBQWUsTUFBTSxDQUFDO0FBRzVCLFlBQU0sT0FBTyxLQUFLLFNBQVMsT0FBTztBQUVsQyxVQUFJLE1BQU07QUFDTixtQkFBVyxLQUFLO0FBQUEsVUFDWjtBQUFBLFVBQ0EsY0FBYztBQUFBO0FBQUEsVUFDZDtBQUFBLFVBQ0E7QUFBQSxRQUNKLENBQUM7QUFBQSxNQUNMO0FBQUEsSUFDSjtBQUdBLGVBQVcsT0FBTyxZQUFZO0FBQzFCLHVCQUFpQixlQUFlLFFBQVEsSUFBSSxjQUFjLEdBQUc7QUFBQSxJQUNqRTtBQUdBLHFCQUFpQixlQUFlLFFBQVEsV0FBVyxHQUFHLEVBQUUsS0FBSztBQUc3RCxVQUFNLGlCQUFpQixXQUFXLE9BQU8sU0FBTyxJQUFJLFlBQVk7QUFDaEUsUUFBSSxlQUFlLFNBQVMsR0FBRztBQUMzQixZQUFNLFdBQVcsS0FBSyxrQkFBa0IsSUFBSSxvQkFBb0IsS0FBSyxDQUFDO0FBQ3RFLFlBQU0sb0JBQW9CLENBQUMsR0FBRyxRQUFRO0FBR3RDLGlCQUFXLE9BQU8sZ0JBQWdCO0FBQzlCLGNBQU0sU0FBUyxrQkFBa0IsS0FBSyxDQUFBQyxjQUFZQSxVQUFTLEtBQUssU0FBUyxJQUFJLEtBQUssSUFBSTtBQUN0RixZQUFJLENBQUMsUUFBUTtBQUNULDRCQUFrQixLQUFLLEdBQUc7QUFBQSxRQUM5QjtBQUFBLE1BQ0o7QUFFQSxXQUFLLGtCQUFrQixJQUFJLHNCQUFzQixpQkFBaUI7QUFBQSxJQUN0RTtBQUVBLFdBQU8sRUFBRSxnQkFBZ0IsV0FBVztBQUFBLEVBQ3hDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGFBQ0YsU0FDQSxhQUNBLGtCQUlEO0FBRUMsVUFBTSxFQUFFLGdCQUFnQixXQUFXLElBQUksS0FBSyxhQUFhLFNBQVMsWUFBWSxJQUFJO0FBR2xGLFVBQU0scUJBQXFCLEtBQUssa0JBQWtCLElBQUksWUFBWSxJQUFJLEtBQUssQ0FBQztBQUc1RSxRQUFJLFdBQVcsU0FBUyxHQUFHO0FBQ3ZCLFlBQU0sb0JBQW9CLENBQUMsR0FBRyxrQkFBa0I7QUFHaEQsaUJBQVcsT0FBTyxZQUFZO0FBQzFCLGNBQU0sU0FBUyxrQkFBa0IsS0FBSyxjQUFZLFNBQVMsS0FBSyxTQUFTLElBQUksS0FBSyxJQUFJO0FBQ3RGLFlBQUksQ0FBQyxRQUFRO0FBQ1QsNEJBQWtCLEtBQUssR0FBRztBQUFBLFFBQzlCO0FBQUEsTUFDSjtBQUVBLFdBQUssa0JBQWtCLElBQUksWUFBWSxNQUFNLGlCQUFpQjtBQUFBLElBQ2xFO0FBR0EsVUFBTSxvQkFBb0IsS0FBSyxrQkFBa0IsSUFBSSxZQUFZLElBQUksS0FBSyxDQUFDO0FBRzNFLFVBQU0sb0JBQW9CLGtCQUFrQixPQUFPLFlBQVU7QUEvSXJFO0FBZ0pZLFVBQUksRUFBQyxpQ0FBUSxTQUFRLENBQUMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLE9BQU8sS0FBSyxJQUFJLEdBQUc7QUFDMUUsZ0JBQVEsS0FBSyxvQ0FBa0Msc0NBQVEsU0FBUixtQkFBYyxTQUFRLFNBQVMsRUFBRTtBQUNoRixlQUFPO0FBQUEsTUFDWDtBQUNBLGFBQU87QUFBQSxJQUNYLENBQUM7QUFHRCxRQUFJLGtCQUFrQixXQUFXLGtCQUFrQixRQUFRO0FBQ3ZELFVBQUksa0JBQWtCLFNBQVMsR0FBRztBQUM5QixhQUFLLGtCQUFrQixJQUFJLFlBQVksTUFBTSxpQkFBaUI7QUFBQSxNQUNsRSxPQUFPO0FBQ0gsYUFBSyxrQkFBa0IsT0FBTyxZQUFZLElBQUk7QUFBQSxNQUNsRDtBQUFBLElBQ0o7QUFHQSxVQUFNLGVBQXlCLENBQUM7QUFHaEMsVUFBTSxxQkFBcUIsTUFBTSxLQUFLLHVCQUF1QixhQUFhLE1BQU0sR0FBRztBQUNuRixRQUFJLG9CQUFvQjtBQUNwQixtQkFBYSxLQUFLLGtCQUFrQjtBQUFBLElBQ3hDO0FBR0EsZUFBVyxVQUFVLG1CQUFtQjtBQUNwQyxZQUFNLGNBQWMsTUFBTSxLQUFLLG1CQUFtQixNQUFNO0FBQ3hELFVBQUksYUFBYTtBQUNiLHFCQUFhLEtBQUssV0FBVztBQUFBLE1BQ2pDO0FBQUEsSUFDSjtBQUVBLFVBQU0sZ0JBQWdCLGFBQWEsS0FBSyxhQUFhO0FBQ3JELFVBQU0sYUFBYSxLQUFLLGVBQWUsYUFBYTtBQUNwRCxVQUFNLGNBQWMsYUFBYyxLQUFLLGNBQWMsS0FBSztBQUUxRCxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0EsU0FBUztBQUFBLFFBQ0wsZ0JBQWdCO0FBQUEsUUFDaEI7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyx1QkFBdUIsTUFBYSxpQkFBMEIsTUFBTSxXQUFtQixJQUE0QjtBQUM3SCxRQUFJO0FBQ0EsVUFBSSxlQUF5QixDQUFDO0FBRzlCLG1CQUFhLEtBQUssZ0JBQWdCLEtBQUssUUFBUSxFQUFFO0FBR2pELFlBQU0sUUFBUSxLQUFLLElBQUksY0FBYyxhQUFhLElBQUk7QUFDdEQsV0FBSSwrQkFBTyxnQkFBZSxPQUFPLEtBQUssTUFBTSxXQUFXLEVBQUUsU0FBUyxHQUFHO0FBQ2pFLHFCQUFhLEtBQUssNEJBQTRCO0FBQzlDLG1CQUFXLENBQUMsS0FBSyxLQUFLLEtBQUssT0FBTyxRQUFRLE1BQU0sV0FBVyxHQUFHO0FBRTFELGdCQUFNLGlCQUFpQixPQUFPLFVBQVUsV0FBVyxLQUFLLFVBQVUsS0FBSyxJQUFJO0FBQzNFLHVCQUFhLEtBQUssS0FBSyxHQUFHLEtBQUssY0FBYyxFQUFFO0FBQUEsUUFDbkQ7QUFBQSxNQUNKO0FBR0EsVUFBSSxnQkFBZ0I7QUFDaEIsY0FBTSxVQUFVLE1BQU0sS0FBSyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQzlDLFlBQUksU0FBUztBQUNULGdCQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFHaEMsY0FBSSxvQkFBb0I7QUFDeEIsY0FBSSxNQUFNLENBQUMsTUFBTSxPQUFPO0FBQ3BCLHFCQUFTLElBQUksR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ25DLGtCQUFJLE1BQU0sQ0FBQyxNQUFNLE9BQU87QUFDcEIsb0NBQW9CLElBQUk7QUFDeEI7QUFBQSxjQUNKO0FBQUEsWUFDSjtBQUFBLFVBQ0o7QUFFQSxnQkFBTSxlQUFlLE1BQU0sTUFBTSxpQkFBaUI7QUFDbEQsZ0JBQU0sbUJBQW1CLGFBQWEsTUFBTSxHQUFHLFFBQVEsRUFBRSxLQUFLLElBQUk7QUFDbEUsZ0JBQU0sZUFBZSxhQUFhLFNBQVM7QUFFM0MsdUJBQWEsS0FBSyxnQkFBZ0I7QUFDbEMsdUJBQWEsS0FBSyxnQkFBZ0I7QUFDbEMsY0FBSSxjQUFjO0FBQ2QseUJBQWEsS0FBSyxtQ0FBbUM7QUFBQSxVQUN6RDtBQUFBLFFBQ0o7QUFBQSxNQUNKO0FBRUEsYUFBTyxhQUFhLEtBQUssSUFBSTtBQUFBLElBQ2pDLFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSxvQ0FBb0MsS0FBSyxJQUFJLEtBQUssS0FBSztBQUNyRSxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsbUJBQW1CLFFBQW1EO0FBNVB4RjtBQTZQUSxRQUFJO0FBQ0EsWUFBTSxFQUFFLE1BQU0sU0FBUyxJQUFJO0FBRzNCLFVBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLEtBQUssSUFBSSxHQUFHO0FBQzNELGdCQUFRLEtBQUssMkJBQTBCLDZCQUFNLFNBQVEsU0FBUyxFQUFFO0FBQ2hFLGVBQU87QUFBQSxNQUNYO0FBRUEsVUFBSSxVQUFVO0FBRVYsY0FBTSxRQUFRLEtBQUssSUFBSSxjQUFjLGFBQWEsSUFBSTtBQUN0RCxhQUFJLCtCQUFPLGdCQUFlLE1BQU0sWUFBWSxRQUFRLEdBQUc7QUFDbkQsaUJBQU8sTUFBTSxLQUFLLFFBQVEsTUFBTSxRQUFRO0FBQUEsRUFBSyxNQUFNLFlBQVksUUFBUSxDQUFDO0FBQUEsUUFDNUU7QUFDQSxlQUFPO0FBQUEsTUFDWCxPQUFPO0FBRUgsZUFBTyxLQUFLLHVCQUF1QixJQUFJO0FBQUEsTUFDM0M7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSxpQ0FBK0Isc0NBQVEsU0FBUixtQkFBYyxTQUFRLGNBQWMsS0FBSyxLQUFLO0FBQzNGLGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsU0FBUyxZQUFrQztBQUUvQyxRQUFJLE9BQU8sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFVBQVU7QUFFMUQsUUFBSSxDQUFDLFFBQVEsRUFBRSxnQkFBZ0Isd0JBQVE7QUFFbkMsYUFBTyxLQUFLLElBQUksTUFBTSxzQkFBc0IsYUFBYSxLQUFLO0FBQUEsSUFDbEU7QUFFQSxRQUFJLENBQUMsUUFBUSxFQUFFLGdCQUFnQix3QkFBUTtBQUVuQyxZQUFNLFFBQVEsS0FBSyxJQUFJLE1BQU0saUJBQWlCO0FBQzlDLGFBQU8sTUFBTTtBQUFBLFFBQUssT0FDZCxFQUFFLGFBQWEsY0FDZixFQUFFLFNBQVMsY0FDWCxFQUFFLEtBQUssU0FBUyxNQUFNLFVBQVUsS0FDaEMsRUFBRSxLQUFLLFNBQVMsTUFBTSxhQUFhLEtBQUs7QUFBQSxNQUM1QyxLQUFLO0FBQUEsSUFDVDtBQUVBLFdBQU8sZ0JBQWdCLHdCQUFRLE9BQU87QUFBQSxFQUMxQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQXVCLFVBQXdCO0FBQzNDLFNBQUssa0JBQWtCLE9BQU8sUUFBUTtBQUFBLEVBQzFDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBcUIsVUFBdUM7QUFDeEQsV0FBTyxLQUFLLGtCQUFrQixJQUFJLFFBQVEsS0FBSyxDQUFDO0FBQUEsRUFDcEQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUFvQixVQUFrQixhQUEyQjtBQUM3RCxVQUFNLFVBQVUsS0FBSyxrQkFBa0IsSUFBSSxRQUFRLEtBQUssQ0FBQztBQUN6RCxVQUFNLFdBQVcsUUFBUSxPQUFPLFNBQU8sSUFBSSxLQUFLLFNBQVMsV0FBVztBQUVwRSxRQUFJLFNBQVMsU0FBUyxHQUFHO0FBQ3JCLFdBQUssa0JBQWtCLElBQUksVUFBVSxRQUFRO0FBQUEsSUFDakQsT0FBTztBQUNILFdBQUssa0JBQWtCLE9BQU8sUUFBUTtBQUFBLElBQzFDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZUFBZSxNQUFzQjtBQUV6QyxXQUFPLEtBQUssS0FBSyxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQ3BDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBcUIsU0FJbkI7QUFDRSxVQUFNLFdBQVcsUUFBUSxlQUFlO0FBQ3hDLFVBQU0sYUFBYSxLQUFLLE1BQU8sUUFBUSxhQUFhLEtBQUssY0FBZSxHQUFHO0FBRTNFLFFBQUksWUFBWTtBQUNoQixRQUFJLFVBQVUsWUFBWSxRQUFRLFlBQVksYUFBYSxJQUFJLE1BQU0sRUFBRSxNQUFNLFFBQVEsVUFBVTtBQUUvRixRQUFJLFFBQVEsYUFBYTtBQUNyQixtQkFBYTtBQUNiLGlCQUFXO0FBQUEsSUFDZjtBQUVBLFVBQU0sT0FBTyxHQUFHLFFBQVEsU0FBUyxVQUFVO0FBRTNDLFdBQU8sRUFBRSxNQUFNLFdBQVcsUUFBUTtBQUFBLEVBQ3RDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx3QkFBd0IsU0FBb0M7QUFDeEQsVUFBTSxRQUFrQixDQUFDO0FBR3pCLGVBQVcsT0FBTyxRQUFRLGdCQUFnQjtBQUN0QyxZQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssUUFBUSxHQUFHLElBQUksV0FBVyxJQUFJLElBQUksUUFBUSxLQUFLLEVBQUUsRUFBRTtBQUFBLElBQzlFO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFDSjs7O0FGcFhPLElBQU0seUJBQXlCO0FBRS9CLElBQU0sa0JBQU4sY0FBOEIsMEJBQVM7QUFBQSxFQXdCN0MsWUFBWSxNQUFxQixRQUFvQjtBQUNwRCxVQUFNLElBQUk7QUFsQlgsU0FBUSxjQUE0QjtBQUVwQyxTQUFRLHFCQUFvQyxDQUFDO0FBQzdDLFNBQVEsdUJBQStCO0FBRXZDLFNBQVEsdUJBQWdDO0FBTXhDLFNBQVEsaUJBQXlDO0FBR2pEO0FBQUEsU0FBUSx5QkFBK0YsQ0FBQztBQUN4RyxTQUFRLFdBQTZCLENBQUM7QUFJckMsU0FBSyxTQUFTO0FBQ2QsU0FBSyxrQkFBa0IsSUFBSSx1QkFBdUIsS0FBSyxHQUFHO0FBQUEsRUFDM0Q7QUFBQSxFQUVBLGNBQWM7QUFDYixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEsaUJBQWlCO0FBQ2hCLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxVQUFVO0FBQ1QsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLE1BQU0sU0FBUztBQUNkLFVBQU0sWUFBWSxLQUFLLFlBQVksU0FBUyxDQUFDO0FBQzdDLGNBQVUsTUFBTTtBQUNoQixjQUFVLFNBQVMsd0JBQXdCO0FBSzNDLFVBQU0sWUFBWSxVQUFVLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUM3RCxjQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBS1AsMEJBQVMsZUFBZSxTQUFTLEdBQUc7QUFBQTtBQUl2RCxVQUFNLFdBQVcsVUFBVSxVQUFVLEVBQUUsS0FBSyxjQUFjLENBQUM7QUFDM0QsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVV6QixVQUFNLFVBQVUsU0FBUyxTQUFTLElBQUk7QUFDdEMsWUFBUSxNQUFNLFVBQVU7QUFDeEIsWUFBUSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFhcEIsVUFBTSxpQkFBaUIsU0FBUyxVQUFVO0FBQzFDLG1CQUFlLE1BQU0sVUFBVTtBQUcvQixTQUFLLHVCQUF1QixjQUFjO0FBRzFDLFVBQU0sY0FBYyxJQUFJLGlDQUFnQixjQUFjO0FBQ3RELGdCQUFZLFFBQVEsUUFBUSxFQUMxQixXQUFXLDRCQUE0QixFQUN2QyxRQUFRLE1BQU0sS0FBSyxVQUFVLENBQUM7QUFFaEMsU0FBSyxvQkFBb0IsU0FBUztBQUNsQyxTQUFLLHFCQUFxQixTQUFTO0FBR25DLFNBQUs7QUFBQSxNQUNKLEtBQUssSUFBSSxVQUFVLEdBQUcsc0JBQXNCLE1BQU07QUFDakQsYUFBSyw4QkFBOEI7QUFBQSxNQUNwQyxDQUFDO0FBQUEsSUFDRjtBQUdBLFNBQUssOEJBQThCO0FBQUEsRUFDcEM7QUFBQSxFQUVBLE1BQU0sVUFBVTtBQXhIakI7QUEwSEUsU0FBSyxVQUFhLDRCQUFiLG1CQUFzQyxTQUFTO0FBQ25ELE1BQUMsS0FBYSx3QkFBd0IsUUFBUTtBQUFBLElBQy9DO0FBR0EsUUFBSSxLQUFLLHNCQUFzQjtBQUM5QixXQUFLLHFCQUFxQixRQUFRO0FBQUEsSUFDbkM7QUFHQSxTQUFLLHNCQUFzQjtBQUczQixTQUFLLGNBQWM7QUFHbkIsU0FBSyxtQkFBbUI7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esd0JBQXdCLFNBQXNCLE9BQWUsU0FBOEI7QUFDbEcsWUFBUSxpQkFBaUIsT0FBTyxPQUFPO0FBQ3ZDLFNBQUssdUJBQXVCLEtBQUssRUFBRSxTQUFTLE9BQU8sUUFBUSxDQUFDO0FBQUEsRUFDN0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixVQUFzQixPQUErQjtBQUM5RSxVQUFNLEtBQUssV0FBVyxNQUFNO0FBQzNCLGVBQVM7QUFDVCxXQUFLLFdBQVcsS0FBSyxTQUFTLE9BQU8sT0FBSyxNQUFNLEVBQUU7QUFBQSxJQUNuRCxHQUFHLEtBQUs7QUFDUixTQUFLLFNBQVMsS0FBSyxFQUFFO0FBQ3JCLFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx3QkFBOEI7QUFDckMsU0FBSyx1QkFBdUIsUUFBUSxDQUFDLEVBQUUsU0FBUyxPQUFPLFFBQVEsTUFBTTtBQUNwRSxjQUFRLG9CQUFvQixPQUFPLE9BQU87QUFBQSxJQUMzQyxDQUFDO0FBQ0QsU0FBSyx5QkFBeUIsQ0FBQztBQUFBLEVBQ2hDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBc0I7QUFDN0IsU0FBSyxTQUFTLFFBQVEsUUFBTSxhQUFhLEVBQUUsQ0FBQztBQUM1QyxTQUFLLFdBQVcsQ0FBQztBQUFBLEVBQ2xCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxxQkFBMkI7QUFDbEMsU0FBSyxxQkFBcUIsQ0FBQztBQUMzQixRQUFJLEtBQUssa0JBQWtCO0FBQzFCLFdBQUssaUJBQWlCLE9BQU87QUFBQSxJQUM5QjtBQUNBLFFBQUksS0FBSyxlQUFlO0FBQ3ZCLFdBQUssY0FBYyxNQUFNO0FBQUEsSUFDMUI7QUFDQSxRQUFJLEtBQUssYUFBYTtBQUNyQixXQUFLLFlBQVksT0FBTztBQUFBLElBQ3pCO0FBQUEsRUFDRDtBQUFBLEVBRVEsb0JBQW9CLFdBQXdCO0FBQ25ELFNBQUssZ0JBQWdCLFVBQVUsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDdkUsU0FBSyxjQUFjLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFXbkMsU0FBSyxrQkFBa0I7QUFBQSxFQUN4QjtBQUFBLEVBRVEscUJBQXFCLFdBQXdCO0FBQ3BELFNBQUssaUJBQWlCLFVBQVUsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDekUsU0FBSyxnQkFBZ0I7QUFBQSxFQUN0QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esa0JBQWtCO0FBRXpCLFNBQUssZUFBZSxNQUFNO0FBRTFCLFNBQUssZUFBZSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBV3BDLFVBQU0sV0FBVyxLQUFLLGVBQWUsVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDeEUsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU96QixVQUFNLG9CQUFvQixTQUFTLFVBQVU7QUFDN0Msc0JBQWtCLE1BQU0sVUFBVTtBQUNsQyxTQUFLLFdBQVcsSUFBSSxtQ0FBa0IsaUJBQWlCO0FBQ3ZELFNBQUssU0FBUyxlQUFlLHdDQUF3QztBQUdyRSxVQUFNLGFBQWE7QUFDbkIsVUFBTSxrQkFBa0I7QUFDeEIsVUFBTSxjQUFjO0FBQ3BCLFVBQU0sWUFBWSwwQkFBUyxXQUFXLElBQUk7QUFDMUMsVUFBTSxXQUFXLDBCQUFTLFdBQVcsSUFBSTtBQUd6QyxVQUFNLFdBQVcsV0FBVyxpQkFBaUIsU0FBUyxlQUFlLEVBQUUsaUJBQWlCLGtCQUFrQixLQUFLLE1BQU07QUFDckgsVUFBTSxnQkFBaUIsWUFBWSxhQUFhLFdBQVksa0JBQWtCO0FBRTlFLFNBQUssU0FBUyxRQUFRLE1BQU0sVUFBVTtBQUFBO0FBQUEsaUJBRXZCLGFBQWE7QUFBQSxpQkFDWixXQUFXLGFBQWEsV0FBWSxrQkFBa0IsV0FBVztBQUFBLGFBQ3RFLGFBQWE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsa0JBTVIsVUFBVTtBQUFBO0FBQUE7QUFBQTtBQU0xQixTQUFLLG1CQUFtQixNQUFNO0FBQzdCLFlBQU0sS0FBSyxLQUFLLFNBQVM7QUFHekIsU0FBRyxNQUFNLFNBQVM7QUFHbEIsWUFBTSxnQkFBZ0IsR0FBRztBQUN6QixZQUFNLFlBQVk7QUFDbEIsWUFBTSxZQUFhLFdBQVcsYUFBYSxXQUFZLGtCQUFrQjtBQUd6RSxZQUFNLFlBQVksS0FBSyxJQUFJLFdBQVcsS0FBSyxJQUFJLGVBQWUsU0FBUyxDQUFDO0FBR3hFLFNBQUcsTUFBTSxTQUFTLEdBQUcsU0FBUztBQUc5QixTQUFHLE1BQU0sWUFBWSxnQkFBZ0IsWUFBWSxTQUFTO0FBQUEsSUFDM0Q7QUFHQSxTQUFLLFNBQVMsUUFBUSxpQkFBaUIsU0FBUyxLQUFLLGdCQUFnQjtBQUdyRSxlQUFXLEtBQUssa0JBQWtCLENBQUM7QUFHbkMsU0FBSyx1QkFBdUIsSUFBSSx5QkFBeUIsS0FBSyxLQUFLLEtBQUssU0FBUyxPQUFPO0FBR3hGLFNBQUssU0FBUyxRQUFRLGlCQUFpQixTQUFTLE1BQU07QUFDckQsV0FBSyx5QkFBeUI7QUFBQSxJQUMvQixDQUFDO0FBR0QsU0FBSyxnQkFBZ0IsSUFBSSxpQ0FBZ0IsUUFBUTtBQUNqRCxTQUFLLGNBQWMsUUFBUSxLQUFLO0FBQ2hDLFNBQUssY0FBYyxXQUFXLFVBQVU7QUFDeEMsU0FBSyxjQUFjLFFBQVEsTUFBTSxLQUFLLGtCQUFrQixDQUFDO0FBQ3pELFNBQUssY0FBYyxTQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBSWhDLEtBQUssd0JBQXdCLElBQUksU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUzVELFNBQUssYUFBYSxJQUFJLGlDQUFnQixRQUFRO0FBQzlDLFNBQUssV0FBVyxRQUFRLE1BQU07QUFDOUIsU0FBSyxXQUFXLFdBQVcsY0FBYztBQUN6QyxTQUFLLFdBQVcsT0FBTztBQUN2QixTQUFLLFdBQVcsUUFBUSxNQUFNLEtBQUssV0FBVyxDQUFDO0FBQy9DLFNBQUssV0FBVyxTQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVl6QyxTQUFLLFNBQVMsUUFBUSxpQkFBaUIsV0FBVyxDQUFDLFVBQVU7QUFDNUQsVUFBSSxNQUFNLFFBQVEsV0FBVyxDQUFDLE1BQU0sVUFBVTtBQUM3QyxjQUFNLGVBQWU7QUFDckIsYUFBSyw2QkFBNkIsS0FBSyxLQUFLLFdBQVc7QUFBQSxNQUN4RCxXQUFXLE1BQU0sUUFBUSxVQUFVO0FBQ2xDLGFBQUssa0JBQWtCO0FBQUEsTUFDeEIsV0FBVyxNQUFNLFFBQVEsZUFBZSxNQUFNLFFBQVEsV0FBVztBQUNoRSxZQUFJLEtBQUssdUJBQXVCLEdBQUc7QUFDbEMsZ0JBQU0sZUFBZTtBQUNyQixlQUFLLHNCQUFzQixNQUFNLFFBQVEsY0FBYyxJQUFJLEVBQUU7QUFBQSxRQUM5RDtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLFNBQVMsUUFBUSxpQkFBaUIsU0FBUyxNQUFNO0FBQ3JELFdBQUssa0JBQWtCO0FBQUEsSUFDeEIsQ0FBQztBQUdELFNBQUssb0JBQW9CO0FBR3pCLFNBQUssa0JBQWtCO0FBR3ZCLFNBQUssdUJBQXVCO0FBQzVCLFNBQUssaUJBQWlCLEtBQUsscUJBQXFCO0FBQUEsRUFDakQ7QUFBQSxFQUVRLFdBQVcsTUFBdUMsU0FBaUI7QUFDMUUsVUFBTSxZQUFZLEtBQUssY0FBYyxVQUFVLEVBQUUsS0FBSyw2QkFBNkIsSUFBSSxHQUFHLENBQUM7QUFDM0YsY0FBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEtBS3ZCLFNBQVMsU0FDUiw0RkFDQSxTQUFTLFdBQ1Qsa0lBQ0EsNkZBQ0g7QUFBQTtBQUdELFVBQU0sU0FBUyxVQUFVLFNBQVMsT0FBTztBQUFBLE1BQ3hDLE1BQU0sU0FBUyxTQUFTLFFBQVEsU0FBUyxXQUFXLFdBQVc7QUFBQSxNQUMvRCxLQUFLO0FBQUEsSUFDTixDQUFDO0FBQ0QsV0FBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3ZCLFVBQU0sWUFBWSxVQUFVLFNBQVMsT0FBTyxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFFM0UsUUFBSSxTQUFTLFlBQVksUUFBUSxTQUFTLE1BQU0sR0FBRztBQUNsRCxnQkFBVSxZQUFZO0FBQUEsSUFDdkIsT0FBTztBQUNOLGdCQUFVLGNBQWM7QUFBQSxJQUN6QjtBQUdBLGVBQVcsTUFBTTtBQUNoQixXQUFLLGNBQWMsU0FBUztBQUFBLFFBQzNCLEtBQUssS0FBSyxjQUFjO0FBQUEsUUFDeEIsVUFBVTtBQUFBLE1BQ1gsQ0FBQztBQUFBLElBQ0YsR0FBRyxFQUFFO0FBQUEsRUFDTjtBQUFBLEVBRVEsa0JBQWtCLFNBQWtCO0FBQzNDLFVBQU0sWUFBWSxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssZUFBZSxDQUFDO0FBQ3RFLGNBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWMxQixVQUFNLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ3RFLGtCQUFjLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPOUIsa0JBQWMsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWUxQixVQUFNLGdCQUFnQixVQUFVLFVBQVU7QUFDMUMsa0JBQWMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBSzlCLFVBQU0sVUFBVSxjQUFjLFVBQVUsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ25FLFlBQVEsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU94QixVQUFNLGFBQWEsY0FBYyxVQUFVLEVBQUUsTUFBTSxXQUFXLCtEQUErRCxDQUFDO0FBQzlILGVBQVcsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBTTNCLGVBQVcsTUFBTTtBQUNoQixXQUFLLGNBQWMsU0FBUztBQUFBLFFBQzNCLEtBQUssS0FBSyxjQUFjO0FBQUEsUUFDeEIsVUFBVTtBQUFBLE1BQ1gsQ0FBQztBQUFBLElBQ0YsR0FBRyxFQUFFO0FBQUEsRUFDTjtBQUFBLEVBRVEsb0JBQW9CLFFBQWdCO0FBQzNDLFVBQU0sY0FBYyxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbEYsZ0JBQVksTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFnQjVCLGdCQUFZLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUlyQixLQUFLLHlCQUF5QixNQUFNLENBQUM7QUFBQTtBQUl4QyxlQUFXLE1BQU07QUFDaEIsV0FBSyxjQUFjLFNBQVM7QUFBQSxRQUMzQixLQUFLLEtBQUssY0FBYztBQUFBLFFBQ3hCLFVBQVU7QUFBQSxNQUNYLENBQUM7QUFBQSxJQUNGLEdBQUcsRUFBRTtBQUFBLEVBQ047QUFBQSxFQUVRLHlCQUF5QixRQUF3QjtBQUN4RCxZQUFRLFFBQVE7QUFBQSxNQUNmLEtBQUs7QUFDSixlQUFPO0FBQUEsTUFDUixLQUFLO0FBQ0osZUFBTztBQUFBLE1BQ1IsS0FBSztBQUNKLGVBQU87QUFBQSxNQUNSLEtBQUs7QUFDSixlQUFPO0FBQUEsTUFDUixLQUFLO0FBQ0osZUFBTztBQUFBLE1BQ1I7QUFDQyxlQUFPO0FBQUEsSUFDVDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsbUJBQW1CLFNBQW1DO0FBeGhCckU7QUEwaEJFLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsZ0JBQWdCLEdBQUc7QUFDbkUsV0FBSyxXQUFXLFVBQVUsS0FBSyxrQkFBa0IsT0FBTyxrSEFBa0gsQ0FBQztBQUMzSyxhQUFPO0FBQUEsSUFDUjtBQUVBLFVBQU0sVUFBVSxRQUFRLE1BQU0sQ0FBQyxFQUFFLFlBQVk7QUFHN0MsVUFBTSxtQkFBMkM7QUFBQSxNQUNoRCxVQUFVO0FBQUEsTUFDVixXQUFXO0FBQUEsTUFDWCxVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsSUFDWDtBQUVBLFFBQUksaUJBQWlCLE9BQU8sR0FBRztBQUM5QixZQUFNLGFBQWEsaUJBQWlCLE9BQU87QUFDM0MsWUFBTSxLQUFLLE9BQU8sV0FBVyxtQkFBbUIsVUFBVTtBQUMxRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLFdBQUssV0FBVyxVQUFVLEtBQUssa0JBQWtCLGNBQWMsZUFBZSxLQUFLLHVCQUF1QixVQUFVLENBQUMsRUFBRSxDQUFDO0FBQ3hILGFBQU87QUFBQSxJQUNSO0FBR0EsUUFBSSxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsaUJBQWlCLEdBQUc7QUFDbkUsWUFBTSxpQkFBZ0IsVUFBSyxPQUFPLFNBQVMsbUJBQXJCLG1CQUFxQyxLQUFLLFNBQU8sSUFBSSxZQUFZO0FBQ3ZGLFVBQUksZUFBZTtBQUVsQixhQUFLLFNBQVMsU0FBUyxjQUFjLFFBQVE7QUFFN0MsbUJBQVcsTUFBTSxLQUFLLGlCQUFpQixHQUFHLENBQUM7QUFDM0MsYUFBSyxXQUFXLFVBQVUsS0FBSyxrQkFBa0IsUUFBUSxvQkFBb0IsY0FBYyxJQUFJLEVBQUUsQ0FBQztBQUNsRyxlQUFPO0FBQUEsTUFDUjtBQUFBLElBQ0Q7QUFHQSxTQUFLLFdBQVcsVUFBVSxLQUFLLGtCQUFrQixlQUFlLHFCQUFxQixPQUFPLCtDQUErQyxDQUFDO0FBQzVJLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFUSxzQkFBNEI7QUFDbkMsU0FBSyxnQkFBZ0IsS0FBSyxlQUFlLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ2pGLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFlcEM7QUFBQSxFQUVRLG9CQUEwQjtBQUNqQyxVQUFNLFFBQVEsS0FBSyxTQUFTLFNBQVM7QUFFckMsUUFBSSxNQUFNLFdBQVcsR0FBRyxLQUFLLEtBQUssT0FBTyxlQUFlLGlCQUFpQixnQkFBZ0IsR0FBRztBQUMzRixZQUFNLFFBQVEsTUFBTSxNQUFNLENBQUMsRUFBRSxZQUFZO0FBQ3pDLFdBQUssa0JBQWtCLEtBQUs7QUFBQSxJQUM3QixPQUFPO0FBQ04sV0FBSyxrQkFBa0I7QUFBQSxJQUN4QjtBQUFBLEVBQ0Q7QUFBQSxFQUVRLGtCQUFrQixPQUFxQjtBQUM5QyxVQUFNLFdBQVcsS0FBSyxxQkFBcUIsRUFBRTtBQUFBLE1BQU8sU0FDbkQsSUFBSSxRQUFRLFlBQVksRUFBRSxTQUFTLEtBQUssS0FBSyxJQUFJLEtBQUssWUFBWSxFQUFFLFNBQVMsS0FBSztBQUFBLElBQ25GO0FBRUEsU0FBSyxjQUFjLE1BQU07QUFDekIsU0FBSyxxQkFBcUIsQ0FBQztBQUMzQixTQUFLLHVCQUF1QjtBQUU1QixRQUFJLFNBQVMsV0FBVyxHQUFHO0FBQzFCLFdBQUssa0JBQWtCO0FBQ3ZCO0FBQUEsSUFDRDtBQUVBLGFBQVMsUUFBUSxDQUFDLFNBQVMsVUFBVTtBQUNwQyxZQUFNLE9BQU8sS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ3RFLFdBQUssTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFTckIsWUFBTSxZQUFZLEtBQUssV0FBVyxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDakUsZ0JBQVUsY0FBYyxJQUFJLFFBQVEsT0FBTztBQUMzQyxnQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVMxQixZQUFNLFNBQVMsS0FBSyxXQUFXLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUMzRCxhQUFPLGNBQWMsUUFBUTtBQUM3QixhQUFPLE1BQU0sVUFBVTtBQUV2QixVQUFJLFFBQVEsYUFBYTtBQUN4QixjQUFNLFNBQVMsS0FBSyxXQUFXLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUMzRCxlQUFPLGNBQWMsUUFBUTtBQUM3QixlQUFPLE1BQU0sVUFBVTtBQUFBLE1BQ3hCO0FBRUEsV0FBSyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3BDLGFBQUssY0FBYyxRQUFRLE9BQU87QUFBQSxNQUNuQyxDQUFDO0FBRUQsV0FBSyxpQkFBaUIsY0FBYyxNQUFNO0FBQ3pDLGFBQUssbUJBQW1CLEtBQUs7QUFBQSxNQUM5QixDQUFDO0FBRUQsV0FBSyxtQkFBbUIsS0FBSyxJQUFJO0FBQUEsSUFDbEMsQ0FBQztBQUVELFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQSxFQUNwQztBQUFBLEVBRVEsb0JBQTBCO0FBQ2pDLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFDbkMsU0FBSyx1QkFBdUI7QUFBQSxFQUM3QjtBQUFBLEVBRVEseUJBQWtDO0FBQ3pDLFdBQU8sS0FBSyxjQUFjLE1BQU0sWUFBWTtBQUFBLEVBQzdDO0FBQUEsRUFFUSxzQkFBc0IsV0FBeUI7QUFDdEQsUUFBSSxLQUFLLG1CQUFtQixXQUFXLEVBQUc7QUFFMUMsVUFBTSxXQUFXLEtBQUssSUFBSSxHQUFHLEtBQUs7QUFBQSxNQUNqQyxLQUFLLG1CQUFtQixTQUFTO0FBQUEsTUFDakMsS0FBSyx1QkFBdUI7QUFBQSxJQUM3QixDQUFDO0FBRUQsU0FBSyxtQkFBbUIsUUFBUTtBQUFBLEVBQ2pDO0FBQUEsRUFFUSxtQkFBbUIsT0FBcUI7QUFFL0MsU0FBSyxtQkFBbUIsUUFBUSxVQUFRO0FBQ3ZDLFdBQUssTUFBTSxrQkFBa0I7QUFBQSxJQUM5QixDQUFDO0FBRUQsU0FBSyx1QkFBdUI7QUFFNUIsUUFBSSxTQUFTLEtBQUssUUFBUSxLQUFLLG1CQUFtQixRQUFRO0FBQ3pELFdBQUssbUJBQW1CLEtBQUssRUFBRSxNQUFNLGtCQUFrQjtBQUN2RCxXQUFLLG1CQUFtQixLQUFLLEVBQUUsZUFBZSxFQUFFLE9BQU8sVUFBVSxDQUFDO0FBQUEsSUFDbkU7QUFBQSxFQUNEO0FBQUEsRUFFUSwrQkFBd0M7QUFDL0MsUUFBSSxDQUFDLEtBQUssdUJBQXVCLEtBQUssS0FBSyx5QkFBeUIsSUFBSTtBQUN2RSxhQUFPO0FBQUEsSUFDUjtBQUVBLFVBQU0sV0FBVyxLQUFLLHFCQUFxQjtBQUMzQyxVQUFNLGtCQUFrQixTQUFTLEtBQUssb0JBQW9CO0FBRTFELFFBQUksaUJBQWlCO0FBQ3BCLFdBQUssY0FBYyxnQkFBZ0IsT0FBTztBQUMxQyxhQUFPO0FBQUEsSUFDUjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFUSxjQUFjLFNBQXVCO0FBQzVDLFNBQUssU0FBUyxTQUFTLElBQUksT0FBTyxFQUFFO0FBQ3BDLFNBQUssa0JBQWtCO0FBRXZCLFNBQUssV0FBVztBQUFBLEVBQ2pCO0FBQUEsRUFFUSx1QkFBcUY7QUFDNUYsVUFBTSxXQUF5RTtBQUFBLE1BQzlFLEVBQUUsU0FBUyxVQUFVLE1BQU0sb0JBQW9CLGFBQWEsc0JBQXNCO0FBQUEsTUFDbEYsRUFBRSxTQUFTLFdBQVcsTUFBTSxxQkFBcUIsYUFBYSxvQkFBb0I7QUFBQSxNQUNsRixFQUFFLFNBQVMsVUFBVSxNQUFNLG9CQUFvQixhQUFhLG1CQUFtQjtBQUFBLE1BQy9FLEVBQUUsU0FBUyxVQUFVLE1BQU0sb0JBQW9CLGFBQWEsa0JBQWtCO0FBQUEsSUFDL0U7QUFHQSxRQUFJLEtBQUssT0FBTyxlQUFlLGlCQUFpQixpQkFBaUIsR0FBRztBQUNuRSxZQUFNLGlCQUFpQixLQUFLLE9BQU8sU0FBUyxrQkFBa0IsQ0FBQztBQUMvRCxxQkFBZSxRQUFRLFNBQU87QUFDN0IsaUJBQVMsS0FBSztBQUFBLFVBQ2IsU0FBUyxJQUFJO0FBQUEsVUFDYixNQUFNLElBQUk7QUFBQSxVQUNWLEdBQUksSUFBSSxlQUFlLEVBQUUsYUFBYSxJQUFJLFlBQVk7QUFBQSxRQUN2RCxDQUFDO0FBQUEsTUFDRixDQUFDO0FBQUEsSUFDRjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFUSxvQkFBMEI7QUFDakMsU0FBSyxjQUFjLEtBQUssZUFBZSxVQUFVLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUM3RSxTQUFLLFlBQVksTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlCakMsVUFBTSwwQkFBeUMsQ0FBQyxVQUFpQjtBQUNoRSxVQUFJLENBQUMsS0FBSyxZQUFZLFNBQVMsTUFBTSxNQUFjLEtBQ2xELENBQUMsS0FBSyxjQUFjLFNBQVMsU0FBUyxNQUFNLE1BQWMsR0FBRztBQUM3RCxhQUFLLGdCQUFnQjtBQUFBLE1BQ3RCO0FBQUEsSUFDRDtBQUNBLFNBQUssd0JBQXdCLFVBQVUsU0FBUyx1QkFBdUI7QUFBQSxFQUN4RTtBQUFBLEVBRVEsb0JBQTBCO0FBQ2pDLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsZ0JBQWdCLEdBQUc7QUFDbkUsV0FBSyxXQUFXLFVBQVUsS0FBSyxrQkFBa0IsT0FBTywrR0FBK0csQ0FBQztBQUN4SztBQUFBLElBQ0Q7QUFFQSxRQUFJLEtBQUssc0JBQXNCO0FBQzlCLFdBQUssZ0JBQWdCO0FBQUEsSUFDdEIsT0FBTztBQUNOLFdBQUssZ0JBQWdCO0FBQUEsSUFDdEI7QUFBQSxFQUNEO0FBQUEsRUFFUSxrQkFBd0I7QUFDL0IsVUFBTSxXQUFXLEtBQUsscUJBQXFCO0FBRTNDLFNBQUssWUFBWSxNQUFNO0FBR3ZCLFVBQU0sV0FBVyxLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssMkJBQTJCLENBQUM7QUFDL0UsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPekIsYUFBUyxZQUFZLEtBQUssaUJBQWlCLEtBQUssSUFBSTtBQUdwRCxhQUFTLFFBQVEsYUFBVztBQUMzQixZQUFNLE9BQU8sS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ3pFLFdBQUssTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVVyQixZQUFNLFNBQVMsS0FBSyxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUMvRCxhQUFPLGNBQWMsUUFBUTtBQUM3QixhQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUt2QixZQUFNLFlBQVksS0FBSyxVQUFVLEVBQUUsS0FBSyw0QkFBNEIsQ0FBQztBQUNyRSxnQkFBVSxjQUFjLElBQUksUUFBUSxPQUFPO0FBQzNDLGdCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPMUIsVUFBSSxRQUFRLGFBQWE7QUFDeEIsY0FBTSxTQUFTLEtBQUssVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDL0QsZUFBTyxjQUFjLFFBQVE7QUFDN0IsZUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUl4QjtBQUVBLFdBQUssaUJBQWlCLGNBQWMsTUFBTTtBQUN6QyxhQUFLLE1BQU0sa0JBQWtCO0FBQUEsTUFDOUIsQ0FBQztBQUVELFdBQUssaUJBQWlCLGNBQWMsTUFBTTtBQUN6QyxhQUFLLE1BQU0sa0JBQWtCO0FBQUEsTUFDOUIsQ0FBQztBQUVELFdBQUssaUJBQWlCLFNBQVMsTUFBTTtBQUNwQyxhQUFLLHVCQUF1QixRQUFRLE9BQU87QUFBQSxNQUM1QyxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUEsRUFFUSxrQkFBd0I7QUFDL0IsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUEsRUFFUSx1QkFBdUIsU0FBdUI7QUFDckQsU0FBSyxnQkFBZ0I7QUFHckIsU0FBSyxTQUFTLFNBQVMsSUFBSSxPQUFPLEVBQUU7QUFDcEMsU0FBSyxXQUFXO0FBQUEsRUFDakI7QUFBQSxFQUVRLHlCQUErQjtBQUV0QyxRQUFJLENBQUMsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLG1CQUFtQixHQUFHO0FBQ3RFO0FBQUEsSUFDRDtBQUVBLFNBQUssbUJBQW1CLEtBQUssZUFBZSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUN2RixTQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBV3ZDO0FBQUEsRUFFUSx1QkFBb0M7QUFFM0MsUUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUV0RSxhQUFPLFNBQVMsY0FBYyxLQUFLO0FBQUEsSUFDcEM7QUFHQSxVQUFNLG1CQUFtQixLQUFLLGVBQWUsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDdEYscUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWNqQyxVQUFNLGNBQWMsaUJBQWlCLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBQ3BGLGdCQUFZLFlBQVksS0FBSyxpQkFBaUIsV0FBVyxJQUFJO0FBQzdELGdCQUFZLE1BQU0sVUFBVTtBQUU1QixVQUFNLGNBQWMsaUJBQWlCLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBQ3BGLGdCQUFZLE1BQU0sVUFBVTtBQUU1QixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRVEsMkJBQWlDO0FBajZCMUM7QUFrNkJFLFFBQUksQ0FBQyxLQUFLLGtCQUFrQixDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUM5RjtBQUFBLElBQ0Q7QUFFQSxVQUFNLFVBQVUsS0FBSyxTQUFTLFNBQVM7QUFDdkMsUUFBSSxDQUFDLFNBQVM7QUFDYixXQUFLLGVBQWUsTUFBTSxVQUFVO0FBQ3BDO0FBQUEsSUFDRDtBQUlBLFVBQU0sYUFBYTtBQUNuQixVQUFNLFlBQXNELENBQUM7QUFDN0QsUUFBSTtBQUVKLFlBQVEsUUFBUSxXQUFXLEtBQUssT0FBTyxPQUFPLE1BQU07QUFDbkQsWUFBTSxVQUFVLE1BQU0sQ0FBQztBQUN2QixZQUFNLFdBQVcsTUFBTSxDQUFDO0FBR3hCLFlBQU0sT0FBTyxLQUFLLGVBQWUsT0FBTztBQUN4QyxVQUFJLE1BQU07QUFDVCxrQkFBVSxLQUFLO0FBQUEsVUFDZCxNQUFNO0FBQUEsVUFDTjtBQUFBLFFBQ0QsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNEO0FBR0EsVUFBTSxpQkFBaUIsS0FBSyxnQkFBZ0IsdUJBQXFCLFVBQUssZ0JBQUwsbUJBQWtCLFNBQVEsRUFBRTtBQUM3RixtQkFBZSxRQUFRLFNBQU87QUFFN0IsWUFBTSxTQUFTLFVBQVUsS0FBSyxTQUFPLElBQUksU0FBUyxJQUFJLEtBQUssUUFBUTtBQUNuRSxVQUFJLENBQUMsUUFBUTtBQUNaLGtCQUFVLEtBQUs7QUFBQSxVQUNkLE1BQU0sSUFBSSxLQUFLO0FBQUEsVUFDZixVQUFVLElBQUk7QUFBQSxRQUNmLENBQUM7QUFBQSxNQUNGO0FBQUEsSUFDRCxDQUFDO0FBR0QsUUFBSSxVQUFVLFNBQVMsR0FBRztBQUN6QixZQUFNLGNBQWMsS0FBSyxlQUFlLGNBQWMsNEJBQTRCO0FBQ2xGLFVBQUksYUFBYTtBQUNoQixjQUFNLFdBQVcsVUFBVSxJQUFJLFNBQU87QUFDckMsZ0JBQU0sU0FBUyxJQUFJLFdBQVcsSUFBSSxJQUFJLFFBQVEsS0FBSztBQUNuRCxpQkFBTyxHQUFHLElBQUksSUFBSSxHQUFHLE1BQU07QUFBQSxRQUM1QixDQUFDO0FBQ0Qsb0JBQVksY0FBYyxTQUFTLEtBQUssSUFBSTtBQUFBLE1BQzdDO0FBQ0EsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLElBQ3JDLE9BQU87QUFDTixXQUFLLGVBQWUsTUFBTSxVQUFVO0FBQUEsSUFDckM7QUFBQSxFQUNEO0FBQUEsRUFFUSxlQUFlLFlBQWtDO0FBRXhELFFBQUksT0FBTyxLQUFLLElBQUksTUFBTSxzQkFBc0IsVUFBVTtBQUUxRCxRQUFJLENBQUMsUUFBUSxFQUFFLGdCQUFnQix5QkFBUTtBQUV0QyxhQUFPLEtBQUssSUFBSSxNQUFNLHNCQUFzQixhQUFhLEtBQUs7QUFBQSxJQUMvRDtBQUVBLFFBQUksQ0FBQyxRQUFRLEVBQUUsZ0JBQWdCLHlCQUFRO0FBRXRDLFlBQU0sUUFBUSxLQUFLLElBQUksTUFBTSxpQkFBaUI7QUFDOUMsYUFBTyxNQUFNO0FBQUEsUUFBSyxPQUNqQixFQUFFLGFBQWEsY0FDZixFQUFFLFNBQVMsY0FDWCxFQUFFLEtBQUssU0FBUyxNQUFNLFVBQVUsS0FDaEMsRUFBRSxLQUFLLFNBQVMsTUFBTSxhQUFhLEtBQUs7QUFBQSxNQUN6QyxLQUFLO0FBQUEsSUFDTjtBQUVBLFdBQU8sZ0JBQWdCLHlCQUFRLE9BQU87QUFBQSxFQUN2QztBQUFBLEVBRVEseUJBQStCO0FBQ3RDLFFBQUksQ0FBQyxLQUFLLGtCQUFrQjtBQUMzQjtBQUFBLElBQ0Q7QUFFQSxTQUFLLGlCQUFpQixNQUFNO0FBRTVCLFFBQUksQ0FBQyxLQUFLLGdCQUFnQjtBQUN6QixXQUFLLGlCQUFpQixNQUFNLFVBQVU7QUFDdEM7QUFBQSxJQUNEO0FBRUEsVUFBTSxVQUFVLEtBQUssZUFBZTtBQUVwQyxRQUFJLFFBQVEsV0FBVyxHQUFHO0FBQ3pCLFdBQUssaUJBQWlCLE1BQU0sVUFBVTtBQUN0QztBQUFBLElBQ0Q7QUFHQSxVQUFNLFdBQVcsMEJBQVM7QUFDMUIsU0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBLGNBRzFCLFdBQVcsY0FBYyxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxnQkFLakMsV0FBVyxVQUFVLE9BQU87QUFBQTtBQUFBO0FBQUE7QUFBQSxpQkFJM0IsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUd6QyxVQUFNLFlBQVksS0FBSyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDakYsY0FBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVMxQixVQUFNLGdCQUFnQixVQUFVLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBRS9FLFVBQU0sZUFBZSxLQUFLLE1BQU8sS0FBSyxlQUFlLGFBQWEsTUFBUSxHQUFHO0FBQzdFLFVBQU0sV0FBVyxRQUFRLElBQUksU0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFLE1BQU0sR0FBRyxXQUFXLElBQUksQ0FBQztBQUNoRixVQUFNLFlBQVksUUFBUSxVQUFVLFdBQVcsSUFBSSxLQUFLLEtBQUssUUFBUSxVQUFVLFdBQVcsSUFBSSxFQUFFLEtBQUs7QUFHckcsa0JBQWMsTUFBTSxVQUFVO0FBRTlCLFFBQUksVUFBVTtBQUNiLG9CQUFjLFlBQVksS0FBSyxpQkFBaUIsV0FBVyxJQUFJLElBQUksU0FBUyxLQUFLLElBQUksQ0FBQyxHQUFHLFNBQVMsS0FBSyxZQUFZO0FBQUEsSUFDcEgsT0FBTztBQUNOLG9CQUFjLFlBQVksS0FBSyxpQkFBaUIsV0FBVyxJQUFJLElBQUksU0FBUyxLQUFLLElBQUksQ0FBQyxHQUFHLFNBQVMsS0FBSyxZQUFZO0FBQUEsSUFDcEg7QUFHQSxVQUFNLG9CQUFvQixVQUFVLFdBQVcsRUFBRSxLQUFLLGdDQUFnQyxDQUFDO0FBQ3ZGLHNCQUFrQixZQUFZLEtBQUssaUJBQWlCLG1CQUFtQixXQUFXLFNBQVMsTUFBTTtBQUNqRyxzQkFBa0IsTUFBTSxVQUFVO0FBQUE7QUFBQSxnQkFFcEIsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUFBLGNBRTVCLFdBQVcsUUFBUSxLQUFLO0FBQUEsZ0JBQ3RCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU14QyxzQkFBa0IsUUFBUSxTQUFTLHlCQUF5QjtBQUc1RCxRQUFJLFVBQVU7QUFDYixnQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLDBCQUFrQixNQUFNLGFBQWE7QUFBQSxNQUN0QyxDQUFDO0FBQ0QsZ0JBQVUsaUJBQWlCLFlBQVksTUFBTTtBQUM1QyxhQUFLLGtCQUFrQixNQUFNO0FBQzVCLDRCQUFrQixNQUFNLGFBQWE7QUFBQSxRQUN0QyxHQUFHLEdBQUc7QUFBQSxNQUNQLENBQUM7QUFBQSxJQUNGLE9BQU87QUFDTixnQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLDBCQUFrQixNQUFNLGFBQWE7QUFBQSxNQUN0QyxDQUFDO0FBQ0QsZ0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QywwQkFBa0IsTUFBTSxhQUFhO0FBQUEsTUFDdEMsQ0FBQztBQUFBLElBQ0Y7QUFHQSxVQUFNLGFBQWEsS0FBSyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDbkYsZUFBVyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQUlsQixXQUFXLFNBQVMsR0FBRztBQUFBLFlBQ3RCLFdBQVcsU0FBUyxHQUFHO0FBQUE7QUFBQTtBQUFBO0FBQUEsbUJBSWhCLFdBQVcsY0FBYyxVQUFVLGtCQUFrQixXQUFXLFNBQVMsS0FBSztBQUFBO0FBQUE7QUFBQSxpQkFHaEYsV0FBVyxTQUFTLE9BQU87QUFBQTtBQUFBLGdCQUU1QixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBSXhDLFVBQU0sbUJBQW1CLFdBQVcsVUFBVSxFQUFFLEtBQUssK0JBQStCLENBQUM7QUFDckYscUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBSXJCLFdBQVcsY0FBYyxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxpQkFLaEMsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUd6QyxVQUFNLGdCQUFnQixpQkFBaUIsV0FBVztBQUNsRCxrQkFBYyxZQUFZLEtBQUssaUJBQWlCLFdBQVcsSUFBSSxlQUFlLFFBQVEsTUFBTTtBQUM1RixrQkFBYyxNQUFNLFVBQVU7QUFHOUIsVUFBTSx1QkFBdUIsSUFBSSxpQ0FBZ0IsZ0JBQWdCO0FBQ2pFLHlCQUFxQixRQUFRLFFBQVEsRUFDbkMsV0FBVyxrQ0FBa0MsRUFDN0MsUUFBUSxZQUFZO0FBQ3BCLFVBQUksS0FBSyxhQUFhO0FBQ3JCLGFBQUssZ0JBQWdCLHVCQUF1QixLQUFLLFlBQVksSUFBSTtBQUNqRSxjQUFNLEtBQUssZUFBZTtBQUFBLE1BQzNCO0FBQUEsSUFDRCxDQUFDO0FBRUYsVUFBTSxjQUFjLHFCQUFxQjtBQUN6QyxnQkFBWSxTQUFTLDRCQUE0QjtBQUNqRCxnQkFBWSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBS2hCLFdBQVcsYUFBYSxTQUFTO0FBQUE7QUFBQTtBQUFBO0FBQUEsZ0JBSS9CLFdBQVcsU0FBUyxNQUFNO0FBQUEsaUJBQ3pCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPekMsUUFBSSxVQUFVO0FBQ2Isa0JBQVksaUJBQWlCLGNBQWMsTUFBTTtBQUNoRCxvQkFBWSxNQUFNLGFBQWE7QUFDL0Isb0JBQVksTUFBTSxjQUFjO0FBQ2hDLG9CQUFZLE1BQU0sUUFBUTtBQUFBLE1BQzNCLENBQUM7QUFDRCxrQkFBWSxpQkFBaUIsWUFBWSxNQUFNO0FBQzlDLG1CQUFXLE1BQU07QUFDaEIsc0JBQVksTUFBTSxhQUFhO0FBQy9CLHNCQUFZLE1BQU0sY0FBYztBQUNoQyxzQkFBWSxNQUFNLFFBQVE7QUFBQSxRQUMzQixHQUFHLEdBQUc7QUFBQSxNQUNQLENBQUM7QUFBQSxJQUNGLE9BQU87QUFDTixrQkFBWSxpQkFBaUIsY0FBYyxNQUFNO0FBQ2hELG9CQUFZLE1BQU0sYUFBYTtBQUMvQixvQkFBWSxNQUFNLGNBQWM7QUFDaEMsb0JBQVksTUFBTSxRQUFRO0FBQUEsTUFDM0IsQ0FBQztBQUNELGtCQUFZLGlCQUFpQixjQUFjLE1BQU07QUFDaEQsb0JBQVksTUFBTSxhQUFhO0FBQy9CLG9CQUFZLE1BQU0sY0FBYztBQUNoQyxvQkFBWSxNQUFNLFFBQVE7QUFBQSxNQUMzQixDQUFDO0FBQUEsSUFDRjtBQUdBLFVBQU0sWUFBWSxXQUFXLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBRXZFLFlBQVEsUUFBUSxDQUFDLEtBQUssVUFBVTtBQUMvQixZQUFNLFlBQVksVUFBVSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUN0RSxnQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxlQUlkLFdBQVcsY0FBYyxVQUFVO0FBQUEscUJBQzdCLFFBQVEsUUFBUSxTQUFTLElBQUksZ0RBQWdELE1BQU07QUFBQTtBQUFBLGtCQUV0RixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBR3pDLFlBQU0sWUFBWSxVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ3RFLGdCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQSxXQUdsQixXQUFXLFNBQVMsS0FBSztBQUFBO0FBQUE7QUFBQTtBQUtqQyxZQUFNLFNBQVMsVUFBVSxXQUFXO0FBQ3BDLGFBQU8sWUFBWSxLQUFLLGlCQUFpQixXQUFXO0FBQ3BELGFBQU8sTUFBTSxVQUFVO0FBRXZCLFlBQU0sU0FBUyxVQUFVLFdBQVcsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ3BFLFlBQU0sU0FBUyxJQUFJLFdBQVcsSUFBSSxJQUFJLFFBQVEsS0FBSztBQUNuRCxhQUFPLGNBQWMsR0FBRyxJQUFJLEtBQUssUUFBUSxHQUFHLE1BQU07QUFDbEQsYUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBU3ZCLGFBQU8sUUFBUSxTQUFTLEdBQUcsSUFBSSxLQUFLLElBQUksMEJBQTBCO0FBR2xFLFlBQU0sYUFBYSxVQUFVLFdBQVcsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ3hFLGlCQUFXLGNBQWM7QUFDekIsaUJBQVcsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFhM0IsWUFBTSxZQUFZLFVBQVUsU0FBUyxVQUFVLEVBQUUsS0FBSywwQkFBMEIsQ0FBQztBQUNqRixnQkFBVSxZQUFZLEtBQUssaUJBQWlCLEtBQUssV0FBVyxTQUFTLE1BQU07QUFDM0UsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxhQUtoQixXQUFXLFNBQVMsTUFBTTtBQUFBLGNBQ3pCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxpQkFLdkIsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFJeEMsZ0JBQVUsUUFBUSxTQUFTLFVBQVUsSUFBSSxLQUFLLFFBQVEsRUFBRTtBQUV4RCxnQkFBVSxpQkFBaUIsU0FBUyxPQUFPLE1BQU07QUFDaEQsVUFBRSxnQkFBZ0I7QUFDbEIsWUFBSSxLQUFLLGFBQWE7QUFDckIsZUFBSyxnQkFBZ0Isb0JBQW9CLEtBQUssWUFBWSxNQUFNLElBQUksS0FBSyxJQUFJO0FBQzdFLGdCQUFNLEtBQUssZUFBZTtBQUFBLFFBQzNCO0FBQUEsTUFDRCxDQUFDO0FBR0QsVUFBSSxVQUFVO0FBQ2Isa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFDN0Isb0JBQVUsTUFBTSxRQUFRO0FBQUEsUUFDekIsQ0FBQztBQUVELGtCQUFVLGlCQUFpQixZQUFZLE1BQU07QUFDNUMscUJBQVcsTUFBTTtBQUNoQixzQkFBVSxNQUFNLGFBQWE7QUFDN0Isc0JBQVUsTUFBTSxRQUFRO0FBQUEsVUFDekIsR0FBRyxHQUFHO0FBQUEsUUFDUCxDQUFDO0FBR0Qsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFBQSxRQUM5QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLFlBQVksTUFBTTtBQUM1QyxxQkFBVyxNQUFNO0FBQ2hCLHNCQUFVLE1BQU0sYUFBYTtBQUFBLFVBQzlCLEdBQUcsR0FBRztBQUFBLFFBQ1AsQ0FBQztBQUFBLE1BQ0YsT0FBTztBQUNOLGtCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsb0JBQVUsTUFBTSxhQUFhO0FBQzdCLG9CQUFVLE1BQU0sUUFBUTtBQUFBLFFBQ3pCLENBQUM7QUFFRCxrQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLG9CQUFVLE1BQU0sYUFBYTtBQUM3QixvQkFBVSxNQUFNLFFBQVE7QUFBQSxRQUN6QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFBQSxRQUM5QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFBQSxRQUM5QixDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0QsQ0FBQztBQUdELFFBQUksYUFBYTtBQUVqQixVQUFNLGlCQUFpQixDQUFDLE1BQWtCO0FBQ3pDLFFBQUUsZ0JBQWdCO0FBQ2xCLG1CQUFhLENBQUM7QUFFZCxVQUFJLFlBQVk7QUFDZixtQkFBVyxNQUFNLFVBQVU7QUFDM0IsYUFBSyxpQkFBaUIsTUFBTSxTQUFTO0FBQUEsTUFDdEMsT0FBTztBQUNOLG1CQUFXLE1BQU0sVUFBVTtBQUMzQixhQUFLLGlCQUFpQixNQUFNLFNBQVM7QUFBQSxNQUN0QztBQUFBLElBQ0Q7QUFHQSxjQUFVLGlCQUFpQixTQUFTLGNBQWM7QUFHbEQsVUFBTSxlQUE4QixDQUFDLE1BQWE7QUFDakQsVUFBSSxjQUFjLENBQUMsS0FBSyxpQkFBaUIsU0FBUyxFQUFFLE1BQWMsR0FBRztBQUNwRSxxQkFBYTtBQUNiLG1CQUFXLE1BQU0sVUFBVTtBQUMzQixhQUFLLGlCQUFpQixNQUFNLFNBQVM7QUFBQSxNQUN0QztBQUFBLElBQ0Q7QUFFQSxTQUFLLHdCQUF3QixVQUFVLFNBQVMsWUFBWTtBQUFBLEVBQzdEO0FBQUEsRUFFQSxNQUFjLGlCQUFnQztBQUM3QyxRQUFJLEtBQUssYUFBYTtBQUNyQixZQUFNLFNBQVMsTUFBTSxLQUFLLGdCQUFnQixhQUFhLElBQUksS0FBSyxXQUFXO0FBQzNFLFdBQUssaUJBQWlCLE9BQU87QUFDN0IsV0FBSyx1QkFBdUI7QUFBQSxJQUM3QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsYUFBYTtBQTExQzVCO0FBMjFDRSxVQUFNLFVBQVUsS0FBSyxTQUFTLFNBQVMsRUFBRSxLQUFLO0FBQzlDLFFBQUksQ0FBQyxRQUFTO0FBR2QsUUFBSSxRQUFRLFdBQVcsR0FBRyxHQUFHO0FBQzVCLFlBQU0sZ0JBQWdCLE1BQU0sS0FBSyxtQkFBbUIsT0FBTztBQUMzRCxVQUFJLGVBQWU7QUFDbEIsYUFBSyxTQUFTLFNBQVMsRUFBRTtBQUV6QixtQkFBVyxNQUFNLEtBQUssaUJBQWlCLEdBQUcsQ0FBQztBQUMzQztBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsUUFBSSxtQkFBbUI7QUFDdkIsUUFBSSxrQkFBMEM7QUFFOUMsUUFBSSxLQUFLLGFBQWE7QUFFckIsVUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUN0RSxZQUFJLFFBQVEsU0FBUyxJQUFJLEtBQUssUUFBUSxTQUFTLEtBQUssR0FBRztBQUN0RCxlQUFLLFdBQVcsVUFBVSxLQUFLLGtCQUFrQixhQUFhLHVIQUF1SCxDQUFDO0FBQ3RMO0FBQUEsUUFDRDtBQUFBLE1BQ0QsT0FBTztBQUVOLGNBQU0sZ0JBQWdCLE1BQU0sS0FBSyxnQkFBZ0IsYUFBYSxTQUFTLEtBQUssV0FBVztBQUN2RiwyQkFBbUIsY0FBYztBQUNqQywwQkFBa0IsY0FBYztBQUNoQyxhQUFLLGlCQUFpQjtBQUd0QixhQUFLLHVCQUF1QjtBQUk1QixjQUFNLDRCQUEwQixVQUFLLG1CQUFMLG1CQUFxQixlQUFlLFdBQVU7QUFDOUUsY0FBTSx5QkFBeUIsZ0JBQWdCLGVBQWU7QUFDOUQsY0FBTSxhQUFhLHlCQUF5QjtBQUM1QyxjQUFNLHVCQUF1QixpQkFBaUIsS0FBSyxFQUFFLFdBQVcsS0FBSztBQUVyRSxZQUFJLHNCQUFzQjtBQUV6QixnQkFBTSxlQUFlLHlCQUF5QjtBQUM5QyxjQUFJLGVBQWUsR0FBRztBQUVyQixrQkFBTSxVQUFVLGdCQUFnQixlQUFlLE1BQU0sQ0FBQyxZQUFZO0FBQ2xFLGtCQUFNLFdBQVcsUUFBUSxJQUFJLFNBQU8sSUFBSSxLQUFLLFFBQVEsRUFBRSxLQUFLLElBQUk7QUFDaEUsaUJBQUssV0FBVyxVQUFVLEtBQUssa0JBQWtCLGdCQUFnQixTQUFTLFlBQVksWUFBWSxpQkFBaUIsSUFBSSxNQUFNLEVBQUUsMkJBQTJCLFFBQVEsRUFBRSxDQUFDO0FBQUEsVUFDdEs7QUFHQSxlQUFLLFNBQVMsU0FBUyxFQUFFO0FBQ3pCLHFCQUFXLE1BQU0sS0FBSyxpQkFBaUIsR0FBRyxDQUFDO0FBQzNDLGVBQUssdUJBQXVCO0FBRzVCLGNBQUksS0FBSyxnQkFBZ0I7QUFDeEIsaUJBQUssZUFBZSxNQUFNLFVBQVU7QUFBQSxVQUNyQztBQUNBO0FBQUEsUUFDRDtBQUdBLFlBQUksZ0JBQWdCLGVBQWUsU0FBUyxHQUFHO0FBQzlDLGdCQUFNLFVBQVUsZ0JBQWdCO0FBQ2hDLGdCQUFNLFdBQVcsUUFBUSxJQUFJLFNBQU8sSUFBSSxLQUFLLFFBQVEsRUFBRSxLQUFLLElBQUk7QUFDaEUsZ0JBQU0sWUFBWSxnQkFBZ0IsYUFBYSxJQUFJLE1BQU0sZ0JBQWdCLFVBQVUsYUFBYTtBQUNoRyxnQkFBTSxnQkFBYyxVQUFLLGdCQUFMLG1CQUFrQixhQUFZO0FBQ2xELGVBQUssV0FBVyxVQUFVLEtBQUssa0JBQWtCLGFBQWEsWUFBWSxRQUFRLE1BQU0sWUFBWSxRQUFRLFdBQVcsSUFBSSxNQUFNLEVBQUUsZ0JBQWdCLFFBQVEsR0FBRyxTQUFTLHFFQUFxRSxXQUFXLEdBQUcsQ0FBQztBQUFBLFFBQzVQO0FBR0EsWUFBSSxnQkFBZ0IsYUFBYTtBQUNoQyxjQUFJLHdCQUFPLHdGQUE4RSxHQUFJO0FBQUEsUUFDOUY7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUdBLFNBQUssV0FBVyxRQUFRLE9BQU87QUFDL0IsU0FBSyxTQUFTLFNBQVMsRUFBRTtBQUV6QixlQUFXLE1BQU0sS0FBSyxpQkFBaUIsR0FBRyxDQUFDO0FBRzNDLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLElBQ3JDO0FBRUEsU0FBSyxXQUFXLFlBQVksSUFBSTtBQUVoQyxRQUFJO0FBRUgsWUFBTSxZQUFZLEtBQUssY0FBYyxVQUFVLEVBQUUsS0FBSyxlQUFlLENBQUM7QUFDdEUsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFhMUIsWUFBTSxnQkFBZ0IsVUFBVSxVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUN6RSxvQkFBYyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFTMUIsWUFBTSxTQUFTLFVBQVUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbkUsYUFBTyxNQUFNLFVBQVU7QUFHdkIsWUFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFDcEQsVUFBSSxZQUFZO0FBQ2YsY0FBTSxLQUFLLE9BQU8sZUFBZSxlQUFlLE9BQU87QUFBQSxNQUN4RDtBQUdBLFlBQU0sa0JBQWtCLEtBQUssT0FBTyxjQUFjLGlCQUFpQixFQUFFLGdCQUFnQjtBQUNyRixVQUFJLFdBQTBCO0FBRTlCLFVBQUksbUJBQW1CLFlBQVk7QUFFbEMsY0FBTSxnQkFBZ0IsS0FBSyxPQUFPLGNBQWMsYUFBYSxnQkFBZ0I7QUFDN0UsbUJBQVcsTUFBTSxLQUFLLGVBQWUsYUFBYTtBQUFBLE1BQ25ELE9BQU87QUFFTixjQUFNQyxVQUFTLE1BQU0sS0FBSyxPQUFPLGNBQWMsc0JBQXNCLGtCQUFrQixjQUFjLE1BQVM7QUFHOUcsWUFBSSxtQkFBbUIsZ0JBQWdCLGVBQWU7QUFFckQsZ0JBQU0scUJBQXFCLEdBQUcsZ0JBQWdCLGFBQWE7QUFBQTtBQUFBO0FBQUE7QUFBQSxnQkFBNEIsZ0JBQWdCO0FBR3ZHLHFCQUFXLE1BQU0sS0FBSyxPQUFPLGtCQUFrQixTQUFTQSxRQUFPLGNBQWMsb0JBQW9CO0FBQUEsWUFDaEcsYUFBYUEsUUFBTyxPQUFPO0FBQUEsWUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsVUFDMUIsQ0FBQztBQUFBLFFBQ0YsT0FBTztBQUVOLHFCQUFXLE1BQU0sS0FBSyxPQUFPLGtCQUFrQixTQUFTQSxRQUFPLGNBQWNBLFFBQU8sWUFBWTtBQUFBLFlBQy9GLGFBQWFBLFFBQU8sT0FBTztBQUFBLFlBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFVBQzFCLENBQUM7QUFBQSxRQUNGO0FBQUEsTUFDRDtBQUdBLGdCQUFVLE9BQU87QUFHakIsVUFBSSxjQUFjLFVBQVU7QUFDM0IsY0FBTSxLQUFLLE9BQU8sZUFBZSxvQkFBb0IsUUFBUTtBQUFBLE1BQzlEO0FBR0EsVUFBSSxVQUFVO0FBQ2IsYUFBSyxXQUFXLGFBQWEsUUFBUTtBQUFBLE1BQ3RDO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFFZixZQUFNLFlBQVksS0FBSyxjQUFjLGNBQWMsZUFBZTtBQUNsRSxVQUFJLFVBQVcsV0FBVSxPQUFPO0FBRWhDLFdBQUssV0FBVyxhQUFhLGtDQUFtQyxNQUFnQixPQUFPLEVBQUU7QUFBQSxJQUMxRixVQUFFO0FBQ0QsV0FBSyxXQUFXLFlBQVksS0FBSztBQUVqQyxZQUFNLEtBQUssZUFBZTtBQUFBLElBQzNCO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSx5QkFBeUIsTUFBYztBQUM1QyxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLHlCQUFRO0FBQ2xFLFFBQUksY0FBYyxZQUFZLFlBQVk7QUFDekMsWUFBTSxTQUFVLFdBQW1CO0FBQ25DLFVBQUksUUFBUTtBQUNYLGNBQU0sU0FBUyxPQUFPLFVBQVU7QUFDaEMsZUFBTyxhQUFhLE1BQU0sTUFBTTtBQUFBLE1BQ2pDO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsZUFBZSxTQUE4QztBQUMxRSxRQUFJO0FBRUgsVUFBSSxDQUFDLEtBQUssYUFBYTtBQUN0QixlQUFPLEtBQUssa0JBQWtCLFlBQVkscUZBQXFGO0FBQUEsTUFDaEk7QUFHQSxZQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLFVBQVU7QUFDNUQsVUFBSSxlQUFvQztBQUd4QyxpQkFBVyxRQUFRLFFBQVE7QUFDMUIsY0FBTSxPQUFPLEtBQUs7QUFDbEIsWUFBSSxLQUFLLFNBQVMsS0FBSyxhQUFhO0FBQ25DLHlCQUFlO0FBQ2Y7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUdBLFVBQUksQ0FBQyxjQUFjO0FBQ2xCLGNBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxRQUFRLEtBQUs7QUFDN0MsWUFBSSxNQUFNO0FBQ1QsZ0JBQU0sS0FBSyxTQUFTLEtBQUssV0FBVztBQUNwQyx5QkFBZSxLQUFLO0FBQUEsUUFDckI7QUFBQSxNQUNEO0FBRUEsVUFBSSxDQUFDLGNBQWM7QUFDbEIsZUFBTyxLQUFLLGtCQUFrQixZQUFZLDhCQUE4QixLQUFLLFlBQVksUUFBUSw4Q0FBOEM7QUFBQSxNQUNoSjtBQUlBLFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBQ3BELFVBQUksQ0FBQyxjQUFjLGVBQWUsS0FBSyxhQUFhO0FBRW5ELGFBQUssSUFBSSxVQUFVLGNBQWMsYUFBYSxNQUFNLEVBQUUsT0FBTyxLQUFLLENBQUM7QUFHbkUsY0FBTSxnQkFBZ0IsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUN2RCxZQUFJLENBQUMsaUJBQWlCLGtCQUFrQixLQUFLLGFBQWE7QUFDekQsaUJBQU8sS0FBSyxrQkFBa0IsWUFBWSxrQkFBa0IsS0FBSyxZQUFZLFFBQVEsd0lBQXdJO0FBQUEsUUFDOU47QUFBQSxNQUNEO0FBRUEsVUFBSTtBQUVKLGNBQVEsUUFBUSxRQUFRO0FBQUEsUUFDdkIsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSyxPQUFPLGtCQUFrQixRQUFRLE9BQU87QUFDNUQ7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssT0FBTyxtQkFBbUIsUUFBUSxPQUFPO0FBQzdEO0FBQUEsUUFDRCxLQUFLO0FBQ0osbUJBQVMsTUFBTSxLQUFLLE9BQU8scUJBQXFCLFFBQVEsT0FBTztBQUMvRDtBQUFBLFFBQ0QsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSyxPQUFPLHNCQUFzQixRQUFRLE9BQU87QUFDaEU7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssT0FBTyxzQkFBc0IsUUFBUSxPQUFPO0FBQ2hFO0FBQUEsUUFDRCxLQUFLO0FBQ0osbUJBQVMsTUFBTSxLQUFLLE9BQU8sdUJBQXVCLFFBQVEsT0FBTztBQUNqRTtBQUFBLFFBQ0Q7QUFDQyxpQkFBTyxtQ0FBbUMsUUFBUSxNQUFNO0FBQUEsTUFDMUQ7QUFFQSxVQUFJLE9BQU8sU0FBUztBQUVuQixhQUFLLG9CQUFvQixRQUFRLE1BQU07QUFDdkMsZUFBTztBQUFBLE1BQ1IsT0FBTztBQUNOLGVBQU8sYUFBYSxRQUFRLE1BQU0sS0FBSyxPQUFPLEtBQUs7QUFBQSxNQUNwRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsYUFBTyxLQUFLLGtCQUFrQixZQUFZLDRCQUE2QixNQUFnQixPQUFPLEVBQUU7QUFBQSxJQUNqRztBQUFBLEVBQ0Q7QUFBQSxFQUdBLE1BQWMsZ0NBQWdDO0FBQzdDLFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBR3BELFFBQUksYUFBYTtBQUNqQixRQUFJLENBQUMsWUFBWTtBQUNoQixZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVU7QUFDdEMsVUFBSSxjQUFjLFdBQVcsZ0JBQWdCLCtCQUFjO0FBQzFELHFCQUFhLFdBQVcsS0FBSztBQUFBLE1BQzlCLE9BQU87QUFFTixjQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLFVBQVU7QUFDNUQsWUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixnQkFBTSxPQUFPLE9BQU8sQ0FBQyxFQUFFO0FBQ3ZCLHVCQUFhLEtBQUs7QUFBQSxRQUNuQjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsUUFBSSxDQUFDLGNBQWMsS0FBSyxhQUFhO0FBQ3BDLFdBQUssY0FBYztBQUNuQixXQUFLLGNBQWMsTUFBTTtBQUN6QixXQUFLLGVBQWU7QUFDcEIsV0FBSyxrQkFBa0IsOENBQThDO0FBQ3JFO0FBQUEsSUFDRDtBQUdBLFFBQUksQ0FBQyxjQUFjLGVBQWUsS0FBSyxhQUFhO0FBQ25EO0FBQUEsSUFDRDtBQUVBLFNBQUssY0FBYztBQUduQixTQUFLLGNBQWMsTUFBTTtBQUd6QixVQUFNLEtBQUssZUFBZTtBQUUxQixRQUFJO0FBRUgsWUFBTSxpQkFBaUIsTUFBTSxLQUFLLE9BQU8sb0JBQW9CLGtCQUFrQixZQUFZLEVBQUU7QUFFN0YsVUFBSSxlQUFlLFNBQVMsR0FBRztBQUU5Qix1QkFBZSxRQUFRLFNBQU87QUFDN0IsY0FBSSxJQUFJLFNBQVMsVUFBVTtBQUMxQixpQkFBSyxXQUFXLElBQUksTUFBOEIsSUFBSSxPQUFPO0FBQUEsVUFDOUQ7QUFBQSxRQUNELENBQUM7QUFBQSxNQUNGLE9BQU87QUFFTixhQUFLLGtCQUFrQiwyQkFBMkIsV0FBVyxRQUFRLCtCQUErQjtBQUFBLE1BQ3JHO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixjQUFRLEtBQUssd0NBQXdDLEtBQUs7QUFFMUQsV0FBSyxrQkFBa0IsMkJBQTJCLFdBQVcsUUFBUSwrQkFBK0I7QUFBQSxJQUNyRztBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMsWUFBWTtBQUV6QixTQUFLLGNBQWMsTUFBTTtBQUd6QixRQUFJLEtBQUssYUFBYTtBQUNyQixVQUFJO0FBQ0gsY0FBTSxLQUFLLE9BQU8sb0JBQW9CLGtCQUFrQixLQUFLLFdBQVc7QUFFeEUsYUFBSyxnQkFBZ0IsdUJBQXVCLEtBQUssWUFBWSxJQUFJO0FBQ2pFLGFBQUssaUJBQWlCO0FBQ3RCLFlBQUksS0FBSyxrQkFBa0I7QUFDMUIsZUFBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQUEsUUFDdkM7QUFBQSxNQUNELFNBQVMsT0FBTztBQUNmLGdCQUFRLEtBQUssaUNBQWlDLEtBQUs7QUFBQSxNQUNwRDtBQUFBLElBQ0Q7QUFHQSxRQUFJLEtBQUssYUFBYTtBQUNyQixXQUFLLGtCQUFrQix5Q0FBeUMsS0FBSyxZQUFZLFFBQVEsK0JBQStCO0FBQUEsSUFDekgsT0FBTztBQUNOLFdBQUssa0JBQWtCLHlEQUF5RDtBQUFBLElBQ2pGO0FBR0EsUUFBSSx3QkFBTyxzQkFBc0I7QUFBQSxFQUNsQztBQUFBO0FBQUEsRUFHQSxNQUFNLFlBQVksU0FBZ0M7QUFDakQsVUFBTSxhQUFhLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFHNUQsVUFBTUEsVUFBUyxNQUFNLEtBQUssT0FBTyxjQUFjLHNCQUFzQixTQUFTLGNBQWMsTUFBUztBQUdyRyxVQUFNLFVBQVUsS0FBSyxPQUFPLGNBQWMsYUFBYSxPQUFPO0FBRzlELFVBQU0sZUFBZSxDQUFDLE9BQU8sUUFBUSxVQUFVLFdBQVcsV0FBVyxVQUFVO0FBQy9FLFFBQUksYUFBYSxTQUFTLFFBQVEsTUFBTSxHQUFHO0FBSTFDLFlBQU0sb0JBQW9CLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFDbkUsVUFBSSxjQUFjLHFCQUFxQixzQkFBc0IsWUFBWTtBQUN4RSxjQUFNLElBQUksTUFBTSx1RUFBdUUsV0FBVyxRQUFRLGFBQWEsa0JBQWtCLFFBQVEsRUFBRTtBQUFBLE1BQ3BKO0FBR0EsY0FBUSxRQUFRLFFBQVE7QUFBQSxRQUN2QixLQUFLO0FBQ0osZ0JBQU0sS0FBSyxPQUFPLGtCQUFrQixRQUFRLE9BQU87QUFDbkQ7QUFBQSxRQUNELEtBQUs7QUFDSixnQkFBTSxLQUFLLE9BQU8sbUJBQW1CLFFBQVEsT0FBTztBQUNwRDtBQUFBLFFBQ0QsS0FBSztBQUNKLGdCQUFNLEtBQUssT0FBTyxxQkFBcUIsUUFBUSxPQUFPO0FBQ3REO0FBQUEsUUFDRCxLQUFLO0FBQ0osZ0JBQU0sS0FBSyxPQUFPLHNCQUFzQixRQUFRLE9BQU87QUFDdkQ7QUFBQSxRQUNELEtBQUs7QUFDSixnQkFBTSxLQUFLLE9BQU8sc0JBQXNCLFFBQVEsT0FBTztBQUN2RDtBQUFBLFFBQ0QsS0FBSztBQUNKLGdCQUFNLEtBQUssT0FBTyx1QkFBdUIsUUFBUSxPQUFPO0FBQ3hEO0FBQUEsTUFDRjtBQUFBLElBQ0QsT0FBTztBQUVOLFVBQUksWUFBWTtBQUNmLGNBQU0sS0FBSyxPQUFPLG9CQUFvQixlQUFlLFlBQVksU0FBUyxJQUFXO0FBQUEsTUFDdEY7QUFHQSxZQUFNLEtBQUssT0FBTyxrQkFBa0IsU0FBU0EsUUFBTyxjQUFjQSxRQUFPLFVBQVU7QUFFbkYsVUFBSSxZQUFZO0FBQ2YsY0FBTSxLQUFLLE9BQU8sb0JBQW9CLG9CQUFvQixZQUFZLGVBQWUsRUFBRSxTQUFTLE1BQU0sVUFBVSxPQUFPLENBQVE7QUFBQSxNQUNoSTtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFNLHdCQUF3QixNQUEwQjtBQUN2RCxVQUFNLFdBQVcsTUFBTSxLQUFLLE9BQU8sb0JBQW9CLGtCQUFrQixNQUFNLEVBQUU7QUFBQSxFQUVsRjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMkJBQTJCLFdBQThCO0FBQ2hFLFVBQU0saUJBQWlCLFVBQVUsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDMUUsbUJBQWUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFTL0IsVUFBTSxrQkFBa0IsZUFBZSxXQUFXLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNsRixvQkFBZ0IsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9oQyxVQUFNLHFCQUFxQixlQUFlLFdBQVcsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUczRSxTQUFLLE9BQU8sa0JBQWtCLHVCQUF1QixFQUFFLEtBQUssVUFBUTtBQUNuRSx5QkFBbUIsUUFBUSxJQUFJO0FBQUEsSUFDaEMsQ0FBQztBQUFBLEVBQ0Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHVCQUF1QixXQUE4QjtBQUM1RCxVQUFNLG9CQUFvQixVQUFVLFVBQVUsRUFBRSxLQUFLLG1DQUFtQyxDQUFDO0FBQ3pGLHNCQUFrQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9sQyxVQUFNLGlCQUFpQixrQkFBa0IsU0FBUyxVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUMzRixtQkFBZSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFlL0IsVUFBTSxZQUFZLGVBQWUsV0FBVyxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDNUUsY0FBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUTFCLFVBQU0sZUFBZSxlQUFlLFdBQVcsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUdyRSxVQUFNLGdCQUFnQixlQUFlLFdBQVcsRUFBRSxNQUFNLFNBQUksQ0FBQztBQUM3RCxrQkFBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU85QixVQUFNLGVBQWUsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLDhCQUE4QixDQUFDO0FBQ3ZGLGlCQUFhLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWM3QixRQUFJLGlCQUFpQjtBQUdyQixVQUFNLHdCQUF3QixZQUFZO0FBQ3pDLFlBQU0sc0JBQXNCLE1BQU0sS0FBSyxPQUFPLGtCQUFrQix1QkFBdUI7QUFDdkYsbUJBQWEsUUFBUSxtQkFBbUI7QUFBQSxJQUN6QztBQUdBLFVBQU0saUJBQWlCLE1BQU07QUFDNUIsdUJBQWlCLENBQUM7QUFDbEIsbUJBQWEsTUFBTSxVQUFVLGlCQUFpQixVQUFVO0FBQ3hELG9CQUFjLE1BQU0sWUFBWSxpQkFBaUIsbUJBQW1CO0FBRXBFLFVBQUksZ0JBQWdCO0FBQ25CLGFBQUsseUJBQXlCLFlBQVk7QUFBQSxNQUMzQztBQUFBLElBQ0Q7QUFHQSxVQUFNLGdCQUErQixDQUFDLFVBQWlCO0FBQ3RELFVBQUksQ0FBQyxrQkFBa0IsU0FBUyxNQUFNLE1BQWMsR0FBRztBQUN0RCx5QkFBaUI7QUFDakIscUJBQWEsTUFBTSxVQUFVO0FBQzdCLHNCQUFjLE1BQU0sWUFBWTtBQUFBLE1BQ2pDO0FBQUEsSUFDRDtBQUVBLG1CQUFlLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUMvQyxRQUFFLGdCQUFnQjtBQUNsQixxQkFBZTtBQUFBLElBQ2hCLENBQUM7QUFHRCxTQUFLLHdCQUF3QixVQUFVLFNBQVMsYUFBYTtBQUc3RCwwQkFBc0I7QUFHdEIsSUFBQyxLQUFhLDBCQUEwQjtBQUFBLE1BQ3ZDO0FBQUEsTUFDQSxTQUFTLE1BQU0sU0FBUyxvQkFBb0IsU0FBUyxhQUFhO0FBQUEsSUFDbkU7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHlCQUF5QixjQUEwQztBQUNoRixpQkFBYSxNQUFNO0FBRW5CLFVBQU0sbUJBQW1CLEtBQUssT0FBTyxrQkFBa0Isb0JBQW9CO0FBQzNFLFVBQU0sc0JBQXNCLE1BQU0sS0FBSyxPQUFPLGtCQUFrQix1QkFBdUI7QUFFdkYsZUFBVyxnQkFBZ0Isa0JBQWtCO0FBQzVDLFVBQUksaUJBQWlCLE9BQVE7QUFFN0IsWUFBTSxlQUFlLGFBQWEsVUFBVSxFQUFFLEtBQUssOEJBQThCLENBQUM7QUFDbEYsbUJBQWEsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVc3QixZQUFNLGNBQWMsYUFBYSxXQUFXO0FBQzVDLGtCQUFZLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLGtCQUliLEtBQUssaUJBQWlCLFlBQVksQ0FBQztBQUFBO0FBSWxELFlBQU0sY0FBYyxLQUFLLHVCQUF1QixZQUFZO0FBQzVELFlBQU0sV0FBVyxhQUFhLFdBQVcsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUc5RCxZQUFNLFlBQVksZ0JBQWdCO0FBQ2xDLFVBQUksV0FBVztBQUNkLHFCQUFhLE1BQU0sYUFBYTtBQUNoQyxpQkFBUyxNQUFNLGFBQWE7QUFBQSxNQUM3QjtBQUdBLG1CQUFhLGlCQUFpQixTQUFTLFlBQVk7QUFDbEQsWUFBSSxDQUFDLFdBQVc7QUFDZixnQkFBTSxLQUFLLGlCQUFpQixZQUFZO0FBRXhDLHVCQUFhLE1BQU0sVUFBVTtBQUM3QixjQUFLLEtBQWEseUJBQXlCO0FBQzFDLFlBQUMsS0FBYSx3QkFBd0Isc0JBQXNCO0FBQUEsVUFDN0Q7QUFBQSxRQUNEO0FBQUEsTUFDRCxDQUFDO0FBR0QsbUJBQWEsaUJBQWlCLGNBQWMsTUFBTTtBQUNqRCxZQUFJLENBQUMsV0FBVztBQUNmLHVCQUFhLE1BQU0sYUFBYTtBQUFBLFFBQ2pDO0FBQUEsTUFDRCxDQUFDO0FBRUQsbUJBQWEsaUJBQWlCLGNBQWMsTUFBTTtBQUNqRCxZQUFJLENBQUMsV0FBVztBQUNmLHVCQUFhLE1BQU0sYUFBYTtBQUFBLFFBQ2pDO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixVQUFrQixTQUF5QjtBQUNwRSxVQUFNLFVBQVUsS0FBSyxnQkFBZ0IsVUFBVSxNQUFNO0FBRXJELFdBQU8sc0VBQXNFLE9BQU8sU0FBUyxPQUFPO0FBQUEsRUFDckc7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUFpQixVQUFrQixPQUFlLFFBQWdCO0FBQ3pFLFdBQU8sS0FBSyxnQkFBZ0IsVUFBVSxJQUFJO0FBQUEsRUFDM0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixVQUFrQixPQUFlLFFBQWdCO0FBQ3hFLFVBQU0sUUFBZ0M7QUFBQSxNQUNyQyxPQUFPLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQSxNQUdySCxjQUFjLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLNUgsUUFBUSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUl0SCxlQUFlLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLN0gsYUFBYSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFNM0gsbUJBQW1CLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLakksYUFBYSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU8zSCxLQUFLLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BSW5ILGdCQUFnQix5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUk5SCxZQUFZLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFLM0g7QUFFQSxXQUFPLE1BQU0sUUFBUSxLQUFLLE1BQU0sYUFBYTtBQUFBLEVBQzlDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx1QkFBdUIsY0FBOEI7QUFDNUQsVUFBTSxRQUFnQztBQUFBLE1BQ3JDLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFFBQVE7QUFBQSxJQUNUO0FBQ0EsV0FBTyxNQUFNLFlBQVksS0FBSztBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxpQkFBaUIsY0FBOEI7QUFDdEQsVUFBTSxTQUFpQztBQUFBLE1BQ3RDLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFFBQVE7QUFBQSxJQUNUO0FBQ0EsV0FBTyxPQUFPLFlBQVksS0FBSztBQUFBLEVBQ2hDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLGlCQUFpQixjQUFxQztBQUNuRSxRQUFJO0FBRUgsWUFBTSxnQkFBZ0IsS0FBSyxrQkFBa0IsY0FBYyxlQUFlLEtBQUssdUJBQXVCLFlBQVksQ0FBQyxFQUFFO0FBQ3JILFdBQUssV0FBVyxVQUFVLGFBQWE7QUFHdkMsWUFBTSxXQUFXLDBCQUFTLFdBQVcsV0FBVztBQUNoRCxXQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxFQUFFLGtCQUFrQjtBQUNsRSxZQUFNLEtBQUssT0FBTyxhQUFhO0FBRy9CLFdBQUssT0FBTyxrQkFBa0IsZUFBZSxLQUFLLE9BQU8sUUFBUTtBQUFBLElBRWxFLFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSw2QkFBNkIsS0FBSztBQUNoRCxXQUFLLFdBQVcsVUFBVSxLQUFLLGtCQUFrQixZQUFZLHVCQUF1QixLQUFLLHVCQUF1QixZQUFZLENBQUMsRUFBRSxDQUFDO0FBQUEsSUFDakk7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSwwQkFBbUM7QUFFMUMsUUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixnQkFBZ0IsR0FBRztBQUNuRSxhQUFPO0FBQUEsSUFDUjtBQUNBLFdBQU8sS0FBSyxPQUFPLFNBQVM7QUFBQSxFQUM3QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EscUJBQTJCO0FBQzFCLFNBQUsscUJBQXFCO0FBQUEsRUFFM0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHVCQUE2QjtBQWxuRTlCO0FBbW5FRSxRQUFJLENBQUMsS0FBSyxlQUFnQjtBQUcxQixVQUFNLGdCQUFjLFVBQUssYUFBTCxtQkFBZSxlQUFjO0FBQ2pELFVBQU0sZ0JBQWMsZ0JBQUssYUFBTCxtQkFBZSxZQUFmLG1CQUF3QixtQkFBa0I7QUFDOUQsVUFBTSxjQUFZLGdCQUFLLGFBQUwsbUJBQWUsWUFBZixtQkFBd0IsaUJBQWdCO0FBQzFELFVBQU0sYUFBVyxVQUFLLGFBQUwsbUJBQWUsYUFBWSxTQUFTO0FBR3JELFNBQUssZ0JBQWdCO0FBR3JCLFFBQUksS0FBSyxZQUFZLGFBQWE7QUFDakMsV0FBSyxTQUFTLFNBQVMsV0FBVztBQUVsQyxpQkFBVyxNQUFNO0FBbG9FcEIsWUFBQUM7QUFtb0VJLGFBQUlBLE1BQUEsS0FBSyxhQUFMLGdCQUFBQSxJQUFlLFNBQVM7QUFDM0IsZUFBSyxTQUFTLFFBQVEsa0JBQWtCLGFBQWEsU0FBUztBQUM5RCxjQUFJLFVBQVU7QUFDYixpQkFBSyxTQUFTLFFBQVEsTUFBTTtBQUFBLFVBQzdCO0FBQUEsUUFDRDtBQUFBLE1BQ0QsR0FBRyxDQUFDO0FBQUEsSUFDTDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHVCQUE2QjtBQUFBLEVBSXJDO0FBRUQ7OztBRGhwRUEsSUFBTSxnQkFBZ0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQTRDZixJQUFNLG1CQUFpQztBQUFBLEVBQzdDLGFBQWE7QUFBQSxJQUNaLFFBQVE7QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLE9BQU87QUFBQSxNQUNQLGFBQWE7QUFBQSxNQUNiLFdBQVc7QUFBQSxJQUNaO0FBQUEsSUFDQSxRQUFRO0FBQUEsTUFDUCxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsTUFDVCxPQUFPO0FBQUEsTUFDUCxhQUFhO0FBQUEsTUFDYixXQUFXO0FBQUEsSUFDWjtBQUFBLElBQ0EsUUFBUTtBQUFBLE1BQ1AsUUFBUTtBQUFBLE1BQ1IsT0FBTztBQUFBLE1BQ1AsYUFBYTtBQUFBLE1BQ2IsV0FBVztBQUFBLElBQ1o7QUFBQSxJQUNBLFFBQVE7QUFBQSxNQUNQLFNBQVM7QUFBQSxNQUNULE9BQU87QUFBQSxNQUNQLGFBQWE7QUFBQSxNQUNiLFdBQVc7QUFBQSxJQUNaO0FBQUEsRUFDRDtBQUFBLEVBQ0Esa0JBQWtCO0FBQUEsSUFDakIsU0FBUztBQUFBLE1BQ1IsaUJBQWlCO0FBQUEsTUFDakIsbUJBQW1CLENBQUMsVUFBVSxVQUFVLFFBQVE7QUFBQSxJQUNqRDtBQUFBLElBQ0EsUUFBUTtBQUFBLE1BQ1AsaUJBQWlCO0FBQUEsTUFDakIsbUJBQW1CLENBQUMsVUFBVSxRQUFRO0FBQUEsSUFDdkM7QUFBQSxFQUNEO0FBQUEsRUFDQSxnQkFBZ0IsQ0FBQztBQUFBLEVBQ2pCLFNBQVM7QUFBQSxJQUNSLG9CQUFvQjtBQUFBLElBQ3BCLGtCQUFrQjtBQUFBLElBQ2xCLFVBQVU7QUFBQSxFQUNYO0FBQUEsRUFDQSxtQkFBbUI7QUFBQSxFQUNuQixXQUFXO0FBQUEsSUFDVixZQUFZO0FBQUEsSUFDWixxQkFBcUI7QUFBQSxJQUNyQixhQUFhO0FBQUEsSUFDYixlQUFlO0FBQUEsTUFDZCxTQUFTO0FBQUEsTUFDVCxjQUFjO0FBQUEsTUFDZCxnQkFBZ0I7QUFBQSxJQUNqQjtBQUFBLEVBQ0Q7QUFDRDtBQUVPLElBQU0saUJBQU4sY0FBNkIsa0NBQWlCO0FBQUEsRUFHcEQsWUFBWSxLQUFVLFFBQW9CO0FBQ3pDLFVBQU0sS0FBSyxNQUFNO0FBQ2pCLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBQ2xCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFdkQsU0FBSyxzQkFBc0I7QUFDM0IsU0FBSyxzQkFBc0I7QUFDM0IsU0FBSyx1QkFBdUI7QUFDNUIsU0FBSyx1QkFBdUI7QUFDNUIsU0FBSyxzQkFBc0I7QUFBQSxFQUM1QjtBQUFBLEVBRVEsd0JBQXdCO0FBL0hqQztBQWdJRSxVQUFNLEVBQUUsWUFBWSxJQUFJO0FBQ3hCLFVBQU0sbUJBQW1CLFlBQVksVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDOUUscUJBQWlCLFNBQVMsTUFBTSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFHdEUsVUFBTSxTQUFTLGlCQUFpQixVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNwRSxXQUFPLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUW5CLFVBQU0sZ0JBQWMsVUFBSyxPQUFPLG1CQUFaLG1CQUE0QiwyQkFBMEI7QUFDMUUsVUFBTSxvQkFBbUIsVUFBSyxPQUFPLG1CQUFaLG1CQUE0QjtBQUVyRCxVQUFNLGdCQUFnQixpQkFBaUIsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDakYsVUFBTSxhQUFhLGNBQWMsd0JBQXdCO0FBQ3pELFVBQU0sYUFBYSxjQUFjO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsWUFVdkI7QUFBQSxLQUNQLGFBQWE7QUFBQTtBQUVoQixrQkFBYyxZQUFZO0FBQUEsbUNBQ08sY0FBYyxjQUFjLE1BQU07QUFBQSxnQ0FDckMsVUFBVTtBQUFBLGdDQUNWLFVBQVU7QUFBQTtBQUFBO0FBS3hDLFFBQUksa0JBQWtCO0FBQ3JCLFlBQU0sV0FBVyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDMUUsWUFBTSxhQUFhLGlCQUFpQixZQUNqQyxZQUFZLGlCQUFpQixVQUFVLG1CQUFtQixDQUFDLEtBQzNEO0FBQ0gsZUFBUyxZQUFZO0FBQUE7QUFBQSxtQ0FFVyxpQkFBaUIsS0FBSztBQUFBLG9DQUNyQixVQUFVO0FBQUE7QUFBQTtBQUFBLElBRzVDO0FBR0EsUUFBSSx5QkFBUSxnQkFBZ0IsRUFDMUIsUUFBUSxrQ0FBa0MsRUFDMUMsUUFBUSw2RUFBNkUsRUFDckYsUUFBUSxVQUFRO0FBekxwQixVQUFBQztBQTBMSSxXQUFLLFFBQVEsT0FBTztBQUNwQixXQUFLLGVBQWUsZ0NBQWdDLEVBQ2xELFNBQVMsS0FBSyxPQUFPLFNBQVMsVUFBVSx1QkFBdUIsRUFBRSxFQUNqRSxTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxVQUFVLHNCQUFzQjtBQUNyRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBRy9CLFlBQUksS0FBSyxPQUFPLGdCQUFnQjtBQUMvQixnQkFBTSxLQUFLLE9BQU8sZUFBZSx1QkFBdUIsU0FBUyxJQUFJO0FBR3JFLGdCQUFNLFNBQVMsS0FBSyxPQUFPLElBQUksVUFBVSxnQkFBZ0Isc0JBQXNCO0FBQy9FLGNBQUksT0FBTyxTQUFTLEdBQUc7QUFDdEIsa0JBQU0sY0FBYyxPQUFPLENBQUMsRUFBRTtBQUM5Qix3QkFBWSxtQkFBbUI7QUFBQSxVQUNoQztBQUdBLGVBQUssUUFBUTtBQUFBLFFBQ2Q7QUFBQSxNQUNELENBQUM7QUFHRixZQUFNLGtCQUFpQkEsTUFBQSxLQUFLLFFBQVEsa0JBQWIsZ0JBQUFBLElBQTRCLFNBQVMsVUFBVTtBQUFBLFFBQ3JFLE1BQU07QUFBQSxRQUNOLEtBQUs7QUFBQSxNQUNOO0FBRUEsVUFBSSxnQkFBZ0I7QUFDbkIsdUJBQWUsaUJBQWlCLFNBQVMsWUFBWTtBQUNwRCxnQkFBTSxhQUFhLEtBQUssUUFBUTtBQUNoQyxjQUFJLENBQUMsWUFBWTtBQUNoQixpQkFBSyxtQkFBbUIsK0NBQStDLE9BQU87QUFDOUU7QUFBQSxVQUNEO0FBRUEseUJBQWUsY0FBYztBQUM3Qix5QkFBZSxXQUFXO0FBRTFCLGNBQUk7QUFDSCxnQkFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLG9CQUFNLEtBQUssT0FBTyxlQUFlLHVCQUF1QixVQUFVO0FBQ2xFLG9CQUFNQyxlQUFjLEtBQUssT0FBTyxlQUFlLHFCQUFxQjtBQUVwRSxrQkFBSUEsY0FBYTtBQUNoQixxQkFBSyxtQkFBbUIsdUVBQXVFLFNBQVM7QUFDeEcscUJBQUssYUFBYTtBQUFBLGNBQ25CLE9BQU87QUFDTixxQkFBSyxtQkFBbUIsNkNBQTZDLE9BQU87QUFBQSxjQUM3RTtBQUdBLG9CQUFNLFNBQVMsS0FBSyxPQUFPLElBQUksVUFBVSxnQkFBZ0Isc0JBQXNCO0FBQy9FLGtCQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLHNCQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsNEJBQVksbUJBQW1CO0FBQUEsY0FDaEM7QUFHQSxtQkFBSyxRQUFRO0FBQUEsWUFDZDtBQUFBLFVBQ0QsU0FBUyxPQUFPO0FBQ2YsaUJBQUssbUJBQW1CLHVDQUF1QyxPQUFPO0FBQUEsVUFDdkUsVUFBRTtBQUNELDJCQUFlLGNBQWM7QUFDN0IsMkJBQWUsV0FBVztBQUFBLFVBQzNCO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0QsQ0FBQztBQUdGLFNBQUssb0JBQW9CLGdCQUFnQjtBQUd6QyxRQUFJLE1BQWdHO0FBQ25HLFdBQUssb0JBQW9CLGdCQUFnQjtBQUFBLElBQzFDO0FBQUEsRUFDRDtBQUFBLEVBRVEsb0JBQW9CLFdBQXdCO0FBRW5ELFVBQU0sZ0JBQWdCLFVBQVUsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDeEUsa0JBQWMsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVkzQjtBQUFBLEVBRVEsb0JBQW9CLFdBQXdCO0FBQ25ELFVBQU0saUJBQWlCLFVBQVUsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDeEUsbUJBQWUsU0FBUyxNQUFNLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUU5RCxRQUFJLHlCQUFRLGNBQWMsRUFDeEIsUUFBUSxZQUFZLEVBQ3BCLFFBQVEscUNBQXFDLEVBQzdDLFVBQVUsWUFBVSxPQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxPQUFPLEVBQzdELFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxVQUFVO0FBQ3ZELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsVUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGFBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxNQUM1RjtBQUdBLFdBQUssUUFBUTtBQUFBLElBQ2QsQ0FBQyxDQUFDO0FBRUosUUFBSSxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsU0FBUztBQUN6RCxVQUFJLHlCQUFRLGNBQWMsRUFDeEIsUUFBUSxlQUFlLEVBQ3ZCLFFBQVEsb0VBQW9FLEVBQzVFLFFBQVEsVUFBUSxLQUNmLGVBQWUsWUFBWSxFQUMzQixTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxnQkFBZ0IsRUFBRSxFQUN4RSxTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsZUFBZSxTQUFTO0FBQ3JFLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGVBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxRQUM1RjtBQUFBLE1BR0QsQ0FBQyxDQUFDO0FBRUosVUFBSSx5QkFBUSxjQUFjLEVBQ3hCLFFBQVEsd0JBQXdCLEVBQ2hDLFFBQVEsaURBQWlELEVBQ3pELFVBQVUsWUFBVSxPQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxrQkFBa0IsS0FBSyxFQUM3RSxTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsaUJBQWlCO0FBQzlELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGVBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxRQUM1RjtBQUdBLFlBQUksT0FBTztBQUNWLGVBQUssYUFBYTtBQUFBLFFBQ25CO0FBR0EsY0FBTSxTQUFTLEtBQUssT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLHNCQUFzQjtBQUMvRSxZQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLGdCQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsc0JBQVksbUJBQW1CO0FBQUEsUUFDaEM7QUFHQSxhQUFLLFFBQVE7QUFBQSxNQUNkLENBQUMsQ0FBQztBQUdKLFVBQUkseUJBQVEsY0FBYyxFQUN4QixRQUFRLG9CQUFvQixFQUM1QixRQUFRLDJDQUEyQyxFQUNuRCxVQUFVLFlBQVUsT0FDbkIsY0FBYyxnQkFBZ0IsRUFDOUIsV0FBVyxFQUNYLFFBQVEsWUFBWTtBQUVwQixjQUFNLFlBQVksUUFBUSw4RkFBOEY7QUFDeEgsWUFBSSxDQUFDLFVBQVc7QUFHaEIsYUFBSyxPQUFPLFNBQVMsVUFBVSxzQkFBc0I7QUFHckQsWUFBSSxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsZ0JBQWdCO0FBQ2hFLGVBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxpQkFBaUI7QUFBQSxRQUMvRDtBQUVBLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFHL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGdCQUFNLEtBQUssT0FBTyxlQUFlLHVCQUF1QixJQUFJO0FBQzVELGVBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxRQUM1RjtBQUdBLGNBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsWUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixnQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLHNCQUFZLG1CQUFtQjtBQUFBLFFBQ2hDO0FBR0EsYUFBSyxtQkFBbUIsc0NBQXNDLFNBQVM7QUFHdkUsYUFBSyxRQUFRO0FBQUEsTUFDZCxDQUFDLENBQUM7QUFBQSxJQUNMO0FBQUEsRUFDRDtBQUFBLEVBRVEsbUJBQW1CLFNBQWlCLE1BQTJCO0FBRXRFLFVBQU0sa0JBQWtCLEtBQUssWUFBWSxjQUFjLHVCQUF1QjtBQUM5RSxRQUFJLGlCQUFpQjtBQUNwQixzQkFBZ0IsT0FBTztBQUFBLElBQ3hCO0FBRUEsVUFBTSxZQUFZLEtBQUssWUFBWSxVQUFVO0FBQUEsTUFDNUMsS0FBSyx3QkFBd0IsSUFBSTtBQUFBLE1BQ2pDLE1BQU07QUFBQSxJQUNQLENBQUM7QUFHRCxlQUFXLE1BQU07QUFDaEIsZ0JBQVUsT0FBTztBQUFBLElBQ2xCLEdBQUcsR0FBSTtBQUFBLEVBQ1I7QUFBQSxFQUVRLGVBQWU7QUFFdEIsVUFBTSxvQkFBb0IsU0FBUyxjQUFjLEtBQUs7QUFDdEQsc0JBQWtCLFlBQVk7QUFDOUIsYUFBUyxLQUFLLFlBQVksaUJBQWlCO0FBRzNDLFVBQU0sT0FBTyxLQUFLLFlBQVksc0JBQXNCO0FBQ3BELFVBQU0sVUFBVSxLQUFLLE9BQU8sS0FBSyxRQUFRO0FBQ3pDLFVBQU0sVUFBVSxLQUFLLE1BQU0sS0FBSyxJQUFJLEtBQUssU0FBUyxHQUFHLEdBQUc7QUFHeEQsVUFBTSxTQUFTLENBQUMsUUFBUSxRQUFRLFFBQVEsU0FBUyxPQUFPLEVBQUU7QUFHMUQsYUFBUyxJQUFJLEdBQUcsSUFBSSxLQUFLLEtBQUs7QUFDN0IsWUFBTSxXQUFXLFNBQVMsY0FBYyxLQUFLO0FBQzdDLGVBQVMsWUFBWSx1QkFBdUIsT0FBTyxLQUFLLE1BQU0sS0FBSyxPQUFPLElBQUksT0FBTyxNQUFNLENBQUMsQ0FBQztBQUc3RixlQUFTLE1BQU0sT0FBTyxHQUFHLE9BQU87QUFDaEMsZUFBUyxNQUFNLE1BQU0sR0FBRyxPQUFPO0FBRy9CLFlBQU0sUUFBUyxLQUFLLEtBQUssSUFBSSxJQUFLLE9BQU8sS0FBSyxPQUFPLElBQUksTUFBTTtBQUMvRCxZQUFNLFdBQVcsTUFBTSxLQUFLLE9BQU8sSUFBSTtBQUN2QyxZQUFNLFdBQVcsS0FBSyxJQUFJLEtBQUssSUFBSTtBQUNuQyxZQUFNLFdBQVcsS0FBSyxJQUFJLEtBQUssSUFBSSxXQUFXO0FBRzlDLGVBQVMsTUFBTSxZQUFZLGVBQWUsR0FBRyxRQUFRLElBQUk7QUFDekQsZUFBUyxNQUFNLFlBQVksZUFBZSxHQUFHLFFBQVEsSUFBSTtBQUd6RCxlQUFTLE1BQU0saUJBQWlCLEdBQUcsS0FBSyxPQUFPLElBQUksR0FBRztBQUd0RCxZQUFNLE9BQU8sSUFBSSxLQUFLLE9BQU8sSUFBSTtBQUNqQyxlQUFTLE1BQU0sUUFBUSxHQUFHLElBQUk7QUFDOUIsZUFBUyxNQUFNLFNBQVMsR0FBRyxJQUFJO0FBRy9CLFVBQUksS0FBSyxPQUFPLElBQUksS0FBSztBQUN4QixpQkFBUyxNQUFNLFNBQVMsR0FBRyxPQUFPLEdBQUc7QUFBQSxNQUN0QztBQUVBLHdCQUFrQixZQUFZLFFBQVE7QUFBQSxJQUN2QztBQUdBLGVBQVcsTUFBTTtBQUNoQix3QkFBa0IsT0FBTztBQUFBLElBQzFCLEdBQUcsR0FBSTtBQUFBLEVBQ1I7QUFBQSxFQUVRLHdCQUF3QjtBQUMvQixVQUFNLEVBQUUsWUFBWSxJQUFJO0FBQ3hCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFdkQsUUFBSSx5QkFBUSxXQUFXLEVBQ3JCLFFBQVEscUJBQXFCLEVBQzdCLFFBQVEsaURBQWlELEVBQ3pELFVBQVUsWUFBVSxPQUNuQixVQUFVLEdBQUcsR0FBRyxHQUFHLEVBQ25CLFNBQVMsS0FBSyxPQUFPLFNBQVMsUUFBUSxrQkFBa0IsRUFDeEQsa0JBQWtCLEVBQ2xCLFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFFBQVEscUJBQXFCO0FBQ2xELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFFSixRQUFJLHlCQUFRLFdBQVcsRUFDckIsUUFBUSxvQkFBb0IsRUFDNUIsUUFBUSxnQ0FBZ0MsRUFDeEMsUUFBUSxVQUFRLEtBQ2YsZUFBZSxNQUFNLEVBQ3JCLFNBQVMsS0FBSyxPQUFPLFNBQVMsUUFBUSxpQkFBaUIsU0FBUyxDQUFDLEVBQ2pFLFNBQVMsT0FBTyxVQUFVO0FBQzFCLFlBQU0sV0FBVyxTQUFTLEtBQUs7QUFDL0IsVUFBSSxDQUFDLE1BQU0sUUFBUSxLQUFLLFdBQVcsR0FBRztBQUNyQyxhQUFLLE9BQU8sU0FBUyxRQUFRLG1CQUFtQjtBQUNoRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEM7QUFBQSxJQUNELENBQUMsQ0FBQztBQUVKLFFBQUkseUJBQVEsV0FBVyxFQUNyQixRQUFRLG9CQUFvQixFQUM1QixRQUFRLDBDQUEwQyxFQUNsRCxVQUFVLFlBQVUsT0FDbkIsU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUFRLFFBQVEsRUFDOUMsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsUUFBUSxXQUFXO0FBQ3hDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFBQSxFQUVMO0FBQUEsRUFFUSx5QkFBeUI7QUFDaEMsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUd4QixVQUFNLFdBQVcsWUFBWSxVQUFVLEVBQUUsS0FBSywwQkFBMEIsQ0FBQztBQUN6RSxhQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBU3pCLFVBQU0sVUFBVSxTQUFTLFdBQVcsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ3JFLFlBQVEsWUFBWTtBQUNwQixZQUFRLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPeEIsVUFBTSxVQUFVLFNBQVMsU0FBUyxNQUFNLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUN4RSxZQUFRLE1BQU0sVUFBVTtBQUV4QixVQUFNLG9CQUFvQixZQUFZLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ2hGLHNCQUFrQixNQUFNLFVBQVU7QUFHbEMsYUFBUyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3hDLFlBQU0sWUFBWSxrQkFBa0IsTUFBTSxZQUFZO0FBQ3RELHdCQUFrQixNQUFNLFVBQVUsWUFBWSxTQUFTO0FBQ3ZELGNBQVEsTUFBTSxZQUFZLFlBQVksaUJBQWlCO0FBQUEsSUFDeEQsQ0FBQztBQUdELFVBQU0sU0FBUyxrQkFBa0IsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDeEUsV0FBTyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBU25CLFNBQUsscUJBQXFCLGlCQUFpQjtBQUMzQyxTQUFLLHFCQUFxQixpQkFBaUI7QUFDM0MsU0FBSyxxQkFBcUIsaUJBQWlCO0FBQzNDLFNBQUsscUJBQXFCLGlCQUFpQjtBQUFBLEVBQzVDO0FBQUEsRUFFUSxxQkFBcUIsY0FBYyxLQUFLLGFBQWE7QUFFNUQsVUFBTSxrQkFBa0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUM5RSxvQkFBZ0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUU3RCxRQUFJLHlCQUFRLGVBQWUsRUFDekIsUUFBUSxTQUFTLEVBQ2pCLFFBQVEsd0JBQXdCLEVBQ2hDLFFBQVEsVUFBUSxLQUNmLGVBQWUsWUFBWSxFQUMzQixTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxVQUFVLEVBQUUsRUFDN0QsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVM7QUFDakQsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUdKLFVBQU0sZUFBZSxJQUFJLHlCQUFRLGVBQWUsRUFDOUMsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUI7QUFFL0IsUUFBSTtBQUVKLGlCQUFhLFlBQVksY0FBWTtBQUNwQyxzQkFBZ0I7QUFDaEIsV0FBSyxxQkFBcUIsUUFBUTtBQUNsQyxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUyw0QkFBNEIsRUFDdEYsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFFBQVE7QUFDaEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNILENBQUM7QUFFRCxpQkFBYSxVQUFVLFlBQVUsT0FDL0IsUUFBUSxZQUFZLEVBQ3BCLFdBQVcsMEJBQTBCLEVBQ3JDLFFBQVEsWUFBWTtBQUNwQixZQUFNLEtBQUssc0JBQXNCLFVBQVUsYUFBYTtBQUFBLElBQ3pELENBQUMsQ0FBQztBQUFBLEVBQ0o7QUFBQSxFQUVRLHFCQUFxQixVQUFlO0FBRTNDLGFBQVMsU0FBUyxNQUFNO0FBR3hCLFVBQU0sZ0JBQWdCO0FBQUEsTUFDckIsRUFBRSxPQUFPLDhCQUE4QixPQUFPLG9CQUFvQjtBQUFBLE1BQ2xFLEVBQUUsT0FBTyw2QkFBNkIsT0FBTyxtQkFBbUI7QUFBQSxNQUNoRSxFQUFFLE9BQU8sMEJBQTBCLE9BQU8sZ0JBQWdCO0FBQUEsTUFDMUQsRUFBRSxPQUFPLDRCQUE0QixPQUFPLGtCQUFrQjtBQUFBLE1BQzlELEVBQUUsT0FBTywyQkFBMkIsT0FBTyxpQkFBaUI7QUFBQSxJQUM3RDtBQUVBLGtCQUFjLFFBQVEsV0FBUztBQUM5QixlQUFTLFVBQVUsTUFBTSxPQUFPLE1BQU0sS0FBSztBQUFBLElBQzVDLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFjLHNCQUFzQixjQUE4QyxVQUFlO0FBaG5CbEc7QUFpbkJFLFVBQU0sVUFBUyxjQUFTLFNBQVMsa0JBQWxCLG1CQUFpQyxjQUFjO0FBQzlELFFBQUksUUFBUTtBQUNYLGFBQU8sTUFBTSxVQUFVO0FBQ3ZCLGFBQU8sTUFBTSxnQkFBZ0I7QUFBQSxJQUM5QjtBQUVBLFFBQUk7QUFDSCxZQUFNLFNBQVMsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLGtCQUFrQixZQUFZO0FBRWpGLFVBQUksT0FBTyxTQUFTLEdBQUc7QUFFdEIsaUJBQVMsU0FBUyxNQUFNO0FBR3hCLGVBQU8sUUFBUSxXQUFTO0FBQ3ZCLGdCQUFNLFFBQVEsS0FBSyxvQkFBb0IsY0FBYyxLQUFLO0FBQzFELG1CQUFTLFVBQVUsT0FBTyxLQUFLO0FBQUEsUUFDaEMsQ0FBQztBQUdELGNBQU0sZUFBZSxLQUFLLE9BQU8sU0FBUyxZQUFZLFlBQVksRUFBRTtBQUNwRSxZQUFJLGdCQUFnQixPQUFPLFNBQVMsWUFBWSxHQUFHO0FBQ2xELG1CQUFTLFNBQVMsWUFBWTtBQUFBLFFBQy9CLFdBQVcsT0FBTyxTQUFTLEdBQUc7QUFFN0IsbUJBQVMsU0FBUyxPQUFPLENBQUMsQ0FBQztBQUMzQixlQUFLLE9BQU8sU0FBUyxZQUFZLFlBQVksRUFBRSxRQUFRLE9BQU8sQ0FBQztBQUMvRCxnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDO0FBRUEsYUFBSyxtQkFBbUIsaUNBQWlDLFNBQVM7QUFBQSxNQUNuRSxPQUFPO0FBQ04sYUFBSyxtQkFBbUIsc0NBQXNDLE9BQU87QUFBQSxNQUN0RTtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLHFCQUFxQixZQUFZLFlBQVksS0FBSztBQUNoRSxXQUFLLG1CQUFtQiw2QkFBNkIsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsSUFBSSxPQUFPO0FBQUEsSUFDekgsVUFBRTtBQUNELFVBQUksUUFBUTtBQUNYLGVBQU8sTUFBTSxVQUFVO0FBQ3ZCLGVBQU8sTUFBTSxnQkFBZ0I7QUFBQSxNQUM5QjtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUEsRUFFUSxvQkFBb0IsY0FBc0IsT0FBdUI7QUFFeEUsUUFBSSxpQkFBaUIsVUFBVTtBQUM5QixVQUFJLE1BQU0sU0FBUyxRQUFRLEVBQUcsUUFBTyxNQUFNLFNBQVMsS0FBSyxJQUFJLHNCQUFzQjtBQUNuRixVQUFJLE1BQU0sU0FBUyxPQUFPLEVBQUcsUUFBTyxNQUFNLFNBQVMsS0FBSyxJQUFJLHFCQUFxQjtBQUNqRixVQUFJLE1BQU0sU0FBUyxNQUFNLEVBQUcsUUFBTztBQUFBLElBQ3BDLFdBQVcsaUJBQWlCLFVBQVU7QUFDckMsVUFBSSxNQUFNLFNBQVMsUUFBUSxFQUFHLFFBQU8sTUFBTSxTQUFTLE1BQU0sSUFBSSxnQkFBZ0I7QUFDOUUsVUFBSSxNQUFNLFNBQVMsT0FBTyxFQUFHLFFBQU87QUFDcEMsVUFBSSxNQUFNLFNBQVMsU0FBUyxFQUFHLFFBQU87QUFBQSxJQUN2QyxXQUFXLGlCQUFpQixVQUFVO0FBQ3JDLFVBQUksTUFBTSxTQUFTLEtBQUssRUFBRyxRQUFPO0FBQ2xDLFVBQUksTUFBTSxTQUFTLFNBQVMsRUFBRyxRQUFPO0FBQ3RDLFVBQUksTUFBTSxTQUFTLFdBQVcsRUFBRyxRQUFPO0FBQ3hDLFVBQUksTUFBTSxTQUFTLFNBQVMsRUFBRyxRQUFPO0FBQUEsSUFDdkM7QUFHQSxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRVEsbUJBQW1CLFNBQWlCLE1BQTJCO0FBRXRFLFVBQU0sa0JBQWtCLEtBQUssWUFBWSxjQUFjLHVCQUF1QjtBQUM5RSxRQUFJLGlCQUFpQjtBQUNwQixzQkFBZ0IsT0FBTztBQUFBLElBQ3hCO0FBRUEsVUFBTSxZQUFZLEtBQUssWUFBWSxVQUFVO0FBQUEsTUFDNUMsS0FBSyx3QkFBd0IsSUFBSTtBQUFBLE1BQ2pDLE1BQU07QUFBQSxJQUNQLENBQUM7QUFFRCxjQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FRdkIsU0FBUyxZQUNSLGdGQUNBLHlFQUNIO0FBQUE7QUFJRCxlQUFXLE1BQU07QUFDaEIsZ0JBQVUsT0FBTztBQUFBLElBQ2xCLEdBQUcsR0FBSTtBQUFBLEVBQ1I7QUFBQSxFQUdRLHFCQUFxQixjQUFjLEtBQUssYUFBYTtBQUU1RCxVQUFNLGtCQUFrQixZQUFZLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzlFLG9CQUFnQixTQUFTLE1BQU0sRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRTNELFFBQUkseUJBQVEsZUFBZSxFQUN6QixRQUFRLFNBQVMsRUFDakIsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSxVQUFRLEtBQ2YsZUFBZSxRQUFRLEVBQ3ZCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFVBQVUsRUFBRSxFQUM3RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUztBQUNqRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBRUosUUFBSSx5QkFBUSxlQUFlLEVBQ3pCLFFBQVEsVUFBVSxFQUNsQixRQUFRLDRDQUE0QyxFQUNwRCxRQUFRLFVBQVEsS0FDZixlQUFlLDJCQUEyQixFQUMxQyxTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxXQUFXLEVBQUUsRUFDOUQsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFVBQVU7QUFDbEQsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUdKLFVBQU0sZUFBZSxJQUFJLHlCQUFRLGVBQWUsRUFDOUMsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUI7QUFFL0IsUUFBSTtBQUVKLGlCQUFhLFlBQVksY0FBWTtBQUNwQyxzQkFBZ0I7QUFDaEIsV0FBSyxxQkFBcUIsUUFBUTtBQUNsQyxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUyxRQUFRLEVBQ2xFLFNBQVMsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxRQUFRO0FBQ2hELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQyxDQUFDO0FBQUEsSUFDSCxDQUFDO0FBRUQsaUJBQWEsVUFBVSxZQUFVLE9BQy9CLFFBQVEsWUFBWSxFQUNwQixXQUFXLDBCQUEwQixFQUNyQyxRQUFRLFlBQVk7QUFDcEIsWUFBTSxLQUFLLHNCQUFzQixVQUFVLGFBQWE7QUFBQSxJQUN6RCxDQUFDLENBQUM7QUFBQSxFQUNKO0FBQUEsRUFFUSxxQkFBcUIsVUFBZTtBQUUzQyxhQUFTLFNBQVMsTUFBTTtBQUd4QixVQUFNLGdCQUFnQjtBQUFBLE1BQ3JCLEVBQUUsT0FBTyxVQUFVLE9BQU8sU0FBUztBQUFBLE1BQ25DLEVBQUUsT0FBTyxlQUFlLE9BQU8sY0FBYztBQUFBLE1BQzdDLEVBQUUsT0FBTyxlQUFlLE9BQU8sY0FBYztBQUFBLE1BQzdDLEVBQUUsT0FBTyxTQUFTLE9BQU8sUUFBUTtBQUFBLE1BQ2pDLEVBQUUsT0FBTyxpQkFBaUIsT0FBTyxnQkFBZ0I7QUFBQSxJQUNsRDtBQUVBLGtCQUFjLFFBQVEsV0FBUztBQUM5QixlQUFTLFVBQVUsTUFBTSxPQUFPLE1BQU0sS0FBSztBQUFBLElBQzVDLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFUSxxQkFBcUIsY0FBYyxLQUFLLGFBQWE7QUFFNUQsVUFBTSxrQkFBa0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUM5RSxvQkFBZ0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUUxRCxRQUFJLHlCQUFRLGVBQWUsRUFDekIsUUFBUSxTQUFTLEVBQ2pCLFFBQVEsd0JBQXdCLEVBQ2hDLFFBQVEsVUFBUSxLQUNmLGVBQWUsT0FBTyxFQUN0QixTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxVQUFVLEVBQUUsRUFDN0QsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVM7QUFDakQsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUdKLFVBQU0sZUFBZSxJQUFJLHlCQUFRLGVBQWUsRUFDOUMsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUI7QUFFL0IsUUFBSTtBQUVKLGlCQUFhLFlBQVksY0FBWTtBQUNwQyxzQkFBZ0I7QUFDaEIsV0FBSyxxQkFBcUIsUUFBUTtBQUNsQyxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUyxrQkFBa0IsRUFDNUUsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFFBQVE7QUFDaEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNILENBQUM7QUFFRCxpQkFBYSxVQUFVLFlBQVUsT0FDL0IsUUFBUSxZQUFZLEVBQ3BCLFdBQVcsMEJBQTBCLEVBQ3JDLFFBQVEsWUFBWTtBQUNwQixZQUFNLEtBQUssc0JBQXNCLFVBQVUsYUFBYTtBQUFBLElBQ3pELENBQUMsQ0FBQztBQUFBLEVBQ0o7QUFBQSxFQUVRLHFCQUFxQixVQUFlO0FBRTNDLGFBQVMsU0FBUyxNQUFNO0FBR3hCLFVBQU0sZ0JBQWdCO0FBQUEsTUFDckIsRUFBRSxPQUFPLHdCQUF3QixPQUFPLGtDQUFrQztBQUFBLE1BQzFFLEVBQUUsT0FBTyxrQkFBa0IsT0FBTyxpQkFBaUI7QUFBQSxNQUNuRCxFQUFFLE9BQU8sb0JBQW9CLE9BQU8sbUJBQW1CO0FBQUEsTUFDdkQsRUFBRSxPQUFPLGtCQUFrQixPQUFPLGlCQUFpQjtBQUFBLElBQ3BEO0FBRUEsa0JBQWMsUUFBUSxXQUFTO0FBQzlCLGVBQVMsVUFBVSxNQUFNLE9BQU8sTUFBTSxLQUFLO0FBQUEsSUFDNUMsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLHFCQUFxQixjQUFjLEtBQUssYUFBYTtBQUM1RCxVQUFNLGtCQUFrQixZQUFZLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzlFLG9CQUFnQixTQUFTLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRXpELFFBQUkseUJBQVEsZUFBZSxFQUN6QixRQUFRLFVBQVUsRUFDbEIsUUFBUSxtQkFBbUIsRUFDM0IsUUFBUSxVQUFRLEtBQ2YsZUFBZSx3QkFBd0IsRUFDdkMsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sV0FBVyxFQUFFLEVBQzlELFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxVQUFVO0FBQ2xELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFFSixRQUFJLHlCQUFRLGVBQWUsRUFDekIsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSxVQUFRLEtBQ2YsZUFBZSxRQUFRLEVBQ3ZCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVMsRUFBRSxFQUM1RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sUUFBUTtBQUNoRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRVEseUJBQXlCO0FBQ2hDLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFHeEIsVUFBTSxXQUFXLFlBQVksVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDekUsYUFBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVN6QixVQUFNLFVBQVUsU0FBUyxXQUFXLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUNyRSxZQUFRLFlBQVk7QUFDcEIsWUFBUSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3hCLFVBQU0sVUFBVSxTQUFTLFNBQVMsTUFBTSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDckUsWUFBUSxNQUFNLFVBQVU7QUFFeEIsVUFBTSxvQkFBb0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUNoRixzQkFBa0IsTUFBTSxVQUFVO0FBR2xDLGFBQVMsaUJBQWlCLFNBQVMsTUFBTTtBQUN4QyxZQUFNLFlBQVksa0JBQWtCLE1BQU0sWUFBWTtBQUN0RCx3QkFBa0IsTUFBTSxVQUFVLFlBQVksU0FBUztBQUN2RCxjQUFRLE1BQU0sWUFBWSxZQUFZLGlCQUFpQjtBQUFBLElBQ3hELENBQUM7QUFHRCxVQUFNLFNBQVMsa0JBQWtCLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3hFLFdBQU8sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVFuQixzQkFBa0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDcEQsVUFBTSxrQkFBa0IsSUFBSSx5QkFBUSxpQkFBaUIsRUFDbkQsUUFBUSxrQkFBa0IsRUFDMUIsUUFBUSxpQ0FBaUMsRUFDekMsWUFBWSxjQUFZO0FBQ3hCLFlBQU0sbUJBQW1CLEtBQUssK0JBQStCLFNBQVM7QUFFdEUsdUJBQWlCLFFBQVEsY0FBWTtBQUNwQyxjQUFNLFFBQVEsS0FBSyx1QkFBdUIsUUFBUTtBQUNsRCxpQkFBUyxVQUFVLFVBQVUsS0FBSztBQUFBLE1BQ25DLENBQUM7QUFFRCxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxlQUFlLEVBQ3RFLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxhQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxrQkFBa0I7QUFDaEUsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixZQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsZUFBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsUUFDbEU7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNILENBQUM7QUFFRixzQkFBa0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDbkQsVUFBTSxnQkFBZ0IsSUFBSSx5QkFBUSxpQkFBaUIsRUFDakQsUUFBUSxrQkFBa0IsRUFDMUIsUUFBUSx3Q0FBd0M7QUFFbEQsa0JBQWMsWUFBWSxjQUFZLFNBQ3BDLFVBQVUsUUFBUSxpQkFBaUIsRUFDbkMsVUFBVSxVQUFVLFFBQVEsRUFDNUIsVUFBVSxVQUFVLFFBQVEsRUFDNUIsVUFBVSxVQUFVLFFBQVEsRUFDNUIsU0FBUyxLQUFLLE9BQU8sU0FBUyxpQkFBaUIsT0FBTyxlQUFlLEVBQ3JFLFNBQVMsT0FBTyxVQUFrQjtBQUNsQyxXQUFLLE9BQU8sU0FBUyxpQkFBaUIsT0FBTyxrQkFBa0I7QUFDL0QsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixVQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsYUFBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsTUFDbEU7QUFBQSxJQUNELENBQUMsQ0FBQztBQUFBLEVBQ0o7QUFBQSxFQUVRLCtCQUErQixVQUFnRDtBQUV0RixXQUFPLGFBQWEsWUFDakIsQ0FBQyxVQUFVLFVBQVUsVUFBVSxRQUFRLElBQ3ZDLENBQUMsVUFBVSxVQUFVLFFBQVE7QUFBQSxFQUNqQztBQUFBLEVBRVEsdUJBQXVCLFVBQWdDO0FBQzlELFVBQU0sUUFBc0M7QUFBQSxNQUMzQyxVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixRQUFRO0FBQUEsSUFDVDtBQUNBLFdBQU8sTUFBTSxRQUFRLEtBQUs7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxtQkFBbUIsWUFBbUM7QUFDM0QsVUFBTSxXQUFXLDBCQUFTLFdBQVcsV0FBVztBQUNoRCxTQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBUSxFQUFFLGtCQUFrQjtBQUdsRSxRQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsV0FBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsSUFDbEU7QUFBQSxFQUNEO0FBQUEsRUFFUSx3QkFBd0I7QUFDL0IsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUd4QixVQUFNLFdBQVcsWUFBWSxVQUFVLEVBQUUsS0FBSywwQkFBMEIsQ0FBQztBQUN6RSxhQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBU3pCLFVBQU0sVUFBVSxTQUFTLFdBQVcsRUFBRSxLQUFLLHlCQUF5QixDQUFDO0FBQ3JFLFlBQVEsWUFBWTtBQUNwQixZQUFRLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPeEIsVUFBTSxVQUFVLFNBQVMsU0FBUyxNQUFNLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNuRSxZQUFRLE1BQU0sVUFBVTtBQUV4QixVQUFNLG1CQUFtQixZQUFZLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzlFLHFCQUFpQixNQUFNLFVBQVU7QUFHakMsYUFBUyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3hDLFlBQU0sWUFBWSxpQkFBaUIsTUFBTSxZQUFZO0FBQ3JELHVCQUFpQixNQUFNLFVBQVUsWUFBWSxTQUFTO0FBQ3RELGNBQVEsTUFBTSxZQUFZLFlBQVksaUJBQWlCO0FBQUEsSUFDeEQsQ0FBQztBQUdELFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsaUJBQWlCLEdBQUc7QUFDcEUsWUFBTSxXQUFXLGlCQUFpQixVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUMxRSxlQUFTLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBU3JCO0FBQUEsSUFDRDtBQUdBLFVBQU0sU0FBUyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssMkJBQTJCLENBQUM7QUFDN0UsV0FBTyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPbkIsUUFBSSx5QkFBUSxnQkFBZ0IsRUFDMUIsUUFBUSw2QkFBNkIsRUFDckMsUUFBUSwwRUFBMEUsRUFDbEYsVUFBVSxZQUFVLE9BQ25CLFNBQVMsS0FBSyxPQUFPLFNBQVMsaUJBQWlCLEVBQy9DLFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLG9CQUFvQjtBQUN6QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBRy9CLFlBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsVUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixjQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsb0JBQVkscUJBQXFCO0FBQUEsTUFDbEM7QUFBQSxJQUNELENBQUMsQ0FBQztBQUdKLFVBQU0sV0FBVyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFDdkUsYUFBUyxNQUFNLFVBQVU7QUFFekIsUUFBSSx5QkFBUSxRQUFRLEVBQ2xCO0FBQUEsTUFBVSxZQUNWLE9BQ0UsY0FBYyxzQkFBc0IsRUFDcEMsT0FBTyxFQUNQLFFBQVEsTUFBTSxLQUFLLHFCQUFxQixDQUFDO0FBQUEsSUFDNUM7QUFHRCxTQUFLLHlCQUF5QixnQkFBZ0I7QUFBQSxFQUMvQztBQUFBLEVBRVEseUJBQXlCLFdBQXdCO0FBRXhELFVBQU0sZUFBZSxVQUFVLGNBQWMscUJBQXFCO0FBQ2xFLFFBQUksYUFBYyxjQUFhLE9BQU87QUFFdEMsVUFBTSxlQUFlLFVBQVUsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDdEUsVUFBTSxXQUFXLEtBQUssT0FBTyxTQUFTLGtCQUFrQixDQUFDO0FBRXpELFFBQUksU0FBUyxXQUFXLEdBQUc7QUFDMUIsWUFBTSxVQUFVLGFBQWEsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDckUsY0FBUSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1wQjtBQUFBLElBQ0Q7QUFFQSxhQUFTLFFBQVEsQ0FBQyxTQUFTLFVBQVU7QUFDcEMsWUFBTSxZQUFZLGFBQWEsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDckUsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUzFCLFlBQU0sV0FBVyxVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ25FLGVBQVMsTUFBTSxVQUFVO0FBRXpCLFlBQU0sU0FBUyxTQUFTLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBRTlELFlBQU0sU0FBUyxPQUFPLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQzVELGFBQU8sY0FBYyxRQUFRO0FBQzdCLGFBQU8sTUFBTSxVQUFVO0FBRXZCLFlBQU0sWUFBWSxPQUFPLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ2xFLGdCQUFVLFlBQVksVUFBVSxRQUFRLE9BQU87QUFDL0MsZ0JBQVUsTUFBTSxVQUFVO0FBRzFCLFlBQU0sWUFBWSxTQUFTLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ3BFLGdCQUFVLE1BQU0sVUFBVTtBQUUxQixZQUFNLFVBQVUsVUFBVSxTQUFTLFVBQVUsRUFBRSxNQUFNLE9BQU8sQ0FBQztBQUM3RCxjQUFRLE1BQU0sVUFBVTtBQUN4QixjQUFRLFVBQVUsTUFBTSxLQUFLLHNCQUFzQixLQUFLO0FBRXhELFlBQU0sWUFBWSxVQUFVLFNBQVMsVUFBVSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQ2pFLGdCQUFVLE1BQU0sVUFBVTtBQUMxQixnQkFBVSxVQUFVLE1BQU0sS0FBSyxjQUFjLEtBQUs7QUFHbEQsVUFBSSxRQUFRLGFBQWE7QUFDeEIsY0FBTSxTQUFTLFVBQVUsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDL0QsZUFBTyxjQUFjLFFBQVE7QUFDN0IsZUFBTyxNQUFNLFVBQVU7QUFBQSxNQUN4QjtBQUVBLFlBQU0sYUFBYSxVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ3ZFLGlCQUFXLFlBQVk7QUFBQTtBQUFBLE9BRW5CLFFBQVEsUUFBUTtBQUFBO0FBQUE7QUFBQSxJQUdyQixDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsdUJBQXVCO0FBQzlCLFNBQUssa0JBQWtCO0FBQUEsRUFDeEI7QUFBQSxFQUVRLHNCQUFzQixPQUFlO0FBOW9DOUM7QUErb0NFLFVBQU0sV0FBVSxVQUFLLE9BQU8sU0FBUyxtQkFBckIsbUJBQXNDO0FBQ3RELFFBQUksU0FBUztBQUNaLFdBQUssa0JBQWtCLFNBQVMsS0FBSztBQUFBLElBQ3RDO0FBQUEsRUFDRDtBQUFBLEVBRVEsa0JBQWtCLGlCQUFpQyxXQUFvQjtBQUc5RSxVQUFNLE9BQU8sT0FBTyxrQkFBaUIsbURBQWlCLFNBQVEsRUFBRTtBQUNoRSxRQUFJLENBQUMsS0FBTTtBQUVYLFVBQU0sVUFBVSxPQUFPLGlDQUFnQyxtREFBaUIsWUFBVyxFQUFFO0FBQ3JGLFFBQUksQ0FBQyxRQUFTO0FBRWQsVUFBTSxjQUFjLE9BQU8sNEJBQTJCLG1EQUFpQixnQkFBZSxFQUFFO0FBRXhGLFVBQU0sV0FBVyxPQUFPLHNCQUFxQixtREFBaUIsYUFBWSxFQUFFO0FBQzVFLFFBQUksQ0FBQyxTQUFVO0FBRWYsVUFBTSxTQUF3QjtBQUFBLE1BQzdCLEtBQUksbURBQWlCLE9BQU8sU0FBUyxLQUFLLE9BQU8sRUFBRSxTQUFTLEVBQUUsRUFBRSxPQUFPLEdBQUcsQ0FBQztBQUFBLE1BQzNFO0FBQUEsTUFDQSxTQUFTLFFBQVEsWUFBWTtBQUFBLE1BQzdCO0FBQUEsTUFDQSxhQUFhLGVBQWU7QUFBQSxJQUM3QjtBQUVBLFFBQUksY0FBYyxRQUFXO0FBRTVCLFVBQUksQ0FBQyxLQUFLLE9BQU8sU0FBUyxlQUFnQixNQUFLLE9BQU8sU0FBUyxpQkFBaUIsQ0FBQztBQUNqRixXQUFLLE9BQU8sU0FBUyxlQUFlLFNBQVMsSUFBSTtBQUFBLElBQ2xELE9BQU87QUFFTixVQUFJLENBQUMsS0FBSyxPQUFPLFNBQVMsZUFBZ0IsTUFBSyxPQUFPLFNBQVMsaUJBQWlCLENBQUM7QUFDakYsV0FBSyxPQUFPLFNBQVMsZUFBZSxLQUFLLE1BQU07QUFBQSxJQUNoRDtBQUVBLFNBQUssT0FBTyxhQUFhO0FBQ3pCLFNBQUsseUJBQXlCLEtBQUssWUFBWSxjQUFjLHVCQUF1QixDQUFnQjtBQUFBLEVBQ3JHO0FBQUEsRUFFUSxjQUFjLE9BQWU7QUFDcEMsUUFBSSxDQUFDLEtBQUssT0FBTyxTQUFTLGVBQWdCO0FBRTFDLFVBQU0sVUFBVSxLQUFLLE9BQU8sU0FBUyxlQUFlLEtBQUs7QUFDekQsVUFBTSxZQUFZLFFBQVEsbUJBQW1CLFFBQVEsSUFBSSxNQUFNLFFBQVEsT0FBTyxJQUFJO0FBRWxGLFFBQUksV0FBVztBQUNkLFdBQUssT0FBTyxTQUFTLGVBQWUsT0FBTyxPQUFPLENBQUM7QUFDbkQsV0FBSyxPQUFPLGFBQWE7QUFDekIsV0FBSyx5QkFBeUIsS0FBSyxZQUFZLGNBQWMsdUJBQXVCLENBQWdCO0FBQUEsSUFDckc7QUFBQSxFQUNEO0FBQ0Q7OztBSXJzQ0EsSUFBQUMsbUJBQXlCOzs7QUNFbEIsSUFBTSxpQkFBTixNQUEyQztBQUFBLEVBS2pELFlBQVksUUFBd0I7QUFKcEMsZ0JBQU87QUFFUCxTQUFRLGVBQWdDO0FBR3ZDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLGFBQWEsUUFBd0I7QUFDcEMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsTUFBTSxjQUFnQztBQUNyQyxXQUFPLENBQUMsQ0FBQyxLQUFLLE9BQU87QUFBQSxFQUN0QjtBQUFBLEVBRUEsTUFBTSxhQUFhQyxTQUFnQixTQUFnRDtBQUNsRixVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLG1CQUFtQkEsU0FBZ0IsU0FBaUU7QUFDMUcsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVNBLFFBQU8sQ0FBQztBQUNoRSxXQUFPLEtBQUsscUJBQXFCLFVBQVUsT0FBTztBQUFBLEVBQ25EO0FBQUEsRUFFQSxNQUFNLGVBQWUsVUFBdUIsU0FBZ0Q7QUFDM0YsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSx5Q0FBeUM7QUFBQSxNQUNyRSxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxRQUNoQixhQUFhLEtBQUssT0FBTztBQUFBLFFBQ3pCLHFCQUFxQjtBQUFBLE1BQ3RCO0FBQUEsTUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCLFFBQU8sbUNBQVMsVUFBUyxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzlDLGFBQVksbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQzNELGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxRQUNoRSxRQUFRLG1DQUFTO0FBQUEsUUFDakIsVUFBVSxTQUFTLElBQUksVUFBUTtBQUFBLFVBQzlCLE1BQU0sSUFBSSxTQUFTLGNBQWMsY0FBYztBQUFBLFVBQy9DLFNBQVMsSUFBSTtBQUFBLFFBQ2QsRUFBRTtBQUFBLE1BQ0gsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFFBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsWUFBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsSUFDM0Q7QUFFQSxVQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFDakMsV0FBTyxLQUFLLFFBQVEsQ0FBQyxFQUFFO0FBQUEsRUFDeEI7QUFBQSxFQUVBLE1BQU0sU0FBUyxjQUFzQixZQUFvQixTQUFnRDtBQUN4RyxVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBUyxXQUFXLENBQUM7QUFDcEUsVUFBTSxrQkFBa0IsRUFBRSxHQUFHLFNBQVMsYUFBYTtBQUNuRCxXQUFPLEtBQUssZUFBZSxVQUFVLGVBQWU7QUFBQSxFQUNyRDtBQUFBLEVBRUEsT0FBTyxxQkFBcUIsVUFBdUIsU0FBaUU7QUFuRXJIO0FBb0VFLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sV0FBVyxNQUFNLE1BQU0seUNBQXlDO0FBQUEsTUFDckUsUUFBUTtBQUFBLE1BQ1IsU0FBUztBQUFBLFFBQ1IsZ0JBQWdCO0FBQUEsUUFDaEIsYUFBYSxLQUFLLE9BQU87QUFBQSxRQUN6QixxQkFBcUI7QUFBQSxNQUN0QjtBQUFBLE1BQ0EsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQixRQUFPLG1DQUFTLFVBQVMsS0FBSyxPQUFPLFNBQVM7QUFBQSxRQUM5QyxhQUFZLG1DQUFTLGNBQWEsS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUMzRCxjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsUUFDaEUsUUFBUSxtQ0FBUztBQUFBLFFBQ2pCLFFBQVE7QUFBQSxRQUNSLFVBQVUsU0FBUyxJQUFJLFVBQVE7QUFBQSxVQUM5QixNQUFNLElBQUksU0FBUyxjQUFjLGNBQWM7QUFBQSxVQUMvQyxTQUFTLElBQUk7QUFBQSxRQUNkLEVBQUU7QUFBQSxNQUNILENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxRQUFJLFNBQVM7QUFFYixRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGtCQUFVLFFBQVEsT0FBTyxPQUFPLEVBQUUsUUFBUSxLQUFLLENBQUM7QUFDaEQsY0FBTSxRQUFRLE9BQU8sTUFBTSxJQUFJO0FBQy9CLGlCQUFTLE1BQU0sSUFBSSxLQUFLO0FBRXhCLG1CQUFXLFFBQVEsT0FBTztBQUN6QixjQUFJLEtBQUssV0FBVyxRQUFRLEdBQUc7QUFDOUIsa0JBQU0sT0FBTyxLQUFLLE1BQU0sQ0FBQztBQUN6QixnQkFBSSxTQUFTLFVBQVU7QUFDdEIsb0JBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQ2hDO0FBQUEsWUFDRDtBQUVBLGdCQUFJO0FBQ0gsb0JBQU0sU0FBUyxLQUFLLE1BQU0sSUFBSTtBQUM5QixrQkFBSSxPQUFPLFNBQVMsMkJBQXlCLFlBQU8sVUFBUCxtQkFBYyxPQUFNO0FBQ2hFLHNCQUFNLEVBQUUsU0FBUyxPQUFPLE1BQU0sTUFBTSxNQUFNLE1BQU07QUFBQSxjQUNqRDtBQUFBLFlBQ0QsU0FBUyxHQUFHO0FBQUEsWUFFWjtBQUFBLFVBQ0Q7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0QsVUFBRTtBQUNELGFBQU8sWUFBWTtBQUFBLElBQ3BCO0FBRUEsVUFBTSxFQUFFLFNBQVMsSUFBSSxNQUFNLEtBQUs7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxxQkFBd0M7QUFDN0MsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBR0EsUUFBSSxLQUFLLGNBQWM7QUFDdEIsYUFBTyxLQUFLO0FBQUEsSUFDYjtBQUlBLFFBQUk7QUFFSCxZQUFNLFdBQVcsTUFBTSxNQUFNLHlDQUF5QztBQUFBLFFBQ3JFLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGdCQUFnQjtBQUFBLFVBQ2hCLGFBQWEsS0FBSyxPQUFPO0FBQUEsVUFDekIscUJBQXFCO0FBQUEsUUFDdEI7QUFBQSxRQUNBLE1BQU0sS0FBSyxVQUFVO0FBQUEsVUFDcEIsT0FBTztBQUFBLFVBQ1AsWUFBWTtBQUFBLFVBQ1osVUFBVSxDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVMsT0FBTyxDQUFDO0FBQUEsUUFDN0MsQ0FBQztBQUFBLE1BQ0YsQ0FBQztBQUVELFVBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsY0FBTSxJQUFJLE1BQU0sOEJBQThCLFNBQVMsVUFBVSxFQUFFO0FBQUEsTUFDcEU7QUFHQSxZQUFNLFNBQVM7QUFBQSxRQUNkO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0Q7QUFFQSxXQUFLLGVBQWU7QUFDcEIsYUFBTztBQUFBLElBQ1IsU0FBUyxPQUFPO0FBQ2YsWUFBTSxJQUFJLE1BQU0sa0NBQWtDLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUM3RztBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUF3QjtBQUN2QixTQUFLLGVBQWU7QUFBQSxFQUNyQjtBQUNEOzs7QUNsTU8sSUFBTSxpQkFBTixNQUEyQztBQUFBLEVBS2pELFlBQVksUUFBd0I7QUFKcEMsZ0JBQU87QUFFUCxTQUFRLGVBQWdDO0FBR3ZDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLGFBQWEsUUFBd0I7QUFDcEMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsTUFBTSxjQUFnQztBQUNyQyxXQUFPLENBQUMsQ0FBQyxLQUFLLE9BQU87QUFBQSxFQUN0QjtBQUFBLEVBRUEsTUFBTSxhQUFhQyxTQUFnQixTQUFnRDtBQUNsRixVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLG1CQUFtQkEsU0FBZ0IsU0FBaUU7QUFDMUcsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVNBLFFBQU8sQ0FBQztBQUNoRSxXQUFPLEtBQUsscUJBQXFCLFVBQVUsT0FBTztBQUFBLEVBQ25EO0FBQUEsRUFFQSxNQUFNLGVBQWUsVUFBdUIsU0FBZ0Q7QUFDM0YsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxrQkFBa0IsQ0FBQyxHQUFHLFFBQVE7QUFDcEMsUUFBSSxtQ0FBUyxjQUFjO0FBQzFCLHNCQUFnQixRQUFRLEVBQUUsTUFBTSxVQUFVLFNBQVMsUUFBUSxhQUFhLENBQUM7QUFBQSxJQUMxRTtBQUVBLFVBQU0sVUFBVSxLQUFLLE9BQU8sV0FBVztBQUN2QyxVQUFNLFdBQVcsUUFBUSxTQUFTLG1CQUFtQixJQUFJLFVBQVUsR0FBRyxPQUFPO0FBQzdFLFVBQU0sV0FBVyxNQUFNLE1BQU0sVUFBVTtBQUFBLE1BQ3RDLFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxRQUNSLGdCQUFnQjtBQUFBLFFBQ2hCLGlCQUFpQixVQUFVLEtBQUssT0FBTyxNQUFNO0FBQUEsTUFDOUM7QUFBQSxNQUNBLE1BQU0sS0FBSyxVQUFVO0FBQUEsUUFDcEIsUUFBTyxtQ0FBUyxVQUFTLEtBQUssT0FBTyxTQUFTO0FBQUEsUUFDOUMsVUFBVTtBQUFBLFFBQ1YsYUFBWSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDM0QsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLE1BQ2pFLENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBQ2pDLFdBQU8sS0FBSyxRQUFRLENBQUMsRUFBRSxRQUFRO0FBQUEsRUFDaEM7QUFBQSxFQUVBLE1BQU0sU0FBUyxjQUFzQixZQUFvQixTQUFnRDtBQUN4RyxVQUFNLFdBQXdCO0FBQUEsTUFDN0IsRUFBRSxNQUFNLFVBQVUsU0FBUyxhQUFhO0FBQUEsTUFDeEMsRUFBRSxNQUFNLFFBQVEsU0FBUyxXQUFXO0FBQUEsSUFDckM7QUFDQSxXQUFPLEtBQUssZUFBZSxVQUFVLE9BQU87QUFBQSxFQUM3QztBQUFBLEVBRUEsT0FBTyxxQkFBcUIsVUFBdUIsU0FBaUU7QUF2RXJIO0FBd0VFLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sa0JBQWtCLENBQUMsR0FBRyxRQUFRO0FBQ3BDLFFBQUksbUNBQVMsY0FBYztBQUMxQixzQkFBZ0IsUUFBUSxFQUFFLE1BQU0sVUFBVSxTQUFTLFFBQVEsYUFBYSxDQUFDO0FBQUEsSUFDMUU7QUFFQSxVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxXQUFXLFFBQVEsU0FBUyxtQkFBbUIsSUFBSSxVQUFVLEdBQUcsT0FBTztBQUM3RSxVQUFNLFdBQVcsTUFBTSxNQUFNLFVBQVU7QUFBQSxNQUN0QyxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxRQUNoQixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sTUFBTTtBQUFBLE1BQzlDO0FBQUEsTUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCLFFBQU8sbUNBQVMsVUFBUyxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzlDLFVBQVU7QUFBQSxRQUNWLGFBQVksbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQzNELGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxRQUNoRSxRQUFRO0FBQUEsTUFDVCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sVUFBUyxjQUFTLFNBQVQsbUJBQWU7QUFDOUIsUUFBSSxDQUFDLFFBQVE7QUFDWixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sVUFBVSxJQUFJLFlBQVk7QUFDaEMsUUFBSSxTQUFTO0FBRWIsUUFBSTtBQUNILGFBQU8sTUFBTTtBQUNaLGNBQU0sRUFBRSxNQUFNLE1BQU0sSUFBSSxNQUFNLE9BQU8sS0FBSztBQUMxQyxZQUFJLEtBQU07QUFFVixrQkFBVSxRQUFRLE9BQU8sT0FBTyxFQUFFLFFBQVEsS0FBSyxDQUFDO0FBQ2hELGNBQU0sUUFBUSxPQUFPLE1BQU0sSUFBSTtBQUMvQixpQkFBUyxNQUFNLElBQUksS0FBSztBQUV4QixtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLFdBQVcsUUFBUSxHQUFHO0FBQzlCLGtCQUFNLE9BQU8sS0FBSyxNQUFNLENBQUM7QUFDekIsZ0JBQUksU0FBUyxVQUFVO0FBQ3RCLG9CQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUNoQztBQUFBLFlBQ0Q7QUFFQSxnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsb0JBQU0sV0FBVSx3QkFBTyxZQUFQLG1CQUFpQixPQUFqQixtQkFBcUIsVUFBckIsbUJBQTRCO0FBQzVDLGtCQUFJLFNBQVM7QUFDWixzQkFBTSxFQUFFLFNBQVMsTUFBTSxNQUFNO0FBQUEsY0FDOUI7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXdDO0FBQzdDLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUdBLFFBQUksS0FBSyxjQUFjO0FBQ3RCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFFQSxRQUFJO0FBQ0gsWUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFlBQU0sV0FBVyxRQUFRLFNBQVMsU0FBUyxJQUFJLFVBQVUsR0FBRyxPQUFPO0FBRW5FLFlBQU0sV0FBVyxNQUFNLE1BQU0sVUFBVTtBQUFBLFFBQ3RDLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGlCQUFpQixVQUFVLEtBQUssT0FBTyxNQUFNO0FBQUEsUUFDOUM7QUFBQSxNQUNELENBQUM7QUFFRCxVQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLGNBQU0sSUFBSSxNQUFNLHVCQUF1QixTQUFTLFVBQVUsRUFBRTtBQUFBLE1BQzdEO0FBRUEsWUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBR2pDLFlBQU0sYUFBYSxLQUFLLEtBQ3RCLE9BQU8sQ0FBQyxVQUFlO0FBQ3ZCLGNBQU0sS0FBSyxNQUFNLEdBQUcsWUFBWTtBQUNoQyxnQkFBUSxHQUFHLFNBQVMsS0FBSyxLQUFLLEdBQUcsU0FBUyxNQUFNLE1BQzVDLENBQUMsR0FBRyxTQUFTLFVBQVUsS0FDdkIsQ0FBQyxHQUFHLFNBQVMsTUFBTSxLQUNuQixDQUFDLEdBQUcsU0FBUyxRQUFRLEtBQ3JCLENBQUMsR0FBRyxTQUFTLFlBQVksS0FDekIsQ0FBQyxHQUFHLFNBQVMsV0FBVztBQUFBLE1BQzdCLENBQUMsRUFDQSxJQUFJLENBQUMsVUFBZSxNQUFNLEVBQUUsRUFDNUIsS0FBSztBQUVQLFlBQU0sU0FBUyxXQUFXLFNBQVMsSUFBSSxhQUFhO0FBQUEsUUFDbkQ7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUVBLFdBQUssZUFBZTtBQUNwQixhQUFPO0FBQUEsSUFDUixTQUFTLE9BQU87QUFDZixZQUFNLElBQUksTUFBTSxrQ0FBa0MsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQzdHO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQXdCO0FBQ3ZCLFNBQUssZUFBZTtBQUFBLEVBQ3JCO0FBQ0Q7OztBQ2pOTyxJQUFNLGlCQUFOLE1BQTJDO0FBQUEsRUFLakQsWUFBWSxRQUF3QjtBQUpwQyxnQkFBTztBQUVQLFNBQVEsZUFBZ0M7QUFHdkMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsYUFBYSxRQUF3QjtBQUNwQyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxNQUFNLGNBQWdDO0FBQ3JDLFdBQU8sQ0FBQyxDQUFDLEtBQUssT0FBTztBQUFBLEVBQ3RCO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTQSxRQUFPLENBQUM7QUFDaEUsV0FBTyxLQUFLLGVBQWUsVUFBVSxPQUFPO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQUMxRyxVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxxQkFBcUIsVUFBVSxPQUFPO0FBQUEsRUFDbkQ7QUFBQSxFQUVRLHdCQUF3QixVQUF1QixjQUE0QjtBQUNsRixVQUFNLFdBQVcsQ0FBQztBQUVsQixRQUFJLGNBQWM7QUFDakIsZUFBUyxLQUFLO0FBQUEsUUFDYixNQUFNO0FBQUEsUUFDTixPQUFPLENBQUMsRUFBRSxNQUFNLFdBQVcsWUFBWSxHQUFHLENBQUM7QUFBQSxNQUM1QyxDQUFDO0FBQUEsSUFDRjtBQUVBLGVBQVcsV0FBVyxVQUFVO0FBQy9CLFlBQU0sT0FBTyxRQUFRLFNBQVMsY0FBYyxVQUFVO0FBQ3RELGVBQVMsS0FBSztBQUFBLFFBQ2I7QUFBQSxRQUNBLE9BQU8sQ0FBQyxFQUFFLE1BQU0sUUFBUSxRQUFRLENBQUM7QUFBQSxNQUNsQyxDQUFDO0FBQUEsSUFDRjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLGVBQWUsVUFBdUIsU0FBZ0Q7QUFDM0YsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPLFNBQVM7QUFDckQsVUFBTSxNQUFNLDJEQUEyRCxLQUFLLHdCQUF3QixLQUFLLE9BQU8sTUFBTTtBQUV0SCxVQUFNLFdBQVcsTUFBTSxNQUFNLEtBQUs7QUFBQSxNQUNqQyxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxNQUNqQjtBQUFBLE1BQ0EsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQixVQUFVLEtBQUssd0JBQXdCLFVBQVUsbUNBQVMsWUFBWTtBQUFBLFFBQ3RFLGtCQUFrQjtBQUFBLFVBQ2pCLGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxVQUNoRSxrQkFBaUIsbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2pFO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sT0FBTyxNQUFNLFNBQVMsS0FBSztBQUNqQyxXQUFPLEtBQUssV0FBVyxDQUFDLEVBQUUsUUFBUSxNQUFNLENBQUMsRUFBRTtBQUFBLEVBQzVDO0FBQUEsRUFFQSxNQUFNLFNBQVMsY0FBc0IsWUFBb0IsU0FBZ0Q7QUFDeEcsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVMsV0FBVyxDQUFDO0FBQ3BFLFVBQU0sa0JBQWtCLEVBQUUsR0FBRyxTQUFTLGFBQWE7QUFDbkQsV0FBTyxLQUFLLGVBQWUsVUFBVSxlQUFlO0FBQUEsRUFDckQ7QUFBQSxFQUVBLE9BQU8scUJBQXFCLFVBQXVCLFNBQWlFO0FBdEZySDtBQXVGRSxRQUFJLENBQUMsS0FBSyxPQUFPLFFBQVE7QUFDeEIsWUFBTSxJQUFJLE1BQU0sK0JBQStCO0FBQUEsSUFDaEQ7QUFFQSxVQUFNLFNBQVEsbUNBQVMsVUFBUyxLQUFLLE9BQU8sU0FBUztBQUNyRCxVQUFNLE1BQU0sMkRBQTJELEtBQUssOEJBQThCLEtBQUssT0FBTyxNQUFNO0FBRTVILFVBQU0sV0FBVyxNQUFNLE1BQU0sS0FBSztBQUFBLE1BQ2pDLFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxRQUNSLGdCQUFnQjtBQUFBLE1BQ2pCO0FBQUEsTUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCLFVBQVUsS0FBSyx3QkFBd0IsVUFBVSxtQ0FBUyxZQUFZO0FBQUEsUUFDdEUsa0JBQWtCO0FBQUEsVUFDakIsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLFVBQ2hFLGtCQUFpQixtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDakU7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxRQUFJLFNBQVM7QUFFYixRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGtCQUFVLFFBQVEsT0FBTyxPQUFPLEVBQUUsUUFBUSxLQUFLLENBQUM7QUFDaEQsY0FBTSxRQUFRLE9BQU8sTUFBTSxJQUFJO0FBQy9CLGlCQUFTLE1BQU0sSUFBSSxLQUFLO0FBRXhCLG1CQUFXLFFBQVEsT0FBTztBQUN6QixjQUFJLEtBQUssS0FBSyxHQUFHO0FBQ2hCLGdCQUFJO0FBQ0gsb0JBQU0sU0FBUyxLQUFLLE1BQU0sSUFBSTtBQUM5QixvQkFBTSxRQUFPLG9DQUFPLGVBQVAsbUJBQW9CLE9BQXBCLG1CQUF3QixZQUF4QixtQkFBaUMsVUFBakMsbUJBQXlDLE9BQXpDLG1CQUE2QztBQUMxRCxrQkFBSSxNQUFNO0FBQ1Qsc0JBQU0sRUFBRSxTQUFTLE1BQU0sTUFBTSxNQUFNO0FBQUEsY0FDcEM7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXdDO0FBQzdDLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUdBLFFBQUksS0FBSyxjQUFjO0FBQ3RCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFFQSxRQUFJO0FBQ0gsWUFBTSxNQUFNLCtEQUErRCxLQUFLLE9BQU8sTUFBTTtBQUU3RixZQUFNLFdBQVcsTUFBTSxNQUFNLEtBQUs7QUFBQSxRQUNqQyxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixnQkFBZ0I7QUFBQSxRQUNqQjtBQUFBLE1BQ0QsQ0FBQztBQUVELFVBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsY0FBTSxJQUFJLE1BQU0sdUJBQXVCLFNBQVMsVUFBVSxFQUFFO0FBQUEsTUFDN0Q7QUFFQSxZQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFHakMsWUFBTSxtQkFBbUIsS0FBSyxPQUM1QixPQUFPLENBQUMsVUFBZTtBQUN2QixlQUFPLE1BQU0sOEJBQ1QsTUFBTSwyQkFBMkIsU0FBUyxpQkFBaUIsS0FDM0QsTUFBTSxLQUFLLFNBQVMsUUFBUTtBQUFBLE1BQ2pDLENBQUMsRUFDQSxJQUFJLENBQUMsVUFBZTtBQUVwQixlQUFPLE1BQU0sS0FBSyxNQUFNLEdBQUcsRUFBRSxJQUFJO0FBQUEsTUFDbEMsQ0FBQyxFQUNBLEtBQUs7QUFFUCxZQUFNLFNBQVMsaUJBQWlCLFNBQVMsSUFBSSxtQkFBbUI7QUFBQSxRQUMvRDtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0Q7QUFFQSxXQUFLLGVBQWU7QUFDcEIsYUFBTztBQUFBLElBQ1IsU0FBUyxPQUFPO0FBQ2YsWUFBTSxJQUFJLE1BQU0sa0NBQWtDLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUM3RztBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUF3QjtBQUN2QixTQUFLLGVBQWU7QUFBQSxFQUNyQjtBQUNEOzs7QUNsTk8sSUFBTSxpQkFBTixNQUEyQztBQUFBLEVBSWpELFlBQVksUUFBd0I7QUFIcEMsZ0JBQU87QUFJTixTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxhQUFhLFFBQXdCO0FBQ3BDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLE1BQU0sY0FBZ0M7QUFDckMsUUFBSSxDQUFDLEtBQUssT0FBTyxNQUFPLFFBQU87QUFFL0IsUUFBSTtBQUNILFlBQU0sVUFBVSxLQUFLLE9BQU8sV0FBVztBQUN2QyxZQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxhQUFhO0FBQUEsUUFDbkQsUUFBUTtBQUFBLFFBQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUMvQyxDQUFDO0FBQ0QsYUFBTyxTQUFTO0FBQUEsSUFDakIsU0FBUTtBQUNQLGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSxhQUFhQyxTQUFnQixTQUFnRDtBQUNsRixVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPO0FBQzVDLFFBQUksQ0FBQyxPQUFPO0FBQ1gsWUFBTSxJQUFJLE1BQU0sZ0NBQWdDO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxpQkFBaUI7QUFBQSxNQUN2RCxRQUFRO0FBQUEsTUFDUixTQUFTLEVBQUUsZ0JBQWdCLG1CQUFtQjtBQUFBLE1BQzlDLE1BQU0sS0FBSyxVQUFVO0FBQUEsUUFDcEI7QUFBQSxRQUNBLFFBQUFBO0FBQUEsUUFDQSxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsY0FBYSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0Q7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBQ2pDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQTFENUc7QUEyREUsVUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFVBQU0sU0FBUSxtQ0FBUyxVQUFTLEtBQUssT0FBTztBQUM1QyxRQUFJLENBQUMsT0FBTztBQUNYLFlBQU0sSUFBSSxNQUFNLGdDQUFnQztBQUFBLElBQ2pEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSxHQUFHLE9BQU8saUJBQWlCO0FBQUEsTUFDdkQsUUFBUTtBQUFBLE1BQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUM5QyxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxRQUFBQTtBQUFBLFFBQ0EsUUFBUTtBQUFBLFFBQ1IsU0FBUztBQUFBLFVBQ1IsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLFVBQ2hFLGNBQWEsbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQzdEO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sVUFBUyxjQUFTLFNBQVQsbUJBQWU7QUFDOUIsUUFBSSxDQUFDLFFBQVE7QUFDWixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sVUFBVSxJQUFJLFlBQVk7QUFFaEMsUUFBSTtBQUNILGFBQU8sTUFBTTtBQUNaLGNBQU0sRUFBRSxNQUFNLE1BQU0sSUFBSSxNQUFNLE9BQU8sS0FBSztBQUMxQyxZQUFJLEtBQU07QUFFVixjQUFNLFFBQVEsUUFBUSxPQUFPLEtBQUssRUFBRSxNQUFNLElBQUk7QUFDOUMsbUJBQVcsUUFBUSxPQUFPO0FBQ3pCLGNBQUksS0FBSyxLQUFLLEdBQUc7QUFDaEIsZ0JBQUk7QUFDSCxvQkFBTSxTQUFTLEtBQUssTUFBTSxJQUFJO0FBQzlCLGtCQUFJLE9BQU8sVUFBVTtBQUNwQixzQkFBTSxFQUFFLFNBQVMsT0FBTyxVQUFVLE1BQU0sTUFBTTtBQUFBLGNBQy9DO0FBQ0Esa0JBQUksT0FBTyxNQUFNO0FBQ2hCLHNCQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUNoQztBQUFBLGNBQ0Q7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPO0FBQzVDLFFBQUksQ0FBQyxPQUFPO0FBQ1gsWUFBTSxJQUFJLE1BQU0sZ0NBQWdDO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxhQUFhO0FBQUEsTUFDbkQsUUFBUTtBQUFBLE1BQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUM5QyxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxVQUFVLFNBQVMsSUFBSSxVQUFRO0FBQUEsVUFDOUIsTUFBTSxJQUFJO0FBQUEsVUFDVixTQUFTLElBQUk7QUFBQSxRQUNkLEVBQUU7QUFBQSxRQUNGLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxVQUNoRSxjQUFhLG1DQUFTLGNBQWEsS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUM3RDtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFFBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsWUFBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsSUFDM0Q7QUFFQSxVQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFDakMsV0FBTyxLQUFLLFFBQVE7QUFBQSxFQUNyQjtBQUFBLEVBRUEsTUFBTSxTQUFTLGNBQXNCLFlBQW9CLFNBQWdEO0FBQ3hHLFVBQU0sV0FBd0I7QUFBQSxNQUM3QixFQUFFLE1BQU0sVUFBVSxTQUFTLGFBQWE7QUFBQSxNQUN4QyxFQUFFLE1BQU0sUUFBUSxTQUFTLFdBQVc7QUFBQSxJQUNyQztBQUNBLFdBQU8sS0FBSyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQWhLckg7QUFpS0UsVUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFVBQU0sU0FBUSxtQ0FBUyxVQUFTLEtBQUssT0FBTztBQUM1QyxRQUFJLENBQUMsT0FBTztBQUNYLFlBQU0sSUFBSSxNQUFNLGdDQUFnQztBQUFBLElBQ2pEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSxHQUFHLE9BQU8sYUFBYTtBQUFBLE1BQ25ELFFBQVE7QUFBQSxNQUNSLFNBQVMsRUFBRSxnQkFBZ0IsbUJBQW1CO0FBQUEsTUFDOUMsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQjtBQUFBLFFBQ0EsVUFBVSxTQUFTLElBQUksVUFBUTtBQUFBLFVBQzlCLE1BQU0sSUFBSTtBQUFBLFVBQ1YsU0FBUyxJQUFJO0FBQUEsUUFDZCxFQUFFO0FBQUEsUUFDRixRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsY0FBYSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0Q7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUVoQyxRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGNBQU0sUUFBUSxRQUFRLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSTtBQUM5QyxtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLEtBQUssR0FBRztBQUNoQixnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsbUJBQUksWUFBTyxZQUFQLG1CQUFnQixTQUFTO0FBQzVCLHNCQUFNLEVBQUUsU0FBUyxPQUFPLFFBQVEsU0FBUyxNQUFNLE1BQU07QUFBQSxjQUN0RDtBQUNBLGtCQUFJLE9BQU8sTUFBTTtBQUNoQixzQkFBTSxFQUFFLFNBQVMsSUFBSSxNQUFNLEtBQUs7QUFDaEM7QUFBQSxjQUNEO0FBQUEsWUFDRCxTQUFTLEdBQUc7QUFBQSxZQUVaO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRCxVQUFFO0FBQ0QsYUFBTyxZQUFZO0FBQUEsSUFDcEI7QUFFQSxVQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUFBLEVBQ2pDO0FBQ0Q7OztBSnZOTyxJQUFNLG9CQUFOLE1BQXdCO0FBQUEsRUFLOUIsWUFBWSxVQUF3QixnQkFBaUM7QUFKckUsU0FBUSxZQUEyQyxvQkFBSSxJQUFJO0FBSzFELFNBQUssV0FBVztBQUNoQixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxNQUFNLGFBQWE7QUFDbEIsU0FBSyxVQUFVLElBQUksVUFBVSxJQUFJLGVBQWUsS0FBSyxTQUFTLFlBQVksTUFBTSxDQUFDO0FBQ2pGLFNBQUssVUFBVSxJQUFJLFVBQVUsSUFBSSxlQUFlLEtBQUssU0FBUyxZQUFZLE1BQU0sQ0FBQztBQUNqRixTQUFLLFVBQVUsSUFBSSxVQUFVLElBQUksZUFBZSxLQUFLLFNBQVMsWUFBWSxNQUFNLENBQUM7QUFDakYsU0FBSyxVQUFVLElBQUksVUFBVSxJQUFJLGVBQWUsS0FBSyxTQUFTLFlBQVksTUFBTSxDQUFDO0FBQUEsRUFDbEY7QUFBQSxFQUVBLGVBQWUsVUFBd0I7QUFDdEMsU0FBSyxXQUFXO0FBQ2hCLFNBQUssVUFBVSxRQUFRLENBQUMsVUFBVSxTQUFTO0FBNUI3QztBQTZCRyxVQUFJLFNBQVMsVUFBVSxRQUFRLEtBQUssU0FBUyxhQUFhO0FBQ3pELHVCQUFTLGlCQUFULGtDQUF3QixLQUFLLFNBQVMsWUFBWSxJQUFnQztBQUFBLE1BQ25GO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsdUJBQXVDO0FBQzlDLFVBQU0sV0FBVywwQkFBUyxXQUFXLFdBQVc7QUFDaEQsVUFBTSxtQkFBbUIsS0FBSyxTQUFTLGlCQUFpQixRQUFRO0FBQ2hFLFVBQU0sWUFBWSxDQUFDLGlCQUFpQixpQkFBaUIsR0FBRyxpQkFBaUIsaUJBQWlCO0FBRzFGLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFHQSxNQUFjLHVCQUFtRDtBQUNoRSxVQUFNLG1CQUFtQixLQUFLLHFCQUFxQjtBQUduRCxRQUFJLGlCQUFpQixDQUFDLE1BQU0sUUFBUTtBQUNuQyxhQUFPO0FBQUEsSUFDUjtBQUVBLGVBQVcsZ0JBQWdCLGtCQUFrQjtBQUM1QyxVQUFJLGlCQUFpQixPQUFRO0FBQzdCLFlBQU0sV0FBVyxLQUFLLFVBQVUsSUFBSSxZQUFZO0FBQ2hELFVBQUksWUFBWSxNQUFNLFNBQVMsWUFBWSxHQUFHO0FBQzdDLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sV0FBVyxNQUFNLEtBQUsscUJBQXFCO0FBQ2pELFFBQUksQ0FBQyxVQUFVO0FBQ2QsWUFBTSxJQUFJLE1BQU0saURBQWlEO0FBQUEsSUFDbEU7QUFDQSxXQUFPLFNBQVMsYUFBYUEsU0FBUSxPQUFPO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQUMxRyxVQUFNLFdBQVcsTUFBTSxLQUFLLHFCQUFxQjtBQUNqRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUFBLElBQ2xFO0FBQ0EsV0FBTyxTQUFTLG1CQUFtQkEsU0FBUSxPQUFPO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixVQUFNLFdBQVcsTUFBTSxLQUFLLHFCQUFxQjtBQUNqRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUFBLElBQ2xFO0FBQ0EsV0FBTyxTQUFTLGVBQWUsVUFBVSxPQUFPO0FBQUEsRUFDakQ7QUFBQSxFQUVBLE9BQU8scUJBQXFCLFVBQXVCLFNBQWlFO0FBQ25ILFVBQU0sV0FBVyxNQUFNLEtBQUsscUJBQXFCO0FBQ2pELFFBQUksQ0FBQyxVQUFVO0FBQ2QsWUFBTSxJQUFJLE1BQU0saURBQWlEO0FBQUEsSUFDbEU7QUFDQSxXQUFPLFNBQVMscUJBQXFCLFVBQVUsT0FBTztBQUFBLEVBQ3ZEO0FBQUEsRUFFQSxtQkFBNkI7QUFDNUIsV0FBTyxNQUFNLEtBQUssS0FBSyxVQUFVLE9BQU8sQ0FBQyxFQUFFLElBQUksT0FBSyxFQUFFLElBQUk7QUFBQSxFQUMzRDtBQUFBLEVBRUEsTUFBTSx5QkFBMEM7QUFDL0MsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsV0FBTyxXQUFXLFNBQVMsT0FBTztBQUFBLEVBQ25DO0FBQUEsRUFFQSxNQUFNLFNBQVMsY0FBc0IsWUFBb0IsU0FBZ0Q7QUFDeEcsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsUUFBSSxDQUFDLFVBQVU7QUFDZCxZQUFNLElBQUksTUFBTSxpREFBaUQ7QUFBQSxJQUNsRTtBQUNBLFdBQU8sU0FBUyxTQUFTLGNBQWMsWUFBWSxPQUFPO0FBQUEsRUFDM0Q7QUFBQSxFQUVBLHNCQUFzQztBQUVyQyxXQUFPLENBQUMsVUFBVSxVQUFVLFVBQVUsUUFBUTtBQUFBLEVBQy9DO0FBQUEsRUFFQSxrQkFBa0IsY0FBcUM7QUFFdEQsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLG9CQUFzRDtBQUVyRCxXQUFPLEVBQUUsT0FBTyxVQUFVLE9BQU8sU0FBUztBQUFBLEVBQzNDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUFrQixjQUErQztBQUN0RSxVQUFNLFdBQVcsS0FBSyxVQUFVLElBQUksWUFBWTtBQUNoRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLFlBQVksWUFBWSxZQUFZO0FBQUEsSUFDckQ7QUFHQSxRQUFJLHdCQUF3QixZQUFZLE9BQU8sU0FBUyx1QkFBdUIsWUFBWTtBQUMxRixhQUFPLE1BQU8sU0FBaUIsbUJBQW1CO0FBQUEsSUFDbkQ7QUFHQSxXQUFPLENBQUM7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx3QkFBd0IsY0FBa0M7QUFDekQsVUFBTSxXQUFXLEtBQUssVUFBVSxJQUFJLFlBQVk7QUFDaEQsUUFBSSxDQUFDLFVBQVU7QUFDZDtBQUFBLElBQ0Q7QUFHQSxRQUFJLHFCQUFxQixZQUFZLE9BQU8sU0FBUyxvQkFBb0IsWUFBWTtBQUNwRixNQUFDLFNBQWlCLGdCQUFnQjtBQUFBLElBQ25DO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBVTtBQUNULFNBQUssVUFBVSxNQUFNO0FBQUEsRUFDdEI7QUFDRDs7O0FLL0pBLElBQUFDLG1CQUF5RTs7O0FDUWxFLElBQU0sc0JBQU4sTUFBMEI7QUFBQSxFQU03QixZQUFvQixXQUFzQjtBQUF0QjtBQUxwQixTQUFRLGdCQUErQyxvQkFBSSxJQUFJO0FBQy9ELFNBQVEscUJBQXFCO0FBQzdCO0FBQUEsU0FBUSxhQUFhO0FBQ3JCLFNBQVEsa0JBQWlDO0FBR3JDLFNBQUssa0JBQWtCO0FBQ3ZCLFNBQUsscUJBQXFCO0FBQUEsRUFDOUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsb0JBQW1DO0FBQzdDLFFBQUk7QUFDQSxZQUFNLE9BQU8sTUFBTSxLQUFLLFVBQVUsU0FBUyxLQUFLLFVBQVU7QUFDMUQsVUFBSSxRQUFRLE1BQU0sUUFBUSxJQUFJLEdBQUc7QUFDN0IsbUJBQVcsZ0JBQWdCLE1BQU07QUFDN0IsZUFBSyxjQUFjLElBQUksYUFBYSxVQUFVLFlBQVk7QUFBQSxRQUM5RDtBQUFBLE1BQ0o7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUNaLGNBQVEsS0FBSyxxQ0FBcUMsS0FBSztBQUFBLElBQzNEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxvQkFBbUM7QUFDN0MsUUFBSTtBQUNBLFlBQU0scUJBQXFCLE1BQU0sS0FBSyxLQUFLLGNBQWMsT0FBTyxDQUFDO0FBQ2pFLFlBQU0sS0FBSyxVQUFVLFNBQVMsS0FBSyxZQUFZLGtCQUFrQjtBQUFBLElBQ3JFLFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSxxQ0FBcUMsS0FBSztBQUFBLElBQzVEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZ0JBQWdCLE1BQStCO0FBQzNDLFVBQU0sV0FBVyxLQUFLO0FBRXRCLFFBQUksQ0FBQyxLQUFLLGNBQWMsSUFBSSxRQUFRLEdBQUc7QUFFbkMsWUFBTSxrQkFBb0M7QUFBQSxRQUN0QztBQUFBLFFBQ0EsVUFBVSxDQUFDO0FBQUEsUUFDWCxhQUFhLEtBQUssSUFBSTtBQUFBLFFBQ3RCLFVBQVU7QUFBQSxVQUNOLFdBQVc7QUFBQSxVQUNYLGtCQUFrQjtBQUFBLFlBQ2QsS0FBSztBQUFBLFlBQ0wsTUFBTTtBQUFBLFlBQ04sUUFBUTtBQUFBLFlBQ1IsU0FBUztBQUFBLFlBQ1QsU0FBUztBQUFBLFlBQ1QsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUNBLFdBQUssY0FBYyxJQUFJLFVBQVUsZUFBZTtBQUFBLElBQ3BEO0FBRUEsV0FBTyxLQUFLLGNBQWMsSUFBSSxRQUFRO0FBQUEsRUFDMUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sZUFDRixNQUNBLFNBQ0EsU0FDNEI7QUFDNUIsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxNQUNwQjtBQUFBLElBQ0o7QUFFQSxpQkFBYSxTQUFTLEtBQUssT0FBTztBQUNsQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUdwQyxRQUFJLFdBQVcsYUFBYSxVQUFVO0FBQ2xDLG1CQUFhLFNBQVMsaUJBQWlCLFFBQVEsTUFBTTtBQUFBLElBQ3pEO0FBRUEsVUFBTSxLQUFLLFlBQVksWUFBWTtBQUNuQyxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxvQkFDRixNQUNBLFNBQ0EsUUFDNEI7QUFDNUIsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxNQUNwQjtBQUFBLElBQ0o7QUFFQSxpQkFBYSxTQUFTLEtBQUssT0FBTztBQUNsQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUdwQyxTQUFJLGlDQUFRLFlBQVcsYUFBYSxVQUFVO0FBQzFDLG1CQUFhLFNBQVM7QUFBQSxJQUMxQjtBQUVBLFVBQU0sS0FBSyxZQUFZLFlBQVk7QUFDbkMsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQWlCLE1BQWEsU0FBK0M7QUFDL0UsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxJQUN4QjtBQUVBLGlCQUFhLFNBQVMsS0FBSyxPQUFPO0FBQ2xDLGlCQUFhLGNBQWMsS0FBSyxJQUFJO0FBRXBDLFVBQU0sS0FBSyxZQUFZLFlBQVk7QUFDbkMsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixNQUFhLFFBQWdCLElBQTJCO0FBQ3RFLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFdBQU8sYUFBYSxTQUFTLE1BQU0sQ0FBQyxLQUFLO0FBQUEsRUFDN0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixNQUFhLE1BQTBEO0FBQ3JGLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFdBQU8sYUFBYSxTQUFTLE9BQU8sU0FBTyxJQUFJLFNBQVMsSUFBSTtBQUFBLEVBQ2hFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBdUIsTUFBYSxjQUFzQixHQUFXO0FBQ2pFLFVBQU0sV0FBVyxLQUFLLGtCQUFrQixNQUFNLFdBQVc7QUFFekQsUUFBSSxTQUFTLFdBQVcsR0FBRztBQUN2QixhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sZUFBZSxTQUFTLElBQUksU0FBTztBQUNyQyxZQUFNLFlBQVksSUFBSSxLQUFLLElBQUksU0FBUyxFQUFFLG1CQUFtQjtBQUM3RCxVQUFJLE9BQU8sSUFBSSxTQUFTLEtBQUssSUFBSSxLQUFLLFlBQVksQ0FBQyxLQUFLLElBQUksT0FBTztBQUVuRSxVQUFJLElBQUksU0FBUztBQUNiLGdCQUFRLGNBQWMsSUFBSSxRQUFRLE1BQU0sSUFBSSxJQUFJLFFBQVEsTUFBTTtBQUFBLE1BQ2xFO0FBRUEsVUFBSSxJQUFJLFFBQVE7QUFDWixnQkFBUSxhQUFhLElBQUksT0FBTyxVQUFVLFlBQVksUUFBUTtBQUFBLE1BQ2xFO0FBRUEsYUFBTztBQUFBLElBQ1gsQ0FBQztBQUVELFdBQU87QUFBQSxFQUEyQixhQUFhLEtBQUssSUFBSSxDQUFDO0FBQUE7QUFBQSxFQUM3RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFBa0IsTUFBNEI7QUFDaEQsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFDOUMsaUJBQWEsV0FBVyxDQUFDO0FBQ3pCLGlCQUFhLGNBQWMsS0FBSyxJQUFJO0FBRXBDLFFBQUksYUFBYSxVQUFVO0FBQ3ZCLG1CQUFhLFNBQVMsWUFBWTtBQUNsQyxtQkFBYSxTQUFTLG1CQUFtQjtBQUFBLFFBQ3JDLEtBQUs7QUFBQSxRQUNMLE1BQU07QUFBQSxRQUNOLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUVBLFVBQU0sS0FBSyxrQkFBa0I7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsU0FBUyxNQUtQO0FBN09OO0FBOE9RLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBRTlDLFFBQUksa0JBQXFDO0FBQ3pDLFFBQUksV0FBVztBQUVmLFFBQUksYUFBYSxVQUFVO0FBQ3ZCLGlCQUFXLENBQUMsUUFBUSxLQUFLLEtBQUssT0FBTyxRQUFRLGFBQWEsU0FBUyxnQkFBZ0IsR0FBRztBQUNsRixZQUFJLFFBQVEsVUFBVTtBQUNsQixxQkFBVztBQUNYLDRCQUFrQjtBQUFBLFFBQ3RCO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxVQUFNLGtCQUFrQixhQUFhLFNBQVMsU0FBUyxJQUNqRCxLQUFLLElBQUksSUFBSSxhQUFhLFNBQVMsQ0FBQyxFQUFFLFlBQ3RDO0FBRU4sV0FBTztBQUFBLE1BQ0gsY0FBYyxhQUFhLFNBQVM7QUFBQSxNQUNwQyxhQUFXLGtCQUFhLGFBQWIsbUJBQXVCLGNBQWE7QUFBQSxNQUMvQztBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsbUJBQW1CLE1BQXFCO0FBQ3BDLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFVBQU0sUUFBUSxDQUFDLDhCQUE4QixLQUFLLElBQUksSUFBSSxFQUFFO0FBRTVELGVBQVcsV0FBVyxhQUFhLFVBQVU7QUFDekMsWUFBTSxZQUFZLElBQUksS0FBSyxRQUFRLFNBQVMsRUFBRSxlQUFlO0FBQzdELFlBQU0sS0FBSyxNQUFNLFFBQVEsS0FBSyxZQUFZLENBQUMsS0FBSyxTQUFTLEdBQUc7QUFDNUQsWUFBTSxLQUFLLFFBQVEsT0FBTztBQUUxQixVQUFJLFFBQVEsU0FBUztBQUNqQixjQUFNLEtBQUssYUFBYSxRQUFRLFFBQVEsTUFBTSxJQUFJLFFBQVEsUUFBUSxNQUFNLEdBQUc7QUFBQSxNQUMvRTtBQUVBLFVBQUksUUFBUSxRQUFRO0FBQ2hCLGNBQU0sS0FBSyxZQUFZLFFBQVEsT0FBTyxVQUFVLFlBQVksUUFBUSxHQUFHO0FBQ3ZFLFlBQUksUUFBUSxPQUFPLE9BQU87QUFDdEIsZ0JBQU0sS0FBSyxXQUFXLFFBQVEsT0FBTyxLQUFLLEdBQUc7QUFBQSxRQUNqRDtBQUFBLE1BQ0o7QUFFQSxZQUFNLEtBQUssRUFBRTtBQUFBLElBQ2pCO0FBRUEsV0FBTyxNQUFNLEtBQUssSUFBSTtBQUFBLEVBQzFCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxvQkFBNEI7QUFDaEMsV0FBTyxPQUFPLEtBQUssSUFBSSxDQUFDLElBQUksS0FBSyxPQUFPLEVBQUUsU0FBUyxFQUFFLEVBQUUsT0FBTyxHQUFHLENBQUMsQ0FBQztBQUFBLEVBQ3ZFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLFlBQVksY0FBK0M7QUFDckUsUUFBSSxhQUFhLFNBQVMsU0FBUyxLQUFLLG9CQUFvQjtBQUV4RCxtQkFBYSxXQUFXLGFBQWEsU0FBUyxNQUFNLENBQUMsS0FBSyxrQkFBa0I7QUFBQSxJQUNoRjtBQUVBLFVBQU0sS0FBSyxrQkFBa0I7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsMEJBQW9DO0FBQ2hDLFdBQU8sTUFBTSxLQUFLLEtBQUssY0FBYyxLQUFLLENBQUM7QUFBQSxFQUMvQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZ0JBQWdCLE1BQXNCO0FBQ2xDLFVBQU0sZUFBZSxLQUFLLGNBQWMsSUFBSSxLQUFLLElBQUk7QUFDckQsV0FBTyxlQUFlLGFBQWEsU0FBUyxTQUFTLElBQUk7QUFBQSxFQUM3RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxlQUFlLFNBQWlCLFNBQWdDO0FBQ2xFLFVBQU0sZUFBZSxLQUFLLGNBQWMsSUFBSSxPQUFPO0FBQ25ELFFBQUksY0FBYztBQUNkLG1CQUFhLFdBQVc7QUFDeEIsV0FBSyxjQUFjLE9BQU8sT0FBTztBQUNqQyxXQUFLLGNBQWMsSUFBSSxTQUFTLFlBQVk7QUFDNUMsWUFBTSxLQUFLLGtCQUFrQjtBQUFBLElBQ2pDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQTZCO0FBRWpDLFNBQUssa0JBQWtCLE9BQU8sWUFBWSxNQUFNO0FBQzVDLFdBQUssd0JBQXdCLElBQUksS0FBSyxLQUFLLEtBQUssR0FBSTtBQUFBLElBQ3hELEdBQUcsS0FBSyxLQUFLLEtBQUssR0FBSTtBQUFBLEVBQzFCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHdCQUF3QixRQUErQjtBQUNqRSxVQUFNLE1BQU0sS0FBSyxJQUFJO0FBQ3JCLFFBQUksVUFBVTtBQUVkLGVBQVcsQ0FBQyxVQUFVLFlBQVksS0FBSyxLQUFLLGNBQWMsUUFBUSxHQUFHO0FBRWpFLFVBQUksYUFBYSxTQUFTLFNBQVMsR0FBRztBQUNsQyxjQUFNLGNBQWMsYUFBYSxTQUFTLGFBQWEsU0FBUyxTQUFTLENBQUM7QUFDMUUsY0FBTSxNQUFNLE1BQU0sWUFBWTtBQUU5QixZQUFJLE1BQU0sUUFBUTtBQUNkLGVBQUssY0FBYyxPQUFPLFFBQVE7QUFDbEMsb0JBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxRQUFJLFNBQVM7QUFDVCxZQUFNLEtBQUssa0JBQWtCO0FBQUEsSUFDakM7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxVQUFnQjtBQUNaLFFBQUksS0FBSyxvQkFBb0IsTUFBTTtBQUMvQixvQkFBYyxLQUFLLGVBQWU7QUFDbEMsV0FBSyxrQkFBa0I7QUFBQSxJQUMzQjtBQUFBLEVBQ0o7QUFDSjs7O0FEeFhPLElBQU0saUJBQU4sTUFBcUI7QUFBQSxFQUd4QixZQUFvQixLQUFVLFdBQXVCO0FBQWpDO0FBRnBCLFNBQVEsc0JBQWtEO0FBR3RELFFBQUksV0FBVztBQUNYLFdBQUssc0JBQXNCLElBQUksb0JBQW9CLFNBQVM7QUFBQSxJQUNoRTtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHVCQUF1QixxQkFBZ0Q7QUFDbkUsU0FBSyxzQkFBc0I7QUFBQSxFQUMvQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWlDO0FBRTdCLFVBQU0sZUFBZSxLQUFLLElBQUksVUFBVTtBQUN4QyxRQUFJLDZDQUFjLFFBQVE7QUFDdEIsYUFBTyxhQUFhO0FBQUEsSUFDeEI7QUFHQSxRQUFJLE9BQU8sS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBRzlELFFBQUksQ0FBQyxNQUFNO0FBQ1AsWUFBTSxTQUFTLEtBQUssSUFBSSxVQUFVLGdCQUFnQixVQUFVO0FBQzVELGlCQUFXLFFBQVEsUUFBUTtBQUN2QixjQUFNLFdBQVcsS0FBSztBQUN0QixZQUFJLG9CQUFvQiwrQkFBYztBQUNsQyxpQkFBTztBQUNQO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBRUEsUUFBSSxDQUFDLE1BQU07QUFDUCxhQUFPO0FBQUEsSUFDWDtBQUdBLFVBQU0sU0FBUyxLQUFLO0FBRXBCLFdBQU8sVUFBVTtBQUFBLEVBQ3JCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBOEI7QUFDMUIsV0FBTyxLQUFLLElBQUksVUFBVSxjQUFjO0FBQUEsRUFDNUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUEwQjtBQUN0QixVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsUUFBSSxDQUFDLE9BQVEsUUFBTztBQUVwQixXQUFPLE9BQU8sYUFBYTtBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxvQkFBMkM7QUFDdkMsVUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBQ3BDLFFBQUksQ0FBQyxPQUFRLFFBQU87QUFFcEIsV0FBTyxPQUFPLFVBQVU7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxxQkFBc0Q7QUFDeEQsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFFcEMsUUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRO0FBQ2xCLGFBQU87QUFBQSxJQUNYO0FBRUEsVUFBTSxVQUFVLE9BQU8sU0FBUztBQUNoQyxVQUFNLGVBQWUsS0FBSyxnQkFBZ0I7QUFDMUMsVUFBTSxpQkFBaUIsS0FBSyxrQkFBa0I7QUFHOUMsVUFBTSxXQUFXLEtBQUssZ0JBQWdCLE9BQU87QUFHN0MsVUFBTSxtQkFBbUIsaUJBQ3JCLEtBQUssb0JBQW9CLFNBQVMsZUFBZSxJQUFJLElBQ3JEO0FBRUosV0FBTztBQUFBLE1BQ0g7QUFBQSxNQUNBLFVBQVUsS0FBSztBQUFBLE1BQ2Y7QUFBQSxNQUNBO0FBQUEsTUFDQSxjQUFjLGdCQUFnQjtBQUFBLE1BQzlCLGdCQUFnQixrQkFBa0I7QUFBQSxNQUNsQztBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsU0FBZ0M7QUFDcEQsVUFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBQ2hDLFVBQU0sV0FBMEIsQ0FBQztBQUNqQyxRQUFJLFlBQVk7QUFFaEIsVUFBTSxRQUFRLENBQUMsTUFBTSxVQUFVO0FBQzNCLFlBQU0sZUFBZSxLQUFLLE1BQU0sbUJBQW1CO0FBQ25ELFVBQUksY0FBYztBQUNkLGNBQU0sUUFBUSxhQUFhLENBQUMsRUFBRTtBQUM5QixjQUFNLE9BQU8sYUFBYSxDQUFDO0FBRTNCLGlCQUFTLEtBQUs7QUFBQSxVQUNWO0FBQUEsVUFDQTtBQUFBLFVBQ0EsTUFBTTtBQUFBLFVBQ04sVUFBVTtBQUFBLFlBQ04sT0FBTztBQUFBLFlBQ1AsS0FBSyxZQUFZLEtBQUs7QUFBQSxVQUMxQjtBQUFBLFFBQ0osQ0FBQztBQUFBLE1BQ0w7QUFHQSxtQkFBYSxLQUFLLFNBQVM7QUFBQSxJQUMvQixDQUFDO0FBRUQsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUNKLFNBQ0EsYUFDQSxjQUFzQixHQUNlO0FBQ3JDLFVBQU0sUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUVoQyxVQUFNLFlBQVksS0FBSyxJQUFJLEdBQUcsY0FBYyxXQUFXO0FBQ3ZELFVBQU0sVUFBVSxLQUFLLElBQUksTUFBTSxTQUFTLEdBQUcsY0FBYyxXQUFXO0FBRXBFLFdBQU87QUFBQSxNQUNILFFBQVEsTUFBTSxNQUFNLFdBQVcsV0FBVztBQUFBLE1BQzFDLE9BQU8sTUFBTSxNQUFNLGNBQWMsR0FBRyxVQUFVLENBQUM7QUFBQSxJQUNuRDtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sVUFDRixTQUNBLFVBQ0EsVUFBdUIsQ0FBQyxHQUNMO0FBQ25CLFVBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUNwQyxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBRWhDLFFBQUksQ0FBQyxVQUFVLENBQUMsTUFBTTtBQUNsQixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPO0FBQUEsUUFDUCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFFQSxRQUFJO0FBQ0EsVUFBSTtBQUVKLFVBQUksYUFBYSxVQUFVO0FBRXZCLG9CQUFZLE9BQU8sVUFBVTtBQUM3QixlQUFPLGFBQWEsU0FBUyxTQUFTO0FBQUEsTUFDMUMsV0FBVyxhQUFhLGFBQWE7QUFFakMsY0FBTSxZQUFZLE9BQU8sYUFBYTtBQUN0QyxZQUFJLENBQUMsV0FBVztBQUNaLGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFDQSxvQkFBWSxPQUFPLFVBQVUsTUFBTTtBQUNuQyxlQUFPLGlCQUFpQixPQUFPO0FBQUEsTUFDbkMsV0FBVyxhQUFhLE9BQU87QUFFM0IsY0FBTSxXQUFXLE9BQU8sU0FBUztBQUNqQyxjQUFNLGlCQUFpQixPQUFPLFFBQVEsUUFBUSxFQUFFO0FBQ2hELG9CQUFZLEVBQUUsTUFBTSxVQUFVLElBQUksZUFBZTtBQUVqRCxjQUFNLGlCQUFpQixPQUFPLFNBQVM7QUFDdkMsY0FBTSxhQUFhLGtCQUFrQixlQUFlLFNBQVMsSUFBSSxJQUFJLEtBQUssUUFBUTtBQUdsRixjQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sTUFBTSxVQUFVO0FBQUEsTUFDaEQsT0FBTztBQUVILG9CQUFZO0FBQ1osZUFBTyxhQUFhLFNBQVMsU0FBUztBQUFBLE1BQzFDO0FBR0EsVUFBSSxRQUFRLGVBQWU7QUFDdkIsY0FBTSxTQUFTO0FBQUEsVUFDWCxNQUFNLFVBQVUsT0FBTyxRQUFRLE1BQU0sSUFBSSxFQUFFLFNBQVM7QUFBQSxVQUNwRCxJQUFJLFFBQVEsU0FBUyxJQUFJLElBQ3JCLFFBQVEsTUFBTSxJQUFJLEVBQUUsSUFBSSxFQUFHLFNBQzNCLFVBQVUsS0FBSyxRQUFRO0FBQUEsUUFDL0I7QUFDQSxlQUFPLGFBQWEsV0FBVyxNQUFNO0FBQUEsTUFDekM7QUFFQSxVQUFJLFFBQVEsY0FBYztBQUN0QixlQUFPLGVBQWU7QUFBQSxVQUNsQixNQUFNO0FBQUEsVUFDTixJQUFJO0FBQUEsUUFDUixHQUFHLElBQUk7QUFBQSxNQUNYO0FBRUEsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1Q7QUFBQSxRQUNBLFVBQVUsYUFBYSxjQUFjLFlBQzVCLGFBQWEsUUFBUSxXQUFXO0FBQUEsUUFDekM7QUFBQSxNQUNKO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sY0FDRixRQUNBLFVBQ21CO0FBQ25CLFVBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUNwQyxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBRWhDLFFBQUksQ0FBQyxVQUFVLENBQUMsTUFBTTtBQUNsQixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPO0FBQUEsUUFDUCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFFQSxRQUFJO0FBQ0EsVUFBSSxXQUFXLGFBQWE7QUFDeEIsY0FBTSxZQUFZLE9BQU8sYUFBYTtBQUN0QyxZQUFJLENBQUMsV0FBVztBQUNaLGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFDQSxlQUFPLGlCQUFpQixFQUFFO0FBQzFCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSixXQUFXLFdBQVcsUUFBUTtBQUMxQixjQUFNLFNBQVMsT0FBTyxVQUFVO0FBQ2hDLGNBQU0sT0FBTyxPQUFPO0FBQ3BCLGVBQU87QUFBQSxVQUFhO0FBQUEsVUFDaEIsRUFBRSxNQUFNLElBQUksRUFBRTtBQUFBLFVBQ2QsRUFBRSxNQUFNLE9BQU8sR0FBRyxJQUFJLEVBQUU7QUFBQSxRQUM1QjtBQUNBLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULFVBQVU7QUFBQSxVQUNWLFdBQVcsRUFBRSxNQUFNLElBQUksRUFBRTtBQUFBLFFBQzdCO0FBQUEsTUFDSixXQUFXLFdBQVcsYUFBYSxVQUFVO0FBQ3pDLGNBQU0sVUFBVSxNQUFNLEtBQUssWUFBWSxRQUFRO0FBQy9DLFlBQUksQ0FBQyxTQUFTO0FBQ1YsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU8sWUFBWSxRQUFRO0FBQUEsWUFDM0IsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBR0EsY0FBTSxVQUFVLE9BQU8sU0FBUztBQUNoQyxjQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFDaEMsY0FBTSxXQUFXLE1BQU07QUFBQSxVQUFPLENBQUMsR0FBRyxVQUM5QixRQUFRLFFBQVEsTUFBTSxTQUFTLFFBQVEsUUFBUSxNQUFNO0FBQUEsUUFDekQ7QUFFQSxjQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUssSUFBSSxDQUFDO0FBRXJELGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULFVBQVU7QUFBQSxVQUNWLFdBQVcsRUFBRSxNQUFNLFFBQVEsTUFBTSxPQUFPLElBQUksRUFBRTtBQUFBLFFBQ2xEO0FBQUEsTUFDSjtBQUVBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU87QUFBQSxRQUNQLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sWUFBWSxhQUFzRDtBQUNwRSxVQUFNLFVBQVUsTUFBTSxLQUFLLG1CQUFtQjtBQUM5QyxRQUFJLENBQUMsUUFBUyxRQUFPO0FBRXJCLFVBQU0sZUFBZSxRQUFRLFNBQVM7QUFBQSxNQUFVLE9BQzVDLEVBQUUsS0FBSyxZQUFZLEVBQUUsU0FBUyxZQUFZLFlBQVksQ0FBQztBQUFBLElBQzNEO0FBRUEsUUFBSSxpQkFBaUIsR0FBSSxRQUFPO0FBRWhDLFVBQU0sVUFBVSxRQUFRLFNBQVMsWUFBWTtBQUM3QyxVQUFNLGNBQWMsUUFBUSxTQUFTLGVBQWUsQ0FBQztBQUVyRCxVQUFNLFFBQVEsUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUN4QyxVQUFNLFVBQVUsY0FBYyxZQUFZLE9BQU8sSUFBSSxNQUFNLFNBQVM7QUFHcEUsVUFBTSxlQUFlLE1BQU0sTUFBTSxRQUFRLE9BQU8sR0FBRyxVQUFVLENBQUM7QUFDOUQsVUFBTSxpQkFBaUIsYUFBYSxLQUFLLElBQUksRUFBRSxLQUFLO0FBRXBELFdBQU87QUFBQSxNQUNILFNBQVMsUUFBUTtBQUFBLE1BQ2pCLE9BQU8sUUFBUTtBQUFBLE1BQ2YsU0FBUztBQUFBLE1BQ1QsT0FBTztBQUFBLFFBQ0gsT0FBTyxRQUFRO0FBQUEsUUFDZixLQUFLO0FBQUEsTUFDVDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHFCQUE2QztBQUMvQyxVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsUUFBSSxDQUFDLE9BQVEsUUFBTztBQUVwQixXQUFPLE9BQU8sU0FBUztBQUFBLEVBQzNCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLG1CQUFtQixTQUFzQztBQUMzRCxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBRWhDLFFBQUksQ0FBQyxNQUFNO0FBQ1AsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTztBQUFBLFFBQ1AsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBRUEsUUFBSTtBQUNBLFlBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxNQUFNLE9BQU87QUFFekMsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1Q7QUFBQSxRQUNBLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT0EsTUFBTSxlQUFlLFNBQWlCLFNBQXNDO0FBQ3hFLFFBQUksQ0FBQyxLQUFLLG9CQUFxQjtBQUUvQixVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksTUFBTTtBQUNOLFlBQU0sS0FBSyxvQkFBb0IsZUFBZSxNQUFNLFNBQVMsT0FBTztBQUFBLElBQ3hFO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxvQkFBb0IsU0FBaUIsUUFBb0M7QUFDM0UsUUFBSSxDQUFDLEtBQUssb0JBQXFCO0FBRS9CLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxNQUFNO0FBQ04sWUFBTSxLQUFLLG9CQUFvQixvQkFBb0IsTUFBTSxTQUFTLE1BQU07QUFBQSxJQUM1RTtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQWlCLFNBQWdDO0FBQ25ELFFBQUksQ0FBQyxLQUFLLG9CQUFxQjtBQUUvQixVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksTUFBTTtBQUNOLFlBQU0sS0FBSyxvQkFBb0IsaUJBQWlCLE1BQU0sT0FBTztBQUFBLElBQ2pFO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQXVCLGNBQXNCLEdBQVc7QUFDcEQsUUFBSSxDQUFDLEtBQUssb0JBQXFCLFFBQU87QUFFdEMsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLENBQUMsS0FBTSxRQUFPO0FBRWxCLFdBQU8sS0FBSyxvQkFBb0IsdUJBQXVCLE1BQU0sV0FBVztBQUFBLEVBQzVFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLG9CQUFtQztBQUNyQyxRQUFJLENBQUMsS0FBSyxvQkFBcUI7QUFFL0IsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLE1BQU07QUFDTixZQUFNLEtBQUssb0JBQW9CLGtCQUFrQixJQUFJO0FBQUEsSUFDekQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFLUztBQUNMLFFBQUksQ0FBQyxLQUFLLG9CQUFxQixRQUFPO0FBRXRDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxDQUFDLEtBQU0sUUFBTztBQUVsQixXQUFPLEtBQUssb0JBQW9CLFNBQVMsSUFBSTtBQUFBLEVBQ2pEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBMkI7QUFDdkIsUUFBSSxDQUFDLEtBQUssb0JBQXFCLFFBQU87QUFFdEMsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLENBQUMsS0FBTSxRQUFPO0FBRWxCLFdBQU8sS0FBSyxvQkFBb0IsZ0JBQWdCLElBQUk7QUFBQSxFQUN4RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EscUJBQW9DO0FBQ2hDLFFBQUksQ0FBQyxLQUFLLG9CQUFxQixRQUFPO0FBRXRDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxDQUFDLEtBQU0sUUFBTztBQUVsQixXQUFPLEtBQUssb0JBQW9CLG1CQUFtQixJQUFJO0FBQUEsRUFDM0Q7QUFDSjs7O0FFL2VPLElBQU0saUJBQU4sTUFBcUI7QUFBQSxFQUFyQjtBQUNILFNBQVEsZ0JBQThCO0FBQUEsTUFDbEMsaUJBQWlCO0FBQUEsTUFDakIsa0JBQWtCO0FBQUEsTUFDbEIsZ0JBQWdCO0FBQUEsTUFDaEIsYUFBYTtBQUFBLE1BQ2IsV0FBVztBQUFBLElBQ2Y7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsWUFDSSxTQUNBLGlCQUNBLFVBQWlDLENBQUMsR0FDbEMscUJBQ2U7QUFDZixVQUFNLFNBQVMsRUFBRSxHQUFHLEtBQUssZUFBZSxHQUFHLFFBQVE7QUFFbkQsVUFBTSxlQUFlLEtBQUssa0JBQWtCLFFBQVEsUUFBUSxNQUFNO0FBQ2xFLFVBQU0sY0FBYyxLQUFLLGlCQUFpQixpQkFBaUIsU0FBUyxRQUFRLG1CQUFtQjtBQUMvRixVQUFNLGFBQWEsS0FBSyxnQkFBZ0IsU0FBUyxXQUFXO0FBRTVELFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0EsU0FBUztBQUFBLE1BQ1QsUUFBUTtBQUFBLFFBQ0osYUFBYSxPQUFPLGVBQWU7QUFBQSxRQUNuQyxXQUFXLE9BQU8sYUFBYTtBQUFBLE1BQ25DO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixRQUErQixRQUE4QjtBQUNuRixVQUFNLGFBQWE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVNuQixVQUFNLHdCQUF3QjtBQUFBLE1BQzFCLEtBQUs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFPTCxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BT04sUUFBUTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU9SLFNBQVM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQVFULFNBQVM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQVFULFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQU9kO0FBRUEsV0FBTyxhQUFhLHNCQUFzQixNQUFNO0FBQUEsRUFDcEQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixTQUFzQixhQUE2QjtBQUN2RSxRQUFJQyxVQUFTLEdBQUcsV0FBVztBQUFBO0FBQUEsZ0JBQXFCLFFBQVEsV0FBVztBQUduRSxRQUFJLFFBQVEsV0FBVyxRQUFRLFFBQVEsS0FBSyxHQUFHO0FBQzNDLE1BQUFBLFdBQVU7QUFBQTtBQUFBLDJCQUFnQyxRQUFRLE9BQU87QUFBQSxJQUM3RDtBQUdBLFVBQU0scUJBQXFCLEtBQUssc0JBQXNCLE9BQU87QUFDN0QsUUFBSSxvQkFBb0I7QUFDcEIsTUFBQUEsV0FBVTtBQUFBO0FBQUEsRUFBTyxrQkFBa0I7QUFBQSxJQUN2QztBQUdBLFVBQU0scUJBQXFCLEtBQUssc0JBQXNCLE9BQU87QUFDN0QsUUFBSSxvQkFBb0I7QUFDcEIsTUFBQUEsV0FBVTtBQUFBO0FBQUEsRUFBTyxrQkFBa0I7QUFBQSxJQUN2QztBQUVBLFdBQU9BO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esc0JBQXNCLFNBQThCO0FBQ3hELFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxZQUFJLFFBQVEsVUFBVTtBQUNsQixpQkFBTyx5QkFBeUIsUUFBUSxRQUFRLGNBQWMsUUFBUSxXQUFXLFFBQVEsaUNBQWlDLDJCQUEyQjtBQUFBLFFBQ3pKO0FBQ0EsZUFBTztBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVg7QUFDSSxlQUFPO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHNCQUFzQixTQUE4QjtBQUN4RCxZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYO0FBQ0ksZUFBTztBQUFBLElBQ2Y7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxpQkFDSixpQkFDQSxTQUNBLFFBQ0EscUJBQ007QUFDTixRQUFJLFVBQVUsYUFBYSxnQkFBZ0IsUUFBUTtBQUFBO0FBR25ELFFBQUksT0FBTyxrQkFBa0IsdUJBQXVCLG9CQUFvQixLQUFLLEdBQUc7QUFDNUUsaUJBQVc7QUFBQSxFQUFLLG1CQUFtQjtBQUFBO0FBQUEsSUFDdkM7QUFHQSxRQUFJLE9BQU8sb0JBQW9CLGdCQUFnQixTQUFTLFNBQVMsR0FBRztBQUNoRSxpQkFBVztBQUNYLHNCQUFnQixTQUFTLFFBQVEsYUFBVztBQUN4QyxjQUFNLFNBQVMsS0FBSyxPQUFPLFFBQVEsUUFBUSxDQUFDO0FBQzVDLG1CQUFXLEdBQUcsTUFBTSxLQUFLLFFBQVEsSUFBSTtBQUFBO0FBQUEsTUFDekMsQ0FBQztBQUFBLElBQ0w7QUFHQSxRQUFJLGdCQUFnQixnQkFBZ0IsUUFBUSxXQUFXLGFBQWE7QUFDaEUsaUJBQVc7QUFBQTtBQUFBLEVBQXFCLGdCQUFnQixZQUFZO0FBQUE7QUFBQSxJQUNoRTtBQUdBLFFBQUksUUFBUSxXQUFXLGFBQWEsUUFBUSxVQUFVO0FBQ2xELFlBQU0sVUFBVSxLQUFLLHFCQUFxQixnQkFBZ0IsU0FBUyxRQUFRLFFBQVE7QUFDbkYsVUFBSSxTQUFTO0FBQ1QsbUJBQVc7QUFBQSxtQkFBc0IsUUFBUSxRQUFRO0FBQUEsRUFBTyxPQUFPO0FBQUE7QUFBQSxNQUNuRTtBQUFBLElBQ0osV0FBVyxRQUFRLFdBQVcsZUFBZSxnQkFBZ0Isa0JBQWtCO0FBQzNFLGlCQUFXO0FBQ1gsVUFBSSxnQkFBZ0IsaUJBQWlCLE9BQU8sU0FBUyxHQUFHO0FBQ3BELG1CQUFXLFdBQVcsZ0JBQWdCLGlCQUFpQixPQUFPLEtBQUssR0FBRyxDQUFDO0FBQUE7QUFBQSxNQUMzRTtBQUNBLFVBQUksZ0JBQWdCLGlCQUFpQixNQUFNLFNBQVMsR0FBRztBQUNuRCxtQkFBVyxVQUFVLGdCQUFnQixpQkFBaUIsTUFBTSxLQUFLLEdBQUcsQ0FBQztBQUFBO0FBQUEsTUFDekU7QUFBQSxJQUNKO0FBR0EsVUFBTSxlQUFlLGdCQUFnQixRQUFRLE1BQU0sSUFBSTtBQUN2RCxRQUFJLGFBQWEsU0FBUyxPQUFPLGlCQUFpQjtBQUM5QyxZQUFNLFFBQVEsS0FBSyxJQUFJLEdBQUcsYUFBYSxTQUFTLE9BQU8sZUFBZTtBQUN0RSxpQkFBVztBQUFBLHVCQUEwQixPQUFPLGVBQWU7QUFBQTtBQUMzRCxpQkFBVyxhQUFhLE1BQU0sS0FBSyxFQUFFLEtBQUssSUFBSTtBQUFBLElBQ2xELE9BQU87QUFDSCxpQkFBVztBQUFBO0FBQUEsRUFBcUIsZ0JBQWdCLE9BQU87QUFBQSxJQUMzRDtBQUVBLFdBQU87QUFBQSxFQUNYO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxxQkFBcUIsU0FBaUIsYUFBb0M7QUFDOUUsVUFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBQ2hDLFVBQU0sd0JBQXdCLFlBQVksWUFBWSxFQUFFLEtBQUs7QUFFN0QsUUFBSSxlQUFlO0FBQ25CLFFBQUksZUFBZTtBQUduQixhQUFTLElBQUksR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ25DLFlBQU0sT0FBTyxNQUFNLENBQUM7QUFDcEIsWUFBTSxlQUFlLEtBQUssTUFBTSxtQkFBbUI7QUFFbkQsVUFBSSxjQUFjO0FBQ2QsY0FBTSxRQUFRLGFBQWEsQ0FBQyxFQUFFO0FBQzlCLGNBQU0sVUFBVSxhQUFhLENBQUMsRUFBRSxZQUFZLEVBQUUsS0FBSztBQUVuRCxZQUFJLFlBQVkseUJBQXlCLFFBQVEsU0FBUyxxQkFBcUIsR0FBRztBQUM5RSx5QkFBZTtBQUNmLHlCQUFlO0FBQ2Y7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxRQUFJLGlCQUFpQixHQUFJLFFBQU87QUFHaEMsUUFBSSxhQUFhLE1BQU07QUFDdkIsYUFBUyxJQUFJLGVBQWUsR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ2xELFlBQU0sT0FBTyxNQUFNLENBQUM7QUFDcEIsWUFBTSxlQUFlLEtBQUssTUFBTSxjQUFjO0FBRTlDLFVBQUksZ0JBQWdCLGFBQWEsQ0FBQyxFQUFFLFVBQVUsY0FBYztBQUN4RCxxQkFBYTtBQUNiO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxXQUFPLE1BQU0sTUFBTSxjQUFjLFVBQVUsRUFBRSxLQUFLLElBQUk7QUFBQSxFQUMxRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWtCLGFBQXFCLFNBQW1DO0FBQ3RFLFVBQU0sZUFBZTtBQUVyQixRQUFJLGFBQWE7QUFDakIsUUFBSSxTQUFTO0FBQ1QsbUJBQWEsWUFBWSxPQUFPO0FBQUE7QUFBQSxXQUFnQixXQUFXO0FBQUEsSUFDL0Q7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0E7QUFBQSxNQUNBLFNBQVMsV0FBVztBQUFBLE1BQ3BCLFFBQVE7QUFBQSxRQUNKLGFBQWE7QUFBQSxRQUNiLFdBQVc7QUFBQSxNQUNmO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHdCQUNJLFNBQ0EsaUJBQ0EsZ0JBQXVDLENBQUMsR0FDekI7QUFDZixRQUFJLGVBQWU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFRbkIsUUFBSSxhQUFhO0FBQ2pCLFFBQUksVUFBVTtBQUdkLFFBQUksaUJBQWlCO0FBQ2pCLGlCQUFXLHFCQUFxQixnQkFBZ0IsUUFBUTtBQUFBO0FBRXhELFVBQUksZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQ3JDLG1CQUFXO0FBQ1gsd0JBQWdCLFNBQVMsUUFBUSxhQUFXO0FBQ3hDLGdCQUFNLFNBQVMsS0FBSyxPQUFPLFFBQVEsUUFBUSxDQUFDO0FBQzVDLHFCQUFXLEdBQUcsTUFBTSxLQUFLLFFBQVEsSUFBSTtBQUFBO0FBQUEsUUFDekMsQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBR0EsUUFBSSxjQUFjLFNBQVMsR0FBRztBQUMxQixpQkFBVztBQUNYLG9CQUFjLE1BQU0sRUFBRSxFQUFFLFFBQVEsU0FBTztBQUNuQyxZQUFJLElBQUksU0FBUyxRQUFRO0FBQ3JCLHFCQUFXLFFBQVEsSUFBSSxPQUFPO0FBQUE7QUFBQSxRQUNsQyxXQUFXLElBQUksU0FBUyxhQUFhO0FBQ2pDLHFCQUFXLFNBQVMsSUFBSSxPQUFPO0FBQUE7QUFBQSxRQUNuQztBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0w7QUFFQSxRQUFJLFNBQVM7QUFDVCxtQkFBYSxHQUFHLE9BQU87QUFBQTtBQUFBLG1CQUF3QixPQUFPO0FBQUEsSUFDMUQ7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQSxRQUFRO0FBQUEsUUFDSixhQUFhO0FBQUEsUUFDYixXQUFXO0FBQUEsTUFDZjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxtQkFBbUJBLFNBQWlDO0FBRWhELFVBQU0sWUFBWUEsUUFBTyxlQUFlQSxRQUFPLGFBQWFBLFFBQU87QUFDbkUsV0FBTyxLQUFLLEtBQUssVUFBVSxTQUFTLENBQUM7QUFBQSxFQUN6QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZUFBZUEsU0FBK0Q7QUFDMUUsVUFBTSxTQUFtQixDQUFDO0FBRTFCLFFBQUksQ0FBQ0EsUUFBTyxnQkFBZ0JBLFFBQU8sYUFBYSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ2pFLGFBQU8sS0FBSyx3QkFBd0I7QUFBQSxJQUN4QztBQUVBLFFBQUksQ0FBQ0EsUUFBTyxjQUFjQSxRQUFPLFdBQVcsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUM3RCxhQUFPLEtBQUssc0JBQXNCO0FBQUEsSUFDdEM7QUFFQSxVQUFNLGFBQWEsS0FBSyxtQkFBbUJBLE9BQU07QUFDakQsUUFBSSxhQUFhLEtBQU07QUFDbkIsYUFBTyxLQUFLLHVCQUF1QixVQUFVLG9CQUFvQjtBQUFBLElBQ3JFO0FBRUEsUUFBSUEsUUFBTyxPQUFPLGNBQWMsS0FBS0EsUUFBTyxPQUFPLGNBQWMsR0FBRztBQUNoRSxhQUFPLEtBQUsscUNBQXFDO0FBQUEsSUFDckQ7QUFFQSxRQUFJQSxRQUFPLE9BQU8sWUFBWSxNQUFNQSxRQUFPLE9BQU8sWUFBWSxLQUFNO0FBQ2hFLGFBQU8sS0FBSyx3Q0FBd0M7QUFBQSxJQUN4RDtBQUVBLFdBQU87QUFBQSxNQUNILE9BQU8sT0FBTyxXQUFXO0FBQUEsTUFDekI7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKOzs7QUNoYUEsSUFBTSxtQkFBcUM7QUFBQSxFQUN2QztBQUFBLElBQ0ksUUFBUTtBQUFBLElBQ1IsVUFBVTtBQUFBLE1BQ047QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLElBQ0EsU0FBUyxDQUFDLGFBQWEsWUFBWSxXQUFXO0FBQUEsRUFDbEQ7QUFBQSxFQUNBO0FBQUEsSUFDSSxRQUFRO0FBQUEsSUFDUixVQUFVO0FBQUEsTUFDTjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxZQUFZLEtBQUs7QUFBQSxFQUMvQjtBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLElBQ0EsU0FBUyxDQUFDLGFBQWEsV0FBVyxNQUFNO0FBQUEsRUFDNUM7QUFBQSxFQUNBO0FBQUEsSUFDSSxRQUFRO0FBQUEsSUFDUixVQUFVO0FBQUEsTUFDTjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxPQUFPLFdBQVcsV0FBVztBQUFBLEVBQzNDO0FBQUEsRUFDQTtBQUFBLElBQ0ksUUFBUTtBQUFBLElBQ1IsVUFBVTtBQUFBLE1BQ047QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsSUFDQSxTQUFTLENBQUMsYUFBYSxXQUFXLFdBQVc7QUFBQSxFQUNqRDtBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxVQUFVO0FBQUEsRUFDeEI7QUFDSjtBQUtBLElBQU0sb0JBQW9CO0FBQUEsRUFDdEI7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUNKO0FBS0EsSUFBTSxrQkFBa0I7QUFBQSxFQUNwQixFQUFFLFNBQVMseURBQXlELFFBQVEsWUFBWTtBQUFBLEVBQ3hGLEVBQUUsU0FBUyxxREFBcUQsUUFBUSxZQUFZO0FBQUEsRUFDcEYsRUFBRSxTQUFTLHFEQUFxRCxRQUFRLFdBQVc7QUFBQSxFQUNuRixFQUFFLFNBQVMsZ0NBQWdDLFFBQVEsTUFBTTtBQUFBLEVBQ3pELEVBQUUsU0FBUywrQkFBK0IsUUFBUSxVQUFVO0FBQ2hFO0FBRU8sSUFBTSxnQkFBTixNQUFvQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSXZCLGFBQWEsT0FBZSxlQUF3QixPQUFvQjtBQUNwRSxVQUFNLGtCQUFrQixNQUFNLEtBQUssRUFBRSxZQUFZO0FBR2pELFVBQU0sU0FBUyxLQUFLLGFBQWEsZUFBZTtBQUdoRCxVQUFNLFNBQVMsS0FBSyxhQUFhLGlCQUFpQixjQUFjLE1BQU07QUFHdEUsVUFBTSxXQUFXLEtBQUssZ0JBQWdCLEtBQUs7QUFHM0MsVUFBTSxVQUFVLEtBQUssZUFBZSxLQUFLO0FBRXpDLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBLGFBQWE7QUFBQSxNQUNiO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGFBQWEsT0FBMkI7QUFFNUMsZUFBVyxrQkFBa0Isa0JBQWtCO0FBQzNDLGlCQUFXLFdBQVcsZUFBZSxVQUFVO0FBQzNDLFlBQUksUUFBUSxLQUFLLEtBQUssR0FBRztBQUNyQixpQkFBTyxlQUFlO0FBQUEsUUFDMUI7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUdBLFFBQUksMkRBQTJELEtBQUssS0FBSyxHQUFHO0FBQ3hFLGFBQU87QUFBQSxJQUNYO0FBQ0EsUUFBSSxvREFBb0QsS0FBSyxLQUFLLEdBQUc7QUFDakUsYUFBTztBQUFBLElBQ1g7QUFDQSxRQUFJLGlDQUFpQyxLQUFLLEtBQUssR0FBRztBQUM5QyxhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksb0RBQW9ELEtBQUssS0FBSyxHQUFHO0FBQ2pFLGFBQU87QUFBQSxJQUNYO0FBQ0EsUUFBSSxzSEFBc0gsS0FBSyxLQUFLLEdBQUc7QUFDbkksYUFBTztBQUFBLElBQ1g7QUFHQSxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsYUFDSixPQUNBLGNBQ0EsUUFDcUI7QUFFckIsZUFBVyxpQkFBaUIsaUJBQWlCO0FBQ3pDLFVBQUksY0FBYyxRQUFRLEtBQUssS0FBSyxHQUFHO0FBQ25DLGVBQU8sY0FBYztBQUFBLE1BQ3pCO0FBQUEsSUFDSjtBQUdBLFFBQUksaUJBQWlCLFdBQVcsVUFBVSxXQUFXLGFBQWEsV0FBVyxXQUFXO0FBQ3BGLGFBQU87QUFBQSxJQUNYO0FBR0EsWUFBUSxRQUFRO0FBQUEsTUFDWixLQUFLO0FBQ0QsZUFBTyxNQUFNLFNBQVMsU0FBUyxLQUFLLE1BQU0sU0FBUyxTQUFTLElBQUksWUFBWTtBQUFBLE1BQ2hGLEtBQUs7QUFDRCxlQUFPLGVBQWUsY0FBYztBQUFBLE1BQ3hDLEtBQUs7QUFDRCxlQUFPLGVBQWUsY0FBYztBQUFBLE1BQ3hDLEtBQUs7QUFDRCxlQUFPLGVBQWUsY0FBYztBQUFBLE1BQ3hDLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFDWDtBQUNJLGVBQU87QUFBQSxJQUNmO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQWdCLE9BQW1DO0FBQ3ZELGVBQVcsV0FBVyxtQkFBbUI7QUFDckMsWUFBTSxRQUFRLFFBQVEsS0FBSyxLQUFLO0FBQ2hDLFVBQUksU0FBUyxNQUFNLENBQUMsR0FBRztBQUNuQixlQUFPLE1BQU0sQ0FBQyxFQUFFLEtBQUs7QUFBQSxNQUN6QjtBQUFBLElBQ0o7QUFFQSxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZUFBZSxPQUF1QjtBQUUxQyxVQUFNLGtCQUFrQjtBQUFBLE1BQ3BCO0FBQUEsTUFBVTtBQUFBLE1BQVk7QUFBQSxNQUFVO0FBQUEsTUFBZ0I7QUFBQSxNQUFZO0FBQUEsTUFDNUQ7QUFBQSxNQUFVO0FBQUEsTUFBVztBQUFBLE1BQVk7QUFBQSxNQUFTO0FBQUEsTUFBVztBQUFBLE1BQ3JEO0FBQUEsTUFBWTtBQUFBLE1BQVc7QUFBQSxNQUFZO0FBQUEsTUFBWTtBQUFBLElBQ25EO0FBRUEsVUFBTSxjQUFjLGdCQUFnQjtBQUFBLE1BQU8sV0FDdkMsTUFBTSxZQUFZLEVBQUUsU0FBUyxLQUFLO0FBQUEsSUFDdEM7QUFFQSxRQUFJLFVBQVU7QUFDZCxRQUFJLFlBQVksU0FBUyxHQUFHO0FBQ3hCLGlCQUFXLFVBQVUsWUFBWSxLQUFLLElBQUksQ0FBQztBQUFBLElBQy9DO0FBR0EsUUFBSSxNQUFNLFNBQVMsT0FBTyxLQUFLLE1BQU0sU0FBUyxPQUFPLEtBQUssTUFBTSxTQUFTLFNBQVMsR0FBRztBQUNqRixpQkFBVztBQUFBLElBQ2Y7QUFDQSxRQUFJLE1BQU0sU0FBUyxNQUFNLEtBQUssTUFBTSxTQUFTLFVBQVUsS0FBSyxNQUFNLFNBQVMsZUFBZSxHQUFHO0FBQ3pGLGlCQUFXO0FBQUEsSUFDZjtBQUdBLFFBQUksTUFBTSxTQUFTLFFBQVEsS0FBSyxNQUFNLFNBQVMsTUFBTSxHQUFHO0FBQ3BELGlCQUFXO0FBQUEsSUFDZjtBQUNBLFFBQUksTUFBTSxTQUFTLFNBQVMsS0FBSyxNQUFNLFNBQVMsVUFBVSxHQUFHO0FBQ3pELGlCQUFXO0FBQUEsSUFDZjtBQUNBLFFBQUksTUFBTSxTQUFTLFFBQVEsS0FBSyxNQUFNLFNBQVMsVUFBVSxHQUFHO0FBQ3hELGlCQUFXO0FBQUEsSUFDZjtBQUVBLFdBQU8sUUFBUSxLQUFLO0FBQUEsRUFDeEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGdCQUFnQixTQUFzQixjQUdwQztBQUVFLFFBQUksUUFBUSxXQUFXLGVBQWUsQ0FBQyxjQUFjO0FBQ2pELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLGFBQWEsUUFBUSxXQUFXLFlBQVksQ0FBQyxRQUFRLFVBQVU7QUFDbEYsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBR0EsUUFBSSxRQUFRLFdBQVcsU0FBUyxRQUFRLFdBQVcsYUFBYTtBQUM1RCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFFQSxXQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsRUFDekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGVBQWUsY0FBdUIsYUFBZ0M7QUFDbEUsVUFBTSxjQUF3QixDQUFDO0FBRS9CLFFBQUksY0FBYztBQUNkLGtCQUFZO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0o7QUFBQSxJQUNKLE9BQU87QUFDSCxrQkFBWTtBQUFBLFFBQ1I7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFFBQUksYUFBYTtBQUNiLGtCQUFZO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFdBQU87QUFBQSxFQUNYO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxzQkFBc0IsT0FBOEI7QUFFaEQsVUFBTSxhQUFhO0FBQ25CLFVBQU0sUUFBUSxNQUFNLE1BQU0sVUFBVTtBQUVwQyxRQUFJLE1BQU0sV0FBVyxHQUFHO0FBQ3BCLGFBQU8sQ0FBQyxLQUFLLGFBQWEsS0FBSyxDQUFDO0FBQUEsSUFDcEM7QUFFQSxXQUFPLE1BQ0YsSUFBSSxVQUFRLEtBQUssS0FBSyxDQUFDLEVBQ3ZCLE9BQU8sVUFBUSxLQUFLLFNBQVMsQ0FBQyxFQUM5QixJQUFJLFVBQVEsS0FBSyxhQUFhLElBQUksQ0FBQztBQUFBLEVBQzVDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxzQkFBc0IsU0FBOEI7QUFDaEQsVUFBTSxFQUFFLFFBQVEsUUFBUSxTQUFTLElBQUk7QUFFckMsUUFBSSxjQUFjO0FBRWxCLFlBQVEsUUFBUTtBQUFBLE1BQ1osS0FBSztBQUNELHNCQUFjO0FBQ2Q7QUFBQSxNQUNKLEtBQUs7QUFDRCxzQkFBYztBQUNkO0FBQUEsTUFDSixLQUFLO0FBQ0Qsc0JBQWM7QUFDZDtBQUFBLE1BQ0osS0FBSztBQUNELHNCQUFjO0FBQ2Q7QUFBQSxNQUNKLEtBQUs7QUFDRCxzQkFBYztBQUNkO0FBQUEsSUFDUjtBQUVBLFFBQUksVUFBVTtBQUNWLHFCQUFlLFFBQVEsUUFBUTtBQUFBLElBQ25DLE9BQU87QUFDSCxjQUFRLFFBQVE7QUFBQSxRQUNaLEtBQUs7QUFDRCx5QkFBZTtBQUNmO0FBQUEsUUFDSixLQUFLO0FBQ0QseUJBQWU7QUFDZjtBQUFBLFFBQ0osS0FBSztBQUNELHlCQUFlO0FBQ2Y7QUFBQSxRQUNKLEtBQUs7QUFDRCx5QkFBZTtBQUNmO0FBQUEsUUFDSixLQUFLO0FBQ0QseUJBQWU7QUFDZjtBQUFBLE1BQ1I7QUFBQSxJQUNKO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFDSjs7O0FDN1hPLElBQU0sZ0JBQU4sTUFBb0I7QUFBQSxFQU12QixZQUNJLGdCQUNBLHFCQUNGO0FBQ0UsU0FBSyxpQkFBaUIsSUFBSSxlQUFlO0FBQ3pDLFNBQUssaUJBQWlCO0FBQ3RCLFNBQUssc0JBQXNCO0FBQzNCLFNBQUssZ0JBQWdCLElBQUksY0FBYztBQUFBLEVBQzNDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHNCQUNGLFNBQ0EsTUFDQSxVQUFpQyxDQUFDLEdBQ1Y7QUFFeEIsVUFBTSxrQkFBa0IsS0FBSyxnQkFBZ0IsT0FBTztBQUVwRCxRQUFJLG1CQUFtQixNQUFNO0FBRXpCLFlBQU0sZ0JBQWdCLEtBQUssY0FBYyxhQUFhLE9BQU87QUFDN0QsYUFBTyxLQUFLLG1CQUFtQixlQUFlLE1BQU0sT0FBTztBQUFBLElBQy9ELE9BQU87QUFFSCxhQUFPLEtBQUssd0JBQXdCLFNBQVMsTUFBTSxPQUFPO0FBQUEsSUFDOUQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsU0FBMEI7QUFFOUMsVUFBTSxlQUFlO0FBQUEsTUFDakI7QUFBQSxNQUFPO0FBQUEsTUFBVTtBQUFBLE1BQVM7QUFBQSxNQUFVO0FBQUEsTUFBVztBQUFBLE1BQy9DO0FBQUEsTUFBUTtBQUFBLE1BQVU7QUFBQSxNQUFVO0FBQUEsTUFBVTtBQUFBLE1BQVU7QUFBQSxNQUFXO0FBQUEsTUFDM0Q7QUFBQSxNQUFVO0FBQUEsTUFBVTtBQUFBLE1BQWE7QUFBQSxNQUFPO0FBQUEsTUFDeEM7QUFBQSxNQUFPO0FBQUEsTUFBVztBQUFBLE1BQVc7QUFBQSxNQUFTO0FBQUEsTUFBYTtBQUFBLE1BQ25EO0FBQUEsTUFBVztBQUFBLE1BQVU7QUFBQSxNQUFZO0FBQUEsTUFBZTtBQUFBLElBQ3BEO0FBRUEsVUFBTSxlQUFlLFFBQVEsWUFBWTtBQUN6QyxXQUFPLGFBQWEsS0FBSyxVQUFRLGFBQWEsU0FBUyxJQUFJLENBQUM7QUFBQSxFQUNoRTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxtQkFDRixTQUNBLE1BQ0EsVUFBaUMsQ0FBQyxHQUNWO0FBQ3hCLFFBQUksQ0FBQyxNQUFNO0FBQ1AsWUFBTSxJQUFJLE1BQU0sc0NBQXNDO0FBQUEsSUFDMUQ7QUFHQSxVQUFNLGtCQUFrQixNQUFNLEtBQUssbUJBQW1CLElBQUk7QUFHMUQsUUFBSTtBQUNKLFFBQUksUUFBUSxnQkFBZ0I7QUFDeEIsWUFBTSxpQkFBaUIsTUFBTSxLQUFLLG9CQUFvQixrQkFBa0IsTUFBTSxDQUFDO0FBQy9FLDRCQUFzQixLQUFLLDBCQUEwQixjQUFjO0FBQUEsSUFDdkU7QUFHQSxXQUFPLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLFNBQVMsbUJBQW1CO0FBQUEsRUFDakc7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sd0JBQ0YsU0FDQSxNQUNBLFVBQWlDLENBQUMsR0FDVjtBQUN4QixRQUFJO0FBQ0osUUFBSSxnQkFBdUMsQ0FBQztBQUc1QyxRQUFJLE1BQU07QUFDTix3QkFBa0IsTUFBTSxLQUFLLG1CQUFtQixJQUFJO0FBR3BELHNCQUFnQixNQUFNLEtBQUssb0JBQW9CLGtCQUFrQixNQUFNLENBQUM7QUFBQSxJQUM1RTtBQUVBLFdBQU8sS0FBSyxlQUFlLHdCQUF3QixTQUFTLGlCQUFpQixhQUFhO0FBQUEsRUFDOUY7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixhQUFxQixTQUFtQztBQUN0RSxXQUFPLEtBQUssZUFBZSxrQkFBa0IsYUFBYSxPQUFPO0FBQUEsRUFDckU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsbUJBQW1CLE1BQXVDO0FBRXBFLFVBQU0sVUFBVSxNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFFN0QsUUFBSSxDQUFDLFNBQVM7QUFFVixZQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsbUJBQW1CLEtBQUs7QUFDbEUsYUFBTztBQUFBLFFBQ0g7QUFBQSxRQUNBLFVBQVUsS0FBSztBQUFBLFFBQ2Y7QUFBQSxRQUNBLFVBQVUsQ0FBQztBQUFBLFFBQ1gsY0FBYztBQUFBLFFBQ2Qsa0JBQWtCO0FBQUEsTUFDdEI7QUFBQSxJQUNKO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDBCQUEwQixVQUF5QztBQUN2RSxRQUFJLFNBQVMsV0FBVyxFQUFHLFFBQU87QUFFbEMsUUFBSSxZQUFZO0FBQ2hCLGFBQVMsUUFBUSxTQUFPO0FBQ3BCLFlBQU0sT0FBTyxJQUFJLFNBQVMsU0FBUyxRQUFRO0FBQzNDLG1CQUFhLEdBQUcsSUFBSSxLQUFLLElBQUksT0FBTztBQUFBO0FBQUEsSUFDeEMsQ0FBQztBQUVELFdBQU87QUFBQSxFQUNYO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSwwQkFBMEJDLFNBQTBDO0FBQ2hFLFVBQU0sYUFBYSxLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUU1RCxRQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGNBQVEsS0FBSyw2QkFBNkIsV0FBVyxNQUFNO0FBRzNELFVBQUksa0JBQWtCLEVBQUUsR0FBR0EsUUFBTztBQUdsQyxZQUFNLGFBQWEsS0FBSyxlQUFlLG1CQUFtQkEsT0FBTTtBQUNoRSxVQUFJLGFBQWEsS0FBTTtBQUVuQixjQUFNLG1CQUFtQixLQUFLLE1BQU1BLFFBQU8sUUFBUSxTQUFTLEdBQUc7QUFDL0Qsd0JBQWdCLFVBQVVBLFFBQU8sUUFBUSxVQUFVLEdBQUcsZ0JBQWdCLElBQUk7QUFBQSxNQUM5RTtBQUdBLFVBQUlBLFFBQU8sT0FBTyxjQUFjLEtBQUtBLFFBQU8sT0FBTyxjQUFjLEdBQUc7QUFDaEUsd0JBQWdCLE9BQU8sY0FBYyxLQUFLLElBQUksR0FBRyxLQUFLLElBQUksR0FBR0EsUUFBTyxPQUFPLFdBQVcsQ0FBQztBQUFBLE1BQzNGO0FBR0EsVUFBSUEsUUFBTyxPQUFPLFlBQVksTUFBTUEsUUFBTyxPQUFPLFlBQVksS0FBTTtBQUNoRSx3QkFBZ0IsT0FBTyxZQUFZLEtBQUssSUFBSSxJQUFJLEtBQUssSUFBSSxLQUFNQSxRQUFPLE9BQU8sU0FBUyxDQUFDO0FBQUEsTUFDM0Y7QUFFQSxhQUFPO0FBQUEsSUFDWDtBQUVBLFdBQU9BO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsY0FBY0EsU0FBaUM7QUFDM0MsV0FBTyxLQUFLLGVBQWUsbUJBQW1CQSxPQUFNO0FBQUEsRUFDeEQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQ0YsUUFDQSxhQUNBLE1BQ3dCO0FBQ3hCLFVBQU0sVUFBdUI7QUFBQSxNQUN6QjtBQUFBLE1BQ0EsUUFBUTtBQUFBLE1BQ1I7QUFBQSxNQUNBLFVBQVU7QUFBQSxNQUNWLFNBQVM7QUFBQSxJQUNiO0FBRUEsUUFBSSxNQUFNO0FBQ04sYUFBTyxLQUFLLG1CQUFtQixTQUFTLE1BQU07QUFBQSxRQUMxQyxpQkFBaUI7QUFBQSxRQUNqQixrQkFBa0I7QUFBQSxRQUNsQixnQkFBZ0I7QUFBQSxNQUNwQixDQUFDO0FBQUEsSUFDTCxPQUFPO0FBQ0gsYUFBTyxLQUFLLGtCQUFrQixXQUFXO0FBQUEsSUFDN0M7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUNGLGNBQ0EsYUFDQSxNQUN3QjtBQUN4QixRQUFJLFVBQVU7QUFFZCxRQUFJLE1BQU07QUFDTixZQUFNLGtCQUFrQixNQUFNLEtBQUssbUJBQW1CLElBQUk7QUFDMUQsZ0JBQVUsYUFBYSxnQkFBZ0IsUUFBUTtBQUFBLEVBQUssZ0JBQWdCLE9BQU87QUFBQSxJQUMvRTtBQUVBLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQSxZQUFZO0FBQUEsTUFDWjtBQUFBLE1BQ0EsUUFBUTtBQUFBLFFBQ0osYUFBYTtBQUFBLFFBQ2IsV0FBVztBQUFBLE1BQ2Y7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKOzs7QUN2UE8sSUFBTSxhQUFOLE1BQWlCO0FBQUEsRUFDcEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBK0M7QUFDekQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sYUFBYSxLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUM1RCxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sNkJBQTZCLFdBQVcsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ2hFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFFQSxjQUFNLEtBQUssZUFBZSxlQUFlLFFBQVEsYUFBYSxPQUFPO0FBRXJFLGNBQU0sVUFBVSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsVUFDdkNBLFFBQU87QUFBQSxVQUNQO0FBQUEsWUFDSSxjQUFjQSxRQUFPO0FBQUEsWUFDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsWUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsVUFDN0I7QUFBQSxRQUNKO0FBRUEsWUFBSSxDQUFDLFdBQVcsUUFBUSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ3pDLGdCQUFNQyxVQUFTO0FBQUEsWUFDWCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUdBLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IsOEJBQThCQSxPQUFNO0FBQ2xGLGlCQUFPQTtBQUFBLFFBQ1g7QUFHQSxjQUFNLFNBQVMsTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUNyQztBQUFBLFVBQ0EsTUFBTSxLQUFLLHdCQUF3QixTQUFTLGVBQWU7QUFBQSxVQUMzRDtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUdBLFlBQUksQ0FBQyxPQUFPLFNBQVM7QUFDakIsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQix5QkFBeUIsTUFBTTtBQUFBLFFBQ2pGO0FBRUEsZUFBTztBQUFBLE1BRVgsU0FBUyxPQUFPO0FBQ1osY0FBTSxTQUFTO0FBQUEsVUFDWCxTQUFTO0FBQUEsVUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBR0EsY0FBTSxLQUFLLGVBQWU7QUFBQSxVQUN0QixVQUFVLE9BQU8sS0FBSztBQUFBLFVBQ3RCO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsd0JBQ1YsU0FDQSxpQkFDc0U7QUFDdEUsWUFBUSxRQUFRLFFBQVE7QUFBQSxNQUNwQixLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVgsS0FBSztBQUNELFlBQUksUUFBUSxVQUFVO0FBQ2xCLGdCQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsWUFBWSxRQUFRLFFBQVE7QUFDdEUsY0FBSSxTQUFTO0FBRVQsbUJBQU8sRUFBRSxNQUFNLFFBQVEsTUFBTSxLQUFLLElBQUksRUFBRTtBQUFBLFVBQzVDO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUVYLEtBQUs7QUFFRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBRUQsZUFBTztBQUFBLE1BRVg7QUFDSSxlQUFPO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGdCQUFnQixTQUEwQixjQUd4QztBQUVFLFFBQUksUUFBUSxXQUFXLGFBQWE7QUFDaEMsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBR0EsUUFBSSxRQUFRLFdBQVcsYUFBYSxDQUFDLFFBQVEsVUFBVTtBQUVuRCxhQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsSUFDekI7QUFFQSxXQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsRUFDekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGVBQWUsaUJBQTRDO0FBQ3ZELFVBQU0sY0FBd0I7QUFBQSxNQUMxQjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBR0EsUUFBSSxnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDckMsWUFBTSxlQUFlLGdCQUFnQixTQUFTLElBQUksT0FBSyxFQUFFLElBQUk7QUFFN0QsVUFBSSxDQUFDLGFBQWEsS0FBSyxVQUFRLEtBQUssWUFBWSxFQUFFLFNBQVMsY0FBYyxDQUFDLEdBQUc7QUFDekUsb0JBQVksUUFBUSw2QkFBNkI7QUFBQSxNQUNyRDtBQUVBLFVBQUksQ0FBQyxhQUFhLEtBQUssVUFBUSxLQUFLLFlBQVksRUFBRSxTQUFTLFlBQVksQ0FBQyxHQUFHO0FBQ3ZFLG9CQUFZLEtBQUssMEJBQTBCO0FBQUEsTUFDL0M7QUFFQSxVQUFJLENBQUMsYUFBYSxLQUFLLFVBQVEsS0FBSyxZQUFZLEVBQUUsU0FBUyxTQUFTLENBQUMsR0FBRztBQUNwRSxvQkFBWSxLQUFLLHVCQUF1QjtBQUFBLE1BQzVDO0FBQUEsSUFDSjtBQUVBLFdBQU8sWUFBWSxNQUFNLEdBQUcsQ0FBQztBQUFBLEVBQ2pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLFFBQVEsU0FLWDtBQUNDLFFBQUk7QUFDQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsUUFDWDtBQUFBLE1BQ0o7QUFHQSxVQUFJLHNCQUFzQjtBQUMxQixjQUFRLFFBQVEsUUFBUTtBQUFBLFFBQ3BCLEtBQUs7QUFDRCxnQ0FBc0I7QUFDdEI7QUFBQSxRQUNKLEtBQUs7QUFDRCxjQUFJLFFBQVEsVUFBVTtBQUNsQixrQ0FBc0IsV0FBVyxRQUFRLFFBQVE7QUFBQSxVQUNyRCxPQUFPO0FBQ0gsa0NBQXNCO0FBQUEsVUFDMUI7QUFDQTtBQUFBLFFBQ0osS0FBSztBQUNELGdDQUFzQjtBQUN0QjtBQUFBLFFBQ0osS0FBSztBQUNELGdDQUFzQjtBQUN0QjtBQUFBLFFBQ0o7QUFDSSxnQ0FBc0I7QUFBQSxNQUM5QjtBQUVBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVMsd0JBQXdCLG1CQUFtQjtBQUFBLFFBQ3BELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ3BEO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDM1BPLElBQU0sY0FBTixNQUFrQjtBQUFBLEVBQ3JCLFlBQ1ksS0FDQSxnQkFDQSxnQkFDQSxpQkFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFDVDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0gsTUFBTSxRQUFRLFNBQStDO0FBQ3pELFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsU0FBUyxDQUFDLENBQUMsZ0JBQWdCLFlBQVk7QUFDL0UsVUFBSSxDQUFDLFdBQVcsT0FBTztBQUNuQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLFdBQVc7QUFBQSxVQUNsQixVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLHNCQUFzQixLQUFLLGVBQWUsdUJBQXVCO0FBQ3ZFLFlBQU0sZUFBZSxzQkFBc0IsRUFBRSxnQkFBZ0IsS0FBSyxJQUFJLENBQUM7QUFDdkUsWUFBTUMsVUFBUyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixjQUFjLG1CQUFtQjtBQUcxRyxZQUFNLG1CQUFtQixLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUNsRSxVQUFJLENBQUMsaUJBQWlCLE9BQU87QUFDekIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyw2QkFBNkIsaUJBQWlCLE9BQU8sS0FBSyxJQUFJLENBQUM7QUFBQSxVQUN0RSxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxVQUFJO0FBRUEsY0FBTSxLQUFLLGVBQWUsZUFBZSxRQUFRLGFBQWEsT0FBTztBQUVyRSxjQUFNLFVBQVUsTUFBTSxLQUFLLGdCQUFnQjtBQUFBLFVBQ3ZDQSxRQUFPO0FBQUEsVUFDUDtBQUFBLFlBQ0ksY0FBY0EsUUFBTztBQUFBLFlBQ3JCLGFBQWFBLFFBQU8sT0FBTztBQUFBLFlBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFVBQzdCO0FBQUEsUUFDSjtBQUVBLFlBQUksQ0FBQyxXQUFXLFFBQVEsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUN6QyxnQkFBTUMsVUFBUztBQUFBLFlBQ1gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFHQSxnQkFBTSxLQUFLLGVBQWUsb0JBQW9CLDhCQUE4QkEsT0FBTTtBQUNsRixpQkFBT0E7QUFBQSxRQUNYO0FBR0EsY0FBTSxTQUFTLE1BQU0sS0FBSyxVQUFVLFNBQVMsaUJBQWlCLE9BQU87QUFHckUsWUFBSSxDQUFDLE9BQU8sU0FBUztBQUNqQixnQkFBTSxLQUFLLGVBQWUsb0JBQW9CLDBCQUEwQixNQUFNO0FBQUEsUUFDbEY7QUFFQSxlQUFPO0FBQUEsTUFFWCxTQUFTLE9BQU87QUFDWixjQUFNLFNBQVM7QUFBQSxVQUNYLFNBQVM7QUFBQSxVQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFHQSxjQUFNLEtBQUssZUFBZTtBQUFBLFVBQ3RCLFVBQVUsT0FBTyxLQUFLO0FBQUEsVUFDdEI7QUFBQSxRQUNKO0FBRUEsZUFBTztBQUFBLE1BQ1g7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDaEQsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxVQUNWLFNBQ0EsaUJBQ0EsU0FDbUI7QUFDbkIsWUFBUSxRQUFRLFFBQVE7QUFBQSxNQUNwQixLQUFLO0FBQ0QsZUFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFVBQzdCO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxZQUNJLGNBQWM7QUFBQSxZQUNkLGVBQWU7QUFBQSxVQUNuQjtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFDRCxZQUFJLFFBQVEsVUFBVTtBQUNsQixnQkFBTSxVQUFVLE1BQU0sS0FBSyxlQUFlLFlBQVksUUFBUSxRQUFRO0FBQ3RFLGNBQUksU0FBUztBQUVULGtCQUFNLG9CQUFvQixHQUFHLFFBQVEsT0FBTztBQUFBO0FBQUEsRUFBTyxPQUFPO0FBRzFELGtCQUFNLFdBQVcsRUFBRSxNQUFNLFFBQVEsTUFBTSxPQUFPLElBQUksRUFBRTtBQUNwRCxrQkFBTSxTQUFTLEVBQUUsTUFBTSxRQUFRLE1BQU0sTUFBTSxHQUFHLElBQUksRUFBRTtBQUVwRCxrQkFBTSxTQUFTLEtBQUssZUFBZSxnQkFBZ0I7QUFDbkQsZ0JBQUksQ0FBQyxRQUFRO0FBQ1QscUJBQU87QUFBQSxnQkFDSCxTQUFTO0FBQUEsZ0JBQ1QsT0FBTztBQUFBLGdCQUNQLFVBQVU7QUFBQSxjQUNkO0FBQUEsWUFDSjtBQUVBLG1CQUFPLGFBQWEsbUJBQW1CLFVBQVUsTUFBTTtBQUV2RCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsU0FBUztBQUFBLGNBQ1QsVUFBVTtBQUFBLGNBQ1YsV0FBVztBQUFBLFlBQ2Y7QUFBQSxVQUNKLE9BQU87QUFDSCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsT0FBTyxZQUFZLFFBQVEsUUFBUTtBQUFBLGNBQ25DLFVBQVU7QUFBQSxZQUNkO0FBQUEsVUFDSjtBQUFBLFFBQ0o7QUFBQTtBQUFBLE1BR0osS0FBSztBQUNELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBQ0QsZUFBTyxNQUFNLEtBQUssZUFBZSxtQkFBbUIsT0FBTztBQUFBLE1BRS9ELEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsU0FBMEIsY0FHeEM7QUFFRSxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxhQUFhLFFBQVEsV0FBVyxVQUFVLFFBQVEsVUFBVTtBQUUvRSxhQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsSUFDekI7QUFFQSxXQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsRUFDekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGVBQWUsaUJBQWtDLGNBQWlDO0FBQzlFLFVBQU0sY0FBd0IsQ0FBQztBQUUvQixRQUFJLGNBQWM7QUFDZCxrQkFBWTtBQUFBLFFBQ1I7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUFBLElBQ0osT0FBTztBQUNILGtCQUFZO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBR0EsVUFBSSxnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDckMsd0JBQWdCLFNBQVMsUUFBUSxhQUFXO0FBQ3hDLHNCQUFZLEtBQUssZ0JBQWdCLFFBQVEsSUFBSSxXQUFXO0FBQUEsUUFDNUQsQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBRUEsV0FBTyxZQUFZLE1BQU0sR0FBRyxFQUFFO0FBQUEsRUFDbEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sUUFBUSxTQUtYO0FBMVJQO0FBMlJRLFFBQUk7QUFDQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsUUFDWDtBQUFBLE1BQ0o7QUFFQSxVQUFJLGtCQUFrQjtBQUN0QixVQUFJLGNBQWM7QUFFbEIsY0FBUSxRQUFRLFFBQVE7QUFBQSxRQUNwQixLQUFLO0FBQ0QsY0FBSSxnQkFBZ0IsY0FBYztBQUM5Qiw4QkFBa0IsZ0JBQWdCO0FBQ2xDLDBCQUFjO0FBQUEsVUFDbEIsT0FBTztBQUNILG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPO0FBQUEsWUFDWDtBQUFBLFVBQ0o7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELGNBQUksUUFBUSxVQUFVO0FBQ2xCLGtCQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsWUFBWSxRQUFRLFFBQVE7QUFDdEUsZ0JBQUksU0FBUztBQUNULGdDQUFrQixRQUFRO0FBQzFCLDRCQUFjLHlCQUF5QixRQUFRLFFBQVE7QUFBQSxZQUMzRCxPQUFPO0FBQ0gscUJBQU87QUFBQSxnQkFDSCxTQUFTO0FBQUEsZ0JBQ1QsT0FBTyxZQUFZLFFBQVEsUUFBUTtBQUFBLGNBQ3ZDO0FBQUEsWUFDSjtBQUFBLFVBQ0osT0FBTztBQUNILDBCQUFjO0FBQUEsVUFDbEI7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELHdCQUFjO0FBRWQsY0FBSSxnQkFBZ0Isa0JBQWtCO0FBQ2xDLGtCQUFNLGVBQWMsMkJBQWdCLG1CQUFoQixtQkFBZ0MsU0FBaEMsWUFBd0M7QUFDNUQsa0JBQU0sU0FBUyxLQUFLLGVBQWUsZ0JBQWdCO0FBQ25ELGdCQUFJLFFBQVE7QUFDUixnQ0FBa0IsT0FBTyxRQUFRLFdBQVc7QUFBQSxZQUNoRDtBQUFBLFVBQ0o7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELDRCQUFrQixnQkFBZ0I7QUFDbEMsd0JBQWM7QUFDZDtBQUFBLFFBRUosS0FBSztBQUNELHdCQUFjO0FBQ2Q7QUFBQSxRQUVKO0FBQ0ksaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxVQUNYO0FBQUEsTUFDUjtBQUVBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULGlCQUFpQixnQkFBZ0IsU0FBUyxNQUN0QyxnQkFBZ0IsVUFBVSxHQUFHLEdBQUcsSUFBSSxRQUNwQztBQUFBLE1BQ1I7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDcEQ7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esb0JBQW9CLGlCQUErRDtBQUMvRSxVQUFNLFVBQXVDLENBQUMsYUFBYSxZQUFZLEtBQUs7QUFFNUUsUUFBSSxnQkFBZ0IsY0FBYztBQUM5QixjQUFRLFFBQVEsV0FBVztBQUFBLElBQy9CO0FBRUEsUUFBSSxnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDckMsY0FBUSxPQUFPLElBQUksR0FBRyxTQUFTO0FBQUEsSUFDbkM7QUFFQSxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxjQUFjLFNBSWpCO0FBQ0MsVUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFFBQUksQ0FBQyxpQkFBaUI7QUFDbEIsYUFBTztBQUFBLFFBQ0gsb0JBQW9CO0FBQUEsUUFDcEIsZUFBZTtBQUFBLFFBQ2Ysa0JBQWtCO0FBQUEsTUFDdEI7QUFBQSxJQUNKO0FBRUEsUUFBSSxxQkFBcUI7QUFDekIsUUFBSSxnQkFBZ0I7QUFDcEIsUUFBSSxtQkFBbUI7QUFFdkIsWUFBUSxRQUFRLFFBQVE7QUFBQSxNQUNwQixLQUFLO0FBQ0QsWUFBSSxnQkFBZ0IsY0FBYztBQUM5QiwrQkFBcUIsZ0JBQWdCLGFBQWE7QUFDbEQsMEJBQWdCLGdCQUFnQixhQUFhLE1BQU0sSUFBSSxFQUFFO0FBQ3pELDZCQUFtQjtBQUFBLFFBQ3ZCO0FBQ0E7QUFBQSxNQUVKLEtBQUs7QUFDRCxZQUFJLFFBQVEsVUFBVTtBQUNsQixnQkFBTSxVQUFVLE1BQU0sS0FBSyxlQUFlLFlBQVksUUFBUSxRQUFRO0FBQ3RFLGNBQUksU0FBUztBQUNULGlDQUFxQixRQUFRLFFBQVE7QUFDckMsNEJBQWdCLFFBQVEsTUFBTSxNQUFNLFFBQVEsTUFBTTtBQUNsRCwrQkFBbUIsSUFBSSxRQUFRLFFBQVE7QUFBQSxVQUMzQztBQUFBLFFBQ0o7QUFDQTtBQUFBLE1BRUosS0FBSztBQUVELDZCQUFxQjtBQUNyQix3QkFBZ0I7QUFDaEIsMkJBQW1CO0FBQ25CO0FBQUEsTUFFSixLQUFLO0FBQ0QsNkJBQXFCLGdCQUFnQixRQUFRO0FBQzdDLHdCQUFnQixnQkFBZ0IsUUFBUSxNQUFNLElBQUksRUFBRTtBQUNwRCwyQkFBbUI7QUFDbkI7QUFBQSxNQUVKLEtBQUs7QUFDRCw2QkFBcUI7QUFDckIsd0JBQWdCO0FBQ2hCLDJCQUFtQjtBQUNuQjtBQUFBLElBQ1I7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDMWJPLElBQU0sZ0JBQU4sTUFBb0I7QUFBQSxFQUN2QixZQUNZLEtBQ0EsZ0JBQ0EsZ0JBQ0EsaUJBQ1Y7QUFKVTtBQUNBO0FBQ0E7QUFDQTtBQUFBLEVBQ1Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtILE1BQU0sUUFBUSxTQUErQztBQUN6RCxRQUFJO0FBRUEsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFVBQUksQ0FBQyxpQkFBaUI7QUFDbEIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFVBQ1AsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsWUFBTSxhQUFhLEtBQUssZ0JBQWdCLFNBQVMsQ0FBQyxDQUFDLGdCQUFnQixZQUFZO0FBQy9FLFVBQUksQ0FBQyxXQUFXLE9BQU87QUFDbkIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyxXQUFXO0FBQUEsVUFDbEIsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBR0EsVUFBSSxRQUFRLGVBQWUsUUFBUSxZQUFZLEtBQUssRUFBRSxTQUFTLEdBQUc7QUFFOUQsY0FBTSxLQUFLLGVBQWUsZUFBZSxRQUFRLGFBQWEsT0FBTztBQUdyRSxjQUFNLHNCQUFzQixLQUFLLGVBQWUsdUJBQXVCO0FBQ3ZFLGNBQU0sZUFBZSxzQkFBc0IsRUFBRSxnQkFBZ0IsS0FBSyxJQUFJLENBQUM7QUFDdkUsY0FBTUMsVUFBUyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixjQUFjLG1CQUFtQjtBQUcxRyxjQUFNLG1CQUFtQixLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUNsRSxZQUFJLENBQUMsaUJBQWlCLE9BQU87QUFDekIsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU8sNkJBQTZCLGlCQUFpQixPQUFPLEtBQUssSUFBSSxDQUFDO0FBQUEsWUFDdEUsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBRUEsWUFBSTtBQUVBLGdCQUFNLGFBQWEsTUFBTSxLQUFLLGdCQUFnQjtBQUFBLFlBQzFDQSxRQUFPO0FBQUEsWUFDUDtBQUFBLGNBQ0ksY0FBY0EsUUFBTztBQUFBLGNBQ3JCLGFBQWFBLFFBQU8sT0FBTztBQUFBLGNBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFlBQzdCO0FBQUEsVUFDSjtBQUFBLFFBSUosU0FBUyxPQUFPO0FBQ1osZ0JBQU1DLFVBQVM7QUFBQSxZQUNYLFNBQVM7QUFBQSxZQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsWUFDaEQsVUFBVTtBQUFBLFVBQ2Q7QUFHQSxnQkFBTSxLQUFLLGVBQWU7QUFBQSxZQUN0QixVQUFVQSxRQUFPLEtBQUs7QUFBQSxZQUN0QkE7QUFBQSxVQUNKO0FBRUEsaUJBQU9BO0FBQUEsUUFDWDtBQUFBLE1BQ0o7QUFHQSxZQUFNLFNBQVMsTUFBTSxLQUFLLGNBQWMsU0FBUyxlQUFlO0FBR2hFLFVBQUksUUFBUSxlQUFlLFFBQVEsWUFBWSxLQUFLLEVBQUUsU0FBUyxLQUFLLENBQUMsT0FBTyxTQUFTO0FBQ2pGLGNBQU0sS0FBSyxlQUFlLG9CQUFvQiw0QkFBNEIsTUFBTTtBQUFBLE1BQ3BGO0FBRUEsYUFBTztBQUFBLElBRVgsU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLGNBQ1YsU0FDQSxpQkFDbUI7QUFDbkIsWUFBUSxRQUFRLFFBQVE7QUFBQSxNQUNwQixLQUFLO0FBQ0QsWUFBSSxnQkFBZ0IsY0FBYztBQUM5QixpQkFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFlBQzdCO0FBQUEsWUFDQTtBQUFBLFlBQ0E7QUFBQSxjQUNJLGNBQWM7QUFBQSxjQUNkLGVBQWU7QUFBQSxZQUNuQjtBQUFBLFVBQ0o7QUFBQSxRQUNKLE9BQU87QUFDSCxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBQ0QsWUFBSSxRQUFRLFVBQVU7QUFDbEIsZ0JBQU0sVUFBVSxNQUFNLEtBQUssZUFBZSxZQUFZLFFBQVEsUUFBUTtBQUN0RSxjQUFJLFNBQVM7QUFFVCxrQkFBTSxXQUFXLEVBQUUsTUFBTSxRQUFRLE1BQU0sT0FBTyxJQUFJLEVBQUU7QUFDcEQsa0JBQU0sU0FBUyxFQUFFLE1BQU0sUUFBUSxNQUFNLE1BQU0sR0FBRyxJQUFJLEVBQUU7QUFFcEQsa0JBQU0sU0FBUyxLQUFLLGVBQWUsZ0JBQWdCO0FBQ25ELGdCQUFJLENBQUMsUUFBUTtBQUNULHFCQUFPO0FBQUEsZ0JBQ0gsU0FBUztBQUFBLGdCQUNULE9BQU87QUFBQSxnQkFDUCxVQUFVO0FBQUEsY0FDZDtBQUFBLFlBQ0o7QUFFQSxtQkFBTyxhQUFhLElBQUksVUFBVSxNQUFNO0FBRXhDLG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxTQUFTO0FBQUEsY0FDVCxVQUFVO0FBQUEsY0FDVixXQUFXO0FBQUEsWUFDZjtBQUFBLFVBQ0osT0FBTztBQUNILG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPLFlBQVksUUFBUSxRQUFRO0FBQUEsY0FDbkMsVUFBVTtBQUFBLFlBQ2Q7QUFBQSxVQUNKO0FBQUEsUUFDSixPQUFPO0FBQ0gsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELFlBQUksZ0JBQWdCLGdCQUFnQjtBQUNoQyxnQkFBTSxTQUFTLEtBQUssZUFBZSxnQkFBZ0I7QUFDbkQsY0FBSSxDQUFDLFFBQVE7QUFDVCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsT0FBTztBQUFBLGNBQ1AsVUFBVTtBQUFBLFlBQ2Q7QUFBQSxVQUNKO0FBRUEsZ0JBQU0sY0FBYyxnQkFBZ0IsZUFBZTtBQUNuRCxnQkFBTSxjQUFjLE9BQU8sUUFBUSxXQUFXO0FBRzlDLGNBQUksWUFBWTtBQUNoQixjQUFJLFVBQVU7QUFHZCxpQkFBTyxZQUFZLEdBQUc7QUFDbEIsa0JBQU0sV0FBVyxPQUFPLFFBQVEsWUFBWSxDQUFDO0FBQzdDLGdCQUFJLFNBQVMsS0FBSyxNQUFNLE1BQU0sU0FBUyxXQUFXLEdBQUcsR0FBRztBQUNwRDtBQUFBLFlBQ0o7QUFDQTtBQUFBLFVBQ0o7QUFHQSxnQkFBTSxZQUFZLE9BQU8sVUFBVTtBQUNuQyxpQkFBTyxVQUFVLFlBQVksR0FBRztBQUM1QixrQkFBTSxXQUFXLE9BQU8sUUFBUSxVQUFVLENBQUM7QUFDM0MsZ0JBQUksU0FBUyxLQUFLLE1BQU0sTUFBTSxTQUFTLFdBQVcsR0FBRyxHQUFHO0FBQ3BEO0FBQUEsWUFDSjtBQUNBO0FBQUEsVUFDSjtBQUdBLGdCQUFNLFdBQVcsRUFBRSxNQUFNLFdBQVcsSUFBSSxFQUFFO0FBQzFDLGdCQUFNLFNBQVMsRUFBRSxNQUFNLFVBQVUsR0FBRyxJQUFJLEVBQUU7QUFFMUMsaUJBQU8sYUFBYSxJQUFJLFVBQVUsTUFBTTtBQUV4QyxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsU0FBUztBQUFBLFlBQ1QsVUFBVTtBQUFBLFlBQ1YsV0FBVztBQUFBLFVBQ2Y7QUFBQSxRQUNKLE9BQU87QUFDSCxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZSxtQkFBbUIsRUFBRTtBQUFBLE1BRTFELEtBQUs7QUFFRCxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsU0FBMEIsY0FHeEM7QUFFRSxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxhQUFhLENBQUMsUUFBUSxVQUFVO0FBQ25ELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLE9BQU87QUFDMUIsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBRUEsV0FBTyxFQUFFLE9BQU8sS0FBSztBQUFBLEVBQ3pCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxlQUFlLGlCQUFrQyxjQUFpQztBQUM5RSxVQUFNLGNBQXdCLENBQUM7QUFFL0IsUUFBSSxjQUFjO0FBQ2Qsa0JBQVk7QUFBQSxRQUNSO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBQUEsSUFDSixPQUFPO0FBQ0gsa0JBQVk7QUFBQSxRQUNSO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUdBLFVBQUksZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQ3JDLHdCQUFnQixTQUFTLFFBQVEsYUFBVztBQUN4QyxzQkFBWSxLQUFLLGVBQWUsUUFBUSxJQUFJLFdBQVc7QUFBQSxRQUMzRCxDQUFDO0FBQUEsTUFDTDtBQUFBLElBQ0o7QUFFQSxXQUFPLFlBQVksTUFBTSxHQUFHLENBQUM7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxRQUFRLFNBS1g7QUFDQyxRQUFJO0FBQ0EsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFVBQUksQ0FBQyxpQkFBaUI7QUFDbEIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFFBQ1g7QUFBQSxNQUNKO0FBRUEsVUFBSSxrQkFBa0I7QUFDdEIsVUFBSSxjQUFjO0FBRWxCLGNBQVEsUUFBUSxRQUFRO0FBQUEsUUFDcEIsS0FBSztBQUNELGNBQUksZ0JBQWdCLGNBQWM7QUFDOUIsOEJBQWtCLGdCQUFnQjtBQUNsQywwQkFBYztBQUFBLFVBQ2xCLE9BQU87QUFDSCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsT0FBTztBQUFBLFlBQ1g7QUFBQSxVQUNKO0FBQ0E7QUFBQSxRQUVKLEtBQUs7QUFDRCxjQUFJLFFBQVEsVUFBVTtBQUNsQixrQkFBTSxVQUFVLE1BQU0sS0FBSyxlQUFlLFlBQVksUUFBUSxRQUFRO0FBQ3RFLGdCQUFJLFNBQVM7QUFDVCxnQ0FBa0IsR0FBRyxRQUFRLE9BQU87QUFBQTtBQUFBLEVBQU8sUUFBUSxPQUFPO0FBQzFELDRCQUFjLDJCQUEyQixRQUFRLFFBQVE7QUFBQSxZQUM3RCxPQUFPO0FBQ0gscUJBQU87QUFBQSxnQkFDSCxTQUFTO0FBQUEsZ0JBQ1QsT0FBTyxZQUFZLFFBQVEsUUFBUTtBQUFBLGNBQ3ZDO0FBQUEsWUFDSjtBQUFBLFVBQ0osT0FBTztBQUNILG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPO0FBQUEsWUFDWDtBQUFBLFVBQ0o7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELHdCQUFjO0FBRWQsY0FBSSxnQkFBZ0IsZ0JBQWdCO0FBQ2hDLGtCQUFNLFNBQVMsS0FBSyxlQUFlLGdCQUFnQjtBQUNuRCxnQkFBSSxRQUFRO0FBQ1Isb0JBQU0sY0FBYyxnQkFBZ0IsZUFBZTtBQUNuRCxrQkFBSSxpQkFBMkIsQ0FBQztBQUdoQyxrQkFBSSxZQUFZO0FBQ2hCLGtCQUFJLFVBQVU7QUFHZCxxQkFBTyxZQUFZLEdBQUc7QUFDbEIsc0JBQU0sV0FBVyxPQUFPLFFBQVEsWUFBWSxDQUFDO0FBQzdDLG9CQUFJLFNBQVMsS0FBSyxNQUFNLE1BQU0sU0FBUyxXQUFXLEdBQUcsR0FBRztBQUNwRDtBQUFBLGdCQUNKO0FBQ0E7QUFBQSxjQUNKO0FBR0Esb0JBQU0sWUFBWSxPQUFPLFVBQVU7QUFDbkMscUJBQU8sVUFBVSxZQUFZLEdBQUc7QUFDNUIsc0JBQU0sV0FBVyxPQUFPLFFBQVEsVUFBVSxDQUFDO0FBQzNDLG9CQUFJLFNBQVMsS0FBSyxNQUFNLE1BQU0sU0FBUyxXQUFXLEdBQUcsR0FBRztBQUNwRDtBQUFBLGdCQUNKO0FBQ0E7QUFBQSxjQUNKO0FBR0EsdUJBQVMsSUFBSSxXQUFXLEtBQUssU0FBUyxLQUFLO0FBQ3ZDLCtCQUFlLEtBQUssT0FBTyxRQUFRLENBQUMsQ0FBQztBQUFBLGNBQ3pDO0FBQ0EsZ0NBQWtCLGVBQWUsS0FBSyxJQUFJO0FBQUEsWUFDOUM7QUFBQSxVQUNKO0FBQ0E7QUFBQSxRQUVKLEtBQUs7QUFDRCw0QkFBa0IsZ0JBQWdCO0FBQ2xDLHdCQUFjO0FBQ2Q7QUFBQSxRQUVKLEtBQUs7QUFDRCxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFVBQ1g7QUFBQSxRQUVKO0FBQ0ksaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxVQUNYO0FBQUEsTUFDUjtBQUVBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULGlCQUFpQixnQkFBZ0IsU0FBUyxNQUN0QyxnQkFBZ0IsVUFBVSxHQUFHLEdBQUcsSUFBSSxRQUNwQztBQUFBLE1BQ1I7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDcEQ7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esb0JBQW9CLGlCQUErRDtBQUMvRSxVQUFNLFVBQXVDLENBQUMsYUFBYSxVQUFVO0FBRXJFLFFBQUksZ0JBQWdCLGNBQWM7QUFDOUIsY0FBUSxRQUFRLFdBQVc7QUFBQSxJQUMvQjtBQUVBLFFBQUksZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQ3JDLGNBQVEsT0FBTyxJQUFJLEdBQUcsU0FBUztBQUFBLElBQ25DO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sY0FBYyxTQUlqQjtBQUNDLFVBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxRQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGFBQU87QUFBQSxRQUNILG9CQUFvQjtBQUFBLFFBQ3BCLGVBQWU7QUFBQSxRQUNmLGtCQUFrQjtBQUFBLE1BQ3RCO0FBQUEsSUFDSjtBQUVBLFFBQUkscUJBQXFCO0FBQ3pCLFFBQUksZ0JBQWdCO0FBQ3BCLFFBQUksbUJBQW1CO0FBRXZCLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsK0JBQXFCLGdCQUFnQixhQUFhO0FBQ2xELDBCQUFnQixnQkFBZ0IsYUFBYSxNQUFNLElBQUksRUFBRTtBQUN6RCw2QkFBbUI7QUFBQSxRQUN2QjtBQUNBO0FBQUEsTUFFSixLQUFLO0FBQ0QsWUFBSSxRQUFRLFVBQVU7QUFDbEIsZ0JBQU0sVUFBVSxNQUFNLEtBQUssZUFBZSxZQUFZLFFBQVEsUUFBUTtBQUN0RSxjQUFJLFNBQVM7QUFDVCxpQ0FBcUIsUUFBUSxRQUFRLFNBQVMsUUFBUSxRQUFRO0FBQzlELDRCQUFnQixRQUFRLE1BQU0sTUFBTSxRQUFRLE1BQU0sUUFBUTtBQUMxRCwrQkFBbUIsSUFBSSxRQUFRLFFBQVE7QUFBQSxVQUMzQztBQUFBLFFBQ0o7QUFDQTtBQUFBLE1BRUosS0FBSztBQUVELDZCQUFxQjtBQUNyQix3QkFBZ0I7QUFDaEIsMkJBQW1CO0FBQ25CO0FBQUEsTUFFSixLQUFLO0FBQ0QsNkJBQXFCLGdCQUFnQixRQUFRO0FBQzdDLHdCQUFnQixnQkFBZ0IsUUFBUSxNQUFNLElBQUksRUFBRTtBQUNwRCwyQkFBbUI7QUFDbkI7QUFBQSxNQUVKLEtBQUs7QUFDRCw2QkFBcUI7QUFDckIsd0JBQWdCO0FBQ2hCLDJCQUFtQjtBQUNuQjtBQUFBLElBQ1I7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDN2dCTyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFDeEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBK0M7QUFDekQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxLQUFLLGdCQUFnQixTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsWUFBWTtBQUMvRSxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sbUJBQW1CLEtBQUssZUFBZSxlQUFlQSxPQUFNO0FBQ2xFLFVBQUksQ0FBQyxpQkFBaUIsT0FBTztBQUN6QixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixpQkFBaUIsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ3RFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFFQSxjQUFNLEtBQUssZUFBZSxlQUFlLFFBQVEsYUFBYSxPQUFPO0FBRXJFLGNBQU0sbUJBQW1CLE1BQU0sS0FBSyxnQkFBZ0I7QUFBQSxVQUNoREEsUUFBTztBQUFBLFVBQ1A7QUFBQSxZQUNJLGNBQWNBLFFBQU87QUFBQSxZQUNyQixhQUFhO0FBQUE7QUFBQSxZQUNiLFdBQVdBLFFBQU8sT0FBTztBQUFBLFVBQzdCO0FBQUEsUUFDSjtBQUVBLFlBQUksQ0FBQyxvQkFBb0IsaUJBQWlCLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDM0QsZ0JBQU1DLFVBQVM7QUFBQSxZQUNYLFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBR0EsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQix3Q0FBd0NBLE9BQU07QUFDNUYsaUJBQU9BO0FBQUEsUUFDWDtBQUdBLGNBQU0sU0FBUyxNQUFNLEtBQUssdUJBQXVCLFNBQVMsaUJBQWlCLGdCQUFnQjtBQUczRixZQUFJLENBQUMsT0FBTyxTQUFTO0FBQ2pCLGdCQUFNLEtBQUssZUFBZSxvQkFBb0IsNkJBQTZCLE1BQU07QUFBQSxRQUNyRjtBQUVBLGVBQU87QUFBQSxNQUVYLFNBQVMsT0FBTztBQUNaLGNBQU0sU0FBUztBQUFBLFVBQ1gsU0FBUztBQUFBLFVBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxVQUNoRCxVQUFVO0FBQUEsUUFDZDtBQUdBLGNBQU0sS0FBSyxlQUFlO0FBQUEsVUFDdEIsVUFBVSxPQUFPLEtBQUs7QUFBQSxVQUN0QjtBQUFBLFFBQ0o7QUFFQSxlQUFPO0FBQUEsTUFDWDtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUNWLFNBQ0EsaUJBQ0Esa0JBQ21CO0FBQ25CLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBQ0QsWUFBSSxRQUFRLFVBQVU7QUFDbEIsZ0JBQU0sVUFBVSxNQUFNLEtBQUssZUFBZSxZQUFZLFFBQVEsUUFBUTtBQUN0RSxjQUFJLFNBQVM7QUFFVCxrQkFBTSxvQkFBb0IsR0FBRyxRQUFRLE9BQU87QUFBQTtBQUFBLEVBQU8sZ0JBQWdCO0FBRW5FLGtCQUFNLFdBQVcsRUFBRSxNQUFNLFFBQVEsTUFBTSxPQUFPLElBQUksRUFBRTtBQUNwRCxrQkFBTSxTQUFTLEVBQUUsTUFBTSxRQUFRLE1BQU0sTUFBTSxHQUFHLElBQUksRUFBRTtBQUVwRCxrQkFBTSxTQUFTLEtBQUssZUFBZSxnQkFBZ0I7QUFDbkQsZ0JBQUksQ0FBQyxRQUFRO0FBQ1QscUJBQU87QUFBQSxnQkFDSCxTQUFTO0FBQUEsZ0JBQ1QsT0FBTztBQUFBLGdCQUNQLFVBQVU7QUFBQSxjQUNkO0FBQUEsWUFDSjtBQUVBLG1CQUFPLGFBQWEsbUJBQW1CLFVBQVUsTUFBTTtBQUV2RCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsU0FBUztBQUFBLGNBQ1QsVUFBVTtBQUFBLGNBQ1YsV0FBVztBQUFBLFlBQ2Y7QUFBQSxVQUNKLE9BQU87QUFDSCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsT0FBTyxZQUFZLFFBQVEsUUFBUTtBQUFBLGNBQ25DLFVBQVU7QUFBQSxZQUNkO0FBQUEsVUFDSjtBQUFBLFFBQ0o7QUFBQTtBQUFBLE1BR0osS0FBSztBQUVELFlBQUksZ0JBQWdCLGdCQUFnQjtBQUNoQyxnQkFBTSxTQUFTLEtBQUssZUFBZSxnQkFBZ0I7QUFDbkQsY0FBSSxDQUFDLFFBQVE7QUFDVCxtQkFBTztBQUFBLGNBQ0gsU0FBUztBQUFBLGNBQ1QsT0FBTztBQUFBLGNBQ1AsVUFBVTtBQUFBLFlBQ2Q7QUFBQSxVQUNKO0FBRUEsZ0JBQU0sY0FBYyxnQkFBZ0IsZUFBZTtBQUduRCxjQUFJLFlBQVk7QUFDaEIsY0FBSSxVQUFVO0FBR2QsaUJBQU8sWUFBWSxHQUFHO0FBQ2xCLGtCQUFNLFdBQVcsT0FBTyxRQUFRLFlBQVksQ0FBQztBQUM3QyxnQkFBSSxTQUFTLEtBQUssTUFBTSxNQUFNLFNBQVMsV0FBVyxHQUFHLEdBQUc7QUFDcEQ7QUFBQSxZQUNKO0FBQ0E7QUFBQSxVQUNKO0FBR0EsZ0JBQU0sWUFBWSxPQUFPLFVBQVU7QUFDbkMsaUJBQU8sVUFBVSxZQUFZLEdBQUc7QUFDNUIsa0JBQU0sV0FBVyxPQUFPLFFBQVEsVUFBVSxDQUFDO0FBQzNDLGdCQUFJLFNBQVMsS0FBSyxNQUFNLE1BQU0sU0FBUyxXQUFXLEdBQUcsR0FBRztBQUNwRDtBQUFBLFlBQ0o7QUFDQTtBQUFBLFVBQ0o7QUFHQSxnQkFBTSxXQUFXLEVBQUUsTUFBTSxXQUFXLElBQUksRUFBRTtBQUMxQyxnQkFBTSxTQUFTLEVBQUUsTUFBTSxTQUFTLElBQUksT0FBTyxRQUFRLE9BQU8sRUFBRSxPQUFPO0FBRW5FLGlCQUFPLGFBQWEsa0JBQWtCLFVBQVUsTUFBTTtBQUV0RCxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsU0FBUztBQUFBLFlBQ1QsVUFBVTtBQUFBLFlBQ1YsV0FBVztBQUFBLFVBQ2Y7QUFBQSxRQUNKLE9BQU87QUFDSCxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBQ0QsZUFBTyxNQUFNLEtBQUssZUFBZSxtQkFBbUIsZ0JBQWdCO0FBQUEsTUFFeEUsS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSjtBQUNJLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsSUFDUjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGdCQUFnQixTQUEwQixjQUd4QztBQUVFLFFBQUksUUFBUSxXQUFXLGVBQWUsQ0FBQyxjQUFjO0FBQ2pELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLGFBQWEsUUFBUSxXQUFXLGFBQWEsUUFBUSxVQUFVO0FBRWxGLGFBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxJQUN6QjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZUFBZSxpQkFBa0MsY0FBaUM7QUFDOUUsVUFBTSxjQUF3QixDQUFDO0FBRS9CLFFBQUksY0FBYztBQUNkLGtCQUFZO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0o7QUFBQSxJQUNKLE9BQU87QUFDSCxrQkFBWTtBQUFBLFFBQ1I7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBR0EsVUFBSSxnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDckMsd0JBQWdCLFNBQVMsUUFBUSxhQUFXO0FBQ3hDLHNCQUFZLEtBQUsscUJBQXFCLFFBQVEsSUFBSSxXQUFXO0FBQUEsUUFDakUsQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBRUEsV0FBTyxZQUFZLE1BQU0sR0FBRyxFQUFFO0FBQUEsRUFDbEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sUUFBUSxTQU1YO0FBQ0MsUUFBSTtBQUNBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxRQUNYO0FBQUEsTUFDSjtBQUVBLFVBQUksa0JBQWtCO0FBQ3RCLFVBQUksY0FBYztBQUNsQixZQUFNLGtCQUE0QixDQUFDO0FBRW5DLGNBQVEsUUFBUSxRQUFRO0FBQUEsUUFDcEIsS0FBSztBQUNELGNBQUksZ0JBQWdCLGNBQWM7QUFDOUIsOEJBQWtCLGdCQUFnQjtBQUNsQywwQkFBYztBQUdkLDRCQUFnQixLQUFLLEdBQUcsS0FBSyxzQkFBc0IsZUFBZSxDQUFDO0FBQUEsVUFDdkUsT0FBTztBQUNILG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPO0FBQUEsWUFDWDtBQUFBLFVBQ0o7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELGNBQUksUUFBUSxVQUFVO0FBQ2xCLGtCQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsWUFBWSxRQUFRLFFBQVE7QUFDdEUsZ0JBQUksU0FBUztBQUNULGdDQUFrQixRQUFRO0FBQzFCLDRCQUFjLDhCQUE4QixRQUFRLFFBQVE7QUFDNUQsOEJBQWdCLEtBQUssR0FBRyxLQUFLLHNCQUFzQixlQUFlLENBQUM7QUFBQSxZQUN2RSxPQUFPO0FBQ0gscUJBQU87QUFBQSxnQkFDSCxTQUFTO0FBQUEsZ0JBQ1QsT0FBTyxZQUFZLFFBQVEsUUFBUTtBQUFBLGNBQ3ZDO0FBQUEsWUFDSjtBQUFBLFVBQ0osT0FBTztBQUNILDBCQUFjO0FBQUEsVUFDbEI7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELHdCQUFjO0FBRWQsY0FBSSxnQkFBZ0IsZ0JBQWdCO0FBQ2hDLGtCQUFNLFNBQVMsS0FBSyxlQUFlLGdCQUFnQjtBQUNuRCxnQkFBSSxRQUFRO0FBQ1Isb0JBQU0sY0FBYyxnQkFBZ0IsZUFBZTtBQUNuRCxrQkFBSSxpQkFBMkIsQ0FBQztBQUdoQyxrQkFBSSxZQUFZO0FBQ2hCLGtCQUFJLFVBQVU7QUFHZCxxQkFBTyxZQUFZLEdBQUc7QUFDbEIsc0JBQU0sV0FBVyxPQUFPLFFBQVEsWUFBWSxDQUFDO0FBQzdDLG9CQUFJLFNBQVMsS0FBSyxNQUFNLE1BQU0sU0FBUyxXQUFXLEdBQUcsR0FBRztBQUNwRDtBQUFBLGdCQUNKO0FBQ0E7QUFBQSxjQUNKO0FBR0Esb0JBQU0sWUFBWSxPQUFPLFVBQVU7QUFDbkMscUJBQU8sVUFBVSxZQUFZLEdBQUc7QUFDNUIsc0JBQU0sV0FBVyxPQUFPLFFBQVEsVUFBVSxDQUFDO0FBQzNDLG9CQUFJLFNBQVMsS0FBSyxNQUFNLE1BQU0sU0FBUyxXQUFXLEdBQUcsR0FBRztBQUNwRDtBQUFBLGdCQUNKO0FBQ0E7QUFBQSxjQUNKO0FBR0EsdUJBQVMsSUFBSSxXQUFXLEtBQUssU0FBUyxLQUFLO0FBQ3ZDLCtCQUFlLEtBQUssT0FBTyxRQUFRLENBQUMsQ0FBQztBQUFBLGNBQ3pDO0FBQ0EsZ0NBQWtCLGVBQWUsS0FBSyxJQUFJO0FBQzFDLDhCQUFnQixLQUFLLEdBQUcsS0FBSyxzQkFBc0IsZUFBZSxDQUFDO0FBQUEsWUFDdkU7QUFBQSxVQUNKO0FBQ0E7QUFBQSxRQUVKLEtBQUs7QUFDRCw0QkFBa0IsZ0JBQWdCO0FBQ2xDLHdCQUFjO0FBQ2QsMEJBQWdCLEtBQUssR0FBRyxLQUFLLHNCQUFzQixlQUFlLENBQUM7QUFDbkU7QUFBQSxRQUVKLEtBQUs7QUFDRCx3QkFBYztBQUNkO0FBQUEsUUFFSjtBQUNJLGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsVUFDWDtBQUFBLE1BQ1I7QUFFQSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxpQkFBaUIsZ0JBQWdCLFNBQVMsTUFDdEMsZ0JBQWdCLFVBQVUsR0FBRyxHQUFHLElBQUksUUFDcEM7QUFBQSxRQUNKLGlCQUFpQixnQkFBZ0IsTUFBTSxHQUFHLENBQUM7QUFBQTtBQUFBLE1BQy9DO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ3BEO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHNCQUFzQixNQUF3QjtBQUNsRCxVQUFNLFNBQW1CLENBQUM7QUFHMUIsVUFBTSxXQUFXO0FBQUEsTUFDYixFQUFFLFNBQVMsV0FBVyxPQUFPLHNDQUFzQztBQUFBLE1BQ25FLEVBQUUsU0FBUyxlQUFlLE9BQU8sNENBQTRDO0FBQUEsTUFDN0UsRUFBRSxTQUFTLFdBQVcsT0FBTywyQkFBMkI7QUFBQSxNQUN4RCxFQUFFLFNBQVMsY0FBYyxPQUFPLDZCQUE2QjtBQUFBLE1BQzdELEVBQUUsU0FBUyxnQkFBZ0IsT0FBTywyQkFBMkI7QUFBQSxNQUM3RCxFQUFFLFNBQVMsWUFBWSxPQUFPLGtDQUFrQztBQUFBLE1BQ2hFLEVBQUUsU0FBUyxhQUFhLE9BQU8scUNBQXFDO0FBQUEsTUFDcEUsRUFBRSxTQUFTLG1CQUFtQixPQUFPLGtCQUFrQjtBQUFBLE1BQ3ZELEVBQUUsU0FBUyxtQkFBbUIsT0FBTyxrQkFBa0I7QUFBQSxNQUN2RCxFQUFFLFNBQVMsaUJBQWlCLE9BQU8saUJBQWlCO0FBQUEsSUFDeEQ7QUFFQSxhQUFTLFFBQVEsQ0FBQyxFQUFFLFNBQVMsTUFBTSxNQUFNO0FBQ3JDLFVBQUksUUFBUSxLQUFLLElBQUksR0FBRztBQUNwQixlQUFPLEtBQUssS0FBSztBQUFBLE1BQ3JCO0FBQUEsSUFDSixDQUFDO0FBRUQsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUFvQixpQkFBK0Q7QUFDL0UsVUFBTSxVQUF1QyxDQUFDLGFBQWEsWUFBWSxLQUFLO0FBRTVFLFFBQUksZ0JBQWdCLGNBQWM7QUFDOUIsY0FBUSxRQUFRLFdBQVc7QUFBQSxJQUMvQjtBQUVBLFFBQUksZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQ3JDLGNBQVEsT0FBTyxJQUFJLEdBQUcsU0FBUztBQUFBLElBQ25DO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sY0FBYyxTQUtqQjtBQUNDLFVBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxRQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGFBQU87QUFBQSxRQUNILG9CQUFvQjtBQUFBLFFBQ3BCLGVBQWU7QUFBQSxRQUNmLGtCQUFrQjtBQUFBLFFBQ2xCLGlCQUFpQjtBQUFBLE1BQ3JCO0FBQUEsSUFDSjtBQUVBLFFBQUkscUJBQXFCO0FBQ3pCLFFBQUksZ0JBQWdCO0FBQ3BCLFFBQUksbUJBQW1CO0FBQ3ZCLFFBQUksbUJBQW1CO0FBRXZCLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsK0JBQXFCLGdCQUFnQixhQUFhO0FBQ2xELDBCQUFnQixnQkFBZ0IsYUFBYSxNQUFNLElBQUksRUFBRTtBQUN6RCw2QkFBbUI7QUFDbkIsNkJBQW1CLGdCQUFnQjtBQUFBLFFBQ3ZDO0FBQ0E7QUFBQSxNQUVKLEtBQUs7QUFDRCxZQUFJLFFBQVEsVUFBVTtBQUNsQixnQkFBTSxVQUFVLE1BQU0sS0FBSyxlQUFlLFlBQVksUUFBUSxRQUFRO0FBQ3RFLGNBQUksU0FBUztBQUNULGlDQUFxQixRQUFRLFFBQVE7QUFDckMsNEJBQWdCLFFBQVEsTUFBTSxNQUFNLFFBQVEsTUFBTTtBQUNsRCwrQkFBbUIsSUFBSSxRQUFRLFFBQVE7QUFDdkMsK0JBQW1CLFFBQVE7QUFBQSxVQUMvQjtBQUFBLFFBQ0o7QUFDQTtBQUFBLE1BRUosS0FBSztBQUVELDZCQUFxQjtBQUNyQix3QkFBZ0I7QUFDaEIsMkJBQW1CO0FBRW5CLFlBQUksZ0JBQWdCLGtCQUFrQjtBQUNsQyw2QkFBbUIsZ0JBQWdCLGlCQUFpQixPQUFPLEtBQUssSUFBSSxJQUNwRCxPQUFPLGdCQUFnQixpQkFBaUIsTUFBTSxLQUFLLElBQUk7QUFBQSxRQUMzRTtBQUNBO0FBQUEsTUFFSixLQUFLO0FBQ0QsNkJBQXFCLGdCQUFnQixRQUFRO0FBQzdDLHdCQUFnQixnQkFBZ0IsUUFBUSxNQUFNLElBQUksRUFBRTtBQUNwRCwyQkFBbUI7QUFDbkIsMkJBQW1CLGdCQUFnQjtBQUNuQztBQUFBLE1BRUosS0FBSztBQUNELDZCQUFxQjtBQUNyQix3QkFBZ0I7QUFDaEIsMkJBQW1CO0FBQ25CO0FBQUEsSUFDUjtBQUdBLFVBQU0sa0JBQWtCLEtBQUssc0JBQXNCLGdCQUFnQixFQUFFO0FBRXJFLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDeGpCTyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFDeEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBK0M7QUFDekQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxLQUFLLGdCQUFnQixTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsWUFBWTtBQUMvRSxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sbUJBQW1CLEtBQUssZUFBZSxlQUFlQSxPQUFNO0FBQ2xFLFVBQUksQ0FBQyxpQkFBaUIsT0FBTztBQUN6QixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixpQkFBaUIsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ3RFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFFQSxjQUFNLEtBQUssZUFBZSxlQUFlLFFBQVEsYUFBYSxPQUFPO0FBRXJFLGNBQU0sbUJBQW1CLE1BQU0sS0FBSyxnQkFBZ0I7QUFBQSxVQUNoREEsUUFBTztBQUFBLFVBQ1A7QUFBQSxZQUNJLGNBQWNBLFFBQU87QUFBQSxZQUNyQixhQUFhQSxRQUFPLE9BQU87QUFBQSxZQUMzQixXQUFXQSxRQUFPLE9BQU87QUFBQSxVQUM3QjtBQUFBLFFBQ0o7QUFFQSxZQUFJLENBQUMsb0JBQW9CLGlCQUFpQixLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQzNELGdCQUFNQyxVQUFTO0FBQUEsWUFDWCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUdBLGdCQUFNLEtBQUssZUFBZSxvQkFBb0Isd0NBQXdDQSxPQUFNO0FBQzVGLGlCQUFPQTtBQUFBLFFBQ1g7QUFHQSxjQUFNLFNBQVMsTUFBTSxLQUFLLGFBQWEsU0FBUyxpQkFBaUIsZ0JBQWdCO0FBR2pGLFlBQUksQ0FBQyxPQUFPLFNBQVM7QUFDakIsZ0JBQU0sS0FBSyxlQUFlLG9CQUFvQiw2QkFBNkIsTUFBTTtBQUFBLFFBQ3JGO0FBRUEsZUFBTztBQUFBLE1BRVgsU0FBUyxPQUFPO0FBQ1osY0FBTSxTQUFTO0FBQUEsVUFDWCxTQUFTO0FBQUEsVUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBR0EsY0FBTSxLQUFLLGVBQWU7QUFBQSxVQUN0QixVQUFVLE9BQU8sS0FBSztBQUFBLFVBQ3RCO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsYUFDVixTQUNBLGlCQUNBLGtCQUNtQjtBQUNuQixZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUNELFlBQUksUUFBUSxVQUFVO0FBQ2xCLGdCQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsWUFBWSxRQUFRLFFBQVE7QUFDdEUsY0FBSSxTQUFTO0FBRVQsa0JBQU0sb0JBQW9CLEdBQUcsUUFBUSxPQUFPO0FBQUE7QUFBQSxFQUFPLGdCQUFnQjtBQUVuRSxrQkFBTSxXQUFXLEVBQUUsTUFBTSxRQUFRLE1BQU0sT0FBTyxJQUFJLEVBQUU7QUFDcEQsa0JBQU0sU0FBUyxFQUFFLE1BQU0sUUFBUSxNQUFNLE1BQU0sR0FBRyxJQUFJLEVBQUU7QUFFcEQsa0JBQU0sU0FBUyxLQUFLLGVBQWUsZ0JBQWdCO0FBQ25ELGdCQUFJLENBQUMsUUFBUTtBQUNULHFCQUFPO0FBQUEsZ0JBQ0gsU0FBUztBQUFBLGdCQUNULE9BQU87QUFBQSxnQkFDUCxVQUFVO0FBQUEsY0FDZDtBQUFBLFlBQ0o7QUFFQSxtQkFBTyxhQUFhLG1CQUFtQixVQUFVLE1BQU07QUFFdkQsbUJBQU87QUFBQSxjQUNILFNBQVM7QUFBQSxjQUNULFNBQVM7QUFBQSxjQUNULFVBQVU7QUFBQSxjQUNWLFdBQVc7QUFBQSxZQUNmO0FBQUEsVUFDSixPQUFPO0FBQ0gsbUJBQU87QUFBQSxjQUNILFNBQVM7QUFBQSxjQUNULE9BQU8sWUFBWSxRQUFRLFFBQVE7QUFBQSxjQUNuQyxVQUFVO0FBQUEsWUFDZDtBQUFBLFVBQ0o7QUFBQSxRQUNKO0FBQUE7QUFBQSxNQUdKLEtBQUs7QUFFRCxZQUFJLGdCQUFnQixnQkFBZ0I7QUFDaEMsZ0JBQU0sU0FBUyxLQUFLLGVBQWUsZ0JBQWdCO0FBQ25ELGNBQUksQ0FBQyxRQUFRO0FBQ1QsbUJBQU87QUFBQSxjQUNILFNBQVM7QUFBQSxjQUNULE9BQU87QUFBQSxjQUNQLFVBQVU7QUFBQSxZQUNkO0FBQUEsVUFDSjtBQUVBLGdCQUFNLGNBQWMsZ0JBQWdCLGVBQWU7QUFHbkQsY0FBSSxZQUFZO0FBQ2hCLGNBQUksVUFBVTtBQUdkLGlCQUFPLFlBQVksR0FBRztBQUNsQixrQkFBTSxXQUFXLE9BQU8sUUFBUSxZQUFZLENBQUM7QUFDN0MsZ0JBQUksU0FBUyxLQUFLLE1BQU0sTUFBTSxTQUFTLFdBQVcsR0FBRyxHQUFHO0FBQ3BEO0FBQUEsWUFDSjtBQUNBO0FBQUEsVUFDSjtBQUdBLGdCQUFNLFlBQVksT0FBTyxVQUFVO0FBQ25DLGlCQUFPLFVBQVUsWUFBWSxHQUFHO0FBQzVCLGtCQUFNLFdBQVcsT0FBTyxRQUFRLFVBQVUsQ0FBQztBQUMzQyxnQkFBSSxTQUFTLEtBQUssTUFBTSxNQUFNLFNBQVMsV0FBVyxHQUFHLEdBQUc7QUFDcEQ7QUFBQSxZQUNKO0FBQ0E7QUFBQSxVQUNKO0FBR0EsZ0JBQU0sV0FBVyxFQUFFLE1BQU0sV0FBVyxJQUFJLEVBQUU7QUFDMUMsZ0JBQU0sU0FBUyxFQUFFLE1BQU0sU0FBUyxJQUFJLE9BQU8sUUFBUSxPQUFPLEVBQUUsT0FBTztBQUVuRSxpQkFBTyxhQUFhLGtCQUFrQixVQUFVLE1BQU07QUFFdEQsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULFNBQVM7QUFBQSxZQUNULFVBQVU7QUFBQSxZQUNWLFdBQVc7QUFBQSxVQUNmO0FBQUEsUUFDSixPQUFPO0FBQ0gsaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUNELGVBQU8sTUFBTSxLQUFLLGVBQWUsbUJBQW1CLGdCQUFnQjtBQUFBLE1BRXhFLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsU0FBMEIsY0FHeEM7QUFFRSxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxhQUFhLFFBQVEsV0FBVyxhQUFhLFFBQVEsVUFBVTtBQUVsRixhQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsSUFDekI7QUFFQSxXQUFPLEVBQUUsT0FBTyxLQUFLO0FBQUEsRUFDekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGVBQWUsaUJBQWtDLGNBQWlDO0FBQzlFLFVBQU0sY0FBd0IsQ0FBQztBQUUvQixRQUFJLGNBQWM7QUFDZCxrQkFBWTtBQUFBLFFBQ1I7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0o7QUFBQSxJQUNKLE9BQU87QUFDSCxrQkFBWTtBQUFBLFFBQ1I7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBR0EsVUFBSSxnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDckMsd0JBQWdCLFNBQVMsUUFBUSxhQUFXO0FBQ3hDLHNCQUFZLEtBQUssZ0JBQWdCLFFBQVEsSUFBSSxXQUFXO0FBQUEsUUFDNUQsQ0FBQztBQUFBLE1BQ0w7QUFBQSxJQUNKO0FBRUEsV0FBTyxZQUFZLE1BQU0sR0FBRyxFQUFFO0FBQUEsRUFDbEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sUUFBUSxTQU1YO0FBQ0MsUUFBSTtBQUNBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxRQUNYO0FBQUEsTUFDSjtBQUVBLFVBQUksa0JBQWtCO0FBQ3RCLFVBQUksY0FBYztBQUNsQixZQUFNLGVBQWUsS0FBSyxrQkFBa0IsUUFBUSxXQUFXO0FBRS9ELGNBQVEsUUFBUSxRQUFRO0FBQUEsUUFDcEIsS0FBSztBQUNELGNBQUksZ0JBQWdCLGNBQWM7QUFDOUIsOEJBQWtCLGdCQUFnQjtBQUNsQywwQkFBYztBQUNkLGdCQUFJLGNBQWM7QUFDZCw2QkFBZSxLQUFLLFlBQVk7QUFBQSxZQUNwQztBQUFBLFVBQ0osT0FBTztBQUNILG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPO0FBQUEsWUFDWDtBQUFBLFVBQ0o7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELGNBQUksUUFBUSxVQUFVO0FBQ2xCLGtCQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsWUFBWSxRQUFRLFFBQVE7QUFDdEUsZ0JBQUksU0FBUztBQUNULGdDQUFrQixRQUFRO0FBQzFCLDRCQUFjLHFCQUFxQixRQUFRLFFBQVE7QUFDbkQsa0JBQUksY0FBYztBQUNkLCtCQUFlLEtBQUssWUFBWTtBQUFBLGNBQ3BDO0FBQUEsWUFDSixPQUFPO0FBQ0gscUJBQU87QUFBQSxnQkFDSCxTQUFTO0FBQUEsZ0JBQ1QsT0FBTyxZQUFZLFFBQVEsUUFBUTtBQUFBLGNBQ3ZDO0FBQUEsWUFDSjtBQUFBLFVBQ0osT0FBTztBQUNILDBCQUFjO0FBQUEsVUFDbEI7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELHdCQUFjO0FBQ2QsY0FBSSxjQUFjO0FBQ2QsMkJBQWUsS0FBSyxZQUFZO0FBQUEsVUFDcEM7QUFFQSxjQUFJLGdCQUFnQixnQkFBZ0I7QUFDaEMsa0JBQU0sU0FBUyxLQUFLLGVBQWUsZ0JBQWdCO0FBQ25ELGdCQUFJLFFBQVE7QUFDUixvQkFBTSxjQUFjLGdCQUFnQixlQUFlO0FBQ25ELGtCQUFJLGlCQUEyQixDQUFDO0FBR2hDLGtCQUFJLFlBQVk7QUFDaEIsa0JBQUksVUFBVTtBQUdkLHFCQUFPLFlBQVksR0FBRztBQUNsQixzQkFBTSxXQUFXLE9BQU8sUUFBUSxZQUFZLENBQUM7QUFDN0Msb0JBQUksU0FBUyxLQUFLLE1BQU0sTUFBTSxTQUFTLFdBQVcsR0FBRyxHQUFHO0FBQ3BEO0FBQUEsZ0JBQ0o7QUFDQTtBQUFBLGNBQ0o7QUFHQSxvQkFBTSxZQUFZLE9BQU8sVUFBVTtBQUNuQyxxQkFBTyxVQUFVLFlBQVksR0FBRztBQUM1QixzQkFBTSxXQUFXLE9BQU8sUUFBUSxVQUFVLENBQUM7QUFDM0Msb0JBQUksU0FBUyxLQUFLLE1BQU0sTUFBTSxTQUFTLFdBQVcsR0FBRyxHQUFHO0FBQ3BEO0FBQUEsZ0JBQ0o7QUFDQTtBQUFBLGNBQ0o7QUFHQSx1QkFBUyxJQUFJLFdBQVcsS0FBSyxTQUFTLEtBQUs7QUFDdkMsK0JBQWUsS0FBSyxPQUFPLFFBQVEsQ0FBQyxDQUFDO0FBQUEsY0FDekM7QUFDQSxnQ0FBa0IsZUFBZSxLQUFLLElBQUk7QUFBQSxZQUM5QztBQUFBLFVBQ0o7QUFDQTtBQUFBLFFBRUosS0FBSztBQUNELDRCQUFrQixnQkFBZ0I7QUFDbEMsd0JBQWM7QUFDZCxjQUFJLGNBQWM7QUFDZCwyQkFBZSxLQUFLLFlBQVk7QUFBQSxVQUNwQztBQUNBO0FBQUEsUUFFSixLQUFLO0FBQ0Qsd0JBQWM7QUFDZCxjQUFJLGNBQWM7QUFDZCwyQkFBZSxLQUFLLFlBQVk7QUFBQSxVQUNwQztBQUNBO0FBQUEsUUFFSjtBQUNJLGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsVUFDWDtBQUFBLE1BQ1I7QUFFQSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxpQkFBaUIsZ0JBQWdCLFNBQVMsTUFDdEMsZ0JBQWdCLFVBQVUsR0FBRyxHQUFHLElBQUksUUFDcEM7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNwRDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxrQkFBa0IsYUFBNkI7QUFDbkQsVUFBTSxtQkFBbUIsWUFBWSxZQUFZO0FBRWpELFFBQUksaUJBQWlCLFNBQVMsUUFBUSxFQUFHLFFBQU87QUFDaEQsUUFBSSxpQkFBaUIsU0FBUyxRQUFRLEtBQUssaUJBQWlCLFNBQVMsVUFBVSxFQUFHLFFBQU87QUFDekYsUUFBSSxpQkFBaUIsU0FBUyxTQUFTLEtBQUssaUJBQWlCLFNBQVMsU0FBUyxFQUFHLFFBQU87QUFDekYsUUFBSSxpQkFBaUIsU0FBUyxRQUFRLEtBQUssaUJBQWlCLFNBQVMsUUFBUSxFQUFHLFFBQU87QUFDdkYsUUFBSSxpQkFBaUIsU0FBUyxRQUFRLEtBQUssaUJBQWlCLFNBQVMsVUFBVSxFQUFHLFFBQU87QUFDekYsUUFBSSxpQkFBaUIsU0FBUyxVQUFVLEtBQUssaUJBQWlCLFNBQVMsYUFBYSxFQUFHLFFBQU87QUFDOUYsUUFBSSxpQkFBaUIsU0FBUyxjQUFjLEVBQUcsUUFBTztBQUN0RCxRQUFJLGlCQUFpQixTQUFTLFFBQVEsS0FBSyxpQkFBaUIsU0FBUyxNQUFNLEVBQUcsUUFBTztBQUNyRixRQUFJLGlCQUFpQixTQUFTLFdBQVcsS0FBSyxpQkFBaUIsU0FBUyxPQUFPLEVBQUcsUUFBTztBQUN6RixRQUFJLGlCQUFpQixTQUFTLFdBQVcsRUFBRyxRQUFPO0FBQ25ELFFBQUksaUJBQWlCLFNBQVMsVUFBVSxFQUFHLFFBQU87QUFFbEQsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUFvQixpQkFBK0Q7QUFDL0UsVUFBTSxVQUF1QyxDQUFDLGFBQWEsWUFBWSxLQUFLO0FBRTVFLFFBQUksZ0JBQWdCLGNBQWM7QUFDOUIsY0FBUSxRQUFRLFdBQVc7QUFBQSxJQUMvQjtBQUVBLFFBQUksZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQ3JDLGNBQVEsT0FBTyxJQUFJLEdBQUcsU0FBUztBQUFBLElBQ25DO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sY0FBYyxTQUtqQjtBQUNDLFVBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxRQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGFBQU87QUFBQSxRQUNILG9CQUFvQjtBQUFBLFFBQ3BCLGVBQWU7QUFBQSxRQUNmLGtCQUFrQjtBQUFBLFFBQ2xCLG1CQUFtQjtBQUFBLE1BQ3ZCO0FBQUEsSUFDSjtBQUVBLFFBQUkscUJBQXFCO0FBQ3pCLFFBQUksZ0JBQWdCO0FBQ3BCLFFBQUksbUJBQW1CO0FBQ3ZCLFFBQUksbUJBQW1CO0FBRXZCLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsK0JBQXFCLGdCQUFnQixhQUFhO0FBQ2xELDBCQUFnQixnQkFBZ0IsYUFBYSxNQUFNLElBQUksRUFBRTtBQUN6RCw2QkFBbUI7QUFDbkIsNkJBQW1CLGdCQUFnQjtBQUFBLFFBQ3ZDO0FBQ0E7QUFBQSxNQUVKLEtBQUs7QUFDRCxZQUFJLFFBQVEsVUFBVTtBQUNsQixnQkFBTSxVQUFVLE1BQU0sS0FBSyxlQUFlLFlBQVksUUFBUSxRQUFRO0FBQ3RFLGNBQUksU0FBUztBQUNULGlDQUFxQixRQUFRLFFBQVE7QUFDckMsNEJBQWdCLFFBQVEsTUFBTSxNQUFNLFFBQVEsTUFBTTtBQUNsRCwrQkFBbUIsSUFBSSxRQUFRLFFBQVE7QUFDdkMsK0JBQW1CLFFBQVE7QUFBQSxVQUMvQjtBQUFBLFFBQ0o7QUFDQTtBQUFBLE1BRUosS0FBSztBQUVELDZCQUFxQjtBQUNyQix3QkFBZ0I7QUFDaEIsMkJBQW1CO0FBRW5CLFlBQUksZ0JBQWdCLGtCQUFrQjtBQUNsQyw2QkFBbUIsZ0JBQWdCLGlCQUFpQixPQUFPLEtBQUssSUFBSSxJQUNwRCxPQUFPLGdCQUFnQixpQkFBaUIsTUFBTSxLQUFLLElBQUk7QUFBQSxRQUMzRTtBQUNBO0FBQUEsTUFFSixLQUFLO0FBQ0QsNkJBQXFCLGdCQUFnQixRQUFRO0FBQzdDLHdCQUFnQixnQkFBZ0IsUUFBUSxNQUFNLElBQUksRUFBRTtBQUNwRCwyQkFBbUI7QUFDbkIsMkJBQW1CLGdCQUFnQjtBQUNuQztBQUFBLE1BRUosS0FBSztBQUNELDZCQUFxQjtBQUNyQix3QkFBZ0I7QUFDaEIsMkJBQW1CO0FBQ25CO0FBQUEsSUFDUjtBQUdBLFVBQU0sb0JBQW9CLEtBQUssbUJBQW1CLGtCQUFrQixRQUFRLFdBQVc7QUFFdkYsV0FBTztBQUFBLE1BQ0g7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsbUJBQW1CLFNBQWlCLGFBQWdEO0FBQ3hGLFVBQU0sZ0JBQWdCLFFBQVE7QUFDOUIsVUFBTSxtQkFBbUIsWUFBWSxZQUFZO0FBR2pELFFBQUksYUFBd0M7QUFDNUMsUUFBSSxnQkFBZ0IsSUFBTSxjQUFhO0FBQUEsYUFDOUIsZ0JBQWdCLElBQUssY0FBYTtBQUczQyxVQUFNLHNCQUFzQjtBQUFBLE1BQ3hCO0FBQUEsTUFBZTtBQUFBLE1BQWM7QUFBQSxNQUFzQjtBQUFBLE1BQ25EO0FBQUEsTUFBZ0I7QUFBQSxNQUFzQjtBQUFBLE1BQWE7QUFBQSxJQUN2RDtBQUVBLFFBQUksb0JBQW9CLEtBQUssVUFBUSxpQkFBaUIsU0FBUyxJQUFJLENBQUMsR0FBRztBQUNuRSxVQUFJLGVBQWUsTUFBTyxjQUFhO0FBQUEsZUFDOUIsZUFBZSxTQUFVLGNBQWE7QUFBQSxJQUNuRDtBQUVBLFdBQU87QUFBQSxFQUNYO0FBQ0o7OztBQ2xsQk8sSUFBTSxrQkFBTixNQUFzQjtBQUFBLEVBQ3pCLFlBQ1ksS0FDQSxnQkFDQSxnQkFDQSxpQkFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFDVDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0gsTUFBTSxRQUFRLFNBQTJDO0FBQ3JELFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLHNCQUFzQixLQUFLLGVBQWUsdUJBQXVCO0FBQ3ZFLFlBQU0sZUFBZSxzQkFBc0IsRUFBRSxnQkFBZ0IsS0FBSyxJQUFJLENBQUM7QUFDdkUsWUFBTUMsVUFBUyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixjQUFjLG1CQUFtQjtBQUcxRyxZQUFNLGFBQWEsS0FBSyxlQUFlLGVBQWVBLE9BQU07QUFDNUQsVUFBSSxDQUFDLFdBQVcsT0FBTztBQUNuQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixXQUFXLE9BQU8sS0FBSyxJQUFJLENBQUM7QUFBQSxVQUNoRSxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsTUFBTSxLQUFLLGdCQUFnQjtBQUFBLFFBQzFDQSxRQUFPO0FBQUEsUUFDUEEsUUFBTztBQUFBLFFBQ1A7QUFBQSxVQUNJLGFBQWFBLFFBQU8sT0FBTztBQUFBLFVBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFFBQzdCO0FBQUEsTUFDSjtBQUdBLFlBQU0sVUFBVSxLQUFLLHFCQUFxQixVQUFVO0FBQ3BELFVBQUksQ0FBQyxXQUFXLE9BQU8sS0FBSyxPQUFPLEVBQUUsV0FBVyxHQUFHO0FBQy9DLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0saUJBQWlCLEtBQUssa0JBQWtCLGdCQUFnQixTQUFTLE9BQU87QUFHOUUsWUFBTSxLQUFLLElBQUksTUFBTSxPQUFPLGdCQUFnQixNQUFNLGNBQWM7QUFFaEUsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsU0FBUztBQUFBLFFBQ1QsV0FBVyxFQUFFLE1BQU0sR0FBRyxJQUFJLEVBQUU7QUFBQSxRQUM1QixVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0osU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyw4QkFBK0IsTUFBZ0IsT0FBTztBQUFBLFFBQzdELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHFCQUFxQixVQUE4QztBQUN2RSxRQUFJO0FBRUEsWUFBTSxZQUFZLFNBQVMsTUFBTSw0QkFBNEI7QUFDN0QsVUFBSSxXQUFXO0FBQ1gsZUFBTyxLQUFLLE1BQU0sVUFBVSxDQUFDLENBQUM7QUFBQSxNQUNsQztBQUdBLFlBQU0sVUFBK0IsQ0FBQztBQUN0QyxZQUFNLFFBQVEsU0FBUyxNQUFNLElBQUk7QUFFakMsaUJBQVcsUUFBUSxPQUFPO0FBRXRCLGNBQU0sUUFBUSxLQUFLLE1BQU0seUJBQXlCO0FBQ2xELFlBQUksT0FBTztBQUNQLGdCQUFNLE1BQU0sTUFBTSxDQUFDLEVBQUUsS0FBSztBQUMxQixjQUFJLFFBQVEsTUFBTSxDQUFDLEVBQUUsS0FBSztBQUcxQixjQUFJO0FBQ0Esb0JBQVEsS0FBSyxNQUFNLEtBQUs7QUFBQSxVQUM1QixTQUFRO0FBR0osZ0JBQUssTUFBTSxXQUFXLEdBQUcsS0FBSyxNQUFNLFNBQVMsR0FBRyxLQUMzQyxNQUFNLFdBQVcsR0FBRyxLQUFLLE1BQU0sU0FBUyxHQUFHLEdBQUk7QUFDaEQsc0JBQVEsTUFBTSxNQUFNLEdBQUcsRUFBRTtBQUFBLFlBQzdCO0FBQUEsVUFDSjtBQUVBLGtCQUFRLEdBQUcsSUFBSTtBQUFBLFFBQ25CO0FBQUEsTUFDSjtBQUVBLGFBQU8sT0FBTyxLQUFLLE9BQU8sRUFBRSxTQUFTLElBQUksVUFBVTtBQUFBLElBQ3ZELFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSxxQ0FBcUMsS0FBSztBQUN4RCxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixTQUFpQixTQUFzQztBQUM3RSxVQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFHaEMsUUFBSSxNQUFNLENBQUMsTUFBTSxPQUFPO0FBRXBCLFVBQUksV0FBVztBQUNmLGVBQVMsSUFBSSxHQUFHLElBQUksTUFBTSxRQUFRLEtBQUs7QUFDbkMsWUFBSSxNQUFNLENBQUMsTUFBTSxPQUFPO0FBQ3BCLHFCQUFXO0FBQ1g7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUVBLFVBQUksV0FBVyxHQUFHO0FBRWQsY0FBTSxnQkFBcUMsQ0FBQztBQUM1QyxpQkFBUyxJQUFJLEdBQUcsSUFBSSxVQUFVLEtBQUs7QUFDL0IsZ0JBQU0sUUFBUSxNQUFNLENBQUMsRUFBRSxNQUFNLG1CQUFtQjtBQUNoRCxjQUFJLE9BQU87QUFDUCxrQkFBTSxNQUFNLE1BQU0sQ0FBQyxFQUFFLEtBQUs7QUFDMUIsZ0JBQUksUUFBUSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBRzFCLGdCQUFJO0FBQ0Esc0JBQVEsS0FBSyxNQUFNLEtBQUs7QUFBQSxZQUM1QixTQUFRO0FBQUEsWUFFUjtBQUVBLDBCQUFjLEdBQUcsSUFBSTtBQUFBLFVBQ3pCO0FBQUEsUUFDSjtBQUdBLGNBQU0sY0FBYyxFQUFFLEdBQUcsZUFBZSxHQUFHLFFBQVE7QUFHbkQsY0FBTUMsa0JBQWlCLENBQUMsS0FBSztBQUM3QixtQkFBVyxDQUFDLEtBQUssS0FBSyxLQUFLLE9BQU8sUUFBUSxXQUFXLEdBQUc7QUFDcEQsY0FBSSxVQUFVLFFBQVEsVUFBVSxRQUFXO0FBRXZDO0FBQUEsVUFDSjtBQUVBLGdCQUFNLGlCQUFpQixPQUFPLFVBQVUsV0FDbEMsS0FBSyxVQUFVLEtBQUssSUFDcEIsT0FBTyxLQUFLO0FBRWxCLFVBQUFBLGdCQUFlLEtBQUssR0FBRyxHQUFHLEtBQUssY0FBYyxFQUFFO0FBQUEsUUFDbkQ7QUFDQSxRQUFBQSxnQkFBZSxLQUFLLEtBQUs7QUFHekIsZUFBTztBQUFBLFVBQ0gsR0FBR0E7QUFBQSxVQUNILEdBQUcsTUFBTSxNQUFNLFdBQVcsQ0FBQztBQUFBLFFBQy9CLEVBQUUsS0FBSyxJQUFJO0FBQUEsTUFDZjtBQUFBLElBQ0o7QUFHQSxVQUFNLGlCQUFpQixDQUFDLEtBQUs7QUFDN0IsZUFBVyxDQUFDLEtBQUssS0FBSyxLQUFLLE9BQU8sUUFBUSxPQUFPLEdBQUc7QUFDaEQsVUFBSSxVQUFVLFFBQVEsVUFBVSxRQUFXO0FBQ3ZDO0FBQUEsTUFDSjtBQUVBLFlBQU0saUJBQWlCLE9BQU8sVUFBVSxXQUNsQyxLQUFLLFVBQVUsS0FBSyxJQUNwQixPQUFPLEtBQUs7QUFFbEIscUJBQWUsS0FBSyxHQUFHLEdBQUcsS0FBSyxjQUFjLEVBQUU7QUFBQSxJQUNuRDtBQUNBLG1CQUFlLEtBQUssT0FBTyxFQUFFO0FBRzdCLFdBQU8sZUFBZSxLQUFLLElBQUksSUFBSTtBQUFBLEVBQ3ZDO0FBQ0o7OztBQy9NTyxJQUFNLHFCQUF1RDtBQUFBO0FBQUEsRUFFaEUsa0JBQWtCO0FBQUEsSUFDZCxlQUFlO0FBQUE7QUFBQSxJQUNmLGFBQWE7QUFBQTtBQUFBLElBQ2IsYUFBYTtBQUFBLEVBQ2pCO0FBQUE7QUFBQSxFQUdBLHFCQUFxQjtBQUFBLElBQ2pCLGVBQWU7QUFBQTtBQUFBLElBQ2YsYUFBYTtBQUFBO0FBQUEsSUFDYixhQUFhO0FBQUEsRUFDakI7QUFBQTtBQUFBLEVBR0EsY0FBYztBQUFBLElBQ1YsZUFBZTtBQUFBO0FBQUEsSUFDZixhQUFhO0FBQUE7QUFBQSxJQUNiLGFBQWE7QUFBQSxFQUNqQjtBQUFBO0FBQUEsRUFHQSxrQkFBa0I7QUFBQSxJQUNkLGVBQWU7QUFBQTtBQUFBLElBQ2YsYUFBYTtBQUFBO0FBQUEsSUFDYixhQUFhO0FBQUEsRUFDakI7QUFBQTtBQUFBLEVBR0EsbUJBQW1CO0FBQUEsSUFDZixlQUFlO0FBQUE7QUFBQSxJQUNmLGFBQWE7QUFBQTtBQUFBLElBQ2IsYUFBYTtBQUFBLEVBQ2pCO0FBQUE7QUFBQSxFQUdBLHNCQUFzQjtBQUFBLElBQ2xCLGVBQWU7QUFBQTtBQUFBLElBQ2YsYUFBYTtBQUFBO0FBQUEsSUFDYixhQUFhO0FBQUEsRUFDakI7QUFDSjtBQU1PLElBQU0sZ0JBQWdCO0FBQUEsRUFDekI7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUFBLEVBQ0E7QUFBQTtBQUNKOzs7QUNsRU8sSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBTTNCLFlBQ1Msa0JBQ1IsZUFDQztBQUZPO0FBTlQsU0FBUSxXQUFxQyxvQkFBSSxJQUFJO0FBQ3JELFNBQVEsbUJBQTRDO0FBQ3BELFNBQVEsY0FBdUI7QUFDL0IsU0FBUSxnQkFBK0IsRUFBRSxTQUFTLE1BQU07QUFNdkQsUUFBSSxlQUFlO0FBQ2xCLFdBQUssZ0JBQWdCO0FBQUEsSUFDdEI7QUFDQSxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT1EseUJBQStCO0FBRXRDLGtCQUFjLFFBQVEsZ0JBQWM7QUFDbkMsV0FBSyxnQkFBZ0I7QUFBQSxRQUNwQixLQUFLO0FBQUEsUUFDTCxTQUFTO0FBQUEsUUFDVCxhQUFhLEtBQUssMEJBQTBCLFVBQVU7QUFBQSxNQUN2RCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBR0QsV0FBTyxRQUFRLGtCQUFrQixFQUFFLFFBQVEsQ0FBQyxDQUFDLEtBQUssTUFBTSxNQUFNO0FBQzdELFlBQU0sVUFBVSxLQUFLLDBCQUEwQixLQUFLLE1BQU07QUFDMUQsV0FBSyxnQkFBZ0I7QUFBQSxRQUNwQjtBQUFBLFFBQ0E7QUFBQSxRQUNBLGFBQWEsT0FBTztBQUFBLFFBQ3BCLGFBQWE7QUFBQSxRQUNiLGlCQUFpQixDQUFDLEtBQUsscUJBQXFCLE1BQU07QUFBQSxNQUNuRCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBQUEsRUFDRjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMEJBQTBCLEtBQXFCO0FBQ3RELFVBQU0sZUFBdUM7QUFBQSxNQUM1QyxpQkFBaUI7QUFBQSxNQUNqQixvQkFBb0I7QUFBQSxNQUNwQixzQkFBc0I7QUFBQSxNQUN0QixzQkFBc0I7QUFBQSxNQUN0QixpQkFBaUI7QUFBQSxNQUNqQixrQkFBa0I7QUFBQSxNQUNsQixnQkFBZ0I7QUFBQSxNQUNoQixvQkFBb0I7QUFBQSxJQUNyQjtBQUNBLFdBQU8sYUFBYSxHQUFHLEtBQUs7QUFBQSxFQUM3QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMEJBQTBCLFlBQW9CLFFBQW1DO0FBQ3hGLFVBQU0sTUFBTSxLQUFLLGVBQWU7QUFDaEMsVUFBTSxnQkFBZ0IsSUFBSSxLQUFLLE9BQU8sYUFBYTtBQUNuRCxVQUFNLGNBQWMsSUFBSSxLQUFLLE9BQU8sV0FBVztBQUcvQyxRQUFJLE9BQU8sYUFBYTtBQUN2QixhQUFPO0FBQUEsSUFDUjtBQUdBLFFBQUksS0FBSyxlQUFlLEtBQUssT0FBTyxlQUFlO0FBQ2xELGFBQU87QUFBQSxJQUNSO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHFCQUFxQixRQUFtQztBQUMvRCxVQUFNLE1BQU0sS0FBSyxlQUFlO0FBQ2hDLFVBQU0sY0FBYyxJQUFJLEtBQUssT0FBTyxXQUFXO0FBQy9DLFdBQU8sT0FBTztBQUFBLEVBQ2Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUF1QjtBQUM5QixRQUFJLEtBQUssY0FBYyxXQUFXLEtBQUssY0FBYyxjQUFjO0FBQ2xFLGFBQU8sSUFBSSxLQUFLLEtBQUssY0FBYyxZQUFZO0FBQUEsSUFDaEQ7QUFDQSxXQUFPLG9CQUFJLEtBQUs7QUFBQSxFQUNqQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsaUJBQTBCO0FBQ2pDLFFBQUksS0FBSyxjQUFjLFdBQVcsS0FBSyxjQUFjLG1CQUFtQixRQUFXO0FBQ2xGLGFBQU8sS0FBSyxjQUFjO0FBQUEsSUFDM0I7QUFDQSxXQUFPLEtBQUs7QUFBQSxFQUNiO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsTUFBeUI7QUFDeEMsU0FBSyxTQUFTLElBQUksS0FBSyxLQUFLLElBQUk7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx1QkFBdUIsWUFBMEM7QUFDdEUsUUFBSSxDQUFDLFlBQVk7QUFDaEIsV0FBSyxtQkFBbUI7QUFDeEIsV0FBSyxjQUFjO0FBQUEsSUFDcEIsT0FBTztBQUNOLFlBQU0sYUFBYSxNQUFNLEtBQUssaUJBQWlCLHlCQUF5QixVQUFVO0FBQ2xGLFVBQUksV0FBVyxTQUFTLFdBQVcsU0FBUztBQUMzQyxhQUFLLG1CQUFtQixXQUFXO0FBQ25DLGFBQUssY0FBYztBQUFBLE1BQ3BCLE9BQU87QUFDTixhQUFLLG1CQUFtQjtBQUN4QixhQUFLLGNBQWM7QUFBQSxNQUNwQjtBQUFBLElBQ0Q7QUFHQSxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBZ0M7QUFDL0IsV0FBTyxLQUFLLGVBQWU7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esc0JBQStDO0FBQzlDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGlCQUFpQixZQUE2QjtBQWpLL0M7QUFtS0UsUUFBSSxLQUFLLG1CQUFtQixVQUFVLEdBQUc7QUFDeEMsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLFVBQVUsS0FBSyxTQUFTLElBQUksVUFBVTtBQUM1QyxZQUFPLHdDQUFTLFlBQVQsWUFBb0I7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsbUJBQW1CLEtBQXNCO0FBQ2hELFVBQU0sYUFBYTtBQUFBLE1BQ2xCO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0Q7QUFDQSxXQUFPLFdBQVcsU0FBUyxHQUFHO0FBQUEsRUFDL0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG1CQUFtQixZQUF5QztBQUUzRCxRQUFJLEtBQUssbUJBQW1CLFVBQVUsR0FBRztBQUN4QyxhQUFPLEVBQUUsU0FBUyxLQUFLO0FBQUEsSUFDeEI7QUFFQSxVQUFNLFVBQVUsS0FBSyxTQUFTLElBQUksVUFBVTtBQUU1QyxRQUFJLENBQUMsU0FBUztBQUNiLGFBQU87QUFBQSxRQUNOLFNBQVM7QUFBQSxRQUNULFFBQVEsWUFBWSxVQUFVO0FBQUEsTUFDL0I7QUFBQSxJQUNEO0FBRUEsUUFBSSxRQUFRLFNBQVM7QUFDcEIsYUFBTyxFQUFFLFNBQVMsS0FBSztBQUFBLElBQ3hCO0FBR0EsUUFBSSxRQUFRLGFBQWE7QUFDeEIsWUFBTSxTQUFTLG1CQUFtQixVQUFVO0FBQzVDLFVBQUksUUFBUTtBQUNYLGNBQU0sTUFBTSxLQUFLLGVBQWU7QUFDaEMsY0FBTSxjQUFjLElBQUksS0FBSyxPQUFPLFdBQVc7QUFDL0MsY0FBTSxnQkFBZ0IsSUFBSSxLQUFLLE9BQU8sYUFBYTtBQUVuRCxZQUFJLEtBQUssZUFBZSxLQUFLLE1BQU0sZUFBZTtBQUNqRCxpQkFBTztBQUFBLFlBQ04sU0FBUztBQUFBLFlBQ1QsUUFBUSw2REFBNkQsT0FBTyxhQUFhO0FBQUEsWUFDekYsb0JBQW9CO0FBQUEsWUFDcEIsZUFBZTtBQUFBLFVBQ2hCO0FBQUEsUUFDRCxXQUFXLENBQUMsS0FBSyxlQUFlLEtBQUssTUFBTSxhQUFhO0FBQ3ZELGlCQUFPO0FBQUEsWUFDTixTQUFTO0FBQUEsWUFDVCxRQUFRLDRHQUE0RyxPQUFPLFdBQVc7QUFBQSxZQUN0SSxvQkFBb0I7QUFBQSxZQUNwQixlQUFlO0FBQUEsVUFDaEI7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFFQSxXQUFPO0FBQUEsTUFDTixTQUFTO0FBQUEsTUFDVCxRQUFRO0FBQUEsSUFDVDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHFCQUFvQztBQUNuQyxXQUFPLE1BQU0sS0FBSyxLQUFLLFNBQVMsT0FBTyxDQUFDLEVBQUUsT0FBTyxhQUFXLFFBQVEsT0FBTztBQUFBLEVBQzVFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBc0M7QUFDckMsV0FBTyxNQUFNLEtBQUssS0FBSyxTQUFTLE9BQU8sQ0FBQyxFQUFFO0FBQUEsTUFBTyxhQUNoRCxRQUFRLGVBQWUsUUFBUTtBQUFBLElBQ2hDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esb0JBQW9CLFVBQStCO0FBQ2xELFNBQUssZ0JBQWdCO0FBRXJCLFNBQUssdUJBQXVCO0FBQUEsRUFDN0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG1CQUFrQztBQUNqQyxXQUFPLEVBQUUsR0FBRyxLQUFLLGNBQWM7QUFBQSxFQUNoQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esb0JBSUU7QUFDRCxVQUFNLFVBQW9CLENBQUM7QUFDM0IsVUFBTSxhQUFnRixDQUFDO0FBRXZGLGVBQVcsQ0FBQyxLQUFLLE9BQU8sS0FBSyxLQUFLLFVBQVU7QUFDM0MsVUFBSSxRQUFRLFNBQVM7QUFDcEIsZ0JBQVEsS0FBSyxHQUFHO0FBQUEsTUFDakIsV0FBVyxRQUFRLGFBQWE7QUFDL0IsY0FBTSxTQUFTLG1CQUFtQixHQUFHO0FBQ3JDLFlBQUksUUFBUTtBQUNYLGdCQUFNLGtCQUFrQixLQUFLLGVBQWU7QUFDNUMscUJBQVcsS0FBSztBQUFBLFlBQ2Y7QUFBQSxZQUNBLGVBQWUsa0JBQWtCLE9BQU8sZ0JBQWdCLE9BQU87QUFBQSxZQUMvRCxhQUFhO0FBQUEsVUFDZCxDQUFDO0FBQUEsUUFDRjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBRUEsV0FBTztBQUFBLE1BQ04sYUFBYSxLQUFLLGVBQWU7QUFBQSxNQUNqQztBQUFBLE1BQ0E7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNEOzs7QUNwVE8sSUFBTSxtQkFBTixNQUF1QjtBQUFBLEVBQXZCO0FBRU47QUFBQSxTQUFpQixhQUFhO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUs5QixNQUFNLGdCQUFnQixZQUFzRDtBQUMzRSxRQUFJO0FBQ0gsWUFBTSxVQUFVLEtBQUssZ0JBQWdCLFVBQVU7QUFDL0MsVUFBSSxDQUFDLFNBQVM7QUFDYixlQUFPO0FBQUEsVUFDTixPQUFPO0FBQUEsVUFDUDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBRUEsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLHNCQUFzQixPQUFPO0FBQ2hFLFVBQUksaUJBQWlCO0FBQ3BCLGVBQU87QUFBQSxVQUNOLE9BQU87QUFBQSxVQUNQO0FBQUEsVUFDQSxPQUFPO0FBQUEsUUFDUjtBQUFBLE1BQ0Q7QUFFQSxhQUFPO0FBQUEsUUFDTixPQUFPO0FBQUEsUUFDUDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLGFBQU87QUFBQSxRQUNOLE9BQU87QUFBQSxRQUNQO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsWUFBb0M7QUFDM0QsUUFBSTtBQUVILFlBQU0sVUFBVSxLQUFLLGFBQWEsVUFBVTtBQUM1QyxZQUFNLFFBQVEsUUFBUSxNQUFNLEdBQUc7QUFFL0IsVUFBSSxNQUFNLFdBQVcsR0FBRztBQUN2QixlQUFPO0FBQUEsTUFDUjtBQUVBLFlBQU0sQ0FBQyxPQUFPLE1BQU0sY0FBYyxhQUFhLFNBQVMsSUFBSTtBQUs1RCxZQUFNLFlBQVksaUJBQWlCLGFBQWEsT0FBTyxJQUFJLEtBQUssWUFBWTtBQUM1RSxZQUFNLFdBQVcsSUFBSSxLQUFLLFdBQVc7QUFHckMsVUFBSSxNQUFNLFNBQVMsUUFBUSxDQUFDLEdBQUc7QUFDOUIsZUFBTztBQUFBLE1BQ1I7QUFFQSxVQUFJLGFBQWEsTUFBTSxVQUFVLFFBQVEsQ0FBQyxHQUFHO0FBQzVDLGVBQU87QUFBQSxNQUNSO0FBRUEsYUFBTztBQUFBLFFBQ047QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsYUFBTztBQUFBLElBQ1I7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxhQUFhLEtBQXFCO0FBQ3pDLFFBQUksT0FBTyxTQUFTLGFBQWE7QUFDaEMsYUFBTyxLQUFLLEdBQUc7QUFBQSxJQUNoQjtBQUVBLFdBQU8sT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFLFNBQVMsTUFBTTtBQUFBLEVBQ2xEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxhQUFhLEtBQXFCO0FBQ3pDLFFBQUksT0FBTyxTQUFTLGFBQWE7QUFDaEMsYUFBTyxLQUFLLEdBQUc7QUFBQSxJQUNoQjtBQUVBLFdBQU8sT0FBTyxLQUFLLEtBQUssTUFBTSxFQUFFLFNBQVMsUUFBUTtBQUFBLEVBQ2xEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHNCQUFzQixTQUFnRDtBQUVuRixVQUFNLG9CQUFvQixNQUFNLEtBQUs7QUFBQSxNQUNwQyxRQUFRO0FBQUEsTUFDUjtBQUFBO0FBQUEsTUFDQSxRQUFRO0FBQUEsTUFDUixRQUFRO0FBQUEsSUFDVDtBQUVBLFFBQUksUUFBUSxjQUFjLG1CQUFtQjtBQUM1QztBQUFBLElBQ0Q7QUFHQSxRQUFJLFFBQVEsYUFBYSxvQkFBSSxLQUFLLElBQUksUUFBUSxXQUFXO0FBQ3hEO0FBQUEsSUFDRDtBQUdBLFFBQUksUUFBUSxXQUFXLG9CQUFJLEtBQUssR0FBRztBQUNsQztBQUFBLElBQ0Q7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxrQkFDYixPQUNBLE1BQ0EsV0FDQSxVQUNrQjtBQUNsQixVQUFNLE9BQU8sR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUM7QUFFakcsVUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxVQUFNLFVBQVUsUUFBUSxPQUFPLEtBQUssVUFBVTtBQUM5QyxVQUFNLGNBQWMsUUFBUSxPQUFPLElBQUk7QUFFdkMsVUFBTSxZQUFZLE1BQU0sT0FBTyxPQUFPO0FBQUEsTUFDckM7QUFBQSxNQUNBO0FBQUEsTUFDQSxFQUFFLE1BQU0sUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNoQztBQUFBLE1BQ0EsQ0FBQyxNQUFNO0FBQUEsSUFDUjtBQUVBLFVBQU0sWUFBWSxNQUFNLE9BQU8sT0FBTyxLQUFLLFFBQVEsV0FBVyxXQUFXO0FBQ3pFLFdBQU8sTUFBTSxLQUFLLElBQUksV0FBVyxTQUFTLENBQUMsRUFDekMsSUFBSSxPQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsU0FBUyxHQUFHLEdBQUcsQ0FBQyxFQUN4QyxLQUFLLEVBQUU7QUFBQSxFQUNWO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUFrQixPQUFlLE1BQWMsZUFBZSxNQUF1QjtBQUMxRixVQUFNLFdBQVcsb0JBQUksS0FBSztBQUMxQixVQUFNLFlBQVksZUFBZSxPQUFPLElBQUksS0FBSyxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssS0FBSyxLQUFLLEdBQUk7QUFFdkYsVUFBTSxZQUFZLE1BQU0sS0FBSyxrQkFBa0IsT0FBTyxNQUFNLFdBQVcsUUFBUTtBQUUvRSxVQUFNLGNBQWMsR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUMsSUFBSSxTQUFTO0FBRXJILFdBQU8sS0FBSyxhQUFhLFdBQVc7QUFBQSxFQUNyQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx5QkFBeUIsWUFBd0Q7QUFDdEYsUUFBSTtBQUNILFlBQU0sVUFBVSxLQUFLLHlCQUF5QixVQUFVO0FBQ3hELFVBQUksQ0FBQyxTQUFTO0FBQ2IsZUFBTztBQUFBLFVBQ04sT0FBTztBQUFBLFVBQ1A7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSywrQkFBK0IsT0FBTztBQUN6RSxVQUFJLGlCQUFpQjtBQUNwQixlQUFPO0FBQUEsVUFDTixPQUFPO0FBQUEsVUFDUDtBQUFBLFVBQ0EsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBRUEsYUFBTztBQUFBLFFBQ04sT0FBTztBQUFBLFFBQ1A7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixhQUFPO0FBQUEsUUFDTixPQUFPO0FBQUEsUUFDUDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EseUJBQXlCLFlBQTZDO0FBQzdFLFFBQUk7QUFFSCxZQUFNLFVBQVUsS0FBSyxhQUFhLFVBQVU7QUFDNUMsWUFBTSxRQUFRLFFBQVEsTUFBTSxHQUFHO0FBRS9CLFVBQUksTUFBTSxXQUFXLEdBQUc7QUFDdkIsZUFBTztBQUFBLE1BQ1I7QUFFQSxZQUFNLENBQUMsT0FBTyxNQUFNLGNBQWMsYUFBYSxTQUFTLElBQUk7QUFHNUQsVUFBSSxTQUFTLFlBQVksU0FBUyxZQUFZO0FBQzdDLGVBQU87QUFBQSxNQUNSO0FBR0EsWUFBTSxZQUFZLGlCQUFpQixhQUFhLE9BQU8sSUFBSSxLQUFLLFlBQVk7QUFDNUUsWUFBTSxXQUFXLElBQUksS0FBSyxXQUFXO0FBR3JDLFVBQUksTUFBTSxTQUFTLFFBQVEsQ0FBQyxHQUFHO0FBQzlCLGVBQU87QUFBQSxNQUNSO0FBRUEsVUFBSSxhQUFhLE1BQU0sVUFBVSxRQUFRLENBQUMsR0FBRztBQUM1QyxlQUFPO0FBQUEsTUFDUjtBQUVBLGFBQU87QUFBQSxRQUNOO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsK0JBQStCLFNBQXlEO0FBRXJHLFVBQU0sb0JBQW9CLE1BQU0sS0FBSztBQUFBLE1BQ3BDLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxJQUNUO0FBRUEsUUFBSSxRQUFRLGNBQWMsbUJBQW1CO0FBQzVDO0FBQUEsSUFDRDtBQUdBLFFBQUksUUFBUSxhQUFhLG9CQUFJLEtBQUssSUFBSSxRQUFRLFdBQVc7QUFDeEQ7QUFBQSxJQUNEO0FBR0EsUUFBSSxRQUFRLFdBQVcsb0JBQUksS0FBSyxHQUFHO0FBQ2xDO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLDJCQUNiLE9BQ0EsTUFDQSxXQUNBLFVBQ2tCO0FBQ2xCLFVBQU0sT0FBTyxHQUFHLEtBQUssSUFBSSxJQUFJLEtBQUksdUNBQVcsa0JBQWlCLFVBQVUsSUFBSSxTQUFTLFlBQVksQ0FBQztBQUVqRyxVQUFNLFVBQVUsSUFBSSxZQUFZO0FBQ2hDLFVBQU0sVUFBVSxRQUFRLE9BQU8sS0FBSyxVQUFVO0FBQzlDLFVBQU0sY0FBYyxRQUFRLE9BQU8sSUFBSTtBQUV2QyxVQUFNLFlBQVksTUFBTSxPQUFPLE9BQU87QUFBQSxNQUNyQztBQUFBLE1BQ0E7QUFBQSxNQUNBLEVBQUUsTUFBTSxRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ2hDO0FBQUEsTUFDQSxDQUFDLE1BQU07QUFBQSxJQUNSO0FBRUEsVUFBTSxZQUFZLE1BQU0sT0FBTyxPQUFPLEtBQUssUUFBUSxXQUFXLFdBQVc7QUFDekUsV0FBTyxNQUFNLEtBQUssSUFBSSxXQUFXLFNBQVMsQ0FBQyxFQUN6QyxJQUFJLE9BQUssRUFBRSxTQUFTLEVBQUUsRUFBRSxTQUFTLEdBQUcsR0FBRyxDQUFDLEVBQ3hDLEtBQUssRUFBRTtBQUFBLEVBQ1Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sMkJBQTJCLE9BQWUsTUFBOEM7QUFDN0YsVUFBTSxXQUFXLG9CQUFJLEtBQUs7QUFDMUIsVUFBTSxZQUFZLFNBQVMsYUFBYSxPQUFPLElBQUksS0FBSyxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssS0FBSyxLQUFLLEdBQUk7QUFFOUYsVUFBTSxZQUFZLE1BQU0sS0FBSywyQkFBMkIsT0FBTyxNQUFNLFdBQVcsUUFBUTtBQUV4RixVQUFNLGNBQWMsR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUMsSUFBSSxTQUFTO0FBRXJILFdBQU8sS0FBSyxhQUFhLFdBQVc7QUFBQSxFQUNyQztBQUNEOzs7QXZCcFRBLElBQU1DLGlCQUFnQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBa0J0QixJQUFxQixhQUFyQixjQUF3Qyx3QkFBTztBQUFBLEVBbUI5QyxNQUFNLFNBQVM7QUFDZCxRQUFJO0FBQ0gsY0FBUSxJQUFJLDBCQUEwQjtBQUN0QyxZQUFNLEtBQUssYUFBYTtBQUN4QixjQUFRLElBQUksdUJBQXVCO0FBR25DLFdBQUssbUJBQW1CLElBQUksaUJBQWlCO0FBQzdDLFdBQUssaUJBQWlCLElBQUk7QUFBQSxRQUN6QixLQUFLO0FBQUEsUUFDTCxLQUFLLFNBQVMsVUFBVTtBQUFBLE1BQ3pCO0FBR0EsVUFBSSxLQUFLLFNBQVMsVUFBVSxZQUFZO0FBQ3ZDLGNBQU0sS0FBSyxlQUFlLHVCQUF1QixLQUFLLFNBQVMsVUFBVSxVQUFVO0FBQUEsTUFDcEY7QUFDQSxjQUFRLElBQUksbUNBQW1DO0FBRy9DLFdBQUssSUFBSSxVQUFVLGNBQWMsTUFBTTtBQUN0QyxjQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLHNCQUFzQjtBQUN4RSxZQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLGdCQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsc0JBQVksbUJBQW1CO0FBQUEsUUFDaEM7QUFBQSxNQUNELENBQUM7QUFNRCxvQ0FBUSxhQUFhQSxjQUFhO0FBQ2xDLGNBQVEsSUFBSSx1QkFBdUI7QUFFbkMsV0FBSyxvQkFBb0IsSUFBSSxrQkFBa0IsS0FBSyxVQUFVLEtBQUssY0FBYztBQUNqRixZQUFNLEtBQUssa0JBQWtCLFdBQVc7QUFDeEMsY0FBUSxJQUFJLHVDQUF1QztBQUduRCxZQUFNLFlBQVk7QUFBQSxRQUNqQixVQUFVLENBQUMsUUFBZ0IsS0FBSyxnQkFBZ0IsR0FBRztBQUFBLFFBQ25ELFVBQVUsQ0FBQyxLQUFhLFNBQWMsS0FBSyxnQkFBZ0IsS0FBSyxJQUFJO0FBQUEsTUFDckU7QUFDQSxXQUFLLHNCQUFzQixJQUFJLG9CQUFvQixTQUFTO0FBQzVELFdBQUssaUJBQWlCLElBQUksZUFBZSxLQUFLLEtBQUssU0FBUztBQUM1RCxXQUFLLGVBQWUsdUJBQXVCLEtBQUssbUJBQW1CO0FBQ25FLFdBQUssaUJBQWlCLElBQUksZUFBZTtBQUN6QyxXQUFLLGdCQUFnQixJQUFJLGNBQWM7QUFDdkMsV0FBSyxnQkFBZ0IsSUFBSSxjQUFjLEtBQUssZ0JBQWdCLEtBQUssbUJBQW1CO0FBR3BGLFdBQUssb0JBQW9CLElBQUksV0FBVyxLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDbEgsV0FBSyxxQkFBcUIsSUFBSSxZQUFZLEtBQUssS0FBSyxLQUFLLGdCQUFnQixLQUFLLGdCQUFnQixLQUFLLGlCQUFpQjtBQUNwSCxXQUFLLHVCQUF1QixJQUFJLGNBQWMsS0FBSyxLQUFLLEtBQUssZ0JBQWdCLEtBQUssZ0JBQWdCLEtBQUssaUJBQWlCO0FBQ3hILFdBQUssd0JBQXdCLElBQUksZUFBZSxLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDMUgsV0FBSyx3QkFBd0IsSUFBSSxlQUFlLEtBQUssS0FBSyxLQUFLLGdCQUFnQixLQUFLLGdCQUFnQixLQUFLLGlCQUFpQjtBQUMxSCxXQUFLLHlCQUF5QixJQUFJLGdCQUFnQixLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDNUgsY0FBUSxJQUFJLGdEQUFnRDtBQUU1RCxXQUFLO0FBQUEsUUFDSjtBQUFBLFFBQ0EsQ0FBQyxTQUFTLElBQUksZ0JBQWdCLE1BQU0sSUFBSTtBQUFBLE1BQ3pDO0FBQ0EsY0FBUSxJQUFJLHVCQUF1QjtBQUluQyxZQUFNLGFBQWEsS0FBSyxjQUFjLGFBQWEsV0FBVyxDQUFDLFFBQW9CO0FBQ2xGLGFBQUssYUFBYTtBQUFBLE1BQ25CLENBQUM7QUFDRCxjQUFRLElBQUkseUJBQXlCO0FBQ3JDLGNBQVEsSUFBSSw4QkFBOEIsVUFBVTtBQUNwRCxjQUFRLElBQUksZ0NBQWdDLFdBQVcsU0FBUztBQUNoRSxjQUFRLElBQUksZ0NBQWdDLFdBQVcsVUFBVSxTQUFTLENBQUM7QUFHM0UsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixnQkFBZ0IsT0FBTyxRQUFnQixRQUF5QztBQUMvRSxnQkFBTSxLQUFLLGlCQUFpQjtBQUFBLFFBQzdCO0FBQUEsTUFDRCxDQUFDO0FBRUQsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixnQkFBZ0IsT0FBTyxRQUFnQixRQUF5QztBQUMvRSxnQkFBTSxLQUFLLGtCQUFrQjtBQUFBLFFBQzlCO0FBQUEsTUFDRCxDQUFDO0FBRUQsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixnQkFBZ0IsT0FBTyxRQUFnQixRQUF5QztBQUMvRSxnQkFBTSxLQUFLLG9CQUFvQjtBQUFBLFFBQ2hDO0FBQUEsTUFDRCxDQUFDO0FBRUQsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixnQkFBZ0IsT0FBTyxRQUFnQixRQUF5QztBQUMvRSxnQkFBTSxLQUFLLHFCQUFxQjtBQUFBLFFBQ2pDO0FBQUEsTUFDRCxDQUFDO0FBRUQsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixnQkFBZ0IsT0FBTyxRQUFnQixRQUF5QztBQUMvRSxnQkFBTSxLQUFLLHFCQUFxQjtBQUFBLFFBQ2pDO0FBQUEsTUFDRCxDQUFDO0FBRUQsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixVQUFVLE1BQU07QUFDZixlQUFLLGFBQWE7QUFBQSxRQUNuQjtBQUFBLE1BQ0QsQ0FBQztBQUNELGNBQVEsSUFBSSwyQkFBMkI7QUFFdkMsV0FBSyxhQUFhLElBQUksZUFBZSxLQUFLLEtBQUssSUFBSTtBQUNwRCxXQUFLLGNBQWMsS0FBSyxVQUFVO0FBQ2pDLGNBQVEsSUFBSSwwQkFBMEI7QUFDdEMsY0FBUSxJQUFJLHFDQUFxQztBQUFBLElBQ2xELFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSwwQkFBMEIsS0FBSztBQUFBLElBQzlDO0FBQUEsRUFDRDtBQUFBLEVBRUEsV0FBVztBQS9MWjtBQWdNRSxlQUFLLHNCQUFMLG1CQUF3QjtBQUN4QixlQUFLLHdCQUFMLG1CQUEwQjtBQUFBLEVBQzNCO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDcEIsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUMxRTtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBeE10QjtBQXlNRSxVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFDakMsZUFBSyxzQkFBTCxtQkFBd0IsZUFBZSxLQUFLO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNwQixVQUFNLEVBQUUsVUFBVSxJQUFJLEtBQUs7QUFFM0IsUUFBSTtBQUNKLFVBQU0sU0FBUyxVQUFVLGdCQUFnQixzQkFBc0I7QUFFL0QsUUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixhQUFPLE9BQU8sQ0FBQztBQUFBLElBQ2hCLE9BQU87QUFDTixhQUFPLFVBQVUsYUFBYSxLQUFLO0FBQ25DLGFBQU0sNkJBQU0sYUFBYSxFQUFFLE1BQU0sd0JBQXdCLFFBQVEsS0FBSztBQUFBLElBQ3ZFO0FBRUEsY0FBVSxXQUFXLElBQUs7QUFHMUIsU0FBSSw2QkFBTSxpQkFBZ0IsaUJBQWlCO0FBQzFDLFdBQUssY0FBYyxLQUFLO0FBQUEsSUFDekI7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLG1CQUFrQztBQUMvQyxVQUFNLGNBQWMsTUFBTSxLQUFLLHFCQUFxQiw2QkFBNkI7QUFDakYsUUFBSSxDQUFDLFlBQWE7QUFFbEIsUUFBSTtBQUNILFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxZQUFNLGVBQWUsQ0FBQyxFQUFFLG1EQUFpQjtBQUN6QyxZQUFNLFVBQVUsS0FBSyxjQUFjLGFBQWEsYUFBYSxZQUFZO0FBQ3pFLFlBQU0sU0FBUyxNQUFNLEtBQUssa0JBQWtCLFFBQVEsT0FBTztBQUUzRCxVQUFJLE9BQU8sU0FBUztBQUNuQixZQUFJLHdCQUFPLDRCQUE0QjtBQUFBLE1BQ3hDLE9BQU87QUFDTixZQUFJLHdCQUFPLDBCQUEwQixPQUFPLEtBQUssRUFBRTtBQUFBLE1BQ3BEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixVQUFJLHdCQUFPLFVBQVUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQ2hGO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxvQkFBbUM7QUFDaEQsVUFBTSxjQUFjLE1BQU0sS0FBSyxxQkFBcUIseUNBQXlDO0FBQzdGLFFBQUksQ0FBQyxZQUFhO0FBRWxCLFFBQUk7QUFDSCxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsWUFBTSxlQUFlLENBQUMsRUFBRSxtREFBaUI7QUFDekMsWUFBTSxVQUFVLEtBQUssY0FBYyxhQUFhLGFBQWEsWUFBWTtBQUN6RSxZQUFNLFNBQVMsTUFBTSxLQUFLLG1CQUFtQixRQUFRLE9BQU87QUFFNUQsVUFBSSxPQUFPLFNBQVM7QUFDbkIsWUFBSSx3QkFBTyw2QkFBNkI7QUFBQSxNQUN6QyxPQUFPO0FBQ04sWUFBSSx3QkFBTywyQkFBMkIsT0FBTyxLQUFLLEVBQUU7QUFBQSxNQUNyRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsVUFBSSx3QkFBTyxVQUFVLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUNoRjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsc0JBQXFDO0FBQ2xELFVBQU0sY0FBYyxNQUFNLEtBQUsscUJBQXFCLGdDQUFnQztBQUNwRixRQUFJLENBQUMsWUFBYTtBQUVsQixRQUFJO0FBQ0gsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLGVBQWUsbUJBQW1CO0FBQ3JFLFlBQU0sZUFBZSxDQUFDLEVBQUUsbURBQWlCO0FBQ3pDLFlBQU0sVUFBVSxLQUFLLGNBQWMsYUFBYSxhQUFhLFlBQVk7QUFDekUsWUFBTSxTQUFTLE1BQU0sS0FBSyxxQkFBcUIsUUFBUSxPQUFPO0FBRTlELFVBQUksT0FBTyxTQUFTO0FBQ25CLFlBQUksd0JBQU8sOEJBQThCO0FBQUEsTUFDMUMsT0FBTztBQUNOLFlBQUksd0JBQU8sNkJBQTZCLE9BQU8sS0FBSyxFQUFFO0FBQUEsTUFDdkQ7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLFVBQUksd0JBQU8sVUFBVSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDaEY7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUFzQztBQUNuRCxVQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsUUFBSSxDQUFDLGlCQUFpQjtBQUNyQixVQUFJLHdCQUFPLDBCQUEwQjtBQUNyQztBQUFBLElBQ0Q7QUFHQSxRQUFJLFNBQW1DO0FBQ3ZDLFFBQUksY0FBYztBQUVsQixRQUFJLGdCQUFnQixjQUFjO0FBQ2pDLGVBQVM7QUFDVCxvQkFBYztBQUFBLElBQ2Y7QUFFQSxRQUFJO0FBQ0gsWUFBTSxVQUFVO0FBQUEsUUFDZixRQUFRO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxNQUNEO0FBRUEsWUFBTSxTQUFTLE1BQU0sS0FBSyxzQkFBc0IsUUFBUSxPQUFPO0FBRS9ELFVBQUksT0FBTyxTQUFTO0FBQ25CLFlBQUksd0JBQU8sZ0NBQWdDO0FBQUEsTUFDNUMsT0FBTztBQUNOLFlBQUksd0JBQU8sOEJBQThCLE9BQU8sS0FBSyxFQUFFO0FBQUEsTUFDeEQ7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLFVBQUksd0JBQU8sVUFBVSxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDaEY7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUFzQztBQUNuRCxVQUFNLGNBQWMsTUFBTSxLQUFLLHFCQUFxQiw0Q0FBNEM7QUFDaEcsUUFBSSxDQUFDLFlBQWE7QUFFbEIsUUFBSTtBQUNILFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxZQUFNLGVBQWUsQ0FBQyxFQUFFLG1EQUFpQjtBQUN6QyxZQUFNLFVBQVUsS0FBSyxjQUFjLGFBQWEsYUFBYSxZQUFZO0FBQ3pFLFlBQU0sU0FBUyxNQUFNLEtBQUssc0JBQXNCLFFBQVEsT0FBTztBQUUvRCxVQUFJLE9BQU8sU0FBUztBQUNuQixZQUFJLHdCQUFPLGdDQUFnQztBQUFBLE1BQzVDLE9BQU87QUFDTixZQUFJLHdCQUFPLDhCQUE4QixPQUFPLEtBQUssRUFBRTtBQUFBLE1BQ3hEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixVQUFJLHdCQUFPLFVBQVUsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQ2hGO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxxQkFBcUIsYUFBNkM7QUFDL0UsV0FBTyxJQUFJLFFBQVEsQ0FBQyxZQUFZO0FBQy9CLFlBQU0sUUFBUSxTQUFTLGNBQWMsS0FBSztBQUMxQyxZQUFNLFlBQVk7QUFDbEIsWUFBTSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdFQVNtRCxXQUFXO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVVoRixZQUFNLFFBQVEsTUFBTSxjQUFjLHlCQUF5QjtBQUMzRCxZQUFNLFlBQVksTUFBTSxjQUFjLGtCQUFrQjtBQUN4RCxZQUFNLFlBQVksTUFBTSxjQUFjLGtCQUFrQjtBQUV4RCxZQUFNLGVBQWUsTUFBTTtBQUMxQixjQUFNLFFBQVEsTUFBTSxNQUFNLEtBQUs7QUFDL0IsY0FBTSxPQUFPO0FBQ2IsZ0JBQVEsU0FBUyxJQUFJO0FBQUEsTUFDdEI7QUFFQSxZQUFNLGVBQWUsTUFBTTtBQUMxQixjQUFNLE9BQU87QUFDYixnQkFBUSxJQUFJO0FBQUEsTUFDYjtBQUVBLFlBQU0saUJBQWlCLFdBQVcsQ0FBQyxNQUFNO0FBQ3hDLFlBQUksRUFBRSxRQUFRLFNBQVM7QUFDdEIsWUFBRSxlQUFlO0FBQ2pCLHVCQUFhO0FBQUEsUUFDZCxXQUFXLEVBQUUsUUFBUSxVQUFVO0FBQzlCLFlBQUUsZUFBZTtBQUNqQix1QkFBYTtBQUFBLFFBQ2Q7QUFBQSxNQUNELENBQUM7QUFFRCxnQkFBVSxpQkFBaUIsU0FBUyxZQUFZO0FBQ2hELGdCQUFVLGlCQUFpQixTQUFTLFlBQVk7QUFFaEQsZUFBUyxLQUFLLFlBQVksS0FBSztBQUMvQixZQUFNLE1BQU07QUFBQSxJQUNiLENBQUM7QUFBQSxFQUNGO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSwwQkFBZ0M7QUFDdkMsVUFBTSxRQUFRLFNBQVMsY0FBYyxLQUFLO0FBQzFDLFVBQU0sWUFBWTtBQUNsQixVQUFNLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlDbEIsVUFBTSxhQUFhLE1BQU0sY0FBYyxtQkFBbUI7QUFDMUQsVUFBTSxXQUFXLE1BQU0sY0FBYyxpQkFBaUI7QUFDdEQsVUFBTSxVQUFVLE1BQU0sY0FBYyxXQUFXO0FBRS9DLFVBQU0sYUFBYSxNQUFNO0FBQ3hCLFlBQU0sT0FBTztBQUFBLElBQ2Q7QUFFQSxlQUFXLGlCQUFpQixTQUFTLE1BQU07QUFDMUMsYUFBTyxLQUFLLGlDQUFpQyxRQUFRO0FBQ3JELGlCQUFXO0FBQUEsSUFDWixDQUFDO0FBRUQsYUFBUyxpQkFBaUIsU0FBUyxVQUFVO0FBQzdDLFlBQVEsaUJBQWlCLFNBQVMsVUFBVTtBQUU1QyxhQUFTLEtBQUssWUFBWSxLQUFLO0FBRy9CLFFBQUksd0JBQU8saURBQWlELEdBQUk7QUFBQSxFQUNqRTtBQUFBO0FBQUEsRUFHQSxNQUFNLGdCQUFnQixLQUEyQjtBQUNoRCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVM7QUFDcEMsV0FBTyxVQUFVLFFBQVEsR0FBRyxJQUFJO0FBQUEsRUFDakM7QUFBQSxFQUVBLE1BQU0sZ0JBQWdCLEtBQWEsTUFBMEI7QUFDNUQsVUFBTSxVQUFVLE1BQU0sS0FBSyxTQUFTLEtBQUssQ0FBQztBQUMxQyxZQUFRLEdBQUcsSUFBSTtBQUNmLFdBQU8sTUFBTSxLQUFLLFNBQVMsT0FBTztBQUFBLEVBQ25DO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImV4aXN0aW5nIiwgInByb21wdCIsICJfYSIsICJfYSIsICJpc1N1cGVybm92YSIsICJpbXBvcnRfb2JzaWRpYW4iLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJpbXBvcnRfb2JzaWRpYW4iLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgIm5ld0Zyb250bWF0dGVyIiwgIk5PVkFfSUNPTl9TVkciXQp9Cg==
