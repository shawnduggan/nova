/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-sonnet-4",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-2.5-flash-preview-05-20",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  licensing: {
    licenseKey: "",
    catalystLicenseKey: "",
    isCatalyst: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceCatalyst: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Catalyst Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>All Features Available</h4>
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Catalyst supporters get early access to new features before they're released to everyone.</p>
			</div>
		`;
    const isCatalyst = ((_a = this.plugin.featureManager) == null ? void 0 : _a.getIsCatalystSupporter()) || false;
    const catalystLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getCatalystLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-catalyst-status" });
    const statusText = isCatalyst ? "Catalyst Supporter" : "Nova User";
    const statusIcon = isCatalyst ? "\u26A1" : "\u2605";
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isCatalyst ? "catalyst" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (catalystLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = catalystLicense.expiresAt ? `Expires: ${catalystLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${catalystLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian.Setting(licenseContainer).setName("Catalyst License Key (Optional)").setDesc("Enter your Catalyst supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Catalyst license key...").setValue(this.plugin.settings.licensing.catalystLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.catalystLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateCatalystLicense(value || null);
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Catalyst license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateCatalystLicense(licenseKey);
              const isCatalyst2 = this.plugin.featureManager.getIsCatalystSupporter();
              if (isCatalyst2) {
                this.showLicenseMessage("Valid Catalyst license! You now have early access to new features.", "success");
              } else {
                this.showLicenseMessage("Invalid or expired Catalyst license key.", "error");
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Catalyst license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createFeatureComparison(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createFeatureComparison(container) {
    var _a;
    const comparisonContainer = container.createDiv({ cls: "nova-feature-comparison" });
    comparisonContainer.createEl("h4", { text: "Nova Features" });
    const summaryEl = comparisonContainer.createDiv({ cls: "nova-feature-summary" });
    summaryEl.innerHTML = `
			<div class="nova-available-now">
				<h5>Available Now (Free with Your API Keys)</h5>
				<ul>
					<li>All AI Providers (Claude, OpenAI, Gemini, Ollama)</li>
					<li>Complete Document Editing Suite</li>
					<li>Chat Interface with Conversation History</li>
					<li>Provider Switching</li>
					<li>Full Mobile Support</li>
					<li>File-Scoped Conversations</li>
				</ul>
			</div>
		`;
    const featureSummary = (_a = this.plugin.featureManager) == null ? void 0 : _a.getFeatureSummary();
    if (featureSummary && featureSummary.comingSoon.length > 0) {
      const upcomingEl = comparisonContainer.createDiv({ cls: "nova-upcoming-features" });
      upcomingEl.innerHTML = `
				<div class="nova-catalyst-preview">
					<h5>Coming Soon for Catalyst Supporters</h5>
					<ul>
						${featureSummary.comingSoon.map((feature) => `
							<li>Available ${feature.availableDate} ${feature.isCatalyst ? "(You have early access!)" : ""}</li>
						`).join("")}
					</ul>
				</div>
			`;
    }
    const catalystInfo = comparisonContainer.createDiv({ cls: "nova-catalyst-info" });
    catalystInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Catalyst Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        this.display();
      }));
      new import_obsidian.Setting(debugContainer).setName("Force Catalyst Status").setDesc("Override Catalyst supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceCatalyst || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceCatalyst = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "AI Provider Settings" });
    const infoEl = containerEl.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
		`;
    this.createOllamaSettings();
    this.createClaudeSettings();
    this.createGoogleSettings();
    this.createOpenAISettings();
  }
  createClaudeSettings() {
    const { containerEl } = this;
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(claudeContainer).setName("Model").setDesc("Claude model to use").addDropdown((dropdown) => dropdown.addOption("claude-sonnet-4", "Claude Sonnet 4").addOption("claude-opus-4", "Claude Opus 4").addOption("claude-3-haiku-20240307", "Claude 3 Haiku").addOption("claude-3-sonnet-20240229", "Claude 3 Sonnet").addOption("claude-3-opus-20240229", "Claude 3 Opus").setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createOpenAISettings() {
    const { containerEl } = this;
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "OpenAI" });
    new import_obsidian.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(openaiContainer).setName("Base URL").setDesc("OpenAI API base URL (for custom endpoints)").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.aiProviders.openai.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use").addDropdown((dropdown) => dropdown.addOption("gpt-4o", "GPT-4o").addOption("gpt-3.5-turbo", "GPT-3.5 Turbo").addOption("gpt-4", "GPT-4").addOption("gpt-4-turbo-preview", "GPT-4 Turbo").setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4o").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createGoogleSettings() {
    const { containerEl } = this;
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(googleContainer).setName("Model").setDesc("Gemini model to use").addDropdown((dropdown) => dropdown.addOption("gemini-2.5-flash-preview-05-20", "Gemini 2.5 Flash Preview").addOption("gemini-2.5-pro-preview-06-05", "Gemini 2.5 Pro Preview").addOption("gemini-1.5-flash", "Gemini 1.5 Flash").addOption("gemini-1.5-pro", "Gemini 1.5 Pro").setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-05-20").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createOllamaSettings() {
    const { containerEl } = this;
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Platform Settings" });
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "OpenAI",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.createEl("h3", { text: "Custom Commands" });
    if (!this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 12px; background: var(--background-modifier-hover); border-radius: 8px; margin-bottom: 16px;">
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently in early access for Catalyst supporters. 
						They will be available to all users on September 15, 2025.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    this.renderCustomCommandsList(commandContainer);
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-top: 16px;";
    const addButton = new import_obsidian.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian2 = require("obsidian");

// src/ai/providers/claude.ts
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.content[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": this.config.apiKey,
        "anthropic-version": "2023-06-01"
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-haiku-20240307",
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        system: options == null ? void 0 : options.systemPrompt,
        stream: true,
        messages: messages.map((msg) => ({
          role: msg.role === "assistant" ? "assistant" : "user",
          content: msg.content
        }))
      })
    });
    if (!response.ok) {
      throw new Error(`Claude API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              if (parsed.type === "content_block_delta" && ((_b = parsed.delta) == null ? void 0 : _b.text)) {
                yield { content: parsed.delta.text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const response = await fetch(this.config.baseUrl || "https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.choices[0].message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const response = await fetch(this.config.baseUrl || "https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.candidates[0].content.parts[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian2.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  cleanup() {
    this.providers.clear();
  }
};

// src/ui/sidebar-view.ts
var import_obsidian4 = require("obsidian");

// src/ui/wikilink-suggest.ts
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea) {
    this.suggestionPopup = null;
    this.suggestions = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.currentQuery = "";
    this.currentTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.setupEventListeners();
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
    this.textArea.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textArea.addEventListener("blur", () => {
      setTimeout(() => this.hideSuggestions(), 150);
    });
    document.addEventListener("click", (e) => {
      if (this.suggestionPopup && !this.suggestionPopup.contains(e.target) && e.target !== this.textArea) {
        this.hideSuggestions();
      }
    });
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (linkMatch) {
      this.currentQuery = linkMatch[2] || "";
      this.currentTriggerPos = cursorPos - linkMatch[0].length;
      this.showSuggestions();
    } else {
      this.hideSuggestions();
    }
  }
  handleKeydown(e) {
    if (!this.isVisible) return;
    switch (e.key) {
      case "ArrowDown":
        e.preventDefault();
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);
        this.updateSelection();
        break;
      case "ArrowUp":
        e.preventDefault();
        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
        this.updateSelection();
        break;
      case "Enter":
      case "Tab":
        if (this.selectedIndex >= 0) {
          e.preventDefault();
          this.selectSuggestion(this.suggestions[this.selectedIndex]);
        }
        break;
      case "Escape":
        e.preventDefault();
        this.hideSuggestions();
        break;
    }
  }
  showSuggestions() {
    this.suggestions = this.getSuggestions(this.currentQuery);
    if (this.suggestions.length === 0) {
      this.hideSuggestions();
      return;
    }
    if (!this.suggestionPopup) {
      this.createSuggestionPopup();
    }
    this.renderSuggestions();
    this.positionPopup();
    this.isVisible = true;
    this.selectedIndex = -1;
  }
  hideSuggestions() {
    if (this.suggestionPopup) {
      this.suggestionPopup.style.display = "none";
    }
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  createSuggestionPopup() {
    var _a;
    this.suggestionPopup = document.createElement("div");
    this.suggestionPopup.className = "nova-wikilink-suggestions";
    this.suggestionPopup.style.cssText = `
            position: absolute;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            min-width: 200px;
        `;
    (_a = this.textArea.parentElement) == null ? void 0 : _a.appendChild(this.suggestionPopup);
  }
  renderSuggestions() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.empty();
    this.suggestions.forEach((suggestion, index) => {
      const item = this.suggestionPopup.createDiv({ cls: "nova-suggestion-item" });
      item.style.cssText = `
                padding: 8px 12px;
                cursor: pointer;
                border-bottom: 1px solid var(--background-modifier-border-hover);
                transition: background-color 0.2s;
            `;
      const nameEl = item.createDiv({ cls: "nova-suggestion-name" });
      nameEl.textContent = suggestion.file.basename;
      nameEl.style.cssText = `
                font-weight: 500;
                color: var(--text-normal);
                margin-bottom: 2px;
            `;
      if (suggestion.file.path !== suggestion.file.name) {
        const pathEl = item.createDiv({ cls: "nova-suggestion-path" });
        pathEl.textContent = suggestion.file.path;
        pathEl.style.cssText = `
                    font-size: 0.85em;
                    color: var(--text-muted);
                `;
      }
      item.addEventListener("click", () => {
        this.selectSuggestion(suggestion);
      });
      item.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.suggestionPopup.style.display = "block";
  }
  updateSelection() {
    if (!this.suggestionPopup) return;
    const items = this.suggestionPopup.querySelectorAll(".nova-suggestion-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.backgroundColor = "var(--background-modifier-hover)";
      } else {
        element.style.backgroundColor = "";
      }
    });
  }
  positionPopup() {
    if (!this.suggestionPopup) return;
    const rect = this.textArea.getBoundingClientRect();
    const popupHeight = Math.min(200, this.suggestions.length * 50);
    this.suggestionPopup.style.position = "absolute";
    this.suggestionPopup.style.left = "0";
    this.suggestionPopup.style.bottom = "100%";
    this.suggestionPopup.style.marginBottom = "4px";
    this.suggestionPopup.style.width = `${rect.width}px`;
  }
  selectSuggestion(suggestion) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (!linkMatch) return;
    const isPersistent = !!linkMatch[1];
    const startPos = cursorPos - linkMatch[0].length;
    const linkText = `[[${suggestion.file.basename}]]`;
    const replacement = isPersistent ? `+${linkText}` : linkText;
    const newText = text.substring(0, startPos) + replacement + text.substring(cursorPos);
    this.textArea.value = newText;
    const newCursorPos = startPos + replacement.length;
    this.textArea.setSelectionRange(newCursorPos, newCursorPos);
    this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    this.hideSuggestions();
    this.textArea.focus();
  }
  getSuggestions(query) {
    const files = this.app.vault.getMarkdownFiles();
    const suggestions = [];
    for (const file of files) {
      const score = this.scoreFile(file, query);
      if (score > 0) {
        suggestions.push({
          file,
          displayText: file.basename,
          score
        });
      }
    }
    return suggestions.sort((a, b) => b.score - a.score).slice(0, 8);
  }
  scoreFile(file, query) {
    if (!query) return 50;
    const basename = file.basename.toLowerCase();
    const path = file.path.toLowerCase();
    const queryLower = query.toLowerCase();
    if (basename === queryLower) return 100;
    if (basename.startsWith(queryLower)) return 80;
    if (basename.includes(queryLower)) return 60;
    if (path.includes(queryLower)) return 40;
    if (this.fuzzyMatch(basename, queryLower)) return 20;
    return 0;
  }
  fuzzyMatch(text, query) {
    let textIndex = 0;
    let queryIndex = 0;
    while (textIndex < text.length && queryIndex < query.length) {
      if (text[textIndex] === query[queryIndex]) {
        queryIndex++;
      }
      textIndex++;
    }
    return queryIndex === query.length;
  }
  destroy() {
    if (this.suggestionPopup) {
      this.suggestionPopup.remove();
    }
  }
};

// src/core/multi-doc-context.ts
var import_obsidian3 = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const allPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const contextParts = [];
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        temporaryDocs: [],
        // No more temporary docs
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        const content = await this.app.vault.read(file);
        const lines = content.split("\n");
        const truncatedContent = lines.slice(0, 50).join("\n");
        const wasTruncated = lines.length > 50;
        return `## Document: ${file.basename}
${truncatedContent}${wasTruncated ? "\n\n[... truncated for brevity ...]" : ""}`;
      }
    } catch (error) {
      console.error(`Failed to read context from ${docRef.file.path}:`, error);
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian3.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian3.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian3.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.temporaryDocs.length + context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`+${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    for (const doc of context.temporaryDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var NovaSidebarView = class extends import_obsidian4.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.currentContext = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian4.Platform.isDesktopApp ? "25px" : "0"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 10px;
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: 1.1em; display: flex; align-items: center; gap: 6px;";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: 8px;";
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian4.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.loadConversationForActiveFile();
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
    this.commandPickerItems = [];
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.empty();
    }
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: 10px;
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: 8px;
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.inputContainer.style.cssText = `
			display: flex;
			flex-direction: column;
			gap: 8px;
			padding: 10px;
			border-top: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
			position: relative;
		`;
    const inputRow = this.inputContainer.createDiv({ cls: "nova-input-row" });
    inputRow.style.cssText = `
			display: flex;
			align-items: center;
			gap: 8px;
		`;
    const textAreaContainer = inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian4.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova to help edit your document...");
    const lineHeight = 1.5;
    const paddingVertical = 20;
    const borderWidth = 2;
    const baseLines = import_obsidian4.Platform.isMobile ? 2 : 3;
    const maxLines = import_obsidian4.Platform.isMobile ? 8 : 6;
    const fontSize = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--font-text-size") || "14px");
    const initialHeight = baseLines * lineHeight * fontSize + paddingVertical + borderWidth;
    this.textArea.inputEl.style.cssText = `
			width: 100%;
			min-height: ${initialHeight}px;
			max-height: ${maxLines * lineHeight * fontSize + paddingVertical + borderWidth}px;
			height: ${initialHeight}px;
			resize: none;
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			padding: 10px;
			font-size: var(--font-text-size);
			line-height: ${lineHeight};
			overflow-y: hidden;
			transition: height 0.1s ease-out;
		`;
    this.autoGrowTextarea = () => {
      const el = this.textArea.inputEl;
      el.style.height = "auto";
      const contentHeight = el.scrollHeight;
      const minHeight = initialHeight;
      const maxHeight = maxLines * lineHeight * fontSize + paddingVertical + borderWidth;
      const newHeight = Math.max(minHeight, Math.min(contentHeight, maxHeight));
      el.style.height = `${newHeight}px`;
      el.style.overflowY = contentHeight > maxHeight ? "auto" : "hidden";
    };
    this.textArea.inputEl.addEventListener("input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.app, this.textArea.inputEl);
    this.textArea.inputEl.addEventListener("input", () => {
      this.updateLiveContextPreview();
    });
    this.commandButton = new import_obsidian4.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: ${this.plugin.featureManager.isFeatureEnabled("command-button") ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: 8px;
		`;
    this.sendButton = new import_obsidian4.ButtonComponent(inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.setCta();
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			width: 36px;
			height: 36px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
		`;
    this.textArea.inputEl.addEventListener("keydown", (event) => {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
        this.handleCommandPickerSelection() || this.handleSend();
      } else if (event.key === "Escape") {
        this.hideCommandPicker();
      } else if (event.key === "ArrowDown" || event.key === "ArrowUp") {
        if (this.isCommandPickerVisible()) {
          event.preventDefault();
          this.navigateCommandPicker(event.key === "ArrowDown" ? 1 : -1);
        }
      }
    });
    this.textArea.inputEl.addEventListener("input", () => {
      this.handleInputChange();
    });
    this.createCommandPicker();
    this.createCommandMenu();
    this.createContextIndicator();
    this.contextPreview = this.createContextPreview();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: 10px;
			padding: 8px 12px;
			border-radius: 8px;
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: 0.9em;" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: 0.8em;
			opacity: 0.7;
			margin-bottom: 4px;
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: 12px;
			margin: 16px auto;
			padding: 16px 20px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 18px;
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: 32px;
			height: 32px;
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Welcome to Nova" });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "Your AI thinking partner. Ask me to help edit your document!" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: #4caf50; display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, 50);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("command-system")) {
      this.addMessage("system", this.createIconMessage("zap", "Command system is currently in early access for Catalyst supporters. Available to all users September 15, 2025."));
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addMessage("system", this.createIconMessage("refresh-cw", `Switched to ${this.getProviderDisplayName(providerId)}`));
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.textArea.setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addMessage("system", this.createIconMessage("edit", `Loaded template: ${customCommand.name}`));
        return true;
      }
    }
    this.addMessage("system", this.createIconMessage("help-circle", `Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`));
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.textArea.getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("command-system")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item" });
      item.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
				display: flex;
				align-items: center;
				gap: 8px;
			`;
      const triggerEl = item.createSpan({ cls: "nova-command-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.cssText = `
				font-family: var(--font-monospace);
				background: var(--background-modifier-hover);
				padding: 2px 6px;
				border-radius: 4px;
				font-size: 0.9em;
				color: var(--interactive-accent);
			`;
      const nameEl = item.createSpan({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1; color: var(--text-normal);";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "font-size: 0.8em; color: var(--text-muted);";
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.style.backgroundColor = "";
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].style.backgroundColor = "var(--background-modifier-hover)";
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.textArea.setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    const commands = [
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" },
      { trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" }
    ];
    if (this.plugin.featureManager.isFeatureEnabled("custom-commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      customCommands.forEach((cmd) => {
        commands.push({
          trigger: cmd.trigger,
          name: cmd.name,
          ...cmd.description && { description: cmd.description }
        });
      });
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("command-button")) {
      this.addMessage("system", this.createIconMessage("zap", "Command button is currently in early access for Catalyst supporters. Available to all users August 15, 2025."));
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header" });
    headerEl.style.cssText = `
			padding: 12px 16px;
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 600;
			font-size: 0.9em;
			color: var(--text-normal);
		`;
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item" });
      item.style.cssText = `
				padding: 12px 16px;
				cursor: pointer;
				border-bottom: 1px solid var(--background-modifier-border-hover);
				display: flex;
				flex-direction: column;
				gap: 4px;
				transition: background-color 0.2s;
			`;
      const nameEl = item.createDiv({ cls: "nova-command-menu-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
			`;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.cssText = `
				font-family: var(--font-monospace);
				font-size: 0.8em;
				color: var(--interactive-accent);
				opacity: 0.8;
			`;
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-muted);
				`;
      }
      item.addEventListener("mouseenter", () => {
        item.style.backgroundColor = "var(--background-modifier-hover)";
      });
      item.addEventListener("mouseleave", () => {
        item.style.backgroundColor = "";
      });
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  executeCommandFromMenu(trigger) {
    this.hideCommandMenu();
    this.textArea.setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.textArea.getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian4.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const allDocs = [...this.currentContext.temporaryDocs, ...this.currentContext.persistentDocs];
    if (allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const isMobile = import_obsidian4.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: block;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px;";
    if (isMobile) {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}%)`;
    } else {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, 150);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian4.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("eraser").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, 150);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
			`;
      nameEl.setAttr("title", doc.file.path);
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.innerHTML = this.createInlineIcon("x", isMobile ? "18px" : "14px");
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: bold;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, 150);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, 150);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      const result = await this.multiDocHandler.buildContext("", this.currentFile);
      this.currentContext = result.context;
      this.updateContextIndicator();
    }
  }
  async handleSend() {
    const message = this.textArea.getValue().trim();
    if (!message) return;
    if (message.startsWith(":")) {
      const commandResult = await this.handleColonCommand(message);
      if (commandResult) {
        this.textArea.setValue("");
        setTimeout(() => this.autoGrowTextarea(), 0);
        return;
      }
    }
    let processedMessage = message;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (message.includes("[[") || message.includes("+[[")) {
          this.addMessage("system", this.createIconMessage("book-open", "Multi-document context is currently in early access for Catalyst supporters. Available to all users August 15, 2025."));
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(message, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const hasNewTempDocs = multiDocContext.temporaryDocs.length > 0;
        const hasNewPersistentDocs = multiDocContext.temporaryDocs.some((doc) => doc.isPersistent);
        const isContextOnlyMessage = processedMessage.trim().length === 0 && (hasNewTempDocs || hasNewPersistentDocs);
        if (isContextOnlyMessage) {
          if (hasNewPersistentDocs) {
            const persistentDocs = multiDocContext.temporaryDocs.filter((doc) => doc.isPersistent);
            const docNames = persistentDocs.map((doc) => doc.file.basename).join(", ");
            this.addMessage("system", this.createIconMessage("check-circle", `Added ${persistentDocs.length} document${persistentDocs.length !== 1 ? "s" : ""} to persistent context: ${docNames}`));
          }
          this.textArea.setValue("");
          setTimeout(() => this.autoGrowTextarea(), 0);
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (multiDocContext.temporaryDocs.length > 0 || multiDocContext.persistentDocs.length > 0) {
          const allDocs = [...multiDocContext.temporaryDocs, ...multiDocContext.persistentDocs];
          const docNames = allDocs.map((doc) => doc.file.basename).join(", ");
          const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
          this.addMessage("system", this.createIconMessage("book-open", `Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}`));
        }
        if (multiDocContext.isNearLimit) {
          new import_obsidian4.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", 5e3);
        }
      }
    }
    this.addMessage("user", message);
    this.textArea.setValue("");
    setTimeout(() => this.autoGrowTextarea(), 0);
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    this.sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(message);
      }
      const isLikelyCommand = this.plugin.promptBuilder["isLikelyCommand"](processedMessage);
      let response = null;
      if (isLikelyCommand && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedUserPrompt = `${multiDocContext.contextString}

---

Current Request: ${prompt2.userPrompt}`;
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      loadingEl.remove();
      if (activeFile && response) {
        await this.plugin.documentEngine.addAssistantMessage(response);
      }
      if (response) {
        this.addMessage("assistant", response);
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addMessage("assistant", `Sorry, I encountered an error: ${error.message}`);
    } finally {
      this.sendButton.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian4.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      let result;
      switch (command.action) {
        case "add":
          result = await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          result = await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          result = await this.plugin.rewriteCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, or rewrite content.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return this.createIconMessage("x-circle", `Error executing command: ${error.message}`);
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian4.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFile = targetFile;
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
      }
    } catch (error) {
      console.warn("Failed to load conversation history:", error);
      this.addWelcomeMessage(`Ready to help you with "${targetFile.basename}". What would you like to do?`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
        console.warn("Failed to clear conversation:", error);
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared! Ready to help you with "${this.currentFile.basename}". What would you like to do?`);
    } else {
      this.addWelcomeMessage("Chat cleared! Ready to help. What would you like to do?");
    }
    new import_obsidian4.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite"];
    if (validActions.includes(command.action)) {
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Create static provider status display
   */
  createStaticProviderStatus(container) {
    const providerStatus = container.createDiv({ cls: "nova-header-provider" });
    providerStatus.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			font-size: 0.75em;
			color: var(--text-muted);
			opacity: 0.8;
		`;
    const headerStatusDot = providerStatus.createSpan({ cls: "nova-status-dot-small" });
    headerStatusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const headerProviderName = providerStatus.createSpan({ text: "Loading..." });
    this.plugin.aiProviderManager.getCurrentProviderName().then((name) => {
      headerProviderName.setText(name);
    });
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-muted);
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const statusDot = providerButton.createSpan({ cls: "nova-status-dot-small" });
    statusDot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: #4caf50;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
      providerName.setText(currentProviderName);
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providerItem = dropdownMenu.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				transition: background-color 0.2s ease;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const displayName = this.getProviderDisplayName(providerType);
      const nameSpan = providerItem.createSpan({ text: displayName });
      const isCurrent = displayName === currentProviderName;
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      providerItem.addEventListener("click", async () => {
        if (!isCurrent) {
          await this.switchToProvider(providerType);
          dropdownMenu.style.display = "none";
          if (this.currentProviderDropdown) {
            this.currentProviderDropdown.updateCurrentProvider();
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "GPT-4 (OpenAI)",
      "google": "Gemini (Google)",
      "ollama": "Ollama (Local)",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "#D2691E",
      "openai": "#10A37F",
      "google": "#4285F4",
      "ollama": "#7C3AED",
      "none": "#999"
    };
    return colors[providerType] || "#4caf50";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${this.getProviderDisplayName(providerType)}`);
      this.addMessage("system", switchMessage);
      const platform = import_obsidian4.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    } catch (error) {
      console.error("Error switching provider:", error);
      this.addMessage("system", this.createIconMessage("x-circle", `Failed to switch to ${this.getProviderDisplayName(providerType)}`));
    }
  }
};

// src/core/document-engine.ts
var import_obsidian5 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
      console.warn("Failed to load conversation data:", error);
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
      console.error("Failed to save conversation data:", error);
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance
   */
  getActiveEditor() {
    const activeEditor = this.app.workspace.activeEditor;
    if (activeEditor == null ? void 0 : activeEditor.editor) {
      return activeEditor.editor;
    }
    let view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
    if (!view) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of leaves) {
        const leafView = leaf.view;
        if (leafView instanceof import_obsidian5.MarkdownView) {
          view = leafView;
          break;
        }
      }
    }
    if (!view) {
      return null;
    }
    const editor = view.editor;
    return editor || null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at a specific location
   */
  async deleteContent(target, location) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      } else if (target === "section" && location) {
        const section = await this.findSection(location);
        if (!section) {
          return {
            success: false,
            error: `Section "${location}" not found`,
            editType: "delete"
          };
        }
        const content = editor.getValue();
        const lines = content.split("\n");
        const newLines = lines.filter(
          (_, index) => index < section.range.start || index > section.range.end
        );
        await this.app.vault.modify(file, newLines.join("\n"));
        return {
          success: true,
          editType: "delete",
          appliedAt: { line: section.range.start, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Find a section by heading name
   */
  async findSection(headingText) {
    const context = await this.getDocumentContext();
    if (!context) return null;
    const headingIndex = context.headings.findIndex(
      (h) => h.text.toLowerCase().includes(headingText.toLowerCase())
    );
    if (headingIndex === -1) return null;
    const heading = context.headings[headingIndex];
    const nextHeading = context.headings[headingIndex + 1];
    const lines = context.content.split("\n");
    const endLine = nextHeading ? nextHeading.line - 1 : lines.length - 1;
    const sectionLines = lines.slice(heading.line + 1, endLine + 1);
    const sectionContent = sectionLines.join("\n").trim();
    return {
      heading: heading.text,
      level: heading.level,
      content: sectionContent,
      range: {
        start: heading.line,
        end: endLine
      }
    };
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor() {
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: 0.7,
      maxTokens: 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents directly. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Be concise and focused on the specific request
- Do not add section headers unless specifically requested`;
    const actionSpecificPrompts = {
      add: `
TASK: Add new content to the document.
- Create well-structured, relevant content that fits the document's purpose
- Use appropriate markdown formatting (headings, lists, emphasis)
- Ensure smooth flow with existing content
- Match the document's style and tone`,
      edit: `
TASK: Edit and improve existing content.
- Enhance clarity, readability, and flow
- Preserve the original meaning unless changes are requested
- Improve word choice and sentence structure
- Maintain the original formatting and structure`,
      delete: `
TASK: Remove specified content from the document.
- Identify the exact content to be removed
- Ensure remaining content flows naturally
- Preserve document structure and formatting
- Confirm the deletion is appropriate for the context`,
      grammar: `
TASK: Fix grammar, spelling, and language issues.
- Correct spelling errors, grammar mistakes, and typos
- Improve sentence structure and clarity
- Maintain the original voice and style
- Preserve all formatting and markdown syntax
- Make minimal changes - only fix actual errors`,
      rewrite: `
TASK: Rewrite or restructure content.
- Create new content that serves the same purpose
- Improve organization, clarity, and flow
- Use more effective language and structure
- Maintain key information and concepts
- Adapt to any specified style requirements`
    };
    return basePrompt + actionSpecificPrompts[action];
  }
  /**
   * Build user prompt with specific instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = `${contextInfo}

USER REQUEST: ${command.instruction}`;
    if (command.context && command.context.trim()) {
      prompt2 += `

ADDITIONAL REQUIREMENTS: ${command.context}`;
    }
    const targetInstructions = this.getTargetInstructions(command);
    if (targetInstructions) {
      prompt2 += `

${targetInstructions}`;
    }
    const actionInstructions = this.getActionInstructions(command);
    if (actionInstructions) {
      prompt2 += `

${actionInstructions}`;
    }
    return prompt2;
  }
  /**
   * Get target-specific instructions
   */
  getTargetInstructions(command) {
    switch (command.target) {
      case "selection":
        return "FOCUS: Work with the selected text only. Provide the improved version of the selected content.";
      case "section":
        if (command.location) {
          return `FOCUS: Work with the "${command.location}" section. ${command.action === "add" ? "Add content to this section." : "Modify only this section."}`;
        }
        return "FOCUS: Work with the current section.";
      case "document":
        return "FOCUS: Apply changes to the entire document while preserving its structure.";
      case "end":
        return "FOCUS: Add content at the end of the document. Ensure it flows naturally from existing content.";
      case "paragraph":
        return "FOCUS: Work with the current paragraph or create a new paragraph.";
      default:
        return "";
    }
  }
  /**
   * Get action-specific instructions
   */
  getActionInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added. Include appropriate headings if adding a section.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide only the corrected text with grammar and spelling fixes.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      default:
        return "";
    }
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeHistory && conversationContext && conversationContext.trim()) {
      context += `
${conversationContext}
`;
    }
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += "\nDOCUMENT STRUCTURE:\n";
      documentContext.headings.forEach((heading) => {
        const indent = "  ".repeat(heading.level - 1);
        context += `${indent}- ${heading.text}
`;
      });
    }
    if (documentContext.selectedText && command.target === "selection") {
      context += `
SELECTED TEXT:
${documentContext.selectedText}
`;
    }
    if (command.target === "section" && command.location) {
      const section = this.findSectionInContent(documentContext.content, command.location);
      if (section) {
        context += `
CURRENT SECTION "${command.location}":
${section}
`;
      }
    } else if (command.target === "paragraph" && documentContext.surroundingLines) {
      context += "\nCURRENT CONTEXT:\n";
      if (documentContext.surroundingLines.before.length > 0) {
        context += `Before: ${documentContext.surroundingLines.before.join(" ")}
`;
      }
      if (documentContext.surroundingLines.after.length > 0) {
        context += `After: ${documentContext.surroundingLines.after.join(" ")}
`;
      }
    }
    const contentLines = documentContext.content.split("\n");
    if (contentLines.length > config.maxContextLines) {
      const start = Math.max(0, contentLines.length - config.maxContextLines);
      context += `
RECENT CONTENT (last ${config.maxContextLines} lines):
`;
      context += contentLines.slice(start).join("\n");
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}`;
    }
    return context;
  }
  /**
   * Find a specific section in content
   */
  findSectionInContent(content, sectionName) {
    const lines = content.split("\n");
    const normalizedSectionName = sectionName.toLowerCase().trim();
    let sectionStart = -1;
    let sectionLevel = 0;
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const heading = headingMatch[2].toLowerCase().trim();
        if (heading === normalizedSectionName || heading.includes(normalizedSectionName)) {
          sectionStart = i;
          sectionLevel = level;
          break;
        }
      }
    }
    if (sectionStart === -1) return null;
    let sectionEnd = lines.length;
    for (let i = sectionStart + 1; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+/);
      if (headingMatch && headingMatch[1].length <= sectionLevel) {
        sectionEnd = i;
        break;
      }
    }
    return lines.slice(sectionStart, sectionEnd).join("\n");
  }
  /**
   * Create a simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner. Provide helpful, concise responses to user requests. Focus on being practical and actionable.`;
    let userPrompt = instruction;
    if (context) {
      userPrompt = `Context: ${context}

Request: ${instruction}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 500
      }
    };
  }
  /**
   * Build prompt for conversation context
   */
  buildConversationPrompt(message, documentContext, recentHistory = []) {
    let systemPrompt = `You are Nova, an AI writing partner that helps users with their documents. You can:
- Answer questions about writing and editing
- Provide suggestions for improvement
- Help plan document structure
- Assist with research and content development

Be helpful, concise, and practical in your responses.`;
    let userPrompt = message;
    let context = "";
    if (documentContext) {
      context += `Current document: ${documentContext.filename}
`;
      if (documentContext.headings.length > 0) {
        context += "Document structure:\n";
        documentContext.headings.forEach((heading) => {
          const indent = "  ".repeat(heading.level - 1);
          context += `${indent}- ${heading.text}
`;
        });
      }
    }
    if (recentHistory.length > 0) {
      context += "\nRecent conversation:\n";
      recentHistory.slice(-3).forEach((msg) => {
        if (msg.role === "user") {
          context += `You: ${msg.content}
`;
        } else if (msg.role === "assistant") {
          context += `Nova: ${msg.content}
`;
        }
      });
    }
    if (context) {
      userPrompt = `${context}

Current message: ${message}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context,
      config: {
        temperature: 0.8,
        maxTokens: 800
      }
    };
  }
  /**
   * Estimate token count for a prompt
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Validate prompt generation
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    const tokenCount = this.estimateTokenCount(prompt2);
    if (tokenCount > 8e3) {
      issues.push(`Prompt is too long (${tokenCount} tokens, max 8000)`);
    }
    if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
      issues.push("Temperature must be between 0 and 1");
    }
    if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
      issues.push("Max tokens must be between 10 and 4000");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document", "paragraph"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection", "section", "line"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert)\b(?!\s+.*\b(better|clearer|more|less)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i
    ],
    targets: ["end", "section", "paragraph"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection", "section", "paragraph"]
  }
];
var LOCATION_PATTERNS = [
  /\b(?:to|in|at|under|within|inside)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:section|heading|part)\s+["']([^"']+?)["']/i,
  /\b(?:section|heading)\s+(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:the\s+)?([a-zA-Z][a-zA-Z\s&]*?)\s+(?:section|heading)\b/i
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:this|current|selected)\s+(?:paragraph|line)/i, target: "paragraph" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" },
  { pattern: /\b(?:section|heading|part)/i, target: "section" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const location = this.extractLocation(input);
    const context = this.extractContext(input);
    return {
      action,
      target,
      location,
      instruction: input,
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return input.includes("section") || input.includes("heading") ? "section" : "end";
      case "edit":
        return hasSelection ? "selection" : "paragraph";
      case "delete":
        return hasSelection ? "selection" : "section";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return "end";
      default:
        return "paragraph";
    }
  }
  /**
   * Extract location information from the input
   */
  extractLocation(input) {
    for (const pattern of LOCATION_PATTERNS) {
      const match = pattern.exec(input);
      if (match && match[1]) {
        return match[1].trim();
      }
    }
    return void 0;
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "delete" && !command.location) {
      return {
        valid: false,
        error: "Please specify which section to delete"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection, hasHeadings) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add a conclusion section",
        "Fix grammar in this document",
        "Add an introduction",
        "Create a summary"
      );
    }
    if (hasHeadings) {
      suggestions.push(
        "Add content to the introduction section",
        "Expand the methodology section"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target, location } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new sections";
        break;
    }
    if (location) {
      description += ` in "${location}"`;
    } else {
      switch (target) {
        case "selection":
          description += " in selected text";
          break;
        case "section":
          description += " in current section";
          break;
        case "paragraph":
          description += " in current paragraph";
          break;
        case "document":
          description += " in entire document";
          break;
        case "end":
          description += " at end of document";
          break;
      }
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const commandWords = [
      "add",
      "create",
      "write",
      "insert",
      "include",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "fix",
      "correct",
      "grammar",
      "spell",
      "proofread",
      "polish",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const lowerMessage = message.toLowerCase();
    return commandWords.some((word) => lowerMessage.includes(word));
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    return this.contextBuilder.buildConversationPrompt(message, documentContext, recentHistory);
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    return this.contextBuilder.buildSimplePrompt(instruction, context);
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      console.warn("Prompt validation issues:", validation.issues);
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.contextBuilder.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.contextBuilder.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      location: void 0,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "insert"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.documentEngine.applyEdit(
          content,
          await this.determineInsertPosition(command, documentContext),
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Determine where to insert new content
   */
  async determineInsertPosition(command, documentContext) {
    switch (command.target) {
      case "end":
        return "end";
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            return { line: section.range.end, ch: 0 };
          }
        }
        return "cursor";
      case "paragraph":
        return "cursor";
      case "document":
        return "end";
      default:
        return "cursor";
    }
  }
  /**
   * Validate add command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    if (command.target === "section" && !command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for add commands
   */
  getSuggestions(documentContext) {
    const suggestions = [
      "Add a conclusion section",
      "Add an introduction",
      "Create a summary",
      "Add examples",
      "Create a methodology section"
    ];
    if (documentContext.headings.length > 0) {
      const sectionNames = documentContext.headings.map((h) => h.text);
      if (!sectionNames.some((name) => name.toLowerCase().includes("introduction"))) {
        suggestions.unshift("Add an introduction section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("conclusion"))) {
        suggestions.push("Add a conclusion section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("summary"))) {
        suggestions.push("Add a summary section");
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what content would be added (without actually adding it)
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let positionDescription = "";
      switch (command.target) {
        case "end":
          positionDescription = "at the end of the document";
          break;
        case "section":
          if (command.location) {
            positionDescription = `in the "${command.location}" section`;
          } else {
            positionDescription = "in the current section";
          }
          break;
        case "paragraph":
          positionDescription = "at the cursor position";
          break;
        case "document":
          positionDescription = "at the end of the document";
          break;
        default:
          positionDescription = "at the cursor position";
      }
      return {
        success: true,
        preview: `Will add new content ${positionDescription}`,
        position: positionDescription
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyEdit(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          content,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${content}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid edit target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "edit" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for edit commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Make this more professional",
        "Make this more detailed",
        "Improve clarity and flow",
        "Make this more formal",
        "Simplify this text",
        "Expand on this point",
        "Make this more engaging"
      );
    } else {
      suggestions.push(
        "Improve the writing style",
        "Make the document more professional",
        "Enhance clarity throughout",
        "Improve the introduction",
        "Polish the conclusion",
        "Make it more concise",
        "Add more detail",
        "Improve the flow between sections"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Improve the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be edited
   */
  async preview(command) {
    var _a, _b;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will edit the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will edit the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will edit content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will edit content at cursor position";
          if (documentContext.surroundingLines) {
            const currentLine = (_b = (_a = documentContext.cursorPosition) == null ? void 0 : _a.line) != null ? _b : 0;
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              affectedContent = editor.getLine(currentLine);
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will edit the entire document";
          break;
        case "end":
          previewText = "Will add edited content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid edit target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get edit targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of changes
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const conversationContext = this.documentEngine.getConversationContext();
        const promptConfig = conversationContext ? { includeHistory: true } : {};
        const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
        const promptValidation = this.contextBuilder.validatePrompt(prompt2);
        if (!promptValidation.valid) {
          return {
            success: false,
            error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
            editType: "delete"
          };
        }
        try {
          const aiResponse = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
        } catch (error) {
          const result2 = {
            success: false,
            error: error instanceof Error ? error.message : "AI analysis failed",
            editType: "delete"
          };
          await this.documentEngine.addAssistantMessage(
            `Error: ${result2.error}`,
            result2
          );
          return result2;
        }
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0 && !result.success) {
        await this.documentEngine.addAssistantMessage("Failed to delete content", result);
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "delete"
              };
            }
            editor.replaceRange("", startPos, endPos);
            return {
              success: true,
              content: "",
              editType: "delete",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "delete"
            };
          }
        } else {
          return {
            success: false,
            error: "Section name required for section deletion",
            editType: "delete"
          };
        }
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "delete"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          const lineContent = editor.getLine(currentLine);
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine + 1, ch: 0 };
          editor.replaceRange("", startPos, endPos);
          return {
            success: true,
            content: "",
            editType: "delete",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "delete"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end of document. Use a different target.",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: "Invalid deletion target",
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && !command.location) {
      return {
        valid: false,
        error: "Section name required for section deletion"
      };
    }
    if (command.target === "end") {
      return {
        valid: false,
        error: "Cannot delete from end of document. Use a different target."
      };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for delete commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Delete the selected text",
        "Remove this content",
        "Clear the selection"
      );
    } else {
      suggestions.push(
        "Delete the current paragraph",
        "Remove empty sections",
        "Clear redundant content",
        "Delete duplicate information"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Delete the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what would be deleted
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will delete the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = `${section.heading}

${section.content}`;
              previewText = `Will delete the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            return {
              success: false,
              error: "Section name required for preview"
            };
          }
          break;
        case "paragraph":
          previewText = "Will delete the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will delete all document content";
          break;
        case "end":
          return {
            success: false,
            error: "Cannot delete from end of document"
          };
        default:
          return {
            success: false,
            error: "Invalid deletion target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get delete targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-1, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of deletion
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length + section.heading.length;
            linesAffected = section.range.end - section.range.start + 1;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "Invalid target for deletion";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const correctedContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: 0.3,
            // Lower temperature for grammar corrections
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!correctedContent || correctedContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate corrected content", result2);
          return result2;
        }
        const result = await this.applyGrammarCorrection(command, documentContext, correctedContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to correct grammar", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Grammar correction failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar correction based on command target
   */
  async applyGrammarCorrection(command, documentContext, correctedContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${correctedContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(correctedContent, startPos, endPos);
          return {
            success: true,
            content: correctedContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(correctedContent);
      case "end":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid grammar correction target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "grammar" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for grammar commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Fix grammar in selected text",
        "Correct spelling and punctuation",
        "Improve sentence structure",
        "Fix capitalization errors",
        "Correct verb tenses",
        "Fix subject-verb agreement",
        "Improve readability"
      );
    } else {
      suggestions.push(
        "Check grammar throughout document",
        "Fix spelling errors",
        "Correct punctuation",
        "Improve sentence structure",
        "Fix grammatical errors in current paragraph",
        "Check for common mistakes",
        "Proofread the document"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Check grammar in "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be grammar-corrected
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const potentialIssues = [];
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will check grammar in the selected text";
            potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will check grammar in the "${command.location}" section`;
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will check grammar at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will check grammar in the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will check grammar throughout the entire document";
          potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          break;
        case "end":
          previewText = "Will add grammar-corrected content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid grammar correction target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        potentialIssues: potentialIssues.slice(0, 5)
        // Limit to 5 issues
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Detect potential grammar issues in text
   */
  detectPotentialIssues(text) {
    const issues = [];
    const patterns = [
      { pattern: /\bi\s/gi, issue: 'Lowercase "i" should be capitalized' },
      { pattern: /\.\s*[a-z]/g, issue: "Sentence should start with capital letter" },
      { pattern: /\s{2,}/g, issue: "Multiple spaces detected" },
      { pattern: /[.!?]{2,}/g, issue: "Multiple punctuation marks" },
      { pattern: /\s+[.!?,:;]/g, issue: "Space before punctuation" },
      { pattern: /[.!?]\w/g, issue: "Missing space after punctuation" },
      { pattern: /\bteh\b/gi, issue: 'Common typo: "teh" should be "the"' },
      { pattern: /\band\s+and\b/gi, issue: 'Duplicate "and"' },
      { pattern: /\bthe\s+the\b/gi, issue: 'Duplicate "the"' },
      { pattern: /\bis\s+is\b/gi, issue: 'Duplicate "is"' }
    ];
    patterns.forEach(({ pattern, issue }) => {
      if (pattern.test(text)) {
        issues.push(issue);
      }
    });
    return issues;
  }
  /**
   * Get grammar check targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of grammar correction
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        estimatedIssues: 0
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const estimatedIssues = this.detectPotentialIssues(contentToAnalyze).length;
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      estimatedIssues
    };
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const rewrittenContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!rewrittenContent || rewrittenContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate rewritten content", result2);
          return result2;
        }
        const result = await this.applyRewrite(command, documentContext, rewrittenContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Rewrite generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, rewrittenContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${rewrittenContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(rewrittenContent, startPos, endPos);
          return {
            success: true,
            content: rewrittenContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(rewrittenContent);
      case "end":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid rewrite target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "rewrite" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for rewrite commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Rewrite in a more formal tone",
        "Rewrite in a casual tone",
        "Make this more concise",
        "Expand with more detail",
        "Rewrite for clarity",
        "Simplify the language",
        "Make it more engaging",
        "Rewrite in bullet points",
        "Convert to narrative form"
      );
    } else {
      suggestions.push(
        "Rewrite the current paragraph",
        "Rewrite in a different style",
        "Make the writing more engaging",
        "Simplify complex language",
        "Rewrite for different audience",
        "Convert to more formal tone",
        "Make the content more concise"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Rewrite the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be rewritten
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const rewriteStyle = this.inferRewriteStyle(command.instruction);
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = `Will rewrite the selected text`;
            if (rewriteStyle) {
              previewText += ` (${rewriteStyle})`;
            }
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will rewrite the "${command.location}" section`;
              if (rewriteStyle) {
                previewText += ` (${rewriteStyle})`;
              }
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will rewrite content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will rewrite the current paragraph";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will rewrite the entire document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        case "end":
          previewText = "Will add rewritten content at the end of the document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        default:
          return {
            success: false,
            error: "Invalid rewrite target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        rewriteStyle
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Infer rewrite style from instruction
   */
  inferRewriteStyle(instruction) {
    const lowerInstruction = instruction.toLowerCase();
    if (lowerInstruction.includes("formal")) return "formal tone";
    if (lowerInstruction.includes("casual") || lowerInstruction.includes("informal")) return "casual tone";
    if (lowerInstruction.includes("concise") || lowerInstruction.includes("shorter")) return "more concise";
    if (lowerInstruction.includes("expand") || lowerInstruction.includes("detail")) return "more detailed";
    if (lowerInstruction.includes("simple") || lowerInstruction.includes("simplify")) return "simplified language";
    if (lowerInstruction.includes("engaging") || lowerInstruction.includes("interesting")) return "more engaging";
    if (lowerInstruction.includes("professional")) return "professional tone";
    if (lowerInstruction.includes("bullet") || lowerInstruction.includes("list")) return "bullet point format";
    if (lowerInstruction.includes("narrative") || lowerInstruction.includes("story")) return "narrative style";
    if (lowerInstruction.includes("technical")) return "technical style";
    if (lowerInstruction.includes("creative")) return "creative style";
    return "";
  }
  /**
   * Get rewrite targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of rewriting
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        rewriteComplexity: "low"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const rewriteComplexity = this.estimateComplexity(contentToAnalyze, command.instruction);
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      rewriteComplexity
    };
  }
  /**
   * Estimate rewrite complexity
   */
  estimateComplexity(content, instruction) {
    const contentLength = content.length;
    const lowerInstruction = instruction.toLowerCase();
    let complexity = "low";
    if (contentLength > 1e3) complexity = "high";
    else if (contentLength > 300) complexity = "medium";
    const complexInstructions = [
      "restructure",
      "reorganize",
      "completely rewrite",
      "transform",
      "change style",
      "different audience",
      "technical",
      "academic"
    ];
    if (complexInstructions.some((term) => lowerInstruction.includes(term))) {
      if (complexity === "low") complexity = "medium";
      else if (complexity === "medium") complexity = "high";
    }
    return complexity;
  }
};

// src/licensing/feature-config.ts
var CATALYST_FEATURES = {
  // Command system - 3 month early access
  "command-system": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-09-15",
    // 3 months later
    description: "Command system with : triggers and provider switching"
  },
  // Multi-document context - 2 month early access  
  "multi-doc-context": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Reference other documents with [[doc]] syntax"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Command button - 2 month early access
  "command-button": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Command button for mobile and discovery"
  },
  // Custom commands - 3 month early access
  "custom-commands": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-09-15",
    // 3 months later
    description: "User-defined custom command shortcuts"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    catalystDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context"
  // Current document context
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.catalystLicense = null;
    this.isCatalyst = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Catalyst status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(CATALYST_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const catalystDate = new Date(config.catalystDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsCatalyst() && now >= catalystDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Catalyst status (can be overridden in debug mode)
   */
  getIsCatalyst() {
    if (this.debugSettings.enabled && this.debugSettings.forceCatalyst !== void 0) {
      return this.debugSettings.forceCatalyst;
    }
    return this.isCatalyst;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Catalyst license and recalculate feature availability
   */
  async updateCatalystLicense(licenseKey) {
    if (!licenseKey) {
      this.catalystLicense = null;
      this.isCatalyst = false;
    } else {
      const validation = await this.licenseValidator.validateCatalystLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.catalystLicense = validation.license;
        this.isCatalyst = true;
      } else {
        this.catalystLicense = null;
        this.isCatalyst = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Catalyst status
   */
  getIsCatalystSupporter() {
    return this.getIsCatalyst();
  }
  /**
   * Get current Catalyst license
   */
  getCatalystLicense() {
    return this.catalystLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = CATALYST_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const catalystDate = new Date(config.catalystDate);
        if (this.getIsCatalyst() && now < catalystDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Catalyst supporters on ${config.catalystDate}`,
            isCatalystFeature: true,
            availableDate: catalystDate
          };
        } else if (!this.getIsCatalyst() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Catalyst supporters. It will be available to all users on ${config.generalDate}`,
            isCatalystFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Catalyst early access features
   */
  getCatalystFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = CATALYST_FEATURES[key];
        if (config) {
          const isCatalystUser = this.getIsCatalyst();
          comingSoon.push({
            key,
            availableDate: isCatalystUser ? config.catalystDate : config.generalDate,
            isCatalyst: isCatalystUser
          });
        }
      }
    }
    return {
      isCatalyst: this.getIsCatalyst(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Catalyst license key
   */
  async validateCatalystLicense(licenseKey) {
    try {
      const license = this.parseCatalystLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateCatalystLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Catalyst license key string
   */
  parseCatalystLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Catalyst license object
   */
  async validateCatalystLicenseObject(license) {
    const expectedSignature = await this.generateCatalystSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Catalyst license
   */
  async generateCatalystSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Catalyst license for development
   */
  async createTestCatalystLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateCatalystSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// main.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian6.Plugin {
  async onload() {
    try {
      console.log("Nova: onload starting...");
      await this.loadSettings();
      console.log("Nova: settings loaded");
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateCatalystLicense(this.settings.licensing.licenseKey);
      }
      console.log("Nova: feature manager initialized");
      (0, import_obsidian6.addIcon)("nova-star", NOVA_ICON_SVG);
      console.log("Nova: icon registered");
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      console.log("Nova: AI provider manager initialized");
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder();
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      console.log("Nova: document engine and commands initialized");
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      console.log("Nova: view registered");
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      console.log("Nova: ribbon icon added");
      console.log("Nova: ribbon icon element:", ribbonIcon);
      console.log("Nova: ribbon icon innerHTML:", ribbonIcon.innerHTML);
      console.log("Nova: ribbon icon classList:", ribbonIcon.classList.toString());
      this.addCommand({
        id: "nova-add-content",
        name: "Nova: Add content",
        editorCallback: async (editor, ctx) => {
          await this.handleAddCommand();
        }
      });
      this.addCommand({
        id: "nova-edit-content",
        name: "Nova: Edit content",
        editorCallback: async (editor, ctx) => {
          await this.handleEditCommand();
        }
      });
      this.addCommand({
        id: "nova-delete-content",
        name: "Nova: Delete content",
        editorCallback: async (editor, ctx) => {
          await this.handleDeleteCommand();
        }
      });
      this.addCommand({
        id: "nova-fix-grammar",
        name: "Nova: Fix grammar",
        editorCallback: async (editor, ctx) => {
          await this.handleGrammarCommand();
        }
      });
      this.addCommand({
        id: "nova-rewrite-content",
        name: "Nova: Rewrite content",
        editorCallback: async (editor, ctx) => {
          await this.handleRewriteCommand();
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      console.log("Nova: commands registered");
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
      console.log("Nova: settings tab added");
      console.log("Nova: onload completed successfully");
    } catch (error) {
      console.error("Nova: Error in onload:", error);
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
  }
  /**
   * Handle add content command with user input
   */
  async handleAddCommand() {
    const instruction = await this.promptForInstruction("What would you like to add?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.addCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content added successfully");
      } else {
        new import_obsidian6.Notice(`Failed to add content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle edit content command with user input
   */
  async handleEditCommand() {
    const instruction = await this.promptForInstruction("How would you like to edit the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.editCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content edited successfully");
      } else {
        new import_obsidian6.Notice(`Failed to edit content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle delete content command with user input
   */
  async handleDeleteCommand() {
    const instruction = await this.promptForInstruction("What would you like to delete?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.deleteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content deleted successfully");
      } else {
        new import_obsidian6.Notice(`Failed to delete content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle grammar correction command
   */
  async handleGrammarCommand() {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      new import_obsidian6.Notice("No active document found");
      return;
    }
    let target = "document";
    let instruction = "Fix grammar and spelling errors";
    if (documentContext.selectedText) {
      target = "selection";
      instruction = "Fix grammar and spelling errors in the selected text";
    }
    try {
      const command = {
        action: "grammar",
        target,
        instruction
      };
      const result = await this.grammarCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Grammar corrected successfully");
      } else {
        new import_obsidian6.Notice(`Failed to correct grammar: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle rewrite content command with user input
   */
  async handleRewriteCommand() {
    const instruction = await this.promptForInstruction("How would you like to rewrite the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.rewriteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian6.Notice("Content rewritten successfully");
      } else {
        new import_obsidian6.Notice(`Failed to rewrite content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian6.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Prompt user for instruction input
   */
  async promptForInstruction(placeholder) {
    return new Promise((resolve) => {
      const modal = document.createElement("div");
      modal.className = "modal nova-input-modal";
      modal.innerHTML = `
				<div class="modal-container">
					<div class="modal-bg" onclick="this.parentElement.parentElement.remove(); resolve(null);"></div>
					<div class="modal-content">
						<div class="modal-header">
							<h3>Nova AI Command</h3>
							<button class="modal-close-button" onclick="this.closest('.modal').remove(); resolve(null);">\xD7</button>
						</div>
						<div class="modal-body">
							<input type="text" class="nova-instruction-input" placeholder="${placeholder}" autofocus>
						</div>
						<div class="modal-footer">
							<button class="mod-cta nova-submit-btn">Execute</button>
							<button class="nova-cancel-btn">Cancel</button>
						</div>
					</div>
				</div>
			`;
      const input = modal.querySelector(".nova-instruction-input");
      const submitBtn = modal.querySelector(".nova-submit-btn");
      const cancelBtn = modal.querySelector(".nova-cancel-btn");
      const handleSubmit = () => {
        const value = input.value.trim();
        modal.remove();
        resolve(value || null);
      };
      const handleCancel = () => {
        modal.remove();
        resolve(null);
      };
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          handleSubmit();
        } else if (e.key === "Escape") {
          e.preventDefault();
          handleCancel();
        }
      });
      submitBtn.addEventListener("click", handleSubmit);
      cancelBtn.addEventListener("click", handleCancel);
      document.body.appendChild(modal);
      input.focus();
    });
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian6.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXIudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9jbGF1ZGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vcGVuYWkudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9nb29nbGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vbGxhbWEudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvdWkvd2lraWxpbmstc3VnZ2VzdC50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvY29yZS9kb2N1bWVudC1lbmdpbmUudHMiLCAic3JjL2NvcmUvY29udmVyc2F0aW9uLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvY29udGV4dC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmQtcGFyc2VyLnRzIiwgInNyYy9jb3JlL3Byb21wdC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2VkaXQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9kZWxldGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1jb25maWcudHMiLCAic3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXIudHMiLCAic3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBXb3Jrc3BhY2VMZWFmLCBJdGVtVmlldywgYWRkSWNvbiwgTm90aWNlLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTWFya2Rvd25GaWxlSW5mbywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBOb3ZhU2V0dGluZ3MsIE5vdmFTZXR0aW5nVGFiLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zcmMvc2V0dGluZ3MnO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuL3NyYy9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IE5vdmFTaWRlYmFyVmlldywgVklFV19UWVBFX05PVkFfU0lERUJBUiB9IGZyb20gJy4vc3JjL3VpL3NpZGViYXItdmlldyc7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vc3JjL2NvcmUvZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi9zcmMvY29yZS9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQ29tbWFuZFBhcnNlciB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZC1wYXJzZXInO1xuaW1wb3J0IHsgUHJvbXB0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvcHJvbXB0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udmVyc2F0aW9uLW1hbmFnZXInO1xuaW1wb3J0IHsgQWRkQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvYWRkLWNvbW1hbmQnO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2VkaXQtY29tbWFuZCc7XG5pbXBvcnQgeyBEZWxldGVDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9kZWxldGUtY29tbWFuZCc7XG5pbXBvcnQgeyBHcmFtbWFyQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZ3JhbW1hci1jb21tYW5kJztcbmltcG9ydCB7IFJld3JpdGVDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9yZXdyaXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcbmltcG9ydCB7IExpY2Vuc2VWYWxpZGF0b3IgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi9zcmMvdWkvd2lraWxpbmstc3VnZ2VzdCc7XG5cbmNvbnN0IE5PVkFfSUNPTl9TVkcgPSBgXG48c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPCEtLSBDZW50cmFsIHN0YXIgY29yZSAtLT5cbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuICBcbiAgPCEtLSBQcmltYXJ5IHJheXMgKDQgbWFpbiBkaXJlY3Rpb25zKSAtLT5cbiAgPHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIFxuICA8IS0tIFNlY29uZGFyeSByYXlzIChkaWFnb25hbHMpIC0tPlxuICA8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuPC9zdmc+YDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm92YVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzITogTm92YVNldHRpbmdzO1xuXHRhaVByb3ZpZGVyTWFuYWdlciE6IEFJUHJvdmlkZXJNYW5hZ2VyO1xuXHRkb2N1bWVudEVuZ2luZSE6IERvY3VtZW50RW5naW5lO1xuXHRjb250ZXh0QnVpbGRlciE6IENvbnRleHRCdWlsZGVyO1xuXHRjb21tYW5kUGFyc2VyITogQ29tbWFuZFBhcnNlcjtcblx0cHJvbXB0QnVpbGRlciE6IFByb21wdEJ1aWxkZXI7XG5cdGNvbnZlcnNhdGlvbk1hbmFnZXIhOiBDb252ZXJzYXRpb25NYW5hZ2VyO1xuXHRhZGRDb21tYW5kSGFuZGxlciE6IEFkZENvbW1hbmQ7XG5cdGVkaXRDb21tYW5kSGFuZGxlciE6IEVkaXRDb21tYW5kO1xuXHRkZWxldGVDb21tYW5kSGFuZGxlciE6IERlbGV0ZUNvbW1hbmQ7XG5cdGdyYW1tYXJDb21tYW5kSGFuZGxlciE6IEdyYW1tYXJDb21tYW5kO1xuXHRyZXdyaXRlQ29tbWFuZEhhbmRsZXIhOiBSZXdyaXRlQ29tbWFuZDtcblx0ZmVhdHVyZU1hbmFnZXIhOiBGZWF0dXJlTWFuYWdlcjtcblx0bGljZW5zZVZhbGlkYXRvciE6IExpY2Vuc2VWYWxpZGF0b3I7XG5cdHNldHRpbmdUYWIhOiBOb3ZhU2V0dGluZ1RhYjtcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBvbmxvYWQgc3RhcnRpbmcuLi4nKTtcblx0XHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgbG9hZGVkJyk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgbGljZW5zaW5nIHN5c3RlbVxuXHRcdFx0dGhpcy5saWNlbnNlVmFsaWRhdG9yID0gbmV3IExpY2Vuc2VWYWxpZGF0b3IoKTtcblx0XHRcdHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBuZXcgRmVhdHVyZU1hbmFnZXIoXG5cdFx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvcixcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5nc1xuXHRcdFx0KTtcblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIGxpY2Vuc2UgZnJvbSBzZXR0aW5nc1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5mZWF0dXJlTWFuYWdlci51cGRhdGVDYXRhbHlzdExpY2Vuc2UodGhpcy5zZXR0aW5ncy5saWNlbnNpbmcubGljZW5zZUtleSk7XG5cdFx0XHR9XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogZmVhdHVyZSBtYW5hZ2VyIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdC8vIE5vdGU6IE1vYmlsZSBhY2Nlc3MgcmVzdHJpY3Rpb25zIGFyZSBub3cgaGFuZGxlZCBpbiBzaWRlYmFyIFVJXG5cdFx0XHQvLyBUaGlzIGFsbG93cyBDb3JlIG1vYmlsZSB1c2VycyB0byBzZWUgdGhlIHVwZ3JhZGUgaW50ZXJmYWNlIHJhdGhlciB0aGFuIGEgYnJva2VuIHBsdWdpblxuXG5cdFx0XHQvLyBSZWdpc3RlciBjdXN0b20gaWNvblxuXHRcdFx0YWRkSWNvbignbm92YS1zdGFyJywgTk9WQV9JQ09OX1NWRyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogaWNvbiByZWdpc3RlcmVkJyk7XG5cblx0XHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXIgPSBuZXcgQUlQcm92aWRlck1hbmFnZXIodGhpcy5zZXR0aW5ncywgdGhpcy5mZWF0dXJlTWFuYWdlcik7XG5cdFx0XHRhd2FpdCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyLmluaXRpYWxpemUoKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBBSSBwcm92aWRlciBtYW5hZ2VyIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgY29udmVyc2F0aW9uIG1hbmFnZXIgYW5kIGRvY3VtZW50IGVuZ2luZVxuXHRcdFx0Y29uc3QgZGF0YVN0b3JlID0ge1xuXHRcdFx0XHRsb2FkRGF0YTogKGtleTogc3RyaW5nKSA9PiB0aGlzLmxvYWREYXRhV2l0aEtleShrZXkpLFxuXHRcdFx0XHRzYXZlRGF0YTogKGtleTogc3RyaW5nLCBkYXRhOiBhbnkpID0+IHRoaXMuc2F2ZURhdGFXaXRoS2V5KGtleSwgZGF0YSlcblx0XHRcdH07XG5cdFx0XHR0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuXHRcdFx0dGhpcy5kb2N1bWVudEVuZ2luZSA9IG5ldyBEb2N1bWVudEVuZ2luZSh0aGlzLmFwcCwgZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0Q29udmVyc2F0aW9uTWFuYWdlcih0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpO1xuXHRcdFx0dGhpcy5jb250ZXh0QnVpbGRlciA9IG5ldyBDb250ZXh0QnVpbGRlcigpO1xuXHRcdFx0dGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcblx0XHRcdHRoaXMucHJvbXB0QnVpbGRlciA9IG5ldyBQcm9tcHRCdWlsZGVyKHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcik7XG5cdFx0XHRcblx0XHRcdC8vIEluaXRpYWxpemUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbnNcblx0XHRcdHRoaXMuYWRkQ29tbWFuZEhhbmRsZXIgPSBuZXcgQWRkQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmVkaXRDb21tYW5kSGFuZGxlciA9IG5ldyBFZGl0Q29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmRlbGV0ZUNvbW1hbmRIYW5kbGVyID0gbmV3IERlbGV0ZUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5ncmFtbWFyQ29tbWFuZEhhbmRsZXIgPSBuZXcgR3JhbW1hckNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5yZXdyaXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgUmV3cml0ZUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGRvY3VtZW50IGVuZ2luZSBhbmQgY29tbWFuZHMgaW5pdGlhbGl6ZWQnKTtcblxuXHRcdFx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0XHRcdFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsXG5cdFx0XHRcdChsZWFmKSA9PiBuZXcgTm92YVNpZGViYXJWaWV3KGxlYWYsIHRoaXMpXG5cdFx0XHQpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHZpZXcgcmVnaXN0ZXJlZCcpO1xuXG5cdFx0XHQvLyBOb3RlOiBXaWtpbGluayBhdXRvY29tcGxldGUgaXMgbm93IGhhbmRsZWQgZGlyZWN0bHkgaW4gc2lkZWJhciB2aWV3XG5cblx0XHRcdGNvbnN0IHJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ25vdmEtc3RhcicsICdOb3ZhIEFJJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0fSk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gYWRkZWQnKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBlbGVtZW50OicsIHJpYmJvbkljb24pO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGlubmVySFRNTDonLCByaWJib25JY29uLmlubmVySFRNTCk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gY2xhc3NMaXN0OicsIHJpYmJvbkljb24uY2xhc3NMaXN0LnRvU3RyaW5nKCkpO1xuXG5cdFx0XHQvLyBSZWdpc3RlciBjb3JlIGRvY3VtZW50IGVkaXRpbmcgY29tbWFuZHNcblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1hZGQtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBBZGQgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlQWRkQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWVkaXQtY29udGVudCcsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBFZGl0IGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUVkaXRDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtZGVsZXRlLWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogRGVsZXRlIGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZURlbGV0ZUNvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1maXgtZ3JhbW1hcicsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBGaXggZ3JhbW1hcicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlR3JhbW1hckNvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1yZXdyaXRlLWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogUmV3cml0ZSBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVSZXdyaXRlQ29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdvcGVuLW5vdmEtc2lkZWJhcicsXG5cdFx0XHRcdG5hbWU6ICdOb3ZhOiBPcGVuIHNpZGViYXInLFxuXHRcdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IGNvbW1hbmRzIHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0dGhpcy5zZXR0aW5nVGFiID0gbmV3IE5vdmFTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKTtcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nVGFiKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBzZXR0aW5ncyB0YWIgYWRkZWQnKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBvbmxvYWQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdOb3ZhOiBFcnJvciBpbiBvbmxvYWQ6JywgZXJyb3IpO1xuXHRcdH1cblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXI/LmNsZWFudXAoKTtcblx0XHR0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXI/LmNsZWFudXAoKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXI/LnVwZGF0ZVNldHRpbmdzKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0YXN5bmMgYWN0aXZhdGVWaWV3KCkge1xuXHRcdGNvbnN0IHsgd29ya3NwYWNlIH0gPSB0aGlzLmFwcDtcblxuXHRcdGxldCBsZWFmOiBXb3Jrc3BhY2VMZWFmIHwgbnVsbDtcblx0XHRjb25zdCBsZWF2ZXMgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXG5cdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRsZWFmID0gbGVhdmVzWzBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG5cdFx0XHRhd2FpdCBsZWFmPy5zZXRWaWV3U3RhdGUoeyB0eXBlOiBWSUVXX1RZUEVfTk9WQV9TSURFQkFSLCBhY3RpdmU6IHRydWUgfSk7XG5cdFx0fVxuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZiEpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBhZGQgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVBZGRDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBhZGQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgYWRkZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gYWRkIGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGVkaXQgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVFZGl0Q29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ0hvdyB3b3VsZCB5b3UgbGlrZSB0byBlZGl0IHRoZSBjb250ZW50PycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBlZGl0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gZWRpdCBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBkZWxldGUgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVEZWxldGVDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkZWxldGU/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgZGVsZXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBkZWxldGUgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZ3JhbW1hciBjb3JyZWN0aW9uIGNvbW1hbmRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlR3JhbW1hckNvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuXHRcdFx0bmV3IE5vdGljZSgnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIHRhcmdldCBiYXNlZCBvbiBzZWxlY3Rpb25cblx0XHRsZXQgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdkb2N1bWVudCcgPSAnZG9jdW1lbnQnO1xuXHRcdGxldCBpbnN0cnVjdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZXJyb3JzJztcblx0XHRcblx0XHRpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuXHRcdFx0dGFyZ2V0ID0gJ3NlbGVjdGlvbic7XG5cdFx0XHRpbnN0cnVjdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZXJyb3JzIGluIHRoZSBzZWxlY3RlZCB0ZXh0Jztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHtcblx0XHRcdFx0YWN0aW9uOiAnZ3JhbW1hcicgYXMgY29uc3QsXG5cdFx0XHRcdHRhcmdldCxcblx0XHRcdFx0aW5zdHJ1Y3Rpb25cblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdHcmFtbWFyIGNvcnJlY3RlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjb3JyZWN0IGdyYW1tYXI6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHJld3JpdGUgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVSZXdyaXRlQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ0hvdyB3b3VsZCB5b3UgbGlrZSB0byByZXdyaXRlIHRoZSBjb250ZW50PycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCByZXdyaXR0ZW4gc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmV3cml0ZSBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFByb21wdCB1c2VyIGZvciBpbnN0cnVjdGlvbiBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwcm9tcHRGb3JJbnN0cnVjdGlvbihwbGFjZWhvbGRlcjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0XHRjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0bW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsIG5vdmEtaW5wdXQtbW9kYWwnO1xuXHRcdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJnXCIgb25jbGljaz1cInRoaXMucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZSgpOyByZXNvbHZlKG51bGwpO1wiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHRcdDxoMz5Ob3ZhIEFJIENvbW1hbmQ8L2gzPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kYWwtY2xvc2UtYnV0dG9uXCIgb25jbGljaz1cInRoaXMuY2xvc2VzdCgnLm1vZGFsJykucmVtb3ZlKCk7IHJlc29sdmUobnVsbCk7XCI+XHUwMEQ3PC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHRcdDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwibm92YS1pbnN0cnVjdGlvbi1pbnB1dFwiIHBsYWNlaG9sZGVyPVwiJHtwbGFjZWhvbGRlcn1cIiBhdXRvZm9jdXM+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cblx0XHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS1zdWJtaXQtYnRuXCI+RXhlY3V0ZTwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jYW5jZWwtYnRuXCI+Q2FuY2VsPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBpbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWluc3RydWN0aW9uLWlucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcblx0XHRcdGNvbnN0IHN1Ym1pdEJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXN1Ym1pdC1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRcdGNvbnN0IGNhbmNlbEJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNhbmNlbC1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblxuXHRcdFx0Y29uc3QgaGFuZGxlU3VibWl0ID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlLnRyaW0oKTtcblx0XHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0XHRcdHJlc29sdmUodmFsdWUgfHwgbnVsbCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRjb25zdCBoYW5kbGVDYW5jZWwgPSAoKSA9PiB7XG5cdFx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdFx0XHRyZXNvbHZlKG51bGwpO1xuXHRcdFx0fTtcblxuXHRcdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG5cdFx0XHRcdGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRoYW5kbGVTdWJtaXQoKTtcblx0XHRcdFx0fSBlbHNlIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0aGFuZGxlQ2FuY2VsKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVTdWJtaXQpO1xuXHRcdFx0Y2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ2FuY2VsKTtcblxuXHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cdFx0XHRpbnB1dC5mb2N1cygpO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNob3cgdXBncmFkZSBwcm9tcHQgZm9yIENvcmUgdGllciBtb2JpbGUgdXNlcnNcblx0ICovXG5cdHByaXZhdGUgc2hvd01vYmlsZVVwZ3JhZGVQcm9tcHQoKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRtb2RhbC5jbGFzc05hbWUgPSAnbW9kYWwgbm92YS1tb2JpbGUtdXBncmFkZS1tb2RhbCc7XG5cdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYmdcIj48L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHQ8aDM+Tm92YSBTdXBlck5vdmEgUmVxdWlyZWQ8L2gzPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aWVyLWJhZGdlIGNvcmVcIiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDFlbTtcIj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLWljb25cIj5GUkVFPC9zcGFuPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItbmFtZVwiPkNvcmUgKEZyZWUpPC9zcGFuPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8cD5Nb2JpbGUgYWNjZXNzIGlzIGF2YWlsYWJsZSB3aXRoIE5vdmEgU3VwZXJOb3ZhLjwvcD5cblx0XHRcdFx0XHRcdDxwPkNvcmUgdGllciBpcyBsaW1pdGVkIHRvIGRlc2t0b3AgdXNlIG9ubHkuPC9wPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtZmVhdHVyZS1saXN0XCI+XG5cdFx0XHRcdFx0XHRcdDxoND5TdXBlck5vdmEgaW5jbHVkZXM6PC9oND5cblx0XHRcdFx0XHRcdFx0PHVsPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Nb2JpbGUgZGV2aWNlIHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5NdWx0aXBsZSBBSSBwcm92aWRlcnM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Jbi1jaGF0IHByb3ZpZGVyIHN3aXRjaGluZzwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkFkdmFuY2VkIHRlbXBsYXRlczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS11cGdyYWRlLWJ0blwiPlVwZ3JhZGUgdG8gU3VwZXJOb3ZhPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jbG9zZS1idG5cIj5DbG9zZTwvYnV0dG9uPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHRjb25zdCB1cGdyYWRlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtdXBncmFkZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBjbG9zZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNsb3NlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IG1vZGFsQmcgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYmcnKSBhcyBIVE1MRWxlbWVudDtcblxuXHRcdGNvbnN0IGNsb3NlTW9kYWwgPSAoKSA9PiB7XG5cdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHR9O1xuXG5cdFx0dXBncmFkZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHdpbmRvdy5vcGVuKCdodHRwczovL25vdmF3cml0ZXIuYWkvdXBncmFkZScsICdfYmxhbmsnKTtcblx0XHRcdGNsb3NlTW9kYWwoKTtcblx0XHR9KTtcblxuXHRcdGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cdFx0bW9kYWxCZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cblx0XHQvLyBTaG93IG5vdGljZSBhcyB3ZWxsXG5cdFx0bmV3IE5vdGljZSgnTm92YSBtb2JpbGUgYWNjZXNzIHJlcXVpcmVzIFN1cGVyTm92YSBsaWNlbnNlJywgODAwMCk7XG5cdH1cblxuXHQvLyBEYXRhU3RvcmUgaW50ZXJmYWNlIGltcGxlbWVudGF0aW9uIGZvciBDb252ZXJzYXRpb25NYW5hZ2VyXG5cdGFzeW5jIGxvYWREYXRhV2l0aEtleShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcblx0XHRyZXR1cm4gYWxsRGF0YSA/IGFsbERhdGFba2V5XSA6IHVuZGVmaW5lZDtcblx0fVxuXG5cdGFzeW5jIHNhdmVEYXRhV2l0aEtleShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKSB8fCB7fTtcblx0XHRhbGxEYXRhW2tleV0gPSBkYXRhO1xuXHRcdHJldHVybiBhd2FpdCB0aGlzLnNhdmVEYXRhKGFsbERhdGEpO1xuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXJTZXR0aW5ncywgUGxhdGZvcm1TZXR0aW5ncywgUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi9haS90eXBlcyc7XG5pbXBvcnQgeyBEZWJ1Z1NldHRpbmdzIH0gZnJvbSAnLi9saWNlbnNpbmcvdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbUNvbW1hbmQge1xuXHRpZDogc3RyaW5nO1xuXHRuYW1lOiBzdHJpbmc7XG5cdHRyaWdnZXI6IHN0cmluZztcblx0dGVtcGxhdGU6IHN0cmluZztcblx0ZGVzY3JpcHRpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTm92YVNldHRpbmdzIHtcblx0YWlQcm92aWRlcnM6IEFJUHJvdmlkZXJTZXR0aW5ncztcblx0cGxhdGZvcm1TZXR0aW5nczogUGxhdGZvcm1TZXR0aW5ncztcblx0Y3VzdG9tQ29tbWFuZHM/OiBDdXN0b21Db21tYW5kW107XG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IG51bWJlcjtcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiBudW1iZXI7XG5cdFx0YXV0b1NhdmU6IGJvb2xlYW47XG5cdH07XG5cdGxpY2Vuc2luZzoge1xuXHRcdGxpY2Vuc2VLZXk6IHN0cmluZztcblx0XHRjYXRhbHlzdExpY2Vuc2VLZXk/OiBzdHJpbmc7XG5cdFx0aXNDYXRhbHlzdD86IGJvb2xlYW47XG5cdFx0ZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncztcblx0fTtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE5vdmFTZXR0aW5ncyA9IHtcblx0YWlQcm92aWRlcnM6IHtcblx0XHRjbGF1ZGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2NsYXVkZS1zb25uZXQtNCcsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvcGVuYWk6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRiYXNlVXJsOiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScsXG5cdFx0XHRtb2RlbDogJ2dwdC00bycsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRnb29nbGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNS0yMCcsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvbGxhbWE6IHtcblx0XHRcdGJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jyxcblx0XHRcdG1vZGVsOiAnJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9XG5cdH0sXG5cdHBsYXRmb3JtU2V0dGluZ3M6IHtcblx0XHRkZXNrdG9wOiB7XG5cdFx0XHRwcmltYXJ5UHJvdmlkZXI6ICdvbGxhbWEnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdH0sXG5cdFx0bW9iaWxlOiB7XG5cdFx0XHRwcmltYXJ5UHJvdmlkZXI6ICdub25lJyxcblx0XHRcdGZhbGxiYWNrUHJvdmlkZXJzOiBbJ29wZW5haScsICdnb29nbGUnXVxuXHRcdH1cblx0fSxcblx0Y3VzdG9tQ29tbWFuZHM6IFtdLFxuXHRnZW5lcmFsOiB7XG5cdFx0ZGVmYXVsdFRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0ZGVmYXVsdE1heFRva2VuczogMTAwMCxcblx0XHRhdXRvU2F2ZTogdHJ1ZVxuXHR9LFxuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiAnJyxcblx0XHRjYXRhbHlzdExpY2Vuc2VLZXk6ICcnLFxuXHRcdGlzQ2F0YWx5c3Q6IGZhbHNlLFxuXHRcdGRlYnVnU2V0dGluZ3M6IHtcblx0XHRcdGVuYWJsZWQ6IGZhbHNlLFxuXHRcdFx0b3ZlcnJpZGVEYXRlOiB1bmRlZmluZWQsXG5cdFx0XHRmb3JjZUNhdGFseXN0OiBmYWxzZVxuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGNsYXNzIE5vdmFTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnTm92YSBBSSBTZXR0aW5ncycgfSk7XG5cblx0XHR0aGlzLmNyZWF0ZUxpY2Vuc2VTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlR2VuZXJhbFNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQbGF0Zm9ybVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlclNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kU2V0dGluZ3MoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlTGljZW5zZVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29uc3QgbGljZW5zZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zZWN0aW9uJyB9KTtcblx0XHRsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0NhdGFseXN0IFN1cHBvcnRlciBTdGF0dXMnIH0pO1xuXG5cdFx0Ly8gSW5mbyBhYm91dCB0aGUgbmV3IG1vZGVsXG5cdFx0Y29uc3QgaW5mb0VsID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0PkFsbCBGZWF0dXJlcyBBdmFpbGFibGU8L2g0PlxuXHRcdFx0XHQ8cD5Ob3ZhIHByb3ZpZGVzIGFsbCBmZWF0dXJlcyBmb3IgZnJlZSB3aGVuIHlvdSB1c2UgeW91ciBvd24gQUkgcHJvdmlkZXIgQVBJIGtleXMuIFxuXHRcdFx0XHRDYXRhbHlzdCBzdXBwb3J0ZXJzIGdldCBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzIGJlZm9yZSB0aGV5J3JlIHJlbGVhc2VkIHRvIGV2ZXJ5b25lLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IENhdGFseXN0IHN0YXR1c1xuXHRcdGNvbnN0IGlzQ2F0YWx5c3QgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uZ2V0SXNDYXRhbHlzdFN1cHBvcnRlcigpIHx8IGZhbHNlO1xuXHRcdGNvbnN0IGNhdGFseXN0TGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRDYXRhbHlzdExpY2Vuc2UoKTtcblx0XHRcblx0XHRjb25zdCBzdGF0dXNEaXNwbGF5ID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNhdGFseXN0LXN0YXR1cycgfSk7XG5cdFx0Y29uc3Qgc3RhdHVzVGV4dCA9IGlzQ2F0YWx5c3QgPyAnQ2F0YWx5c3QgU3VwcG9ydGVyJyA6ICdOb3ZhIFVzZXInO1xuXHRcdGNvbnN0IHN0YXR1c0ljb24gPSBpc0NhdGFseXN0ID8gJ1x1MjZBMScgOiAnXHUyNjA1JzsgLy8gTGlnaHRuaW5nIGZvciBDYXRhbHlzdCwgU3RhciBmb3IgTm92YVxuXHRcdHN0YXR1c0Rpc3BsYXkuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3RhdHVzLWJhZGdlICR7aXNDYXRhbHlzdCA/ICdjYXRhbHlzdCcgOiAnbm92YSd9XCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLWljb25cIj4ke3N0YXR1c0ljb259PC9zcGFuPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInN0YXR1cy1uYW1lXCI+JHtzdGF0dXNUZXh0fTwvc3Bhbj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBDYXRhbHlzdCBsaWNlbnNlIHN0YXR1c1xuXHRcdGlmIChjYXRhbHlzdExpY2Vuc2UpIHtcblx0XHRcdGNvbnN0IHN0YXR1c0VsID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxpY2Vuc2Utc3RhdHVzJyB9KTtcblx0XHRcdGNvbnN0IGV4cGlyeVRleHQgPSBjYXRhbHlzdExpY2Vuc2UuZXhwaXJlc0F0IFxuXHRcdFx0XHQ/IGBFeHBpcmVzOiAke2NhdGFseXN0TGljZW5zZS5leHBpcmVzQXQudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdFx0XHQ6ICdMaWZldGltZSBTdXBwb3J0Jztcblx0XHRcdHN0YXR1c0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cImxpY2Vuc2UtaW5mb1wiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1lbWFpbFwiPiR7Y2F0YWx5c3RMaWNlbnNlLmVtYWlsfTwvc3Bhbj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImxpY2Vuc2UtZXhwaXJ5XCI+JHtleHBpcnlUZXh0fTwvc3Bhbj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIENhdGFseXN0IGxpY2Vuc2Uga2V5IGlucHV0XG5cdFx0bmV3IFNldHRpbmcobGljZW5zZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdDYXRhbHlzdCBMaWNlbnNlIEtleSAoT3B0aW9uYWwpJylcblx0XHRcdC5zZXREZXNjKCdFbnRlciB5b3VyIENhdGFseXN0IHN1cHBvcnRlciBsaWNlbnNlIGtleSBmb3IgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcycpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAncGFzc3dvcmQnO1xuXHRcdFx0XHR0ZXh0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBDYXRhbHlzdCBsaWNlbnNlIGtleS4uLicpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5jYXRhbHlzdExpY2Vuc2VLZXkgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmNhdGFseXN0TGljZW5zZUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBDYXRhbHlzdCBsaWNlbnNlIGluIGZlYXR1cmUgbWFuYWdlclxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZUNhdGFseXN0TGljZW5zZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCB0aGUgZGlzcGxheSB0byBzaG93IHVwZGF0ZWQgc3RhdHVzXG5cdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIEFkZCB2YWxpZGF0aW9uIGJ1dHRvblxuXHRcdFx0XHRjb25zdCB2YWxpZGF0ZUJ1dHRvbiA9IHRleHQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5jcmVhdGVFbCgnYnV0dG9uJywge1xuXHRcdFx0XHRcdHRleHQ6ICdWYWxpZGF0ZScsXG5cdFx0XHRcdFx0Y2xzOiAnbm92YS12YWxpZGF0ZS1idG4nXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHZhbGlkYXRlQnV0dG9uKSB7XG5cdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBsaWNlbnNlS2V5ID0gdGV4dC5pbnB1dEVsLnZhbHVlO1xuXHRcdFx0XHRcdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdQbGVhc2UgZW50ZXIgYSBDYXRhbHlzdCBsaWNlbnNlIGtleSBmaXJzdC4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdWYWxpZGF0aW5nLi4uJztcblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlQ2F0YWx5c3RMaWNlbnNlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGlzQ2F0YWx5c3QgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5nZXRJc0NhdGFseXN0U3VwcG9ydGVyKCk7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzQ2F0YWx5c3QpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdWYWxpZCBDYXRhbHlzdCBsaWNlbnNlISBZb3Ugbm93IGhhdmUgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy4nLCAnc3VjY2VzcycpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnSW52YWxpZCBvciBleHBpcmVkIENhdGFseXN0IGxpY2Vuc2Uga2V5LicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXlcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0Vycm9yIHZhbGlkYXRpbmcgQ2F0YWx5c3QgbGljZW5zZS4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdH0gZmluYWxseSB7XG5cdFx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLnRleHRDb250ZW50ID0gJ1ZhbGlkYXRlJztcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHQvLyBGZWF0dXJlcyBjb21wYXJpc29uXG5cdFx0dGhpcy5jcmVhdGVGZWF0dXJlQ29tcGFyaXNvbihsaWNlbnNlQ29udGFpbmVyKTtcblxuXHRcdC8vIERlYnVnIHNldHRpbmdzIChkZXZlbG9wbWVudCBvbmx5KVxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyB8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHR0aGlzLmNyZWF0ZURlYnVnU2V0dGluZ3MobGljZW5zZUNvbnRhaW5lcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVGZWF0dXJlQ29tcGFyaXNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgY29tcGFyaXNvbkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWZlYXR1cmUtY29tcGFyaXNvbicgfSk7XG5cdFx0Y29tcGFyaXNvbkNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdOb3ZhIEZlYXR1cmVzJyB9KTtcblxuXHRcdC8vIEZlYXR1cmUgc3VtbWFyeVxuXHRcdGNvbnN0IHN1bW1hcnlFbCA9IGNvbXBhcmlzb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1mZWF0dXJlLXN1bW1hcnknIH0pO1xuXHRcdHN1bW1hcnlFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1hdmFpbGFibGUtbm93XCI+XG5cdFx0XHRcdDxoNT5BdmFpbGFibGUgTm93IChGcmVlIHdpdGggWW91ciBBUEkgS2V5cyk8L2g1PlxuXHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0PGxpPkFsbCBBSSBQcm92aWRlcnMgKENsYXVkZSwgT3BlbkFJLCBHZW1pbmksIE9sbGFtYSk8L2xpPlxuXHRcdFx0XHRcdDxsaT5Db21wbGV0ZSBEb2N1bWVudCBFZGl0aW5nIFN1aXRlPC9saT5cblx0XHRcdFx0XHQ8bGk+Q2hhdCBJbnRlcmZhY2Ugd2l0aCBDb252ZXJzYXRpb24gSGlzdG9yeTwvbGk+XG5cdFx0XHRcdFx0PGxpPlByb3ZpZGVyIFN3aXRjaGluZzwvbGk+XG5cdFx0XHRcdFx0PGxpPkZ1bGwgTW9iaWxlIFN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdDxsaT5GaWxlLVNjb3BlZCBDb252ZXJzYXRpb25zPC9saT5cblx0XHRcdFx0PC91bD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBHZXQgdXBjb21pbmcgZmVhdHVyZXMgZm9yIENhdGFseXN0IHN1cHBvcnRlcnNcblx0XHRjb25zdCBmZWF0dXJlU3VtbWFyeSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRGZWF0dXJlU3VtbWFyeSgpO1xuXHRcdGlmIChmZWF0dXJlU3VtbWFyeSAmJiBmZWF0dXJlU3VtbWFyeS5jb21pbmdTb29uLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IHVwY29taW5nRWwgPSBjb21wYXJpc29uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtdXBjb21pbmctZmVhdHVyZXMnIH0pO1xuXHRcdFx0dXBjb21pbmdFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhdGFseXN0LXByZXZpZXdcIj5cblx0XHRcdFx0XHQ8aDU+Q29taW5nIFNvb24gZm9yIENhdGFseXN0IFN1cHBvcnRlcnM8L2g1PlxuXHRcdFx0XHRcdDx1bD5cblx0XHRcdFx0XHRcdCR7ZmVhdHVyZVN1bW1hcnkuY29taW5nU29vbi5tYXAoZmVhdHVyZSA9PiBgXG5cdFx0XHRcdFx0XHRcdDxsaT5BdmFpbGFibGUgJHtmZWF0dXJlLmF2YWlsYWJsZURhdGV9ICR7ZmVhdHVyZS5pc0NhdGFseXN0ID8gJyhZb3UgaGF2ZSBlYXJseSBhY2Nlc3MhKScgOiAnJ308L2xpPlxuXHRcdFx0XHRcdFx0YCkuam9pbignJyl9XG5cdFx0XHRcdFx0PC91bD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIENhdGFseXN0IHN1cHBvcnRlciBpbmZvcm1hdGlvblxuXHRcdGNvbnN0IGNhdGFseXN0SW5mbyA9IGNvbXBhcmlzb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jYXRhbHlzdC1pbmZvJyB9KTtcblx0XHRjYXRhbHlzdEluZm8uaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoNT5CZWNvbWUgYSBDYXRhbHlzdCBTdXBwb3J0ZXI8L2g1PlxuXHRcdFx0XHQ8cD5TdXBwb3J0IE5vdmEgZGV2ZWxvcG1lbnQgYW5kIGdldCBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLiBBbGwgZmVhdHVyZXMgZXZlbnR1YWxseSBiZWNvbWUgZnJlZSBmb3IgZXZlcnlvbmUuPC9wPlxuXHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0PGxpPkVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMgKDMtNiBtb250aHMgYmVmb3JlIGdlbmVyYWwgcmVsZWFzZSk8L2xpPlxuXHRcdFx0XHRcdDxsaT5Qcmlvcml0eSBzdXBwb3J0IGFuZCBmZWF0dXJlIHJlcXVlc3RzPC9saT5cblx0XHRcdFx0XHQ8bGk+U3VwcG9ydGVyIGJhZGdlIGFuZCByZWNvZ25pdGlvbjwvbGk+XG5cdFx0XHRcdFx0PGxpPkRpcmVjdGx5IHN1cHBvcnQgb3Blbi1zb3VyY2UgZGV2ZWxvcG1lbnQ8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlRGVidWdTZXR0aW5ncyhjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgZGVidWdDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kZWJ1Zy1zZWN0aW9uJyB9KTtcblx0XHRkZWJ1Z0NvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXZlbG9wbWVudCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdEZWJ1ZyBNb2RlJylcblx0XHRcdC5zZXREZXNjKCdFbmFibGUgZGV2ZWxvcG1lbnQgdGVzdGluZyBmZWF0dXJlcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5IHRvIHNob3cvaGlkZSBkZWJ1ZyBvcHRpb25zXG5cdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ092ZXJyaWRlIERhdGUnKVxuXHRcdFx0XHQuc2V0RGVzYygnT3ZlcnJpZGUgY3VycmVudCBkYXRlIGZvciB0ZXN0aW5nIHRpbWUtZ2F0ZWQgZmVhdHVyZXMgKFlZWVktTU0tREQpJylcblx0XHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCcyMDI1LTEyLTAxJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlIHx8ICcnKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSA9IHZhbHVlIHx8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggZGlzcGxheVxuXHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0fSkpO1xuXG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ0ZvcmNlIENhdGFseXN0IFN0YXR1cycpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBDYXRhbHlzdCBzdXBwb3J0ZXIgc3RhdHVzIGZvciB0ZXN0aW5nJylcblx0XHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlQ2F0YWx5c3QgfHwgZmFsc2UpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VDYXRhbHlzdCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5XG5cdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9KSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93TGljZW5zZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InKSB7XG5cdFx0Ly8gQ3JlYXRlIG9yIHVwZGF0ZSBtZXNzYWdlIGVsZW1lbnRcblx0XHRjb25zdCBleGlzdGluZ01lc3NhZ2UgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWxpY2Vuc2UtbWVzc2FnZScpO1xuXHRcdGlmIChleGlzdGluZ01lc3NhZ2UpIHtcblx0XHRcdGV4aXN0aW5nTWVzc2FnZS5yZW1vdmUoKTtcblx0XHR9XG5cblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IFxuXHRcdFx0Y2xzOiBgbm92YS1saWNlbnNlLW1lc3NhZ2UgJHt0eXBlfWAsXG5cdFx0XHR0ZXh0OiBtZXNzYWdlXG5cdFx0fSk7XG5cblx0XHQvLyBBdXRvLXJlbW92ZSBhZnRlciA1IHNlY29uZHNcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdG1lc3NhZ2VFbC5yZW1vdmUoKTtcblx0XHR9LCA1MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR2VuZXJhbFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnR2VuZXJhbCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IFRlbXBlcmF0dXJlJylcblx0XHRcdC5zZXREZXNjKCdDb250cm9scyByYW5kb21uZXNzIGluIEFJIHJlc3BvbnNlcyAoMC4wIC0gMS4wKScpXG5cdFx0XHQuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcblx0XHRcdFx0LnNldExpbWl0cygwLCAxLCAwLjEpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSlcblx0XHRcdFx0LnNldER5bmFtaWNUb29sdGlwKClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgTWF4IFRva2VucycpXG5cdFx0XHQuc2V0RGVzYygnTWF4aW11bSBsZW5ndGggb2YgQUkgcmVzcG9uc2VzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzEwMDAnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zLnRvU3RyaW5nKCkpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zdCBudW1WYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcblx0XHRcdFx0XHRpZiAoIWlzTmFOKG51bVZhbHVlKSAmJiBudW1WYWx1ZSA+IDApIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2VucyA9IG51bVZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdBdXRvLXNhdmUgc2V0dGluZ3MnKVxuXHRcdFx0LnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgc2F2ZSBzZXR0aW5ncyB3aGVuIGNoYW5nZWQnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5hdXRvU2F2ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVByb3ZpZGVyU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdBSSBQcm92aWRlciBTZXR0aW5ncycgfSk7XG5cblx0XHQvLyBJbmZvIGFib3V0IEFQSSBrZXlzXG5cdFx0Y29uc3QgaW5mb0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5Db25maWd1cmUgWW91ciBBUEkgS2V5czwvaDQ+XG5cdFx0XHRcdDxwPk5vdmEgY29ubmVjdHMgdG8gQUkgcHJvdmlkZXJzIHVzaW5nIHlvdXIgb3duIEFQSSBrZXlzLiBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIC0gXG5cdFx0XHRcdGp1c3QgYWRkIHlvdXIgQVBJIGtleXMgYmVsb3cgdG8gZ2V0IHN0YXJ0ZWQuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIFNob3cgYWxsIHByb3ZpZGVycyAtIG5vIHJlc3RyaWN0aW9uc1xuXHRcdHRoaXMuY3JlYXRlT2xsYW1hU2V0dGluZ3MoKTtcblx0XHR0aGlzLmNyZWF0ZUNsYXVkZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVHb29nbGVTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlT3BlbkFJU2V0dGluZ3MoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2xhdWRlU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHRjb25zdCBjbGF1ZGVDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdGNsYXVkZUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDbGF1ZGUgKEFudGhyb3BpYyknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY2xhdWRlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgQW50aHJvcGljIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignc2stYW50LS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjbGF1ZGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ0NsYXVkZSBtb2RlbCB0byB1c2UnKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZS1zb25uZXQtNCcsICdDbGF1ZGUgU29ubmV0IDQnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUtb3B1cy00JywgJ0NsYXVkZSBPcHVzIDQnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUtMy1oYWlrdS0yMDI0MDMwNycsICdDbGF1ZGUgMyBIYWlrdScpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2NsYXVkZS0zLXNvbm5ldC0yMDI0MDIyOScsICdDbGF1ZGUgMyBTb25uZXQnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdjbGF1ZGUtMy1vcHVzLTIwMjQwMjI5JywgJ0NsYXVkZSAzIE9wdXMnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsIHx8ICdjbGF1ZGUtc29ubmV0LTQnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cblx0cHJpdmF0ZSBjcmVhdGVPcGVuQUlTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdGNvbnN0IG9wZW5haUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0b3BlbmFpQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ09wZW5BSScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBPcGVuQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay0uLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Jhc2UgVVJMJylcblx0XHRcdC5zZXREZXNjKCdPcGVuQUkgQVBJIGJhc2UgVVJMIChmb3IgY3VzdG9tIGVuZHBvaW50cyknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYmFzZVVybCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5iYXNlVXJsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT3BlbkFJIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cblx0XHRcdFx0LmFkZE9wdGlvbignZ3B0LTRvJywgJ0dQVC00bycpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dwdC0zLjUtdHVyYm8nLCAnR1BULTMuNSBUdXJibycpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dwdC00JywgJ0dQVC00Jylcblx0XHRcdFx0LmFkZE9wdGlvbignZ3B0LTQtdHVyYm8tcHJldmlldycsICdHUFQtNCBUdXJibycpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgfHwgJ2dwdC00bycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHb29nbGVTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdGNvbnN0IGdvb2dsZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0Z29vZ2xlQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dvb2dsZSAoR2VtaW5pKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhnb29nbGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBHb29nbGUgQUkgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdBSS4uLicpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5IHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhnb29nbGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ0dlbWluaSBtb2RlbCB0byB1c2UnKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNS0yMCcsICdHZW1pbmkgMi41IEZsYXNoIFByZXZpZXcnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdnZW1pbmktMi41LXByby1wcmV2aWV3LTA2LTA1JywgJ0dlbWluaSAyLjUgUHJvIFByZXZpZXcnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdnZW1pbmktMS41LWZsYXNoJywgJ0dlbWluaSAxLjUgRmxhc2gnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCdnZW1pbmktMS41LXBybycsICdHZW1pbmkgMS41IFBybycpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUubW9kZWwgfHwgJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNS0yMCcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVPbGxhbWFTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnN0IG9sbGFtYUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0b2xsYW1hQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ09sbGFtYSAoTG9jYWwpJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdCYXNlIFVSTCcpXG5cdFx0XHQuc2V0RGVzYygnT2xsYW1hIHNlcnZlciBVUkwnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignaHR0cDovL2xvY2FsaG9zdDoxMTQzNCcpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT2xsYW1hIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdsbGFtYTInKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLm1vZGVsIHx8ICcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUGxhdGZvcm1TZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1BsYXRmb3JtIFNldHRpbmdzJyB9KTtcblxuXHRcdGNvbnN0IHBsYXRmb3JtQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHQvLyBJbmZvIGFib3V0IHBsYXRmb3JtIHNldHRpbmdzXG5cdFx0Y29uc3QgaW5mb0VsID0gcGxhdGZvcm1Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5cdUQ4M0RcdUREQTVcdUZFMEYgUGxhdGZvcm0gQ29uZmlndXJhdGlvbjwvaDQ+XG5cdFx0XHRcdDxwPkNvbmZpZ3VyZSB3aGljaCBBSSBwcm92aWRlciB0byB1c2UgYXMgeW91ciBwcmltYXJ5IHByb3ZpZGVyIG9uIGRpZmZlcmVudCBwbGF0Zm9ybXMuIFxuXHRcdFx0XHROb3ZhIHdvcmtzIHNlYW1sZXNzbHkgYWNyb3NzIGRlc2t0b3AgYW5kIG1vYmlsZSB3aXRoIGFsbCBwcm92aWRlcnMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXNrdG9wJyB9KTtcblx0XHRjb25zdCBkZXNrdG9wRHJvcGRvd24gPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBkZXNrdG9wJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRcdGNvbnN0IGFsbG93ZWRQcm92aWRlcnMgPSB0aGlzLmdldEFsbG93ZWRQcm92aWRlcnNGb3JQbGF0Zm9ybSgnZGVza3RvcCcpO1xuXHRcdFx0XHRcblx0XHRcdFx0YWxsb3dlZFByb3ZpZGVycy5mb3JFYWNoKHByb3ZpZGVyID0+IHtcblx0XHRcdFx0XHRjb25zdCBsYWJlbCA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcik7XG5cdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHByb3ZpZGVyLCBsYWJlbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AucHJpbWFyeVByb3ZpZGVyID0gdmFsdWUgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdNb2JpbGUnIH0pO1xuXHRcdGNvbnN0IG1vYmlsZVNldHRpbmcgPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBtb2JpbGUgZGV2aWNlcycpO1xuXHRcdFx0XG5cdFx0bW9iaWxlU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0LmFkZE9wdGlvbignbm9uZScsICdOb25lIChEaXNhYmxlZCknKVxuXHRcdFx0LmFkZE9wdGlvbignY2xhdWRlJywgJ0NsYXVkZScpXG5cdFx0XHQuYWRkT3B0aW9uKCdvcGVuYWknLCAnT3BlbkFJJylcblx0XHRcdC5hZGRPcHRpb24oJ2dvb2dsZScsICdHb29nbGUnKVxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlcilcblx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKHBsYXRmb3JtOiAnZGVza3RvcCcgfCAnbW9iaWxlJyk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIGluIHRoZSBDYXRhbHlzdCBtb2RlbFxuXHRcdHJldHVybiBwbGF0Zm9ybSA9PT0gJ2Rlc2t0b3AnIFxuXHRcdFx0PyBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0XHQ6IFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnXTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcjogUHJvdmlkZXJUeXBlKTogc3RyaW5nIHtcblx0XHRjb25zdCBuYW1lczogUmVjb3JkPFByb3ZpZGVyVHlwZSwgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnQ2xhdWRlIChBbnRocm9waWMpJyxcblx0XHRcdCdvcGVuYWknOiAnT3BlbkFJJyxcblx0XHRcdCdnb29nbGUnOiAnR29vZ2xlIChHZW1pbmkpJywgXG5cdFx0XHQnb2xsYW1hJzogJ09sbGFtYSAoTG9jYWwpJyxcblx0XHRcdCdub25lJzogJ05vbmUgKERpc2FibGVkKSdcblx0XHR9O1xuXHRcdHJldHVybiBuYW1lc1twcm92aWRlcl0gfHwgcHJvdmlkZXI7XG5cdH1cblxuXHRhc3luYyBzZXRDdXJyZW50UHJvdmlkZXIocHJvdmlkZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVySWQgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29uc3QgY29tbWFuZENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1zZWN0aW9uJyB9KTtcblx0XHRjb21tYW5kQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0N1c3RvbSBDb21tYW5kcycgfSk7XG5cblx0XHQvLyBGZWF0dXJlIGF2YWlsYWJpbGl0eSBub3RpY2Vcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2N1c3RvbS1jb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBub3RpY2VFbCA9IGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1mZWF0dXJlLW5vdGljZScgfSk7XG5cdFx0XHRub3RpY2VFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAxMnB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgYm9yZGVyLXJhZGl1czogOHB4OyBtYXJnaW4tYm90dG9tOiAxNnB4O1wiPlxuXHRcdFx0XHRcdDxwIHN0eWxlPVwibWFyZ2luOiAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07XCI+XG5cdFx0XHRcdFx0XHRDdXN0b20gY29tbWFuZHMgYXJlIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIENhdGFseXN0IHN1cHBvcnRlcnMuIFxuXHRcdFx0XHRcdFx0VGhleSB3aWxsIGJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgb24gU2VwdGVtYmVyIDE1LCAyMDI1LlxuXHRcdFx0XHRcdDwvcD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERlc2NyaXB0aW9uXG5cdFx0Y29uc3QgZGVzY0VsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzY3JpcHRpb24nIH0pO1xuXHRcdGRlc2NFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8cCBzdHlsZT1cImNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgbWFyZ2luLWJvdHRvbTogMTZweDtcIj5cblx0XHRcdFx0Q3JlYXRlIGN1c3RvbSBjb21tYW5kIHNob3J0Y3V0cyB0aGF0IGluc2VydCBwcmVkZWZpbmVkIHRleHQgdGVtcGxhdGVzIHdoZW4gdHJpZ2dlcmVkIHdpdGggPGNvZGU+OnRyaWdnZXI8L2NvZGU+LlxuXHRcdFx0PC9wPlxuXHRcdGA7XG5cblx0XHQvLyBDb21tYW5kcyBsaXN0XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29tbWFuZENvbnRhaW5lcik7XG5cblx0XHQvLyBBZGQgbmV3IGNvbW1hbmQgYnV0dG9uXG5cdFx0Y29uc3QgYnV0dG9uRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYWRkLWNvbW1hbmQnIH0pO1xuXHRcdGJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luLXRvcDogMTZweDsnO1xuXHRcdFxuXHRcdGNvbnN0IGFkZEJ1dHRvbiA9IG5ldyBTZXR0aW5nKGJ1dHRvbkVsKVxuXHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gXG5cdFx0XHRcdGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCcrIEFkZCBDdXN0b20gQ29tbWFuZCcpXG5cdFx0XHRcdFx0LnNldEN0YSgpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5zaG93QWRkQ29tbWFuZERpYWxvZygpKVxuXHRcdFx0KTtcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBjb21tYW5kcyBsaXN0XG5cdFx0Y29uc3QgZXhpc3RpbmdMaXN0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmRzLWxpc3QnKTtcblx0XHRpZiAoZXhpc3RpbmdMaXN0KSBleGlzdGluZ0xpc3QucmVtb3ZlKCk7XG5cblx0XHRjb25zdCBjb21tYW5kc0xpc3QgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kcy1saXN0JyB9KTtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXG5cdFx0aWYgKGNvbW1hbmRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Y29uc3QgZW1wdHlFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWVtcHR5JyB9KTtcblx0XHRcdGVtcHR5RWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAyNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XCI+XG5cdFx0XHRcdFx0PHA+Tm8gY3VzdG9tIGNvbW1hbmRzIHlldC48L3A+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJmb250LXNpemU6IDAuOWVtO1wiPkNyZWF0ZSB5b3VyIGZpcnN0IGNvbW1hbmQgdG8gZ2V0IHN0YXJ0ZWQhPC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGNvbW1hbmRFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRjb21tYW5kRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRcdHBhZGRpbmc6IDE2cHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDEycHg7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRgO1xuXG5cdFx0XHQvLyBDb21tYW5kIGhlYWRlclxuXHRcdFx0Y29uc3QgaGVhZGVyRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWhlYWRlcicgfSk7XG5cdFx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IG1hcmdpbi1ib3R0b206IDhweDsnO1xuXG5cdFx0XHRjb25zdCBpbmZvRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaW5mbycgfSk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGluZm9FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbmFtZScgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNjAwOyBtYXJnaW4tYm90dG9tOiA0cHg7JztcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC5pbm5lckhUTUwgPSBgPGNvZGU+OiR7Y29tbWFuZC50cmlnZ2VyfTwvY29kZT5gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gQWN0aW9uc1xuXHRcdFx0Y29uc3QgYWN0aW9uc0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWFjdGlvbnMnIH0pO1xuXHRcdFx0YWN0aW9uc0VsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7JztcblxuXHRcdFx0Y29uc3QgZWRpdEJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRWRpdCcgfSk7XG5cdFx0XHRlZGl0QnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4Oyc7XG5cdFx0XHRlZGl0QnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnNob3dFZGl0Q29tbWFuZERpYWxvZyhpbmRleCk7XG5cblx0XHRcdGNvbnN0IGRlbGV0ZUJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRGVsZXRlJyB9KTtcblx0XHRcdGRlbGV0ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGZvbnQtc2l6ZTogMC44ZW07IGJvcmRlci1yYWRpdXM6IDRweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvcik7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7Jztcblx0XHRcdGRlbGV0ZUJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5kZWxldGVDb21tYW5kKGluZGV4KTtcblxuXHRcdFx0Ly8gRGVzY3JpcHRpb24gYW5kIHRlbXBsYXRlIHByZXZpZXdcblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYycgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHRlbXBsYXRlRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRlbXBsYXRlJyB9KTtcblx0XHRcdHRlbXBsYXRlRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IHBhZGRpbmc6IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBmb250LXNpemU6IDAuOGVtOyB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7IG1heC1oZWlnaHQ6IDYwcHg7IG92ZXJmbG93LXk6IGF1dG87XCI+XG5cdFx0XHRcdFx0JHtjb21tYW5kLnRlbXBsYXRlfVxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dBZGRDb21tYW5kRGlhbG9nKCkge1xuXHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coKTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4OiBudW1iZXIpIHtcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHM/LltpbmRleF07XG5cdFx0aWYgKGNvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coY29tbWFuZCwgaW5kZXgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmREaWFsb2coZXhpc3RpbmdDb21tYW5kPzogQ3VzdG9tQ29tbWFuZCwgZWRpdEluZGV4PzogbnVtYmVyKSB7XG5cdFx0Ly8gRm9yIG5vdywgdXNlIGEgc2ltcGxlIHByb21wdC1iYXNlZCBhcHByb2FjaFxuXHRcdC8vIFRPRE86IEltcGxlbWVudCBwcm9wZXIgbW9kYWwgd2hlbiBNb2RhbCBjbGFzcyBpcyBwcm9wZXJseSBhdmFpbGFibGVcblx0XHRjb25zdCBuYW1lID0gcHJvbXB0KCdDb21tYW5kIG5hbWU6JywgZXhpc3RpbmdDb21tYW5kPy5uYW1lIHx8ICcnKTtcblx0XHRpZiAoIW5hbWUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCB0cmlnZ2VyID0gcHJvbXB0KCdDb21tYW5kIHRyaWdnZXIgKHdpdGhvdXQgOik6JywgZXhpc3RpbmdDb21tYW5kPy50cmlnZ2VyIHx8ICcnKTtcblx0XHRpZiAoIXRyaWdnZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBkZXNjcmlwdGlvbiA9IHByb21wdCgnRGVzY3JpcHRpb24gKG9wdGlvbmFsKTonLCBleGlzdGluZ0NvbW1hbmQ/LmRlc2NyaXB0aW9uIHx8ICcnKTtcblx0XHRcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IHByb21wdCgnVGVtcGxhdGUgY29udGVudDonLCBleGlzdGluZ0NvbW1hbmQ/LnRlbXBsYXRlIHx8ICcnKTtcblx0XHRpZiAoIXRlbXBsYXRlKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgcmVzdWx0OiBDdXN0b21Db21tYW5kID0ge1xuXHRcdFx0aWQ6IGV4aXN0aW5nQ29tbWFuZD8uaWQgfHwgKCdjbWRfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KSksXG5cdFx0XHRuYW1lLFxuXHRcdFx0dHJpZ2dlcjogdHJpZ2dlci50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0dGVtcGxhdGUsXG5cdFx0XHRkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgdW5kZWZpbmVkXG5cdFx0fTtcblx0XHRcblx0XHRpZiAoZWRpdEluZGV4ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdC8vIEVkaXQgZXhpc3RpbmcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzW2VkaXRJbmRleF0gPSByZXN1bHQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEFkZCBuZXcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzLnB1c2gocmVzdWx0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblxuXHRwcml2YXRlIGRlbGV0ZUNvbW1hbmQoaW5kZXg6IG51bWJlcikge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbaW5kZXhdO1xuXHRcdGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oYERlbGV0ZSBjb21tYW5kIFwiJHtjb21tYW5kLm5hbWV9XCIgKCR7Y29tbWFuZC50cmlnZ2VyfSk/YCk7XG5cdFx0XG5cdFx0aWYgKGNvbmZpcm1lZCkge1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQUlQcm92aWRlciwgUHJvdmlkZXJUeXBlLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIEFJUHJvdmlkZXJTZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ2xhdWRlUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9jbGF1ZGUnO1xuaW1wb3J0IHsgT3BlbkFJUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9vcGVuYWknO1xuaW1wb3J0IHsgR29vZ2xlUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9nb29nbGUnO1xuaW1wb3J0IHsgT2xsYW1hUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9vbGxhbWEnO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuLi9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIEFJUHJvdmlkZXJNYW5hZ2VyIHtcblx0cHJpdmF0ZSBwcm92aWRlcnM6IE1hcDxQcm92aWRlclR5cGUsIEFJUHJvdmlkZXI+ID0gbmV3IE1hcCgpO1xuXHRwcml2YXRlIHNldHRpbmdzOiBOb3ZhU2V0dGluZ3M7XG5cdHByaXZhdGUgZmVhdHVyZU1hbmFnZXI/OiBGZWF0dXJlTWFuYWdlcjtcblxuXHRjb25zdHJ1Y3RvcihzZXR0aW5nczogTm92YVNldHRpbmdzLCBmZWF0dXJlTWFuYWdlcj86IEZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBmZWF0dXJlTWFuYWdlcjtcblx0fVxuXG5cdGFzeW5jIGluaXRpYWxpemUoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdjbGF1ZGUnLCBuZXcgQ2xhdWRlUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ29wZW5haScsIG5ldyBPcGVuQUlQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnZ29vZ2xlJywgbmV3IEdvb2dsZVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdvbGxhbWEnLCBuZXcgT2xsYW1hUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEpKTtcblx0fVxuXG5cdHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBOb3ZhU2V0dGluZ3MpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdFx0dGhpcy5wcm92aWRlcnMuZm9yRWFjaCgocHJvdmlkZXIsIHR5cGUpID0+IHtcblx0XHRcdGlmICh0eXBlICE9PSAnbm9uZScgJiYgdHlwZSBpbiB0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzKSB7XG5cdFx0XHRcdHByb3ZpZGVyLnVwZGF0ZUNvbmZpZz8uKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnNbdHlwZSBhcyBrZXlvZiBBSVByb3ZpZGVyU2V0dGluZ3NdKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0UGxhdGZvcm1Qcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRjb25zdCBwbGF0Zm9ybVNldHRpbmdzID0gdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXTtcblx0XHRjb25zdCBwcm92aWRlcnMgPSBbcGxhdGZvcm1TZXR0aW5ncy5wcmltYXJ5UHJvdmlkZXIsIC4uLnBsYXRmb3JtU2V0dGluZ3MuZmFsbGJhY2tQcm92aWRlcnNdO1xuXHRcdFxuXHRcdC8vIE5vIHJlc3RyaWN0aW9ucyAtIGFsbCB1c2VycyBjYW4gdXNlIGFsbCBwcm92aWRlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0XHRyZXR1cm4gcHJvdmlkZXJzO1xuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGdldEF2YWlsYWJsZVByb3ZpZGVyKCk6IFByb21pc2U8QUlQcm92aWRlciB8IG51bGw+IHtcblx0XHRjb25zdCBvcmRlcmVkUHJvdmlkZXJzID0gdGhpcy5nZXRQbGF0Zm9ybVByb3ZpZGVycygpO1xuXHRcdFxuXHRcdC8vIElmIHByaW1hcnkgcHJvdmlkZXIgaXMgJ25vbmUnLCBOb3ZhIGlzIGRpc2FibGVkIG9uIHRoaXMgcGxhdGZvcm1cblx0XHRpZiAob3JkZXJlZFByb3ZpZGVyc1swXSA9PT0gJ25vbmUnKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBwcm92aWRlclR5cGUgb2Ygb3JkZXJlZFByb3ZpZGVycykge1xuXHRcdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnKSBjb250aW51ZTtcblx0XHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRpZiAocHJvdmlkZXIgJiYgYXdhaXQgcHJvdmlkZXIuaXNBdmFpbGFibGUoKSkge1xuXHRcdFx0XHRyZXR1cm4gcHJvdmlkZXI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuZ2VuZXJhdGVUZXh0KHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHlpZWxkKiBwcm92aWRlci5nZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0eWllbGQqIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGdldFByb3ZpZGVyTmFtZXMoKTogc3RyaW5nW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMucHJvdmlkZXJzLnZhbHVlcygpKS5tYXAocCA9PiBwLm5hbWUpO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdHJldHVybiBwcm92aWRlciA/IHByb3ZpZGVyLm5hbWUgOiAnTm9uZSc7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGdldEFsbG93ZWRQcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGFsbG93ZWQgZm9yIGFsbCB1c2Vyc1xuXHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHR9XG5cblx0aXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhbGxvd2VkXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRnZXRQcm92aWRlckxpbWl0cygpOiB7IGxvY2FsOiBudW1iZXI7IGNsb3VkOiBudW1iZXIgfSB7XG5cdFx0Ly8gTm8gbGltaXRzIGluIHRoZSBDYXRhbHlzdCBtb2RlbFxuXHRcdHJldHVybiB7IGxvY2FsOiBJbmZpbml0eSwgY2xvdWQ6IEluZmluaXR5IH07XG5cdH1cblxuXHRjbGVhbnVwKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLmNsZWFyKCk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIENsYXVkZVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnQ2xhdWRlIChBbnRocm9waWMpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2NsYXVkZS0zLWhhaWt1LTIwMjQwMzA3Jyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRzeXN0ZW06IG9wdGlvbnM/LnN5c3RlbVByb21wdCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnYXNzaXN0YW50JyA6ICd1c2VyJyxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSlcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYENsYXVkZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNvbnRlbnRbMF0udGV4dDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHQnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ2Fzc2lzdGFudCcgOiAndXNlcicsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBDbGF1ZGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2RhdGE6ICcpKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBkYXRhID0gbGluZS5zbGljZSg2KTtcblx0XHRcdFx0XHRcdGlmIChkYXRhID09PSAnW0RPTkVdJykge1xuXHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC50eXBlID09PSAnY29udGVudF9ibG9ja19kZWx0YScgJiYgcGFyc2VkLmRlbHRhPy50ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQuZGVsdGEudGV4dCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT3BlbkFJUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPcGVuQUknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRpZiAob3B0aW9ucz8uc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRyZXF1ZXN0TWVzc2FnZXMudW5zaGlmdCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBvcHRpb25zLnN5c3RlbVByb21wdCB9KTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvY2hhdC9jb21wbGV0aW9ucycsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdncHQtMy41LXR1cmJvJyxcblx0XHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRpZiAob3B0aW9ucz8uc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRyZXF1ZXN0TWVzc2FnZXMudW5zaGlmdCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBvcHRpb25zLnN5c3RlbVByb21wdCB9KTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvY2hhdC9jb21wbGV0aW9ucycsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdncHQtMy41LXR1cmJvJyxcblx0XHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRzdHJlYW06IHRydWVcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG5cdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gcGFyc2VkLmNob2ljZXM/LlswXT8uZGVsdGE/LmNvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBHb29nbGVQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ0dvb2dsZSAoR2VtaW5pKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0cHJpdmF0ZSBmb3JtYXRNZXNzYWdlc0ZvckdlbWluaShtZXNzYWdlczogQUlNZXNzYWdlW10sIHN5c3RlbVByb21wdD86IHN0cmluZyk6IGFueSB7XG5cdFx0Y29uc3QgY29udGVudHMgPSBbXTtcblx0XHRcblx0XHRpZiAoc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRjb250ZW50cy5wdXNoKHtcblx0XHRcdFx0cm9sZTogJ3VzZXInLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogYFN5c3RlbTogJHtzeXN0ZW1Qcm9tcHR9YCB9XVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Zm9yIChjb25zdCBtZXNzYWdlIG9mIG1lc3NhZ2VzKSB7XG5cdFx0XHRjb25zdCByb2xlID0gbWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50JyA/ICdtb2RlbCcgOiAndXNlcic7XG5cdFx0XHRjb250ZW50cy5wdXNoKHtcblx0XHRcdFx0cm9sZSxcblx0XHRcdFx0cGFydHM6IFt7IHRleHQ6IG1lc3NhZ2UuY29udGVudCB9XVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbnRlbnRzO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktcHJvJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzLCBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnZ2VtaW5pLXBybyc7XG5cdFx0Y29uc3QgdXJsID0gYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMvJHttb2RlbH06c3RyZWFtR2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gO1xuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRjb250ZW50czogdGhpcy5mb3JtYXRNZXNzYWdlc0ZvckdlbWluaShtZXNzYWdlcywgb3B0aW9ucz8uc3lzdGVtUHJvbXB0KSxcblx0XHRcdFx0Z2VuZXJhdGlvbkNvbmZpZzoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bWF4T3V0cHV0VG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgR29vZ2xlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXHRcdGxldCBidWZmZXIgPSAnJztcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0Y29uc3QgbGluZXMgPSBidWZmZXIuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJztcblxuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHRleHQgPSBwYXJzZWQuY2FuZGlkYXRlcz8uWzBdPy5jb250ZW50Py5wYXJ0cz8uWzBdPy50ZXh0O1xuXHRcdFx0XHRcdFx0XHRpZiAodGV4dCkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogdGV4dCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT2xsYW1hUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPbGxhbWEgKExvY2FsKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5tb2RlbCkgcmV0dXJuIGZhbHNlOyAvLyBSZXF1aXJlIG1vZGVsIHRvIGJlIHNldFxuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS90YWdzYCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2Uub2s7XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEucmVzcG9uc2U7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2dlbmVyYXRlYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdHByb21wdCxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0Y29uc3QgbGluZXMgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSkuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQucmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHBhcnNlZC5yZXNwb25zZSwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLmRvbmUpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9jaGF0YCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpLFxuXHRcdFx0XHRzdHJlYW06IGZhbHNlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLm1lc3NhZ2UuY29udGVudDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0Y29uc3QgbGluZXMgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSkuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQubWVzc2FnZT8uY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogcGFyc2VkLm1lc3NhZ2UuY29udGVudCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLmRvbmUpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmLCBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSwgTm90aWNlLCBNYXJrZG93blZpZXcsIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IE11bHRpRG9jQ29udGV4dEhhbmRsZXIsIE11bHRpRG9jQ29udGV4dCB9IGZyb20gJy4uL2NvcmUvbXVsdGktZG9jLWNvbnRleHQnO1xuXG5leHBvcnQgY29uc3QgVklFV19UWVBFX05PVkFfU0lERUJBUiA9ICdub3ZhLXNpZGViYXInO1xuXG5leHBvcnQgY2xhc3MgTm92YVNpZGViYXJWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXHRwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgY2hhdENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGlucHV0Q29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgdGV4dEFyZWEhOiBUZXh0QXJlYUNvbXBvbmVudDtcblx0cHJpdmF0ZSBzZW5kQnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGNvbW1hbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgY29tbWFuZFBpY2tlciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXJJdGVtczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRwcml2YXRlIHNlbGVjdGVkQ29tbWFuZEluZGV4OiBudW1iZXIgPSAtMTtcblx0cHJpdmF0ZSBjb21tYW5kTWVudSE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGlzQ29tbWFuZE1lbnVWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgYXV0b0dyb3dUZXh0YXJlYSE6ICgpID0+IHZvaWQ7XG5cdHByaXZhdGUgd2lraWxpbmtBdXRvY29tcGxldGUhOiBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGU7XG5cdHByaXZhdGUgY29udGV4dFByZXZpZXchOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBtdWx0aURvY0hhbmRsZXIhOiBNdWx0aURvY0NvbnRleHRIYW5kbGVyO1xuXHRwcml2YXRlIGNvbnRleHRJbmRpY2F0b3IhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjdXJyZW50Q29udGV4dDogTXVsdGlEb2NDb250ZXh0IHwgbnVsbCA9IG51bGw7XG5cdFxuXHQvLyBFdmVudCBsaXN0ZW5lciBjbGVhbnVwIHRyYWNraW5nXG5cdHByaXZhdGUgZG9jdW1lbnRFdmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblx0cHJpdmF0ZSB0aW1lb3V0czogTm9kZUpTLlRpbWVvdXRbXSA9IFtdO1xuXG5cdGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGxlYWYpO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyID0gbmV3IE11bHRpRG9jQ29udGV4dEhhbmRsZXIodGhpcy5hcHApO1xuXHR9XG5cblx0Z2V0Vmlld1R5cGUoKSB7XG5cdFx0cmV0dXJuIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVI7XG5cdH1cblxuXHRnZXREaXNwbGF5VGV4dCgpIHtcblx0XHRyZXR1cm4gJ05vdmEgQUknO1xuXHR9XG5cblx0Z2V0SWNvbigpIHtcblx0XHRyZXR1cm4gJ25vdmEtc3Rhcic7XG5cdH1cblxuXHRhc3luYyBvbk9wZW4oKSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcblx0XHRjb250YWluZXIuZW1wdHkoKTtcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ25vdmEtc2lkZWJhci1jb250YWluZXInKTtcblxuXHRcdC8vIE1vYmlsZSBhY2Nlc3MgaXMgbm93IGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0XHRcblx0XHQvLyBDcmVhdGUgd3JhcHBlciB3aXRoIHByb3BlciBmbGV4IGxheW91dFxuXHRcdGNvbnN0IHdyYXBwZXJFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdyYXBwZXInIH0pO1xuXHRcdHdyYXBwZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRoZWlnaHQ6IDEwMCU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0cGFkZGluZy1ib3R0b206ICR7UGxhdGZvcm0uaXNEZXNrdG9wQXBwID8gJzI1cHgnIDogJzAnfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciB3aXRoIHByb3ZpZGVyIGluZm9cblx0XHRjb25zdCBoZWFkZXJFbCA9IHdyYXBwZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogMTBweDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIExlZnQgc2lkZTogVGl0bGUgd2l0aCBOb3ZhIGljb25cblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2g0Jyk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZm9udC1zaXplOiAxLjFlbTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7Jztcblx0XHR0aXRsZUVsLmlubmVySFRNTCA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAxOHB4OyBoZWlnaHQ6IDE4cHg7XCI+XG5cdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0PC9zdmc+Tm92YWA7XG5cdFx0XG5cdFx0Ly8gUmlnaHQgc2lkZTogUHJvdmlkZXIgc3RhdHVzIGFuZCBDbGVhciBidXR0b25cblx0XHRjb25zdCByaWdodENvbnRhaW5lciA9IGhlYWRlckVsLmNyZWF0ZURpdigpO1xuXHRcdHJpZ2h0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA4cHg7Jztcblx0XHRcblx0XHQvLyBBbGwgdXNlcnMgY2FuIHN3aXRjaCBwcm92aWRlcnMgZnJlZWx5XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlckRyb3Bkb3duKHJpZ2h0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDbGVhciBDaGF0IGJ1dHRvbiBpbiByaWdodCBjb250YWluZXJcblx0XHRjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQocmlnaHRDb250YWluZXIpO1xuXHRcdGNsZWFyQnV0dG9uLnNldEljb24oJ2VyYXNlcicpXG5cdFx0XHQuc2V0VG9vbHRpcCgnQ2xlYXIgY29udmVyc2F0aW9uIGhpc3RvcnknKVxuXHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5jbGVhckNoYXQoKSk7XG5cblx0XHR0aGlzLmNyZWF0ZUNoYXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHR0aGlzLmNyZWF0ZUlucHV0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0XG5cdFx0Ly8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXIgZm9yIGFjdGl2ZSBmaWxlIGNoYW5nZXNcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcblx0XHRcdFx0dGhpcy5sb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIExvYWQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcblx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdH1cblxuXHRhc3luYyBvbkNsb3NlKCkge1xuXHRcdC8vIENsZWFuIHVwIHByb3ZpZGVyIGRyb3Bkb3duIGV2ZW50IGxpc3RlbmVyXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LmNsZWFudXApIHtcblx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24uY2xlYW51cCgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB3aWtpbGluayBhdXRvY29tcGxldGVcblx0XHRpZiAodGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSkge1xuXHRcdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZS5kZXN0cm95KCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFuIHVwIHRyYWNrZWQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0dGhpcy5jbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcblx0XHQvLyBDbGVhciBhbGwgdGltZW91dHNcblx0XHR0aGlzLmNsZWFyVGltZW91dHMoKTtcblx0XHRcblx0XHQvLyBDbGVhbiB1cCBET00gZWxlbWVudHNcblx0XHR0aGlzLmNsZWFudXBET01FbGVtZW50cygpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIGV2ZW50IGxpc3RlbmVyIHdpdGggYXV0b21hdGljIGNsZWFudXAgdHJhY2tpbmdcblx0ICovXG5cdHByaXZhdGUgYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGQgdGltZW91dCB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRUaW1lb3V0KGNhbGxiYWNrOiAoKSA9PiB2b2lkLCBkZWxheTogbnVtYmVyKTogTm9kZUpTLlRpbWVvdXQge1xuXHRcdGNvbnN0IGlkID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0dGhpcy50aW1lb3V0cyA9IHRoaXMudGltZW91dHMuZmlsdGVyKHQgPT4gdCAhPT0gaWQpO1xuXHRcdH0sIGRlbGF5KTtcblx0XHR0aGlzLnRpbWVvdXRzLnB1c2goaWQpO1xuXHRcdHJldHVybiBpZDtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIGFsbCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFyIGFsbCB0cmFja2VkIHRpbWVvdXRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFyVGltZW91dHMoKTogdm9pZCB7XG5cdFx0dGhpcy50aW1lb3V0cy5mb3JFYWNoKGlkID0+IGNsZWFyVGltZW91dChpZCkpO1xuXHRcdHRoaXMudGltZW91dHMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRE9NRWxlbWVudHMoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXIpIHtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlci5lbXB0eSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5yZW1vdmUoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNoYXRJbnRlcmZhY2UoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNoYXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXg6IDE7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0cGFkZGluZzogMTBweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0Z2FwOiA4cHg7XG5cdFx0YDtcblxuXHRcdC8vIFdlbGNvbWUgbWVzc2FnZSB3aXRoIE5vdmEgYnJhbmRpbmdcblx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUlucHV0SW50ZXJmYWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogOHB4O1xuXHRcdFx0cGFkZGluZzogMTBweDtcblx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRgO1xuXG5cdFx0Ly8gU2ltcGxpZmllZCBpbnB1dCByb3cgd2l0aCBqdXN0IHRleHRhcmVhIGFuZCBzZW5kIGJ1dHRvblxuXHRcdGNvbnN0IGlucHV0Um93ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LXJvdycgfSk7XG5cdFx0aW5wdXRSb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA4cHg7XG5cdFx0YDtcblxuXHRcdC8vIFRleHQgYXJlYSB0YWtlcyBtb3N0IHNwYWNlXG5cdFx0Y29uc3QgdGV4dEFyZWFDb250YWluZXIgPSBpbnB1dFJvdy5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7IHBvc2l0aW9uOiByZWxhdGl2ZTsnO1xuXHRcdHRoaXMudGV4dEFyZWEgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodGV4dEFyZWFDb250YWluZXIpO1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0UGxhY2Vob2xkZXIoJ0FzayBOb3ZhIHRvIGhlbHAgZWRpdCB5b3VyIGRvY3VtZW50Li4uJyk7XG5cdFx0XG5cdFx0Ly8gUGxhdGZvcm0tYXdhcmUgZGVmYXVsdHMgYW5kIGF1dG8tZ3Jvd2luZyBzZXR1cFxuXHRcdGNvbnN0IGxpbmVIZWlnaHQgPSAxLjU7IC8vIGVtIHVuaXRzXG5cdFx0Y29uc3QgcGFkZGluZ1ZlcnRpY2FsID0gMjA7IC8vIHB4ICgxMHB4IHRvcCArIDEwcHggYm90dG9tKVxuXHRcdGNvbnN0IGJvcmRlcldpZHRoID0gMjsgLy8gcHggKDFweCB0b3AgKyAxcHggYm90dG9tKVxuXHRcdGNvbnN0IGJhc2VMaW5lcyA9IFBsYXRmb3JtLmlzTW9iaWxlID8gMiA6IDM7XG5cdFx0Y29uc3QgbWF4TGluZXMgPSBQbGF0Zm9ybS5pc01vYmlsZSA/IDggOiA2O1xuXHRcdFxuXHRcdC8vIENhbGN1bGF0ZSBpbml0aWFsIGhlaWdodCBiYXNlZCBvbiBwbGF0Zm9ybVxuXHRcdGNvbnN0IGZvbnRTaXplID0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgnLS1mb250LXRleHQtc2l6ZScpIHx8ICcxNHB4Jyk7XG5cdFx0Y29uc3QgaW5pdGlhbEhlaWdodCA9IChiYXNlTGluZXMgKiBsaW5lSGVpZ2h0ICogZm9udFNpemUpICsgcGFkZGluZ1ZlcnRpY2FsICsgYm9yZGVyV2lkdGg7XG5cdFx0XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aW5pdGlhbEhlaWdodH1weDtcblx0XHRcdG1heC1oZWlnaHQ6ICR7KG1heExpbmVzICogbGluZUhlaWdodCAqIGZvbnRTaXplKSArIHBhZGRpbmdWZXJ0aWNhbCArIGJvcmRlcldpZHRofXB4O1xuXHRcdFx0aGVpZ2h0OiAke2luaXRpYWxIZWlnaHR9cHg7XG5cdFx0XHRyZXNpemU6IG5vbmU7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRwYWRkaW5nOiAxMHB4O1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXRleHQtc2l6ZSk7XG5cdFx0XHRsaW5lLWhlaWdodDogJHtsaW5lSGVpZ2h0fTtcblx0XHRcdG92ZXJmbG93LXk6IGhpZGRlbjtcblx0XHRcdHRyYW5zaXRpb246IGhlaWdodCAwLjFzIGVhc2Utb3V0O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gQXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCBlbCA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRcdFxuXHRcdFx0Ly8gUmVzZXQgaGVpZ2h0IHRvIGF1dG8gdG8gZ2V0IHRoZSBjb3JyZWN0IHNjcm9sbEhlaWdodFxuXHRcdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgbmV3IGhlaWdodCBiYXNlZCBvbiBjb250ZW50XG5cdFx0XHRjb25zdCBjb250ZW50SGVpZ2h0ID0gZWwuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0Y29uc3QgbWluSGVpZ2h0ID0gaW5pdGlhbEhlaWdodDtcblx0XHRcdGNvbnN0IG1heEhlaWdodCA9IChtYXhMaW5lcyAqIGxpbmVIZWlnaHQgKiBmb250U2l6ZSkgKyBwYWRkaW5nVmVydGljYWwgKyBib3JkZXJXaWR0aDtcblx0XHRcdFxuXHRcdFx0Ly8gQ2xhbXAgaGVpZ2h0IGJldHdlZW4gbWluIGFuZCBtYXhcblx0XHRcdGNvbnN0IG5ld0hlaWdodCA9IE1hdGgubWF4KG1pbkhlaWdodCwgTWF0aC5taW4oY29udGVudEhlaWdodCwgbWF4SGVpZ2h0KSk7XG5cdFx0XHRcblx0XHRcdC8vIEFwcGx5IG5ldyBoZWlnaHRcblx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGAke25ld0hlaWdodH1weGA7XG5cdFx0XHRcblx0XHRcdC8vIFNob3cgc2Nyb2xsYmFyIG9ubHkgd2hlbiBjb250ZW50IGV4Y2VlZHMgbWF4IGhlaWdodFxuXHRcdFx0ZWwuc3R5bGUub3ZlcmZsb3dZID0gY29udGVudEhlaWdodCA+IG1heEhlaWdodCA/ICdhdXRvJyA6ICdoaWRkZW4nO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQWRkIGlucHV0IGV2ZW50IGxpc3RlbmVyIGZvciBhdXRvLWdyb3dcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmF1dG9Hcm93VGV4dGFyZWEpO1xuXHRcdFxuXHRcdC8vIEFsc28gdHJpZ2dlciBvbiBpbml0aWFsIGxvYWQgYW5kIHdoZW4gdmFsdWUgY2hhbmdlcyBwcm9ncmFtbWF0aWNhbGx5XG5cdFx0c2V0VGltZW91dCh0aGlzLmF1dG9Hcm93VGV4dGFyZWEsIDApO1xuXHRcdFxuXHRcdC8vIEluaXRpYWxpemUgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSA9IG5ldyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUodGhpcy5hcHAsIHRoaXMudGV4dEFyZWEuaW5wdXRFbCk7XG5cdFx0XG5cdFx0Ly8gQWRkIHJlYWwtdGltZSBjb250ZXh0IHByZXZpZXdcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHR0aGlzLnVwZGF0ZUxpdmVDb250ZXh0UHJldmlldygpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ29tbWFuZCBidXR0b24gKGxpZ2h0bmluZykgLSBjb25kaXRpb25hbGx5IHNob3duXG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldEljb24oJ3phcCcpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5zZXRUb29sdGlwKCdDb21tYW5kcycpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMudG9nZ2xlQ29tbWFuZE1lbnUoKSk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHR3aWR0aDogMzZweDtcblx0XHRcdGhlaWdodDogMzZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGRpc3BsYXk6ICR7dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1idXR0b24nKSA/ICdmbGV4JyA6ICdub25lJ307XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAwO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRgO1xuXG5cdFx0Ly8gU2VuZCBidXR0b24gdmVydGljYWxseSBjZW50ZXJlZFxuXHRcdHRoaXMuc2VuZEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRSb3cpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRJY29uKCdzZW5kJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldFRvb2x0aXAoJ1NlbmQgbWVzc2FnZScpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRDdGEoKTtcblx0XHR0aGlzLnNlbmRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmhhbmRsZVNlbmQoKSk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHR3aWR0aDogMzZweDtcblx0XHRcdGhlaWdodDogMzZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAwO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblxuXHRcdC8vIEVudGVyIGtleSBoYW5kbGluZyBhbmQgY29tbWFuZCBwaWNrZXJcblx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xuXHRcdFx0aWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAhZXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5oYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCkgfHwgdGhpcy5oYW5kbGVTZW5kKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIHtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdFx0fSBlbHNlIGlmIChldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nIHx8IGV2ZW50LmtleSA9PT0gJ0Fycm93VXAnKSB7XG5cdFx0XHRcdGlmICh0aGlzLmlzQ29tbWFuZFBpY2tlclZpc2libGUoKSkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0dGhpcy5uYXZpZ2F0ZUNvbW1hbmRQaWNrZXIoZXZlbnQua2V5ID09PSAnQXJyb3dEb3duJyA/IDEgOiAtMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIElucHV0IGNoYW5nZSBoYW5kbGluZyBmb3IgY29tbWFuZCBwaWNrZXIgKGFscmVhZHkgaGFzIGF1dG9Hcm93IGxpc3RlbmVyKVxuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcblx0XHRcdHRoaXMuaGFuZGxlSW5wdXRDaGFuZ2UoKTtcblx0XHR9KTtcblxuXHRcdC8vIENyZWF0ZSBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMuY3JlYXRlQ29tbWFuZFBpY2tlcigpO1xuXG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgbWVudVxuXHRcdHRoaXMuY3JlYXRlQ29tbWFuZE1lbnUoKTtcblxuXHRcdC8vIENyZWF0ZSBjb250ZXh0IGluZGljYXRvciBhbmQgcHJldmlld1xuXHRcdHRoaXMuY3JlYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdHRoaXMuY29udGV4dFByZXZpZXcgPSB0aGlzLmNyZWF0ZUNvbnRleHRQcmV2aWV3KCk7XG5cdH1cblxuXHRwcml2YXRlIGFkZE1lc3NhZ2Uocm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgY29udGVudDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtJHtyb2xlfWAgfSk7XG5cdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tYm90dG9tOiAxMHB4O1xuXHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogMC45ZW07J1xuXHRcdFx0XHQ6ICdiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7J1xuXHRcdFx0fVxuXHRcdGA7XG5cblx0XHRjb25zdCByb2xlRWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgXG5cdFx0XHR0ZXh0OiByb2xlID09PSAndXNlcicgPyAnWW91JyA6IHJvbGUgPT09ICdzeXN0ZW0nID8gJ1N5c3RlbScgOiAnTm92YScsXG5cdFx0XHRjbHM6ICdub3ZhLW1lc3NhZ2Utcm9sZSdcblx0XHR9KTtcblx0XHRyb2xlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbSB3aXRoIHNtb290aCBhbmltYXRpb25cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCA1MCk7XG5cdH1cblxuXHRwcml2YXRlIGFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2U/OiBzdHJpbmcpIHtcblx0XHRjb25zdCB3ZWxjb21lRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lJyB9KTtcblx0XHR3ZWxjb21lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiAxMnB4O1xuXHRcdFx0bWFyZ2luOiAxNnB4IGF1dG87XG5cdFx0XHRwYWRkaW5nOiAxNnB4IDIwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogMThweDtcblx0XHRcdG1heC13aWR0aDogOTAlO1xuXHRcdFx0YW5pbWF0aW9uOiBmYWRlSW4gMC41cyBlYXNlLWluO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gTm92YSBzdGFyIGljb24gKHN0YXRpYywgbm90IGFuaW1hdGVkKVxuXHRcdGNvbnN0IGljb25Db250YWluZXIgPSB3ZWxjb21lRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lLWljb24nIH0pO1xuXHRcdGljb25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdHdpZHRoOiAzMnB4O1xuXHRcdFx0aGVpZ2h0OiAzMnB4O1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblx0XHRcblx0XHRpY29uQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IDMycHg7IGhlaWdodDogMzJweDsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5cblx0XHRgO1xuXHRcdFxuXHRcdC8vIFdlbGNvbWUgdGV4dFxuXHRcdGNvbnN0IHRleHRDb250YWluZXIgPSB3ZWxjb21lRWwuY3JlYXRlRGl2KCk7XG5cdFx0dGV4dENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gdGV4dENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiAnV2VsY29tZSB0byBOb3ZhJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC10ZXh0LXNpemUpO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3Qgc3VidGl0bGVFbCA9IHRleHRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogbWVzc2FnZSB8fCAnWW91ciBBSSB0aGlua2luZyBwYXJ0bmVyLiBBc2sgbWUgdG8gaGVscCBlZGl0IHlvdXIgZG9jdW1lbnQhJyB9KTtcblx0XHRzdWJ0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRmb250LXNpemU6IDAuOWVtO1xuXHRcdGA7XG5cblx0XHQvLyBBdXRvLXNjcm9sbCB0byBib3R0b21cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCA1MCk7XG5cdH1cblxuXHRwcml2YXRlIGFkZFN1Y2Nlc3NJbmRpY2F0b3IoYWN0aW9uOiBzdHJpbmcpIHtcblx0XHRjb25zdCBpbmRpY2F0b3JFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Y2Nlc3MtaW5kaWNhdG9yJyB9KTtcblx0XHRpbmRpY2F0b3JFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdG1hcmdpbjogOHB4IGF1dG87XG5cdFx0XHRwYWRkaW5nOiA2cHggMTJweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEoNzYsIDE3NSwgODAsIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKDc2LCAxNzUsIDgwLCAwLjMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogMTZweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRtYXgtd2lkdGg6IDIwMHB4O1xuXHRcdFx0YW5pbWF0aW9uOiBmYWRlSW4gMC4zcyBlYXNlLWluO1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gQWRkIGNoZWNrbWFyayBhbmQgdGV4dFxuXHRcdGluZGljYXRvckVsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgc3R5bGU9XCJ3aWR0aDogMTJweDsgaGVpZ2h0OiAxMnB4OyBtYXJnaW4tcmlnaHQ6IDZweDsgYm9yZGVyLXJhZGl1czogNTAlOyBiYWNrZ3JvdW5kOiAjNGNhZjUwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcIj5cblx0XHRcdFx0PGRpdiBzdHlsZT1cIndpZHRoOiA0cHg7IGhlaWdodDogMnB4OyBib3JkZXItbGVmdDogMXB4IHNvbGlkIHdoaXRlOyBib3JkZXItYm90dG9tOiAxcHggc29saWQgd2hpdGU7IHRyYW5zZm9ybTogcm90YXRlKC00NWRlZykgdHJhbnNsYXRlKC0wLjVweCwgLTAuNXB4KTtcIj48L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdFx0JHt0aGlzLmdldENvbXBhY3RTdWNjZXNzTWVzc2FnZShhY3Rpb24pfVxuXHRcdGA7XG5cblx0XHQvLyBBdXRvLXNjcm9sbCB0byBib3R0b21cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCA1MCk7XG5cdH1cblxuXHRwcml2YXRlIGdldENvbXBhY3RTdWNjZXNzTWVzc2FnZShhY3Rpb246IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0c3dpdGNoIChhY3Rpb24pIHtcblx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBhZGRlZCc7XG5cdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGVkaXRlZCc7XG5cdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgZGVsZXRlZCc7XG5cdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0cmV0dXJuICdHcmFtbWFyIGZpeGVkJztcblx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgcmV3cml0dGVuJztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHJldHVybiAnQ29tbWFuZCBjb21wbGV0ZWQnO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdC8vIENoZWNrIGlmIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1zeXN0ZW0nKSkge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd6YXAnLCAnQ29tbWFuZCBzeXN0ZW0gaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgQ2F0YWx5c3Qgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMTUsIDIwMjUuJykpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZCA9IG1lc3NhZ2Uuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsgLy8gUmVtb3ZlICc6JyBhbmQgbm9ybWFsaXplXG5cblx0XHQvLyBQcm92aWRlciBzd2l0Y2hpbmcgY29tbWFuZHNcblx0XHRjb25zdCBwcm92aWRlckNvbW1hbmRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdjbGF1ZGUnLFxuXHRcdFx0J2NoYXRncHQnOiAnb3BlbmFpJyxcblx0XHRcdCdvcGVuYWknOiAnb3BlbmFpJyxcblx0XHRcdCdnZW1pbmknOiAnZ29vZ2xlJyxcblx0XHRcdCdnb29nbGUnOiAnZ29vZ2xlJyxcblx0XHRcdCdvbGxhbWEnOiAnb2xsYW1hJ1xuXHRcdH07XG5cblx0XHRpZiAocHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXSkge1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVyQ29tbWFuZHNbY29tbWFuZF07XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zZXR0aW5nVGFiLnNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkKTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdyZWZyZXNoLWN3JywgYFN3aXRjaGVkIHRvICR7dGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVySWQpfWApKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGZvciBjdXN0b20gY29tbWFuZHMgKGlmIGZlYXR1cmUgZW5hYmxlZClcblx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY3VzdG9tLWNvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uZmluZChjbWQgPT4gY21kLnRyaWdnZXIgPT09IGNvbW1hbmQpO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmQpIHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBjdXN0b20gY29tbWFuZFxuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGN1c3RvbUNvbW1hbmQudGVtcGxhdGUpO1xuXHRcdFx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBhZnRlciBzZXR0aW5nIHRlbXBsYXRlXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5hdXRvR3Jvd1RleHRhcmVhKCksIDApO1xuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2VkaXQnLCBgTG9hZGVkIHRlbXBsYXRlOiAke2N1c3RvbUNvbW1hbmQubmFtZX1gKSk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFVua25vd24gY29tbWFuZFxuXHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnaGVscC1jaXJjbGUnLCBgVW5rbm93biBjb21tYW5kICc6JHtjb21tYW5kfScuIFRyeSA6Y2xhdWRlLCA6Y2hhdGdwdCwgOmdlbWluaSwgb3IgOm9sbGFtYWApKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXInIH0pO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGNvbnN0IHZhbHVlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdGlmICh2YWx1ZS5zdGFydHNXaXRoKCc6JykgJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1zeXN0ZW0nKSkge1xuXHRcdFx0Y29uc3QgcXVlcnkgPSB2YWx1ZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZFBpY2tlcihxdWVyeSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kUGlja2VyKHF1ZXJ5OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKS5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLnRyaWdnZXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgY21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSlcblx0XHQpO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0nIH0pO1xuXHRcdFx0aXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IHRyaWdnZXJFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdFx0cGFkZGluZzogMnB4IDZweDtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0XHRmb250LXNpemU6IDAuOWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29tbWFuZC1uYW1lJyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7JztcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2MnIH0pO1xuXHRcdFx0XHRkZXNjRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLmRlc2NyaXB0aW9uO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXNpemU6IDAuOGVtOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Jztcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChpbmRleCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgaGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXHR9XG5cblx0cHJpdmF0ZSBpc0NvbW1hbmRQaWNrZXJWaXNpYmxlKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgbmF2aWdhdGVDb21tYW5kUGlja2VyKGRpcmVjdGlvbjogbnVtYmVyKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG5cdFx0Y29uc3QgbmV3SW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEsXG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgZGlyZWN0aW9uXG5cdFx0KSk7XG5cblx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChuZXdJbmRleCk7XG5cdH1cblxuXHRwcml2YXRlIHNldFNlbGVjdGVkQ29tbWFuZChpbmRleDogbnVtYmVyKTogdm9pZCB7XG5cdFx0Ly8gUmVtb3ZlIHByZXZpb3VzIHNlbGVjdGlvblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG5cdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IGluZGV4O1xuXG5cdFx0aWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zW2luZGV4XS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXNbaW5kZXhdLnNjcm9sbEludG9WaWV3KHsgYmxvY2s6ICduZWFyZXN0JyB9KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogYm9vbGVhbiB7XG5cdFx0aWYgKCF0aGlzLmlzQ29tbWFuZFBpY2tlclZpc2libGUoKSB8fCB0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID09PSAtMSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpO1xuXHRcdGNvbnN0IHNlbGVjdGVkQ29tbWFuZCA9IGNvbW1hbmRzW3RoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXhdO1xuXHRcdFxuXHRcdGlmIChzZWxlY3RlZENvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2VsZWN0Q29tbWFuZChzZWxlY3RlZENvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIHNlbGVjdENvbW1hbmQodHJpZ2dlcjogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShgOiR7dHJpZ2dlcn1gKTtcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0Ly8gVHJpZ2dlciB0aGUgY29tbWFuZCBpbW1lZGlhdGVseVxuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBdmFpbGFibGVDb21tYW5kcygpOiBBcnJheTx7dHJpZ2dlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nfT4ge1xuXHRcdGNvbnN0IGNvbW1hbmRzOiBBcnJheTx7dHJpZ2dlcjogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uPzogc3RyaW5nfT4gPSBbXG5cdFx0XHR7IHRyaWdnZXI6ICdjbGF1ZGUnLCBuYW1lOiAnU3dpdGNoIHRvIENsYXVkZScsIGRlc2NyaXB0aW9uOiAnQW50aHJvcGljIENsYXVkZSBBSScgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2NoYXRncHQnLCBuYW1lOiAnU3dpdGNoIHRvIENoYXRHUFQnLCBkZXNjcmlwdGlvbjogJ09wZW5BSSBHUFQgbW9kZWxzJyB9LFxuXHRcdFx0eyB0cmlnZ2VyOiAnZ2VtaW5pJywgbmFtZTogJ1N3aXRjaCB0byBHZW1pbmknLCBkZXNjcmlwdGlvbjogJ0dvb2dsZSBHZW1pbmkgQUknIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdvbGxhbWEnLCBuYW1lOiAnU3dpdGNoIHRvIE9sbGFtYScsIGRlc2NyaXB0aW9uOiAnTG9jYWwgQUkgbW9kZWxzJyB9XG5cdFx0XTtcblxuXHRcdC8vIEFkZCBjdXN0b20gY29tbWFuZHMgaWYgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2N1c3RvbS1jb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXHRcdFx0Y3VzdG9tQ29tbWFuZHMuZm9yRWFjaChjbWQgPT4ge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHR0cmlnZ2VyOiBjbWQudHJpZ2dlcixcblx0XHRcdFx0XHRuYW1lOiBjbWQubmFtZSxcblx0XHRcdFx0XHQuLi4oY21kLmRlc2NyaXB0aW9uICYmIHsgZGVzY3JpcHRpb246IGNtZC5kZXNjcmlwdGlvbiB9KVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb21tYW5kcztcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudSA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1pbi13aWR0aDogMjQwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdGJveC1zaGFkb3c6IDAgLTRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjb21tYW5kTWVudUNsaWNrSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGlmICghdGhpcy5jb21tYW5kTWVudS5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkgJiYgXG5cdFx0XHRcdCF0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjb21tYW5kTWVudUNsaWNrSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIHRvZ2dsZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZC1idXR0b24nKSkge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd6YXAnLCAnQ29tbWFuZCBidXR0b24gaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgQ2F0YWx5c3Qgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBBdWd1c3QgMTUsIDIwMjUuJykpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kTWVudSgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpO1xuXHRcdFxuXHRcdHRoaXMuY29tbWFuZE1lbnUuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBIZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cGFkZGluZzogMTJweCAxNnB4O1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRmb250LXNpemU6IDAuOWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRgO1xuXHRcdGhlYWRlckVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignemFwJykgKyAnIENvbW1hbmRzJztcblxuXHRcdC8vIENvbW1hbmRzIGxpc3Rcblx0XHRjb21tYW5kcy5mb3JFYWNoKGNvbW1hbmQgPT4ge1xuXHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtaXRlbScgfSk7XG5cdFx0XHRpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0XHRnYXA6IDRweDtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1uYW1lJyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuXHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0b3BhY2l0eTogMC44O1xuXHRcdFx0YDtcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1kZXNjJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdFx0ZGVzY0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdGA7XG5cdFx0XHR9XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0fSk7XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnJztcblx0XHRcdH0pO1xuXG5cdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmV4ZWN1dGVDb21tYW5kRnJvbU1lbnUoY29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgaGlkZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIGV4ZWN1dGVDb21tYW5kRnJvbU1lbnUodHJpZ2dlcjogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcblx0XHQvLyBFeGVjdXRlIHRoZSBjb21tYW5kIGRpcmVjdGx5XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShgOiR7dHJpZ2dlcn1gKTtcblx0XHR0aGlzLmhhbmRsZVNlbmQoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29udGV4dEluZGljYXRvcigpOiB2b2lkIHtcblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1pbmRpY2F0b3InIH0pO1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogOHB4O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRmb250LXNpemU6IDAuODVlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29udGV4dFByZXZpZXcoKTogSFRNTEVsZW1lbnQge1xuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0Ly8gUmV0dXJuIGEgZHVtbXkgZWxlbWVudCB0aGF0IHdvbid0IGJlIHVzZWRcblx0XHRcdHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR9XG5cblx0XHQvLyBDcmVhdGUgYSBwcmV2aWV3IGFyZWEgdGhhdCBzaG93cyBsaXZlIGNvbnRleHQgYXMgdXNlciB0eXBlc1xuXHRcdGNvbnN0IHByZXZpZXdDb250YWluZXIgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1wcmV2aWV3JyB9KTtcblx0XHRwcmV2aWV3Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjEpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdGA7XG5cblx0XHRjb25zdCBwcmV2aWV3VGV4dCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1wcmV2aWV3LXRleHQnIH0pO1xuXHRcdHByZXZpZXdUZXh0LmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJykgKyAnIENvbnRleHQgd2lsbCBpbmNsdWRlOiAnO1xuXHRcdHByZXZpZXdUZXh0LnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDUwMDsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7JztcblxuXHRcdGNvbnN0IHByZXZpZXdMaXN0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctbGlzdCcgfSk7XG5cdFx0cHJldmlld0xpc3Quc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsnO1xuXG5cdFx0cmV0dXJuIHByZXZpZXdDb250YWluZXI7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldygpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dFByZXZpZXcgfHwgIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdGlmICghbWVzc2FnZSkge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFBhcnNlIGRvY3VtZW50IHJlZmVyZW5jZXMgZnJvbSBjdXJyZW50IG1lc3NhZ2Vcblx0XHQvLyBOb3RlOiBBbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQgZm9yIHNpbXBsaWZpZWQgVVhcblx0XHRjb25zdCByZWZQYXR0ZXJuID0gLyhcXCspP1xcW1xcWyhbXlxcXV0rPykoPzojKFteXFxdXSs/KSk/XFxdXFxdL2c7XG5cdFx0Y29uc3QgZm91bmRSZWZzOiBBcnJheTx7bmFtZTogc3RyaW5nLCBwcm9wZXJ0eT86IHN0cmluZ30+ID0gW107XG5cdFx0bGV0IG1hdGNoO1xuXG5cdFx0d2hpbGUgKChtYXRjaCA9IHJlZlBhdHRlcm4uZXhlYyhtZXNzYWdlKSkgIT09IG51bGwpIHtcblx0XHRcdGNvbnN0IGRvY05hbWUgPSBtYXRjaFsyXTtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbWF0Y2hbM107XG5cdFx0XHRcblx0XHRcdC8vIFRyeSB0byBmaW5kIHRoZSBmaWxlIHRvIHZhbGlkYXRlIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuZmluZEZpbGVCeU5hbWUoZG9jTmFtZSk7XG5cdFx0XHRpZiAoZmlsZSkge1xuXHRcdFx0XHRmb3VuZFJlZnMucHVzaCh7XG5cdFx0XHRcdFx0bmFtZTogZG9jTmFtZSxcblx0XHRcdFx0XHRwcm9wZXJ0eVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGQgZXhpc3RpbmcgcGVyc2lzdGVudCBjb250ZXh0IGZvciBjdXJyZW50IGZpbGVcblx0XHRjb25zdCBwZXJzaXN0ZW50RG9jcyA9IHRoaXMubXVsdGlEb2NIYW5kbGVyLmdldFBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGU/LnBhdGggfHwgJycpO1xuXHRcdHBlcnNpc3RlbnREb2NzLmZvckVhY2goZG9jID0+IHtcblx0XHRcdC8vIE9ubHkgYWRkIGlmIG5vdCBhbHJlYWR5IGluIGZvdW5kUmVmcyB0byBhdm9pZCBkdXBsaWNhdGVzXG5cdFx0XHRjb25zdCBleGlzdHMgPSBmb3VuZFJlZnMuc29tZShyZWYgPT4gcmVmLm5hbWUgPT09IGRvYy5maWxlLmJhc2VuYW1lKTtcblx0XHRcdGlmICghZXhpc3RzKSB7XG5cdFx0XHRcdGZvdW5kUmVmcy5wdXNoKHtcblx0XHRcdFx0XHRuYW1lOiBkb2MuZmlsZS5iYXNlbmFtZSxcblx0XHRcdFx0XHRwcm9wZXJ0eTogZG9jLnByb3BlcnR5XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gVXBkYXRlIHByZXZpZXdcblx0XHRpZiAoZm91bmRSZWZzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IHByZXZpZXdMaXN0ID0gdGhpcy5jb250ZXh0UHJldmlldy5xdWVyeVNlbGVjdG9yKCcubm92YS1jb250ZXh0LXByZXZpZXctbGlzdCcpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0aWYgKHByZXZpZXdMaXN0KSB7XG5cdFx0XHRcdGNvbnN0IGRvY05hbWVzID0gZm91bmRSZWZzLm1hcChyZWYgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IHN1ZmZpeCA9IHJlZi5wcm9wZXJ0eSA/IGAjJHtyZWYucHJvcGVydHl9YCA6ICcnO1xuXHRcdFx0XHRcdHJldHVybiBgJHtyZWYubmFtZX0ke3N1ZmZpeH1gO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cHJldmlld0xpc3QudGV4dENvbnRlbnQgPSBkb2NOYW1lcy5qb2luKCcsICcpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgZmluZEZpbGVCeU5hbWUobmFtZU9yUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcblx0XHQvLyBGaXJzdCB0cnkgZXhhY3QgcGF0aCBtYXRjaFxuXHRcdGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGgpO1xuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFRyeSB3aXRoIC5tZCBleHRlbnNpb25cblx0XHRcdGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCArICcubWQnKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0Ly8gU2VhcmNoIGJ5IGJhc2VuYW1lXG5cdFx0XHRjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblx0XHRcdGZpbGUgPSBmaWxlcy5maW5kKGYgPT4gXG5cdFx0XHRcdGYuYmFzZW5hbWUgPT09IG5hbWVPclBhdGggfHwgXG5cdFx0XHRcdGYubmFtZSA9PT0gbmFtZU9yUGF0aCB8fFxuXHRcdFx0XHRmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCkgfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGggKyAnLm1kJylcblx0XHRcdCkgfHwgbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGZpbGUgOiBudWxsO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLmVtcHR5KCk7XG5cdFx0XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRDb250ZXh0KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgYWxsRG9jcyA9IFsuLi50aGlzLmN1cnJlbnRDb250ZXh0LnRlbXBvcmFyeURvY3MsIC4uLnRoaXMuY3VycmVudENvbnRleHQucGVyc2lzdGVudERvY3NdO1xuXHRcdFxuXHRcdGlmIChhbGxEb2NzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gU2hvdyBhcyB0aGluIGxpbmUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIHNpemluZ1xuXHRcdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBibG9jaztcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMC45ZW0nIDogJzAuOGVtJ307XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHQvLyBTaW5nbGUgbGluZSBzdW1tYXJ5IChzYW1lIHN0eWxlIGFzIGxpdmUgcHJldmlldylcblx0XHRjb25zdCBzdW1tYXJ5RWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXN1bW1hcnknIH0pO1xuXHRcdHN1bW1hcnlFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBhdXRvO1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3Qgc3VtbWFyeVRleHRFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXN1bW1hcnktdGV4dCcgfSk7XG5cdFx0XG5cdFx0Y29uc3QgdG9rZW5QZXJjZW50ID0gTWF0aC5yb3VuZCgodGhpcy5jdXJyZW50Q29udGV4dC50b2tlbkNvdW50IC8gODAwMCkgKiAxMDApO1xuXHRcdGNvbnN0IGRvY05hbWVzID0gYWxsRG9jcy5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5zbGljZSgwLCBpc01vYmlsZSA/IDEgOiAyKTtcblx0XHRjb25zdCBtb3JlQ291bnQgPSBhbGxEb2NzLmxlbmd0aCA+IChpc01vYmlsZSA/IDEgOiAyKSA/IGAgKyR7YWxsRG9jcy5sZW5ndGggLSAoaXNNb2JpbGUgPyAxIDogMil9YCA6ICcnO1xuXHRcdFxuXHRcdC8vIE1vYmlsZS1vcHRpbWl6ZWQgdGV4dCAoc2hvcnRlciBvbiBtb2JpbGUpIHdpdGggcHJvcGVyIGZsZXggYWxpZ25tZW50XG5cdFx0c3VtbWFyeVRleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZmxleDogMTsgcG9pbnRlci1ldmVudHM6IG5vbmU7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cdFx0XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5VGV4dEVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJykgKyBgICR7ZG9jTmFtZXMuam9pbignLCAnKX0ke21vcmVDb3VudH0gKCR7dG9rZW5QZXJjZW50fSUpYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3VtbWFyeVRleHRFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCAke2RvY05hbWVzLmpvaW4oJywgJyl9JHttb3JlQ291bnR9ICgke3Rva2VuUGVyY2VudH0lIHRva2VucylgO1xuXHRcdH1cblx0XHRcblx0XHQvLyBNb2JpbGUtZnJpZW5kbHkgbW9yZSBtZW51IGluZGljYXRvclxuXHRcdGNvbnN0IGV4cGFuZEluZGljYXRvckVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kLWluZGljYXRvcicgfSk7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdtb3JlLWhvcml6b250YWwnLCBpc01vYmlsZSA/ICcxNnB4JyA6ICcxNHB4Jyk7IC8vIE1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Y29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCd9O1xuXHRcdFx0b3BhY2l0eTogMC44O1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHgnIDogJzRweCd9O1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0YDtcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5zZXRBdHRyKCd0aXRsZScsICdUYXAgdG8gbWFuYWdlIGRvY3VtZW50cycpO1xuXHRcdFxuXHRcdC8vIFZpc3VhbCBmZWVkYmFjayBvbiB0aGUgd2hvbGUgc3VtbWFyeSBsaW5lIGluc3RlYWQgb2YganVzdCB0aGUgaW5kaWNhdG9yXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpJztcblx0XHRcdH0pO1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFkZFRyYWNrZWRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHR9LCAxNTApO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMiknO1xuXHRcdFx0fSk7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEV4cGFuZGVkIHN0YXRlIC0gbW9iaWxlLXJlc3BvbnNpdmUgb3ZlcmxheVxuXHRcdGNvbnN0IGV4cGFuZGVkRWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkJyB9KTtcblx0XHRleHBhbmRlZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRyaWdodDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgJHtpc01vYmlsZSA/ICctNHB4IDE2cHgnIDogJy0ycHggOHB4J30gcmdiYSgwLCAwLCAwLCAke2lzTW9iaWxlID8gJzAuMTUnIDogJzAuMSd9KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAycHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAke2lzTW9iaWxlID8gJzYwdmgnIDogJzIwMHB4J307XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzEwMCUnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciBmb3IgZXhwYW5kZWQgc3RhdGUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIGNsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IGV4cGFuZGVkSGVhZGVyRWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZC1oZWFkZXInIH0pO1xuXHRcdGV4cGFuZGVkSGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgaGVhZGVyVGl0bGVFbCA9IGV4cGFuZGVkSGVhZGVyRWwuY3JlYXRlU3BhbigpO1xuXHRcdGhlYWRlclRpdGxlRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgRG9jdW1lbnRzICgke2FsbERvY3MubGVuZ3RofSlgO1xuXHRcdGhlYWRlclRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCBidXR0b24gdXNpbmcgc2FtZSBpY29uIGFzIG1haW4gc2lkZWJhclxuXHRcdGNvbnN0IGNsZWFyQWxsQnRuQ29tcG9uZW50ID0gbmV3IEJ1dHRvbkNvbXBvbmVudChleHBhbmRlZEhlYWRlckVsKTtcblx0XHRjbGVhckFsbEJ0bkNvbXBvbmVudC5zZXRJY29uKCdlcmFzZXInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGFsbCBkb2N1bWVudHMgZnJvbSBjb250ZXh0Jylcblx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcblx0XHRjb25zdCBjbGVhckFsbEJ0biA9IGNsZWFyQWxsQnRuQ29tcG9uZW50LmJ1dHRvbkVsO1xuXHRcdGNsZWFyQWxsQnRuLmFkZENsYXNzKCdub3ZhLWNvbnRleHQtY2xlYXItYWxsLWJ0bicpO1xuXHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCAxMnB4JyA6ICc0cHggOHB4J307XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvdWNoLWZyaWVuZGx5IGZlZWRiYWNrIGZvciBjbGVhciBidXR0b25cblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERvY3VtZW50IGxpc3QgZm9yIGV4cGFuZGVkIHN0YXRlXG5cdFx0Y29uc3QgZG9jTGlzdEVsID0gZXhwYW5kZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWxpc3QnIH0pO1xuXHRcdFxuXHRcdGFsbERvY3MuZm9yRWFjaCgoZG9jLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgZG9jSXRlbUVsID0gZG9jTGlzdEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtaXRlbScgfSk7XG5cdFx0XHRkb2NJdGVtRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdFx0Ym9yZGVyLWJvdHRvbTogJHtpbmRleCA8IGFsbERvY3MubGVuZ3RoIC0gMSA/ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJyA6ICdub25lJ307XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcblx0XHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc1NnB4JyA6ICdhdXRvJ307XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBkb2NJbmZvRWwgPSBkb2NJdGVtRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1pbmZvJyB9KTtcblx0XHRcdGRvY0luZm9FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6ICR7aXNNb2JpbGUgPyAnMTJweCcgOiAnOHB4J307XG5cdFx0XHRcdGZsZXg6IDE7XG5cdFx0XHRcdG1pbi13aWR0aDogMDtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGljb25FbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKCk7XG5cdFx0XHRpY29uRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdmaWxlLXRleHQnKTtcblx0XHRcdGljb25FbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGZvbnQtc2l6ZTogMWVtOyc7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1uYW1lJyB9KTtcblx0XHRcdGNvbnN0IHN1ZmZpeCA9IGRvYy5wcm9wZXJ0eSA/IGAjJHtkb2MucHJvcGVydHl9YCA6ICcnO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNDAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHR0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcblx0XHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdFx0d2hpdGUtc3BhY2U6IG5vd3JhcDtcblx0XHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0XHRgO1xuXHRcdFx0bmFtZUVsLnNldEF0dHIoJ3RpdGxlJywgZG9jLmZpbGUucGF0aCk7XG5cdFx0XHRcblx0XHRcdC8vIE1vYmlsZS1vcHRpbWl6ZWQgcmVtb3ZlIGJ1dHRvbiB3aXRoIGxhcmdlciB0b3VjaCB0YXJnZXRcblx0XHRcdGNvbnN0IHJlbW92ZUJ0biA9IGRvY0l0ZW1FbC5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLXJlbW92ZScgfSk7XG5cdFx0XHRyZW1vdmVCdG4uaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd4JywgaXNNb2JpbGUgPyAnMThweCcgOiAnMTRweCcpO1xuXHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdHdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0aGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE4cHgnIDogJzE0cHgnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiBib2xkO1xuXHRcdFx0YDtcblx0XHRcdHJlbW92ZUJ0bi5zZXRBdHRyKCd0aXRsZScsIGBSZW1vdmUgJHtkb2MuZmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdFxuXHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5yZW1vdmVQZXJzaXN0ZW50RG9jKHRoaXMuY3VycmVudEZpbGUucGF0aCwgZG9jLmZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gUGxhdGZvcm0tc3BlY2lmaWMgaW50ZXJhY3Rpb24gZmVlZGJhY2tcblx0XHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBUb3VjaCBmZWVkYmFjayBmb3IgZG9jdW1lbnQgaXRlbXNcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0XHR9LCAxNTApO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBDbGljayB0byBleHBhbmQgbWFuYWdlbWVudCBvdmVybGF5XG5cdFx0bGV0IGlzRXhwYW5kZWQgPSBmYWxzZTtcblx0XHRcblx0XHRjb25zdCB0b2dnbGVFeHBhbmRlZCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0aXNFeHBhbmRlZCA9ICFpc0V4cGFuZGVkO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNFeHBhbmRlZCkge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJzEwMDEnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQ2xpY2sgb24gdGhlIGVudGlyZSBzdW1tYXJ5IGxpbmUgdG8gZXhwYW5kXG5cdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRXhwYW5kZWQpO1xuXHRcdFxuXHRcdC8vIENsb3NlIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChlOiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKGlzRXhwYW5kZWQgJiYgIXRoaXMuY29udGV4dEluZGljYXRvci5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0V4cGFuZGVkID0gZmFsc2U7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm11bHRpRG9jSGFuZGxlci5idWlsZENvbnRleHQoJycsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IHJlc3VsdC5jb250ZXh0O1xuXHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVTZW5kKCkge1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZSkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2hlY2sgZm9yIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0aWYgKG1lc3NhZ2Uuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRjb25zdCBjb21tYW5kUmVzdWx0ID0gYXdhaXQgdGhpcy5oYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZSk7XG5cdFx0XHRpZiAoY29tbWFuZFJlc3VsdCkge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHRcdFx0Ly8gUmVzZXQgdGV4dGFyZWEgaGVpZ2h0IGFmdGVyIGNsZWFyaW5nXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5hdXRvR3Jvd1RleHRhcmVhKCksIDApO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkIGFuZCBwYXJzZSByZWZlcmVuY2VzXG5cdFx0bGV0IHByb2Nlc3NlZE1lc3NhZ2UgPSBtZXNzYWdlO1xuXHRcdGxldCBtdWx0aURvY0NvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcdFxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHQvLyBDaGVjayBmb3IgZWFybHkgYWNjZXNzXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdFx0aWYgKG1lc3NhZ2UuaW5jbHVkZXMoJ1tbJykgfHwgbWVzc2FnZS5pbmNsdWRlcygnK1tbJykpIHtcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2Jvb2stb3BlbicsICdNdWx0aS1kb2N1bWVudCBjb250ZXh0IGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIENhdGFseXN0IHN1cHBvcnRlcnMuIEF2YWlsYWJsZSB0byBhbGwgdXNlcnMgQXVndXN0IDE1LCAyMDI1LicpKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFBhcnNlIGFuZCBidWlsZCBjb250ZXh0XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRSZXN1bHQgPSBhd2FpdCB0aGlzLm11bHRpRG9jSGFuZGxlci5idWlsZENvbnRleHQobWVzc2FnZSwgdGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdHByb2Nlc3NlZE1lc3NhZ2UgPSBjb250ZXh0UmVzdWx0LmNsZWFuZWRNZXNzYWdlO1xuXHRcdFx0XHRtdWx0aURvY0NvbnRleHQgPSBjb250ZXh0UmVzdWx0LmNvbnRleHQ7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBtdWx0aURvY0NvbnRleHQ7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBVcGRhdGUgVUkgaW5kaWNhdG9yXG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgbWVzc2FnZSBpcyBqdXN0IGRvY3VtZW50IHJlZmVyZW5jZXMgKGNvbnRleHQtb25seSBtb2RlKVxuXHRcdFx0XHRjb25zdCBoYXNOZXdUZW1wRG9jcyA9IG11bHRpRG9jQ29udGV4dC50ZW1wb3JhcnlEb2NzLmxlbmd0aCA+IDA7XG5cdFx0XHRcdGNvbnN0IGhhc05ld1BlcnNpc3RlbnREb2NzID0gbXVsdGlEb2NDb250ZXh0LnRlbXBvcmFyeURvY3Muc29tZShkb2MgPT4gZG9jLmlzUGVyc2lzdGVudCk7XG5cdFx0XHRcdGNvbnN0IGlzQ29udGV4dE9ubHlNZXNzYWdlID0gcHJvY2Vzc2VkTWVzc2FnZS50cmltKCkubGVuZ3RoID09PSAwICYmIChoYXNOZXdUZW1wRG9jcyB8fCBoYXNOZXdQZXJzaXN0ZW50RG9jcyk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaXNDb250ZXh0T25seU1lc3NhZ2UpIHtcblx0XHRcdFx0XHQvLyBIYW5kbGUgY29udGV4dC1vbmx5IGNvbW1hbmRzXG5cdFx0XHRcdFx0aWYgKGhhc05ld1BlcnNpc3RlbnREb2NzKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBwZXJzaXN0ZW50RG9jcyA9IG11bHRpRG9jQ29udGV4dC50ZW1wb3JhcnlEb2NzLmZpbHRlcihkb2MgPT4gZG9jLmlzUGVyc2lzdGVudCk7XG5cdFx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IHBlcnNpc3RlbnREb2NzLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2NoZWNrLWNpcmNsZScsIGBBZGRlZCAke3BlcnNpc3RlbnREb2NzLmxlbmd0aH0gZG9jdW1lbnQke3BlcnNpc3RlbnREb2NzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSB0byBwZXJzaXN0ZW50IGNvbnRleHQ6ICR7ZG9jTmFtZXN9YCkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDbGVhciBpbnB1dCBhbmQgdXBkYXRlIGNvbnRleHQgaW5kaWNhdG9yXG5cdFx0XHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKSwgMCk7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gSGlkZSBjb250ZXh0IHByZXZpZXcgc2luY2Ugd2UncmUgZG9uZVxuXHRcdFx0XHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gU2hvdyBjb250ZXh0IGNvbmZpcm1hdGlvbiBpZiBkb2N1bWVudHMgd2VyZSBpbmNsdWRlZCBpbiBhIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0LnRlbXBvcmFyeURvY3MubGVuZ3RoID4gMCB8fCBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IGFsbERvY3MgPSBbLi4ubXVsdGlEb2NDb250ZXh0LnRlbXBvcmFyeURvY3MsIC4uLm11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jc107XG5cdFx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBhbGxEb2NzLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0Y29uc3QgdG9rZW5JbmZvID0gbXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnQgPiAwID8gYCAofiR7bXVsdGlEb2NDb250ZXh0LnRva2VuQ291bnR9IHRva2VucylgIDogJyc7XG5cdFx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdib29rLW9wZW4nLCBgSW5jbHVkZWQgJHthbGxEb2NzLmxlbmd0aH0gZG9jdW1lbnQke2FsbERvY3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9IGluIGNvbnRleHQ6ICR7ZG9jTmFtZXN9JHt0b2tlbkluZm99YCkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayB0b2tlbiBsaW1pdFxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0LmlzTmVhckxpbWl0KSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIEFwcHJvYWNoaW5nIHRva2VuIGxpbWl0LiBDb25zaWRlciByZW1vdmluZyBzb21lIGRvY3VtZW50cyBmcm9tIGNvbnRleHQuJywgNTAwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGQgdXNlciBtZXNzYWdlIChzaG93IG9yaWdpbmFsIHdpdGggcmVmZXJlbmNlcylcblx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKCcnKTtcblx0XHQvLyBSZXNldCB0ZXh0YXJlYSBoZWlnaHQgYWZ0ZXIgY2xlYXJpbmdcblx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcblx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBzZW5kaW5nIHRoZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldERpc2FibGVkKHRydWUpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBsb2FkaW5nIGluZGljYXRvciB3aXRoIGFuaW1hdGVkIG5vdmFcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxvYWRpbmcnIH0pO1xuXHRcdFx0bG9hZGluZ0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAxMnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDEwcHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBDcmVhdGUgYW5pbWF0ZWQgbm92YSBidXJzdFxuXHRcdFx0Y29uc3Qgbm92YUNvbnRhaW5lciA9IGxvYWRpbmdFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJ1cnN0LWNvbnRhaW5lcicgfSk7XG5cdFx0XHRub3ZhQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYnVyc3RcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jb3JlXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTJcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0zXCI+PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgdGV4dEVsID0gbG9hZGluZ0VsLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTm92YSBpcyB0aGlua2luZy4uLicgfSk7XG5cdFx0XHR0ZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gU3RvcmUgbWVzc2FnZSBpbiBjb252ZXJzYXRpb24gbWFuYWdlclxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShtZXNzYWdlKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIGNvbW1hbmQgb3IgY29udmVyc2F0aW9uXG5cdFx0XHRjb25zdCBpc0xpa2VseUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyWydpc0xpa2VseUNvbW1hbmQnXShwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdGxldCByZXNwb25zZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdFx0XHRcblx0XHRcdGlmIChpc0xpa2VseUNvbW1hbmQgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBQYXJzZSBhcyBjb21tYW5kIGFuZCByb3V0ZSB0byBhcHByb3ByaWF0ZSBoYW5kbGVyXG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGFzIGNvbnZlcnNhdGlvbiB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0XHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKHByb2Nlc3NlZE1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBtdWx0aS1kb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0ICYmIG11bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nKSB7XG5cdFx0XHRcdFx0Ly8gRW5oYW5jZSB0aGUgcHJvbXB0IHdpdGggYWRkaXRpb25hbCBjb250ZXh0XG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRVc2VyUHJvbXB0ID0gYCR7bXVsdGlEb2NDb250ZXh0LmNvbnRleHRTdHJpbmd9XFxuXFxuLS0tXFxuXFxuQ3VycmVudCBSZXF1ZXN0OiAke3Byb21wdC51c2VyUHJvbXB0fWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0LCBlbmhhbmNlZFVzZXJQcm9tcHQsIHtcblx0XHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRcdFx0bWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIEdldCBBSSByZXNwb25zZSB1c2luZyB0aGUgcHJvdmlkZXIgbWFuYWdlclxuXHRcdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCwgcHJvbXB0LnVzZXJQcm9tcHQsIHtcblx0XHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRcdFx0bWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvclxuXHRcdFx0bG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHQvLyBTdG9yZSByZXNwb25zZSBpbiBjb252ZXJzYXRpb24gbWFuYWdlciAoaWYgcmVzcG9uc2UgZXhpc3RzKVxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUgJiYgcmVzcG9uc2UpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShyZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBBSSByZXNwb25zZSAob25seSBpZiB0aGVyZSBpcyBhIHJlc3BvbnNlKVxuXHRcdFx0aWYgKHJlc3BvbnNlKSB7XG5cdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgcmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3IgaWYgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtbG9hZGluZycpO1xuXHRcdFx0aWYgKGxvYWRpbmdFbCkgbG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGBTb3JyeSwgSSBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXREaXNhYmxlZChmYWxzZSk7XG5cdFx0XHQvLyBSZWZyZXNoIGNvbnRleHQgaW5kaWNhdG9yIHRvIHNob3cgcGVyc2lzdGVudCBkb2N1bWVudHNcblx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBpbnNlcnRUZXh0SW50b0FjdGl2ZU5vdGUodGV4dDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KTtcblx0XHRpZiAoYWN0aXZlVmlldyAmJiAnZWRpdG9yJyBpbiBhY3RpdmVWaWV3KSB7XG5cdFx0XHRjb25zdCBlZGl0b3IgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmVkaXRvcjtcblx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRcdFx0XHRlZGl0b3IucmVwbGFjZVJhbmdlKHRleHQsIGN1cnNvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBDaGVjayBpZiB0aGVyZSdzIGEgY3VycmVudCBmaWxlICh0aGUgb25lIHdlJ3JlIGNoYXR0aW5nIGFib3V0KVxuXHRcdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsICdObyBtYXJrZG93biBmaWxlIGlzIG9wZW4uIFBsZWFzZSBvcGVuIGEgZmlsZSBpbiB0aGUgZWRpdG9yIHRvIHVzZSBlZGl0aW5nIGNvbW1hbmRzLicpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBFbnN1cmUgdGhlcmUncyBhIG1hcmtkb3duIHZpZXcgd2l0aCB0aGlzIGZpbGVcblx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG5cdFx0XHRsZXQgbWFya2Rvd25WaWV3OiBNYXJrZG93blZpZXcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0Ly8gRmluZCB0aGUgdmlldyB3aXRoIG91ciBmaWxlXG5cdFx0XHRmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHRpZiAodmlldy5maWxlID09PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0bWFya2Rvd25WaWV3ID0gdmlldztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBJZiBub3QgZm91bmQsIHRyeSB0byBvcGVuIHRoZSBmaWxlXG5cdFx0XHRpZiAoIW1hcmtkb3duVmlldykge1xuXHRcdFx0XHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuXHRcdFx0XHRpZiAobGVhZikge1xuXHRcdFx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUodGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdFx0bWFya2Rvd25WaWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoIW1hcmtkb3duVmlldykge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgVW5hYmxlIHRvIGFjY2VzcyB0aGUgZmlsZSBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIi4gUGxlYXNlIG1ha2Ugc3VyZSBpdCdzIG9wZW4gaW4gdGhlIGVkaXRvci5gKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFkZENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmRlbGV0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gYEkgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgY29tbWFuZCBcIiR7Y29tbWFuZC5hY3Rpb259XCIuIFRyeSBhc2tpbmcgbWUgdG8gYWRkLCBlZGl0LCBkZWxldGUsIGZpeCBncmFtbWFyLCBvciByZXdyaXRlIGNvbnRlbnQuYDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdC8vIEFkZCBjb21wYWN0IHN1Y2Nlc3MgaW5kaWNhdG9yIGluc3RlYWQgb2YgZnVsbCBtZXNzYWdlXG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc0luZGljYXRvcihjb21tYW5kLmFjdGlvbik7XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBEb24ndCByZXR1cm4gdGV4dCBmb3IgcmVndWxhciBtZXNzYWdlXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gYEZhaWxlZCB0byAke2NvbW1hbmQuYWN0aW9ufTogJHtyZXN1bHQuZXJyb3J9YDtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEVycm9yIGV4ZWN1dGluZyBjb21tYW5kOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gKTtcblx0XHR9XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKSB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gSWYgbm8gYWN0aXZlIGZpbGUsIHRyeSB0byBmaW5kIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxlYWYncyBmaWxlXG5cdFx0bGV0IHRhcmdldEZpbGUgPSBhY3RpdmVGaWxlO1xuXHRcdGlmICghdGFyZ2V0RmlsZSkge1xuXHRcdFx0Y29uc3QgYWN0aXZlTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmO1xuXHRcdFx0aWYgKGFjdGl2ZUxlYWYgJiYgYWN0aXZlTGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHRhcmdldEZpbGUgPSBhY3RpdmVMZWFmLnZpZXcuZmlsZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGwgYmFjayB0byBhbnkgb3BlbiBtYXJrZG93biBmaWxlIG9ubHkgaWYgbm8gYWN0aXZlIGxlYWZcblx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0XHR0YXJnZXRGaWxlID0gdmlldy5maWxlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIG5vIGZpbGUgb3Igc2FtZSBmaWxlLCBkbyBub3RoaW5nXG5cdFx0aWYgKCF0YXJnZXRGaWxlIHx8IHRhcmdldEZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50RmlsZSA9IHRhcmdldEZpbGU7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY3VycmVudCBjaGF0XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGZvciBuZXcgZmlsZSAodGhpcyB3aWxsIHNob3cgcGVyc2lzdGVudCBkb2N1bWVudHMgaWYgYW55KVxuXHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gTG9hZCBjb252ZXJzYXRpb24gaGlzdG9yeSBpZiBpdCBleGlzdHNcblx0XHRcdGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyh0YXJnZXRGaWxlLCAxMCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZWNlbnRNZXNzYWdlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vIERpc3BsYXkgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG5cdFx0XHRcdHJlY2VudE1lc3NhZ2VzLmZvckVhY2gobXNnID0+IHtcblx0XHRcdFx0XHRpZiAobXNnLnJvbGUgIT09ICdzeXN0ZW0nKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UobXNnLnJvbGUgYXMgJ3VzZXInIHwgJ2Fzc2lzdGFudCcsIG1zZy5jb250ZW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2UgZm9yIG5ldyBmaWxlXG5cdFx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYFJlYWR5IHRvIGhlbHAgeW91IHdpdGggXCIke3RhcmdldEZpbGUuYmFzZW5hbWV9XCIuIFdoYXQgd291bGQgeW91IGxpa2UgdG8gZG8/YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGhpc3Rvcnk6JywgZXJyb3IpO1xuXHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2Ugb24gZXJyb3Jcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYFJlYWR5IHRvIGhlbHAgeW91IHdpdGggXCIke3RhcmdldEZpbGUuYmFzZW5hbWV9XCIuIFdoYXQgd291bGQgeW91IGxpa2UgdG8gZG8/YCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjbGVhckNoYXQoKSB7XG5cdFx0Ly8gQ2xlYXIgdGhlIGNoYXQgY29udGFpbmVyXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY29udmVyc2F0aW9uIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24odGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdC8vIEFsc28gY2xlYXIgbXVsdGktZG9jIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNsZWFyIGNvbnZlcnNhdGlvbjonLCBlcnJvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgZnJlc2ggd2VsY29tZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYENoYXQgY2xlYXJlZCEgUmVhZHkgdG8gaGVscCB5b3Ugd2l0aCBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShcIkNoYXQgY2xlYXJlZCEgUmVhZHkgdG8gaGVscC4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkbz9cIik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgbm90aWNlIHRvIHVzZXJcblx0XHRuZXcgTm90aWNlKCdDaGF0IGhpc3RvcnkgY2xlYXJlZCcpO1xuXHR9XG5cblx0Ly8gUHVibGljIG1ldGhvZHMgZm9yIHRlc3Rpbmdcblx0YXN5bmMgc2VuZE1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBCdWlsZCBwcm9tcHQgdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKG1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcblx0XHQvLyBUcnkgdG8gcGFyc2UgYXMgY29tbWFuZCBmaXJzdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiBpdCdzIGEgdmFsaWQgY29tbWFuZCBhY3Rpb25cblx0XHRjb25zdCB2YWxpZEFjdGlvbnMgPSBbJ2FkZCcsICdlZGl0JywgJ2RlbGV0ZScsICdncmFtbWFyJywgJ3Jld3JpdGUnXTtcblx0XHRpZiAodmFsaWRBY3Rpb25zLmluY2x1ZGVzKGNvbW1hbmQuYWN0aW9uKSkge1xuXHRcdFx0Ly8gRXhlY3V0ZSBjb21tYW5kXG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBSZWd1bGFyIGNvbnZlcnNhdGlvblxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShhY3RpdmVGaWxlLCBtZXNzYWdlLCBudWxsIGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIENhbGwgQUkgcHJvdmlkZXJcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIHByb21wdC51c2VyUHJvbXB0KTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGFjdGl2ZUZpbGUsICdBSSByZXNwb25zZScsIHsgc3VjY2VzczogdHJ1ZSwgZWRpdFR5cGU6ICdub25lJyB9IGFzIGFueSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkoZmlsZTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHQvLyBJbiByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGRpc3BsYXkgbWVzc2FnZXMgaW4gdGhlIFVJXG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHN0YXRpYyBwcm92aWRlciBzdGF0dXMgZGlzcGxheVxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVTdGF0aWNQcm92aWRlclN0YXR1cyhjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgcHJvdmlkZXJTdGF0dXMgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXItcHJvdmlkZXInIH0pO1xuXHRcdHByb3ZpZGVyU3RhdHVzLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRvcGFjaXR5OiAwLjg7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJTdGF0dXNEb3QgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtZG90LXNtYWxsJyB9KTtcblx0XHRoZWFkZXJTdGF0dXNEb3Quc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHdpZHRoOiA2cHg7XG5cdFx0XHRoZWlnaHQ6IDZweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGJhY2tncm91bmQ6ICM0Y2FmNTA7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBoZWFkZXJQcm92aWRlck5hbWUgPSBwcm92aWRlclN0YXR1cy5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nIH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBuYW1lIGFzeW5jaHJvbm91c2x5XG5cdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpLnRoZW4obmFtZSA9PiB7XG5cdFx0XHRoZWFkZXJQcm92aWRlck5hbWUuc2V0VGV4dChuYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlckRyb3Bkb3duKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWNvbnRhaW5lcicgfSk7XG5cdFx0ZHJvcGRvd25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHByb3ZpZGVyIGJ1dHRvblxuXHRcdGNvbnN0IHByb3ZpZGVyQnV0dG9uID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1wcm92aWRlci1idXR0b24nIH0pO1xuXHRcdHByb3ZpZGVyQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogNHB4IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gU3RhdHVzIGRvdFxuXHRcdGNvbnN0IHN0YXR1c0RvdCA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXN0YXR1cy1kb3Qtc21hbGwnIH0pO1xuXHRcdHN0YXR1c0RvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0d2lkdGg6IDZweDtcblx0XHRcdGhlaWdodDogNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0YmFja2dyb3VuZDogIzRjYWY1MDtcblx0XHRgO1xuXG5cdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTG9hZGluZy4uLicgfSk7XG5cblx0XHQvLyBEcm9wZG93biBhcnJvd1xuXHRcdGNvbnN0IGRyb3Bkb3duQXJyb3cgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCQycgfSk7XG5cdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdG1hcmdpbi1sZWZ0OiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBEcm9wZG93biBtZW51IChpbml0aWFsbHkgaGlkZGVuKVxuXHRcdGNvbnN0IGRyb3Bkb3duTWVudSA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudScgfSk7XG5cdFx0ZHJvcGRvd25NZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdG1pbi13aWR0aDogMTUwcHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdGA7XG5cblx0XHRsZXQgaXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblxuXHRcdC8vIFVwZGF0ZSBjdXJyZW50IHByb3ZpZGVyIGRpc3BsYXlcblx0XHRjb25zdCB1cGRhdGVDdXJyZW50UHJvdmlkZXIgPSBhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXHRcdFx0cHJvdmlkZXJOYW1lLnNldFRleHQoY3VycmVudFByb3ZpZGVyTmFtZSk7XG5cdFx0fTtcblxuXHRcdC8vIFRvZ2dsZSBkcm9wZG93blxuXHRcdGNvbnN0IHRvZ2dsZURyb3Bkb3duID0gKCkgPT4ge1xuXHRcdFx0aXNEcm9wZG93bk9wZW4gPSAhaXNEcm9wZG93bk9wZW47XG5cdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9IGlzRHJvcGRvd25PcGVuID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gaXNEcm9wZG93bk9wZW4gPyAncm90YXRlKDE4MGRlZyknIDogJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHRcblx0XHRcdGlmIChpc0Ryb3Bkb3duT3Blbikge1xuXHRcdFx0XHR0aGlzLnBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBDbG9zZSBkcm9wZG93biB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjbG9zZURyb3Bkb3duOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCFkcm9wZG93bkNvbnRhaW5lci5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0aXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblx0XHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHByb3ZpZGVyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR0b2dnbGVEcm9wZG93bigpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQWRkIGdsb2JhbCBjbGljayBsaXN0ZW5lclxuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNsb3NlRHJvcGRvd24pO1xuXG5cdFx0Ly8gVXBkYXRlIHByb3ZpZGVyIG5hbWUgaW5pdGlhbGx5XG5cdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIGNsZWFudXBcblx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duID0ge1xuXHRcdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyLFxuXHRcdFx0Y2xlYW51cDogKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZURyb3Bkb3duKVxuXHRcdH07XG5cdH1cblxuXHQvKipcblx0ICogUG9wdWxhdGUgcHJvdmlkZXIgZHJvcGRvd24gd2l0aCBhdmFpbGFibGUgcHJvdmlkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnU6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cblx0XHRjb25zdCBhbGxvd2VkUHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlck5hbWUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk7XG5cblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBhbGxvd2VkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBwcm92aWRlckl0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1pdGVtJyB9KTtcblx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDhweDtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjg1ZW07XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgaWNvbi9kb3Rcblx0XHRcdGNvbnN0IHByb3ZpZGVyRG90ID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdHByb3ZpZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHdpZHRoOiA4cHg7XG5cdFx0XHRcdGhlaWdodDogOHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGJhY2tncm91bmQ6ICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gUHJvdmlkZXIgbmFtZVxuXHRcdFx0Y29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IG5hbWVTcGFuID0gcHJvdmlkZXJJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiBkaXNwbGF5TmFtZSB9KTtcblxuXHRcdFx0Ly8gTWFyayBjdXJyZW50IHByb3ZpZGVyXG5cdFx0XHRjb25zdCBpc0N1cnJlbnQgPSBkaXNwbGF5TmFtZSA9PT0gY3VycmVudFByb3ZpZGVyTmFtZTtcblx0XHRcdGlmIChpc0N1cnJlbnQpIHtcblx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHRuYW1lU3Bhbi5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDbGljayBoYW5kbGVyXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdFx0Ly8gQ2xvc2UgZHJvcGRvd25cblx0XHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIb3ZlciBlZmZlY3Rcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKSc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdDbGF1ZGUgKEFudGhyb3BpYyknLFxuXHRcdFx0J29wZW5haSc6ICdHUFQtNCAoT3BlbkFJKScsXG5cdFx0XHQnZ29vZ2xlJzogJ0dlbWluaSAoR29vZ2xlKScsXG5cdFx0XHQnb2xsYW1hJzogJ09sbGFtYSAoTG9jYWwpJyxcblx0XHRcdCdub25lJzogJ05vbmUnXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJUeXBlXSB8fCBwcm92aWRlclR5cGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGNvbG9yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnI0QyNjkxRScsXG5cdFx0XHQnb3BlbmFpJzogJyMxMEEzN0YnLFxuXHRcdFx0J2dvb2dsZSc6ICcjNDI4NUY0Jyxcblx0XHRcdCdvbGxhbWEnOiAnIzdDM0FFRCcsXG5cdFx0XHQnbm9uZSc6ICcjOTk5J1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICcjNGNhZjUwJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgcHJvdmlkZXIgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBhIHN5c3RlbSBtZXNzYWdlIGFib3V0IHByb3ZpZGVyIHN3aXRjaGluZ1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKTtcblx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgc3dpdGNoTWVzc2FnZSk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0aGUgcGxhdGZvcm0gc2V0dGluZ3MgdG8gdXNlIHRoZSBuZXcgcHJvdmlkZXJcblx0XHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbcGxhdGZvcm1dLnByaW1hcnlQcm92aWRlciA9IHByb3ZpZGVyVHlwZSBhcyBhbnk7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmUtaW5pdGlhbGl6ZSB0aGUgcHJvdmlkZXIgbWFuYWdlciB3aXRoIG5ldyBzZXR0aW5nc1xuXHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN3aXRjaGluZyBwcm92aWRlcjonLCBlcnJvcik7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEZhaWxlZCB0byBzd2l0Y2ggdG8gJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKSk7XG5cdFx0fVxuXHR9XG5cbn0iLCAiLyoqXG4gKiBDdXN0b20gd2lraWxpbmsgYXV0b2NvbXBsZXRlIGZvciBOb3ZhIHRleHRhcmVhXG4gKiBQcm92aWRlcyBbW2RvY3VtZW50XV0gc3VnZ2VzdGlvbnMgd2hlbiB0eXBpbmcgaW4gTm92YSdzIHRleHRhcmVhXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUsIEFwcCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBXaWtpbGlua1N1Z2dlc3Rpb24ge1xuICAgIGZpbGU6IFRGaWxlO1xuICAgIGRpc3BsYXlUZXh0OiBzdHJpbmc7XG4gICAgc2NvcmU6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgIHByaXZhdGUgc3VnZ2VzdGlvblBvcHVwOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgc3VnZ2VzdGlvbnM6IFdpa2lsaW5rU3VnZ2VzdGlvbltdID0gW107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZEluZGV4OiBudW1iZXIgPSAtMTtcbiAgICBwcml2YXRlIGlzVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgY3VycmVudFF1ZXJ5OiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIGN1cnJlbnRUcmlnZ2VyUG9zOiBudW1iZXIgPSAtMTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuICAgICAgICB0aGlzLnNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleWRvd24uYmluZCh0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbG9zZSBvbiBmb2N1cyBsb3NzXG4gICAgICAgIHRoaXMudGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsICgpID0+IHtcbiAgICAgICAgICAgIC8vIERlbGF5IHRvIGFsbG93IHNlbGVjdGlvbiBjbGlja3NcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKSwgMTUwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgY2xpY2sgb3V0c2lkZVxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9uUG9wdXAgJiYgIXRoaXMuc3VnZ2VzdGlvblBvcHVwLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpICYmIGUudGFyZ2V0ICE9PSB0aGlzLnRleHRBcmVhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVJbnB1dCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dEFyZWEudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIFxuICAgICAgICAvLyBMb29rIGZvciBbWyBwYXR0ZXJuIGJlZm9yZSBjdXJzb3JcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC8oXFwrKT9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxpbmtNYXRjaCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlcnkgPSBsaW5rTWF0Y2hbMl0gfHwgJyc7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUcmlnZ2VyUG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuc2hvd1N1Z2dlc3Rpb25zKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlkb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZEluZGV4ICsgMSwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWF4KHRoaXMuc2VsZWN0ZWRJbmRleCAtIDEsIC0xKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgICAgY2FzZSAnVGFiJzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24odGhpcy5zdWdnZXN0aW9uc1t0aGlzLnNlbGVjdGVkSW5kZXhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdFc2NhcGUnOlxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93U3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKHRoaXMuY3VycmVudFF1ZXJ5KTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVTdWdnZXN0aW9uUG9wdXAoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJTdWdnZXN0aW9ucygpO1xuICAgICAgICB0aGlzLnBvc2l0aW9uUG9wdXAoKTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhpZGVTdWdnZXN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU3VnZ2VzdGlvblBvcHVwKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5jbGFzc05hbWUgPSAnbm92YS13aWtpbGluay1zdWdnZXN0aW9ucyc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuICAgICAgICAgICAgbWF4LWhlaWdodDogMjAwcHg7XG4gICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgICBtaW4td2lkdGg6IDIwMHB4O1xuICAgICAgICBgO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5zZXJ0IGFmdGVyIHRoZSB0ZXh0YXJlYVxuICAgICAgICB0aGlzLnRleHRBcmVhLnBhcmVudEVsZW1lbnQ/LmFwcGVuZENoaWxkKHRoaXMuc3VnZ2VzdGlvblBvcHVwKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlclN1Z2dlc3Rpb25zKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuc3VnZ2VzdGlvblBvcHVwKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5mb3JFYWNoKChzdWdnZXN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvblBvcHVwIS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Z2dlc3Rpb24taXRlbScgfSk7XG4gICAgICAgICAgICBpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgcGFkZGluZzogOHB4IDEycHg7XG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmlsZSBuYW1lXG4gICAgICAgICAgICBjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3VnZ2VzdGlvbi1uYW1lJyB9KTtcbiAgICAgICAgICAgIG5hbWVFbC50ZXh0Q29udGVudCA9IHN1Z2dlc3Rpb24uZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgICAgIG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAycHg7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGaWxlIHBhdGggKGlmIGRpZmZlcmVudCBmcm9tIG5hbWUpXG4gICAgICAgICAgICBpZiAoc3VnZ2VzdGlvbi5maWxlLnBhdGggIT09IHN1Z2dlc3Rpb24uZmlsZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aEVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1Z2dlc3Rpb24tcGF0aCcgfSk7XG4gICAgICAgICAgICAgICAgcGF0aEVsLnRleHRDb250ZW50ID0gc3VnZ2VzdGlvbi5maWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgcGF0aEVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NWVtO1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcubm92YS1zdWdnZXN0aW9uLWl0ZW0nKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBpdGVtIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcG9zaXRpb25Qb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgLy8gUG9zaXRpb24gYWJvdmUgdGhlIHRleHRhcmVhXG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLnRleHRBcmVhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBjb25zdCBwb3B1cEhlaWdodCA9IE1hdGgubWluKDIwMCwgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggKiA1MCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmxlZnQgPSAnMCc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmJvdHRvbSA9ICcxMDAlJztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUubWFyZ2luQm90dG9tID0gJzRweCc7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLndpZHRoID0gYCR7cmVjdC53aWR0aH1weGA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IFdpa2lsaW5rU3VnZ2VzdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0QXJlYS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy50ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIFtbIHBhdHRlcm4gdG8gcmVwbGFjZVxuICAgICAgICBjb25zdCBiZWZvcmVDdXJzb3IgPSB0ZXh0LnN1YnN0cmluZygwLCBjdXJzb3JQb3MpO1xuICAgICAgICBjb25zdCBsaW5rTWF0Y2ggPSBiZWZvcmVDdXJzb3IubWF0Y2goLyhcXCspP1xcW1xcWyhbXlxcXV0qPykkLyk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWxpbmtNYXRjaCkgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaXNQZXJzaXN0ZW50ID0gISFsaW5rTWF0Y2hbMV07XG4gICAgICAgIGNvbnN0IHN0YXJ0UG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgcmVwbGFjZW1lbnQgdGV4dFxuICAgICAgICBjb25zdCBsaW5rVGV4dCA9IGBbWyR7c3VnZ2VzdGlvbi5maWxlLmJhc2VuYW1lfV1dYDtcbiAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBpc1BlcnNpc3RlbnQgPyBgKyR7bGlua1RleHR9YCA6IGxpbmtUZXh0O1xuICAgICAgICBcbiAgICAgICAgLy8gUmVwbGFjZSB0aGUgdGV4dFxuICAgICAgICBjb25zdCBuZXdUZXh0ID0gdGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRQb3MpICsgcmVwbGFjZW1lbnQgKyB0ZXh0LnN1YnN0cmluZyhjdXJzb3JQb3MpO1xuICAgICAgICB0aGlzLnRleHRBcmVhLnZhbHVlID0gbmV3VGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhZnRlciB0aGUgbGlua1xuICAgICAgICBjb25zdCBuZXdDdXJzb3JQb3MgPSBzdGFydFBvcyArIHJlcGxhY2VtZW50Lmxlbmd0aDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5zZXRTZWxlY3Rpb25SYW5nZShuZXdDdXJzb3JQb3MsIG5ld0N1cnNvclBvcyk7XG4gICAgICAgIFxuICAgICAgICAvLyBUcmlnZ2VyIGlucHV0IGV2ZW50IHRvIHVwZGF0ZSBhbnkgYXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5mb2N1cygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFdpa2lsaW5rU3VnZ2VzdGlvbltdIHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBXaWtpbGlua1N1Z2dlc3Rpb25bXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBzY29yZSA9IHRoaXMuc2NvcmVGaWxlKGZpbGUsIHF1ZXJ5KTtcbiAgICAgICAgICAgIGlmIChzY29yZSA+IDApIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVRleHQ6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3JlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNvcnQgYnkgc2NvcmUgKGhpZ2hlc3QgZmlyc3QpIGFuZCBsaW1pdCByZXN1bHRzXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKVxuICAgICAgICAgICAgLnNsaWNlKDAsIDgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2NvcmVGaWxlKGZpbGU6IFRGaWxlLCBxdWVyeTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKCFxdWVyeSkgcmV0dXJuIDUwOyAvLyBTaG93IGFsbCBmaWxlcyB3aGVuIG5vIHF1ZXJ5XG4gICAgICAgIFxuICAgICAgICBjb25zdCBiYXNlbmFtZSA9IGZpbGUuYmFzZW5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgcGF0aCA9IGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBxdWVyeUxvd2VyID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4YWN0IG1hdGNoXG4gICAgICAgIGlmIChiYXNlbmFtZSA9PT0gcXVlcnlMb3dlcikgcmV0dXJuIDEwMDtcbiAgICAgICAgXG4gICAgICAgIC8vIFN0YXJ0cyB3aXRoIHF1ZXJ5XG4gICAgICAgIGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKHF1ZXJ5TG93ZXIpKSByZXR1cm4gODA7XG4gICAgICAgIFxuICAgICAgICAvLyBDb250YWlucyBxdWVyeVxuICAgICAgICBpZiAoYmFzZW5hbWUuaW5jbHVkZXMocXVlcnlMb3dlcikpIHJldHVybiA2MDtcbiAgICAgICAgXG4gICAgICAgIC8vIFBhdGggY29udGFpbnMgcXVlcnlcbiAgICAgICAgaWYgKHBhdGguaW5jbHVkZXMocXVlcnlMb3dlcikpIHJldHVybiA0MDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZ1enp5IG1hdGNoXG4gICAgICAgIGlmICh0aGlzLmZ1enp5TWF0Y2goYmFzZW5hbWUsIHF1ZXJ5TG93ZXIpKSByZXR1cm4gMjA7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZ1enp5TWF0Y2godGV4dDogc3RyaW5nLCBxdWVyeTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB0ZXh0SW5kZXggPSAwO1xuICAgICAgICBsZXQgcXVlcnlJbmRleCA9IDA7XG4gICAgICAgIFxuICAgICAgICB3aGlsZSAodGV4dEluZGV4IDwgdGV4dC5sZW5ndGggJiYgcXVlcnlJbmRleCA8IHF1ZXJ5Lmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHRleHRbdGV4dEluZGV4XSA9PT0gcXVlcnlbcXVlcnlJbmRleF0pIHtcbiAgICAgICAgICAgICAgICBxdWVyeUluZGV4Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ZXh0SW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHF1ZXJ5SW5kZXggPT09IHF1ZXJ5Lmxlbmd0aDtcbiAgICB9XG5cbiAgICBkZXN0cm95KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9uUG9wdXApIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIE11bHRpLWRvY3VtZW50IGNvbnRleHQgaGFuZGxlciBmb3IgTm92YVxuICogUGFyc2VzIFtbZG9jXV0gYW5kICtbW2RvY11dIHN5bnRheCBmb3IgYWRkaXRpb25hbCBjb250ZXh0XG4gKi9cblxuaW1wb3J0IHsgQXBwLCBURmlsZSwgQ2FjaGVkTWV0YWRhdGEgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9jdW1lbnRSZWZlcmVuY2Uge1xuICAgIC8qKiBUaGUgZmlsZSBiZWluZyByZWZlcmVuY2VkICovXG4gICAgZmlsZTogVEZpbGU7XG4gICAgXG4gICAgLyoqIFdoZXRoZXIgdGhpcyBpcyBwZXJzaXN0ZW50IGNvbnRleHQgKCtbW2RvY11dKSAqL1xuICAgIGlzUGVyc2lzdGVudDogYm9vbGVhbjtcbiAgICBcbiAgICAvKiogVGhlIHJhdyByZWZlcmVuY2UgdGV4dCAoZS5nLiwgXCJbW015IERvY3VtZW50XV1cIikgKi9cbiAgICByYXdSZWZlcmVuY2U6IHN0cmluZztcbiAgICBcbiAgICAvKiogU3BlY2lmaWMgcHJvcGVydHkgdG8gZXh0cmFjdCAoZS5nLiwgXCJbW2RvYyNwcm9wZXJ0eV1dXCIpICovXG4gICAgcHJvcGVydHk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTXVsdGlEb2NDb250ZXh0IHtcbiAgICAvKiogRG9jdW1lbnRzIHJlZmVyZW5jZWQgaW4gY3VycmVudCBtZXNzYWdlICovXG4gICAgdGVtcG9yYXJ5RG9jczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICBcbiAgICAvKiogRG9jdW1lbnRzIGluIHBlcnNpc3RlbnQgY29udGV4dCAqL1xuICAgIHBlcnNpc3RlbnREb2NzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIFxuICAgIC8qKiBDb21iaW5lZCBjb250ZXh0IHN0cmluZyAqL1xuICAgIGNvbnRleHRTdHJpbmc6IHN0cmluZztcbiAgICBcbiAgICAvKiogRXN0aW1hdGVkIHRva2VuIGNvdW50ICovXG4gICAgdG9rZW5Db3VudDogbnVtYmVyO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHdlJ3JlIGFwcHJvYWNoaW5nIHRva2VuIGxpbWl0ICovXG4gICAgaXNOZWFyTGltaXQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBNdWx0aURvY0NvbnRleHRIYW5kbGVyIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGVyc2lzdGVudENvbnRleHQ6IE1hcDxzdHJpbmcsIERvY3VtZW50UmVmZXJlbmNlW10+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgVE9LRU5fTElNSVQgPSA4MDAwO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgV0FSTklOR19USFJFU0hPTEQgPSAwLjg7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIG1lc3NhZ2UgZm9yIGRvY3VtZW50IHJlZmVyZW5jZXNcbiAgICAgKi9cbiAgICBwYXJzZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCBjb252ZXJzYXRpb25GaWxlUGF0aDogc3RyaW5nKToge1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuICAgIH0ge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdID0gW107XG4gICAgICAgIGxldCBjbGVhbmVkTWVzc2FnZSA9IG1lc3NhZ2U7XG5cbiAgICAgICAgLy8gUGF0dGVybiB0byBtYXRjaCBbW2RvY11dIGFuZCArW1tkb2NdXSB3aXRoIG9wdGlvbmFsIHByb3BlcnR5XG4gICAgICAgIC8vIE5vdGU6IEFsbCBkb2N1bWVudCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuICAgICAgICBjb25zdCByZWZQYXR0ZXJuID0gLyhcXCspP1xcW1xcWyhbXlxcXV0rPykoPzojKFteXFxdXSs/KSk/XFxdXFxdL2c7XG4gICAgICAgIFxuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuICAgICAgICAgICAgY29uc3QgcmF3UmVmZXJlbmNlID0gbWF0Y2hbMF07XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBmaWxlXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZShkb2NOYW1lKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICBpc1BlcnNpc3RlbnQ6IHRydWUsIC8vIEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudFxuICAgICAgICAgICAgICAgICAgICByYXdSZWZlcmVuY2UsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgYWxsIGZvdW5kIHJlZmVyZW5jZXMgZnJvbSBtZXNzYWdlXG4gICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZShyZWYucmF3UmVmZXJlbmNlLCAnICcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYW4gdXAgZXhjZXNzaXZlIHNwYWNlcyBidXQgcHJlc2VydmUgbmVjZXNzYXJ5IHNwYWNpbmdcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2UgPSBjbGVhbmVkTWVzc2FnZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJykudHJpbSgpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgIGNvbnN0IHBlcnNpc3RlbnRSZWZzID0gcmVmZXJlbmNlcy5maWx0ZXIocmVmID0+IHJlZi5pc1BlcnNpc3RlbnQpO1xuICAgICAgICBpZiAocGVyc2lzdGVudFJlZnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjb252ZXJzYXRpb25GaWxlUGF0aCkgfHwgW107XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcGVyc2lzdGVudFJlZnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY29udmVyc2F0aW9uRmlsZVBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IGNsZWFuZWRNZXNzYWdlLCByZWZlcmVuY2VzIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29tcGxldGUgY29udGV4dCBpbmNsdWRpbmcgcGVyc2lzdGVudCBkb2N1bWVudHNcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbnRleHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgY3VycmVudEZpbGU6IFRGaWxlLFxuICAgICAgICBjb252ZXJzYXRpb25EYXRhPzogQ29udmVyc2F0aW9uRGF0YVxuICAgICk6IFByb21pc2U8e1xuICAgICAgICBjbGVhbmVkTWVzc2FnZTogc3RyaW5nO1xuICAgICAgICBjb250ZXh0OiBNdWx0aURvY0NvbnRleHQ7XG4gICAgfT4ge1xuICAgICAgICAvLyBQYXJzZSBjdXJyZW50IG1lc3NhZ2VcbiAgICAgICAgY29uc3QgeyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9ID0gdGhpcy5wYXJzZU1lc3NhZ2UobWVzc2FnZSwgY3VycmVudEZpbGUucGF0aCk7XG5cbiAgICAgICAgLy8gR2V0IGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgdGhpcyBjb252ZXJzYXRpb25cbiAgICAgICAgY29uc3QgZXhpc3RpbmdQZXJzaXN0ZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY3VycmVudEZpbGUucGF0aCkgfHwgW107XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdG8gcGVyc2lzdGVudCBjb250ZXh0IChhbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQpXG4gICAgICAgIGlmIChyZWZlcmVuY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRQZXJzaXN0ZW50ID0gWy4uLmV4aXN0aW5nUGVyc2lzdGVudF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcmVmZXJlbmNlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHVwZGF0ZWRQZXJzaXN0ZW50LnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcuZmlsZS5wYXRoID09PSByZWYuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGVyc2lzdGVudC5wdXNoKHJlZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjdXJyZW50RmlsZS5wYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmaW5hbCBwZXJzaXN0ZW50IGNvbnRleHQgKGluY2x1ZGluZyBuZXdseSBhZGRlZCBkb2NzKVxuICAgICAgICBjb25zdCBhbGxQZXJzaXN0ZW50RG9jcyA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuXG4gICAgICAgIC8vIEJ1aWxkIGNvbnRleHQgc3RyaW5nIGZyb20gYWxsIHBlcnNpc3RlbnQgZG9jdW1lbnRzXG4gICAgICAgIGNvbnN0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBkb2NSZWYgb2YgYWxsUGVyc2lzdGVudERvY3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRQYXJ0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZG9jUmVmKTtcbiAgICAgICAgICAgIGlmIChjb250ZXh0UGFydCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGNvbnRleHRQYXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRleHRTdHJpbmcgPSBjb250ZXh0UGFydHMuam9pbignXFxuXFxuLS0tXFxuXFxuJyk7XG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5zKGNvbnRleHRTdHJpbmcpO1xuICAgICAgICBjb25zdCBpc05lYXJMaW1pdCA9IHRva2VuQ291bnQgPiAodGhpcy5UT0tFTl9MSU1JVCAqIHRoaXMuV0FSTklOR19USFJFU0hPTEQpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjbGVhbmVkTWVzc2FnZSxcbiAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICB0ZW1wb3JhcnlEb2NzOiBbXSwgLy8gTm8gbW9yZSB0ZW1wb3JhcnkgZG9jc1xuICAgICAgICAgICAgICAgIHBlcnNpc3RlbnREb2NzOiBhbGxQZXJzaXN0ZW50RG9jcyxcbiAgICAgICAgICAgICAgICBjb250ZXh0U3RyaW5nLFxuICAgICAgICAgICAgICAgIHRva2VuQ291bnQsXG4gICAgICAgICAgICAgICAgaXNOZWFyTGltaXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udGV4dCBmb3IgYSBzcGVjaWZpYyBkb2N1bWVudCByZWZlcmVuY2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldERvY3VtZW50Q29udGV4dChkb2NSZWY6IERvY3VtZW50UmVmZXJlbmNlKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IGZpbGUsIHByb3BlcnR5IH0gPSBkb2NSZWY7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBzcGVjaWZpYyBwcm9wZXJ0eSBmcm9tIGZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyICYmIGNhY2hlLmZyb250bWF0dGVyW3Byb3BlcnR5XSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYCMjICR7ZmlsZS5iYXNlbmFtZX0gLSAke3Byb3BlcnR5fVxcbiR7Y2FjaGUuZnJvbnRtYXR0ZXJbcHJvcGVydHldfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMaW1pdCB0byBmaXJzdCA1MCBsaW5lcyBmb3IgY29udGV4dFxuICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZENvbnRlbnQgPSBsaW5lcy5zbGljZSgwLCA1MCkuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgd2FzVHJ1bmNhdGVkID0gbGluZXMubGVuZ3RoID4gNTA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGAjIyBEb2N1bWVudDogJHtmaWxlLmJhc2VuYW1lfVxcbiR7dHJ1bmNhdGVkQ29udGVudH0ke3dhc1RydW5jYXRlZCA/ICdcXG5cXG5bLi4uIHRydW5jYXRlZCBmb3IgYnJldml0eSAuLi5dJyA6ICcnfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gcmVhZCBjb250ZXh0IGZyb20gJHtkb2NSZWYuZmlsZS5wYXRofTpgLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgYSBmaWxlIGJ5IG5hbWUgb3IgcGF0aFxuICAgICAqL1xuICAgIHByaXZhdGUgZmluZEZpbGUobmFtZU9yUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcbiAgICAgICAgbGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG4gICAgICAgICAgICBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgIC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgICAgICBmaWxlID0gZmlsZXMuZmluZChmID0+IFxuICAgICAgICAgICAgICAgIGYuYmFzZW5hbWUgPT09IG5hbWVPclBhdGggfHwgXG4gICAgICAgICAgICAgICAgZi5uYW1lID09PSBuYW1lT3JQYXRoIHx8XG4gICAgICAgICAgICAgICAgZi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG4gICAgICAgICAgICAgICAgZi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGggKyAnLm1kJylcbiAgICAgICAgICAgICkgfHwgbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGZpbGUgOiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgYSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBjbGVhclBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoZmlsZVBhdGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgZ2V0UGVyc2lzdGVudENvbnRleHQoZmlsZVBhdGg6IHN0cmluZyk6IERvY3VtZW50UmVmZXJlbmNlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoZmlsZVBhdGgpIHx8IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHNwZWNpZmljIGRvY3VtZW50IGZyb20gcGVyc2lzdGVudCBjb250ZXh0XG4gICAgICovXG4gICAgcmVtb3ZlUGVyc2lzdGVudERvYyhmaWxlUGF0aDogc3RyaW5nLCBkb2NUb1JlbW92ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChmaWxlUGF0aCkgfHwgW107XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gY3VycmVudC5maWx0ZXIocmVmID0+IHJlZi5maWxlLnBhdGggIT09IGRvY1RvUmVtb3ZlKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChmaWxlUGF0aCwgZmlsdGVyZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5kZWxldGUoZmlsZVBhdGgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdG9rZW4gY291bnQgKHJvdWdoIGFwcHJveGltYXRpb24pXG4gICAgICovXG4gICAgcHJpdmF0ZSBlc3RpbWF0ZVRva2Vucyh0ZXh0OiBzdHJpbmcpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0ZTogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0ZXh0Lmxlbmd0aCAvIDQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB2aXN1YWwgaW5kaWNhdG9ycyBmb3IgY29udGV4dCBzdGF0ZVxuICAgICAqL1xuICAgIGdldENvbnRleHRJbmRpY2F0b3JzKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBjbGFzc05hbWU6IHN0cmluZztcbiAgICAgICAgdG9vbHRpcDogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBkb2NDb3VudCA9IGNvbnRleHQudGVtcG9yYXJ5RG9jcy5sZW5ndGggKyBjb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGNvbnRleHQudG9rZW5Db3VudCAvIHRoaXMuVE9LRU5fTElNSVQpICogMTAwKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjbGFzc05hbWUgPSAnbm92YS1jb250ZXh0LWluZGljYXRvcic7XG4gICAgICAgIGxldCB0b29sdGlwID0gYENvbnRleHQ6ICR7ZG9jQ291bnR9IGRvY3VtZW50JHtkb2NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSwgfiR7Y29udGV4dC50b2tlbkNvdW50fSB0b2tlbnNgO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnRleHQuaXNOZWFyTGltaXQpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAnIG5vdmEtY29udGV4dC13YXJuaW5nJztcbiAgICAgICAgICAgIHRvb2x0aXAgKz0gJyAoYXBwcm9hY2hpbmcgbGltaXQpJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdGV4dCA9IGAke2RvY0NvdW50fSBkb2NzICR7cGVyY2VudGFnZX0lYDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHRleHQsIGNsYXNzTmFtZSwgdG9vbHRpcCB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb250ZXh0IGZvciBkaXNwbGF5IGluIFVJXG4gICAgICovXG4gICAgZm9ybWF0Q29udGV4dEZvckRpc3BsYXkoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBpdGVtczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBwZXJzaXN0ZW50IGRvY3VtZW50c1xuICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiBjb250ZXh0LnBlcnNpc3RlbnREb2NzKSB7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGArJHtkb2MuZmlsZS5iYXNlbmFtZX0ke2RvYy5wcm9wZXJ0eSA/IGAjJHtkb2MucHJvcGVydHl9YCA6ICcnfWApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdGVtcG9yYXJ5IGRvY3VtZW50c1xuICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiBjb250ZXh0LnRlbXBvcmFyeURvY3MpIHtcbiAgICAgICAgICAgIGl0ZW1zLnB1c2goYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtkb2MucHJvcGVydHkgPyBgIyR7ZG9jLnByb3BlcnR5fWAgOiAnJ31gKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb3JlIGRvY3VtZW50IGVuZ2luZSBmb3IgTm92YVxuICogSGFuZGxlcyBhbGwgZG9jdW1lbnQgbWFuaXB1bGF0aW9uIGFuZCBlZGl0b3IgaW50ZXJhY3Rpb25zXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgVEZpbGUsIEVkaXRvclBvc2l0aW9uLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudENvbnRleHQsIEhlYWRpbmdJbmZvLCBFZGl0UmVzdWx0LCBFZGl0T3B0aW9ucywgRG9jdW1lbnRTZWN0aW9uLCBFZGl0Q29tbWFuZCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciwgRGF0YVN0b3JlIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudEVuZ2luZSB7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyIHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBkYXRhU3RvcmU/OiBEYXRhU3RvcmUpIHtcbiAgICAgICAgaWYgKGRhdGFTdG9yZSkge1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjb252ZXJzYXRpb24gbWFuYWdlciAoZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uKVxuICAgICAqL1xuICAgIHNldENvbnZlcnNhdGlvbk1hbmFnZXIoY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBjb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYWN0aXZlIGVkaXRvciBpbnN0YW5jZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUVkaXRvcigpOiBFZGl0b3IgfCBudWxsIHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5IHRoZSB3b3Jrc3BhY2UgbWV0aG9kXG4gICAgICAgIGNvbnN0IGFjdGl2ZUVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVFZGl0b3I7XG4gICAgICAgIGlmIChhY3RpdmVFZGl0b3I/LmVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZUVkaXRvci5lZGl0b3I7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBnZXQgdGhlIGFjdGl2ZSBtYXJrZG93biB2aWV3XG4gICAgICAgIGxldCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG5vIGFjdGl2ZSBtYXJrZG93biB2aWV3LCB0cnkgdG8gZmluZCBhbnkgbWFya2Rvd24gdmlld1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZlZpZXcgPSBsZWFmLnZpZXc7XG4gICAgICAgICAgICAgICAgaWYgKGxlYWZWaWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcgPSBsZWFmVmlldztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUcnkgZGlmZmVyZW50IHdheXMgdG8gZ2V0IHRoZSBlZGl0b3JcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdmlldy5lZGl0b3I7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yIHx8IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZmlsZVxuICAgICAqL1xuICAgIGdldEFjdGl2ZUZpbGUoKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgdGV4dFxuICAgICAqL1xuICAgIGdldFNlbGVjdGVkVGV4dCgpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgZ2V0Q3Vyc29yUG9zaXRpb24oKTogRWRpdG9yUG9zaXRpb24gfCBudWxsIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGNvbXByZWhlbnNpdmUgZG9jdW1lbnQgY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIGdldERvY3VtZW50Q29udGV4dCgpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICFlZGl0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSB0aGlzLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHRoaXMuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSB0aGUgZG9jdW1lbnRcbiAgICAgICAgY29uc3QgaGVhZGluZ3MgPSB0aGlzLmV4dHJhY3RIZWFkaW5ncyhjb250ZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBzdXJyb3VuZGluZyBsaW5lcyBmb3IgY29udGV4dFxuICAgICAgICBjb25zdCBzdXJyb3VuZGluZ0xpbmVzID0gY3Vyc29yUG9zaXRpb24gPyBcbiAgICAgICAgICAgIHRoaXMuZ2V0U3Vycm91bmRpbmdMaW5lcyhjb250ZW50LCBjdXJzb3JQb3NpdGlvbi5saW5lKSA6IFxuICAgICAgICAgICAgdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgaGVhZGluZ3MsXG4gICAgICAgICAgICBzZWxlY3RlZFRleHQ6IHNlbGVjdGVkVGV4dCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBjdXJzb3JQb3NpdGlvbjogY3Vyc29yUG9zaXRpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgaGVhZGluZ3MgZnJvbSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0SGVhZGluZ3MoY29udGVudDogc3RyaW5nKTogSGVhZGluZ0luZm9bXSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGhlYWRpbmdzOiBIZWFkaW5nSW5mb1tdID0gW107XG4gICAgICAgIGxldCBjaGFyQ291bnQgPSAwO1xuXG4gICAgICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGhlYWRpbmdNYXRjaFsyXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWFkaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGNoYXJDb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogY2hhckNvdW50ICsgbGluZS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbGluZSBsZW5ndGggKyBuZXdsaW5lIGNoYXJhY3RlclxuICAgICAgICAgICAgY2hhckNvdW50ICs9IGxpbmUubGVuZ3RoICsgMTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGhlYWRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBsaW5lcyBzdXJyb3VuZGluZyB0aGUgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRTdXJyb3VuZGluZ0xpbmVzKFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjdXJyZW50TGluZTogbnVtYmVyLCBcbiAgICAgICAgY29udGV4dFNpemU6IG51bWJlciA9IDVcbiAgICApOiB7IGJlZm9yZTogc3RyaW5nW107IGFmdGVyOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IE1hdGgubWF4KDAsIGN1cnJlbnRMaW5lIC0gY29udGV4dFNpemUpO1xuICAgICAgICBjb25zdCBlbmRMaW5lID0gTWF0aC5taW4obGluZXMubGVuZ3RoIC0gMSwgY3VycmVudExpbmUgKyBjb250ZXh0U2l6ZSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmVmb3JlOiBsaW5lcy5zbGljZShzdGFydExpbmUsIGN1cnJlbnRMaW5lKSxcbiAgICAgICAgICAgIGFmdGVyOiBsaW5lcy5zbGljZShjdXJyZW50TGluZSArIDEsIGVuZExpbmUgKyAxKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGFuIGVkaXQgdG8gdGhlIGRvY3VtZW50XG4gICAgICovXG4gICAgYXN5bmMgYXBwbHlFZGl0KFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgICAgIHBvc2l0aW9uOiAnY3Vyc29yJyB8ICdzZWxlY3Rpb24nIHwgJ2VuZCcgfCB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9LFxuICAgICAgICBvcHRpb25zOiBFZGl0T3B0aW9ucyA9IHt9XG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBvciBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IGFwcGxpZWRBdDogRWRpdG9yUG9zaXRpb247XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2N1cnNvcicpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oY29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnZW5kJykge1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZSA9IGVkaXRvci5sYXN0TGluZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gZWRpdG9yLmdldExpbmUobGFzdExpbmUpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSB7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50Q29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBjdXJyZW50Q29udGVudCArIChjdXJyZW50Q29udGVudC5lbmRzV2l0aCgnXFxuJykgPyAnJyA6ICdcXG4nKSArIGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXNlIHZhdWx0Lm1vZGlmeSBmb3IgdW5kby9yZWRvIHN1cHBvcnRcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBzcGVjaWZpYyBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgYXBwbGllZEF0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGFuZGxlIHBvc3QtZWRpdCBvcHRpb25zXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zZWxlY3ROZXdUZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0ge1xuICAgICAgICAgICAgICAgICAgICBsaW5lOiBhcHBsaWVkQXQubGluZSArIGNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjb250ZW50LmluY2x1ZGVzKCdcXG4nKSA/IFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5zcGxpdCgnXFxuJykucG9wKCkhLmxlbmd0aCA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0LmNoICsgY29udGVudC5sZW5ndGhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTZWxlY3Rpb24oYXBwbGllZEF0LCBlbmRQb3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zY3JvbGxUb0VkaXQpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBhcHBsaWVkQXQsXG4gICAgICAgICAgICAgICAgICAgIHRvOiBhcHBsaWVkQXRcbiAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6IHBvc2l0aW9uID09PSAnc2VsZWN0aW9uJyA/ICdyZXBsYWNlJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID09PSAnZW5kJyA/ICdhcHBlbmQnIDogJ2luc2VydCcsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgY29udGVudCBhdCBhIHNwZWNpZmljIGxvY2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlQ29udGVudChcbiAgICAgICAgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdsaW5lJyB8ICdzZWN0aW9uJyxcbiAgICAgICAgbG9jYXRpb24/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCcnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdsaW5lJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gY3Vyc29yLmxpbmU7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZSwgY2g6IDAgfSwgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogbGluZSArIDEsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmUsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmZpbmRTZWN0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtsb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgc2VjdGlvbiBpbmNsdWRpbmcgaXRzIGhlYWRpbmdcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaW5lcyA9IGxpbmVzLmZpbHRlcigoXywgaW5kZXgpID0+IFxuICAgICAgICAgICAgICAgICAgICBpbmRleCA8IHNlY3Rpb24ucmFuZ2Uuc3RhcnQgfHwgaW5kZXggPiBzZWN0aW9uLnJhbmdlLmVuZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0xpbmVzLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRlIHRhcmdldCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc2VjdGlvbiBieSBoZWFkaW5nIG5hbWVcbiAgICAgKi9cbiAgICBhc3luYyBmaW5kU2VjdGlvbihoZWFkaW5nVGV4dDogc3RyaW5nKTogUHJvbWlzZTxEb2N1bWVudFNlY3Rpb24gfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWNvbnRleHQpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IGhlYWRpbmdJbmRleCA9IGNvbnRleHQuaGVhZGluZ3MuZmluZEluZGV4KGggPT4gXG4gICAgICAgICAgICBoLnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhoZWFkaW5nVGV4dC50b0xvd2VyQ2FzZSgpKVxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChoZWFkaW5nSW5kZXggPT09IC0xKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBoZWFkaW5nID0gY29udGV4dC5oZWFkaW5nc1toZWFkaW5nSW5kZXhdO1xuICAgICAgICBjb25zdCBuZXh0SGVhZGluZyA9IGNvbnRleHQuaGVhZGluZ3NbaGVhZGluZ0luZGV4ICsgMV07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBuZXh0SGVhZGluZyA/IG5leHRIZWFkaW5nLmxpbmUgLSAxIDogbGluZXMubGVuZ3RoIC0gMTtcblxuICAgICAgICAvLyBFeHRyYWN0IHNlY3Rpb24gY29udGVudCAoZXhjbHVkaW5nIHRoZSBoZWFkaW5nIGxpbmUpXG4gICAgICAgIGNvbnN0IHNlY3Rpb25MaW5lcyA9IGxpbmVzLnNsaWNlKGhlYWRpbmcubGluZSArIDEsIGVuZExpbmUgKyAxKTtcbiAgICAgICAgY29uc3Qgc2VjdGlvbkNvbnRlbnQgPSBzZWN0aW9uTGluZXMuam9pbignXFxuJykudHJpbSgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoZWFkaW5nOiBoZWFkaW5nLnRleHQsXG4gICAgICAgICAgICBsZXZlbDogaGVhZGluZy5sZXZlbCxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHNlY3Rpb25Db250ZW50LFxuICAgICAgICAgICAgcmFuZ2U6IHtcbiAgICAgICAgICAgICAgICBzdGFydDogaGVhZGluZy5saW5lLFxuICAgICAgICAgICAgICAgIGVuZDogZW5kTGluZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZW50KCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZW50aXJlIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBzZXREb2N1bWVudENvbnRlbnQoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJzYXRpb24gbWFuYWdlbWVudCBtZXRob2RzXG5cbiAgICAvKipcbiAgICAgKiBBZGQgdXNlciBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgY29tbWFuZD86IEVkaXRDb21tYW5kKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoZmlsZSwgY29udGVudCwgY29tbWFuZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYXNzaXN0YW50IHJlc3BvbnNlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoY29udGVudDogc3RyaW5nLCByZXN1bHQ/OiBFZGl0UmVzdWx0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShmaWxlLCBjb250ZW50LCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN5c3RlbSBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkU3lzdGVtTWVzc2FnZShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBmb3IgQUkgcHJvbXB0c1xuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbkNvbnRleHQobWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljcyBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uU3RhdHMoKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFN0YXRzKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGN1cnJlbnQgZmlsZSBoYXMgYW4gYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbigpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmhhc0NvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZXhwb3J0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlciBmb3IgTm92YVxuICogSGFuZGxlcyBmaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gc3RvcmFnZSBhbmQgcmV0cmlldmFsXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhLCBDb252ZXJzYXRpb25NZXNzYWdlLCBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRWRpdEFjdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTdG9yZSB7XG4gICAgbG9hZERhdGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gICAgc2F2ZURhdGEoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbnM6IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbkRhdGE+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgbWF4TWVzc2FnZXNQZXJGaWxlID0gMTAwOyAvLyBMaW1pdCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgIHByaXZhdGUgc3RvcmFnZUtleSA9ICdub3ZhLWNvbnZlcnNhdGlvbnMnO1xuICAgIHByaXZhdGUgY2xlYW51cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0YVN0b3JlOiBEYXRhU3RvcmUpIHtcbiAgICAgICAgdGhpcy5sb2FkQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBjb252ZXJzYXRpb25zIGZyb20gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZGF0YVN0b3JlLmxvYWREYXRhKHRoaXMuc3RvcmFnZUtleSk7XG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb252ZXJzYXRpb24gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGNvbnZlcnNhdGlvbi5maWxlUGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBkYXRhOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhdmUgY29udmVyc2F0aW9ucyB0byBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25zQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy52YWx1ZXMoKSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRhdGFTdG9yZS5zYXZlRGF0YSh0aGlzLnN0b3JhZ2VLZXksIGNvbnZlcnNhdGlvbnNBcnJheSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBjb252ZXJzYXRpb24gZGF0YTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGZvciBhIHNwZWNpZmljIGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBDb252ZXJzYXRpb25EYXRhIHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9ucy5oYXMoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNvbnZlcnNhdGlvbiBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICBjb25zdCBuZXdDb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZEZyZXF1ZW5jeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXdyaXRlOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChmaWxlUGF0aCwgbmV3Q29udmVyc2F0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGVQYXRoKSE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgdXNlciBtZXNzYWdlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRVc2VyTWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsIFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjb21tYW5kPzogRWRpdENvbW1hbmRcbiAgICApOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjb21tYW5kXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmQgZnJlcXVlbmN5IGlmIGNvbW1hbmQgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeVtjb21tYW5kLmFjdGlvbl0rKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFuIGFzc2lzdGFudCByZXNwb25zZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcmVzdWx0PzogRWRpdFJlc3VsdFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gSW5jcmVtZW50IGVkaXQgY291bnQgaWYgcmVzdWx0IGluZGljYXRlcyBzdWNjZXNzZnVsIGVkaXRcbiAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcyAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgc3lzdGVtIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoZmlsZTogVEZpbGUsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmVjZW50IG1lc3NhZ2VzIGZvciBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0UmVjZW50TWVzc2FnZXMoZmlsZTogVEZpbGUsIGNvdW50OiBudW1iZXIgPSAxMCk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uLm1lc3NhZ2VzLnNsaWNlKC1jb3VudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG1lc3NhZ2VzIGJ5IHJvbGVcbiAgICAgKi9cbiAgICBnZXRNZXNzYWdlc0J5Um9sZShmaWxlOiBURmlsZSwgcm9sZTogQ29udmVyc2F0aW9uTWVzc2FnZVsncm9sZSddKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cucm9sZSA9PT0gcm9sZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlOiBURmlsZSwgbWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgbWF4TWVzc2FnZXMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dExpbmVzID0gbWVzc2FnZXMubWFwKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZShtc2cudGltZXN0YW1wKS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcbiAgICAgICAgICAgIGxldCBsaW5lID0gYFske3RpbWVzdGFtcH1dICR7bXNnLnJvbGUudG9VcHBlckNhc2UoKX06ICR7bXNnLmNvbnRlbnR9YDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChDb21tYW5kOiAke21zZy5jb21tYW5kLmFjdGlvbn0gJHttc2cuY29tbWFuZC50YXJnZXR9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtc2cucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChSZXN1bHQ6ICR7bXNnLnJlc3VsdC5zdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2ZhaWxlZCd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYFByZXZpb3VzIGNvbnZlcnNhdGlvbjpcXG4ke2NvbnRleHRMaW5lcy5qb2luKCdcXG4nKX1cXG5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IFtdO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmVkaXRDb3VudCA9IDA7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeSA9IHtcbiAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICBkZWxldGU6IDAsXG4gICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICByZXdyaXRlOiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljc1xuICAgICAqL1xuICAgIGdldFN0YXRzKGZpbGU6IFRGaWxlKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGw7XG4gICAgICAgIGNvbnZlcnNhdGlvbkFnZTogbnVtYmVyO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBtb3N0VXNlZENvbW1hbmQ6IEVkaXRBY3Rpb24gfCBudWxsID0gbnVsbDtcbiAgICAgICAgbGV0IG1heENvdW50ID0gMDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2FjdGlvbiwgY291bnRdIG9mIE9iamVjdC5lbnRyaWVzKGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5KSkge1xuICAgICAgICAgICAgICAgIGlmIChjb3VudCA+IG1heENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIG1heENvdW50ID0gY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCA9IGFjdGlvbiBhcyBFZGl0QWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkFnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwIFxuICAgICAgICAgICAgPyBEYXRlLm5vdygpIC0gY29udmVyc2F0aW9uLm1lc3NhZ2VzWzBdLnRpbWVzdGFtcFxuICAgICAgICAgICAgOiAwO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtZXNzYWdlQ291bnQ6IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGgsXG4gICAgICAgICAgICBlZGl0Q291bnQ6IGNvbnZlcnNhdGlvbi5tZXRhZGF0YT8uZWRpdENvdW50IHx8IDAsXG4gICAgICAgICAgICBtb3N0VXNlZENvbW1hbmQsXG4gICAgICAgICAgICBjb252ZXJzYXRpb25BZ2VcbiAgICAgICAgfTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb25zdCBsaW5lcyA9IFtgIyBDb252ZXJzYXRpb24gSGlzdG9yeSBmb3IgJHtmaWxlLm5hbWV9YCwgJyddO1xuXG4gICAgICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBjb252ZXJzYXRpb24ubWVzc2FnZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1lc3NhZ2UudGltZXN0YW1wKS50b0xvY2FsZVN0cmluZygpO1xuICAgICAgICAgICAgbGluZXMucHVzaChgIyMgJHttZXNzYWdlLnJvbGUudG9VcHBlckNhc2UoKX0gKCR7dGltZXN0YW1wfSlgKTtcbiAgICAgICAgICAgIGxpbmVzLnB1c2gobWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuY29tbWFuZCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpDb21tYW5kOiAke21lc3NhZ2UuY29tbWFuZC5hY3Rpb259ICR7bWVzc2FnZS5jb21tYW5kLnRhcmdldH0qYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpSZXN1bHQ6ICR7bWVzc2FnZS5yZXN1bHQuc3VjY2VzcyA/ICdTdWNjZXNzJyA6ICdGYWlsZWQnfSpgKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS5yZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkVycm9yOiAke21lc3NhZ2UucmVzdWx0LmVycm9yfSpgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxpbmVzLnB1c2goJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBtZXNzYWdlIElEXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZU1lc3NhZ2VJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYG1zZ18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpbSBjb252ZXJzYXRpb24gdG8gbWF4IGxlbmd0aCBhbmQgc2F2ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgdHJpbUFuZFNhdmUoY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb25EYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpIHtcbiAgICAgICAgICAgIC8vIEtlZXAgdGhlIG1vc3QgcmVjZW50IG1lc3NhZ2VzXG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLXRoaXMubWF4TWVzc2FnZXNQZXJGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgY29udmVyc2F0aW9uIGZpbGUgcGF0aHNcbiAgICAgKi9cbiAgICBnZXRBbGxDb252ZXJzYXRpb25GaWxlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy5rZXlzKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGZpbGUgaGFzIGFjdGl2ZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBoYXNDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChmaWxlLnBhdGgpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uID8gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgOiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgY29udmVyc2F0aW9uIGZpbGUgcGF0aCAoZm9yIGZpbGUgcmVuYW1lcylcbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVGaWxlUGF0aChvbGRQYXRoOiBzdHJpbmcsIG5ld1BhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KG9sZFBhdGgpO1xuICAgICAgICBpZiAoY29udmVyc2F0aW9uKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24uZmlsZVBhdGggPSBuZXdQYXRoO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShvbGRQYXRoKTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQobmV3UGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHBlcmlvZGljIGNsZWFudXAgb2Ygb2xkIGNvbnZlcnNhdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk6IHZvaWQge1xuICAgICAgICAvLyBDbGVhbiB1cCBldmVyeSAyNCBob3Vyc1xuICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBPbGRDb252ZXJzYXRpb25zKDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gNyBkYXlzXG4gICAgICAgIH0sIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIHVwIGNvbnZlcnNhdGlvbnMgb2xkZXIgdGhhbiB0aGUgc3BlY2lmaWVkIGFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY2xlYW51cE9sZENvbnZlcnNhdGlvbnMobWF4QWdlOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgbGV0IGNsZWFuZWQgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGNvbnN0IFtmaWxlUGF0aCwgY29udmVyc2F0aW9uXSBvZiB0aGlzLmNvbnZlcnNhdGlvbnMuZW50cmllcygpKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBjb252ZXJzYXRpb24gaXMgb2xkIGJhc2VkIG9uIGxhc3QgbWVzc2FnZVxuICAgICAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdE1lc3NhZ2UgPSBjb252ZXJzYXRpb24ubWVzc2FnZXNbY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFnZSA9IG5vdyAtIGxhc3RNZXNzYWdlLnRpbWVzdGFtcDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoYWdlID4gbWF4QWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5kZWxldGUoZmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBjbGVhbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2xlYW5lZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW51cCBtZXRob2QgdG8gY2FsbCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxuICAgICAqL1xuICAgIGNsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNsZWFudXBJbnRlcnZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBJbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBOb3ZhXG4gKiBHZW5lcmF0ZXMgYXBwcm9wcmlhdGUgcHJvbXB0cyBmb3IgZGlmZmVyZW50IGNvbW1hbmQgdHlwZXNcbiAqL1xuXG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRG9jdW1lbnRDb250ZXh0LCBEb2N1bWVudFNlY3Rpb24sIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIEdlbmVyYXRlZCBwcm9tcHQgZm9yIEFJIGNvbXBsZXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRQcm9tcHQge1xuICAgIC8qKiBTeXN0ZW0gcHJvbXB0IGZvciBBSSBjb250ZXh0ICovXG4gICAgc3lzdGVtUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFVzZXIgcHJvbXB0IHdpdGggc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zICovXG4gICAgdXNlclByb21wdDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBBZGRpdGlvbmFsIGNvbnRleHQgZm9yIHRoZSBBSSAqL1xuICAgIGNvbnRleHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogQ29uZmlndXJhdGlvbiBmb3IgQUkgZ2VuZXJhdGlvbiAqL1xuICAgIGNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogbnVtYmVyO1xuICAgICAgICBtYXhUb2tlbnM6IG51bWJlcjtcbiAgICB9O1xufVxuXG4vKipcbiAqIENvbnRleHQgYnVpbGRlciBmb3IgZ2VuZXJhdGluZyBBSSBwcm9tcHRzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb250ZXh0QnVpbGRlciB7XG4gICAgcHJpdmF0ZSBkZWZhdWx0Q29uZmlnOiBQcm9tcHRDb25maWcgPSB7XG4gICAgICAgIG1heENvbnRleHRMaW5lczogMjAsXG4gICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IHRydWUsXG4gICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4VG9rZW5zOiAxMDAwXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYnVpbGRQcm9tcHQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge30sXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBjb25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdENvbmZpZywgLi4ub3B0aW9ucyB9O1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gdGhpcy5idWlsZFN5c3RlbVByb21wdChjb21tYW5kLmFjdGlvbiwgY29uZmlnKTtcbiAgICAgICAgY29uc3QgY29udGV4dEluZm8gPSB0aGlzLmJ1aWxkQ29udGV4dEluZm8oZG9jdW1lbnRDb250ZXh0LCBjb21tYW5kLCBjb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICBjb25zdCB1c2VyUHJvbXB0ID0gdGhpcy5idWlsZFVzZXJQcm9tcHQoY29tbWFuZCwgY29udGV4dEluZm8pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0SW5mbyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBjb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc3lzdGVtIHByb21wdCBiYXNlZCBvbiBhY3Rpb24gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTeXN0ZW1Qcm9tcHQoYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sIGNvbmZpZzogUHJvbXB0Q29uZmlnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgYmFzZVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIGVkaXQgZG9jdW1lbnRzIGRpcmVjdGx5LiBZb3Ugd29yayB3aXRoIE1hcmtkb3duIGRvY3VtZW50cyBpbiBPYnNpZGlhbi5cblxuSU1QT1JUQU5UIEdVSURFTElORVM6XG4tIFByb3ZpZGUgT05MWSB0aGUgY29udGVudCB0byBiZSBpbnNlcnRlZC9tb2RpZmllZCwgbm8gZXhwbGFuYXRpb25zIG9yIG1ldGEtdGV4dFxuLSBNYWludGFpbiB0aGUgZG9jdW1lbnQncyBleGlzdGluZyBzdHlsZSBhbmQgdG9uZSB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkIHRvIGNoYW5nZSBpdFxuLSBQcmVzZXJ2ZSBmb3JtYXR0aW5nLCBzdHJ1Y3R1cmUsIGFuZCBtYXJrZG93biBzeW50YXhcbi0gQmUgY29uY2lzZSBhbmQgZm9jdXNlZCBvbiB0aGUgc3BlY2lmaWMgcmVxdWVzdFxuLSBEbyBub3QgYWRkIHNlY3Rpb24gaGVhZGVycyB1bmxlc3Mgc3BlY2lmaWNhbGx5IHJlcXVlc3RlZGA7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uU3BlY2lmaWNQcm9tcHRzID0ge1xuICAgICAgICAgICAgYWRkOiBgXG5UQVNLOiBBZGQgbmV3IGNvbnRlbnQgdG8gdGhlIGRvY3VtZW50LlxuLSBDcmVhdGUgd2VsbC1zdHJ1Y3R1cmVkLCByZWxldmFudCBjb250ZW50IHRoYXQgZml0cyB0aGUgZG9jdW1lbnQncyBwdXJwb3NlXG4tIFVzZSBhcHByb3ByaWF0ZSBtYXJrZG93biBmb3JtYXR0aW5nIChoZWFkaW5ncywgbGlzdHMsIGVtcGhhc2lzKVxuLSBFbnN1cmUgc21vb3RoIGZsb3cgd2l0aCBleGlzdGluZyBjb250ZW50XG4tIE1hdGNoIHRoZSBkb2N1bWVudCdzIHN0eWxlIGFuZCB0b25lYCxcblxuICAgICAgICAgICAgZWRpdDogYFxuVEFTSzogRWRpdCBhbmQgaW1wcm92ZSBleGlzdGluZyBjb250ZW50LlxuLSBFbmhhbmNlIGNsYXJpdHksIHJlYWRhYmlsaXR5LCBhbmQgZmxvd1xuLSBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgbWVhbmluZyB1bmxlc3MgY2hhbmdlcyBhcmUgcmVxdWVzdGVkXG4tIEltcHJvdmUgd29yZCBjaG9pY2UgYW5kIHNlbnRlbmNlIHN0cnVjdHVyZVxuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgZm9ybWF0dGluZyBhbmQgc3RydWN0dXJlYCxcblxuICAgICAgICAgICAgZGVsZXRlOiBgXG5UQVNLOiBSZW1vdmUgc3BlY2lmaWVkIGNvbnRlbnQgZnJvbSB0aGUgZG9jdW1lbnQuXG4tIElkZW50aWZ5IHRoZSBleGFjdCBjb250ZW50IHRvIGJlIHJlbW92ZWRcbi0gRW5zdXJlIHJlbWFpbmluZyBjb250ZW50IGZsb3dzIG5hdHVyYWxseVxuLSBQcmVzZXJ2ZSBkb2N1bWVudCBzdHJ1Y3R1cmUgYW5kIGZvcm1hdHRpbmdcbi0gQ29uZmlybSB0aGUgZGVsZXRpb24gaXMgYXBwcm9wcmlhdGUgZm9yIHRoZSBjb250ZXh0YCxcblxuICAgICAgICAgICAgZ3JhbW1hcjogYFxuVEFTSzogRml4IGdyYW1tYXIsIHNwZWxsaW5nLCBhbmQgbGFuZ3VhZ2UgaXNzdWVzLlxuLSBDb3JyZWN0IHNwZWxsaW5nIGVycm9ycywgZ3JhbW1hciBtaXN0YWtlcywgYW5kIHR5cG9zXG4tIEltcHJvdmUgc2VudGVuY2Ugc3RydWN0dXJlIGFuZCBjbGFyaXR5XG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCB2b2ljZSBhbmQgc3R5bGVcbi0gUHJlc2VydmUgYWxsIGZvcm1hdHRpbmcgYW5kIG1hcmtkb3duIHN5bnRheFxuLSBNYWtlIG1pbmltYWwgY2hhbmdlcyAtIG9ubHkgZml4IGFjdHVhbCBlcnJvcnNgLFxuXG4gICAgICAgICAgICByZXdyaXRlOiBgXG5UQVNLOiBSZXdyaXRlIG9yIHJlc3RydWN0dXJlIGNvbnRlbnQuXG4tIENyZWF0ZSBuZXcgY29udGVudCB0aGF0IHNlcnZlcyB0aGUgc2FtZSBwdXJwb3NlXG4tIEltcHJvdmUgb3JnYW5pemF0aW9uLCBjbGFyaXR5LCBhbmQgZmxvd1xuLSBVc2UgbW9yZSBlZmZlY3RpdmUgbGFuZ3VhZ2UgYW5kIHN0cnVjdHVyZVxuLSBNYWludGFpbiBrZXkgaW5mb3JtYXRpb24gYW5kIGNvbmNlcHRzXG4tIEFkYXB0IHRvIGFueSBzcGVjaWZpZWQgc3R5bGUgcmVxdWlyZW1lbnRzYFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBiYXNlUHJvbXB0ICsgYWN0aW9uU3BlY2lmaWNQcm9tcHRzW2FjdGlvbl07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBgJHtjb250ZXh0SW5mb31cXG5cXG5VU0VSIFJFUVVFU1Q6ICR7Y29tbWFuZC5pbnN0cnVjdGlvbn1gO1xuXG4gICAgICAgIC8vIEFkZCBzcGVjaWZpYyBjb250ZXh0IGlmIHByb3ZpZGVkXG4gICAgICAgIGlmIChjb21tYW5kLmNvbnRleHQgJiYgY29tbWFuZC5jb250ZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBcXG5cXG5BRERJVElPTkFMIFJFUVVJUkVNRU5UUzogJHtjb21tYW5kLmNvbnRleHR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCB0YXJnZXQtc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICAgIGNvbnN0IHRhcmdldEluc3RydWN0aW9ucyA9IHRoaXMuZ2V0VGFyZ2V0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuICAgICAgICBpZiAodGFyZ2V0SW5zdHJ1Y3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbiR7dGFyZ2V0SW5zdHJ1Y3Rpb25zfWA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgYWN0aW9uLXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAgICBjb25zdCBhY3Rpb25JbnN0cnVjdGlvbnMgPSB0aGlzLmdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kKTtcbiAgICAgICAgaWYgKGFjdGlvbkluc3RydWN0aW9ucykge1xuICAgICAgICAgICAgcHJvbXB0ICs9IGBcXG5cXG4ke2FjdGlvbkluc3RydWN0aW9uc31gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGFyZ2V0LXNwZWNpZmljIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VGFyZ2V0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBXb3JrIHdpdGggdGhlIHNlbGVjdGVkIHRleHQgb25seS4gUHJvdmlkZSB0aGUgaW1wcm92ZWQgdmVyc2lvbiBvZiB0aGUgc2VsZWN0ZWQgY29udGVudC4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYEZPQ1VTOiBXb3JrIHdpdGggdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb24uICR7Y29tbWFuZC5hY3Rpb24gPT09ICdhZGQnID8gJ0FkZCBjb250ZW50IHRvIHRoaXMgc2VjdGlvbi4nIDogJ01vZGlmeSBvbmx5IHRoaXMgc2VjdGlvbi4nfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IFdvcmsgd2l0aCB0aGUgY3VycmVudCBzZWN0aW9uLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBBcHBseSBjaGFuZ2VzIHRvIHRoZSBlbnRpcmUgZG9jdW1lbnQgd2hpbGUgcHJlc2VydmluZyBpdHMgc3RydWN0dXJlLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogQWRkIGNvbnRlbnQgYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQuIEVuc3VyZSBpdCBmbG93cyBuYXR1cmFsbHkgZnJvbSBleGlzdGluZyBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogV29yayB3aXRoIHRoZSBjdXJyZW50IHBhcmFncmFwaCBvciBjcmVhdGUgYSBuZXcgcGFyYWdyYXBoLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFjdGlvbi1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgbmV3IGNvbnRlbnQgdG8gYmUgYWRkZWQuIEluY2x1ZGUgYXBwcm9wcmlhdGUgaGVhZGluZ3MgaWYgYWRkaW5nIGEgc2VjdGlvbi4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlLCBvciByZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGNvcnJlY3RlZCB0ZXh0IHdpdGggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZml4ZXMuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvbXBsZXRlbHkgcmV3cml0dGVuIGNvbnRlbnQgdGhhdCBzZXJ2ZXMgdGhlIHNhbWUgcHVycG9zZS4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGNvbnRleHQgaW5mb3JtYXRpb24gZm9yIHRoZSBwcm9tcHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkQ29udGV4dEluZm8oXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgY29uZmlnOiBQcm9tcHRDb25maWcsXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBzdHJpbmcge1xuICAgICAgICBsZXQgY29udGV4dCA9IGBET0NVTUVOVDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuYDtcblxuICAgICAgICAvLyBBZGQgY29udmVyc2F0aW9uIGNvbnRleHQgaWYgYXZhaWxhYmxlIGFuZCByZXF1ZXN0ZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlSGlzdG9yeSAmJiBjb252ZXJzYXRpb25Db250ZXh0ICYmIGNvbnZlcnNhdGlvbkNvbnRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG4ke2NvbnZlcnNhdGlvbkNvbnRleHR9XFxuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBzdHJ1Y3R1cmUgaWYgcmVxdWVzdGVkXG4gICAgICAgIGlmIChjb25maWcuaW5jbHVkZVN0cnVjdHVyZSAmJiBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnXFxuRE9DVU1FTlQgU1RSVUNUVVJFOlxcbic7XG4gICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRlbnQgPSAnICAnLnJlcGVhdChoZWFkaW5nLmxldmVsIC0gMSk7XG4gICAgICAgICAgICAgICAgY29udGV4dCArPSBgJHtpbmRlbnR9LSAke2hlYWRpbmcudGV4dH1cXG5gO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgc2VsZWN0ZWQgdGV4dCBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQgJiYgY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5TRUxFQ1RFRCBURVhUOlxcbiR7ZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHJlbGV2YW50IGNvbnRleHQgYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlY3Rpb24nICYmIGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSB0aGlzLmZpbmRTZWN0aW9uSW5Db250ZW50KGRvY3VtZW50Q29udGV4dC5jb250ZW50LCBjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dCArPSBgXFxuQ1VSUkVOVCBTRUNUSU9OIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiOlxcbiR7c2VjdGlvbn1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAncGFyYWdyYXBoJyAmJiBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgY29udGV4dCArPSAnXFxuQ1VSUkVOVCBDT05URVhUOlxcbic7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBCZWZvcmU6ICR7ZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJyAnKX1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBBZnRlcjogJHtkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCcgJyl9XFxuYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBsaW1pdGVkIGRvY3VtZW50IGNvbnRlbnQgZm9yIGNvbnRleHRcbiAgICAgICAgY29uc3QgY29udGVudExpbmVzID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBpZiAoY29udGVudExpbmVzLmxlbmd0aCA+IGNvbmZpZy5tYXhDb250ZXh0TGluZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gTWF0aC5tYXgoMCwgY29udGVudExpbmVzLmxlbmd0aCAtIGNvbmZpZy5tYXhDb250ZXh0TGluZXMpO1xuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuUkVDRU5UIENPTlRFTlQgKGxhc3QgJHtjb25maWcubWF4Q29udGV4dExpbmVzfSBsaW5lcyk6XFxuYDtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gY29udGVudExpbmVzLnNsaWNlKHN0YXJ0KS5qb2luKCdcXG4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkZVTEwgRE9DVU1FTlQ6XFxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmluZCBhIHNwZWNpZmljIHNlY3Rpb24gaW4gY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgZmluZFNlY3Rpb25JbkNvbnRlbnQoY29udGVudDogc3RyaW5nLCBzZWN0aW9uTmFtZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRTZWN0aW9uTmFtZSA9IHNlY3Rpb25OYW1lLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgbGV0IHNlY3Rpb25TdGFydCA9IC0xO1xuICAgICAgICBsZXQgc2VjdGlvbkxldmVsID0gMDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIHNlY3Rpb24gaGVhZGluZ1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGhlYWRpbmdNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gaGVhZGluZ01hdGNoWzFdLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gaGVhZGluZ01hdGNoWzJdLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChoZWFkaW5nID09PSBub3JtYWxpemVkU2VjdGlvbk5hbWUgfHwgaGVhZGluZy5pbmNsdWRlcyhub3JtYWxpemVkU2VjdGlvbk5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb25TdGFydCA9IGk7XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb25MZXZlbCA9IGxldmVsO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChzZWN0aW9uU3RhcnQgPT09IC0xKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIGVuZCBvZiB0aGUgc2VjdGlvblxuICAgICAgICBsZXQgc2VjdGlvbkVuZCA9IGxpbmVzLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaSA9IHNlY3Rpb25TdGFydCArIDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xuICAgICAgICAgICAgY29uc3QgaGVhZGluZ01hdGNoID0gbGluZS5tYXRjaCgvXigjezEsNn0pXFxzKy8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaGVhZGluZ01hdGNoICYmIGhlYWRpbmdNYXRjaFsxXS5sZW5ndGggPD0gc2VjdGlvbkxldmVsKSB7XG4gICAgICAgICAgICAgICAgc2VjdGlvbkVuZCA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBsaW5lcy5zbGljZShzZWN0aW9uU3RhcnQsIHNlY3Rpb25FbmQpLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHNpbXBsZSBwcm9tcHQgZm9yIGJhc2ljIG9wZXJhdGlvbnNcbiAgICAgKi9cbiAgICBidWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbjogc3RyaW5nLCBjb250ZXh0Pzogc3RyaW5nKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyLiBQcm92aWRlIGhlbHBmdWwsIGNvbmNpc2UgcmVzcG9uc2VzIHRvIHVzZXIgcmVxdWVzdHMuIEZvY3VzIG9uIGJlaW5nIHByYWN0aWNhbCBhbmQgYWN0aW9uYWJsZS5gO1xuICAgICAgICBcbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBpbnN0cnVjdGlvbjtcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ29udGV4dDogJHtjb250ZXh0fVxcblxcblJlcXVlc3Q6ICR7aW5zdHJ1Y3Rpb259YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dDogY29udGV4dCB8fCAnJyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiA1MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICovXG4gICAgYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0PzogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICByZWNlbnRIaXN0b3J5OiBDb252ZXJzYXRpb25NZXNzYWdlW10gPSBbXVxuICAgICk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGxldCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyB3aXRoIHRoZWlyIGRvY3VtZW50cy4gWW91IGNhbjpcbi0gQW5zd2VyIHF1ZXN0aW9ucyBhYm91dCB3cml0aW5nIGFuZCBlZGl0aW5nXG4tIFByb3ZpZGUgc3VnZ2VzdGlvbnMgZm9yIGltcHJvdmVtZW50XG4tIEhlbHAgcGxhbiBkb2N1bWVudCBzdHJ1Y3R1cmVcbi0gQXNzaXN0IHdpdGggcmVzZWFyY2ggYW5kIGNvbnRlbnQgZGV2ZWxvcG1lbnRcblxuQmUgaGVscGZ1bCwgY29uY2lzZSwgYW5kIHByYWN0aWNhbCBpbiB5b3VyIHJlc3BvbnNlcy5gO1xuXG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gbWVzc2FnZTtcbiAgICAgICAgbGV0IGNvbnRleHQgPSAnJztcblxuICAgICAgICAvLyBBZGQgZG9jdW1lbnQgY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dCArPSBgQ3VycmVudCBkb2N1bWVudDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dCArPSAnRG9jdW1lbnQgc3RydWN0dXJlOlxcbic7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGVudCA9ICcgICcucmVwZWF0KGhlYWRpbmcubGV2ZWwgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dCArPSBgJHtpbmRlbnR9LSAke2hlYWRpbmcudGV4dH1cXG5gO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICAgICBpZiAocmVjZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5SZWNlbnQgY29udmVyc2F0aW9uOlxcbic7XG4gICAgICAgICAgICByZWNlbnRIaXN0b3J5LnNsaWNlKC0zKS5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG1zZy5yb2xlID09PSAndXNlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dCArPSBgWW91OiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dCArPSBgTm92YTogJHttc2cuY29udGVudH1cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgJHtjb250ZXh0fVxcblxcbkN1cnJlbnQgbWVzc2FnZTogJHttZXNzYWdlfWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdCxcbiAgICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC44LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogODAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdG9rZW4gY291bnQgZm9yIGEgcHJvbXB0XG4gICAgICovXG4gICAgZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogbnVtYmVyIHtcbiAgICAgICAgLy8gUm91Z2ggZXN0aW1hdGlvbjogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cbiAgICAgICAgY29uc3QgdG90YWxUZXh0ID0gcHJvbXB0LnN5c3RlbVByb21wdCArIHByb21wdC51c2VyUHJvbXB0ICsgcHJvbXB0LmNvbnRleHQ7XG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodG90YWxUZXh0Lmxlbmd0aCAvIDQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHByb21wdCBnZW5lcmF0aW9uXG4gICAgICovXG4gICAgdmFsaWRhdGVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiB7IHZhbGlkOiBib29sZWFuOyBpc3N1ZXM6IHN0cmluZ1tdIH0ge1xuICAgICAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKCFwcm9tcHQuc3lzdGVtUHJvbXB0IHx8IHByb21wdC5zeXN0ZW1Qcm9tcHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1N5c3RlbSBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcHJvbXB0LnVzZXJQcm9tcHQgfHwgcHJvbXB0LnVzZXJQcm9tcHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1VzZXIgcHJvbXB0IGlzIGVtcHR5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0b2tlbkNvdW50ID0gdGhpcy5lc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0KTtcbiAgICAgICAgaWYgKHRva2VuQ291bnQgPiA4MDAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaChgUHJvbXB0IGlzIHRvbyBsb25nICgke3Rva2VuQ291bnR9IHRva2VucywgbWF4IDgwMDApYCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA8IDAgfHwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA+IDEpIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdUZW1wZXJhdHVyZSBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByb21wdC5jb25maWcubWF4VG9rZW5zIDwgMTAgfHwgcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPiA0MDAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnTWF4IHRva2VucyBtdXN0IGJlIGJldHdlZW4gMTAgYW5kIDQwMDAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIGlzc3Vlc1xuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb21tYW5kIHBhcnNlciBmb3IgTm92YVxuICogQ29udmVydHMgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIHN0cnVjdHVyZWQgRWRpdENvbW1hbmQgb2JqZWN0c1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0QWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogUGF0dGVybnMgZm9yIGRldGVjdGluZyBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5pbnRlcmZhY2UgQ29tbWFuZFBhdHRlcm4ge1xuICAgIGFjdGlvbjogRWRpdEFjdGlvbjtcbiAgICBwYXR0ZXJuczogUmVnRXhwW107XG4gICAgdGFyZ2V0czogc3RyaW5nW107XG59XG5cbi8qKlxuICogQ29tbWFuZCBwYXJzaW5nIHJ1bGVzXG4gKi9cbmNvbnN0IENPTU1BTkRfUEFUVEVSTlM6IENvbW1hbmRQYXR0ZXJuW10gPSBbXG4gICAge1xuICAgICAgICBhY3Rpb246ICdncmFtbWFyJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZ3JhbW1hcnxzcGVsbHxzcGVsbGluZ3xwcm9vZnJlYWR8cG9saXNoKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmNoZWNrXFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihncmFtbWF0aWNhbHxjb3JyZWN0fHByb3BlcilcXGIvaSxcbiAgICAgICAgICAgIC9cXGJmaXhcXHMrLipcXGIoZ3JhbW1hcnxlcnJvcnN8bWlzdGFrZXN8dHlwb3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY29ycmVjdFxcYi4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ2RvY3VtZW50JywgJ3BhcmFncmFwaCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ3Jld3JpdGUnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihyZXdyaXRlfHJld29yZHxyZXBocmFzZXxyZXN0cnVjdHVyZXxyZW9yZ2FuaXplKVxcYi9pLFxuICAgICAgICAgICAgL1xcYndyaXRlXFxzKy4qXFxiKG5ld3xkaWZmZXJlbnR8YWx0ZXJuYXRpdmUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXHMrLipcXGIoc2VjdGlvbnN8cGFydHN8bXVsdGlwbGUpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2RvY3VtZW50JywgJ2VuZCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2RlbGV0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlfGN1dHxlcmFzZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZXRcXHMrcmlkXFxzK29mXFxiL2ksXG4gICAgICAgICAgICAvXFxidGFrZVxccytvdXRcXGIvaSxcbiAgICAgICAgICAgIC9cXGJkcm9wXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8cGFydClcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbicsICdzZWN0aW9uJywgJ2xpbmUnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdhZGQnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxpbmNsdWRlKVxcYi4qXFxiKHNlY3Rpb258cGFyYWdyYXBofGhlYWRpbmd8Y29udGVudHx0ZXh0fHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0KVxcYig/IVxccysuKlxcYihiZXR0ZXJ8Y2xlYXJlcnxtb3JlfGxlc3MpXFxiKS9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoc2VjdGlvbnxwYXJ0KVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdlbmVyYXRlXFxiLipcXGIoc2VjdGlvbnxjb250ZW50fHRleHQpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydlbmQnLCAnc2VjdGlvbicsICdwYXJhZ3JhcGgnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdlZGl0JyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZWRpdHxtb2RpZnl8Y2hhbmdlfHVwZGF0ZXxyZXZpc2V8aW1wcm92ZXxlbmhhbmNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoYmV0dGVyfGNsZWFyZXJ8bW9yZXxsZXNzfGZvcm1hbHxwcm9mZXNzaW9uYWx8ZGV0YWlsZWR8Y29tcHJlaGVuc2l2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoZml4fGNvcnJlY3R8YWRqdXN0KVxcYig/IS4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGIoZXhwYW5kfHNob3J0ZW58Y29uZGVuc2UpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nLCAnc2VjdGlvbicsICdwYXJhZ3JhcGgnXVxuICAgIH1cbl07XG5cbi8qKlxuICogTG9jYXRpb24gZXh0cmFjdGlvbiBwYXR0ZXJuc1xuICovXG5jb25zdCBMT0NBVElPTl9QQVRURVJOUyA9IFtcbiAgICAvXFxiKD86dG98aW58YXR8dW5kZXJ8d2l0aGlufGluc2lkZSlcXHMrKD86dGhlXFxzKyk/W1wiJ10oW15cIiddKz8pW1wiJ11cXHMrKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpL2ksXG4gICAgL1xcYig/OnRoZVxccyspP1tcIiddKFteXCInXSs/KVtcIiddXFxzKyg/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KS9pLFxuICAgIC9cXGIoPzpzZWN0aW9ufGhlYWRpbmd8cGFydClcXHMrW1wiJ10oW15cIiddKz8pW1wiJ10vaSxcbiAgICAvXFxiKD86c2VjdGlvbnxoZWFkaW5nKVxccysoPzpjYWxsZWR8dGl0bGVkfG5hbWVkKVxccytbXCInXShbXlwiJ10rPylbXCInXS9pLFxuICAgIC9cXGIoPzpjYWxsZWR8dGl0bGVkfG5hbWVkKVxccytbXCInXShbXlwiJ10rPylbXCInXS9pLFxuICAgIC9cXGIoPzp0aGVcXHMrKT8oW2EtekEtWl1bYS16QS1aXFxzJl0qPylcXHMrKD86c2VjdGlvbnxoZWFkaW5nKVxcYi9pXG5dO1xuXG4vKipcbiAqIFRhcmdldCB0eXBlIGRldGVjdGlvbiBwYXR0ZXJuc1xuICovXG5jb25zdCBUQVJHRVRfUEFUVEVSTlMgPSBbXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86c2VsZWN0ZWR8aGlnaGxpZ2h0ZWR8Y2hvc2VuKVxccysoPzp0ZXh0fGNvbnRlbnQpL2ksIHRhcmdldDogJ3NlbGVjdGlvbicgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzp0aGlzfGN1cnJlbnR8c2VsZWN0ZWQpXFxzKyg/OnBhcmFncmFwaHxsaW5lKS9pLCB0YXJnZXQ6ICdwYXJhZ3JhcGgnIH0sXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86ZW50aXJlfHdob2xlfGZ1bGwpXFxzKyg/OmRvY3VtZW50fGZpbGV8bm90ZSkvaSwgdGFyZ2V0OiAnZG9jdW1lbnQnIH0sXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86ZW5kfGJvdHRvbXxjb25jbHVzaW9uKS9pLCB0YXJnZXQ6ICdlbmQnIH0sXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpL2ksIHRhcmdldDogJ3NlY3Rpb24nIH1cbl07XG5cbmV4cG9ydCBjbGFzcyBDb21tYW5kUGFyc2VyIHtcbiAgICAvKipcbiAgICAgKiBQYXJzZSBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gYW4gRWRpdENvbW1hbmRcbiAgICAgKi9cbiAgICBwYXJzZUNvbW1hbmQoaW5wdXQ6IHN0cmluZywgaGFzU2VsZWN0aW9uOiBib29sZWFuID0gZmFsc2UpOiBFZGl0Q29tbWFuZCB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJbnB1dCA9IGlucHV0LnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZVxuICAgICAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmRldGVjdEFjdGlvbihub3JtYWxpemVkSW5wdXQpO1xuICAgICAgICBcbiAgICAgICAgLy8gRGV0ZWN0IHRoZSB0YXJnZXQgdHlwZVxuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmRldGVjdFRhcmdldChub3JtYWxpemVkSW5wdXQsIGhhc1NlbGVjdGlvbiwgYWN0aW9uKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgbG9jYXRpb24gaWYgc3BlY2lmaWVkXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gdGhpcy5leHRyYWN0TG9jYXRpb24oaW5wdXQpO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5leHRyYWN0Q29udGV4dChpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgICAgbG9jYXRpb24sXG4gICAgICAgICAgICBpbnN0cnVjdGlvbjogaW5wdXQsXG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgYWN0aW9uIHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdEFjdGlvbihpbnB1dDogc3RyaW5nKTogRWRpdEFjdGlvbiB7XG4gICAgICAgIC8vIENoZWNrIHBhdHRlcm5zIGluIG9yZGVyIG9mIHNwZWNpZmljaXR5XG4gICAgICAgIGZvciAoY29uc3QgY29tbWFuZFBhdHRlcm4gb2YgQ09NTUFORF9QQVRURVJOUykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGNvbW1hbmRQYXR0ZXJuLnBhdHRlcm5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmRQYXR0ZXJuLmFjdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgbG9naWMgd2l0aCBtb3JlIHNwZWNpZmljIGNoZWNrc1xuICAgICAgICBpZiAoL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxpbmNsdWRlfGdlbmVyYXRlLipzZWN0aW9uKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FkZCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZml4fGNvcnJlY3R8Z3JhbW1hcnxzcGVsbHxwcm9vZnJlYWR8cG9saXNoKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2dyYW1tYXInO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2RlbGV0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIocmV3cml0ZXxyZXBocmFzZXxyZXN0cnVjdHVyZXxnZW5lcmF0ZS4qbmV3KVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3Jld3JpdGUnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZhdWx0IHRvIGVkaXQgZm9yIGFtYmlndW91cyBjYXNlc1xuICAgICAgICByZXR1cm4gJ2VkaXQnO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBEZXRlY3QgdGhlIHRhcmdldCB0eXBlIGZyb20gdGhlIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBkZXRlY3RUYXJnZXQoXG4gICAgICAgIGlucHV0OiBzdHJpbmcsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW4sIFxuICAgICAgICBhY3Rpb246IEVkaXRBY3Rpb25cbiAgICApOiBFZGl0Q29tbWFuZFsndGFyZ2V0J10ge1xuICAgICAgICAvLyBDaGVjayBleHBsaWNpdCB0YXJnZXQgcGF0dGVybnNcbiAgICAgICAgZm9yIChjb25zdCB0YXJnZXRQYXR0ZXJuIG9mIFRBUkdFVF9QQVRURVJOUykge1xuICAgICAgICAgICAgaWYgKHRhcmdldFBhdHRlcm4ucGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRQYXR0ZXJuLnRhcmdldCBhcyBFZGl0Q29tbWFuZFsndGFyZ2V0J107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENvbnRleHQtYmFzZWQgdGFyZ2V0IGRldGVjdGlvblxuICAgICAgICBpZiAoaGFzU2VsZWN0aW9uICYmIChhY3Rpb24gPT09ICdlZGl0JyB8fCBhY3Rpb24gPT09ICdncmFtbWFyJyB8fCBhY3Rpb24gPT09ICdkZWxldGUnKSkge1xuICAgICAgICAgICAgcmV0dXJuICdzZWxlY3Rpb24nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBY3Rpb24tc3BlY2lmaWMgZGVmYXVsdHNcbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0LmluY2x1ZGVzKCdzZWN0aW9uJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2hlYWRpbmcnKSA/ICdzZWN0aW9uJyA6ICdlbmQnO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ3BhcmFncmFwaCc7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdzZWN0aW9uJztcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdkb2N1bWVudCc7XG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2VuZCc7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAncGFyYWdyYXBoJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGxvY2F0aW9uIGluZm9ybWF0aW9uIGZyb20gdGhlIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0TG9jYXRpb24oaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBMT0NBVElPTl9QQVRURVJOUykge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBwYXR0ZXJuLmV4ZWMoaW5wdXQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBhZGRpdGlvbmFsIGNvbnRleHQgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RDb250ZXh0KGlucHV0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICAvLyBFeHRyYWN0IHN0eWxlL3RvbmUgaW5kaWNhdG9yc1xuICAgICAgICBjb25zdCBzdHlsZUluZGljYXRvcnMgPSBbXG4gICAgICAgICAgICAnZm9ybWFsJywgJ2luZm9ybWFsJywgJ2Nhc3VhbCcsICdwcm9mZXNzaW9uYWwnLCAnYWNhZGVtaWMnLCAndGVjaG5pY2FsJyxcbiAgICAgICAgICAgICdzaW1wbGUnLCAnY29tcGxleCcsICdkZXRhaWxlZCcsICdicmllZicsICdjb25jaXNlJywgJ3ZlcmJvc2UnLFxuICAgICAgICAgICAgJ2ZyaWVuZGx5JywgJ3NlcmlvdXMnLCAnaHVtb3JvdXMnLCAnY3JlYXRpdmUnLCAnYW5hbHl0aWNhbCdcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZvdW5kU3R5bGVzID0gc3R5bGVJbmRpY2F0b3JzLmZpbHRlcihzdHlsZSA9PiBcbiAgICAgICAgICAgIGlucHV0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc3R5bGUpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuICAgICAgICBpZiAoZm91bmRTdHlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29udGV4dCArPSBgU3R5bGU6ICR7Zm91bmRTdHlsZXMuam9pbignLCAnKX0uIGA7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgbGVuZ3RoIGluZGljYXRvcnNcbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdzaG9ydCcpIHx8IGlucHV0LmluY2x1ZGVzKCdicmllZicpIHx8IGlucHV0LmluY2x1ZGVzKCdjb25jaXNlJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0tlZXAgaXQgYnJpZWYuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdsb25nJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2RldGFpbGVkJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbXByZWhlbnNpdmUnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnUHJvdmlkZSBkZXRhaWxlZCBjb250ZW50LiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IHNwZWNpZmljIHJlcXVpcmVtZW50c1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2J1bGxldCcpIHx8IGlucHV0LmluY2x1ZGVzKCdsaXN0JykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1VzZSBidWxsZXQgcG9pbnRzIG9yIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnZXhhbXBsZScpIHx8IGlucHV0LmluY2x1ZGVzKCdleGFtcGxlcycpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdJbmNsdWRlIGV4YW1wbGVzLiAnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnbnVtYmVyJykgfHwgaW5wdXQuaW5jbHVkZXMoJ251bWJlcmVkJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1VzZSBudW1iZXJlZCBsaXN0cy4gJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbnRleHQudHJpbSgpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBpZiBhIGNvbW1hbmQgY2FuIGJlIGV4ZWN1dGVkXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGxvY2F0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdkZWxldGUnICYmICFjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzcGVjaWZ5IHdoaWNoIHNlY3Rpb24gdG8gZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uLXRhcmdldCBjb21iaW5hdGlvbnNcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uID09PSAnYWRkJyAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGFkZCBjb250ZW50IHRvIGEgc2VsZWN0aW9uLiBVc2UgXCJlZGl0XCIgdG8gbW9kaWZ5IHNlbGVjdGVkIHRleHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGVkIGNvbW1hbmRzIGJhc2VkIG9uIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRTdWdnZXN0aW9ucyhoYXNTZWxlY3Rpb246IGJvb2xlYW4sIGhhc0hlYWRpbmdzOiBib29sZWFuKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGNvbmNpc2UnLFxuICAgICAgICAgICAgICAgICdGaXggZ3JhbW1hciBpbiB0aGlzIHRleHQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFeHBhbmQgb24gdGhpcyBwb2ludCdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdBZGQgYSBjb25jbHVzaW9uIHNlY3Rpb24nLFxuICAgICAgICAgICAgICAgICdGaXggZ3JhbW1hciBpbiB0aGlzIGRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICAnQWRkIGFuIGludHJvZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgJ0NyZWF0ZSBhIHN1bW1hcnknXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoaGFzSGVhZGluZ3MpIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBjb250ZW50IHRvIHRoZSBpbnRyb2R1Y3Rpb24gc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCB0aGUgbWV0aG9kb2xvZ3kgc2VjdGlvbidcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbXVsdGlwbGUgY29tbWFuZHMgZnJvbSBhIHNpbmdsZSBpbnB1dFxuICAgICAqL1xuICAgIHBhcnNlTXVsdGlwbGVDb21tYW5kcyhpbnB1dDogc3RyaW5nKTogRWRpdENvbW1hbmRbXSB7XG4gICAgICAgIC8vIFNwbGl0IG9uIGNvbW1vbiBjb21tYW5kIHNlcGFyYXRvcnNcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9ycyA9IC9cXGIoPzp0aGVufGFsc298YW5kIHRoZW58YWZ0ZXIgdGhhdHxuZXh0fGFkZGl0aW9uYWxseSlcXGIvaTtcbiAgICAgICAgY29uc3QgcGFydHMgPSBpbnB1dC5zcGxpdChzZXBhcmF0b3JzKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5wYXJzZUNvbW1hbmQoaW5wdXQpXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhcnRzXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gcGFydC50cmltKCkpXG4gICAgICAgICAgICAuZmlsdGVyKHBhcnQgPT4gcGFydC5sZW5ndGggPiAwKVxuICAgICAgICAgICAgLm1hcChwYXJ0ID0+IHRoaXMucGFyc2VDb21tYW5kKHBhcnQpKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogR2V0IGNvbW1hbmQgZGVzY3JpcHRpb24gZm9yIGRpc3BsYXlcbiAgICAgKi9cbiAgICBnZXRDb21tYW5kRGVzY3JpcHRpb24oY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB7IGFjdGlvbiwgdGFyZ2V0LCBsb2NhdGlvbiB9ID0gY29tbWFuZDtcbiAgICAgICAgXG4gICAgICAgIGxldCBkZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBcbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnQWRkIG5ldyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0VkaXQgZXhpc3RpbmcgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ1JlbW92ZSBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdHZW5lcmF0ZSBuZXcgc2VjdGlvbnMnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9IGAgaW4gXCIke2xvY2F0aW9ufVwiYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN3aXRjaCAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgaW4gY3VycmVudCBzZWN0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBjdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGF0IGVuZCBvZiBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGVzY3JpcHRpb247XG4gICAgfVxufSIsICIvKipcbiAqIFByb21wdCBidWlsZGVyIHNlcnZpY2UgZm9yIE5vdmFcbiAqIEludGVncmF0ZXMgQ29udGV4dEJ1aWxkZXIgd2l0aCBkb2N1bWVudCBlbmdpbmUgYW5kIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciwgR2VuZXJhdGVkUHJvbXB0IH0gZnJvbSAnLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyc2VyIH0gZnJvbSAnLi9jb21tYW5kLXBhcnNlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRG9jdW1lbnRDb250ZXh0LCBQcm9tcHRDb25maWcsIENvbnZlcnNhdGlvbk1lc3NhZ2UgfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQcm9tcHQgYnVpbGRpbmcgc2VydmljZVxuICovXG5leHBvcnQgY2xhc3MgUHJvbXB0QnVpbGRlciB7XG4gICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXI7XG4gICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmU7XG4gICAgcHJpdmF0ZSBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgIHByaXZhdGUgY29tbWFuZFBhcnNlcjogQ29tbWFuZFBhcnNlcjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXJcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb250ZXh0QnVpbGRlciA9IG5ldyBDb250ZXh0QnVpbGRlcigpO1xuICAgICAgICB0aGlzLmRvY3VtZW50RW5naW5lID0gZG9jdW1lbnRFbmdpbmU7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IGNvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgICAgIHRoaXMuY29tbWFuZFBhcnNlciA9IG5ldyBDb21tYW5kUGFyc2VyKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHVzZXIgbWVzc2FnZSAtIGRldGVybWluZXMgaWYgaXQncyBhIGNvbW1hbmQgb3IgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRQcm9tcHRGb3JNZXNzYWdlKFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGxpa2VseSBhIGNvbW1hbmQgYmFzZWQgb24gYWN0aW9uIHdvcmRzXG4gICAgICAgIGNvbnN0IGlzTGlrZWx5Q29tbWFuZCA9IHRoaXMuaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2UpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlzTGlrZWx5Q29tbWFuZCAmJiBmaWxlKSB7XG4gICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgY29tbWFuZFxuICAgICAgICAgICAgY29uc3QgcGFyc2VkQ29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQocGFyc2VkQ29tbWFuZCwgZmlsZSwgb3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJdCdzIGEgY29udmVyc2F0aW9uIC0gYnVpbGQgY29udmVyc2F0aW9uIHByb21wdFxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQobWVzc2FnZSwgZmlsZSwgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhIG1lc3NhZ2UgaXMgbGlrZWx5IGEgY29tbWFuZCB2cyBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGlzTGlrZWx5Q29tbWFuZChtZXNzYWdlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGNvbW1vbiBjb21tYW5kIGFjdGlvbiB3b3Jkc1xuICAgICAgICBjb25zdCBjb21tYW5kV29yZHMgPSBbXG4gICAgICAgICAgICAnYWRkJywgJ2NyZWF0ZScsICd3cml0ZScsICdpbnNlcnQnLCAnaW5jbHVkZScsICdnZW5lcmF0ZScsXG4gICAgICAgICAgICAnZWRpdCcsICdtb2RpZnknLCAnY2hhbmdlJywgJ3VwZGF0ZScsICdyZXZpc2UnLCAnaW1wcm92ZScsICdlbmhhbmNlJyxcbiAgICAgICAgICAgICdkZWxldGUnLCAncmVtb3ZlJywgJ2VsaW1pbmF0ZScsICdjdXQnLCAnZXJhc2UnLFxuICAgICAgICAgICAgJ2ZpeCcsICdjb3JyZWN0JywgJ2dyYW1tYXInLCAnc3BlbGwnLCAncHJvb2ZyZWFkJywgJ3BvbGlzaCcsXG4gICAgICAgICAgICAncmV3cml0ZScsICdyZXdvcmQnLCAncmVwaHJhc2UnLCAncmVzdHJ1Y3R1cmUnLCAncmVvcmdhbml6ZSdcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIGNvbW1hbmRXb3Jkcy5zb21lKHdvcmQgPT4gbG93ZXJNZXNzYWdlLmluY2x1ZGVzKHdvcmQpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29tbWFuZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBpcyByZXF1aXJlZCBmb3IgY29tbWFuZCBwcm9tcHRzJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBuZWVkZWRcbiAgICAgICAgbGV0IGNvbnZlcnNhdGlvbkNvbnRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKG9wdGlvbnMuaW5jbHVkZUhpc3RvcnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShyZWNlbnRNZXNzYWdlcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCB0aGUgcHJvbXB0XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgb3B0aW9ucywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBjb252ZXJzYXRpb24gKG5vbi1jb21tYW5kIG1lc3NhZ2VzKVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCByZWNlbnRIaXN0b3J5OiBDb252ZXJzYXRpb25NZXNzYWdlW10gPSBbXTtcblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dCBpZiBmaWxlIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IHJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICAgICAgICAgcmVjZW50SGlzdG9yeSA9IGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KG1lc3NhZ2UsIGRvY3VtZW50Q29udGV4dCwgcmVjZW50SGlzdG9yeSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbiwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRvY3VtZW50IGNvbnRleHQgZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxEb2N1bWVudENvbnRleHQ+IHtcbiAgICAgICAgLy8gVXNlIHRoZSBkb2N1bWVudCBlbmdpbmUncyBidWlsdC1pbiBjb250ZXh0IGdhdGhlcmluZ1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGNyZWF0ZSBtaW5pbWFsIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGVudCgpIHx8ICcnO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgaGVhZGluZ3M6IFtdLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXM6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybiB0aGUgY29udGV4dCBhcy1pcywgc2luY2UgaXQncyBhbHJlYWR5IGluIHRoZSBjb3JyZWN0IGZvcm1hdFxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgY29udmVyc2F0aW9uIGhpc3RvcnkgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkobWVzc2FnZXM6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSk6IHN0cmluZyB7XG4gICAgICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybiAnJztcblxuICAgICAgICBsZXQgZm9ybWF0dGVkID0gJ1JFQ0VOVCBDT05WRVJTQVRJT046XFxuJztcbiAgICAgICAgbWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuICAgICAgICAgICAgY29uc3Qgcm9sZSA9IG1zZy5yb2xlID09PSAndXNlcicgPyAnWW91JyA6ICdOb3ZhJztcbiAgICAgICAgICAgIGZvcm1hdHRlZCArPSBgJHtyb2xlfTogJHttc2cuY29udGVudH1cXG5gO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFuZCBvcHRpbWl6ZSBwcm9tcHQgYmVmb3JlIHNlbmRpbmcgdG8gQUlcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUFuZE9wdGltaXplUHJvbXB0KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdQcm9tcHQgdmFsaWRhdGlvbiBpc3N1ZXM6JywgdmFsaWRhdGlvbi5pc3N1ZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdG8gZml4IGNvbW1vbiBpc3N1ZXNcbiAgICAgICAgICAgIGxldCBvcHRpbWl6ZWRQcm9tcHQgPSB7IC4uLnByb21wdCB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnVuY2F0ZSBpZiB0b28gbG9uZ1xuICAgICAgICAgICAgY29uc3QgdG9rZW5Db3VudCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdCk7XG4gICAgICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgICAgICAvLyBSZWR1Y2UgY29udGV4dCBzaXplIG1vcmUgYWdncmVzc2l2ZWx5XG4gICAgICAgICAgICAgICAgY29uc3QgbWF4Q29udGV4dExlbmd0aCA9IE1hdGguZmxvb3IocHJvbXB0LmNvbnRleHQubGVuZ3RoICogMC42KTtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29udGV4dCA9IHByb21wdC5jb250ZXh0LnN1YnN0cmluZygwLCBtYXhDb250ZXh0TGVuZ3RoKSArICdcXG5bQ29udGV4dCB0cnVuY2F0ZWQuLi5dJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgdGVtcGVyYXR1cmVcbiAgICAgICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsYW1wIG1heCB0b2tlbnNcbiAgICAgICAgICAgIGlmIChwcm9tcHQuY29uZmlnLm1heFRva2VucyA8IDEwIHx8IHByb21wdC5jb25maWcubWF4VG9rZW5zID4gNDAwMCkge1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb25maWcubWF4VG9rZW5zID0gTWF0aC5tYXgoMTAsIE1hdGgubWluKDQwMDAsIHByb21wdC5jb25maWcubWF4VG9rZW5zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBvcHRpbWl6ZWRQcm9tcHQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0b2tlbiBjb3VudCBlc3RpbWF0ZSBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBnZXRUb2tlbkNvdW50KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHByb21wdCBmb3IgYSBzcGVjaWZpYyBhY3Rpb24gd2l0aCBtaW5pbWFsIGNvbnRleHRcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFF1aWNrUHJvbXB0KFxuICAgICAgICBhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSxcbiAgICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlXG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgY29uc3QgY29tbWFuZDogRWRpdENvbW1hbmQgPSB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQ6ICdkb2N1bWVudCcsXG4gICAgICAgICAgICBpbnN0cnVjdGlvbixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBjb250ZXh0OiB1bmRlZmluZWRcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb21tYW5kUHJvbXB0KGNvbW1hbmQsIGZpbGUsIHsgXG4gICAgICAgICAgICAgICAgbWF4Q29udGV4dExpbmVzOiAxMCxcbiAgICAgICAgICAgICAgICBpbmNsdWRlU3RydWN0dXJlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbmNsdWRlSGlzdG9yeTogZmFsc2UgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCB3aXRoIGN1c3RvbSBzeXN0ZW0gcHJvbXB0IG92ZXJyaWRlXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDdXN0b21Qcm9tcHQoXG4gICAgICAgIHN5c3RlbVByb21wdDogc3RyaW5nLFxuICAgICAgICB1c2VyTWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGVcbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgY29udGV4dCA9IGBEb2N1bWVudDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQ6IHVzZXJNZXNzYWdlLFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIEFkZCBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFkZGluZyBuZXcgY29udGVudCB0byBkb2N1bWVudHNcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBBZGRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGFkZCBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHt2YWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBlZGl0XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGV0ZXJtaW5lSW5zZXJ0UG9zaXRpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0KSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBEb24ndCBsb2cgc3VjY2VzcyBtZXNzYWdlcyAtIGhhbmRsZWQgYnkgVUlcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGFkZCBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lIHdoZXJlIHRvIGluc2VydCBuZXcgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZGV0ZXJtaW5lSW5zZXJ0UG9zaXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHRcbiAgICApOiBQcm9taXNlPCdjdXJzb3InIHwgJ3NlbGVjdGlvbicgfCAnZW5kJyB8IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2VuZCc7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGNvbnRlbnQgYXQgdGhlIGVuZCBvZiB0aGUgc2VjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuICdjdXJzb3InO1xuXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBBZGQgYXQgdGhlIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBhZGQgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQWRkIGNvbW1hbmQgY2Fubm90IHRhcmdldCBzZWxlY3Rpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0YXJnZXRpbmcgYSBzZWN0aW9uLCBsb2NhdGlvbiBzaG91bGQgYmUgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgc3RpbGwgdmFsaWQgLSB3ZSdsbCBhZGQgdG8gY3VycmVudCBzZWN0aW9uIG9yIGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBhZGQgY29tbWFuZHNcbiAgICAgKi9cbiAgICBnZXRTdWdnZXN0aW9ucyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW1xuICAgICAgICAgICAgJ0FkZCBhIGNvbmNsdXNpb24gc2VjdGlvbicsXG4gICAgICAgICAgICAnQWRkIGFuIGludHJvZHVjdGlvbicsXG4gICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeScsXG4gICAgICAgICAgICAnQWRkIGV4YW1wbGVzJyxcbiAgICAgICAgICAgICdDcmVhdGUgYSBtZXRob2RvbG9neSBzZWN0aW9uJ1xuICAgICAgICBdO1xuXG4gICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIHN1Z2dlc3Rpb25zIGJhc2VkIG9uIGV4aXN0aW5nIGhlYWRpbmdzXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbk5hbWVzID0gZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLm1hcChoID0+IGgudGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghc2VjdGlvbk5hbWVzLnNvbWUobmFtZSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2ludHJvZHVjdGlvbicpKSkge1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnVuc2hpZnQoJ0FkZCBhbiBpbnRyb2R1Y3Rpb24gc2VjdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXNlY3Rpb25OYW1lcy5zb21lKG5hbWUgPT4gbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjb25jbHVzaW9uJykpKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnQWRkIGEgY29uY2x1c2lvbiBzZWN0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghc2VjdGlvbk5hbWVzLnNvbWUobmFtZSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3N1bW1hcnknKSkpIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgYSBzdW1tYXJ5IHNlY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCA4KTsgLy8gTGltaXQgdG8gOCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCBjb250ZW50IHdvdWxkIGJlIGFkZGVkICh3aXRob3V0IGFjdHVhbGx5IGFkZGluZyBpdClcbiAgICAgKi9cbiAgICBhc3luYyBwcmV2aWV3KGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBzdWNjZXNzOiBib29sZWFuO1xuICAgICAgICBwcmV2aWV3Pzogc3RyaW5nO1xuICAgICAgICBwb3NpdGlvbj86IHN0cmluZztcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERldGVybWluZSB3aGVyZSBjb250ZW50IHdvdWxkIGJlIHBsYWNlZFxuICAgICAgICAgICAgbGV0IHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnJztcbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gYGluIHRoZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnaW4gdGhlIGN1cnJlbnQgc2VjdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICdhdCB0aGUgY3Vyc29yIHBvc2l0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICdhdCB0aGUgY3Vyc29yIHBvc2l0aW9uJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHByZXZpZXc6IGBXaWxsIGFkZCBuZXcgY29udGVudCAke3Bvc2l0aW9uRGVzY3JpcHRpb259YCxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb25EZXNjcmlwdGlvblxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogRWRpdCBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIG1vZGlmeWluZyBhbmQgaW1wcm92aW5nIGV4aXN0aW5nIGNvbnRlbnRcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBFZGl0Q29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBlZGl0IGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGVkaXQgYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUVkaXQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZWRpdCBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBlZGl0IGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgZW50aXJlIHNlY3Rpb24gY29udGVudCAoZXhjbHVkaW5nIGhlYWRpbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdTZWN0aW9uQ29udGVudCA9IGAke3NlY3Rpb24uaGVhZGluZ31cXG5cXG4ke2NvbnRlbnR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBwb3NpdGlvbiB0byByZXBsYWNlIGZyb20gaGVhZGluZyBsaW5lIHRvIHNlY3Rpb24gZW5kXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3U2VjdGlvbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3U2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZhbGwgdGhyb3VnaCB0byBwYXJhZ3JhcGggaWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoY29udGVudCk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gRm9yIGVkaXQgY29tbWFuZHMgdGFyZ2V0aW5nIGVuZCwgdHJlYXQgYXMgYWRkaW5nIHRvIGVuZFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZWRpdCB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGVkaXQgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBsb2NhdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IHByb3ZpZGVkIGZvciBzZWN0aW9uIGVkaXRzXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlY3Rpb24nICYmIGNvbW1hbmQuYWN0aW9uID09PSAnZWRpdCcgJiYgY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgLy8gTG9jYXRpb24gaXMgcHJvdmlkZWQsIHdoaWNoIGlzIGdvb2QgZm9yIHNlY3Rpb24gZWRpdHNcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgZWRpdCBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGNvbmNpc2UnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBkZXRhaWxlZCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgY2xhcml0eSBhbmQgZmxvdycsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGZvcm1hbCcsXG4gICAgICAgICAgICAgICAgJ1NpbXBsaWZ5IHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50JyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgZW5nYWdpbmcnXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSB0aGUgd3JpdGluZyBzdHlsZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhlIGRvY3VtZW50IG1vcmUgcHJvZmVzc2lvbmFsJyxcbiAgICAgICAgICAgICAgICAnRW5oYW5jZSBjbGFyaXR5IHRocm91Z2hvdXQnLFxuICAgICAgICAgICAgICAgICdJbXByb3ZlIHRoZSBpbnRyb2R1Y3Rpb24nLFxuICAgICAgICAgICAgICAgICdQb2xpc2ggdGhlIGNvbmNsdXNpb24nLFxuICAgICAgICAgICAgICAgICdNYWtlIGl0IG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0FkZCBtb3JlIGRldGFpbCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgdGhlIGZsb3cgYmV0d2VlbiBzZWN0aW9ucydcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChgSW1wcm92ZSB0aGUgXCIke2hlYWRpbmcudGV4dH1cIiBzZWN0aW9uYCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgMTApOyAvLyBMaW1pdCB0byAxMCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBlZGl0ZWRcbiAgICAgKi9cbiAgICBhc3luYyBwcmV2aWV3KGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBzdWNjZXNzOiBib29sZWFuO1xuICAgICAgICBwcmV2aWV3Pzogc3RyaW5nO1xuICAgICAgICBhZmZlY3RlZENvbnRlbnQ/OiBzdHJpbmc7XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcblxuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBlZGl0IHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IGlzIGN1cnJlbnRseSBzZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSBgV2lsbCBlZGl0IHRoZSBlbnRpcmUgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBlZGl0IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHN1cnJvdW5kaW5nIGNvbnRleHRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbj8ubGluZSA/PyAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBlZGl0b3IuZ2V0TGluZShjdXJyZW50TGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgdGhlIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBhZGQgZWRpdGVkIGNvbnRlbnQgYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBlZGl0IHRhcmdldCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHByZXZpZXc6IHByZXZpZXdUZXh0LFxuICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudDogYWZmZWN0ZWRDb250ZW50Lmxlbmd0aCA+IDIwMCA/IFxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQuc3Vic3RyaW5nKDAsIDIwMCkgKyAnLi4uJyA6IFxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGVkaXQgdGFyZ2V0cyBhdmFpbGFibGUgZm9yIGN1cnJlbnQgY29udGV4dFxuICAgICAqL1xuICAgIGdldEF2YWlsYWJsZVRhcmdldHMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQpOiBFZGl0Q29tbWFuZFR5cGVbJ3RhcmdldCddW10ge1xuICAgICAgICBjb25zdCB0YXJnZXRzOiBFZGl0Q29tbWFuZFR5cGVbJ3RhcmdldCddW10gPSBbJ3BhcmFncmFwaCcsICdkb2N1bWVudCcsICdlbmQnXTtcblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgdGFyZ2V0cy51bnNoaWZ0KCdzZWxlY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoLTIsIDAsICdzZWN0aW9uJyk7IC8vIEluc2VydCBiZWZvcmUgJ2RvY3VtZW50JyBhbmQgJ2VuZCdcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0YXJnZXRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzdGltYXRlIHRoZSBzY29wZSBvZiBjaGFuZ2VzXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogJ05vIGRvY3VtZW50IGF2YWlsYWJsZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBzZWN0aW9uLnJhbmdlLmVuZCAtIHNlY3Rpb24ucmFuZ2Uuc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gYFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEVzdGltYXRlIHNpbmdsZSBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAxMDA7IC8vIFJvdWdoIGVzdGltYXRlXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDE7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdDdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7IC8vIE5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdOZXcgY29udGVudCBhdCBlbmQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIERlbGV0ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIHJlbW92aW5nIGNvbnRlbnQgZnJvbSBkb2N1bWVudHNcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBEZWxldGVDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGRlbGV0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzbWFydCBkZWxldGlvbiwgd2UgbWF5IG5lZWQgQUkgdG8gZGV0ZXJtaW5lIHdoYXQgdG8gZGVsZXRlXG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgdG8gaWRlbnRpZnkgd2hhdCBzaG91bGQgYmUgZGVsZXRlZFxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXNrIEFJIHdoYXQgY29udGVudCBzaG91bGQgYmUgZGVsZXRlZFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhaVJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBQYXJzZSBBSSByZXNwb25zZSB0byBkZXRlcm1pbmUgZGVsZXRpb24gYWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBNVlAsIHdlJ2xsIHByb2NlZWQgd2l0aCB0aGUgdGFyZ2V0LWJhc2VkIGRlbGV0aW9uXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgYW5hbHlzaXMgZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBkZWxldGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlEZWxldGlvbihjb21tYW5kLCBkb2N1bWVudENvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBMb2cgZGVsZXRpb24gcmVzdWx0IChvbmx5IGZhaWx1cmVzKVxuICAgICAgICAgICAgaWYgKGNvbW1hbmQuaW5zdHJ1Y3Rpb24gJiYgY29tbWFuZC5pbnN0cnVjdGlvbi50cmltKCkubGVuZ3RoID4gMCAmJiAhcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBkZWxldGUgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGRlbGV0aW9uIGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseURlbGV0aW9uKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0XG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQgZm9yIGRlbGV0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIGVudGlyZSBzZWN0aW9uIGluY2x1ZGluZyBoZWFkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdTZWN0aW9uIG5hbWUgcmVxdWlyZWQgZm9yIHNlY3Rpb24gZGVsZXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBjdXJyZW50IHBhcmFncmFwaCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvbnRlbnQgPSBlZGl0b3IuZ2V0TGluZShjdXJyZW50TGluZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzIChlbXB0eSBsaW5lcyBvciBoZWFkaW5nIG1hcmtlcnMpXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IHN0YXJ0TGluZSwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBlbmRMaW5lICsgMSwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJycsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGN1cnNvciBwb3NpdGlvbiBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgZW50aXJlIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoJycpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBjb250ZW50IGZyb20gZW5kIC0gbm90IG1lYW5pbmdmdWwgZm9yIGRlbGV0ZSBjb21tYW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBmcm9tIGVuZCBvZiBkb2N1bWVudC4gVXNlIGEgZGlmZmVyZW50IHRhcmdldC4nLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRpb24gdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGRlbGV0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIGxvY2F0aW9uIGlzIHJlcXVpcmVkIGZvciBzZWN0aW9uIGRlbGV0aW9uXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlY3Rpb24nICYmICFjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3Igc2VjdGlvbiBkZWxldGlvbidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSB0YXJnZXQgaXMgYXBwcm9wcmlhdGUgZm9yIGRlbGV0aW9uXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ2VuZCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBmcm9tIGVuZCBvZiBkb2N1bWVudC4gVXNlIGEgZGlmZmVyZW50IHRhcmdldC4nXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGlvbnMgZm9yIGRlbGV0ZSBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0RlbGV0ZSB0aGUgc2VsZWN0ZWQgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ1JlbW92ZSB0aGlzIGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICdDbGVhciB0aGUgc2VsZWN0aW9uJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0RlbGV0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnLFxuICAgICAgICAgICAgICAgICdSZW1vdmUgZW1wdHkgc2VjdGlvbnMnLFxuICAgICAgICAgICAgICAgICdDbGVhciByZWR1bmRhbnQgY29udGVudCcsXG4gICAgICAgICAgICAgICAgJ0RlbGV0ZSBkdXBsaWNhdGUgaW5mb3JtYXRpb24nXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBBZGQgc2VjdGlvbi1zcGVjaWZpYyBkZWxldGlvbiBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYERlbGV0ZSB0aGUgXCIke2hlYWRpbmcudGV4dH1cIiBzZWN0aW9uYCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgOCk7IC8vIExpbWl0IHRvIDggc3VnZ2VzdGlvbnNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2aWV3IHdoYXQgd291bGQgYmUgZGVsZXRlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBhZmZlY3RlZENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGxldCBwcmV2aWV3VGV4dCA9ICcnO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGRlbGV0ZSB0aGUgc2VsZWN0ZWQgdGV4dCc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBpcyBjdXJyZW50bHkgc2VsZWN0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7c2VjdGlvbi5jb250ZW50fWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSBgV2lsbCBkZWxldGUgdGhlIGVudGlyZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdTZWN0aW9uIG5hbWUgcmVxdWlyZWQgZm9yIHByZXZpZXcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBkZWxldGUgdGhlIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhMaW5lczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnRMaW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ291bnQgPSBlZGl0b3IubGluZUNvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dExpbmUudHJpbSgpID09PSAnJyB8fCBuZXh0TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRMaW5lOyBpIDw9IGVuZExpbmU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGhMaW5lcy5wdXNoKGVkaXRvci5nZXRMaW5lKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gcGFyYWdyYXBoTGluZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGRlbGV0ZSBhbGwgZG9jdW1lbnQgY29udGVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50J1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGRlbGV0aW9uIHRhcmdldCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHByZXZpZXc6IHByZXZpZXdUZXh0LFxuICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudDogYWZmZWN0ZWRDb250ZW50Lmxlbmd0aCA+IDIwMCA/IFxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQuc3Vic3RyaW5nKDAsIDIwMCkgKyAnLi4uJyA6IFxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRlbGV0ZSB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50J107XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgIHRhcmdldHMudW5zaGlmdCgnc2VsZWN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRhcmdldHMuc3BsaWNlKC0xLCAwLCAnc2VjdGlvbicpOyAvLyBJbnNlcnQgYmVmb3JlICdkb2N1bWVudCdcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0YXJnZXRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzdGltYXRlIHRoZSBzY29wZSBvZiBkZWxldGlvblxuICAgICAqL1xuICAgIGFzeW5jIGVzdGltYXRlU2NvcGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBsaW5lc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIHNjb3BlRGVzY3JpcHRpb246IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb246ICdObyBkb2N1bWVudCBhdmFpbGFibGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IHNjb3BlRGVzY3JpcHRpb24gPSAnJztcblxuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5zcGxpdCgnXFxuJykubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ1NlbGVjdGVkIHRleHQgb25seSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IHNlY3Rpb24uY29udGVudC5sZW5ndGggKyBzZWN0aW9uLmhlYWRpbmcubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IHNlY3Rpb24ucmFuZ2UuZW5kIC0gc2VjdGlvbi5yYW5nZS5zdGFydCArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gYFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEVzdGltYXRlIHNpbmdsZSBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAxMDA7IC8vIFJvdWdoIGVzdGltYXRlXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDE7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdDdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdJbnZhbGlkIHRhcmdldCBmb3IgZGVsZXRpb24nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIEdyYW1tYXIgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBncmFtbWFyIGNoZWNraW5nIGFuZCBjb3JyZWN0aW9uIG9mIGNvbnRlbnRcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBHcmFtbWFyQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgZm9yIGdyYW1tYXIgY29ycmVjdGlvbiB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uIGZvciBncmFtbWFyIGNvcnJlY3Rpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb3JyZWN0ZWRDb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuMywgLy8gTG93ZXIgdGVtcGVyYXR1cmUgZm9yIGdyYW1tYXIgY29ycmVjdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvcnJlY3RlZENvbnRlbnQgfHwgY29ycmVjdGVkQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY29ycmVjdGVkIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBncmFtbWFyIGNvcnJlY3Rpb24gYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUdyYW1tYXJDb3JyZWN0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29ycmVjdGVkQ29udGVudCk7XG5cbiAgICAgICAgICAgICAgICAvLyBEb24ndCBsb2cgc3VjY2VzcyBtZXNzYWdlcyAtIGhhbmRsZWQgYnkgVUlcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGNvcnJlY3QgZ3JhbW1hcicsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnR3JhbW1hciBjb3JyZWN0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBncmFtbWFyIGNvcnJlY3Rpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5R3JhbW1hckNvcnJlY3Rpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvcnJlY3RlZENvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29ycmVjdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBzZWN0aW9uIGNvbnRlbnQgd2hpbGUgcHJlc2VydmluZyBoZWFkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdTZWN0aW9uQ29udGVudCA9IGAke3NlY3Rpb24uaGVhZGluZ31cXG5cXG4ke2NvcnJlY3RlZENvbnRlbnR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IHNlY3Rpb24ucmFuZ2Uuc3RhcnQsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IHNlY3Rpb24ucmFuZ2UuZW5kICsgMSwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld1NlY3Rpb25Db250ZW50LCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG5ld1NlY3Rpb25Db250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBGYWxsIHRocm91Z2ggdG8gcGFyYWdyYXBoIGlmIG5vIGxvY2F0aW9uIHNwZWNpZmllZFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAvLyBBcHBseSBncmFtbWFyIGNvcnJlY3Rpb24gdG8gY3VycmVudCBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgcGFyYWdyYXBoIHdpdGggY29ycmVjdGVkIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IHN0YXJ0TGluZSwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBlbmRMaW5lLCBjaDogZWRpdG9yLmdldExpbmUoZW5kTGluZSkubGVuZ3RoIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGNvcnJlY3RlZENvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb3JyZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGN1cnNvciBwb3NpdGlvbiBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb3JyZWN0ZWRDb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgZ3JhbW1hciBjb21tYW5kcyB0YXJnZXRpbmcgZW5kLCB0cmVhdCBhcyBhZGRpbmcgY29ycmVjdGVkIGNvbnRlbnQgdG8gZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb3JyZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBncmFtbWFyIGNvcnJlY3Rpb24gdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBncmFtbWFyIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIHNlY3Rpb24gdGFyZ2V0cywgbG9jYXRpb24gc2hvdWxkIGJlIHByb3ZpZGVkIGZvciBiZXR0ZXIgYWNjdXJhY3lcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdncmFtbWFyJyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiBncmFtbWFyIGNvcnJlY3Rpb25cbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgZ3JhbW1hciBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHNlbGVjdGVkIHRleHQnLFxuICAgICAgICAgICAgICAgICdDb3JyZWN0IHNwZWxsaW5nIGFuZCBwdW5jdHVhdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgc2VudGVuY2Ugc3RydWN0dXJlJyxcbiAgICAgICAgICAgICAgICAnRml4IGNhcGl0YWxpemF0aW9uIGVycm9ycycsXG4gICAgICAgICAgICAgICAgJ0NvcnJlY3QgdmVyYiB0ZW5zZXMnLFxuICAgICAgICAgICAgICAgICdGaXggc3ViamVjdC12ZXJiIGFncmVlbWVudCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgcmVhZGFiaWxpdHknXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnQ2hlY2sgZ3JhbW1hciB0aHJvdWdob3V0IGRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICAnRml4IHNwZWxsaW5nIGVycm9ycycsXG4gICAgICAgICAgICAgICAgJ0NvcnJlY3QgcHVuY3R1YXRpb24nLFxuICAgICAgICAgICAgICAgICdJbXByb3ZlIHNlbnRlbmNlIHN0cnVjdHVyZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWF0aWNhbCBlcnJvcnMgaW4gY3VycmVudCBwYXJhZ3JhcGgnLFxuICAgICAgICAgICAgICAgICdDaGVjayBmb3IgY29tbW9uIG1pc3Rha2VzJyxcbiAgICAgICAgICAgICAgICAnUHJvb2ZyZWFkIHRoZSBkb2N1bWVudCdcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIGdyYW1tYXIgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBDaGVjayBncmFtbWFyIGluIFwiJHtoZWFkaW5nLnRleHR9XCIgc2VjdGlvbmApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDEwKTsgLy8gTGltaXQgdG8gMTAgc3VnZ2VzdGlvbnNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2aWV3IHdoYXQgd291bGQgYmUgZ3JhbW1hci1jb3JyZWN0ZWRcbiAgICAgKi9cbiAgICBhc3luYyBwcmV2aWV3KGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBzdWNjZXNzOiBib29sZWFuO1xuICAgICAgICBwcmV2aWV3Pzogc3RyaW5nO1xuICAgICAgICBhZmZlY3RlZENvbnRlbnQ/OiBzdHJpbmc7XG4gICAgICAgIHBvdGVudGlhbElzc3Vlcz86IHN0cmluZ1tdO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGFmZmVjdGVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgbGV0IHByZXZpZXdUZXh0ID0gJyc7XG4gICAgICAgICAgICBjb25zdCBwb3RlbnRpYWxJc3N1ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgY2hlY2sgZ3JhbW1hciBpbiB0aGUgc2VsZWN0ZWQgdGV4dCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJhc2ljIGdyYW1tYXIgaXNzdWUgZGV0ZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3RlbnRpYWxJc3N1ZXMucHVzaCguLi50aGlzLmRldGVjdFBvdGVudGlhbElzc3VlcyhhZmZlY3RlZENvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IGlzIGN1cnJlbnRseSBzZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSBgV2lsbCBjaGVjayBncmFtbWFyIGluIHRoZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3RlbnRpYWxJc3N1ZXMucHVzaCguLi50aGlzLmRldGVjdFBvdGVudGlhbElzc3VlcyhhZmZlY3RlZENvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgY2hlY2sgZ3JhbW1hciBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGluIHRoZSBjdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYWdyYXBoTGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBwYXJhZ3JhcGggYm91bmRhcmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkxpbmUgPSBlZGl0b3IuZ2V0TGluZShzdGFydExpbmUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChlbmRMaW5lIDwgbGluZUNvdW50IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0TGluZTsgaSA8PSBlbmRMaW5lOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYWdyYXBoTGluZXMucHVzaChlZGl0b3IuZ2V0TGluZShpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHBhcmFncmFwaExpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIHRocm91Z2hvdXQgdGhlIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgYWRkIGdyYW1tYXItY29ycmVjdGVkIGNvbnRlbnQgYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBncmFtbWFyIGNvcnJlY3Rpb24gdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBwb3RlbnRpYWxJc3N1ZXM6IHBvdGVudGlhbElzc3Vlcy5zbGljZSgwLCA1KSAvLyBMaW1pdCB0byA1IGlzc3Vlc1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXRlY3QgcG90ZW50aWFsIGdyYW1tYXIgaXNzdWVzIGluIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdFBvdGVudGlhbElzc3Vlcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEJhc2ljIHBhdHRlcm4gbWF0Y2hpbmcgZm9yIGNvbW1vbiBpc3N1ZXNcbiAgICAgICAgY29uc3QgcGF0dGVybnMgPSBbXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXGJpXFxzL2dpLCBpc3N1ZTogJ0xvd2VyY2FzZSBcImlcIiBzaG91bGQgYmUgY2FwaXRhbGl6ZWQnIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXC5cXHMqW2Etel0vZywgaXNzdWU6ICdTZW50ZW5jZSBzaG91bGQgc3RhcnQgd2l0aCBjYXBpdGFsIGxldHRlcicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcc3syLH0vZywgaXNzdWU6ICdNdWx0aXBsZSBzcGFjZXMgZGV0ZWN0ZWQnIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9bLiE/XXsyLH0vZywgaXNzdWU6ICdNdWx0aXBsZSBwdW5jdHVhdGlvbiBtYXJrcycgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xccytbLiE/LDo7XS9nLCBpc3N1ZTogJ1NwYWNlIGJlZm9yZSBwdW5jdHVhdGlvbicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1suIT9dXFx3L2csIGlzc3VlOiAnTWlzc2luZyBzcGFjZSBhZnRlciBwdW5jdHVhdGlvbicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYnRlaFxcYi9naSwgaXNzdWU6ICdDb21tb24gdHlwbzogXCJ0ZWhcIiBzaG91bGQgYmUgXCJ0aGVcIicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYmFuZFxccythbmRcXGIvZ2ksIGlzc3VlOiAnRHVwbGljYXRlIFwiYW5kXCInIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXGJ0aGVcXHMrdGhlXFxiL2dpLCBpc3N1ZTogJ0R1cGxpY2F0ZSBcInRoZVwiJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxiaXNcXHMraXNcXGIvZ2ksIGlzc3VlOiAnRHVwbGljYXRlIFwiaXNcIicgfVxuICAgICAgICBdO1xuXG4gICAgICAgIHBhdHRlcm5zLmZvckVhY2goKHsgcGF0dGVybiwgaXNzdWUgfSkgPT4ge1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdCh0ZXh0KSkge1xuICAgICAgICAgICAgICAgIGlzc3Vlcy5wdXNoKGlzc3VlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGlzc3VlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZ3JhbW1hciBjaGVjayB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGVzdGltYXRlU2NvcGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBsaW5lc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIHNjb3BlRGVzY3JpcHRpb246IHN0cmluZztcbiAgICAgICAgZXN0aW1hdGVkSXNzdWVzOiBudW1iZXI7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRJc3N1ZXM6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBsZXQgY29udGVudFRvQW5hbHl6ZSA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IHNlY3Rpb24uY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9IGBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAvLyBGb3IgZXN0aW1hdGlvbiBwdXJwb3NlcywgdXNlIHN1cnJvdW5kaW5nIGNvbnRleHRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5qb2luKCdcXG4nKSArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xcbicgKyBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwOyAvLyBOZXcgY29udGVudFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnTmV3IGNvbnRlbnQgYXQgZW5kJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEVzdGltYXRlIHBvdGVudGlhbCBpc3N1ZXNcbiAgICAgICAgY29uc3QgZXN0aW1hdGVkSXNzdWVzID0gdGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoY29udGVudFRvQW5hbHl6ZSkubGVuZ3RoO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQsXG4gICAgICAgICAgICBsaW5lc0FmZmVjdGVkLFxuICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGVzdGltYXRlZElzc3Vlc1xuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBSZXdyaXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgcmV3cml0aW5nIGNvbnRlbnQgd2l0aCBkaWZmZXJlbnQgc3R5bGVzIGFuZCBhcHByb2FjaGVzXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUmV3cml0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kLCAhIWRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IGZvciByZXdyaXRpbmcgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvbiBmb3IgcmV3cml0aW5nXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmV3cml0dGVuQ29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghcmV3cml0dGVuQ29udGVudCB8fCByZXdyaXR0ZW5Db250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSByZXdyaXR0ZW4gY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIHJld3JpdGUgYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseVJld3JpdGUoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCByZXdyaXR0ZW5Db250ZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gcmV3cml0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdSZXdyaXRlIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IHJld3JpdGUgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5UmV3cml0ZShcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcmV3cml0dGVuQ29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICByZXdyaXR0ZW5Db250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlY3Rpb24gY29udGVudCB3aGlsZSBwcmVzZXJ2aW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7cmV3cml0dGVuQ29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3U2VjdGlvbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3U2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZhbGwgdGhyb3VnaCB0byBwYXJhZ3JhcGggaWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IHJld3JpdGUgdG8gY3VycmVudCBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgcGFyYWdyYXBoIHdpdGggcmV3cml0dGVuIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IHN0YXJ0TGluZSwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBlbmRMaW5lLCBjaDogZWRpdG9yLmdldExpbmUoZW5kTGluZSkubGVuZ3RoIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHJld3JpdHRlbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiByZXdyaXR0ZW5Db250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGN1cnNvciBwb3NpdGlvbiBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChyZXdyaXR0ZW5Db250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgcmV3cml0ZSBjb21tYW5kcyB0YXJnZXRpbmcgZW5kLCB0cmVhdCBhcyBhZGRpbmcgcmV3cml0dGVuIGNvbnRlbnQgdG8gZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICByZXdyaXR0ZW5Db250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCByZXdyaXRlIHRhcmdldCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcmV3cml0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBzZWN0aW9uIHRhcmdldHMsIGxvY2F0aW9uIHNob3VsZCBiZSBwcm92aWRlZCBmb3IgYmV0dGVyIGFjY3VyYWN5XG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlY3Rpb24nICYmIGNvbW1hbmQuYWN0aW9uID09PSAncmV3cml0ZScgJiYgY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgLy8gTG9jYXRpb24gaXMgcHJvdmlkZWQsIHdoaWNoIGlzIGdvb2QgZm9yIHNlY3Rpb24gcmV3cml0aW5nXG4gICAgICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGlvbnMgZm9yIHJld3JpdGUgY29tbWFuZHNcbiAgICAgKi9cbiAgICBnZXRTdWdnZXN0aW9ucyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCwgaGFzU2VsZWN0aW9uOiBib29sZWFuKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGluIGEgbW9yZSBmb3JtYWwgdG9uZScsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYSBjYXN1YWwgdG9uZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGNvbmNpc2UnLFxuICAgICAgICAgICAgICAgICdFeHBhbmQgd2l0aCBtb3JlIGRldGFpbCcsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgZm9yIGNsYXJpdHknLFxuICAgICAgICAgICAgICAgICdTaW1wbGlmeSB0aGUgbGFuZ3VhZ2UnLFxuICAgICAgICAgICAgICAgICdNYWtlIGl0IG1vcmUgZW5nYWdpbmcnLFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGluIGJ1bGxldCBwb2ludHMnLFxuICAgICAgICAgICAgICAgICdDb252ZXJ0IHRvIG5hcnJhdGl2ZSBmb3JtJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgdGhlIGN1cnJlbnQgcGFyYWdyYXBoJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBpbiBhIGRpZmZlcmVudCBzdHlsZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhlIHdyaXRpbmcgbW9yZSBlbmdhZ2luZycsXG4gICAgICAgICAgICAgICAgJ1NpbXBsaWZ5IGNvbXBsZXggbGFuZ3VhZ2UnLFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGZvciBkaWZmZXJlbnQgYXVkaWVuY2UnLFxuICAgICAgICAgICAgICAgICdDb252ZXJ0IHRvIG1vcmUgZm9ybWFsIHRvbmUnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoZSBjb250ZW50IG1vcmUgY29uY2lzZSdcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIHJld3JpdGUgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBSZXdyaXRlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCAxMCk7IC8vIExpbWl0IHRvIDEwIHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IHdvdWxkIGJlIHJld3JpdHRlblxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgcmV3cml0ZVN0eWxlPzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGFmZmVjdGVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgbGV0IHByZXZpZXdUZXh0ID0gJyc7XG4gICAgICAgICAgICBjb25zdCByZXdyaXRlU3R5bGUgPSB0aGlzLmluZmVyUmV3cml0ZVN0eWxlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24pO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIHJld3JpdGUgdGhlIHNlbGVjdGVkIHRleHRgO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ICs9IGAgKCR7cmV3cml0ZVN0eWxlfSlgO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIHJld3JpdGUgdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXdyaXRlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgcmV3cml0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY3VycmVudCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFncmFwaExpbmVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHN0YXJ0IG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2TGluZS50cmltKCkgPT09ICcnIHx8IHByZXZMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5lLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgZW5kIG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dExpbmUgPSBlZGl0b3IuZ2V0TGluZShlbmRMaW5lICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydExpbmU7IGkgPD0gZW5kTGluZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaExpbmVzLnB1c2goZWRpdG9yLmdldExpbmUoaSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBwYXJhZ3JhcGhMaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgcmV3cml0ZSB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGFkZCByZXdyaXR0ZW4gY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXdyaXRlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ICs9IGAgKCR7cmV3cml0ZVN0eWxlfSlgO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJld3JpdGUgdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICByZXdyaXRlU3R5bGVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5mZXIgcmV3cml0ZSBzdHlsZSBmcm9tIGluc3RydWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBpbmZlclJld3JpdGVTdHlsZShpbnN0cnVjdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnZm9ybWFsJykpIHJldHVybiAnZm9ybWFsIHRvbmUnO1xuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnY2FzdWFsJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnaW5mb3JtYWwnKSkgcmV0dXJuICdjYXN1YWwgdG9uZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjb25jaXNlJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2hvcnRlcicpKSByZXR1cm4gJ21vcmUgY29uY2lzZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdleHBhbmQnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdkZXRhaWwnKSkgcmV0dXJuICdtb3JlIGRldGFpbGVkJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3NpbXBsZScpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3NpbXBsaWZ5JykpIHJldHVybiAnc2ltcGxpZmllZCBsYW5ndWFnZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdlbmdhZ2luZycpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2ludGVyZXN0aW5nJykpIHJldHVybiAnbW9yZSBlbmdhZ2luZyc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdwcm9mZXNzaW9uYWwnKSkgcmV0dXJuICdwcm9mZXNzaW9uYWwgdG9uZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdidWxsZXQnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdsaXN0JykpIHJldHVybiAnYnVsbGV0IHBvaW50IGZvcm1hdCc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCduYXJyYXRpdmUnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdzdG9yeScpKSByZXR1cm4gJ25hcnJhdGl2ZSBzdHlsZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCd0ZWNobmljYWwnKSkgcmV0dXJuICd0ZWNobmljYWwgc3R5bGUnO1xuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnY3JlYXRpdmUnKSkgcmV0dXJuICdjcmVhdGl2ZSBzdHlsZSc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHJld3JpdGUgdGFyZ2V0cyBhdmFpbGFibGUgZm9yIGN1cnJlbnQgY29udGV4dFxuICAgICAqL1xuICAgIGdldEF2YWlsYWJsZVRhcmdldHMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQpOiBFZGl0Q29tbWFuZFR5cGVbJ3RhcmdldCddW10ge1xuICAgICAgICBjb25zdCB0YXJnZXRzOiBFZGl0Q29tbWFuZFR5cGVbJ3RhcmdldCddW10gPSBbJ3BhcmFncmFwaCcsICdkb2N1bWVudCcsICdlbmQnXTtcblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgdGFyZ2V0cy51bnNoaWZ0KCdzZWxlY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoLTIsIDAsICdzZWN0aW9uJyk7IC8vIEluc2VydCBiZWZvcmUgJ2RvY3VtZW50JyBhbmQgJ2VuZCdcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0YXJnZXRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzdGltYXRlIHRoZSBzY29wZSBvZiByZXdyaXRpbmdcbiAgICAgKi9cbiAgICBhc3luYyBlc3RpbWF0ZVNjb3BlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgbGluZXNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBzY29wZURlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgICAgIHJld3JpdGVDb21wbGV4aXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogJ05vIGRvY3VtZW50IGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHk6ICdsb3cnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IHNjb3BlRGVzY3JpcHRpb24gPSAnJztcbiAgICAgICAgbGV0IGNvbnRlbnRUb0FuYWx5emUgPSAnJztcblxuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5zcGxpdCgnXFxuJykubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ1NlbGVjdGVkIHRleHQgb25seSc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBzZWN0aW9uLmNvbnRlbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IHNlY3Rpb24ucmFuZ2UuZW5kIC0gc2VjdGlvbi5yYW5nZS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gc2VjdGlvbi5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEVzdGltYXRlIHNpbmdsZSBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAxMDA7IC8vIFJvdWdoIGVzdGltYXRlXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDE7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdDdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgLy8gRm9yIGVzdGltYXRpb24gcHVycG9zZXMsIHVzZSBzdXJyb3VuZGluZyBjb250ZXh0XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5iZWZvcmUuam9pbignXFxuJykgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcXG4nICsgZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYWZ0ZXIuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnRW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDsgLy8gTmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ05ldyBjb250ZW50IGF0IGVuZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZXRlcm1pbmUgcmV3cml0ZSBjb21wbGV4aXR5IGJhc2VkIG9uIGNvbnRlbnQgbGVuZ3RoIGFuZCBpbnN0cnVjdGlvblxuICAgICAgICBjb25zdCByZXdyaXRlQ29tcGxleGl0eSA9IHRoaXMuZXN0aW1hdGVDb21wbGV4aXR5KGNvbnRlbnRUb0FuYWx5emUsIGNvbW1hbmQuaW5zdHJ1Y3Rpb24pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQsXG4gICAgICAgICAgICBsaW5lc0FmZmVjdGVkLFxuICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbixcbiAgICAgICAgICAgIHJld3JpdGVDb21wbGV4aXR5XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgcmV3cml0ZSBjb21wbGV4aXR5XG4gICAgICovXG4gICAgcHJpdmF0ZSBlc3RpbWF0ZUNvbXBsZXhpdHkoY29udGVudDogc3RyaW5nLCBpbnN0cnVjdGlvbjogc3RyaW5nKTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRMZW5ndGggPSBjb250ZW50Lmxlbmd0aDtcbiAgICAgICAgY29uc3QgbG93ZXJJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCYXNlIGNvbXBsZXhpdHkgb24gY29udGVudCBsZW5ndGhcbiAgICAgICAgbGV0IGNvbXBsZXhpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgPSAnbG93JztcbiAgICAgICAgaWYgKGNvbnRlbnRMZW5ndGggPiAxMDAwKSBjb21wbGV4aXR5ID0gJ2hpZ2gnO1xuICAgICAgICBlbHNlIGlmIChjb250ZW50TGVuZ3RoID4gMzAwKSBjb21wbGV4aXR5ID0gJ21lZGl1bSc7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGp1c3QgYmFzZWQgb24gaW5zdHJ1Y3Rpb24gY29tcGxleGl0eVxuICAgICAgICBjb25zdCBjb21wbGV4SW5zdHJ1Y3Rpb25zID0gW1xuICAgICAgICAgICAgJ3Jlc3RydWN0dXJlJywgJ3Jlb3JnYW5pemUnLCAnY29tcGxldGVseSByZXdyaXRlJywgJ3RyYW5zZm9ybScsXG4gICAgICAgICAgICAnY2hhbmdlIHN0eWxlJywgJ2RpZmZlcmVudCBhdWRpZW5jZScsICd0ZWNobmljYWwnLCAnYWNhZGVtaWMnXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICBpZiAoY29tcGxleEluc3RydWN0aW9ucy5zb21lKHRlcm0gPT4gbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcyh0ZXJtKSkpIHtcbiAgICAgICAgICAgIGlmIChjb21wbGV4aXR5ID09PSAnbG93JykgY29tcGxleGl0eSA9ICdtZWRpdW0nO1xuICAgICAgICAgICAgZWxzZSBpZiAoY29tcGxleGl0eSA9PT0gJ21lZGl1bScpIGNvbXBsZXhpdHkgPSAnaGlnaCc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjb21wbGV4aXR5O1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBjYXRhbHlzdERhdGU6IHN0cmluZzsgIC8vIFlZWVktTU0tREQgZm9ybWF0XG4gICAgZ2VuZXJhbERhdGU6IHN0cmluZzsgICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRmVhdHVyZSByZWxlYXNlIGNvbmZpZ3VyYXRpb24gZm9yIENhdGFseXN0IGVhcmx5IGFjY2VzcyBtb2RlbFxuICogQ2F0YWx5c3Qgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gY2F0YWx5c3REYXRlXG4gKiBBbGwgdXNlcnMgZ2V0IGZlYXR1cmVzIG9uIGdlbmVyYWxEYXRlXG4gKiBcbiAqIERhdGVzIGFyZSBpbiBZWVlZLU1NLUREIGZvcm1hdCBhbmQgZWFzeSB0byBtb2RpZnkgcG9zdC1sYXVuY2hcbiAqL1xuZXhwb3J0IGNvbnN0IENBVEFMWVNUX0ZFQVRVUkVTOiBSZWNvcmQ8c3RyaW5nLCBUaW1lR2F0ZWRGZWF0dXJlPiA9IHtcbiAgICAvLyBDb21tYW5kIHN5c3RlbSAtIDMgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmQtc3lzdGVtJzoge1xuICAgICAgICBjYXRhbHlzdERhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA5LTE1JywgICAvLyAzIG1vbnRocyBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbW1hbmQgc3lzdGVtIHdpdGggOiB0cmlnZ2VycyBhbmQgcHJvdmlkZXIgc3dpdGNoaW5nJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gTXVsdGktZG9jdW1lbnQgY29udGV4dCAtIDIgbW9udGggZWFybHkgYWNjZXNzICBcbiAgICAnbXVsdGktZG9jLWNvbnRleHQnOiB7XG4gICAgICAgIGNhdGFseXN0RGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDgtMTUnLCAgIC8vIDIgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUmVmZXJlbmNlIG90aGVyIGRvY3VtZW50cyB3aXRoIFtbZG9jXV0gc3ludGF4J1xuICAgIH0sXG4gICAgXG4gICAgLy8gQXV0by1ncm93aW5nIGlucHV0IC0gMSBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnYXV0by1pbnB1dCc6IHtcbiAgICAgICAgY2F0YWx5c3REYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wNy0xNScsICAgLy8gMSBtb250aCBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0F1dG8tZ3Jvd2luZyBpbnB1dCBhcmVhIHdpdGggc21vb3RoIHRyYW5zaXRpb25zJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gQ29tbWFuZCBidXR0b24gLSAyIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdjb21tYW5kLWJ1dHRvbic6IHtcbiAgICAgICAgY2F0YWx5c3REYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOC0xNScsICAgLy8gMiBtb250aHMgbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb21tYW5kIGJ1dHRvbiBmb3IgbW9iaWxlIGFuZCBkaXNjb3ZlcnknXG4gICAgfSxcbiAgICBcbiAgICAvLyBDdXN0b20gY29tbWFuZHMgLSAzIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdjdXN0b20tY29tbWFuZHMnOiB7XG4gICAgICAgIGNhdGFseXN0RGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDktMTUnLCAgIC8vIDMgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVXNlci1kZWZpbmVkIGN1c3RvbSBjb21tYW5kIHNob3J0Y3V0cydcbiAgICB9LFxuICAgIFxuICAgIC8vIEVuaGFuY2VkIHByb3ZpZGVyIG1hbmFnZW1lbnQgLSAyIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdlbmhhbmNlZC1wcm92aWRlcnMnOiB7XG4gICAgICAgIGNhdGFseXN0RGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDgtMTUnLCAgIC8vIDIgbW9udGhzIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWR2YW5jZWQgcHJvdmlkZXIgY29uZmlndXJhdGlvbiBhbmQgc3dpdGNoaW5nJ1xuICAgIH1cbn07XG5cbi8qKlxuICogQ29yZSBmZWF0dXJlcyB0aGF0IGFyZSBhbHdheXMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuICogVGhlc2UgYXJlIE5PVCB0aW1lLWdhdGVkXG4gKi9cbmV4cG9ydCBjb25zdCBDT1JFX0ZFQVRVUkVTID0gW1xuICAgICdiYXNpY19lZGl0aW5nJywgICAgICAgICAgLy8gQWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUgY29tbWFuZHNcbiAgICAnYWxsX2FpX3Byb3ZpZGVycycsICAgICAgIC8vIENsYXVkZSwgT3BlbkFJLCBHb29nbGUsIE9sbGFtYVxuICAgICdmaWxlX2NvbnZlcnNhdGlvbnMnLCAgICAgLy8gRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICAncHJvdmlkZXJfc3dpdGNoaW5nJywgICAgIC8vIFN3aXRjaCBwcm92aWRlcnMgaW4gY2hhdFxuICAgICdtb2JpbGVfYWNjZXNzJywgICAgICAgICAgLy8gRnVsbCBtb2JpbGUgc3VwcG9ydFxuICAgICdhcGlfa2V5X2NvbmZpZycsICAgICAgICAgLy8gQ29uZmlndXJlIG93biBBUEkga2V5c1xuICAgICdzaWRlYmFyX2NoYXQnLCAgICAgICAgICAgLy8gQ2hhdCBpbnRlcmZhY2UgaW4gc2lkZWJhclxuICAgICdkb2N1bWVudF9jb250ZXh0JyAgICAgICAgLy8gQ3VycmVudCBkb2N1bWVudCBjb250ZXh0XG5dOyIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBDYXRhbHlzdExpY2Vuc2UsIEZlYXR1cmVGbGFnLCBGZWF0dXJlQWNjZXNzUmVzdWx0LCBEZWJ1Z1NldHRpbmdzLCBDYXRhbHlzdFZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENBVEFMWVNUX0ZFQVRVUkVTLCBDT1JFX0ZFQVRVUkVTLCBUaW1lR2F0ZWRGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlLWNvbmZpZyc7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTWFuYWdlciB7XG5cdHByaXZhdGUgZmVhdHVyZXM6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBjYXRhbHlzdExpY2Vuc2U6IENhdGFseXN0TGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzQ2F0YWx5c3Q6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbGljZW5zZVZhbGlkYXRvcjogTGljZW5zZVZhbGlkYXRvcixcblx0XHRkZWJ1Z1NldHRpbmdzPzogRGVidWdTZXR0aW5nc1xuXHQpIHtcblx0XHRpZiAoZGVidWdTZXR0aW5ncykge1xuXHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0gZGVidWdTZXR0aW5ncztcblx0XHR9XG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZSBhbGwgZmVhdHVyZSBmbGFnc1xuXHQgKiBDb3JlIGZlYXR1cmVzIGFyZSBhbHdheXMgZW5hYmxlZFxuXHQgKiBUaW1lLWdhdGVkIGZlYXR1cmVzIGRlcGVuZCBvbiBjdXJyZW50IGRhdGUgYW5kIENhdGFseXN0IHN0YXR1c1xuXHQgKi9cblx0cHJpdmF0ZSBpbml0aWFsaXplRmVhdHVyZUZsYWdzKCk6IHZvaWQge1xuXHRcdC8vIENvcmUgZmVhdHVyZXMgLSBhbHdheXMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuXHRcdENPUkVfRkVBVFVSRVMuZm9yRWFjaChmZWF0dXJlS2V5ID0+IHtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5OiBmZWF0dXJlS2V5LFxuXHRcdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogdGhpcy5nZXRDb3JlRmVhdHVyZURlc2NyaXB0aW9uKGZlYXR1cmVLZXkpXG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIFRpbWUtZ2F0ZWQgZmVhdHVyZXMgLSBhdmFpbGFibGUgYmFzZWQgb24gZGF0ZVxuXHRcdE9iamVjdC5lbnRyaWVzKENBVEFMWVNUX0ZFQVRVUkVTKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XG5cdFx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5pc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGtleSwgY29uZmlnKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5LFxuXHRcdFx0XHRlbmFibGVkLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuXHRcdFx0XHRpc1RpbWVHYXRlZDogdHJ1ZSxcblx0XHRcdFx0ZWFybHlBY2Nlc3NPbmx5OiAhdGhpcy5pc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWcpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVzY3JpcHRpb24gZm9yIGNvcmUgZmVhdHVyZXNcblx0ICovXG5cdHByaXZhdGUgZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihrZXk6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgZGVzY3JpcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2Jhc2ljX2VkaXRpbmcnOiAnQmFzaWMgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kcyAoYWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUpJyxcblx0XHRcdCdhbGxfYWlfcHJvdmlkZXJzJzogJ0FjY2VzcyB0byBhbGwgQUkgcHJvdmlkZXJzIChDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWEpJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnOiAnRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZyc6ICdTd2l0Y2ggQUkgcHJvdmlkZXJzIGRpcmVjdGx5IGluIGNoYXQgaW50ZXJmYWNlJyxcblx0XHRcdCdtb2JpbGVfYWNjZXNzJzogJ0Z1bGwgbW9iaWxlIGRldmljZSBzdXBwb3J0Jyxcblx0XHRcdCdhcGlfa2V5X2NvbmZpZyc6ICdDb25maWd1cmUgeW91ciBvd24gQVBJIGtleXMnLFxuXHRcdFx0J3NpZGViYXJfY2hhdCc6ICdDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyJyxcblx0XHRcdCdkb2N1bWVudF9jb250ZXh0JzogJ0N1cnJlbnQgZG9jdW1lbnQgY29udGV4dCBpbiBjb252ZXJzYXRpb25zJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGRlc2NyaXB0aW9uc1trZXldIHx8IGtleTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIHRpbWUtZ2F0ZWQgZmVhdHVyZSBzaG91bGQgYmUgZW5hYmxlZFxuXHQgKi9cblx0cHJpdmF0ZSBpc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZywgY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGNhdGFseXN0RGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5jYXRhbHlzdERhdGUpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblxuXHRcdC8vIEZlYXR1cmUgaXMgYXZhaWxhYmxlIHRvIGV2ZXJ5b25lIGFmdGVyIGdlbmVyYWwgZGF0ZVxuXHRcdGlmIChub3cgPj0gZ2VuZXJhbERhdGUpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIEZlYXR1cmUgaXMgYXZhaWxhYmxlIHRvIENhdGFseXN0IHN1cHBvcnRlcnMgYWZ0ZXIgY2F0YWx5c3QgZGF0ZVxuXHRcdGlmICh0aGlzLmdldElzQ2F0YWx5c3QoKSAmJiBub3cgPj0gY2F0YWx5c3REYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBDYXRhbHlzdCBzdGF0dXMgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldElzQ2F0YWx5c3QoKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuZGVidWdTZXR0aW5ncy5lbmFibGVkICYmIHRoaXMuZGVidWdTZXR0aW5ncy5mb3JjZUNhdGFseXN0ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VDYXRhbHlzdDtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuaXNDYXRhbHlzdDtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWdpc3RlciBhIG5ldyBmZWF0dXJlIGZsYWdcblx0ICovXG5cdHJlZ2lzdGVyRmVhdHVyZShmbGFnOiBGZWF0dXJlRmxhZyk6IHZvaWQge1xuXHRcdHRoaXMuZmVhdHVyZXMuc2V0KGZsYWcua2V5LCBmbGFnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgQ2F0YWx5c3QgbGljZW5zZSBhbmQgcmVjYWxjdWxhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0ICovXG5cdGFzeW5jIHVwZGF0ZUNhdGFseXN0TGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHR0aGlzLmNhdGFseXN0TGljZW5zZSA9IG51bGw7XG5cdFx0XHR0aGlzLmlzQ2F0YWx5c3QgPSBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMubGljZW5zZVZhbGlkYXRvci52YWxpZGF0ZUNhdGFseXN0TGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICh2YWxpZGF0aW9uLnZhbGlkICYmIHZhbGlkYXRpb24ubGljZW5zZSkge1xuXHRcdFx0XHR0aGlzLmNhdGFseXN0TGljZW5zZSA9IHZhbGlkYXRpb24ubGljZW5zZTtcblx0XHRcdFx0dGhpcy5pc0NhdGFseXN0ID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY2F0YWx5c3RMaWNlbnNlID0gbnVsbDtcblx0XHRcdFx0dGhpcy5pc0NhdGFseXN0ID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVpbml0aWFsaXplIGZlYXR1cmVzIHdpdGggdXBkYXRlZCBDYXRhbHlzdCBzdGF0dXNcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBDYXRhbHlzdCBzdGF0dXNcblx0ICovXG5cdGdldElzQ2F0YWx5c3RTdXBwb3J0ZXIoKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0SXNDYXRhbHlzdCgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IENhdGFseXN0IGxpY2Vuc2Vcblx0ICovXG5cdGdldENhdGFseXN0TGljZW5zZSgpOiBDYXRhbHlzdExpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5jYXRhbHlzdExpY2Vuc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgYSBmZWF0dXJlIGlzIGVuYWJsZWRcblx0ICovXG5cdGlzRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gSGFuZGxlIG9sZCBmZWF0dXJlIGtleXMgdGhhdCBtaWdodCBzdGlsbCBiZSByZWZlcmVuY2VkXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTsgLy8gQWxsIGxlZ2FjeSBmZWF0dXJlcyBhcmUgbm93IGVuYWJsZWQgZm9yIGV2ZXJ5b25lXG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdHJldHVybiBmZWF0dXJlPy5lbmFibGVkID8/IGZhbHNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoaXMgaXMgYSBsZWdhY3kgZmVhdHVyZSBrZXkgdGhhdCBzaG91bGQgYWx3YXlzIGJlIGVuYWJsZWRcblx0ICovXG5cdHByaXZhdGUgaXNMZWdhY3lGZWF0dXJlS2V5KGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Y29uc3QgbGVnYWN5S2V5cyA9IFtcblx0XHRcdCdiYXNpY19lZGl0aW5nJyxcblx0XHRcdCdsb2NhbF9haV9wcm92aWRlcnMnLFxuXHRcdFx0J2ZpbGVfY29udmVyc2F0aW9ucycsXG5cdFx0XHQnc2luZ2xlX2Nsb3VkX3Byb3ZpZGVyJyxcblx0XHRcdCd1bmxpbWl0ZWRfY2xvdWRfYWknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZycsXG5cdFx0XHQnbW9iaWxlX2FjY2VzcycsXG5cdFx0XHQnYWR2YW5jZWRfdGVtcGxhdGVzJyxcblx0XHRcdCdiYXRjaF9vcGVyYXRpb25zJyxcblx0XHRcdCdjcm9zc19kb2N1bWVudF9jb250ZXh0Jyxcblx0XHRcdCdwcmlvcml0eV9zdXBwb3J0J1xuXHRcdF07XG5cdFx0cmV0dXJuIGxlZ2FjeUtleXMuaW5jbHVkZXMoa2V5KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBmZWF0dXJlIGFjY2VzcyB3aXRoIGRldGFpbGVkIHJlc3VsdFxuXHQgKi9cblx0Y2hlY2tGZWF0dXJlQWNjZXNzKGZlYXR1cmVLZXk6IHN0cmluZyk6IEZlYXR1cmVBY2Nlc3NSZXN1bHQge1xuXHRcdC8vIEhhbmRsZSBsZWdhY3kgZmVhdHVyZXNcblx0XHRpZiAodGhpcy5pc0xlZ2FjeUZlYXR1cmVLZXkoZmVhdHVyZUtleSkpIHtcblx0XHRcdHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcblx0XHR9XG5cblx0XHRjb25zdCBmZWF0dXJlID0gdGhpcy5mZWF0dXJlcy5nZXQoZmVhdHVyZUtleSk7XG5cdFx0XG5cdFx0aWYgKCFmZWF0dXJlKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0YWxsb3dlZDogZmFsc2UsIFxuXHRcdFx0XHRyZWFzb246IGBGZWF0dXJlICcke2ZlYXR1cmVLZXl9JyBub3QgZm91bmRgIFxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRpZiAoZmVhdHVyZS5lbmFibGVkKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHRpbWUtZ2F0ZWQgZmVhdHVyZXMsIHByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvblxuXHRcdGlmIChmZWF0dXJlLmlzVGltZUdhdGVkKSB7XG5cdFx0XHRjb25zdCBjb25maWcgPSBDQVRBTFlTVF9GRUFUVVJFU1tmZWF0dXJlS2V5XTtcblx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdFx0XHRjb25zdCBnZW5lcmFsRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5nZW5lcmFsRGF0ZSk7XG5cdFx0XHRcdGNvbnN0IGNhdGFseXN0RGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5jYXRhbHlzdERhdGUpO1xuXG5cdFx0XHRcdGlmICh0aGlzLmdldElzQ2F0YWx5c3QoKSAmJiBub3cgPCBjYXRhbHlzdERhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgd2lsbCBiZSBhdmFpbGFibGUgdG8gQ2F0YWx5c3Qgc3VwcG9ydGVycyBvbiAke2NvbmZpZy5jYXRhbHlzdERhdGV9YCxcblx0XHRcdFx0XHRcdGlzQ2F0YWx5c3RGZWF0dXJlOiB0cnVlLFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogY2F0YWx5c3REYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIGlmICghdGhpcy5nZXRJc0NhdGFseXN0KCkgJiYgbm93IDwgZ2VuZXJhbERhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgQ2F0YWx5c3Qgc3VwcG9ydGVycy4gSXQgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uICR7Y29uZmlnLmdlbmVyYWxEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc0NhdGFseXN0RmVhdHVyZTogdHJ1ZSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGdlbmVyYWxEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdHJlYXNvbjogJ0ZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZSdcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgZW5hYmxlZCBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0RW5hYmxlZEZlYXR1cmVzKCk6IEZlYXR1cmVGbGFnW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMuZmVhdHVyZXMudmFsdWVzKCkpLmZpbHRlcihmZWF0dXJlID0+IGZlYXR1cmUuZW5hYmxlZCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFsbCBDYXRhbHlzdCBlYXJseSBhY2Nlc3MgZmVhdHVyZXNcblx0ICovXG5cdGdldENhdGFseXN0RmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHRmZWF0dXJlLmlzVGltZUdhdGVkICYmIGZlYXR1cmUuZWFybHlBY2Nlc3NPbmx5XG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IHRlc3Rpbmdcblx0ICovXG5cdHVwZGF0ZURlYnVnU2V0dGluZ3Moc2V0dGluZ3M6IERlYnVnU2V0dGluZ3MpOiB2b2lkIHtcblx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCBuZXcgZGVidWcgc2V0dGluZ3Ncblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeVxuXHQgKi9cblx0Z2V0RmVhdHVyZVN1bW1hcnkoKTogeyBcblx0XHRpc0NhdGFseXN0OiBib29sZWFuOyBcblx0XHRlbmFibGVkOiBzdHJpbmdbXTsgXG5cdFx0Y29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzQ2F0YWx5c3Q6IGJvb2xlYW59PiBcblx0fSB7XG5cdFx0Y29uc3QgZW5hYmxlZDogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBjb21pbmdTb29uOiBBcnJheTx7a2V5OiBzdHJpbmc7IGF2YWlsYWJsZURhdGU6IHN0cmluZzsgaXNDYXRhbHlzdDogYm9vbGVhbn0+ID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZlYXR1cmUuaXNUaW1lR2F0ZWQpIHtcblx0XHRcdFx0Y29uc3QgY29uZmlnID0gQ0FUQUxZU1RfRkVBVFVSRVNba2V5XTtcblx0XHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRcdGNvbnN0IGlzQ2F0YWx5c3RVc2VyID0gdGhpcy5nZXRJc0NhdGFseXN0KCk7XG5cdFx0XHRcdFx0Y29taW5nU29vbi5wdXNoKHtcblx0XHRcdFx0XHRcdGtleSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGlzQ2F0YWx5c3RVc2VyID8gY29uZmlnLmNhdGFseXN0RGF0ZSA6IGNvbmZpZy5nZW5lcmFsRGF0ZSxcblx0XHRcdFx0XHRcdGlzQ2F0YWx5c3Q6IGlzQ2F0YWx5c3RVc2VyXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4geyBcblx0XHRcdGlzQ2F0YWx5c3Q6IHRoaXMuZ2V0SXNDYXRhbHlzdCgpLCBcblx0XHRcdGVuYWJsZWQsIFxuXHRcdFx0Y29taW5nU29vbiBcblx0XHR9O1xuXHR9XG59IiwgImltcG9ydCB7IExpY2Vuc2UsIENhdGFseXN0TGljZW5zZSwgTGljZW5zZVZhbGlkYXRpb25SZXN1bHQsIENhdGFseXN0VmFsaWRhdGlvblJlc3VsdCwgTGljZW5zZUVycm9yIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBMaWNlbnNlVmFsaWRhdG9yIHtcblx0Ly8gRW1iZWRkZWQgc2lnbmluZyBrZXkgLSBpbiBwcm9kdWN0aW9uIHRoaXMgd291bGQgYmUgb2JmdXNjYXRlZFxuXHRwcml2YXRlIHJlYWRvbmx5IFNFQ1JFVF9LRVkgPSAnbm92YS1saWNlbnNlLXNpZ25pbmcta2V5LTIwMjUnO1xuXHRcblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIGxpY2Vuc2Uga2V5IGFuZCByZXR1cm5zIHZhbGlkYXRpb24gcmVzdWx0XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nKTogUHJvbWlzZTxMaWNlbnNlVmFsaWRhdGlvblJlc3VsdD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBsaWNlbnNlID0gdGhpcy5wYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleSk7XG5cdFx0XHRpZiAoIWxpY2Vuc2UpIHtcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLklOVkFMSURfRk9STUFUIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBhd2FpdCB0aGlzLnZhbGlkYXRlTGljZW5zZU9iamVjdChsaWNlbnNlKTtcblx0XHRcdGlmICh2YWxpZGF0aW9uRXJyb3IpIHtcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0XHRsaWNlbnNlLFxuXHRcdFx0XHRcdGVycm9yOiB2YWxpZGF0aW9uRXJyb3IgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogdHJ1ZSwgXG5cdFx0XHRcdGxpY2Vuc2UgXG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5NQUxGT1JNRURfREFUQSBcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBhcnNlcyBhIGxpY2Vuc2Uga2V5IHN0cmluZyBpbnRvIGEgTGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgcGFyc2VMaWNlbnNlS2V5KGxpY2Vuc2VLZXk6IHN0cmluZyk6IExpY2Vuc2UgfCBudWxsIHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gTGljZW5zZSBrZXkgZm9ybWF0OiBiYXNlNjQoZW1haWx8dGllcnxleHBpcmVzQXR8aXNzdWVkQXR8c2lnbmF0dXJlKVxuXHRcdFx0Y29uc3QgZGVjb2RlZCA9IHRoaXMuYmFzZTY0RGVjb2RlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBkZWNvZGVkLnNwbGl0KCd8Jyk7XG5cdFx0XHRcblx0XHRcdGlmIChwYXJ0cy5sZW5ndGggIT09IDUpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IFtlbWFpbCwgdGllciwgZXhwaXJlc0F0U3RyLCBpc3N1ZWRBdFN0ciwgc2lnbmF0dXJlXSA9IHBhcnRzO1xuXG5cdFx0XHQvLyBTa2lwIHRpZXIgdmFsaWRhdGlvbiBzaW5jZSB3ZSdyZSByZW1vdmluZyB0aWVyc1xuXG5cdFx0XHQvLyBQYXJzZSBkYXRlc1xuXHRcdFx0Y29uc3QgZXhwaXJlc0F0ID0gZXhwaXJlc0F0U3RyID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKGV4cGlyZXNBdFN0cik7XG5cdFx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKGlzc3VlZEF0U3RyKTtcblxuXHRcdFx0Ly8gVmFsaWRhdGUgZGF0ZXNcblx0XHRcdGlmIChpc05hTihpc3N1ZWRBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXhwaXJlc0F0ICYmIGlzTmFOKGV4cGlyZXNBdC5nZXRUaW1lKCkpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRlbWFpbCxcblx0XHRcdFx0ZXhwaXJlc0F0LFxuXHRcdFx0XHRpc3N1ZWRBdCxcblx0XHRcdFx0c2lnbmF0dXJlLFxuXHRcdFx0XHRsaWNlbnNlS2V5XG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU2FmZSBiYXNlNjQgZGVjb2RlIHRoYXQgaGFuZGxlcyBib3RoIGJyb3dzZXIgYW5kIE5vZGUuanMgZW52aXJvbm1lbnRzXG5cdCAqL1xuXHRwcml2YXRlIGJhc2U2NERlY29kZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKHR5cGVvZiBhdG9iICE9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIGF0b2Ioc3RyKTtcblx0XHR9XG5cdFx0Ly8gRmFsbGJhY2sgZm9yIE5vZGUuanMgZW52aXJvbm1lbnRcblx0XHRyZXR1cm4gQnVmZmVyLmZyb20oc3RyLCAnYmFzZTY0JykudG9TdHJpbmcoJ3V0ZjgnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBlbmNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RW5jb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGJ0b2EgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYnRvYShzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICd1dGY4JykudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIGxpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHZhbGlkYXRlTGljZW5zZU9iamVjdChsaWNlbnNlOiBMaWNlbnNlKTogUHJvbWlzZTxMaWNlbnNlRXJyb3IgfCBudWxsPiB7XG5cdFx0Ly8gMS4gVmVyaWZ5IEhNQUMgc2lnbmF0dXJlXG5cdFx0Y29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKFxuXHRcdFx0bGljZW5zZS5lbWFpbCxcblx0XHRcdCdsZWdhY3knLCAvLyBVc2UgbGVnYWN5IGZvciBvbGQgbGljZW5zZXNcblx0XHRcdGxpY2Vuc2UuZXhwaXJlc0F0LFxuXHRcdFx0bGljZW5zZS5pc3N1ZWRBdFxuXHRcdCk7XG5cblx0XHRpZiAobGljZW5zZS5zaWduYXR1cmUgIT09IGV4cGVjdGVkU2lnbmF0dXJlKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLklOVkFMSURfU0lHTkFUVVJFO1xuXHRcdH1cblxuXHRcdC8vIDIuIENoZWNrIGV4cGlyYXRpb25cblx0XHRpZiAobGljZW5zZS5leHBpcmVzQXQgJiYgbmV3IERhdGUoKSA+IGxpY2Vuc2UuZXhwaXJlc0F0KSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkVYUElSRUQ7XG5cdFx0fVxuXG5cdFx0Ly8gMy4gVmFsaWRhdGUgaXNzdWUgZGF0ZSAocHJldmVudCBmdXR1cmUtZGF0ZWQgbGljZW5zZXMpXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBsaWNlbnNlIGRhdGFcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0ZW1haWw6IHN0cmluZyxcblx0XHR0aWVyOiBzdHJpbmcsXG5cdFx0ZXhwaXJlc0F0OiBEYXRlIHwgbnVsbCxcblx0XHRpc3N1ZWRBdDogRGF0ZVxuXHQpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGRhdGEgPSBgJHtlbWFpbH18JHt0aWVyfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9YDtcblx0XHRcblx0XHRjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG5cdFx0Y29uc3Qga2V5RGF0YSA9IGVuY29kZXIuZW5jb2RlKHRoaXMuU0VDUkVUX0tFWSk7XG5cdFx0Y29uc3QgbWVzc2FnZURhdGEgPSBlbmNvZGVyLmVuY29kZShkYXRhKTtcblx0XHRcblx0XHRjb25zdCBjcnlwdG9LZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcblx0XHRcdCdyYXcnLFxuXHRcdFx0a2V5RGF0YSxcblx0XHRcdHsgbmFtZTogJ0hNQUMnLCBoYXNoOiAnU0hBLTI1NicgfSxcblx0XHRcdGZhbHNlLFxuXHRcdFx0WydzaWduJ11cblx0XHQpO1xuXHRcdFxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuc2lnbignSE1BQycsIGNyeXB0b0tleSwgbWVzc2FnZURhdGEpO1xuXHRcdHJldHVybiBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZSkpXG5cdFx0XHQubWFwKGIgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKSlcblx0XHRcdC5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgdGVzdCBsaWNlbnNlIGZvciBkZXZlbG9wbWVudCBwdXJwb3Nlc1xuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdExpY2Vuc2UoZW1haWw6IHN0cmluZywgdGllcjogc3RyaW5nLCBsaWZldGltZU1vZGUgPSB0cnVlKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gbGlmZXRpbWVNb2RlID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKGVtYWlsLCB0aWVyLCBleHBpcmVzQXQsIGlzc3VlZEF0KTtcblx0XHRcblx0XHRjb25zdCBsaWNlbnNlRGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX18JHtzaWduYXR1cmV9YDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5iYXNlNjRFbmNvZGUobGljZW5zZURhdGEpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIENhdGFseXN0IGxpY2Vuc2Uga2V5XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZUNhdGFseXN0TGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPENhdGFseXN0VmFsaWRhdGlvblJlc3VsdD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBsaWNlbnNlID0gdGhpcy5wYXJzZUNhdGFseXN0TGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVDYXRhbHlzdExpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBDYXRhbHlzdCBsaWNlbnNlIGtleSBzdHJpbmdcblx0ICovXG5cdHByaXZhdGUgcGFyc2VDYXRhbHlzdExpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogQ2F0YWx5c3RMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENhdGFseXN0IGxpY2Vuc2Uga2V5IGZvcm1hdDogYmFzZTY0KGVtYWlsfHR5cGV8ZXhwaXJlc0F0fGlzc3VlZEF0fHNpZ25hdHVyZSlcblx0XHRcdGNvbnN0IGRlY29kZWQgPSB0aGlzLmJhc2U2NERlY29kZShsaWNlbnNlS2V5KTtcblx0XHRcdGNvbnN0IHBhcnRzID0gZGVjb2RlZC5zcGxpdCgnfCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAocGFydHMubGVuZ3RoICE9PSA1KSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBbZW1haWwsIHR5cGUsIGV4cGlyZXNBdFN0ciwgaXNzdWVkQXRTdHIsIHNpZ25hdHVyZV0gPSBwYXJ0cztcblxuXHRcdFx0Ly8gVmFsaWRhdGUgdHlwZVxuXHRcdFx0aWYgKHR5cGUgIT09ICdhbm51YWwnICYmIHR5cGUgIT09ICdsaWZldGltZScpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHR0eXBlOiB0eXBlIGFzICdhbm51YWwnIHwgJ2xpZmV0aW1lJyxcblx0XHRcdFx0ZXhwaXJlc0F0LFxuXHRcdFx0XHRpc3N1ZWRBdCxcblx0XHRcdFx0c2lnbmF0dXJlLFxuXHRcdFx0XHRsaWNlbnNlS2V5XG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgQ2F0YWx5c3QgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVDYXRhbHlzdExpY2Vuc2VPYmplY3QobGljZW5zZTogQ2F0YWx5c3RMaWNlbnNlKTogUHJvbWlzZTxMaWNlbnNlRXJyb3IgfCBudWxsPiB7XG5cdFx0Ly8gMS4gVmVyaWZ5IEhNQUMgc2lnbmF0dXJlXG5cdFx0Y29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ2F0YWx5c3RTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50eXBlLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBDYXRhbHlzdCBsaWNlbnNlXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdlbmVyYXRlQ2F0YWx5c3RTaWduYXR1cmUoXG5cdFx0ZW1haWw6IHN0cmluZyxcblx0XHR0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScsXG5cdFx0ZXhwaXJlc0F0OiBEYXRlIHwgbnVsbCxcblx0XHRpc3N1ZWRBdDogRGF0ZVxuXHQpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGRhdGEgPSBgJHtlbWFpbH18JHt0eXBlfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9YDtcblx0XHRcblx0XHRjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG5cdFx0Y29uc3Qga2V5RGF0YSA9IGVuY29kZXIuZW5jb2RlKHRoaXMuU0VDUkVUX0tFWSk7XG5cdFx0Y29uc3QgbWVzc2FnZURhdGEgPSBlbmNvZGVyLmVuY29kZShkYXRhKTtcblx0XHRcblx0XHRjb25zdCBjcnlwdG9LZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcblx0XHRcdCdyYXcnLFxuXHRcdFx0a2V5RGF0YSxcblx0XHRcdHsgbmFtZTogJ0hNQUMnLCBoYXNoOiAnU0hBLTI1NicgfSxcblx0XHRcdGZhbHNlLFxuXHRcdFx0WydzaWduJ11cblx0XHQpO1xuXHRcdFxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuc2lnbignSE1BQycsIGNyeXB0b0tleSwgbWVzc2FnZURhdGEpO1xuXHRcdHJldHVybiBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KHNpZ25hdHVyZSkpXG5cdFx0XHQubWFwKGIgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKSlcblx0XHRcdC5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgdGVzdCBDYXRhbHlzdCBsaWNlbnNlIGZvciBkZXZlbG9wbWVudFxuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdENhdGFseXN0TGljZW5zZShlbWFpbDogc3RyaW5nLCB0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSB0eXBlID09PSAnbGlmZXRpbWUnID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ2F0YWx5c3RTaWduYXR1cmUoZW1haWwsIHR5cGUsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dHlwZX18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtB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QWlDLFFBQVE7QUFDckQsaUJBQVc7QUFBQSxJQUNaLENBQUM7QUFFRCxhQUFTLGlCQUFpQixTQUFTLFVBQVU7QUFDN0MsWUFBUSxpQkFBaUIsU0FBUyxVQUFVO0FBRTVDLGFBQVMsS0FBSyxZQUFZLEtBQUs7QUFHL0IsUUFBSSx3QkFBTyxpREFBaUQsR0FBSTtBQUFBLEVBQ2pFO0FBQUE7QUFBQSxFQUdBLE1BQU0sZ0JBQWdCLEtBQTJCO0FBQ2hELFVBQU0sVUFBVSxNQUFNLEtBQUssU0FBUztBQUNwQyxXQUFPLFVBQVUsUUFBUSxHQUFHLElBQUk7QUFBQSxFQUNqQztBQUFBLEVBRUEsTUFBTSxnQkFBZ0IsS0FBYSxNQUEwQjtBQUM1RCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVMsS0FBSyxDQUFDO0FBQzFDLFlBQVEsR0FBRyxJQUFJO0FBQ2YsV0FBTyxNQUFNLEtBQUssU0FBUyxPQUFPO0FBQUEsRUFDbkM7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgImlzQ2F0YWx5c3QiLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJleGlzdGluZyIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0Il0KfQo=
