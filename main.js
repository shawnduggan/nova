/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian10 = require("obsidian");

// src/settings.ts
var import_obsidian6 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian5 = require("obsidian");

// src/core/multi-doc-context.ts
var import_obsidian = require("obsidian");
var MultiDocContextHandler = class {
  constructor(app) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.TOKEN_LIMIT = 8e3;
    this.WARNING_THRESHOLD = 0.8;
    this.app = app;
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Build complete context including persistent documents
   */
  async buildContext(message, currentFile, conversationData) {
    const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
    const existingPersistent = this.persistentContext.get(currentFile.path) || [];
    if (references.length > 0) {
      const updatedPersistent = [...existingPersistent];
      for (const ref of references) {
        const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(currentFile.path, updatedPersistent);
    }
    const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
    const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
      if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
        return false;
      }
      return true;
    });
    if (allPersistentDocs.length !== rawPersistentDocs.length) {
      if (allPersistentDocs.length > 0) {
        this.persistentContext.set(currentFile.path, allPersistentDocs);
      } else {
        this.persistentContext.delete(currentFile.path);
      }
    }
    const contextParts = [];
    const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
    if (currentFileContext) {
      contextParts.push(currentFileContext);
    }
    for (const docRef of allPersistentDocs) {
      const contextPart = await this.getDocumentContext(docRef);
      if (contextPart) {
        contextParts.push(contextPart);
      }
    }
    const contextString = contextParts.join("\n\n---\n\n");
    const tokenCount = this.estimateTokens(contextString);
    const isNearLimit = tokenCount > this.TOKEN_LIMIT * this.WARNING_THRESHOLD;
    return {
      cleanedMessage,
      context: {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit
      }
    };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian.TFile ? file : null;
  }
  /**
   * Clear persistent context for a conversation
   */
  clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    const percentage = Math.round(context.tokenCount / this.TOKEN_LIMIT * 100);
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens`;
    if (context.isNearLimit) {
      className += " nova-context-warning";
      tooltip += " (approaching limit)";
    }
    const text = `${docCount} docs ${percentage}%`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};

// src/ai/models.ts
function getAvailableModels(providerType, settings) {
  var _a, _b;
  switch (providerType) {
    case "claude":
      return [
        { value: "claude-opus-4-20250514", label: "Claude Opus 4" },
        { value: "claude-sonnet-4-20250514", label: "Claude Sonnet 4" },
        { value: "claude-3-7-sonnet-latest", label: "Claude 3.7 Sonnet" },
        { value: "claude-3-5-sonnet-latest", label: "Claude 3.5 Sonnet" },
        { value: "claude-3-5-sonnet-20241022", label: "Claude 3.5 Sonnet (Oct 22)" },
        { value: "claude-3-5-haiku-latest", label: "Claude 3.5 Haiku" }
      ];
    case "openai":
      return [
        { value: "gpt-4.1-2025-04-14", label: "GPT-4.1" },
        { value: "gpt-4.1-mini-2025-04-14", label: "GPT-4.1 Mini" },
        { value: "gpt-4.1-nano-2025-04-14", label: "GPT-4.1 Nano" },
        { value: "gpt-4o", label: "GPT-4o" },
        { value: "gpt-4o-mini", label: "GPT-4o Mini" }
      ];
    case "google":
      return [
        { value: "gemini-2.5-flash-preview-04-17", label: "Gemini 2.5 Flash" },
        { value: "gemini-2.5-pro-preview-03-25", label: "Gemini 2.5 Pro" },
        { value: "gemini-2.0-flash", label: "Gemini 2.0 Flash" },
        { value: "gemini-2.0-flash-lite", label: "Gemini 2.0 Flash-Lite" }
      ];
    case "ollama":
      const ollamaModel = (_b = (_a = settings == null ? void 0 : settings.aiProviders) == null ? void 0 : _a.ollama) == null ? void 0 : _b.model;
      if (ollamaModel && ollamaModel.trim()) {
        return [{ value: ollamaModel, label: ollamaModel }];
      }
      return [];
    default:
      return [];
  }
}

// src/ui/input-handler.ts
var import_obsidian2 = require("obsidian");

// src/ui/wikilink-suggest.ts
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea, container) {
    this.suggestionPopup = null;
    this.suggestions = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.currentQuery = "";
    this.currentTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.container = container || textArea.parentElement;
    this.setupEventListeners();
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
    this.textArea.addEventListener("keydown", this.handleKeydown.bind(this));
    this.textArea.addEventListener("blur", () => {
      setTimeout(() => this.hideSuggestions(), 150);
    });
    document.addEventListener("click", (e) => {
      if (this.suggestionPopup && !this.suggestionPopup.contains(e.target) && e.target !== this.textArea) {
        this.hideSuggestions();
      }
    });
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (linkMatch) {
      this.currentQuery = linkMatch[2] || "";
      this.currentTriggerPos = cursorPos - linkMatch[0].length;
      this.showSuggestions();
    } else {
      this.hideSuggestions();
    }
  }
  handleKeydown(e) {
    if (!this.isVisible) return;
    switch (e.key) {
      case "ArrowDown":
        e.preventDefault();
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);
        this.updateSelection();
        break;
      case "ArrowUp":
        e.preventDefault();
        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
        this.updateSelection();
        break;
      case "Enter":
      case "Tab":
        if (this.selectedIndex >= 0) {
          e.preventDefault();
          this.selectSuggestion(this.suggestions[this.selectedIndex]);
        }
        break;
      case "Escape":
        e.preventDefault();
        this.hideSuggestions();
        break;
    }
  }
  showSuggestions() {
    this.suggestions = this.getSuggestions(this.currentQuery);
    if (this.suggestions.length === 0) {
      this.hideSuggestions();
      return;
    }
    if (!this.suggestionPopup) {
      this.createSuggestionPopup();
    }
    this.renderSuggestions();
    this.positionPopup();
    this.isVisible = true;
    this.selectedIndex = -1;
  }
  hideSuggestions() {
    if (this.suggestionPopup) {
      this.suggestionPopup.style.display = "none";
    }
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  createSuggestionPopup() {
    this.suggestionPopup = document.createElement("div");
    this.suggestionPopup.className = "nova-wikilink-suggestions";
    this.suggestionPopup.style.cssText = `
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-bottom: 4px;
        `;
    this.container.appendChild(this.suggestionPopup);
  }
  renderSuggestions() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.innerHTML = "";
    this.suggestions.forEach((suggestion, index) => {
      const item = document.createElement("div");
      item.className = "nova-suggestion-item";
      item.style.cssText = `
                padding: 8px 12px;
                cursor: pointer;
                border-bottom: 1px solid var(--background-modifier-border-hover);
                transition: background-color 0.2s;
            `;
      const nameEl = document.createElement("div");
      nameEl.className = "nova-suggestion-name";
      nameEl.textContent = suggestion.file.basename;
      nameEl.style.cssText = `
                font-weight: 500;
                color: var(--text-normal);
                margin-bottom: 4px;
            `;
      item.appendChild(nameEl);
      const descEl = document.createElement("div");
      descEl.className = "nova-suggestion-desc";
      descEl.textContent = `Link to document in ${suggestion.file.path.includes("/") ? suggestion.file.path.substring(0, suggestion.file.path.lastIndexOf("/")) : "root"}`;
      descEl.style.cssText = `
                font-size: 0.85em;
                color: var(--text-muted);
                margin-bottom: 4px;
            `;
      item.appendChild(descEl);
      const exampleEl = document.createElement("div");
      exampleEl.className = "nova-suggestion-example";
      this.getFilePreview(suggestion.file).then((preview) => {
        exampleEl.textContent = `Preview: ${preview}`;
      });
      exampleEl.style.cssText = `
                font-size: 0.8em;
                color: var(--text-accent);
                font-family: var(--font-monospace);
            `;
      item.appendChild(exampleEl);
      this.suggestionPopup.appendChild(item);
      item.addEventListener("click", () => {
        this.selectSuggestion(suggestion);
      });
      item.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.suggestionPopup.style.display = "block";
  }
  updateSelection() {
    if (!this.suggestionPopup) return;
    const items = this.suggestionPopup.querySelectorAll(".nova-suggestion-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.backgroundColor = "var(--background-modifier-hover)";
      } else {
        element.style.backgroundColor = "";
      }
    });
  }
  positionPopup() {
    if (!this.suggestionPopup) return;
    this.suggestionPopup.style.position = "absolute";
    this.suggestionPopup.style.left = "0";
    this.suggestionPopup.style.right = "0";
    this.suggestionPopup.style.bottom = "100%";
    this.suggestionPopup.style.marginBottom = "4px";
  }
  selectSuggestion(suggestion) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/(\+)?\[\[([^\]]*?)$/);
    if (!linkMatch) return;
    const isPersistent = !!linkMatch[1];
    const startPos = cursorPos - linkMatch[0].length;
    const linkText = `[[${suggestion.file.basename}]]`;
    const replacement = isPersistent ? `+${linkText}` : linkText;
    const newText = text.substring(0, startPos) + replacement + text.substring(cursorPos);
    this.textArea.value = newText;
    const newCursorPos = startPos + replacement.length;
    this.textArea.setSelectionRange(newCursorPos, newCursorPos);
    this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    this.hideSuggestions();
    this.textArea.focus();
  }
  getSuggestions(query) {
    const files = this.app.vault.getMarkdownFiles();
    const suggestions = [];
    for (const file of files) {
      const score = this.scoreFile(file, query);
      if (score > 0) {
        suggestions.push({
          file,
          displayText: file.basename,
          score
        });
      }
    }
    return suggestions.sort((a, b) => b.score - a.score).slice(0, 8);
  }
  scoreFile(file, query) {
    if (!query) return 50;
    const basename = file.basename.toLowerCase();
    const path = file.path.toLowerCase();
    const queryLower = query.toLowerCase();
    if (basename === queryLower) return 100;
    if (basename.startsWith(queryLower)) return 80;
    if (basename.includes(queryLower)) return 60;
    if (path.includes(queryLower)) return 40;
    if (this.fuzzyMatch(basename, queryLower)) return 20;
    return 0;
  }
  fuzzyMatch(text, query) {
    let textIndex = 0;
    let queryIndex = 0;
    while (textIndex < text.length && queryIndex < query.length) {
      if (text[textIndex] === query[queryIndex]) {
        queryIndex++;
      }
      textIndex++;
    }
    return queryIndex === query.length;
  }
  async getFilePreview(file) {
    try {
      const content = await this.app.vault.read(file);
      let textContent = content;
      if (content.startsWith("---")) {
        const frontmatterEnd = content.indexOf("---", 3);
        if (frontmatterEnd !== -1) {
          textContent = content.substring(frontmatterEnd + 3);
        }
      }
      const plainText = textContent.replace(/^#+ /gm, "").replace(/\*\*(.*?)\*\*/g, "$1").replace(/\*(.*?)\*/g, "$1").replace(/\[(.*?)\]\(.*?\)/g, "$1").replace(/\n/g, " ").trim();
      return plainText.length > 50 ? plainText.substring(0, 50) + "..." : plainText || "Empty file";
    } catch (error) {
      return "Unable to load preview";
    }
  }
  destroy() {
    if (this.suggestionPopup) {
      this.suggestionPopup.remove();
    }
  }
};

// src/ui/section-picker.ts
var SectionPicker = class {
  constructor(app, documentEngine, container) {
    this.items = [];
    this.filteredItems = [];
    this.selectedIndex = -1;
    this.isVisible = false;
    this.app = app;
    this.documentEngine = documentEngine;
    this.container = container;
    this.createPicker();
  }
  createPicker() {
    this.pickerEl = document.createElement("div");
    this.pickerEl.className = "nova-section-picker";
    this.pickerEl.style.cssText = `
            position: absolute;
            bottom: 100%;
            left: 0;
            right: 0;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-bottom: 4px;
        `;
    this.pickerEl.empty = function() {
      this.innerHTML = "";
    };
    this.pickerEl.createDiv = function(options) {
      const div = document.createElement("div");
      if (options == null ? void 0 : options.cls) {
        div.className = options.cls;
      }
      this.appendChild(div);
      div.empty = function() {
        this.innerHTML = "";
      };
      div.createDiv = this.createDiv;
      div.createEl = function(tag, options2) {
        const el = document.createElement(tag);
        if (options2 == null ? void 0 : options2.text) el.textContent = options2.text;
        if (options2 == null ? void 0 : options2.cls) el.className = options2.cls;
        this.appendChild(el);
        return el;
      };
      return div;
    };
    this.pickerEl.createEl = function(tag, options) {
      const el = document.createElement(tag);
      if (options == null ? void 0 : options.text) el.textContent = options.text;
      if (options == null ? void 0 : options.cls) el.className = options.cls;
      this.appendChild(el);
      return el;
    };
    this.container.appendChild(this.pickerEl);
  }
  /**
   * Show the section picker with current document sections
   */
  async show(filterText = "") {
    await this.loadSections();
    this.applyFilter(filterText);
    this.render();
    this.pickerEl.style.display = "block";
    this.isVisible = true;
    this.selectedIndex = 0;
    this.updateSelection();
  }
  /**
   * Hide the section picker
   */
  hide() {
    this.pickerEl.style.display = "none";
    this.isVisible = false;
    this.selectedIndex = -1;
  }
  /**
   * Check if picker is currently visible
   */
  getIsVisible() {
    return this.isVisible;
  }
  /**
   * Load sections from current document
   */
  async loadSections() {
    try {
      const sectionPaths = await this.documentEngine.getAllSectionPaths();
      this.items = sectionPaths.map((section) => ({
        displayName: section.displayName,
        targetPath: section.targetPath,
        headingText: section.headingText,
        level: section.level,
        line: section.line,
        preview: section.preview
      }));
    } catch (error) {
      console.error("Failed to load sections:", error);
      this.items = [];
    }
  }
  /**
   * Apply filter to sections based on search text
   */
  applyFilter(filterText) {
    if (!filterText.trim()) {
      this.filteredItems = [...this.items];
      return;
    }
    const searchLower = filterText.toLowerCase();
    this.filteredItems = this.items.filter(
      (item) => item.headingText.toLowerCase().includes(searchLower) || item.targetPath.toLowerCase().includes(searchLower)
    );
  }
  /**
   * Render the picker items
   */
  render() {
    this.pickerEl.empty();
    if (this.filteredItems.length === 0) {
      const noResultsEl = this.pickerEl.createDiv({ cls: "nova-section-picker-no-results" });
      noResultsEl.style.cssText = `
                padding: 12px;
                text-align: center;
                color: var(--text-muted);
                font-size: 0.9em;
            `;
      noResultsEl.textContent = "No sections found";
      return;
    }
    this.filteredItems.forEach((item, index) => {
      const itemEl = this.pickerEl.createDiv({ cls: "nova-section-picker-item" });
      itemEl.style.cssText = `
                padding: 8px 12px;
                cursor: pointer;
                border-bottom: 1px solid var(--background-modifier-border-hover);
                transition: background-color 0.2s;
            `;
      const nameEl = document.createElement("div");
      nameEl.textContent = item.headingText;
      nameEl.style.cssText = `
                font-weight: 500;
                color: var(--text-normal);
                margin-bottom: 4px;
            `;
      itemEl.appendChild(nameEl);
      const descEl = document.createElement("div");
      descEl.textContent = `Navigate to section: ${item.targetPath}`;
      descEl.style.cssText = `
                font-size: 0.85em;
                color: var(--text-muted);
                margin-bottom: 4px;
            `;
      itemEl.appendChild(descEl);
      const exampleEl = document.createElement("div");
      const previewText = item.preview ? item.preview.substring(0, 50) + "..." : `Line ${item.line}`;
      exampleEl.textContent = `Preview: ${previewText}`;
      exampleEl.style.cssText = `
                font-size: 0.8em;
                color: var(--text-accent);
                font-family: var(--font-monospace);
            `;
      itemEl.appendChild(exampleEl);
      itemEl.addEventListener("click", () => {
        this.selectItem(index);
      });
      itemEl.addEventListener("mouseenter", () => {
        this.selectedIndex = index;
        this.updateSelection();
      });
    });
    this.updateSelection();
  }
  /**
   * Update visual selection state
   */
  updateSelection() {
    const items = this.pickerEl.querySelectorAll(".nova-section-picker-item");
    items.forEach((item, index) => {
      const element = item;
      if (index === this.selectedIndex) {
        element.style.background = "var(--background-modifier-hover)";
      } else {
        element.style.background = "transparent";
      }
    });
  }
  /**
   * Handle keyboard navigation
   */
  handleKeyDown(event) {
    if (!this.isVisible) return false;
    switch (event.key) {
      case "ArrowDown":
        this.selectedIndex = Math.min(this.selectedIndex + 1, this.filteredItems.length - 1);
        this.updateSelection();
        return true;
      case "ArrowUp":
        this.selectedIndex = Math.max(this.selectedIndex - 1, 0);
        this.updateSelection();
        return true;
      case "Enter":
        if (this.selectedIndex >= 0 && this.selectedIndex < this.filteredItems.length) {
          this.selectItem(this.selectedIndex);
        }
        return true;
      case "Escape":
        this.cancel();
        return true;
      default:
        return false;
    }
  }
  /**
   * Select a section by index
   */
  selectItem(index) {
    var _a;
    if (index >= 0 && index < this.filteredItems.length) {
      const item = this.filteredItems[index];
      this.hide();
      (_a = this.onSelectCallback) == null ? void 0 : _a.call(this, item.targetPath);
    }
  }
  /**
   * Cancel selection
   */
  cancel() {
    var _a;
    this.hide();
    (_a = this.onCancelCallback) == null ? void 0 : _a.call(this);
  }
  /**
   * Update filter and re-render
   */
  updateFilter(filterText) {
    this.applyFilter(filterText);
    this.render();
    this.selectedIndex = this.filteredItems.length > 0 ? 0 : -1;
    this.updateSelection();
  }
  /**
   * Set selection callback
   */
  onSelect(callback) {
    this.onSelectCallback = callback;
  }
  /**
   * Set cancel callback
   */
  onCancel(callback) {
    this.onCancelCallback = callback;
  }
  /**
   * Get current selected item
   */
  getSelectedItem() {
    if (this.selectedIndex >= 0 && this.selectedIndex < this.filteredItems.length) {
      return this.filteredItems[this.selectedIndex];
    }
    return null;
  }
  /**
   * Cleanup resources
   */
  cleanup() {
    this.hide();
    this.pickerEl.remove();
  }
};

// src/ui/input-handler.ts
var _InputHandler = class _InputHandler {
  constructor(plugin, container, contextManager) {
    // Event cleanup tracking
    this.eventListeners = [];
    this.plugin = plugin;
    this.container = container;
    this.contextManager = contextManager;
  }
  setCommandSystem(commandSystem) {
    this.commandSystem = commandSystem;
    const sendButtonEl = this.sendButton.buttonEl;
    sendButtonEl.remove();
    this.commandSystem.createCommandButton(this.inputRow);
    this.inputRow.appendChild(sendButtonEl);
    this.commandSystem.createCommandPickerInContainer(this.inputRow);
  }
  getTextArea() {
    return this.textArea;
  }
  createInputInterface(chatContainer) {
    this.container = this.container.createDiv({ cls: "nova-input-container" });
    this.container.style.cssText = `
			flex-shrink: 0;
			padding: var(--size-4-3);
			border-top: 1px solid var(--background-modifier-border);
			position: relative;
		`;
    this.inputRow = this.container.createDiv({ cls: "nova-input-row" });
    this.inputRow.style.cssText = `
			display: flex;
			gap: var(--size-2-3);
			align-items: center;
			position: relative;
		`;
    const textAreaContainer = this.inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian2.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("Ask Nova anything... (Shift+Enter for new line)");
    this.textArea.inputEl.style.cssText = `
			min-height: 80px;
			max-height: 200px;
			resize: none;
			overflow-y: auto;
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			border: 1px solid var(--background-modifier-border);
			background: var(--background-primary);
			color: var(--text-normal);
			font-family: var(--font-interface);
			font-size: var(--font-ui-medium);
			line-height: 1.4;
			width: 100%;
			box-sizing: border-box;
		`;
    this.autoGrowTextarea = () => {
      const textarea = this.textArea.inputEl;
      textarea.style.height = "auto";
      textarea.style.height = Math.min(textarea.scrollHeight, 200) + "px";
    };
    this.addEventListener(this.textArea.inputEl, "input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.plugin.app, this.textArea.inputEl, this.inputRow);
    this.sectionPicker = new SectionPicker(this.plugin.app, this.plugin.documentEngine, this.inputRow);
    this.setupSectionPickerCallbacks();
    this.addEventListener(this.textArea.inputEl, "input", () => {
      this.contextManager.updateLiveContextPreview(this.textArea.getValue());
    });
    this.sendButton = new import_obsidian2.ButtonComponent(this.inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
		`;
    this.addEventListener(this.textArea.inputEl, "keydown", (event) => {
      var _a, _b, _c, _d;
      const keyEvent = event;
      if (this.sectionPicker.handleKeyDown(keyEvent)) {
        event.preventDefault();
        return;
      }
      if (keyEvent.key === "Enter" && !keyEvent.shiftKey) {
        event.preventDefault();
        ((_a = this.commandSystem) == null ? void 0 : _a.handleCommandPickerSelection()) || false || this.handleSend();
      } else if (keyEvent.key === "Escape") {
        (_b = this.commandSystem) == null ? void 0 : _b.hideCommandPicker();
        this.sectionPicker.hide();
      } else if (keyEvent.key === "ArrowUp" || keyEvent.key === "ArrowDown") {
        if ((_c = this.commandSystem) == null ? void 0 : _c.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      } else if (keyEvent.key === "Tab") {
        if ((_d = this.commandSystem) == null ? void 0 : _d.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      }
    });
    this.addEventListener(this.textArea.inputEl, "input", () => {
      if (this.commandSystem) {
        this.commandSystem.handleInputChange();
      }
      this.handleSectionPickerInput();
    });
  }
  focus() {
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _InputHandler.FOCUS_DELAY_MS);
  }
  handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.textArea.setValue("");
    this.autoGrowTextarea();
    this.contextManager.hideContextPreview();
    (_a = this.onSendMessage) == null ? void 0 : _a.call(this, message);
  }
  setOnSendMessage(callback) {
    this.onSendMessage = callback;
  }
  getValue() {
    return this.textArea.getValue();
  }
  setValue(value) {
    this.textArea.setValue(value);
    this.autoGrowTextarea();
  }
  insertText(text) {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + text + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const newPosition = start + text.length;
    setTimeout(() => {
      textarea.setSelectionRange(newPosition, newPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  insertTextWithCursor(beforeCursor, afterCursor = "") {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + beforeCursor + afterCursor + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const cursorPosition = start + beforeCursor.length;
    setTimeout(() => {
      textarea.setSelectionRange(cursorPosition, cursorPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.eventListeners.push({ element, event, handler });
  }
  /**
   * Setup section picker callbacks
   */
  setupSectionPickerCallbacks() {
    this.sectionPicker.onSelect((path) => {
      this.handleSectionSelection(path);
    });
    this.sectionPicker.onCancel(() => {
      this.focus();
    });
  }
  /**
   * Handle section picker input changes
   */
  handleSectionPickerInput() {
    const input = this.textArea.getValue();
    const cursorPos = this.textArea.inputEl.selectionStart;
    const pathMatch = this.findPathTrigger(input, cursorPos);
    if (pathMatch) {
      this.sectionPicker.show(pathMatch.filterText).catch(console.error);
      if (pathMatch.filterText) {
        this.sectionPicker.updateFilter(pathMatch.filterText);
      }
    } else {
      this.sectionPicker.hide();
    }
  }
  /**
   * Find path trigger (/) in input relative to cursor position
   */
  findPathTrigger(input, cursorPos) {
    const beforeCursor = input.substring(0, cursorPos);
    const pathMatch = beforeCursor.match(/(?:^|\s)\/([^\/\s]*)$/);
    if (pathMatch) {
      const fullMatch = pathMatch[0];
      const filterText = pathMatch[1] || "";
      const start = cursorPos - fullMatch.length + (fullMatch.startsWith(" ") ? 1 : 0);
      return {
        start,
        filterText
      };
    }
    return null;
  }
  /**
   * Handle section selection from picker
   */
  handleSectionSelection(path) {
    const input = this.textArea.getValue();
    const cursorPos = this.textArea.inputEl.selectionStart;
    const pathMatch = this.findPathTrigger(input, cursorPos);
    if (pathMatch) {
      const beforeSlash = input.slice(0, pathMatch.start);
      const afterCursor = input.slice(cursorPos);
      const newValue = beforeSlash + path + afterCursor;
      this.textArea.setValue(newValue);
      const newCursorPos = pathMatch.start + path.length;
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(newCursorPos, newCursorPos);
        this.textArea.inputEl.focus();
      }, 0);
      this.autoGrowTextarea();
    }
  }
  refreshCommandButton() {
    if (this.commandSystem) {
      this.commandSystem.updateCommandButtonVisibility();
    }
  }
  cleanup() {
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.sectionPicker) {
      this.sectionPicker.cleanup();
    }
    this.eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.eventListeners = [];
  }
};
_InputHandler.FOCUS_DELAY_MS = 150;
var InputHandler = _InputHandler;

// src/ui/command-system.ts
var import_obsidian3 = require("obsidian");
var CommandSystem = class {
  constructor(plugin, container, textArea) {
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.plugin = plugin;
    this.container = container;
    this.textArea = textArea;
  }
  createCommandButton(inputRow) {
    this.commandButton = new import_obsidian3.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: var(--size-2-3);
		`;
    return this.commandButton;
  }
  createCommandPicker() {
    this.createCommandPickerInContainer(this.container);
  }
  createCommandPickerInContainer(container) {
    this.commandPicker = container.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			margin-bottom: 4px;
		`;
  }
  shouldShowCommandButton() {
    return this.plugin.settings.showCommandButton && this.plugin.featureManager.isFeatureEnabled("commands");
  }
  updateCommandButtonVisibility() {
    if (this.commandButton) {
      const shouldShow = this.shouldShowCommandButton();
      this.commandButton.buttonEl.style.display = shouldShow ? "flex" : "none";
    }
  }
  toggleCommandMenu() {
    if (!this.commandMenu) {
      this.createCommandMenu();
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  createCommandMenu() {
    this.commandMenu = this.container.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			box-shadow: var(--shadow-s);
			min-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			padding: var(--size-2-2);
		`;
    const commands = [
      { name: "Improve Writing", description: "Enhance clarity and flow", command: "/improve" },
      { name: "Fix Grammar", description: "Correct grammar and spelling", command: "/grammar" },
      { name: "Summarize", description: "Create a concise summary", command: "/summarize" },
      { name: "Expand Ideas", description: "Develop thoughts further", command: "/expand" },
      { name: "Explain", description: "Clarify complex concepts", command: "/explain" },
      { name: "Continue Writing", description: "Extend the current text", command: "/continue" }
    ];
    const title = this.commandMenu.createEl("div", { text: "Quick Commands" });
    title.style.cssText = `
			font-size: var(--font-ui-medium);
			font-weight: 600;
			margin-bottom: var(--size-2-3);
			color: var(--text-normal);
		`;
    commands.forEach((cmd) => {
      const cmdEl = this.commandMenu.createDiv({ cls: "nova-command-item" });
      cmdEl.style.cssText = `
				padding: var(--size-2-2) var(--size-2-3);
				border-radius: var(--radius-xs);
				cursor: pointer;
				margin-bottom: var(--size-2-1);
				transition: background-color 0.1s;
			`;
      const nameEl = cmdEl.createEl("div", { text: cmd.name });
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
				margin-bottom: var(--size-2-1);
			`;
      const descEl = cmdEl.createEl("div", { text: cmd.description });
      descEl.style.cssText = `
				font-size: var(--font-ui-smaller);
				color: var(--text-muted);
			`;
      cmdEl.addEventListener("click", () => {
        this.textArea.setValue(cmd.command + " ");
        this.textArea.inputEl.focus();
        this.hideCommandMenu();
      });
      cmdEl.addEventListener("mouseenter", () => {
        cmdEl.style.background = "var(--background-modifier-hover)";
      });
      cmdEl.addEventListener("mouseleave", () => {
        cmdEl.style.background = "transparent";
      });
    });
  }
  showCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "block";
      this.isCommandMenuVisible = true;
    }
  }
  hideCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "none";
      this.isCommandMenuVisible = false;
    }
  }
  handleInputChange() {
    if (!this.textArea) {
      return;
    }
    const input = this.textArea.getValue();
    if (input.startsWith(":")) {
      this.showStructuredCommandPicker(input);
    } else {
      this.hideCommandPicker();
    }
  }
  /**
   * Show structured command picker for ":" trigger  
   */
  showStructuredCommandPicker(input) {
    if (!this.commandPicker) {
      return;
    }
    const structuredCommands = this.getStructuredCommands();
    const filterText = input.slice(1).toLowerCase();
    const filtered = structuredCommands.filter(
      (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
    );
    this.commandPickerItems = [];
    this.commandPicker.empty();
    this.selectedCommandIndex = -1;
    if (filtered.length > 0) {
      filtered.forEach((cmd, index) => {
        const item = this.commandPicker.createDiv({ cls: "nova-command-picker-item" });
        item.style.cssText = `
					padding: 8px 12px;
					cursor: pointer;
					border-bottom: 1px solid var(--background-modifier-border-hover);
					transition: background-color 0.2s;
				`;
        const nameEl = item.createEl("div", { text: cmd.name });
        nameEl.style.cssText = `
					font-weight: 500;
					color: var(--text-normal);
					margin-bottom: 4px;
				`;
        const descEl = item.createEl("div", { text: cmd.description });
        descEl.style.cssText = `
					font-size: 0.85em;
					color: var(--text-muted);
					margin-bottom: 4px;
				`;
        const exampleEl = item.createEl("div", { text: `Example: ${cmd.example}` });
        exampleEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-accent);
					font-family: var(--font-monospace);
				`;
        item.addEventListener("click", () => {
          this.selectStructuredCommand(cmd.template);
        });
        item.addEventListener("mouseenter", () => {
          this.selectedCommandIndex = index;
          this.updateCommandPickerSelection();
        });
        this.commandPickerItems.push(item);
      });
      this.commandPicker.style.display = "block";
    } else {
      this.hideCommandPicker();
    }
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
  }
  handleCommandPickerNavigation(key) {
    if (this.commandPickerItems.length === 0) return false;
    if (key === "ArrowDown") {
      this.selectedCommandIndex = Math.min(this.selectedCommandIndex + 1, this.commandPickerItems.length - 1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "ArrowUp") {
      this.selectedCommandIndex = Math.max(this.selectedCommandIndex - 1, -1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "Tab" && this.selectedCommandIndex >= 0) {
      return this.handleCommandPickerSelection();
    }
    return false;
  }
  handleCommandPickerSelection() {
    if (this.selectedCommandIndex >= 0 && this.commandPickerItems.length > 0) {
      const commands = this.getStructuredCommands();
      const input = this.textArea.getValue();
      if (input.startsWith(":")) {
        const filterText = input.slice(1).toLowerCase();
        const filtered = commands.filter(
          (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
        );
        if (this.selectedCommandIndex < filtered.length) {
          const selectedCmd = filtered[this.selectedCommandIndex];
          this.selectStructuredCommand(selectedCmd.template);
          return true;
        }
      }
    }
    return false;
  }
  updateCommandPickerSelection() {
    this.commandPickerItems.forEach((item, index) => {
      if (index === this.selectedCommandIndex) {
        item.style.background = "var(--background-modifier-hover)";
      } else {
        item.style.background = "transparent";
      }
    });
  }
  selectCommand(command) {
    this.textArea.setValue(command + " ");
    this.textArea.inputEl.focus();
    const length = this.textArea.getValue().length;
    this.textArea.inputEl.setSelectionRange(length, length);
    this.hideCommandPicker();
  }
  /**
   * Get structured commands for ":" trigger
   */
  getStructuredCommands() {
    return [
      {
        name: "Add Section",
        description: "Add a new section to the document",
        command: "add section",
        template: 'add section "{cursor}"',
        example: ':add section "Results"',
        keywords: ["create", "new", "heading"]
      },
      {
        name: "Edit Section",
        description: "Edit content in a specific section",
        command: "edit section",
        template: "edit {cursor} section",
        example: ":edit Methods section",
        keywords: ["modify", "update", "change"]
      },
      {
        name: "Delete Section",
        description: "Remove a section from the document",
        command: "delete section",
        template: "delete {cursor} section",
        example: ":delete Introduction section",
        keywords: ["remove", "eliminate"]
      },
      {
        name: "Append To",
        description: "Add content to the end of a section",
        command: "append to",
        template: "append {cursor} to /",
        example: ":append conclusion to /Results",
        keywords: ["add", "attach", "end"]
      },
      {
        name: "Prepend To",
        description: "Add content to the beginning of a section",
        command: "prepend to",
        template: "prepend {cursor} to /",
        example: ":prepend warning to /Methods",
        keywords: ["add", "beginning", "start"]
      },
      {
        name: "Insert After",
        description: "Insert content after a section heading",
        command: "insert after",
        template: "insert {cursor} after / heading",
        example: ":insert diagram after /Methods heading",
        keywords: ["add", "place", "after"]
      },
      {
        name: "Insert Before",
        description: "Insert content before a section heading",
        command: "insert before",
        template: "insert {cursor} before / heading",
        example: ":insert note before /Results heading",
        keywords: ["add", "place", "before"]
      }
    ];
  }
  /**
   * Select a structured command and insert template
   */
  selectStructuredCommand(template) {
    this.hideCommandPicker();
    const cursorPos = template.indexOf("{cursor}");
    if (cursorPos !== -1) {
      const beforeCursor = template.slice(0, cursorPos);
      const afterCursor = template.slice(cursorPos + 8);
      this.textArea.setValue(beforeCursor + afterCursor);
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(cursorPos, cursorPos);
        this.textArea.inputEl.focus();
      }, 0);
    } else {
      this.textArea.setValue(template);
      this.textArea.inputEl.focus();
    }
  }
  cleanup() {
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.remove();
    }
  }
};

// src/ui/context-manager.ts
var import_obsidian4 = require("obsidian");
var _ContextManager = class _ContextManager {
  constructor(plugin, app, container) {
    this.currentContext = null;
    this.plugin = plugin;
    this.app = app;
    this.container = container;
    this.multiDocHandler = new MultiDocContextHandler(app);
  }
  createContextIndicator() {
    this.contextIndicator = this.container.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			position: absolute;
			top: -2px;
			right: var(--size-4-3);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-1) var(--size-2-2);
			font-size: var(--font-ui-smaller);
			color: var(--text-muted);
			display: none;
			z-index: 100;
			max-width: 200px;
			box-shadow: var(--shadow-s);
		`;
  }
  createContextPreview() {
    const previewContainer = this.container.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			margin-bottom: var(--size-2-2);
			font-size: var(--font-ui-small);
			display: none;
		`;
    const previewLabel = previewContainer.createSpan({ text: "Context: " });
    previewLabel.style.cssText = "color: var(--text-muted); font-weight: 600;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview(message) {
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      foundRefs.push({ name: docName, property });
    }
    if (foundRefs.length === 0) {
      this.contextPreview.style.display = "none";
      return;
    }
    const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
    if (previewList) {
      const refsText = foundRefs.map(
        (ref) => ref.property ? `${ref.name}#${ref.property}` : ref.name
      ).join(", ");
      previewList.textContent = refsText;
    }
    this.contextPreview.style.display = "block";
  }
  async buildContext(message, currentFile) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context") || !currentFile) {
      return null;
    }
    try {
      const result = await this.multiDocHandler.buildContext(message, currentFile);
      this.currentContext = result.context;
      if ((_a = result.context) == null ? void 0 : _a.persistentDocs.length) {
        this.updateContextIndicator(result.context);
        if (result.context.isNearLimit) {
          new import_obsidian4.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _ContextManager.NOTICE_DURATION_MS);
        }
      }
      return result.context;
    } catch (error) {
      return null;
    }
  }
  updateContextIndicator(context) {
    if (!this.contextIndicator) return;
    const docCount = context.persistentDocs.length;
    if (docCount > 0) {
      this.contextIndicator.textContent = `${docCount} doc${docCount > 1 ? "s" : ""}`;
      this.contextIndicator.style.display = "block";
      this.contextIndicator.style.cursor = "pointer";
      this.contextIndicator.onclick = () => {
        this.showContextDetails(context);
      };
      this.contextIndicator.addEventListener("mouseenter", () => {
        this.contextIndicator.style.background = "var(--interactive-hover)";
      });
      this.contextIndicator.addEventListener("mouseleave", () => {
        this.contextIndicator.style.background = "var(--background-primary)";
      });
    } else {
      this.contextIndicator.style.display = "none";
    }
  }
  showContextDetails(context) {
    const modal = this.container.createDiv({ cls: "nova-context-modal" });
    modal.style.cssText = `
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 10000;
		`;
    const content = modal.createDiv();
    content.style.cssText = `
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-4-4);
			max-width: 80%;
			max-height: 80%;
			overflow-y: auto;
			box-shadow: var(--shadow-s);
		`;
    const header = content.createEl("h3", { text: "Context Documents" });
    header.style.cssText = "margin-top: 0; margin-bottom: var(--size-4-3);";
    context.persistentDocs.forEach((doc) => {
      const docEl = content.createDiv();
      docEl.style.cssText = `
				padding: var(--size-2-2);
				margin-bottom: var(--size-2-2);
				background: var(--background-modifier-hover);
				border-radius: var(--radius-xs);
			`;
      const nameEl = docEl.createEl("div", { text: doc.file.basename });
      nameEl.style.cssText = "font-weight: 600; margin-bottom: var(--size-2-1);";
      if (doc.property) {
        const propEl = docEl.createEl("div", { text: `Property: ${doc.property}` });
        propEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted);";
      }
      const previewEl = docEl.createEl("div", { text: doc.file.path });
      previewEl.style.cssText = "font-size: var(--font-ui-smaller); color: var(--text-muted); margin-top: var(--size-2-1);";
    });
    const closeBtn = content.createEl("button", { text: "Close" });
    closeBtn.style.cssText = `
			margin-top: var(--size-4-3);
			padding: var(--size-2-2) var(--size-4-3);
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
			border-radius: var(--radius-s);
			cursor: pointer;
		`;
    closeBtn.onclick = () => modal.remove();
    modal.onclick = (e) => {
      if (e.target === modal) modal.remove();
    };
  }
  hideContextPreview() {
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
  }
  hideContextIndicator() {
    if (this.contextIndicator) {
      this.contextIndicator.style.display = "none";
    }
  }
  clearCurrentContext() {
    this.currentContext = null;
    this.hideContextIndicator();
    this.hideContextPreview();
  }
  getCurrentContext() {
    return this.currentContext;
  }
  cleanup() {
    this.clearCurrentContext();
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.contextPreview) {
      this.contextPreview.remove();
    }
  }
};
_ContextManager.NOTICE_DURATION_MS = 5e3;
var ContextManager = _ContextManager;

// src/ui/chat-renderer.ts
var _ChatRenderer = class _ChatRenderer {
  constructor(plugin, chatContainer) {
    this.plugin = plugin;
    this.chatContainer = chatContainer;
  }
  /**
   * Add a chat message with role header
   */
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom(true);
  }
  /**
   * Helper method to create simple messages without role headers
   */
  createSimpleMessage(content, className) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${className}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom();
  }
  addErrorMessage(content) {
    this.createSimpleMessage(content, "nova-message-error");
  }
  addSuccessMessage(content) {
    this.createSimpleMessage(content, "nova-message-success");
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			padding: var(--size-4-4);
			margin-bottom: var(--size-4-3);
			background: var(--background-modifier-hover);
			border-radius: var(--radius-s);
			border: 1px solid var(--background-modifier-border);
			text-align: center;
			position: relative;
		`;
    const content = message || `
			<div style="display: flex; align-items: center; justify-content: center; gap: var(--size-2-3); margin-bottom: var(--size-4-2);">
				<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size-xl); height: var(--icon-size-xl); color: var(--interactive-accent);">
					<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
					<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				</svg>
				<span style="font-size: var(--font-ui-large); font-weight: 600; color: var(--text-normal);">Welcome to Nova</span>
			</div>
			<p style="margin: 0 0 var(--size-4-3) 0; color: var(--text-muted); font-size: var(--font-ui-medium);">
				Your AI thinking partner for Obsidian. Start a conversation or use commands to enhance your writing.
			</p>
			<p style="margin: 0; color: var(--text-faint); font-size: var(--font-ui-small);">
				\u{1F4A1} <strong>Tip:</strong> Reference other notes with [[Note Name]] or use the \u26A1 button for quick commands
			</p>
		`;
    welcomeEl.innerHTML = content;
    const dismissBtn = welcomeEl.createEl("button");
    dismissBtn.textContent = "\xD7";
    dismissBtn.style.cssText = `
			position: absolute;
			top: var(--size-2-2);
			right: var(--size-2-2);
			background: none;
			border: none;
			font-size: var(--font-ui-large);
			color: var(--text-faint);
			cursor: pointer;
			padding: var(--size-2-1);
			border-radius: var(--radius-xs);
		`;
    dismissBtn.addEventListener("click", () => {
      welcomeEl.remove();
    });
    dismissBtn.addEventListener("mouseenter", () => {
      dismissBtn.style.color = "var(--text-normal)";
      dismissBtn.style.background = "var(--background-modifier-hover)";
    });
    dismissBtn.addEventListener("mouseleave", () => {
      dismissBtn.style.color = "var(--text-faint)";
      dismissBtn.style.background = "none";
    });
    this.scrollToBottom(true);
  }
  clearChat() {
    this.chatContainer.empty();
  }
  scrollToBottom(smooth = false) {
    setTimeout(() => {
      if (smooth) {
        this.chatContainer.scrollTo({
          top: this.chatContainer.scrollHeight,
          behavior: "smooth"
        });
      } else {
        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
      }
    }, _ChatRenderer.SCROLL_DELAY_MS);
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
    for (const message of messages) {
      this.addMessage(message.role, message.content);
    }
  }
};
_ChatRenderer.SCROLL_DELAY_MS = 50;
var ChatRenderer = _ChatRenderer;

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var _NovaSidebarView = class _NovaSidebarView extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.currentContext = null;
    // Command system compatibility - stub out old methods
    this._commandPickerItems = [];
    this._selectedCommandIndex = -1;
    this._isCommandMenuVisible = false;
    // Performance optimization - debouncing and timing constants
    this.contextPreviewDebounceTimeout = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
    this.multiDocHandler = new MultiDocContextHandler(this.app);
  }
  // Legacy compatibility delegates - Forward to new architecture
  get textArea() {
    var _a;
    return (_a = this.inputHandler) == null ? void 0 : _a.getTextArea();
  }
  get wikilinkAutocomplete() {
    return this.inputHandler ? { destroy: () => {
    } } : null;
  }
  get autoGrowTextarea() {
    return () => {
    };
  }
  get commandPickerItems() {
    return this._commandPickerItems;
  }
  set commandPickerItems(value) {
    this._commandPickerItems = value;
  }
  get selectedCommandIndex() {
    return this._selectedCommandIndex;
  }
  set selectedCommandIndex(value) {
    this._selectedCommandIndex = value;
  }
  get isCommandMenuVisible() {
    return this._isCommandMenuVisible;
  }
  set isCommandMenuVisible(value) {
    this._isCommandMenuVisible = value;
  }
  // Context system compatibility - forward to ContextManager
  get contextPreview() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextPreview;
  }
  get contextIndicator() {
    var _a;
    return this._contextIndicator || ((_a = this.contextManager) == null ? void 0 : _a.contextIndicator);
  }
  set contextIndicator(value) {
    this._contextIndicator = value;
  }
  // Stub out old DOM elements that should no longer be used
  get commandPicker() {
    return null;
  }
  set commandPicker(value) {
  }
  get commandMenu() {
    return null;
  }
  set commandMenu(value) {
  }
  get commandButton() {
    return null;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova AI";
  }
  getIcon() {
    return "nova-star";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian5.Platform.isDesktopApp ? "var(--size-4-6)" : "var(--size-4-5)"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: var(--size-4-2);
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const titleEl = headerEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: var(--font-ui-medium); display: flex; align-items: center; gap: var(--size-2-2);";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size); height: var(--icon-size);">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = headerEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: var(--size-2-3);";
    const privacyIndicator = rightContainer.createSpan({ cls: "nova-privacy-indicator" });
    privacyIndicator.style.cssText = `
			display: flex;
			align-items: center;
			padding: 4px;
			color: var(--icon-color);
			font-weight: var(--font-weight-medium);
		`;
    this.updatePrivacyIndicator(privacyIndicator);
    this.privacyIndicator = privacyIndicator;
    this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian5.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.loadConversationForActiveFile();
    setTimeout(() => this.refreshProviderStatus(), 100);
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _NovaSidebarView.FOCUS_DELAY_MS);
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
      this.contextPreviewDebounceTimeout = null;
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: var(--size-4-2);
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: var(--size-2-3);
		`;
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements using new architecture
   */
  createInputArea() {
    this.inputContainer.empty();
    this.contextManager = new ContextManager(this.plugin, this.app, this.inputContainer);
    this.chatRenderer = new ChatRenderer(this.plugin, this.chatContainer);
    this.inputHandler = new InputHandler(this.plugin, this.inputContainer, this.contextManager);
    this.inputHandler.createInputInterface(this.chatContainer);
    this.commandSystem = new CommandSystem(this.plugin, this.inputContainer, this.inputHandler.getTextArea());
    this.inputHandler.setCommandSystem(this.commandSystem);
    this.inputHandler.setOnSendMessage((message) => {
      this.handleSend(message);
    });
    this.contextManager.createContextIndicator();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  /**
   * Helper method to create simple messages without role headers
   */
  createSimpleMessage(content, className) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${className}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  addErrorMessage(content) {
    this.createSimpleMessage(content, "nova-message-error");
  }
  addSuccessMessage(content) {
    this.createSimpleMessage(content, "nova-message-success");
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			display: flex;
			align-items: center;
			gap: var(--size-4-3);
			margin: var(--size-4-4) auto;
			padding: var(--size-4-4) var(--size-4-5);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-l);
			max-width: 90%;
			animation: fadeIn 0.5s ease-in;
		`;
    const iconContainer = welcomeEl.createDiv({ cls: "nova-welcome-icon" });
    iconContainer.style.cssText = `
			position: relative;
			width: var(--icon-size-xl);
			height: var(--icon-size-xl);
			flex-shrink: 0;
		`;
    iconContainer.innerHTML = `
			<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size-xl); height: var(--icon-size-xl); color: var(--interactive-accent);">
				<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
				<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
				<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			</svg>
		`;
    const textContainer = welcomeEl.createDiv();
    textContainer.style.cssText = `
			flex: 1;
			line-height: 1.4;
		`;
    const titleEl = textContainer.createDiv({ text: "Hi! I'm Nova." });
    titleEl.style.cssText = `
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
			font-size: var(--font-text-size);
		`;
    const subtitleEl = textContainer.createDiv({ text: message || "" });
    subtitleEl.style.cssText = `
			color: var(--text-muted);
			font-size: 0.9em;
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  addSuccessIndicator(action) {
    const indicatorEl = this.chatContainer.createDiv({ cls: "nova-success-indicator" });
    indicatorEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 8px auto;
			padding: 6px 12px;
			background: rgba(76, 175, 80, 0.1);
			border: 1px solid rgba(76, 175, 80, 0.3);
			border-radius: 16px;
			font-size: 0.8em;
			color: var(--text-muted);
			max-width: 200px;
			animation: fadeIn 0.3s ease-in;
		`;
    indicatorEl.innerHTML = `
			<div style="width: 12px; height: 12px; margin-right: 6px; border-radius: 50%; background: var(--text-success); display: flex; align-items: center; justify-content: center;">
				<div style="width: 4px; height: 2px; border-left: 1px solid white; border-bottom: 1px solid white; transform: rotate(-45deg) translate(-0.5px, -0.5px);"></div>
			</div>
			${this.getCompactSuccessMessage(action)}
		`;
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  getCompactSuccessMessage(action) {
    switch (action) {
      case "add":
        return "Content added";
      case "edit":
        return "Content edited";
      case "delete":
        return "Content deleted";
      case "grammar":
        return "Grammar fixed";
      case "rewrite":
        return "Content rewritten";
      default:
        return "Command completed";
    }
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addMessage("system", this.createIconMessage("zap", "Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025."));
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentProvider(providerId);
      await this.plugin.saveSettings();
      this.addSuccessMessage(this.createIconMessage("refresh-cw", `Switched to ${this.getProviderWithModelDisplayName(providerId)}`));
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.textArea.setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addMessage("system", this.createIconMessage("edit", `Loaded template: ${customCommand.name}`));
        return true;
      }
    }
    this.addErrorMessage(this.createIconMessage("help-circle", `Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`));
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker nova-panel-base" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.textArea.getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("commands")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item nova-panel-item" });
      const triggerEl = item.createSpan({ cls: "nova-command-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      const nameEl = item.createSpan({ cls: "nova-command-name nova-panel-text" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1;";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.removeClass("selected");
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].addClass("selected");
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.textArea.setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    const commands = [
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" }
    ];
    if (import_obsidian5.Platform.isDesktopApp) {
      commands.push({ trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" });
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      customCommands.forEach((cmd) => {
        commands.push({
          trigger: cmd.trigger,
          name: cmd.name,
          ...cmd.description && { description: cmd.description }
        });
      });
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu nova-panel-base" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addMessage("system", this.createIconMessage("zap", "Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025."));
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header nova-panel-header" });
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item nova-panel-item-vertical" });
      const nameEl = item.createDiv({ cls: "nova-command-menu-name nova-panel-text" });
      nameEl.textContent = command.name;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.opacity = "0.8";
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  executeCommandFromMenu(trigger) {
    this.hideCommandMenu();
    this.textArea.setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextIndicator() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    this.contextIndicator = this.inputContainer.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 8px;
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			font-size: 0.85em;
			color: var(--text-muted);
			transition: all 0.2s ease;
		`;
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  /**
   * Debounced version of updateLiveContextPreview for performance
   */
  debouncedUpdateContextPreview() {
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
    }
    this.contextPreviewDebounceTimeout = setTimeout(() => {
      this.updateLiveContextPreview();
      this.contextPreviewDebounceTimeout = null;
    }, _NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS);
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.textArea.getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.multiDocHandler.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian5.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian5.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian5.TFile ? file : null;
  }
  updateContextIndicator() {
    if (!this.contextIndicator) {
      return;
    }
    this.contextIndicator.empty();
    if (!this.currentContext) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      return;
    }
    const isMobile = import_obsidian5.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: block;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const tokenPercent = Math.round(this.currentContext.tokenCount / 8e3 * 100);
    const docNames = allDocs.map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px;";
    if (isMobile) {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}%)`;
    } else {
      summaryTextEl.innerHTML = this.createInlineIcon("book-open") + ` ${docNames.join(", ")}${moreCount} (${tokenPercent}% tokens)`;
    }
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian5.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("eraser").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				margin-left: 6px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.innerHTML = this.createInlineIcon("x", isMobile ? "18px" : "14px");
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: bold;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.multiDocHandler.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    let isExpanded = false;
    const toggleExpanded = (e) => {
      e.stopPropagation();
      isExpanded = !isExpanded;
      if (isExpanded) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    const closeHandler = (e) => {
      if (isExpanded && !this.contextIndicator.contains(e.target)) {
        isExpanded = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    this.addTrackedEventListener(document, "click", closeHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      const result = await this.multiDocHandler.buildContext("", this.currentFile);
      this.currentContext = result.context;
      this.updateContextIndicator();
    }
  }
  async handleSend(message) {
    var _a, _b;
    const messageText = message || this.inputHandler.getValue().trim();
    if (!messageText) return;
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (!currentProviderType) {
      this.addErrorMessage(this.createIconMessage("alert-circle", "Nova is disabled or no AI provider is available. Please configure an AI provider in settings."));
      return;
    }
    if (messageText.startsWith(":")) {
      const commandResult = await this.handleColonCommand(messageText);
      if (commandResult) {
        this.inputHandler.setValue("");
        return;
      }
    }
    let processedMessage = messageText;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (messageText.includes("[[") || messageText.includes("+[[")) {
          this.addMessage("system", this.createIconMessage("book-open", "Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025."));
          return;
        }
      } else {
        const contextResult = await this.multiDocHandler.buildContext(messageText, this.currentFile);
        processedMessage = contextResult.cleanedMessage;
        multiDocContext = contextResult.context;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_a = this.currentContext) == null ? void 0 : _a.persistentDocs.length) || 0;
        const currentPersistentCount = multiDocContext.persistentDocs.length;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.map((doc) => doc.file.basename).join(", ");
            this.addSuccessMessage(this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
          }
          this.inputHandler.setValue("");
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if (multiDocContext.persistentDocs.length > 0) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.map((doc) => doc.file.basename).join(", ");
          const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
          const currentFile = ((_b = this.currentFile) == null ? void 0 : _b.basename) || "current file";
          this.addMessage("system", this.createIconMessage("book-open", `Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`));
        }
        if (multiDocContext.isNearLimit) {
          new import_obsidian5.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _NovaSidebarView.NOTICE_DURATION_MS);
        }
      }
    }
    this.addMessage("user", messageText);
    this.inputHandler.setValue("");
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(true);
    try {
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const textEl = loadingEl.createSpan({ text: "Nova is thinking..." });
      textEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.documentEngine.addUserMessage(messageText);
      }
      const isLikelyCommand = this.plugin.promptBuilder["isLikelyCommand"](processedMessage);
      let response = null;
      if (isLikelyCommand && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedUserPrompt = `${multiDocContext.contextString}

---

User Request: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      loadingEl.remove();
      const filteredResponse = response ? this.filterThinkingContent(response) : response;
      if (activeFile && filteredResponse) {
        await this.plugin.documentEngine.addAssistantMessage(filteredResponse);
      }
      if (filteredResponse) {
        if (filteredResponse.includes("x-circle") || filteredResponse.includes("Error executing command") || filteredResponse.includes("Failed to") || filteredResponse.includes("No markdown file is open") || filteredResponse.includes("Unable to access") || filteredResponse.includes("Unable to set")) {
          this.addErrorMessage(filteredResponse);
        } else {
          this.addMessage("assistant", filteredResponse);
        }
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) loadingEl.remove();
      this.addErrorMessage(this.createIconMessage("x-circle", `Sorry, I encountered an error: ${error.message}`));
    } finally {
      const sendButton2 = this.inputHandler.sendButton;
      if (sendButton2) sendButton2.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: true });
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      let result;
      switch (command.action) {
        case "add":
          result = await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          result = await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          result = await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        return `Failed to ${command.action}: ${result.error}`;
      }
    } catch (error) {
      return this.createIconMessage("x-circle", `Error executing command: ${error.message}`);
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian5.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      this.currentFile = null;
      this.chatContainer.empty();
      this.refreshContext();
      this.addWelcomeMessage("Open a document to get started.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.currentFile = targetFile;
    this.chatContainer.empty();
    await this.refreshContext();
    try {
      const recentMessages = await this.plugin.conversationManager.getRecentMessages(targetFile, 10);
      if (recentMessages.length > 0) {
        recentMessages.forEach((msg) => {
          if (msg.role !== "system") {
            this.addMessage(msg.role, msg.content);
          }
        });
      } else {
        this.addWelcomeMessage(`Working on "${targetFile.basename}".`);
      }
    } catch (error) {
      this.addWelcomeMessage(`Working on "${targetFile.basename}".`);
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.multiDocHandler.clearPersistentContext(this.currentFile.path);
        this.currentContext = null;
        if (this.contextIndicator) {
          this.contextIndicator.style.display = "none";
        }
      } catch (error) {
      }
    }
    if (this.currentFile) {
      this.addWelcomeMessage(`Chat cleared.`);
    } else {
      this.addWelcomeMessage("Chat cleared.");
    }
    new import_obsidian5.Notice("Chat history cleared");
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, message, null);
      }
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  async loadConversationHistory(file) {
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
  }
  /**
   * Update send button enabled/disabled state based on provider availability
   */
  async updateSendButtonState() {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(!currentProviderType);
  }
  /**
   * Update privacy indicator icon and tooltip based on current provider
   */
  async updatePrivacyIndicator(privacyIndicator) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (currentProviderType) {
      const isLocalProvider = currentProviderType === "ollama";
      const iconName = isLocalProvider ? "lock" : "unlock";
      const tooltip = isLocalProvider ? "Local processing - data stays on your device" : "Cloud processing - data sent to provider";
      (0, import_obsidian5.setIcon)(privacyIndicator, iconName);
      privacyIndicator.setAttribute("aria-label", tooltip);
      privacyIndicator.setAttribute("title", tooltip);
    } else {
      (0, import_obsidian5.setIcon)(privacyIndicator, "help-circle");
      privacyIndicator.setAttribute("aria-label", "No provider selected");
      privacyIndicator.setAttribute("title", "No provider selected");
    }
  }
  /**
   * Filter thinking content from AI responses
   * Removes content between <think>/<thinking> and </think>/<thinking> tags
   */
  filterThinkingContent(content) {
    return content.replace(/<think(?:ing)?[\s\S]*?<\/think(?:ing)?>/gi, "").trim();
  }
  /**
   * Refresh all provider status indicators in the UI
   */
  async refreshProviderStatus() {
    var _a;
    if (this.privacyIndicator) {
      await this.updatePrivacyIndicator(this.privacyIndicator);
    }
    this.updateSendButtonState();
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      await this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-normal);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const providerName = providerButton.createSpan({ text: "Loading..." });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 150px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow: hidden;
		`;
    let isDropdownOpen = false;
    const updateCurrentProvider = async () => {
      const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
      if (currentProviderType) {
        const displayText = this.getProviderWithModelDisplayName(currentProviderType);
        providerName.setText(displayText);
      } else {
        const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
        providerName.setText(currentProviderName);
      }
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Get available models for a provider type
   */
  getAvailableModels(providerType) {
    return getAvailableModels(providerType, this.plugin.settings);
  }
  /**
   * Get current model for a provider type
   */
  getCurrentModel(providerType) {
    var _a;
    const providers = this.plugin.settings.aiProviders;
    const currentModel = (_a = providers[providerType]) == null ? void 0 : _a.model;
    if (currentModel) {
      return currentModel;
    }
    const availableModels = this.getAvailableModels(providerType);
    return availableModels.length > 0 ? availableModels[0].value : "";
  }
  /**
   * Get model display name from model value
   */
  getModelDisplayName(providerType, modelValue) {
    const models = this.getAvailableModels(providerType);
    const model = models.find((m) => m.value === modelValue);
    return model ? model.label : modelValue;
  }
  /**
   * Switch to a specific model for a provider
   */
  async switchToModel(providerType, modelValue) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const isCurrentProvider = currentProviderType === providerType;
    const providers = this.plugin.settings.aiProviders;
    providers[providerType].model = modelValue;
    await this.plugin.saveSettings();
    if (isCurrentProvider) {
      const modelName = this.getModelDisplayName(providerType, modelValue);
      const providerName = this.getProviderDisplayName(providerType);
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${providerName} ${modelName}`);
      this.addMessage("system", switchMessage);
    } else {
      await this.switchToProvider(providerType);
    }
    if (this.currentProviderDropdown) {
      this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Populate provider dropdown with available providers
   */
  async populateProviderDropdown(dropdownMenu) {
    var _a;
    dropdownMenu.empty();
    const allowedProviders = this.plugin.aiProviderManager.getAllowedProviders();
    const currentProviderName = await this.plugin.aiProviderManager.getCurrentProviderName();
    for (const providerType of allowedProviders) {
      if (providerType === "none") continue;
      const providers = this.plugin.settings.aiProviders;
      const hasApiKey = (_a = providers[providerType]) == null ? void 0 : _a.apiKey;
      if (!hasApiKey && providerType !== "ollama") continue;
      const models = this.getAvailableModels(providerType);
      const currentModel = this.getCurrentModel(providerType);
      const displayName = this.getProviderDisplayName(providerType);
      const isCurrent = displayName === currentProviderName;
      const providerContainer = dropdownMenu.createDiv({ cls: "nova-provider-container" });
      const providerItem = providerContainer.createDiv({ cls: "nova-provider-dropdown-item" });
      providerItem.style.cssText = `
				padding: 8px 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 0.85em;
				color: var(--text-normal);
				transition: background-color 0.2s ease;
				position: relative;
			`;
      const providerDot = providerItem.createSpan();
      providerDot.style.cssText = `
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background: ${this.getProviderColor(providerType)};
			`;
      const nameSpan = providerItem.createSpan({ text: displayName });
      nameSpan.style.flex = "1";
      let expandArrow = null;
      if (models.length > 0) {
        expandArrow = providerItem.createSpan({ text: "\u25B6" });
        expandArrow.style.cssText = `
					font-size: 0.6em;
					transition: transform 0.2s ease;
					color: var(--text-muted);
				`;
      }
      if (isCurrent) {
        providerItem.style.background = "var(--background-modifier-hover)";
        nameSpan.style.fontWeight = "bold";
      }
      let modelsMenu = null;
      let isExpanded = false;
      if (models.length > 0) {
        modelsMenu = providerContainer.createDiv({ cls: "nova-models-submenu" });
        modelsMenu.style.cssText = `
					display: none;
					background: var(--background-primary);
					border-left: 2px solid ${this.getProviderColor(providerType)};
					margin-left: 16px;
				`;
        for (const model of models) {
          const modelItem = modelsMenu.createDiv({ cls: "nova-model-item" });
          modelItem.style.cssText = `
						padding: 6px 12px;
						cursor: pointer;
						font-size: 0.8em;
						color: var(--text-normal);
						transition: background-color 0.2s ease;
						display: flex;
						align-items: center;
						gap: 8px;
					`;
          const modelDot = modelItem.createSpan();
          modelDot.style.cssText = `
						width: 4px;
						height: 4px;
						border-radius: 50%;
						background: ${model.value === currentModel ? this.getProviderColor(providerType) : "var(--text-muted)"};
					`;
          const modelName = modelItem.createSpan({ text: model.label });
          if (model.value === currentModel) {
            modelName.style.fontWeight = "bold";
          }
          modelItem.addEventListener("click", async (e) => {
            e.stopPropagation();
            await this.switchToModel(providerType, model.value);
            dropdownMenu.style.display = "none";
          });
          modelItem.addEventListener("mouseenter", () => {
            modelItem.style.background = "var(--background-modifier-border-hover)";
          });
          modelItem.addEventListener("mouseleave", () => {
            modelItem.style.background = "transparent";
          });
        }
      }
      providerItem.addEventListener("click", async (e) => {
        if (models.length > 0) {
          e.stopPropagation();
          isExpanded = !isExpanded;
          if (modelsMenu) {
            modelsMenu.style.display = isExpanded ? "block" : "none";
          }
          if (expandArrow) {
            expandArrow.style.transform = isExpanded ? "rotate(90deg)" : "rotate(0deg)";
          }
        } else {
          if (!isCurrent) {
            await this.switchToProvider(providerType);
            dropdownMenu.style.display = "none";
            if (this.currentProviderDropdown) {
              this.currentProviderDropdown.updateCurrentProvider();
            }
          }
        }
      });
      providerItem.addEventListener("mouseenter", () => {
        if (!isCurrent) {
          providerItem.style.background = "var(--background-modifier-border-hover)";
        }
      });
      providerItem.addEventListener("mouseleave", () => {
        if (!isCurrent && !isExpanded) {
          providerItem.style.background = "transparent";
        }
      });
    }
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Anthropic",
      "openai": "OpenAI",
      "google": "Google",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get display name for header (just model name if available, otherwise provider name)
   */
  getProviderWithModelDisplayName(providerType) {
    const models = this.getAvailableModels(providerType);
    if (models.length > 0) {
      const currentModel = this.getCurrentModel(providerType);
      return this.getModelDisplayName(providerType, currentModel);
    }
    return this.getProviderDisplayName(providerType);
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "var(--color-orange)",
      "openai": "var(--color-green)",
      "google": "var(--color-blue)",
      "ollama": "var(--color-purple)",
      "none": "var(--text-muted)"
    };
    return colors[providerType] || "var(--text-success)";
  }
  /**
   * Switch to a different provider and update conversation context
   */
  async switchToProvider(providerType) {
    try {
      const switchMessage = this.createIconMessage("refresh-cw", `Switched to ${this.getProviderWithModelDisplayName(providerType)}`);
      this.addMessage("system", switchMessage);
      const platform = import_obsidian5.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].primaryProvider = providerType;
      await this.plugin.saveSettings();
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      setTimeout(() => this.refreshProviderStatus(), 100);
    } catch (error) {
      this.addErrorMessage(this.createIconMessage("x-circle", `Failed to switch to ${this.getProviderWithModelDisplayName(providerType)}`));
    }
  }
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    if (this.inputHandler) {
      this.inputHandler.refreshCommandButton();
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
};
_NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS = 300;
_NovaSidebarView.SCROLL_DELAY_MS = 50;
_NovaSidebarView.FOCUS_DELAY_MS = 150;
_NovaSidebarView.HOVER_TIMEOUT_MS = 150;
_NovaSidebarView.NOTICE_DURATION_MS = 5e3;
var NovaSidebarView = _NovaSidebarView;

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-3-5-sonnet-20241022",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-1.5-flash",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      primaryProvider: "ollama",
      fallbackProviders: ["openai", "google", "ollama"]
    },
    mobile: {
      primaryProvider: "none",
      fallbackProviders: ["openai", "google"]
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  }
};
var NovaSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova AI Settings" });
    this.createLicenseSettings();
    this.createGeneralSettings();
    this.createPlatformSettings();
    this.createProviderSettings();
    this.createCommandSettings();
  }
  createLicenseSettings() {
    var _a, _b;
    const { containerEl } = this;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isSupernova ? "supernova" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    new import_obsidian6.Setting(licenseContainer).setName("Supernova License Key (Optional)").setDesc("Enter your Supernova supporter license key for early access to new features").addText((text) => {
      var _a2;
      text.inputEl.type = "password";
      text.setPlaceholder("Enter Supernova license key...").setValue(this.plugin.settings.licensing.supernovaLicenseKey || "").onChange(async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.display();
        }
      });
      const validateButton = (_a2 = text.inputEl.parentElement) == null ? void 0 : _a2.createEl("button", {
        text: "Validate",
        cls: "nova-validate-btn"
      });
      if (validateButton) {
        validateButton.addEventListener("click", async () => {
          const licenseKey = text.inputEl.value;
          if (!licenseKey) {
            this.showLicenseMessage("Please enter a Supernova license key first.", "error");
            return;
          }
          validateButton.textContent = "Validating...";
          validateButton.disabled = true;
          try {
            if (this.plugin.featureManager) {
              await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
              const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
              if (isSupernova2) {
                this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
                this.showConfetti();
              } else {
                this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
              }
              const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
              if (leaves.length > 0) {
                const sidebarView = leaves[0].view;
                sidebarView.refreshSupernovaUI();
              }
              this.display();
            }
          } catch (error) {
            this.showLicenseMessage("Error validating Supernova license.", "error");
          } finally {
            validateButton.textContent = "Validate";
            validateButton.disabled = false;
          }
        });
      }
    });
    this.createSupernovaInfo(licenseContainer);
    if (true) {
      this.createDebugSettings(licenseContainer);
    }
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian6.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian6.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian6.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.display();
      }));
      new import_obsidian6.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.display();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "General Settings" });
    new import_obsidian6.Setting(containerEl).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 - 1.0)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian6.Setting(containerEl).setName("Default Max Tokens").setDesc("Maximum length of AI responses").addText((text) => text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
      const numValue = parseInt(value);
      if (!isNaN(numValue) && numValue > 0) {
        this.plugin.settings.general.defaultMaxTokens = numValue;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian6.Setting(containerEl).setName("Auto-save settings").setDesc("Automatically save settings when changed").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "AI Provider Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const providerContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    providerContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = providerContainer.style.display !== "none";
      providerContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = providerContainer.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>Configure Your API Keys</h4>
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
			<div class="nova-info-card nova-model-guidance">
				<h4>Recommended Defaults</h4>
				<ul class="nova-model-recommendations">
					<li><strong>Claude Sonnet 4</strong> - Latest generation with excellent instruction following for collaborative editing</li>
					<li><strong>GPT-4.1 Mini</strong> - Current-generation model that outperforms GPT-4o while remaining cost-effective</li>
					<li><strong>Gemini 2.5 Flash</strong> - Best price/performance with "thinking" capabilities and strong coding support</li>
				</ul>
				<p class="nova-guidance-note">These defaults offer modern AI capabilities without premium pricing.</p>
			</div>
		`;
    this.createOllamaSettings(providerContainer);
    this.createClaudeSettings(providerContainer);
    this.createGoogleSettings(providerContainer);
    this.createOpenAISettings(providerContainer);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    claudeContainer.createEl("h4", { text: "Claude (Anthropic)" });
    new import_obsidian6.Setting(claudeContainer).setName("API Key").setDesc("Your Anthropic API key").addText((text) => text.setPlaceholder("sk-ant-...").setValue(this.plugin.settings.aiProviders.claude.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.claude.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian6.Setting(claudeContainer).setName("Model").setDesc("Claude model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateClaudeModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4-20250514").onChange(async (value) => {
        this.plugin.settings.aiProviders.claude.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateClaudeModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("claude");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    openaiContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    new import_obsidian6.Setting(openaiContainer).setName("API Key").setDesc("Your OpenAI API key").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.aiProviders.openai.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.openai.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian6.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateOpenAIModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4.1-mini-2025-04-14").onChange(async (value) => {
        this.plugin.settings.aiProviders.openai.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateOpenAIModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("openai");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    googleContainer.createEl("h4", { text: "Google (Gemini)" });
    new import_obsidian6.Setting(googleContainer).setName("API Key").setDesc("Your Google AI API key").addText((text) => text.setPlaceholder("AI...").setValue(this.plugin.settings.aiProviders.google.apiKey || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.google.apiKey = value;
      await this.plugin.saveSettings();
    }));
    const modelSetting = new import_obsidian6.Setting(googleContainer).setName("Model").setDesc("Gemini model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      this.populateGoogleModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-04-17").onChange(async (value) => {
        this.plugin.settings.aiProviders.google.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateGoogleModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("google");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    ollamaContainer.createEl("h4", { text: "Ollama (Local)" });
    new import_obsidian6.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian6.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
      this.plugin.settings.aiProviders.ollama.model = value;
      await this.plugin.saveSettings();
    }));
  }
  createPlatformSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Platform Settings" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const platformContainer = containerEl.createDiv({ cls: "nova-platform-section" });
    platformContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = platformContainer.style.display !== "none";
      platformContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    const infoEl = platformContainer.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    platformContainer.createEl("h4", { text: "Desktop" });
    const desktopDropdown = new import_obsidian6.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for desktop").addDropdown((dropdown) => {
      const allowedProviders = this.getAllowedProvidersForPlatform("desktop");
      allowedProviders.forEach((provider) => {
        const label = this.getProviderDisplayName(provider);
        dropdown.addOption(provider, label);
      });
      return dropdown.setValue(this.plugin.settings.platformSettings.desktop.primaryProvider).onChange(async (value) => {
        this.plugin.settings.platformSettings.desktop.primaryProvider = value;
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
    platformContainer.createEl("h4", { text: "Mobile" });
    const mobileSetting = new import_obsidian6.Setting(platformContainer).setName("Primary Provider").setDesc("Primary AI provider for mobile devices");
    mobileSetting.addDropdown((dropdown) => dropdown.addOption("none", "None (Disabled)").addOption("claude", "Claude").addOption("openai", "OpenAI").addOption("google", "Google").setValue(this.plugin.settings.platformSettings.mobile.primaryProvider).onChange(async (value) => {
      this.plugin.settings.platformSettings.mobile.primaryProvider = value;
      await this.plugin.saveSettings();
      if (this.plugin.aiProviderManager) {
        this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
      }
    }));
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentProvider(providerId) {
    const platform = import_obsidian6.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].primaryProvider = providerId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings() {
    const { containerEl } = this;
    const headerEl = containerEl.createDiv({ cls: "nova-collapsible-header" });
    headerEl.style.cssText = `
			display: flex;
			align-items: center;
			cursor: pointer;
			padding: 8px 0;
			border-bottom: 1px solid var(--background-modifier-border);
			margin-bottom: 16px;
		`;
    const arrowEl = headerEl.createSpan({ cls: "nova-collapsible-arrow" });
    arrowEl.innerHTML = "\u25B6";
    arrowEl.style.cssText = `
			margin-right: 8px;
			transition: transform 0.2s ease;
			font-size: 12px;
			color: var(--text-muted);
		`;
    const titleEl = headerEl.createEl("h3", { text: "Custom Commands" });
    titleEl.style.cssText = "margin: 0; flex: 1;";
    const commandContainer = containerEl.createDiv({ cls: "nova-command-section" });
    commandContainer.style.cssText = "display: none;";
    headerEl.addEventListener("click", () => {
      const isVisible = commandContainer.style.display !== "none";
      commandContainer.style.display = isVisible ? "none" : "block";
      arrowEl.style.transform = isVisible ? "rotate(0deg)" : "rotate(90deg)";
    });
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      const noticeEl = commandContainer.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = commandContainer.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian6.Setting(commandContainer).setName("Show Command Button in Chat").setDesc("Show the Commands button beside the Send button for quick command access").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = commandContainer.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian6.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(commandContainer);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
};

// src/ai/provider-manager.ts
var import_obsidian8 = require("obsidian");

// src/ai/providers/claude.ts
var import_obsidian7 = require("obsidian");
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-5-haiku-latest",
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
      system: options == null ? void 0 : options.systemPrompt,
      messages: messages.map((msg) => ({
        role: msg.role === "assistant" ? "assistant" : "user",
        content: msg.content
      }))
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await (0, import_obsidian7.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": this.config.apiKey,
            "anthropic-version": "2023-06-01"
          },
          body: requestBody
        });
        if (response.status === 200) {
          const data = response.json;
          return data.content[0].text;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`Claude API error: ${response.status} - ${response.text}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && (error.message.includes("Network error") || error.message.includes("Failed to connect"))) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        if (error instanceof Error && error.message.startsWith("Claude API error:")) {
          throw error;
        }
        throw new Error(`Failed to connect to Claude API: ${error instanceof Error ? error.message : "Network error"}`);
      }
    }
    throw new Error("Claude API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    const result = await this.chatCompletion(messages, options);
    yield { content: result, done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await (0, import_obsidian7.requestUrl)({
        url: "https://api.anthropic.com/v1/messages",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-5-haiku-latest",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (response.status !== 200) {
        throw new Error(`API key validation failed: ${response.status} - ${response.text}`);
      }
      const models = [
        "claude-opus-4-20250514",
        "claude-sonnet-4-20250514",
        "claude-3-7-sonnet-latest",
        "claude-3-5-sonnet-latest",
        "claude-3-5-haiku-latest"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
      messages: requestMessages,
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${this.config.apiKey}`
          },
          body: requestBody
        });
        if (response.ok) {
          const data = await response.json();
          return data.choices[0].message.content;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`OpenAI API error: ${response.statusText}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && error.message.includes("fetch")) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw error;
      }
    }
    throw new Error("OpenAI API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                yield { content, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gpt-4.1-2025-04-14",
        "gpt-4.1-mini-2025-04-14",
        "gpt-4.1-nano-2025-04-14",
        "gpt-4o",
        "gpt-4o-mini"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages, systemPrompt) {
    const contents = [];
    if (systemPrompt) {
      contents.push({
        role: "user",
        parts: [{ text: `System: ${systemPrompt}` }]
      });
    }
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.candidates[0].content.parts[0].text;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-pro";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages, options == null ? void 0 : options.systemPrompt),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Google API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
              if (text) {
                yield { content: text, done: false };
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gemini-2.5-flash-preview-04-17",
        "gemini-2.5-pro-preview-03-25",
        "gemini-2.0-flash",
        "gemini-2.0-flash-lite"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                yield { content: parsed.response, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                yield { content: parsed.message.content, done: false };
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/ai/provider-manager.ts
var AIProviderManager = class {
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
  }
  getPlatformProviders() {
    const platform = import_obsidian8.Platform.isMobile ? "mobile" : "desktop";
    const platformSettings = this.settings.platformSettings[platform];
    const providers = [platformSettings.primaryProvider, ...platformSettings.fallbackProviders];
    return providers;
  }
  async getAvailableProvider() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return provider;
      }
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async getCurrentProviderType() {
    const orderedProviders = this.getPlatformProviders();
    if (orderedProviders[0] === "none") {
      return null;
    }
    for (const providerType of orderedProviders) {
      if (providerType === "none") continue;
      const provider = this.providers.get(providerType);
      if (provider && await provider.isAvailable()) {
        return providerType;
      }
    }
    return null;
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    if (import_obsidian8.Platform.isMobile) {
      return ["claude", "openai", "google"];
    }
    return ["claude", "openai", "google", "ollama"];
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
};

// src/core/document-engine.ts
var import_obsidian9 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          this.conversations.set(conversation.filePath, conversation);
        }
      }
    } catch (error) {
    }
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    return this.conversations.get(filePath);
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now()
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance
   */
  getActiveEditor() {
    const activeEditor = this.app.workspace.activeEditor;
    if (activeEditor == null ? void 0 : activeEditor.editor) {
      return activeEditor.editor;
    }
    let view = this.app.workspace.getActiveViewOfType(import_obsidian9.MarkdownView);
    if (!view) {
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      for (const leaf of leaves) {
        const leafView = leaf.view;
        if (leafView instanceof import_obsidian9.MarkdownView) {
          view = leafView;
          break;
        }
      }
    }
    if (!view) {
      return null;
    }
    const editor = view.editor;
    return editor || null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at a specific location
   */
  async deleteContent(target, location) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      } else if (target === "section" && location) {
        const section = await this.findSection(location);
        if (!section) {
          return {
            success: false,
            error: `Section "${location}" not found`,
            editType: "delete"
          };
        }
        const content = editor.getValue();
        const lines = content.split("\n");
        const newLines = lines.filter(
          (_, index) => index < section.range.start || index > section.range.end
        );
        await this.app.vault.modify(file, newLines.join("\n"));
        return {
          success: true,
          editType: "delete",
          appliedAt: { line: section.range.start, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Build hierarchical path for a heading
   */
  buildSectionPath(headings, targetIndex) {
    const target = headings[targetIndex];
    const path = [target.text];
    for (let i = targetIndex - 1; i >= 0; i--) {
      const heading = headings[i];
      if (heading.level < target.level) {
        path.unshift(heading.text);
        break;
      }
    }
    return path.join("::");
  }
  /**
   * Find a section by heading name (supports hierarchical paths with :: or /)
   */
  async findSection(headingText) {
    const context = await this.getDocumentContext();
    if (!context) return null;
    const normalizedTarget = headingText.toLowerCase().trim();
    if (normalizedTarget.includes("::") || normalizedTarget.includes("/")) {
      const targetPath = normalizedTarget.replace(/::/g, "/");
      for (let i = 0; i < context.headings.length; i++) {
        const heading = context.headings[i];
        const legacyPath = this.buildSectionPath(context.headings, i).toLowerCase();
        const newPath = this.buildFullSectionPath(context.headings, i).toLowerCase();
        if (legacyPath === normalizedTarget || newPath === targetPath) {
          return this.buildDocumentSection(heading, context.headings, i, context.content);
        }
      }
      return null;
    } else {
      const headingIndex = context.headings.findIndex(
        (h) => h.text.toLowerCase().includes(normalizedTarget)
      );
      if (headingIndex === -1) return null;
      const heading = context.headings[headingIndex];
      return this.buildDocumentSection(heading, context.headings, headingIndex, context.content);
    }
  }
  /**
   * Build DocumentSection object from heading info
   */
  buildDocumentSection(heading, allHeadings, headingIndex, content) {
    const nextHeading = allHeadings[headingIndex + 1];
    const lines = content.split("\n");
    const endLine = nextHeading ? nextHeading.line - 1 : lines.length - 1;
    const sectionLines = lines.slice(heading.line + 1, endLine + 1);
    const sectionContent = sectionLines.join("\n").trim();
    return {
      heading: heading.text,
      level: heading.level,
      content: sectionContent,
      range: {
        start: heading.line,
        end: endLine
      }
    };
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
  /**
   * Get all section paths for section picker
   */
  async getAllSectionPaths() {
    const context = await this.getDocumentContext();
    if (!context) return [];
    return context.headings.map((heading, index) => {
      const targetPath = this.buildFullSectionPath(context.headings, index);
      const displayName = this.createDisplayName(heading.text, heading.level);
      const preview = this.getSectionPreview(context.headings, index, context.content);
      return {
        displayName,
        targetPath,
        headingText: heading.text,
        level: heading.level,
        line: heading.line,
        preview
      };
    });
  }
  /**
   * Build full hierarchical path including all parents
   */
  buildFullSectionPath(headings, targetIndex) {
    const target = headings[targetIndex];
    const path = [target.text];
    let currentLevel = target.level;
    for (let i = targetIndex - 1; i >= 0; i--) {
      const heading = headings[i];
      if (heading.level < currentLevel) {
        path.unshift(heading.text);
        currentLevel = heading.level;
      }
    }
    return path.join("/");
  }
  /**
   * Create indented display name for hierarchical view
   */
  createDisplayName(text, level) {
    const indent = "  ".repeat(Math.max(0, level - 1));
    const icon = level === 1 ? "\u{1F4C4} " : "";
    return `${indent}${icon}${text}`;
  }
  /**
   * Get section content preview
   */
  getSectionPreview(headings, headingIndex, content) {
    const heading = headings[headingIndex];
    const nextHeading = headings[headingIndex + 1];
    const lines = content.split("\n");
    const startLine = heading.line + 1;
    const endLine = nextHeading ? Math.min(nextHeading.line, startLine + 3) : Math.min(lines.length, startLine + 3);
    const sectionLines = lines.slice(startLine, endLine).filter((line) => line.trim().length > 0).slice(0, 2);
    if (sectionLines.length === 0) {
      return "Empty section";
    }
    const preview = sectionLines.join(" ").substring(0, 100);
    return preview.length > 97 ? preview + "..." : preview;
  }
  /**
   * Enhanced section finding with better path support
   */
  async findSectionByPath(sectionPath) {
    const context = await this.getDocumentContext();
    if (!context) return null;
    const normalizedPath = sectionPath.toLowerCase().trim();
    for (let i = 0; i < context.headings.length; i++) {
      const fullPath = this.buildFullSectionPath(context.headings, i);
      if (fullPath.toLowerCase() === normalizedPath) {
        return this.buildDocumentSection(context.headings[i], context.headings, i, context.content);
      }
    }
    const headingIndex = context.headings.findIndex(
      (h) => h.text.toLowerCase().includes(normalizedPath)
    );
    if (headingIndex === -1) return null;
    const heading = context.headings[headingIndex];
    return this.buildDocumentSection(heading, context.headings, headingIndex, context.content);
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor() {
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: 0.7,
      maxTokens: 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents directly. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Be concise and focused on the specific request
- Do not add section headers unless specifically requested

CRITICAL POSITIONING RULES:
- When a specific location is mentioned (section, header, heading), ALWAYS target that location, NOT the cursor position
- Understand spatial relationships: "after [section]" means after the section's content, "before [header]" means before the header line
- "Under [heading]" means immediately after the heading line
- Location references OVERRIDE cursor position - ignore where the cursor is when location is specified
- Only use cursor position when NO specific location is mentioned`;
    const actionSpecificPrompts = {
      add: `
TASK: Add new content to the document.
- Create well-structured, relevant content that fits the document's purpose
- Use appropriate markdown formatting (headings, lists, emphasis)
- Ensure smooth flow with existing content
- Match the document's style and tone

POSITIONING FOR ADD:
- If a section/header is specified, add content WITHIN that section (not at cursor)
- "Add after [section]" = add at the end of that section's content
- "Add under [heading]" = add immediately after the heading line
- "Add before [section]" = add just before the section header
- Pay attention to section boundaries and respect document structure`,
      edit: `
TASK: Edit and improve existing content.
- Enhance clarity, readability, and flow
- Preserve the original meaning unless changes are requested
- Improve word choice and sentence structure
- Maintain the original formatting and structure`,
      delete: `
TASK: Remove specified content from the document.
- Identify the exact content to be removed
- Ensure remaining content flows naturally
- Preserve document structure and formatting
- Confirm the deletion is appropriate for the context`,
      grammar: `
TASK: Fix grammar, spelling, and language issues.
- Correct spelling errors, grammar mistakes, and typos
- Improve sentence structure and clarity
- Maintain the original voice and style
- Preserve all formatting and markdown syntax
- Make minimal changes - only fix actual errors`,
      rewrite: `
TASK: Rewrite or restructure content.
- Create new content that serves the same purpose
- Improve organization, clarity, and flow
- Use more effective language and structure
- Maintain key information and concepts
- Adapt to any specified style requirements`,
      metadata: `
TASK: Update document metadata/properties.
- Modify, add, or remove frontmatter properties
- Handle tags, titles, dates, and custom properties
- Maintain proper YAML formatting
- Preserve existing properties unless specifically changing them
- Provide ONLY the property updates in JSON format`
    };
    return basePrompt + actionSpecificPrompts[action];
  }
  /**
   * Build user prompt with specific instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = `${contextInfo}

USER REQUEST: ${command.instruction}`;
    if (command.target === "section" && command.location) {
      prompt2 += `

\u{1F3AF} LOCATION OVERRIDE: You are working with the "${command.location}" section. IGNORE any cursor position or surrounding context - focus ONLY on the specified section.`;
    }
    if (command.context && command.context.trim()) {
      prompt2 += `

ADDITIONAL REQUIREMENTS: ${command.context}`;
    }
    const targetInstructions = this.getTargetInstructions(command);
    if (targetInstructions) {
      prompt2 += `

${targetInstructions}`;
    }
    const actionInstructions = this.getActionInstructions(command);
    if (actionInstructions) {
      prompt2 += `

${actionInstructions}`;
    }
    return prompt2;
  }
  /**
   * Get target-specific instructions
   */
  getTargetInstructions(command) {
    switch (command.target) {
      case "selection":
        return "FOCUS: Work with the selected text only. Provide the improved version of the selected content.";
      case "section":
        if (command.location) {
          const actionGuidance = {
            "add": "Add content WITHIN this section, after the section header and before any subsections.",
            "edit": "Modify ONLY the content of this section, preserving the section header.",
            "delete": "Remove content from this section only.",
            "rewrite": "Rewrite the content of this section, keeping the section header.",
            "grammar": "Fix grammar and spelling in this section only.",
            "metadata": "Update metadata related to this section."
          };
          return `FOCUS: Target the "${command.location}" section specifically. ${actionGuidance[command.action] || "Modify only this section."} IGNORE cursor position - work with the named section.`;
        }
        return "FOCUS: Work with the current section around the cursor.";
      case "document":
        return "FOCUS: Apply changes to the entire document while preserving its structure.";
      case "end":
        return "FOCUS: Add content at the very end of the document, after all existing content. Ensure it flows naturally.";
      case "paragraph":
        return "FOCUS: Work with the current paragraph where the cursor is located, or create a new paragraph.";
      default:
        return "";
    }
  }
  /**
   * Get action-specific instructions
   */
  getActionInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added. Include appropriate headings if adding a section.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide only the corrected text with grammar and spelling fixes.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return 'OUTPUT: Provide ONLY a JSON object with the property updates. Example: {"title": "New Title", "tags": ["tag1", "tag2"], "date": "2025-01-01"}';
      default:
        return "";
    }
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeHistory && conversationContext && conversationContext.trim()) {
      context += `
${conversationContext}
`;
    }
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += "\nDOCUMENT STRUCTURE:\n";
      documentContext.headings.forEach((heading) => {
        const indent = "  ".repeat(heading.level - 1);
        context += `${indent}- ${heading.text}
`;
      });
    }
    if (documentContext.selectedText && command.target === "selection") {
      context += `
SELECTED TEXT:
${documentContext.selectedText}
`;
    }
    if (command.target === "section" && command.location) {
      const section = this.findSectionInContent(documentContext.content, command.location);
      if (section) {
        context += `
=== TARGET SECTION "${command.location}" ===
${section}
=== END TARGET SECTION ===
`;
        context += `
IMPORTANT: Work with the TARGET SECTION above, NOT the cursor position. The section "${command.location}" is your focus area.
`;
      } else {
        context += `
TARGET SECTION "${command.location}" NOT FOUND.

Available sections with hierarchical paths:
`;
        documentContext.headings.forEach((heading, index) => {
          const path = this.buildSectionPath(documentContext.headings, index);
          context += `- ${path}
`;
        });
        context += `
Tip: Use hierarchical paths like "Methods::Data Collection" to target specific nested sections.
`;
      }
    } else if (command.target === "paragraph" && documentContext.surroundingLines) {
      context += "\nCURRENT CONTEXT:\n";
      if (documentContext.surroundingLines.before.length > 0) {
        context += `Before: ${documentContext.surroundingLines.before.join(" ")}
`;
      }
      if (documentContext.surroundingLines.after.length > 0) {
        context += `After: ${documentContext.surroundingLines.after.join(" ")}
`;
      }
    }
    const contentLines = documentContext.content.split("\n");
    if (contentLines.length > config.maxContextLines) {
      const start = Math.max(0, contentLines.length - config.maxContextLines);
      context += `
RECENT CONTENT (last ${config.maxContextLines} lines):
`;
      context += contentLines.slice(start).join("\n");
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}`;
    }
    return context;
  }
  /**
   * Build hierarchical path for a heading
   */
  buildSectionPath(headings, targetIndex) {
    const target = headings[targetIndex];
    const path = [target.text];
    for (let i = targetIndex - 1; i >= 0; i--) {
      const heading = headings[i];
      if (heading.level < target.level) {
        path.unshift(heading.text);
        break;
      }
    }
    return path.join("::");
  }
  /**
   * Find a specific section in content
   */
  findSectionInContent(content, sectionName) {
    const lines = content.split("\n");
    const normalizedSectionName = sectionName.toLowerCase().trim();
    const headings = [];
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        headings.push({
          text: headingMatch[2],
          level: headingMatch[1].length,
          line: index
        });
      }
    });
    if (normalizedSectionName.includes("::")) {
      for (let i = 0; i < headings.length; i++) {
        const sectionPath = this.buildSectionPath(headings, i);
        if (sectionPath.toLowerCase() === normalizedSectionName) {
          return this.extractSectionContent(lines, headings, i);
        }
      }
      return null;
    } else {
      const headingIndex = headings.findIndex(
        (h) => h.text.toLowerCase().includes(normalizedSectionName)
      );
      if (headingIndex === -1) return null;
      return this.extractSectionContent(lines, headings, headingIndex);
    }
  }
  /**
   * Extract section content from lines and heading info
   */
  extractSectionContent(lines, headings, headingIndex) {
    const heading = headings[headingIndex];
    const nextHeading = headings[headingIndex + 1];
    const sectionEnd = nextHeading ? nextHeading.line : lines.length;
    return lines.slice(heading.line, sectionEnd).join("\n");
  }
  /**
   * Create a simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner. Provide helpful, concise responses to user requests. Focus on being practical and actionable.`;
    let userPrompt = instruction;
    if (context) {
      userPrompt = `Context: ${context}

Request: ${instruction}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 500
      }
    };
  }
  /**
   * Build prompt for conversation context
   */
  buildConversationPrompt(message, documentContext, recentHistory = []) {
    let systemPrompt = `You are Nova, an AI writing partner that helps users with their documents. You can:
- Answer questions about writing and editing
- Provide suggestions for improvement
- Help plan document structure
- Assist with research and content development
- Directly modify documents when users request specific actions (like adding content, editing sections, etc.)

IMPORTANT: When users request document actions (e.g., "add a paragraph about X", "append lorem ipsum after heading Y", "insert bullet points"), you should provide the actual content to be added/modified, not just explain what should be done.

Be helpful, concise, and practical in your responses.`;
    let userPrompt = message;
    let context = "";
    if (documentContext) {
      context += `Current document: ${documentContext.filename}
`;
      if (documentContext.headings.length > 0) {
        context += "Document structure:\n";
        documentContext.headings.forEach((heading) => {
          const indent = "  ".repeat(heading.level - 1);
          context += `${indent}- ${heading.text}
`;
        });
      }
    }
    if (recentHistory.length > 0) {
      context += "\nRecent conversation:\n";
      recentHistory.slice(-3).forEach((msg) => {
        if (msg.role === "user") {
          context += `You: ${msg.content}
`;
        } else if (msg.role === "assistant") {
          context += `Nova: ${msg.content}
`;
        }
      });
    }
    if (context) {
      userPrompt = `${context}

Current message: ${message}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context,
      config: {
        temperature: 0.8,
        maxTokens: 800
      }
    };
  }
  /**
   * Estimate token count for a prompt
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Validate prompt generation
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    const tokenCount = this.estimateTokenCount(prompt2);
    if (tokenCount > 8e3) {
      issues.push(`Prompt is too long (${tokenCount} tokens, max 8000)`);
    }
    if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
      issues.push("Temperature must be between 0 and 1");
    }
    if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
      issues.push("Max tokens must be between 10 and 4000");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document", "paragraph"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection", "section", "line"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include|append|prepend)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert|append|prepend)\b(?!\s+.*\b(better|clearer|more|less)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i,
      // Specific patterns for append/prepend with location
      /\b(append|add)\b.*\b(after|following)\b/i,
      /\b(prepend|add)\b.*\b(before|preceding)\b/i
    ],
    targets: ["end", "section", "paragraph"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection", "section", "paragraph"]
  },
  {
    action: "metadata",
    patterns: [
      /\b(update|set|change|modify|add)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      /\b(add|remove|update)\s+.*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  }
];
var LOCATION_PATTERNS = [
  // New semantic patterns for append/prepend to
  /\b(?:append|prepend)\s+.*?\bto\s+(?:the\s+)?["']([^"']+?)["']/i,
  /\b(?:append|prepend)\s+.*?\bto\s+(?:the\s+)?([A-Za-z][A-Za-z0-9\s:&]*?)(?:\s+(?:section|heading|part))?$/i,
  /\b(?:append|prepend)\s+.*?\bto\s+([A-Za-z][A-Za-z0-9\s:&]*?)\s+(?:section|heading|part)/i,
  // Append/prepend with after/before (for mixed syntax like "append X after Y")
  /\b(?:append|prepend)\s+.*?\b(?:after|before)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading)/i,
  /\b(?:append|prepend)\s+.*?\b(?:after|before)\s+(?:the\s+)?([A-Za-z][A-Za-z0-9\s:&]*?)\s+(?:section|heading)/i,
  // Insert patterns with after/before
  /\binsert\s+.*?\b(?:after|before)\s+(?:the\s+)?["']([^"']+?)["']\s+heading/i,
  /\binsert\s+.*?\b(?:after|before)\s+(?:the\s+)?([A-Za-z][A-Za-z0-9\s:&]*?)\s+heading/i,
  // Original patterns for after/before the X heading/section
  /\b(?:after|before|following|preceding)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:after|before|following|preceding)\s+the\s+([^"'\s]+(?:\s+(?:and|&)\s+[^"'\s]+)*)\s+(?:section|heading|part)/i,
  // Standard quoted patterns
  /\b(?:to|in|at|under|within|inside)\s+(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:the\s+)?["']([^"']+?)["']\s+(?:section|heading|part)/i,
  /\b(?:section|heading|part)\s+["']([^"']+?)["']/i,
  /\b(?:section|heading)\s+(?:called|titled|named)\s+["']([^"']+?)["']/i,
  /\b(?:called|titled|named)\s+["']([^"']+?)["']/i,
  // Generic pattern - must be last and more restrictive
  /\b(?:in|at|under|within)\s+(?:the\s+)?([a-zA-Z][a-zA-Z\s&]*?)\s+(?:section|heading)\b/i
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:this|current|selected)\s+(?:paragraph|line)/i, target: "paragraph" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" },
  { pattern: /\b(?:section|heading|part)/i, target: "section" }
];
var CommandParser = class {
  /**
   * Convert path-style syntax (/) to hierarchical syntax (::) 
   */
  convertPathSyntax(input) {
    return input.replace(/\b([A-Za-z][A-Za-z0-9\s]*?)\/([A-Za-z][A-Za-z0-9\s\/]*)\b/g, "$1::$2");
  }
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const convertedInput = this.convertPathSyntax(input);
    const normalizedInput = convertedInput.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const { target, positionHint } = this.detectTargetAndPosition(normalizedInput, hasSelection, action);
    const location = this.extractLocation(convertedInput);
    const context = this.extractContext(convertedInput, positionHint);
    return {
      action,
      target,
      location,
      instruction: input,
      // Keep original input for display
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type AND position hint for the command
   */
  detectTargetAndPosition(input, hasSelection, action) {
    let positionHint;
    if (/\bappend\s+.*?\b(?:to|after)\b/i.test(input)) {
      positionHint = "section-end";
    } else if (/\bprepend\s+.*?\b(?:to|before)\b/i.test(input)) {
      positionHint = "section-start";
    } else if (/\binsert\s+.*?\bafter\s+.*?\bheading\b/i.test(input)) {
      positionHint = "after-heading";
    } else if (/\binsert\s+.*?\bbefore\s+.*?\bheading\b/i.test(input)) {
      positionHint = "before-heading";
    }
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return {
          target: targetPattern.target,
          positionHint
        };
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return { target: "selection", positionHint };
    }
    let target;
    switch (action) {
      case "add":
        target = input.includes("section") || input.includes("heading") ? "section" : "end";
        break;
      case "edit":
        target = hasSelection ? "selection" : "paragraph";
        break;
      case "delete":
        target = hasSelection ? "selection" : "section";
        break;
      case "grammar":
        target = hasSelection ? "selection" : "document";
        break;
      case "rewrite":
        target = "end";
        break;
      default:
        target = "paragraph";
    }
    return { target, positionHint };
  }
  /**
   * Detect the target type from the input (legacy wrapper)
   */
  detectTarget(input, hasSelection, action) {
    const { target } = this.detectTargetAndPosition(input, hasSelection, action);
    return target;
  }
  /**
   * Extract location information from the input
   */
  extractLocation(input) {
    for (const pattern of LOCATION_PATTERNS) {
      const match = pattern.exec(input);
      if (match && match[1]) {
        return match[1].trim();
      }
    }
    return void 0;
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input, positionHint) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    if (positionHint) {
      switch (positionHint) {
        case "section-end":
          context += "Position: Add at the end of the section. ";
          break;
        case "section-start":
          context += "Position: Add at the start of the section (right after the heading). ";
          break;
        case "after-heading":
          context += "Position: Insert immediately after the heading line. ";
          break;
        case "before-heading":
          context += "Position: Insert immediately before the heading line. ";
          break;
      }
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "delete" && !command.location) {
      return {
        valid: false,
        error: "Please specify which section to delete"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection, hasHeadings) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add a conclusion section",
        "Fix grammar in this document",
        "Add an introduction",
        "Create a summary"
      );
    }
    if (hasHeadings) {
      suggestions.push(
        "Add content to the introduction section",
        "Expand the methodology section"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target, location } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new sections";
        break;
    }
    if (location) {
      description += ` in "${location}"`;
    } else {
      switch (target) {
        case "selection":
          description += " in selected text";
          break;
        case "section":
          description += " in current section";
          break;
        case "paragraph":
          description += " in current paragraph";
          break;
        case "document":
          description += " in entire document";
          break;
        case "end":
          description += " at end of document";
          break;
      }
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const lowerMessage = message.toLowerCase().trim();
    if (lowerMessage.startsWith(":")) {
      return true;
    }
    const actionVerbs = [
      "add",
      "insert",
      "append",
      "prepend",
      "include",
      "create",
      "write",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "replace",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "drop",
      "fix",
      "correct",
      "proofread",
      "polish",
      "check",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const startsWithAction = actionVerbs.some((verb) => {
      const verbPattern = new RegExp(`^${verb}\\b`, "i");
      return verbPattern.test(lowerMessage);
    });
    if (startsWithAction) {
      const questionIndicators = [
        /^(how|what|why|when|where|which|who|can|could|should|would|will|is|are|am|do|does|did)/i,
        /\?/,
        // Contains question mark
        /\b(help|advice|suggest|recommend|think|opinion)\b/i
      ];
      const isQuestion = questionIndicators.some((pattern) => pattern.test(lowerMessage));
      if (isQuestion) {
        return false;
      }
      return true;
    }
    const explicitCommandPatterns = [
      // Grammar/spelling commands that don't start with action verbs
      /\b(grammar|spell|spelling|proofread|polish)\b.*\b(check|fix|correct)\b/i,
      // Metadata commands with different structures
      /\bset\s+(the\s+)?(title|tags|metadata|properties)/i,
      /\bupdate\s+(the\s+)?(title|tags|metadata|properties)/i
    ];
    for (const pattern of explicitCommandPatterns) {
      if (pattern.test(lowerMessage)) {
        return true;
      }
    }
    return false;
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    return this.contextBuilder.buildConversationPrompt(message, documentContext, recentHistory);
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    return this.contextBuilder.buildSimplePrompt(instruction, context);
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.contextBuilder.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.contextBuilder.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      location: void 0,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "insert"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        let insertPosition;
        try {
          insertPosition = await this.determineInsertPosition(command, documentContext);
        } catch (error) {
          if (error instanceof Error && error.message.includes("not found")) {
            const errorMessage = this.buildSectionNotFoundError(command.location, documentContext);
            const result2 = {
              success: false,
              error: errorMessage,
              editType: "insert"
            };
            await this.documentEngine.addAssistantMessage(errorMessage, result2);
            return result2;
          }
          throw error;
        }
        const result = await this.documentEngine.applyEdit(
          content,
          insertPosition,
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to add content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Determine where to insert new content
   */
  async determineInsertPosition(command, documentContext) {
    switch (command.target) {
      case "end":
        return "end";
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const positionHint = this.extractPositionHint(command.context);
            switch (positionHint) {
              case "section-start":
                return { line: section.range.start + 1, ch: 0 };
              case "after-heading":
                return { line: section.range.start + 1, ch: 0 };
              case "before-heading":
                return { line: section.range.start, ch: 0 };
              case "section-end":
              default:
                return { line: section.range.end, ch: 0 };
            }
          } else {
            throw new Error(`Section "${command.location}" not found`);
          }
        }
        return "cursor";
      case "paragraph":
        return "cursor";
      case "document":
        return "end";
      default:
        return "cursor";
    }
  }
  /**
   * Validate add command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    if (command.target === "section" && !command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Extract position hint from command context
   */
  extractPositionHint(context) {
    if (!context) return null;
    if (context.includes("Position: Add at the end of the section")) {
      return "section-end";
    } else if (context.includes("Position: Add at the start of the section")) {
      return "section-start";
    } else if (context.includes("Position: Insert immediately after the heading line")) {
      return "after-heading";
    } else if (context.includes("Position: Insert immediately before the heading line")) {
      return "before-heading";
    }
    return null;
  }
  /**
   * Build error message when section is not found, showing available hierarchical paths
   */
  buildSectionNotFoundError(sectionName, documentContext) {
    const availablePaths = [];
    documentContext.headings.forEach((heading, index) => {
      const path = this.buildSectionPath(documentContext.headings, index);
      availablePaths.push(path);
    });
    let errorMessage = `Section "${sectionName}" not found.

Available sections:`;
    availablePaths.forEach((path) => {
      errorMessage += `
- ${path}`;
    });
    errorMessage += `

Tip: Use hierarchical paths like "Methods::Data Collection" to target specific nested sections.`;
    return errorMessage;
  }
  /**
   * Build hierarchical path for a heading (duplicated from DocumentEngine for error messages)
   */
  buildSectionPath(headings, targetIndex) {
    const target = headings[targetIndex];
    const path = [target.text];
    for (let i = targetIndex - 1; i >= 0; i--) {
      const heading = headings[i];
      if (heading.level < target.level) {
        path.unshift(heading.text);
        break;
      }
    }
    return path.join("::");
  }
  /**
   * Get suggestions for add commands
   */
  getSuggestions(documentContext) {
    const suggestions = [
      "Add a conclusion section",
      "Add an introduction",
      "Create a summary",
      "Add examples",
      "Create a methodology section"
    ];
    if (documentContext.headings.length > 0) {
      const sectionNames = documentContext.headings.map((h) => h.text);
      if (!sectionNames.some((name) => name.toLowerCase().includes("introduction"))) {
        suggestions.unshift("Add an introduction section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("conclusion"))) {
        suggestions.push("Add a conclusion section");
      }
      if (!sectionNames.some((name) => name.toLowerCase().includes("summary"))) {
        suggestions.push("Add a summary section");
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what content would be added (without actually adding it)
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let positionDescription = "";
      switch (command.target) {
        case "end":
          positionDescription = "at the end of the document";
          break;
        case "section":
          if (command.location) {
            positionDescription = `in the "${command.location}" section`;
          } else {
            positionDescription = "in the current section";
          }
          break;
        case "paragraph":
          positionDescription = "at the cursor position";
          break;
        case "document":
          positionDescription = "at the end of the document";
          break;
        default:
          positionDescription = "at the cursor position";
      }
      return {
        success: true,
        preview: `Will add new content ${positionDescription}`,
        position: positionDescription
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const content = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!content || content.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate content", result2);
          return result2;
        }
        const result = await this.applyEdit(command, documentContext, content);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to edit content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          content,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${content}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid edit target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "edit" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for edit commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Make this more professional",
        "Make this more detailed",
        "Improve clarity and flow",
        "Make this more formal",
        "Simplify this text",
        "Expand on this point",
        "Make this more engaging"
      );
    } else {
      suggestions.push(
        "Improve the writing style",
        "Make the document more professional",
        "Enhance clarity throughout",
        "Improve the introduction",
        "Polish the conclusion",
        "Make it more concise",
        "Add more detail",
        "Improve the flow between sections"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Improve the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be edited
   */
  async preview(command) {
    var _a, _b;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will edit the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will edit the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will edit content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will edit content at cursor position";
          if (documentContext.surroundingLines) {
            const currentLine = (_b = (_a = documentContext.cursorPosition) == null ? void 0 : _a.line) != null ? _b : 0;
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              affectedContent = editor.getLine(currentLine);
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will edit the entire document";
          break;
        case "end":
          previewText = "Will add edited content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid edit target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get edit targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of changes
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      if (command.instruction && command.instruction.trim().length > 0) {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const conversationContext = this.documentEngine.getConversationContext();
        const promptConfig = conversationContext ? { includeHistory: true } : {};
        const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
        const promptValidation = this.contextBuilder.validatePrompt(prompt2);
        if (!promptValidation.valid) {
          return {
            success: false,
            error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
            editType: "delete"
          };
        }
        try {
          const aiResponse = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
        } catch (error) {
          const result2 = {
            success: false,
            error: error instanceof Error ? error.message : "AI analysis failed",
            editType: "delete"
          };
          await this.documentEngine.addAssistantMessage(
            `Error: ${result2.error}`,
            result2
          );
          return result2;
        }
      }
      const result = await this.applyDeletion(command, documentContext);
      if (command.instruction && command.instruction.trim().length > 0 && !result.success) {
        await this.documentEngine.addAssistantMessage("Failed to delete content", result);
      }
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "delete"
              };
            }
            editor.replaceRange("", startPos, endPos);
            return {
              success: true,
              content: "",
              editType: "delete",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "delete"
            };
          }
        } else {
          return {
            success: false,
            error: "Section name required for section deletion",
            editType: "delete"
          };
        }
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "delete"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          const lineContent = editor.getLine(currentLine);
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine + 1, ch: 0 };
          editor.replaceRange("", startPos, endPos);
          return {
            success: true,
            content: "",
            editType: "delete",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "delete"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end of document. Use a different target.",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: "Invalid deletion target",
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && !command.location) {
      return {
        valid: false,
        error: "Section name required for section deletion"
      };
    }
    if (command.target === "end") {
      return {
        valid: false,
        error: "Cannot delete from end of document. Use a different target."
      };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for delete commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Delete the selected text",
        "Remove this content",
        "Clear the selection"
      );
    } else {
      suggestions.push(
        "Delete the current paragraph",
        "Remove empty sections",
        "Clear redundant content",
        "Delete duplicate information"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Delete the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 8);
  }
  /**
   * Preview what would be deleted
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will delete the selected text";
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = `${section.heading}

${section.content}`;
              previewText = `Will delete the entire "${command.location}" section`;
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            return {
              success: false,
              error: "Section name required for preview"
            };
          }
          break;
        case "paragraph":
          previewText = "Will delete the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will delete all document content";
          break;
        case "end":
          return {
            success: false,
            error: "Cannot delete from end of document"
          };
        default:
          return {
            success: false,
            error: "Invalid deletion target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Get delete targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-1, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of deletion
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length + section.heading.length;
            linesAffected = section.range.end - section.range.start + 1;
            scopeDescription = `"${command.location}" section`;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "Invalid target for deletion";
        break;
    }
    return {
      charactersAffected,
      linesAffected,
      scopeDescription
    };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const correctedContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: 0.3,
            // Lower temperature for grammar corrections
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!correctedContent || correctedContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate corrected content", result2);
          return result2;
        }
        const result = await this.applyGrammarCorrection(command, documentContext, correctedContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to correct grammar", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Grammar correction failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar correction based on command target
   */
  async applyGrammarCorrection(command, documentContext, correctedContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${correctedContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(correctedContent, startPos, endPos);
          return {
            success: true,
            content: correctedContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(correctedContent);
      case "end":
        return await this.documentEngine.applyEdit(
          correctedContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid grammar correction target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "grammar" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for grammar commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Fix grammar in selected text",
        "Correct spelling and punctuation",
        "Improve sentence structure",
        "Fix capitalization errors",
        "Correct verb tenses",
        "Fix subject-verb agreement",
        "Improve readability"
      );
    } else {
      suggestions.push(
        "Check grammar throughout document",
        "Fix spelling errors",
        "Correct punctuation",
        "Improve sentence structure",
        "Fix grammatical errors in current paragraph",
        "Check for common mistakes",
        "Proofread the document"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Check grammar in "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be grammar-corrected
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const potentialIssues = [];
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = "Will check grammar in the selected text";
            potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will check grammar in the "${command.location}" section`;
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will check grammar at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will check grammar in the current paragraph";
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
              potentialIssues.push(...this.detectPotentialIssues(affectedContent));
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will check grammar throughout the entire document";
          potentialIssues.push(...this.detectPotentialIssues(affectedContent));
          break;
        case "end":
          previewText = "Will add grammar-corrected content at the end of the document";
          break;
        default:
          return {
            success: false,
            error: "Invalid grammar correction target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        potentialIssues: potentialIssues.slice(0, 5)
        // Limit to 5 issues
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Detect potential grammar issues in text
   */
  detectPotentialIssues(text) {
    const issues = [];
    const patterns = [
      { pattern: /\bi\s/gi, issue: 'Lowercase "i" should be capitalized' },
      { pattern: /\.\s*[a-z]/g, issue: "Sentence should start with capital letter" },
      { pattern: /\s{2,}/g, issue: "Multiple spaces detected" },
      { pattern: /[.!?]{2,}/g, issue: "Multiple punctuation marks" },
      { pattern: /\s+[.!?,:;]/g, issue: "Space before punctuation" },
      { pattern: /[.!?]\w/g, issue: "Missing space after punctuation" },
      { pattern: /\bteh\b/gi, issue: 'Common typo: "teh" should be "the"' },
      { pattern: /\band\s+and\b/gi, issue: 'Duplicate "and"' },
      { pattern: /\bthe\s+the\b/gi, issue: 'Duplicate "the"' },
      { pattern: /\bis\s+is\b/gi, issue: 'Duplicate "is"' }
    ];
    patterns.forEach(({ pattern, issue }) => {
      if (pattern.test(text)) {
        issues.push(issue);
      }
    });
    return issues;
  }
  /**
   * Get grammar check targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of grammar correction
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        estimatedIssues: 0
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const estimatedIssues = this.detectPotentialIssues(contentToAnalyze).length;
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      estimatedIssues
    };
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        await this.documentEngine.addUserMessage(command.instruction, command);
        const rewrittenContent = await this.providerManager.generateText(
          prompt2.userPrompt,
          {
            systemPrompt: prompt2.systemPrompt,
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          }
        );
        if (!rewrittenContent || rewrittenContent.trim().length === 0) {
          const result2 = {
            success: false,
            error: "AI provider returned empty content",
            editType: "replace"
          };
          await this.documentEngine.addAssistantMessage("Failed to generate rewritten content", result2);
          return result2;
        }
        const result = await this.applyRewrite(command, documentContext, rewrittenContent);
        if (!result.success) {
          await this.documentEngine.addAssistantMessage("Failed to rewrite content", result);
        }
        return result;
      } catch (error) {
        const result = {
          success: false,
          error: error instanceof Error ? error.message : "Rewrite generation failed",
          editType: "replace"
        };
        await this.documentEngine.addAssistantMessage(
          `Error: ${result.error}`,
          result
        );
        return result;
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, rewrittenContent) {
    switch (command.target) {
      case "selection":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "selection",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            const newSectionContent = `${section.heading}

${rewrittenContent}`;
            const startPos = { line: section.range.start, ch: 0 };
            const endPos = { line: section.range.end + 1, ch: 0 };
            const editor = this.documentEngine.getActiveEditor();
            if (!editor) {
              return {
                success: false,
                error: "No active editor",
                editType: "replace"
              };
            }
            editor.replaceRange(newSectionContent, startPos, endPos);
            return {
              success: true,
              content: newSectionContent,
              editType: "replace",
              appliedAt: startPos
            };
          } else {
            return {
              success: false,
              error: `Section "${command.location}" not found`,
              editType: "replace"
            };
          }
        }
      // Fall through to paragraph if no location specified
      case "paragraph":
        if (documentContext.cursorPosition) {
          const editor = this.documentEngine.getActiveEditor();
          if (!editor) {
            return {
              success: false,
              error: "No active editor",
              editType: "replace"
            };
          }
          const currentLine = documentContext.cursorPosition.line;
          let startLine = currentLine;
          let endLine = currentLine;
          while (startLine > 0) {
            const prevLine = editor.getLine(startLine - 1);
            if (prevLine.trim() === "" || prevLine.startsWith("#")) {
              break;
            }
            startLine--;
          }
          const lineCount = editor.lineCount();
          while (endLine < lineCount - 1) {
            const nextLine = editor.getLine(endLine + 1);
            if (nextLine.trim() === "" || nextLine.startsWith("#")) {
              break;
            }
            endLine++;
          }
          const startPos = { line: startLine, ch: 0 };
          const endPos = { line: endLine, ch: editor.getLine(endLine).length };
          editor.replaceRange(rewrittenContent, startPos, endPos);
          return {
            success: true,
            content: rewrittenContent,
            editType: "replace",
            appliedAt: startPos
          };
        } else {
          return {
            success: false,
            error: "No cursor position available",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(rewrittenContent);
      case "end":
        return await this.documentEngine.applyEdit(
          rewrittenContent,
          "end",
          {
            scrollToEdit: true,
            selectNewText: false
          }
        );
      default:
        return {
          success: false,
          error: "Invalid rewrite target",
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command requirements
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.target === "section" && command.action === "rewrite" && command.location) {
      return { valid: true };
    }
    return { valid: true };
  }
  /**
   * Get suggestions for rewrite commands
   */
  getSuggestions(documentContext, hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Rewrite in a more formal tone",
        "Rewrite in a casual tone",
        "Make this more concise",
        "Expand with more detail",
        "Rewrite for clarity",
        "Simplify the language",
        "Make it more engaging",
        "Rewrite in bullet points",
        "Convert to narrative form"
      );
    } else {
      suggestions.push(
        "Rewrite the current paragraph",
        "Rewrite in a different style",
        "Make the writing more engaging",
        "Simplify complex language",
        "Rewrite for different audience",
        "Convert to more formal tone",
        "Make the content more concise"
      );
      if (documentContext.headings.length > 0) {
        documentContext.headings.forEach((heading) => {
          suggestions.push(`Rewrite the "${heading.text}" section`);
        });
      }
    }
    return suggestions.slice(0, 10);
  }
  /**
   * Preview what would be rewritten
   */
  async preview(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found"
        };
      }
      let affectedContent = "";
      let previewText = "";
      const rewriteStyle = this.inferRewriteStyle(command.instruction);
      switch (command.target) {
        case "selection":
          if (documentContext.selectedText) {
            affectedContent = documentContext.selectedText;
            previewText = `Will rewrite the selected text`;
            if (rewriteStyle) {
              previewText += ` (${rewriteStyle})`;
            }
          } else {
            return {
              success: false,
              error: "No text is currently selected"
            };
          }
          break;
        case "section":
          if (command.location) {
            const section = await this.documentEngine.findSection(command.location);
            if (section) {
              affectedContent = section.content;
              previewText = `Will rewrite the "${command.location}" section`;
              if (rewriteStyle) {
                previewText += ` (${rewriteStyle})`;
              }
            } else {
              return {
                success: false,
                error: `Section "${command.location}" not found`
              };
            }
          } else {
            previewText = "Will rewrite content at cursor position";
          }
          break;
        case "paragraph":
          previewText = "Will rewrite the current paragraph";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          if (documentContext.cursorPosition) {
            const editor = this.documentEngine.getActiveEditor();
            if (editor) {
              const currentLine = documentContext.cursorPosition.line;
              let paragraphLines = [];
              let startLine = currentLine;
              let endLine = currentLine;
              while (startLine > 0) {
                const prevLine = editor.getLine(startLine - 1);
                if (prevLine.trim() === "" || prevLine.startsWith("#")) {
                  break;
                }
                startLine--;
              }
              const lineCount = editor.lineCount();
              while (endLine < lineCount - 1) {
                const nextLine = editor.getLine(endLine + 1);
                if (nextLine.trim() === "" || nextLine.startsWith("#")) {
                  break;
                }
                endLine++;
              }
              for (let i = startLine; i <= endLine; i++) {
                paragraphLines.push(editor.getLine(i));
              }
              affectedContent = paragraphLines.join("\n");
            }
          }
          break;
        case "document":
          affectedContent = documentContext.content;
          previewText = "Will rewrite the entire document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        case "end":
          previewText = "Will add rewritten content at the end of the document";
          if (rewriteStyle) {
            previewText += ` (${rewriteStyle})`;
          }
          break;
        default:
          return {
            success: false,
            error: "Invalid rewrite target"
          };
      }
      return {
        success: true,
        preview: previewText,
        affectedContent: affectedContent.length > 200 ? affectedContent.substring(0, 200) + "..." : affectedContent,
        rewriteStyle
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Infer rewrite style from instruction
   */
  inferRewriteStyle(instruction) {
    const lowerInstruction = instruction.toLowerCase();
    if (lowerInstruction.includes("formal")) return "formal tone";
    if (lowerInstruction.includes("casual") || lowerInstruction.includes("informal")) return "casual tone";
    if (lowerInstruction.includes("concise") || lowerInstruction.includes("shorter")) return "more concise";
    if (lowerInstruction.includes("expand") || lowerInstruction.includes("detail")) return "more detailed";
    if (lowerInstruction.includes("simple") || lowerInstruction.includes("simplify")) return "simplified language";
    if (lowerInstruction.includes("engaging") || lowerInstruction.includes("interesting")) return "more engaging";
    if (lowerInstruction.includes("professional")) return "professional tone";
    if (lowerInstruction.includes("bullet") || lowerInstruction.includes("list")) return "bullet point format";
    if (lowerInstruction.includes("narrative") || lowerInstruction.includes("story")) return "narrative style";
    if (lowerInstruction.includes("technical")) return "technical style";
    if (lowerInstruction.includes("creative")) return "creative style";
    return "";
  }
  /**
   * Get rewrite targets available for current context
   */
  getAvailableTargets(documentContext) {
    const targets = ["paragraph", "document", "end"];
    if (documentContext.selectedText) {
      targets.unshift("selection");
    }
    if (documentContext.headings.length > 0) {
      targets.splice(-2, 0, "section");
    }
    return targets;
  }
  /**
   * Estimate the scope of rewriting
   */
  async estimateScope(command) {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      return {
        charactersAffected: 0,
        linesAffected: 0,
        scopeDescription: "No document available",
        rewriteComplexity: "low"
      };
    }
    let charactersAffected = 0;
    let linesAffected = 0;
    let scopeDescription = "";
    let contentToAnalyze = "";
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          charactersAffected = documentContext.selectedText.length;
          linesAffected = documentContext.selectedText.split("\n").length;
          scopeDescription = "Selected text only";
          contentToAnalyze = documentContext.selectedText;
        }
        break;
      case "section":
        if (command.location) {
          const section = await this.documentEngine.findSection(command.location);
          if (section) {
            charactersAffected = section.content.length;
            linesAffected = section.range.end - section.range.start;
            scopeDescription = `"${command.location}" section`;
            contentToAnalyze = section.content;
          }
        }
        break;
      case "paragraph":
        charactersAffected = 100;
        linesAffected = 1;
        scopeDescription = "Current paragraph";
        if (documentContext.surroundingLines) {
          contentToAnalyze = documentContext.surroundingLines.before.join("\n") + "\n" + documentContext.surroundingLines.after.join("\n");
        }
        break;
      case "document":
        charactersAffected = documentContext.content.length;
        linesAffected = documentContext.content.split("\n").length;
        scopeDescription = "Entire document";
        contentToAnalyze = documentContext.content;
        break;
      case "end":
        charactersAffected = 0;
        linesAffected = 0;
        scopeDescription = "New content at end";
        break;
    }
    const rewriteComplexity = this.estimateComplexity(contentToAnalyze, command.instruction);
    return {
      charactersAffected,
      linesAffected,
      scopeDescription,
      rewriteComplexity
    };
  }
  /**
   * Estimate rewrite complexity
   */
  estimateComplexity(content, instruction) {
    const contentLength = content.length;
    const lowerInstruction = instruction.toLowerCase();
    let complexity = "low";
    if (contentLength > 1e3) complexity = "high";
    else if (contentLength > 300) complexity = "medium";
    const complexInstructions = [
      "restructure",
      "reorganize",
      "completely rewrite",
      "transform",
      "change style",
      "different audience",
      "technical",
      "academic"
    ];
    if (complexInstructions.some((term) => lowerInstruction.includes(term))) {
      if (complexity === "low") complexity = "medium";
      else if (complexity === "medium") complexity = "high";
    }
    return complexity;
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Commands (unified) - 2 month early access
  "commands": {
    supernovaDate: "2025-07-31",
    // Supernova early access
    generalDate: "2025-09-30",
    // General availability 
    description: "Command system with : triggers, command button, and custom commands"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = [
  "basic_editing",
  // Add, edit, delete, grammar, rewrite commands
  "all_ai_providers",
  // Claude, OpenAI, Google, Ollama
  "file_conversations",
  // File-scoped conversation history
  "provider_switching",
  // Switch providers in chat
  "mobile_access",
  // Full mobile support
  "api_key_config",
  // Configure own API keys
  "sidebar_chat",
  // Chat interface in sidebar
  "document_context",
  // Current document context
  "multi-doc-context"
  // Reference other documents with [[doc]] syntax
];

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Supernova status
   */
  initializeFeatureFlags() {
    CORE_FEATURES.forEach((featureKey) => {
      this.registerFeature({
        key: featureKey,
        enabled: true,
        description: this.getCoreFeatureDescription(featureKey)
      });
    });
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Get description for core features
   */
  getCoreFeatureDescription(key) {
    const descriptions = {
      "basic_editing": "Basic document editing commands (add, edit, delete, grammar, rewrite)",
      "all_ai_providers": "Access to all AI providers (Claude, OpenAI, Google, Ollama)",
      "file_conversations": "File-scoped conversation history",
      "provider_switching": "Switch AI providers directly in chat interface",
      "mobile_access": "Full mobile device support",
      "api_key_config": "Configure your own API keys",
      "sidebar_chat": "Chat interface in sidebar",
      "document_context": "Current document context in conversations"
    };
    return descriptions[key] || key;
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsSupernova() && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian10.Plugin {
  async onload() {
    try {
      console.log("Nova: onload starting...");
      await this.loadSettings();
      console.log("Nova: settings loaded");
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      console.log("Nova: feature manager initialized");
      this.app.workspace.onLayoutReady(() => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
      });
      (0, import_obsidian10.addIcon)("nova-star", NOVA_ICON_SVG2);
      console.log("Nova: icon registered");
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      console.log("Nova: AI provider manager initialized");
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder();
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      console.log("Nova: document engine and commands initialized");
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      console.log("Nova: view registered");
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      console.log("Nova: ribbon icon added");
      console.log("Nova: ribbon icon element:", ribbonIcon);
      console.log("Nova: ribbon icon innerHTML:", ribbonIcon.innerHTML);
      console.log("Nova: ribbon icon classList:", ribbonIcon.classList.toString());
      this.addCommand({
        id: "nova-add-content",
        name: "Nova: Add content",
        editorCallback: async (editor, ctx) => {
          await this.handleAddCommand();
        }
      });
      this.addCommand({
        id: "nova-edit-content",
        name: "Nova: Edit content",
        editorCallback: async (editor, ctx) => {
          await this.handleEditCommand();
        }
      });
      this.addCommand({
        id: "nova-delete-content",
        name: "Nova: Delete content",
        editorCallback: async (editor, ctx) => {
          await this.handleDeleteCommand();
        }
      });
      this.addCommand({
        id: "nova-fix-grammar",
        name: "Nova: Fix grammar",
        editorCallback: async (editor, ctx) => {
          await this.handleGrammarCommand();
        }
      });
      this.addCommand({
        id: "nova-rewrite-content",
        name: "Nova: Rewrite content",
        editorCallback: async (editor, ctx) => {
          await this.handleRewriteCommand();
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Nova: Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      console.log("Nova: commands registered");
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
      console.log("Nova: settings tab added");
      console.log("Nova: onload completed successfully");
    } catch (error) {
      console.error("Nova: Error in onload:", error);
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    var _a;
    await this.saveData(this.settings);
    (_a = this.aiProviderManager) == null ? void 0 : _a.updateSettings(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle add content command with user input
   */
  async handleAddCommand() {
    const instruction = await this.promptForInstruction("What would you like to add?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.addCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content added successfully");
      } else {
        new import_obsidian10.Notice(`Failed to add content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle edit content command with user input
   */
  async handleEditCommand() {
    const instruction = await this.promptForInstruction("How would you like to edit the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.editCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content edited successfully");
      } else {
        new import_obsidian10.Notice(`Failed to edit content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle delete content command with user input
   */
  async handleDeleteCommand() {
    const instruction = await this.promptForInstruction("What would you like to delete?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.deleteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content deleted successfully");
      } else {
        new import_obsidian10.Notice(`Failed to delete content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle grammar correction command
   */
  async handleGrammarCommand() {
    const documentContext = await this.documentEngine.getDocumentContext();
    if (!documentContext) {
      new import_obsidian10.Notice("No active document found");
      return;
    }
    let target = "document";
    let instruction = "Fix grammar and spelling errors";
    if (documentContext.selectedText) {
      target = "selection";
      instruction = "Fix grammar and spelling errors in the selected text";
    }
    try {
      const command = {
        action: "grammar",
        target,
        instruction
      };
      const result = await this.grammarCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Grammar corrected successfully");
      } else {
        new import_obsidian10.Notice(`Failed to correct grammar: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Handle rewrite content command with user input
   */
  async handleRewriteCommand() {
    const instruction = await this.promptForInstruction("How would you like to rewrite the content?");
    if (!instruction) return;
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      const hasSelection = !!(documentContext == null ? void 0 : documentContext.selectedText);
      const command = this.commandParser.parseCommand(instruction, hasSelection);
      const result = await this.rewriteCommandHandler.execute(command);
      if (result.success) {
        new import_obsidian10.Notice("Content rewritten successfully");
      } else {
        new import_obsidian10.Notice(`Failed to rewrite content: ${result.error}`);
      }
    } catch (error) {
      new import_obsidian10.Notice(`Error: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Prompt user for instruction input
   */
  async promptForInstruction(placeholder) {
    return new Promise((resolve) => {
      const modal = document.createElement("div");
      modal.className = "modal nova-input-modal";
      modal.innerHTML = `
				<div class="modal-container">
					<div class="modal-bg" onclick="this.parentElement.parentElement.remove(); resolve(null);"></div>
					<div class="modal-content">
						<div class="modal-header">
							<h3>Nova AI Command</h3>
							<button class="modal-close-button" onclick="this.closest('.modal').remove(); resolve(null);">\xD7</button>
						</div>
						<div class="modal-body">
							<input type="text" class="nova-instruction-input" placeholder="${placeholder}" autofocus>
						</div>
						<div class="modal-footer">
							<button class="mod-cta nova-submit-btn">Execute</button>
							<button class="nova-cancel-btn">Cancel</button>
						</div>
					</div>
				</div>
			`;
      const input = modal.querySelector(".nova-instruction-input");
      const submitBtn = modal.querySelector(".nova-submit-btn");
      const cancelBtn = modal.querySelector(".nova-cancel-btn");
      const handleSubmit = () => {
        const value = input.value.trim();
        modal.remove();
        resolve(value || null);
      };
      const handleCancel = () => {
        modal.remove();
        resolve(null);
      };
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          handleSubmit();
        } else if (e.key === "Escape") {
          e.preventDefault();
          handleCancel();
        }
      });
      submitBtn.addEventListener("click", handleSubmit);
      cancelBtn.addEventListener("click", handleCancel);
      document.body.appendChild(modal);
      input.focus();
    });
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian10.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9tdWx0aS1kb2MtY29udGV4dC50cyIsICJzcmMvYWkvbW9kZWxzLnRzIiwgInNyYy91aS9pbnB1dC1oYW5kbGVyLnRzIiwgInNyYy91aS93aWtpbGluay1zdWdnZXN0LnRzIiwgInNyYy91aS9zZWN0aW9uLXBpY2tlci50cyIsICJzcmMvdWkvY29tbWFuZC1zeXN0ZW0udHMiLCAic3JjL3VpL2NvbnRleHQtbWFuYWdlci50cyIsICJzcmMvdWkvY2hhdC1yZW5kZXJlci50cyIsICJzcmMvYWkvcHJvdmlkZXItbWFuYWdlci50cyIsICJzcmMvYWkvcHJvdmlkZXJzL2NsYXVkZS50cyIsICJzcmMvYWkvcHJvdmlkZXJzL29wZW5haS50cyIsICJzcmMvYWkvcHJvdmlkZXJzL2dvb2dsZS50cyIsICJzcmMvYWkvcHJvdmlkZXJzL29sbGFtYS50cyIsICJzcmMvY29yZS9kb2N1bWVudC1lbmdpbmUudHMiLCAic3JjL2NvcmUvY29udmVyc2F0aW9uLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvY29udGV4dC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmQtcGFyc2VyLnRzIiwgInNyYy9jb3JlL3Byb21wdC1idWlsZGVyLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL2VkaXQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9kZWxldGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL21ldGFkYXRhLWNvbW1hbmQudHMiLCAic3JjL2xpY2Vuc2luZy9mZWF0dXJlLWNvbmZpZy50cyIsICJzcmMvbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlci50cyIsICJzcmMvbGljZW5zaW5nL2xpY2Vuc2UtdmFsaWRhdG9yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIFdvcmtzcGFjZUxlYWYsIEl0ZW1WaWV3LCBhZGRJY29uLCBOb3RpY2UsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNYXJrZG93bkZpbGVJbmZvLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncywgTm92YVNldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3NyYy9zZXR0aW5ncyc7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4vc3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgTm92YVNpZGViYXJWaWV3LCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSIH0gZnJvbSAnLi9zcmMvdWkvc2lkZWJhci12aWV3JztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi9zcmMvY29yZS9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyc2VyIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kLXBhcnNlcic7XG5pbXBvcnQgeyBQcm9tcHRCdWlsZGVyIH0gZnJvbSAnLi9zcmMvY29yZS9wcm9tcHQtYnVpbGRlcic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyIH0gZnJvbSAnLi9zcmMvY29yZS9jb252ZXJzYXRpb24tbWFuYWdlcic7XG5pbXBvcnQgeyBBZGRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9hZGQtY29tbWFuZCc7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZWRpdC1jb21tYW5kJztcbmltcG9ydCB7IERlbGV0ZUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2RlbGV0ZS1jb21tYW5kJztcbmltcG9ydCB7IEdyYW1tYXJDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9ncmFtbWFyLWNvbW1hbmQnO1xuaW1wb3J0IHsgUmV3cml0ZUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL3Jld3JpdGUtY29tbWFuZCc7XG5pbXBvcnQgeyBNZXRhZGF0YUNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL21ldGFkYXRhLWNvbW1hbmQnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcbmltcG9ydCB7IExpY2Vuc2VWYWxpZGF0b3IgfSBmcm9tICcuL3NyYy9saWNlbnNpbmcvbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi9zcmMvdWkvd2lraWxpbmstc3VnZ2VzdCc7XG5cbmNvbnN0IE5PVkFfSUNPTl9TVkcgPSBgXG48c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPCEtLSBDZW50cmFsIHN0YXIgY29yZSAtLT5cbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuICBcbiAgPCEtLSBQcmltYXJ5IHJheXMgKDQgbWFpbiBkaXJlY3Rpb25zKSAtLT5cbiAgPHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIFxuICA8IS0tIFNlY29uZGFyeSByYXlzIChkaWFnb25hbHMpIC0tPlxuICA8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuPC9zdmc+YDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm92YVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzITogTm92YVNldHRpbmdzO1xuXHRhaVByb3ZpZGVyTWFuYWdlciE6IEFJUHJvdmlkZXJNYW5hZ2VyO1xuXHRkb2N1bWVudEVuZ2luZSE6IERvY3VtZW50RW5naW5lO1xuXHRjb250ZXh0QnVpbGRlciE6IENvbnRleHRCdWlsZGVyO1xuXHRjb21tYW5kUGFyc2VyITogQ29tbWFuZFBhcnNlcjtcblx0cHJvbXB0QnVpbGRlciE6IFByb21wdEJ1aWxkZXI7XG5cdGNvbnZlcnNhdGlvbk1hbmFnZXIhOiBDb252ZXJzYXRpb25NYW5hZ2VyO1xuXHRhZGRDb21tYW5kSGFuZGxlciE6IEFkZENvbW1hbmQ7XG5cdGVkaXRDb21tYW5kSGFuZGxlciE6IEVkaXRDb21tYW5kO1xuXHRkZWxldGVDb21tYW5kSGFuZGxlciE6IERlbGV0ZUNvbW1hbmQ7XG5cdGdyYW1tYXJDb21tYW5kSGFuZGxlciE6IEdyYW1tYXJDb21tYW5kO1xuXHRyZXdyaXRlQ29tbWFuZEhhbmRsZXIhOiBSZXdyaXRlQ29tbWFuZDtcblx0bWV0YWRhdGFDb21tYW5kSGFuZGxlciE6IE1ldGFkYXRhQ29tbWFuZDtcblx0ZmVhdHVyZU1hbmFnZXIhOiBGZWF0dXJlTWFuYWdlcjtcblx0bGljZW5zZVZhbGlkYXRvciE6IExpY2Vuc2VWYWxpZGF0b3I7XG5cdHNldHRpbmdUYWIhOiBOb3ZhU2V0dGluZ1RhYjtcblx0c2lkZWJhclZpZXchOiBOb3ZhU2lkZWJhclZpZXc7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogb25sb2FkIHN0YXJ0aW5nLi4uJyk7XG5cdFx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHNldHRpbmdzIGxvYWRlZCcpO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIGxpY2Vuc2luZyBzeXN0ZW1cblx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvciA9IG5ldyBMaWNlbnNlVmFsaWRhdG9yKCk7XG5cdFx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gbmV3IEZlYXR1cmVNYW5hZ2VyKFxuXHRcdFx0XHR0aGlzLmxpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Ncblx0XHRcdCk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBsaWNlbnNlIGZyb20gc2V0dGluZ3Ncblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KTtcblx0XHRcdH1cblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBmZWF0dXJlIG1hbmFnZXIgaW5pdGlhbGl6ZWQnKTtcblxuXHRcdFx0Ly8gUmVmcmVzaCBTdXBlcm5vdmEgVUkgYWZ0ZXIgbGljZW5zZSB2YWxpZGF0aW9uIHRvIGhhbmRsZSBleHBpcmVkIGxpY2Vuc2VzXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gTm90ZTogTW9iaWxlIGFjY2VzcyByZXN0cmljdGlvbnMgYXJlIG5vdyBoYW5kbGVkIGluIHNpZGViYXIgVUlcblx0XHRcdC8vIFRoaXMgYWxsb3dzIENvcmUgbW9iaWxlIHVzZXJzIHRvIHNlZSB0aGUgdXBncmFkZSBpbnRlcmZhY2UgcmF0aGVyIHRoYW4gYSBicm9rZW4gcGx1Z2luXG5cblx0XHRcdC8vIFJlZ2lzdGVyIGN1c3RvbSBpY29uXG5cdFx0XHRhZGRJY29uKCdub3ZhLXN0YXInLCBOT1ZBX0lDT05fU1ZHKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBpY29uIHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlciA9IG5ldyBBSVByb3ZpZGVyTWFuYWdlcih0aGlzLnNldHRpbmdzLCB0aGlzLmZlYXR1cmVNYW5hZ2VyKTtcblx0XHRcdGF3YWl0IHRoaXMuYWlQcm92aWRlck1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IEFJIHByb3ZpZGVyIG1hbmFnZXIgaW5pdGlhbGl6ZWQnKTtcblxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb252ZXJzYXRpb24gbWFuYWdlciBhbmQgZG9jdW1lbnQgZW5naW5lXG5cdFx0XHRjb25zdCBkYXRhU3RvcmUgPSB7XG5cdFx0XHRcdGxvYWREYXRhOiAoa2V5OiBzdHJpbmcpID0+IHRoaXMubG9hZERhdGFXaXRoS2V5KGtleSksXG5cdFx0XHRcdHNhdmVEYXRhOiAoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdGhpcy5zYXZlRGF0YVdpdGhLZXkoa2V5LCBkYXRhKVxuXHRcdFx0fTtcblx0XHRcdHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IG5ldyBDb252ZXJzYXRpb25NYW5hZ2VyKGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lID0gbmV3IERvY3VtZW50RW5naW5lKHRoaXMuYXBwLCBkYXRhU3RvcmUpO1xuXHRcdFx0dGhpcy5kb2N1bWVudEVuZ2luZS5zZXRDb252ZXJzYXRpb25NYW5hZ2VyKHRoaXMuY29udmVyc2F0aW9uTWFuYWdlcik7XG5cdFx0XHR0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQYXJzZXIgPSBuZXcgQ29tbWFuZFBhcnNlcigpO1xuXHRcdFx0dGhpcy5wcm9tcHRCdWlsZGVyID0gbmV3IFByb21wdEJ1aWxkZXIodGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdFxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kSGFuZGxlciA9IG5ldyBBZGRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZWRpdENvbW1hbmRIYW5kbGVyID0gbmV3IEVkaXRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgRGVsZXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmdyYW1tYXJDb21tYW5kSGFuZGxlciA9IG5ldyBHcmFtbWFyQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlciA9IG5ldyBSZXdyaXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIgPSBuZXcgTWV0YWRhdGFDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBkb2N1bWVudCBlbmdpbmUgYW5kIGNvbW1hbmRzIGluaXRpYWxpemVkJyk7XG5cblx0XHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0XHRWSUVXX1RZUEVfTk9WQV9TSURFQkFSLFxuXHRcdFx0XHQobGVhZikgPT4gbmV3IE5vdmFTaWRlYmFyVmlldyhsZWFmLCB0aGlzKVxuXHRcdFx0KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiB2aWV3IHJlZ2lzdGVyZWQnKTtcblxuXHRcdFx0Ly8gTm90ZTogV2lraWxpbmsgYXV0b2NvbXBsZXRlIGlzIG5vdyBoYW5kbGVkIGRpcmVjdGx5IGluIHNpZGViYXIgdmlld1xuXG5cdFx0XHRjb25zdCByaWJib25JY29uID0gdGhpcy5hZGRSaWJib25JY29uKCdub3ZhLXN0YXInLCAnTm92YSBBSScsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdH0pO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGFkZGVkJyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogcmliYm9uIGljb24gZWxlbWVudDonLCByaWJib25JY29uKTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiByaWJib24gaWNvbiBpbm5lckhUTUw6JywgcmliYm9uSWNvbi5pbm5lckhUTUwpO1xuXHRcdFx0Y29uc29sZS5sb2coJ05vdmE6IHJpYmJvbiBpY29uIGNsYXNzTGlzdDonLCByaWJib25JY29uLmNsYXNzTGlzdC50b1N0cmluZygpKTtcblxuXHRcdFx0Ly8gUmVnaXN0ZXIgY29yZSBkb2N1bWVudCBlZGl0aW5nIGNvbW1hbmRzXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtYWRkLWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogQWRkIGNvbnRlbnQnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUFkZENvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1lZGl0LWNvbnRlbnQnLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogRWRpdCBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVFZGl0Q29tbWFuZCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWRlbGV0ZS1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IERlbGV0ZSBjb250ZW50Jyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVEZWxldGVDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtZml4LWdyYW1tYXInLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogRml4IGdyYW1tYXInLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUdyYW1tYXJDb21tYW5kKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtcmV3cml0ZS1jb250ZW50Jyxcblx0XHRcdFx0bmFtZTogJ05vdmE6IFJld3JpdGUgY29udGVudCcsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlUmV3cml0ZUNvbW1hbmQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnb3Blbi1ub3ZhLXNpZGViYXInLFxuXHRcdFx0XHRuYW1lOiAnTm92YTogT3BlbiBzaWRlYmFyJyxcblx0XHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUubG9nKCdOb3ZhOiBjb21tYW5kcyByZWdpc3RlcmVkJyk7XG5cblx0XHRcdHRoaXMuc2V0dGluZ1RhYiA9IG5ldyBOb3ZhU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcyk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKHRoaXMuc2V0dGluZ1RhYik7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogc2V0dGluZ3MgdGFiIGFkZGVkJyk7XG5cdFx0XHRjb25zb2xlLmxvZygnTm92YTogb25sb2FkIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignTm92YTogRXJyb3IgaW4gb25sb2FkOicsIGVycm9yKTtcblx0XHR9XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcblx0fVxuXG5cdGFzeW5jIGFjdGl2YXRlVmlldygpIHtcblx0XHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gdGhpcy5hcHA7XG5cblx0XHRsZXQgbGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGw7XG5cdFx0Y29uc3QgbGVhdmVzID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblxuXHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0bGVhZiA9IGxlYXZlc1swXTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuXHRcdFx0YXdhaXQgbGVhZj8uc2V0Vmlld1N0YXRlKHsgdHlwZTogVklFV19UWVBFX05PVkFfU0lERUJBUiwgYWN0aXZlOiB0cnVlIH0pO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYhKTtcblx0XHRcblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgdG8gc2lkZWJhciB2aWV3XG5cdFx0aWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBOb3ZhU2lkZWJhclZpZXcpIHtcblx0XHRcdHRoaXMuc2lkZWJhclZpZXcgPSBsZWFmLnZpZXc7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBhZGQgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVBZGRDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBhZGQ/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgYWRkZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gYWRkIGNvbnRlbnQ6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGVkaXQgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVFZGl0Q29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ0hvdyB3b3VsZCB5b3UgbGlrZSB0byBlZGl0IHRoZSBjb250ZW50PycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmVkaXRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCBlZGl0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gZWRpdCBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBkZWxldGUgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVEZWxldGVDb21tYW5kKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGluc3RydWN0aW9uID0gYXdhaXQgdGhpcy5wcm9tcHRGb3JJbnN0cnVjdGlvbignV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkZWxldGU/Jyk7XG5cdFx0aWYgKCFpbnN0cnVjdGlvbikgcmV0dXJuO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG5cdFx0XHRjb25zdCBoYXNTZWxlY3Rpb24gPSAhIShkb2N1bWVudENvbnRleHQ/LnNlbGVjdGVkVGV4dCk7XG5cdFx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnN0cnVjdGlvbiwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0NvbnRlbnQgZGVsZXRlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBkZWxldGUgY29udGVudDogJHtyZXN1bHQuZXJyb3J9YCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZ3JhbW1hciBjb3JyZWN0aW9uIGNvbW1hbmRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlR3JhbW1hckNvbW1hbmQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcblx0XHRpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuXHRcdFx0bmV3IE5vdGljZSgnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIHRhcmdldCBiYXNlZCBvbiBzZWxlY3Rpb25cblx0XHRsZXQgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdkb2N1bWVudCcgPSAnZG9jdW1lbnQnO1xuXHRcdGxldCBpbnN0cnVjdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZXJyb3JzJztcblx0XHRcblx0XHRpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuXHRcdFx0dGFyZ2V0ID0gJ3NlbGVjdGlvbic7XG5cdFx0XHRpbnN0cnVjdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZXJyb3JzIGluIHRoZSBzZWxlY3RlZCB0ZXh0Jztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHtcblx0XHRcdFx0YWN0aW9uOiAnZ3JhbW1hcicgYXMgY29uc3QsXG5cdFx0XHRcdHRhcmdldCxcblx0XHRcdFx0aW5zdHJ1Y3Rpb25cblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdHcmFtbWFyIGNvcnJlY3RlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjb3JyZWN0IGdyYW1tYXI6ICR7cmVzdWx0LmVycm9yfWApO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHJld3JpdGUgY29udGVudCBjb21tYW5kIHdpdGggdXNlciBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVSZXdyaXRlQ29tbWFuZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnN0cnVjdGlvbiA9IGF3YWl0IHRoaXMucHJvbXB0Rm9ySW5zdHJ1Y3Rpb24oJ0hvdyB3b3VsZCB5b3UgbGlrZSB0byByZXdyaXRlIHRoZSBjb250ZW50PycpO1xuXHRcdGlmICghaW5zdHJ1Y3Rpb24pIHJldHVybjtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoZG9jdW1lbnRDb250ZXh0Py5zZWxlY3RlZFRleHQpO1xuXHRcdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMuY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5zdHJ1Y3Rpb24sIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnQ29udGVudCByZXdyaXR0ZW4gc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmV3cml0ZSBjb250ZW50OiAke3Jlc3VsdC5lcnJvcn1gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFByb21wdCB1c2VyIGZvciBpbnN0cnVjdGlvbiBpbnB1dFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwcm9tcHRGb3JJbnN0cnVjdGlvbihwbGFjZWhvbGRlcjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0XHRjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0bW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsIG5vdmEtaW5wdXQtbW9kYWwnO1xuXHRcdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJnXCIgb25jbGljaz1cInRoaXMucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZSgpOyByZXNvbHZlKG51bGwpO1wiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHRcdDxoMz5Ob3ZhIEFJIENvbW1hbmQ8L2gzPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kYWwtY2xvc2UtYnV0dG9uXCIgb25jbGljaz1cInRoaXMuY2xvc2VzdCgnLm1vZGFsJykucmVtb3ZlKCk7IHJlc29sdmUobnVsbCk7XCI+XHUwMEQ3PC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHRcdDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwibm92YS1pbnN0cnVjdGlvbi1pbnB1dFwiIHBsYWNlaG9sZGVyPVwiJHtwbGFjZWhvbGRlcn1cIiBhdXRvZm9jdXM+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cblx0XHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS1zdWJtaXQtYnRuXCI+RXhlY3V0ZTwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jYW5jZWwtYnRuXCI+Q2FuY2VsPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBpbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWluc3RydWN0aW9uLWlucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcblx0XHRcdGNvbnN0IHN1Ym1pdEJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXN1Ym1pdC1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRcdGNvbnN0IGNhbmNlbEJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNhbmNlbC1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblxuXHRcdFx0Y29uc3QgaGFuZGxlU3VibWl0ID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlLnRyaW0oKTtcblx0XHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0XHRcdHJlc29sdmUodmFsdWUgfHwgbnVsbCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRjb25zdCBoYW5kbGVDYW5jZWwgPSAoKSA9PiB7XG5cdFx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdFx0XHRyZXNvbHZlKG51bGwpO1xuXHRcdFx0fTtcblxuXHRcdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG5cdFx0XHRcdGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRoYW5kbGVTdWJtaXQoKTtcblx0XHRcdFx0fSBlbHNlIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0aGFuZGxlQ2FuY2VsKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVTdWJtaXQpO1xuXHRcdFx0Y2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ2FuY2VsKTtcblxuXHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cdFx0XHRpbnB1dC5mb2N1cygpO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNob3cgdXBncmFkZSBwcm9tcHQgZm9yIENvcmUgdGllciBtb2JpbGUgdXNlcnNcblx0ICovXG5cdHByaXZhdGUgc2hvd01vYmlsZVVwZ3JhZGVQcm9tcHQoKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRtb2RhbC5jbGFzc05hbWUgPSAnbW9kYWwgbm92YS1tb2JpbGUtdXBncmFkZS1tb2RhbCc7XG5cdFx0bW9kYWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYmdcIj48L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+XG5cdFx0XHRcdFx0XHQ8aDM+Tm92YSBTdXBlck5vdmEgUmVxdWlyZWQ8L2gzPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aWVyLWJhZGdlIGNvcmVcIiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDFlbTtcIj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLWljb25cIj5GUkVFPC9zcGFuPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItbmFtZVwiPkNvcmUgKEZyZWUpPC9zcGFuPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8cD5Nb2JpbGUgYWNjZXNzIGlzIGF2YWlsYWJsZSB3aXRoIE5vdmEgU3VwZXJOb3ZhLjwvcD5cblx0XHRcdFx0XHRcdDxwPkNvcmUgdGllciBpcyBsaW1pdGVkIHRvIGRlc2t0b3AgdXNlIG9ubHkuPC9wPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtZmVhdHVyZS1saXN0XCI+XG5cdFx0XHRcdFx0XHRcdDxoND5TdXBlck5vdmEgaW5jbHVkZXM6PC9oND5cblx0XHRcdFx0XHRcdFx0PHVsPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Nb2JpbGUgZGV2aWNlIHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5NdWx0aXBsZSBBSSBwcm92aWRlcnM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Jbi1jaGF0IHByb3ZpZGVyIHN3aXRjaGluZzwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkFkdmFuY2VkIHRlbXBsYXRlczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vZC1jdGEgbm92YS11cGdyYWRlLWJ0blwiPlVwZ3JhZGUgdG8gU3VwZXJOb3ZhPC9idXR0b24+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1jbG9zZS1idG5cIj5DbG9zZTwvYnV0dG9uPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHRjb25zdCB1cGdyYWRlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtdXBncmFkZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBjbG9zZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNsb3NlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IG1vZGFsQmcgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYmcnKSBhcyBIVE1MRWxlbWVudDtcblxuXHRcdGNvbnN0IGNsb3NlTW9kYWwgPSAoKSA9PiB7XG5cdFx0XHRtb2RhbC5yZW1vdmUoKTtcblx0XHR9O1xuXG5cdFx0dXBncmFkZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHdpbmRvdy5vcGVuKCdodHRwczovL25vdmF3cml0ZXIuYWkvdXBncmFkZScsICdfYmxhbmsnKTtcblx0XHRcdGNsb3NlTW9kYWwoKTtcblx0XHR9KTtcblxuXHRcdGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cdFx0bW9kYWxCZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtb2RhbCk7XG5cblx0XHQvLyBTaG93IG5vdGljZSBhcyB3ZWxsXG5cdFx0bmV3IE5vdGljZSgnTm92YSBtb2JpbGUgYWNjZXNzIHJlcXVpcmVzIFN1cGVyTm92YSBsaWNlbnNlJywgODAwMCk7XG5cdH1cblxuXHQvLyBEYXRhU3RvcmUgaW50ZXJmYWNlIGltcGxlbWVudGF0aW9uIGZvciBDb252ZXJzYXRpb25NYW5hZ2VyXG5cdGFzeW5jIGxvYWREYXRhV2l0aEtleShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcblx0XHRyZXR1cm4gYWxsRGF0YSA/IGFsbERhdGFba2V5XSA6IHVuZGVmaW5lZDtcblx0fVxuXG5cdGFzeW5jIHNhdmVEYXRhV2l0aEtleShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWxsRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKSB8fCB7fTtcblx0XHRhbGxEYXRhW2tleV0gPSBkYXRhO1xuXHRcdHJldHVybiBhd2FpdCB0aGlzLnNhdmVEYXRhKGFsbERhdGEpO1xuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXJTZXR0aW5ncywgUGxhdGZvcm1TZXR0aW5ncywgUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi9haS90eXBlcyc7XG5pbXBvcnQgeyBEZWJ1Z1NldHRpbmdzIH0gZnJvbSAnLi9saWNlbnNpbmcvdHlwZXMnO1xuaW1wb3J0IHsgVklFV19UWVBFX05PVkFfU0lERUJBUiwgTm92YVNpZGViYXJWaWV3IH0gZnJvbSAnLi91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgZ2V0QXZhaWxhYmxlTW9kZWxzIH0gZnJvbSAnLi9haS9tb2RlbHMnO1xuXG5jb25zdCBOT1ZBX0lDT05fU1ZHID0gYFxuPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XG4gIDwhLS0gQ2VudHJhbCBzdGFyIGNvcmUgLS0+XG4gIDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cbiAgXG4gIDwhLS0gUHJpbWFyeSByYXlzICg0IG1haW4gZGlyZWN0aW9ucykgLS0+XG4gIDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICBcbiAgPCEtLSBTZWNvbmRhcnkgcmF5cyAoZGlhZ29uYWxzKSAtLT5cbiAgPHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbjwvc3ZnPmA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tQ29tbWFuZCB7XG5cdGlkOiBzdHJpbmc7XG5cdG5hbWU6IHN0cmluZztcblx0dHJpZ2dlcjogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3ZhU2V0dGluZ3Mge1xuXHRhaVByb3ZpZGVyczogQUlQcm92aWRlclNldHRpbmdzO1xuXHRwbGF0Zm9ybVNldHRpbmdzOiBQbGF0Zm9ybVNldHRpbmdzO1xuXHRjdXN0b21Db21tYW5kcz86IEN1c3RvbUNvbW1hbmRbXTtcblx0Z2VuZXJhbDoge1xuXHRcdGRlZmF1bHRUZW1wZXJhdHVyZTogbnVtYmVyO1xuXHRcdGRlZmF1bHRNYXhUb2tlbnM6IG51bWJlcjtcblx0XHRhdXRvU2F2ZTogYm9vbGVhbjtcblx0fTtcblx0c2hvd0NvbW1hbmRCdXR0b246IGJvb2xlYW47XG5cdGxpY2Vuc2luZzoge1xuXHRcdGxpY2Vuc2VLZXk6IHN0cmluZztcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5Pzogc3RyaW5nO1xuXHRcdGlzU3VwZXJub3ZhPzogYm9vbGVhbjtcblx0XHRkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzO1xuXHR9O1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTm92YVNldHRpbmdzID0ge1xuXHRhaVByb3ZpZGVyczoge1xuXHRcdGNsYXVkZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0b3BlbmFpOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0YmFzZVVybDogJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnLFxuXHRcdFx0bW9kZWw6ICdncHQtNG8nLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH0sXG5cdFx0Z29vZ2xlOiB7XG5cdFx0XHRhcGlLZXk6ICcnLFxuXHRcdFx0bW9kZWw6ICdnZW1pbmktMS41LWZsYXNoJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9sbGFtYToge1xuXHRcdFx0YmFzZVVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuXHRcdFx0bW9kZWw6ICcnLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH1cblx0fSxcblx0cGxhdGZvcm1TZXR0aW5nczoge1xuXHRcdGRlc2t0b3A6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ29sbGFtYScsXG5cdFx0XHRmYWxsYmFja1Byb3ZpZGVyczogWydvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0fSxcblx0XHRtb2JpbGU6IHtcblx0XHRcdHByaW1hcnlQcm92aWRlcjogJ25vbmUnLFxuXHRcdFx0ZmFsbGJhY2tQcm92aWRlcnM6IFsnb3BlbmFpJywgJ2dvb2dsZSddXG5cdFx0fVxuXHR9LFxuXHRjdXN0b21Db21tYW5kczogW10sXG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IDAuNyxcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiAxMDAwLFxuXHRcdGF1dG9TYXZlOiB0cnVlXG5cdH0sXG5cdHNob3dDb21tYW5kQnV0dG9uOiB0cnVlLFxuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiAnJyxcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5OiAnJyxcblx0XHRpc1N1cGVybm92YTogZmFsc2UsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRvdmVycmlkZURhdGU6IHVuZGVmaW5lZCxcblx0XHRcdGZvcmNlU3VwZXJub3ZhOiBmYWxzZVxuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGNsYXNzIE5vdmFTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnTm92YSBBSSBTZXR0aW5ncycgfSk7XG5cblx0XHR0aGlzLmNyZWF0ZUxpY2Vuc2VTZXR0aW5ncygpO1xuXHRcdHRoaXMuY3JlYXRlR2VuZXJhbFNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQbGF0Zm9ybVNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlclNldHRpbmdzKCk7XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kU2V0dGluZ3MoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlTGljZW5zZVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29uc3QgbGljZW5zZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zZWN0aW9uJyB9KTtcblx0XHRsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1N1cGVybm92YSBTdXBwb3J0ZXIgU3RhdHVzJyB9KTtcblxuXHRcdC8vIEluZm8gYWJvdXQgdGhlIG5ldyBtb2RlbFxuXHRcdGNvbnN0IGluZm9FbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tb2RlbC1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkIGNvbXBhY3RcIj5cblx0XHRcdFx0PHA+Tm92YSBwcm92aWRlcyBhbGwgZmVhdHVyZXMgZm9yIGZyZWUgd2hlbiB5b3UgdXNlIHlvdXIgb3duIEFJIHByb3ZpZGVyIEFQSSBrZXlzLiBcblx0XHRcdFx0U3VwZXJub3ZhIHN1cHBvcnRlcnMgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmlzU3VwZXJub3ZhU3VwcG9ydGVyKCkgfHwgZmFsc2U7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhTGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRTdXBlcm5vdmFMaWNlbnNlKCk7XG5cdFx0XG5cdFx0Y29uc3Qgc3RhdHVzRGlzcGxheSA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdXBlcm5vdmEtc3RhdHVzJyB9KTtcblx0XHRjb25zdCBzdGF0dXNUZXh0ID0gaXNTdXBlcm5vdmEgPyAnU3VwZXJub3ZhIFN1cHBvcnRlcicgOiAnTm92YSBVc2VyJztcblx0XHRjb25zdCBzdGF0dXNJY29uID0gaXNTdXBlcm5vdmEgPyBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3R5bGU9XCJ3aWR0aDogMTRweDsgaGVpZ2h0OiAxNHB4OyBjb2xvcjogIzkzMzNlYTsgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgNHB4IHJnYmEoMTQ3LCA1MSwgMjM0LCAwLjYpKTtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5gIDogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0eWxlPVwid2lkdGg6IDE0cHg7IGhlaWdodDogMTRweDsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj5cblx0XHRcdCR7Tk9WQV9JQ09OX1NWR31cblx0XHQ8L3N2Zz5gO1xuXHRcdHN0YXR1c0Rpc3BsYXkuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3RhdHVzLWJhZGdlICR7aXNTdXBlcm5vdmEgPyAnc3VwZXJub3ZhJyA6ICdub3ZhJ31cIj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJzdGF0dXMtaWNvblwiPiR7c3RhdHVzSWNvbn08L3NwYW4+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLW5hbWVcIj4ke3N0YXR1c1RleHR9PC9zcGFuPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIHN0YXR1c1xuXHRcdGlmIChzdXBlcm5vdmFMaWNlbnNlKSB7XG5cdFx0XHRjb25zdCBzdGF0dXNFbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXN0YXR1cycgfSk7XG5cdFx0XHRjb25zdCBleHBpcnlUZXh0ID0gc3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQgXG5cdFx0XHRcdD8gYEV4cGlyZXM6ICR7c3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdFx0XHQ6ICdMaWZldGltZSBTdXBwb3J0Jztcblx0XHRcdHN0YXR1c0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cImxpY2Vuc2UtaW5mb1wiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1lbWFpbFwiPiR7c3VwZXJub3ZhTGljZW5zZS5lbWFpbH08L3NwYW4+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJsaWNlbnNlLWV4cGlyeVwiPiR7ZXhwaXJ5VGV4dH08L3NwYW4+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHR9XG5cblx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgaW5wdXRcblx0XHRuZXcgU2V0dGluZyhsaWNlbnNlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ1N1cGVybm92YSBMaWNlbnNlIEtleSAoT3B0aW9uYWwpJylcblx0XHRcdC5zZXREZXNjKCdFbnRlciB5b3VyIFN1cGVybm92YSBzdXBwb3J0ZXIgbGljZW5zZSBrZXkgZm9yIGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3Bhc3N3b3JkJztcblx0XHRcdFx0dGV4dC5zZXRQbGFjZWhvbGRlcignRW50ZXIgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5Li4uJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgU3VwZXJub3ZhIGxpY2Vuc2UgaW4gZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBkaXNwbGF5IHRvIHNob3cgdXBkYXRlZCBzdGF0dXNcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gQWRkIHZhbGlkYXRpb24gYnV0dG9uXG5cdFx0XHRcdGNvbnN0IHZhbGlkYXRlQnV0dG9uID0gdGV4dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/LmNyZWF0ZUVsKCdidXR0b24nLCB7XG5cdFx0XHRcdFx0dGV4dDogJ1ZhbGlkYXRlJyxcblx0XHRcdFx0XHRjbHM6ICdub3ZhLXZhbGlkYXRlLWJ0bidcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAodmFsaWRhdGVCdXR0b24pIHtcblx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IGxpY2Vuc2VLZXkgPSB0ZXh0LmlucHV0RWwudmFsdWU7XG5cdFx0XHRcdFx0XHRpZiAoIWxpY2Vuc2VLZXkpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1BsZWFzZSBlbnRlciBhIFN1cGVybm92YSBsaWNlbnNlIGtleSBmaXJzdC4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdWYWxpZGF0aW5nLi4uJztcblx0XHRcdFx0XHRcdHZhbGlkYXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShsaWNlbnNlS2V5KTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzU3VwZXJub3ZhU3VwcG9ydGVyKCk7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnVmFsaWQgU3VwZXJub3ZhIGxpY2Vuc2UhIFlvdSBub3cgaGF2ZSBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLicsICdzdWNjZXNzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dDb25mZXR0aSgpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnSW52YWxpZCBvciBleHBpcmVkIFN1cGVybm92YSBsaWNlbnNlIGtleS4nLCAnZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdFcnJvciB2YWxpZGF0aW5nIFN1cGVybm92YSBsaWNlbnNlLicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRcdFx0dmFsaWRhdGVCdXR0b24udGV4dENvbnRlbnQgPSAnVmFsaWRhdGUnO1xuXHRcdFx0XHRcdFx0XHR2YWxpZGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdC8vIFN1cGVybm92YSBzdXBwb3J0ZXIgaW5mb3JtYXRpb24gb25seVxuXHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhSW5mbyhsaWNlbnNlQ29udGFpbmVyKTtcblxuXHRcdC8vIERlYnVnIHNldHRpbmdzIChkZXZlbG9wbWVudCBvbmx5KVxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyB8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHR0aGlzLmNyZWF0ZURlYnVnU2V0dGluZ3MobGljZW5zZUNvbnRhaW5lcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFJbmZvKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBTdXBlcm5vdmEgc3VwcG9ydGVyIGluZm9ybWF0aW9uXG5cdFx0Y29uc3Qgc3VwZXJub3ZhSW5mbyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1cGVybm92YS1pbmZvJyB9KTtcblx0XHRzdXBlcm5vdmFJbmZvLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDU+QmVjb21lIGEgU3VwZXJub3ZhIFN1cHBvcnRlcjwvaDU+XG5cdFx0XHRcdDxwPlN1cHBvcnQgTm92YSBkZXZlbG9wbWVudCBhbmQgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuIEFsbCBmZWF0dXJlcyBldmVudHVhbGx5IGJlY29tZSBmcmVlIGZvciBldmVyeW9uZS48L3A+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+RWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcyAoMy02IG1vbnRocyBiZWZvcmUgZ2VuZXJhbCByZWxlYXNlKTwvbGk+XG5cdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQgYW5kIGZlYXR1cmUgcmVxdWVzdHM8L2xpPlxuXHRcdFx0XHRcdDxsaT5TdXBwb3J0ZXIgYmFkZ2UgYW5kIHJlY29nbml0aW9uPC9saT5cblx0XHRcdFx0XHQ8bGk+RGlyZWN0bHkgc3VwcG9ydCBvcGVuLXNvdXJjZSBkZXZlbG9wbWVudDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1NldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBkZWJ1Z0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0RldmVsb3BtZW50IFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0RlYnVnIE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXZlbG9wbWVudCB0ZXN0aW5nIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIGRlYnVnIG9wdGlvbnNcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnT3ZlcnJpZGUgRGF0ZScpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBjdXJyZW50IGRhdGUgZm9yIHRlc3RpbmcgdGltZS1nYXRlZCBmZWF0dXJlcyAoWVlZWS1NTS1ERCknKVxuXHRcdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzIwMjUtMTItMDEnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgcmVmcmVzaCBkaXNwbGF5IG9uIGV2ZXJ5IGtleXN0cm9rZSAtIGp1c3QgdXBkYXRlIHRoZSBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnRm9yY2UgU3VwZXJub3ZhIFN0YXR1cycpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBTdXBlcm5vdmEgc3VwcG9ydGVyIHN0YXR1cyBmb3IgdGVzdGluZycpXG5cdFx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSB8fCBmYWxzZSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gU2hvdyBjb25mZXR0aSB3aGVuIHR1cm5pbmcgT04gRm9yY2UgU3VwZXJub3ZhXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93Q29uZmV0dGkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdyB1cGRhdGVkIGZlYXR1cmUgc3RhdHVzXG5cdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdC8vIENsZWFyIGxpY2Vuc2VzIGJ1dHRvblxuXHRcdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKCdDbGVhciBBbGwgTGljZW5zZXMnKVxuXHRcdFx0XHQuc2V0RGVzYygnUmVtb3ZlIGFsbCBhcHBsaWVkIGxpY2Vuc2VzIChmb3IgdGVzdGluZyknKVxuXHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgTGljZW5zZXMnKVxuXHRcdFx0XHRcdC5zZXRXYXJuaW5nKClcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBDb25maXJtIGFjdGlvblxuXHRcdFx0XHRcdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBsaWNlbnNlcz8gVGhpcyB3aWxsIHJlbW92ZSBhbnkgYXBwbGllZCBTdXBlcm5vdmEgbGljZW5zZS4nKTtcblx0XHRcdFx0XHRcdGlmICghY29uZmlybWVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdC8vIENsZWFyIGxpY2Vuc2Uga2V5XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9ICcnO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBDbGVhciBGb3JjZSBTdXBlcm5vdmEgaWYgZW5hYmxlZFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShudWxsKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhclxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuXHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0FsbCBsaWNlbnNlcyBjbGVhcmVkIHN1Y2Nlc3NmdWxseS4nLCAnc3VjY2VzcycpO1xuXG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXlcblx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdH0pKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dMaWNlbnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIHR5cGU6ICdzdWNjZXNzJyB8ICdlcnJvcicpIHtcblx0XHQvLyBDcmVhdGUgb3IgdXBkYXRlIG1lc3NhZ2UgZWxlbWVudFxuXHRcdGNvbnN0IGV4aXN0aW5nTWVzc2FnZSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtbGljZW5zZS1tZXNzYWdlJyk7XG5cdFx0aWYgKGV4aXN0aW5nTWVzc2FnZSkge1xuXHRcdFx0ZXhpc3RpbmdNZXNzYWdlLnJlbW92ZSgpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgXG5cdFx0XHRjbHM6IGBub3ZhLWxpY2Vuc2UtbWVzc2FnZSAke3R5cGV9YCxcblx0XHRcdHRleHQ6IG1lc3NhZ2Vcblx0XHR9KTtcblxuXHRcdC8vIEF1dG8tcmVtb3ZlIGFmdGVyIDUgc2Vjb25kc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0bWVzc2FnZUVsLnJlbW92ZSgpO1xuXHRcdH0sIDUwMDApO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29uZmV0dGkoKSB7XG5cdFx0Ly8gQ3JlYXRlIGNvbmZldHRpIGNvbnRhaW5lclxuXHRcdGNvbnN0IGNvbmZldHRpQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0Y29uZmV0dGlDb250YWluZXIuY2xhc3NOYW1lID0gJ25vdmEtY29uZmV0dGktY29udGFpbmVyJztcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbmZldHRpQ29udGFpbmVyKTtcblxuXHRcdC8vIEdldCBzZXR0aW5ncyBjb250YWluZXIgcG9zaXRpb24gZm9yIGV4cGxvc2lvbiBjZW50ZXJcblx0XHRjb25zdCByZWN0ID0gdGhpcy5jb250YWluZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRjb25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7XG5cdFx0Y29uc3QgY2VudGVyWSA9IHJlY3QudG9wICsgTWF0aC5taW4ocmVjdC5oZWlnaHQgLyAyLCAzMDApO1xuXG5cdFx0Ly8gQ29sb3JzIGZvciBjb25mZXR0aVxuXHRcdGNvbnN0IGNvbG9ycyA9IFsnZ29sZCcsICdibHVlJywgJ3BpbmsnLCAnZ3JlZW4nLCAncmVkJywgJyddOyAgLy8gZW1wdHkgc3RyaW5nID0gZGVmYXVsdCBwdXJwbGVcblxuXHRcdC8vIENyZWF0ZSBjb25mZXR0aSBwaWVjZXNcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7XG5cdFx0XHRjb25zdCBjb25mZXR0aSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0Y29uZmV0dGkuY2xhc3NOYW1lID0gYG5vdmEtY29uZmV0dGktcGllY2UgJHtjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldfWA7XG5cdFx0XHRcblx0XHRcdC8vIFBvc2l0aW9uIGF0IGV4cGxvc2lvbiBjZW50ZXJcblx0XHRcdGNvbmZldHRpLnN0eWxlLmxlZnQgPSBgJHtjZW50ZXJYfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLnRvcCA9IGAke2NlbnRlcll9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgZXhwbG9zaW9uIHRyYWplY3Rvcnlcblx0XHRcdGNvbnN0IGFuZ2xlID0gKE1hdGguUEkgKiAyICogaSkgLyAxNTAgKyAoTWF0aC5yYW5kb20oKSAqIDAuMiAtIDAuMSk7XG5cdFx0XHRjb25zdCB2ZWxvY2l0eSA9IDI1MCArIE1hdGgucmFuZG9tKCkgKiAzNTA7IC8vIHBpeGVsc1xuXHRcdFx0Y29uc3QgZXhwbG9kZVggPSBNYXRoLmNvcyhhbmdsZSkgKiB2ZWxvY2l0eTtcblx0XHRcdGNvbnN0IGV4cGxvZGVZID0gTWF0aC5zaW4oYW5nbGUpICogdmVsb2NpdHkgLSAxNTA7IC8vIFN0cm9uZyB1cHdhcmQgYmlhc1xuXHRcdFx0XG5cdFx0XHQvLyBTZXQgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzIGZvciBhbmltYXRpb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLnNldFByb3BlcnR5KCctLWV4cGxvZGUteCcsIGAke2V4cGxvZGVYfXB4YCk7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1leHBsb2RlLXknLCBgJHtleHBsb2RlWX1weGApO1xuXHRcdFx0XG5cdFx0XHQvLyBSYW5kb20gZGVsYXkgZm9yIHN0YWdnZXJlZCBleHBsb3Npb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gYCR7TWF0aC5yYW5kb20oKSAqIDAuMn1zYDtcblx0XHRcdFxuXHRcdFx0Ly8gUmFuZG9tIHNpemVcblx0XHRcdGNvbnN0IHNpemUgPSA2ICsgTWF0aC5yYW5kb20oKSAqIDE0O1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUud2lkdGggPSBgJHtzaXplfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemV9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBNYWtlIHNvbWUgY29uZmV0dGkgcmVjdGFuZ3VsYXJcblx0XHRcdGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG5cdFx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemUgKiAwLjR9cHhgO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb25mZXR0aSk7XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGNvbnRhaW5lciBhZnRlciBhbmltYXRpb24gY29tcGxldGVzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5yZW1vdmUoKTtcblx0XHR9LCA0MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR2VuZXJhbFNldHRpbmdzKCkge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnR2VuZXJhbCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IFRlbXBlcmF0dXJlJylcblx0XHRcdC5zZXREZXNjKCdDb250cm9scyByYW5kb21uZXNzIGluIEFJIHJlc3BvbnNlcyAoMC4wIC0gMS4wKScpXG5cdFx0XHQuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcblx0XHRcdFx0LnNldExpbWl0cygwLCAxLCAwLjEpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSlcblx0XHRcdFx0LnNldER5bmFtaWNUb29sdGlwKClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgTWF4IFRva2VucycpXG5cdFx0XHQuc2V0RGVzYygnTWF4aW11bSBsZW5ndGggb2YgQUkgcmVzcG9uc2VzJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzEwMDAnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zLnRvU3RyaW5nKCkpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zdCBudW1WYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcblx0XHRcdFx0XHRpZiAoIWlzTmFOKG51bVZhbHVlKSAmJiBudW1WYWx1ZSA+IDApIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2VucyA9IG51bVZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdBdXRvLXNhdmUgc2V0dGluZ3MnKVxuXHRcdFx0LnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgc2F2ZSBzZXR0aW5ncyB3aGVuIGNoYW5nZWQnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5hdXRvU2F2ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJTZXR0aW5ncygpIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb2xsYXBzaWJsZSBoZWFkZXJcblx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29sbGFwc2libGUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiA4cHggMDtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAxNnB4O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgYXJyb3dFbCA9IGhlYWRlckVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWFycm93JyB9KTtcblx0XHRhcnJvd0VsLmlubmVySFRNTCA9ICdcdTI1QjYnO1xuXHRcdGFycm93RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRcdGZvbnQtc2l6ZTogMTJweDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdBSSBQcm92aWRlciBTZXR0aW5ncycgfSk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZmxleDogMTsnO1xuXG5cdFx0Y29uc3QgcHJvdmlkZXJDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdHByb3ZpZGVyQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogbm9uZTsnOyAvLyBTdGFydCBjb2xsYXBzZWRcblx0XHRcblx0XHQvLyBUb2dnbGUgZnVuY3Rpb25hbGl0eVxuXHRcdGhlYWRlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgaXNWaXNpYmxlID0gcHJvdmlkZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuXHRcdFx0cHJvdmlkZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXG5cdFx0Ly8gSW5mbyBhYm91dCBBUEkga2V5cyBhbmQgbW9kZWwgcmVjb21tZW5kYXRpb25zXG5cdFx0Y29uc3QgaW5mb0VsID0gcHJvdmlkZXJDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5Db25maWd1cmUgWW91ciBBUEkgS2V5czwvaDQ+XG5cdFx0XHRcdDxwPk5vdmEgY29ubmVjdHMgdG8gQUkgcHJvdmlkZXJzIHVzaW5nIHlvdXIgb3duIEFQSSBrZXlzLiBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIC0gXG5cdFx0XHRcdGp1c3QgYWRkIHlvdXIgQVBJIGtleXMgYmVsb3cgdG8gZ2V0IHN0YXJ0ZWQuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmQgbm92YS1tb2RlbC1ndWlkYW5jZVwiPlxuXHRcdFx0XHQ8aDQ+UmVjb21tZW5kZWQgRGVmYXVsdHM8L2g0PlxuXHRcdFx0XHQ8dWwgY2xhc3M9XCJub3ZhLW1vZGVsLXJlY29tbWVuZGF0aW9uc1wiPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkNsYXVkZSBTb25uZXQgNDwvc3Ryb25nPiAtIExhdGVzdCBnZW5lcmF0aW9uIHdpdGggZXhjZWxsZW50IGluc3RydWN0aW9uIGZvbGxvd2luZyBmb3IgY29sbGFib3JhdGl2ZSBlZGl0aW5nPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HUFQtNC4xIE1pbmk8L3N0cm9uZz4gLSBDdXJyZW50LWdlbmVyYXRpb24gbW9kZWwgdGhhdCBvdXRwZXJmb3JtcyBHUFQtNG8gd2hpbGUgcmVtYWluaW5nIGNvc3QtZWZmZWN0aXZlPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HZW1pbmkgMi41IEZsYXNoPC9zdHJvbmc+IC0gQmVzdCBwcmljZS9wZXJmb3JtYW5jZSB3aXRoIFwidGhpbmtpbmdcIiBjYXBhYmlsaXRpZXMgYW5kIHN0cm9uZyBjb2Rpbmcgc3VwcG9ydDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHRcdDxwIGNsYXNzPVwibm92YS1ndWlkYW5jZS1ub3RlXCI+VGhlc2UgZGVmYXVsdHMgb2ZmZXIgbW9kZXJuIEFJIGNhcGFiaWxpdGllcyB3aXRob3V0IHByZW1pdW0gcHJpY2luZy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gU2hvdyBhbGwgcHJvdmlkZXJzIC0gbm8gcmVzdHJpY3Rpb25zXG5cdFx0dGhpcy5jcmVhdGVPbGxhbWFTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVDbGF1ZGVTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVHb29nbGVTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVPcGVuQUlTZXR0aW5ncyhwcm92aWRlckNvbnRhaW5lcik7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNsYXVkZVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IGNsYXVkZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0Y2xhdWRlQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NsYXVkZSAoQW50aHJvcGljKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjbGF1ZGVDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQVBJIEtleScpXG5cdFx0XHQuc2V0RGVzYygnWW91ciBBbnRocm9waWMgQVBJIGtleScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdzay1hbnQtLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIE1vZGVsIHNldHRpbmcgd2l0aCByZWZyZXNoIGJ1dHRvblxuXHRcdGNvbnN0IG1vZGVsU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNsYXVkZUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnQ2xhdWRlIG1vZGVsIHRvIHVzZScpO1xuXG5cdFx0bGV0IG1vZGVsRHJvcGRvd246IGFueTtcblx0XHRcblx0XHRtb2RlbFNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0bW9kZWxEcm9wZG93biA9IGRyb3Bkb3duO1xuXHRcdFx0dGhpcy5wb3B1bGF0ZUNsYXVkZU1vZGVscyhkcm9wZG93bik7XG5cdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5tb2RlbCB8fCAnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0Jylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIENsYXVkZSBtb2RlbHMgYXJlIGhhcmRjb2RlZCAtIG5vIHJlZnJlc2ggbmVlZGVkXG5cdH1cblxuXHRwcml2YXRlIHBvcHVsYXRlQ2xhdWRlTW9kZWxzKGRyb3Bkb3duOiBhbnkpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG5cdFx0ZHJvcGRvd24uc2VsZWN0RWwuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBVc2UgY2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnNcblx0XHRjb25zdCBjdXJyZW50TW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzKCdjbGF1ZGUnKTtcblxuXHRcdGN1cnJlbnRNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTtcblx0XHR9KTtcblx0fVxuXG5cblxuXHRwcml2YXRlIGNyZWF0ZU9wZW5BSVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IG9wZW5haUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0b3BlbmFpQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NoYXRHUFQgKE9wZW5BSSknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcob3BlbmFpQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgT3BlbkFJIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignc2stLi4uJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIE1vZGVsIHNldHRpbmcgd2l0aCByZWZyZXNoIGJ1dHRvblxuXHRcdGNvbnN0IG1vZGVsU2V0dGluZyA9IG5ldyBTZXR0aW5nKG9wZW5haUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT3BlbkFJIG1vZGVsIHRvIHVzZScpO1xuXG5cdFx0bGV0IG1vZGVsRHJvcGRvd246IGFueTtcblx0XHRcblx0XHRtb2RlbFNldHRpbmcuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuXHRcdFx0bW9kZWxEcm9wZG93biA9IGRyb3Bkb3duO1xuXHRcdFx0dGhpcy5wb3B1bGF0ZU9wZW5BSU1vZGVscyhkcm9wZG93bik7XG5cdFx0XHRyZXR1cm4gZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCB8fCAnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gT3BlbkFJIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVPcGVuQUlNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ29wZW5haScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHb29nbGVTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRcblx0XHRjb25zdCBnb29nbGVDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdGdvb2dsZUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdHb29nbGUgKEdlbWluaSknIH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0FQSSBLZXknKVxuXHRcdFx0LnNldERlc2MoJ1lvdXIgR29vZ2xlIEFJIEFQSSBrZXknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignQUkuLi4nKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdHZW1pbmkgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHR0aGlzLnBvcHVsYXRlR29vZ2xlTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsIHx8ICdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gR29vZ2xlIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVHb29nbGVNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ2dvb2dsZScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVPbGxhbWFTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRjb25zdCBvbGxhbWFDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdG9sbGFtYUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdPbGxhbWEgKExvY2FsKScgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnQmFzZSBVUkwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBzZXJ2ZXIgVVJMJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgfHwgJycpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ09sbGFtYSBtb2RlbCB0byB1c2UnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignbGxhbWEyJylcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCB8fCAnJylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUGxhdGZvcm0gU2V0dGluZ3MnIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZsZXg6IDE7JztcblxuXHRcdGNvbnN0IHBsYXRmb3JtQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1zZWN0aW9uJyB9KTtcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IG5vbmU7JzsgLy8gU3RhcnQgY29sbGFwc2VkXG5cdFx0XG5cdFx0Ly8gVG9nZ2xlIGZ1bmN0aW9uYWxpdHlcblx0XHRoZWFkZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdGNvbnN0IGlzVmlzaWJsZSA9IHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdHBsYXRmb3JtQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBpc1Zpc2libGUgPyAnbm9uZScgOiAnYmxvY2snO1xuXHRcdFx0YXJyb3dFbC5zdHlsZS50cmFuc2Zvcm0gPSBpc1Zpc2libGUgPyAncm90YXRlKDBkZWcpJyA6ICdyb3RhdGUoOTBkZWcpJztcblx0XHR9KTtcblx0XHRcblx0XHQvLyBJbmZvIGFib3V0IHBsYXRmb3JtIHNldHRpbmdzXG5cdFx0Y29uc3QgaW5mb0VsID0gcGxhdGZvcm1Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5cdUQ4M0RcdUREQTVcdUZFMEYgUGxhdGZvcm0gQ29uZmlndXJhdGlvbjwvaDQ+XG5cdFx0XHRcdDxwPkNvbmZpZ3VyZSB3aGljaCBBSSBwcm92aWRlciB0byB1c2UgYXMgeW91ciBwcmltYXJ5IHByb3ZpZGVyIG9uIGRpZmZlcmVudCBwbGF0Zm9ybXMuIFxuXHRcdFx0XHROb3ZhIHdvcmtzIHNlYW1sZXNzbHkgYWNyb3NzIGRlc2t0b3AgYW5kIG1vYmlsZSB3aXRoIGFsbCBwcm92aWRlcnMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXNrdG9wJyB9KTtcblx0XHRjb25zdCBkZXNrdG9wRHJvcGRvd24gPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBkZXNrdG9wJylcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRcdGNvbnN0IGFsbG93ZWRQcm92aWRlcnMgPSB0aGlzLmdldEFsbG93ZWRQcm92aWRlcnNGb3JQbGF0Zm9ybSgnZGVza3RvcCcpO1xuXHRcdFx0XHRcblx0XHRcdFx0YWxsb3dlZFByb3ZpZGVycy5mb3JFYWNoKHByb3ZpZGVyID0+IHtcblx0XHRcdFx0XHRjb25zdCBsYWJlbCA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcik7XG5cdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHByb3ZpZGVyLCBsYWJlbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5wcmltYXJ5UHJvdmlkZXIpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AucHJpbWFyeVByb3ZpZGVyID0gdmFsdWUgYXMgUHJvdmlkZXJUeXBlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRwbGF0Zm9ybUNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdNb2JpbGUnIH0pO1xuXHRcdGNvbnN0IG1vYmlsZVNldHRpbmcgPSBuZXcgU2V0dGluZyhwbGF0Zm9ybUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdQcmltYXJ5IFByb3ZpZGVyJylcblx0XHRcdC5zZXREZXNjKCdQcmltYXJ5IEFJIHByb3ZpZGVyIGZvciBtb2JpbGUgZGV2aWNlcycpO1xuXHRcdFx0XG5cdFx0bW9iaWxlU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuXHRcdFx0LmFkZE9wdGlvbignbm9uZScsICdOb25lIChEaXNhYmxlZCknKVxuXHRcdFx0LmFkZE9wdGlvbignY2xhdWRlJywgJ0NsYXVkZScpXG5cdFx0XHQuYWRkT3B0aW9uKCdvcGVuYWknLCAnT3BlbkFJJylcblx0XHRcdC5hZGRPcHRpb24oJ2dvb2dsZScsICdHb29nbGUnKVxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLnByaW1hcnlQcm92aWRlcilcblx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5wcmltYXJ5UHJvdmlkZXIgPSB2YWx1ZSBhcyBQcm92aWRlclR5cGU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKHBsYXRmb3JtOiAnZGVza3RvcCcgfCAnbW9iaWxlJyk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4gcGxhdGZvcm0gPT09ICdkZXNrdG9wJyBcblx0XHRcdD8gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdFx0OiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdH1cblxuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXI6IFByb3ZpZGVyVHlwZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbmFtZXM6IFJlY29yZDxQcm92aWRlclR5cGUsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ0NsYXVkZSAoQW50aHJvcGljKScsXG5cdFx0XHQnb3BlbmFpJzogJ0NoYXRHUFQgKE9wZW5BSSknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUgKEdlbWluaSknLCBcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hIChMb2NhbCknLFxuXHRcdFx0J25vbmUnOiAnTm9uZSAoRGlzYWJsZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIG5hbWVzW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcblx0fVxuXG5cdGFzeW5jIHNldEN1cnJlbnRQcm92aWRlcihwcm92aWRlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0ucHJpbWFyeVByb3ZpZGVyID0gcHJvdmlkZXJJZCBhcyBQcm92aWRlclR5cGU7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBwcm92aWRlciBtYW5hZ2VyIHdpdGggbmV3IHNldHRpbmdzXG5cdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRcblx0XHQvLyBDcmVhdGUgY29sbGFwc2libGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbGxhcHNpYmxlLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogOHB4IDA7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMTZweDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGFycm93RWwgPSBoZWFkZXJFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb2xsYXBzaWJsZS1hcnJvdycgfSk7XG5cdFx0YXJyb3dFbC5pbm5lckhUTUwgPSAnXHUyNUI2Jztcblx0XHRhcnJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0XHRmb250LXNpemU6IDEycHg7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ3VzdG9tIENvbW1hbmRzJyB9KTtcblx0XHR0aXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luOiAwOyBmbGV4OiAxOyc7XG5cblx0XHRjb25zdCBjb21tYW5kQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXNlY3Rpb24nIH0pO1xuXHRcdGNvbW1hbmRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBub25lOyc7IC8vIFN0YXJ0IGNvbGxhcHNlZFxuXHRcdFxuXHRcdC8vIFRvZ2dsZSBmdW5jdGlvbmFsaXR5XG5cdFx0aGVhZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRjb25zdCBpc1Zpc2libGUgPSBjb21tYW5kQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJztcblx0XHRcdGNvbW1hbmRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IGlzVmlzaWJsZSA/ICdub25lJyA6ICdibG9jayc7XG5cdFx0XHRhcnJvd0VsLnN0eWxlLnRyYW5zZm9ybSA9IGlzVmlzaWJsZSA/ICdyb3RhdGUoMGRlZyknIDogJ3JvdGF0ZSg5MGRlZyknO1xuXHRcdH0pO1xuXG5cdFx0Ly8gRmVhdHVyZSBhdmFpbGFiaWxpdHkgY2hlY2tcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IG5vdGljZUVsID0gY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWZlYXR1cmUtbm90aWNlJyB9KTtcblx0XHRcdG5vdGljZUVsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBzdHlsZT1cInBhZGRpbmc6IDE2cHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBib3JkZXItcmFkaXVzOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcIj5cblx0XHRcdFx0XHQ8aDQgc3R5bGU9XCJtYXJnaW46IDAgMCA4cHggMDsgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj5TdXBlcm5vdmEgU3VwcG9ydGVyIEZlYXR1cmU8L2g0PlxuXHRcdFx0XHRcdDxwIHN0eWxlPVwibWFyZ2luOiAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07XCI+XG5cdFx0XHRcdFx0XHRDdXN0b20gY29tbWFuZHMgYXJlIGN1cnJlbnRseSBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMuIFxuXHRcdFx0XHRcdFx0VGhleSB3aWxsIGJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgb24gPHN0cm9uZz5PY3RvYmVyIDEsIDIwMjU8L3N0cm9uZz4uXG5cdFx0XHRcdFx0PC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGVzY3JpcHRpb25cblx0XHRjb25zdCBkZXNjRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjcmlwdGlvbicgfSk7XG5cdFx0ZGVzY0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxwIHN0eWxlPVwiY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiAxNnB4O1wiPlxuXHRcdFx0XHRDcmVhdGUgY3VzdG9tIGNvbW1hbmQgc2hvcnRjdXRzIHRoYXQgaW5zZXJ0IHByZWRlZmluZWQgdGV4dCB0ZW1wbGF0ZXMgd2hlbiB0cmlnZ2VyZWQgd2l0aCA8Y29kZT46dHJpZ2dlcjwvY29kZT4uXG5cdFx0XHQ8L3A+XG5cdFx0YDtcblxuXHRcdC8vIFNob3cgQ29tbWFuZCBCdXR0b24gc2V0dGluZyAoU3VwZXJub3ZhLW9ubHkpXG5cdFx0bmV3IFNldHRpbmcoY29tbWFuZENvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdTaG93IENvbW1hbmQgQnV0dG9uIGluIENoYXQnKVxuXHRcdFx0LnNldERlc2MoJ1Nob3cgdGhlIENvbW1hbmRzIGJ1dHRvbiBiZXNpZGUgdGhlIFNlbmQgYnV0dG9uIGZvciBxdWljayBjb21tYW5kIGFjY2VzcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b24gPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBGaW5kIGFuZCByZWZyZXNoIHNpZGViYXIgdmlld1xuXHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gQWRkIG5ldyBjb21tYW5kIGJ1dHRvbiBhdCB0aGUgdG9wXG5cdFx0Y29uc3QgYnV0dG9uRWwgPSBjb21tYW5kQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYWRkLWNvbW1hbmQnIH0pO1xuXHRcdGJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luLWJvdHRvbTogMTZweDsnO1xuXHRcdFxuXHRcdG5ldyBTZXR0aW5nKGJ1dHRvbkVsKVxuXHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gXG5cdFx0XHRcdGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCcrIEFkZCBDdXN0b20gQ29tbWFuZCcpXG5cdFx0XHRcdFx0LnNldEN0YSgpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5zaG93QWRkQ29tbWFuZERpYWxvZygpKVxuXHRcdFx0KTtcblxuXHRcdC8vIENvbW1hbmRzIGxpc3Rcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdChjb21tYW5kQ29udGFpbmVyKTtcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBjb21tYW5kcyBsaXN0XG5cdFx0Y29uc3QgZXhpc3RpbmdMaXN0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmRzLWxpc3QnKTtcblx0XHRpZiAoZXhpc3RpbmdMaXN0KSBleGlzdGluZ0xpc3QucmVtb3ZlKCk7XG5cblx0XHRjb25zdCBjb21tYW5kc0xpc3QgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kcy1saXN0JyB9KTtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXG5cdFx0aWYgKGNvbW1hbmRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Y29uc3QgZW1wdHlFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWVtcHR5JyB9KTtcblx0XHRcdGVtcHR5RWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAyNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XCI+XG5cdFx0XHRcdFx0PHA+Tm8gY3VzdG9tIGNvbW1hbmRzIHlldC48L3A+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJmb250LXNpemU6IDAuOWVtO1wiPkNyZWF0ZSB5b3VyIGZpcnN0IGNvbW1hbmQgdG8gZ2V0IHN0YXJ0ZWQhPC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGNvbW1hbmRFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRjb21tYW5kRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRcdHBhZGRpbmc6IDE2cHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDEycHg7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRgO1xuXG5cdFx0XHQvLyBDb21tYW5kIGhlYWRlclxuXHRcdFx0Y29uc3QgaGVhZGVyRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWhlYWRlcicgfSk7XG5cdFx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IG1hcmdpbi1ib3R0b206IDhweDsnO1xuXG5cdFx0XHRjb25zdCBpbmZvRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaW5mbycgfSk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGluZm9FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbmFtZScgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNjAwOyBtYXJnaW4tYm90dG9tOiA0cHg7JztcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC5pbm5lckhUTUwgPSBgPGNvZGU+OiR7Y29tbWFuZC50cmlnZ2VyfTwvY29kZT5gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gQWN0aW9uc1xuXHRcdFx0Y29uc3QgYWN0aW9uc0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWFjdGlvbnMnIH0pO1xuXHRcdFx0YWN0aW9uc0VsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7JztcblxuXHRcdFx0Y29uc3QgZWRpdEJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRWRpdCcgfSk7XG5cdFx0XHRlZGl0QnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4Oyc7XG5cdFx0XHRlZGl0QnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnNob3dFZGl0Q29tbWFuZERpYWxvZyhpbmRleCk7XG5cblx0XHRcdGNvbnN0IGRlbGV0ZUJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRGVsZXRlJyB9KTtcblx0XHRcdGRlbGV0ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGZvbnQtc2l6ZTogMC44ZW07IGJvcmRlci1yYWRpdXM6IDRweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvcik7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7Jztcblx0XHRcdGRlbGV0ZUJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5kZWxldGVDb21tYW5kKGluZGV4KTtcblxuXHRcdFx0Ly8gRGVzY3JpcHRpb24gYW5kIHRlbXBsYXRlIHByZXZpZXdcblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYycgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHRlbXBsYXRlRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRlbXBsYXRlJyB9KTtcblx0XHRcdHRlbXBsYXRlRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IHBhZGRpbmc6IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBmb250LXNpemU6IDAuOGVtOyB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7IG1heC1oZWlnaHQ6IDYwcHg7IG92ZXJmbG93LXk6IGF1dG87XCI+XG5cdFx0XHRcdFx0JHtjb21tYW5kLnRlbXBsYXRlfVxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dBZGRDb21tYW5kRGlhbG9nKCkge1xuXHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coKTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4OiBudW1iZXIpIHtcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHM/LltpbmRleF07XG5cdFx0aWYgKGNvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coY29tbWFuZCwgaW5kZXgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmREaWFsb2coZXhpc3RpbmdDb21tYW5kPzogQ3VzdG9tQ29tbWFuZCwgZWRpdEluZGV4PzogbnVtYmVyKSB7XG5cdFx0Ly8gRm9yIG5vdywgdXNlIGEgc2ltcGxlIHByb21wdC1iYXNlZCBhcHByb2FjaFxuXHRcdC8vIFRPRE86IEltcGxlbWVudCBwcm9wZXIgbW9kYWwgd2hlbiBNb2RhbCBjbGFzcyBpcyBwcm9wZXJseSBhdmFpbGFibGVcblx0XHRjb25zdCBuYW1lID0gcHJvbXB0KCdDb21tYW5kIG5hbWU6JywgZXhpc3RpbmdDb21tYW5kPy5uYW1lIHx8ICcnKTtcblx0XHRpZiAoIW5hbWUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCB0cmlnZ2VyID0gcHJvbXB0KCdDb21tYW5kIHRyaWdnZXIgKHdpdGhvdXQgOik6JywgZXhpc3RpbmdDb21tYW5kPy50cmlnZ2VyIHx8ICcnKTtcblx0XHRpZiAoIXRyaWdnZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBkZXNjcmlwdGlvbiA9IHByb21wdCgnRGVzY3JpcHRpb24gKG9wdGlvbmFsKTonLCBleGlzdGluZ0NvbW1hbmQ/LmRlc2NyaXB0aW9uIHx8ICcnKTtcblx0XHRcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IHByb21wdCgnVGVtcGxhdGUgY29udGVudDonLCBleGlzdGluZ0NvbW1hbmQ/LnRlbXBsYXRlIHx8ICcnKTtcblx0XHRpZiAoIXRlbXBsYXRlKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgcmVzdWx0OiBDdXN0b21Db21tYW5kID0ge1xuXHRcdFx0aWQ6IGV4aXN0aW5nQ29tbWFuZD8uaWQgfHwgKCdjbWRfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KSksXG5cdFx0XHRuYW1lLFxuXHRcdFx0dHJpZ2dlcjogdHJpZ2dlci50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0dGVtcGxhdGUsXG5cdFx0XHRkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgdW5kZWZpbmVkXG5cdFx0fTtcblx0XHRcblx0XHRpZiAoZWRpdEluZGV4ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdC8vIEVkaXQgZXhpc3RpbmcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzW2VkaXRJbmRleF0gPSByZXN1bHQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEFkZCBuZXcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzLnB1c2gocmVzdWx0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblxuXHRwcml2YXRlIGRlbGV0ZUNvbW1hbmQoaW5kZXg6IG51bWJlcikge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbaW5kZXhdO1xuXHRcdGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oYERlbGV0ZSBjb21tYW5kIFwiJHtjb21tYW5kLm5hbWV9XCIgKCR7Y29tbWFuZC50cmlnZ2VyfSk/YCk7XG5cdFx0XG5cdFx0aWYgKGNvbmZpcm1lZCkge1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmLCBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSwgTm90aWNlLCBNYXJrZG93blZpZXcsIFBsYXRmb3JtLCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IE11bHRpRG9jQ29udGV4dEhhbmRsZXIsIE11bHRpRG9jQ29udGV4dCB9IGZyb20gJy4uL2NvcmUvbXVsdGktZG9jLWNvbnRleHQnO1xuaW1wb3J0IHsgZ2V0QXZhaWxhYmxlTW9kZWxzIH0gZnJvbSAnLi4vYWkvbW9kZWxzJztcbmltcG9ydCB7IElucHV0SGFuZGxlciB9IGZyb20gJy4vaW5wdXQtaGFuZGxlcic7XG5pbXBvcnQgeyBDb21tYW5kU3lzdGVtIH0gZnJvbSAnLi9jb21tYW5kLXN5c3RlbSc7XG5pbXBvcnQgeyBDb250ZXh0TWFuYWdlciB9IGZyb20gJy4vY29udGV4dC1tYW5hZ2VyJztcbmltcG9ydCB7IENoYXRSZW5kZXJlciB9IGZyb20gJy4vY2hhdC1yZW5kZXJlcic7XG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfTk9WQV9TSURFQkFSID0gJ25vdmEtc2lkZWJhcic7XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2lkZWJhclZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG5cdHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaW5wdXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBtdWx0aURvY0hhbmRsZXIhOiBNdWx0aURvY0NvbnRleHRIYW5kbGVyO1xuXHRwcml2YXRlIGN1cnJlbnRDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XG5cdC8vIE5ldyBhcmNoaXRlY3R1cmUgY29tcG9uZW50c1xuXHRwcml2YXRlIGlucHV0SGFuZGxlciE6IElucHV0SGFuZGxlcjtcblx0cHJpdmF0ZSBjb21tYW5kU3lzdGVtITogQ29tbWFuZFN5c3RlbTtcblx0cHJpdmF0ZSBjb250ZXh0TWFuYWdlciE6IENvbnRleHRNYW5hZ2VyO1xuXHRwcml2YXRlIGNoYXRSZW5kZXJlciE6IENoYXRSZW5kZXJlcjtcblx0XG5cdC8vIExlZ2FjeSBjb21wYXRpYmlsaXR5IGRlbGVnYXRlcyAtIEZvcndhcmQgdG8gbmV3IGFyY2hpdGVjdHVyZVxuXHRwcml2YXRlIGdldCB0ZXh0QXJlYSgpIHsgcmV0dXJuIHRoaXMuaW5wdXRIYW5kbGVyPy5nZXRUZXh0QXJlYSgpOyB9XG5cdHByaXZhdGUgZ2V0IHdpa2lsaW5rQXV0b2NvbXBsZXRlKCkgeyByZXR1cm4gdGhpcy5pbnB1dEhhbmRsZXIgPyB7IGRlc3Ryb3k6ICgpID0+IHt9IH0gOiBudWxsOyB9XG5cdHByaXZhdGUgZ2V0IGF1dG9Hcm93VGV4dGFyZWEoKSB7IHJldHVybiAoKSA9PiB7fTsgfVxuXHRcblx0Ly8gQ29tbWFuZCBzeXN0ZW0gY29tcGF0aWJpbGl0eSAtIHN0dWIgb3V0IG9sZCBtZXRob2RzXG5cdHByaXZhdGUgX2NvbW1hbmRQaWNrZXJJdGVtczogYW55W10gPSBbXTtcblx0cHJpdmF0ZSBnZXQgY29tbWFuZFBpY2tlckl0ZW1zKCkgeyByZXR1cm4gdGhpcy5fY29tbWFuZFBpY2tlckl0ZW1zOyB9XG5cdHByaXZhdGUgc2V0IGNvbW1hbmRQaWNrZXJJdGVtcyh2YWx1ZTogYW55W10pIHsgdGhpcy5fY29tbWFuZFBpY2tlckl0ZW1zID0gdmFsdWU7IH1cblx0cHJpdmF0ZSBfc2VsZWN0ZWRDb21tYW5kSW5kZXg6IG51bWJlciA9IC0xO1xuXHRwcml2YXRlIGdldCBzZWxlY3RlZENvbW1hbmRJbmRleCgpIHsgcmV0dXJuIHRoaXMuX3NlbGVjdGVkQ29tbWFuZEluZGV4OyB9XG5cdHByaXZhdGUgc2V0IHNlbGVjdGVkQ29tbWFuZEluZGV4KHZhbHVlOiBudW1iZXIpIHsgdGhpcy5fc2VsZWN0ZWRDb21tYW5kSW5kZXggPSB2YWx1ZTsgfVxuXHRwcml2YXRlIF9pc0NvbW1hbmRNZW51VmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuXHRwcml2YXRlIGdldCBpc0NvbW1hbmRNZW51VmlzaWJsZSgpIHsgcmV0dXJuIHRoaXMuX2lzQ29tbWFuZE1lbnVWaXNpYmxlOyB9XG5cdHByaXZhdGUgc2V0IGlzQ29tbWFuZE1lbnVWaXNpYmxlKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX2lzQ29tbWFuZE1lbnVWaXNpYmxlID0gdmFsdWU7IH1cblx0XG5cdC8vIENvbnRleHQgc3lzdGVtIGNvbXBhdGliaWxpdHkgLSBmb3J3YXJkIHRvIENvbnRleHRNYW5hZ2VyXG5cdHByaXZhdGUgZ2V0IGNvbnRleHRQcmV2aWV3KCkgeyByZXR1cm4gdGhpcy5jb250ZXh0TWFuYWdlcj8uY29udGV4dFByZXZpZXc7IH1cblx0cHJpdmF0ZSBfY29udGV4dEluZGljYXRvcjogYW55O1xuXHRwcml2YXRlIGdldCBjb250ZXh0SW5kaWNhdG9yKCkgeyByZXR1cm4gdGhpcy5fY29udGV4dEluZGljYXRvciB8fCB0aGlzLmNvbnRleHRNYW5hZ2VyPy5jb250ZXh0SW5kaWNhdG9yOyB9XG5cdHByaXZhdGUgc2V0IGNvbnRleHRJbmRpY2F0b3IodmFsdWU6IGFueSkgeyB0aGlzLl9jb250ZXh0SW5kaWNhdG9yID0gdmFsdWU7IH1cblx0XG5cdC8vIFN0dWIgb3V0IG9sZCBET00gZWxlbWVudHMgdGhhdCBzaG91bGQgbm8gbG9uZ2VyIGJlIHVzZWRcblx0cHJpdmF0ZSBnZXQgY29tbWFuZFBpY2tlcigpOiBhbnkgeyByZXR1cm4gbnVsbDsgfVxuXHRwcml2YXRlIHNldCBjb21tYW5kUGlja2VyKHZhbHVlOiBhbnkpIHsgLyogbm8tb3AgKi8gfVxuXHRwcml2YXRlIGdldCBjb21tYW5kTWVudSgpOiBhbnkgeyByZXR1cm4gbnVsbDsgfVxuXHRwcml2YXRlIHNldCBjb21tYW5kTWVudSh2YWx1ZTogYW55KSB7IC8qIG5vLW9wICovIH1cblx0cHJpdmF0ZSBnZXQgY29tbWFuZEJ1dHRvbigpOiBhbnkgeyByZXR1cm4gbnVsbDsgfVxuXHRcblx0XG5cdC8vIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiAtIGRlYm91bmNpbmcgYW5kIHRpbWluZyBjb25zdGFudHNcblx0cHJpdmF0ZSBjb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ09OVEVYVF9QUkVWSUVXX0RFQk9VTkNFX01TID0gMzAwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBTQ1JPTExfREVMQVlfTVMgPSA1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRk9DVVNfREVMQVlfTVMgPSAxNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEhPVkVSX1RJTUVPVVRfTVMgPSAxNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE5PVElDRV9EVVJBVElPTl9NUyA9IDUwMDA7XG5cdFxuXHQvLyBFdmVudCBsaXN0ZW5lciBjbGVhbnVwIHRyYWNraW5nXG5cdHByaXZhdGUgZG9jdW1lbnRFdmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblx0cHJpdmF0ZSB0aW1lb3V0czogTm9kZUpTLlRpbWVvdXRbXSA9IFtdO1xuXG5cdGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGxlYWYpO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMubXVsdGlEb2NIYW5kbGVyID0gbmV3IE11bHRpRG9jQ29udGV4dEhhbmRsZXIodGhpcy5hcHApO1xuXHR9XG5cblx0Z2V0Vmlld1R5cGUoKSB7XG5cdFx0cmV0dXJuIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVI7XG5cdH1cblxuXHRnZXREaXNwbGF5VGV4dCgpIHtcblx0XHRyZXR1cm4gJ05vdmEgQUknO1xuXHR9XG5cblx0Z2V0SWNvbigpIHtcblx0XHRyZXR1cm4gJ25vdmEtc3Rhcic7XG5cdH1cblxuXHRhc3luYyBvbk9wZW4oKSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcblx0XHRjb250YWluZXIuZW1wdHkoKTtcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ25vdmEtc2lkZWJhci1jb250YWluZXInKTtcblxuXHRcdC8vIE1vYmlsZSBhY2Nlc3MgaXMgbm93IGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0XHRcblx0XHQvLyBDcmVhdGUgd3JhcHBlciB3aXRoIHByb3BlciBmbGV4IGxheW91dFxuXHRcdGNvbnN0IHdyYXBwZXJFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdyYXBwZXInIH0pO1xuXHRcdHdyYXBwZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRoZWlnaHQ6IDEwMCU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0cGFkZGluZy1ib3R0b206ICR7UGxhdGZvcm0uaXNEZXNrdG9wQXBwID8gJ3ZhcigtLXNpemUtNC02KScgOiAndmFyKC0tc2l6ZS00LTUpJ307XG5cdFx0YDtcblx0XHRcblx0XHQvLyBIZWFkZXIgd2l0aCBwcm92aWRlciBpbmZvXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB3cmFwcGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIExlZnQgc2lkZTogVGl0bGUgd2l0aCBOb3ZhIGljb25cblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2g0Jyk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogdmFyKC0tc2l6ZS0yLTIpOyc7XG5cdFx0dGl0bGVFbC5pbm5lckhUTUwgPSBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogdmFyKC0taWNvbi1zaXplKTsgaGVpZ2h0OiB2YXIoLS1pY29uLXNpemUpO1wiPlxuXHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdDwvc3ZnPk5vdmFgO1xuXHRcdFxuXHRcdC8vIFJpZ2h0IHNpZGU6IFByb3ZpZGVyIHN0YXR1cyBhbmQgQ2xlYXIgYnV0dG9uXG5cdFx0Y29uc3QgcmlnaHRDb250YWluZXIgPSBoZWFkZXJFbC5jcmVhdGVEaXYoKTtcblx0XHRyaWdodENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogdmFyKC0tc2l6ZS0yLTMpOyc7XG5cdFx0XG5cdFx0Ly8gUHJpdmFjeSBpbmRpY2F0b3IgaWNvblxuXHRcdGNvbnN0IHByaXZhY3lJbmRpY2F0b3IgPSByaWdodENvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1wcml2YWN5LWluZGljYXRvcicgfSk7XG5cdFx0cHJpdmFjeUluZGljYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRwYWRkaW5nOiA0cHg7XG5cdFx0XHRjb2xvcjogdmFyKC0taWNvbi1jb2xvcik7XG5cdFx0XHRmb250LXdlaWdodDogdmFyKC0tZm9udC13ZWlnaHQtbWVkaXVtKTtcblx0XHRgO1xuXHRcdHRoaXMudXBkYXRlUHJpdmFjeUluZGljYXRvcihwcml2YWN5SW5kaWNhdG9yKTtcblx0XHRcblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIHVwZGF0ZXNcblx0XHQodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IgPSBwcml2YWN5SW5kaWNhdG9yO1xuXHRcdFxuXHRcdC8vIEFsbCB1c2VycyBjYW4gc3dpdGNoIHByb3ZpZGVycyBmcmVlbHlcblx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyRHJvcGRvd24ocmlnaHRDb250YWluZXIpO1xuXHRcdFxuXHRcdC8vIENsZWFyIENoYXQgYnV0dG9uIGluIHJpZ2h0IGNvbnRhaW5lclxuXHRcdGNvbnN0IGNsZWFyQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChyaWdodENvbnRhaW5lcik7XG5cdFx0Y2xlYXJCdXR0b24uc2V0SWNvbignZXJhc2VyJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBjb252ZXJzYXRpb24gaGlzdG9yeScpXG5cdFx0XHQub25DbGljaygoKSA9PiB0aGlzLmNsZWFyQ2hhdCgpKTtcblxuXHRcdHRoaXMuY3JlYXRlQ2hhdEludGVyZmFjZSh3cmFwcGVyRWwpO1xuXHRcdHRoaXMuY3JlYXRlSW5wdXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHRcblx0XHQvLyBSZWdpc3RlciBldmVudCBsaXN0ZW5lciBmb3IgYWN0aXZlIGZpbGUgY2hhbmdlc1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdFx0XHR9KVxuXHRcdCk7XG5cdFx0XG5cdFx0Ly8gTG9hZCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuXHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBJbml0aWFsIHN0YXR1cyByZWZyZXNoIHRvIGVuc3VyZSBhbGwgaW5kaWNhdG9ycyBhcmUgdXAgdG8gZGF0ZVxuXHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5yZWZyZXNoUHJvdmlkZXJTdGF0dXMoKSwgMTAwKTtcblx0XHRcblx0XHQvLyBBdXRvLWZvY3VzIGlucHV0IGZvciBpbW1lZGlhdGUgdHlwaW5nXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy50ZXh0QXJlYT8uaW5wdXRFbCkge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdH1cblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuRk9DVVNfREVMQVlfTVMpO1xuXHR9XG5cblx0YXN5bmMgb25DbG9zZSgpIHtcblx0XHQvLyBDbGVhbiB1cCBwcm92aWRlciBkcm9wZG93biBldmVudCBsaXN0ZW5lclxuXHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy5jbGVhbnVwKSB7XG5cdFx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLmNsZWFudXAoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuZGVzdHJveSgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhciBkZWJvdW5jZSB0aW1lb3V0XG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KTtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBudWxsO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHRcdHRoaXMuY2xlYW51cEV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgYWxsIHRpbWVvdXRzXG5cdFx0dGhpcy5jbGVhclRpbWVvdXRzKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgRE9NIGVsZW1lbnRzXG5cdFx0dGhpcy5jbGVhbnVwRE9NRWxlbWVudHMoKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEFkZCBldmVudCBsaXN0ZW5lciB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGVsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyKTogdm9pZCB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMucHVzaCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIHRpbWVvdXQgd2l0aCBhdXRvbWF0aWMgY2xlYW51cCB0cmFja2luZ1xuXHQgKi9cblx0cHJpdmF0ZSBhZGRUcmFja2VkVGltZW91dChjYWxsYmFjazogKCkgPT4gdm9pZCwgZGVsYXk6IG51bWJlcik6IE5vZGVKUy5UaW1lb3V0IHtcblx0XHRjb25zdCBpZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdHRoaXMudGltZW91dHMgPSB0aGlzLnRpbWVvdXRzLmZpbHRlcih0ID0+IHQgIT09IGlkKTtcblx0XHR9LCBkZWxheSk7XG5cdFx0dGhpcy50aW1lb3V0cy5wdXNoKGlkKTtcblx0XHRyZXR1cm4gaWQ7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBhbGwgdHJhY2tlZCBldmVudCBsaXN0ZW5lcnNcblx0ICovXG5cdHByaXZhdGUgY2xlYW51cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5mb3JFYWNoKCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pID0+IHtcblx0XHRcdGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0fSk7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzID0gW107XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhciBhbGwgdHJhY2tlZCB0aW1lb3V0c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhclRpbWVvdXRzKCk6IHZvaWQge1xuXHRcdHRoaXMudGltZW91dHMuZm9yRWFjaChpZCA9PiBjbGVhclRpbWVvdXQoaWQpKTtcblx0XHR0aGlzLnRpbWVvdXRzID0gW107XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBET00gZWxlbWVudHNcblx0ICovXG5cdHByaXZhdGUgY2xlYW51cERPTUVsZW1lbnRzKCk6IHZvaWQge1xuXHRcdC8vIENsZWFudXAgaXMgbm93IGhhbmRsZWQgYnkgaW5kaXZpZHVhbCBjb21wb25lbnQgY2xlYW51cCBtZXRob2RzXG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNoYXRJbnRlcmZhY2UoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNoYXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNoYXRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXg6IDE7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS00LTIpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRnYXA6IHZhcigtLXNpemUtMi0zKTtcblx0XHRgO1xuXG5cdFx0Ly8gV2VsY29tZSBtZXNzYWdlIHdpdGggTm92YSBicmFuZGluZ1xuXHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlSW5wdXRJbnRlcmZhY2UoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMuaW5wdXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY3JlYXRlSW5wdXRBcmVhKCk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHRoZSBpbnB1dCBhcmVhIFVJIGVsZW1lbnRzIHVzaW5nIG5ldyBhcmNoaXRlY3R1cmVcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSW5wdXRBcmVhKCkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIGlucHV0IGFyZWEgY29udGVudFxuXHRcdHRoaXMuaW5wdXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBJbml0aWFsaXplIGNvbnRleHQgbWFuYWdlciBhbmQgY2hhdCByZW5kZXJlciBmaXJzdFxuXHRcdHRoaXMuY29udGV4dE1hbmFnZXIgPSBuZXcgQ29udGV4dE1hbmFnZXIodGhpcy5wbHVnaW4sIHRoaXMuYXBwLCB0aGlzLmlucHV0Q29udGFpbmVyKTtcblx0XHR0aGlzLmNoYXRSZW5kZXJlciA9IG5ldyBDaGF0UmVuZGVyZXIodGhpcy5wbHVnaW4sIHRoaXMuY2hhdENvbnRhaW5lcik7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIElucHV0SGFuZGxlciB3aGljaCB3aWxsIGhhbmRsZSBhbGwgaW5wdXQgVUkgY3JlYXRpb25cblx0XHR0aGlzLmlucHV0SGFuZGxlciA9IG5ldyBJbnB1dEhhbmRsZXIodGhpcy5wbHVnaW4sIHRoaXMuaW5wdXRDb250YWluZXIsIHRoaXMuY29udGV4dE1hbmFnZXIpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB0aGUgaW5wdXQgaW50ZXJmYWNlIHVzaW5nIG5ldyBJbnB1dEhhbmRsZXJcblx0XHR0aGlzLmlucHV0SGFuZGxlci5jcmVhdGVJbnB1dEludGVyZmFjZSh0aGlzLmNoYXRDb250YWluZXIpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBDb21tYW5kU3lzdGVtIHdpdGggdGhlIGFjdHVhbCB0ZXh0QXJlYSBmcm9tIElucHV0SGFuZGxlclxuXHRcdHRoaXMuY29tbWFuZFN5c3RlbSA9IG5ldyBDb21tYW5kU3lzdGVtKHRoaXMucGx1Z2luLCB0aGlzLmlucHV0Q29udGFpbmVyLCB0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpKTtcblx0XHRcblx0XHQvLyBDb25uZWN0IHRoZSBDb21tYW5kU3lzdGVtIHRvIHRoZSBJbnB1dEhhbmRsZXJcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRDb21tYW5kU3lzdGVtKHRoaXMuY29tbWFuZFN5c3RlbSk7XG5cdFx0XG5cdFx0Ly8gU2V0IHVwIHNlbmQgbWVzc2FnZSBjYWxsYmFja1xuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLnNldE9uU2VuZE1lc3NhZ2UoKG1lc3NhZ2U6IHN0cmluZykgPT4ge1xuXHRcdFx0dGhpcy5oYW5kbGVTZW5kKG1lc3NhZ2UpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb250ZXh0IGluZGljYXRvciBhbmQgcHJldmlldyB1c2luZyBDb250ZXh0TWFuYWdlclxuXHRcdHRoaXMuY29udGV4dE1hbmFnZXIuY3JlYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFxuXHR9XG5cblx0cHJpdmF0ZSBhZGRNZXNzYWdlKHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbScsIGNvbnRlbnQ6IHN0cmluZykge1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2Ugbm92YS1tZXNzYWdlLSR7cm9sZX1gIH0pO1xuXHRcdG1lc3NhZ2VFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTIpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTMpIHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdG1heC13aWR0aDogODUlO1xuXHRcdFx0JHtyb2xlID09PSAndXNlcicgXG5cdFx0XHRcdD8gJ21hcmdpbi1sZWZ0OiBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpOycgXG5cdFx0XHRcdDogcm9sZSA9PT0gJ3N5c3RlbSdcblx0XHRcdFx0PyAnbWFyZ2luOiAwIGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IHRleHQtYWxpZ246IGNlbnRlcjsgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsKTsnXG5cdFx0XHRcdDogJ2JhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsnXG5cdFx0XHR9XG5cdFx0YDtcblxuXHRcdGNvbnN0IHJvbGVFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBcblx0XHRcdHRleHQ6IHJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogcm9sZSA9PT0gJ3N5c3RlbScgPyAnU3lzdGVtJyA6ICdOb3ZhJyxcblx0XHRcdGNsczogJ25vdmEtbWVzc2FnZS1yb2xlJ1xuXHRcdH0pO1xuXHRcdHJvbGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpO1xuXHRcdFx0b3BhY2l0eTogMC43O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRgO1xuXG5cdFx0Y29uc3QgY29udGVudEVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtbWVzc2FnZS1jb250ZW50JyB9KTtcblx0XHQvLyBVc2UgaW5uZXJIVE1MIGZvciBzeXN0ZW0gbWVzc2FnZXMgdG8gc3VwcG9ydCBpY29ucywgdGV4dENvbnRlbnQgZm9yIG90aGVycyBmb3Igc2VjdXJpdHlcblx0XHRpZiAocm9sZSA9PT0gJ3N5c3RlbScgJiYgY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50RWwuaW5uZXJIVE1MID0gY29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gY29udGVudDtcblx0XHR9XG5cblx0XHQvLyBBdXRvLXNjcm9sbCB0byBib3R0b20gd2l0aCBzbW9vdGggYW5pbWF0aW9uXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG8oe1xuXHRcdFx0XHR0b3A6IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQsXG5cdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJ1xuXHRcdFx0fSk7XG5cdFx0fSwgTm92YVNpZGViYXJWaWV3LlNDUk9MTF9ERUxBWV9NUyk7XG5cdH1cblxuXHQvKipcblx0ICogSGVscGVyIG1ldGhvZCB0byBjcmVhdGUgc2ltcGxlIG1lc3NhZ2VzIHdpdGhvdXQgcm9sZSBoZWFkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZVNpbXBsZU1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBjbGFzc05hbWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2UgJHtjbGFzc05hbWV9YCB9KTtcblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdFxuXHRcdC8vIFN1cHBvcnQgaWNvbnMgaW4gbWVzc2FnZXNcblx0XHRpZiAoY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50RWwuaW5uZXJIVE1MID0gY29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gY29udGVudDtcblx0XHR9XG5cblx0XHQvLyBBdXRvLXNjcm9sbCB0byBib3R0b21cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUb3AgPSB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0O1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5TQ1JPTExfREVMQVlfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRFcnJvck1lc3NhZ2UoY29udGVudDogc3RyaW5nKSB7XG5cdFx0dGhpcy5jcmVhdGVTaW1wbGVNZXNzYWdlKGNvbnRlbnQsICdub3ZhLW1lc3NhZ2UtZXJyb3InKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nKSB7XG5cdFx0dGhpcy5jcmVhdGVTaW1wbGVNZXNzYWdlKGNvbnRlbnQsICdub3ZhLW1lc3NhZ2Utc3VjY2VzcycpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRXZWxjb21lTWVzc2FnZShtZXNzYWdlPzogc3RyaW5nKSB7XG5cdFx0Y29uc3Qgd2VsY29tZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtd2VsY29tZScgfSk7XG5cdFx0d2VsY29tZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0bWFyZ2luOiB2YXIoLS1zaXplLTQtNCkgYXV0bztcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC00KSB2YXIoLS1zaXplLTQtNSk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLWwpO1xuXHRcdFx0bWF4LXdpZHRoOiA5MCU7XG5cdFx0XHRhbmltYXRpb246IGZhZGVJbiAwLjVzIGVhc2UtaW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBOb3ZhIHN0YXIgaWNvbiAoc3RhdGljLCBub3QgYW5pbWF0ZWQpXG5cdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUtaWNvbicgfSk7XG5cdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0d2lkdGg6IHZhcigtLWljb24tc2l6ZS14bCk7XG5cdFx0XHRoZWlnaHQ6IHZhcigtLWljb24tc2l6ZS14bCk7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdGljb25Db250YWluZXIuaW5uZXJIVE1MID0gYFxuXHRcdFx0PHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogdmFyKC0taWNvbi1zaXplLXhsKTsgaGVpZ2h0OiB2YXIoLS1pY29uLXNpemUteGwpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPlxuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gV2VsY29tZSB0ZXh0XG5cdFx0Y29uc3QgdGV4dENvbnRhaW5lciA9IHdlbGNvbWVFbC5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHRpdGxlRWwgPSB0ZXh0Q29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6ICdIaSEgSVxcJ20gTm92YS4nIH0pO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXRleHQtc2l6ZSk7XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdWJ0aXRsZUVsID0gdGV4dENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBtZXNzYWdlIHx8ICcnIH0pO1xuXHRcdHN1YnRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGZvbnQtc2l6ZTogMC45ZW07XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbVxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0dG9wOiB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdH0pO1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5TQ1JPTExfREVMQVlfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTdWNjZXNzSW5kaWNhdG9yKGFjdGlvbjogc3RyaW5nKSB7XG5cdFx0Y29uc3QgaW5kaWNhdG9yRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdWNjZXNzLWluZGljYXRvcicgfSk7XG5cdFx0aW5kaWNhdG9yRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRtYXJnaW46IDhweCBhdXRvO1xuXHRcdFx0cGFkZGluZzogNnB4IDEycHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKDc2LCAxNzUsIDgwLCAwLjEpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSg3NiwgMTc1LCA4MCwgMC4zKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDE2cHg7XG5cdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0bWF4LXdpZHRoOiAyMDBweDtcblx0XHRcdGFuaW1hdGlvbjogZmFkZUluIDAuM3MgZWFzZS1pbjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEFkZCBjaGVja21hcmsgYW5kIHRleHRcblx0XHRpbmRpY2F0b3JFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IHN0eWxlPVwid2lkdGg6IDEycHg7IGhlaWdodDogMTJweDsgbWFyZ2luLXJpZ2h0OiA2cHg7IGJvcmRlci1yYWRpdXM6IDUwJTsgYmFja2dyb3VuZDogdmFyKC0tdGV4dC1zdWNjZXNzKTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XCI+XG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJ3aWR0aDogNHB4OyBoZWlnaHQ6IDJweDsgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCB3aGl0ZTsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHdoaXRlOyB0cmFuc2Zvcm06IHJvdGF0ZSgtNDVkZWcpIHRyYW5zbGF0ZSgtMC41cHgsIC0wLjVweCk7XCI+PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdCR7dGhpcy5nZXRDb21wYWN0U3VjY2Vzc01lc3NhZ2UoYWN0aW9uKX1cblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1zY3JvbGwgdG8gYm90dG9tXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG8oe1xuXHRcdFx0XHR0b3A6IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQsXG5cdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJ1xuXHRcdFx0fSk7XG5cdFx0fSwgTm92YVNpZGViYXJWaWV3LlNDUk9MTF9ERUxBWV9NUyk7XG5cdH1cblxuXHRwcml2YXRlIGdldENvbXBhY3RTdWNjZXNzTWVzc2FnZShhY3Rpb246IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0c3dpdGNoIChhY3Rpb24pIHtcblx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdHJldHVybiAnQ29udGVudCBhZGRlZCc7XG5cdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0cmV0dXJuICdDb250ZW50IGVkaXRlZCc7XG5cdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgZGVsZXRlZCc7XG5cdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0cmV0dXJuICdHcmFtbWFyIGZpeGVkJztcblx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRyZXR1cm4gJ0NvbnRlbnQgcmV3cml0dGVuJztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHJldHVybiAnQ29tbWFuZCBjb21wbGV0ZWQnO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdC8vIENoZWNrIGlmIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd6YXAnLCAnQ29tbWFuZHMgYXJlIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIFNlcHRlbWJlciAzMCwgMjAyNS4nKSk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kID0gbWVzc2FnZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgJzonIGFuZCBub3JtYWxpemVcblxuXHRcdC8vIFByb3ZpZGVyIHN3aXRjaGluZyBjb21tYW5kc1xuXHRcdGNvbnN0IHByb3ZpZGVyQ29tbWFuZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ2NsYXVkZScsXG5cdFx0XHQnY2hhdGdwdCc6ICdvcGVuYWknLFxuXHRcdFx0J29wZW5haSc6ICdvcGVuYWknLFxuXHRcdFx0J2dlbWluaSc6ICdnb29nbGUnLFxuXHRcdFx0J2dvb2dsZSc6ICdnb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdvbGxhbWEnXG5cdFx0fTtcblxuXHRcdGlmIChwcm92aWRlckNvbW1hbmRzW2NvbW1hbmRdKSB7XG5cdFx0XHRjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNldHRpbmdUYWIuc2V0Q3VycmVudFByb3ZpZGVyKHByb3ZpZGVySWQpO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJJZCl9YCkpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgZm9yIGN1c3RvbSBjb21tYW5kcyAoaWYgZmVhdHVyZSBlbmFibGVkKVxuXHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHM/LmZpbmQoY21kID0+IGNtZC50cmlnZ2VyID09PSBjb21tYW5kKTtcblx0XHRcdGlmIChjdXN0b21Db21tYW5kKSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgY3VzdG9tIGNvbW1hbmRcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShjdXN0b21Db21tYW5kLnRlbXBsYXRlKTtcblx0XHRcdFx0Ly8gVHJpZ2dlciBhdXRvLWdyb3cgYWZ0ZXIgc2V0dGluZyB0ZW1wbGF0ZVxuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpLCAwKTtcblx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdlZGl0JywgYExvYWRlZCB0ZW1wbGF0ZTogJHtjdXN0b21Db21tYW5kLm5hbWV9YCkpO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBVbmtub3duIGNvbW1hbmRcblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdoZWxwLWNpcmNsZScsIGBVbmtub3duIGNvbW1hbmQgJzoke2NvbW1hbmR9Jy4gVHJ5IDpjbGF1ZGUsIDpjaGF0Z3B0LCA6Z2VtaW5pLCBvciA6b2xsYW1hYCkpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlciBub3ZhLXBhbmVsLWJhc2UnIH0pO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRib3gtc2hhZG93OiAwIC00cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlSW5wdXRDaGFuZ2UoKTogdm9pZCB7XG5cdFx0Y29uc3QgdmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XG5cdFx0aWYgKHZhbHVlLnN0YXJ0c1dpdGgoJzonKSAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBxdWVyeSA9IHZhbHVlLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kUGlja2VyKHF1ZXJ5KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRQaWNrZXIocXVlcnk6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5nZXRBdmFpbGFibGVDb21tYW5kcygpLmZpbHRlcihjbWQgPT4gXG5cdFx0XHRjbWQudHJpZ2dlci50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KSB8fCBjbWQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KVxuXHRcdCk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuZW1wdHkoKTtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblxuXHRcdGlmIChjb21tYW5kcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKChjb21tYW5kLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZFBpY2tlci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbSBub3ZhLXBhbmVsLWl0ZW0nIH0pO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtdHJpZ2dlciBub3ZhLXBhbmVsLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLnRleHRDb250ZW50ID0gYDoke2NvbW1hbmQudHJpZ2dlcn1gO1xuXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtbmFtZSBub3ZhLXBhbmVsLXRleHQnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZmxleDogMTsnO1xuXG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBpdGVtLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYyBub3ZhLXBhbmVsLW11dGVkJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChpbmRleCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgaGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXHR9XG5cblx0cHJpdmF0ZSBpc0NvbW1hbmRQaWNrZXJWaXNpYmxlKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJztcblx0fVxuXG5cdHByaXZhdGUgbmF2aWdhdGVDb21tYW5kUGlja2VyKGRpcmVjdGlvbjogbnVtYmVyKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG5cdFx0Y29uc3QgbmV3SW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEsXG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgZGlyZWN0aW9uXG5cdFx0KSk7XG5cblx0XHR0aGlzLnNldFNlbGVjdGVkQ29tbWFuZChuZXdJbmRleCk7XG5cdH1cblxuXHRwcml2YXRlIHNldFNlbGVjdGVkQ29tbWFuZChpbmRleDogbnVtYmVyKTogdm9pZCB7XG5cdFx0Ly8gUmVtb3ZlIHByZXZpb3VzIHNlbGVjdGlvblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG5cdFx0XHRpdGVtLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IGluZGV4O1xuXG5cdFx0aWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zW2luZGV4XS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zW2luZGV4XS5zY3JvbGxJbnRvVmlldyh7IGJsb2NrOiAnbmVhcmVzdCcgfSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk6IGJvb2xlYW4ge1xuXHRcdGlmICghdGhpcy5pc0NvbW1hbmRQaWNrZXJWaXNpYmxlKCkgfHwgdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9PT0gLTEpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRjb25zdCBzZWxlY3RlZENvbW1hbmQgPSBjb21tYW5kc1t0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4XTtcblx0XHRcblx0XHRpZiAoc2VsZWN0ZWRDb21tYW5kKSB7XG5cdFx0XHR0aGlzLnNlbGVjdENvbW1hbmQoc2VsZWN0ZWRDb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBzZWxlY3RDb21tYW5kKHRyaWdnZXI6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoYDoke3RyaWdnZXJ9YCk7XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdC8vIFRyaWdnZXIgdGhlIGNvbW1hbmQgaW1tZWRpYXRlbHlcblx0XHR0aGlzLmhhbmRsZVNlbmQoKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTogQXJyYXk8e3RyaWdnZXI6IHN0cmluZywgbmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbj86IHN0cmluZ30+IHtcblx0XHRjb25zdCBjb21tYW5kczogQXJyYXk8e3RyaWdnZXI6IHN0cmluZywgbmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbj86IHN0cmluZ30+ID0gW1xuXHRcdFx0eyB0cmlnZ2VyOiAnY2xhdWRlJywgbmFtZTogJ1N3aXRjaCB0byBDbGF1ZGUnLCBkZXNjcmlwdGlvbjogJ0FudGhyb3BpYyBDbGF1ZGUgQUknIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdjaGF0Z3B0JywgbmFtZTogJ1N3aXRjaCB0byBDaGF0R1BUJywgZGVzY3JpcHRpb246ICdPcGVuQUkgR1BUIG1vZGVscycgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2dlbWluaScsIG5hbWU6ICdTd2l0Y2ggdG8gR2VtaW5pJywgZGVzY3JpcHRpb246ICdHb29nbGUgR2VtaW5pIEFJJyB9XG5cdFx0XTtcblxuXHRcdC8vIE9ubHkgYWRkIE9sbGFtYSBvbiBkZXNrdG9wXG5cdFx0aWYgKFBsYXRmb3JtLmlzRGVza3RvcEFwcCkge1xuXHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICdvbGxhbWEnLCBuYW1lOiAnU3dpdGNoIHRvIE9sbGFtYScsIGRlc2NyaXB0aW9uOiAnTG9jYWwgQUkgbW9kZWxzJyB9KTtcblx0XHR9XG5cblx0XHQvLyBBZGQgY3VzdG9tIGNvbW1hbmRzIGlmIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXHRcdFx0Y3VzdG9tQ29tbWFuZHMuZm9yRWFjaChjbWQgPT4ge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHR0cmlnZ2VyOiBjbWQudHJpZ2dlcixcblx0XHRcdFx0XHRuYW1lOiBjbWQubmFtZSxcblx0XHRcdFx0XHQuLi4oY21kLmRlc2NyaXB0aW9uICYmIHsgZGVzY3JpcHRpb246IGNtZC5kZXNjcmlwdGlvbiB9KVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb21tYW5kcztcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudSA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUgbm92YS1wYW5lbC1iYXNlJyB9KTtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1pbi13aWR0aDogMjQwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdGJveC1zaGFkb3c6IDAgLTRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ2xvc2UgbWVudSB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjb21tYW5kTWVudUNsaWNrSGFuZGxlcjogRXZlbnRMaXN0ZW5lciA9IChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGlmICghdGhpcy5jb21tYW5kTWVudS5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkgJiYgXG5cdFx0XHRcdCF0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpKSB7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjb21tYW5kTWVudUNsaWNrSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIHRvZ2dsZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd6YXAnLCAnQ29tbWFuZHMgYXJlIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIFNlcHRlbWJlciAzMCwgMjAyNS4nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUpIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCk7XG5cdFx0XG5cdFx0dGhpcy5jb21tYW5kTWVudS5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIEhlYWRlclxuXHRcdGNvbnN0IGhlYWRlckVsID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1oZWFkZXIgbm92YS1wYW5lbC1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignemFwJykgKyAnIENvbW1hbmRzJztcblxuXHRcdC8vIENvbW1hbmRzIGxpc3Rcblx0XHRjb21tYW5kcy5mb3JFYWNoKGNvbW1hbmQgPT4ge1xuXHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtaXRlbSBub3ZhLXBhbmVsLWl0ZW0tdmVydGljYWwnIH0pO1xuXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LW5hbWUgbm92YS1wYW5lbC10ZXh0JyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS10cmlnZ2VyIG5vdmEtcGFuZWwtdHJpZ2dlcicgfSk7XG5cdFx0XHR0cmlnZ2VyRWwudGV4dENvbnRlbnQgPSBgOiR7Y29tbWFuZC50cmlnZ2VyfWA7XG5cdFx0XHR0cmlnZ2VyRWwuc3R5bGUub3BhY2l0eSA9ICcwLjgnO1xuXG5cdFx0XHRpZiAoY29tbWFuZC5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRjb25zdCBkZXNjRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWRlc2Mgbm92YS1wYW5lbC1tdXRlZCcgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHR9XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZXhlY3V0ZUNvbW1hbmRGcm9tTWVudShjb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSB0cnVlO1xuXHR9XG5cblx0cHJpdmF0ZSBoaWRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgZXhlY3V0ZUNvbW1hbmRGcm9tTWVudSh0cmlnZ2VyOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdFxuXHRcdC8vIEV4ZWN1dGUgdGhlIGNvbW1hbmQgZGlyZWN0bHlcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0UHJldmlldygpOiBIVE1MRWxlbWVudCB7XG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHQvLyBSZXR1cm4gYSBkdW1teSBlbGVtZW50IHRoYXQgd29uJ3QgYmUgdXNlZFxuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhIHByZXZpZXcgYXJlYSB0aGF0IHNob3dzIGxpdmUgY29udGV4dCBhcyB1c2VyIHR5cGVzXG5cdFx0Y29uc3QgcHJldmlld0NvbnRhaW5lciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXcnIH0pO1xuXHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA0cHg7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdUZXh0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctdGV4dCcgfSk7XG5cdFx0cHJldmlld1RleHQuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArICcgQ29udGV4dCB3aWxsIGluY2x1ZGU6ICc7XG5cdFx0cHJldmlld1RleHQuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBEZWJvdW5jZWQgdmVyc2lvbiBvZiB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcgZm9yIHBlcmZvcm1hbmNlXG5cdCAqL1xuXHRwcml2YXRlIGRlYm91bmNlZFVwZGF0ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMudXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0ID0gbnVsbDtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuQ09OVEVYVF9QUkVWSUVXX0RFQk9VTkNFX01TKTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0UHJldmlldyB8fCAhdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0aWYgKCFtZXNzYWdlKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUGFyc2UgZG9jdW1lbnQgcmVmZXJlbmNlcyBmcm9tIGN1cnJlbnQgbWVzc2FnZVxuXHRcdC8vIE5vdGU6IEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRjb25zdCBmb3VuZFJlZnM6IEFycmF5PHtuYW1lOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nfT4gPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcblx0XHRcdFxuXHRcdFx0Ly8gVHJ5IHRvIGZpbmQgdGhlIGZpbGUgdG8gdmFsaWRhdGUgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZUJ5TmFtZShkb2NOYW1lKTtcblx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdGZvdW5kUmVmcy5wdXNoKHtcblx0XHRcdFx0XHRuYW1lOiBkb2NOYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHRcdGNvbnN0IHBlcnNpc3RlbnREb2NzID0gdGhpcy5tdWx0aURvY0hhbmRsZXIuZ2V0UGVyc2lzdGVudENvbnRleHQodGhpcy5jdXJyZW50RmlsZT8ucGF0aCB8fCAnJyk7XG5cdFx0cGVyc2lzdGVudERvY3MuZm9yRWFjaChkb2MgPT4ge1xuXHRcdFx0Ly8gT25seSBhZGQgaWYgbm90IGFscmVhZHkgaW4gZm91bmRSZWZzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcblx0XHRcdGNvbnN0IGV4aXN0cyA9IGZvdW5kUmVmcy5zb21lKHJlZiA9PiByZWYubmFtZSA9PT0gZG9jLmZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0aWYgKCFleGlzdHMpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvYy5maWxlLmJhc2VuYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5OiBkb2MucHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBVcGRhdGUgcHJldmlld1xuXHRcdGlmIChmb3VuZFJlZnMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgcHJldmlld0xpc3QgPSB0aGlzLmNvbnRleHRQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBmb3VuZFJlZnMubWFwKHJlZiA9PiB7XG5cdFx0XHRcdFx0Y29uc3Qgc3VmZml4ID0gcmVmLnByb3BlcnR5ID8gYCMke3JlZi5wcm9wZXJ0eX1gIDogJyc7XG5cdFx0XHRcdFx0cmV0dXJuIGAke3JlZi5uYW1lfSR7c3VmZml4fWA7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRwcmV2aWV3TGlzdC50ZXh0Q29udGVudCA9IGRvY05hbWVzLmpvaW4oJywgJyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBmaW5kRmlsZUJ5TmFtZShuYW1lT3JQYXRoOiBzdHJpbmcpOiBURmlsZSB8IG51bGwge1xuXHRcdC8vIEZpcnN0IHRyeSBleGFjdCBwYXRoIG1hdGNoXG5cdFx0bGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCk7XG5cdFx0XG5cdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0Ly8gVHJ5IHdpdGggLm1kIGV4dGVuc2lvblxuXHRcdFx0ZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoICsgJy5tZCcpO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBTZWFyY2ggYnkgYmFzZW5hbWVcblx0XHRcdGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXHRcdFx0ZmlsZSA9IGZpbGVzLmZpbmQoZiA9PiBcblx0XHRcdFx0Zi5iYXNlbmFtZSA9PT0gbmFtZU9yUGF0aCB8fCBcblx0XHRcdFx0Zi5uYW1lID09PSBuYW1lT3JQYXRoIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoKSB8fFxuXHRcdFx0XHRmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCArICcubWQnKVxuXHRcdFx0KSB8fCBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gZmlsZSA6IG51bGw7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IuZW1wdHkoKTtcblx0XHRcblx0XHRpZiAoIXRoaXMuY3VycmVudENvbnRleHQpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBhbGxEb2NzID0gdGhpcy5jdXJyZW50Q29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcblx0XHRpZiAoYWxsRG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFNob3cgYXMgdGhpbiBsaW5lIHdpdGggbW9iaWxlLW9wdGltaXplZCBzaXppbmdcblx0XHRjb25zdCBpc01vYmlsZSA9IFBsYXRmb3JtLmlzTW9iaWxlO1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogYmxvY2s7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzAuOWVtJyA6ICcwLjhlbSd9O1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0Ly8gU2luZ2xlIGxpbmUgc3VtbWFyeSAoc2FtZSBzdHlsZSBhcyBsaXZlIHByZXZpZXcpXG5cdFx0Y29uc3Qgc3VtbWFyeUVsID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1zdW1tYXJ5JyB9KTtcblx0XHRzdW1tYXJ5RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0d2lkdGg6IDEwMCU7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwb2ludGVyLWV2ZW50czogYXV0bztcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHN1bW1hcnlUZXh0RWwgPSBzdW1tYXJ5RWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1zdW1tYXJ5LXRleHQnIH0pO1xuXHRcdFxuXHRcdGNvbnN0IHRva2VuUGVyY2VudCA9IE1hdGgucm91bmQoKHRoaXMuY3VycmVudENvbnRleHQudG9rZW5Db3VudCAvIDgwMDApICogMTAwKTtcblx0XHRjb25zdCBkb2NOYW1lcyA9IGFsbERvY3MubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuc2xpY2UoMCwgaXNNb2JpbGUgPyAxIDogMik7XG5cdFx0Y29uc3QgbW9yZUNvdW50ID0gYWxsRG9jcy5sZW5ndGggPiAoaXNNb2JpbGUgPyAxIDogMikgPyBgICske2FsbERvY3MubGVuZ3RoIC0gKGlzTW9iaWxlID8gMSA6IDIpfWAgOiAnJztcblx0XHRcblx0XHQvLyBNb2JpbGUtb3B0aW1pemVkIHRleHQgKHNob3J0ZXIgb24gbW9iaWxlKSB3aXRoIHByb3BlciBmbGV4IGFsaWdubWVudFxuXHRcdHN1bW1hcnlUZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZsZXg6IDE7IHBvaW50ZXItZXZlbnRzOiBub25lOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0c3VtbWFyeVRleHRFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgYCAke2RvY05hbWVzLmpvaW4oJywgJyl9JHttb3JlQ291bnR9ICgke3Rva2VuUGVyY2VudH0lKWA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlUZXh0RWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgJHtkb2NOYW1lcy5qb2luKCcsICcpfSR7bW9yZUNvdW50fSAoJHt0b2tlblBlcmNlbnR9JSB0b2tlbnMpYDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gTW9iaWxlLWZyaWVuZGx5IG1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRjb25zdCBleHBhbmRJbmRpY2F0b3JFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZC1pbmRpY2F0b3InIH0pO1xuXHRcdGV4cGFuZEluZGljYXRvckVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignbW9yZS1ob3Jpem9udGFsJywgaXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCcpOyAvLyBNb3JlIG1lbnUgaW5kaWNhdG9yXG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE2cHgnIDogJzE0cHgnfTtcblx0XHRcdG9wYWNpdHk6IDAuODtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnOHB4JyA6ICc0cHgnfTtcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBub25lO1xuXHRcdGA7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc2V0QXR0cigndGl0bGUnLCAnVGFwIHRvIG1hbmFnZSBkb2N1bWVudHMnKTtcblx0XHRcblx0XHQvLyBWaXN1YWwgZmVlZGJhY2sgb24gdGhlIHdob2xlIHN1bW1hcnkgbGluZSBpbnN0ZWFkIG9mIGp1c3QgdGhlIGluZGljYXRvclxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKSc7XG5cdFx0XHR9KTtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0dGhpcy5hZGRUcmFja2VkVGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMiknO1xuXHRcdFx0fSk7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEV4cGFuZGVkIHN0YXRlIC0gbW9iaWxlLXJlc3BvbnNpdmUgb3ZlcmxheVxuXHRcdGNvbnN0IGV4cGFuZGVkRWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkJyB9KTtcblx0XHRleHBhbmRlZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRyaWdodDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgJHtpc01vYmlsZSA/ICctNHB4IDE2cHgnIDogJy0ycHggOHB4J30gcmdiYSgwLCAwLCAwLCAke2lzTW9iaWxlID8gJzAuMTUnIDogJzAuMSd9KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAycHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAke2lzTW9iaWxlID8gJzYwdmgnIDogJzIwMHB4J307XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzEwMCUnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciBmb3IgZXhwYW5kZWQgc3RhdGUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIGNsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IGV4cGFuZGVkSGVhZGVyRWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZC1oZWFkZXInIH0pO1xuXHRcdGV4cGFuZGVkSGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgaGVhZGVyVGl0bGVFbCA9IGV4cGFuZGVkSGVhZGVyRWwuY3JlYXRlU3BhbigpO1xuXHRcdGhlYWRlclRpdGxlRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgRG9jdW1lbnRzICgke2FsbERvY3MubGVuZ3RofSlgO1xuXHRcdGhlYWRlclRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCBidXR0b24gdXNpbmcgc2FtZSBpY29uIGFzIG1haW4gc2lkZWJhclxuXHRcdGNvbnN0IGNsZWFyQWxsQnRuQ29tcG9uZW50ID0gbmV3IEJ1dHRvbkNvbXBvbmVudChleHBhbmRlZEhlYWRlckVsKTtcblx0XHRjbGVhckFsbEJ0bkNvbXBvbmVudC5zZXRJY29uKCdlcmFzZXInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGFsbCBkb2N1bWVudHMgZnJvbSBjb250ZXh0Jylcblx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcblx0XHRjb25zdCBjbGVhckFsbEJ0biA9IGNsZWFyQWxsQnRuQ29tcG9uZW50LmJ1dHRvbkVsO1xuXHRcdGNsZWFyQWxsQnRuLmFkZENsYXNzKCdub3ZhLWNvbnRleHQtY2xlYXItYWxsLWJ0bicpO1xuXHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCAxMnB4JyA6ICc0cHggOHB4J307XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvdWNoLWZyaWVuZGx5IGZlZWRiYWNrIGZvciBjbGVhciBidXR0b25cblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRG9jdW1lbnQgbGlzdCBmb3IgZXhwYW5kZWQgc3RhdGVcblx0XHRjb25zdCBkb2NMaXN0RWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtbGlzdCcgfSk7XG5cdFx0XG5cdFx0YWxsRG9jcy5mb3JFYWNoKChkb2MsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBkb2NJdGVtRWwgPSBkb2NMaXN0RWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1pdGVtJyB9KTtcblx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0XHRib3JkZXItYm90dG9tOiAke2luZGV4IDwgYWxsRG9jcy5sZW5ndGggLSAxID8gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknIDogJ25vbmUnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzU2cHgnIDogJ2F1dG8nfTtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGRvY0luZm9FbCA9IGRvY0l0ZW1FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWluZm8nIH0pO1xuXHRcdFx0ZG9jSW5mb0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogJHtpc01vYmlsZSA/ICcxMnB4JyA6ICc4cHgnfTtcblx0XHRcdFx0ZmxleDogMTtcblx0XHRcdFx0bWluLXdpZHRoOiAwO1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgaWNvbkVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oKTtcblx0XHRcdGljb25FbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2ZpbGUtdGV4dCcpO1xuXHRcdFx0aWNvbkVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZm9udC1zaXplOiAxZW07Jztcblx0XHRcdFxuXHRcdFx0Y29uc3QgbmFtZUVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLW5hbWUnIH0pO1xuXHRcdFx0Y29uc3Qgc3VmZml4ID0gZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyc7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBgJHtkb2MuZmlsZS5iYXNlbmFtZX0ke3N1ZmZpeH1gO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA0MDA7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXHRcdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0XHR3aGl0ZS1zcGFjZTogbm93cmFwO1xuXHRcdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdGA7XG5cdFx0XHRuYW1lRWwuc2V0QXR0cigndGl0bGUnLCBgJHtkb2MuZmlsZS5wYXRofSAocmVhZC1vbmx5IGZvciBlZGl0aW5nKWApO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgcmVhZC1vbmx5IGluZGljYXRvclxuXHRcdFx0Y29uc3QgcmVhZE9ubHlFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXJlYWRvbmx5JyB9KTtcblx0XHRcdHJlYWRPbmx5RWwudGV4dENvbnRlbnQgPSAncmVhZC1vbmx5Jztcblx0XHRcdHJlYWRPbmx5RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRcdHBhZGRpbmc6IDFweCA0cHg7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDNweDtcblx0XHRcdFx0bWFyZ2luLWxlZnQ6IDZweDtcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdFx0dGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcblx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gTW9iaWxlLW9wdGltaXplZCByZW1vdmUgYnV0dG9uIHdpdGggbGFyZ2VyIHRvdWNoIHRhcmdldFxuXHRcdFx0Y29uc3QgcmVtb3ZlQnRuID0gZG9jSXRlbUVsLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25vdmEtY29udGV4dC1kb2MtcmVtb3ZlJyB9KTtcblx0XHRcdHJlbW92ZUJ0bi5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ3gnLCBpc01vYmlsZSA/ICcxOHB4JyA6ICcxNHB4Jyk7XG5cdFx0XHRyZW1vdmVCdG4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0YmFja2dyb3VuZDogbm9uZTtcblx0XHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0d2lkdGg6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnMjBweCd9O1xuXHRcdFx0XHRoZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnMjBweCd9O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0XHRmb250LXNpemU6ICR7aXNNb2JpbGUgPyAnMThweCcgOiAnMTRweCd9O1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IGJvbGQ7XG5cdFx0XHRgO1xuXHRcdFx0cmVtb3ZlQnRuLnNldEF0dHIoJ3RpdGxlJywgYFJlbW92ZSAke2RvYy5maWxlLmJhc2VuYW1lfWApO1xuXHRcdFx0XG5cdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZTogRXZlbnQpID0+IHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5yZW1vdmVQZXJzaXN0ZW50RG9jKHRoaXMuY3VycmVudEZpbGUucGF0aCwgZG9jLmZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gUGxhdGZvcm0tc3BlY2lmaWMgaW50ZXJhY3Rpb24gZmVlZGJhY2tcblx0XHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFRvdWNoIGZlZWRiYWNrIGZvciBkb2N1bWVudCBpdGVtc1xuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gQ2xpY2sgdG8gZXhwYW5kIG1hbmFnZW1lbnQgb3ZlcmxheVxuXHRcdGxldCBpc0V4cGFuZGVkID0gZmFsc2U7XG5cdFx0XG5cdFx0Y29uc3QgdG9nZ2xlRXhwYW5kZWQgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGlzRXhwYW5kZWQgPSAhaXNFeHBhbmRlZDtcblx0XHRcdFxuXHRcdFx0aWYgKGlzRXhwYW5kZWQpIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICcxMDAxJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLnpJbmRleCA9ICdhdXRvJztcblx0XHRcdH1cblx0XHR9O1xuXHRcdFxuXHRcdC8vIENsaWNrIG9uIHRoZSBlbnRpcmUgc3VtbWFyeSBsaW5lIHRvIGV4cGFuZFxuXHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUV4cGFuZGVkKTtcblx0XHRcblx0XHQvLyBDbG9zZSB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjbG9zZUhhbmRsZXI6IEV2ZW50TGlzdGVuZXIgPSAoZTogRXZlbnQpID0+IHtcblx0XHRcdGlmIChpc0V4cGFuZGVkICYmICF0aGlzLmNvbnRleHRJbmRpY2F0b3IuY29udGFpbnMoZS50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0aXNFeHBhbmRlZCA9IGZhbHNlO1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnYXV0byc7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZUhhbmRsZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZWZyZXNoQ29udGV4dCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KCcnLCB0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSByZXN1bHQuY29udGV4dDtcblx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlU2VuZChtZXNzYWdlPzogc3RyaW5nKSB7XG5cdFx0Ly8gR2V0IG1lc3NhZ2UgZnJvbSBwYXJhbWV0ZXIgb3IgZnJvbSBpbnB1dCBoYW5kbGVyXG5cdFx0Y29uc3QgbWVzc2FnZVRleHQgPSBtZXNzYWdlIHx8IHRoaXMuaW5wdXRIYW5kbGVyLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZVRleHQpIHJldHVybjtcblxuXHRcdC8vIENoZWNrIGlmIE5vdmEgaXMgZW5hYmxlZCBhbmQgYSBwcm92aWRlciBpcyBhdmFpbGFibGVcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGlmICghY3VycmVudFByb3ZpZGVyVHlwZSkge1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnYWxlcnQtY2lyY2xlJywgJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlLiBQbGVhc2UgY29uZmlndXJlIGFuIEFJIHByb3ZpZGVyIGluIHNldHRpbmdzLicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY29tbWFuZCBzeXN0ZW0gZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRpZiAobWVzc2FnZVRleHQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRjb25zdCBjb21tYW5kUmVzdWx0ID0gYXdhaXQgdGhpcy5oYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZVRleHQpO1xuXHRcdFx0aWYgKGNvbW1hbmRSZXN1bHQpIHtcblx0XHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkIGFuZCBwYXJzZSByZWZlcmVuY2VzXG5cdFx0bGV0IHByb2Nlc3NlZE1lc3NhZ2UgPSBtZXNzYWdlVGV4dDtcblx0XHRsZXQgbXVsdGlEb2NDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XHRcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Ly8gQ2hlY2sgZm9yIGVhcmx5IGFjY2Vzc1xuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRcdGlmIChtZXNzYWdlVGV4dC5pbmNsdWRlcygnW1snKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnK1tbJykpIHtcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2Jvb2stb3BlbicsICdNdWx0aS1kb2N1bWVudCBjb250ZXh0IGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIEF1Z3VzdCAxNSwgMjAyNS4nKSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBQYXJzZSBhbmQgYnVpbGQgY29udGV4dFxuXHRcdFx0XHRjb25zdCBjb250ZXh0UmVzdWx0ID0gYXdhaXQgdGhpcy5tdWx0aURvY0hhbmRsZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2VUZXh0LCB0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0cHJvY2Vzc2VkTWVzc2FnZSA9IGNvbnRleHRSZXN1bHQuY2xlYW5lZE1lc3NhZ2U7XG5cdFx0XHRcdG11bHRpRG9jQ29udGV4dCA9IGNvbnRleHRSZXN1bHQuY29udGV4dDtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG11bHRpRG9jQ29udGV4dDtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFVwZGF0ZSBVSSBpbmRpY2F0b3Jcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayBpZiBtZXNzYWdlIGlzIGp1c3QgZG9jdW1lbnQgcmVmZXJlbmNlcyAoY29udGV4dC1vbmx5IG1vZGUpXG5cdFx0XHRcdC8vIFNpbmNlIGFsbCBkb2NzIGFyZSBub3cgcGVyc2lzdGVudCwgY2hlY2sgaWYgd2UgaGF2ZSBuZXcgZG9jcyBhbmQgZW1wdHkgbWVzc2FnZVxuXHRcdFx0XHRjb25zdCBwcmV2aW91c1BlcnNpc3RlbnRDb3VudCA9IHRoaXMuY3VycmVudENvbnRleHQ/LnBlcnNpc3RlbnREb2NzLmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRjb25zdCBjdXJyZW50UGVyc2lzdGVudENvdW50ID0gbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aDtcblx0XHRcdFx0Y29uc3QgaGFzTmV3RG9jcyA9IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgPiBwcmV2aW91c1BlcnNpc3RlbnRDb3VudDtcblx0XHRcdFx0Y29uc3QgaXNDb250ZXh0T25seU1lc3NhZ2UgPSBwcm9jZXNzZWRNZXNzYWdlLnRyaW0oKS5sZW5ndGggPT09IDAgJiYgaGFzTmV3RG9jcztcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChpc0NvbnRleHRPbmx5TWVzc2FnZSkge1xuXHRcdFx0XHRcdC8vIEhhbmRsZSBjb250ZXh0LW9ubHkgY29tbWFuZHMgLSBzaG93IG5ld2x5IGFkZGVkIGRvY3VtZW50c1xuXHRcdFx0XHRcdGNvbnN0IG5ld0RvY3NDb3VudCA9IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgLSBwcmV2aW91c1BlcnNpc3RlbnRDb3VudDtcblx0XHRcdFx0XHRpZiAobmV3RG9jc0NvdW50ID4gMCkge1xuXHRcdFx0XHRcdFx0Ly8gR2V0IHRoZSBuZXdseSBhZGRlZCBkb2N1bWVudHMgKGxhc3QgTiBkb2N1bWVudHMpXG5cdFx0XHRcdFx0XHRjb25zdCBuZXdEb2NzID0gbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLnNsaWNlKC1uZXdEb2NzQ291bnQpO1xuXHRcdFx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBuZXdEb2NzLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2NoZWNrLWNpcmNsZScsIGBBZGRlZCAke25ld0RvY3NDb3VudH0gZG9jdW1lbnQke25ld0RvY3NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSB0byBwZXJzaXN0ZW50IGNvbnRleHQ6ICR7ZG9jTmFtZXN9YCkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDbGVhciBpbnB1dCBhbmQgdXBkYXRlIGNvbnRleHQgaW5kaWNhdG9yXG5cdFx0XHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEhpZGUgY29udGV4dCBwcmV2aWV3IHNpbmNlIHdlJ3JlIGRvbmVcblx0XHRcdFx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0XHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIFNob3cgY29udGV4dCBjb25maXJtYXRpb24gaWYgZG9jdW1lbnRzIHdlcmUgaW5jbHVkZWQgaW4gYSByZWd1bGFyIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgYWxsRG9jcyA9IG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGFsbERvY3MubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKTtcblx0XHRcdFx0XHRjb25zdCB0b2tlbkluZm8gPSBtdWx0aURvY0NvbnRleHQudG9rZW5Db3VudCA+IDAgPyBgICh+JHttdWx0aURvY0NvbnRleHQudG9rZW5Db3VudH0gdG9rZW5zKWAgOiAnJztcblx0XHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuY3VycmVudEZpbGU/LmJhc2VuYW1lIHx8ICdjdXJyZW50IGZpbGUnO1xuXHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnc3lzdGVtJywgdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnYm9vay1vcGVuJywgYEluY2x1ZGVkICR7YWxsRG9jcy5sZW5ndGh9IGRvY3VtZW50JHthbGxEb2NzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBpbiBjb250ZXh0OiAke2RvY05hbWVzfSR7dG9rZW5JbmZvfS4gQ29udGV4dCBkb2N1bWVudHMgYXJlIHJlYWQtb25seTsgZWRpdCBjb21tYW5kcyB3aWxsIG9ubHkgbW9kaWZ5ICR7Y3VycmVudEZpbGV9LmApKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgdG9rZW4gbGltaXRcblx0XHRcdFx0aWYgKG11bHRpRG9jQ29udGV4dC5pc05lYXJMaW1pdCkge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1x1MjZBMFx1RkUwRiBBcHByb2FjaGluZyB0b2tlbiBsaW1pdC4gQ29uc2lkZXIgcmVtb3Zpbmcgc29tZSBkb2N1bWVudHMgZnJvbSBjb250ZXh0LicsIE5vdmFTaWRlYmFyVmlldy5OT1RJQ0VfRFVSQVRJT05fTVMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIHVzZXIgbWVzc2FnZSAoc2hvdyBvcmlnaW5hbCB3aXRoIHJlZmVyZW5jZXMpXG5cdFx0dGhpcy5hZGRNZXNzYWdlKCd1c2VyJywgbWVzc2FnZVRleHQpO1xuXHRcdHRoaXMuaW5wdXRIYW5kbGVyLnNldFZhbHVlKCcnKTtcblx0XHRcblx0XHQvLyBIaWRlIGNvbnRleHQgcHJldmlldyBzaW5jZSB3ZSdyZSBzZW5kaW5nIHRoZSBtZXNzYWdlXG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRGlzYWJsZSBzZW5kIGJ1dHRvbiBkdXJpbmcgcHJvY2Vzc2luZ1xuXHRcdGNvbnN0IHNlbmRCdXR0b24gPSAodGhpcy5pbnB1dEhhbmRsZXIgYXMgYW55KS5zZW5kQnV0dG9uO1xuXHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKHRydWUpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFkZCBsb2FkaW5nIGluZGljYXRvciB3aXRoIGFuaW1hdGVkIG5vdmFcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxvYWRpbmcnIH0pO1xuXHRcdFx0bG9hZGluZ0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAxMnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDEwcHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBDcmVhdGUgYW5pbWF0ZWQgbm92YSBidXJzdFxuXHRcdFx0Y29uc3Qgbm92YUNvbnRhaW5lciA9IGxvYWRpbmdFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJ1cnN0LWNvbnRhaW5lcicgfSk7XG5cdFx0XHRub3ZhQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYnVyc3RcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jb3JlXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTJcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0zXCI+PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgdGV4dEVsID0gbG9hZGluZ0VsLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTm92YSBpcyB0aGlua2luZy4uLicgfSk7XG5cdFx0XHR0ZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gU3RvcmUgbWVzc2FnZSBpbiBjb252ZXJzYXRpb24gbWFuYWdlclxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShtZXNzYWdlVGV4dCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYSBjb21tYW5kIG9yIGNvbnZlcnNhdGlvblxuXHRcdFx0Y29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlclsnaXNMaWtlbHlDb21tYW5kJ10ocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHRsZXQgcmVzcG9uc2U6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNMaWtlbHlDb21tYW5kICYmIGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0Ly8gUGFyc2UgYXMgY29tbWFuZCBhbmQgcm91dGUgdG8gYXBwcm9wcmlhdGUgaGFuZGxlclxuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChwYXJzZWRDb21tYW5kKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBhcyBjb252ZXJzYXRpb24gdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdFx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShwcm9jZXNzZWRNZXNzYWdlLCBhY3RpdmVGaWxlIHx8IHVuZGVmaW5lZCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBBZGQgbXVsdGktZG9jdW1lbnQgY29udGV4dCBpZiBhdmFpbGFibGVcblx0XHRcdFx0aWYgKG11bHRpRG9jQ29udGV4dCAmJiBtdWx0aURvY0NvbnRleHQuY29udGV4dFN0cmluZykge1xuXHRcdFx0XHRcdC8vIFRoZSBjb250ZXh0IGFscmVhZHkgaW5jbHVkZXMgdGhlIGN1cnJlbnQgZmlsZSwgc28gd2UgY2FuIHVzZSBpdCBkaXJlY3RseVxuXHRcdFx0XHRcdGNvbnN0IGVuaGFuY2VkVXNlclByb21wdCA9IGAke211bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nfVxcblxcbi0tLVxcblxcblVzZXIgUmVxdWVzdDogJHtwcm9jZXNzZWRNZXNzYWdlfWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0IHx8ICcnLCBlbmhhbmNlZFVzZXJQcm9tcHQsIHtcblx0XHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRcdFx0bWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIEdldCBBSSByZXNwb25zZSB1c2luZyB0aGUgcHJvdmlkZXIgbWFuYWdlclxuXHRcdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJywgcHJvbXB0LnVzZXJQcm9tcHQsIHtcblx0XHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRcdFx0bWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvclxuXHRcdFx0bG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHQvLyBGaWx0ZXIgdGhpbmtpbmcgY29udGVudCBmcm9tIHJlc3BvbnNlXG5cdFx0XHRjb25zdCBmaWx0ZXJlZFJlc3BvbnNlID0gcmVzcG9uc2UgPyB0aGlzLmZpbHRlclRoaW5raW5nQ29udGVudChyZXNwb25zZSkgOiByZXNwb25zZTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RvcmUgZmlsdGVyZWQgcmVzcG9uc2UgaW4gY29udmVyc2F0aW9uIG1hbmFnZXIgKGlmIHJlc3BvbnNlIGV4aXN0cylcblx0XHRcdGlmIChhY3RpdmVGaWxlICYmIGZpbHRlcmVkUmVzcG9uc2UpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShmaWx0ZXJlZFJlc3BvbnNlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGZpbHRlcmVkIEFJIHJlc3BvbnNlIChvbmx5IGlmIHRoZXJlIGlzIGEgcmVzcG9uc2UpXG5cdFx0XHRpZiAoZmlsdGVyZWRSZXNwb25zZSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZiByZXNwb25zZSBpcyBhbiBlcnJvciBtZXNzYWdlIChjb250YWlucyB4LWNpcmNsZSBpY29uIG9yIGVycm9yIGtleXdvcmRzKVxuXHRcdFx0XHRpZiAoZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygneC1jaXJjbGUnKSB8fCBcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdFcnJvciBleGVjdXRpbmcgY29tbWFuZCcpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnRmFpbGVkIHRvJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdObyBtYXJrZG93biBmaWxlIGlzIG9wZW4nKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ1VuYWJsZSB0byBhY2Nlc3MnKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ1VuYWJsZSB0byBzZXQnKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKGZpbHRlcmVkUmVzcG9uc2UpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgZmlsdGVyZWRSZXNwb25zZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yIGlmIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgbG9hZGluZ0VsID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWxvYWRpbmcnKTtcblx0XHRcdGlmIChsb2FkaW5nRWwpIGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdFxuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgU29ycnksIEkgZW5jb3VudGVyZWQgYW4gZXJyb3I6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApKTtcblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0Ly8gUmUtZW5hYmxlIHNlbmQgYnV0dG9uXG5cdFx0XHRjb25zdCBzZW5kQnV0dG9uID0gKHRoaXMuaW5wdXRIYW5kbGVyIGFzIGFueSkuc2VuZEJ1dHRvbjtcblx0XHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcblx0XHRcdC8vIFJlZnJlc2ggY29udGV4dCBpbmRpY2F0b3IgdG8gc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50c1xuXHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGluc2VydFRleHRJbnRvQWN0aXZlTm90ZSh0ZXh0OiBzdHJpbmcpIHtcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoSXRlbVZpZXcpO1xuXHRcdGlmIChhY3RpdmVWaWV3ICYmICdlZGl0b3InIGluIGFjdGl2ZVZpZXcpIHtcblx0XHRcdGNvbnN0IGVkaXRvciA9IChhY3RpdmVWaWV3IGFzIGFueSkuZWRpdG9yO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCwgY3Vyc29yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlJ3MgYSBjdXJyZW50IGZpbGUgKHRoZSBvbmUgd2UncmUgY2hhdHRpbmcgYWJvdXQpXG5cdFx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgJ05vIG1hcmtkb3duIGZpbGUgaXMgb3Blbi4gUGxlYXNlIG9wZW4gYSBmaWxlIGluIHRoZSBlZGl0b3IgdG8gdXNlIGVkaXRpbmcgY29tbWFuZHMuJyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEVuc3VyZSB0aGVyZSdzIGEgbWFya2Rvd24gdmlldyB3aXRoIHRoaXMgZmlsZVxuXHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdGxldCBtYXJrZG93blZpZXc6IE1hcmtkb3duVmlldyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIHRoZSB2aWV3IHdpdGggb3VyIGZpbGVcblx0XHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdGlmICh2aWV3LmZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSB2aWV3O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIElmIG5vdCBmb3VuZCwgdHJ5IHRvIG9wZW4gdGhlIGZpbGVcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRcdGlmIChsZWFmKSB7XG5cdFx0XHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gYWNjZXNzIHRoZSBmaWxlIFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiLiBQbGVhc2UgbWFrZSBzdXJlIGl0J3Mgb3BlbiBpbiB0aGUgZWRpdG9yLmApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDUklUSUNBTCBTRUNVUklUWTogRW5zdXJlIHRoZSBhY3RpdmUgZmlsZSBtYXRjaGVzIG91ciBjb252ZXJzYXRpb24gZmlsZVxuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgZWRpdGluZyBjb250ZXh0IGRvY3VtZW50cyB0aGF0IG1pZ2h0IGJlIG9wZW5cblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKCFhY3RpdmVGaWxlIHx8IGFjdGl2ZUZpbGUgIT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0Ly8gTWFrZSB0aGUgY29udmVyc2F0aW9uIGZpbGUgYWN0aXZlIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZHNcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobWFya2Rvd25WaWV3LmxlYWYsIHsgZm9jdXM6IHRydWUgfSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBEb3VibGUtY2hlY2sgdGhhdCB0aGUgZmlsZSBpcyBub3cgYWN0aXZlXG5cdFx0XHRcdGNvbnN0IG5vd0FjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0XHRpZiAoIW5vd0FjdGl2ZUZpbGUgfHwgbm93QWN0aXZlRmlsZSAhPT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gc2V0IFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiIGFzIHRoZSBhY3RpdmUgZmlsZS4gRWRpdCBjb21tYW5kcyBjYW4gb25seSBtb2RpZnkgdGhlIGZpbGUgeW91J3JlIGNoYXR0aW5nIGFib3V0IHRvIHByZXZlbnQgYWNjaWRlbnRhbCBjaGFuZ2VzIHRvIGNvbnRleHQgZG9jdW1lbnRzLmApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGxldCByZXN1bHQ7XG5cdFx0XHRcblx0XHRcdHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcblx0XHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4ucmV3cml0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ21ldGFkYXRhJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIGBJIGRvbid0IHVuZGVyc3RhbmQgdGhlIGNvbW1hbmQgXCIke2NvbW1hbmQuYWN0aW9ufVwiLiBUcnkgYXNraW5nIG1lIHRvIGFkZCwgZWRpdCwgZGVsZXRlLCBmaXggZ3JhbW1hciwgcmV3cml0ZSBjb250ZW50LCBvciB1cGRhdGUgbWV0YWRhdGEvcHJvcGVydGllcy5gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0Ly8gQWRkIGNvbXBhY3Qgc3VjY2VzcyBpbmRpY2F0b3IgaW5zdGVhZCBvZiBmdWxsIG1lc3NhZ2Vcblx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzSW5kaWNhdG9yKGNvbW1hbmQuYWN0aW9uKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7IC8vIERvbid0IHJldHVybiB0ZXh0IGZvciByZWd1bGFyIG1lc3NhZ2Vcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBgRmFpbGVkIHRvICR7Y29tbWFuZC5hY3Rpb259OiAke3Jlc3VsdC5lcnJvcn1gO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQ6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApO1xuXHRcdH1cblx0fVxuXG5cblx0cHJpdmF0ZSBhc3luYyBsb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpIHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBJZiBubyBhY3RpdmUgZmlsZSwgdHJ5IHRvIGZpbmQgdGhlIGN1cnJlbnRseSBhY3RpdmUgbGVhZidzIGZpbGVcblx0XHRsZXQgdGFyZ2V0RmlsZSA9IGFjdGl2ZUZpbGU7XG5cdFx0aWYgKCF0YXJnZXRGaWxlKSB7XG5cdFx0XHRjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWY7XG5cdFx0XHRpZiAoYWN0aXZlTGVhZiAmJiBhY3RpdmVMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRcdFx0dGFyZ2V0RmlsZSA9IGFjdGl2ZUxlYWYudmlldy5maWxlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmFsbCBiYWNrIHRvIGFueSBvcGVuIG1hcmtkb3duIGZpbGUgb25seSBpZiBubyBhY3RpdmUgbGVhZlxuXHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuXHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHRcdHRhcmdldEZpbGUgPSB2aWV3LmZpbGU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbm8gZmlsZSBhdmFpbGFibGUgYW5kIHdlIGhhdmUgYSBjdXJyZW50IGZpbGUsIGNsZWFyIGV2ZXJ5dGhpbmdcblx0XHRpZiAoIXRhcmdldEZpbGUgJiYgdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0dGhpcy5jdXJyZW50RmlsZSA9IG51bGw7XG5cdFx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcdHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoJ09wZW4gYSBkb2N1bWVudCB0byBnZXQgc3RhcnRlZC4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbm8gZmlsZSBvciBzYW1lIGZpbGUsIGRvIG5vdGhpbmdcblx0XHRpZiAoIXRhcmdldEZpbGUgfHwgdGFyZ2V0RmlsZSA9PT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmN1cnJlbnRGaWxlID0gdGFyZ2V0RmlsZTtcblx0XHRcblx0XHQvLyBDbGVhciBjdXJyZW50IGNoYXRcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBSZWZyZXNoIGNvbnRleHQgZm9yIG5ldyBmaWxlICh0aGlzIHdpbGwgc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50cyBpZiBhbnkpXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBMb2FkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGlmIGl0IGV4aXN0c1xuXHRcdFx0Y29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKHRhcmdldEZpbGUsIDEwKTtcblx0XHRcdFxuXHRcdFx0aWYgKHJlY2VudE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gRGlzcGxheSByZWNlbnQgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0XHRcdFx0cmVjZW50TWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuXHRcdFx0XHRcdGlmIChtc2cucm9sZSAhPT0gJ3N5c3RlbScpIHtcblx0XHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZShtc2cucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JywgbXNnLmNvbnRlbnQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBTaG93IHdlbGNvbWUgbWVzc2FnZSBmb3IgbmV3IGZpbGVcblx0XHRcdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZShgV29ya2luZyBvbiBcIiR7dGFyZ2V0RmlsZS5iYXNlbmFtZX1cIi5gKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGhpc3RvcnkgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2Ugb24gZXJyb3Jcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoYFdvcmtpbmcgb24gXCIke3RhcmdldEZpbGUuYmFzZW5hbWV9XCIuYCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjbGVhckNoYXQoKSB7XG5cdFx0Ly8gQ2xlYXIgdGhlIGNoYXQgY29udGFpbmVyXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY29udmVyc2F0aW9uIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24odGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdC8vIEFsc28gY2xlYXIgbXVsdGktZG9jIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHR0aGlzLm11bHRpRG9jSGFuZGxlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIEZhaWxlZCB0byBjbGVhciBjb252ZXJzYXRpb24gLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IGZyZXNoIHdlbGNvbWUgbWVzc2FnZVxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKGBDaGF0IGNsZWFyZWQuYCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoXCJDaGF0IGNsZWFyZWQuXCIpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IG5vdGljZSB0byB1c2VyXG5cdFx0bmV3IE5vdGljZSgnQ2hhdCBoaXN0b3J5IGNsZWFyZWQnKTtcblx0fVxuXG5cdC8vIFB1YmxpYyBtZXRob2RzIGZvciB0ZXN0aW5nXG5cdGFzeW5jIHNlbmRNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gQnVpbGQgcHJvbXB0IHVzaW5nIFByb21wdEJ1aWxkZXJcblx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShtZXNzYWdlLCBhY3RpdmVGaWxlIHx8IHVuZGVmaW5lZCk7XG5cdFx0XG5cdFx0Ly8gVHJ5IHRvIHBhcnNlIGFzIGNvbW1hbmQgZmlyc3Rcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQobWVzc2FnZSk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIHZhbGlkIGNvbW1hbmQgYWN0aW9uXG5cdFx0Y29uc3QgdmFsaWRBY3Rpb25zID0gWydhZGQnLCAnZWRpdCcsICdkZWxldGUnLCAnZ3JhbW1hcicsICdyZXdyaXRlJywgJ21ldGFkYXRhJ107XG5cdFx0aWYgKHZhbGlkQWN0aW9ucy5pbmNsdWRlcyhjb21tYW5kLmFjdGlvbikpIHtcblx0XHRcdC8vIENSSVRJQ0FMIFNFQ1VSSVRZOiBWYWxpZGF0ZSB0aGF0IHdlJ3JlIGVkaXRpbmcgdGhlIGNvcnJlY3QgZmlsZVxuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgZWRpdGluZyBjb250ZXh0IGRvY3VtZW50cyB0aGF0IG1pZ2h0IGJlIG9wZW5cblx0XHRcdC8vIE9ubHkgYXBwbHkgdGhpcyB2YWxpZGF0aW9uIHdoZW4gYm90aCBmaWxlcyBleGlzdCAobm90IGluIHRlc3Qgc2NlbmFyaW9zKVxuXHRcdFx0Y29uc3QgY3VycmVudEFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSAmJiBjdXJyZW50QWN0aXZlRmlsZSAmJiBjdXJyZW50QWN0aXZlRmlsZSAhPT0gYWN0aXZlRmlsZSkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFNlY3VyaXR5IHZpb2xhdGlvbjogQ29tbWFuZCBhdHRlbXB0ZWQgdG8gZWRpdCB3cm9uZyBmaWxlLiBFeHBlY3RlZDogJHthY3RpdmVGaWxlLmJhc2VuYW1lfSwgQWN0aXZlOiAke2N1cnJlbnRBY3RpdmVGaWxlLmJhc2VuYW1lfWApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBFeGVjdXRlIGNvbW1hbmRcblx0XHRcdHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcblx0XHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4ucmV3cml0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ21ldGFkYXRhJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFJlZ3VsYXIgY29udmVyc2F0aW9uXG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFVzZXJNZXNzYWdlKGFjdGl2ZUZpbGUsIG1lc3NhZ2UsIG51bGwgYXMgYW55KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQ2FsbCBBSSBwcm92aWRlclxuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJywgcHJvbXB0LnVzZXJQcm9tcHQpO1xuXHRcdFx0XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZEFzc2lzdGFudE1lc3NhZ2UoYWN0aXZlRmlsZSwgJ0FJIHJlc3BvbnNlJywgeyBzdWNjZXNzOiB0cnVlLCBlZGl0VHlwZTogJ25vbmUnIH0gYXMgYW55KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeShmaWxlOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNTApO1xuXHRcdC8vIEluIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgZGlzcGxheSBtZXNzYWdlcyBpbiB0aGUgVUlcblx0fVxuXG5cblxuXHQvKipcblx0ICogVXBkYXRlIHNlbmQgYnV0dG9uIGVuYWJsZWQvZGlzYWJsZWQgc3RhdGUgYmFzZWQgb24gcHJvdmlkZXIgYXZhaWxhYmlsaXR5XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHVwZGF0ZVNlbmRCdXR0b25TdGF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGNvbnN0IHNlbmRCdXR0b24gPSAodGhpcy5pbnB1dEhhbmRsZXIgYXMgYW55KS5zZW5kQnV0dG9uO1xuXHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKCFjdXJyZW50UHJvdmlkZXJUeXBlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgcHJpdmFjeSBpbmRpY2F0b3IgaWNvbiBhbmQgdG9vbHRpcCBiYXNlZCBvbiBjdXJyZW50IHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHVwZGF0ZVByaXZhY3lJbmRpY2F0b3IocHJpdmFjeUluZGljYXRvcjogSFRNTEVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRjb25zdCBpc0xvY2FsUHJvdmlkZXIgPSBjdXJyZW50UHJvdmlkZXJUeXBlID09PSAnb2xsYW1hJztcblx0XHRcdGNvbnN0IGljb25OYW1lID0gaXNMb2NhbFByb3ZpZGVyID8gJ2xvY2snIDogJ3VubG9jayc7XG5cdFx0XHRjb25zdCB0b29sdGlwID0gaXNMb2NhbFByb3ZpZGVyID8gJ0xvY2FsIHByb2Nlc3NpbmcgLSBkYXRhIHN0YXlzIG9uIHlvdXIgZGV2aWNlJyA6ICdDbG91ZCBwcm9jZXNzaW5nIC0gZGF0YSBzZW50IHRvIHByb3ZpZGVyJztcblx0XHRcdFxuXHRcdFx0Ly8gVXNlIE9ic2lkaWFuJ3Mgc2V0SWNvbiBmdW5jdGlvbiAoc2FtZSBhcyBCdXR0b25Db21wb25lbnQgdXNlcyBpbnRlcm5hbGx5KVxuXHRcdFx0c2V0SWNvbihwcml2YWN5SW5kaWNhdG9yLCBpY29uTmFtZSk7XG5cdFx0XHRcblx0XHRcdC8vIFNldCB0b29sdGlwXG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRvb2x0aXApO1xuXHRcdFx0cHJpdmFjeUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdG9vbHRpcCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIE5vIHByb3ZpZGVyIGF2YWlsYWJsZSAtIHNob3cgZ2VuZXJpYyBwcml2YWN5IGljb25cblx0XHRcdHNldEljb24ocHJpdmFjeUluZGljYXRvciwgJ2hlbHAtY2lyY2xlJyk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdObyBwcm92aWRlciBzZWxlY3RlZCcpO1xuXHRcdFx0cHJpdmFjeUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ05vIHByb3ZpZGVyIHNlbGVjdGVkJyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEZpbHRlciB0aGlua2luZyBjb250ZW50IGZyb20gQUkgcmVzcG9uc2VzXG5cdCAqIFJlbW92ZXMgY29udGVudCBiZXR3ZWVuIDx0aGluaz4vPHRoaW5raW5nPiBhbmQgPC90aGluaz4vPHRoaW5raW5nPiB0YWdzXG5cdCAqL1xuXHRwcml2YXRlIGZpbHRlclRoaW5raW5nQ29udGVudChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFJlbW92ZSB0aGlua2luZyB0YWdzIGFuZCB0aGVpciBjb250ZW50IChjYXNlLWluc2Vuc2l0aXZlLCBtdWx0aS1saW5lKVxuXHRcdC8vIEhhbmRsZXMgYm90aCA8dGhpbms+IChRd2VuMykgYW5kIDx0aGlua2luZz4gKENsYXVkZSkgdGFnc1xuXHRcdHJldHVybiBjb250ZW50LnJlcGxhY2UoLzx0aGluayg/OmluZyk/W1xcc1xcU10qPzxcXC90aGluayg/OmluZyk/Pi9naSwgJycpLnRyaW0oKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIGFsbCBwcm92aWRlciBzdGF0dXMgaW5kaWNhdG9ycyBpbiB0aGUgVUlcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgcmVmcmVzaFByb3ZpZGVyU3RhdHVzKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIFVwZGF0ZSBwcml2YWN5IGluZGljYXRvciBpZiBpdCBleGlzdHNcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnVwZGF0ZVByaXZhY3lJbmRpY2F0b3IoKHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yKTtcblx0XHR9XG5cblx0XHQvLyBVcGRhdGUgc2VuZCBidXR0b24gc3RhdGVcblx0XHR0aGlzLnVwZGF0ZVNlbmRCdXR0b25TdGF0ZSgpO1xuXG5cdFx0Ly8gVXBkYXRlIGRyb3Bkb3duIHByb3ZpZGVyIG5hbWUgaWYgaXQgZXhpc3RzXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LnVwZGF0ZUN1cnJlbnRQcm92aWRlcikge1xuXHRcdFx0YXdhaXQgKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHByb3ZpZGVyIGRyb3Bkb3duIGZvciBhbGwgdXNlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJEcm9wZG93bihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgZHJvcGRvd25Db250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1jb250YWluZXInIH0pO1xuXHRcdGRyb3Bkb3duQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRgO1xuXG5cdFx0Ly8gQ3VycmVudCBwcm92aWRlciBidXR0b25cblx0XHRjb25zdCBwcm92aWRlckJ1dHRvbiA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25vdmEtcHJvdmlkZXItYnV0dG9uJyB9KTtcblx0XHRwcm92aWRlckJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRcdHBhZGRpbmc6IDRweCA4cHg7XG5cdFx0XHRmb250LXNpemU6IDAuNzVlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2U7XG5cdFx0YDtcblxuXHRcdC8vIFByb3ZpZGVyIG5hbWVcblx0XHRjb25zdCBwcm92aWRlck5hbWUgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nIH0pO1xuXG5cdFx0Ly8gRHJvcGRvd24gYXJyb3dcblx0XHRjb25zdCBkcm9wZG93bkFycm93ID0gcHJvdmlkZXJCdXR0b24uY3JlYXRlU3Bhbih7IHRleHQ6ICdcdTI1QkMnIH0pO1xuXHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogMC42ZW07XG5cdFx0XHRtYXJnaW4tbGVmdDogNHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gRHJvcGRvd24gbWVudSAoaW5pdGlhbGx5IGhpZGRlbilcblx0XHRjb25zdCBkcm9wZG93bk1lbnUgPSBkcm9wZG93bkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLW1lbnUnIH0pO1xuXHRcdGRyb3Bkb3duTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0dG9wOiAxMDAlO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRtaW4td2lkdGg6IDE1MHB4O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRgO1xuXG5cdFx0bGV0IGlzRHJvcGRvd25PcGVuID0gZmFsc2U7XG5cblx0XHQvLyBVcGRhdGUgY3VycmVudCBwcm92aWRlciBkaXNwbGF5XG5cdFx0Y29uc3QgdXBkYXRlQ3VycmVudFByb3ZpZGVyID0gYXN5bmMgKCkgPT4ge1xuXHRcdFx0Y29uc3QgY3VycmVudFByb3ZpZGVyVHlwZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEN1cnJlbnRQcm92aWRlclR5cGUoKTtcblx0XHRcdGlmIChjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRcdGNvbnN0IGRpc3BsYXlUZXh0ID0gdGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKGN1cnJlbnRQcm92aWRlclR5cGUpO1xuXHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChkaXNwbGF5VGV4dCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChjdXJyZW50UHJvdmlkZXJOYW1lKTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gVG9nZ2xlIGRyb3Bkb3duXG5cdFx0Y29uc3QgdG9nZ2xlRHJvcGRvd24gPSAoKSA9PiB7XG5cdFx0XHRpc0Ryb3Bkb3duT3BlbiA9ICFpc0Ryb3Bkb3duT3Blbjtcblx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gaXNEcm9wZG93bk9wZW4gPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSBpc0Ryb3Bkb3duT3BlbiA/ICdyb3RhdGUoMTgwZGVnKScgOiAncm90YXRlKDBkZWcpJztcblx0XHRcdFxuXHRcdFx0aWYgKGlzRHJvcGRvd25PcGVuKSB7XG5cdFx0XHRcdHRoaXMucG9wdWxhdGVQcm92aWRlckRyb3Bkb3duKGRyb3Bkb3duTWVudSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIENsb3NlIGRyb3Bkb3duIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlRHJvcGRvd246IEV2ZW50TGlzdGVuZXIgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoIWRyb3Bkb3duQ29udGFpbmVyLmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0Ryb3Bkb3duT3BlbiA9IGZhbHNlO1xuXHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDBkZWcpJztcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0cHJvdmlkZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdHRvZ2dsZURyb3Bkb3duKCk7XG5cdFx0fSk7XG5cblx0XHQvLyBBZGQgZ2xvYmFsIGNsaWNrIGxpc3RlbmVyXG5cdFx0dGhpcy5hZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihkb2N1bWVudCwgJ2NsaWNrJywgY2xvc2VEcm9wZG93bik7XG5cblx0XHQvLyBVcGRhdGUgcHJvdmlkZXIgbmFtZSBpbml0aWFsbHlcblx0XHR1cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgY2xlYW51cFxuXHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24gPSB7XG5cdFx0XHR1cGRhdGVDdXJyZW50UHJvdmlkZXIsXG5cdFx0XHRjbGVhbnVwOiAoKSA9PiBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRHJvcGRvd24pXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYXZhaWxhYmxlIG1vZGVscyBmb3IgYSBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGU6IHN0cmluZyk6IHsgdmFsdWU6IHN0cmluZzsgbGFiZWw6IHN0cmluZyB9W10ge1xuXHRcdHJldHVybiBnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgbW9kZWwgZm9yIGEgcHJvdmlkZXIgdHlwZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IHByb3ZpZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzIGFzIFJlY29yZDxzdHJpbmcsIGFueT47XG5cdFx0Y29uc3QgY3VycmVudE1vZGVsID0gcHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0/Lm1vZGVsO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50TW9kZWwpIHtcblx0XHRcdHJldHVybiBjdXJyZW50TW9kZWw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEdldCBkZWZhdWx0IG1vZGVsIChmaXJzdCBhdmFpbGFibGUgbW9kZWwgZm9yIHRoZSBwcm92aWRlcilcblx0XHRjb25zdCBhdmFpbGFibGVNb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdHJldHVybiBhdmFpbGFibGVNb2RlbHMubGVuZ3RoID4gMCA/IGF2YWlsYWJsZU1vZGVsc1swXS52YWx1ZSA6ICcnO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBtb2RlbCBkaXNwbGF5IG5hbWUgZnJvbSBtb2RlbCB2YWx1ZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBtb2RlbFZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG1vZGVscyA9IHRoaXMuZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSk7XG5cdFx0Y29uc3QgbW9kZWwgPSBtb2RlbHMuZmluZChtID0+IG0udmFsdWUgPT09IG1vZGVsVmFsdWUpO1xuXHRcdHJldHVybiBtb2RlbCA/IG1vZGVsLmxhYmVsIDogbW9kZWxWYWx1ZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBzcGVjaWZpYyBtb2RlbCBmb3IgYSBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBtb2RlbFZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBDaGVjayBpZiB3ZSdyZSBhbHJlYWR5IG9uIHRoaXMgcHJvdmlkZXJcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGNvbnN0IGlzQ3VycmVudFByb3ZpZGVyID0gY3VycmVudFByb3ZpZGVyVHlwZSA9PT0gcHJvdmlkZXJUeXBlO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBzZXR0aW5nc1xuXHRcdGNvbnN0IHByb3ZpZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzIGFzIFJlY29yZDxzdHJpbmcsIGFueT47XG5cdFx0cHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0ubW9kZWwgPSBtb2RlbFZhbHVlO1xuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFxuXHRcdGlmIChpc0N1cnJlbnRQcm92aWRlcikge1xuXHRcdFx0Ly8gSnVzdCBzd2l0Y2hpbmcgbW9kZWxzIG9uIGN1cnJlbnQgcHJvdmlkZXIgLSBzaG93IG1vZGVsIHN3aXRjaCBtZXNzYWdlXG5cdFx0XHRjb25zdCBtb2RlbE5hbWUgPSB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBtb2RlbFZhbHVlKTtcblx0XHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHRcdFx0Y29uc3Qgc3dpdGNoTWVzc2FnZSA9IHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3JlZnJlc2gtY3cnLCBgU3dpdGNoZWQgdG8gJHtwcm92aWRlck5hbWV9ICR7bW9kZWxOYW1lfWApO1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKCdzeXN0ZW0nLCBzd2l0Y2hNZXNzYWdlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gU3dpdGNoaW5nIHRvIGRpZmZlcmVudCBwcm92aWRlciAtIHRoaXMgd2lsbCBzaG93IHRoZSBwcm92aWRlcittb2RlbCBtZXNzYWdlXG5cdFx0XHRhd2FpdCB0aGlzLnN3aXRjaFRvUHJvdmlkZXIocHJvdmlkZXJUeXBlKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBkcm9wZG93biBkaXNwbGF5XG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24pIHtcblx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24udXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBvcHVsYXRlIHByb3ZpZGVyIGRyb3Bkb3duIHdpdGggYXZhaWxhYmxlIHByb3ZpZGVyc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51OiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGRyb3Bkb3duTWVudS5lbXB0eSgpO1xuXG5cdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEFsbG93ZWRQcm92aWRlcnMoKTtcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJOYW1lID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyTmFtZSgpO1xuXG5cdFx0Zm9yIChjb25zdCBwcm92aWRlclR5cGUgb2YgYWxsb3dlZFByb3ZpZGVycykge1xuXHRcdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnKSBjb250aW51ZTtcblxuXHRcdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIEFQSSBrZXkgY29uZmlndXJlZFxuXHRcdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRcdGNvbnN0IGhhc0FwaUtleSA9IHByb3ZpZGVyc1twcm92aWRlclR5cGVdPy5hcGlLZXk7XG5cdFx0XHRpZiAoIWhhc0FwaUtleSAmJiBwcm92aWRlclR5cGUgIT09ICdvbGxhbWEnKSBjb250aW51ZTtcblxuXHRcdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMuZ2V0Q3VycmVudE1vZGVsKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRjb25zdCBkaXNwbGF5TmFtZSA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHRcdFx0Y29uc3QgaXNDdXJyZW50ID0gZGlzcGxheU5hbWUgPT09IGN1cnJlbnRQcm92aWRlck5hbWU7XG5cblx0XHRcdC8vIENyZWF0ZSBwcm92aWRlciBjb250YWluZXJcblx0XHRcdGNvbnN0IHByb3ZpZGVyQ29udGFpbmVyID0gZHJvcGRvd25NZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItY29udGFpbmVyJyB9KTtcblx0XHRcdFxuXHRcdFx0Ly8gTWFpbiBwcm92aWRlciBpdGVtXG5cdFx0XHRjb25zdCBwcm92aWRlckl0ZW0gPSBwcm92aWRlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWl0ZW0nIH0pO1xuXHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogOHB4O1xuXHRcdFx0XHRmb250LXNpemU6IDAuODVlbTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2U7XG5cdFx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIFByb3ZpZGVyIGljb24vZG90XG5cdFx0XHRjb25zdCBwcm92aWRlckRvdCA9IHByb3ZpZGVySXRlbS5jcmVhdGVTcGFuKCk7XG5cdFx0XHRwcm92aWRlckRvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHR3aWR0aDogOHB4O1xuXHRcdFx0XHRoZWlnaHQ6IDhweDtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiAke3RoaXMuZ2V0UHJvdmlkZXJDb2xvcihwcm92aWRlclR5cGUpfTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIFByb3ZpZGVyIG5hbWUgb25seSAobW9kZWxzIGFyZSBzaG93biBpbiBzdWJtZW51KVxuXHRcdFx0Y29uc3QgbmFtZVNwYW4gPSBwcm92aWRlckl0ZW0uY3JlYXRlU3Bhbih7IHRleHQ6IGRpc3BsYXlOYW1lIH0pO1xuXHRcdFx0bmFtZVNwYW4uc3R5bGUuZmxleCA9ICcxJztcblxuXHRcdFx0Ly8gRXhwYW5kIGFycm93IGZvciBtb2RlbHMgKG9ubHkgaWYgbW9kZWxzIGF2YWlsYWJsZSlcblx0XHRcdGxldCBleHBhbmRBcnJvdzogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0XHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRleHBhbmRBcnJvdyA9IHByb3ZpZGVySXRlbS5jcmVhdGVTcGFuKHsgdGV4dDogJ1x1MjVCNicgfSk7XG5cdFx0XHRcdGV4cGFuZEFycm93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjZlbTtcblx0XHRcdFx0XHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0YDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTWFyayBjdXJyZW50IHByb3ZpZGVyXG5cdFx0XHRpZiAoaXNDdXJyZW50KSB7XG5cdFx0XHRcdHByb3ZpZGVySXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0bmFtZVNwYW4uc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJztcblx0XHRcdH1cblxuXHRcdFx0Ly8gTW9kZWxzIHN1Ym1lbnVcblx0XHRcdGxldCBtb2RlbHNNZW51OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRcdFx0bGV0IGlzRXhwYW5kZWQgPSBmYWxzZTtcblxuXHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdG1vZGVsc01lbnUgPSBwcm92aWRlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVscy1zdWJtZW51JyB9KTtcblx0XHRcdFx0bW9kZWxzTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0XHRib3JkZXItbGVmdDogMnB4IHNvbGlkICR7dGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSl9O1xuXHRcdFx0XHRcdG1hcmdpbi1sZWZ0OiAxNnB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdC8vIFBvcHVsYXRlIG1vZGVsc1xuXHRcdFx0XHRmb3IgKGNvbnN0IG1vZGVsIG9mIG1vZGVscykge1xuXHRcdFx0XHRcdGNvbnN0IG1vZGVsSXRlbSA9IG1vZGVsc01lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tb2RlbC1pdGVtJyB9KTtcblx0XHRcdFx0XHRtb2RlbEl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRcdHBhZGRpbmc6IDZweCAxMnB4O1xuXHRcdFx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRcdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRcdFx0Z2FwOiA4cHg7XG5cdFx0XHRcdFx0YDtcblxuXHRcdFx0XHRcdC8vIE1vZGVsIGluZGljYXRvclxuXHRcdFx0XHRcdGNvbnN0IG1vZGVsRG90ID0gbW9kZWxJdGVtLmNyZWF0ZVNwYW4oKTtcblx0XHRcdFx0XHRtb2RlbERvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0d2lkdGg6IDRweDtcblx0XHRcdFx0XHRcdGhlaWdodDogNHB4O1xuXHRcdFx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0XHRcdFx0YmFja2dyb3VuZDogJHttb2RlbC52YWx1ZSA9PT0gY3VycmVudE1vZGVsID8gdGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSkgOiAndmFyKC0tdGV4dC1tdXRlZCknfTtcblx0XHRcdFx0XHRgO1xuXG5cdFx0XHRcdFx0Y29uc3QgbW9kZWxOYW1lID0gbW9kZWxJdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiBtb2RlbC5sYWJlbCB9KTtcblx0XHRcdFx0XHRpZiAobW9kZWwudmFsdWUgPT09IGN1cnJlbnRNb2RlbCkge1xuXHRcdFx0XHRcdFx0bW9kZWxOYW1lLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gTW9kZWwgY2xpY2sgaGFuZGxlclxuXHRcdFx0XHRcdG1vZGVsSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZSwgbW9kZWwudmFsdWUpO1xuXHRcdFx0XHRcdFx0Ly8gQ2xvc2UgZHJvcGRvd25cblx0XHRcdFx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0Ly8gTW9kZWwgaG92ZXIgZWZmZWN0XG5cdFx0XHRcdFx0bW9kZWxJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHRtb2RlbEl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3ZlciknO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdG1vZGVsSXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bW9kZWxJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIFByb3ZpZGVyIGNsaWNrIGhhbmRsZXJcblx0XHRcdHByb3ZpZGVySXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG5cdFx0XHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdC8vIFRvZ2dsZSBzdWJtZW51XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRpc0V4cGFuZGVkID0gIWlzRXhwYW5kZWQ7XG5cdFx0XHRcdFx0aWYgKG1vZGVsc01lbnUpIHtcblx0XHRcdFx0XHRcdG1vZGVsc01lbnUuc3R5bGUuZGlzcGxheSA9IGlzRXhwYW5kZWQgPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZXhwYW5kQXJyb3cpIHtcblx0XHRcdFx0XHRcdGV4cGFuZEFycm93LnN0eWxlLnRyYW5zZm9ybSA9IGlzRXhwYW5kZWQgPyAncm90YXRlKDkwZGVnKScgOiAncm90YXRlKDBkZWcpJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gU3dpdGNoIHByb3ZpZGVyIGRpcmVjdGx5IChmb3IgT2xsYW1hIG9yIHByb3ZpZGVycyB3aXRob3V0IG1vZGVscylcblx0XHRcdFx0XHRpZiAoIWlzQ3VycmVudCkge1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5zd2l0Y2hUb1Byb3ZpZGVyKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0XHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duKSB7XG5cdFx0XHRcdFx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24udXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gSG92ZXIgZWZmZWN0XG5cdFx0XHRwcm92aWRlckl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0XHRwcm92aWRlckl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3ZlciknO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0cHJvdmlkZXJJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGlmICghaXNDdXJyZW50ICYmICFpc0V4cGFuZGVkKSB7XG5cdFx0XHRcdFx0cHJvdmlkZXJJdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIGEgbWVzc2FnZSB3aXRoIGEgY2xlYW4gaWNvbiAocmVwbGFjZXMgZW1vamkpXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZUljb25NZXNzYWdlKGljb25OYW1lOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvblN2ZyA9IHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCAnMTRweCcpO1xuXHRcdC8vIFJldHVybiBhcyBIVE1MIHRoYXQgd2lsbCBiZSBpbnRlcnByZXRlZCBieSB0aGUgbWVzc2FnZSBkaXNwbGF5XG5cdFx0cmV0dXJuIGA8c3BhbiBzdHlsZT1cImRpc3BsYXk6IGlubGluZS1mbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDtcIj4ke2ljb25Tdmd9PHNwYW4+JHttZXNzYWdlfTwvc3Bhbj48L3NwYW4+YDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYW4gaW5saW5lIGljb24gZm9yIHVzZSBpbiBpbm5lckhUTUxcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSW5saW5lSWNvbihpY29uTmFtZTogc3RyaW5nLCBzaXplOiBzdHJpbmcgPSAnMTRweCcpOiBzdHJpbmcge1xuXHRcdHJldHVybiB0aGlzLmdldE9ic2lkaWFuSWNvbihpY29uTmFtZSwgc2l6ZSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IE9ic2lkaWFuLXN0eWxlIGljb24gU1ZHXG5cdCAqL1xuXHRwcml2YXRlIGdldE9ic2lkaWFuSWNvbihpY29uTmFtZTogc3RyaW5nLCBzaXplOiBzdHJpbmcgPSAnMTRweCcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGljb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J3phcCc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTMgMkwzIDE0SDEyTDExIDIyTDIxIDEwSDEyTDEzIDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQncmVmcmVzaC1jdyc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMyAxMkE5IDkgMCAwIDAgMjEgMTJBOSA5IDAgMCAwIDMgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIxIDEyTDE3IDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIxIDEyTDE3IDE2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnZWRpdCc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTEgNEg0QTIgMiAwIDAgMCAyIDZWMjBBMiAyIDAgMCAwIDQgMjJIMThBMiAyIDAgMCAwIDIwIDIwVjEzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xOC41IDIuNUEyLjEyIDIuMTIgMCAwIDEgMjEgNUwxMiAxNEw4IDE1TDkgMTFMMTguNSAyLjVaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnaGVscC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk05LjA5IDlBMyAzIDAgMCAxIDEyIDZBMyAzIDAgMCAxIDE1IDlDMTUgMTAuNSAxMiAxMSAxMiAxMVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTdcIiByPVwiMVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J2Jvb2stb3Blbic6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzSDhBNCA0IDAgMCAxIDEyIDdBNCA0IDAgMCAxIDE2IDNIMjJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIgM1YxOUEyIDIgMCAwIDAgNCAyMUg5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0yMiAzVjE5QTIgMiAwIDAgMSAyMCAyMUgxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTIgN1YyMVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J21vcmUtaG9yaXpvbnRhbCc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxOVwiIGN5PVwiMTJcIiByPVwiMVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCI1XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnZmlsZS10ZXh0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAySDZBMiAyIDAgMCAwIDQgNFYyMEEyIDIgMCAwIDAgNiAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWOEwxNCAyWlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTQgMlY4SDIwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNiAxM0g4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNiAxN0g4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMCA5SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCd4JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xOCA2TDYgMThcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTYgNkwxOCAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J2NoZWNrLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgMTJMMTEgMTRMMTYgOVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gtY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMTUgOUw5IDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk05IDlMMTUgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YFxuXHRcdH07XG5cdFx0XG5cdFx0cmV0dXJuIGljb25zW2ljb25OYW1lXSB8fCBpY29uc1snaGVscC1jaXJjbGUnXTsgLy8gRmFsbGJhY2sgdG8gaGVscC1jaXJjbGUgaWYgaWNvbiBub3QgZm91bmRcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBuYW1lczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnQW50aHJvcGljJyxcblx0XHRcdCdvcGVuYWknOiAnT3BlbkFJJyxcblx0XHRcdCdnb29nbGUnOiAnR29vZ2xlJyxcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hJyxcblx0XHRcdCdub25lJzogJ05vbmUnXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJUeXBlXSB8fCBwcm92aWRlclR5cGU7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGRpc3BsYXkgbmFtZSBmb3IgaGVhZGVyIChqdXN0IG1vZGVsIG5hbWUgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgcHJvdmlkZXIgbmFtZSlcblx0ICovXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJXaXRoTW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRcblx0XHRpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMuZ2V0Q3VycmVudE1vZGVsKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZXRNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSwgY3VycmVudE1vZGVsKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjb2xvciBmb3IgcHJvdmlkZXIgdHlwZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBVc2UgdGhlbWUtY29tcGF0aWJsZSBjb2xvcnMgaW5zdGVhZCBvZiBoYXJkY29kZWQgaGV4IHZhbHVlc1xuXHRcdGNvbnN0IGNvbG9yczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAndmFyKC0tY29sb3Itb3JhbmdlKScsXG5cdFx0XHQnb3BlbmFpJzogJ3ZhcigtLWNvbG9yLWdyZWVuKScsXG5cdFx0XHQnZ29vZ2xlJzogJ3ZhcigtLWNvbG9yLWJsdWUpJyxcblx0XHRcdCdvbGxhbWEnOiAndmFyKC0tY29sb3ItcHVycGxlKScsXG5cdFx0XHQnbm9uZSc6ICd2YXIoLS10ZXh0LW11dGVkKSdcblx0XHR9O1xuXHRcdHJldHVybiBjb2xvcnNbcHJvdmlkZXJUeXBlXSB8fCAndmFyKC0tdGV4dC1zdWNjZXNzKSc7XG5cdH1cblxuXHQvKipcblx0ICogU3dpdGNoIHRvIGEgZGlmZmVyZW50IHByb3ZpZGVyIGFuZCB1cGRhdGUgY29udmVyc2F0aW9uIGNvbnRleHRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgc3dpdGNoVG9Qcm92aWRlcihwcm92aWRlclR5cGU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBBZGQgYSBzeXN0ZW0gbWVzc2FnZSBhYm91dCBwcm92aWRlciBzd2l0Y2hpbmdcblx0XHRcdGNvbnN0IHN3aXRjaE1lc3NhZ2UgPSB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdyZWZyZXNoLWN3JywgYFN3aXRjaGVkIHRvICR7dGhpcy5nZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSl9YCk7XG5cdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3N5c3RlbScsIHN3aXRjaE1lc3NhZ2UpO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgdGhlIHBsYXRmb3JtIHNldHRpbmdzIHRvIHVzZSB0aGUgbmV3IHByb3ZpZGVyXG5cdFx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5wcmltYXJ5UHJvdmlkZXIgPSBwcm92aWRlclR5cGUgYXMgYW55O1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcblx0XHRcdC8vIFJlLWluaXRpYWxpemUgdGhlIHByb3ZpZGVyIG1hbmFnZXIgd2l0aCBuZXcgc2V0dGluZ3Ncblx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmVmcmVzaCBzdGF0dXMgaW5kaWNhdG9yc1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLnJlZnJlc2hQcm92aWRlclN0YXR1cygpLCAxMDApO1xuXHRcdFx0XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIEVycm9yIHN3aXRjaGluZyBwcm92aWRlciAtIGhhbmRsZWQgYnkgVUkgZmVlZGJhY2tcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgYEZhaWxlZCB0byBzd2l0Y2ggdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKX1gKSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIHRoZSBjb21tYW5kIGJ1dHRvbiBzaG91bGQgYmUgc2hvd24gYmFzZWQgb24gZmVhdHVyZSBhdmFpbGFiaWxpdHkgYW5kIHVzZXIgcHJlZmVyZW5jZVxuXHQgKi9cblx0cHJpdmF0ZSBzaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpOiBib29sZWFuIHtcblx0XHQvLyBDb21tYW5kIGJ1dHRvbiBpcyBnYXRlZCBiZWhpbmQgdGhlIGNvbW1hbmRzIGZlYXR1cmUgXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIGFsbCBTdXBlcm5vdmEtZ2F0ZWQgVUkgZWxlbWVudHMgd2hlbiBsaWNlbnNlIHN0YXR1cyBjaGFuZ2VzXG5cdCAqL1xuXHRyZWZyZXNoU3VwZXJub3ZhVUkoKTogdm9pZCB7XG5cdFx0dGhpcy5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdC8vIEZ1dHVyZSBTdXBlcm5vdmEgZmVhdHVyZXMgY2FuIGFkZCB0aGVpciByZWZyZXNoIGxvZ2ljIGhlcmVcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIHRoZSBjb21tYW5kIGJ1dHRvbiB2aXNpYmlsaXR5IHdoZW4gc2V0dGluZ3MgY2hhbmdlXG5cdCAqL1xuXHRyZWZyZXNoQ29tbWFuZEJ1dHRvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBpbnB1dCByb3cgbGF5b3V0IHdoZW4gY29tbWFuZCBidXR0b24gdmlzaWJpbGl0eSBjaGFuZ2VzXG5cdCAqL1xuXHRwcml2YXRlIHVwZGF0ZUlucHV0Um93TGF5b3V0KCk6IHZvaWQge1xuXHRcdC8vIE5vIG5lZWQgdG8gbWFudWFsbHkgYWRqdXN0IHRleHRhcmVhIHdpZHRoIC0gZmxleGJveCBoYW5kbGVzIGl0XG5cdFx0Ly8gVGhlIHRleHRhcmVhIGNvbnRhaW5lciBoYXMgZmxleDogMSwgc28gaXQgd2lsbCBleHBhbmQvY29udHJhY3QgYXV0b21hdGljYWxseVxuXHRcdC8vIHdoZW4gdGhlIGNvbW1hbmQgYnV0dG9uIGlzIHNob3duL2hpZGRlblxuXHR9XG5cbn0iLCAiLyoqXG4gKiBNdWx0aS1kb2N1bWVudCBjb250ZXh0IGhhbmRsZXIgZm9yIE5vdmFcbiAqIFBhcnNlcyBbW2RvY11dIGFuZCArW1tkb2NdXSBzeW50YXggZm9yIGFkZGl0aW9uYWwgY29udGV4dFxuICovXG5cbmltcG9ydCB7IEFwcCwgVEZpbGUsIENhY2hlZE1ldGFkYXRhIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvY3VtZW50UmVmZXJlbmNlIHtcbiAgICAvKiogVGhlIGZpbGUgYmVpbmcgcmVmZXJlbmNlZCAqL1xuICAgIGZpbGU6IFRGaWxlO1xuICAgIFxuICAgIC8qKiBXaGV0aGVyIHRoaXMgaXMgcGVyc2lzdGVudCBjb250ZXh0ICgrW1tkb2NdXSkgKi9cbiAgICBpc1BlcnNpc3RlbnQ6IGJvb2xlYW47XG4gICAgXG4gICAgLyoqIFRoZSByYXcgcmVmZXJlbmNlIHRleHQgKGUuZy4sIFwiW1tNeSBEb2N1bWVudF1dXCIpICovXG4gICAgcmF3UmVmZXJlbmNlOiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFNwZWNpZmljIHByb3BlcnR5IHRvIGV4dHJhY3QgKGUuZy4sIFwiW1tkb2MjcHJvcGVydHldXVwiKSAqL1xuICAgIHByb3BlcnR5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpRG9jQ29udGV4dCB7XG4gICAgLyoqIERvY3VtZW50cyBpbiBwZXJzaXN0ZW50IGNvbnRleHQgKi9cbiAgICBwZXJzaXN0ZW50RG9jczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICBcbiAgICAvKiogQ29tYmluZWQgY29udGV4dCBzdHJpbmcgKi9cbiAgICBjb250ZXh0U3RyaW5nOiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIEVzdGltYXRlZCB0b2tlbiBjb3VudCAqL1xuICAgIHRva2VuQ291bnQ6IG51bWJlcjtcbiAgICBcbiAgICAvKiogV2hldGhlciB3ZSdyZSBhcHByb2FjaGluZyB0b2tlbiBsaW1pdCAqL1xuICAgIGlzTmVhckxpbWl0OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgTXVsdGlEb2NDb250ZXh0SGFuZGxlciB7XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHBlcnNpc3RlbnRDb250ZXh0OiBNYXA8c3RyaW5nLCBEb2N1bWVudFJlZmVyZW5jZVtdPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IFRPS0VOX0xJTUlUID0gODAwMDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IFdBUk5JTkdfVEhSRVNIT0xEID0gMC44O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBtZXNzYWdlIGZvciBkb2N1bWVudCByZWZlcmVuY2VzXG4gICAgICovXG4gICAgcGFyc2VNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgY29udmVyc2F0aW9uRmlsZVBhdGg6IHN0cmluZyk6IHtcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgcmVmZXJlbmNlczogRG9jdW1lbnRSZWZlcmVuY2VbXTtcbiAgICB9IHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlczogRG9jdW1lbnRSZWZlcmVuY2VbXSA9IFtdO1xuICAgICAgICBsZXQgY2xlYW5lZE1lc3NhZ2UgPSBtZXNzYWdlO1xuXG4gICAgICAgIC8vIFBhdHRlcm4gdG8gbWF0Y2ggW1tkb2NdXSBhbmQgK1tbZG9jXV0gd2l0aCBvcHRpb25hbCBwcm9wZXJ0eVxuICAgICAgICAvLyBOb3RlOiBBbGwgZG9jdW1lbnQgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnQgZm9yIHNpbXBsaWZpZWQgVVhcbiAgICAgICAgY29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcbiAgICAgICAgICAgIGNvbnN0IHJhd1JlZmVyZW5jZSA9IG1hdGNoWzBdO1xuXG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCB0aGUgZmlsZVxuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZmluZEZpbGUoZG9jTmFtZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgaXNQZXJzaXN0ZW50OiB0cnVlLCAvLyBBbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnRcbiAgICAgICAgICAgICAgICAgICAgcmF3UmVmZXJlbmNlLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBmb3VuZCByZWZlcmVuY2VzIGZyb20gbWVzc2FnZVxuICAgICAgICBmb3IgKGNvbnN0IHJlZiBvZiByZWZlcmVuY2VzKSB7XG4gICAgICAgICAgICBjbGVhbmVkTWVzc2FnZSA9IGNsZWFuZWRNZXNzYWdlLnJlcGxhY2UocmVmLnJhd1JlZmVyZW5jZSwgJyAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENsZWFuIHVwIGV4Y2Vzc2l2ZSBzcGFjZXMgYnV0IHByZXNlcnZlIG5lY2Vzc2FyeSBzcGFjaW5nXG4gICAgICAgIGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZSgvXFxzezIsfS9nLCAnICcpLnRyaW0oKTtcblxuICAgICAgICAvLyBVcGRhdGUgcGVyc2lzdGVudCBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBjb25zdCBwZXJzaXN0ZW50UmVmcyA9IHJlZmVyZW5jZXMuZmlsdGVyKHJlZiA9PiByZWYuaXNQZXJzaXN0ZW50KTtcbiAgICAgICAgaWYgKHBlcnNpc3RlbnRSZWZzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoY29udmVyc2F0aW9uRmlsZVBhdGgpIHx8IFtdO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFBlcnNpc3RlbnQgPSBbLi4uZXhpc3RpbmddO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdGhhdCBhcmVuJ3QgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHBlcnNpc3RlbnRSZWZzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShleGlzdGluZyA9PiBleGlzdGluZy5maWxlLnBhdGggPT09IHJlZi5maWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGNvbnZlcnNhdGlvbkZpbGVQYXRoLCB1cGRhdGVkUGVyc2lzdGVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGNvbXBsZXRlIGNvbnRleHQgaW5jbHVkaW5nIHBlcnNpc3RlbnQgZG9jdW1lbnRzXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb250ZXh0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGN1cnJlbnRGaWxlOiBURmlsZSxcbiAgICAgICAgY29udmVyc2F0aW9uRGF0YT86IENvbnZlcnNhdGlvbkRhdGFcbiAgICApOiBQcm9taXNlPHtcbiAgICAgICAgY2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgY29udGV4dDogTXVsdGlEb2NDb250ZXh0O1xuICAgIH0+IHtcbiAgICAgICAgLy8gUGFyc2UgY3VycmVudCBtZXNzYWdlXG4gICAgICAgIGNvbnN0IHsgY2xlYW5lZE1lc3NhZ2UsIHJlZmVyZW5jZXMgfSA9IHRoaXMucGFyc2VNZXNzYWdlKG1lc3NhZ2UsIGN1cnJlbnRGaWxlLnBhdGgpO1xuXG4gICAgICAgIC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIHRoaXMgY29udmVyc2F0aW9uXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nUGVyc2lzdGVudCA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIG5ldyByZWZlcmVuY2VzIHRvIHBlcnNpc3RlbnQgY29udGV4dCAoYWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50KVxuICAgICAgICBpZiAocmVmZXJlbmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ1BlcnNpc3RlbnRdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHJlZmVyZW5jZXMgdGhhdCBhcmVuJ3QgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHRcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBlcnNpc3RlbnQucHVzaChyZWYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgdXBkYXRlZFBlcnNpc3RlbnQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZmluYWwgcGVyc2lzdGVudCBjb250ZXh0IChpbmNsdWRpbmcgbmV3bHkgYWRkZWQgZG9jcylcbiAgICAgICAgY29uc3QgcmF3UGVyc2lzdGVudERvY3MgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbHRlciBvdXQgYW55IHN0YWxlIGZpbGUgcmVmZXJlbmNlcyAoZmlsZXMgdGhhdCBubyBsb25nZXIgZXhpc3QpXG4gICAgICAgIGNvbnN0IGFsbFBlcnNpc3RlbnREb2NzID0gcmF3UGVyc2lzdGVudERvY3MuZmlsdGVyKGRvY1JlZiA9PiB7XG4gICAgICAgICAgICBpZiAoIWRvY1JlZj8uZmlsZSB8fCAhdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRvY1JlZi5maWxlLnBhdGgpKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3Zpbmcgc3RhbGUgZmlsZSByZWZlcmVuY2VcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgdGhlIHBlcnNpc3RlbnQgY29udGV4dCB0byByZW1vdmUgc3RhbGUgcmVmZXJlbmNlc1xuICAgICAgICBpZiAoYWxsUGVyc2lzdGVudERvY3MubGVuZ3RoICE9PSByYXdQZXJzaXN0ZW50RG9jcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChhbGxQZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgYWxsUGVyc2lzdGVudERvY3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShjdXJyZW50RmlsZS5wYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIGNvbnRleHQgc3RyaW5nIGZyb20gYWxsIGRvY3VtZW50c1xuICAgICAgICBjb25zdCBjb250ZXh0UGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBBTFdBWVMgaW5jbHVkZSBjdXJyZW50IGZpbGUgY29udGVudCBhbmQgbWV0YWRhdGEgZmlyc3QgKGltcGxpY2l0IGNvbnRleHQpXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlQ29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChjdXJyZW50RmlsZSwgdHJ1ZSwgMTAwKTtcbiAgICAgICAgaWYgKGN1cnJlbnRGaWxlQ29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dFBhcnRzLnB1c2goY3VycmVudEZpbGVDb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVGhlbiBhZGQgYWxsIHBlcnNpc3RlbnQgZG9jdW1lbnRzIHdpdGggdGhlaXIgbWV0YWRhdGFcbiAgICAgICAgZm9yIChjb25zdCBkb2NSZWYgb2YgYWxsUGVyc2lzdGVudERvY3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRQYXJ0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZG9jUmVmKTtcbiAgICAgICAgICAgIGlmIChjb250ZXh0UGFydCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGNvbnRleHRQYXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRleHRTdHJpbmcgPSBjb250ZXh0UGFydHMuam9pbignXFxuXFxuLS0tXFxuXFxuJyk7XG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5zKGNvbnRleHRTdHJpbmcpO1xuICAgICAgICBjb25zdCBpc05lYXJMaW1pdCA9IHRva2VuQ291bnQgPiAodGhpcy5UT0tFTl9MSU1JVCAqIHRoaXMuV0FSTklOR19USFJFU0hPTEQpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjbGVhbmVkTWVzc2FnZSxcbiAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICBwZXJzaXN0ZW50RG9jczogYWxsUGVyc2lzdGVudERvY3MsXG4gICAgICAgICAgICAgICAgY29udGV4dFN0cmluZyxcbiAgICAgICAgICAgICAgICB0b2tlbkNvdW50LFxuICAgICAgICAgICAgICAgIGlzTmVhckxpbWl0XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGZ1bGwgZG9jdW1lbnQgY29udGV4dCBpbmNsdWRpbmcgbWV0YWRhdGEvcHJvcGVydGllc1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlOiBURmlsZSwgaW5jbHVkZUNvbnRlbnQ6IGJvb2xlYW4gPSB0cnVlLCBtYXhMaW5lczogbnVtYmVyID0gNTApOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBjb250ZXh0UGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBkb2N1bWVudCBoZWFkZXJcbiAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGAjIyBEb2N1bWVudDogJHtmaWxlLmJhc2VuYW1lfWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgYW5kIGFkZCBtZXRhZGF0YS9wcm9wZXJ0aWVzIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIgJiYgT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCgnXFxuIyMjIFByb3BlcnRpZXMvTWV0YWRhdGE6Jyk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoY2FjaGUuZnJvbnRtYXR0ZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcm1hdCB0aGUgcHJvcGVydHkgdmFsdWUgKGhhbmRsZSBhcnJheXMsIG9iamVjdHMsIGV0Yy4pXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChgLSAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgY29udGVudCBpZiByZXF1ZXN0ZWRcbiAgICAgICAgICAgIGlmIChpbmNsdWRlQ29udGVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICAgICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGZyb250bWF0dGVyIGluIGNvbnRlbnQgZGlzcGxheSAoYmV0d2VlbiAtLS0gbWFya2VycylcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnRTdGFydEluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0YXJ0SW5kZXggPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50TGluZXMgPSBsaW5lcy5zbGljZShjb250ZW50U3RhcnRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZENvbnRlbnQgPSBjb250ZW50TGluZXMuc2xpY2UoMCwgbWF4TGluZXMpLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB3YXNUcnVuY2F0ZWQgPSBjb250ZW50TGluZXMubGVuZ3RoID4gbWF4TGluZXM7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCgnXFxuIyMjIENvbnRlbnQ6Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKHRydW5jYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAod2FzVHJ1bmNhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0UGFydHMucHVzaCgnXFxuWy4uLiB0cnVuY2F0ZWQgZm9yIGJyZXZpdHkgLi4uXScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gY29udGV4dFBhcnRzLmpvaW4oJ1xcbicpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHJlYWQgZnVsbCBjb250ZXh0IC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnRleHQgZm9yIGEgc3BlY2lmaWMgZG9jdW1lbnQgcmVmZXJlbmNlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZG9jUmVmOiBEb2N1bWVudFJlZmVyZW5jZSk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgeyBmaWxlLCBwcm9wZXJ0eSB9ID0gZG9jUmVmO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBmaWxlIHN0aWxsIGV4aXN0cyBpbiB0aGUgdmF1bHRcbiAgICAgICAgICAgIGlmICghZmlsZSB8fCAhdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGUucGF0aCkpIHtcbiAgICAgICAgICAgICAgICAvLyBGaWxlIG5vIGxvbmdlciBleGlzdHMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgc3BlY2lmaWMgcHJvcGVydHkgZnJvbSBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBjYWNoZS5mcm9udG1hdHRlcltwcm9wZXJ0eV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAjIyAke2ZpbGUuYmFzZW5hbWV9IC0gJHtwcm9wZXJ0eX1cXG4ke2NhY2hlLmZyb250bWF0dGVyW3Byb3BlcnR5XX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IGZ1bGwgZG9jdW1lbnQgY29udGV4dCB3aXRoIG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxlZCB0byByZWFkIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgZmlsZSBieSBuYW1lIG9yIHBhdGhcbiAgICAgKi9cbiAgICBwcml2YXRlIGZpbmRGaWxlKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG4gICAgICAgIC8vIEZpcnN0IHRyeSBleGFjdCBwYXRoIG1hdGNoXG4gICAgICAgIGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgLy8gVHJ5IHdpdGggLm1kIGV4dGVuc2lvblxuICAgICAgICAgICAgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoICsgJy5tZCcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAvLyBTZWFyY2ggYnkgYmFzZW5hbWVcbiAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICAgICAgZmlsZSA9IGZpbGVzLmZpbmQoZiA9PiBcbiAgICAgICAgICAgICAgICBmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuICAgICAgICAgICAgICAgIGYubmFtZSA9PT0gbmFtZU9yUGF0aCB8fFxuICAgICAgICAgICAgICAgIGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoKSB8fFxuICAgICAgICAgICAgICAgIGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG4gICAgICAgICAgICApIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgY2xlYXJQZXJzaXN0ZW50Q29udGV4dChmaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcGVyc2lzdGVudCBjb250ZXh0IGZvciBhIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGdldFBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiBEb2N1bWVudFJlZmVyZW5jZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGZpbGVQYXRoKSB8fCBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBzcGVjaWZpYyBkb2N1bWVudCBmcm9tIHBlcnNpc3RlbnQgY29udGV4dFxuICAgICAqL1xuICAgIHJlbW92ZVBlcnNpc3RlbnREb2MoZmlsZVBhdGg6IHN0cmluZywgZG9jVG9SZW1vdmU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQoZmlsZVBhdGgpIHx8IFtdO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZCA9IGN1cnJlbnQuZmlsdGVyKHJlZiA9PiByZWYuZmlsZS5wYXRoICE9PSBkb2NUb1JlbW92ZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoZmlsZVBhdGgsIGZpbHRlcmVkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzdGltYXRlIHRva2VuIGNvdW50IChyb3VnaCBhcHByb3hpbWF0aW9uKVxuICAgICAqL1xuICAgIHByaXZhdGUgZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgLy8gUm91Z2ggZXN0aW1hdGU6IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodGV4dC5sZW5ndGggLyA0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdmlzdWFsIGluZGljYXRvcnMgZm9yIGNvbnRleHQgc3RhdGVcbiAgICAgKi9cbiAgICBnZXRDb250ZXh0SW5kaWNhdG9ycyhjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiB7XG4gICAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgICAgY2xhc3NOYW1lOiBzdHJpbmc7XG4gICAgICAgIHRvb2x0aXA6IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgY29uc3QgZG9jQ291bnQgPSBjb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGNvbnRleHQudG9rZW5Db3VudCAvIHRoaXMuVE9LRU5fTElNSVQpICogMTAwKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjbGFzc05hbWUgPSAnbm92YS1jb250ZXh0LWluZGljYXRvcic7XG4gICAgICAgIGxldCB0b29sdGlwID0gYENvbnRleHQ6ICR7ZG9jQ291bnR9IGRvY3VtZW50JHtkb2NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSwgfiR7Y29udGV4dC50b2tlbkNvdW50fSB0b2tlbnNgO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnRleHQuaXNOZWFyTGltaXQpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSArPSAnIG5vdmEtY29udGV4dC13YXJuaW5nJztcbiAgICAgICAgICAgIHRvb2x0aXAgKz0gJyAoYXBwcm9hY2hpbmcgbGltaXQpJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdGV4dCA9IGAke2RvY0NvdW50fSBkb2NzICR7cGVyY2VudGFnZX0lYDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHRleHQsIGNsYXNzTmFtZSwgdG9vbHRpcCB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb250ZXh0IGZvciBkaXNwbGF5IGluIFVJXG4gICAgICovXG4gICAgZm9ybWF0Q29udGV4dEZvckRpc3BsYXkoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBpdGVtczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBwZXJzaXN0ZW50IGRvY3VtZW50c1xuICAgICAgICBmb3IgKGNvbnN0IGRvYyBvZiBjb250ZXh0LnBlcnNpc3RlbnREb2NzKSB7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGAke2RvYy5maWxlLmJhc2VuYW1lfSR7ZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyd9YCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9XG59IiwgIi8qKlxuICogQ2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnMgZm9yIGFsbCBBSSBwcm92aWRlcnNcbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIE1vZGVsRGVmaW5pdGlvbiB7XG5cdHZhbHVlOiBzdHJpbmc7XG5cdGxhYmVsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZWxDb25maWcge1xuXHRnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlOiBzdHJpbmcsIHNldHRpbmdzPzogYW55KTogTW9kZWxEZWZpbml0aW9uW107XG59XG5cbi8qKlxuICogR2V0IGF2YWlsYWJsZSBtb2RlbHMgZm9yIGEgcHJvdmlkZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGU6IHN0cmluZywgc2V0dGluZ3M/OiBhbnkpOiBNb2RlbERlZmluaXRpb25bXSB7XG5cdHN3aXRjaCAocHJvdmlkZXJUeXBlKSB7XG5cdFx0Y2FzZSAnY2xhdWRlJzpcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtb3B1cy00LTIwMjUwNTE0JywgbGFiZWw6ICdDbGF1ZGUgT3B1cyA0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0JywgbGFiZWw6ICdDbGF1ZGUgU29ubmV0IDQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy03LXNvbm5ldC1sYXRlc3QnLCBsYWJlbDogJ0NsYXVkZSAzLjcgU29ubmV0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNS1zb25uZXQtbGF0ZXN0JywgbGFiZWw6ICdDbGF1ZGUgMy41IFNvbm5ldCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJywgbGFiZWw6ICdDbGF1ZGUgMy41IFNvbm5ldCAoT2N0IDIyKScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0JywgbGFiZWw6ICdDbGF1ZGUgMy41IEhhaWt1JyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ29wZW5haSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTQuMS0yMDI1LTA0LTE0JywgbGFiZWw6ICdHUFQtNC4xJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnLCBsYWJlbDogJ0dQVC00LjEgTWluaScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00LjEtbmFuby0yMDI1LTA0LTE0JywgbGFiZWw6ICdHUFQtNC4xIE5hbm8nIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNG8nLCBsYWJlbDogJ0dQVC00bycgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00by1taW5pJywgbGFiZWw6ICdHUFQtNG8gTWluaScgfVxuXHRcdFx0XTtcblx0XHRjYXNlICdnb29nbGUnOlxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjUtZmxhc2gtcHJldmlldy0wNC0xNycsIGxhYmVsOiAnR2VtaW5pIDIuNSBGbGFzaCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjUtcHJvLXByZXZpZXctMDMtMjUnLCBsYWJlbDogJ0dlbWluaSAyLjUgUHJvJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuMC1mbGFzaCcsIGxhYmVsOiAnR2VtaW5pIDIuMCBGbGFzaCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjAtZmxhc2gtbGl0ZScsIGxhYmVsOiAnR2VtaW5pIDIuMCBGbGFzaC1MaXRlJyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ29sbGFtYSc6XG5cdFx0XHQvLyBSZXR1cm4gdGhlIGNvbmZpZ3VyZWQgbW9kZWwgZnJvbSBzZXR0aW5nc1xuXHRcdFx0Y29uc3Qgb2xsYW1hTW9kZWwgPSBzZXR0aW5ncz8uYWlQcm92aWRlcnM/Lm9sbGFtYT8ubW9kZWw7XG5cdFx0XHRpZiAob2xsYW1hTW9kZWwgJiYgb2xsYW1hTW9kZWwudHJpbSgpKSB7XG5cdFx0XHRcdHJldHVybiBbeyB2YWx1ZTogb2xsYW1hTW9kZWwsIGxhYmVsOiBvbGxhbWFNb2RlbCB9XTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBbXTtcblx0XHRkZWZhdWx0OlxuXHRcdFx0cmV0dXJuIFtdO1xuXHR9XG59IiwgImltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3dpa2lsaW5rLXN1Z2dlc3QnO1xuaW1wb3J0IHsgQ29tbWFuZFN5c3RlbSB9IGZyb20gJy4vY29tbWFuZC1zeXN0ZW0nO1xuaW1wb3J0IHsgQ29udGV4dE1hbmFnZXIgfSBmcm9tICcuL2NvbnRleHQtbWFuYWdlcic7XG5pbXBvcnQgeyBTZWN0aW9uUGlja2VyIH0gZnJvbSAnLi9zZWN0aW9uLXBpY2tlcic7XG5cbi8qKlxuICogSGFuZGxlcyB0ZXh0YXJlYSBpbnB1dCwgYXV0by1ncm93LCBzZW5kIGJ1dHRvbiwgYW5kIGlucHV0IGV2ZW50c1xuICovXG5leHBvcnQgY2xhc3MgSW5wdXRIYW5kbGVyIHtcblx0cHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0ZXh0QXJlYSE6IFRleHRBcmVhQ29tcG9uZW50O1xuXHRwcml2YXRlIHNlbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgYXV0b0dyb3dUZXh0YXJlYSE6ICgpID0+IHZvaWQ7XG5cdHByaXZhdGUgd2lraWxpbmtBdXRvY29tcGxldGUhOiBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGU7XG5cdHByaXZhdGUgY29tbWFuZFN5c3RlbSE6IENvbW1hbmRTeXN0ZW07XG5cdHByaXZhdGUgY29udGV4dE1hbmFnZXI6IENvbnRleHRNYW5hZ2VyO1xuXHRwcml2YXRlIHNlY3Rpb25QaWNrZXIhOiBTZWN0aW9uUGlja2VyO1xuXHRwcml2YXRlIGlucHV0Um93ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEZPQ1VTX0RFTEFZX01TID0gMTUwO1xuXG5cdC8vIEV2ZW50IGNsZWFudXAgdHJhY2tpbmdcblx0cHJpdmF0ZSBldmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwbHVnaW46IE5vdmFQbHVnaW4sIFxuXHRcdGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIFxuXHRcdGNvbnRleHRNYW5hZ2VyOiBDb250ZXh0TWFuYWdlclxuXHQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyID0gY29udGV4dE1hbmFnZXI7XG5cdH1cblxuXHRzZXRDb21tYW5kU3lzdGVtKGNvbW1hbmRTeXN0ZW06IENvbW1hbmRTeXN0ZW0pOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0gPSBjb21tYW5kU3lzdGVtO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB0aGUgY29tbWFuZCBidXR0b24gQkVGT1JFIHRoZSBzZW5kIGJ1dHRvbiB0byBnZXQgcHJvcGVyIG9yZGVyXG5cdFx0Ly8gUmVtb3ZlIHNlbmQgYnV0dG9uIHRlbXBvcmFyaWx5XG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbkVsID0gdGhpcy5zZW5kQnV0dG9uLmJ1dHRvbkVsO1xuXHRcdHNlbmRCdXR0b25FbC5yZW1vdmUoKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29tbWFuZCBidXR0b25cblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0uY3JlYXRlQ29tbWFuZEJ1dHRvbih0aGlzLmlucHV0Um93KTtcblx0XHRcblx0XHQvLyBSZS1hZGQgc2VuZCBidXR0b24gKHdpbGwgYmUgbGFzdCBpbiBET00gb3JkZXIpXG5cdFx0dGhpcy5pbnB1dFJvdy5hcHBlbmRDaGlsZChzZW5kQnV0dG9uRWwpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMuY29tbWFuZFN5c3RlbS5jcmVhdGVDb21tYW5kUGlja2VySW5Db250YWluZXIodGhpcy5pbnB1dFJvdyk7XG5cdH1cblxuXHRnZXRUZXh0QXJlYSgpOiBUZXh0QXJlYUNvbXBvbmVudCB7XG5cdFx0cmV0dXJuIHRoaXMudGV4dEFyZWE7XG5cdH1cblxuXHRjcmVhdGVJbnB1dEludGVyZmFjZShjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdHRoaXMuY29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0YDtcblxuXHRcdHRoaXMuaW5wdXRSb3cgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWlucHV0LXJvdycgfSk7XG5cdFx0dGhpcy5pbnB1dFJvdy5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRgO1xuXG5cdFx0Ly8gVGV4dGFyZWEgY29udGFpbmVyXG5cdFx0Y29uc3QgdGV4dEFyZWFDb250YWluZXIgPSB0aGlzLmlucHV0Um93LmNyZWF0ZURpdigpO1xuXHRcdHRleHRBcmVhQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZmxleDogMTsgcG9zaXRpb246IHJlbGF0aXZlOyc7XG5cblx0XHQvLyBDcmVhdGUgdGV4dGFyZWFcblx0XHR0aGlzLnRleHRBcmVhID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHRleHRBcmVhQ29udGFpbmVyKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFBsYWNlaG9sZGVyKCdBc2sgTm92YSBhbnl0aGluZy4uLiAoU2hpZnQrRW50ZXIgZm9yIG5ldyBsaW5lKScpO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWluLWhlaWdodDogODBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0cmVzaXplOiBub25lO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKSB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LWludGVyZmFjZSk7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTtcblx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0XHR3aWR0aDogMTAwJTtcblx0XHRcdGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG5cdFx0YDtcblxuXHRcdC8vIEF1dG8tZ3JvdyBmdW5jdGlvbmFsaXR5XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhID0gKCkgPT4ge1xuXHRcdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0XHR0ZXh0YXJlYS5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG5cdFx0XHR0ZXh0YXJlYS5zdHlsZS5oZWlnaHQgPSBNYXRoLm1pbih0ZXh0YXJlYS5zY3JvbGxIZWlnaHQsIDIwMCkgKyAncHgnO1xuXHRcdH07XG5cblx0XHQvLyBBZGQgaW5wdXQgZXZlbnQgbGlzdGVuZXIgZm9yIGF1dG8tZ3Jvd1xuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdpbnB1dCcsIHRoaXMuYXV0b0dyb3dUZXh0YXJlYSk7XG5cblx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBvbiBpbml0aWFsIGxvYWRcblx0XHRzZXRUaW1lb3V0KHRoaXMuYXV0b0dyb3dUZXh0YXJlYSwgMCk7XG5cblx0XHQvLyBJbml0aWFsaXplIHdpa2lsaW5rIGF1dG9jb21wbGV0ZSB3aXRoIGlucHV0Um93IGZvciBjb25zaXN0ZW50IHdpZHRoXG5cdFx0dGhpcy53aWtpbGlua0F1dG9jb21wbGV0ZSA9IG5ldyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUodGhpcy5wbHVnaW4uYXBwLCB0aGlzLnRleHRBcmVhLmlucHV0RWwsIHRoaXMuaW5wdXRSb3cpO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSBzZWN0aW9uIHBpY2tlciB3aXRoIGlucHV0Um93IGZvciBjb25zaXN0ZW50IGFsaWdubWVudFxuXHRcdHRoaXMuc2VjdGlvblBpY2tlciA9IG5ldyBTZWN0aW9uUGlja2VyKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUsIHRoaXMuaW5wdXRSb3cpO1xuXHRcdHRoaXMuc2V0dXBTZWN0aW9uUGlja2VyQ2FsbGJhY2tzKCk7XG5cblx0XHQvLyBBZGQgZGVib3VuY2VkIGNvbnRleHQgcHJldmlld1xuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdpbnB1dCcsICgpID0+IHtcblx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIudXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKSk7XG5cdFx0fSk7XG5cblx0XHQvLyBDb21tYW5kIGJ1dHRvbiB3aWxsIGJlIGNyZWF0ZWQgbGF0ZXIgd2hlbiBDb21tYW5kU3lzdGVtIGlzIHNldFxuXG5cdFx0Ly8gU2VuZCBidXR0b25cblx0XHR0aGlzLnNlbmRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHRoaXMuaW5wdXRSb3cpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRJY29uKCdzZW5kJyk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLnNldFRvb2x0aXAoJ1NlbmQgbWVzc2FnZScpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuaGFuZGxlU2VuZCgpKTtcblx0XHR0aGlzLnNlbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1pbi13aWR0aDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0aGVpZ2h0OiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0cGFkZGluZzogMDtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7XG5cdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0YDtcblxuXHRcdC8vIEVudGVyIGtleSBoYW5kbGluZyBhbmQgY29tbWFuZC9zZWN0aW9uIHBpY2tlclxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdrZXlkb3duJywgKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0Y29uc3Qga2V5RXZlbnQgPSBldmVudCBhcyBLZXlib2FyZEV2ZW50O1xuXHRcdFx0Ly8gRmlyc3QgY2hlY2sgaWYgc2VjdGlvbiBwaWNrZXIgaGFuZGxlcyB0aGUga2V5XG5cdFx0XHRpZiAodGhpcy5zZWN0aW9uUGlja2VyLmhhbmRsZUtleURvd24oa2V5RXZlbnQpKSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGtleUV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAha2V5RXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0KHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpIHx8IGZhbHNlKSB8fCB0aGlzLmhhbmRsZVNlbmQoKTtcblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0/LmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHRcdHRoaXMuc2VjdGlvblBpY2tlci5oaWRlKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGtleUV2ZW50LmtleSA9PT0gJ0Fycm93VXAnIHx8IGtleUV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlck5hdmlnYXRpb24oa2V5RXZlbnQua2V5KSkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnVGFiJykge1xuXHRcdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtPy5oYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXlFdmVudC5rZXkpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSW5wdXQgY2hhbmdlIGhhbmRsaW5nIGZvciBjb21tYW5kIHBpY2tlciBhbmQgc2VjdGlvbiBwaWNrZXJcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAnaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtKSB7XG5cdFx0XHRcdHRoaXMuY29tbWFuZFN5c3RlbS5oYW5kbGVJbnB1dENoYW5nZSgpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5oYW5kbGVTZWN0aW9uUGlja2VySW5wdXQoKTtcblx0XHR9KTtcblx0fVxuXG5cdGZvY3VzKCk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMudGV4dEFyZWE/LmlucHV0RWwpIHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9XG5cdFx0fSwgSW5wdXRIYW5kbGVyLkZPQ1VTX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlU2VuZCgpOiB2b2lkIHtcblx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHJldHVybjtcblxuXHRcdC8vIENsZWFyIGlucHV0XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSgnJyk7XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5oaWRlQ29udGV4dFByZXZpZXcoKTtcblxuXHRcdC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGNhbGwgYSBjYWxsYmFjayBvciBlbWl0IGFuIGV2ZW50XG5cdFx0Ly8gRm9yIG5vdywgd2UnbGwgYXNzdW1lIHRoZSBwYXJlbnQgaGFuZGxlcyB0aGUgYWN0dWFsIHNlbmRpbmdcblx0XHR0aGlzLm9uU2VuZE1lc3NhZ2U/LihtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgb25TZW5kTWVzc2FnZT86IChtZXNzYWdlOiBzdHJpbmcpID0+IHZvaWQ7XG5cblx0c2V0T25TZW5kTWVzc2FnZShjYWxsYmFjazogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZCk6IHZvaWQge1xuXHRcdHRoaXMub25TZW5kTWVzc2FnZSA9IGNhbGxiYWNrO1xuXHR9XG5cblx0Z2V0VmFsdWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHR9XG5cblx0c2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodmFsdWUpO1xuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpO1xuXHR9XG5cblx0aW5zZXJ0VGV4dCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0Y29uc3Qgc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDtcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XG5cblx0XHRjb25zdCBuZXdWYWx1ZSA9IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBzdGFydCkgKyB0ZXh0ICsgY3VycmVudFZhbHVlLnNsaWNlKGVuZCk7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShuZXdWYWx1ZSk7XG5cblx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYWZ0ZXIgaW5zZXJ0ZWQgdGV4dFxuXHRcdGNvbnN0IG5ld1Bvc2l0aW9uID0gc3RhcnQgKyB0ZXh0Lmxlbmd0aDtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKG5ld1Bvc2l0aW9uLCBuZXdQb3NpdGlvbik7XG5cdFx0XHR0ZXh0YXJlYS5mb2N1cygpO1xuXHRcdH0sIDApO1xuXG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdH1cblxuXHRpbnNlcnRUZXh0V2l0aEN1cnNvcihiZWZvcmVDdXJzb3I6IHN0cmluZywgYWZ0ZXJDdXJzb3I6IHN0cmluZyA9ICcnKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFZhbHVlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdGNvbnN0IHRleHRhcmVhID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsO1xuXHRcdGNvbnN0IHN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7XG5cdFx0Y29uc3QgZW5kID0gdGV4dGFyZWEuc2VsZWN0aW9uRW5kO1xuXG5cdFx0Y29uc3QgbmV3VmFsdWUgPSBjdXJyZW50VmFsdWUuc2xpY2UoMCwgc3RhcnQpICsgYmVmb3JlQ3Vyc29yICsgYWZ0ZXJDdXJzb3IgKyBjdXJyZW50VmFsdWUuc2xpY2UoZW5kKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBiZXR3ZWVuIGJlZm9yZSBhbmQgYWZ0ZXIgdGV4dFxuXHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gc3RhcnQgKyBiZWZvcmVDdXJzb3IubGVuZ3RoO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yUG9zaXRpb24sIGN1cnNvclBvc2l0aW9uKTtcblx0XHRcdHRleHRhcmVhLmZvY3VzKCk7XG5cdFx0fSwgMCk7XG5cblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkRXZlbnRMaXN0ZW5lcihlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0dGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblxuXHQvKipcblx0ICogU2V0dXAgc2VjdGlvbiBwaWNrZXIgY2FsbGJhY2tzXG5cdCAqL1xuXHRwcml2YXRlIHNldHVwU2VjdGlvblBpY2tlckNhbGxiYWNrcygpOiB2b2lkIHtcblx0XHR0aGlzLnNlY3Rpb25QaWNrZXIub25TZWxlY3QoKHBhdGg6IHN0cmluZykgPT4ge1xuXHRcdFx0dGhpcy5oYW5kbGVTZWN0aW9uU2VsZWN0aW9uKHBhdGgpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zZWN0aW9uUGlja2VyLm9uQ2FuY2VsKCgpID0+IHtcblx0XHRcdC8vIEZvY3VzIGJhY2sgdG8gdGV4dCBhcmVhXG5cdFx0XHR0aGlzLmZvY3VzKCk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHNlY3Rpb24gcGlja2VyIGlucHV0IGNoYW5nZXNcblx0ICovXG5cdHByaXZhdGUgaGFuZGxlU2VjdGlvblBpY2tlcklucHV0KCk6IHZvaWQge1xuXHRcdGNvbnN0IGlucHV0ID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZWxlY3Rpb25TdGFydDtcblx0XHRcblx0XHQvLyBGaW5kIGlmIGN1cnNvciBpcyBhZnRlciBhIFwiL1wiIHRyaWdnZXJcblx0XHRjb25zdCBwYXRoTWF0Y2ggPSB0aGlzLmZpbmRQYXRoVHJpZ2dlcihpbnB1dCwgY3Vyc29yUG9zKTtcblx0XHRcblx0XHRpZiAocGF0aE1hdGNoKSB7XG5cdFx0XHQvLyBTaG93IHNlY3Rpb24gcGlja2VyIHdpdGggZmlsdGVyIHRleHRcblx0XHRcdHRoaXMuc2VjdGlvblBpY2tlci5zaG93KHBhdGhNYXRjaC5maWx0ZXJUZXh0KS5jYXRjaChjb25zb2xlLmVycm9yKTtcblx0XHRcdGlmIChwYXRoTWF0Y2guZmlsdGVyVGV4dCkge1xuXHRcdFx0XHR0aGlzLnNlY3Rpb25QaWNrZXIudXBkYXRlRmlsdGVyKHBhdGhNYXRjaC5maWx0ZXJUZXh0KTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gSGlkZSBzZWN0aW9uIHBpY2tlciBpZiBub3QgaW4gcGF0aCBtb2RlXG5cdFx0XHR0aGlzLnNlY3Rpb25QaWNrZXIuaGlkZSgpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBGaW5kIHBhdGggdHJpZ2dlciAoLykgaW4gaW5wdXQgcmVsYXRpdmUgdG8gY3Vyc29yIHBvc2l0aW9uXG5cdCAqL1xuXHRwcml2YXRlIGZpbmRQYXRoVHJpZ2dlcihpbnB1dDogc3RyaW5nLCBjdXJzb3JQb3M6IG51bWJlcik6IHsgc3RhcnQ6IG51bWJlcjsgZmlsdGVyVGV4dDogc3RyaW5nIH0gfCBudWxsIHtcblx0XHQvLyBMb29rIGZvciBcIi9cIiBwYXR0ZXJuIGJlZm9yZSBjdXJzb3IsIHNpbWlsYXIgdG8gd2lraWxpbmsgZGV0ZWN0aW9uXG5cdFx0Y29uc3QgYmVmb3JlQ3Vyc29yID0gaW5wdXQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG5cdFx0Y29uc3QgcGF0aE1hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC8oPzpefFxccylcXC8oW15cXC9cXHNdKikkLyk7XG5cdFx0XG5cdFx0aWYgKHBhdGhNYXRjaCkge1xuXHRcdFx0Y29uc3QgZnVsbE1hdGNoID0gcGF0aE1hdGNoWzBdO1xuXHRcdFx0Y29uc3QgZmlsdGVyVGV4dCA9IHBhdGhNYXRjaFsxXSB8fCAnJztcblx0XHRcdGNvbnN0IHN0YXJ0ID0gY3Vyc29yUG9zIC0gZnVsbE1hdGNoLmxlbmd0aCArIChmdWxsTWF0Y2guc3RhcnRzV2l0aCgnICcpID8gMSA6IDApOyAvLyBBZGp1c3QgZm9yIHdoaXRlc3BhY2Vcblx0XHRcdFxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3RhcnQ6IHN0YXJ0LFxuXHRcdFx0XHRmaWx0ZXJUZXh0OiBmaWx0ZXJUZXh0XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgc2VjdGlvbiBzZWxlY3Rpb24gZnJvbSBwaWNrZXJcblx0ICovXG5cdHByaXZhdGUgaGFuZGxlU2VjdGlvblNlbGVjdGlvbihwYXRoOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBpbnB1dCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQ7XG5cdFx0XG5cdFx0Ly8gRmluZCB0aGUgXCIvXCIgdHJpZ2dlciB0byByZXBsYWNlXG5cdFx0Y29uc3QgcGF0aE1hdGNoID0gdGhpcy5maW5kUGF0aFRyaWdnZXIoaW5wdXQsIGN1cnNvclBvcyk7XG5cdFx0XG5cdFx0aWYgKHBhdGhNYXRjaCkge1xuXHRcdFx0Ly8gUmVwbGFjZSBcIi9cIiBhbmQgZmlsdGVyIHRleHQgd2l0aCBzZWxlY3RlZCBwYXRoXG5cdFx0XHRjb25zdCBiZWZvcmVTbGFzaCA9IGlucHV0LnNsaWNlKDAsIHBhdGhNYXRjaC5zdGFydCk7XG5cdFx0XHRjb25zdCBhZnRlckN1cnNvciA9IGlucHV0LnNsaWNlKGN1cnNvclBvcyk7XG5cdFx0XHRjb25zdCBuZXdWYWx1ZSA9IGJlZm9yZVNsYXNoICsgcGF0aCArIGFmdGVyQ3Vyc29yO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGFmdGVyIHRoZSBpbnNlcnRlZCBwYXRoXG5cdFx0XHRjb25zdCBuZXdDdXJzb3JQb3MgPSBwYXRoTWF0Y2guc3RhcnQgKyBwYXRoLmxlbmd0aDtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuc2V0U2VsZWN0aW9uUmFuZ2UobmV3Q3Vyc29yUG9zLCBuZXdDdXJzb3JQb3MpO1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdH0sIDApO1xuXHRcdFx0XG5cdFx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0XHR9XG5cdH1cblxuXHRyZWZyZXNoQ29tbWFuZEJ1dHRvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0udXBkYXRlQ29tbWFuZEJ1dHRvblZpc2liaWxpdHkoKTtcblx0XHR9XG5cdH1cblxuXHRjbGVhbnVwKCk6IHZvaWQge1xuXHRcdC8vIENsZWFuIHVwIHdpa2lsaW5rIGF1dG9jb21wbGV0ZVxuXHRcdGlmICh0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlKSB7XG5cdFx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlLmRlc3Ryb3koKTtcblx0XHR9XG5cblx0XHQvLyBDbGVhbiB1cCBzZWN0aW9uIHBpY2tlclxuXHRcdGlmICh0aGlzLnNlY3Rpb25QaWNrZXIpIHtcblx0XHRcdHRoaXMuc2VjdGlvblBpY2tlci5jbGVhbnVwKCk7XG5cdFx0fVxuXG5cdFx0Ly8gQ2xlYW4gdXAgZXZlbnQgbGlzdGVuZXJzXG5cdFx0dGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pID0+IHtcblx0XHRcdGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0fSk7XG5cdFx0dGhpcy5ldmVudExpc3RlbmVycyA9IFtdO1xuXHR9XG59IiwgIi8qKlxuICogQ3VzdG9tIHdpa2lsaW5rIGF1dG9jb21wbGV0ZSBmb3IgTm92YSB0ZXh0YXJlYVxuICogUHJvdmlkZXMgW1tkb2N1bWVudF1dIHN1Z2dlc3Rpb25zIHdoZW4gdHlwaW5nIGluIE5vdmEncyB0ZXh0YXJlYVxuICovXG5cbmltcG9ydCB7IFRGaWxlLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2lraWxpbmtTdWdnZXN0aW9uIHtcbiAgICBmaWxlOiBURmlsZTtcbiAgICBkaXNwbGF5VGV4dDogc3RyaW5nO1xuICAgIHNjb3JlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUge1xuICAgIHByaXZhdGUgYXBwOiBBcHA7XG4gICAgcHJpdmF0ZSB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9uUG9wdXA6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9uczogV2lraWxpbmtTdWdnZXN0aW9uW10gPSBbXTtcbiAgICBwcml2YXRlIHNlbGVjdGVkSW5kZXg6IG51bWJlciA9IC0xO1xuICAgIHByaXZhdGUgaXNWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjdXJyZW50UXVlcnk6IHN0cmluZyA9ICcnO1xuICAgIHByaXZhdGUgY3VycmVudFRyaWdnZXJQb3M6IG51bWJlciA9IC0xO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRleHRBcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50LCBjb250YWluZXI/OiBIVE1MRWxlbWVudCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lciB8fCB0ZXh0QXJlYS5wYXJlbnRFbGVtZW50ITtcbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5oYW5kbGVJbnB1dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlkb3duLmJpbmQodGhpcykpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xvc2Ugb24gZm9jdXMgbG9zc1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBEZWxheSB0byBhbGxvdyBzZWxlY3Rpb24gY2xpY2tzXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCksIDE1MCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIGNsaWNrIG91dHNpZGVcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwICYmICF0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSAmJiBlLnRhcmdldCAhPT0gdGhpcy50ZXh0QXJlYSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlSW5wdXQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHRBcmVhLnZhbHVlO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICBcbiAgICAgICAgLy8gTG9vayBmb3IgW1sgcGF0dGVybiBiZWZvcmUgY3Vyc29yXG4gICAgICAgIGNvbnN0IGJlZm9yZUN1cnNvciA9IHRleHQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmtNYXRjaCA9IGJlZm9yZUN1cnNvci5tYXRjaCgvKFxcKyk/XFxbXFxbKFteXFxdXSo/KSQvKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5rTWF0Y2gpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFF1ZXJ5ID0gbGlua01hdGNoWzJdIHx8ICcnO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VHJpZ2dlclBvcyA9IGN1cnNvclBvcyAtIGxpbmtNYXRjaFswXS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLnNob3dTdWdnZXN0aW9ucygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlS2V5ZG93bihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5pc1Zpc2libGUpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWluKHRoaXMuc2VsZWN0ZWRJbmRleCArIDEsIHRoaXMuc3VnZ2VzdGlvbnMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBNYXRoLm1heCh0aGlzLnNlbGVjdGVkSW5kZXggLSAxLCAtMSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ0VudGVyJzpcbiAgICAgICAgICAgIGNhc2UgJ1RhYic6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKHRoaXMuc3VnZ2VzdGlvbnNbdGhpcy5zZWxlY3RlZEluZGV4XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnRXNjYXBlJzpcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1N1Z2dlc3Rpb25zKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zID0gdGhpcy5nZXRTdWdnZXN0aW9ucyh0aGlzLmN1cnJlbnRRdWVyeSk7XG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5zdWdnZXN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVN1Z2dlc3Rpb25zKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlU3VnZ2VzdGlvblBvcHVwKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgdGhpcy5wb3NpdGlvblBvcHVwKCk7XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoaWRlU3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25Qb3B1cCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVN1Z2dlc3Rpb25Qb3B1cCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuY2xhc3NOYW1lID0gJ25vdmEtd2lraWxpbmstc3VnZ2VzdGlvbnMnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgYm90dG9tOiAxMDAlO1xuICAgICAgICAgICAgbGVmdDogMDtcbiAgICAgICAgICAgIHJpZ2h0OiAwO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICAgICAgICAgIG1heC1oZWlnaHQ6IDIwMHB4O1xuICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgICAgICAgIHotaW5kZXg6IDEwMDA7XG4gICAgICAgICAgICBkaXNwbGF5OiBub25lO1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICAgICAgICBgO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5zZXJ0IGluIHRoZSBwcm92aWRlZCBjb250YWluZXIgZm9yIGNvbnNpc3RlbnQgd2lkdGhcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5zdWdnZXN0aW9uUG9wdXApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyU3VnZ2VzdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5zdWdnZXN0aW9uUG9wdXApIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5mb3JFYWNoKChzdWdnZXN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnbm92YS1zdWdnZXN0aW9uLWl0ZW0nO1xuICAgICAgICAgICAgaXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxMnB4O1xuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcbiAgICAgICAgICAgIGA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE5hbWUgKHN0YW5kYXJkaXplZCB0byBtYXRjaCBjb21tYW5kIHBpY2tlcilcbiAgICAgICAgICAgIGNvbnN0IG5hbWVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgbmFtZUVsLmNsYXNzTmFtZSA9ICdub3ZhLXN1Z2dlc3Rpb24tbmFtZSc7XG4gICAgICAgICAgICBuYW1lRWwudGV4dENvbnRlbnQgPSBzdWdnZXN0aW9uLmZpbGUuYmFzZW5hbWU7XG4gICAgICAgICAgICBuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQobmFtZUVsKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGVzY3JpcHRpb24gKHN0YW5kYXJkaXplZClcbiAgICAgICAgICAgIGNvbnN0IGRlc2NFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZGVzY0VsLmNsYXNzTmFtZSA9ICdub3ZhLXN1Z2dlc3Rpb24tZGVzYyc7XG4gICAgICAgICAgICBkZXNjRWwudGV4dENvbnRlbnQgPSBgTGluayB0byBkb2N1bWVudCBpbiAke3N1Z2dlc3Rpb24uZmlsZS5wYXRoLmluY2x1ZGVzKCcvJykgPyBzdWdnZXN0aW9uLmZpbGUucGF0aC5zdWJzdHJpbmcoMCwgc3VnZ2VzdGlvbi5maWxlLnBhdGgubGFzdEluZGV4T2YoJy8nKSkgOiAncm9vdCd9YDtcbiAgICAgICAgICAgIGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NWVtO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChkZXNjRWwpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb250ZW50IFByZXZpZXcgKHN0YW5kYXJkaXplZCB3aXRoIG1vbm9zcGFjZSlcbiAgICAgICAgICAgIGNvbnN0IGV4YW1wbGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZXhhbXBsZUVsLmNsYXNzTmFtZSA9ICdub3ZhLXN1Z2dlc3Rpb24tZXhhbXBsZSc7XG4gICAgICAgICAgICB0aGlzLmdldEZpbGVQcmV2aWV3KHN1Z2dlc3Rpb24uZmlsZSkudGhlbihwcmV2aWV3ID0+IHtcbiAgICAgICAgICAgICAgICBleGFtcGxlRWwudGV4dENvbnRlbnQgPSBgUHJldmlldzogJHtwcmV2aWV3fWA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV4YW1wbGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtYWNjZW50KTtcbiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoZXhhbXBsZUVsKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAhLmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlU2VsZWN0aW9uKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuc3VnZ2VzdGlvblBvcHVwKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBpdGVtcyA9IHRoaXMuc3VnZ2VzdGlvblBvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3ZhLXN1Z2dlc3Rpb24taXRlbScpO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGl0ZW0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IHRoaXMuc2VsZWN0ZWRJbmRleCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwb3NpdGlvblBvcHVwKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuc3VnZ2VzdGlvblBvcHVwKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICAvLyBQb3NpdGlvbiBhYm92ZSB0aGUgdGV4dGFyZWEgd2l0aCBmdWxsIGNvbnRhaW5lciB3aWR0aCAobWF0Y2hpbmcgb3RoZXIgcGlja2VycylcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5sZWZ0ID0gJzAnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5yaWdodCA9ICcwJztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc3R5bGUuYm90dG9tID0gJzEwMCUnO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnNHB4JztcbiAgICB9XG5cbiAgICBwcml2YXRlIHNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogV2lraWxpbmtTdWdnZXN0aW9uKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHRBcmVhLnZhbHVlO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgW1sgcGF0dGVybiB0byByZXBsYWNlXG4gICAgICAgIGNvbnN0IGJlZm9yZUN1cnNvciA9IHRleHQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmtNYXRjaCA9IGJlZm9yZUN1cnNvci5tYXRjaCgvKFxcKyk/XFxbXFxbKFteXFxdXSo/KSQvKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghbGlua01hdGNoKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBpc1BlcnNpc3RlbnQgPSAhIWxpbmtNYXRjaFsxXTtcbiAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSBjdXJzb3JQb3MgLSBsaW5rTWF0Y2hbMF0ubGVuZ3RoO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSByZXBsYWNlbWVudCB0ZXh0XG4gICAgICAgIGNvbnN0IGxpbmtUZXh0ID0gYFtbJHtzdWdnZXN0aW9uLmZpbGUuYmFzZW5hbWV9XV1gO1xuICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IGlzUGVyc2lzdGVudCA/IGArJHtsaW5rVGV4dH1gIDogbGlua1RleHQ7XG4gICAgICAgIFxuICAgICAgICAvLyBSZXBsYWNlIHRoZSB0ZXh0XG4gICAgICAgIGNvbnN0IG5ld1RleHQgPSB0ZXh0LnN1YnN0cmluZygwLCBzdGFydFBvcykgKyByZXBsYWNlbWVudCArIHRleHQuc3Vic3RyaW5nKGN1cnNvclBvcyk7XG4gICAgICAgIHRoaXMudGV4dEFyZWEudmFsdWUgPSBuZXdUZXh0O1xuICAgICAgICBcbiAgICAgICAgLy8gUG9zaXRpb24gY3Vyc29yIGFmdGVyIHRoZSBsaW5rXG4gICAgICAgIGNvbnN0IG5ld0N1cnNvclBvcyA9IHN0YXJ0UG9zICsgcmVwbGFjZW1lbnQubGVuZ3RoO1xuICAgICAgICB0aGlzLnRleHRBcmVhLnNldFNlbGVjdGlvblJhbmdlKG5ld0N1cnNvclBvcywgbmV3Q3Vyc29yUG9zKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyaWdnZXIgaW5wdXQgZXZlbnQgdG8gdXBkYXRlIGFueSBhdXRvLWdyb3cgZnVuY3Rpb25hbGl0eVxuICAgICAgICB0aGlzLnRleHRBcmVhLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpbnB1dCcsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmhpZGVTdWdnZXN0aW9ucygpO1xuICAgICAgICB0aGlzLnRleHRBcmVhLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogV2lraWxpbmtTdWdnZXN0aW9uW10ge1xuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IFdpa2lsaW5rU3VnZ2VzdGlvbltdID0gW107XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNjb3JlID0gdGhpcy5zY29yZUZpbGUoZmlsZSwgcXVlcnkpO1xuICAgICAgICAgICAgaWYgKHNjb3JlID4gMCkge1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGV4dDogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gU29ydCBieSBzY29yZSAoaGlnaGVzdCBmaXJzdCkgYW5kIGxpbWl0IHJlc3VsdHNcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXG4gICAgICAgICAgICAuc2xpY2UoMCwgOCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzY29yZUZpbGUoZmlsZTogVEZpbGUsIHF1ZXJ5OiBzdHJpbmcpOiBudW1iZXIge1xuICAgICAgICBpZiAoIXF1ZXJ5KSByZXR1cm4gNTA7IC8vIFNob3cgYWxsIGZpbGVzIHdoZW4gbm8gcXVlcnlcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGJhc2VuYW1lID0gZmlsZS5iYXNlbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5TG93ZXIgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXhhY3QgbWF0Y2hcbiAgICAgICAgaWYgKGJhc2VuYW1lID09PSBxdWVyeUxvd2VyKSByZXR1cm4gMTAwO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RhcnRzIHdpdGggcXVlcnlcbiAgICAgICAgaWYgKGJhc2VuYW1lLnN0YXJ0c1dpdGgocXVlcnlMb3dlcikpIHJldHVybiA4MDtcbiAgICAgICAgXG4gICAgICAgIC8vIENvbnRhaW5zIHF1ZXJ5XG4gICAgICAgIGlmIChiYXNlbmFtZS5pbmNsdWRlcyhxdWVyeUxvd2VyKSkgcmV0dXJuIDYwO1xuICAgICAgICBcbiAgICAgICAgLy8gUGF0aCBjb250YWlucyBxdWVyeVxuICAgICAgICBpZiAocGF0aC5pbmNsdWRlcyhxdWVyeUxvd2VyKSkgcmV0dXJuIDQwO1xuICAgICAgICBcbiAgICAgICAgLy8gRnV6enkgbWF0Y2hcbiAgICAgICAgaWYgKHRoaXMuZnV6enlNYXRjaChiYXNlbmFtZSwgcXVlcnlMb3dlcikpIHJldHVybiAyMDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIHByaXZhdGUgZnV6enlNYXRjaCh0ZXh0OiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHRleHRJbmRleCA9IDA7XG4gICAgICAgIGxldCBxdWVyeUluZGV4ID0gMDtcbiAgICAgICAgXG4gICAgICAgIHdoaWxlICh0ZXh0SW5kZXggPCB0ZXh0Lmxlbmd0aCAmJiBxdWVyeUluZGV4IDwgcXVlcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGV4dFt0ZXh0SW5kZXhdID09PSBxdWVyeVtxdWVyeUluZGV4XSkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5SW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRleHRJbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcXVlcnlJbmRleCA9PT0gcXVlcnkubGVuZ3RoO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZ2V0RmlsZVByZXZpZXcoZmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlbW92ZSBmcm9udG1hdHRlciBpZiBwcmVzZW50XG4gICAgICAgICAgICBsZXQgdGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlckVuZCA9IGNvbnRlbnQuaW5kZXhPZignLS0tJywgMyk7XG4gICAgICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyRW5kICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCA9IGNvbnRlbnQuc3Vic3RyaW5nKGZyb250bWF0dGVyRW5kICsgMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgZmlyc3QgNTAgY2hhcmFjdGVycyBvZiBhY3R1YWwgdGV4dCBjb250ZW50LCByZW1vdmluZyBtYXJrZG93biBmb3JtYXR0aW5nXG4gICAgICAgICAgICBjb25zdCBwbGFpblRleHQgPSB0ZXh0Q29udGVudFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9eIysgL2dtLCAnJykgLy8gUmVtb3ZlIGhlYWRpbmdzXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKlxcKiguKj8pXFwqXFwqL2csICckMScpIC8vIFJlbW92ZSBib2xkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKiguKj8pXFwqL2csICckMScpIC8vIFJlbW92ZSBpdGFsaWNcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxbKC4qPylcXF1cXCguKj9cXCkvZywgJyQxJykgLy8gUmVtb3ZlIGxpbmtzXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnICcpIC8vIFJlcGxhY2UgbmV3bGluZXMgd2l0aCBzcGFjZXNcbiAgICAgICAgICAgICAgICAudHJpbSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gcGxhaW5UZXh0Lmxlbmd0aCA+IDUwID8gcGxhaW5UZXh0LnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJyA6IHBsYWluVGV4dCB8fCAnRW1wdHkgZmlsZSc7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1VuYWJsZSB0byBsb2FkIHByZXZpZXcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3VnZ2VzdGlvblBvcHVwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vY29yZS9kb2N1bWVudC1lbmdpbmUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3Rpb25QYXRoSXRlbSB7XG4gICAgLyoqIERpc3BsYXkgbmFtZSB3aXRoIHByb3BlciBpbmRlbnRhdGlvbiAqL1xuICAgIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG4gICAgLyoqIEFjdHVhbCBwYXRoIGZvciB0YXJnZXRpbmcgKGUuZy4sIFwiTWV0aG9kcy9EYXRhIENvbGxlY3Rpb25cIikgKi9cbiAgICB0YXJnZXRQYXRoOiBzdHJpbmc7XG4gICAgLyoqIE9yaWdpbmFsIGhlYWRpbmcgdGV4dCAqL1xuICAgIGhlYWRpbmdUZXh0OiBzdHJpbmc7XG4gICAgLyoqIE5lc3RpbmcgbGV2ZWwgKDAgPSB0b3AgbGV2ZWwpICovXG4gICAgbGV2ZWw6IG51bWJlcjtcbiAgICAvKiogTGluZSBudW1iZXIgaW4gZG9jdW1lbnQgKi9cbiAgICBsaW5lOiBudW1iZXI7XG4gICAgLyoqIENvbnRlbnQgcHJldmlldyAqL1xuICAgIHByZXZpZXc/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogU2VjdGlvbiBwYXRoIHBpY2tlciBjb21wb25lbnQgZm9yIFwiL1wiIHRyaWdnZXJcbiAqIERpc3BsYXlzIGhpZXJhcmNoaWNhbCBkb2N1bWVudCBzdHJ1Y3R1cmUgZm9yIHByZWNpc2UgdGFyZ2V0aW5nXG4gKi9cbmV4cG9ydCBjbGFzcyBTZWN0aW9uUGlja2VyIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lO1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHBpY2tlckVsITogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpdGVtczogU2VjdGlvblBhdGhJdGVtW10gPSBbXTtcbiAgICBwcml2YXRlIGZpbHRlcmVkSXRlbXM6IFNlY3Rpb25QYXRoSXRlbVtdID0gW107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZEluZGV4OiBudW1iZXIgPSAtMTtcbiAgICBwcml2YXRlIGlzVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgb25TZWxlY3RDYWxsYmFjaz86IChwYXRoOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgcHJpdmF0ZSBvbkNhbmNlbENhbGxiYWNrPzogKCkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgICAgIHRoaXMuY3JlYXRlUGlja2VyKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVQaWNrZXIoKTogdm9pZCB7XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgcGlja2VyIGVsZW1lbnQgbWFudWFsbHkgc2luY2UgY29udGFpbmVyIG1pZ2h0IG5vdCBoYXZlIGNyZWF0ZURpdlxuICAgICAgICB0aGlzLnBpY2tlckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMucGlja2VyRWwuY2xhc3NOYW1lID0gJ25vdmEtc2VjdGlvbi1waWNrZXInO1xuICAgICAgICB0aGlzLnBpY2tlckVsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBib3R0b206IDEwMCU7XG4gICAgICAgICAgICBsZWZ0OiAwO1xuICAgICAgICAgICAgcmlnaHQ6IDA7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4O1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuICAgICAgICAgICAgbWF4LWhlaWdodDogMjAwcHg7XG4gICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdGhlIGVtcHR5IG1ldGhvZCBmb3IgT2JzaWRpYW4gY29tcGF0aWJpbGl0eVxuICAgICAgICAodGhpcy5waWNrZXJFbCBhcyBhbnkpLmVtcHR5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmlubmVySFRNTCA9ICcnO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRoZSBjcmVhdGVEaXYgbWV0aG9kIGZvciBPYnNpZGlhbiBjb21wYXRpYmlsaXR5XG4gICAgICAgICh0aGlzLnBpY2tlckVsIGFzIGFueSkuY3JlYXRlRGl2ID0gZnVuY3Rpb24ob3B0aW9ucz86IHsgY2xzPzogc3RyaW5nIH0pIHtcbiAgICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnM/LmNscykge1xuICAgICAgICAgICAgICAgIGRpdi5jbGFzc05hbWUgPSBvcHRpb25zLmNscztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGVtcHR5IG1ldGhvZCB0byBjcmVhdGVkIGRpdnMgdG9vXG4gICAgICAgICAgICAoZGl2IGFzIGFueSkuZW1wdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIChkaXYgYXMgYW55KS5jcmVhdGVEaXYgPSB0aGlzLmNyZWF0ZURpdjtcbiAgICAgICAgICAgIChkaXYgYXMgYW55KS5jcmVhdGVFbCA9IGZ1bmN0aW9uKHRhZzogc3RyaW5nLCBvcHRpb25zPzogeyB0ZXh0Pzogc3RyaW5nOyBjbHM/OiBzdHJpbmcgfSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zPy50ZXh0KSBlbC50ZXh0Q29udGVudCA9IG9wdGlvbnMudGV4dDtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucz8uY2xzKSBlbC5jbGFzc05hbWUgPSBvcHRpb25zLmNscztcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKGVsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gZGl2O1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRoZSBjcmVhdGVFbCBtZXRob2RcbiAgICAgICAgKHRoaXMucGlja2VyRWwgYXMgYW55KS5jcmVhdGVFbCA9IGZ1bmN0aW9uKHRhZzogc3RyaW5nLCBvcHRpb25zPzogeyB0ZXh0Pzogc3RyaW5nOyBjbHM/OiBzdHJpbmcgfSkge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7XG4gICAgICAgICAgICBpZiAob3B0aW9ucz8udGV4dCkgZWwudGV4dENvbnRlbnQgPSBvcHRpb25zLnRleHQ7XG4gICAgICAgICAgICBpZiAob3B0aW9ucz8uY2xzKSBlbC5jbGFzc05hbWUgPSBvcHRpb25zLmNscztcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICAgICAgcmV0dXJuIGVsO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gQXBwZW5kIHRvIGNvbnRhaW5lclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnBpY2tlckVsKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoZSBzZWN0aW9uIHBpY2tlciB3aXRoIGN1cnJlbnQgZG9jdW1lbnQgc2VjdGlvbnNcbiAgICAgKi9cbiAgICBhc3luYyBzaG93KGZpbHRlclRleHQ6IHN0cmluZyA9ICcnKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNlY3Rpb25zKCk7XG4gICAgICAgIHRoaXMuYXBwbHlGaWx0ZXIoZmlsdGVyVGV4dCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMucGlja2VyRWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDsgLy8gU2VsZWN0IGZpcnN0IGl0ZW0gYnkgZGVmYXVsdFxuICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhpZGUgdGhlIHNlY3Rpb24gcGlja2VyXG4gICAgICovXG4gICAgaGlkZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5waWNrZXJFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBwaWNrZXIgaXMgY3VycmVudGx5IHZpc2libGVcbiAgICAgKi9cbiAgICBnZXRJc1Zpc2libGUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzVmlzaWJsZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIHNlY3Rpb25zIGZyb20gY3VycmVudCBkb2N1bWVudFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgbG9hZFNlY3Rpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvblBhdGhzID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBbGxTZWN0aW9uUGF0aHMoKTtcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBzZWN0aW9uUGF0aHMubWFwKHNlY3Rpb24gPT4gKHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogc2VjdGlvbi5kaXNwbGF5TmFtZSxcbiAgICAgICAgICAgICAgICB0YXJnZXRQYXRoOiBzZWN0aW9uLnRhcmdldFBhdGgsXG4gICAgICAgICAgICAgICAgaGVhZGluZ1RleHQ6IHNlY3Rpb24uaGVhZGluZ1RleHQsXG4gICAgICAgICAgICAgICAgbGV2ZWw6IHNlY3Rpb24ubGV2ZWwsXG4gICAgICAgICAgICAgICAgbGluZTogc2VjdGlvbi5saW5lLFxuICAgICAgICAgICAgICAgIHByZXZpZXc6IHNlY3Rpb24ucHJldmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgc2VjdGlvbnM6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBmaWx0ZXIgdG8gc2VjdGlvbnMgYmFzZWQgb24gc2VhcmNoIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFwcGx5RmlsdGVyKGZpbHRlclRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAoIWZpbHRlclRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkSXRlbXMgPSBbLi4udGhpcy5pdGVtc107XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzZWFyY2hMb3dlciA9IGZpbHRlclRleHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgdGhpcy5maWx0ZXJlZEl0ZW1zID0gdGhpcy5pdGVtcy5maWx0ZXIoaXRlbSA9PlxuICAgICAgICAgICAgaXRlbS5oZWFkaW5nVGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxuICAgICAgICAgICAgaXRlbS50YXJnZXRQYXRoLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoTG93ZXIpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBwaWNrZXIgaXRlbXNcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5waWNrZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIGlmICh0aGlzLmZpbHRlcmVkSXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBub1Jlc3VsdHNFbCA9ICh0aGlzLnBpY2tlckVsIGFzIGFueSkuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zZWN0aW9uLXBpY2tlci1uby1yZXN1bHRzJyB9KTtcbiAgICAgICAgICAgIG5vUmVzdWx0c0VsLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgcGFkZGluZzogMTJweDtcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45ZW07XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgbm9SZXN1bHRzRWwudGV4dENvbnRlbnQgPSAnTm8gc2VjdGlvbnMgZm91bmQnO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5maWx0ZXJlZEl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtRWwgPSAodGhpcy5waWNrZXJFbCBhcyBhbnkpLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc2VjdGlvbi1waWNrZXItaXRlbScgfSk7XG4gICAgICAgICAgICBpdGVtRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA4cHggMTJweDtcbiAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKTtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG4gICAgICAgICAgICBgO1xuXG4gICAgICAgICAgICAvLyBOYW1lIChzdGFuZGFyZGl6ZWQgdG8gbWF0Y2ggY29tbWFuZCBwaWNrZXIpXG4gICAgICAgICAgICBjb25zdCBuYW1lRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIG5hbWVFbC50ZXh0Q29udGVudCA9IGl0ZW0uaGVhZGluZ1RleHQ7XG4gICAgICAgICAgICBuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIGl0ZW1FbC5hcHBlbmRDaGlsZChuYW1lRWwpO1xuXG4gICAgICAgICAgICAvLyBEZXNjcmlwdGlvbiAocGF0aCBpbmZvKVxuICAgICAgICAgICAgY29uc3QgZGVzY0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkZXNjRWwudGV4dENvbnRlbnQgPSBgTmF2aWdhdGUgdG8gc2VjdGlvbjogJHtpdGVtLnRhcmdldFBhdGh9YDtcbiAgICAgICAgICAgIGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NWVtO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgaXRlbUVsLmFwcGVuZENoaWxkKGRlc2NFbCk7XG5cbiAgICAgICAgICAgIC8vIEV4YW1wbGUvUHJldmlldyAoc3RhbmRhcmRpemVkIHdpdGggbW9ub3NwYWNlKVxuICAgICAgICAgICAgY29uc3QgZXhhbXBsZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBwcmV2aWV3VGV4dCA9IGl0ZW0ucHJldmlldyA/IGl0ZW0ucHJldmlldy5zdWJzdHJpbmcoMCwgNTApICsgJy4uLicgOiBgTGluZSAke2l0ZW0ubGluZX1gO1xuICAgICAgICAgICAgZXhhbXBsZUVsLnRleHRDb250ZW50ID0gYFByZXZpZXc6ICR7cHJldmlld1RleHR9YDtcbiAgICAgICAgICAgIGV4YW1wbGVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtYWNjZW50KTtcbiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIGl0ZW1FbC5hcHBlbmRDaGlsZChleGFtcGxlRWwpO1xuXG4gICAgICAgICAgICAvLyBDbGljayBoYW5kbGVyXG4gICAgICAgICAgICBpdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RJdGVtKGluZGV4KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBIb3ZlciBlZmZlY3RzXG4gICAgICAgICAgICBpdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHZpc3VhbCBzZWxlY3Rpb24gc3RhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZVNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLnBpY2tlckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3ZhLXNlY3Rpb24tcGlja2VyLWl0ZW0nKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBpdGVtIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUga2V5Ym9hcmQgbmF2aWdhdGlvblxuICAgICAqL1xuICAgIGhhbmRsZUtleURvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIHN3aXRjaCAoZXZlbnQua2V5KSB7XG4gICAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IE1hdGgubWluKHRoaXMuc2VsZWN0ZWRJbmRleCArIDEsIHRoaXMuZmlsdGVyZWRJdGVtcy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICBjYXNlICdBcnJvd1VwJzpcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBNYXRoLm1heCh0aGlzLnNlbGVjdGVkSW5kZXggLSAxLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICBjYXNlICdFbnRlcic6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbmRleCA+PSAwICYmIHRoaXMuc2VsZWN0ZWRJbmRleCA8IHRoaXMuZmlsdGVyZWRJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RJdGVtKHRoaXMuc2VsZWN0ZWRJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICBjYXNlICdFc2NhcGUnOlxuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VsZWN0IGEgc2VjdGlvbiBieSBpbmRleFxuICAgICAqL1xuICAgIHByaXZhdGUgc2VsZWN0SXRlbShpbmRleDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5maWx0ZXJlZEl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZmlsdGVyZWRJdGVtc1tpbmRleF07XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMub25TZWxlY3RDYWxsYmFjaz8uKGl0ZW0udGFyZ2V0UGF0aCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYW5jZWwgc2VsZWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBjYW5jZWwoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB0aGlzLm9uQ2FuY2VsQ2FsbGJhY2s/LigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBmaWx0ZXIgYW5kIHJlLXJlbmRlclxuICAgICAqL1xuICAgIHVwZGF0ZUZpbHRlcihmaWx0ZXJUZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hcHBseUZpbHRlcihmaWx0ZXJUZXh0KTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5maWx0ZXJlZEl0ZW1zLmxlbmd0aCA+IDAgPyAwIDogLTE7XG4gICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHNlbGVjdGlvbiBjYWxsYmFja1xuICAgICAqL1xuICAgIG9uU2VsZWN0KGNhbGxiYWNrOiAocGF0aDogc3RyaW5nKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIHRoaXMub25TZWxlY3RDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjYW5jZWwgY2FsbGJhY2tcbiAgICAgKi9cbiAgICBvbkNhbmNlbChjYWxsYmFjazogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uQ2FuY2VsQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBzZWxlY3RlZCBpdGVtXG4gICAgICovXG4gICAgZ2V0U2VsZWN0ZWRJdGVtKCk6IFNlY3Rpb25QYXRoSXRlbSB8IG51bGwge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluZGV4ID49IDAgJiYgdGhpcy5zZWxlY3RlZEluZGV4IDwgdGhpcy5maWx0ZXJlZEl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyZWRJdGVtc1t0aGlzLnNlbGVjdGVkSW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFudXAgcmVzb3VyY2VzXG4gICAgICovXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIHRoaXMucGlja2VyRWwucmVtb3ZlKCk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuXG5pbnRlcmZhY2UgU3RydWN0dXJlZENvbW1hbmQge1xuXHRuYW1lOiBzdHJpbmc7XG5cdGRlc2NyaXB0aW9uOiBzdHJpbmc7XG5cdGNvbW1hbmQ6IHN0cmluZztcblx0dGVtcGxhdGU6IHN0cmluZztcblx0ZXhhbXBsZTogc3RyaW5nO1xuXHRrZXl3b3Jkczogc3RyaW5nW107XG59XG5cblxuLyoqXG4gKiBIYW5kbGVzIGNvbW1hbmQgcGlja2VyLCBjb21tYW5kIG1lbnUsIGFuZCBjb21tYW5kIGV4ZWN1dGlvblxuICovXG5leHBvcnQgY2xhc3MgQ29tbWFuZFN5c3RlbSB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgdGV4dEFyZWE6IFRleHRBcmVhQ29tcG9uZW50O1xuXHRwcml2YXRlIGNvbW1hbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdHByaXZhdGUgY29tbWFuZFBpY2tlciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXJJdGVtczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRwcml2YXRlIHNlbGVjdGVkQ29tbWFuZEluZGV4OiBudW1iZXIgPSAtMTtcblx0cHJpdmF0ZSBjb21tYW5kTWVudSE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGlzQ29tbWFuZE1lbnVWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBjb250YWluZXI6IEhUTUxFbGVtZW50LCB0ZXh0QXJlYTogVGV4dEFyZWFDb21wb25lbnQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLnRleHRBcmVhID0gdGV4dEFyZWE7XG5cdH1cblxuXHRjcmVhdGVDb21tYW5kQnV0dG9uKGlucHV0Um93OiBIVE1MRWxlbWVudCk6IEJ1dHRvbkNvbXBvbmVudCB7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dFJvdyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldEljb24oJ3phcCcpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5zZXRUb29sdGlwKCdDb21tYW5kcycpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMudG9nZ2xlQ29tbWFuZE1lbnUoKSk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4td2lkdGg6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGhlaWdodDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogJHt0aGlzLnNob3VsZFNob3dDb21tYW5kQnV0dG9uKCkgPyAnZmxleCcgOiAnbm9uZSd9O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0cGFkZGluZzogMDtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0bWFyZ2luLXJpZ2h0OiB2YXIoLS1zaXplLTItMyk7XG5cdFx0YDtcblx0XHRyZXR1cm4gdGhpcy5jb21tYW5kQnV0dG9uO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHQvLyBMZWdhY3kgbWV0aG9kIC0gdXNlIGNyZWF0ZUNvbW1hbmRQaWNrZXJJbkNvbnRhaW5lciBpbnN0ZWFkXG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kUGlja2VySW5Db250YWluZXIodGhpcy5jb250YWluZXIpO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlcicgfSk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0YDtcblx0fVxuXG5cdHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbiAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpO1xuXHR9XG5cblx0dXBkYXRlQ29tbWFuZEJ1dHRvblZpc2liaWxpdHkoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZEJ1dHRvbikge1xuXHRcdFx0Y29uc3Qgc2hvdWxkU2hvdyA9IHRoaXMuc2hvdWxkU2hvd0NvbW1hbmRCdXR0b24oKTtcblx0XHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gc2hvdWxkU2hvdyA/ICdmbGV4JyA6ICdub25lJztcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY3JlYXRlQ29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUpIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRcdG1pbi13aWR0aDogMjUwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ29tbWFuZHMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gW1xuXHRcdFx0eyBuYW1lOiAnSW1wcm92ZSBXcml0aW5nJywgZGVzY3JpcHRpb246ICdFbmhhbmNlIGNsYXJpdHkgYW5kIGZsb3cnLCBjb21tYW5kOiAnL2ltcHJvdmUnIH0sXG5cdFx0XHR7IG5hbWU6ICdGaXggR3JhbW1hcicsIGRlc2NyaXB0aW9uOiAnQ29ycmVjdCBncmFtbWFyIGFuZCBzcGVsbGluZycsIGNvbW1hbmQ6ICcvZ3JhbW1hcicgfSxcblx0XHRcdHsgbmFtZTogJ1N1bW1hcml6ZScsIGRlc2NyaXB0aW9uOiAnQ3JlYXRlIGEgY29uY2lzZSBzdW1tYXJ5JywgY29tbWFuZDogJy9zdW1tYXJpemUnIH0sXG5cdFx0XHR7IG5hbWU6ICdFeHBhbmQgSWRlYXMnLCBkZXNjcmlwdGlvbjogJ0RldmVsb3AgdGhvdWdodHMgZnVydGhlcicsIGNvbW1hbmQ6ICcvZXhwYW5kJyB9LFxuXHRcdFx0eyBuYW1lOiAnRXhwbGFpbicsIGRlc2NyaXB0aW9uOiAnQ2xhcmlmeSBjb21wbGV4IGNvbmNlcHRzJywgY29tbWFuZDogJy9leHBsYWluJyB9LFxuXHRcdFx0eyBuYW1lOiAnQ29udGludWUgV3JpdGluZycsIGRlc2NyaXB0aW9uOiAnRXh0ZW5kIHRoZSBjdXJyZW50IHRleHQnLCBjb21tYW5kOiAnL2NvbnRpbnVlJyB9XG5cdFx0XTtcblxuXHRcdGNvbnN0IHRpdGxlID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnUXVpY2sgQ29tbWFuZHMnIH0pO1xuXHRcdHRpdGxlLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdGA7XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRjb25zdCBjbWRFbCA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0nIH0pO1xuXHRcdFx0Y21kRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtMi0zKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXhzKTtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xcztcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGNtZEVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5uYW1lIH0pO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IGRlc2NFbCA9IGNtZEVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5kZXNjcmlwdGlvbiB9KTtcblx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGA7XG5cblx0XHRcdGNtZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGNtZC5jb21tYW5kICsgJyAnKTtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Y21kRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0Y21kRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR9KTtcblxuXHRcdFx0Y21kRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0Y21kRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbW1hbmRNZW51KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0aGFuZGxlSW5wdXRDaGFuZ2UoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnRleHRBcmVhKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGlucHV0ID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdC8vIEhhbmRsZSBkaWZmZXJlbnQgdHJpZ2dlcnNcblx0XHRpZiAoaW5wdXQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHQvLyBDdXN0b20gY29tbWFuZCB0cmlnZ2VyIC0gc2hvdyBzdHJ1Y3R1cmVkIGNvbW1hbmRzXG5cdFx0XHR0aGlzLnNob3dTdHJ1Y3R1cmVkQ29tbWFuZFBpY2tlcihpbnB1dCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIE5vIHRyaWdnZXJzIGFjdGl2ZSAtIGhpZGUgY29tbWFuZCBwaWNrZXJcblx0XHRcdC8vIE5vdGU6IFwiL1wiIGlzIGhhbmRsZWQgYnkgc2VjdGlvbiBwaWNrZXIsIG5vdCBjb21tYW5kIHN5c3RlbVxuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdH1cblx0fVxuXG5cblx0LyoqXG5cdCAqIFNob3cgc3RydWN0dXJlZCBjb21tYW5kIHBpY2tlciBmb3IgXCI6XCIgdHJpZ2dlciAgXG5cdCAqL1xuXHRwcml2YXRlIHNob3dTdHJ1Y3R1cmVkQ29tbWFuZFBpY2tlcihpbnB1dDogc3RyaW5nKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbW1hbmRQaWNrZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3Qgc3RydWN0dXJlZENvbW1hbmRzID0gdGhpcy5nZXRTdHJ1Y3R1cmVkQ29tbWFuZHMoKTtcblx0XHRjb25zdCBmaWx0ZXJUZXh0ID0gaW5wdXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTsgLy8gUmVtb3ZlIFwiOlwiXG5cdFx0XG5cdFx0Y29uc3QgZmlsdGVyZWQgPSBzdHJ1Y3R1cmVkQ29tbWFuZHMuZmlsdGVyKGNtZCA9PiBcblx0XHRcdGNtZC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdGNtZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdGNtZC5rZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4ga2V5d29yZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpKVxuXHRcdCk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5lbXB0eSgpO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblxuXHRcdGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRmaWx0ZXJlZC5mb3JFYWNoKChjbWQsIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlci1pdGVtJyB9KTtcblx0XHRcdFx0aXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRjb25zdCBuYW1lRWwgPSBpdGVtLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGNtZC5uYW1lIH0pO1xuXHRcdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLmRlc2NyaXB0aW9uIH0pO1xuXHRcdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuODVlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IGV4YW1wbGVFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogYEV4YW1wbGU6ICR7Y21kLmV4YW1wbGV9YCB9KTtcblx0XHRcdFx0ZXhhbXBsZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpO1xuXHRcdFx0XHRcdGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKGNtZC50ZW1wbGF0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gaW5kZXg7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblx0aGlkZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cdH1cblxuXHRoYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuXHRcdGlmIChrZXkgPT09ICdBcnJvd0Rvd24nKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gTWF0aC5taW4odGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCArIDEsIHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCAtIDEpO1xuXHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ0Fycm93VXAnKSB7XG5cdFx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gTWF0aC5tYXgodGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCAtIDEsIC0xKTtcblx0XHRcdHRoaXMudXBkYXRlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIGlmIChrZXkgPT09ICdUYWInICYmIHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPj0gMCkge1xuXHRcdFx0Ly8gVXNlIHRoZSBzYW1lIGxvZ2ljIGFzIGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24gZm9yIFRhYlxuXHRcdFx0cmV0dXJuIHRoaXMuaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGhhbmRsZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPj0gMCAmJiB0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPiAwKSB7XG5cdFx0XHQvLyBGb3Igc3RydWN0dXJlZCBjb21tYW5kcywgd2UgbmVlZCB0byBnZXQgdGhlIHNlbGVjdGVkIGNvbW1hbmQgZnJvbSB0aGUgZmlsdGVyZWQgbGlzdFxuXHRcdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldFN0cnVjdHVyZWRDb21tYW5kcygpO1xuXHRcdFx0Y29uc3QgaW5wdXQgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XHRpZiAoaW5wdXQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRcdGNvbnN0IGZpbHRlclRleHQgPSBpbnB1dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRjb25zdCBmaWx0ZXJlZCA9IGNvbW1hbmRzLmZpbHRlcihjbWQgPT4gXG5cdFx0XHRcdFx0Y21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0XHRcdGNtZC5jb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkgfHxcblx0XHRcdFx0XHRjbWQua2V5d29yZHMuc29tZShrZXl3b3JkID0+IGtleXdvcmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSlcblx0XHRcdFx0KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4IDwgZmlsdGVyZWQubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc2VsZWN0ZWRDbWQgPSBmaWx0ZXJlZFt0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4XTtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdFN0cnVjdHVyZWRDb21tYW5kKHNlbGVjdGVkQ21kLnRlbXBsYXRlKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpbmRleCA9PT0gdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCkge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZChjb21tYW5kOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGNvbW1hbmQgKyAnICcpO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCBlbmRcblx0XHRjb25zdCBsZW5ndGggPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkubGVuZ3RoO1xuXHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZShsZW5ndGgsIGxlbmd0aCk7XG5cdFx0XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHR9XG5cblxuXHQvKipcblx0ICogR2V0IHN0cnVjdHVyZWQgY29tbWFuZHMgZm9yIFwiOlwiIHRyaWdnZXJcblx0ICovXG5cdHByaXZhdGUgZ2V0U3RydWN0dXJlZENvbW1hbmRzKCk6IFN0cnVjdHVyZWRDb21tYW5kW10ge1xuXHRcdHJldHVybiBbXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdBZGQgU2VjdGlvbicsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnQWRkIGEgbmV3IHNlY3Rpb24gdG8gdGhlIGRvY3VtZW50Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2FkZCBzZWN0aW9uJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdhZGQgc2VjdGlvbiBcIntjdXJzb3J9XCInLFxuXHRcdFx0XHRleGFtcGxlOiAnOmFkZCBzZWN0aW9uIFwiUmVzdWx0c1wiJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY3JlYXRlJywgJ25ldycsICdoZWFkaW5nJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdFZGl0IFNlY3Rpb24nLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogJ0VkaXQgY29udGVudCBpbiBhIHNwZWNpZmljIHNlY3Rpb24nLFxuXHRcdFx0XHRjb21tYW5kOiAnZWRpdCBzZWN0aW9uJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdlZGl0IHtjdXJzb3J9IHNlY3Rpb24nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmVkaXQgTWV0aG9kcyBzZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnbW9kaWZ5JywgJ3VwZGF0ZScsICdjaGFuZ2UnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0RlbGV0ZSBTZWN0aW9uJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdSZW1vdmUgYSBzZWN0aW9uIGZyb20gdGhlIGRvY3VtZW50Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2RlbGV0ZSBzZWN0aW9uJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdkZWxldGUge2N1cnNvcn0gc2VjdGlvbicsXG5cdFx0XHRcdGV4YW1wbGU6ICc6ZGVsZXRlIEludHJvZHVjdGlvbiBzZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsncmVtb3ZlJywgJ2VsaW1pbmF0ZSddXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRuYW1lOiAnQXBwZW5kIFRvJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgY29udGVudCB0byB0aGUgZW5kIG9mIGEgc2VjdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdhcHBlbmQgdG8nLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2FwcGVuZCB7Y3Vyc29yfSB0byAvJyxcblx0XHRcdFx0ZXhhbXBsZTogJzphcHBlbmQgY29uY2x1c2lvbiB0byAvUmVzdWx0cycsXG5cdFx0XHRcdGtleXdvcmRzOiBbJ2FkZCcsICdhdHRhY2gnLCAnZW5kJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdQcmVwZW5kIFRvJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgY29udGVudCB0byB0aGUgYmVnaW5uaW5nIG9mIGEgc2VjdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdwcmVwZW5kIHRvJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdwcmVwZW5kIHtjdXJzb3J9IHRvIC8nLFxuXHRcdFx0XHRleGFtcGxlOiAnOnByZXBlbmQgd2FybmluZyB0byAvTWV0aG9kcycsXG5cdFx0XHRcdGtleXdvcmRzOiBbJ2FkZCcsICdiZWdpbm5pbmcnLCAnc3RhcnQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0luc2VydCBBZnRlcicsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnSW5zZXJ0IGNvbnRlbnQgYWZ0ZXIgYSBzZWN0aW9uIGhlYWRpbmcnLFxuXHRcdFx0XHRjb21tYW5kOiAnaW5zZXJ0IGFmdGVyJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdpbnNlcnQge2N1cnNvcn0gYWZ0ZXIgLyBoZWFkaW5nJyxcblx0XHRcdFx0ZXhhbXBsZTogJzppbnNlcnQgZGlhZ3JhbSBhZnRlciAvTWV0aG9kcyBoZWFkaW5nJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnYWRkJywgJ3BsYWNlJywgJ2FmdGVyJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdJbnNlcnQgQmVmb3JlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdJbnNlcnQgY29udGVudCBiZWZvcmUgYSBzZWN0aW9uIGhlYWRpbmcnLFxuXHRcdFx0XHRjb21tYW5kOiAnaW5zZXJ0IGJlZm9yZScsXG5cdFx0XHRcdHRlbXBsYXRlOiAnaW5zZXJ0IHtjdXJzb3J9IGJlZm9yZSAvIGhlYWRpbmcnLFxuXHRcdFx0XHRleGFtcGxlOiAnOmluc2VydCBub3RlIGJlZm9yZSAvUmVzdWx0cyBoZWFkaW5nJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnYWRkJywgJ3BsYWNlJywgJ2JlZm9yZSddXG5cdFx0XHR9XG5cdFx0XTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTZWxlY3QgYSBzdHJ1Y3R1cmVkIGNvbW1hbmQgYW5kIGluc2VydCB0ZW1wbGF0ZVxuXHQgKi9cblx0cHJpdmF0ZSBzZWxlY3RTdHJ1Y3R1cmVkQ29tbWFuZCh0ZW1wbGF0ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdFxuXHRcdC8vIFJlcGxhY2UgY3Vyc29yIHBsYWNlaG9sZGVyIGFuZCBpbnNlcnQgdGVtcGxhdGVcblx0XHRjb25zdCBjdXJzb3JQb3MgPSB0ZW1wbGF0ZS5pbmRleE9mKCd7Y3Vyc29yfScpO1xuXHRcdGlmIChjdXJzb3JQb3MgIT09IC0xKSB7XG5cdFx0XHRjb25zdCBiZWZvcmVDdXJzb3IgPSB0ZW1wbGF0ZS5zbGljZSgwLCBjdXJzb3JQb3MpO1xuXHRcdFx0Y29uc3QgYWZ0ZXJDdXJzb3IgPSB0ZW1wbGF0ZS5zbGljZShjdXJzb3JQb3MgKyA4KTsgLy8gTGVuZ3RoIG9mICd7Y3Vyc29yfSdcblx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoYmVmb3JlQ3Vyc29yICsgYWZ0ZXJDdXJzb3IpO1xuXHRcdFx0XG5cdFx0XHQvLyBQb3NpdGlvbiBjdXJzb3Igd2hlcmUge2N1cnNvcn0gd2FzXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKGN1cnNvclBvcywgY3Vyc29yUG9zKTtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSh0ZW1wbGF0ZSk7XG5cdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHR9XG5cdH1cblxuXHRjbGVhbnVwKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRNZW51LnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb21tYW5kUGlja2VyKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXIucmVtb3ZlKCk7XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgUGxhdGZvcm0sIFRGaWxlLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IE11bHRpRG9jQ29udGV4dEhhbmRsZXIsIE11bHRpRG9jQ29udGV4dCB9IGZyb20gJy4uL2NvcmUvbXVsdGktZG9jLWNvbnRleHQnO1xuXG4vKipcbiAqIEhhbmRsZXMgbXVsdGktZG9jdW1lbnQgY29udGV4dCBVSSBhbmQgbWFuYWdlbWVudFxuICovXG5leHBvcnQgY2xhc3MgQ29udGV4dE1hbmFnZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBhcHA6IEFwcDtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIG11bHRpRG9jSGFuZGxlcjogTXVsdGlEb2NDb250ZXh0SGFuZGxlcjtcblx0cHVibGljIGNvbnRleHRJbmRpY2F0b3IhOiBIVE1MRWxlbWVudDtcblx0cHVibGljIGNvbnRleHRQcmV2aWV3ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBOT1RJQ0VfRFVSQVRJT05fTVMgPSA1MDAwO1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogTm92YVBsdWdpbiwgYXBwOiBBcHAsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLm11bHRpRG9jSGFuZGxlciA9IG5ldyBNdWx0aURvY0NvbnRleHRIYW5kbGVyKGFwcCk7XG5cdH1cblxuXHRjcmVhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1pbmRpY2F0b3InIH0pO1xuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0dG9wOiAtMnB4O1xuXHRcdFx0cmlnaHQ6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMSkgdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHotaW5kZXg6IDEwMDtcblx0XHRcdG1heC13aWR0aDogMjAwcHg7XG5cdFx0XHRib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctcyk7XG5cdFx0YDtcblx0fVxuXG5cdGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblx0XHRjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXcnIH0pO1xuXHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTIpIHZhcigtLXNpemUtMi0zKTtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbCk7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdGA7XG5cblx0XHRjb25zdCBwcmV2aWV3TGFiZWwgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnQ29udGV4dDogJyB9KTtcblx0XHRwcmV2aWV3TGFiZWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtd2VpZ2h0OiA2MDA7JztcblxuXHRcdGNvbnN0IHByZXZpZXdMaXN0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctbGlzdCcgfSk7XG5cdFx0cHJldmlld0xpc3Quc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsnO1xuXG5cdFx0cmV0dXJuIHByZXZpZXdDb250YWluZXI7XG5cdH1cblxuXHR1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRQcmV2aWV3IHx8ICF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCFtZXNzYWdlKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUGFyc2UgZG9jdW1lbnQgcmVmZXJlbmNlcyBmcm9tIGN1cnJlbnQgbWVzc2FnZVxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRjb25zdCBmb3VuZFJlZnM6IEFycmF5PHtuYW1lOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nfT4gPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcblx0XHRcdGZvdW5kUmVmcy5wdXNoKHsgbmFtZTogZG9jTmFtZSwgcHJvcGVydHkgfSk7XG5cdFx0fVxuXG5cdFx0aWYgKGZvdW5kUmVmcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBVcGRhdGUgcHJldmlldyBkaXNwbGF5XG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSB0aGlzLmNvbnRleHRQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0aWYgKHByZXZpZXdMaXN0KSB7XG5cdFx0XHRjb25zdCByZWZzVGV4dCA9IGZvdW5kUmVmcy5tYXAocmVmID0+IFxuXHRcdFx0XHRyZWYucHJvcGVydHkgPyBgJHtyZWYubmFtZX0jJHtyZWYucHJvcGVydHl9YCA6IHJlZi5uYW1lXG5cdFx0XHQpLmpvaW4oJywgJyk7XG5cdFx0XHRwcmV2aWV3TGlzdC50ZXh0Q29udGVudCA9IHJlZnNUZXh0O1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdH1cblxuXHRhc3luYyBidWlsZENvbnRleHQobWVzc2FnZTogc3RyaW5nLCBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsKTogUHJvbWlzZTxNdWx0aURvY0NvbnRleHQgfCBudWxsPiB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpIHx8ICFjdXJyZW50RmlsZSkge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubXVsdGlEb2NIYW5kbGVyLmJ1aWxkQ29udGV4dChtZXNzYWdlLCBjdXJyZW50RmlsZSk7XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gcmVzdWx0LmNvbnRleHQ7XG5cblx0XHRcdGlmIChyZXN1bHQuY29udGV4dD8ucGVyc2lzdGVudERvY3MubGVuZ3RoKSB7XG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcihyZXN1bHQuY29udGV4dCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayB0b2tlbiBsaW1pdFxuXHRcdFx0XHRpZiAocmVzdWx0LmNvbnRleHQuaXNOZWFyTGltaXQpIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgQXBwcm9hY2hpbmcgdG9rZW4gbGltaXQuIENvbnNpZGVyIHJlbW92aW5nIHNvbWUgZG9jdW1lbnRzIGZyb20gY29udGV4dC4nLCBDb250ZXh0TWFuYWdlci5OT1RJQ0VfRFVSQVRJT05fTVMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZXN1bHQuY29udGV4dDtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGJ1aWxkIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0SW5kaWNhdG9yKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0SW5kaWNhdG9yKSByZXR1cm47XG5cblx0XHRjb25zdCBkb2NDb3VudCA9IGNvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuXHRcdGlmIChkb2NDb3VudCA+IDApIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci50ZXh0Q29udGVudCA9IGAke2RvY0NvdW50fSBkb2Mke2RvY0NvdW50ID4gMSA/ICdzJyA6ICcnfWA7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cblx0XHRcdC8vIEFkZCBleHBhbmQgZnVuY3Rpb25hbGl0eVxuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5vbmNsaWNrID0gKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnNob3dDb250ZXh0RGV0YWlscyhjb250ZXh0KTtcblx0XHRcdH07XG5cblx0XHRcdC8vIEFkZCBob3ZlciBlZmZlY3Rcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1ob3ZlciknO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb250ZXh0RGV0YWlscyhjb250ZXh0OiBNdWx0aURvY0NvbnRleHQpOiB2b2lkIHtcblx0XHQvLyBDcmVhdGUgbW9kYWwgb3IgZXhwYW5kZWQgdmlld1xuXHRcdGNvbnN0IG1vZGFsID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LW1vZGFsJyB9KTtcblx0XHRtb2RhbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGZpeGVkO1xuXHRcdFx0dG9wOiAwO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym90dG9tOiAwO1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHotaW5kZXg6IDEwMDAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50ID0gbW9kYWwuY3JlYXRlRGl2KCk7XG5cdFx0Y29udGVudC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC00KTtcblx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0bWF4LWhlaWdodDogODAlO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRgO1xuXG5cdFx0Y29uc3QgaGVhZGVyID0gY29udGVudC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdDb250ZXh0IERvY3VtZW50cycgfSk7XG5cdFx0aGVhZGVyLnN0eWxlLmNzc1RleHQgPSAnbWFyZ2luLXRvcDogMDsgbWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTMpOyc7XG5cblx0XHRjb250ZXh0LnBlcnNpc3RlbnREb2NzLmZvckVhY2goZG9jID0+IHtcblx0XHRcdGNvbnN0IGRvY0VsID0gY29udGVudC5jcmVhdGVEaXYoKTtcblx0XHRcdGRvY0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXhzKTtcblx0XHRcdGA7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGRvY0VsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGRvYy5maWxlLmJhc2VuYW1lIH0pO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDYwMDsgbWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpOyc7XG5cblx0XHRcdGlmIChkb2MucHJvcGVydHkpIHtcblx0XHRcdFx0Y29uc3QgcHJvcEVsID0gZG9jRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogYFByb3BlcnR5OiAke2RvYy5wcm9wZXJ0eX1gIH0pO1xuXHRcdFx0XHRwcm9wRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTaG93IGZpbGUgcGF0aCBhcyBwcmV2aWV3IHNpbmNlIGNvbnRlbnQgaXNuJ3QgZGlyZWN0bHkgYXZhaWxhYmxlXG5cdFx0XHRjb25zdCBwcmV2aWV3RWwgPSBkb2NFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBkb2MuZmlsZS5wYXRoIH0pO1xuXHRcdFx0cHJldmlld0VsLnN0eWxlLmNzc1RleHQgPSAnZm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IG1hcmdpbi10b3A6IHZhcigtLXNpemUtMi0xKTsnO1xuXHRcdH0pO1xuXG5cdFx0Y29uc3QgY2xvc2VCdG4gPSBjb250ZW50LmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdDbG9zZScgfSk7XG5cdFx0Y2xvc2VCdG4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi10b3A6IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcblx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRgO1xuXG5cdFx0Y2xvc2VCdG4ub25jbGljayA9ICgpID0+IG1vZGFsLnJlbW92ZSgpO1xuXHRcdG1vZGFsLm9uY2xpY2sgPSAoZSkgPT4ge1xuXHRcdFx0aWYgKGUudGFyZ2V0ID09PSBtb2RhbCkgbW9kYWwucmVtb3ZlKCk7XG5cdFx0fTtcblx0fVxuXG5cdGhpZGVDb250ZXh0UHJldmlldygpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGhpZGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFyQ3VycmVudENvbnRleHQoKTogdm9pZCB7XG5cdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0dGhpcy5oaWRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdHRoaXMuaGlkZUNvbnRleHRQcmV2aWV3KCk7XG5cdH1cblxuXHRnZXRDdXJyZW50Q29udGV4dCgpOiBNdWx0aURvY0NvbnRleHQgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5jdXJyZW50Q29udGV4dDtcblx0fVxuXG5cdGNsZWFudXAoKTogdm9pZCB7XG5cdFx0dGhpcy5jbGVhckN1cnJlbnRDb250ZXh0KCk7XG5cdFx0aWYgKHRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5yZW1vdmUoKTtcblx0XHR9XG5cdH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcblxuLyoqXG4gKiBIYW5kbGVzIGFsbCBjaGF0IG1lc3NhZ2UgcmVuZGVyaW5nIGFuZCBkaXNwbGF5IGxvZ2ljXG4gKi9cbmV4cG9ydCBjbGFzcyBDaGF0UmVuZGVyZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgU0NST0xMX0RFTEFZX01TID0gNTA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGNoYXRDb250YWluZXI7XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGEgY2hhdCBtZXNzYWdlIHdpdGggcm9sZSBoZWFkZXJcblx0ICovXG5cdGFkZE1lc3NhZ2Uocm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtJHtyb2xlfWAgfSk7XG5cdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMykgdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHQke3JvbGUgPT09ICd1c2VyJyBcblx0XHRcdFx0PyAnbWFyZ2luLWxlZnQ6IGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7JyBcblx0XHRcdFx0OiByb2xlID09PSAnc3lzdGVtJ1xuXHRcdFx0XHQ/ICdtYXJnaW46IDAgYXV0bzsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG5cdH1cblxuXHQvKipcblx0ICogSGVscGVyIG1ldGhvZCB0byBjcmVhdGUgc2ltcGxlIG1lc3NhZ2VzIHdpdGhvdXQgcm9sZSBoZWFkZXJzXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZVNpbXBsZU1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBjbGFzc05hbWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2UgJHtjbGFzc05hbWV9YCB9KTtcblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdFxuXHRcdC8vIFN1cHBvcnQgaWNvbnMgaW4gbWVzc2FnZXNcblx0XHRpZiAoY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50RWwuaW5uZXJIVE1MID0gY29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gY29udGVudDtcblx0XHR9XG5cblx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKCk7XG5cdH1cblxuXHRhZGRFcnJvck1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jcmVhdGVTaW1wbGVNZXNzYWdlKGNvbnRlbnQsICdub3ZhLW1lc3NhZ2UtZXJyb3InKTtcblx0fVxuXG5cdGFkZFN1Y2Nlc3NNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuY3JlYXRlU2ltcGxlTWVzc2FnZShjb250ZW50LCAnbm92YS1tZXNzYWdlLXN1Y2Nlc3MnKTtcblx0fVxuXG5cdGFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2U/OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCB3ZWxjb21lRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lJyB9KTtcblx0XHR3ZWxjb21lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC00KTtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50ID0gbWVzc2FnZSB8fCBgXG5cdFx0XHQ8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGdhcDogdmFyKC0tc2l6ZS0yLTMpOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XCI+XG5cdFx0XHRcdDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IHZhcigtLWljb24tc2l6ZS14bCk7IGhlaWdodDogdmFyKC0taWNvbi1zaXplLXhsKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XCI+XG5cdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDwvc3ZnPlxuXHRcdFx0XHQ8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1sYXJnZSk7IGZvbnQtd2VpZ2h0OiA2MDA7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XCI+V2VsY29tZSB0byBOb3ZhPC9zcGFuPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMCAwIHZhcigtLXNpemUtNC0zKSAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1wiPlxuXHRcdFx0XHRZb3VyIEFJIHRoaW5raW5nIHBhcnRuZXIgZm9yIE9ic2lkaWFuLiBTdGFydCBhIGNvbnZlcnNhdGlvbiBvciB1c2UgY29tbWFuZHMgdG8gZW5oYW5jZSB5b3VyIHdyaXRpbmcuXG5cdFx0XHQ8L3A+XG5cdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgY29sb3I6IHZhcigtLXRleHQtZmFpbnQpOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpO1wiPlxuXHRcdFx0XHRcdUQ4M0RcdURDQTEgPHN0cm9uZz5UaXA6PC9zdHJvbmc+IFJlZmVyZW5jZSBvdGhlciBub3RlcyB3aXRoIFtbTm90ZSBOYW1lXV0gb3IgdXNlIHRoZSBcdTI2QTEgYnV0dG9uIGZvciBxdWljayBjb21tYW5kc1xuXHRcdFx0PC9wPlxuXHRcdGA7XG5cblx0XHR3ZWxjb21lRWwuaW5uZXJIVE1MID0gY29udGVudDtcblxuXHRcdC8vIEFkZCBkaXNtaXNzIGJ1dHRvblxuXHRcdGNvbnN0IGRpc21pc3NCdG4gPSB3ZWxjb21lRWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xuXHRcdGRpc21pc3NCdG4udGV4dENvbnRlbnQgPSAnXHUwMEQ3Jztcblx0XHRkaXNtaXNzQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IHZhcigtLXNpemUtMi0yKTtcblx0XHRcdHJpZ2h0OiB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLWxhcmdlKTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy14cyk7XG5cdFx0YDtcblxuXHRcdGRpc21pc3NCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3ZWxjb21lRWwucmVtb3ZlKCk7XG5cdFx0fSk7XG5cblx0XHRkaXNtaXNzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdH0pO1xuXG5cdFx0ZGlzbWlzc0J0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0ZGlzbWlzc0J0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRkaXNtaXNzQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNjcm9sbFRvQm90dG9tKHRydWUpO1xuXHR9XG5cblx0Y2xlYXJDaGF0KCk6IHZvaWQge1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBzY3JvbGxUb0JvdHRvbShzbW9vdGg6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHNtb290aCkge1xuXHRcdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG8oe1xuXHRcdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodDtcblx0XHRcdH1cblx0XHR9LCBDaGF0UmVuZGVyZXIuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRDb252ZXJzYXRpb25IaXN0b3J5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHQvLyBEaXNwbGF5IG1lc3NhZ2VzIGluIHRoZSBVSVxuXHRcdGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuXHRcdFx0dGhpcy5hZGRNZXNzYWdlKG1lc3NhZ2Uucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBtZXNzYWdlLmNvbnRlbnQpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFJUHJvdmlkZXIsIFByb3ZpZGVyVHlwZSwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBBSVByb3ZpZGVyU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENsYXVkZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvY2xhdWRlJztcbmltcG9ydCB7IE9wZW5BSVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb3BlbmFpJztcbmltcG9ydCB7IEdvb2dsZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvZ29vZ2xlJztcbmltcG9ydCB7IE9sbGFtYVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb2xsYW1hJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzJztcbmltcG9ydCB7IEZlYXR1cmVNYW5hZ2VyIH0gZnJvbSAnLi4vbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBBSVByb3ZpZGVyTWFuYWdlciB7XG5cdHByaXZhdGUgcHJvdmlkZXJzOiBNYXA8UHJvdmlkZXJUeXBlLCBBSVByb3ZpZGVyPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzZXR0aW5nczogTm92YVNldHRpbmdzO1xuXHRwcml2YXRlIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXI7XG5cblx0Y29uc3RydWN0b3Ioc2V0dGluZ3M6IE5vdmFTZXR0aW5ncywgZmVhdHVyZU1hbmFnZXI/OiBGZWF0dXJlTWFuYWdlcikge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gZmVhdHVyZU1hbmFnZXI7XG5cdH1cblxuXHRhc3luYyBpbml0aWFsaXplKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnY2xhdWRlJywgbmV3IENsYXVkZVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdvcGVuYWknLCBuZXcgT3BlbkFJUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2dvb2dsZScsIG5ldyBHb29nbGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb2xsYW1hJywgbmV3IE9sbGFtYVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hKSk7XG5cdH1cblxuXHR1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTm92YVNldHRpbmdzKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMucHJvdmlkZXJzLmZvckVhY2goKHByb3ZpZGVyLCB0eXBlKSA9PiB7XG5cdFx0XHRpZiAodHlwZSAhPT0gJ25vbmUnICYmIHR5cGUgaW4gdGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycykge1xuXHRcdFx0XHRwcm92aWRlci51cGRhdGVDb25maWc/Lih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzW3R5cGUgYXMga2V5b2YgQUlQcm92aWRlclNldHRpbmdzXSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGdldFBsYXRmb3JtUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0Y29uc3QgcGxhdGZvcm1TZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV07XG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gW3BsYXRmb3JtU2V0dGluZ3MucHJpbWFyeVByb3ZpZGVyLCAuLi5wbGF0Zm9ybVNldHRpbmdzLmZhbGxiYWNrUHJvdmlkZXJzXTtcblx0XHRcblx0XHQvLyBObyByZXN0cmljdGlvbnMgLSBhbGwgdXNlcnMgY2FuIHVzZSBhbGwgcHJvdmlkZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdFx0cmV0dXJuIHByb3ZpZGVycztcblx0fVxuXG5cblx0cHJpdmF0ZSBhc3luYyBnZXRBdmFpbGFibGVQcm92aWRlcigpOiBQcm9taXNlPEFJUHJvdmlkZXIgfCBudWxsPiB7XG5cdFx0Y29uc3Qgb3JkZXJlZFByb3ZpZGVycyA9IHRoaXMuZ2V0UGxhdGZvcm1Qcm92aWRlcnMoKTtcblx0XHRcblx0XHQvLyBJZiBwcmltYXJ5IHByb3ZpZGVyIGlzICdub25lJywgTm92YSBpcyBkaXNhYmxlZCBvbiB0aGlzIHBsYXRmb3JtXG5cdFx0aWYgKG9yZGVyZWRQcm92aWRlcnNbMF0gPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGZvciAoY29uc3QgcHJvdmlkZXJUeXBlIG9mIG9yZGVyZWRQcm92aWRlcnMpIHtcblx0XHRcdGlmIChwcm92aWRlclR5cGUgPT09ICdub25lJykgY29udGludWU7XG5cdFx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHByb3ZpZGVyLmlzQXZhaWxhYmxlKCkpIHtcblx0XHRcdFx0cmV0dXJuIHByb3ZpZGVyO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmdlbmVyYXRlVGV4dChwcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHR5aWVsZCogcHJvdmlkZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlci5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdHlpZWxkKiBwcm92aWRlci5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRQcm92aWRlck5hbWVzKCk6IHN0cmluZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSkubWFwKHAgPT4gcC5uYW1lKTtcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRQcm92aWRlck5hbWUoKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRyZXR1cm4gcHJvdmlkZXIgPyBwcm92aWRlci5uYW1lIDogJ05vbmUnO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHRjb25zdCBvcmRlcmVkUHJvdmlkZXJzID0gdGhpcy5nZXRQbGF0Zm9ybVByb3ZpZGVycygpO1xuXHRcdGlmIChvcmRlcmVkUHJvdmlkZXJzWzBdID09PSAnbm9uZScpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRmb3IgKGNvbnN0IHByb3ZpZGVyVHlwZSBvZiBvcmRlcmVkUHJvdmlkZXJzKSB7XG5cdFx0XHRpZiAocHJvdmlkZXJUeXBlID09PSAnbm9uZScpIGNvbnRpbnVlO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRcdGlmIChwcm92aWRlciAmJiBhd2FpdCBwcm92aWRlci5pc0F2YWlsYWJsZSgpKSB7XG5cdFx0XHRcdHJldHVybiBwcm92aWRlclR5cGU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNvbXBsZXRlKHN5c3RlbVByb21wdCwgdXNlclByb21wdCwgb3B0aW9ucyk7XG5cdH1cblxuXHRnZXRBbGxvd2VkUHJvdmlkZXJzKCk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBPbGxhbWEgcmVxdWlyZXMgbG9jYWwgc2VydmVyIC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGVcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdFx0fVxuXHRcdHJldHVybiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHR9XG5cblx0aXNQcm92aWRlckFsbG93ZWQocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBib29sZWFuIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhbGxvd2VkXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRnZXRQcm92aWRlckxpbWl0cygpOiB7IGxvY2FsOiBudW1iZXI7IGNsb3VkOiBudW1iZXIgfSB7XG5cdFx0Ly8gTm8gbGltaXRzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4geyBsb2NhbDogSW5maW5pdHksIGNsb3VkOiBJbmZpbml0eSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRhc3luYyBnZXRQcm92aWRlck1vZGVscyhwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgUHJvdmlkZXIgJHtwcm92aWRlclR5cGV9IG5vdCBmb3VuZGApO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBnZXRBdmFpbGFibGVNb2RlbHMgbWV0aG9kXG5cdFx0aWYgKCdnZXRBdmFpbGFibGVNb2RlbHMnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5nZXRBdmFpbGFibGVNb2RlbHMgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHJldHVybiBhd2FpdCAocHJvdmlkZXIgYXMgYW55KS5nZXRBdmFpbGFibGVNb2RlbHMoKTtcblx0XHR9XG5cblx0XHQvLyBGb3IgcHJvdmlkZXJzIHdpdGhvdXQgQVBJIG1vZGVsIGxpc3RpbmcgKGxpa2UgT2xsYW1hKSwgcmV0dXJuIGVtcHR5IGFycmF5XG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIG1vZGVsIGNhY2hlIGZvciBhIHNwZWNpZmljIHByb3ZpZGVyXG5cdCAqL1xuXHRjbGVhclByb3ZpZGVyTW9kZWxDYWNoZShwcm92aWRlclR5cGU6IFByb3ZpZGVyVHlwZSk6IHZvaWQge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBjbGVhck1vZGVsQ2FjaGUgbWV0aG9kXG5cdFx0aWYgKCdjbGVhck1vZGVsQ2FjaGUnIGluIHByb3ZpZGVyICYmIHR5cGVvZiBwcm92aWRlci5jbGVhck1vZGVsQ2FjaGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdChwcm92aWRlciBhcyBhbnkpLmNsZWFyTW9kZWxDYWNoZSgpO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKSB7XG5cdFx0dGhpcy5wcm92aWRlcnMuY2xlYXIoKTtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIENsYXVkZVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnQ2xhdWRlIChBbnRocm9waWMpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0Qm9keSA9IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLFxuXHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0cm9sZTogbXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ2Fzc2lzdGFudCcgOiAndXNlcicsXG5cdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHR9KSlcblx0XHR9KTtcblxuXHRcdC8vIFJldHJ5IGxvZ2ljIGZvciA1MDAtbGV2ZWwgZXJyb3JzXG5cdFx0Y29uc3QgbWF4UmV0cmllcyA9IDM7XG5cdFx0Y29uc3QgYmFzZURlbGF5ID0gMTAwMDsgLy8gMSBzZWNvbmRcblxuXHRcdGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcblx0XHRcdFx0XHR1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcblx0XHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0XHRcdCdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Ym9keTogcmVxdWVzdEJvZHlcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb247XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGEuY29udGVudFswXS50ZXh0O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIDUwMC1sZXZlbCBlcnJvciB0aGF0IHdlIHNob3VsZCByZXRyeVxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCAmJiBhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gUmV0cnlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvciBhbGwgb3RoZXIgZXJyb3JzIG9yIGZpbmFsIGF0dGVtcHQsIHRocm93IGVycm9yXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2xhdWRlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtyZXNwb25zZS50ZXh0fWApO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBOZXR3b3JrL2Nvbm5lY3Rpb24gZXJyb3JzIC0gcmV0cnkgaWYgbm90IGZpbmFsIGF0dGVtcHRcblx0XHRcdFx0aWYgKGF0dGVtcHQgPCBtYXhSZXRyaWVzICYmIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgKFxuXHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ05ldHdvcmsgZXJyb3InKSB8fCBcblx0XHRcdFx0XHRlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdGYWlsZWQgdG8gY29ubmVjdCcpXG5cdFx0XHRcdCkpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZS10aHJvdyB0aGUgZXJyb3IgaWYgaXQncyB0aGUgZmluYWwgYXR0ZW1wdCBvciBub3QgYSByZXRyeWFibGUgZXJyb3Jcblx0XHRcdFx0aWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5zdGFydHNXaXRoKCdDbGF1ZGUgQVBJIGVycm9yOicpKSB7XG5cdFx0XHRcdFx0dGhyb3cgZXJyb3I7IC8vIEFscmVhZHkgZm9ybWF0dGVkIGVycm9yXG5cdFx0XHRcdH1cblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBDbGF1ZGUgQVBJOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ05ldHdvcmsgZXJyb3InfWApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWQsIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIGl0XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJOiBNYXhpbXVtIHJldHJpZXMgZXhjZWVkZWQnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdC8vIEZvciBub3csIGZhbGwgYmFjayB0byBub24tc3RyZWFtaW5nIGZvciBDbGF1ZGUgZHVlIHRvIENPUlMgbGltaXRhdGlvbnNcblx0XHQvLyByZXF1ZXN0VXJsIGRvZXNuJ3Qgc3VwcG9ydCBzdHJlYW1pbmcsIHNvIHdlJ2xsIGdldCB0aGUgZnVsbCByZXNwb25zZSBhdCBvbmNlXG5cdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdFx0eWllbGQgeyBjb250ZW50OiByZXN1bHQsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gQ2xhdWRlIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHQvLyBGb3IgQ2xhdWRlLCB3ZSdsbCB1c2UgYSBoYXJkY29kZWQgbGlzdCBzaW5jZSBBbnRocm9waWMgZG9lc24ndCBwcm92aWRlIGEgbW9kZWxzIGVuZHBvaW50XG5cdFx0Ly8gQnV0IHdlIGNhbiB2YWxpZGF0ZSB0aGUgQVBJIGtleSBieSBtYWtpbmcgYSB0ZXN0IGNhbGxcblx0XHR0cnkge1xuXHRcdFx0Ly8gVmFsaWRhdGUgQVBJIGtleSB3aXRoIGEgbWluaW1hbCByZXF1ZXN0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0XHR1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcblx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdCd4LWFwaS1rZXknOiB0aGlzLmNvbmZpZy5hcGlLZXksXG5cdFx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0XHRtb2RlbDogJ2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0Jyxcblx0XHRcdFx0XHRtYXhfdG9rZW5zOiAxLFxuXHRcdFx0XHRcdG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICd0ZXN0JyB9XVxuXHRcdFx0XHR9KVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSBrZXkgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7cmVzcG9uc2UudGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmV0dXJuIGN1cnJlbnQgYXZhaWxhYmxlIG1vZGVscyAoZnJvbSBBUEkgZG9jcylcblx0XHRcdGNvbnN0IG1vZGVscyA9IFtcblx0XHRcdFx0J2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnLFxuXHRcdFx0XHQnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0Jyxcblx0XHRcdFx0J2NsYXVkZS0zLTctc29ubmV0LWxhdGVzdCcsXG5cdFx0XHRcdCdjbGF1ZGUtMy01LXNvbm5ldC1sYXRlc3QnLFxuXHRcdFx0XHQnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIENsYXVkZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9wZW5BSVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT3BlbkFJJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9jaGF0L2NvbXBsZXRpb25zJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2A7XG5cdFx0XG5cdFx0Y29uc3QgcmVxdWVzdEJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjdcblx0XHR9KTtcblxuXHRcdC8vIFJldHJ5IGxvZ2ljIGZvciA1MDAtbGV2ZWwgZXJyb3JzXG5cdFx0Y29uc3QgbWF4UmV0cmllcyA9IDM7XG5cdFx0Y29uc3QgYmFzZURlbGF5ID0gMTAwMDsgLy8gMSBzZWNvbmRcblxuXHRcdGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Ym9keTogcmVxdWVzdEJvZHlcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLm9rKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSA1MDAtbGV2ZWwgZXJyb3IgdGhhdCB3ZSBzaG91bGQgcmV0cnlcblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA+PSA1MDAgJiYgYXR0ZW1wdCA8IG1heFJldHJpZXMpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpOyAvLyBFeHBvbmVudGlhbCBiYWNrb2ZmXG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG5cdFx0XHRcdFx0Y29udGludWU7IC8vIFJldHJ5XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBGb3IgYWxsIG90aGVyIGVycm9ycyBvciBmaW5hbCBhdHRlbXB0LCB0aHJvdyBlcnJvclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gTmV0d29yayBlcnJvcnMgLSByZXRyeSBpZiBub3QgZmluYWwgYXR0ZW1wdFxuXHRcdFx0XHRpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMgJiYgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdmZXRjaCcpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTtcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gUmUtdGhyb3cgdGhlIGVycm9yIGlmIGl0J3MgdGhlIGZpbmFsIGF0dGVtcHQgb3Igbm90IGEgbmV0d29yayBlcnJvclxuXHRcdFx0XHR0aHJvdyBlcnJvcjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBUaGlzIHNob3VsZCBuZXZlciBiZSByZWFjaGVkLCBidXQgVHlwZVNjcmlwdCB3YW50cyBpdFxuXHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSTogTWF4aW11bSByZXRyaWVzIGV4Y2VlZGVkJyk7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW1xuXHRcdFx0eyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG5cdFx0XHR7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XG5cdFx0XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlcXVlc3RNZXNzYWdlcyA9IFsuLi5tZXNzYWdlc107XG5cdFx0aWYgKG9wdGlvbnM/LnN5c3RlbVByb21wdCkge1xuXHRcdFx0cmVxdWVzdE1lc3NhZ2VzLnVuc2hpZnQoeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogb3B0aW9ucy5zeXN0ZW1Qcm9tcHQgfSk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdGNvbnN0IGVuZHBvaW50ID0gYmFzZVVybC5lbmRzV2l0aCgnL2NoYXQvY29tcGxldGlvbnMnKSA/IGJhc2VVcmwgOiBgJHtiYXNlVXJsfS9jaGF0L2NvbXBsZXRpb25zYDtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnZ3B0LTMuNS10dXJibycsXG5cdFx0XHRcdG1lc3NhZ2VzOiByZXF1ZXN0TWVzc2FnZXMsXG5cdFx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMCxcblx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0c3RyZWFtOiB0cnVlXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2RhdGE6ICcpKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBkYXRhID0gbGluZS5zbGljZSg2KTtcblx0XHRcdFx0XHRcdGlmIChkYXRhID09PSAnW0RPTkVdJykge1xuXHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IHBhcnNlZC5jaG9pY2VzPy5bMF0/LmRlbHRhPy5jb250ZW50O1xuXHRcdFx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudCwgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gT3BlbkFJIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvbW9kZWxzJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vbW9kZWxzYDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ3B0LTQuMS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbWluaS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbmFuby0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00bycsXG5cdFx0XHRcdCdncHQtNG8tbWluaSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggT3BlbkFJIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgR29vZ2xlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdHb29nbGUgKEdlbWluaSknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgc3lzdGVtUHJvbXB0Pzogc3RyaW5nKTogYW55IHtcblx0XHRjb25zdCBjb250ZW50cyA9IFtdO1xuXHRcdFxuXHRcdGlmIChzeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlOiAndXNlcicsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBgU3lzdGVtOiAke3N5c3RlbVByb21wdH1gIH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgbWVzc2FnZXMpIHtcblx0XHRcdGNvbnN0IHJvbGUgPSBtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ21vZGVsJyA6ICd1c2VyJztcblx0XHRcdGNvbnRlbnRzLnB1c2goe1xuXHRcdFx0XHRyb2xlLFxuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogbWVzc2FnZS5jb250ZW50IH1dXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29udGVudHM7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdHb29nbGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS1wcm8nO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMsIG9wdGlvbnM/LnN5c3RlbVByb21wdCksXG5cdFx0XHRcdGdlbmVyYXRpb25Db25maWc6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktcHJvJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpzdHJlYW1HZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdGNvbnRlbnRzOiB0aGlzLmZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzLCBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRidWZmZXIgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsgc3RyZWFtOiB0cnVlIH0pO1xuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGJ1ZmZlci5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGJ1ZmZlciA9IGxpbmVzLnBvcCgpIHx8ICcnO1xuXG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGV4dCA9IHBhcnNlZC5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XG5cdFx0XHRcdFx0XHRcdGlmICh0ZXh0KSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiB0ZXh0LCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBHb29nbGUgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscz9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA0LTE3Jyxcblx0XHRcdFx0J2dlbWluaS0yLjUtcHJvLXByZXZpZXctMDMtMjUnLFxuXHRcdFx0XHQnZ2VtaW5pLTIuMC1mbGFzaCcsXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoLWxpdGUnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIEdvb2dsZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9sbGFtYVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT2xsYW1hIChMb2NhbCknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdGlmICghdGhpcy5jb25maWcubW9kZWwpIHJldHVybiBmYWxzZTsgLy8gUmVxdWlyZSBtb2RlbCB0byBiZSBzZXRcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvdGFnc2AsIHtcblx0XHRcdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHJlc3BvbnNlLm9rO1xuXHRcdH0gY2F0Y2gge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IGZhbHNlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLnJlc3BvbnNlO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLnJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBwYXJzZWQucmVzcG9uc2UsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5tZXNzYWdlLmNvbnRlbnQ7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW1xuXHRcdFx0eyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG5cdFx0XHR7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XG5cdFx0XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2NoYXRgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0XHRyb2xlOiBtc2cucm9sZSxcblx0XHRcdFx0XHRjb250ZW50OiBtc2cuY29udGVudFxuXHRcdFx0XHR9KSksXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLm1lc3NhZ2U/LmNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IHBhcnNlZC5tZXNzYWdlLmNvbnRlbnQsIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxufSIsICIvKipcbiAqIENvcmUgZG9jdW1lbnQgZW5naW5lIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFsbCBkb2N1bWVudCBtYW5pcHVsYXRpb24gYW5kIGVkaXRvciBpbnRlcmFjdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBURmlsZSwgRWRpdG9yUG9zaXRpb24sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50Q29udGV4dCwgSGVhZGluZ0luZm8sIEVkaXRSZXN1bHQsIEVkaXRPcHRpb25zLCBEb2N1bWVudFNlY3Rpb24sIEVkaXRDb21tYW5kIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyLCBEYXRhU3RvcmUgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIERvY3VtZW50RW5naW5lIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIGRhdGFTdG9yZT86IERhdGFTdG9yZSkge1xuICAgICAgICBpZiAoZGF0YVN0b3JlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb24pXG4gICAgICovXG4gICAgc2V0Q29udmVyc2F0aW9uTWFuYWdlcihjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IGNvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZWRpdG9yIGluc3RhbmNlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRWRpdG9yKCk6IEVkaXRvciB8IG51bGwge1xuICAgICAgICAvLyBGaXJzdCB0cnkgdGhlIHdvcmtzcGFjZSBtZXRob2RcbiAgICAgICAgY29uc3QgYWN0aXZlRWRpdG9yID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUVkaXRvcjtcbiAgICAgICAgaWYgKGFjdGl2ZUVkaXRvcj8uZWRpdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aXZlRWRpdG9yLmVkaXRvcjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIGdldCB0aGUgYWN0aXZlIG1hcmtkb3duIHZpZXdcbiAgICAgICAgbGV0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBcbiAgICAgICAgLy8gSWYgbm8gYWN0aXZlIG1hcmtkb3duIHZpZXcsIHRyeSB0byBmaW5kIGFueSBtYXJrZG93biB2aWV3XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZWFmVmlldyA9IGxlYWYudmlldztcbiAgICAgICAgICAgICAgICBpZiAobGVhZlZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldyA9IGxlYWZWaWV3O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSBkaWZmZXJlbnQgd2F5cyB0byBnZXQgdGhlIGVkaXRvclxuICAgICAgICBjb25zdCBlZGl0b3IgPSB2aWV3LmVkaXRvcjtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IgfHwgbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGl2ZSBmaWxlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRmlsZSgpOiBURmlsZSB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgZ2V0U2VsZWN0ZWRUZXh0KCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBnZXRDdXJzb3JQb3NpdGlvbigpOiBFZGl0b3JQb3NpdGlvbiB8IG51bGwge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY29tcHJlaGVuc2l2ZSBkb2N1bWVudCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KCk6IFByb21pc2U8RG9jdW1lbnRDb250ZXh0IHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIWVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHRoaXMuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5nZXRDdXJzb3JQb3NpdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBoZWFkaW5ncyBmcm9tIHRoZSBkb2N1bWVudFxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZXh0cmFjdEhlYWRpbmdzKGNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHN1cnJvdW5kaW5nIGxpbmVzIGZvciBjb250ZXh0XG4gICAgICAgIGNvbnN0IHN1cnJvdW5kaW5nTGluZXMgPSBjdXJzb3JQb3NpdGlvbiA/IFxuICAgICAgICAgICAgdGhpcy5nZXRTdXJyb3VuZGluZ0xpbmVzKGNvbnRlbnQsIGN1cnNvclBvc2l0aW9uLmxpbmUpIDogXG4gICAgICAgICAgICB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICBoZWFkaW5ncyxcbiAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogc2VsZWN0ZWRUZXh0IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGN1cnNvclBvc2l0aW9uOiBjdXJzb3JQb3NpdGlvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBzdXJyb3VuZGluZ0xpbmVzXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBoZWFkaW5ncyBmcm9tIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RIZWFkaW5ncyhjb250ZW50OiBzdHJpbmcpOiBIZWFkaW5nSW5mb1tdIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IEhlYWRpbmdJbmZvW10gPSBbXTtcbiAgICAgICAgbGV0IGNoYXJDb3VudCA9IDA7XG5cbiAgICAgICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgaWYgKGhlYWRpbmdNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gaGVhZGluZ01hdGNoWzFdLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gaGVhZGluZ01hdGNoWzJdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGhlYWRpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LFxuICAgICAgICAgICAgICAgICAgICBsZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogY2hhckNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBjaGFyQ291bnQgKyBsaW5lLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBsaW5lIGxlbmd0aCArIG5ld2xpbmUgY2hhcmFjdGVyXG4gICAgICAgICAgICBjaGFyQ291bnQgKz0gbGluZS5sZW5ndGggKyAxO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaGVhZGluZ3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGxpbmVzIHN1cnJvdW5kaW5nIHRoZSBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFN1cnJvdW5kaW5nTGluZXMoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGN1cnJlbnRMaW5lOiBudW1iZXIsIFxuICAgICAgICBjb250ZXh0U2l6ZTogbnVtYmVyID0gNVxuICAgICk6IHsgYmVmb3JlOiBzdHJpbmdbXTsgYWZ0ZXI6IHN0cmluZ1tdIH0ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3RhcnRMaW5lID0gTWF0aC5tYXgoMCwgY3VycmVudExpbmUgLSBjb250ZXh0U2l6ZSk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBjdXJyZW50TGluZSArIGNvbnRleHRTaXplKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBiZWZvcmU6IGxpbmVzLnNsaWNlKHN0YXJ0TGluZSwgY3VycmVudExpbmUpLFxuICAgICAgICAgICAgYWZ0ZXI6IGxpbmVzLnNsaWNlKGN1cnJlbnRMaW5lICsgMSwgZW5kTGluZSArIDEpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgYW4gZWRpdCB0byB0aGUgZG9jdW1lbnRcbiAgICAgKi9cbiAgICBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcG9zaXRpb246ICdjdXJzb3InIHwgJ3NlbGVjdGlvbicgfCAnZW5kJyB8IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0sXG4gICAgICAgIG9wdGlvbnM6IEVkaXRPcHRpb25zID0ge31cbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgYXBwbGllZEF0OiBFZGl0b3JQb3NpdGlvbjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnY3Vyc29yJykge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihjb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lID0gZWRpdG9yLmxhc3RMaW5lKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmVMZW5ndGggPSBlZGl0b3IuZ2V0TGluZShsYXN0TGluZSkubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGN1cnJlbnRDb250ZW50ICsgKGN1cnJlbnRDb250ZW50LmVuZHNXaXRoKCdcXG4nKSA/ICcnIDogJ1xcbicpICsgY29udGVudDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVc2UgdmF1bHQubW9kaWZ5IGZvciB1bmRvL3JlZG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IHNwZWNpZmljIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gcG9zaXRpb247XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBIYW5kbGUgcG9zdC1lZGl0IG9wdGlvbnNcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNlbGVjdE5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGFwcGxpZWRBdC5saW5lICsgY29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgY2g6IGNvbnRlbnQuaW5jbHVkZXMoJ1xcbicpID8gXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnNwbGl0KCdcXG4nKS5wb3AoKSEubGVuZ3RoIDogXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQuY2ggKyBjb250ZW50Lmxlbmd0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihhcHBsaWVkQXQsIGVuZFBvcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNjcm9sbFRvRWRpdCkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IGFwcGxpZWRBdCxcbiAgICAgICAgICAgICAgICAgICAgdG86IGFwcGxpZWRBdFxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogcG9zaXRpb24gPT09ICdzZWxlY3Rpb24nID8gJ3JlcGxhY2UnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPT09ICdlbmQnID8gJ2FwcGVuZCcgOiAnaW5zZXJ0JyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBjb250ZW50IGF0IGEgc3BlY2lmaWMgbG9jYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBkZWxldGVDb250ZW50KFxuICAgICAgICB0YXJnZXQ6ICdzZWxlY3Rpb24nIHwgJ2xpbmUnIHwgJ3NlY3Rpb24nLFxuICAgICAgICBsb2NhdGlvbj86IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJ2xpbmUnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBjdXJzb3IubGluZTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lLCBjaDogMCB9LCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBsaW5lICsgMSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJ3NlY3Rpb24nICYmIGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZmluZFNlY3Rpb24obG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIGlmICghc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2xvY2F0aW9ufVwiIG5vdCBmb3VuZGAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBzZWN0aW9uIGluY2x1ZGluZyBpdHMgaGVhZGluZ1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmVzID0gbGluZXMuZmlsdGVyKChfLCBpbmRleCkgPT4gXG4gICAgICAgICAgICAgICAgICAgIGluZGV4IDwgc2VjdGlvbi5yYW5nZS5zdGFydCB8fCBpbmRleCA+IHNlY3Rpb24ucmFuZ2UuZW5kXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3TGluZXMuam9pbignXFxuJykpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmU6IHNlY3Rpb24ucmFuZ2Uuc3RhcnQsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGhpZXJhcmNoaWNhbCBwYXRoIGZvciBhIGhlYWRpbmdcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkU2VjdGlvblBhdGgoaGVhZGluZ3M6IEhlYWRpbmdJbmZvW10sIHRhcmdldEluZGV4OiBudW1iZXIpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBoZWFkaW5nc1t0YXJnZXRJbmRleF07XG4gICAgICAgIGNvbnN0IHBhdGg6IHN0cmluZ1tdID0gW3RhcmdldC50ZXh0XTtcbiAgICAgICAgXG4gICAgICAgIC8vIFdhbGsgYmFja3dhcmRzIHRvIGZpbmQgcGFyZW50IGhlYWRpbmdzXG4gICAgICAgIGZvciAobGV0IGkgPSB0YXJnZXRJbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gaGVhZGluZ3NbaV07XG4gICAgICAgICAgICBpZiAoaGVhZGluZy5sZXZlbCA8IHRhcmdldC5sZXZlbCkge1xuICAgICAgICAgICAgICAgIHBhdGgudW5zaGlmdChoZWFkaW5nLnRleHQpO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpbW1lZGlhdGUgcGFyZW50IGZvciBub3cgKHNpbmdsZSBsZXZlbCB1cClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhdGguam9pbignOjonKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc2VjdGlvbiBieSBoZWFkaW5nIG5hbWUgKHN1cHBvcnRzIGhpZXJhcmNoaWNhbCBwYXRocyB3aXRoIDo6IG9yIC8pXG4gICAgICovXG4gICAgYXN5bmMgZmluZFNlY3Rpb24oaGVhZGluZ1RleHQ6IHN0cmluZyk6IFByb21pc2U8RG9jdW1lbnRTZWN0aW9uIHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFjb250ZXh0KSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBub3JtYWxpemVkVGFyZ2V0ID0gaGVhZGluZ1RleHQudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgaGllcmFyY2hpY2FsIHBhdGggKGNvbnRhaW5zIDo6IG9yIC8pXG4gICAgICAgIGlmIChub3JtYWxpemVkVGFyZ2V0LmluY2x1ZGVzKCc6OicpIHx8IG5vcm1hbGl6ZWRUYXJnZXQuaW5jbHVkZXMoJy8nKSkge1xuICAgICAgICAgICAgLy8gTm9ybWFsaXplIHBhdGggc2VwYXJhdG9ycyB0byBjb21wYXJlIGJvdGggZm9ybWF0c1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0UGF0aCA9IG5vcm1hbGl6ZWRUYXJnZXQucmVwbGFjZSgvOjovZywgJy8nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmluZCBoZWFkaW5ncyB0aGF0IG1hdGNoIHRoZSBoaWVyYXJjaGljYWwgcGF0aFxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZXh0LmhlYWRpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGluZyA9IGNvbnRleHQuaGVhZGluZ3NbaV07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVHJ5IGJvdGggb2xkIGZvcm1hdCAoOjopIGFuZCBuZXcgZm9ybWF0ICgvKVxuICAgICAgICAgICAgICAgIGNvbnN0IGxlZ2FjeVBhdGggPSB0aGlzLmJ1aWxkU2VjdGlvblBhdGgoY29udGV4dC5oZWFkaW5ncywgaSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdQYXRoID0gdGhpcy5idWlsZEZ1bGxTZWN0aW9uUGF0aChjb250ZXh0LmhlYWRpbmdzLCBpKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChsZWdhY3lQYXRoID09PSBub3JtYWxpemVkVGFyZ2V0IHx8IG5ld1BhdGggPT09IHRhcmdldFBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGREb2N1bWVudFNlY3Rpb24oaGVhZGluZywgY29udGV4dC5oZWFkaW5ncywgaSwgY29udGV4dC5jb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gU2ltcGxlIHNlY3Rpb24gbmFtZSAtIGZpbmQgZmlyc3QgbWF0Y2ggKGJhY2t3YXJkcyBjb21wYXRpYmxlKVxuICAgICAgICAgICAgY29uc3QgaGVhZGluZ0luZGV4ID0gY29udGV4dC5oZWFkaW5ncy5maW5kSW5kZXgoaCA9PiBcbiAgICAgICAgICAgICAgICBoLnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhub3JtYWxpemVkVGFyZ2V0KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKGhlYWRpbmdJbmRleCA9PT0gLTEpIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gY29udGV4dC5oZWFkaW5nc1toZWFkaW5nSW5kZXhdO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGREb2N1bWVudFNlY3Rpb24oaGVhZGluZywgY29udGV4dC5oZWFkaW5ncywgaGVhZGluZ0luZGV4LCBjb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgRG9jdW1lbnRTZWN0aW9uIG9iamVjdCBmcm9tIGhlYWRpbmcgaW5mb1xuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGREb2N1bWVudFNlY3Rpb24oXG4gICAgICAgIGhlYWRpbmc6IEhlYWRpbmdJbmZvLCBcbiAgICAgICAgYWxsSGVhZGluZ3M6IEhlYWRpbmdJbmZvW10sIFxuICAgICAgICBoZWFkaW5nSW5kZXg6IG51bWJlciwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IERvY3VtZW50U2VjdGlvbiB7XG4gICAgICAgIGNvbnN0IG5leHRIZWFkaW5nID0gYWxsSGVhZGluZ3NbaGVhZGluZ0luZGV4ICsgMV07XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBuZXh0SGVhZGluZyA/IG5leHRIZWFkaW5nLmxpbmUgLSAxIDogbGluZXMubGVuZ3RoIC0gMTtcblxuICAgICAgICAvLyBFeHRyYWN0IHNlY3Rpb24gY29udGVudCAoZXhjbHVkaW5nIHRoZSBoZWFkaW5nIGxpbmUpXG4gICAgICAgIGNvbnN0IHNlY3Rpb25MaW5lcyA9IGxpbmVzLnNsaWNlKGhlYWRpbmcubGluZSArIDEsIGVuZExpbmUgKyAxKTtcbiAgICAgICAgY29uc3Qgc2VjdGlvbkNvbnRlbnQgPSBzZWN0aW9uTGluZXMuam9pbignXFxuJykudHJpbSgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoZWFkaW5nOiBoZWFkaW5nLnRleHQsXG4gICAgICAgICAgICBsZXZlbDogaGVhZGluZy5sZXZlbCxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHNlY3Rpb25Db250ZW50LFxuICAgICAgICAgICAgcmFuZ2U6IHtcbiAgICAgICAgICAgICAgICBzdGFydDogaGVhZGluZy5saW5lLFxuICAgICAgICAgICAgICAgIGVuZDogZW5kTGluZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZnVsbCBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZW50KCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZW50aXJlIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBzZXREb2N1bWVudENvbnRlbnQoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJzYXRpb24gbWFuYWdlbWVudCBtZXRob2RzXG5cbiAgICAvKipcbiAgICAgKiBBZGQgdXNlciBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgY29tbWFuZD86IEVkaXRDb21tYW5kKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkVXNlck1lc3NhZ2UoZmlsZSwgY29udGVudCwgY29tbWFuZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYXNzaXN0YW50IHJlc3BvbnNlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoY29udGVudDogc3RyaW5nLCByZXN1bHQ/OiBFZGl0UmVzdWx0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShmaWxlLCBjb250ZW50LCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN5c3RlbSBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkU3lzdGVtTWVzc2FnZShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBmb3IgQUkgcHJvbXB0c1xuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbkNvbnRleHQobWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljcyBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uU3RhdHMoKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFN0YXRzKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGN1cnJlbnQgZmlsZSBoYXMgYW4gYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbigpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmhhc0NvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZXhwb3J0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgc2VjdGlvbiBwYXRocyBmb3Igc2VjdGlvbiBwaWNrZXJcbiAgICAgKi9cbiAgICBhc3luYyBnZXRBbGxTZWN0aW9uUGF0aHMoKTogUHJvbWlzZTxBcnJheTx7XG4gICAgICAgIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG4gICAgICAgIHRhcmdldFBhdGg6IHN0cmluZztcbiAgICAgICAgaGVhZGluZ1RleHQ6IHN0cmluZztcbiAgICAgICAgbGV2ZWw6IG51bWJlcjtcbiAgICAgICAgbGluZTogbnVtYmVyO1xuICAgICAgICBwcmV2aWV3Pzogc3RyaW5nO1xuICAgIH0+PiB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWNvbnRleHQpIHJldHVybiBbXTtcblxuICAgICAgICByZXR1cm4gY29udGV4dC5oZWFkaW5ncy5tYXAoKGhlYWRpbmcsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAvLyBCdWlsZCBmdWxsIGhpZXJhcmNoaWNhbCBwYXRoXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRQYXRoID0gdGhpcy5idWlsZEZ1bGxTZWN0aW9uUGF0aChjb250ZXh0LmhlYWRpbmdzLCBpbmRleCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBpbmRlbnRlZCBkaXNwbGF5IG5hbWVcbiAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gdGhpcy5jcmVhdGVEaXNwbGF5TmFtZShoZWFkaW5nLnRleHQsIGhlYWRpbmcubGV2ZWwpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgY29udGVudCBwcmV2aWV3XG4gICAgICAgICAgICBjb25zdCBwcmV2aWV3ID0gdGhpcy5nZXRTZWN0aW9uUHJldmlldyhjb250ZXh0LmhlYWRpbmdzLCBpbmRleCwgY29udGV4dC5jb250ZW50KTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZSxcbiAgICAgICAgICAgICAgICB0YXJnZXRQYXRoLFxuICAgICAgICAgICAgICAgIGhlYWRpbmdUZXh0OiBoZWFkaW5nLnRleHQsXG4gICAgICAgICAgICAgICAgbGV2ZWw6IGhlYWRpbmcubGV2ZWwsXG4gICAgICAgICAgICAgICAgbGluZTogaGVhZGluZy5saW5lLFxuICAgICAgICAgICAgICAgIHByZXZpZXdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGZ1bGwgaGllcmFyY2hpY2FsIHBhdGggaW5jbHVkaW5nIGFsbCBwYXJlbnRzXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZEZ1bGxTZWN0aW9uUGF0aChoZWFkaW5nczogSGVhZGluZ0luZm9bXSwgdGFyZ2V0SW5kZXg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGhlYWRpbmdzW3RhcmdldEluZGV4XTtcbiAgICAgICAgY29uc3QgcGF0aDogc3RyaW5nW10gPSBbdGFyZ2V0LnRleHRdO1xuICAgICAgICBcbiAgICAgICAgLy8gV2FsayBiYWNrd2FyZHMgdG8gZmluZCBhbGwgcGFyZW50IGhlYWRpbmdzXG4gICAgICAgIGxldCBjdXJyZW50TGV2ZWwgPSB0YXJnZXQubGV2ZWw7XG4gICAgICAgIGZvciAobGV0IGkgPSB0YXJnZXRJbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gaGVhZGluZ3NbaV07XG4gICAgICAgICAgICAvLyBPbmx5IGFkZCBoZWFkaW5nIGlmIGl0J3MgYSBwYXJlbnQgKGxvd2VyIGxldmVsIG51bWJlciA9IGhpZ2hlciBoaWVyYXJjaHkpXG4gICAgICAgICAgICBpZiAoaGVhZGluZy5sZXZlbCA8IGN1cnJlbnRMZXZlbCkge1xuICAgICAgICAgICAgICAgIHBhdGgudW5zaGlmdChoZWFkaW5nLnRleHQpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRMZXZlbCA9IGhlYWRpbmcubGV2ZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBwYXRoLmpvaW4oJy8nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgaW5kZW50ZWQgZGlzcGxheSBuYW1lIGZvciBoaWVyYXJjaGljYWwgdmlld1xuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlRGlzcGxheU5hbWUodGV4dDogc3RyaW5nLCBsZXZlbDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoTWF0aC5tYXgoMCwgbGV2ZWwgLSAxKSk7XG4gICAgICAgIGNvbnN0IGljb24gPSBsZXZlbCA9PT0gMSA/ICdcdUQ4M0RcdURDQzQgJyA6ICcnO1xuICAgICAgICByZXR1cm4gYCR7aW5kZW50fSR7aWNvbn0ke3RleHR9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc2VjdGlvbiBjb250ZW50IHByZXZpZXdcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFNlY3Rpb25QcmV2aWV3KGhlYWRpbmdzOiBIZWFkaW5nSW5mb1tdLCBoZWFkaW5nSW5kZXg6IG51bWJlciwgY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgaGVhZGluZyA9IGhlYWRpbmdzW2hlYWRpbmdJbmRleF07XG4gICAgICAgIGNvbnN0IG5leHRIZWFkaW5nID0gaGVhZGluZ3NbaGVhZGluZ0luZGV4ICsgMV07XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZmlyc3QgZmV3IGxpbmVzIG9mIHNlY3Rpb24gY29udGVudCAoZXhjbHVkaW5nIGhlYWRpbmcpXG4gICAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IGhlYWRpbmcubGluZSArIDE7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBuZXh0SGVhZGluZyA/IE1hdGgubWluKG5leHRIZWFkaW5nLmxpbmUsIHN0YXJ0TGluZSArIDMpIDogTWF0aC5taW4obGluZXMubGVuZ3RoLCBzdGFydExpbmUgKyAzKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHNlY3Rpb25MaW5lcyA9IGxpbmVzLnNsaWNlKHN0YXJ0TGluZSwgZW5kTGluZSlcbiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKS5sZW5ndGggPiAwKVxuICAgICAgICAgICAgLnNsaWNlKDAsIDIpOyAvLyBNYXggMiBsaW5lc1xuICAgICAgICBcbiAgICAgICAgaWYgKHNlY3Rpb25MaW5lcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAnRW1wdHkgc2VjdGlvbic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHByZXZpZXcgPSBzZWN0aW9uTGluZXMuam9pbignICcpLnN1YnN0cmluZygwLCAxMDApO1xuICAgICAgICByZXR1cm4gcHJldmlldy5sZW5ndGggPiA5NyA/IHByZXZpZXcgKyAnLi4uJyA6IHByZXZpZXc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5oYW5jZWQgc2VjdGlvbiBmaW5kaW5nIHdpdGggYmV0dGVyIHBhdGggc3VwcG9ydFxuICAgICAqL1xuICAgIGFzeW5jIGZpbmRTZWN0aW9uQnlQYXRoKHNlY3Rpb25QYXRoOiBzdHJpbmcpOiBQcm9taXNlPERvY3VtZW50U2VjdGlvbiB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghY29udGV4dCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSBzZWN0aW9uUGF0aC50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBmaW5kIGJ5IGZ1bGwgcGF0aCBmaXJzdFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRleHQuaGVhZGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gdGhpcy5idWlsZEZ1bGxTZWN0aW9uUGF0aChjb250ZXh0LmhlYWRpbmdzLCBpKTtcbiAgICAgICAgICAgIGlmIChmdWxsUGF0aC50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkUGF0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkRG9jdW1lbnRTZWN0aW9uKGNvbnRleHQuaGVhZGluZ3NbaV0sIGNvbnRleHQuaGVhZGluZ3MsIGksIGNvbnRleHQuY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIHNpbXBsZSB0ZXh0IG1hdGNoaW5nXG4gICAgICAgIGNvbnN0IGhlYWRpbmdJbmRleCA9IGNvbnRleHQuaGVhZGluZ3MuZmluZEluZGV4KGggPT4gXG4gICAgICAgICAgICBoLnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhub3JtYWxpemVkUGF0aClcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoaGVhZGluZ0luZGV4ID09PSAtMSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgaGVhZGluZyA9IGNvbnRleHQuaGVhZGluZ3NbaGVhZGluZ0luZGV4XTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGREb2N1bWVudFNlY3Rpb24oaGVhZGluZywgY29udGV4dC5oZWFkaW5ncywgaGVhZGluZ0luZGV4LCBjb250ZXh0LmNvbnRlbnQpO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlciBmb3IgTm92YVxuICogSGFuZGxlcyBmaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gc3RvcmFnZSBhbmQgcmV0cmlldmFsXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhLCBDb252ZXJzYXRpb25NZXNzYWdlLCBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRWRpdEFjdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTdG9yZSB7XG4gICAgbG9hZERhdGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gICAgc2F2ZURhdGEoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbnM6IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbkRhdGE+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgbWF4TWVzc2FnZXNQZXJGaWxlID0gMTAwOyAvLyBMaW1pdCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgIHByaXZhdGUgc3RvcmFnZUtleSA9ICdub3ZhLWNvbnZlcnNhdGlvbnMnO1xuICAgIHByaXZhdGUgY2xlYW51cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZGF0YVN0b3JlOiBEYXRhU3RvcmUpIHtcbiAgICAgICAgdGhpcy5sb2FkQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBjb252ZXJzYXRpb25zIGZyb20gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZGF0YVN0b3JlLmxvYWREYXRhKHRoaXMuc3RvcmFnZUtleSk7XG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb252ZXJzYXRpb24gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGNvbnZlcnNhdGlvbi5maWxlUGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gbG9hZCBjb252ZXJzYXRpb24gZGF0YSAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIGNvbnZlcnNhdGlvbnMgdG8gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uc0FycmF5ID0gQXJyYXkuZnJvbSh0aGlzLmNvbnZlcnNhdGlvbnMudmFsdWVzKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kYXRhU3RvcmUuc2F2ZURhdGEodGhpcy5zdG9yYWdlS2V5LCBjb252ZXJzYXRpb25zQXJyYXkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHNhdmUgY29udmVyc2F0aW9uIGRhdGEgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBmb3IgYSBzcGVjaWZpYyBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogQ29udmVyc2F0aW9uRGF0YSB7XG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbnMuaGFzKGZpbGVQYXRoKSkge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBjb252ZXJzYXRpb24gZm9yIHRoaXMgZmlsZVxuICAgICAgICAgICAgY29uc3QgbmV3Q29udmVyc2F0aW9uOiBDb252ZXJzYXRpb25EYXRhID0ge1xuICAgICAgICAgICAgICAgIGZpbGVQYXRoLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgICAgICAgICBsYXN0VXBkYXRlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBlZGl0Q291bnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRGcmVxdWVuY3k6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV3cml0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChmaWxlUGF0aCwgbmV3Q29udmVyc2F0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGVQYXRoKSE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgdXNlciBtZXNzYWdlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRVc2VyTWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsIFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjb21tYW5kPzogRWRpdENvbW1hbmRcbiAgICApOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjb21tYW5kXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmQgZnJlcXVlbmN5IGlmIGNvbW1hbmQgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeVtjb21tYW5kLmFjdGlvbl0rKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFuIGFzc2lzdGFudCByZXNwb25zZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcmVzdWx0PzogRWRpdFJlc3VsdFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gSW5jcmVtZW50IGVkaXQgY291bnQgaWYgcmVzdWx0IGluZGljYXRlcyBzdWNjZXNzZnVsIGVkaXRcbiAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcyAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgc3lzdGVtIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoZmlsZTogVEZpbGUsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmVjZW50IG1lc3NhZ2VzIGZvciBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0UmVjZW50TWVzc2FnZXMoZmlsZTogVEZpbGUsIGNvdW50OiBudW1iZXIgPSAxMCk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uLm1lc3NhZ2VzLnNsaWNlKC1jb3VudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG1lc3NhZ2VzIGJ5IHJvbGVcbiAgICAgKi9cbiAgICBnZXRNZXNzYWdlc0J5Um9sZShmaWxlOiBURmlsZSwgcm9sZTogQ29udmVyc2F0aW9uTWVzc2FnZVsncm9sZSddKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cucm9sZSA9PT0gcm9sZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlOiBURmlsZSwgbWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgbWF4TWVzc2FnZXMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dExpbmVzID0gbWVzc2FnZXMubWFwKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZShtc2cudGltZXN0YW1wKS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcbiAgICAgICAgICAgIGxldCBsaW5lID0gYFske3RpbWVzdGFtcH1dICR7bXNnLnJvbGUudG9VcHBlckNhc2UoKX06ICR7bXNnLmNvbnRlbnR9YDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChDb21tYW5kOiAke21zZy5jb21tYW5kLmFjdGlvbn0gJHttc2cuY29tbWFuZC50YXJnZXR9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtc2cucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChSZXN1bHQ6ICR7bXNnLnJlc3VsdC5zdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2ZhaWxlZCd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYFByZXZpb3VzIGNvbnZlcnNhdGlvbjpcXG4ke2NvbnRleHRMaW5lcy5qb2luKCdcXG4nKX1cXG5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IFtdO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmVkaXRDb3VudCA9IDA7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeSA9IHtcbiAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICBkZWxldGU6IDAsXG4gICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICByZXdyaXRlOiAwLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gc3RhdGlzdGljc1xuICAgICAqL1xuICAgIGdldFN0YXRzKGZpbGU6IFRGaWxlKToge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgICAgICAgZWRpdENvdW50OiBudW1iZXI7XG4gICAgICAgIG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGw7XG4gICAgICAgIGNvbnZlcnNhdGlvbkFnZTogbnVtYmVyO1xuICAgIH0ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBtb3N0VXNlZENvbW1hbmQ6IEVkaXRBY3Rpb24gfCBudWxsID0gbnVsbDtcbiAgICAgICAgbGV0IG1heENvdW50ID0gMDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2FjdGlvbiwgY291bnRdIG9mIE9iamVjdC5lbnRyaWVzKGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5KSkge1xuICAgICAgICAgICAgICAgIGlmIChjb3VudCA+IG1heENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIG1heENvdW50ID0gY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCA9IGFjdGlvbiBhcyBFZGl0QWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkFnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwIFxuICAgICAgICAgICAgPyBEYXRlLm5vdygpIC0gY29udmVyc2F0aW9uLm1lc3NhZ2VzWzBdLnRpbWVzdGFtcFxuICAgICAgICAgICAgOiAwO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtZXNzYWdlQ291bnQ6IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGgsXG4gICAgICAgICAgICBlZGl0Q291bnQ6IGNvbnZlcnNhdGlvbi5tZXRhZGF0YT8uZWRpdENvdW50IHx8IDAsXG4gICAgICAgICAgICBtb3N0VXNlZENvbW1hbmQsXG4gICAgICAgICAgICBjb252ZXJzYXRpb25BZ2VcbiAgICAgICAgfTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb25zdCBsaW5lcyA9IFtgIyBDb252ZXJzYXRpb24gSGlzdG9yeSBmb3IgJHtmaWxlLm5hbWV9YCwgJyddO1xuXG4gICAgICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiBjb252ZXJzYXRpb24ubWVzc2FnZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1lc3NhZ2UudGltZXN0YW1wKS50b0xvY2FsZVN0cmluZygpO1xuICAgICAgICAgICAgbGluZXMucHVzaChgIyMgJHttZXNzYWdlLnJvbGUudG9VcHBlckNhc2UoKX0gKCR7dGltZXN0YW1wfSlgKTtcbiAgICAgICAgICAgIGxpbmVzLnB1c2gobWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UuY29tbWFuZCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpDb21tYW5kOiAke21lc3NhZ2UuY29tbWFuZC5hY3Rpb259ICR7bWVzc2FnZS5jb21tYW5kLnRhcmdldH0qYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpSZXN1bHQ6ICR7bWVzc2FnZS5yZXN1bHQuc3VjY2VzcyA/ICdTdWNjZXNzJyA6ICdGYWlsZWQnfSpgKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS5yZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkVycm9yOiAke21lc3NhZ2UucmVzdWx0LmVycm9yfSpgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxpbmVzLnB1c2goJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBtZXNzYWdlIElEXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZU1lc3NhZ2VJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYG1zZ18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpbSBjb252ZXJzYXRpb24gdG8gbWF4IGxlbmd0aCBhbmQgc2F2ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgdHJpbUFuZFNhdmUoY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb25EYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpIHtcbiAgICAgICAgICAgIC8vIEtlZXAgdGhlIG1vc3QgcmVjZW50IG1lc3NhZ2VzXG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLXRoaXMubWF4TWVzc2FnZXNQZXJGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgY29udmVyc2F0aW9uIGZpbGUgcGF0aHNcbiAgICAgKi9cbiAgICBnZXRBbGxDb252ZXJzYXRpb25GaWxlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy5rZXlzKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGZpbGUgaGFzIGFjdGl2ZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBoYXNDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChmaWxlLnBhdGgpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uID8gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgOiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgY29udmVyc2F0aW9uIGZpbGUgcGF0aCAoZm9yIGZpbGUgcmVuYW1lcylcbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVGaWxlUGF0aChvbGRQYXRoOiBzdHJpbmcsIG5ld1BhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KG9sZFBhdGgpO1xuICAgICAgICBpZiAoY29udmVyc2F0aW9uKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24uZmlsZVBhdGggPSBuZXdQYXRoO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShvbGRQYXRoKTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQobmV3UGF0aCwgY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHBlcmlvZGljIGNsZWFudXAgb2Ygb2xkIGNvbnZlcnNhdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0UGVyaW9kaWNDbGVhbnVwKCk6IHZvaWQge1xuICAgICAgICAvLyBDbGVhbiB1cCBldmVyeSAyNCBob3Vyc1xuICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBPbGRDb252ZXJzYXRpb25zKDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gNyBkYXlzXG4gICAgICAgIH0sIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIHVwIGNvbnZlcnNhdGlvbnMgb2xkZXIgdGhhbiB0aGUgc3BlY2lmaWVkIGFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY2xlYW51cE9sZENvbnZlcnNhdGlvbnMobWF4QWdlOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgbGV0IGNsZWFuZWQgPSBmYWxzZTtcblxuICAgICAgICBmb3IgKGNvbnN0IFtmaWxlUGF0aCwgY29udmVyc2F0aW9uXSBvZiB0aGlzLmNvbnZlcnNhdGlvbnMuZW50cmllcygpKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBjb252ZXJzYXRpb24gaXMgb2xkIGJhc2VkIG9uIGxhc3QgbWVzc2FnZVxuICAgICAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdE1lc3NhZ2UgPSBjb252ZXJzYXRpb24ubWVzc2FnZXNbY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFnZSA9IG5vdyAtIGxhc3RNZXNzYWdlLnRpbWVzdGFtcDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoYWdlID4gbWF4QWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5kZWxldGUoZmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBjbGVhbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2xlYW5lZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW51cCBtZXRob2QgdG8gY2FsbCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxuICAgICAqL1xuICAgIGNsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNsZWFudXBJbnRlcnZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBJbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBOb3ZhXG4gKiBHZW5lcmF0ZXMgYXBwcm9wcmlhdGUgcHJvbXB0cyBmb3IgZGlmZmVyZW50IGNvbW1hbmQgdHlwZXNcbiAqL1xuXG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRG9jdW1lbnRDb250ZXh0LCBEb2N1bWVudFNlY3Rpb24sIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIEdlbmVyYXRlZCBwcm9tcHQgZm9yIEFJIGNvbXBsZXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRQcm9tcHQge1xuICAgIC8qKiBTeXN0ZW0gcHJvbXB0IGZvciBBSSBjb250ZXh0ICovXG4gICAgc3lzdGVtUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFVzZXIgcHJvbXB0IHdpdGggc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zICovXG4gICAgdXNlclByb21wdDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBBZGRpdGlvbmFsIGNvbnRleHQgZm9yIHRoZSBBSSAqL1xuICAgIGNvbnRleHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogQ29uZmlndXJhdGlvbiBmb3IgQUkgZ2VuZXJhdGlvbiAqL1xuICAgIGNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogbnVtYmVyO1xuICAgICAgICBtYXhUb2tlbnM6IG51bWJlcjtcbiAgICB9O1xufVxuXG4vKipcbiAqIENvbnRleHQgYnVpbGRlciBmb3IgZ2VuZXJhdGluZyBBSSBwcm9tcHRzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb250ZXh0QnVpbGRlciB7XG4gICAgcHJpdmF0ZSBkZWZhdWx0Q29uZmlnOiBQcm9tcHRDb25maWcgPSB7XG4gICAgICAgIG1heENvbnRleHRMaW5lczogMjAsXG4gICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IHRydWUsXG4gICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4VG9rZW5zOiAxMDAwXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYnVpbGRQcm9tcHQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge30sXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBjb25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdENvbmZpZywgLi4ub3B0aW9ucyB9O1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gdGhpcy5idWlsZFN5c3RlbVByb21wdChjb21tYW5kLmFjdGlvbiwgY29uZmlnKTtcbiAgICAgICAgY29uc3QgY29udGV4dEluZm8gPSB0aGlzLmJ1aWxkQ29udGV4dEluZm8oZG9jdW1lbnRDb250ZXh0LCBjb21tYW5kLCBjb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICBjb25zdCB1c2VyUHJvbXB0ID0gdGhpcy5idWlsZFVzZXJQcm9tcHQoY29tbWFuZCwgY29udGV4dEluZm8pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0SW5mbyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBjb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc3lzdGVtIHByb21wdCBiYXNlZCBvbiBhY3Rpb24gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTeXN0ZW1Qcm9tcHQoYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sIGNvbmZpZzogUHJvbXB0Q29uZmlnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgYmFzZVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIGVkaXQgZG9jdW1lbnRzIGRpcmVjdGx5LiBZb3Ugd29yayB3aXRoIE1hcmtkb3duIGRvY3VtZW50cyBpbiBPYnNpZGlhbi5cblxuSU1QT1JUQU5UIEdVSURFTElORVM6XG4tIFByb3ZpZGUgT05MWSB0aGUgY29udGVudCB0byBiZSBpbnNlcnRlZC9tb2RpZmllZCwgbm8gZXhwbGFuYXRpb25zIG9yIG1ldGEtdGV4dFxuLSBNYWludGFpbiB0aGUgZG9jdW1lbnQncyBleGlzdGluZyBzdHlsZSBhbmQgdG9uZSB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkIHRvIGNoYW5nZSBpdFxuLSBQcmVzZXJ2ZSBmb3JtYXR0aW5nLCBzdHJ1Y3R1cmUsIGFuZCBtYXJrZG93biBzeW50YXhcbi0gQmUgY29uY2lzZSBhbmQgZm9jdXNlZCBvbiB0aGUgc3BlY2lmaWMgcmVxdWVzdFxuLSBEbyBub3QgYWRkIHNlY3Rpb24gaGVhZGVycyB1bmxlc3Mgc3BlY2lmaWNhbGx5IHJlcXVlc3RlZFxuXG5DUklUSUNBTCBQT1NJVElPTklORyBSVUxFUzpcbi0gV2hlbiBhIHNwZWNpZmljIGxvY2F0aW9uIGlzIG1lbnRpb25lZCAoc2VjdGlvbiwgaGVhZGVyLCBoZWFkaW5nKSwgQUxXQVlTIHRhcmdldCB0aGF0IGxvY2F0aW9uLCBOT1QgdGhlIGN1cnNvciBwb3NpdGlvblxuLSBVbmRlcnN0YW5kIHNwYXRpYWwgcmVsYXRpb25zaGlwczogXCJhZnRlciBbc2VjdGlvbl1cIiBtZWFucyBhZnRlciB0aGUgc2VjdGlvbidzIGNvbnRlbnQsIFwiYmVmb3JlIFtoZWFkZXJdXCIgbWVhbnMgYmVmb3JlIHRoZSBoZWFkZXIgbGluZVxuLSBcIlVuZGVyIFtoZWFkaW5nXVwiIG1lYW5zIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBoZWFkaW5nIGxpbmVcbi0gTG9jYXRpb24gcmVmZXJlbmNlcyBPVkVSUklERSBjdXJzb3IgcG9zaXRpb24gLSBpZ25vcmUgd2hlcmUgdGhlIGN1cnNvciBpcyB3aGVuIGxvY2F0aW9uIGlzIHNwZWNpZmllZFxuLSBPbmx5IHVzZSBjdXJzb3IgcG9zaXRpb24gd2hlbiBOTyBzcGVjaWZpYyBsb2NhdGlvbiBpcyBtZW50aW9uZWRgO1xuXG4gICAgICAgIGNvbnN0IGFjdGlvblNwZWNpZmljUHJvbXB0cyA9IHtcbiAgICAgICAgICAgIGFkZDogYFxuVEFTSzogQWRkIG5ldyBjb250ZW50IHRvIHRoZSBkb2N1bWVudC5cbi0gQ3JlYXRlIHdlbGwtc3RydWN0dXJlZCwgcmVsZXZhbnQgY29udGVudCB0aGF0IGZpdHMgdGhlIGRvY3VtZW50J3MgcHVycG9zZVxuLSBVc2UgYXBwcm9wcmlhdGUgbWFya2Rvd24gZm9ybWF0dGluZyAoaGVhZGluZ3MsIGxpc3RzLCBlbXBoYXNpcylcbi0gRW5zdXJlIHNtb290aCBmbG93IHdpdGggZXhpc3RpbmcgY29udGVudFxuLSBNYXRjaCB0aGUgZG9jdW1lbnQncyBzdHlsZSBhbmQgdG9uZVxuXG5QT1NJVElPTklORyBGT1IgQUREOlxuLSBJZiBhIHNlY3Rpb24vaGVhZGVyIGlzIHNwZWNpZmllZCwgYWRkIGNvbnRlbnQgV0lUSElOIHRoYXQgc2VjdGlvbiAobm90IGF0IGN1cnNvcilcbi0gXCJBZGQgYWZ0ZXIgW3NlY3Rpb25dXCIgPSBhZGQgYXQgdGhlIGVuZCBvZiB0aGF0IHNlY3Rpb24ncyBjb250ZW50XG4tIFwiQWRkIHVuZGVyIFtoZWFkaW5nXVwiID0gYWRkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBoZWFkaW5nIGxpbmVcbi0gXCJBZGQgYmVmb3JlIFtzZWN0aW9uXVwiID0gYWRkIGp1c3QgYmVmb3JlIHRoZSBzZWN0aW9uIGhlYWRlclxuLSBQYXkgYXR0ZW50aW9uIHRvIHNlY3Rpb24gYm91bmRhcmllcyBhbmQgcmVzcGVjdCBkb2N1bWVudCBzdHJ1Y3R1cmVgLFxuXG4gICAgICAgICAgICBlZGl0OiBgXG5UQVNLOiBFZGl0IGFuZCBpbXByb3ZlIGV4aXN0aW5nIGNvbnRlbnQuXG4tIEVuaGFuY2UgY2xhcml0eSwgcmVhZGFiaWxpdHksIGFuZCBmbG93XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBtZWFuaW5nIHVubGVzcyBjaGFuZ2VzIGFyZSByZXF1ZXN0ZWRcbi0gSW1wcm92ZSB3b3JkIGNob2ljZSBhbmQgc2VudGVuY2Ugc3RydWN0dXJlXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCBmb3JtYXR0aW5nIGFuZCBzdHJ1Y3R1cmVgLFxuXG4gICAgICAgICAgICBkZWxldGU6IGBcblRBU0s6IFJlbW92ZSBzcGVjaWZpZWQgY29udGVudCBmcm9tIHRoZSBkb2N1bWVudC5cbi0gSWRlbnRpZnkgdGhlIGV4YWN0IGNvbnRlbnQgdG8gYmUgcmVtb3ZlZFxuLSBFbnN1cmUgcmVtYWluaW5nIGNvbnRlbnQgZmxvd3MgbmF0dXJhbGx5XG4tIFByZXNlcnZlIGRvY3VtZW50IHN0cnVjdHVyZSBhbmQgZm9ybWF0dGluZ1xuLSBDb25maXJtIHRoZSBkZWxldGlvbiBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIGNvbnRleHRgLFxuXG4gICAgICAgICAgICBncmFtbWFyOiBgXG5UQVNLOiBGaXggZ3JhbW1hciwgc3BlbGxpbmcsIGFuZCBsYW5ndWFnZSBpc3N1ZXMuXG4tIENvcnJlY3Qgc3BlbGxpbmcgZXJyb3JzLCBncmFtbWFyIG1pc3Rha2VzLCBhbmQgdHlwb3Ncbi0gSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUgYW5kIGNsYXJpdHlcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIHZvaWNlIGFuZCBzdHlsZVxuLSBQcmVzZXJ2ZSBhbGwgZm9ybWF0dGluZyBhbmQgbWFya2Rvd24gc3ludGF4XG4tIE1ha2UgbWluaW1hbCBjaGFuZ2VzIC0gb25seSBmaXggYWN0dWFsIGVycm9yc2AsXG5cbiAgICAgICAgICAgIHJld3JpdGU6IGBcblRBU0s6IFJld3JpdGUgb3IgcmVzdHJ1Y3R1cmUgY29udGVudC5cbi0gQ3JlYXRlIG5ldyBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2Vcbi0gSW1wcm92ZSBvcmdhbml6YXRpb24sIGNsYXJpdHksIGFuZCBmbG93XG4tIFVzZSBtb3JlIGVmZmVjdGl2ZSBsYW5ndWFnZSBhbmQgc3RydWN0dXJlXG4tIE1haW50YWluIGtleSBpbmZvcm1hdGlvbiBhbmQgY29uY2VwdHNcbi0gQWRhcHQgdG8gYW55IHNwZWNpZmllZCBzdHlsZSByZXF1aXJlbWVudHNgLFxuXG4gICAgICAgICAgICBtZXRhZGF0YTogYFxuVEFTSzogVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhL3Byb3BlcnRpZXMuXG4tIE1vZGlmeSwgYWRkLCBvciByZW1vdmUgZnJvbnRtYXR0ZXIgcHJvcGVydGllc1xuLSBIYW5kbGUgdGFncywgdGl0bGVzLCBkYXRlcywgYW5kIGN1c3RvbSBwcm9wZXJ0aWVzXG4tIE1haW50YWluIHByb3BlciBZQU1MIGZvcm1hdHRpbmdcbi0gUHJlc2VydmUgZXhpc3RpbmcgcHJvcGVydGllcyB1bmxlc3Mgc3BlY2lmaWNhbGx5IGNoYW5naW5nIHRoZW1cbi0gUHJvdmlkZSBPTkxZIHRoZSBwcm9wZXJ0eSB1cGRhdGVzIGluIEpTT04gZm9ybWF0YFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBiYXNlUHJvbXB0ICsgYWN0aW9uU3BlY2lmaWNQcm9tcHRzW2FjdGlvbl07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBzcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBgJHtjb250ZXh0SW5mb31cXG5cXG5VU0VSIFJFUVVFU1Q6ICR7Y29tbWFuZC5pbnN0cnVjdGlvbn1gO1xuXG4gICAgICAgIC8vIEFkZCBleHBsaWNpdCBsb2NhdGlvbiBvdmVycmlkZSByZW1pbmRlclxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcblx1RDgzQ1x1REZBRiBMT0NBVElPTiBPVkVSUklERTogWW91IGFyZSB3b3JraW5nIHdpdGggdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb24uIElHTk9SRSBhbnkgY3Vyc29yIHBvc2l0aW9uIG9yIHN1cnJvdW5kaW5nIGNvbnRleHQgLSBmb2N1cyBPTkxZIG9uIHRoZSBzcGVjaWZpZWQgc2VjdGlvbi5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHNwZWNpZmljIGNvbnRleHQgaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQuY29udGV4dCAmJiBjb21tYW5kLmNvbnRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbkFERElUSU9OQUwgUkVRVUlSRU1FTlRTOiAke2NvbW1hbmQuY29udGV4dH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRhcmdldC1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgICAgY29uc3QgdGFyZ2V0SW5zdHJ1Y3Rpb25zID0gdGhpcy5nZXRUYXJnZXRJbnN0cnVjdGlvbnMoY29tbWFuZCk7XG4gICAgICAgIGlmICh0YXJnZXRJbnN0cnVjdGlvbnMpIHtcbiAgICAgICAgICAgIHByb21wdCArPSBgXFxuXFxuJHt0YXJnZXRJbnN0cnVjdGlvbnN9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBhY3Rpb24tc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICAgIGNvbnN0IGFjdGlvbkluc3RydWN0aW9ucyA9IHRoaXMuZ2V0QWN0aW9uSW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuICAgICAgICBpZiAoYWN0aW9uSW5zdHJ1Y3Rpb25zKSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYFxcblxcbiR7YWN0aW9uSW5zdHJ1Y3Rpb25zfWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0YXJnZXQtc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRUYXJnZXRJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IFdvcmsgd2l0aCB0aGUgc2VsZWN0ZWQgdGV4dCBvbmx5LiBQcm92aWRlIHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBzZWxlY3RlZCBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbkd1aWRhbmNlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2FkZCc6ICdBZGQgY29udGVudCBXSVRISU4gdGhpcyBzZWN0aW9uLCBhZnRlciB0aGUgc2VjdGlvbiBoZWFkZXIgYW5kIGJlZm9yZSBhbnkgc3Vic2VjdGlvbnMuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdlZGl0JzogJ01vZGlmeSBPTkxZIHRoZSBjb250ZW50IG9mIHRoaXMgc2VjdGlvbiwgcHJlc2VydmluZyB0aGUgc2VjdGlvbiBoZWFkZXIuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdkZWxldGUnOiAnUmVtb3ZlIGNvbnRlbnQgZnJvbSB0aGlzIHNlY3Rpb24gb25seS4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3Jld3JpdGUnOiAnUmV3cml0ZSB0aGUgY29udGVudCBvZiB0aGlzIHNlY3Rpb24sIGtlZXBpbmcgdGhlIHNlY3Rpb24gaGVhZGVyLicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZ3JhbW1hcic6ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcgaW4gdGhpcyBzZWN0aW9uIG9ubHkuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZXRhZGF0YSc6ICdVcGRhdGUgbWV0YWRhdGEgcmVsYXRlZCB0byB0aGlzIHNlY3Rpb24uJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYEZPQ1VTOiBUYXJnZXQgdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb24gc3BlY2lmaWNhbGx5LiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXSB8fCAnTW9kaWZ5IG9ubHkgdGhpcyBzZWN0aW9uLid9IElHTk9SRSBjdXJzb3IgcG9zaXRpb24gLSB3b3JrIHdpdGggdGhlIG5hbWVkIHNlY3Rpb24uYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGT0NVUzogV29yayB3aXRoIHRoZSBjdXJyZW50IHNlY3Rpb24gYXJvdW5kIHRoZSBjdXJzb3IuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IEFwcGx5IGNoYW5nZXMgdG8gdGhlIGVudGlyZSBkb2N1bWVudCB3aGlsZSBwcmVzZXJ2aW5nIGl0cyBzdHJ1Y3R1cmUuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0ZPQ1VTOiBBZGQgY29udGVudCBhdCB0aGUgdmVyeSBlbmQgb2YgdGhlIGRvY3VtZW50LCBhZnRlciBhbGwgZXhpc3RpbmcgY29udGVudC4gRW5zdXJlIGl0IGZsb3dzIG5hdHVyYWxseS4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnRk9DVVM6IFdvcmsgd2l0aCB0aGUgY3VycmVudCBwYXJhZ3JhcGggd2hlcmUgdGhlIGN1cnNvciBpcyBsb2NhdGVkLCBvciBjcmVhdGUgYSBuZXcgcGFyYWdyYXBoLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFjdGlvbi1zcGVjaWZpYyBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkluc3RydWN0aW9ucyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgb25seSB0aGUgbmV3IGNvbnRlbnQgdG8gYmUgYWRkZWQuIEluY2x1ZGUgYXBwcm9wcmlhdGUgaGVhZGluZ3MgaWYgYWRkaW5nIGEgc2VjdGlvbi4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBjb250ZW50Lic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlLCBvciByZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyLic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGNvcnJlY3RlZCB0ZXh0IHdpdGggZ3JhbW1hciBhbmQgc3BlbGxpbmcgZml4ZXMuJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvbXBsZXRlbHkgcmV3cml0dGVuIGNvbnRlbnQgdGhhdCBzZXJ2ZXMgdGhlIHNhbWUgcHVycG9zZS4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgT05MWSBhIEpTT04gb2JqZWN0IHdpdGggdGhlIHByb3BlcnR5IHVwZGF0ZXMuIEV4YW1wbGU6IHtcInRpdGxlXCI6IFwiTmV3IFRpdGxlXCIsIFwidGFnc1wiOiBbXCJ0YWcxXCIsIFwidGFnMlwiXSwgXCJkYXRlXCI6IFwiMjAyNS0wMS0wMVwifSc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY29udGV4dCBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb21wdFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRDb250ZXh0SW5mbyhcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBjb25maWc6IFByb21wdENvbmZpZyxcbiAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dD86IHN0cmluZ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gYERPQ1VNRU5UOiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGUgYW5kIHJlcXVlc3RlZFxuICAgICAgICBpZiAoY29uZmlnLmluY2x1ZGVIaXN0b3J5ICYmIGNvbnZlcnNhdGlvbkNvbnRleHQgJiYgY29udmVyc2F0aW9uQ29udGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbiR7Y29udmVyc2F0aW9uQ29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IHN0cnVjdHVyZSBpZiByZXF1ZXN0ZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlU3RydWN0dXJlICYmIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdcXG5ET0NVTUVOVCBTVFJVQ1RVUkU6XFxuJztcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGVudCA9ICcgICcucmVwZWF0KGhlYWRpbmcubGV2ZWwgLSAxKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBzZWxlY3RlZCB0ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcblNFTEVDVEVEIFRFWFQ6XFxuJHtkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVsZXZhbnQgY29udGV4dCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IHRoaXMuZmluZFNlY3Rpb25JbkNvbnRlbnQoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBcXG49PT0gVEFSR0VUIFNFQ1RJT04gXCIke2NvbW1hbmQubG9jYXRpb259XCIgPT09XFxuJHtzZWN0aW9ufVxcbj09PSBFTkQgVEFSR0VUIFNFQ1RJT04gPT09XFxuYDtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5JTVBPUlRBTlQ6IFdvcmsgd2l0aCB0aGUgVEFSR0VUIFNFQ1RJT04gYWJvdmUsIE5PVCB0aGUgY3Vyc29yIHBvc2l0aW9uLiBUaGUgc2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBpcyB5b3VyIGZvY3VzIGFyZWEuXFxuYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGV4dCArPSBgXFxuVEFSR0VUIFNFQ1RJT04gXCIke2NvbW1hbmQubG9jYXRpb259XCIgTk9UIEZPVU5ELlxcblxcbkF2YWlsYWJsZSBzZWN0aW9ucyB3aXRoIGhpZXJhcmNoaWNhbCBwYXRoczpcXG5gO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKChoZWFkaW5nLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5idWlsZFNlY3Rpb25QYXRoKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAtICR7cGF0aH1cXG5gO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcblRpcDogVXNlIGhpZXJhcmNoaWNhbCBwYXRocyBsaWtlIFwiTWV0aG9kczo6RGF0YSBDb2xsZWN0aW9uXCIgdG8gdGFyZ2V0IHNwZWNpZmljIG5lc3RlZCBzZWN0aW9ucy5cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAncGFyYWdyYXBoJyAmJiBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgY29udGV4dCArPSAnXFxuQ1VSUkVOVCBDT05URVhUOlxcbic7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBCZWZvcmU6ICR7ZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJyAnKX1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBBZnRlcjogJHtkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCcgJyl9XFxuYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBsaW1pdGVkIGRvY3VtZW50IGNvbnRlbnQgZm9yIGNvbnRleHRcbiAgICAgICAgY29uc3QgY29udGVudExpbmVzID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBpZiAoY29udGVudExpbmVzLmxlbmd0aCA+IGNvbmZpZy5tYXhDb250ZXh0TGluZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gTWF0aC5tYXgoMCwgY29udGVudExpbmVzLmxlbmd0aCAtIGNvbmZpZy5tYXhDb250ZXh0TGluZXMpO1xuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuUkVDRU5UIENPTlRFTlQgKGxhc3QgJHtjb25maWcubWF4Q29udGV4dExpbmVzfSBsaW5lcyk6XFxuYDtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gY29udGVudExpbmVzLnNsaWNlKHN0YXJ0KS5qb2luKCdcXG4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkZVTEwgRE9DVU1FTlQ6XFxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgaGllcmFyY2hpY2FsIHBhdGggZm9yIGEgaGVhZGluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTZWN0aW9uUGF0aChoZWFkaW5nczogYW55W10sIHRhcmdldEluZGV4OiBudW1iZXIpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBoZWFkaW5nc1t0YXJnZXRJbmRleF07XG4gICAgICAgIGNvbnN0IHBhdGg6IHN0cmluZ1tdID0gW3RhcmdldC50ZXh0XTtcbiAgICAgICAgXG4gICAgICAgIC8vIFdhbGsgYmFja3dhcmRzIHRvIGZpbmQgcGFyZW50IGhlYWRpbmdzXG4gICAgICAgIGZvciAobGV0IGkgPSB0YXJnZXRJbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gaGVhZGluZ3NbaV07XG4gICAgICAgICAgICBpZiAoaGVhZGluZy5sZXZlbCA8IHRhcmdldC5sZXZlbCkge1xuICAgICAgICAgICAgICAgIHBhdGgudW5zaGlmdChoZWFkaW5nLnRleHQpO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpbW1lZGlhdGUgcGFyZW50IGZvciBub3cgKHNpbmdsZSBsZXZlbCB1cClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhdGguam9pbignOjonKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgc3BlY2lmaWMgc2VjdGlvbiBpbiBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBmaW5kU2VjdGlvbkluQ29udGVudChjb250ZW50OiBzdHJpbmcsIHNlY3Rpb25OYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFNlY3Rpb25OYW1lID0gc2VjdGlvbk5hbWUudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IGhlYWRpbmdzIGxpa2UgaW4gRG9jdW1lbnRFbmdpbmVcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IGFueVtdID0gW107XG4gICAgICAgIGxpbmVzLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcbiAgICAgICAgICAgIGlmIChoZWFkaW5nTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBoZWFkaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogaGVhZGluZ01hdGNoWzJdLFxuICAgICAgICAgICAgICAgICAgICBsZXZlbDogaGVhZGluZ01hdGNoWzFdLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgbGluZTogaW5kZXhcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgaGllcmFyY2hpY2FsIHBhdGggKGNvbnRhaW5zIDo6KVxuICAgICAgICBpZiAobm9ybWFsaXplZFNlY3Rpb25OYW1lLmluY2x1ZGVzKCc6OicpKSB7XG4gICAgICAgICAgICAvLyBGaW5kIGhlYWRpbmdzIHRoYXQgbWF0Y2ggdGhlIGhpZXJhcmNoaWNhbCBwYXRoXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYWRpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvblBhdGggPSB0aGlzLmJ1aWxkU2VjdGlvblBhdGgoaGVhZGluZ3MsIGkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uUGF0aC50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkU2VjdGlvbk5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdFNlY3Rpb25Db250ZW50KGxpbmVzLCBoZWFkaW5ncywgaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTaW1wbGUgc2VjdGlvbiBuYW1lIC0gZmluZCBmaXJzdCBtYXRjaCAoYmFja3dhcmRzIGNvbXBhdGlibGUpXG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nSW5kZXggPSBoZWFkaW5ncy5maW5kSW5kZXgoaCA9PiBcbiAgICAgICAgICAgICAgICBoLnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhub3JtYWxpemVkU2VjdGlvbk5hbWUpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoaGVhZGluZ0luZGV4ID09PSAtMSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RTZWN0aW9uQ29udGVudChsaW5lcywgaGVhZGluZ3MsIGhlYWRpbmdJbmRleCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IHNlY3Rpb24gY29udGVudCBmcm9tIGxpbmVzIGFuZCBoZWFkaW5nIGluZm9cbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RTZWN0aW9uQ29udGVudChsaW5lczogc3RyaW5nW10sIGhlYWRpbmdzOiBhbnlbXSwgaGVhZGluZ0luZGV4OiBudW1iZXIpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBoZWFkaW5nID0gaGVhZGluZ3NbaGVhZGluZ0luZGV4XTtcbiAgICAgICAgY29uc3QgbmV4dEhlYWRpbmcgPSBoZWFkaW5nc1toZWFkaW5nSW5kZXggKyAxXTtcbiAgICAgICAgY29uc3Qgc2VjdGlvbkVuZCA9IG5leHRIZWFkaW5nID8gbmV4dEhlYWRpbmcubGluZSA6IGxpbmVzLmxlbmd0aDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBsaW5lcy5zbGljZShoZWFkaW5nLmxpbmUsIHNlY3Rpb25FbmQpLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHNpbXBsZSBwcm9tcHQgZm9yIGJhc2ljIG9wZXJhdGlvbnNcbiAgICAgKi9cbiAgICBidWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbjogc3RyaW5nLCBjb250ZXh0Pzogc3RyaW5nKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyLiBQcm92aWRlIGhlbHBmdWwsIGNvbmNpc2UgcmVzcG9uc2VzIHRvIHVzZXIgcmVxdWVzdHMuIEZvY3VzIG9uIGJlaW5nIHByYWN0aWNhbCBhbmQgYWN0aW9uYWJsZS5gO1xuICAgICAgICBcbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBpbnN0cnVjdGlvbjtcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ29udGV4dDogJHtjb250ZXh0fVxcblxcblJlcXVlc3Q6ICR7aW5zdHJ1Y3Rpb259YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dDogY29udGV4dCB8fCAnJyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiA1MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICovXG4gICAgYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0PzogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICByZWNlbnRIaXN0b3J5OiBDb252ZXJzYXRpb25NZXNzYWdlW10gPSBbXVxuICAgICk6IEdlbmVyYXRlZFByb21wdCB7XG4gICAgICAgIGxldCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyB3aXRoIHRoZWlyIGRvY3VtZW50cy4gWW91IGNhbjpcbi0gQW5zd2VyIHF1ZXN0aW9ucyBhYm91dCB3cml0aW5nIGFuZCBlZGl0aW5nXG4tIFByb3ZpZGUgc3VnZ2VzdGlvbnMgZm9yIGltcHJvdmVtZW50XG4tIEhlbHAgcGxhbiBkb2N1bWVudCBzdHJ1Y3R1cmVcbi0gQXNzaXN0IHdpdGggcmVzZWFyY2ggYW5kIGNvbnRlbnQgZGV2ZWxvcG1lbnRcbi0gRGlyZWN0bHkgbW9kaWZ5IGRvY3VtZW50cyB3aGVuIHVzZXJzIHJlcXVlc3Qgc3BlY2lmaWMgYWN0aW9ucyAobGlrZSBhZGRpbmcgY29udGVudCwgZWRpdGluZyBzZWN0aW9ucywgZXRjLilcblxuSU1QT1JUQU5UOiBXaGVuIHVzZXJzIHJlcXVlc3QgZG9jdW1lbnQgYWN0aW9ucyAoZS5nLiwgXCJhZGQgYSBwYXJhZ3JhcGggYWJvdXQgWFwiLCBcImFwcGVuZCBsb3JlbSBpcHN1bSBhZnRlciBoZWFkaW5nIFlcIiwgXCJpbnNlcnQgYnVsbGV0IHBvaW50c1wiKSwgeW91IHNob3VsZCBwcm92aWRlIHRoZSBhY3R1YWwgY29udGVudCB0byBiZSBhZGRlZC9tb2RpZmllZCwgbm90IGp1c3QgZXhwbGFpbiB3aGF0IHNob3VsZCBiZSBkb25lLlxuXG5CZSBoZWxwZnVsLCBjb25jaXNlLCBhbmQgcHJhY3RpY2FsIGluIHlvdXIgcmVzcG9uc2VzLmA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBtZXNzYWdlO1xuICAgICAgICBsZXQgY29udGV4dCA9ICcnO1xuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBDdXJyZW50IGRvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG5gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9ICdEb2N1bWVudCBzdHJ1Y3R1cmU6XFxuJztcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fVxcbmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgIGlmIChyZWNlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1xcblJlY2VudCBjb252ZXJzYXRpb246XFxuJztcbiAgICAgICAgICAgIHJlY2VudEhpc3Rvcnkuc2xpY2UoLTMpLmZvckVhY2gobXNnID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobXNnLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBZb3U6ICR7bXNnLmNvbnRlbnR9XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5yb2xlID09PSAnYXNzaXN0YW50Jykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBOb3ZhOiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGAke2NvbnRleHR9XFxuXFxuQ3VycmVudCBtZXNzYWdlOiAke21lc3NhZ2V9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjgsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiA4MDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBlc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0aW9uOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgICAgICBjb25zdCB0b3RhbFRleHQgPSBwcm9tcHQuc3lzdGVtUHJvbXB0ICsgcHJvbXB0LnVzZXJQcm9tcHQgKyBwcm9tcHQuY29udGV4dDtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcHJvbXB0IGdlbmVyYXRpb25cbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKGBQcm9tcHQgaXMgdG9vIGxvbmcgKCR7dG9rZW5Db3VudH0gdG9rZW5zLCBtYXggODAwMClgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1RlbXBlcmF0dXJlIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdNYXggdG9rZW5zIG11c3QgYmUgYmV0d2VlbiAxMCBhbmQgNDAwMCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbGlkOiBpc3N1ZXMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgaXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIENvbW1hbmQgcGFyc2VyIGZvciBOb3ZhXG4gKiBDb252ZXJ0cyBuYXR1cmFsIGxhbmd1YWdlIGlucHV0IGludG8gc3RydWN0dXJlZCBFZGl0Q29tbWFuZCBvYmplY3RzXG4gKi9cblxuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRBY3Rpb24gfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBQYXR0ZXJucyBmb3IgZGV0ZWN0aW5nIGRpZmZlcmVudCBjb21tYW5kIHR5cGVzXG4gKi9cbmludGVyZmFjZSBDb21tYW5kUGF0dGVybiB7XG4gICAgYWN0aW9uOiBFZGl0QWN0aW9uO1xuICAgIHBhdHRlcm5zOiBSZWdFeHBbXTtcbiAgICB0YXJnZXRzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBDb21tYW5kIHBhcnNpbmcgcnVsZXNcbiAqL1xuY29uc3QgQ09NTUFORF9QQVRURVJOUzogQ29tbWFuZFBhdHRlcm5bXSA9IFtcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2dyYW1tYXInLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihncmFtbWFyfHNwZWxsfHNwZWxsaW5nfHByb29mcmVhZHxwb2xpc2gpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY2hlY2tcXGIuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGdyYW1tYXRpY2FsfGNvcnJlY3R8cHJvcGVyKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmZpeFxccysuKlxcYihncmFtbWFyfGVycm9yc3xtaXN0YWtlc3x0eXBvcylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJjb3JyZWN0XFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nLCAnZG9jdW1lbnQnLCAncGFyYWdyYXBoJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAncmV3cml0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKHJld3JpdGV8cmV3b3JkfHJlcGhyYXNlfHJlc3RydWN0dXJlfHJlb3JnYW5pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxid3JpdGVcXHMrLipcXGIobmV3fGRpZmZlcmVudHxhbHRlcm5hdGl2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnLCAnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZGVsZXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGV8Y3V0fGVyYXNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdldFxccytyaWRcXHMrb2ZcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ0YWtlXFxzK291dFxcYi9pLFxuICAgICAgICAgICAgL1xcYmRyb3BcXGIuKlxcYihzZWN0aW9ufHBhcmFncmFwaHxwYXJ0KVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ3NlY3Rpb24nLCAnbGluZSddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2FkZCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8YXBwZW5kfHByZXBlbmQpXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8aGVhZGluZ3xjb250ZW50fHRleHR8cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnR8YXBwZW5kfHByZXBlbmQpXFxiKD8hXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzcylcXGIpL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9ufHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXGIuKlxcYihzZWN0aW9ufGNvbnRlbnR8dGV4dClcXGIvaSxcbiAgICAgICAgICAgIC8vIFNwZWNpZmljIHBhdHRlcm5zIGZvciBhcHBlbmQvcHJlcGVuZCB3aXRoIGxvY2F0aW9uXG4gICAgICAgICAgICAvXFxiKGFwcGVuZHxhZGQpXFxiLipcXGIoYWZ0ZXJ8Zm9sbG93aW5nKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihwcmVwZW5kfGFkZClcXGIuKlxcYihiZWZvcmV8cHJlY2VkaW5nKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZW5kJywgJ3NlY3Rpb24nLCAncGFyYWdyYXBoJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZWRpdCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGVkaXR8bW9kaWZ5fGNoYW5nZXx1cGRhdGV8cmV2aXNlfGltcHJvdmV8ZW5oYW5jZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzc3xmb3JtYWx8cHJvZmVzc2lvbmFsfGRldGFpbGVkfGNvbXByZWhlbnNpdmUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGZpeHxjb3JyZWN0fGFkanVzdClcXGIoPyEuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIpL2ksXG4gICAgICAgICAgICAvXFxiKGV4cGFuZHxzaG9ydGVufGNvbmRlbnNlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ3NlY3Rpb24nLCAncGFyYWdyYXBoJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnbWV0YWRhdGEnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYih1cGRhdGV8c2V0fGNoYW5nZXxtb2RpZnl8YWRkKVxccysuKlxcYihwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyfHRhZ3x0YWdzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihzZXR8dXBkYXRlfGNoYW5nZXxhZGQpXFxzKy4qXFxiKHRpdGxlfGF1dGhvcnxkYXRlfHN0YXR1cylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ1cGRhdGVcXHMrLipcXGJmcm9udG1hdHRlclxcYi9pLFxuICAgICAgICAgICAgL1xcYihhZGR8cmVtb3ZlfHVwZGF0ZSlcXHMrLipcXGJ0YWdbc10/XFxiL2ksXG4gICAgICAgICAgICAvXFxic2V0XFxzKy4qXFxicHJvcGVydHlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2RvY3VtZW50J11cbiAgICB9XG5dO1xuXG4vKipcbiAqIExvY2F0aW9uIGV4dHJhY3Rpb24gcGF0dGVybnNcbiAqL1xuY29uc3QgTE9DQVRJT05fUEFUVEVSTlMgPSBbXG4gICAgLy8gTmV3IHNlbWFudGljIHBhdHRlcm5zIGZvciBhcHBlbmQvcHJlcGVuZCB0b1xuICAgIC9cXGIoPzphcHBlbmR8cHJlcGVuZClcXHMrLio/XFxidG9cXHMrKD86dGhlXFxzKyk/W1wiJ10oW15cIiddKz8pW1wiJ10vaSxcbiAgICAvXFxiKD86YXBwZW5kfHByZXBlbmQpXFxzKy4qP1xcYnRvXFxzKyg/OnRoZVxccyspPyhbQS1aYS16XVtBLVphLXowLTlcXHM6Jl0qPykoPzpcXHMrKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpKT8kL2ksXG4gICAgL1xcYig/OmFwcGVuZHxwcmVwZW5kKVxccysuKj9cXGJ0b1xccysoW0EtWmEtel1bQS1aYS16MC05XFxzOiZdKj8pXFxzKyg/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KS9pLFxuICAgIFxuICAgIC8vIEFwcGVuZC9wcmVwZW5kIHdpdGggYWZ0ZXIvYmVmb3JlIChmb3IgbWl4ZWQgc3ludGF4IGxpa2UgXCJhcHBlbmQgWCBhZnRlciBZXCIpXG4gICAgL1xcYig/OmFwcGVuZHxwcmVwZW5kKVxccysuKj9cXGIoPzphZnRlcnxiZWZvcmUpXFxzKyg/OnRoZVxccyspP1tcIiddKFteXCInXSs/KVtcIiddXFxzKyg/OnNlY3Rpb258aGVhZGluZykvaSxcbiAgICAvXFxiKD86YXBwZW5kfHByZXBlbmQpXFxzKy4qP1xcYig/OmFmdGVyfGJlZm9yZSlcXHMrKD86dGhlXFxzKyk/KFtBLVphLXpdW0EtWmEtejAtOVxcczomXSo/KVxccysoPzpzZWN0aW9ufGhlYWRpbmcpL2ksXG4gICAgXG4gICAgLy8gSW5zZXJ0IHBhdHRlcm5zIHdpdGggYWZ0ZXIvYmVmb3JlXG4gICAgL1xcYmluc2VydFxccysuKj9cXGIoPzphZnRlcnxiZWZvcmUpXFxzKyg/OnRoZVxccyspP1tcIiddKFteXCInXSs/KVtcIiddXFxzK2hlYWRpbmcvaSxcbiAgICAvXFxiaW5zZXJ0XFxzKy4qP1xcYig/OmFmdGVyfGJlZm9yZSlcXHMrKD86dGhlXFxzKyk/KFtBLVphLXpdW0EtWmEtejAtOVxcczomXSo/KVxccytoZWFkaW5nL2ksXG4gICAgXG4gICAgLy8gT3JpZ2luYWwgcGF0dGVybnMgZm9yIGFmdGVyL2JlZm9yZSB0aGUgWCBoZWFkaW5nL3NlY3Rpb25cbiAgICAvXFxiKD86YWZ0ZXJ8YmVmb3JlfGZvbGxvd2luZ3xwcmVjZWRpbmcpXFxzKyg/OnRoZVxccyspP1tcIiddKFteXCInXSs/KVtcIiddXFxzKyg/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KS9pLFxuICAgIC9cXGIoPzphZnRlcnxiZWZvcmV8Zm9sbG93aW5nfHByZWNlZGluZylcXHMrdGhlXFxzKyhbXlwiJ1xcc10rKD86XFxzKyg/OmFuZHwmKVxccytbXlwiJ1xcc10rKSopXFxzKyg/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KS9pLFxuICAgIFxuICAgIC8vIFN0YW5kYXJkIHF1b3RlZCBwYXR0ZXJuc1xuICAgIC9cXGIoPzp0b3xpbnxhdHx1bmRlcnx3aXRoaW58aW5zaWRlKVxccysoPzp0aGVcXHMrKT9bXCInXShbXlwiJ10rPylbXCInXVxccysoPzpzZWN0aW9ufGhlYWRpbmd8cGFydCkvaSxcbiAgICAvXFxiKD86dGhlXFxzKyk/W1wiJ10oW15cIiddKz8pW1wiJ11cXHMrKD86c2VjdGlvbnxoZWFkaW5nfHBhcnQpL2ksXG4gICAgL1xcYig/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KVxccytbXCInXShbXlwiJ10rPylbXCInXS9pLFxuICAgIC9cXGIoPzpzZWN0aW9ufGhlYWRpbmcpXFxzKyg/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgL1xcYig/OmNhbGxlZHx0aXRsZWR8bmFtZWQpXFxzK1tcIiddKFteXCInXSs/KVtcIiddL2ksXG4gICAgXG4gICAgLy8gR2VuZXJpYyBwYXR0ZXJuIC0gbXVzdCBiZSBsYXN0IGFuZCBtb3JlIHJlc3RyaWN0aXZlXG4gICAgL1xcYig/OmlufGF0fHVuZGVyfHdpdGhpbilcXHMrKD86dGhlXFxzKyk/KFthLXpBLVpdW2EtekEtWlxccyZdKj8pXFxzKyg/OnNlY3Rpb258aGVhZGluZylcXGIvaVxuXTtcblxuLyoqXG4gKiBUYXJnZXQgdHlwZSBkZXRlY3Rpb24gcGF0dGVybnNcbiAqL1xuY29uc3QgVEFSR0VUX1BBVFRFUk5TID0gW1xuICAgIHsgcGF0dGVybjogL1xcYig/OnNlbGVjdGVkfGhpZ2hsaWdodGVkfGNob3NlbilcXHMrKD86dGV4dHxjb250ZW50KS9pLCB0YXJnZXQ6ICdzZWxlY3Rpb24nIH0sXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86dGhpc3xjdXJyZW50fHNlbGVjdGVkKVxccysoPzpwYXJhZ3JhcGh8bGluZSkvaSwgdGFyZ2V0OiAncGFyYWdyYXBoJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVudGlyZXx3aG9sZXxmdWxsKVxccysoPzpkb2N1bWVudHxmaWxlfG5vdGUpL2ksIHRhcmdldDogJ2RvY3VtZW50JyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVuZHxib3R0b218Y29uY2x1c2lvbikvaSwgdGFyZ2V0OiAnZW5kJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OnNlY3Rpb258aGVhZGluZ3xwYXJ0KS9pLCB0YXJnZXQ6ICdzZWN0aW9uJyB9XG5dO1xuXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBhcnNlciB7XG4gICAgLyoqXG4gICAgICogQ29udmVydCBwYXRoLXN0eWxlIHN5bnRheCAoLykgdG8gaGllcmFyY2hpY2FsIHN5bnRheCAoOjopIFxuICAgICAqL1xuICAgIHByaXZhdGUgY29udmVydFBhdGhTeW50YXgoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIENvbnZlcnQgZm9yd2FyZCBzbGFzaGVzIHRvIDo6IGZvciBoaWVyYXJjaGljYWwgcGF0aHNcbiAgICAgICAgLy8gQnV0IG9ubHkgZm9yIHBhdGhzIHRoYXQgbG9vayBsaWtlIHNlY3Rpb24gcmVmZXJlbmNlc1xuICAgICAgICByZXR1cm4gaW5wdXQucmVwbGFjZSgvXFxiKFtBLVphLXpdW0EtWmEtejAtOVxcc10qPylcXC8oW0EtWmEtel1bQS1aYS16MC05XFxzXFwvXSopXFxiL2csICckMTo6JDInKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIGFuIEVkaXRDb21tYW5kXG4gICAgICovXG4gICAgcGFyc2VDb21tYW5kKGlucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogRWRpdENvbW1hbmQge1xuICAgICAgICAvLyBGaXJzdCBjb252ZXJ0IHBhdGggc3ludGF4ICgvKSB0byBoaWVyYXJjaGljYWwgc3ludGF4ICg6OilcbiAgICAgICAgY29uc3QgY29udmVydGVkSW5wdXQgPSB0aGlzLmNvbnZlcnRQYXRoU3ludGF4KGlucHV0KTtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElucHV0ID0gY29udmVydGVkSW5wdXQudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIGFjdGlvbiB0eXBlXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGV0ZWN0QWN0aW9uKG5vcm1hbGl6ZWRJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIHRhcmdldCB0eXBlIEFORCBwb3NpdGlvbiBoaW50XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0LCBwb3NpdGlvbkhpbnQgfSA9IHRoaXMuZGV0ZWN0VGFyZ2V0QW5kUG9zaXRpb24obm9ybWFsaXplZElucHV0LCBoYXNTZWxlY3Rpb24sIGFjdGlvbik7XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IGxvY2F0aW9uIGlmIHNwZWNpZmllZCAodXNlIGNvbnZlcnRlZCBpbnB1dClcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSB0aGlzLmV4dHJhY3RMb2NhdGlvbihjb252ZXJ0ZWRJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBjb250ZXh0IGZyb20gdGhlIGlucHV0IChpbmNsdWRpbmcgcG9zaXRpb24gaGludClcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMuZXh0cmFjdENvbnRleHQoY29udmVydGVkSW5wdXQsIHBvc2l0aW9uSGludCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgICAgbG9jYXRpb24sXG4gICAgICAgICAgICBpbnN0cnVjdGlvbjogaW5wdXQsIC8vIEtlZXAgb3JpZ2luYWwgaW5wdXQgZm9yIGRpc3BsYXlcbiAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSBhY3Rpb24gdHlwZSBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0QWN0aW9uKGlucHV0OiBzdHJpbmcpOiBFZGl0QWN0aW9uIHtcbiAgICAgICAgLy8gQ2hlY2sgcGF0dGVybnMgaW4gb3JkZXIgb2Ygc3BlY2lmaWNpdHlcbiAgICAgICAgZm9yIChjb25zdCBjb21tYW5kUGF0dGVybiBvZiBDT01NQU5EX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgY29tbWFuZFBhdHRlcm4ucGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tbWFuZFBhdHRlcm4uYWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGVmYXVsdCBmYWxsYmFjayBsb2dpYyB3aXRoIG1vcmUgc3BlY2lmaWMgY2hlY2tzXG4gICAgICAgIGlmICgvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8Z2VuZXJhdGUuKnNlY3Rpb24pXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnYWRkJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihmaXh8Y29ycmVjdHxncmFtbWFyfHNwZWxsfHByb29mcmVhZHxwb2xpc2gpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZ3JhbW1hcic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZGVsZXRlfHJlbW92ZXxlbGltaW5hdGUpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnZGVsZXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihyZXdyaXRlfHJlcGhyYXNlfHJlc3RydWN0dXJlfGdlbmVyYXRlLipuZXcpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAncmV3cml0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5fGFkZCkuKlxcYihwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyfHRhZ3x0YWdzfHRpdGxlfGF1dGhvcnxkYXRlfHN0YXR1cylcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdtZXRhZGF0YSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgdG8gZWRpdCBmb3IgYW1iaWd1b3VzIGNhc2VzXG4gICAgICAgIHJldHVybiAnZWRpdCc7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgQU5EIHBvc2l0aW9uIGhpbnQgZm9yIHRoZSBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZXRlY3RUYXJnZXRBbmRQb3NpdGlvbihcbiAgICAgICAgaW5wdXQ6IHN0cmluZywgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgXG4gICAgICAgIGFjdGlvbjogRWRpdEFjdGlvblxuICAgICk6IHsgdGFyZ2V0OiBFZGl0Q29tbWFuZFsndGFyZ2V0J10sIHBvc2l0aW9uSGludD86IHN0cmluZyB9IHtcbiAgICAgICAgbGV0IHBvc2l0aW9uSGludDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHNwZWNpZmljIHBvc2l0aW9uIGluZGljYXRvcnNcbiAgICAgICAgaWYgKC9cXGJhcHBlbmRcXHMrLio/XFxiKD86dG98YWZ0ZXIpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uSGludCA9ICdzZWN0aW9uLWVuZCc7XG4gICAgICAgIH0gZWxzZSBpZiAoL1xcYnByZXBlbmRcXHMrLio/XFxiKD86dG98YmVmb3JlKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICBwb3NpdGlvbkhpbnQgPSAnc2VjdGlvbi1zdGFydCc7XG4gICAgICAgIH0gZWxzZSBpZiAoL1xcYmluc2VydFxccysuKj9cXGJhZnRlclxccysuKj9cXGJoZWFkaW5nXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uSGludCA9ICdhZnRlci1oZWFkaW5nJztcbiAgICAgICAgfSBlbHNlIGlmICgvXFxiaW5zZXJ0XFxzKy4qP1xcYmJlZm9yZVxccysuKj9cXGJoZWFkaW5nXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHBvc2l0aW9uSGludCA9ICdiZWZvcmUtaGVhZGluZyc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGV4cGxpY2l0IHRhcmdldCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHRhcmdldFBhdHRlcm4gb2YgVEFSR0VUX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0UGF0dGVybi5wYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0UGF0dGVybi50YXJnZXQgYXMgRWRpdENvbW1hbmRbJ3RhcmdldCddLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkhpbnQgXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ29udGV4dC1iYXNlZCB0YXJnZXQgZGV0ZWN0aW9uXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24gJiYgKGFjdGlvbiA9PT0gJ2VkaXQnIHx8IGFjdGlvbiA9PT0gJ2dyYW1tYXInIHx8IGFjdGlvbiA9PT0gJ2RlbGV0ZScpKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0YXJnZXQ6ICdzZWxlY3Rpb24nLCBwb3NpdGlvbkhpbnQgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWN0aW9uLXNwZWNpZmljIGRlZmF1bHRzXG4gICAgICAgIGxldCB0YXJnZXQ6IEVkaXRDb21tYW5kWyd0YXJnZXQnXTtcbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gaW5wdXQuaW5jbHVkZXMoJ3NlY3Rpb24nKSB8fCBpbnB1dC5pbmNsdWRlcygnaGVhZGluZycpID8gJ3NlY3Rpb24nIDogJ2VuZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdzZWN0aW9uJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHRhcmdldCA9IGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2RvY3VtZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHRhcmdldCA9ICdlbmQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSAncGFyYWdyYXBoJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHsgdGFyZ2V0LCBwb3NpdGlvbkhpbnQgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSB0YXJnZXQgdHlwZSBmcm9tIHRoZSBpbnB1dCAobGVnYWN5IHdyYXBwZXIpXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZXRlY3RUYXJnZXQoXG4gICAgICAgIGlucHV0OiBzdHJpbmcsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW4sIFxuICAgICAgICBhY3Rpb246IEVkaXRBY3Rpb25cbiAgICApOiBFZGl0Q29tbWFuZFsndGFyZ2V0J10ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gdGhpcy5kZXRlY3RUYXJnZXRBbmRQb3NpdGlvbihpbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGxvY2F0aW9uIGluZm9ybWF0aW9uIGZyb20gdGhlIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0TG9jYXRpb24oaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBMT0NBVElPTl9QQVRURVJOUykge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBwYXR0ZXJuLmV4ZWMoaW5wdXQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBhZGRpdGlvbmFsIGNvbnRleHQgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RDb250ZXh0KGlucHV0OiBzdHJpbmcsIHBvc2l0aW9uSGludD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3Qgc3R5bGUvdG9uZSBpbmRpY2F0b3JzXG4gICAgICAgIGNvbnN0IHN0eWxlSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICdmb3JtYWwnLCAnaW5mb3JtYWwnLCAnY2FzdWFsJywgJ3Byb2Zlc3Npb25hbCcsICdhY2FkZW1pYycsICd0ZWNobmljYWwnLFxuICAgICAgICAgICAgJ3NpbXBsZScsICdjb21wbGV4JywgJ2RldGFpbGVkJywgJ2JyaWVmJywgJ2NvbmNpc2UnLCAndmVyYm9zZScsXG4gICAgICAgICAgICAnZnJpZW5kbHknLCAnc2VyaW91cycsICdodW1vcm91cycsICdjcmVhdGl2ZScsICdhbmFseXRpY2FsJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZm91bmRTdHlsZXMgPSBzdHlsZUluZGljYXRvcnMuZmlsdGVyKHN0eWxlID0+IFxuICAgICAgICAgICAgaW5wdXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHlsZSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIGlmIChmb3VuZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBTdHlsZTogJHtmb3VuZFN0eWxlcy5qb2luKCcsICcpfS4gYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsZW5ndGggaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ3Nob3J0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2JyaWVmJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbmNpc2UnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnS2VlcCBpdCBicmllZi4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2xvbmcnKSB8fCBpbnB1dC5pbmNsdWRlcygnZGV0YWlsZWQnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29tcHJlaGVuc2l2ZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdQcm92aWRlIGRldGFpbGVkIGNvbnRlbnQuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3Qgc3BlY2lmaWMgcmVxdWlyZW1lbnRzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnYnVsbGV0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2xpc3QnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIGJ1bGxldCBwb2ludHMgb3IgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdleGFtcGxlJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGVzJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0luY2x1ZGUgZXhhbXBsZXMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdudW1iZXInKSB8fCBpbnB1dC5pbmNsdWRlcygnbnVtYmVyZWQnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIG51bWJlcmVkIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgcG9zaXRpb24gaGludCBjb250ZXh0XG4gICAgICAgIGlmIChwb3NpdGlvbkhpbnQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocG9zaXRpb25IaW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbi1lbmQnOlxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9ICdQb3NpdGlvbjogQWRkIGF0IHRoZSBlbmQgb2YgdGhlIHNlY3Rpb24uICc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24tc3RhcnQnOlxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0ICs9ICdQb3NpdGlvbjogQWRkIGF0IHRoZSBzdGFydCBvZiB0aGUgc2VjdGlvbiAocmlnaHQgYWZ0ZXIgdGhlIGhlYWRpbmcpLiAnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhZnRlci1oZWFkaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dCArPSAnUG9zaXRpb246IEluc2VydCBpbW1lZGlhdGVseSBhZnRlciB0aGUgaGVhZGluZyBsaW5lLiAnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdiZWZvcmUtaGVhZGluZyc6XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gJ1Bvc2l0aW9uOiBJbnNlcnQgaW1tZWRpYXRlbHkgYmVmb3JlIHRoZSBoZWFkaW5nIGxpbmUuICc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGV4dC50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIGEgY29tbWFuZCBjYW4gYmUgZXhlY3V0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBwcm92aWRlZFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2RlbGV0ZScgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNwZWNpZnkgd2hpY2ggc2VjdGlvbiB0byBkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24tdGFyZ2V0IGNvbWJpbmF0aW9uc1xuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdhZGQnICYmIGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0ZWQgY29tbWFuZHMgYmFzZWQgb24gY29udGV4dFxuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgaGFzSGVhZGluZ3M6IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBhIGNvbmNsdXNpb24gc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNIZWFkaW5ncykge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnQWRkIGNvbnRlbnQgdG8gdGhlIGludHJvZHVjdGlvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIHRoZSBtZXRob2RvbG9neSBzZWN0aW9uJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBtdWx0aXBsZSBjb21tYW5kcyBmcm9tIGEgc2luZ2xlIGlucHV0XG4gICAgICovXG4gICAgcGFyc2VNdWx0aXBsZUNvbW1hbmRzKGlucHV0OiBzdHJpbmcpOiBFZGl0Q29tbWFuZFtdIHtcbiAgICAgICAgLy8gU3BsaXQgb24gY29tbW9uIGNvbW1hbmQgc2VwYXJhdG9yc1xuICAgICAgICBjb25zdCBzZXBhcmF0b3JzID0gL1xcYig/OnRoZW58YWxzb3xhbmQgdGhlbnxhZnRlciB0aGF0fG5leHR8YWRkaXRpb25hbGx5KVxcYi9pO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGlucHV0LnNwbGl0KHNlcGFyYXRvcnMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnBhcnNlQ29tbWFuZChpbnB1dCldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFydHNcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5wYXJzZUNvbW1hbmQocGFydCkpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgY29tbWFuZCBkZXNjcmlwdGlvbiBmb3IgZGlzcGxheVxuICAgICAqL1xuICAgIGdldENvbW1hbmREZXNjcmlwdGlvbihjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCB0YXJnZXQsIGxvY2F0aW9uIH0gPSBjb21tYW5kO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdBZGQgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRWRpdCBleGlzdGluZyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0dlbmVyYXRlIG5ldyBzZWN0aW9ucyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChsb2NhdGlvbikge1xuICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gYCBpbiBcIiR7bG9jYXRpb259XCJgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBjdXJyZW50IHNlY3Rpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgZW5kIG9mIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9XG59IiwgIi8qKlxuICogUHJvbXB0IGJ1aWxkZXIgc2VydmljZSBmb3IgTm92YVxuICogSW50ZWdyYXRlcyBDb250ZXh0QnVpbGRlciB3aXRoIGRvY3VtZW50IGVuZ2luZSBhbmQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyLCBHZW5lcmF0ZWRQcm9tcHQgfSBmcm9tICcuL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFByb21wdCBidWlsZGluZyBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9tcHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcjtcbiAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZTtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb21tYW5kUGFyc2VyOiBDb21tYW5kUGFyc2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICAgICAgdGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgdXNlciBtZXNzYWdlIC0gZGV0ZXJtaW5lcyBpZiBpdCdzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFByb21wdEZvck1lc3NhZ2UoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgbGlrZWx5IGEgY29tbWFuZCBiYXNlZCBvbiBhY3Rpb24gd29yZHNcbiAgICAgICAgY29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5pc0xpa2VseUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNMaWtlbHlDb21tYW5kICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChwYXJzZWRDb21tYW5kLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0J3MgYSBjb252ZXJzYXRpb24gLSBidWlsZCBjb252ZXJzYXRpb24gcHJvbXB0XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbnZlcnNhdGlvblByb21wdChtZXNzYWdlLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgbWVzc2FnZSBpcyBsaWtlbHkgYSBjb21tYW5kIHZzIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gMS4gRXhwbGljaXQgY29tbWFuZCBzeW50YXggKGNvbG9uIGNvbW1hbmRzKVxuICAgICAgICBpZiAobG93ZXJNZXNzYWdlLnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDIuIENoZWNrIGZvciBhY3Rpb24gdmVyYnMgdGhhdCBpbmRpY2F0ZSBkb2N1bWVudCBtb2RpZmljYXRpb24gY29tbWFuZHNcbiAgICAgICAgY29uc3QgYWN0aW9uVmVyYnMgPSBbXG4gICAgICAgICAgICAnYWRkJywgJ2luc2VydCcsICdhcHBlbmQnLCAncHJlcGVuZCcsICdpbmNsdWRlJywgJ2NyZWF0ZScsICd3cml0ZScsICdnZW5lcmF0ZScsXG4gICAgICAgICAgICAnZWRpdCcsICdtb2RpZnknLCAnY2hhbmdlJywgJ3VwZGF0ZScsICdyZXZpc2UnLCAnaW1wcm92ZScsICdlbmhhbmNlJywgJ3JlcGxhY2UnLFxuICAgICAgICAgICAgJ2RlbGV0ZScsICdyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2N1dCcsICdlcmFzZScsICdkcm9wJyxcbiAgICAgICAgICAgICdmaXgnLCAnY29ycmVjdCcsICdwcm9vZnJlYWQnLCAncG9saXNoJywgJ2NoZWNrJyxcbiAgICAgICAgICAgICdyZXdyaXRlJywgJ3Jld29yZCcsICdyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZW9yZ2FuaXplJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbWVzc2FnZSBzdGFydHMgd2l0aCBhbiBhY3Rpb24gdmVyYiAoaW1wZXJhdGl2ZSBjb21tYW5kIHN0cnVjdHVyZSlcbiAgICAgICAgY29uc3Qgc3RhcnRzV2l0aEFjdGlvbiA9IGFjdGlvblZlcmJzLnNvbWUodmVyYiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2ZXJiUGF0dGVybiA9IG5ldyBSZWdFeHAoYF4ke3ZlcmJ9XFxcXGJgLCAnaScpO1xuICAgICAgICAgICAgcmV0dXJuIHZlcmJQYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoc3RhcnRzV2l0aEFjdGlvbikge1xuICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBmaWx0ZXJpbmc6IGV4Y2x1ZGUgcXVlc3Rpb25zIGFuZCBkaXNjdXNzaW9uc1xuICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25JbmRpY2F0b3JzID0gW1xuICAgICAgICAgICAgICAgIC9eKGhvd3x3aGF0fHdoeXx3aGVufHdoZXJlfHdoaWNofHdob3xjYW58Y291bGR8c2hvdWxkfHdvdWxkfHdpbGx8aXN8YXJlfGFtfGRvfGRvZXN8ZGlkKS9pLFxuICAgICAgICAgICAgICAgIC9cXD8vLCAgLy8gQ29udGFpbnMgcXVlc3Rpb24gbWFya1xuICAgICAgICAgICAgICAgIC9cXGIoaGVscHxhZHZpY2V8c3VnZ2VzdHxyZWNvbW1lbmR8dGhpbmt8b3BpbmlvbilcXGIvaVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgaXQncyBhIHF1ZXN0aW9uIG9yIGRpc2N1c3Npb24sIHJvdXRlIHRvIGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgY29uc3QgaXNRdWVzdGlvbiA9IHF1ZXN0aW9uSW5kaWNhdG9ycy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KGxvd2VyTWVzc2FnZSkpO1xuICAgICAgICAgICAgaWYgKGlzUXVlc3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyAzLiBDaGVjayBmb3IgZXhwbGljaXQgY29tbWFuZCBwYXR0ZXJucyAoZm9yIGVkZ2UgY2FzZXMpXG4gICAgICAgIGNvbnN0IGV4cGxpY2l0Q29tbWFuZFBhdHRlcm5zID0gW1xuICAgICAgICAgICAgLy8gR3JhbW1hci9zcGVsbGluZyBjb21tYW5kcyB0aGF0IGRvbid0IHN0YXJ0IHdpdGggYWN0aW9uIHZlcmJzXG4gICAgICAgICAgICAvXFxiKGdyYW1tYXJ8c3BlbGx8c3BlbGxpbmd8cHJvb2ZyZWFkfHBvbGlzaClcXGIuKlxcYihjaGVja3xmaXh8Y29ycmVjdClcXGIvaSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTWV0YWRhdGEgY29tbWFuZHMgd2l0aCBkaWZmZXJlbnQgc3RydWN0dXJlc1xuICAgICAgICAgICAgL1xcYnNldFxccysodGhlXFxzKyk/KHRpdGxlfHRhZ3N8bWV0YWRhdGF8cHJvcGVydGllcykvaSxcbiAgICAgICAgICAgIC9cXGJ1cGRhdGVcXHMrKHRoZVxccyspPyh0aXRsZXx0YWdzfG1ldGFkYXRhfHByb3BlcnRpZXMpL2lcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIG1lc3NhZ2UgbWF0Y2hlcyBleHBsaWNpdCBjb21tYW5kIHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBleHBsaWNpdENvbW1hbmRQYXR0ZXJucykge1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChsb3dlck1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDQuIEV2ZXJ5dGhpbmcgZWxzZSBnb2VzIHRvIGNvbnZlcnNhdGlvbiBtb2RlXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29tbWFuZFByb21wdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBpcyByZXF1aXJlZCBmb3IgY29tbWFuZCBwcm9tcHRzJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBuZWVkZWRcbiAgICAgICAgbGV0IGNvbnZlcnNhdGlvbkNvbnRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKG9wdGlvbnMuaW5jbHVkZUhpc3RvcnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShyZWNlbnRNZXNzYWdlcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCB0aGUgcHJvbXB0XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgb3B0aW9ucywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBjb252ZXJzYXRpb24gKG5vbi1jb21tYW5kIG1lc3NhZ2VzKVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZSxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge31cbiAgICApOiBQcm9taXNlPEdlbmVyYXRlZFByb21wdD4ge1xuICAgICAgICBsZXQgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCByZWNlbnRIaXN0b3J5OiBDb252ZXJzYXRpb25NZXNzYWdlW10gPSBbXTtcblxuICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dCBpZiBmaWxlIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IHJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICAgICAgICAgcmVjZW50SGlzdG9yeSA9IGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KG1lc3NhZ2UsIGRvY3VtZW50Q29udGV4dCwgcmVjZW50SGlzdG9yeSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbiwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRvY3VtZW50IGNvbnRleHQgZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxEb2N1bWVudENvbnRleHQ+IHtcbiAgICAgICAgLy8gVXNlIHRoZSBkb2N1bWVudCBlbmdpbmUncyBidWlsdC1pbiBjb250ZXh0IGdhdGhlcmluZ1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGNyZWF0ZSBtaW5pbWFsIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGVudCgpIHx8ICcnO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgaGVhZGluZ3M6IFtdLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXM6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybiB0aGUgY29udGV4dCBhcy1pcywgc2luY2UgaXQncyBhbHJlYWR5IGluIHRoZSBjb3JyZWN0IGZvcm1hdFxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgY29udmVyc2F0aW9uIGhpc3RvcnkgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkobWVzc2FnZXM6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSk6IHN0cmluZyB7XG4gICAgICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybiAnJztcblxuICAgICAgICBsZXQgZm9ybWF0dGVkID0gJ1JFQ0VOVCBDT05WRVJTQVRJT046XFxuJztcbiAgICAgICAgbWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuICAgICAgICAgICAgY29uc3Qgcm9sZSA9IG1zZy5yb2xlID09PSAndXNlcicgPyAnWW91JyA6ICdOb3ZhJztcbiAgICAgICAgICAgIGZvcm1hdHRlZCArPSBgJHtyb2xlfTogJHttc2cuY29udGVudH1cXG5gO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFuZCBvcHRpbWl6ZSBwcm9tcHQgYmVmb3JlIHNlbmRpbmcgdG8gQUlcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUFuZE9wdGltaXplUHJvbXB0KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgLy8gUHJvbXB0IHZhbGlkYXRpb24gaXNzdWVzIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIGZpeCBjb21tb24gaXNzdWVzXG4gICAgICAgICAgICBsZXQgb3B0aW1pemVkUHJvbXB0ID0geyAuLi5wcm9tcHQgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ1bmNhdGUgaWYgdG9vIGxvbmdcbiAgICAgICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKHRva2VuQ291bnQgPiA4MDAwKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVkdWNlIGNvbnRleHQgc2l6ZSBtb3JlIGFnZ3Jlc3NpdmVseVxuICAgICAgICAgICAgICAgIGNvbnN0IG1heENvbnRleHRMZW5ndGggPSBNYXRoLmZsb29yKHByb21wdC5jb250ZXh0Lmxlbmd0aCAqIDAuNik7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbnRleHQgPSBwcm9tcHQuY29udGV4dC5zdWJzdHJpbmcoMCwgbWF4Q29udGV4dExlbmd0aCkgKyAnXFxuW0NvbnRleHQgdHJ1bmNhdGVkLi4uXSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsYW1wIHRlbXBlcmF0dXJlXG4gICAgICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA8IDAgfHwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA+IDEpIHtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCBtYXggdG9rZW5zXG4gICAgICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29uZmlnLm1heFRva2VucyA9IE1hdGgubWF4KDEwLCBNYXRoLm1pbig0MDAwLCBwcm9tcHQuY29uZmlnLm1heFRva2VucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gb3B0aW1pemVkUHJvbXB0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdG9rZW4gY291bnQgZXN0aW1hdGUgZm9yIGEgcHJvbXB0XG4gICAgICovXG4gICAgZ2V0VG9rZW5Db3VudChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRCdWlsZGVyLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgYWN0aW9uIHdpdGggbWluaW1hbCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRRdWlja1Byb21wdChcbiAgICAgICAgYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sXG4gICAgICAgIGluc3RydWN0aW9uOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmQ6IEVkaXRDb21tYW5kID0ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0OiAnZG9jdW1lbnQnLFxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24sXG4gICAgICAgICAgICBsb2NhdGlvbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgY29udGV4dDogdW5kZWZpbmVkXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChjb21tYW5kLCBmaWxlLCB7IFxuICAgICAgICAgICAgICAgIG1heENvbnRleHRMaW5lczogMTAsXG4gICAgICAgICAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgaW5jbHVkZUhpc3Rvcnk6IGZhbHNlIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgd2l0aCBjdXN0b20gc3lzdGVtIHByb21wdCBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ3VzdG9tUHJvbXB0KFxuICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZyxcbiAgICAgICAgdXNlck1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlXG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgbGV0IGNvbnRleHQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIGNvbnRleHQgPSBgRG9jdW1lbnQ6ICR7ZG9jdW1lbnRDb250ZXh0LmZpbGVuYW1lfVxcbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0OiB1c2VyTWVzc2FnZSxcbiAgICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogMTAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBBZGQgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBhZGRpbmcgbmV3IGNvbnRlbnQgdG8gZG9jdW1lbnRzXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQWRkQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhZGQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdFxuICAgICAgICAgICAgICAgIGxldCBpbnNlcnRQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRQb3NpdGlvbiA9IGF3YWl0IHRoaXMuZGV0ZXJtaW5lSW5zZXJ0UG9zaXRpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgc2VjdGlvbiBub3QgZm91bmQgZXJyb3Igd2l0aCBiZXR0ZXIgbWVzc2FnaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ25vdCBmb3VuZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSB0aGlzLmJ1aWxkU2VjdGlvbk5vdEZvdW5kRXJyb3IoY29tbWFuZC5sb2NhdGlvbiEsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yTWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoZXJyb3JNZXNzYWdlLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0UG9zaXRpb24sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBhZGQgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZSB3aGVyZSB0byBpbnNlcnQgbmV3IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGRldGVybWluZUluc2VydFBvc2l0aW9uKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0XG4gICAgKTogUHJvbWlzZTwnY3Vyc29yJyB8ICdzZWxlY3Rpb24nIHwgJ2VuZCcgfCB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdlbmQnO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERldGVybWluZSBwb3NpdGlvbiBiYXNlZCBvbiBjb250ZXh0IGhpbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvbkhpbnQgPSB0aGlzLmV4dHJhY3RQb3NpdGlvbkhpbnQoY29tbWFuZC5jb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwb3NpdGlvbkhpbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uLXN0YXJ0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGF0IHN0YXJ0IG9mIHNlY3Rpb24gKHJpZ2h0IGFmdGVyIGhlYWRpbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGxpbmU6IHNlY3Rpb24ucmFuZ2Uuc3RhcnQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FmdGVyLWhlYWRpbmcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnNlcnQgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIGhlYWRpbmcgbGluZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0ICsgMSwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdiZWZvcmUtaGVhZGluZyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluc2VydCBpbW1lZGlhdGVseSBiZWZvcmUgdGhlIGhlYWRpbmcgbGluZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24tZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYXQgZW5kIG9mIHNlY3Rpb24gKGRlZmF1bHQgYmVoYXZpb3IpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGxpbmU6IHNlY3Rpb24ucmFuZ2UuZW5kLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2VjdGlvbiBub3QgZm91bmQgLSB0aGlzIHdpbGwgYmUgaGFuZGxlZCBieSB0aGUgY2FsbGluZyBtZXRob2RcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdoaWNoIHNob3VsZCBzaG93IGFwcHJvcHJpYXRlIGVycm9yIG1lc3NhZ2VzXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gSWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkLCB1c2UgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuICdjdXJzb3InO1xuXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBBZGQgYXQgdGhlIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiAnZW5kJztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBhZGQgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQWRkIGNvbW1hbmQgY2Fubm90IHRhcmdldCBzZWxlY3Rpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgYWRkIGNvbnRlbnQgdG8gYSBzZWxlY3Rpb24uIFVzZSBcImVkaXRcIiB0byBtb2RpZnkgc2VsZWN0ZWQgdGV4dCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0YXJnZXRpbmcgYSBzZWN0aW9uLCBsb2NhdGlvbiBzaG91bGQgYmUgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgc3RpbGwgdmFsaWQgLSB3ZSdsbCBhZGQgdG8gY3VycmVudCBzZWN0aW9uIG9yIGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBwb3NpdGlvbiBoaW50IGZyb20gY29tbWFuZCBjb250ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0UG9zaXRpb25IaW50KGNvbnRleHQ/OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgaWYgKCFjb250ZXh0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb250ZXh0LmluY2x1ZGVzKCdQb3NpdGlvbjogQWRkIGF0IHRoZSBlbmQgb2YgdGhlIHNlY3Rpb24nKSkge1xuICAgICAgICAgICAgcmV0dXJuICdzZWN0aW9uLWVuZCc7XG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5pbmNsdWRlcygnUG9zaXRpb246IEFkZCBhdCB0aGUgc3RhcnQgb2YgdGhlIHNlY3Rpb24nKSkge1xuICAgICAgICAgICAgcmV0dXJuICdzZWN0aW9uLXN0YXJ0JztcbiAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0LmluY2x1ZGVzKCdQb3NpdGlvbjogSW5zZXJ0IGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBoZWFkaW5nIGxpbmUnKSkge1xuICAgICAgICAgICAgcmV0dXJuICdhZnRlci1oZWFkaW5nJztcbiAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0LmluY2x1ZGVzKCdQb3NpdGlvbjogSW5zZXJ0IGltbWVkaWF0ZWx5IGJlZm9yZSB0aGUgaGVhZGluZyBsaW5lJykpIHtcbiAgICAgICAgICAgIHJldHVybiAnYmVmb3JlLWhlYWRpbmcnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBlcnJvciBtZXNzYWdlIHdoZW4gc2VjdGlvbiBpcyBub3QgZm91bmQsIHNob3dpbmcgYXZhaWxhYmxlIGhpZXJhcmNoaWNhbCBwYXRoc1xuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTZWN0aW9uTm90Rm91bmRFcnJvcihzZWN0aW9uTmFtZTogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVBhdGhzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgaGllcmFyY2hpY2FsIHBhdGhzIGZvciBhbGwgaGVhZGluZ3NcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goKGhlYWRpbmcsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5idWlsZFNlY3Rpb25QYXRoKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncywgaW5kZXgpO1xuICAgICAgICAgICAgYXZhaWxhYmxlUGF0aHMucHVzaChwYXRoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gYFNlY3Rpb24gXCIke3NlY3Rpb25OYW1lfVwiIG5vdCBmb3VuZC5cXG5cXG5BdmFpbGFibGUgc2VjdGlvbnM6YDtcbiAgICAgICAgYXZhaWxhYmxlUGF0aHMuZm9yRWFjaChwYXRoID0+IHtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSBgXFxuLSAke3BhdGh9YDtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBlcnJvck1lc3NhZ2UgKz0gYFxcblxcblRpcDogVXNlIGhpZXJhcmNoaWNhbCBwYXRocyBsaWtlIFwiTWV0aG9kczo6RGF0YSBDb2xsZWN0aW9uXCIgdG8gdGFyZ2V0IHNwZWNpZmljIG5lc3RlZCBzZWN0aW9ucy5gO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVycm9yTWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBoaWVyYXJjaGljYWwgcGF0aCBmb3IgYSBoZWFkaW5nIChkdXBsaWNhdGVkIGZyb20gRG9jdW1lbnRFbmdpbmUgZm9yIGVycm9yIG1lc3NhZ2VzKVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTZWN0aW9uUGF0aChoZWFkaW5nczogYW55W10sIHRhcmdldEluZGV4OiBudW1iZXIpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBoZWFkaW5nc1t0YXJnZXRJbmRleF07XG4gICAgICAgIGNvbnN0IHBhdGg6IHN0cmluZ1tdID0gW3RhcmdldC50ZXh0XTtcbiAgICAgICAgXG4gICAgICAgIC8vIFdhbGsgYmFja3dhcmRzIHRvIGZpbmQgcGFyZW50IGhlYWRpbmdzXG4gICAgICAgIGZvciAobGV0IGkgPSB0YXJnZXRJbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkaW5nID0gaGVhZGluZ3NbaV07XG4gICAgICAgICAgICBpZiAoaGVhZGluZy5sZXZlbCA8IHRhcmdldC5sZXZlbCkge1xuICAgICAgICAgICAgICAgIHBhdGgudW5zaGlmdChoZWFkaW5nLnRleHQpO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpbW1lZGlhdGUgcGFyZW50IGZvciBub3cgKHNpbmdsZSBsZXZlbCB1cClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhdGguam9pbignOjonKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGlvbnMgZm9yIGFkZCBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXG4gICAgICAgICAgICAnQWRkIGEgY29uY2x1c2lvbiBzZWN0aW9uJyxcbiAgICAgICAgICAgICdBZGQgYW4gaW50cm9kdWN0aW9uJyxcbiAgICAgICAgICAgICdDcmVhdGUgYSBzdW1tYXJ5JyxcbiAgICAgICAgICAgICdBZGQgZXhhbXBsZXMnLFxuICAgICAgICAgICAgJ0NyZWF0ZSBhIG1ldGhvZG9sb2d5IHNlY3Rpb24nXG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnMgYmFzZWQgb24gZXhpc3RpbmcgaGVhZGluZ3NcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uTmFtZXMgPSBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubWFwKGggPT4gaC50ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaW50cm9kdWN0aW9uJykpKSB7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMudW5zaGlmdCgnQWRkIGFuIGludHJvZHVjdGlvbiBzZWN0aW9uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghc2VjdGlvbk5hbWVzLnNvbWUobmFtZSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NvbmNsdXNpb24nKSkpIHtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdBZGQgYSBjb25jbHVzaW9uIHNlY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFzZWN0aW9uTmFtZXMuc29tZShuYW1lID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc3VtbWFyeScpKSkge1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0FkZCBhIHN1bW1hcnkgc2VjdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDgpOyAvLyBMaW1pdCB0byA4IHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IGNvbnRlbnQgd291bGQgYmUgYWRkZWQgKHdpdGhvdXQgYWN0dWFsbHkgYWRkaW5nIGl0KVxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIHBvc2l0aW9uPzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHdoZXJlIGNvbnRlbnQgd291bGQgYmUgcGxhY2VkXG4gICAgICAgICAgICBsZXQgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSBgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25EZXNjcmlwdGlvbiA9ICdpbiB0aGUgY3VycmVudCBzZWN0aW9uJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uRGVzY3JpcHRpb24gPSAnYXQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbkRlc2NyaXB0aW9uID0gJ2F0IHRoZSBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogYFdpbGwgYWRkIG5ldyBjb250ZW50ICR7cG9zaXRpb25EZXNjcmlwdGlvbn1gLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbkRlc2NyaXB0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBFZGl0IGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgbW9kaWZ5aW5nIGFuZCBpbXByb3ZpbmcgZXhpc3RpbmcgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIExvZyB1c2VyIHJlcXVlc3RcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZFVzZXJNZXNzYWdlKGNvbW1hbmQuaW5zdHJ1Y3Rpb24sIGNvbW1hbmQpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgZWRpdCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBlZGl0IGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGVkaXQgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBlbnRpcmUgc2VjdGlvbiBjb250ZW50IChleGNsdWRpbmcgaGVhZGluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHRvIHJlcGxhY2UgZnJvbSBoZWFkaW5nIGxpbmUgdG8gc2VjdGlvbiBlbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgZWRpdCBjb21tYW5kcyB0YXJnZXRpbmcgZW5kLCB0cmVhdCBhcyBhZGRpbmcgdG8gZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBlZGl0IHRhcmdldCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZWRpdCBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAqL1xuICAgIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIGxvY2F0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgcHJvdmlkZWQgZm9yIHNlY3Rpb24gZWRpdHNcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdlZGl0JyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiBlZGl0c1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBlZGl0IGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGRldGFpbGVkJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBjbGFyaXR5IGFuZCBmbG93JyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgZm9ybWFsJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgdGhpcyB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnRXhwYW5kIG9uIHRoaXMgcG9pbnQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBlbmdhZ2luZydcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdJbXByb3ZlIHRoZSB3cml0aW5nIHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgZG9jdW1lbnQgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFbmhhbmNlIGNsYXJpdHkgdGhyb3VnaG91dCcsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgdGhlIGludHJvZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgJ1BvbGlzaCB0aGUgY29uY2x1c2lvbicsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBjb25jaXNlJyxcbiAgICAgICAgICAgICAgICAnQWRkIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSB0aGUgZmxvdyBiZXR3ZWVuIHNlY3Rpb25zJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5mb3JFYWNoKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKGBJbXByb3ZlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCAxMCk7IC8vIExpbWl0IHRvIDEwIHN1Z2dlc3Rpb25zXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmlldyB3aGF0IHdvdWxkIGJlIGVkaXRlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBhZmZlY3RlZENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGxldCBwcmV2aWV3VGV4dCA9ICcnO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgdGhlIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGVkaXQgdGhlIGVudGlyZSBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGVkaXQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uPy5saW5lID8/IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZWRpdCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGFkZCBlZGl0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGVkaXQgdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZWRpdCB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGNoYW5nZXNcbiAgICAgKi9cbiAgICBhc3luYyBlc3RpbWF0ZVNjb3BlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8e1xuICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgbGluZXNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBzY29wZURlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBzZWN0aW9uLmNvbnRlbnQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IHNlY3Rpb24ucmFuZ2UuZW5kIC0gc2VjdGlvbi5yYW5nZS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDsgLy8gTmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ05ldyBjb250ZW50IGF0IGVuZCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogRGVsZXRlIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgcmVtb3ZpbmcgY29udGVudCBmcm9tIGRvY3VtZW50c1xuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHNtYXJ0IGRlbGV0aW9uLCB3ZSBtYXkgbmVlZCBBSSB0byBkZXRlcm1pbmUgd2hhdCB0byBkZWxldGVcbiAgICAgICAgICAgIGlmIChjb21tYW5kLmluc3RydWN0aW9uICYmIGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB0byBpZGVudGlmeSB3aGF0IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBc2sgQUkgd2hhdCBjb250ZW50IHNob3VsZCBiZSBkZWxldGVkXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGRldGVybWluZSBkZWxldGlvbiBhY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIE1WUCwgd2UnbGwgcHJvY2VlZCB3aXRoIHRoZSB0YXJnZXQtYmFzZWQgZGVsZXRpb25cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBhbmFseXNpcyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yOiAke3Jlc3VsdC5lcnJvcn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBkZWxldGlvbiByZXN1bHQgKG9ubHkgZmFpbHVyZXMpXG4gICAgICAgICAgICBpZiAoY29tbWFuZC5pbnN0cnVjdGlvbiAmJiBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPiAwICYmICFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZGVsZXRpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RGVsZXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHRcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZGVsZXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgZW50aXJlIHNlY3Rpb24gaW5jbHVkaW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3Igc2VjdGlvbiBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgcGFyYWdyYXBoIGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ29udGVudCA9IGVkaXRvci5nZXRMaW5lKGN1cnJlbnRMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXMgKGVtcHR5IGxpbmVzIG9yIGhlYWRpbmcgbWFya2VycylcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgdGhlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudCgnJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGNvbnRlbnQgZnJvbSBlbmQgLSBub3QgbWVhbmluZ2Z1bCBmb3IgZGVsZXRlIGNvbW1hbmRcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LicsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZGVsZXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb24gaXMgcmVxdWlyZWQgZm9yIHNlY3Rpb24gZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgIWNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnU2VjdGlvbiBuYW1lIHJlcXVpcmVkIGZvciBzZWN0aW9uIGRlbGV0aW9uJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIHRhcmdldCBpcyBhcHByb3ByaWF0ZSBmb3IgZGVsZXRpb25cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnZW5kJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIG9mIGRvY3VtZW50LiBVc2UgYSBkaWZmZXJlbnQgdGFyZ2V0LidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgZGVsZXRlIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JyxcbiAgICAgICAgICAgICAgICAnUmVtb3ZlIHRoaXMgY29udGVudCcsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHRoZSBzZWxlY3Rpb24nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRGVsZXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ1JlbW92ZSBlbXB0eSBzZWN0aW9ucycsXG4gICAgICAgICAgICAgICAgJ0NsZWFyIHJlZHVuZGFudCBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAnRGVsZXRlIGR1cGxpY2F0ZSBpbmZvcm1hdGlvbidcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzZWN0aW9uLXNwZWNpZmljIGRlbGV0aW9uIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MuZm9yRWFjaChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChgRGVsZXRlIHRoZSBcIiR7aGVhZGluZy50ZXh0fVwiIHNlY3Rpb25gKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCA4KTsgLy8gTGltaXQgdG8gOCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBkZWxldGVkXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGFmZmVjdGVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgbGV0IHByZXZpZXdUZXh0ID0gJyc7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IGlzIGN1cnJlbnRseSBzZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtzZWN0aW9uLmNvbnRlbnR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGRlbGV0ZSB0aGUgZW50aXJlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1NlY3Rpb24gbmFtZSByZXF1aXJlZCBmb3IgcHJldmlldydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGRlbGV0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY3VycmVudCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhcmFncmFwaExpbmVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHN0YXJ0IG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdGFydExpbmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2TGluZS50cmltKCkgPT09ICcnIHx8IHByZXZMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRMaW5lLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgZW5kIG9mIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVDb3VudCA9IGVkaXRvci5saW5lQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dExpbmUgPSBlZGl0b3IuZ2V0TGluZShlbmRMaW5lICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS50cmltKCkgPT09ICcnIHx8IG5leHRMaW5lLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBwYXJhZ3JhcGggY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBzdGFydExpbmU7IGkgPD0gZW5kTGluZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaExpbmVzLnB1c2goZWRpdG9yLmdldExpbmUoaSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBwYXJhZ3JhcGhMaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgZGVsZXRlIGFsbCBkb2N1bWVudCBjb250ZW50JztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgZnJvbSBlbmQgb2YgZG9jdW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgZGVsZXRpb24gdGFyZ2V0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJldmlldzogcHJldmlld1RleHQsXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50OiBhZmZlY3RlZENvbnRlbnQubGVuZ3RoID4gMjAwID8gXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nIDogXG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGVsZXRlIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnXTtcblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgdGFyZ2V0cy51bnNoaWZ0KCdzZWxlY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoLTEsIDAsICdzZWN0aW9uJyk7IC8vIEluc2VydCBiZWZvcmUgJ2RvY3VtZW50J1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIGRlbGV0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogJ05vIGRvY3VtZW50IGF2YWlsYWJsZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aCArIHNlY3Rpb24uaGVhZGluZy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSBgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0ludmFsaWQgdGFyZ2V0IGZvciBkZWxldGlvbic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkLFxuICAgICAgICAgICAgbGluZXNBZmZlY3RlZCxcbiAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb25cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogR3JhbW1hciBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGdyYW1tYXIgY2hlY2tpbmcgYW5kIGNvcnJlY3Rpb24gb2YgY29udGVudFxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEdyYW1tYXJDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uIHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb24gZm9yIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgdXNlciByZXF1ZXN0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRVc2VyTWVzc2FnZShjb21tYW5kLmluc3RydWN0aW9uLCBjb21tYW5kKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvcnJlY3RlZENvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLCAvLyBMb3dlciB0ZW1wZXJhdHVyZSBmb3IgZ3JhbW1hciBjb3JyZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICghY29ycmVjdGVkQ29udGVudCB8fCBjb3JyZWN0ZWRDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCByZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBjb3JyZWN0ZWQgY29udGVudCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5R3JhbW1hckNvcnJlY3Rpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb3JyZWN0ZWRDb250ZW50KTtcblxuICAgICAgICAgICAgICAgIC8vIERvbid0IGxvZyBzdWNjZXNzIG1lc3NhZ2VzIC0gaGFuZGxlZCBieSBVSVxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKCdGYWlsZWQgdG8gY29ycmVjdCBncmFtbWFyJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdHcmFtbWFyIGNvcnJlY3Rpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hZGRBc3Npc3RhbnRNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBgRXJyb3I6ICR7cmVzdWx0LmVycm9yfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlHcmFtbWFyQ29ycmVjdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29ycmVjdGVkQ29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb3JyZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlY3Rpb24gY29udGVudCB3aGlsZSBwcmVzZXJ2aW5nIGhlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NlY3Rpb25Db250ZW50ID0gYCR7c2VjdGlvbi5oZWFkaW5nfVxcblxcbiR7Y29ycmVjdGVkQ29udGVudH1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5zdGFydCwgY2g6IDAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogc2VjdGlvbi5yYW5nZS5lbmQgKyAxLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3U2VjdGlvbkNvbnRlbnQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3U2VjdGlvbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHN0YXJ0UG9zXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIEZhbGwgdGhyb3VnaCB0byBwYXJhZ3JhcGggaWYgbm8gbG9jYXRpb24gc3BlY2lmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IGdyYW1tYXIgY29ycmVjdGlvbiB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCBjb3JyZWN0ZWQgY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29ycmVjdGVkQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvcnJlY3RlZENvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciBncmFtbWFyIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyBjb3JyZWN0ZWQgY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvcnJlY3RlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdyYW1tYXIgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3Igc2VjdGlvbiB0YXJnZXRzLCBsb2NhdGlvbiBzaG91bGQgYmUgcHJvdmlkZWQgZm9yIGJldHRlciBhY2N1cmFjeVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWN0aW9uJyAmJiBjb21tYW5kLmFjdGlvbiA9PT0gJ2dyYW1tYXInICYmIGNvbW1hbmQubG9jYXRpb24pIHtcbiAgICAgICAgICAgIC8vIExvY2F0aW9uIGlzIHByb3ZpZGVkLCB3aGljaCBpcyBnb29kIGZvciBzZWN0aW9uIGdyYW1tYXIgY29ycmVjdGlvblxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3Rpb25zIGZvciBncmFtbWFyIGNvbW1hbmRzXG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXIgaW4gc2VsZWN0ZWQgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ0NvcnJlY3Qgc3BlbGxpbmcgYW5kIHB1bmN0dWF0aW9uJyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSBzZW50ZW5jZSBzdHJ1Y3R1cmUnLFxuICAgICAgICAgICAgICAgICdGaXggY2FwaXRhbGl6YXRpb24gZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCB2ZXJiIHRlbnNlcycsXG4gICAgICAgICAgICAgICAgJ0ZpeCBzdWJqZWN0LXZlcmIgYWdyZWVtZW50JyxcbiAgICAgICAgICAgICAgICAnSW1wcm92ZSByZWFkYWJpbGl0eSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdDaGVjayBncmFtbWFyIHRocm91Z2hvdXQgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdGaXggc3BlbGxpbmcgZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAnQ29ycmVjdCBwdW5jdHVhdGlvbicsXG4gICAgICAgICAgICAgICAgJ0ltcHJvdmUgc2VudGVuY2Ugc3RydWN0dXJlJyxcbiAgICAgICAgICAgICAgICAnRml4IGdyYW1tYXRpY2FsIGVycm9ycyBpbiBjdXJyZW50IHBhcmFncmFwaCcsXG4gICAgICAgICAgICAgICAgJ0NoZWNrIGZvciBjb21tb24gbWlzdGFrZXMnLFxuICAgICAgICAgICAgICAgICdQcm9vZnJlYWQgdGhlIGRvY3VtZW50J1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgZ3JhbW1hciBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYENoZWNrIGdyYW1tYXIgaW4gXCIke2hlYWRpbmcudGV4dH1cIiBzZWN0aW9uYCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgMTApOyAvLyBMaW1pdCB0byAxMCBzdWdnZXN0aW9uc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXZpZXcgd2hhdCB3b3VsZCBiZSBncmFtbWFyLWNvcnJlY3RlZFxuICAgICAqL1xuICAgIGFzeW5jIHByZXZpZXcoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgICAgIHByZXZpZXc/OiBzdHJpbmc7XG4gICAgICAgIGFmZmVjdGVkQ29udGVudD86IHN0cmluZztcbiAgICAgICAgcG90ZW50aWFsSXNzdWVzPzogc3RyaW5nW107XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHBvdGVudGlhbElzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGluIHRoZSBzZWxlY3RlZCB0ZXh0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmFzaWMgZ3JhbW1hciBpc3N1ZSBkZXRlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgaXMgY3VycmVudGx5IHNlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZmluZFNlY3Rpb24oY29tbWFuZC5sb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9IGBXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3Vlcy5wdXNoKC4uLnRoaXMuZGV0ZWN0UG90ZW50aWFsSXNzdWVzKGFmZmVjdGVkQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBTZWN0aW9uIFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIG5vdCBmb3VuZGBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBjaGVjayBncmFtbWFyIGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJhZ3JhcGgnOlxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgaW4gdGhlIGN1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbi5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhMaW5lczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHBhcmFncmFwaCBib3VuZGFyaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmRMaW5lID0gY3VycmVudExpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnRMaW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2TGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0TGluZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ291bnQgPSBlZGl0b3IubGluZUNvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVuZExpbmUgPCBsaW5lQ291bnQgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dExpbmUudHJpbSgpID09PSAnJyB8fCBuZXh0TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcGFyYWdyYXBoIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRMaW5lOyBpIDw9IGVuZExpbmU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhZ3JhcGhMaW5lcy5wdXNoKGVkaXRvci5nZXRMaW5lKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gcGFyYWdyYXBoTGluZXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIGNoZWNrIGdyYW1tYXIgdGhyb3VnaG91dCB0aGUgZW50aXJlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsSXNzdWVzLnB1c2goLi4udGhpcy5kZXRlY3RQb3RlbnRpYWxJc3N1ZXMoYWZmZWN0ZWRDb250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCBhZGQgZ3JhbW1hci1jb3JyZWN0ZWQgY29udGVudCBhdCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGdyYW1tYXIgY29ycmVjdGlvbiB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHBvdGVudGlhbElzc3VlczogcG90ZW50aWFsSXNzdWVzLnNsaWNlKDAsIDUpIC8vIExpbWl0IHRvIDUgaXNzdWVzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdCBwb3RlbnRpYWwgZ3JhbW1hciBpc3N1ZXMgaW4gdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0UG90ZW50aWFsSXNzdWVzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQmFzaWMgcGF0dGVybiBtYXRjaGluZyBmb3IgY29tbW9uIGlzc3Vlc1xuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYmlcXHMvZ2ksIGlzc3VlOiAnTG93ZXJjYXNlIFwiaVwiIHNob3VsZCBiZSBjYXBpdGFsaXplZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcLlxccypbYS16XS9nLCBpc3N1ZTogJ1NlbnRlbmNlIHNob3VsZCBzdGFydCB3aXRoIGNhcGl0YWwgbGV0dGVyJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHNwYWNlcyBkZXRlY3RlZCcgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1suIT9dezIsfS9nLCBpc3N1ZTogJ011bHRpcGxlIHB1bmN0dWF0aW9uIG1hcmtzJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxzK1suIT8sOjtdL2csIGlzc3VlOiAnU3BhY2UgYmVmb3JlIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvWy4hP11cXHcvZywgaXNzdWU6ICdNaXNzaW5nIHNwYWNlIGFmdGVyIHB1bmN0dWF0aW9uJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxidGVoXFxiL2dpLCBpc3N1ZTogJ0NvbW1vbiB0eXBvOiBcInRlaFwiIHNob3VsZCBiZSBcInRoZVwiJyB9LFxuICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXFxiYW5kXFxzK2FuZFxcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJhbmRcIicgfSxcbiAgICAgICAgICAgIHsgcGF0dGVybjogL1xcYnRoZVxccyt0aGVcXGIvZ2ksIGlzc3VlOiAnRHVwbGljYXRlIFwidGhlXCInIH0sXG4gICAgICAgICAgICB7IHBhdHRlcm46IC9cXGJpc1xccytpc1xcYi9naSwgaXNzdWU6ICdEdXBsaWNhdGUgXCJpc1wiJyB9XG4gICAgICAgIF07XG5cbiAgICAgICAgcGF0dGVybnMuZm9yRWFjaCgoeyBwYXR0ZXJuLCBpc3N1ZSB9KSA9PiB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KHRleHQpKSB7XG4gICAgICAgICAgICAgICAgaXNzdWVzLnB1c2goaXNzdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaXNzdWVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBncmFtbWFyIGNoZWNrIHRhcmdldHMgYXZhaWxhYmxlIGZvciBjdXJyZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRBdmFpbGFibGVUYXJnZXRzKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0czogRWRpdENvbW1hbmRUeXBlWyd0YXJnZXQnXVtdID0gWydwYXJhZ3JhcGgnLCAnZG9jdW1lbnQnLCAnZW5kJ107XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgIHRhcmdldHMudW5zaGlmdCgnc2VsZWN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRhcmdldHMuc3BsaWNlKC0yLCAwLCAnc2VjdGlvbicpOyAvLyBJbnNlcnQgYmVmb3JlICdkb2N1bWVudCcgYW5kICdlbmQnXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGFyZ2V0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSB0aGUgc2NvcGUgb2YgZ3JhbW1hciBjb3JyZWN0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZXN0aW1hdGVTY29wZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIGxpbmVzQWZmZWN0ZWQ6IG51bWJlcjtcbiAgICAgICAgc2NvcGVEZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgICBlc3RpbWF0ZWRJc3N1ZXM6IG51bWJlcjtcbiAgICB9PiB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkOiAwLFxuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb246ICdObyBkb2N1bWVudCBhdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZElzc3VlczogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgIGxldCBzY29wZURlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIGxldCBjb250ZW50VG9BbmFseXplID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdTZWxlY3RlZCB0ZXh0IG9ubHknO1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmZpbmRTZWN0aW9uKGNvbW1hbmQubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gc2VjdGlvbi5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBzZWN0aW9uLnJhbmdlLmVuZCAtIHNlY3Rpb24ucmFuZ2Uuc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gYFwiJHtjb21tYW5kLmxvY2F0aW9ufVwiIHNlY3Rpb25gO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IHNlY3Rpb24uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAvLyBFc3RpbWF0ZSBzaW5nbGUgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gMTAwOyAvLyBSb3VnaCBlc3RpbWF0ZVxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAxO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnQ3VycmVudCBwYXJhZ3JhcGgnO1xuICAgICAgICAgICAgICAgIC8vIEZvciBlc3RpbWF0aW9uIHB1cnBvc2VzLCB1c2Ugc3Vycm91bmRpbmcgY29udGV4dFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50VG9BbmFseXplID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArIGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0VudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDA7IC8vIE5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdOZXcgY29udGVudCBhdCBlbmQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXN0aW1hdGUgcG90ZW50aWFsIGlzc3Vlc1xuICAgICAgICBjb25zdCBlc3RpbWF0ZWRJc3N1ZXMgPSB0aGlzLmRldGVjdFBvdGVudGlhbElzc3Vlcyhjb250ZW50VG9BbmFseXplKS5sZW5ndGg7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgZXN0aW1hdGVkSXNzdWVzXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIFJld3JpdGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZXdyaXRpbmcgY29udGVudCB3aXRoIGRpZmZlcmVudCBzdHlsZXMgYW5kIGFwcHJvYWNoZXNcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZXdyaXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgZm9yIHJld3JpdGluZyB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uIGZvciByZXdyaXRpbmdcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIHVzZXIgcmVxdWVzdFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkVXNlck1lc3NhZ2UoY29tbWFuZC5pbnN0cnVjdGlvbiwgY29tbWFuZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXdyaXR0ZW5Db250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFyZXdyaXR0ZW5Db250ZW50IHx8IHJld3JpdHRlbkNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZSgnRmFpbGVkIHRvIGdlbmVyYXRlIHJld3JpdHRlbiBjb250ZW50JywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgcmV3cml0ZSBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5UmV3cml0ZShjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgbG9nIHN1Y2Nlc3MgbWVzc2FnZXMgLSBoYW5kbGVkIGJ5IFVJXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoJ0ZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Jld3JpdGUgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGBFcnJvcjogJHtyZXN1bHQuZXJyb3J9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcmV3cml0ZSBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlSZXdyaXRlKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICByZXdyaXR0ZW5Db250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugc2VjdGlvbiBjb250ZW50IHdoaWxlIHByZXNlcnZpbmcgaGVhZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3U2VjdGlvbkNvbnRlbnQgPSBgJHtzZWN0aW9uLmhlYWRpbmd9XFxuXFxuJHtyZXdyaXR0ZW5Db250ZW50fWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLnN0YXJ0LCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBzZWN0aW9uLnJhbmdlLmVuZCArIDEsIGNoOiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdTZWN0aW9uQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdTZWN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogc3RhcnRQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgU2VjdGlvbiBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBub3QgZm91bmRgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIHBhcmFncmFwaCBpZiBubyBsb2NhdGlvbiBzcGVjaWZpZWRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgcmV3cml0ZSB0byBjdXJyZW50IHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcGFyYWdyYXBoIGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0TGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBzdGFydCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZMaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnRMaW5lIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldkxpbmUudHJpbSgpID09PSAnJyB8fCBwcmV2TGluZS5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGluZS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZW5kTGluZSA8IGxpbmVDb3VudCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRMaW5lID0gZWRpdG9yLmdldExpbmUoZW5kTGluZSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBwYXJhZ3JhcGggd2l0aCByZXdyaXR0ZW4gY29udGVudFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogc3RhcnRMaW5lLCBjaDogMCB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGVuZExpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShlbmRMaW5lKS5sZW5ndGggfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UocmV3cml0dGVuQ29udGVudCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiBzdGFydFBvc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gY3Vyc29yIHBvc2l0aW9uIGF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KHJld3JpdHRlbkNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciByZXdyaXRlIGNvbW1hbmRzIHRhcmdldGluZyBlbmQsIHRyZWF0IGFzIGFkZGluZyByZXdyaXR0ZW4gY29udGVudCB0byBlbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdHRlbkNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJld3JpdGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSByZXdyaXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgaGFzU2VsZWN0aW9uOiBib29sZWFuKToge1xuICAgICAgICB2YWxpZDogYm9vbGVhbjtcbiAgICAgICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGhpcyBjb21tYW5kIHJlcXVpcmVzIHRleHQgdG8gYmUgc2VsZWN0ZWQgZmlyc3QnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIHNlY3Rpb24gdGFyZ2V0cywgbG9jYXRpb24gc2hvdWxkIGJlIHByb3ZpZGVkIGZvciBiZXR0ZXIgYWNjdXJhY3lcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VjdGlvbicgJiYgY29tbWFuZC5hY3Rpb24gPT09ICdyZXdyaXRlJyAmJiBjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAvLyBMb2NhdGlvbiBpcyBwcm92aWRlZCwgd2hpY2ggaXMgZ29vZCBmb3Igc2VjdGlvbiByZXdyaXRpbmdcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWdnZXN0aW9ucyBmb3IgcmV3cml0ZSBjb21tYW5kc1xuICAgICAqL1xuICAgIGdldFN1Z2dlc3Rpb25zKGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYSBtb3JlIGZvcm1hbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBpbiBhIGNhc3VhbCB0b25lJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCB3aXRoIG1vcmUgZGV0YWlsJyxcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSBmb3IgY2xhcml0eScsXG4gICAgICAgICAgICAgICAgJ1NpbXBsaWZ5IHRoZSBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgaXQgbW9yZSBlbmdhZ2luZycsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgaW4gYnVsbGV0IHBvaW50cycsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbmFycmF0aXZlIGZvcm0nXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnUmV3cml0ZSB0aGUgY3VycmVudCBwYXJhZ3JhcGgnLFxuICAgICAgICAgICAgICAgICdSZXdyaXRlIGluIGEgZGlmZmVyZW50IHN0eWxlJyxcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGUgd3JpdGluZyBtb3JlIGVuZ2FnaW5nJyxcbiAgICAgICAgICAgICAgICAnU2ltcGxpZnkgY29tcGxleCBsYW5ndWFnZScsXG4gICAgICAgICAgICAgICAgJ1Jld3JpdGUgZm9yIGRpZmZlcmVudCBhdWRpZW5jZScsXG4gICAgICAgICAgICAgICAgJ0NvbnZlcnQgdG8gbW9yZSBmb3JtYWwgdG9uZScsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhlIGNvbnRlbnQgbW9yZSBjb25jaXNlJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24tc3BlY2lmaWMgcmV3cml0ZSBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzLmZvckVhY2goaGVhZGluZyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYFJld3JpdGUgdGhlIFwiJHtoZWFkaW5nLnRleHR9XCIgc2VjdGlvbmApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDEwKTsgLy8gTGltaXQgdG8gMTAgc3VnZ2VzdGlvbnNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmV2aWV3IHdoYXQgd291bGQgYmUgcmV3cml0dGVuXG4gICAgICovXG4gICAgYXN5bmMgcHJldmlldyhjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiBQcm9taXNlPHtcbiAgICAgICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgcHJldmlldz86IHN0cmluZztcbiAgICAgICAgYWZmZWN0ZWRDb250ZW50Pzogc3RyaW5nO1xuICAgICAgICByZXdyaXRlU3R5bGU/OiBzdHJpbmc7XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgYWZmZWN0ZWRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBsZXQgcHJldmlld1RleHQgPSAnJztcbiAgICAgICAgICAgIGNvbnN0IHJld3JpdGVTdHlsZSA9IHRoaXMuaW5mZXJSZXdyaXRlU3R5bGUoY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgc2VsZWN0ZWQgdGV4dGA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBpcyBjdXJyZW50bHkgc2VsZWN0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21tYW5kLmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50ID0gc2VjdGlvbi5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gYFdpbGwgcmV3cml0ZSB0aGUgXCIke2NvbW1hbmQubG9jYXRpb259XCIgc2VjdGlvbmA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFNlY3Rpb24gXCIke2NvbW1hbmQubG9jYXRpb259XCIgbm90IGZvdW5kYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCA9ICdXaWxsIHJld3JpdGUgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFyYWdyYXBoJzpcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBjdXJyZW50IHBhcmFncmFwaCc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXdyaXRlU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ICs9IGAgKCR7cmV3cml0ZVN0eWxlfSlgO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmUgPSBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24ubGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGFyYWdyYXBoTGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBwYXJhZ3JhcGggYm91bmRhcmllc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydExpbmUgPSBjdXJyZW50TGluZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kTGluZSA9IGN1cnJlbnRMaW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgc3RhcnQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0TGluZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkxpbmUgPSBlZGl0b3IuZ2V0TGluZShzdGFydExpbmUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZMaW5lLnRyaW0oKSA9PT0gJycgfHwgcHJldkxpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydExpbmUtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBlbmQgb2YgcGFyYWdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZUNvdW50ID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChlbmRMaW5lIDwgbGluZUNvdW50IC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZExpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRMaW5lLnRyaW0oKSA9PT0gJycgfHwgbmV4dExpbmUuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHBhcmFncmFwaCBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0TGluZTsgaSA8PSBlbmRMaW5lOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYWdyYXBoTGluZXMucHVzaChlZGl0b3IuZ2V0TGluZShpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkQ29udGVudCA9IHBhcmFncmFwaExpbmVzLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgPSAnV2lsbCByZXdyaXRlIHRoZSBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV3cml0ZVN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3VGV4dCArPSBgICgke3Jld3JpdGVTdHlsZX0pYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdUZXh0ID0gJ1dpbGwgYWRkIHJld3JpdHRlbiBjb250ZW50IGF0IHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJld3JpdGVTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1RleHQgKz0gYCAoJHtyZXdyaXRlU3R5bGV9KWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmV3cml0ZSB0YXJnZXQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3OiBwcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICBhZmZlY3RlZENvbnRlbnQ6IGFmZmVjdGVkQ29udGVudC5sZW5ndGggPiAyMDAgPyBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiBcbiAgICAgICAgICAgICAgICAgICAgYWZmZWN0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHJld3JpdGVTdHlsZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmZlciByZXdyaXRlIHN0eWxlIGZyb20gaW5zdHJ1Y3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGluZmVyUmV3cml0ZVN0eWxlKGluc3RydWN0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdmb3JtYWwnKSkgcmV0dXJuICdmb3JtYWwgdG9uZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjYXN1YWwnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdpbmZvcm1hbCcpKSByZXR1cm4gJ2Nhc3VhbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2NvbmNpc2UnKSB8fCBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdzaG9ydGVyJykpIHJldHVybiAnbW9yZSBjb25jaXNlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2V4cGFuZCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2RldGFpbCcpKSByZXR1cm4gJ21vcmUgZGV0YWlsZWQnO1xuICAgICAgICBpZiAobG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxlJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnc2ltcGxpZnknKSkgcmV0dXJuICdzaW1wbGlmaWVkIGxhbmd1YWdlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2VuZ2FnaW5nJykgfHwgbG93ZXJJbnN0cnVjdGlvbi5pbmNsdWRlcygnaW50ZXJlc3RpbmcnKSkgcmV0dXJuICdtb3JlIGVuZ2FnaW5nJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3Byb2Zlc3Npb25hbCcpKSByZXR1cm4gJ3Byb2Zlc3Npb25hbCB0b25lJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2J1bGxldCcpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ2xpc3QnKSkgcmV0dXJuICdidWxsZXQgcG9pbnQgZm9ybWF0JztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ25hcnJhdGl2ZScpIHx8IGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3N0b3J5JykpIHJldHVybiAnbmFycmF0aXZlIHN0eWxlJztcbiAgICAgICAgaWYgKGxvd2VySW5zdHJ1Y3Rpb24uaW5jbHVkZXMoJ3RlY2huaWNhbCcpKSByZXR1cm4gJ3RlY2huaWNhbCBzdHlsZSc7XG4gICAgICAgIGlmIChsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKCdjcmVhdGl2ZScpKSByZXR1cm4gJ2NyZWF0aXZlIHN0eWxlJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmV3cml0ZSB0YXJnZXRzIGF2YWlsYWJsZSBmb3IgY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0QXZhaWxhYmxlVGFyZ2V0cyhkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSB7XG4gICAgICAgIGNvbnN0IHRhcmdldHM6IEVkaXRDb21tYW5kVHlwZVsndGFyZ2V0J11bXSA9IFsncGFyYWdyYXBoJywgJ2RvY3VtZW50JywgJ2VuZCddO1xuXG4gICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0YXJnZXRzLnVuc2hpZnQoJ3NlbGVjdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YXJnZXRzLnNwbGljZSgtMiwgMCwgJ3NlY3Rpb24nKTsgLy8gSW5zZXJ0IGJlZm9yZSAnZG9jdW1lbnQnIGFuZCAnZW5kJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXN0aW1hdGUgdGhlIHNjb3BlIG9mIHJld3JpdGluZ1xuICAgICAqL1xuICAgIGFzeW5jIGVzdGltYXRlU2NvcGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTx7XG4gICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZDogbnVtYmVyO1xuICAgICAgICBsaW5lc0FmZmVjdGVkOiBudW1iZXI7XG4gICAgICAgIHNjb3BlRGVzY3JpcHRpb246IHN0cmluZztcbiAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCc7XG4gICAgfT4ge1xuICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQ6IDAsXG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZDogMCxcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uOiAnTm8gZG9jdW1lbnQgYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICByZXdyaXRlQ29tcGxleGl0eTogJ2xvdydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhcmFjdGVyc0FmZmVjdGVkID0gMDtcbiAgICAgICAgbGV0IGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICBsZXQgc2NvcGVEZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICBsZXQgY29udGVudFRvQW5hbHl6ZSA9ICcnO1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyc0FmZmVjdGVkID0gZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnU2VsZWN0ZWQgdGV4dCBvbmx5JztcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5maW5kU2VjdGlvbihjb21tYW5kLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IHNlY3Rpb24uY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gc2VjdGlvbi5yYW5nZS5lbmQgLSBzZWN0aW9uLnJhbmdlLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9IGBcIiR7Y29tbWFuZC5sb2NhdGlvbn1cIiBzZWN0aW9uYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBzZWN0aW9uLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3BhcmFncmFwaCc6XG4gICAgICAgICAgICAgICAgLy8gRXN0aW1hdGUgc2luZ2xlIHBhcmFncmFwaFxuICAgICAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCA9IDEwMDsgLy8gUm91Z2ggZXN0aW1hdGVcbiAgICAgICAgICAgICAgICBsaW5lc0FmZmVjdGVkID0gMTtcbiAgICAgICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uID0gJ0N1cnJlbnQgcGFyYWdyYXBoJztcbiAgICAgICAgICAgICAgICAvLyBGb3IgZXN0aW1hdGlvbiBwdXJwb3NlcywgdXNlIHN1cnJvdW5kaW5nIGNvbnRleHRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFRvQW5hbHl6ZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5qb2luKCdcXG4nKSArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xcbicgKyBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSBkb2N1bWVudENvbnRleHQuY29udGVudC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbGluZXNBZmZlY3RlZCA9IGRvY3VtZW50Q29udGV4dC5jb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc2NvcGVEZXNjcmlwdGlvbiA9ICdFbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRUb0FuYWx5emUgPSBkb2N1bWVudENvbnRleHQuY29udGVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXJzQWZmZWN0ZWQgPSAwOyAvLyBOZXcgY29udGVudFxuICAgICAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgIHNjb3BlRGVzY3JpcHRpb24gPSAnTmV3IGNvbnRlbnQgYXQgZW5kJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERldGVybWluZSByZXdyaXRlIGNvbXBsZXhpdHkgYmFzZWQgb24gY29udGVudCBsZW5ndGggYW5kIGluc3RydWN0aW9uXG4gICAgICAgIGNvbnN0IHJld3JpdGVDb21wbGV4aXR5ID0gdGhpcy5lc3RpbWF0ZUNvbXBsZXhpdHkoY29udGVudFRvQW5hbHl6ZSwgY29tbWFuZC5pbnN0cnVjdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNoYXJhY3RlcnNBZmZlY3RlZCxcbiAgICAgICAgICAgIGxpbmVzQWZmZWN0ZWQsXG4gICAgICAgICAgICBzY29wZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcmV3cml0ZUNvbXBsZXhpdHlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc3RpbWF0ZSByZXdyaXRlIGNvbXBsZXhpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlQ29tcGxleGl0eShjb250ZW50OiBzdHJpbmcsIGluc3RydWN0aW9uOiBzdHJpbmcpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHtcbiAgICAgICAgY29uc3QgY29udGVudExlbmd0aCA9IGNvbnRlbnQubGVuZ3RoO1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEJhc2UgY29tcGxleGl0eSBvbiBjb250ZW50IGxlbmd0aFxuICAgICAgICBsZXQgY29tcGxleGl0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyA9ICdsb3cnO1xuICAgICAgICBpZiAoY29udGVudExlbmd0aCA+IDEwMDApIGNvbXBsZXhpdHkgPSAnaGlnaCc7XG4gICAgICAgIGVsc2UgaWYgKGNvbnRlbnRMZW5ndGggPiAzMDApIGNvbXBsZXhpdHkgPSAnbWVkaXVtJztcbiAgICAgICAgXG4gICAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBpbnN0cnVjdGlvbiBjb21wbGV4aXR5XG4gICAgICAgIGNvbnN0IGNvbXBsZXhJbnN0cnVjdGlvbnMgPSBbXG4gICAgICAgICAgICAncmVzdHJ1Y3R1cmUnLCAncmVvcmdhbml6ZScsICdjb21wbGV0ZWx5IHJld3JpdGUnLCAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgICdjaGFuZ2Ugc3R5bGUnLCAnZGlmZmVyZW50IGF1ZGllbmNlJywgJ3RlY2huaWNhbCcsICdhY2FkZW1pYydcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb21wbGV4SW5zdHJ1Y3Rpb25zLnNvbWUodGVybSA9PiBsb3dlckluc3RydWN0aW9uLmluY2x1ZGVzKHRlcm0pKSkge1xuICAgICAgICAgICAgaWYgKGNvbXBsZXhpdHkgPT09ICdsb3cnKSBjb21wbGV4aXR5ID0gJ21lZGl1bSc7XG4gICAgICAgICAgICBlbHNlIGlmIChjb21wbGV4aXR5ID09PSAnbWVkaXVtJykgY29tcGxleGl0eSA9ICdoaWdoJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbXBsZXhpdHk7XG4gICAgfVxufSIsICIvKipcbiAqIE1ldGFkYXRhIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogSGFuZGxlcyB1cGRhdGluZyBkb2N1bWVudCBwcm9wZXJ0aWVzL2Zyb250bWF0dGVyXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0UmVzdWx0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEhhbmRsZXMgbWV0YWRhdGEvcHJvcGVydHkgdXBkYXRlIGNvbW1hbmRzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBtZXRhZGF0YSB1cGRhdGUgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSB0aGUgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0gdGhpcy5wYXJzZVByb3BlcnR5VXBkYXRlcyhhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlcyB8fCBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBwcm9wZXJ0eSB1cGRhdGVzIGZvdW5kIGluIEFJIHJlc3BvbnNlJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFdyaXRlIHRoZSB1cGRhdGVkIGNvbnRlbnQgYmFjayB0byB0aGUgZmlsZSBkaXJlY3RseVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGRvY3VtZW50Q29udGV4dC5maWxlLCB1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byB1cGRhdGUgbWV0YWRhdGE6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VQcm9wZXJ0eVVwZGF0ZXMocmVzcG9uc2U6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OIGZpcnN0XG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIFlBTUwtbGlrZSBmb3JtYXRcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAvLyBNYXRjaCBwYXR0ZXJucyBsaWtlIFwia2V5OiB2YWx1ZVwiIG9yIFwiLSBrZXk6IHZhbHVlXCJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL15bLVxcc10qKFteOl0rKTpcXHMqKC4rKSQvKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdmFsdWUgYXMgSlNPTiAoZm9yIGFycmF5cy9vYmplY3RzKVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBub3QgSlNPTiwgdHJlYXQgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVvdGVzIGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuc3RhcnRzV2l0aCgnXCInKSAmJiB2YWx1ZS5lbmRzV2l0aCgnXCInKSkgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlLnN0YXJ0c1dpdGgoXCInXCIpICYmIHZhbHVlLmVuZHNXaXRoKFwiJ1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID4gMCA/IHVwZGF0ZXMgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHBhcnNlIHByb3BlcnR5IHVwZGF0ZXMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyIGluIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZywgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBmcm9udG1hdHRlciBleGlzdHNcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY2xvc2luZyAtLS1cbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlbmRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvcHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZEluZGV4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9wc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgdXBkYXRlcyB3aXRoIGV4aXN0aW5nIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IHsgLi4uZXhpc3RpbmdQcm9wcywgLi4udXBkYXRlcyB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlYnVpbGQgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobWVyZ2VkUHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIG51bGwvdW5kZWZpbmVkIHZhbHVlcyAoYWxsb3dzIGRlbGV0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goJy0tLScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugb2xkIGZyb250bWF0dGVyIHdpdGggbmV3XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgLi4ubmV3RnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKGVuZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBleGlzdHMsIGNyZWF0ZSBuZXdcbiAgICAgICAgY29uc3QgbmV3RnJvbnRtYXR0ZXIgPSBbJy0tLSddO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZyb250bWF0dGVyIHRvIGJlZ2lubmluZyBvZiBkb2N1bWVudFxuICAgICAgICByZXR1cm4gbmV3RnJvbnRtYXR0ZXIuam9pbignXFxuJykgKyBjb250ZW50O1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBzdXBlcm5vdmFEYXRlOiBzdHJpbmc7ICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGdlbmVyYWxEYXRlOiBzdHJpbmc7ICAgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIEZlYXR1cmUgcmVsZWFzZSBjb25maWd1cmF0aW9uIGZvciBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIG1vZGVsXG4gKiBTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gc3VwZXJub3ZhRGF0ZVxuICogQWxsIHVzZXJzIGdldCBmZWF0dXJlcyBvbiBnZW5lcmFsRGF0ZVxuICogXG4gKiBEYXRlcyBhcmUgaW4gWVlZWS1NTS1ERCBmb3JtYXQgYW5kIGVhc3kgdG8gbW9kaWZ5IHBvc3QtbGF1bmNoXG4gKi9cbmV4cG9ydCBjb25zdCBTVVBFUk5PVkFfRkVBVFVSRVM6IFJlY29yZDxzdHJpbmcsIFRpbWVHYXRlZEZlYXR1cmU+ID0ge1xuICAgIC8vIENvbW1hbmRzICh1bmlmaWVkKSAtIDIgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmRzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNy0zMScsICAvLyBTdXBlcm5vdmEgZWFybHkgYWNjZXNzXG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOS0zMCcsICAgLy8gR2VuZXJhbCBhdmFpbGFiaWxpdHkgXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29tbWFuZCBzeXN0ZW0gd2l0aCA6IHRyaWdnZXJzLCBjb21tYW5kIGJ1dHRvbiwgYW5kIGN1c3RvbSBjb21tYW5kcydcbiAgICB9LFxuICAgIFxuICAgIC8vIEF1dG8tZ3Jvd2luZyBpbnB1dCAtIDEgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2F1dG8taW5wdXQnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA3LTE1JywgICAvLyAxIG1vbnRoIGxhdGVyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0by1ncm93aW5nIGlucHV0IGFyZWEgd2l0aCBzbW9vdGggdHJhbnNpdGlvbnMnXG4gICAgfSxcbiAgICBcbiAgICAvLyBFbmhhbmNlZCBwcm92aWRlciBtYW5hZ2VtZW50IC0gMiBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnZW5oYW5jZWQtcHJvdmlkZXJzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNi0xNScsICAvLyBMYXVuY2ggZGF5XG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOC0xNScsICAgLy8gMiBtb250aHMgbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZHZhbmNlZCBwcm92aWRlciBjb25maWd1cmF0aW9uIGFuZCBzd2l0Y2hpbmcnXG4gICAgfVxufTtcblxuLyoqXG4gKiBDb3JlIGZlYXR1cmVzIHRoYXQgYXJlIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG4gKiBUaGVzZSBhcmUgTk9UIHRpbWUtZ2F0ZWRcbiAqL1xuZXhwb3J0IGNvbnN0IENPUkVfRkVBVFVSRVMgPSBbXG4gICAgJ2Jhc2ljX2VkaXRpbmcnLCAgICAgICAgICAvLyBBZGQsIGVkaXQsIGRlbGV0ZSwgZ3JhbW1hciwgcmV3cml0ZSBjb21tYW5kc1xuICAgICdhbGxfYWlfcHJvdmlkZXJzJywgICAgICAgLy8gQ2xhdWRlLCBPcGVuQUksIEdvb2dsZSwgT2xsYW1hXG4gICAgJ2ZpbGVfY29udmVyc2F0aW9ucycsICAgICAvLyBGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgICdwcm92aWRlcl9zd2l0Y2hpbmcnLCAgICAgLy8gU3dpdGNoIHByb3ZpZGVycyBpbiBjaGF0XG4gICAgJ21vYmlsZV9hY2Nlc3MnLCAgICAgICAgICAvLyBGdWxsIG1vYmlsZSBzdXBwb3J0XG4gICAgJ2FwaV9rZXlfY29uZmlnJywgICAgICAgICAvLyBDb25maWd1cmUgb3duIEFQSSBrZXlzXG4gICAgJ3NpZGViYXJfY2hhdCcsICAgICAgICAgICAvLyBDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyXG4gICAgJ2RvY3VtZW50X2NvbnRleHQnLCAgICAgICAvLyBDdXJyZW50IGRvY3VtZW50IGNvbnRleHRcbiAgICAnbXVsdGktZG9jLWNvbnRleHQnICAgICAgIC8vIFJlZmVyZW5jZSBvdGhlciBkb2N1bWVudHMgd2l0aCBbW2RvY11dIHN5bnRheFxuXTsiLCAiaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vbGljZW5zZS12YWxpZGF0b3InO1xuaW1wb3J0IHsgU3VwZXJub3ZhTGljZW5zZSwgRmVhdHVyZUZsYWcsIEZlYXR1cmVBY2Nlc3NSZXN1bHQsIERlYnVnU2V0dGluZ3MsIFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IFNVUEVSTk9WQV9GRUFUVVJFUywgQ09SRV9GRUFUVVJFUywgVGltZUdhdGVkRmVhdHVyZSB9IGZyb20gJy4vZmVhdHVyZS1jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgRmVhdHVyZU1hbmFnZXIge1xuXHRwcml2YXRlIGZlYXR1cmVzOiBNYXA8c3RyaW5nLCBGZWF0dXJlRmxhZz4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc3VwZXJub3ZhTGljZW5zZTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzU3VwZXJub3ZhOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIGxpY2Vuc2VWYWxpZGF0b3I6IExpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0ZGVidWdTZXR0aW5ncz86IERlYnVnU2V0dGluZ3Ncblx0KSB7XG5cdFx0aWYgKGRlYnVnU2V0dGluZ3MpIHtcblx0XHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IGRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemUgYWxsIGZlYXR1cmUgZmxhZ3Ncblx0ICogQ29yZSBmZWF0dXJlcyBhcmUgYWx3YXlzIGVuYWJsZWRcblx0ICogVGltZS1nYXRlZCBmZWF0dXJlcyBkZXBlbmQgb24gY3VycmVudCBkYXRlIGFuZCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRwcml2YXRlIGluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTogdm9pZCB7XG5cdFx0Ly8gQ29yZSBmZWF0dXJlcyAtIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG5cdFx0Q09SRV9GRUFUVVJFUy5mb3JFYWNoKGZlYXR1cmVLZXkgPT4ge1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXk6IGZlYXR1cmVLZXksXG5cdFx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiB0aGlzLmdldENvcmVGZWF0dXJlRGVzY3JpcHRpb24oZmVhdHVyZUtleSlcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gVGltZS1nYXRlZCBmZWF0dXJlcyAtIGF2YWlsYWJsZSBiYXNlZCBvbiBkYXRlXG5cdFx0T2JqZWN0LmVudHJpZXMoU1VQRVJOT1ZBX0ZFQVRVUkVTKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XG5cdFx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5pc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGtleSwgY29uZmlnKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5LFxuXHRcdFx0XHRlbmFibGVkLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuXHRcdFx0XHRpc1RpbWVHYXRlZDogdHJ1ZSxcblx0XHRcdFx0ZWFybHlBY2Nlc3NPbmx5OiAhdGhpcy5pc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWcpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVzY3JpcHRpb24gZm9yIGNvcmUgZmVhdHVyZXNcblx0ICovXG5cdHByaXZhdGUgZ2V0Q29yZUZlYXR1cmVEZXNjcmlwdGlvbihrZXk6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgZGVzY3JpcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2Jhc2ljX2VkaXRpbmcnOiAnQmFzaWMgZG9jdW1lbnQgZWRpdGluZyBjb21tYW5kcyAoYWRkLCBlZGl0LCBkZWxldGUsIGdyYW1tYXIsIHJld3JpdGUpJyxcblx0XHRcdCdhbGxfYWlfcHJvdmlkZXJzJzogJ0FjY2VzcyB0byBhbGwgQUkgcHJvdmlkZXJzIChDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWEpJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnOiAnRmlsZS1zY29wZWQgY29udmVyc2F0aW9uIGhpc3RvcnknLFxuXHRcdFx0J3Byb3ZpZGVyX3N3aXRjaGluZyc6ICdTd2l0Y2ggQUkgcHJvdmlkZXJzIGRpcmVjdGx5IGluIGNoYXQgaW50ZXJmYWNlJyxcblx0XHRcdCdtb2JpbGVfYWNjZXNzJzogJ0Z1bGwgbW9iaWxlIGRldmljZSBzdXBwb3J0Jyxcblx0XHRcdCdhcGlfa2V5X2NvbmZpZyc6ICdDb25maWd1cmUgeW91ciBvd24gQVBJIGtleXMnLFxuXHRcdFx0J3NpZGViYXJfY2hhdCc6ICdDaGF0IGludGVyZmFjZSBpbiBzaWRlYmFyJyxcblx0XHRcdCdkb2N1bWVudF9jb250ZXh0JzogJ0N1cnJlbnQgZG9jdW1lbnQgY29udGV4dCBpbiBjb252ZXJzYXRpb25zJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGRlc2NyaXB0aW9uc1trZXldIHx8IGtleTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIHRpbWUtZ2F0ZWQgZmVhdHVyZSBzaG91bGQgYmUgZW5hYmxlZFxuXHQgKi9cblx0cHJpdmF0ZSBpc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZywgY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IHN1cGVybm92YURhdGUgPSBuZXcgRGF0ZShjb25maWcuc3VwZXJub3ZhRGF0ZSk7XG5cdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gZXZlcnlvbmUgYWZ0ZXIgZ2VuZXJhbCBkYXRlXG5cdFx0aWYgKG5vdyA+PSBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgYWZ0ZXIgc3VwZXJub3ZhIGRhdGVcblx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA+PSBzdXBlcm5vdmFEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBTdXBlcm5vdmEgc3RhdHVzIChjYW4gYmUgb3ZlcnJpZGRlbiBpbiBkZWJ1ZyBtb2RlKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRJc1N1cGVybm92YSgpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgJiYgdGhpcy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmlzU3VwZXJub3ZhO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGEgbmV3IGZlYXR1cmUgZmxhZ1xuXHQgKi9cblx0cmVnaXN0ZXJGZWF0dXJlKGZsYWc6IEZlYXR1cmVGbGFnKTogdm9pZCB7XG5cdFx0dGhpcy5mZWF0dXJlcy5zZXQoZmxhZy5rZXksIGZsYWcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBhbmQgcmVjYWxjdWxhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0ICovXG5cdGFzeW5jIHVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghbGljZW5zZUtleSkge1xuXHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gbnVsbDtcblx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMubGljZW5zZVZhbGlkYXRvci52YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbi52YWxpZCAmJiB2YWxpZGF0aW9uLmxpY2Vuc2UpIHtcblx0XHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gdmFsaWRhdGlvbi5saWNlbnNlO1xuXHRcdFx0XHR0aGlzLmlzU3VwZXJub3ZhID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuc3VwZXJub3ZhTGljZW5zZSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCB1cGRhdGVkIFN1cGVybm92YSBzdGF0dXNcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRpc1N1cGVybm92YVN1cHBvcnRlcigpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRJc1N1cGVybm92YSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IFN1cGVybm92YSBsaWNlbnNlXG5cdCAqL1xuXHRnZXRTdXBlcm5vdmFMaWNlbnNlKCk6IFN1cGVybm92YUxpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5zdXBlcm5vdmFMaWNlbnNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgZmVhdHVyZSBpcyBlbmFibGVkXG5cdCAqL1xuXHRpc0ZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdC8vIEhhbmRsZSBvbGQgZmVhdHVyZSBrZXlzIHRoYXQgbWlnaHQgc3RpbGwgYmUgcmVmZXJlbmNlZFxuXHRcdGlmICh0aGlzLmlzTGVnYWN5RmVhdHVyZUtleShmZWF0dXJlS2V5KSkge1xuXHRcdFx0cmV0dXJuIHRydWU7IC8vIEFsbCBsZWdhY3kgZmVhdHVyZXMgYXJlIG5vdyBlbmFibGVkIGZvciBldmVyeW9uZVxuXHRcdH1cblxuXHRcdGNvbnN0IGZlYXR1cmUgPSB0aGlzLmZlYXR1cmVzLmdldChmZWF0dXJlS2V5KTtcblx0XHRyZXR1cm4gZmVhdHVyZT8uZW5hYmxlZCA/PyBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiB0aGlzIGlzIGEgbGVnYWN5IGZlYXR1cmUga2V5IHRoYXQgc2hvdWxkIGFsd2F5cyBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzTGVnYWN5RmVhdHVyZUtleShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGxlZ2FjeUtleXMgPSBbXG5cdFx0XHQnYmFzaWNfZWRpdGluZycsXG5cdFx0XHQnbG9jYWxfYWlfcHJvdmlkZXJzJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnLFxuXHRcdFx0J3NpbmdsZV9jbG91ZF9wcm92aWRlcicsXG5cdFx0XHQndW5saW1pdGVkX2Nsb3VkX2FpJyxcblx0XHRcdCdwcm92aWRlcl9zd2l0Y2hpbmcnLFxuXHRcdFx0J21vYmlsZV9hY2Nlc3MnLFxuXHRcdFx0J2FkdmFuY2VkX3RlbXBsYXRlcycsXG5cdFx0XHQnYmF0Y2hfb3BlcmF0aW9ucycsXG5cdFx0XHQnY3Jvc3NfZG9jdW1lbnRfY29udGV4dCcsXG5cdFx0XHQncHJpb3JpdHlfc3VwcG9ydCdcblx0XHRdO1xuXHRcdHJldHVybiBsZWdhY3lLZXlzLmluY2x1ZGVzKGtleSk7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgZmVhdHVyZSBhY2Nlc3Mgd2l0aCBkZXRhaWxlZCByZXN1bHRcblx0ICovXG5cdGNoZWNrRmVhdHVyZUFjY2VzcyhmZWF0dXJlS2V5OiBzdHJpbmcpOiBGZWF0dXJlQWNjZXNzUmVzdWx0IHtcblx0XHQvLyBIYW5kbGUgbGVnYWN5IGZlYXR1cmVzXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdFxuXHRcdGlmICghZmVhdHVyZSkge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLCBcblx0XHRcdFx0cmVhc29uOiBgRmVhdHVyZSAnJHtmZWF0dXJlS2V5fScgbm90IGZvdW5kYCBcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0cmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xuXHRcdH1cblxuXHRcdC8vIEZvciB0aW1lLWdhdGVkIGZlYXR1cmVzLCBwcm92aWRlIG1vcmUgaW5mb3JtYXRpb25cblx0XHRpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2ZlYXR1cmVLZXldO1xuXHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0XHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRcdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblxuXHRcdFx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IHN1cGVybm92YURhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgd2lsbCBiZSBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgb24gJHtjb25maWcuc3VwZXJub3ZhRGF0ZX1gLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmFGZWF0dXJlOiB0cnVlLFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogc3VwZXJub3ZhRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIXRoaXMuZ2V0SXNTdXBlcm5vdmEoKSAmJiBub3cgPCBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gSXQgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uICR7Y29uZmlnLmdlbmVyYWxEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBnZW5lcmFsRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRyZWFzb246ICdGZWF0dXJlIGlzIG5vdCBhdmFpbGFibGUnXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYWxsIGVuYWJsZWQgZmVhdHVyZXNcblx0ICovXG5cdGdldEVuYWJsZWRGZWF0dXJlcygpOiBGZWF0dXJlRmxhZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmZlYXR1cmVzLnZhbHVlcygpKS5maWx0ZXIoZmVhdHVyZSA9PiBmZWF0dXJlLmVuYWJsZWQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgU3VwZXJub3ZhIGVhcmx5IGFjY2VzcyBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0U3VwZXJub3ZhRmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHRmZWF0dXJlLmlzVGltZUdhdGVkICYmIGZlYXR1cmUuZWFybHlBY2Nlc3NPbmx5XG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IHRlc3Rpbmdcblx0ICovXG5cdHVwZGF0ZURlYnVnU2V0dGluZ3Moc2V0dGluZ3M6IERlYnVnU2V0dGluZ3MpOiB2b2lkIHtcblx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCBuZXcgZGVidWcgc2V0dGluZ3Ncblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeVxuXHQgKi9cblx0Z2V0RmVhdHVyZVN1bW1hcnkoKTogeyBcblx0XHRpc1N1cGVybm92YTogYm9vbGVhbjsgXG5cdFx0ZW5hYmxlZDogc3RyaW5nW107IFxuXHRcdGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+IFxuXHR9IHtcblx0XHRjb25zdCBlbmFibGVkOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+ID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZlYXR1cmUuaXNUaW1lR2F0ZWQpIHtcblx0XHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2tleV07XG5cdFx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YVVzZXIgPSB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cdFx0XHRcdFx0Y29taW5nU29vbi5wdXNoKHtcblx0XHRcdFx0XHRcdGtleSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGlzU3VwZXJub3ZhVXNlciA/IGNvbmZpZy5zdXBlcm5vdmFEYXRlIDogY29uZmlnLmdlbmVyYWxEYXRlLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmE6IGlzU3VwZXJub3ZhVXNlclxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHsgXG5cdFx0XHRpc1N1cGVybm92YTogdGhpcy5nZXRJc1N1cGVybm92YSgpLCBcblx0XHRcdGVuYWJsZWQsIFxuXHRcdFx0Y29taW5nU29vbiBcblx0XHR9O1xuXHR9XG59IiwgImltcG9ydCB7IExpY2Vuc2UsIFN1cGVybm92YUxpY2Vuc2UsIExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0LCBTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0LCBMaWNlbnNlRXJyb3IgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIExpY2Vuc2VWYWxpZGF0b3Ige1xuXHQvLyBFbWJlZGRlZCBzaWduaW5nIGtleSAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSBvYmZ1c2NhdGVkXG5cdHByaXZhdGUgcmVhZG9ubHkgU0VDUkVUX0tFWSA9ICdub3ZhLWxpY2Vuc2Utc2lnbmluZy1rZXktMjAyNSc7XG5cdFxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBrZXkgYW5kIHJldHVybnMgdmFsaWRhdGlvbiByZXN1bHRcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgbGljZW5zZSBrZXkgc3RyaW5nIGludG8gYSBMaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBMaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0aWVyfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0aWVyLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFNraXAgdGllciB2YWxpZGF0aW9uIHNpbmNlIHdlJ3JlIHJlbW92aW5nIHRpZXJzXG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBkZWNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RGVjb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYXRvYihzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGVuY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjRFbmNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBidG9hKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IExpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0J2xlZ2FjeScsIC8vIFVzZSBsZWdhY3kgZm9yIG9sZCBsaWNlbnNlc1xuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlIChwcmV2ZW50IGZ1dHVyZS1kYXRlZCBsaWNlbnNlcylcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIGxpY2Vuc2UgZGF0YVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHRpZXI6IHN0cmluZyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50IHB1cnBvc2VzXG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0TGljZW5zZShlbWFpbDogc3RyaW5nLCB0aWVyOiBzdHJpbmcsIGxpZmV0aW1lTW9kZSA9IHRydWUpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSBsaWZldGltZU1vZGUgPyBudWxsIDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyAxIHllYXJcblxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoZW1haWwsIHRpZXIsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nKTogUHJvbWlzZTxTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlU3VwZXJub3ZhTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IHN0cmluZ1xuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZVN1cGVybm92YUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgZm9ybWF0OiBiYXNlNjQoZW1haWx8dHlwZXxleHBpcmVzQXR8aXNzdWVkQXR8c2lnbmF0dXJlKVxuXHRcdFx0Y29uc3QgZGVjb2RlZCA9IHRoaXMuYmFzZTY0RGVjb2RlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBkZWNvZGVkLnNwbGl0KCd8Jyk7XG5cdFx0XHRcblx0XHRcdGlmIChwYXJ0cy5sZW5ndGggIT09IDUpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IFtlbWFpbCwgdHlwZSwgZXhwaXJlc0F0U3RyLCBpc3N1ZWRBdFN0ciwgc2lnbmF0dXJlXSA9IHBhcnRzO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSB0eXBlXG5cdFx0XHRpZiAodHlwZSAhPT0gJ2FubnVhbCcgJiYgdHlwZSAhPT0gJ2xpZmV0aW1lJykge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdHR5cGU6IHR5cGUgYXMgJ2FubnVhbCcgfCAnbGlmZXRpbWUnLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IFN1cGVybm92YUxpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdXBlcm5vdmFTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50eXBlLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBTdXBlcm5vdmEgbGljZW5zZVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHR5cGU6ICdhbm51YWwnIHwgJ2xpZmV0aW1lJyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3R5cGV9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IFN1cGVybm92YSBsaWNlbnNlIGZvciBkZXZlbG9wbWVudFxuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdFN1cGVybm92YUxpY2Vuc2UoZW1haWw6IHN0cmluZywgdHlwZTogJ2FubnVhbCcgfCAnbGlmZXRpbWUnKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gdHlwZSA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDEgeWVhclxuXG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShlbWFpbCwgdHlwZSwgZXhwaXJlc0F0LCBpc3N1ZWRBdCk7XG5cdFx0XG5cdFx0Y29uc3QgbGljZW5zZURhdGEgPSBgJHtlbWFpbH18JHt0eXBlfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9fCR7c2lnbmF0dXJlfWA7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmFzZTY0RW5jb2RlKGxpY2Vuc2VEYXRhKTtcblx0fVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsb0JBQW1IOzs7QUNBbkgsSUFBQUMsbUJBQXlEOzs7QUNBekQsSUFBQUMsbUJBQTRIOzs7QUNLNUgsc0JBQTJDO0FBK0JwQyxJQUFNLHlCQUFOLE1BQTZCO0FBQUEsRUFNaEMsWUFBWSxLQUFVO0FBSnRCLFNBQVEsb0JBQXNELG9CQUFJLElBQUk7QUFDdEUsU0FBaUIsY0FBYztBQUMvQixTQUFpQixvQkFBb0I7QUFHakMsU0FBSyxNQUFNO0FBQUEsRUFDZjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsYUFBYSxTQUFpQixzQkFHNUI7QUFDRSxVQUFNLGFBQWtDLENBQUM7QUFDekMsUUFBSSxpQkFBaUI7QUFJckIsVUFBTSxhQUFhO0FBRW5CLFFBQUk7QUFDSixZQUFRLFFBQVEsV0FBVyxLQUFLLE9BQU8sT0FBTyxNQUFNO0FBQ2hELFlBQU0sVUFBVSxNQUFNLENBQUM7QUFDdkIsWUFBTSxXQUFXLE1BQU0sQ0FBQztBQUN4QixZQUFNLGVBQWUsTUFBTSxDQUFDO0FBRzVCLFlBQU0sT0FBTyxLQUFLLFNBQVMsT0FBTztBQUVsQyxVQUFJLE1B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QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlDbEIsVUFBTSxhQUFhLE1BQU0sY0FBYyxtQkFBbUI7QUFDMUQsVUFBTSxXQUFXLE1BQU0sY0FBYyxpQkFBaUI7QUFDdEQsVUFBTSxVQUFVLE1BQU0sY0FBYyxXQUFXO0FBRS9DLFVBQU0sYUFBYSxNQUFNO0FBQ3hCLFlBQU0sT0FBTztBQUFBLElBQ2Q7QUFFQSxlQUFXLGlCQUFpQixTQUFTLE1BQU07QUFDMUMsYUFBTyxLQUFLLGlDQUFpQyxRQUFRO0FBQ3JELGlCQUFXO0FBQUEsSUFDWixDQUFDO0FBRUQsYUFBUyxpQkFBaUIsU0FBUyxVQUFVO0FBQzdDLFlBQVEsaUJBQWlCLFNBQVMsVUFBVTtBQUU1QyxhQUFTLEtBQUssWUFBWSxLQUFLO0FBRy9CLFFBQUkseUJBQU8saURBQWlELEdBQUk7QUFBQSxFQUNqRTtBQUFBO0FBQUEsRUFHQSxNQUFNLGdCQUFnQixLQUEyQjtBQUNoRCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVM7QUFDcEMsV0FBTyxVQUFVLFFBQVEsR0FBRyxJQUFJO0FBQUEsRUFDakM7QUFBQSxFQUVBLE1BQU0sZ0JBQWdCLEtBQWEsTUFBMEI7QUFDNUQsVUFBTSxVQUFVLE1BQU0sS0FBSyxTQUFTLEtBQUssQ0FBQztBQUMxQyxZQUFRLEdBQUcsSUFBSTtBQUNmLFdBQU8sTUFBTSxLQUFLLFNBQVMsT0FBTztBQUFBLEVBQ25DO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImV4aXN0aW5nIiwgImltcG9ydF9vYnNpZGlhbiIsICJvcHRpb25zIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicHJvbXB0IiwgInNlbmRCdXR0b24iLCAiX2EiLCAiaXNTdXBlcm5vdmEiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAicmVzdWx0IiwgInByb21wdCIsICJyZXN1bHQiLCAicHJvbXB0IiwgInJlc3VsdCIsICJwcm9tcHQiLCAibmV3RnJvbnRtYXR0ZXIiLCAiTk9WQV9JQ09OX1NWRyJdCn0K
