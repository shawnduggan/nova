/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian15 = require("obsidian");

// src/settings.ts
var import_obsidian12 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian10 = require("obsidian");

// src/core/document-analysis.ts
var DocumentAnalyzer = class {
  static analyzeStructure(content) {
    const lines = content.split("\n");
    const headings = [];
    const emptyHeadings = [];
    const incompleteBullets = [];
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i].trim();
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        const hasContent = this.hasContentAfterHeading(lines, i);
        const isEmpty = !hasContent;
        headings.push({ level, text, isEmpty });
        if (isEmpty) {
          emptyHeadings.push(text);
        }
      }
      if (line.match(/^[-*+]\s*(.*)\.\.\.?\s*$/) || line.match(/^[-*+]\s*$/) || line.match(/^[-*+]\s*(TODO|TBD)/i)) {
        incompleteBullets.push(line);
      }
    }
    const wordCount = content.split(/\s+/).filter((word) => word.length > 0).length;
    return {
      headings,
      wordCount,
      emptyHeadings,
      incompleteBullets
    };
  }
  static hasContentAfterHeading(lines, headingIndex) {
    var _a;
    const currentHeading = lines[headingIndex].trim();
    const currentLevel = ((_a = currentHeading.match(/^(#{1,6})/)) == null ? void 0 : _a[1].length) || 0;
    for (let i = headingIndex + 1; i < lines.length; i++) {
      const line = lines[i].trim();
      const headingMatch = line.match(/^(#{1,6})\s/);
      if (headingMatch) {
        const nextLevel = headingMatch[1].length;
        if (nextLevel <= currentLevel) {
          return false;
        }
      }
      if (line.length > 0) return true;
    }
    return false;
  }
};

// src/ai/models.ts
function getAvailableModels(providerType, settings) {
  var _a, _b;
  switch (providerType) {
    case "claude":
      return [
        { value: "claude-opus-4-20250514", label: "Claude Opus 4" },
        { value: "claude-sonnet-4-20250514", label: "Claude Sonnet 4" },
        { value: "claude-3-7-sonnet-latest", label: "Claude 3.7 Sonnet" },
        { value: "claude-3-5-sonnet-latest", label: "Claude 3.5 Sonnet" },
        { value: "claude-3-5-sonnet-20241022", label: "Claude 3.5 Sonnet (Oct 22)" },
        { value: "claude-3-5-haiku-latest", label: "Claude 3.5 Haiku" }
      ];
    case "openai":
      return [
        { value: "gpt-4.1-2025-04-14", label: "GPT-4.1" },
        { value: "gpt-4.1-mini-2025-04-14", label: "GPT-4.1 Mini" },
        { value: "gpt-4.1-nano-2025-04-14", label: "GPT-4.1 Nano" },
        { value: "gpt-4o", label: "GPT-4o" },
        { value: "gpt-4o-mini", label: "GPT-4o Mini" }
      ];
    case "google":
      return [
        { value: "gemini-2.5-flash-preview-04-17", label: "Gemini 2.5 Flash" },
        { value: "gemini-2.5-pro-preview-03-25", label: "Gemini 2.5 Pro" },
        { value: "gemini-2.0-flash", label: "Gemini 2.0 Flash" },
        { value: "gemini-2.0-flash-lite", label: "Gemini 2.0 Flash-Lite" }
      ];
    case "ollama":
      const ollamaModel = (_b = (_a = settings == null ? void 0 : settings.aiProviders) == null ? void 0 : _a.ollama) == null ? void 0 : _b.model;
      if (ollamaModel && ollamaModel.trim()) {
        return [{ value: ollamaModel, label: ollamaModel }];
      }
      return [];
    default:
      return [];
  }
}

// src/ui/input-handler.ts
var import_obsidian2 = require("obsidian");

// src/ui/wikilink-suggest.ts
var import_obsidian = require("obsidian");
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea, container) {
    // Reference to NovaSidebarView
    this.lastTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.setupEventListeners();
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch && cursorPos !== this.lastTriggerPos) {
      this.lastTriggerPos = cursorPos;
      this.showNativeFileModal();
    }
  }
  showNativeFileModal() {
    var _a;
    const currentFile = ((_a = this.sidebarView) == null ? void 0 : _a.currentFile) || this.app.workspace.getActiveFile();
    const modal = new WikilinkFileModal(
      this.app,
      async (file) => {
        await this.selectFile(file);
      },
      () => {
        this.lastTriggerPos = -1;
      },
      currentFile
    );
    modal.open();
  }
  async selectFile(file) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch) {
      const startPos = cursorPos - linkMatch[0].length;
      const newText = text.substring(0, startPos) + text.substring(cursorPos);
      this.textArea.value = newText;
      this.textArea.setSelectionRange(startPos, startPos);
      this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    }
    if (this.sidebarView && this.sidebarView.addFilesToContext) {
      await this.sidebarView.addFilesToContext([file.basename]);
    }
    this.lastTriggerPos = -1;
    this.textArea.focus();
  }
  destroy() {
  }
};
var WikilinkFileModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(app, onSelect, onCancel, currentFile) {
    super(app);
    this.allFiles = [];
    this.onSelectCallback = onSelect;
    this.onCancelCallback = onCancel;
    this.currentFile = currentFile || null;
    this.setPlaceholder("Search files to add to context...");
    this.loadFiles();
  }
  onOpen() {
    super.onOpen();
    this.addInstructions();
  }
  addInstructions() {
    const instructionsEl = this.modalEl.createDiv({ cls: "prompt-instructions" });
    const navInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    navInstruction.createSpan({ cls: "prompt-instruction-command", text: "\u2191\u2193" });
    navInstruction.createSpan({ text: "to navigate" });
    const useInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    useInstruction.createSpan({ cls: "prompt-instruction-command", text: "\u21B5" });
    useInstruction.createSpan({ text: "to use" });
    const escInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    escInstruction.createSpan({ cls: "prompt-instruction-command", text: "esc" });
    escInstruction.createSpan({ text: "to dismiss" });
  }
  loadFiles() {
    this.allFiles = this.app.vault.getMarkdownFiles();
    if (this.currentFile) {
      this.allFiles = this.allFiles.filter((file) => file.path !== this.currentFile.path);
    }
    this.allFiles.sort((a, b) => b.stat.mtime - a.stat.mtime);
  }
  getItems() {
    return this.allFiles;
  }
  getItemText(file) {
    return file.basename;
  }
  onChooseItem(file) {
    this.onSelectCallback(file);
  }
  renderSuggestion(match, el) {
    const file = match.item;
    const container = el.createDiv({ cls: "suggestion-content" });
    const title = container.createDiv({ cls: "suggestion-title" });
    title.textContent = file.basename;
    const aux = container.createDiv({ cls: "suggestion-aux" });
    aux.textContent = file.path;
  }
  onClose() {
    super.onClose();
    if (this.onCancelCallback) {
      this.onCancelCallback();
    }
  }
};

// src/ui/input-handler.ts
var _InputHandler = class _InputHandler {
  constructor(plugin, container, contextManager) {
    this.dropZoneOverlay = null;
    this.isDragging = false;
    // Reference to NovaSidebarView for context operations
    // Event cleanup tracking
    this.eventListeners = [];
    this.plugin = plugin;
    this.container = container;
    this.contextManager = contextManager;
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.setSidebarView(sidebarView);
    }
  }
  setCommandSystem(commandSystem) {
    this.commandSystem = commandSystem;
    const sendButtonEl = this.sendButton.buttonEl;
    sendButtonEl.remove();
    this.commandSystem.createCommandButton(this.inputRow);
    this.inputRow.appendChild(sendButtonEl);
    this.commandSystem.createCommandPickerInContainer(this.inputRow);
  }
  getTextArea() {
    return this.textArea;
  }
  createInputInterface(chatContainer) {
    this.container = this.container.createDiv({ cls: "nova-input-container" });
    this.container.style.cssText = `
			flex-shrink: 0;
			padding: var(--size-4-3);
			border-top: 1px solid var(--background-modifier-border);
			position: relative;
		`;
    this.inputRow = this.container.createDiv({ cls: "nova-input-row" });
    this.inputRow.style.cssText = `
			display: flex;
			gap: var(--size-2-3);
			align-items: center;
			position: relative;
		`;
    const textAreaContainer = this.inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian2.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("How can I help?");
    this.textArea.inputEl.style.cssText = `
			max-height: 200px;
			resize: none;
			overflow-y: auto;
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			border: 1px solid var(--background-modifier-border);
			background: var(--background-primary);
			color: var(--text-normal);
			font-family: var(--font-interface);
			line-height: 1.4;
			width: 100%;
			box-sizing: border-box;
		`;
    this.autoGrowTextarea = () => {
      const textarea = this.textArea.inputEl;
      textarea.style.height = "auto";
      textarea.style.height = Math.min(textarea.scrollHeight, 200) + "px";
    };
    this.addEventListener(this.textArea.inputEl, "input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.plugin.app, this.textArea.inputEl, this.inputRow);
    if (this.sidebarView) {
      this.wikilinkAutocomplete.setSidebarView(this.sidebarView);
    }
    this.addEventListener(this.textArea.inputEl, "input", () => {
      this.contextManager.updateLiveContextPreview(this.textArea.getValue());
    });
    this.sendButton = new import_obsidian2.ButtonComponent(this.inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
		`;
    this.addEventListener(this.textArea.inputEl, "keydown", (event) => {
      var _a, _b, _c, _d;
      const keyEvent = event;
      if (keyEvent.key === "Enter" && !keyEvent.shiftKey) {
        event.preventDefault();
        ((_a = this.commandSystem) == null ? void 0 : _a.handleCommandPickerSelection()) || false || this.handleSend();
      } else if (keyEvent.key === "Escape") {
        (_b = this.commandSystem) == null ? void 0 : _b.hideCommandPicker();
      } else if (keyEvent.key === "ArrowUp" || keyEvent.key === "ArrowDown") {
        if ((_c = this.commandSystem) == null ? void 0 : _c.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      } else if (keyEvent.key === "Tab") {
        if ((_d = this.commandSystem) == null ? void 0 : _d.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      }
    });
    this.addEventListener(this.textArea.inputEl, "input", () => {
      if (this.commandSystem) {
        this.commandSystem.handleInputChange();
      }
    });
    this.setupDragAndDrop();
  }
  focus() {
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _InputHandler.FOCUS_DELAY_MS);
  }
  handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.textArea.setValue("");
    this.autoGrowTextarea();
    this.contextManager.hideContextPreview();
    (_a = this.onSendMessage) == null ? void 0 : _a.call(this, message);
  }
  setOnSendMessage(callback) {
    this.onSendMessage = callback;
  }
  getValue() {
    return this.textArea.getValue();
  }
  setValue(value) {
    this.textArea.setValue(value);
    this.autoGrowTextarea();
  }
  insertText(text) {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + text + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const newPosition = start + text.length;
    setTimeout(() => {
      textarea.setSelectionRange(newPosition, newPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  insertTextWithCursor(beforeCursor, afterCursor = "") {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + beforeCursor + afterCursor + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const cursorPosition = start + beforeCursor.length;
    setTimeout(() => {
      textarea.setSelectionRange(cursorPosition, cursorPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.eventListeners.push({ element, event, handler });
  }
  setupDragAndDrop() {
    const dropZone = this.textArea.inputEl;
    this.addEventListener(dropZone, "dragenter", (e) => {
      e.preventDefault();
      this.handleDragEnter();
    });
    this.addEventListener(dropZone, "dragover", (e) => {
      e.preventDefault();
      e.dataTransfer.dropEffect = "copy";
    });
    this.addEventListener(dropZone, "dragleave", (e) => {
      if (e.target === dropZone) {
        this.handleDragLeave();
      }
    });
    this.addEventListener(dropZone, "drop", (e) => {
      e.preventDefault();
      this.handleDrop(e);
    });
  }
  handleDragEnter() {
    if (this.isDragging) return;
    this.isDragging = true;
    if (!this.dropZoneOverlay) {
      this.dropZoneOverlay = document.createElement("div");
      this.dropZoneOverlay.className = "nova-drop-zone-overlay";
      this.dropZoneOverlay.style.cssText = `
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: var(--interactive-accent);
				opacity: 0;
				border: 2px dashed var(--interactive-accent);
				border-radius: var(--radius-s);
				display: flex;
				align-items: center;
				justify-content: center;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 10;
			`;
      const iconContainer = document.createElement("div");
      iconContainer.style.cssText = `
				background: var(--background-primary);
				border-radius: 50%;
				width: 48px;
				height: 48px;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
				opacity: 0;
				transform: scale(0.8);
				transition: all 0.2s ease;
			`;
      const icon = document.createElement("div");
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>`;
      icon.style.cssText = `
				color: var(--interactive-accent);
				display: flex;
				align-items: center;
				justify-content: center;
			`;
      iconContainer.appendChild(icon);
      this.dropZoneOverlay.appendChild(iconContainer);
    }
    const textAreaContainer = this.textArea.inputEl.parentElement;
    textAreaContainer.style.position = "relative";
    textAreaContainer.appendChild(this.dropZoneOverlay);
    setTimeout(() => {
      if (this.dropZoneOverlay) {
        this.dropZoneOverlay.style.opacity = "0.1";
        const icon = this.dropZoneOverlay.querySelector("div");
        if (icon) {
          icon.style.opacity = "1";
          icon.style.transform = "scale(1)";
        }
      }
    }, 10);
  }
  handleDragLeave() {
    this.isDragging = false;
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.style.opacity = "0";
      const icon = this.dropZoneOverlay.querySelector("div");
      if (icon) {
        icon.style.opacity = "0";
        icon.style.transform = "scale(0.8)";
      }
      setTimeout(() => {
        var _a;
        (_a = this.dropZoneOverlay) == null ? void 0 : _a.remove();
        this.dropZoneOverlay = null;
      }, 200);
    }
  }
  handleDrop(e) {
    var _a;
    this.handleDragLeave();
    const files = [];
    const textPlainData = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
    if (textPlainData && textPlainData.includes("obsidian://open?")) {
      const urls = textPlainData.split(/[\n\r]/).filter((line) => line.trim().startsWith("obsidian://open?"));
      for (const urlString of urls) {
        try {
          const url = new URL(urlString.trim());
          const filePath = url.searchParams.get("file");
          if (filePath) {
            const decodedPath = decodeURIComponent(filePath);
            const pathParts = decodedPath.split(/[/\\]/);
            const filename = pathParts[pathParts.length - 1];
            if (filename.endsWith(".md")) {
              const baseName = filename.replace(".md", "");
              if (baseName && !files.includes(baseName)) {
                files.push(baseName);
              }
            } else {
              if (filename && !files.includes(filename)) {
                files.push(filename);
              }
            }
          }
        } catch (error) {
          console.warn("Failed to parse Obsidian URL:", urlString, error);
        }
      }
    }
    if (files.length > 0) {
      this.addFilesToContext(files);
    } else if (textPlainData && textPlainData.includes("obsidian://open?")) {
      new import_obsidian2.Notice("Only markdown files can be added to context", 3e3);
    } else if (textPlainData && textPlainData.trim() && !textPlainData.includes("://")) {
      new import_obsidian2.Notice("Folders cannot be added to context. Please select individual files.", 3e3);
    }
  }
  async addFilesToContext(filenames) {
    if (filenames.length === 0) return;
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      new import_obsidian2.Notice("Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025.", 3e3);
      return;
    }
    if (this.sidebarView) {
      await this.sidebarView.addFilesToContext(filenames);
    }
  }
  refreshCommandButton() {
    if (this.commandSystem) {
      this.commandSystem.updateCommandButtonVisibility();
    }
  }
  updateContextState(hasContext) {
    if (this.container) {
      if (hasContext) {
        this.container.classList.add("has-context");
      } else {
        this.container.classList.remove("has-context");
      }
    }
  }
  cleanup() {
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.remove();
      this.dropZoneOverlay = null;
    }
    this.eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.eventListeners = [];
  }
};
_InputHandler.FOCUS_DELAY_MS = 150;
var InputHandler = _InputHandler;

// src/ui/command-system.ts
var import_obsidian3 = require("obsidian");
var CommandSystem = class {
  constructor(plugin, container, textArea) {
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.plugin = plugin;
    this.container = container;
    this.textArea = textArea;
  }
  createCommandButton(inputRow) {
    this.commandButton = new import_obsidian3.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: var(--size-2-3);
		`;
    return this.commandButton;
  }
  createCommandPicker() {
    this.createCommandPickerInContainer(this.container);
  }
  createCommandPickerInContainer(container) {
    this.commandPicker = container.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			margin-bottom: 4px;
		`;
  }
  shouldShowCommandButton() {
    return import_obsidian3.Platform.isMobile && this.plugin.settings.showCommandButton && this.plugin.featureManager.isFeatureEnabled("commands");
  }
  updateCommandButtonVisibility() {
    if (this.commandButton) {
      const shouldShow = this.shouldShowCommandButton();
      this.commandButton.buttonEl.style.display = shouldShow ? "flex" : "none";
    }
  }
  toggleCommandMenu() {
    if (!this.commandMenu) {
      this.createCommandMenu();
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  createCommandMenu() {
    this.commandMenu = this.container.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			box-shadow: var(--shadow-s);
			min-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			padding: var(--size-2-2);
		`;
    const commands = [
      { name: "Improve Writing", description: "Enhance clarity and flow", command: "improve writing" },
      { name: "Fix Grammar", description: "Correct grammar and spelling", command: "fix grammar" },
      { name: "Summarize", description: "Create a concise summary", command: "summarize" },
      { name: "Expand Ideas", description: "Develop thoughts further", command: "expand" },
      { name: "Explain", description: "Clarify complex concepts", command: "explain this" },
      { name: "Continue Writing", description: "Extend the current text", command: "continue writing" }
    ];
    const title = this.commandMenu.createEl("div", { text: "Quick Commands" });
    title.style.cssText = `
			font-size: var(--font-ui-medium);
			font-weight: 600;
			margin-bottom: var(--size-2-3);
			color: var(--text-normal);
		`;
    commands.forEach((cmd) => {
      const cmdEl = this.commandMenu.createDiv({ cls: "nova-command-item" });
      cmdEl.style.cssText = `
				padding: var(--size-2-2) var(--size-2-3);
				border-radius: var(--radius-xs);
				cursor: pointer;
				margin-bottom: var(--size-2-1);
				transition: background-color 0.1s;
			`;
      const nameEl = cmdEl.createEl("div", { text: cmd.name });
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
				margin-bottom: var(--size-2-1);
			`;
      const descEl = cmdEl.createEl("div", { text: cmd.description });
      descEl.style.cssText = `
				font-size: var(--font-ui-smaller);
				color: var(--text-muted);
			`;
      cmdEl.addEventListener("click", () => {
        this.textArea.setValue(cmd.command + " ");
        this.textArea.inputEl.focus();
        this.hideCommandMenu();
      });
      cmdEl.addEventListener("mouseenter", () => {
        cmdEl.style.background = "var(--background-modifier-hover)";
      });
      cmdEl.addEventListener("mouseleave", () => {
        cmdEl.style.background = "transparent";
      });
    });
  }
  showCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "block";
      this.isCommandMenuVisible = true;
    }
  }
  hideCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "none";
      this.isCommandMenuVisible = false;
    }
  }
  handleInputChange() {
    if (!this.textArea) {
      return;
    }
    const input = this.textArea.getValue();
    if (input.startsWith(":")) {
      this.showStructuredCommandPicker(input);
    } else {
      this.hideCommandPicker();
    }
  }
  /**
   * Show structured command picker for ":" trigger  
   */
  showStructuredCommandPicker(input) {
    if (!this.commandPicker) {
      return;
    }
    const structuredCommands = this.getStructuredCommands();
    const filterText = input.slice(1).toLowerCase();
    const filtered = structuredCommands.filter(
      (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
    );
    this.commandPickerItems = [];
    this.commandPicker.empty();
    this.selectedCommandIndex = -1;
    if (filtered.length > 0) {
      filtered.forEach((cmd, index) => {
        const item = this.commandPicker.createDiv({ cls: "nova-command-picker-item" });
        item.style.cssText = `
					padding: 8px 12px;
					cursor: pointer;
					border-bottom: 1px solid var(--background-modifier-border-hover);
					transition: background-color 0.2s;
				`;
        const nameEl = item.createEl("div", { text: cmd.name });
        nameEl.style.cssText = `
					font-weight: 500;
					color: var(--text-normal);
					margin-bottom: 4px;
				`;
        const descEl = item.createEl("div", { text: cmd.description });
        descEl.style.cssText = `
					font-size: 0.85em;
					color: var(--text-muted);
					margin-bottom: 4px;
				`;
        const exampleEl = item.createEl("div", { text: `Example: ${cmd.example}` });
        exampleEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-accent);
					font-family: var(--font-monospace);
				`;
        item.addEventListener("click", () => {
          this.selectStructuredCommand(cmd.template);
        });
        item.addEventListener("mouseenter", () => {
          this.selectedCommandIndex = index;
          this.updateCommandPickerSelection();
        });
        this.commandPickerItems.push(item);
      });
      this.commandPicker.style.display = "block";
    } else {
      this.hideCommandPicker();
    }
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
  }
  handleCommandPickerNavigation(key) {
    if (this.commandPickerItems.length === 0) return false;
    if (key === "ArrowDown") {
      this.selectedCommandIndex = Math.min(this.selectedCommandIndex + 1, this.commandPickerItems.length - 1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "ArrowUp") {
      this.selectedCommandIndex = Math.max(this.selectedCommandIndex - 1, -1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "Tab" && this.selectedCommandIndex >= 0) {
      return this.handleCommandPickerSelection();
    }
    return false;
  }
  handleCommandPickerSelection() {
    if (this.selectedCommandIndex >= 0 && this.commandPickerItems.length > 0) {
      const commands = this.getStructuredCommands();
      const input = this.textArea.getValue();
      if (input.startsWith(":")) {
        const filterText = input.slice(1).toLowerCase();
        const filtered = commands.filter(
          (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
        );
        if (this.selectedCommandIndex < filtered.length) {
          const selectedCmd = filtered[this.selectedCommandIndex];
          this.selectStructuredCommand(selectedCmd.template);
          return true;
        }
      }
    }
    return false;
  }
  updateCommandPickerSelection() {
    this.commandPickerItems.forEach((item, index) => {
      if (index === this.selectedCommandIndex) {
        item.style.background = "var(--background-modifier-hover)";
      } else {
        item.style.background = "transparent";
      }
    });
  }
  selectCommand(command) {
    this.textArea.setValue(command + " ");
    this.textArea.inputEl.focus();
    const length = this.textArea.getValue().length;
    this.textArea.inputEl.setSelectionRange(length, length);
    this.hideCommandPicker();
  }
  /**
   * Get structured commands for ":" trigger
   */
  getStructuredCommands() {
    return [
      {
        name: "Add Content",
        description: "Add new content at cursor position",
        command: "add",
        template: "add {cursor}",
        example: ":add paragraph about methodology",
        keywords: ["create", "new", "insert", "write"]
      },
      {
        name: "Edit Selection",
        description: "Edit the selected text",
        command: "edit",
        template: "edit to {cursor}",
        example: ":edit to be more formal",
        keywords: ["modify", "update", "change", "revise"]
      },
      {
        name: "Delete Selection",
        description: "Remove the selected text",
        command: "delete",
        template: "delete {cursor}",
        example: ":delete selected text",
        keywords: ["remove", "eliminate", "erase"]
      },
      {
        name: "Rewrite",
        description: "Rewrite content with specific style",
        command: "rewrite",
        template: "rewrite as {cursor}",
        example: ":rewrite as bullet points",
        keywords: ["rephrase", "restructure", "reword"]
      },
      {
        name: "Fix Grammar",
        description: "Correct grammar and spelling errors",
        command: "grammar",
        template: "fix grammar {cursor}",
        example: ":fix grammar in selection",
        keywords: ["correct", "proofread", "spelling"]
      },
      {
        name: "Continue",
        description: "Continue writing from current position",
        command: "continue",
        template: "continue {cursor}",
        example: ":continue with examples",
        keywords: ["extend", "expand", "proceed"]
      },
      {
        name: "Update Metadata",
        description: "Update document properties",
        command: "metadata",
        template: "update {cursor} property",
        example: ":update tags property",
        keywords: ["frontmatter", "properties", "tags"]
      }
    ];
  }
  /**
   * Select a structured command and insert template
   */
  selectStructuredCommand(template) {
    this.hideCommandPicker();
    const cursorPos = template.indexOf("{cursor}");
    if (cursorPos !== -1) {
      const beforeCursor = template.slice(0, cursorPos);
      const afterCursor = template.slice(cursorPos + 8);
      this.textArea.setValue(beforeCursor + afterCursor);
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(cursorPos, cursorPos);
        this.textArea.inputEl.focus();
      }, 0);
    } else {
      this.textArea.setValue(template);
      this.textArea.inputEl.focus();
    }
  }
  cleanup() {
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.remove();
    }
  }
};

// src/ui/context-manager.ts
var import_obsidian4 = require("obsidian");

// src/ai/context-limits.ts
var CLOUD_PROVIDER_LIMITS = {
  claude: {
    // Claude models - all current versions have 200k tokens
    "claude-sonnet-4-20250514": { tokens: 2e5 },
    "claude-3-5-sonnet-20241022": { tokens: 2e5 },
    "claude-3-5-sonnet-20240620": { tokens: 2e5 },
    "claude-3-5-haiku-20241022": { tokens: 2e5 },
    "claude-3-opus-20240229": { tokens: 2e5 },
    "claude-3-sonnet-20240229": { tokens: 2e5 },
    "claude-3-haiku-20240307": { tokens: 2e5 },
    // Fallback for any Claude model
    "default": { tokens: 2e5, fallback: true }
  },
  openai: {
    // GPT-4.1 models - 1M tokens
    "gpt-4.1-mini-2025-04-14": { tokens: 1e6 },
    "gpt-4.1-turbo-2025-04-14": { tokens: 1e6 },
    // GPT-4o models - 128k tokens
    "gpt-4o": { tokens: 128e3 },
    "gpt-4o-2024-08-06": { tokens: 128e3 },
    "gpt-4o-2024-05-13": { tokens: 128e3 },
    "gpt-4o-mini": { tokens: 128e3 },
    "gpt-4o-mini-2024-07-18": { tokens: 128e3 },
    // GPT-4 Turbo models - 128k tokens
    "gpt-4-turbo": { tokens: 128e3 },
    "gpt-4-turbo-2024-04-09": { tokens: 128e3 },
    "gpt-4-turbo-preview": { tokens: 128e3 },
    "gpt-4-0125-preview": { tokens: 128e3 },
    "gpt-4-1106-preview": { tokens: 128e3 },
    // Legacy GPT-4 models - 8k tokens
    "gpt-4": { tokens: 8e3 },
    "gpt-4-0613": { tokens: 8e3 },
    "gpt-4-0314": { tokens: 8e3 },
    // GPT-3.5 models - 16k tokens
    "gpt-3.5-turbo": { tokens: 16e3 },
    "gpt-3.5-turbo-0125": { tokens: 16e3 },
    "gpt-3.5-turbo-1106": { tokens: 16e3 },
    "gpt-3.5-turbo-16k": { tokens: 16e3 },
    // Fallback for OpenAI models - assume GPT-4o capacity
    "default": { tokens: 128e3, fallback: true }
  },
  google: {
    // Gemini 2.5 models - 1M tokens
    "gemini-2.5-flash-preview-04-17": { tokens: 1e6 },
    "gemini-2.5-flash-exp": { tokens: 1e6 },
    // Gemini 2.0 models - 1M tokens
    "gemini-2.0-flash-exp": { tokens: 1e6 },
    "gemini-2.0-flash-thinking-exp-01-21": { tokens: 1e6 },
    // Gemini 1.5 models - 1M tokens
    "gemini-1.5-pro": { tokens: 1e6 },
    "gemini-1.5-pro-latest": { tokens: 1e6 },
    "gemini-1.5-pro-002": { tokens: 1e6 },
    "gemini-1.5-pro-001": { tokens: 1e6 },
    "gemini-1.5-flash": { tokens: 1e6 },
    "gemini-1.5-flash-latest": { tokens: 1e6 },
    "gemini-1.5-flash-002": { tokens: 1e6 },
    "gemini-1.5-flash-001": { tokens: 1e6 },
    "gemini-1.5-flash-8b": { tokens: 1e6 },
    "gemini-1.5-flash-8b-latest": { tokens: 1e6 },
    "gemini-1.5-flash-8b-001": { tokens: 1e6 },
    // Legacy Gemini models - 30k tokens
    "gemini-pro": { tokens: 3e4 },
    "gemini-pro-vision": { tokens: 3e4 },
    "gemini-1.0-pro": { tokens: 3e4 },
    "gemini-1.0-pro-latest": { tokens: 3e4 },
    "gemini-1.0-pro-001": { tokens: 3e4 },
    // Fallback for Google models - assume modern Gemini capacity
    "default": { tokens: 1e6, fallback: true }
  }
};
function getContextLimit(provider, model) {
  const providerLimits = CLOUD_PROVIDER_LIMITS[provider.toLowerCase()];
  if (!providerLimits) {
    return 32e3;
  }
  const modelLimit = providerLimits[model];
  if (modelLimit) {
    return modelLimit.tokens;
  }
  const defaultLimit = providerLimits["default"];
  if (defaultLimit) {
    return defaultLimit.tokens;
  }
  return 32e3;
}

// src/core/context-calculator.ts
function estimateTokens(text) {
  if (!text) return 0;
  return Math.ceil(text.length / 4);
}
function calculateContextUsage(provider, model, conversationHistory = [], fileAttachments = [], currentInput = "", recentResponse = "", ollamaDefaultContext = 32e3) {
  let contextLimit;
  if (provider.toLowerCase() === "ollama") {
    contextLimit = ollamaDefaultContext;
  } else {
    contextLimit = getContextLimit(provider, model);
  }
  const conversationTokens = conversationHistory.reduce((total, msg) => {
    return total + estimateTokens(msg.content);
  }, 0);
  const fileTokens = fileAttachments.reduce((total, file) => {
    return total + estimateTokens(file.content);
  }, 0);
  const inputTokens = estimateTokens(currentInput);
  const responseTokens = estimateTokens(recentResponse);
  const totalTokens = conversationTokens + fileTokens + inputTokens + responseTokens;
  const usagePercentage = Math.round(totalTokens / contextLimit * 100);
  return {
    totalTokens,
    contextLimit,
    usagePercentage,
    breakdown: {
      conversationHistory: conversationTokens,
      fileAttachments: fileTokens,
      currentInput: inputTokens,
      recentResponse: responseTokens
    }
  };
}
function getRemainingContextPercentage(usage) {
  return Math.max(0, 100 - usage.usagePercentage);
}
function getContextWarningLevel(usage) {
  const remainingPercentage = getRemainingContextPercentage(usage);
  if (remainingPercentage <= 5) {
    return "critical";
  } else if (remainingPercentage <= 15) {
    return "warning";
  } else {
    return "safe";
  }
}
function formatContextUsage(usage) {
  const remainingPercentage = getRemainingContextPercentage(usage);
  const warningLevel = getContextWarningLevel(usage);
  if (warningLevel === "critical") {
    return `${remainingPercentage}% left!`;
  } else {
    return `${remainingPercentage}% left`;
  }
}
function getContextTooltip(usage) {
  const { totalTokens, contextLimit, breakdown } = usage;
  const remainingTokens = contextLimit - totalTokens;
  const lines = [
    `Context Usage: ${totalTokens.toLocaleString()} / ${contextLimit.toLocaleString()} tokens`,
    `Remaining: ${remainingTokens.toLocaleString()} tokens`,
    "",
    "Breakdown:"
  ];
  if (breakdown.conversationHistory > 0) {
    lines.push(`\u2022 Conversation: ${breakdown.conversationHistory.toLocaleString()} tokens`);
  }
  if (breakdown.fileAttachments > 0) {
    lines.push(`\u2022 File context: ${breakdown.fileAttachments.toLocaleString()} tokens`);
  }
  if (breakdown.currentInput > 0) {
    lines.push(`\u2022 Current input: ${breakdown.currentInput.toLocaleString()} tokens`);
  }
  if (breakdown.recentResponse > 0) {
    lines.push(`\u2022 Recent response: ${breakdown.recentResponse.toLocaleString()} tokens`);
  }
  return lines.join("\n");
}

// src/ui/context-manager.ts
var _ContextManager = class _ContextManager {
  constructor(plugin, app, container) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.currentContext = null;
    this.currentFilePath = null;
    // Track current file for validation
    this.currentOperationId = null;
    this.plugin = plugin;
    this.app = app;
    this.container = container;
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  createContextIndicator() {
    this.contextIndicator = this.container.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			position: absolute;
			top: -2px;
			right: var(--size-4-3);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-1) var(--size-2-2);
			font-size: var(--font-ui-smaller);
			color: var(--text-muted);
			display: none;
			z-index: 100;
			max-width: 200px;
			box-shadow: var(--shadow-s);
		`;
  }
  createContextPreview() {
    const previewContainer = this.container.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			margin-bottom: var(--size-2-2);
			font-size: var(--font-ui-small);
			display: none;
		`;
    const previewLabel = previewContainer.createSpan({ text: "Context: " });
    previewLabel.style.cssText = "color: var(--text-muted); font-weight: 600;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview(message) {
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    if (!this.currentFilePath) {
      this.contextPreview.style.display = "none";
      return;
    }
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      foundRefs.push({ name: docName, property });
    }
    if (foundRefs.length === 0) {
      this.contextPreview.style.display = "none";
      return;
    }
    const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
    if (previewList) {
      const refsText = foundRefs.map(
        (ref) => ref.property ? `${ref.name}#${ref.property}` : ref.name
      ).join(", ");
      previewList.textContent = refsText;
    }
    this.contextPreview.style.display = "block";
  }
  async buildContext(message, currentFile) {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context") || !currentFile) {
      return null;
    }
    if (!this.currentFilePath) {
      return null;
    }
    const operationId = Date.now().toString() + Math.random().toString(36).substr(2, 9);
    this.currentOperationId = operationId;
    const targetFilePath = currentFile.path;
    if (this.currentFilePath !== targetFilePath) {
      return null;
    }
    try {
      const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
      const existingPersistent = this.persistentContext.get(currentFile.path) || [];
      if (references.length > 0) {
        const updatedPersistent = [...existingPersistent];
        for (const ref of references) {
          const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
          if (!exists) {
            updatedPersistent.push(ref);
          }
        }
        this.persistentContext.set(currentFile.path, updatedPersistent);
      }
      const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
      const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
        if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
          return false;
        }
        return true;
      });
      if (allPersistentDocs.length !== rawPersistentDocs.length) {
        if (allPersistentDocs.length > 0) {
          this.persistentContext.set(currentFile.path, allPersistentDocs);
        } else {
          this.persistentContext.delete(currentFile.path);
        }
      }
      const contextParts = [];
      const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
      if (currentFileContext) {
        contextParts.push(currentFileContext);
      }
      for (const docRef of allPersistentDocs) {
        const contextPart = await this.getDocumentContext(docRef);
        if (contextPart) {
          contextParts.push(contextPart);
        }
      }
      const contextString = contextParts.join("\n\n---\n\n");
      const tokenCount = this.estimateTokens(contextString);
      const fileAttachments = contextParts.map((content) => ({ content }));
      const totalContextUsage = await this.calculateTotalContextUsage(fileAttachments);
      const context = {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit: false,
        // Legacy field - warnings now handled in sidebar-view.ts
        totalContextUsage
      };
      if (this.currentOperationId !== operationId || !this.currentFilePath || this.currentFilePath !== targetFilePath) {
        return null;
      }
      this.currentContext = context;
      if (context == null ? void 0 : context.persistentDocs.length) {
        this.updateContextIndicator(context);
      }
      return context;
    } catch (error) {
      return null;
    }
  }
  updateContextIndicator(context) {
  }
  hideContextPreview() {
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
  }
  hideContextIndicator() {
    if (this.contextIndicator) {
      this.contextIndicator.style.display = "none";
    }
  }
  clearCurrentContext() {
    this.currentContext = null;
    this.currentFilePath = null;
    this.currentOperationId = null;
    this.hideContextIndicator();
    this.hideContextPreview();
  }
  /**
   * Set current file and immediately clear context to prevent bleeding
   * This should be called synchronously when file switches occur
   */
  setCurrentFile(file) {
    const newFilePath = (file == null ? void 0 : file.path) || null;
    if (this.currentFilePath !== newFilePath) {
      this.currentContext = null;
      this.currentOperationId = null;
      this.hideContextIndicator();
      this.hideContextPreview();
    }
    this.currentFilePath = newFilePath;
  }
  getCurrentContext() {
    return this.currentContext;
  }
  getCurrentFilePath() {
    return this.currentFilePath;
  }
  /**
   * Restore context after chat has been loaded (prevents missing file notifications from being cleared)
   */
  async restoreContextAfterChatLoad(file) {
    if (file && this.plugin.conversationManager) {
      await this.restoreContextFromConversation(file);
    }
    await this.refreshContextFromStorage();
  }
  /**
   * Check if drawer should be visible (has context documents)
   */
  isDrawerVisible() {
    var _a;
    const context = this.getCurrentContext();
    return (((_a = context == null ? void 0 : context.persistentDocs) == null ? void 0 : _a.length) || 0) > 0;
  }
  /**
   * Add document to context for current file
   */
  async addDocument(file) {
    if (!this.currentFilePath) {
      return;
    }
    if (file.path === this.currentFilePath) {
      return;
    }
    const current = this.persistentContext.get(this.currentFilePath) || [];
    const exists = current.some((doc) => doc.file.path === file.path);
    if (exists) {
      return;
    }
    const newRef = {
      file,
      property: void 0,
      isPersistent: true,
      rawReference: `[[${file.basename}]]`
    };
    const updated = [...current, newRef];
    this.persistentContext.set(this.currentFilePath, updated);
    const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
    if (currentFile && currentFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.addContextDocument(currentFile, file.path);
    }
    await this.refreshContextFromStorage();
  }
  /**
   * Remove document from context for current file
   */
  async removeDocument(file) {
    if (!this.currentFilePath) return;
    const current = this.persistentContext.get(this.currentFilePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== file.path);
    if (filtered.length > 0) {
      this.persistentContext.set(this.currentFilePath, filtered);
    } else {
      this.persistentContext.delete(this.currentFilePath);
    }
    const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
    if (currentFile && currentFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.removeContextDocument(currentFile, file.path);
    }
    await this.refreshContextFromStorage();
  }
  /**
   * Update indicator based on current context state
   * Note: SidebarView handles actual UI updates to preserve complex drawer functionality
   */
  updateIndicator() {
  }
  /**
   * Private method to refresh context from storage and update indicator
   */
  async refreshContextFromStorage() {
    if (!this.currentFilePath) {
      this.currentContext = null;
      this.hideContextIndicator();
      return;
    }
    try {
      const persistentDocs = this.persistentContext.get(this.currentFilePath) || [];
      if (persistentDocs.length === 0) {
        this.currentContext = null;
        this.hideContextIndicator();
        return;
      }
      let totalTokens = 0;
      try {
        const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
        if (currentFile instanceof import_obsidian4.TFile) {
          const currentContent = await this.app.vault.read(currentFile);
          totalTokens += Math.ceil(currentContent.length / 4);
        }
      } catch (error) {
      }
      for (const doc of persistentDocs) {
        try {
          const content = await this.app.vault.read(doc.file);
          totalTokens += Math.ceil(content.length / 4);
        } catch (error) {
        }
      }
      const fileAttachments = persistentDocs.length > 0 ? [{ content: `Context files: ${persistentDocs.map((d) => d.file.basename).join(", ")}` }] : [];
      const totalContextUsage = await this.calculateTotalContextUsage(fileAttachments);
      this.currentContext = {
        persistentDocs,
        contextString: "",
        // Not needed for UI
        tokenCount: totalTokens,
        isNearLimit: false,
        // Legacy field - warnings now handled in sidebar-view.ts
        totalContextUsage
      };
    } catch (error) {
      this.currentContext = null;
      this.hideContextIndicator();
    }
  }
  /**
   * Restore context from conversation manager
   */
  async restoreContextFromConversation(file) {
    if (!this.plugin.conversationManager) {
      return;
    }
    try {
      const savedContextDocs = await this.plugin.conversationManager.getContextDocuments(file);
      if (savedContextDocs.length === 0) {
        this.persistentContext.delete(file.path);
        return;
      }
      const validDocumentRefs = [];
      const invalidPaths = [];
      for (const contextDoc of savedContextDocs) {
        try {
          if (!contextDoc || !contextDoc.path || typeof contextDoc.path !== "string") {
            console.warn("Invalid context document structure:", contextDoc);
            continue;
          }
          const contextFile = this.app.vault.getAbstractFileByPath(contextDoc.path);
          if (contextFile && contextFile.path && contextFile instanceof import_obsidian4.TFile) {
            validDocumentRefs.push({
              file: contextFile,
              property: contextDoc.property,
              isPersistent: true,
              rawReference: contextDoc.property ? `[[${contextFile.basename}#${contextDoc.property}]]` : `[[${contextFile.basename}]]`
            });
          } else {
            invalidPaths.push(contextDoc.path);
          }
        } catch (docError) {
          console.warn("Error processing context document, skipping:", docError);
        }
      }
      if (invalidPaths.length > 0) {
        await this.cleanupMissingFiles(file, invalidPaths);
        this.showMissingFilesNotice(invalidPaths);
      }
      if (validDocumentRefs.length > 0) {
        this.persistentContext.set(file.path, validDocumentRefs);
      } else {
        this.persistentContext.delete(file.path);
      }
    } catch (error) {
      console.warn("Failed to restore context from conversation:", error);
      this.persistentContext.delete(file.path);
    }
  }
  /**
   * Clean up missing files from conversation storage
   */
  async cleanupMissingFiles(file, invalidPaths) {
    if (!this.plugin.conversationManager) return;
    try {
      for (const invalidPath of invalidPaths) {
        await this.plugin.conversationManager.removeContextDocument(file, invalidPath);
      }
    } catch (error) {
      console.warn("Failed to cleanup missing files from conversation:", error);
    }
  }
  /**
   * Show notice and chat message about missing context files
   */
  showMissingFilesNotice(missingFiles) {
    if (missingFiles.length === 0) return;
    try {
      let noticeMessage;
      let chatMessage;
      if (missingFiles.length === 1) {
        noticeMessage = `\u26A0\uFE0F Context file no longer available: ${missingFiles[0]}`;
        chatMessage = `Context file no longer available: ${missingFiles[0]}`;
      } else {
        const displayFiles = missingFiles.slice(0, 3);
        const remainingCount = missingFiles.length - displayFiles.length;
        if (remainingCount > 0) {
          noticeMessage = `\u26A0\uFE0F ${missingFiles.length} context files no longer available: ${displayFiles.join(", ")} and ${remainingCount} more`;
          chatMessage = `${missingFiles.length} context files no longer available: ${displayFiles.join(", ")} and ${remainingCount} more`;
        } else {
          noticeMessage = `\u26A0\uFE0F ${missingFiles.length} context files no longer available: ${displayFiles.join(", ")}`;
          chatMessage = `${missingFiles.length} context files no longer available: ${displayFiles.join(", ")}`;
        }
      }
      new import_obsidian4.Notice(noticeMessage, _ContextManager.NOTICE_DURATION_MS);
      if (this.sidebarView && typeof this.sidebarView.addWarningMessage === "function") {
        this.sidebarView.addWarningMessage(chatMessage);
      }
    } catch (error) {
      console.warn("Failed to show missing files notification:", error);
    }
  }
  /**
   * Validate all context documents for a file and return results
   */
  async validateContextDocuments(file) {
    if (!this.plugin.conversationManager) {
      return { validFiles: [], missingFiles: [], totalCount: 0 };
    }
    try {
      const savedContextDocs = await this.plugin.conversationManager.getContextDocuments(file);
      const validFiles = [];
      const missingFiles = [];
      for (const contextDoc of savedContextDocs) {
        const contextFile = this.app.vault.getAbstractFileByPath(contextDoc.path);
        if (contextFile && contextFile.path) {
          validFiles.push(contextDoc.path);
        } else {
          missingFiles.push(contextDoc.path);
        }
      }
      return {
        validFiles,
        missingFiles,
        totalCount: savedContextDocs.length
      };
    } catch (error) {
      return { validFiles: [], missingFiles: [], totalCount: 0 };
    }
  }
  /**
   * Schedule async persistence update
   */
  async schedulePersistenceUpdate(conversationFilePath, references) {
    const conversationFile = this.app.vault.getAbstractFileByPath(conversationFilePath);
    if (conversationFile && conversationFile.path && this.plugin.conversationManager) {
      const contextRefs = references.map((ref) => ({
        path: ref.file.path,
        property: ref.property,
        addedAt: Date.now()
      }));
      await this.plugin.conversationManager.setContextDocuments(conversationFile, contextRefs);
    }
  }
  cleanup() {
    this.clearCurrentContext();
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.contextPreview) {
      this.contextPreview.remove();
    }
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
      this.schedulePersistenceUpdate(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian4.TFile ? file : null;
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Calculate total context usage including conversation history
   */
  async calculateTotalContextUsage(fileAttachments = [], currentInput = "", recentResponse = "") {
    var _a, _b, _c;
    let providerType = "claude";
    let model = "claude-3-5-sonnet-20241022";
    let conversationHistory = [];
    try {
      const detectedProviderType = await ((_a = this.plugin.aiProviderManager) == null ? void 0 : _a.getCurrentProviderType());
      if (detectedProviderType) {
        providerType = detectedProviderType;
        if (this.plugin.aiProviderManager) {
          try {
            const currentModel = this.plugin.aiProviderManager.getCurrentModel();
            if (currentModel) {
              model = currentModel;
            }
          } catch (error) {
            console.warn("Failed to get current model, using default:", error);
          }
        }
      } else {
        console.warn("Provider type detection failed, using Claude defaults");
      }
      if (this.currentFilePath && this.plugin.conversationManager) {
        const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
        if (currentFile) {
          const conversation = await this.plugin.conversationManager.getConversation(currentFile);
          conversationHistory = ((conversation == null ? void 0 : conversation.messages) || []).map((msg) => ({ content: msg.content }));
        }
      }
    } catch (error) {
      console.warn("Error during context calculation setup, using defaults:", error);
    }
    const ollamaDefaultContext = ((_c = (_b = this.plugin) == null ? void 0 : _b.settings) == null ? void 0 : _c.ollamaDefaultContext) || 32e3;
    const usage = calculateContextUsage(
      providerType,
      model,
      conversationHistory,
      fileAttachments,
      currentInput,
      recentResponse,
      ollamaDefaultContext
    );
    return usage;
  }
  /**
   * Clear persistent context for a conversation
   */
  async clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
    const conversationFile = this.app.vault.getAbstractFileByPath(filePath);
    if (conversationFile && conversationFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.clearContextDocuments(conversationFile);
    }
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  async removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
    const conversationFile = this.app.vault.getAbstractFileByPath(filePath);
    if (conversationFile && conversationFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.removeContextDocument(conversationFile, docToRemove);
    }
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens (files only)`;
    const text = `${docCount} docs`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};
// Reference to NovaSidebarView for adding files
_ContextManager.NOTICE_DURATION_MS = 5e3;
var ContextManager = _ContextManager;

// src/ui/chat-renderer.ts
var _ChatRenderer = class _ChatRenderer {
  constructor(plugin, chatContainer) {
    this.plugin = plugin;
    this.chatContainer = chatContainer;
  }
  /**
   * Add a chat message with role header
   */
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom(true);
  }
  /**
   * Unified message creation - determines CSS class at creation time
   */
  addStatusMessage(content, options) {
    const cssClass = this.getMessageCSSClass(content, options);
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${cssClass}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    if (options.persist) {
      const activeFile = this.plugin.app.workspace.getActiveFile();
      if (activeFile) {
        this.plugin.conversationManager.addSystemMessage(
          activeFile,
          content,
          { messageType: cssClass }
          // Store CSS class as metadata
        );
      }
    }
    this.scrollToBottom();
  }
  getMessageCSSClass(content, options) {
    if (options.type === "pill") {
      return `nova-pill-${options.variant}`;
    } else {
      return `nova-bubble-${options.variant}`;
    }
  }
  // Simple wrapper methods for backward compatibility
  addSuccessMessage(content, persist = false) {
    if (!content.startsWith("\u2713 ") && !content.includes("<svg")) {
      content = "\u2713 " + content;
    }
    this.addStatusMessage(content, { type: "pill", variant: "success", persist });
  }
  addErrorMessage(content, persist = false) {
    if (!content.startsWith("\u274C ") && !content.includes("<svg")) {
      content = "\u274C " + content;
    }
    const type = content.length <= 30 ? "pill" : "bubble";
    this.addStatusMessage(content, { type, variant: "error", persist });
  }
  addWarningMessage(content, persist = false) {
    if (!content.startsWith("\u26A0\uFE0F ") && !content.includes("<svg")) {
      content = "\u26A0\uFE0F " + content;
    }
    const type = content.length <= 30 ? "pill" : "bubble";
    this.addStatusMessage(content, { type, variant: "warning", persist });
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			padding: 20px;
			margin-bottom: var(--size-4-3);
			background: var(--background-primary);
			border-radius: var(--radius-s);
			border: 1px solid var(--background-modifier-border);
		`;
    const content = message || `
			<div style="display: flex; flex-direction: column; align-items: center;">
				<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent); margin-bottom: var(--size-4-2);">
					<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
					<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				</svg>
				<p style="margin: 0; margin-left: var(--size-2-3); color: var(--text-muted); font-size: var(--font-ui-medium); line-height: 1.4; text-align: left; align-self: flex-start;">
					I'm your AI writing partner. Select text and right-click for instant editing, or chat for cursor-precise commands.
				</p>
			</div>
		`;
    welcomeEl.innerHTML = content;
    this.scrollToBottom(true);
  }
  clearChat() {
    this.chatContainer.empty();
  }
  scrollToBottom(smooth = false) {
    setTimeout(() => {
      if (smooth) {
        this.chatContainer.scrollTo({
          top: this.chatContainer.scrollHeight,
          behavior: "smooth"
        });
      } else {
        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
      }
    }, _ChatRenderer.SCROLL_DELAY_MS);
  }
  async loadConversationHistory(file) {
    var _a;
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
    if (messages.length === 0) {
      this.addWelcomeMessage();
      return;
    }
    for (const message of messages) {
      if (message.role === "system" && ((_a = message.metadata) == null ? void 0 : _a.messageType)) {
        const messageEl = this.chatContainer.createDiv({
          cls: `nova-message ${message.metadata.messageType}`
        });
        const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
        if (message.content.includes("<svg")) {
          contentEl.innerHTML = message.content;
        } else {
          contentEl.textContent = message.content;
        }
      } else {
        this.addMessage(message.role, message.content);
      }
    }
    this.scrollToBottom();
  }
};
_ChatRenderer.SCROLL_DELAY_MS = 50;
var ChatRenderer = _ChatRenderer;

// src/ui/streaming-manager.ts
var import_obsidian5 = require("obsidian");
var _StreamingManager = class _StreamingManager {
  constructor() {
    this.dotsAnimationInterval = null;
    this.thinkingNotice = null;
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Show thinking notice with context-aware phrase and animated dots
   * Only shows notice if animation mode is 'notice' or not specified (default)
   */
  showThinkingNotice(actionType, animationMode = "notice") {
    if (animationMode !== "notice") {
      return;
    }
    try {
      const phrases = _StreamingManager.THINKING_PHRASES[actionType] || _StreamingManager.THINKING_PHRASES["chat"];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      this.thinkingNotice = new import_obsidian5.Notice(`Nova: ${randomPhrase}.`, 0);
      const initialNoticeText = `Nova: ${randomPhrase}.`;
      const noticeEl = this.thinkingNotice.noticeEl;
      if (noticeEl) {
        noticeEl.textContent = initialNoticeText;
      }
      this.startNoticeDotsAnimation(randomPhrase);
    } catch (error) {
      console.warn("Failed to create thinking notice:", error);
    }
  }
  /**
   * Start streaming at a specific position with hybrid approach
   * For selection replacement: startPos and endPos define the range to replace
   * For cursor insertion: startPos is the cursor position, endPos should be null
   */
  startStreaming(editor, startPos, endPos, options = {}) {
    this.originalPosition = { from: startPos, to: endPos };
    if (endPos) {
      editor.replaceRange("", startPos, endPos);
      this.currentStreamingEndPos = startPos;
    } else {
      this.currentStreamingEndPos = startPos;
    }
    this.streamingStartPos = null;
    const updateStream = (newText, isComplete) => {
      this.updateStreamingText(editor, newText, isComplete, options);
    };
    const stopStream = () => {
      this.stopAnimation();
      this.cleanup();
    };
    return { updateStream, stopStream };
  }
  /**
   * Update streaming text with proper position tracking
   */
  updateStreamingText(editor, newText, isComplete, options) {
    try {
      if (this.currentStreamingEndPos) {
        if (!this.streamingStartPos) {
          this.streamingStartPos = { ...this.currentStreamingEndPos };
        }
        const lines = newText.split("\n");
        const newEndPos = {
          line: this.streamingStartPos.line + lines.length - 1,
          ch: lines.length > 1 ? lines[lines.length - 1].length : this.streamingStartPos.ch + newText.length
        };
        editor.replaceRange(newText, this.streamingStartPos, this.currentStreamingEndPos);
        this.currentStreamingEndPos = newEndPos;
        if (options.onChunk) {
          options.onChunk(newText, isComplete);
        }
      }
      if (isComplete) {
        editor.setCursor(this.currentStreamingEndPos);
        this.cleanup();
        if (options.onComplete) {
          options.onComplete();
        }
      }
    } catch (error) {
      console.warn("Error updating streaming text:", error);
      this.cleanup();
      if (options.onError) {
        options.onError(error instanceof Error ? error : new Error(String(error)));
      }
    }
  }
  /**
   * Animate dots in notice text
   */
  startNoticeDotsAnimation(basePhrase) {
    let dotCount = 1;
    this.dotsAnimationInterval = setInterval(() => {
      try {
        if (!this.thinkingNotice) return;
        dotCount++;
        if (dotCount > 5) {
          dotCount = 1;
        }
        const dots = ".".repeat(dotCount);
        const noticeText = `Nova: ${basePhrase}${dots}`;
        const noticeEl = this.thinkingNotice.noticeEl;
        if (noticeEl) {
          noticeEl.textContent = noticeText;
        }
      } catch (error) {
        console.warn("Error in notice dots animation:", error);
        this.stopDotsAnimation();
      }
    }, 400);
  }
  /**
   * Stop the dots animation and dismiss notice
   */
  stopDotsAnimation() {
    if (this.dotsAnimationInterval) {
      clearInterval(this.dotsAnimationInterval);
      this.dotsAnimationInterval = null;
    }
    if (this.thinkingNotice) {
      this.thinkingNotice.hide();
      this.thinkingNotice = null;
    }
  }
  /**
   * Stop all animations and clean up
   */
  stopAnimation() {
    this.stopDotsAnimation();
  }
  /**
   * Clean up all internal state
   */
  cleanup() {
    this.stopDotsAnimation();
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Get the original position before streaming started
   */
  getOriginalPosition() {
    return this.originalPosition;
  }
  /**
   * Check if currently streaming
   */
  isStreaming() {
    return this.currentStreamingEndPos !== null;
  }
  /**
   * Unified streaming method for selection-based operations
   * Handles both notice animations and document updates
   */
  async startSelectionStreaming(editor, originalRange, actionType, streamingCallback, options = {}) {
    const selectionOptions = { ...options, animationMode: "notice" };
    this.showThinkingNotice(actionType, "notice");
    editor.replaceRange("", originalRange.from, originalRange.to);
    this.currentStreamingEndPos = originalRange.from;
    this.streamingStartPos = null;
    const { updateStream, stopStream } = this.startStreaming(
      editor,
      originalRange.from,
      void 0,
      selectionOptions
    );
    const wrappedCallback = (chunk, isComplete) => {
      updateStream(chunk, isComplete);
      streamingCallback(chunk, isComplete);
    };
    return wrappedCallback;
  }
};
// Comprehensive thinking phrases for all action types
_StreamingManager.THINKING_PHRASES = {
  "improve": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "longer": [
    "expanding...",
    "developing...",
    "elaborating...",
    "building...",
    "enriching...",
    "deepening...",
    "growing...",
    "extending...",
    "amplifying...",
    "unfolding..."
  ],
  "shorter": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ],
  "tone": [
    "adjusting tone...",
    "reshaping...",
    "reframing...",
    "adapting...",
    "transforming...",
    "modulating...",
    "recasting...",
    "shifting...",
    "reforming...",
    "reimagining..."
  ],
  "custom": [
    "working on it...",
    "considering...",
    "thinking...",
    "processing...",
    "analyzing...",
    "contemplating...",
    "understanding...",
    "interpreting...",
    "exploring...",
    "evaluating..."
  ],
  "chat": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "add": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "edit": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "rewrite": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "grammar": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "delete": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ]
};
var StreamingManager = _StreamingManager;

// src/ui/selection-context-menu.ts
var import_obsidian9 = require("obsidian");

// src/core/commands/selection-edit-command.ts
var import_obsidian6 = require("obsidian");
var SelectionEditCommand = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Execute a selection-based edit action
   */
  async execute(action, editor, selectedText, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const loadingNotice = new import_obsidian6.Notice("Nova is processing your request...", 0);
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      const response = await this.plugin.aiProviderManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt
      );
      loadingNotice.hide();
      const transformedText = this.cleanAIResponse(response);
      return {
        success: true,
        transformedText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit command error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Execute a selection-based edit action with streaming
   */
  async executeStreaming(action, editor, selectedText, onChunk, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      let fullResponse = "";
      const stream = this.plugin.aiProviderManager.generateTextStream(prompt2.userPrompt, {
        systemPrompt: prompt2.systemPrompt
      });
      for await (const chunk of stream) {
        if (chunk.error) {
          throw new Error(chunk.error);
        }
        fullResponse += chunk.content;
        if (fullResponse.trim().length > 0 || chunk.done) {
          const cleanedChunk = this.cleanAIResponse(fullResponse);
          onChunk(cleanedChunk, chunk.done);
        }
        if (chunk.done) {
          break;
        }
      }
      const finalText = this.cleanAIResponse(fullResponse);
      if (!finalText.trim()) {
        return {
          success: false,
          error: "AI provider returned empty response",
          originalRange: selectionRange
        };
      }
      return {
        success: true,
        transformedText: finalText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit streaming error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Build prompt for the AI based on the action type
   */
  buildPrompt(action, selectedText, customInstruction) {
    const baseSystemPrompt = `You are Nova, an AI writing assistant. Your task is to transform the provided text according to the user's request. 

CRITICAL RULES:
- Provide ONLY the transformed text, no explanations or meta-commentary
- Maintain the original meaning unless specifically asked to change it
- Preserve the original format (markdown, structure, etc.) unless instructed otherwise
- Do not add introductory phrases like "Here's the improved text:" or similar
- Return only the content that should replace the selected text`;
    let specificPrompt = "";
    let userPrompt = "";
    switch (action) {
      case "improve":
        specificPrompt = `
TASK: Improve the writing quality
- Make the text clearer and more concise
- Improve flow and readability
- Fix any awkward phrasing
- Preserve the original tone and meaning`;
        userPrompt = `Improve this text:

${selectedText}`;
        break;
      case "longer":
        specificPrompt = `
TASK: Expand the text with more detail
- Add relevant examples, context, or explanations
- Maintain the original style and voice
- Expand ideas without changing the core message
- Make it more comprehensive and detailed`;
        userPrompt = `Make this text longer and more detailed:

${selectedText}`;
        break;
      case "shorter":
        specificPrompt = `
TASK: Condense the text to essential points
- Remove redundancy and unnecessary words
- Keep all key information and meaning
- Make it more concise and direct
- Preserve the original tone`;
        userPrompt = `Make this text shorter and more concise:

${selectedText}`;
        break;
      case "tone":
        const toneMap = {
          "formal": "professional and structured, suitable for business or academic contexts",
          "casual": "relaxed and conversational, suitable for informal communication",
          "academic": "scholarly and precise, using technical vocabulary where appropriate",
          "friendly": "warm and approachable, building connection with the reader"
        };
        const toneDescription = toneMap[customInstruction || "formal"] || toneMap.formal;
        specificPrompt = `
TASK: Change the tone to be ${toneDescription}
- Adjust language and vocabulary to match the requested tone
- Keep the same content and meaning
- Maintain appropriate formality level for the chosen tone`;
        userPrompt = `Rewrite this text in a ${customInstruction || "formal"} tone:

${selectedText}`;
        break;
      case "custom":
        specificPrompt = `
TASK: Apply custom transformation
- Follow the user's specific instruction exactly
- Maintain content integrity unless asked to change it
- Apply the requested changes precisely`;
        userPrompt = `Apply this instruction to the text: "${customInstruction}"

Text to transform:

${selectedText}`;
        break;
      default:
        specificPrompt = `
TASK: General text improvement
- Enhance clarity and readability
- Preserve original meaning and tone`;
        userPrompt = `Improve this text:

${selectedText}`;
    }
    return {
      systemPrompt: baseSystemPrompt + "\n" + specificPrompt,
      userPrompt
    };
  }
  /**
   * Clean AI response to extract only the transformed text
   */
  cleanAIResponse(response) {
    let cleaned = response.trim();
    const introPatterns = [
      /^Here's the improved text:?\s*/i,
      /^Here's the rewritten text:?\s*/i,
      /^Here's the transformed text:?\s*/i,
      /^Improved version:?\s*/i,
      /^Rewritten:?\s*/i,
      /^Result:?\s*/i,
      /^Output:?\s*/i
    ];
    for (const pattern of introPatterns) {
      cleaned = cleaned.replace(pattern, "");
    }
    cleaned = cleaned.split(/\n\s*---+\s*/).shift() || cleaned;
    cleaned = cleaned.split(/\n\s*\*\*?Explanation\*?\*?:/i).shift() || cleaned;
    return cleaned.trim();
  }
};

// src/ui/tone-selection-modal.ts
var import_obsidian7 = require("obsidian");
var TONE_OPTIONS = [
  {
    id: "formal",
    label: "Formal",
    description: "Professional, structured language suitable for business or academic contexts"
  },
  {
    id: "casual",
    label: "Casual",
    description: "Relaxed, conversational tone for informal communication"
  },
  {
    id: "academic",
    label: "Academic",
    description: "Scholarly, precise language with technical vocabulary"
  },
  {
    id: "friendly",
    label: "Friendly",
    description: "Warm, approachable tone that builds connection"
  }
];
var ToneSelectionModal = class extends import_obsidian7.FuzzySuggestModal {
  constructor(app, onSelect, onCancel) {
    super(app);
    this.onSelect = onSelect;
    this.onCancel = onCancel;
    this.setPlaceholder("Choose a writing tone...");
    this.setInstructions([
      { command: "\u2191\u2193", purpose: "to navigate" },
      { command: "\u21B5", purpose: "to apply tone" },
      { command: "esc", purpose: "to cancel" }
    ]);
  }
  getItems() {
    return TONE_OPTIONS;
  }
  getItemText(tone) {
    return `${tone.label} - ${tone.description}`;
  }
  onChooseItem(tone, evt) {
    this.onSelect(tone.id);
  }
  onClose() {
    const { contentEl } = this;
    if (contentEl.parentElement) {
      this.onCancel();
    }
  }
};

// src/ui/custom-instruction-modal.ts
var import_obsidian8 = require("obsidian");
var CustomInstructionModal = class extends import_obsidian8.Modal {
  constructor(app, onSubmit, onCancel) {
    super(app);
    this.instruction = "";
    this.onSubmit = onSubmit;
    this.onCancel = onCancel;
  }
  onOpen() {
    var _a;
    const { contentEl } = this;
    contentEl.empty();
    this.modalEl.addClass("nova-custom-instruction-modal");
    contentEl.createEl("h2", { text: "Tell Nova" });
    new import_obsidian8.Setting(contentEl).setName("Instruction").setDesc("Describe how you want Nova to transform your selected text");
    const textAreaSetting = new import_obsidian8.Setting(contentEl).addTextArea((text) => {
      text.setPlaceholder('e.g., "make this more persuasive", "add statistics", "write in bullet points"').setValue(this.instruction).onChange((value) => {
        this.instruction = value;
      });
      text.inputEl.rows = 4;
      text.inputEl.style.width = "100%";
      text.inputEl.style.minHeight = "100px";
      setTimeout(() => text.inputEl.focus(), 50);
      text.inputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && (e.ctrlKey || e.metaKey)) {
          e.preventDefault();
          this.submit();
        }
      });
      return text;
    });
    textAreaSetting.settingEl.style.border = "none";
    (_a = textAreaSetting.settingEl.querySelector(".setting-item-info")) == null ? void 0 : _a.remove();
    const control = textAreaSetting.settingEl.querySelector(".setting-item-control");
    if (control instanceof HTMLElement) {
      control.style.width = "100%";
    }
    new import_obsidian8.Setting(contentEl).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
      this.onCancel();
    })).addButton((btn) => btn.setButtonText("Transform Text").setCta().onClick(() => this.submit()));
  }
  submit() {
    if (this.instruction.trim()) {
      this.close();
      this.onSubmit(this.instruction.trim());
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/ui/selection-context-menu.ts
var SELECTION_ACTIONS = [
  {
    id: "improve",
    label: "Improve Writing",
    icon: "sparkles",
    description: "Make text clearer, more concise, better flow"
  },
  {
    id: "longer",
    label: "Make Longer",
    icon: "plus-circle",
    description: "Expand ideas with more detail and examples"
  },
  {
    id: "shorter",
    label: "Make Shorter",
    icon: "minus-circle",
    description: "Condense to essential points"
  },
  {
    id: "tone",
    label: "Change Tone",
    icon: "palette",
    description: "Adjust writing style and tone"
  },
  {
    id: "custom",
    label: "Tell Nova...",
    icon: "message-circle",
    description: "Custom instruction for transformation"
  }
];
var SelectionContextMenu = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.animatedSelection = null;
    this.selectionEditCommand = new SelectionEditCommand(plugin);
    this.streamingManager = new StreamingManager();
  }
  /**
   * Set callback to be called when streaming completes
   */
  setCompletionCallback(callback) {
    this.completionCallback = callback;
  }
  /**
   * Called when streaming completes
   */
  onStreamingComplete() {
    if (this.completionCallback) {
      this.completionCallback();
    }
  }
  /**
   * Register the context menu with Obsidian's editor
   */
  register() {
    this.plugin.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor) => {
        this.addNovaSubmenu(menu, editor);
      })
    );
  }
  /**
   * Add Nova submenu to the context menu if text is selected
   */
  addNovaSubmenu(menu, editor) {
    const selectedText = editor.getSelection();
    if (!selectedText || selectedText.trim().length === 0) {
      return;
    }
    menu.addSeparator();
    SELECTION_ACTIONS.forEach((action) => {
      menu.addItem((item) => {
        item.setTitle(`Nova: ${action.label}`).setIcon(action.icon || "edit").onClick(() => {
          this.handleSelectionAction(action.id, editor, selectedText);
        });
      });
    });
  }
  /**
   * Handle selection action when menu item is clicked
   */
  async handleSelectionAction(actionId, editor, selectedText, customInstruction) {
    try {
      if (actionId === "tone" && !customInstruction) {
        this.showToneSelectionModal(editor, selectedText);
        return;
      }
      if (actionId === "custom" && !customInstruction) {
        this.showCustomInstructionModal(editor, selectedText);
        return;
      }
      await this.executeSelectionEdit(actionId, editor, selectedText, customInstruction);
    } catch (error) {
      console.error("Error executing Nova selection action:", error);
      new import_obsidian9.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show tone selection modal
   */
  showToneSelectionModal(editor, selectedText) {
    const modal = new ToneSelectionModal(
      this.app,
      async (selectedTone) => {
        await this.executeSelectionEdit("tone", editor, selectedText, selectedTone);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Show custom instruction modal
   */
  showCustomInstructionModal(editor, selectedText) {
    const modal = new CustomInstructionModal(
      this.app,
      async (instruction) => {
        await this.executeSelectionEdit("custom", editor, selectedText, instruction);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Execute the selection edit command with streaming
   */
  async executeSelectionEdit(actionId, editor, selectedText, customInstruction) {
    this.startSelectionAnimation(editor);
    const originalRange = {
      from: editor.getCursor("from"),
      to: editor.getCursor("to")
    };
    try {
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        originalRange.from,
        originalRange.to,
        {
          animationMode: "notice",
          onComplete: () => this.onStreamingComplete()
        }
      );
      this.streamingManager.showThinkingNotice(actionId, "notice");
      const result = await this.selectionEditCommand.executeStreaming(
        actionId,
        editor,
        selectedText,
        (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        },
        customInstruction
      );
      stopStream();
      if (result.success) {
        const actionName = this.getActionDisplayName(actionId);
        new import_obsidian9.Notice(`Nova: Text ${actionName} successfully`, 2e3);
        this.addSuccessChatMessage(actionId, selectedText, customInstruction);
      } else {
        new import_obsidian9.Notice(`Nova: ${result.error || "Failed to process text"}`, 3e3);
        this.addFailureChatMessage(actionId, result.error || "Failed to process text");
        this.restoreOriginalText(editor);
      }
    } catch (error) {
      console.error("Error in streaming selection edit:", error);
      new import_obsidian9.Notice("Failed to execute Nova action. Please try again.", 3e3);
      this.restoreOriginalText(editor);
    } finally {
      this.stopSelectionAnimation();
      this.streamingManager.stopAnimation();
    }
  }
  /**
   * Restore original text if streaming fails completely
   */
  restoreOriginalText(editor) {
  }
  /**
   * Start pulsing animation on selected text
   */
  startSelectionAnimation(editor) {
    var _a;
    try {
      const editorContainer = ((_a = editor.cm) == null ? void 0 : _a.dom) || document.querySelector(".cm-editor");
      if (editorContainer) {
        editorContainer.classList.add("nova-selection-processing");
      }
      const selection = editor.getSelection();
      if (selection) {
        this.animatedSelection = {
          from: editor.getCursor("from"),
          to: editor.getCursor("to")
        };
      }
    } catch (error) {
      console.warn("Failed to start selection animation:", error);
    }
  }
  /**
   * Stop pulsing animation
   */
  stopSelectionAnimation() {
    try {
      const editorElements = document.querySelectorAll(".CodeMirror, .cm-editor");
      editorElements.forEach((el) => {
        el.classList.remove("nova-selection-processing");
      });
      this.animatedSelection = null;
    } catch (error) {
      console.warn("Failed to stop selection animation:", error);
    }
  }
  /**
   * Get display name for action
   */
  getActionDisplayName(actionId) {
    switch (actionId) {
      case "improve":
        return "improved";
      case "longer":
        return "expanded";
      case "shorter":
        return "condensed";
      case "tone":
        return "tone adjusted";
      case "custom":
        return "transformed";
      default:
        return "processed";
    }
  }
  /**
   * Add success message to chat using unified system
   */
  addSuccessChatMessage(actionId, originalText, customInstruction) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView == null ? void 0 : sidebarView.chatRenderer) {
          const actionDescription = this.getActionDescription(actionId, customInstruction);
          const truncatedText = originalText.length > 50 ? originalText.substring(0, 50) + "..." : originalText;
          const message = `\u2713 ${actionDescription} text: "${truncatedText}"`;
          sidebarView.chatRenderer.addSuccessMessage(message, true);
        }
      }
    } catch (error) {
      console.warn("Failed to add success chat message:", error);
    }
  }
  /**
   * Add failure message to chat using unified system
   */
  addFailureChatMessage(actionId, errorMessage) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView == null ? void 0 : sidebarView.chatRenderer) {
          const actionName = this.getActionDisplayName(actionId);
          const message = `\u2717 Failed to ${actionName.replace("ed", "")} text: ${errorMessage}`;
          sidebarView.chatRenderer.addErrorMessage(message, true);
        }
      }
    } catch (error) {
      console.warn("Failed to add error chat message:", error);
    }
  }
  /**
   * Get detailed action description for chat
   */
  getActionDescription(actionId, customInstruction) {
    switch (actionId) {
      case "improve":
        return "Improved";
      case "longer":
        return "Expanded";
      case "shorter":
        return "Condensed";
      case "tone":
        return `Changed tone to ${customInstruction || "formal"}`;
      case "custom":
        return `Applied "${customInstruction}"`;
      default:
        return "Processed";
    }
  }
};

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var _NovaSidebarView = class _NovaSidebarView extends import_obsidian10.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.currentContext = null;
    this.lastTokenWarnings = {};
    // PHASE 3 FIX: Race condition prevention
    this.currentFileLoadOperation = null;
    // Track user-initiated provider changes to prevent spurious messages
    this.isUserInitiatedProviderChange = false;
    // Command system delegation
    this._commandPickerItems = [];
    this._selectedCommandIndex = -1;
    this._isCommandMenuVisible = false;
    // Cursor position tracking - file-scoped like conversation history
    this.currentFileCursorPosition = null;
    // Document drawer state (transient - always starts closed on file switch)
    this.isDrawerOpen = false;
    this.contextDrawerCloseHandler = null;
    // Performance optimization - debouncing and timing constants
    this.contextPreviewDebounceTimeout = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    this.plugin = plugin;
  }
  // Cursor-only architecture - delegate to new components
  get textArea() {
    var _a;
    return (_a = this.inputHandler) == null ? void 0 : _a.getTextArea();
  }
  get wikilinkAutocomplete() {
    return this.inputHandler ? { destroy: () => {
    } } : null;
  }
  get autoGrowTextarea() {
    return () => {
    };
  }
  get commandPickerItems() {
    return this._commandPickerItems;
  }
  set commandPickerItems(value) {
    this._commandPickerItems = value;
  }
  get selectedCommandIndex() {
    return this._selectedCommandIndex;
  }
  set selectedCommandIndex(value) {
    this._selectedCommandIndex = value;
  }
  get isCommandMenuVisible() {
    return this._isCommandMenuVisible;
  }
  set isCommandMenuVisible(value) {
    this._isCommandMenuVisible = value;
  }
  // Context system delegation
  get contextPreview() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextPreview;
  }
  get contextIndicator() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextIndicator;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova";
  }
  getIcon() {
    return "nova-star";
  }
  /**
   * Centralized callback for when any streaming operation completes
   * Updates all UI elements that depend on document content
   */
  onStreamingComplete() {
    this.refreshAllStats();
    this.refreshContext();
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    if (import_obsidian10.Platform.isMobile) {
      container.addClass("is-mobile");
    } else {
      container.addClass("is-desktop");
    }
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian10.Platform.isDesktopApp ? "var(--size-4-6)" : "var(--size-4-5)"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			flex-direction: column;
			padding: var(--size-4-2);
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const topRowEl = headerEl.createDiv();
    topRowEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
		`;
    const titleEl = topRowEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: var(--font-ui-medium); display: flex; align-items: center; gap: var(--size-2-2); color: var(--interactive-accent);";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size); height: var(--icon-size);">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = topRowEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: var(--size-2-3);";
    const privacyIndicator = rightContainer.createDiv({ cls: "nova-privacy-indicator" });
    this.updatePrivacyIndicator(privacyIndicator);
    this.privacyIndicator = privacyIndicator;
    await this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian10.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    const isMobile = import_obsidian10.Platform.isMobile;
    clearButton.buttonEl.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-change", (editor) => {
        this.trackCursorPosition(editor);
      })
    );
    this.setupEditorBlurListener();
    this.loadConversationForActiveFile();
    if (this.plugin.selectionContextMenu) {
      this.plugin.selectionContextMenu.setCompletionCallback(() => this.onStreamingComplete());
    }
    this.isUserInitiatedProviderChange = false;
    await this.refreshProviderStatus();
  }
  /**
   * Track cursor position changes in the active editor (file-scoped)
   */
  trackCursorPosition(editor) {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile || !editor) {
      return;
    }
    if (this.currentFile && activeFile.path === this.currentFile.path) {
      const cursorPos = editor.getCursor();
      if (cursorPos) {
        this.currentFileCursorPosition = cursorPos;
      }
    }
  }
  /**
   * Restore cursor position for current file (file-scoped)
   */
  restoreCursorPosition() {
    if (this.currentFileCursorPosition) {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (editor) {
        editor.setCursor(this.currentFileCursorPosition);
      }
    }
  }
  /**
   * Setup focus-based stats updates using Nova input focus as trigger
   */
  setupEditorBlurListener() {
    var _a, _b;
    const inputElement = (_b = (_a = this.inputHandler) == null ? void 0 : _a.getTextArea()) == null ? void 0 : _b.inputEl;
    if (inputElement) {
      this.registerDomEvent(inputElement, "focus", () => {
        this.refreshAllStats();
      });
    }
    this.registerDomEvent(this.containerEl, "mousedown", () => {
      setTimeout(() => {
        this.refreshAllStats();
      }, 50);
    });
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
      this.contextPreviewDebounceTimeout = null;
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
    if (this.contextDrawerCloseHandler) {
      document.removeEventListener("click", this.contextDrawerCloseHandler);
      this.contextDrawerCloseHandler = null;
    }
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: var(--size-4-2);
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: var(--size-2-3);
		`;
    this.chatRenderer = new ChatRenderer(this.plugin, this.chatContainer);
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements using new architecture
   */
  createInputArea() {
    this.inputContainer.empty();
    this.contextManager = new ContextManager(this.plugin, this.app, this.inputContainer);
    this.streamingManager = new StreamingManager();
    this.selectionContextMenu = this.plugin.selectionContextMenu;
    this.inputHandler = new InputHandler(this.plugin, this.inputContainer, this.contextManager);
    this.inputHandler.setSidebarView(this);
    this.contextManager.setSidebarView(this);
    this.inputHandler.createInputInterface(this.chatContainer);
    this.commandSystem = new CommandSystem(this.plugin, this.inputContainer, this.inputHandler.getTextArea());
    this.inputHandler.setCommandSystem(this.commandSystem);
    this.inputHandler.setOnSendMessage((message) => {
      this.handleSend(message);
    });
    this.contextManager.createContextIndicator();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-text-size);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  // REPLACE with simple delegation to ChatRenderer:
  addSuccessMessage(content) {
    this.chatRenderer.addSuccessMessage(content, true);
  }
  addErrorMessage(content) {
    this.chatRenderer.addErrorMessage(content, true);
  }
  addWelcomeMessage(message) {
    this.chatRenderer.addWelcomeMessage(message);
  }
  addSuccessIndicator(action) {
    const messages = {
      "add": "\u2713 Content added",
      "edit": "\u2713 Content edited",
      "delete": "\u2713 Content deleted",
      "grammar": "\u2713 Grammar fixed",
      "rewrite": "\u2713 Content rewritten"
    };
    const message = messages[action] || "\u2713 Command completed";
    this.addSuccessMessage(message);
  }
  addErrorIndicator(action, error) {
    const messages = {
      "add": "\u274C Failed to add content",
      "edit": "\u274C Failed to edit content",
      "delete": "\u274C Failed to delete content",
      "grammar": "\u274C Failed to fix grammar",
      "rewrite": "\u274C Failed to rewrite content",
      "execute": "\u274C Command execution error"
    };
    let message = messages[action] || "\u274C Command failed";
    if (error) {
      message += `: ${error}`;
    }
    this.addErrorMessage(message);
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addErrorMessage("Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025.");
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentModel(providerId);
      await this.plugin.saveSettings();
      this.addSuccessMessage(`\u2713 Switched to ${this.getProviderWithModelDisplayName(providerId)}`);
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.inputHandler.getTextArea().setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addSuccessMessage(`\u2713 Loaded template: ${customCommand.name}`);
        return true;
      }
    }
    this.addErrorMessage(`\u274C Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`);
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker nova-panel-base" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.inputHandler.getTextArea().getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("commands")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item nova-panel-item" });
      const triggerEl = item.createSpan({ cls: "nova-command-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      const nameEl = item.createSpan({ cls: "nova-command-name nova-panel-text" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1;";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.removeClass("selected");
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].addClass("selected");
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    var _a;
    const commands = [];
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
    if (selectedText && selectedText.trim().length > 0) {
      SELECTION_ACTIONS.forEach((action) => {
        commands.push({
          trigger: action.id,
          name: `Nova: ${action.label}`,
          description: action.description
        });
      });
      commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Provider Commands" });
    }
    commands.push(
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" }
    );
    if (import_obsidian10.Platform.isDesktopApp) {
      commands.push({ trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" });
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      if (customCommands.length > 0) {
        commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Custom Commands" });
        customCommands.forEach((cmd) => {
          commands.push({
            trigger: cmd.trigger,
            name: cmd.name,
            ...cmd.description && { description: cmd.description }
          });
        });
      }
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu nova-panel-base" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addErrorMessage("Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025.");
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header nova-panel-header" });
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      if (command.trigger === "---") {
        const separator = this.commandMenu.createDiv({ cls: "nova-command-menu-separator" });
        separator.style.cssText = `
					padding: 8px 16px 4px 16px;
					font-size: 0.75em;
					color: var(--text-muted);
					font-weight: 600;
					text-transform: uppercase;
					letter-spacing: 0.5px;
					border-top: 1px solid var(--background-modifier-border);
					margin-top: 4px;
					cursor: default;
				`;
        separator.textContent = command.description || "";
        return;
      }
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item nova-panel-item-vertical" });
      const nameEl = item.createDiv({ cls: "nova-command-menu-name nova-panel-text" });
      nameEl.textContent = command.name;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.opacity = "0.8";
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  async executeCommandFromMenu(trigger) {
    var _a;
    this.hideCommandMenu();
    const selectionAction = SELECTION_ACTIONS.find((action) => action.id === trigger);
    if (selectionAction) {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
      const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
      if ((activeView == null ? void 0 : activeView.editor) && selectedText && selectedText.trim().length > 0) {
        await this.selectionContextMenu.handleSelectionAction(trigger, activeView.editor, selectedText);
      } else {
        new import_obsidian10.Notice("No text selected. Please select text to use Nova editing commands.", 3e3);
      }
      return;
    }
    if (trigger === "---") {
      return;
    }
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextPreview() {
    if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return document.createElement("div");
    }
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  /**
   * Debounced version of updateLiveContextPreview for performance
   */
  debouncedUpdateContextPreview() {
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
    }
    this.contextPreviewDebounceTimeout = setTimeout(() => {
      this.updateLiveContextPreview();
      this.contextPreviewDebounceTimeout = null;
    }, _NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS);
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview || !this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
      return;
    }
    const message = this.inputHandler.getTextArea().getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.contextManager.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian10.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian10.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian10.TFile ? file : null;
  }
  updateContextIndicator() {
    var _a, _b, _c, _d;
    if (!this.contextIndicator) {
      return;
    }
    const newDocCount = ((_b = (_a = this.currentContext) == null ? void 0 : _a.persistentDocs) == null ? void 0 : _b.length) || 0;
    const currentDocCount = this.contextIndicator.getAttribute("data-doc-count");
    const currentFilePath = this.contextIndicator.getAttribute("data-file-path");
    const newFilePath = ((_c = this.currentFile) == null ? void 0 : _c.path) || "";
    if (currentDocCount === newDocCount.toString() && currentFilePath === newFilePath && newDocCount > 0) {
      return;
    }
    if (this.contextDrawerCloseHandler) {
      document.removeEventListener("click", this.contextDrawerCloseHandler);
      this.contextDrawerCloseHandler = null;
    }
    this.contextIndicator.empty();
    if (!this.currentContext || !this.currentContext.persistentDocs) {
      this.contextIndicator.style.display = "none";
      this.contextIndicator.removeAttribute("data-doc-count");
      this.contextIndicator.removeAttribute("data-file-path");
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (!allDocs || allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      this.contextIndicator.removeAttribute("data-doc-count");
      this.contextIndicator.removeAttribute("data-file-path");
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    this.contextIndicator.setAttribute("data-doc-count", allDocs.length.toString());
    this.contextIndicator.setAttribute("data-file-path", ((_d = this.currentFile) == null ? void 0 : _d.path) || "");
    if (this.inputHandler) {
      this.inputHandler.updateContextState(true);
    }
    const isMobile = import_obsidian10.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: flex;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			height: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const docNames = allDocs.filter((doc) => {
      var _a2;
      return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
    }).map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px; min-width: 0;";
    const filenamePartEl = summaryTextEl.createSpan();
    filenamePartEl.style.cssText = "display: flex; align-items: center; gap: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; min-width: 0; flex: 1;";
    const iconSpan = filenamePartEl.createSpan();
    iconSpan.innerHTML = this.createInlineIcon("book-open");
    iconSpan.style.cssText = "flex-shrink: 0; display: flex; align-items: center;";
    const textSpan = filenamePartEl.createSpan();
    textSpan.textContent = `${docNames.join(", ")}${moreCount}`;
    textSpan.style.cssText = "overflow: hidden; text-overflow: ellipsis; min-width: 0;";
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian10.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("trash-2").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.contextManager.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.filter((doc) => {
      var _a2;
      return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
    }).forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em; flex-shrink: 0;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
				flex: 1;
				min-width: 0;
				margin-right: 8px;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
				flex-shrink: 0;
				margin-right: 8px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.textContent = "\xD7";
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 4px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: normal;
				line-height: 1;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.contextManager.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    this.isDrawerOpen = false;
    expandedEl.style.display = "none";
    const toggleExpanded = (e) => {
      e.stopPropagation();
      this.isDrawerOpen = !this.isDrawerOpen;
      if (this.isDrawerOpen) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    this.contextDrawerCloseHandler = (e) => {
      if (this.isDrawerOpen && !this.contextIndicator.contains(e.target)) {
        this.isDrawerOpen = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    document.addEventListener("click", this.contextDrawerCloseHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      if (this.contextManager.getCurrentFilePath() !== this.currentFile.path) {
        this.contextManager.setCurrentFile(this.currentFile);
      }
      try {
        this.currentContext = await this.contextManager.buildContext("", this.currentFile);
        this.updateContextIndicator();
        this.updateTokenDisplay();
      } catch (error) {
        console.warn("Failed to refresh context:", error);
        this.currentContext = null;
        this.updateContextIndicator();
        this.updateTokenDisplay();
      }
    } else {
      this.currentContext = null;
      this.contextManager.setCurrentFile(null);
      this.updateContextIndicator();
      this.updateTokenDisplay();
    }
  }
  async handleSend(message) {
    var _a, _b, _c, _d, _e, _f;
    const messageText = message || this.inputHandler.getValue().trim();
    if (!messageText) return;
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (!currentProviderType) {
      this.addErrorMessage(this.createIconMessage("alert-circle", "Nova is disabled or no AI provider is available. Please configure an AI provider in settings."));
      return;
    }
    if (messageText.startsWith(":")) {
      const commandResult = await this.handleColonCommand(messageText);
      if (commandResult) {
        this.inputHandler.setValue("");
        return;
      }
    }
    let processedMessage = messageText;
    let multiDocContext = null;
    if (this.currentFile) {
      if (!this.plugin.featureManager.isFeatureEnabled("multi-doc-context")) {
        if (messageText.includes("[[")) {
          this.addErrorMessage("Multi-document context is currently in early access for Supernova supporters. Available to all users August 15, 2025.");
          return;
        }
      } else {
        const context = await this.contextManager.buildContext(messageText, this.currentFile);
        const contextResult = context ? { cleanedMessage: "", context } : null;
        processedMessage = (contextResult == null ? void 0 : contextResult.cleanedMessage) || messageText;
        multiDocContext = (contextResult == null ? void 0 : contextResult.context) || null;
        this.currentContext = multiDocContext;
        this.updateContextIndicator();
        const previousPersistentCount = ((_b = (_a = this.currentContext) == null ? void 0 : _a.persistentDocs) == null ? void 0 : _b.length) || 0;
        const currentPersistentCount = ((_c = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _c.length) || 0;
        const hasNewDocs = currentPersistentCount > previousPersistentCount;
        const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
        if (isContextOnlyMessage) {
          const newDocsCount = currentPersistentCount - previousPersistentCount;
          if (newDocsCount > 0 && (multiDocContext == null ? void 0 : multiDocContext.persistentDocs) && multiDocContext.persistentDocs.length > 0) {
            const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
            const docNames = newDocs.filter((doc) => {
              var _a2;
              return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
            }).map((doc) => doc.file.basename).join(", ");
            if (docNames) {
              this.addSuccessMessage(this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
            }
          }
          this.inputHandler.setValue("");
          this.updateContextIndicator();
          if (this.contextPreview) {
            this.contextPreview.style.display = "none";
          }
          return;
        }
        if ((_d = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _d.length) {
          const allDocs = multiDocContext.persistentDocs;
          const docNames = allDocs.filter((doc) => {
            var _a2;
            return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
          }).map((doc) => doc.file.basename).join(", ");
          if (docNames && allDocs.length > 0) {
            const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
            const currentFile = ((_e = this.currentFile) == null ? void 0 : _e.basename) || "current file";
            this.addSuccessMessage(`\u2713 Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`);
          }
        }
        if (multiDocContext == null ? void 0 : multiDocContext.isNearLimit) {
          new import_obsidian10.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _NovaSidebarView.NOTICE_DURATION_MS);
        }
      }
    }
    this.inputHandler.setValue("");
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(true);
    try {
      console.log("\u{1F680} CHAT INPUT HANDLING:", { messageText });
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        console.log("\u{1F4BE} About to persist user message:", { file: activeFile.path, messageText });
        await this.plugin.conversationManager.addUserMessage(activeFile, messageText, null);
        console.log("\u{1F4FA} About to display user message in UI");
        this.addMessage("user", messageText);
      }
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
      const selectedText = (_f = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _f.getSelection();
      const hasSelection = !!(selectedText && selectedText.trim().length > 0);
      const intent = await this.plugin.aiIntentClassifier.classifyIntent(processedMessage, hasSelection);
      let contextualCommand;
      if (intent === "METADATA" || intent === "CONTENT") {
        contextualCommand = this.plugin.commandParser.parseCommand(processedMessage);
      }
      const initialPhrase = this.getContextualThinkingPhrase(contextualCommand, processedMessage);
      const loadingTextEl = loadingEl.createSpan({ text: initialPhrase });
      loadingTextEl.style.cssText = "color: var(--text-muted); font-size: 0.9em;";
      this.startThinkingPhraseRotation(loadingTextEl, contextualCommand, processedMessage);
      let response = null;
      if (intent === "METADATA" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else if (intent === "CONTENT" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedSystemPrompt = (prompt2.systemPrompt || "") + `

MULTI-DOCUMENT CONTEXT INSTRUCTIONS:
- You have access to multiple documents as REFERENCE CONTEXT ONLY
- These documents are for your understanding and background knowledge
- DO NOT echo, quote, or output content from these context documents unless specifically requested
- When responding, focus on the user's request, not the content of context documents
- Context documents are read-only; you can only edit the current working document
- If the user asks about context documents, you may reference and discuss their content`;
          const enhancedUserPrompt = `REFERENCE CONTEXT (for your understanding only):
${multiDocContext.contextString}

---

USER REQUEST: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(enhancedSystemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      const loadingTextSpan = loadingEl.querySelector("span");
      if (loadingTextSpan) {
        this.stopThinkingPhraseRotation(loadingTextSpan);
      }
      loadingEl.remove();
      const filteredResponse = response ? this.filterThinkingContent(response) : response;
      if (activeFile && filteredResponse) {
        await this.plugin.documentEngine.addAssistantMessage(filteredResponse);
      }
      if (filteredResponse) {
        if (filteredResponse.includes("x-circle") || filteredResponse.includes("Error executing command") || filteredResponse.includes("Failed to") || filteredResponse.includes("No markdown file is open") || filteredResponse.includes("Unable to access") || filteredResponse.includes("Unable to set")) {
          this.addErrorMessage(filteredResponse);
        } else {
          this.addMessage("assistant", filteredResponse);
        }
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) {
        const loadingTextSpan = loadingEl.querySelector("span");
        if (loadingTextSpan) {
          this.stopThinkingPhraseRotation(loadingTextSpan);
        }
        loadingEl.remove();
      }
      const errorMessage = error.message;
      let displayMessage;
      if (errorMessage.includes("Google API error")) {
        displayMessage = errorMessage;
      } else if (errorMessage.includes("OpenAI API error")) {
        displayMessage = errorMessage;
      } else if (errorMessage.includes("API key")) {
        displayMessage = `${errorMessage}. Please check your settings.`;
      } else if (errorMessage.includes("Failed to fetch") || errorMessage.includes("NetworkError")) {
        displayMessage = "Network error. Please check your internet connection and try again.";
      } else {
        displayMessage = `Sorry, I encountered an error: ${errorMessage}`;
      }
      this.addErrorMessage(displayMessage);
    } finally {
      const sendButton2 = this.inputHandler.sendButton;
      if (sendButton2) sendButton2.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: false });
        await new Promise((resolve) => setTimeout(resolve, 50));
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      const currentPos = this.plugin.documentEngine.getCursorPosition();
      if (currentPos) {
        this.currentFileCursorPosition = currentPos;
      }
      this.restoreCursorPosition();
      let result;
      switch (command.action) {
        case "add":
          result = await this.executeAddCommandWithStreaming(command);
          break;
        case "edit":
          result = await this.executeEditCommandWithStreaming(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.executeGrammarCommandWithStreaming(command);
          break;
        case "rewrite":
          result = await this.executeRewriteCommandWithStreaming(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        this.addErrorIndicator(command.action, result.error);
        return null;
      }
    } catch (error) {
      this.addErrorIndicator("execute", error.message);
      return null;
    }
  }
  async loadConversationForActiveFile() {
    var _a, _b;
    const activeFile = this.app.workspace.getActiveFile();
    console.log("\u{1F504} FILE SWITCH EVENT:", {
      activeFile: activeFile == null ? void 0 : activeFile.path,
      currentFile: (_a = this.currentFile) == null ? void 0 : _a.path
    });
    this.isUserInitiatedProviderChange = false;
    const operationId = Date.now().toString() + Math.random().toString(36).substr(2, 9);
    this.currentFileLoadOperation = operationId;
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian10.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      console.log("\u{1F5D1}\uFE0F Clearing chat - no target file");
      this.currentFile = null;
      this.chatContainer.empty();
      this.currentContext = null;
      this.contextManager.setCurrentFile(null);
      this.refreshContext();
      this.addWelcomeMessage("Open a document to get started.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      console.log("\u23ED\uFE0F Skipping file switch - same file or no file");
      return;
    }
    this.contextManager.setCurrentFile(targetFile);
    this.currentFileCursorPosition = null;
    console.log("\u{1F504} SWITCHING TO FILE:", {
      from: (_b = this.currentFile) == null ? void 0 : _b.path,
      to: targetFile.path
    });
    this.currentFile = targetFile;
    this.currentContext = this.contextManager.getCurrentContext();
    this.updateContextIndicator();
    this.refreshAllStats();
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    if (activeView && activeView.editor) {
      this.trackCursorPosition(activeView.editor);
    }
    console.log("\u{1F9F9} CLEARING CHAT for file switch");
    this.chatContainer.empty();
    if (this.currentFileLoadOperation !== operationId) {
      console.log("\u26A0\uFE0F File load operation cancelled - newer operation in progress");
      return;
    }
    try {
      console.log("\u{1F4DA} LOADING CONVERSATION HISTORY via ChatRenderer");
      await this.chatRenderer.loadConversationHistory(targetFile);
      if (this.currentFileLoadOperation !== operationId) {
        console.log("\u26A0\uFE0F File load operation cancelled during conversation loading");
        return;
      }
      await this.contextManager.restoreContextAfterChatLoad(targetFile);
      await this.refreshContext();
      await this.showDocumentInsights(targetFile);
      if (this.currentFileLoadOperation !== operationId) {
        console.log("\u26A0\uFE0F File load operation cancelled during insights loading");
        return;
      }
    } catch (error) {
      console.log("\u274C CONVERSATION LOADING ERROR:", error);
      this.addWelcomeMessage();
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.lastTokenWarnings = {};
      } catch (error) {
      }
    }
    new import_obsidian10.Notice("Chat cleared");
    this.addWelcomeMessage();
    if (this.currentFile) {
      await this.refreshContext();
    }
  }
  // Coordinator method that updates both document stats and context remaining
  async refreshAllStats() {
    if (this.streamingManager.isStreaming()) {
      return;
    }
    await this.updateDocumentStats();
    await this.refreshContext();
    this.updateContextRemaining();
  }
  // Update only document statistics (word count, sections)
  async updateDocumentStats() {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile) return;
    try {
      const content = await this.app.vault.read(activeFile);
      if (!content) return;
      const wordCount = content.split(/\s+/).filter((word) => word.length > 0).length;
      const headingCount = (content.match(/^#{1,6}\s/gm) || []).length;
      const headerEl = this.containerEl.querySelector(".nova-header");
      if (headerEl) {
        let statsContainer = headerEl.querySelector(".nova-document-stats-container");
        if (!statsContainer) {
          statsContainer = headerEl.createEl("div", { cls: "nova-document-stats-container" });
        }
        let statsEl = statsContainer.querySelector(".nova-document-stats");
        if (!statsEl) {
          statsEl = statsContainer.createEl("div", { cls: "nova-document-stats" });
        }
        if (statsEl && wordCount > 0) {
          const readingTime = Math.ceil(wordCount / 225);
          statsEl.textContent = `~ ${readingTime} min read`;
        }
      }
    } catch (error) {
    }
  }
  // Update only context remaining display (token percentage)
  updateContextRemaining() {
    this.updateTokenDisplay();
  }
  updateTokenDisplay() {
    var _a, _b;
    const headerEl = this.containerEl.querySelector(".nova-header");
    if (!headerEl) return;
    let statsContainer = headerEl.querySelector(".nova-document-stats-container");
    if (!statsContainer) {
      statsContainer = headerEl.createEl("div", { cls: "nova-document-stats-container" });
    }
    let statsEl = statsContainer.querySelector(".nova-document-stats");
    if (!statsEl) {
      statsEl = statsContainer.createEl("div", { cls: "nova-document-stats" });
    }
    let tokenEl = statsContainer.querySelector(".nova-token-usage");
    if (!tokenEl) {
      tokenEl = statsContainer.createEl("div", { cls: "nova-token-usage" });
    }
    const totalContextUsage = (_a = this.currentContext) == null ? void 0 : _a.totalContextUsage;
    let remainingPercent;
    let warningLevel;
    let displayText;
    let tooltipText;
    if (totalContextUsage) {
      remainingPercent = getRemainingContextPercentage(totalContextUsage);
      warningLevel = getContextWarningLevel(totalContextUsage);
      displayText = formatContextUsage(totalContextUsage);
      tooltipText = getContextTooltip(totalContextUsage);
    } else {
      const currentTokens = ((_b = this.currentContext) == null ? void 0 : _b.tokenCount) || 0;
      remainingPercent = 100;
      displayText = currentTokens > 0 ? `${currentTokens} tokens` : "0% left";
      tooltipText = `File context: ${currentTokens} tokens (total context calculation unavailable)`;
      warningLevel = "safe";
    }
    tokenEl.textContent = displayText;
    tokenEl.title = tooltipText;
    tokenEl.className = "nova-token-usage";
    if (warningLevel === "safe") {
      tokenEl.addClass("nova-token-safe");
    } else if (warningLevel === "warning") {
      tokenEl.addClass("nova-token-warning");
      this.showTokenWarning(85);
    } else if (warningLevel === "critical") {
      tokenEl.addClass("nova-token-danger");
      this.showTokenWarning(95);
    }
  }
  showTokenWarning(threshold) {
    const warningKey = `token-warning-${threshold}`;
    if (this.lastTokenWarnings[warningKey]) return;
    this.lastTokenWarnings[warningKey] = Date.now();
    let message;
    if (threshold === 75) {
      message = "\u2139\uFE0F Context usage is growing. Current conversation and file context are using significant tokens.";
    } else if (threshold === 85) {
      message = "\u26A0\uFE0F Context usage high (85%). Consider starting a new conversation or removing file context for better AI performance.";
    } else if (threshold === 95) {
      message = "\u26A0\uFE0F Context nearly full (95%). Start a new conversation or clear context immediately for reliable AI responses.";
    } else {
      message = "\u26A0\uFE0F Context approaching limit. Consider clearing context or starting a new conversation.";
    }
    this.addWarningMessage(message);
  }
  addWarningMessage(content) {
    this.chatRenderer.addWarningMessage(content, true);
  }
  async showDocumentInsights(file) {
    try {
      const content = await this.app.vault.read(file);
      const analysis = DocumentAnalyzer.analyzeStructure(content);
      if (analysis.emptyHeadings.length > 0 || analysis.incompleteBullets.length > 0) {
        const insights = [];
        if (analysis.emptyHeadings.length > 0) {
          insights.push(`${analysis.emptyHeadings.length} empty heading${analysis.emptyHeadings.length > 1 ? "s" : ""} to fill`);
        }
        if (analysis.incompleteBullets.length > 0) {
          insights.push(`${analysis.incompleteBullets.length} incomplete bullet${analysis.incompleteBullets.length > 1 ? "s" : ""}`);
        }
        if (insights.length > 0) {
          const bulletList = insights.map((insight) => `\u2022 ${insight}`).join("\n");
          const messageEl = this.chatContainer.createDiv({ cls: "nova-message nova-message-assistant nova-insights" });
          messageEl.style.cssText = `
						margin-bottom: var(--size-4-2);
						padding: var(--size-2-3) var(--size-4-3);
						border-radius: var(--radius-s);
						max-width: 85%;
						background: var(--background-modifier-hover);
						color: var(--text-muted);
						font-size: var(--font-ui-medium);
						text-align: left;
						margin-left: 0;
						margin-right: auto;
					`;
          const roleEl = messageEl.createEl("div", {
            text: "Nova",
            cls: "nova-message-role"
          });
          roleEl.style.cssText = `
						font-size: var(--font-ui-smaller);
						opacity: 0.7;
						margin-bottom: var(--size-2-1);
						font-weight: 600;
					`;
          const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
          contentEl.style.cssText = "white-space: pre-line; text-align: left;";
          contentEl.textContent = `I noticed:

${bulletList}

Let me help.`;
          setTimeout(() => {
            this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
          }, 50);
        }
      }
    } catch (error) {
    }
  }
  /**
   * Handle consultation requests - chat only, no document modification
   */
  async handleConsultationRequest(input) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(input, activeFile || void 0);
    const response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt);
    this.displayChatResponse(response);
    this.showModeIndicator("consultation");
  }
  /**
   * Display AI response in chat without document modification
   */
  displayChatResponse(response) {
    this.chatRenderer.addMessage("assistant", response);
  }
  /**
   * Show subtle indicator for consultation vs editing mode
   */
  showModeIndicator(mode) {
  }
  /**
   * Handle editing requests - preserves existing behavior with intent tracking
   */
  async handleEditingRequest(input) {
    const parsedCommand = this.plugin.commandParser.parseCommand(input);
    this.trackIntentUsage("editing", input);
    return await this.executeCommand(parsedCommand);
  }
  /**
   * Track intent usage for analytics (placeholder for future enhancement)
   */
  trackIntentUsage(intent, input) {
  }
  /**
   * Handle ambiguous requests by routing to chosen handler
   */
  async handleAmbiguousRequest(input, chosenIntent) {
    if (chosenIntent === "consultation") {
      await this.handleConsultationRequest(input);
    } else {
      await this.handleEditingRequest(input);
    }
  }
  /**
   * Process user input with intent detection integration
   */
  async processUserInputWithIntent(input) {
    const intent = await this.plugin.aiIntentClassifier.classifyIntent(input);
    switch (intent) {
      case "CHAT":
        await this.handleConsultationRequest(input);
        break;
      case "CONTENT":
        await this.handleEditingRequest(input);
        break;
      case "METADATA":
        const parsedCommand = this.plugin.commandParser.parseCommand(input);
        await this.executeCommand(parsedCommand);
        break;
    }
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  // REMOVED: Now using ChatRenderer's loadConversationHistory method directly
  /**
   * Update send button enabled/disabled state based on provider availability
   */
  async updateSendButtonState() {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(!currentProviderType);
  }
  /**
   * Update privacy indicator icon and tooltip based on current provider
   */
  async updatePrivacyIndicator(privacyIndicator) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    privacyIndicator.empty();
    privacyIndicator.removeClass("nova-status-pill", "local", "cloud");
    privacyIndicator.style.cssText = `
			display: inline-flex;
			align-items: center;
			gap: 4px;
			padding: 2px 8px;
			border-radius: 12px;
			font-size: 0.75em;
			font-weight: 500;
			height: auto;
			line-height: 1.5;
		`;
    if (currentProviderType) {
      const isLocalProvider = currentProviderType === "ollama";
      privacyIndicator.addClass("nova-status-pill");
      privacyIndicator.addClass(isLocalProvider ? "local" : "cloud");
      const iconEl = privacyIndicator.createSpan({ cls: "nova-status-icon" });
      iconEl.style.cssText = `
				display: inline-flex;
				align-items: center;
				width: 14px;
				height: 14px;
			`;
      const iconName = isLocalProvider ? "shield-check" : "cloud";
      (0, import_obsidian10.setIcon)(iconEl, iconName);
      const labelEl = privacyIndicator.createSpan({ text: isLocalProvider ? "Local" : "Cloud" });
      labelEl.style.cssText = `line-height: 1;`;
      const tooltip = isLocalProvider ? "Local processing - data stays on your device" : "Cloud processing - data sent to provider";
      privacyIndicator.setAttribute("aria-label", tooltip);
      privacyIndicator.setAttribute("title", tooltip);
    } else {
      privacyIndicator.addClass("nova-status-pill");
      const iconEl = privacyIndicator.createSpan({ cls: "nova-status-icon" });
      iconEl.style.cssText = `
				display: inline-flex;
				align-items: center;
				width: 14px;
				height: 14px;
			`;
      (0, import_obsidian10.setIcon)(iconEl, "help-circle");
      const labelEl = privacyIndicator.createSpan({ text: "No provider" });
      labelEl.style.cssText = `line-height: 1;`;
      privacyIndicator.setAttribute("aria-label", "No provider selected");
      privacyIndicator.setAttribute("title", "No provider selected");
    }
  }
  /**
   * Filter thinking content from AI responses
   * Removes content between <think>/<thinking> and </think>/<thinking> tags
   */
  filterThinkingContent(content) {
    return content.replace(/<think(?:ing)?[\s\S]*?<\/think(?:ing)?>/gi, "").trim();
  }
  /**
   * Refresh all provider status indicators in the UI
   */
  async refreshProviderStatus() {
    var _a;
    if (this.privacyIndicator) {
      await this.updatePrivacyIndicator(this.privacyIndicator);
    }
    this.updateSendButtonState();
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      await this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  async createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-normal);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const providerName = providerButton.createSpan({ text: "Loading...", cls: "nova-provider-name" });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 200px;
			max-width: 280px;
			max-height: 300px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow-y: auto;
			overflow-x: hidden;
			
			/* Mobile responsive adjustments */
			@media (max-width: 768px) {
				min-width: 180px;
				max-width: 250px;
				max-height: 250px;
				right: -20px; /* Offset to prevent edge cutoff */
			}
			
			/* Smooth scrolling */
			scroll-behavior: smooth;
			
			/* Custom scrollbar styling */
			scrollbar-width: thin;
			scrollbar-color: var(--background-modifier-border) transparent;
		`;
    const scrollbarStyle = document.createElement("style");
    scrollbarStyle.textContent = `
			.nova-provider-dropdown-menu::-webkit-scrollbar {
				width: 6px;
			}
			.nova-provider-dropdown-menu::-webkit-scrollbar-track {
				background: transparent;
			}
			.nova-provider-dropdown-menu::-webkit-scrollbar-thumb {
				background: var(--background-modifier-border);
				border-radius: 3px;
			}
			.nova-provider-dropdown-menu::-webkit-scrollbar-thumb:hover {
				background: var(--background-modifier-border-hover);
			}
		`;
    if (!document.querySelector(".nova-scrollbar-style")) {
      scrollbarStyle.className = "nova-scrollbar-style";
      document.head.appendChild(scrollbarStyle);
    }
    let isDropdownOpen = false;
    const updateCurrentProvider = () => {
      try {
        const currentModel = this.plugin.aiProviderManager.getCurrentModel();
        if (currentModel) {
          const providerType = this.getProviderTypeFromModel(currentModel);
          if (providerType) {
            const displayText = this.getModelDisplayName(providerType, currentModel);
            if (displayText && displayText.length > 2 && !displayText.match(/^I+$/)) {
              providerName.setText(displayText);
            } else {
              console.warn("Invalid model display text, using raw model name:", displayText);
              providerName.setText(currentModel);
            }
          } else {
            providerName.setText(currentModel);
          }
        } else {
          providerName.setText("Select Model");
        }
      } catch (error) {
        console.error("Error updating model display:", error);
        providerName.setText("Select Model");
      }
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    const closeDropdownInternal = () => {
      isDropdownOpen = false;
      dropdownMenu.style.display = "none";
      dropdownArrow.style.transform = "rotate(0deg)";
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      closeDropdown: closeDropdownInternal,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Get available models for a provider type
   */
  getAvailableModels(providerType) {
    return getAvailableModels(providerType, this.plugin.settings);
  }
  /**
   * Get current model for a provider type
   */
  getCurrentModel(providerType) {
    var _a;
    const providers = this.plugin.settings.aiProviders;
    const currentModel = (_a = providers[providerType]) == null ? void 0 : _a.model;
    if (currentModel) {
      return currentModel;
    }
    const availableModels = this.getAvailableModels(providerType);
    return availableModels.length > 0 ? availableModels[0].value : "";
  }
  /**
   * Get model display name from model value
   */
  getModelDisplayName(providerType, modelValue) {
    const models = this.getAvailableModels(providerType);
    const model = models.find((m) => m.value === modelValue);
    const displayName = model ? model.label : modelValue;
    if (displayName === "II" || displayName.match(/^I+$/) || displayName.length < 3) {
      console.warn("Invalid model display name prevented:", displayName, "for model:", modelValue);
      return this.getProviderDisplayName(providerType);
    }
    return displayName;
  }
  /**
   * Get provider type from model name synchronously (pattern matching)
   */
  getProviderTypeFromModel(modelName) {
    if (modelName.startsWith("claude-")) return "claude";
    if (modelName.startsWith("gpt-") || modelName.startsWith("o1-")) return "openai";
    if (modelName.startsWith("gemini-")) return "google";
    return "ollama";
  }
  /**
   * Switch to a specific model for a provider
   */
  switchToModel(providerType, modelValue) {
    try {
      const platform = import_obsidian10.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].selectedModel = modelValue;
      const providers = this.plugin.settings.aiProviders;
      if (providers[providerType]) {
        providers[providerType].model = modelValue;
      }
      const modelDisplayName = this.getModelDisplayName(providerType, modelValue);
      const providerDisplayName = this.getProviderDisplayName(providerType);
      this.addSuccessMessage(`\u2713 Switched to ${providerDisplayName} ${modelDisplayName}`);
      this.plugin.saveSettings().catch((error) => {
        console.error("Error saving model selection:", error);
        this.addErrorMessage("Failed to save model selection");
      });
      this.refreshProviderStatus().catch((error) => {
        console.error("Error refreshing provider status:", error);
      });
    } catch (error) {
      console.error("Error switching model:", error);
      this.addErrorMessage("Failed to switch model");
    }
  }
  /**
   * Populate provider dropdown with grouped models and section headers
   */
  async populateProviderDropdown(dropdownMenu) {
    var _a, _b;
    dropdownMenu.empty();
    const loadingItem = dropdownMenu.createDiv({ cls: "nova-dropdown-loading" });
    loadingItem.style.cssText = `
			padding: 12px;
			text-align: center;
			color: var(--text-muted);
			font-size: 0.8em;
		`;
    loadingItem.setText("Loading providers...");
    try {
      const providerAvailability = await this.plugin.aiProviderManager.getAvailableProvidersWithStatus();
      const currentModel = this.plugin.aiProviderManager.getCurrentModel();
      const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
      dropdownMenu.empty();
      let hasAnyProviders = false;
      for (const [providerType, isAvailable] of providerAvailability) {
        if (providerType === "none" || !isAvailable) continue;
        const providers = this.plugin.settings.aiProviders;
        const hasApiKey = (_a = providers[providerType]) == null ? void 0 : _a.apiKey;
        if (!hasApiKey && providerType !== "ollama") continue;
        const models = this.getAvailableModels(providerType);
        const providerDisplayName = this.getProviderDisplayName(providerType);
        const providerColor = this.getProviderColor(providerType);
        if (models.length === 0 && providerType !== "ollama") continue;
        if (hasAnyProviders) {
          const separator = dropdownMenu.createDiv({ cls: "nova-provider-separator" });
          separator.style.cssText = `
						height: 1px;
						background: var(--background-modifier-border);
						margin: 4px 8px;
					`;
        }
        const sectionHeader = dropdownMenu.createDiv({ cls: "nova-provider-section-header" });
        sectionHeader.style.cssText = `
					padding: 8px 12px 4px 12px;
					font-size: 0.75em;
					font-weight: 600;
					color: var(--text-muted);
					text-transform: uppercase;
					letter-spacing: 0.5px;
					display: flex;
					align-items: center;
					gap: 6px;
				`;
        const headerDot = sectionHeader.createSpan();
        headerDot.style.cssText = `
					width: 6px;
					height: 6px;
					border-radius: 50%;
					background: ${providerColor};
					flex-shrink: 0;
				`;
        sectionHeader.createSpan({ text: providerDisplayName });
        hasAnyProviders = true;
        if (models.length === 0) {
          this.createModelDropdownItem(
            dropdownMenu,
            providerType,
            ((_b = providers[providerType]) == null ? void 0 : _b.model) || providerDisplayName,
            providerDisplayName,
            providerColor,
            currentProviderType === providerType,
            currentModel
          );
        } else {
          for (const model of models) {
            const isCurrentSelection = currentProviderType === providerType && model.value === currentModel;
            this.createModelDropdownItem(
              dropdownMenu,
              providerType,
              model.value,
              model.label,
              providerColor,
              isCurrentSelection,
              currentModel
            );
          }
        }
      }
      if (!hasAnyProviders) {
        const noProvidersItem = dropdownMenu.createDiv();
        noProvidersItem.style.cssText = `
					padding: 12px;
					text-align: center;
					color: var(--text-muted);
					font-size: 0.8em;
				`;
        noProvidersItem.setText("No providers available");
      }
    } catch (error) {
      console.error("Error populating provider dropdown:", error);
      dropdownMenu.empty();
      const errorItem = dropdownMenu.createDiv();
      errorItem.style.cssText = `
				padding: 12px;
				text-align: center;
				color: var(--text-error);
				font-size: 0.8em;
			`;
      errorItem.setText("Error loading providers");
    }
  }
  /**
   * Create a single model dropdown item (just model name, no provider prefix)
   */
  createModelDropdownItem(container, providerType, modelValue, modelDisplayName, providerColor, isCurrent, currentModel) {
    const item = container.createDiv({ cls: "nova-model-dropdown-item" });
    item.style.cssText = `
			padding: 8px 12px 8px 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			gap: 8px;
			font-size: 0.85em;
			color: var(--text-normal);
			transition: background-color 0.2s ease;
			border-radius: 3px;
			margin: 1px 6px;
			${isCurrent ? "background: var(--background-modifier-hover);" : ""}
		`;
    const dot = item.createSpan();
    dot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: ${providerColor};
			flex-shrink: 0;
			opacity: 0.7;
		`;
    const textSpan = item.createSpan({ text: modelDisplayName });
    textSpan.style.cssText = `
			flex: 1;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		`;
    if (isCurrent) {
      const checkmark = item.createSpan({ text: "\u2713" });
      checkmark.style.cssText = `
				color: ${providerColor};
				font-weight: 600;
				font-size: 0.9em;
				flex-shrink: 0;
			`;
    }
    item.addEventListener("click", (e) => {
      var _a;
      e.stopPropagation();
      if (!isCurrent) {
        try {
          this.switchToModel(providerType, modelValue || this.getCurrentModel(providerType));
          if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.closeDropdown) {
            this.currentProviderDropdown.closeDropdown();
          }
          if (this.currentProviderDropdown) {
            this.currentProviderDropdown.updateCurrentProvider();
          }
        } catch (error) {
          console.error("Error switching provider/model:", error);
        }
      }
    });
    item.addEventListener("mouseenter", () => {
      if (!isCurrent) {
        item.style.background = "var(--background-modifier-border-hover)";
      }
    });
    item.addEventListener("mouseleave", () => {
      if (!isCurrent) {
        item.style.background = "transparent";
      }
    });
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "trash-2": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M8 6V4A2 2 0 0 1 10 2H14A2 2 0 0 1 16 4V6M19 6V20A2 2 0 0 1 17 22H7A2 2 0 0 1 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Anthropic",
      "openai": "OpenAI",
      "google": "Google",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get display name for header (just model name if available, otherwise provider name)
   */
  getProviderWithModelDisplayName(providerType) {
    const models = this.getAvailableModels(providerType);
    if (models.length > 0) {
      const currentModel = this.getCurrentModel(providerType);
      const modelDisplayName = this.getModelDisplayName(providerType, currentModel);
      if (modelDisplayName === "II" || modelDisplayName.match(/^I+$/)) {
        console.warn("Invalid model display name detected:", {
          providerType,
          currentModel,
          modelDisplayName,
          models
        });
      }
      return modelDisplayName;
    }
    return this.getProviderDisplayName(providerType);
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "var(--color-orange)",
      "openai": "var(--color-green)",
      "google": "var(--color-blue)",
      "ollama": "var(--color-purple)",
      "none": "var(--text-muted)"
    };
    return colors[providerType] || "var(--text-success)";
  }
  /**
   * Switch to a different model and update conversation context
   */
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Refresh the provider dropdown display to reflect current settings
   */
  async refreshProviderDropdown() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      console.log("\u{1F504} Refreshing provider dropdown UI after settings update");
      try {
        await this.currentProviderDropdown.updateCurrentProvider();
      } catch (error) {
        console.error("\u274C Failed to refresh provider dropdown:", error);
      }
    }
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    if (this.inputHandler) {
      this.inputHandler.refreshCommandButton();
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
  /**
   * Execute add command with streaming support
   */
  async executeAddCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.addCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming add command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute edit command with streaming support
   */
  async executeEditCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.editCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming edit command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeRewriteCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.rewriteCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming rewrite command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeGrammarCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.grammarCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming grammar command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Add files to persistent context
   */
  async addFilesToContext(filenames) {
    var _a;
    if (!this.currentFile) {
      new import_obsidian10.Notice("No file is open. Please open a file to add context.", 3e3);
      return;
    }
    const addedFiles = [];
    const alreadyExistingFiles = [];
    const currentFiles = [];
    const notFoundFiles = [];
    const existingPersistent = this.contextManager.getPersistentContext(this.currentFile.path) || [];
    const updatedPersistent = [...existingPersistent];
    for (const filename of filenames) {
      let file = this.app.vault.getAbstractFileByPath(filename);
      if (!file || !(file instanceof import_obsidian10.TFile)) {
        file = this.app.vault.getAbstractFileByPath(filename + ".md");
      }
      if (!file || !(file instanceof import_obsidian10.TFile)) {
        const files = this.app.vault.getMarkdownFiles();
        file = files.find(
          (f) => f.basename === filename || f.name === filename || f.path.endsWith("/" + filename) || f.path.endsWith("/" + filename + ".md")
        ) || null;
      }
      if (file instanceof import_obsidian10.TFile) {
        if (file.path === ((_a = this.currentFile) == null ? void 0 : _a.path)) {
          currentFiles.push(file.basename);
          this.chatRenderer.addWarningMessage("Current file is always in context and doesn't need to be added explicitly.", false);
        } else {
          const exists = updatedPersistent.some((ref) => ref.file.path === file.path);
          if (!exists) {
            updatedPersistent.push({
              file,
              property: void 0,
              isPersistent: true,
              rawReference: `+[[${file.basename}]]`
            });
            addedFiles.push(file.basename);
          } else {
            alreadyExistingFiles.push(file.basename);
          }
        }
      } else {
        notFoundFiles.push(filename);
      }
    }
    if (addedFiles.length > 0 || alreadyExistingFiles.length > 0 || currentFiles.length > 0) {
      this.contextManager.clearPersistentContext(this.currentFile.path);
      for (const doc of updatedPersistent) {
        await this.contextManager.addDocument(doc.file);
      }
    }
    await this.refreshContext();
    const totalFiles = filenames.length;
    const messages = [];
    if (addedFiles.length > 0) {
      if (addedFiles.length === 1) {
        messages.push(`Added "${addedFiles[0]}" to context`);
      } else {
        messages.push(`Added ${addedFiles.length} files to context`);
      }
    }
    if (alreadyExistingFiles.length > 0) {
      if (alreadyExistingFiles.length === 1) {
        messages.push(`"${alreadyExistingFiles[0]}" already in context`);
      } else {
        messages.push(`${alreadyExistingFiles.length} already in context`);
      }
    }
    if (currentFiles.length > 0) {
      if (currentFiles.length === 1) {
        messages.push(`Current file is always in context`);
      } else {
        messages.push(`${currentFiles.length} current files are always in context`);
      }
    }
    if (notFoundFiles.length > 0) {
      if (notFoundFiles.length === 1) {
        messages.push(`"${notFoundFiles[0]}" not found`);
      } else {
        messages.push(`${notFoundFiles.length} not found`);
      }
    }
    if (messages.length > 0) {
      const combinedMessage = messages.join(", ");
      const duration = notFoundFiles.length > 0 ? 3e3 : 2e3;
      new import_obsidian10.Notice(combinedMessage, duration);
    }
  }
  /**
   * Get contextual thinking phrase based on command type or message content
   */
  getContextualThinkingPhrase(command, messageText) {
    if (command) {
      switch (command.action) {
        case "grammar":
        case "edit":
          return this.getRandomPhrase("improve");
        case "add":
          return this.getRandomPhrase("generate");
        case "rewrite":
          return this.getRandomPhrase("improve");
        case "delete":
          return this.getRandomPhrase("process");
        default:
          return this.getRandomPhrase("chat");
      }
    } else if (messageText) {
      if (messageText.includes("improve") || messageText.includes("fix") || messageText.includes("grammar")) {
        return this.getRandomPhrase("improve");
      } else if (messageText.includes("add") || messageText.includes("create") || messageText.includes("write")) {
        return this.getRandomPhrase("generate");
      } else if (messageText.includes("switch") || messageText.includes("/")) {
        return this.getRandomPhrase("switch");
      }
    }
    return this.getRandomPhrase("chat");
  }
  /**
   * Get random phrase from specified category
   */
  getRandomPhrase(category) {
    const phrases = {
      "improve": ["refining...", "polishing...", "enhancing...", "crafting...", "perfecting...", "smoothing...", "sharpening...", "elevating...", "fine-tuning...", "sculpting..."],
      "generate": ["thinking...", "crafting...", "developing...", "composing...", "writing...", "creating...", "formulating...", "building...", "constructing...", "drafting..."],
      "switch": ["connecting...", "switching...", "updating...", "configuring...", "setting up...", "syncing...", "preparing...", "activating...", "initializing...", "establishing..."],
      "process": ["processing...", "analyzing...", "working...", "computing...", "calculating...", "examining...", "evaluating...", "interpreting...", "reviewing...", "scanning..."],
      "chat": ["thinking...", "processing...", "considering...", "analyzing...", "understanding...", "contemplating...", "exploring...", "evaluating...", "working on it...", "composing..."]
    };
    const categoryPhrases = phrases[category] || phrases.chat;
    return categoryPhrases[Math.floor(Math.random() * categoryPhrases.length)];
  }
  /**
   * Start phrase rotation animation for thinking text
   */
  startThinkingPhraseRotation(textEl, command, messageText) {
    const rotationInterval = setInterval(() => {
      const newPhrase = this.getContextualThinkingPhrase(command, messageText);
      textEl.textContent = newPhrase;
    }, 2e3);
    textEl.rotationInterval = rotationInterval;
  }
  /**
   * Stop phrase rotation animation and cleanup
   */
  stopThinkingPhraseRotation(textEl) {
    if (textEl.rotationInterval) {
      clearInterval(textEl.rotationInterval);
      textEl.rotationInterval = null;
    }
  }
};
_NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS = 300;
_NovaSidebarView.SCROLL_DELAY_MS = 50;
_NovaSidebarView.FOCUS_DELAY_MS = 150;
_NovaSidebarView.HOVER_TIMEOUT_MS = 150;
_NovaSidebarView.NOTICE_DURATION_MS = 5e3;
var NovaSidebarView = _NovaSidebarView;

// src/ai/providers/claude.ts
var import_obsidian11 = require("obsidian");
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-5-haiku-latest",
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
      system: options == null ? void 0 : options.systemPrompt,
      messages: messages.map((msg) => ({
        role: msg.role === "assistant" ? "assistant" : "user",
        content: msg.content
      }))
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await (0, import_obsidian11.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": this.config.apiKey,
            "anthropic-version": "2023-06-01"
          },
          body: requestBody
        });
        if (response.status === 200) {
          const data = response.json;
          return data.content[0].text;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`Claude API error: ${response.status} - ${response.text}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && (error.message.includes("Network error") || error.message.includes("Failed to connect"))) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        if (error instanceof Error && error.message.startsWith("Claude API error:")) {
          throw error;
        }
        throw new Error(`Failed to connect to Claude API: ${error instanceof Error ? error.message : "Network error"}`);
      }
    }
    throw new Error("Claude API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    const result = await this.chatCompletion(messages, options);
    const chunkSize = 3;
    for (let i = 0; i < result.length; i += chunkSize) {
      const chunk = result.slice(i, i + chunkSize);
      yield { content: chunk, done: false };
      await new Promise((resolve) => setTimeout(resolve, 20));
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await (0, import_obsidian11.requestUrl)({
        url: "https://api.anthropic.com/v1/messages",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-5-haiku-latest",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (response.status !== 200) {
        throw new Error(`API key validation failed: ${response.status} - ${response.text}`);
      }
      const models = [
        "claude-opus-4-20250514",
        "claude-sonnet-4-20250514",
        "claude-3-7-sonnet-latest",
        "claude-3-5-sonnet-latest",
        "claude-3-5-haiku-latest"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
      messages: requestMessages,
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${this.config.apiKey}`
          },
          body: requestBody
        });
        if (response.ok) {
          const data = await response.json();
          return data.choices[0].message.content;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`OpenAI API error: ${response.statusText}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && error.message.includes("fetch")) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw error;
      }
    }
    throw new Error("OpenAI API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3,
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                const chunkSize = 3;
                for (let i = 0; i < content.length; i += chunkSize) {
                  const chunk = content.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gpt-4.1-2025-04-14",
        "gpt-4.1-mini-2025-04-14",
        "gpt-4.1-nano-2025-04-14",
        "gpt-4o",
        "gpt-4o-mini"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages) {
    const contents = [];
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    if (contents.length === 0) {
      throw new Error("No messages provided for Google API");
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const requestBody = {
      contents: this.formatMessagesForGemini(messages),
      generationConfig: {
        temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
        maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
      }
    };
    if ((options == null ? void 0 : options.systemPrompt) && options.systemPrompt.trim()) {
      requestBody.systemInstruction = {
        parts: [{ text: options.systemPrompt }]
      };
    }
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(requestBody)
    });
    if (!response.ok) {
      const errorText = await response.text();
      let errorMessage = "";
      try {
        const errorData = JSON.parse(errorText);
        if (errorData.error) {
          const code = errorData.error.code || response.status;
          const message = errorData.error.message || errorData.error.status || response.statusText;
          errorMessage = `[${code}]: ${message}`;
          if (response.status === 400) {
            errorMessage += " (Check request format or model name)";
          } else if (response.status === 401) {
            errorMessage += " (Check API key in settings)";
          } else if (response.status === 404) {
            errorMessage += " (Model may not be available)";
          } else if (response.status === 429) {
            errorMessage += " (Rate limit exceeded)";
          }
        } else {
          errorMessage = `[${response.status}]: ${errorText}`;
        }
      } catch (e) {
        errorMessage = `[${response.status}]: ${errorText || response.statusText}`;
      }
      console.error("Google API Error Details:", {
        status: response.status,
        statusText: response.statusText,
        errorText,
        requestBody,
        model,
        url
      });
      throw new Error(`Google API error ${errorMessage}`);
    }
    const data = await response.json();
    if (!data.candidates || data.candidates.length === 0) {
      if (data.error) {
        throw new Error(`Google API error: ${data.error.message || JSON.stringify(data.error)}`);
      }
      throw new Error("Google API returned no candidates");
    }
    if (data.candidates[0].finishReason === "SAFETY" || data.candidates[0].finishReason === "BLOCKED") {
      throw new Error("Google API blocked the response due to safety filters");
    }
    if (data.candidates[0].finishReason === "MAX_TOKENS" && (!data.candidates[0].content || !data.candidates[0].content.parts || data.candidates[0].content.parts.length === 0)) {
      throw new Error('API hit token limit before generating any content. Please increase "Default Max Tokens" in settings.');
    }
    if (data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
      const text = data.candidates[0].content.parts[0].text;
      if (data.candidates[0].finishReason === "MAX_TOKENS") {
        throw new Error('Response was truncated due to token limit. Please increase "Default Max Tokens" in settings.');
      }
      if (!text || text.trim().length === 0) {
        console.error("Google API returned empty text content");
        throw new Error("Google API returned empty text content");
      }
      return text;
    }
    throw new Error("Google API returned empty response");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages),
        generationConfig: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          maxOutputTokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        },
        ...(options == null ? void 0 : options.systemPrompt) && options.systemPrompt.trim() ? {
          systemInstruction: {
            parts: [{ text: options.systemPrompt }]
          }
        } : {}
      })
    });
    if (!response.ok) {
      const errorText = await response.text();
      let errorMessage = "";
      try {
        const errorData = JSON.parse(errorText);
        if (errorData.error) {
          const code = errorData.error.code || response.status;
          const message = errorData.error.message || errorData.error.status || response.statusText;
          errorMessage = `[${code}]: ${message}`;
        } else {
          errorMessage = `[${response.status}]: ${errorText}`;
        }
      } catch (e) {
        errorMessage = `[${response.status}]: ${errorText || response.statusText}`;
      }
      throw new Error(`Google API error ${errorMessage}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    let jsonBuffer = "";
    let braceCount = 0;
    let inJson = false;
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        for (let i = 0; i < buffer.length; i++) {
          const char = buffer[i];
          if (char === "{") {
            if (!inJson) {
              inJson = true;
              jsonBuffer = "";
            }
            braceCount++;
            jsonBuffer += char;
          } else if (char === "}") {
            jsonBuffer += char;
            braceCount--;
            if (braceCount === 0 && inJson) {
              try {
                const parsed = JSON.parse(jsonBuffer);
                const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
                if (text) {
                  const chunkSize = 3;
                  for (let i2 = 0; i2 < text.length; i2 += chunkSize) {
                    const chunk = text.slice(i2, i2 + chunkSize);
                    yield { content: chunk, done: false };
                    await new Promise((resolve) => setTimeout(resolve, 20));
                  }
                }
              } catch (e) {
              }
              inJson = false;
              jsonBuffer = "";
            }
          } else if (inJson) {
            jsonBuffer += char;
          }
        }
        buffer = "";
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gemini-2.5-flash-preview-04-17",
        "gemini-2.5-pro-preview-03-25",
        "gemini-2.0-flash",
        "gemini-2.0-flash-lite"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                const chunkSize = 3;
                for (let i = 0; i < parsed.response.length; i += chunkSize) {
                  const chunk = parsed.response.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: (options == null ? void 0 : options.temperature) || this.config.temperature || 0.7,
          num_predict: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens || 1e3
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                const chunkSize = 3;
                for (let i = 0; i < parsed.message.content.length; i += chunkSize) {
                  const chunk = parsed.message.content.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      model: "claude-3-5-sonnet-20241022",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      model: "gpt-4o",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      model: "gemini-1.5-flash",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      selectedModel: "llama3.1"
      // Default to Ollama model for desktop
    },
    mobile: {
      selectedModel: "claude-3-5-sonnet-20241022"
      // Default to Claude for mobile
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  },
  providerStatus: {},
  ollamaDefaultContext: 32e3
};
var NovaSettingTab = class extends import_obsidian12.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.activeTab = "getting-started";
    this.tabContainer = null;
    this.contentContainer = null;
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova Settings" });
    this.tabContainer = containerEl.createDiv({ cls: "nova-tab-container" });
    this.createTabNavigation();
    this.contentContainer = containerEl.createDiv({ cls: "nova-tab-content" });
    this.updateTabContent();
  }
  createTabNavigation() {
    if (!this.tabContainer) return;
    const tabs = [
      { id: "getting-started", label: "Getting Started" },
      { id: "general", label: "General" },
      { id: "providers", label: "AI Providers" },
      { id: "supernova", label: "Supernova" }
    ];
    if (true) {
      tabs.push({ id: "debug", label: "Debug" });
    }
    tabs.forEach((tab) => {
      const tabEl = this.tabContainer.createDiv({
        cls: `nova-tab ${this.activeTab === tab.id ? "active" : ""}`,
        text: tab.label
      });
      tabEl.dataset.tabId = tab.id;
      tabEl.addEventListener("click", () => {
        this.switchTab(tab.id);
      });
    });
  }
  switchTab(tabId) {
    this.activeTab = tabId;
    this.updateTabStates();
    this.updateTabContent();
    this.scrollToActiveTab();
  }
  updateTabStates() {
    if (!this.tabContainer) return;
    const tabElements = this.tabContainer.querySelectorAll(".nova-tab");
    tabElements.forEach((tabEl) => {
      const htmlTabEl = tabEl;
      if (htmlTabEl.dataset.tabId === this.activeTab) {
        htmlTabEl.addClass("active");
      } else {
        htmlTabEl.removeClass("active");
      }
    });
  }
  scrollToActiveTab() {
    if (!this.tabContainer) return;
    const activeTab = this.tabContainer.querySelector(".nova-tab.active");
    if (activeTab) {
      activeTab.scrollIntoView({
        behavior: "smooth",
        block: "nearest",
        inline: "center"
      });
    }
  }
  updateTabContent() {
    if (!this.contentContainer) return;
    this.contentContainer.empty();
    switch (this.activeTab) {
      case "getting-started":
        this.createGettingStartedTabContent(this.contentContainer);
        break;
      case "general":
        this.createGeneralTabContent(this.contentContainer);
        break;
      case "providers":
        this.createProvidersTabContent(this.contentContainer);
        break;
      case "supernova":
        this.createSupernovaTabContent(this.contentContainer);
        break;
      case "debug":
        this.createDebugTabContent(this.contentContainer);
        break;
    }
  }
  createGeneralTabContent(container) {
    this.createSupernovaCTA(container, {
      showOnlyIfNotSupporter: true,
      buttonAction: "tab",
      showLearnMore: false
    });
    this.createGeneralSettings(container);
    this.createPrivacySettings(container);
  }
  createProvidersTabContent(container) {
    this.createSupernovaCTA(container, {
      showOnlyIfNotSupporter: true,
      buttonAction: "tab",
      showLearnMore: false
    });
    this.createProviderSettings(container);
  }
  createGettingStartedTabContent(container) {
    this.createWelcomeSection(container);
    this.createQuickStartGuide(container);
    this.createSupernovaCTA(container, {
      buttonAction: "tab",
      showLearnMore: true,
      marginTop: "32px",
      marginBottom: "32px"
    });
    this.createNavigationHelp(container);
  }
  createSupernovaTabContent(container) {
    this.createSupernovaCTA(container, {
      buttonAction: "direct",
      showLearnMore: false,
      marginBottom: "32px"
    });
    const benefitsSection = container.createDiv({ cls: "nova-benefits-section" });
    benefitsSection.style.marginTop = "32px";
    benefitsSection.createEl("h3", { text: "Supernova Benefits" });
    benefitsSection.createEl("hr", { cls: "nova-section-divider" });
    const benefitsContent = benefitsSection.createDiv({ cls: "nova-benefits-content" });
    benefitsContent.innerHTML = `
			<p style="margin-bottom: 20px;">Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
			
			<div class="nova-benefits-list">
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u26A1</span>
					<div class="nova-benefit-content">
						<strong>Early Access</strong>
						<span>Get new features 2-4 months before general release</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u{1F4AC}</span>
					<div class="nova-benefit-content">
						<strong>Priority Support</strong>
						<span>Direct access to developers for feature requests and bug reports</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u{1F5F3}\uFE0F</span>
					<div class="nova-benefit-content">
						<strong>Vote on Features</strong>
						<span>Help shape Nova's development and future direction</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u{1F3C6}</span>
					<div class="nova-benefit-content">
						<strong>Supporter Badge</strong>
						<span>Recognition in the Nova community (coming soon)</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u2764\uFE0F</span>
					<div class="nova-benefit-content">
						<strong>Open Source Support</strong>
						<span>Directly fund continued development of Nova</span>
					</div>
				</div>
			</div>
			
			<p style="margin-top: 20px; font-size: 0.9em; color: var(--text-muted);">Your support keeps Nova free and open source for everyone.</p>
		`;
    const licenseSection = container.createDiv({ cls: "nova-provider-section" });
    licenseSection.style.marginTop = "32px";
    licenseSection.createEl("h3", { text: "License Management" });
    this.createSupernovaLicenseInput(licenseSection);
  }
  createDebugTabContent(container) {
    const debugSection = container.createDiv({ cls: "nova-debug-section" });
    debugSection.createEl("h3", { text: "Debug Settings" });
    debugSection.createEl("hr", { cls: "nova-section-divider" });
    const infoEl = debugSection.createDiv({ cls: "nova-debug-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<p>Debug settings for development and testing. These options help developers troubleshoot issues and test new features.</p>
			</div>
			<div class="nova-info-card">
				<h4>\u26A0\uFE0F Developer Settings</h4>
				<ul class="nova-debug-features">
					<li><strong>Debug Mode</strong> - Enable detailed logging and development features</li>
					<li><strong>Override Date</strong> - Test time-sensitive features with custom dates</li>
					<li><strong>Force Supernova</strong> - Test Supernova-only features without a license</li>
				</ul>
				<p class="nova-debug-note">Only modify these settings if you understand their purpose.</p>
			</div>
		`;
    this.createDebugSettings(debugSection);
  }
  createPrivacySettings(container) {
    const privacySection = container.createDiv({ cls: "nova-privacy-section" });
    privacySection.createEl("h3", { text: "Privacy & Platform Settings" });
    privacySection.createEl("hr", { cls: "nova-section-divider" });
    const infoEl = privacySection.createDiv({ cls: "nova-privacy-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F512} Your Privacy Matters</h4>
				<p>Nova respects your privacy and gives you full control over how your data is handled. 
				All AI providers are accessed using your own API keys, so your content stays between you and your chosen AI service.</p>
			</div>
			<div class="nova-info-card">
				<h4>\u{1F4F1} Mobile Support</h4>
				<p>Mobile support is disabled by default to protect your privacy. When enabled, Nova provides identical selection-based editing capabilities across desktop and mobile with cloud-based AI providers.</p>
				<ul class="nova-privacy-features">
					<li><strong>Local-first</strong> - Ollama and desktop-only providers keep everything on your device</li>
					<li><strong>Your choice</strong> - Enable mobile only when you need cross-device access</li>
					<li><strong>Cross-platform editing</strong> - Selection-based editing works identically on mobile via Command Palette (Cmd+P)</li>
					<li><strong>Same experience</strong> - Mobile provides the same editing capabilities as desktop</li>
				</ul>
			</div>
		`;
    new import_obsidian12.Setting(privacySection).setName("Enable Mobile Support").setDesc("Allow Nova to work on mobile devices using cloud-based AI providers").addToggle((toggle) => {
      const currentMobileModel = this.plugin.settings.platformSettings.mobile.selectedModel;
      const isMobileEnabled = currentMobileModel !== "none";
      toggle.setValue(isMobileEnabled).onChange(async (value) => {
        if (value) {
          this.plugin.settings.platformSettings.mobile.selectedModel = "claude-3-5-sonnet-20241022";
        } else {
          this.plugin.settings.platformSettings.mobile.selectedModel = "none";
        }
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
  }
  createSecureApiKeyInput(container, options) {
    const setting = new import_obsidian12.Setting(container).setName(options.name).setDesc(options.desc);
    let actualValue = options.value;
    let isVisible = false;
    setting.addText((text) => {
      text.inputEl.type = "password";
      text.inputEl.style.fontFamily = "var(--font-monospace)";
      text.inputEl.style.width = "400px";
      text.inputEl.style.height = "40px";
      text.inputEl.style.position = "relative";
      text.setPlaceholder(options.placeholder);
      if (actualValue && actualValue.length > 12) {
        const masked = actualValue.slice(0, 8) + "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022" + actualValue.slice(-4);
        text.setValue(masked);
      } else {
        text.setValue(actualValue);
      }
      const inputContainer = text.inputEl.parentElement;
      if (inputContainer) {
        inputContainer.style.position = "relative";
        const toggleBtn = inputContainer.createEl("button", { cls: "nova-toggle-btn" });
        toggleBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
					<circle cx="12" cy="12" r="3"/>
				</svg>`;
        toggleBtn.addEventListener("click", (e) => {
          e.preventDefault();
          isVisible = !isVisible;
          if (isVisible) {
            text.inputEl.type = "text";
            text.setValue(actualValue);
            toggleBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="m9.88 9.88a3 3 0 1 0 4.24 4.24"/>
							<path d="m10.73 5.08a10.43 10.43 0 0 1 1.27-.08c7 0 11 8 11 8a13.16 13.16 0 0 1-1.67 2.68"/>
							<path d="M6.61 6.61A13.526 13.526 0 0 0 1 12s4 8 11 8a9.74 9.74 0 0 0 5.39-1.61"/>
							<line x1="2" y1="2" x2="22" y2="22"/>
						</svg>`;
          } else {
            text.inputEl.type = "password";
            if (actualValue && actualValue.length > 12) {
              const masked = actualValue.slice(0, 8) + "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022" + actualValue.slice(-4);
              text.setValue(masked);
            } else {
              text.setValue(actualValue);
            }
            toggleBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
							<circle cx="12" cy="12" r="3"/>
						</svg>`;
          }
        });
      }
      text.onChange(async (value) => {
        actualValue = value;
        await options.onChange(value);
      });
      return text;
    });
  }
  createProviderStatusIndicator(container, provider) {
    const statusContainer = container.createDiv({ cls: "nova-provider-status-container" });
    try {
      const status = this.getProviderStatus(provider);
      const statusEl = statusContainer.createDiv({ cls: `nova-provider-status ${status.status}` });
      const dot = statusEl.createSpan({ cls: "nova-status-dot" });
      const text = statusEl.createSpan({ cls: "nova-status-text" });
      text.textContent = this.getStatusDisplayText(status);
      if (status.lastChecked || status.message) {
        const tooltip = statusEl.createDiv({ cls: "nova-status-tooltip" });
        if (status.lastChecked) {
          const timeEl = tooltip.createDiv({ cls: "nova-status-time" });
          const date = status.lastChecked instanceof Date ? status.lastChecked : new Date(status.lastChecked);
          timeEl.textContent = `Last checked: ${date.toLocaleDateString()}`;
        }
        if (status.message) {
          const messageEl = tooltip.createDiv({ cls: "nova-status-message" });
          messageEl.textContent = status.message;
        }
      }
    } catch (error) {
      console.error("Error creating provider status indicator:", error);
      const statusEl = statusContainer.createDiv({ cls: "nova-provider-status untested" });
      const dot = statusEl.createSpan({ cls: "nova-status-dot" });
      const text = statusEl.createSpan({ cls: "nova-status-text" });
      text.textContent = "Status unknown";
    }
    return statusContainer;
  }
  getProviderStatus(provider) {
    var _a;
    try {
      const savedStatus = (_a = this.plugin.settings.providerStatus) == null ? void 0 : _a[provider];
      if (savedStatus) {
        return savedStatus;
      }
      const hasConfig = this.hasProviderConfig(provider);
      return {
        status: hasConfig ? "untested" : "not-configured",
        message: hasConfig ? "Configuration not tested" : "No API key configured",
        lastChecked: null
      };
    } catch (error) {
      console.error(`Error getting provider status for ${provider}:`, error);
      return {
        status: "not-configured",
        message: "Status unavailable",
        lastChecked: null
      };
    }
  }
  getStatusDisplayText(status) {
    switch (status.status) {
      case "connected":
        return "Connected";
      case "error":
        return "Connection failed";
      case "not-configured":
        return "Not configured";
      case "untested":
        return "Untested";
      case "testing":
        return "Testing...";
      default:
        return "Unknown";
    }
  }
  createTestConnectionButton(container, provider) {
    const setting = new import_obsidian12.Setting(container).setName("Connection Status").setDesc("Test your API connection");
    const statusContainer = setting.controlEl.createDiv({ cls: "nova-connection-status-container" });
    setting.addButton((button) => {
      button.setButtonText("Test Connection").setTooltip(`Test ${provider} connection`).onClick(async () => {
        await this.testProviderConnection(provider, button.buttonEl, statusContainer);
      });
      button.buttonEl.setAttribute("aria-label", `Test ${this.getProviderDisplayName(provider)} connection`);
      return button;
    });
    this.updateConnectionStatus(statusContainer, provider);
  }
  async testProviderConnection(provider, buttonEl, statusContainer) {
    var _a, _b, _c, _d, _e, _f, _g;
    const originalText = buttonEl.textContent || "Test Connection";
    const button = buttonEl;
    console.log(`Starting connection test for ${provider}, button disabled: ${button.disabled}`);
    button.disabled = false;
    button.textContent = "Testing...";
    button.style.opacity = "0.6";
    await this.updateProviderStatus(provider, "testing", "Testing connection...");
    this.setConnectionStatus(statusContainer, "testing", "Testing...");
    const restoreButton = () => {
      button.disabled = false;
      button.textContent = originalText;
      button.style.opacity = "1";
      console.log(`Button force-restored for ${provider}`);
    };
    const backupTimer = setTimeout(restoreButton, 12e3);
    try {
      const hasConfig = this.hasProviderConfig(provider);
      if (!hasConfig) {
        throw new Error("Provider not configured - missing API key or settings");
      }
      const timeoutPromise = new Promise((_, reject) => {
        setTimeout(() => reject(new Error("Connection timeout")), 1e4);
      });
      const testPromise = this.performRealConnectionTest(provider);
      await Promise.race([testPromise, timeoutPromise]);
      await this.updateProviderStatus(provider, "connected", "Connected successfully");
      this.setConnectionStatus(statusContainer, "success", "\u25CF Connected");
      console.log(`Connection test successful for ${provider}`);
    } catch (error) {
      console.log(`Connection test failed for ${provider}:`, error);
      let errorMessage = "Connection failed";
      if (error.message === "Connection timeout") {
        errorMessage = "Timeout";
      } else if (provider === "ollama") {
        const ollamaUrl = this.plugin.settings.aiProviders.ollama.baseUrl;
        if (!ollamaUrl || ollamaUrl.trim() === "") {
          errorMessage = "No URL configured";
        } else {
          errorMessage = "Connection failed";
        }
      } else if (((_a = error.message) == null ? void 0 : _a.includes("401")) || ((_b = error.message) == null ? void 0 : _b.includes("unauthorized")) || ((_c = error.message) == null ? void 0 : _c.includes("API key"))) {
        errorMessage = "Invalid API key";
      } else if ((_d = error.message) == null ? void 0 : _d.includes("429")) {
        errorMessage = "Rate limited";
      } else if ((_e = error.message) == null ? void 0 : _e.includes("quota")) {
        errorMessage = "Quota exceeded";
      } else if (((_f = error.message) == null ? void 0 : _f.includes("not configured")) || ((_g = error.message) == null ? void 0 : _g.includes("missing"))) {
        errorMessage = "Not configured";
      } else {
        errorMessage = "Connection failed";
      }
      await this.updateProviderStatus(provider, "error", errorMessage);
      this.setConnectionStatus(statusContainer, "error", `\u25CF ${errorMessage}`);
    } finally {
      clearTimeout(backupTimer);
      restoreButton();
    }
  }
  async updateProviderStatus(provider, status, message) {
    if (!this.plugin.settings.providerStatus) {
      this.plugin.settings.providerStatus = {};
    }
    this.plugin.settings.providerStatus[provider] = {
      status,
      message,
      lastChecked: status === "testing" ? null : /* @__PURE__ */ new Date()
    };
    await this.plugin.saveSettings();
    this.refreshProviderStatusIndicators();
  }
  refreshProviderStatusIndicators() {
    const containers = this.containerEl.querySelectorAll(".nova-provider-status-container");
    containers.forEach((container) => {
      const provider = container.getAttribute("data-provider");
      if (provider) {
        this.updateProviderStatusDisplay(container, provider);
      }
    });
  }
  updateProviderStatusDisplay(container, provider) {
    const status = this.getProviderStatus(provider);
    const statusEl = container.querySelector(".nova-provider-status");
    if (statusEl) {
      statusEl.className = `nova-provider-status ${status.status}`;
      const textEl = statusEl.querySelector(".nova-status-text");
      if (textEl) {
        textEl.textContent = this.getStatusDisplayText(status);
      }
      let tooltip = statusEl.querySelector(".nova-status-tooltip");
      if (status.lastChecked || status.message) {
        if (!tooltip) {
          tooltip = statusEl.createDiv({ cls: "nova-status-tooltip" });
        }
        tooltip.empty();
        if (status.lastChecked) {
          const timeEl = tooltip.createDiv({ cls: "nova-status-time" });
          const date = status.lastChecked instanceof Date ? status.lastChecked : new Date(status.lastChecked);
          timeEl.textContent = `Last checked: ${date.toLocaleDateString()}`;
        }
        if (status.message) {
          const messageEl = tooltip.createDiv({ cls: "nova-status-message" });
          messageEl.textContent = status.message;
        }
      } else if (tooltip) {
        tooltip.remove();
      }
    }
  }
  async performRealConnectionTest(provider) {
    console.log(`Starting real connection test for ${provider}`);
    switch (provider) {
      case "claude": {
        const claudeProvider = new ClaudeProvider(this.plugin.settings.aiProviders.claude);
        await claudeProvider.complete("You are a helpful assistant.", "Hi", { maxTokens: 1 });
        break;
      }
      case "openai": {
        const openaiProvider = new OpenAIProvider(this.plugin.settings.aiProviders.openai);
        await openaiProvider.getAvailableModels();
        break;
      }
      case "google": {
        const googleProvider = new GoogleProvider(this.plugin.settings.aiProviders.google);
        await googleProvider.getAvailableModels();
        break;
      }
      case "ollama": {
        const ollamaProvider = new OllamaProvider(this.plugin.settings.aiProviders.ollama);
        const isAvailable = await ollamaProvider.isAvailable();
        if (!isAvailable) {
          throw new Error("Ollama connection failed");
        }
        break;
      }
    }
    console.log(`Connection test successful for ${provider}`);
  }
  setConnectionStatus(container, type, message) {
    container.empty();
    if (type === "none") return;
    const statusEl = container.createDiv({ cls: `nova-status-indicator ${type}` });
    statusEl.textContent = message;
  }
  updateConnectionStatus(container, provider) {
    const hasConfig = this.hasProviderConfig(provider);
    if (!hasConfig) {
      this.setConnectionStatus(container, "none", "");
    } else {
      this.setConnectionStatus(container, "none", "");
    }
  }
  hasProviderConfig(provider) {
    switch (provider) {
      case "claude":
        return !!this.plugin.settings.aiProviders.claude.apiKey;
      case "openai":
        return !!this.plugin.settings.aiProviders.openai.apiKey;
      case "google":
        return !!this.plugin.settings.aiProviders.google.apiKey;
      case "ollama":
        return !!this.plugin.settings.aiProviders.ollama.baseUrl;
      default:
        return false;
    }
  }
  createLicenseSettings(containerEl = this.containerEl) {
    var _a, _b;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${isSupernova ? "supernova" : "nova"}">
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    this.createSecureApiKeyInput(licenseContainer, {
      name: "Supernova License Key (Optional)",
      desc: "Enter your Supernova supporter license key for early access to new features",
      placeholder: "Enter Supernova license key...",
      value: this.plugin.settings.licensing.supernovaLicenseKey || "",
      onChange: async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.updateTabContent();
        }
      }
    });
    const validateSetting = new import_obsidian12.Setting(licenseContainer).setDesc("Validate your Supernova license key").addButton((button) => {
      button.setButtonText("Validate License").onClick(async () => {
        const licenseKey = this.plugin.settings.licensing.supernovaLicenseKey;
        if (!licenseKey) {
          this.showLicenseMessage("Please enter a Supernova license key first.", "error");
          return;
        }
        button.setButtonText("Validating...");
        button.disabled = true;
        try {
          if (this.plugin.featureManager) {
            await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
            const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
            if (isSupernova2) {
              this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
              this.showConfetti();
            } else {
              this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
            }
            const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
            if (leaves.length > 0) {
              const sidebarView = leaves[0].view;
              sidebarView.refreshSupernovaUI();
            }
            this.updateTabContent();
          }
        } catch (error) {
          this.showLicenseMessage("Error validating Supernova license.", "error");
        } finally {
          button.setButtonText("Validate License");
          button.disabled = false;
        }
      });
    });
    this.createSupernovaInfo(licenseContainer);
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian12.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian12.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian12.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.updateTabContent();
      }));
      new import_obsidian12.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.updateTabContent();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings(containerEl = this.containerEl) {
    const coreSection = containerEl.createDiv({ cls: "nova-core-settings-section" });
    coreSection.createEl("h3", { text: "Core Settings" });
    coreSection.style.marginBottom = "32px";
    new import_obsidian12.Setting(coreSection).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 = focused, 1.0 = creative)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(coreSection).setName("Default Max Tokens").setDesc("Maximum length of AI responses (higher = longer responses)").addText((text) => {
      text.inputEl.type = "number";
      text.inputEl.style.width = "150px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("1000").setValue(this.plugin.settings.general.defaultMaxTokens.toString()).onChange(async (value) => {
        const numValue = parseInt(value);
        if (!isNaN(numValue) && numValue > 0) {
          this.plugin.settings.general.defaultMaxTokens = numValue;
          await this.plugin.saveSettings();
        }
      });
    });
    new import_obsidian12.Setting(coreSection).setName("Auto-save settings").setDesc("Automatically save configuration changes").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings(containerEl = this.containerEl) {
    const apiKeysSection = containerEl.createDiv({ cls: "nova-api-keys-section" });
    apiKeysSection.createEl("h3", { text: "Configure Your API Keys" });
    apiKeysSection.createEl("hr", { cls: "nova-section-divider" });
    const infoEl = apiKeysSection.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
			</div>
			<div class="nova-info-card nova-model-guidance">
				<h4>Recommended Defaults</h4>
				<ul class="nova-model-recommendations">
					<li><strong>Claude Sonnet 4</strong> - Latest generation with excellent instruction following for collaborative editing</li>
					<li><strong>GPT-4.1 Mini</strong> - Current-generation model that outperforms GPT-4o while remaining cost-effective</li>
					<li><strong>Gemini 2.5 Flash</strong> - Best price/performance with "thinking" capabilities and strong coding support</li>
				</ul>
				<p class="nova-guidance-note">These defaults offer modern AI capabilities without premium pricing.</p>
			</div>
		`;
    const configSection = apiKeysSection.createDiv({ cls: "nova-provider-config-section" });
    configSection.createEl("h4", { text: "Configuration" });
    configSection.createEl("hr", { cls: "nova-section-divider" });
    this.createOllamaSettings(configSection);
    this.createClaudeSettings(configSection);
    this.createGoogleSettings(configSection);
    this.createOpenAISettings(configSection);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = claudeContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "Claude (Anthropic)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "claude");
    statusContainer.setAttribute("data-provider", "claude");
    this.createSecureApiKeyInput(claudeContainer, {
      name: "API Key",
      desc: "Your Anthropic API key",
      placeholder: "sk-ant-...",
      value: this.plugin.settings.aiProviders.claude.apiKey || "",
      onChange: async (value) => {
        this.plugin.settings.aiProviders.claude.apiKey = value;
        await this.plugin.saveSettings();
      }
    });
    this.createTestConnectionButton(claudeContainer, "claude");
    const modelSetting = new import_obsidian12.Setting(claudeContainer).setName("Model").setDesc("Claude model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      dropdown.selectEl.style.width = "200px";
      dropdown.selectEl.style.height = "40px";
      this.populateClaudeModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.claude.model || "claude-sonnet-4-20250514").onChange(async (value) => {
        this.plugin.settings.aiProviders.claude.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateClaudeModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("claude");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = openaiContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "openai");
    statusContainer.setAttribute("data-provider", "openai");
    this.createSecureApiKeyInput(openaiContainer, {
      name: "API Key",
      desc: "Your OpenAI API key",
      placeholder: "sk-...",
      value: this.plugin.settings.aiProviders.openai.apiKey || "",
      onChange: async (value) => {
        this.plugin.settings.aiProviders.openai.apiKey = value;
        await this.plugin.saveSettings();
      }
    });
    this.createTestConnectionButton(openaiContainer, "openai");
    const modelSetting = new import_obsidian12.Setting(openaiContainer).setName("Model").setDesc("OpenAI model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      dropdown.selectEl.style.width = "200px";
      dropdown.selectEl.style.height = "40px";
      this.populateOpenAIModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.openai.model || "gpt-4.1-mini-2025-04-14").onChange(async (value) => {
        this.plugin.settings.aiProviders.openai.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateOpenAIModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("openai");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = googleContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "Google (Gemini)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "google");
    statusContainer.setAttribute("data-provider", "google");
    this.createSecureApiKeyInput(googleContainer, {
      name: "API Key",
      desc: "Your Google AI API key",
      placeholder: "AI...",
      value: this.plugin.settings.aiProviders.google.apiKey || "",
      onChange: async (value) => {
        this.plugin.settings.aiProviders.google.apiKey = value;
        await this.plugin.saveSettings();
      }
    });
    this.createTestConnectionButton(googleContainer, "google");
    const modelSetting = new import_obsidian12.Setting(googleContainer).setName("Model").setDesc("Gemini model to use");
    let modelDropdown;
    modelSetting.addDropdown((dropdown) => {
      modelDropdown = dropdown;
      dropdown.selectEl.style.width = "200px";
      dropdown.selectEl.style.height = "40px";
      this.populateGoogleModels(dropdown);
      return dropdown.setValue(this.plugin.settings.aiProviders.google.model || "gemini-2.5-flash-preview-04-17").onChange(async (value) => {
        this.plugin.settings.aiProviders.google.model = value;
        await this.plugin.saveSettings();
      });
    });
  }
  populateGoogleModels(dropdown) {
    dropdown.selectEl.empty();
    const currentModels = getAvailableModels("google");
    currentModels.forEach((model) => {
      dropdown.addOption(model.value, model.label);
    });
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = ollamaContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "Ollama (Local)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "ollama");
    statusContainer.setAttribute("data-provider", "ollama");
    new import_obsidian12.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => {
      text.inputEl.style.width = "350px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
        this.plugin.settings.aiProviders.ollama.baseUrl = value;
        await this.plugin.saveSettings();
      });
    });
    this.createTestConnectionButton(ollamaContainer, "ollama");
    new import_obsidian12.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => {
      text.inputEl.style.width = "200px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
        this.plugin.settings.aiProviders.ollama.model = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian12.Setting(ollamaContainer).setName("Default Context Limit").setDesc("Context window size for all Ollama models (Nova defaults to 32K vs Ollama's 2K)").addText((text) => {
      text.inputEl.type = "number";
      text.inputEl.style.width = "150px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("32000").setValue((this.plugin.settings.ollamaDefaultContext || 32e3).toString()).onChange(async (value) => {
        const numValue = parseInt(value);
        if (!isNaN(numValue) && numValue > 0) {
          this.plugin.settings.ollamaDefaultContext = numValue;
          await this.plugin.saveSettings();
        }
      });
    });
  }
  createPlatformSettings(containerEl = this.containerEl) {
    containerEl.createEl("h3", { text: "Platform Settings" });
    const infoEl = containerEl.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    new import_obsidian12.Setting(containerEl).setName("Model Selection").setDesc("Models are now selected using the dropdown in the Nova sidebar. Each platform (desktop/mobile) remembers its selected model independently.");
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentModel(modelId) {
    const platform = import_obsidian12.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].selectedModel = modelId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings(containerEl = this.containerEl) {
    containerEl.createEl("h3", { text: "Custom Commands" });
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      const noticeEl = containerEl.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = containerEl.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian12.Setting(containerEl).setName("Show Command Button in Chat (Mobile)").setDesc("Show the Commands button beside the Send button for mobile quick access to Nova commands and selection actions").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = containerEl.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian12.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(containerEl);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
  createWelcomeSection(container) {
    const welcomeSection = container.createDiv({ cls: "nova-welcome-section" });
    const headerDiv = welcomeSection.createDiv({ cls: "nova-welcome-header" });
    headerDiv.innerHTML = `
			<div class="nova-welcome-logo">
				${NOVA_ICON_SVG}
			</div>
			<div class="nova-welcome-content">
				<h2>Welcome to Nova</h2>
				<p class="nova-tagline">Your AI writing partner to make the writing process smoother</p>
				<p class="nova-story">Removes the friction of copy/paste from LLMs to Obsidian, and provides actionable insights to help improve your writing</p>
			</div>
		`;
  }
  createQuickStartGuide(container) {
    const guideSection = container.createDiv({ cls: "nova-quick-start-section" });
    guideSection.style.marginTop = "32px";
    const selectionCard = guideSection.createDiv({ cls: "nova-quick-start-card" });
    selectionCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F3AF}</span>
				<h4>Selection-Based Editing</h4>
			</div>
			<div class="nova-card-content">
				<ol>
					<li>Select any text in your document</li>
					<li>Right-click to open context menu</li>
					<li>Choose Nova action (Improve Writing, Make Longer)</li>
					<li>Watch AI transform text exactly in place</li>
				</ol>
				<div class="nova-tip">\u{1F4A1} Tip: Select any text in your document and right-click to see Nova actions</div>
			</div>
		`;
    const chatCard = guideSection.createDiv({ cls: "nova-quick-start-card" });
    chatCard.style.marginTop = "24px";
    chatCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F4AC}</span>
				<h4>Chat-Based Targeting</h4>
			</div>
			<div class="nova-card-content">
				<ol>
					<li>Place cursor where you want content</li>
					<li>Type command: "Add conclusion section"</li>
					<li>Nova edits precisely at cursor location</li>
				</ol>
				<div class="nova-tip">\u{1F4F1} Works identically on desktop and mobile</div>
			</div>
		`;
    const providerCard = guideSection.createDiv({ cls: "nova-quick-start-card" });
    providerCard.style.marginTop = "24px";
    providerCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F916}</span>
				<h4>AI Provider Selection</h4>
			</div>
			<div class="nova-card-content">
				<p>Choose the right AI for your task:</p>
				<ul>
					<li><strong>Claude</strong> - For complex reasoning and analysis</li>
					<li><strong>OpenAI</strong> - For balanced performance and creativity</li>
					<li><strong>Gemini</strong> - For fast responses and research</li>
					<li><strong>Ollama</strong> - For local privacy and offline use \u{1F512}</li>
				</ul>
				<div class="nova-tip">Configure providers in the AI Providers tab</div>
			</div>
		`;
  }
  createSupernovaLicenseInput(container) {
    var _a, _b;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    if (supernovaLicense) {
      const statusEl = container.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info" style="margin-bottom: 16px; padding: 12px; background: var(--background-modifier-form-field); border-radius: var(--radius-s);">
					<div style="display: flex; justify-content: space-between; align-items: center;">
						<span style="color: var(--text-normal);">${supernovaLicense.email}</span>
						<span style="color: var(--text-muted); font-size: 0.9em;">${expiryText}</span>
					</div>
				</div>
			`;
    }
    this.createSecureApiKeyInput(container, {
      name: "License Key",
      desc: "Enter your Supernova supporter license key",
      placeholder: "NOVA-XXXX-XXXX-XXXX",
      value: this.plugin.settings.licensing.supernovaLicenseKey || "",
      onChange: async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.updateTabContent();
        }
      }
    });
    const validationEl = container.createDiv({ cls: "nova-validation-status" });
    validationEl.style.marginTop = "8px";
    validationEl.style.fontSize = "0.9em";
  }
  createSupernovaCTA(container, options = {}) {
    var _a;
    const {
      showOnlyIfNotSupporter = false,
      buttonAction = "tab",
      showLearnMore = true,
      marginTop = "0",
      marginBottom = "32px"
    } = options;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    if (showOnlyIfNotSupporter && isSupernova) {
      return;
    }
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? "\u2B50" : "\u{1F31F}";
    const ctaSection = container.createDiv({ cls: "nova-prominent-supernova-section" });
    ctaSection.style.marginTop = marginTop;
    ctaSection.style.marginBottom = marginBottom;
    ctaSection.innerHTML = `
			<div class="nova-supernova-cta">
				<div class="nova-supernova-header">
					<span class="nova-supernova-icon">${statusIcon}</span>
					<div class="nova-supernova-info">
						<h3>Supernova Support</h3>
						<p>Status: <strong>${statusText}</strong></p>
					</div>
				</div>
				<div class="nova-supernova-actions">
					<button class="nova-supernova-btn primary" ${buttonAction === "tab" ? 'data-tab="supernova"' : ""}>
						${isSupernova ? buttonAction === "tab" ? "Manage License" : "Thank You for Supporting!" : "Become a Supporter"}
					</button>
					${showLearnMore ? '<button class="nova-supernova-btn secondary" data-tab="supernova">Learn More</button>' : ""}
				</div>
			</div>
		`;
    if (buttonAction === "tab") {
      ctaSection.querySelectorAll('[data-tab="supernova"]').forEach((button) => {
        button.addEventListener("click", (e) => {
          e.preventDefault();
          this.switchTab("supernova");
        });
      });
    }
  }
  createNavigationHelp(container) {
    const navSection = container.createDiv({ cls: "nova-navigation-section" });
    navSection.style.marginTop = "32px";
    const navCard = navSection.createDiv({ cls: "nova-navigation-card" });
    navCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F4DA}</span>
				<h4>Next Steps</h4>
			</div>
			<div class="nova-card-content">
				<div class="nova-next-steps">
					<div class="nova-next-step">
						<span>1. Configure AI providers</span>
						<a href="#" class="nova-step-link" data-tab="providers">\u2192 Go to AI Providers tab</a>
					</div>
					<div class="nova-next-step">
						<span>2. Explore Privacy and General Settings</span>
						<a href="#" class="nova-step-link" data-tab="general">\u2192 Go to General tab</a>
					</div>
					<div class="nova-next-step">
						<span>3. Manage Supernova License</span>
						<a href="#" class="nova-step-link" data-tab="supernova">\u2192 Go to Supernova tab</a>
					</div>
				</div>
			</div>
		`;
    navCard.querySelectorAll(".nova-step-link").forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const tabId = e.target.getAttribute("data-tab");
        this.switchTab(tabId);
      });
    });
  }
};

// src/ai/provider-manager.ts
var import_obsidian13 = require("obsidian");
var AIProviderManager = class {
  // 30 seconds
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.availabilityCache = /* @__PURE__ */ new Map();
    this.CACHE_TTL = 3e4;
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
    this.availabilityCache.clear();
  }
  /**
   * Check provider availability with caching to avoid repeated network calls
   */
  async checkProviderAvailability(providerType) {
    const now = Date.now();
    const cached = this.availabilityCache.get(providerType);
    if (cached && now - cached.timestamp < this.CACHE_TTL) {
      return cached.isAvailable;
    }
    const provider = this.providers.get(providerType);
    const isAvailable = provider ? await provider.isAvailable() : false;
    this.availabilityCache.set(providerType, {
      isAvailable,
      timestamp: now
    });
    return isAvailable;
  }
  /**
   * Get the provider type that handles a specific model
   */
  getProviderForModel(modelName) {
    if (modelName.startsWith("claude-")) {
      return "claude";
    }
    if (modelName.startsWith("gpt-") || modelName.startsWith("o1-")) {
      return "openai";
    }
    if (modelName.startsWith("gemini-")) {
      return "google";
    }
    return "ollama";
  }
  /**
   * Get the selected model for the current platform
   */
  getSelectedModel() {
    const platform = import_obsidian13.Platform.isMobile ? "mobile" : "desktop";
    const selectedModel = this.settings.platformSettings[platform].selectedModel;
    console.log("\u{1F50D} AIProviderManager.getSelectedModel():");
    console.log("\u{1F50D} Platform:", platform);
    console.log("\u{1F50D} Selected model:", selectedModel);
    return selectedModel;
  }
  async getAvailableProvider() {
    const selectedModel = this.getSelectedModel();
    const providerType = this.getProviderForModel(selectedModel);
    if (!providerType || providerType === "none") {
      return null;
    }
    const provider = this.providers.get(providerType);
    const isAvailable = provider ? await this.checkProviderAvailability(providerType) : false;
    console.log("\u{1F50D} Provider for model:", { selectedModel, providerType, isAvailable });
    if (provider && isAvailable) {
      return provider;
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.generateText(prompt2, options);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.generateTextStream(prompt2, options);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    yield* provider.chatCompletionStream(messages, options);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async getCurrentProviderType() {
    const selectedModel = this.getSelectedModel();
    const providerType = this.getProviderForModel(selectedModel);
    if (!providerType || providerType === "none") {
      return null;
    }
    const provider = this.providers.get(providerType);
    if (provider && await this.checkProviderAvailability(providerType)) {
      return providerType;
    }
    return null;
  }
  /**
   * Get the currently selected model name
   */
  getCurrentModel() {
    return this.getSelectedModel();
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    return provider.complete(systemPrompt, userPrompt, options);
  }
  getAllowedProviders() {
    if (import_obsidian13.Platform.isMobile) {
      return ["claude", "openai", "google"];
    }
    return ["claude", "openai", "google", "ollama"];
  }
  /**
   * Get all available providers with their availability status in parallel
   */
  async getAvailableProvidersWithStatus() {
    const allowedProviders = this.getAllowedProviders();
    const availabilityChecks = allowedProviders.map(async (providerType) => {
      const isAvailable = await this.checkProviderAvailability(providerType);
      return { providerType, isAvailable };
    });
    const results = await Promise.all(availabilityChecks);
    const availabilityMap = /* @__PURE__ */ new Map();
    results.forEach(({ providerType, isAvailable }) => {
      availabilityMap.set(providerType, isAvailable);
    });
    return availabilityMap;
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
  /**
   * Get the default max tokens from settings
   */
  getDefaultMaxTokens() {
    return this.settings.general.defaultMaxTokens;
  }
};

// src/core/document-engine.ts
var import_obsidian14 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.initializePromise = this.initialize();
  }
  async initialize() {
    await this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          try {
            const sanitizedConversation = this.sanitizeConversationData(conversation);
            this.conversations.set(sanitizedConversation.filePath, sanitizedConversation);
          } catch (error) {
            console.warn(`Skipped corrupted conversation for file: ${(conversation == null ? void 0 : conversation.filePath) || "unknown"}`, error);
          }
        }
      }
    } catch (error) {
      console.error("\u274C ConversationManager.loadConversations: Load failed:", error);
    }
  }
  /**
   * Sanitize and validate conversation data
   */
  sanitizeConversationData(conversation) {
    if (!conversation.filePath || typeof conversation.filePath !== "string") {
      throw new Error("Invalid or missing filePath");
    }
    const messages = Array.isArray(conversation.messages) ? conversation.messages : [];
    let contextDocuments = [];
    if (Array.isArray(conversation.contextDocuments)) {
      contextDocuments = conversation.contextDocuments.filter((doc) => this.isValidContextDocument(doc)).map((doc) => this.sanitizeContextDocument(doc));
    }
    return {
      filePath: conversation.filePath,
      messages,
      lastUpdated: typeof conversation.lastUpdated === "number" ? conversation.lastUpdated : Date.now(),
      contextDocuments,
      metadata: conversation.metadata || {
        editCount: 0,
        commandFrequency: {
          add: 0,
          edit: 0,
          delete: 0,
          grammar: 0,
          rewrite: 0,
          metadata: 0
        }
      }
    };
  }
  /**
   * Validate context document structure
   */
  isValidContextDocument(doc) {
    return doc && typeof doc.path === "string" && doc.path.trim().length > 0;
  }
  /**
   * Sanitize context document data
   */
  sanitizeContextDocument(doc) {
    return {
      path: doc.path,
      property: typeof doc.property === "string" ? doc.property : void 0,
      addedAt: typeof doc.addedAt === "number" ? doc.addedAt : Date.now()
    };
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
      console.error("\u274C ConversationManager.saveConversations: Save failed:", error);
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        contextDocuments: [],
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    const conversation = this.conversations.get(filePath);
    if (!conversation.contextDocuments) {
      conversation.contextDocuments = [];
    }
    return conversation;
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content, metadata) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now(),
      metadata
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Add a context document to the conversation
   */
  async addContextDocument(file, contextPath, property) {
    var _a, _b;
    await this.initializePromise;
    const conversation = this.getConversation(file);
    const exists = (_a = conversation.contextDocuments) == null ? void 0 : _a.some(
      (doc) => doc.path === contextPath && doc.property === property
    );
    if (!exists) {
      const contextDoc = {
        path: contextPath,
        property,
        addedAt: Date.now()
      };
      (_b = conversation.contextDocuments) == null ? void 0 : _b.push(contextDoc);
      conversation.lastUpdated = Date.now();
      await this.saveConversations();
    }
  }
  /**
   * Remove a context document from the conversation
   */
  async removeContextDocument(file, contextPath, property) {
    const conversation = this.getConversation(file);
    if (conversation.contextDocuments) {
      conversation.contextDocuments = conversation.contextDocuments.filter(
        (doc) => !(doc.path === contextPath && doc.property === property)
      );
      conversation.lastUpdated = Date.now();
      await this.saveConversations();
    }
  }
  /**
   * Get all context documents for a conversation
   */
  async getContextDocuments(file) {
    await this.initializePromise;
    const conversation = this.getConversation(file);
    return conversation.contextDocuments || [];
  }
  /**
   * Clear all context documents for a conversation
   */
  async clearContextDocuments(file) {
    const conversation = this.getConversation(file);
    conversation.contextDocuments = [];
    conversation.lastUpdated = Date.now();
    await this.saveConversations();
  }
  /**
   * Update context documents (replace entire list)
   */
  async setContextDocuments(file, documents) {
    const conversation = this.getConversation(file);
    conversation.contextDocuments = documents;
    conversation.lastUpdated = Date.now();
    await this.saveConversations();
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance - ensures we get the editor for the active file
   */
  getActiveEditor() {
    const activeFile = this.getActiveFile();
    if (!activeFile) {
      return null;
    }
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    for (const leaf of leaves) {
      const view2 = leaf.view;
      if (view2 instanceof import_obsidian14.MarkdownView && view2.file === activeFile) {
        return view2.editor;
      }
    }
    const activeEditor = this.app.workspace.activeEditor;
    if ((activeEditor == null ? void 0 : activeEditor.editor) && activeEditor.file === activeFile) {
      return activeEditor.editor;
    }
    const view = this.app.workspace.getActiveViewOfType(import_obsidian14.MarkdownView);
    if (view && view.file === activeFile) {
      return view.editor;
    }
    return null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Set the cursor position (optionally focus the editor)
   */
  setCursorPosition(position, shouldFocus = false) {
    const editor = this.getActiveEditor();
    if (!editor) return;
    editor.setCursor(position);
    if (shouldFocus) {
      editor.focus();
    }
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at cursor location
   */
  async deleteContent(target) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
  /**
   * Replace selected text with new content
   * Handles undo/redo properly and preserves cursor position
   */
  async replaceSelection(newText, from, to) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "replace"
      };
    }
    try {
      const fromPos = from || editor.getCursor("from");
      const toPos = to || editor.getCursor("to");
      editor.replaceRange(newText, fromPos, toPos);
      const newCursorPos = {
        line: fromPos.line + (newText.split("\n").length - 1),
        ch: newText.includes("\n") ? newText.split("\n").pop().length : fromPos.ch + newText.length
      };
      editor.setCursor(newCursorPos);
      editor.focus();
      return {
        success: true,
        content: newText,
        appliedAt: fromPos,
        editType: "replace"
      };
    } catch (error) {
      console.error("Error replacing selection:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor(settings) {
    var _a, _b, _c, _d;
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: (_b = (_a = settings == null ? void 0 : settings.general) == null ? void 0 : _a.defaultTemperature) != null ? _b : 0.7,
      maxTokens: (_d = (_c = settings == null ? void 0 : settings.general) == null ? void 0 : _c.defaultMaxTokens) != null ? _d : 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents at their cursor position. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Work at the user's cursor position - every edit happens where they are focused
- Do not add headers unless specifically requested
- Focus on the user's immediate editing context`;
    const actionSpecificPrompts = {
      "add": `

ACTION: ADD CONTENT
- Generate EXACTLY what the user requested - follow their instruction literally
- Do NOT create content related to the document theme unless specifically asked
- Focus on the user's specific request, not the document's existing content
- Match basic formatting style but prioritize the user's exact request`,
      "edit": `

ACTION: EDIT CONTENT  
- Improve, modify, or enhance the specified content
- Preserve the original intent while following user instructions
- Apply style, tone, or structural changes as requested`,
      "delete": `

ACTION: DELETE CONTENT
- Confirm what should be deleted by providing the exact text to remove
- Be precise about deletion boundaries
- Respond "CONFIRMED" if the deletion is clear`,
      "grammar": `

ACTION: GRAMMAR & SPELLING
- Fix grammar, spelling, and punctuation errors
- Improve clarity while preserving meaning
- Maintain the original tone and style`,
      "rewrite": `

ACTION: REWRITE CONTENT
- Generate alternative content that serves the same purpose
- Apply requested style, tone, or structural changes
- Create fresh content while maintaining core meaning`,
      "metadata": `

ACTION: UPDATE METADATA
- Modify frontmatter properties, tags, or document metadata
- Return ONLY a JSON object with the properties to update
- For tags, return as an array: {"tags": ["tag1", "tag2"]}
- For other properties: {"title": "New Title", "author": "Name"}
- Do NOT include properties that shouldn't be changed
- Do NOT return any explanatory text, ONLY the JSON object`
    };
    return basePrompt + (actionSpecificPrompts[action] || "");
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += `DOCUMENT STRUCTURE:
`;
      const structure = this.buildDocumentStructure(documentContext.headings);
      context += structure + "\n";
    }
    context += this.buildTargetContext(command, documentContext);
    if (conversationContext && config.includeHistory) {
      context += `
CONVERSATION CONTEXT:
${conversationContext}
`;
    }
    if (command.action === "add" && command.target === "cursor") {
      if (documentContext.surroundingLines) {
        const before = documentContext.surroundingLines.before.slice(-3).join("\n");
        const after = documentContext.surroundingLines.after.slice(0, 3).join("\n");
        context += `
LOCAL CONTEXT (for style reference only):
Before cursor:
${before}

After cursor:
${after}
`;
      }
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}
`;
    }
    return context;
  }
  /**
   * Build target-specific context
   */
  buildTargetContext(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return `
SELECTED TEXT:
${documentContext.selectedText}
`;
        }
        return `
No text currently selected.
`;
      case "cursor":
        if (documentContext.surroundingLines) {
          const context = `
CURSOR CONTEXT:
`;
          const before = documentContext.surroundingLines.before.join("\n");
          const after = documentContext.surroundingLines.after.join("\n");
          return context + `Before cursor:
${before}

After cursor:
${after}
`;
        }
        return `
Cursor position context not available.
`;
      case "document":
        return `
Targeting entire document.
`;
      case "end":
        return `
Targeting end of document.
`;
      default:
        return `
Working at cursor position.
`;
    }
  }
  /**
   * Build user prompt with instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = contextInfo;
    prompt2 += `
USER REQUEST: ${command.instruction}
`;
    if (command.context) {
      prompt2 += `ADDITIONAL REQUIREMENTS: ${command.context}
`;
    }
    prompt2 += this.getFocusInstructions(command);
    prompt2 += this.getOutputInstructions(command);
    return prompt2;
  }
  /**
   * Get focus instructions based on target
   */
  getFocusInstructions(command) {
    const actionGuidance = {
      "add": "Add new content",
      "edit": "Modify existing content",
      "delete": "Remove specified content",
      "rewrite": "Generate alternative content",
      "grammar": "Fix grammar and spelling",
      "metadata": "Update document metadata"
    };
    switch (command.target) {
      case "selection":
        return `
FOCUS: ${actionGuidance[command.action]} in the selected text.
`;
      case "cursor":
        return `
FOCUS: ${actionGuidance[command.action]} at the current cursor position.
`;
      case "document":
        return `
FOCUS: ${actionGuidance[command.action]} for the entire document.
`;
      case "end":
        return `
FOCUS: Add content at the very end of the document, after all existing content. Ensure it flows naturally.
`;
      default:
        return `
FOCUS: ${actionGuidance[command.action]} at the cursor position.
`;
    }
  }
  /**
   * Get output instructions based on action
   */
  getOutputInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide the corrected version with proper grammar and spelling.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return "OUTPUT: Provide the updated metadata in proper YAML format.";
      default:
        return "OUTPUT: Provide only the requested content changes.";
    }
  }
  /**
   * Build document structure from headings
   */
  buildDocumentStructure(headings) {
    return headings.map((heading) => {
      const indent = "  ".repeat(heading.level - 1);
      return `${indent}- ${heading.text}`;
    }).join("\n");
  }
  /**
   * Validate generated prompt
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    if (prompt2.userPrompt.length > 1e4) {
      issues.push("User prompt is too long (>10000 characters)");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document"]
  },
  {
    action: "metadata",
    patterns: [
      // Tag-specific patterns with colon format (highest priority)
      /^(add|set|update|remove)\s+tags?:/i,
      // Tag optimization patterns
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i,
      /^add tags$/i,
      // Simple "add tags" for AI suggestions
      // General metadata patterns
      /\b(update|set|change|modify)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      // Tag-specific patterns that exclude content/text/section
      /\b(add|remove|update)\s+(?!.*\b(content|text|section|paragraph|about)\b).*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include|append|prepend)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert|append|prepend)\b(?!\s+.*\b(better|clearer|more|less|tags?|property|properties|metadata|frontmatter)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i,
      // Specific patterns for append/prepend with location
      /\b(append|add)\b.*\b(after|following)\b/i,
      /\b(prepend|add)\b.*\b(before|preceding)\b/i
    ],
    targets: ["end"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection"]
  }
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const context = this.extractContext(input);
    return {
      action,
      target,
      instruction: input,
      // Keep original input for display
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input (simplified for cursor-only editing)
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return "cursor";
      // Changed from 'end' to 'cursor' for cursor-only editing
      case "edit":
        return hasSelection ? "selection" : "cursor";
      case "delete":
        return hasSelection ? "selection" : "cursor";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return hasSelection ? "selection" : "cursor";
      // Changed from 'end' to support cursor-only
      case "metadata":
        return "document";
      default:
        return "cursor";
    }
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add content at cursor",
        "Fix grammar in this document",
        "Add conclusion at end",
        "Create a summary"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new content";
        break;
      case "metadata":
        description = "Update document metadata";
        break;
    }
    switch (target) {
      case "selection":
        description += " in selected text";
        break;
      case "cursor":
        description += " at cursor position";
        break;
      case "document":
        description += " in entire document";
        break;
      case "end":
        description += " at end of document";
        break;
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const lowerMessage = message.toLowerCase().trim();
    if (lowerMessage.startsWith(":")) {
      return true;
    }
    const actionVerbs = [
      "add",
      "insert",
      "append",
      "prepend",
      "include",
      "create",
      "write",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "replace",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "drop",
      "fix",
      "correct",
      "proofread",
      "polish",
      "check",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const startsWithAction = actionVerbs.some((verb) => {
      const verbPattern = new RegExp(`^${verb}\\b`, "i");
      return verbPattern.test(lowerMessage);
    });
    if (startsWithAction) {
      const questionIndicators = [
        /^(how|what|why|when|where|which|who|can|could|should|would|will|is|are|am|do|does|did)/i,
        /\?/,
        // Contains question mark
        /\b(help|advice|suggest|recommend|think|opinion)\b/i
      ];
      const isQuestion = questionIndicators.some((pattern) => pattern.test(lowerMessage));
      if (isQuestion) {
        return false;
      }
      return true;
    }
    const explicitCommandPatterns = [
      // Grammar/spelling commands that don't start with action verbs
      /\b(grammar|spell|spelling|proofread|polish)\b.*\b(check|fix|correct)\b/i,
      // Metadata commands with different structures
      /\bset\s+(the\s+)?(title|tags|metadata|properties)/i,
      /\bupdate\s+(the\s+)?(title|tags|metadata|properties)/i,
      // Tag-specific patterns
      /^(add|set|update|remove)\s+tags?:/i,
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i
    ];
    for (const pattern of explicitCommandPatterns) {
      if (pattern.test(lowerMessage)) {
        return true;
      }
    }
    return false;
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Key capabilities:
- Answer questions about documents and content
- Provide writing assistance and suggestions
- Help with research and analysis
- Engage in natural conversation about the user's work

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional
- Reference document context when relevant`;
    let userPrompt = `USER REQUEST: ${message}`;
    if (documentContext && file) {
      userPrompt = `Current document: ${documentContext.filename}

${userPrompt}`;
    }
    if (recentHistory.length > 0) {
      const historyString = this.formatConversationHistory(recentHistory);
      userPrompt = `RECENT CONVERSATION:
${historyString}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: (documentContext == null ? void 0 : documentContext.content) || "",
      config: {
        temperature: options.temperature || 0.7,
        maxTokens: options.maxTokens || 2e3
      }
    };
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional`;
    let userPrompt = `USER REQUEST: ${instruction}`;
    if (context) {
      userPrompt = `Context: ${context}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 2e3
      }
    };
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Simple token count estimation
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "insert"
            };
          }
          result = await this.applyAddition(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Apply addition based on command target
   */
  async applyAddition(command, documentContext, content) {
    switch (command.target) {
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return await this.documentEngine.applyEdit(
            content,
            "cursor",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        }
      default:
        return {
          success: false,
          error: `Invalid add target: ${command.target}`,
          editType: "insert"
        };
    }
  }
  /**
   * Validate add command
   */
  validateCommand(command) {
    if (command.action !== "add") {
      return {
        valid: false,
        error: "Command action must be add"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Add instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute add command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "insert"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "insert",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "insert"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyEdit(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for editing",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid edit target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to edit"
      };
    }
    if (command.action !== "edit") {
      return {
        valid: false,
        error: "Command action must be edit"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Edit instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute edit command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      const result = await this.applyDeletion(command, documentContext);
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "cursor":
        return await this.documentEngine.deleteContent("line");
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end - use cursor or selection instead",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: `Invalid delete target: ${command.target}`,
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to delete"
      };
    }
    if (command.action !== "delete") {
      return {
        valid: false,
        error: "Command action must be delete"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyGrammarFix(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar fix based on command target
   */
  async applyGrammarFix(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for grammar correction",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "cursor":
        return {
          success: false,
          error: 'Please select text to correct grammar, or use "document" to fix entire document',
          editType: "replace"
        };
      case "end":
        return {
          success: false,
          error: 'Grammar correction requires selecting text or specifying "document"',
          editType: "replace"
        };
      default:
        return {
          success: false,
          error: `Invalid grammar target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command
   */
  validateCommand(command, hasSelection) {
    if (command.action !== "grammar") {
      return {
        valid: false,
        error: "Command action must be grammar"
      };
    }
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to correct grammar"
      };
    }
    if (command.target !== "selection" && command.target !== "document") {
      return {
        valid: false,
        error: "Grammar correction requires selecting text or targeting entire document"
      };
    }
    return { valid: true };
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyRewrite(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, content) {
    switch (command.target) {
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for rewriting",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid rewrite target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command
   */
  validateCommand(command) {
    if (command.action !== "rewrite") {
      return {
        valid: false,
        error: "Command action must be rewrite"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Rewrite instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const tagResult = await this.handleDirectTagOperation(command.instruction, documentContext);
      if (tagResult) {
        return tagResult;
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        console.error("Failed to parse metadata updates. AI response:", aiResponse);
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      console.log("Metadata updates:", updates);
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      const successMessage = this.generateSuccessMessage(updates);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
  /**
   * Handle direct tag operations (add, remove, set tags)
   */
  async handleDirectTagOperation(instruction, documentContext) {
    const lowerInstruction = instruction.toLowerCase().trim();
    const colonMatch = lowerInstruction.match(/^(add|set|update|remove)\s+tags?:\s*(.*)$/);
    if (colonMatch) {
      const action = colonMatch[1];
      const tagString = colonMatch[2];
      const newTags = tagString ? tagString.split(",").map((t) => t.trim()).filter((t) => t) : [];
      if (action === "add" && newTags.length === 0) {
        return await this.handleAITagOperation("add suggested tags", documentContext);
      }
      const currentTags = this.getCurrentTags(documentContext.content);
      let updatedTags = [];
      let message = "";
      switch (action) {
        case "add":
          const tagsToAdd = newTags.filter(
            (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
          );
          updatedTags = [...currentTags, ...tagsToAdd];
          message = tagsToAdd.length > 0 ? `Added ${tagsToAdd.length} tag${tagsToAdd.length !== 1 ? "s" : ""}: ${tagsToAdd.join(", ")}` : "No new tags to add (duplicates filtered)";
          break;
        case "remove":
          const lowerNewTags = newTags.map((t) => t.toLowerCase());
          const beforeCount = currentTags.length;
          updatedTags = currentTags.filter(
            (tag) => !lowerNewTags.includes(tag.toLowerCase())
          );
          const removedCount = beforeCount - updatedTags.length;
          message = removedCount > 0 ? `Removed ${removedCount} tag${removedCount !== 1 ? "s" : ""}` : "No tags found to remove";
          break;
        case "set":
        case "update":
          updatedTags = [...new Set(newTags.map((t) => t.toLowerCase()))];
          message = `Set ${updatedTags.length} tag${updatedTags.length !== 1 ? "s" : ""}`;
          break;
      }
      const updates = { tags: updatedTags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    }
    if (/\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i.test(lowerInstruction) || /\b(suggest|recommend)\s+.*\btags?\b/i.test(lowerInstruction) || /^add suggested tags$/i.test(lowerInstruction) || /^add tags$/i.test(lowerInstruction) || // Handle simple "add tags" as AI suggestion
    /^update tags$/i.test(lowerInstruction)) {
      return await this.handleAITagOperation(instruction, documentContext);
    }
    return null;
  }
  /**
   * Handle AI-powered tag operations (suggest, optimize, clean up)
   */
  async handleAITagOperation(instruction, documentContext) {
    const currentTags = this.getCurrentTags(documentContext.content);
    const systemPrompt = `You are an expert at document tagging and metadata organization. Your task is to analyze documents and provide optimal tags.

Rules for tags:
- Tags should be lowercase
- Use hyphens for multi-word tags (e.g., "machine-learning")
- Be specific but not overly granular
- Aim for 5-10 tags per document
- Focus on key concepts, topics, and themes FROM THE ACTUAL DOCUMENT CONTENT
- Tags must be directly relevant to the document's subject matter
- Avoid generic tags like "document" or "text"
- Consider the document's purpose, audience, and main topics
- Extract tags based on the document's actual content, not random topics

IMPORTANT: Base your tag suggestions ONLY on the content provided. Do not invent unrelated tags.

Return ONLY a JSON object with a "tags" array and a "reasoning" field explaining your choices.`;
    let userPrompt = "";
    if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
      userPrompt = `Carefully analyze the following document and suggest relevant tags based on its actual content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Based on the above document content, suggest additional tags that:
1. Reflect the actual topics discussed in the document
2. Capture key concepts, technologies, or themes mentioned
3. Would help with discoverability and organization
4. Are directly relevant to what this document is about

DO NOT suggest tags about topics not mentioned in the document.`;
    } else if (/clean up|cleanup/i.test(instruction)) {
      userPrompt = `Clean up and optimize the tags for this document by analyzing both the current tags and the document content.

Current tags: ${currentTags.join(", ")}

DOCUMENT CONTENT:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Remove duplicate or redundant tags
2. Consolidate similar tags (e.g., "js" and "javascript")
3. Remove tags that aren't relevant to the document content
4. Standardize tag format (lowercase, hyphenated)
5. Ensure remaining tags accurately reflect the document

Provide a cleaned-up tag list based on the actual document content.`;
    } else if (/optimize|improve|review|analyze|update/i.test(instruction)) {
      userPrompt = `Analyze this document thoroughly and provide an optimized set of tags that accurately represents its content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Review the document content carefully
2. Remove any tags that aren't relevant to the actual content
3. Add tags for important concepts, topics, or themes that are missing
4. Ensure all tags directly relate to what's discussed in the document
5. Aim for 5-10 highly relevant tags

Provide an optimized tag list that best represents THIS SPECIFIC document's content.`;
    }
    try {
      const defaultMaxTokens = this.providerManager.getDefaultMaxTokens();
      const aiResponse = await this.providerManager.complete(systemPrompt, userPrompt, {
        temperature: 0.3,
        maxTokens: defaultMaxTokens
      });
      const parsed = this.parseAITagResponse(aiResponse);
      if (!parsed || !parsed.tags || parsed.tags.length === 0) {
        const preview = aiResponse.length > 100 ? aiResponse.substring(0, 100) + "..." : aiResponse;
        return {
          success: false,
          error: `Could not parse AI tag suggestions. AI response: "${preview}"`,
          editType: "replace"
        };
      }
      const updates = { tags: parsed.tags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      let message = "";
      if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
        const addedTags = parsed.tags.filter(
          (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
        );
        message = `Added ${addedTags.length} suggested tag${addedTags.length !== 1 ? "s" : ""}: ${addedTags.join(", ")}`;
      } else if (/clean up|cleanup/i.test(instruction)) {
        message = `Cleaned up tags: ${currentTags.length} \u2192 ${parsed.tags.length} tags`;
      } else {
        message = `Optimized tags: ${parsed.tags.length} tag${parsed.tags.length !== 1 ? "s" : ""} (was ${currentTags.length})`;
      }
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to process tag operation: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Get current tags from document content
   */
  getCurrentTags(content) {
    if (!content) return [];
    const lines = content.split("\n");
    if (lines.length > 0 && lines[0] === "---") {
      let inFrontmatter = true;
      for (let i = 1; i < lines.length && inFrontmatter; i++) {
        if (lines[i] === "---") {
          break;
        }
        const tagMatch = lines[i].match(/^tags:\s*(.*)$/);
        if (tagMatch) {
          const tagValue = tagMatch[1].trim();
          if (!tagValue) return [];
          try {
            const parsed = JSON.parse(tagValue);
            if (Array.isArray(parsed)) {
              return parsed.filter((t) => t);
            }
          } catch (e) {
            return tagValue.split(",").map((t) => t.trim()).filter((t) => t);
          }
        }
      }
    }
    return [];
  }
  /**
   * Parse AI response for tag operations
   */
  parseAITagResponse(response) {
    try {
      const cleanResponse = response.trim();
      const jsonMatch = cleanResponse.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        try {
          const parsed = JSON.parse(jsonMatch[0]);
          if (parsed.tags && Array.isArray(parsed.tags)) {
            return {
              tags: parsed.tags.map((t) => String(t).toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t),
              reasoning: parsed.reasoning
            };
          }
        } catch (e) {
        }
      }
      const patterns = [
        // JSON array: tags: ["tag1", "tag2"]
        /tags?:\s*\[([^\]]+)\]/i,
        // Comma list: Tags: tag1, tag2, tag3
        /tags?:\s*([^\n]+?)(?:\n|$)/i,
        // Bullet list: - tag1\n- tag2
        /(?:tags?:)?\s*(?:\n)?(\s*[-•*]\s*.+(?:\n\s*[-•*]\s*.+)*)/i
      ];
      for (const pattern of patterns) {
        const match = cleanResponse.match(pattern);
        if (match) {
          let tagString = match[1];
          let tags = [];
          if (tagString.includes("-") || tagString.includes("\u2022") || tagString.includes("*")) {
            tags = tagString.split(/\n/).map((line) => line.replace(/^\s*[-•*]\s*/, "").trim()).filter((t) => t);
          } else {
            tags = tagString.split(",").map((t) => t.trim().replace(/["']/g, "")).filter((t) => t);
          }
          if (tags.length > 0) {
            return {
              tags: tags.map((t) => t.toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t)
            };
          }
        }
      }
      const suggestMatch = cleanResponse.match(/(?:suggest|recommend|propose|here are|tags are)[:\s]+([^.]+)/i);
      if (suggestMatch) {
        const tags = suggestMatch[1].split(/[,\n]/).map((t) => t.trim().replace(/["']/g, "").replace(/^and\s+/i, "")).filter((t) => t);
        if (tags.length > 0) {
          return {
            tags: tags.map((t) => t.toLowerCase().trim()).filter((t) => t)
          };
        }
      }
      const lines = cleanResponse.split("\n").map((line) => line.trim()).filter((line) => line);
      const validTags = lines.filter((line) => {
        return line.length > 0 && line.length < 50 && !line.includes(":") && !line.toLowerCase().includes("tag") && !line.toLowerCase().includes("here") && !line.toLowerCase().includes("suggest");
      }).map((line) => {
        return line.toLowerCase().replace(/^[-•*#]\s*/, "").replace(/^\d+\.\s*/, "").trim().replace(/\s+/g, "-");
      }).filter((tag) => tag);
      if (validTags.length > 0) {
        return { tags: validTags };
      }
      console.error("Failed to parse AI tag response:", cleanResponse);
      return null;
    } catch (error) {
      console.error("Error parsing AI tag response:", error, "Response was:", response);
      return null;
    }
  }
  /**
   * Generate success message based on updates
   */
  generateSuccessMessage(updates) {
    const keys = Object.keys(updates);
    if (keys.length === 0) return "Metadata updated";
    if (keys.length === 1) {
      const key = keys[0];
      if (key === "tags") {
        const count = Array.isArray(updates.tags) ? updates.tags.length : 0;
        return `Updated tags (${count} tag${count !== 1 ? "s" : ""})`;
      }
      return `Updated ${key}`;
    }
    return `Updated ${keys.length} properties`;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Commands (unified) - 2 month early access
  "commands": {
    supernovaDate: "2025-07-31",
    // Supernova early access
    generalDate: "2025-09-30",
    // General availability 
    description: "Command system with : triggers, command button, and custom commands"
  },
  // Auto-growing input - 1 month early access
  "auto-input": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-07-15",
    // 1 month later
    description: "Auto-growing input area with smooth transitions"
  },
  // Enhanced provider management - 2 month early access
  "enhanced-providers": {
    supernovaDate: "2025-06-15",
    // Launch day
    generalDate: "2025-08-15",
    // 2 months later
    description: "Advanced provider configuration and switching"
  }
};
var CORE_FEATURES = {
  "basic_editing": {
    description: "Basic document editing commands (add, edit, delete, grammar, rewrite)"
  },
  "all_ai_providers": {
    description: "Access to all AI providers (Claude, OpenAI, Google, Ollama)"
  },
  "file_conversations": {
    description: "File-scoped conversation history"
  },
  "provider_switching": {
    description: "Switch AI providers directly in chat interface"
  },
  "mobile_access": {
    description: "Full mobile device support"
  },
  "api_key_config": {
    description: "Configure your own API keys"
  },
  "sidebar_chat": {
    description: "Chat interface in sidebar"
  },
  "document_context": {
    description: "Current document context in conversations"
  },
  "multi-doc-context": {
    description: "Reference other documents with [[doc]] syntax"
  }
};

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      this.debugSettings = debugSettings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize all feature flags
   * Core features are always enabled
   * Time-gated features depend on current date and Supernova status
   */
  initializeFeatureFlags() {
    Object.entries(CORE_FEATURES).forEach(([key, config]) => {
      this.registerFeature({
        key,
        enabled: true,
        description: config.description
      });
    });
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    if (now >= generalDate) {
      return true;
    }
    if (this.getIsSupernova() && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if a feature is enabled
   */
  isFeatureEnabled(featureKey) {
    var _a;
    if (this.isLegacyFeatureKey(featureKey)) {
      return true;
    }
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check if this is a legacy feature key that should always be enabled
   */
  isLegacyFeatureKey(key) {
    const legacyKeys = [
      "basic_editing",
      "local_ai_providers",
      "file_conversations",
      "single_cloud_provider",
      "unlimited_cloud_ai",
      "provider_switching",
      "mobile_access",
      "advanced_templates",
      "batch_operations",
      "cross_document_context",
      "priority_support"
    ];
    return legacyKeys.includes(key);
  }
  /**
   * Check feature access with detailed result
   */
  checkFeatureAccess(featureKey) {
    if (this.isLegacyFeatureKey(featureKey)) {
      return { allowed: true };
    }
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    this.debugSettings = settings;
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    const encoder = new TextEncoder();
    const keyData = encoder.encode(this.SECRET_KEY);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// src/core/intent-detector.ts
var IntentDetector = class {
  constructor() {
    this.consultationPatterns = [
      { pattern: /^(Now is|Today|This week|Lately|Currently|These days)/i, name: "temporal" },
      { pattern: /\b(I'm (feeling|thinking|working|trying)|I've been|I was|I feel)\b/i, name: "personal_state" },
      { pattern: /\b(reminds me|makes me think|I wonder|I'm wondering)\b/i, name: "reflective" },
      { pattern: /\b(I think|I believe|I suspect|I notice|seems like|appears|looks like)\b/i, name: "opinion_observation" },
      { pattern: /\b(might be|could be|may be|probably|perhaps|maybe)\b/i, name: "speculation" }
    ];
    this.editingPatterns = [
      { pattern: /\b(mak(e|ing)|fix|improve|change|add|remove|rewrite|edit)\b/i, name: "command_verb" },
      { pattern: /\b(this (section|paragraph|part|text|writing|better)|the writing here|here we|here needs|this is (unclear|wrong|confusing|right))\b/i, name: "document_reference" },
      { pattern: /\b(unclear|needs work|sounds wrong|too wordy|confusing)\b/i, name: "quality_assessment" },
      { pattern: /\b(at the end|in the (introduction|conclusion)|before this|after that)\b/i, name: "document_targeting" }
    ];
  }
  classifyInput(input) {
    const consultationMatches = [];
    const editingMatches = [];
    for (const { pattern, name } of this.consultationPatterns) {
      if (pattern.test(input)) {
        consultationMatches.push(name);
      }
    }
    for (const { pattern, name } of this.editingPatterns) {
      if (pattern.test(input)) {
        editingMatches.push(name);
      }
    }
    if (consultationMatches.length > 0 && editingMatches.length === 0) {
      return {
        type: "consultation",
        confidence: 0.9,
        matchedPatterns: consultationMatches
      };
    }
    if (editingMatches.length > 0 && consultationMatches.length === 0) {
      return {
        type: "editing",
        confidence: 0.9,
        matchedPatterns: editingMatches
      };
    }
    if (consultationMatches.length > 0 && editingMatches.length > 0) {
      const hasSpeculation = consultationMatches.includes("speculation") || consultationMatches.includes("opinion_observation");
      if (hasSpeculation) {
        return {
          type: "consultation",
          confidence: 0.8,
          matchedPatterns: consultationMatches
        };
      }
    }
    return {
      type: "ambiguous",
      confidence: 0.5,
      matchedPatterns: []
    };
  }
};

// src/core/ai-intent-classifier.ts
var AIIntentClassifier = class {
  constructor(providerManager) {
    this.providerManager = providerManager;
    this.intentDetector = new IntentDetector();
  }
  /**
   * Classify user input into one of three intents
   */
  async classifyIntent(userInput, hasSelection = false) {
    if (userInput.startsWith(":")) {
      return "CHAT";
    }
    return this.fallbackClassification(userInput);
  }
  /**
   * Enhanced fallback classification using IntentDetector
   */
  fallbackClassification(userInput) {
    const lowerInput = userInput.toLowerCase().trim();
    if (lowerInput.includes("?") || lowerInput.startsWith("what") || lowerInput.startsWith("why") || lowerInput.startsWith("how") || lowerInput.startsWith("when") || lowerInput.startsWith("where") || lowerInput.startsWith("who") || lowerInput.startsWith("can you") || lowerInput.startsWith("could you") || lowerInput.includes("explain") || lowerInput.includes("help me understand")) {
      return "CHAT";
    }
    const intentClassification = this.intentDetector.classifyInput(userInput);
    if (intentClassification.type === "consultation") {
      return "CHAT";
    }
    if (intentClassification.type === "editing") {
      if (this.isMetadataRelated(lowerInput)) {
        return "METADATA";
      }
      return "CONTENT";
    }
    if (this.isMetadataRelated(lowerInput)) {
      return "METADATA";
    }
    return "CONTENT";
  }
  /**
   * Helper method to check if input is metadata-related
   */
  isMetadataRelated(lowerInput) {
    return (
      // Tag-specific patterns
      /\btags?\b/i.test(lowerInput) || /\btagging\b/i.test(lowerInput) || // Property patterns
      /\b(title|author|date|status|category|categories)\b/i.test(lowerInput) || // Metadata/frontmatter patterns
      /\b(metadata|frontmatter|properties|property)\b/i.test(lowerInput) || // Common metadata actions
      /^(add|update|set|remove|clean|optimize)\s+(tags?|title|author|metadata)/i.test(lowerInput)
    );
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian15.Plugin {
  async onload() {
    try {
      await this.loadSettings();
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      this.app.workspace.onLayoutReady(async () => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
          await sidebarView.refreshProviderDropdown();
        }
      });
      (0, import_obsidian15.addIcon)("nova-star", NOVA_ICON_SVG2);
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder(this.settings);
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.aiIntentClassifier = new AIIntentClassifier(this.aiProviderManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      this.addCommand({
        id: "nova-improve-writing",
        name: "Improve Writing",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("improve", editor);
        }
      });
      this.addCommand({
        id: "nova-make-longer",
        name: "Make Longer",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("longer", editor);
        }
      });
      this.addCommand({
        id: "nova-make-shorter",
        name: "Make Shorter",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("shorter", editor);
        }
      });
      TONE_OPTIONS.forEach((tone) => {
        this.addCommand({
          id: `nova-make-${tone.id}`,
          name: `Make ${tone.label}`,
          editorCallback: async (editor) => {
            await this.handleToneCommand(tone.id, editor);
          }
        });
      });
      this.addCommand({
        id: "nova-tell-nova",
        name: "Tell Nova...",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("custom", editor);
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      this.selectionContextMenu = new SelectionContextMenu(this.app, this);
      this.selectionContextMenu.register();
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
    } catch (error) {
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    var _a, _b;
    const savedData = await this.loadData();
    console.log("\u{1F527} Nova: Loading settings...");
    console.log("\u{1F527} Saved data (full):", savedData);
    console.log("\u{1F527} Saved data platformSettings:", savedData == null ? void 0 : savedData.platformSettings);
    if ((_a = savedData == null ? void 0 : savedData.platformSettings) == null ? void 0 : _a.desktop) {
      console.log("\u{1F527} Saved desktop primaryProvider:", savedData.platformSettings.desktop.primaryProvider);
    }
    console.log("\u{1F527} Default platformSettings:", DEFAULT_SETTINGS.platformSettings);
    this.settings = Object.assign({}, DEFAULT_SETTINGS, savedData);
    if (savedData == null ? void 0 : savedData.platformSettings) {
      console.log("\u{1F527} Before merge - Default desktop selectedModel:", DEFAULT_SETTINGS.platformSettings.desktop.selectedModel);
      console.log("\u{1F527} Before merge - Saved desktop selectedModel:", (_b = savedData.platformSettings.desktop) == null ? void 0 : _b.selectedModel);
      this.settings.platformSettings = {
        desktop: Object.assign({}, DEFAULT_SETTINGS.platformSettings.desktop, savedData.platformSettings.desktop || {}),
        mobile: Object.assign({}, DEFAULT_SETTINGS.platformSettings.mobile, savedData.platformSettings.mobile || {})
      };
      console.log("\u{1F527} After merge - Final desktop selectedModel:", this.settings.platformSettings.desktop.selectedModel);
    }
    console.log("\u{1F527} Final merged platformSettings:", this.settings.platformSettings);
    console.log("\u{1F527} Current platform:", import_obsidian15.Platform.isMobile ? "mobile" : "desktop");
    console.log("\u{1F527} Selected model for current platform:", this.settings.platformSettings[import_obsidian15.Platform.isMobile ? "mobile" : "desktop"].selectedModel);
  }
  /**
   * Deep merge two objects, preserving nested structures
   */
  deepMerge(target, source) {
    if (!source) return target;
    const result = { ...target };
    for (const key in source) {
      if (source.hasOwnProperty(key)) {
        if (source[key] && typeof source[key] === "object" && !Array.isArray(source[key])) {
          result[key] = this.deepMerge(target[key] || {}, source[key]);
        } else {
          result[key] = source[key];
        }
      }
    }
    return result;
  }
  async saveSettings() {
    var _a, _b, _c, _d, _e, _f, _g, _h, _i;
    console.log("\u{1F4BE} Nova: Saving settings...");
    console.log("\u{1F4BE} Current platform:", import_obsidian15.Platform.isMobile ? "mobile" : "desktop");
    console.log("\u{1F4BE} Platform settings being saved:", this.settings.platformSettings);
    console.log("\u{1F4BE} Desktop selectedModel being saved:", this.settings.platformSettings.desktop.selectedModel);
    console.log("\u{1F4BE} Mobile selectedModel being saved:", this.settings.platformSettings.mobile.selectedModel);
    try {
      await this.saveData(this.settings);
      console.log("\u{1F4BE} First saveData() completed");
      await new Promise((resolve) => setTimeout(resolve, 200));
      await this.saveData(this.settings);
      console.log("\u{1F4BE} Second saveData() completed");
      await new Promise((resolve) => setTimeout(resolve, 200));
      const readBack = await this.loadData();
      console.log("\u{1F4BE} Verification read - Desktop selectedModel:", (_b = (_a = readBack == null ? void 0 : readBack.platformSettings) == null ? void 0 : _a.desktop) == null ? void 0 : _b.selectedModel);
      console.log("\u{1F4BE} Verification read - Mobile selectedModel:", (_d = (_c = readBack == null ? void 0 : readBack.platformSettings) == null ? void 0 : _c.mobile) == null ? void 0 : _d.selectedModel);
      const currentPlatform = import_obsidian15.Platform.isMobile ? "mobile" : "desktop";
      const expectedModel = this.settings.platformSettings[currentPlatform].selectedModel;
      const actualModel = (_f = (_e = readBack == null ? void 0 : readBack.platformSettings) == null ? void 0 : _e[currentPlatform]) == null ? void 0 : _f.selectedModel;
      if (expectedModel !== actualModel) {
        console.error("\u274C Save verification STILL failed after retry!", {
          expected: expectedModel,
          actual: actualModel,
          platform: currentPlatform
        });
        console.log("\u{1F4BE} Attempting forced save...");
        await this.saveData(JSON.parse(JSON.stringify(this.settings)));
        await new Promise((resolve) => setTimeout(resolve, 300));
        const finalCheck = await this.loadData();
        const finalActual = (_h = (_g = finalCheck == null ? void 0 : finalCheck.platformSettings) == null ? void 0 : _g[currentPlatform]) == null ? void 0 : _h.selectedModel;
        if (expectedModel === finalActual) {
          console.log("\u2705 Forced save succeeded");
        } else {
          console.error("\u274C Forced save also failed!", { finalActual });
        }
      } else {
        console.log("\u2705 Save verification successful");
      }
      (_i = this.aiProviderManager) == null ? void 0 : _i.updateSettings(this.settings);
      console.log("\u{1F4BE} Settings saved successfully");
    } catch (error) {
      console.error("\u274C Error during save operation:", error);
      throw error;
    }
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle selection-based commands
   */
  async handleSelectionCommand(actionId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian15.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction(actionId, editor, selectedText);
    } catch (error) {
      console.error("Error executing Nova selection command:", error);
      new import_obsidian15.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Handle tone-specific commands
   */
  async handleToneCommand(toneId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian15.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction("tone", editor, selectedText, toneId);
    } catch (error) {
      console.error("Error executing Nova tone command:", error);
      new import_obsidian15.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian15.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9kb2N1bWVudC1hbmFseXNpcy50cyIsICJzcmMvYWkvbW9kZWxzLnRzIiwgInNyYy91aS9pbnB1dC1oYW5kbGVyLnRzIiwgInNyYy91aS93aWtpbGluay1zdWdnZXN0LnRzIiwgInNyYy91aS9jb21tYW5kLXN5c3RlbS50cyIsICJzcmMvdWkvY29udGV4dC1tYW5hZ2VyLnRzIiwgInNyYy9haS9jb250ZXh0LWxpbWl0cy50cyIsICJzcmMvY29yZS9jb250ZXh0LWNhbGN1bGF0b3IudHMiLCAic3JjL3VpL2NoYXQtcmVuZGVyZXIudHMiLCAic3JjL3VpL3N0cmVhbWluZy1tYW5hZ2VyLnRzIiwgInNyYy91aS9zZWxlY3Rpb24tY29udGV4dC1tZW51LnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL3NlbGVjdGlvbi1lZGl0LWNvbW1hbmQudHMiLCAic3JjL3VpL3RvbmUtc2VsZWN0aW9uLW1vZGFsLnRzIiwgInNyYy91aS9jdXN0b20taW5zdHJ1Y3Rpb24tbW9kYWwudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9jbGF1ZGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vcGVuYWkudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9nb29nbGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vbGxhbWEudHMiLCAic3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvZG9jdW1lbnQtZW5naW5lLnRzIiwgInNyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyLnRzIiwgInNyYy9jb3JlL2NvbnRleHQtYnVpbGRlci50cyIsICJzcmMvY29yZS9jb21tYW5kLXBhcnNlci50cyIsICJzcmMvY29yZS9wcm9tcHQtYnVpbGRlci50cyIsICJzcmMvY29yZS9jb21tYW5kcy9hZGQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZ3JhbW1hci1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL3Jld3JpdGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9tZXRhZGF0YS1jb21tYW5kLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1jb25maWcudHMiLCAic3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXIudHMiLCAic3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvci50cyIsICJzcmMvY29yZS9pbnRlbnQtZGV0ZWN0b3IudHMiLCAic3JjL2NvcmUvYWktaW50ZW50LWNsYXNzaWZpZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgV29ya3NwYWNlTGVhZiwgSXRlbVZpZXcsIGFkZEljb24sIE5vdGljZSwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzLCBOb3ZhU2V0dGluZ1RhYiwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBOb3ZhU2lkZWJhclZpZXcsIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgfSBmcm9tICcuL3NyYy91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL3NyYy9jb3JlL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IFByb21wdEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL3Byb21wdC1idWlsZGVyJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IEFkZENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgRGVsZXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgR3JhbW1hckNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZCc7XG5pbXBvcnQgeyBSZXdyaXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kJztcbmltcG9ydCB7IE1ldGFkYXRhQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZCc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3NyYy91aS93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IFNlbGVjdGlvbkNvbnRleHRNZW51IH0gZnJvbSAnLi9zcmMvdWkvc2VsZWN0aW9uLWNvbnRleHQtbWVudSc7XG5pbXBvcnQgeyBUT05FX09QVElPTlMgfSBmcm9tICcuL3NyYy91aS90b25lLXNlbGVjdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBBSUludGVudENsYXNzaWZpZXIgfSBmcm9tICcuL3NyYy9jb3JlL2FpLWludGVudC1jbGFzc2lmaWVyJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3ZhUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBOb3ZhU2V0dGluZ3M7XG5cdGFpUHJvdmlkZXJNYW5hZ2VyITogQUlQcm92aWRlck1hbmFnZXI7XG5cdGRvY3VtZW50RW5naW5lITogRG9jdW1lbnRFbmdpbmU7XG5cdGNvbnRleHRCdWlsZGVyITogQ29udGV4dEJ1aWxkZXI7XG5cdGNvbW1hbmRQYXJzZXIhOiBDb21tYW5kUGFyc2VyO1xuXHRwcm9tcHRCdWlsZGVyITogUHJvbXB0QnVpbGRlcjtcblx0Y29udmVyc2F0aW9uTWFuYWdlciE6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG5cdGFpSW50ZW50Q2xhc3NpZmllciE6IEFJSW50ZW50Q2xhc3NpZmllcjtcblx0YWRkQ29tbWFuZEhhbmRsZXIhOiBBZGRDb21tYW5kO1xuXHRlZGl0Q29tbWFuZEhhbmRsZXIhOiBFZGl0Q29tbWFuZDtcblx0ZGVsZXRlQ29tbWFuZEhhbmRsZXIhOiBEZWxldGVDb21tYW5kO1xuXHRncmFtbWFyQ29tbWFuZEhhbmRsZXIhOiBHcmFtbWFyQ29tbWFuZDtcblx0cmV3cml0ZUNvbW1hbmRIYW5kbGVyITogUmV3cml0ZUNvbW1hbmQ7XG5cdG1ldGFkYXRhQ29tbWFuZEhhbmRsZXIhOiBNZXRhZGF0YUNvbW1hbmQ7XG5cdGZlYXR1cmVNYW5hZ2VyITogRmVhdHVyZU1hbmFnZXI7XG5cdGxpY2Vuc2VWYWxpZGF0b3IhOiBMaWNlbnNlVmFsaWRhdG9yO1xuXHRzZXR0aW5nVGFiITogTm92YVNldHRpbmdUYWI7XG5cdHNpZGViYXJWaWV3ITogTm92YVNpZGViYXJWaWV3O1xuXHRzZWxlY3Rpb25Db250ZXh0TWVudSE6IFNlbGVjdGlvbkNvbnRleHRNZW51O1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXG5cdFx0XHQvLyBJbml0aWFsaXplIGxpY2Vuc2luZyBzeXN0ZW1cblx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvciA9IG5ldyBMaWNlbnNlVmFsaWRhdG9yKCk7XG5cdFx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gbmV3IEZlYXR1cmVNYW5hZ2VyKFxuXHRcdFx0XHR0aGlzLmxpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Ncblx0XHRcdCk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBsaWNlbnNlIGZyb20gc2V0dGluZ3Ncblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVmcmVzaCBTdXBlcm5vdmEgVUkgYWZ0ZXIgbGljZW5zZSB2YWxpZGF0aW9uIHRvIGhhbmRsZSBleHBpcmVkIGxpY2Vuc2VzXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeShhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdC8vIEFsc28gcmVmcmVzaCBwcm92aWRlciBkcm9wZG93biB0byByZWZsZWN0IGxvYWRlZCBzZXR0aW5nc1xuXHRcdFx0XHRcdGF3YWl0IHNpZGViYXJWaWV3LnJlZnJlc2hQcm92aWRlckRyb3Bkb3duKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBOb3RlOiBNb2JpbGUgYWNjZXNzIHJlc3RyaWN0aW9ucyBhcmUgbm93IGhhbmRsZWQgaW4gc2lkZWJhciBVSVxuXHRcdFx0Ly8gVGhpcyBhbGxvd3MgQ29yZSBtb2JpbGUgdXNlcnMgdG8gc2VlIHRoZSB1cGdyYWRlIGludGVyZmFjZSByYXRoZXIgdGhhbiBhIGJyb2tlbiBwbHVnaW5cblxuXHRcdFx0Ly8gUmVnaXN0ZXIgY3VzdG9tIGljb25cblx0XHRcdGFkZEljb24oJ25vdmEtc3RhcicsIE5PVkFfSUNPTl9TVkcpO1xuXG5cdFx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyID0gbmV3IEFJUHJvdmlkZXJNYW5hZ2VyKHRoaXMuc2V0dGluZ3MsIHRoaXMuZmVhdHVyZU1hbmFnZXIpO1xuXHRcdFx0YXdhaXQgdGhpcy5haVByb3ZpZGVyTWFuYWdlci5pbml0aWFsaXplKCk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgY29udmVyc2F0aW9uIG1hbmFnZXIgYW5kIGRvY3VtZW50IGVuZ2luZVxuXHRcdFx0Y29uc3QgZGF0YVN0b3JlID0ge1xuXHRcdFx0XHRsb2FkRGF0YTogKGtleTogc3RyaW5nKSA9PiB0aGlzLmxvYWREYXRhV2l0aEtleShrZXkpLFxuXHRcdFx0XHRzYXZlRGF0YTogKGtleTogc3RyaW5nLCBkYXRhOiBhbnkpID0+IHRoaXMuc2F2ZURhdGFXaXRoS2V5KGtleSwgZGF0YSlcblx0XHRcdH07XG5cdFx0XHR0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuXHRcdFx0dGhpcy5kb2N1bWVudEVuZ2luZSA9IG5ldyBEb2N1bWVudEVuZ2luZSh0aGlzLmFwcCwgZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0Q29udmVyc2F0aW9uTWFuYWdlcih0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpO1xuXHRcdFx0dGhpcy5jb250ZXh0QnVpbGRlciA9IG5ldyBDb250ZXh0QnVpbGRlcih0aGlzLnNldHRpbmdzKTtcblx0XHRcdHRoaXMuY29tbWFuZFBhcnNlciA9IG5ldyBDb21tYW5kUGFyc2VyKCk7XG5cdFx0XHR0aGlzLnByb21wdEJ1aWxkZXIgPSBuZXcgUHJvbXB0QnVpbGRlcih0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpO1xuXHRcdFx0dGhpcy5haUludGVudENsYXNzaWZpZXIgPSBuZXcgQUlJbnRlbnRDbGFzc2lmaWVyKHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0XG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbW1hbmQgaW1wbGVtZW50YXRpb25zXG5cdFx0XHR0aGlzLmFkZENvbW1hbmRIYW5kbGVyID0gbmV3IEFkZENvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5lZGl0Q29tbWFuZEhhbmRsZXIgPSBuZXcgRWRpdENvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXHRcdFx0dGhpcy5kZWxldGVDb21tYW5kSGFuZGxlciA9IG5ldyBEZWxldGVDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZ3JhbW1hckNvbW1hbmRIYW5kbGVyID0gbmV3IEdyYW1tYXJDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMucmV3cml0ZUNvbW1hbmRIYW5kbGVyID0gbmV3IFJld3JpdGVDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMubWV0YWRhdGFDb21tYW5kSGFuZGxlciA9IG5ldyBNZXRhZGF0YUNvbW1hbmQodGhpcy5hcHAsIHRoaXMuZG9jdW1lbnRFbmdpbmUsIHRoaXMuY29udGV4dEJ1aWxkZXIsIHRoaXMuYWlQcm92aWRlck1hbmFnZXIpO1xuXG5cdFx0XHR0aGlzLnJlZ2lzdGVyVmlldyhcblx0XHRcdFx0VklFV19UWVBFX05PVkFfU0lERUJBUixcblx0XHRcdFx0KGxlYWYpID0+IG5ldyBOb3ZhU2lkZWJhclZpZXcobGVhZiwgdGhpcylcblx0XHRcdCk7XG5cblx0XHRcdC8vIE5vdGU6IFdpa2lsaW5rIGF1dG9jb21wbGV0ZSBpcyBub3cgaGFuZGxlZCBkaXJlY3RseSBpbiBzaWRlYmFyIHZpZXdcblxuXHRcdFx0Y29uc3QgcmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbignbm92YS1zdGFyJywgJ05vdmEgQUknLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gUmVnaXN0ZXIgc2VsZWN0aW9uLWJhc2VkIGNvbW1hbmRzXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtaW1wcm92ZS13cml0aW5nJyxcblx0XHRcdFx0bmFtZTogJ0ltcHJvdmUgV3JpdGluZycsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ2ltcHJvdmUnLCBlZGl0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLW1ha2UtbG9uZ2VyJyxcblx0XHRcdFx0bmFtZTogJ01ha2UgTG9uZ2VyJyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvcikgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlU2VsZWN0aW9uQ29tbWFuZCgnbG9uZ2VyJywgZWRpdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1tYWtlLXNob3J0ZXInLFxuXHRcdFx0XHRuYW1lOiAnTWFrZSBTaG9ydGVyJyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvcikgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlU2VsZWN0aW9uQ29tbWFuZCgnc2hvcnRlcicsIGVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBJbmRpdmlkdWFsIHRvbmUgY29tbWFuZHNcblx0XHRcdFRPTkVfT1BUSU9OUy5mb3JFYWNoKHRvbmUgPT4ge1xuXHRcdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRcdGlkOiBgbm92YS1tYWtlLSR7dG9uZS5pZH1gLFxuXHRcdFx0XHRcdG5hbWU6IGBNYWtlICR7dG9uZS5sYWJlbH1gLFxuXHRcdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlVG9uZUNvbW1hbmQodG9uZS5pZCwgZWRpdG9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS10ZWxsLW5vdmEnLFxuXHRcdFx0XHRuYW1lOiAnVGVsbCBOb3ZhLi4uJyxcblx0XHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvcikgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlU2VsZWN0aW9uQ29tbWFuZCgnY3VzdG9tJywgZWRpdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnb3Blbi1ub3ZhLXNpZGViYXInLFxuXHRcdFx0XHRuYW1lOiAnT3BlbiBzaWRlYmFyJyxcblx0XHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBzZWxlY3Rpb24gY29udGV4dCBtZW51XG5cdFx0XHR0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51ID0gbmV3IFNlbGVjdGlvbkNvbnRleHRNZW51KHRoaXMuYXBwLCB0aGlzKTtcblx0XHRcdHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUucmVnaXN0ZXIoKTtcblxuXHRcdFx0dGhpcy5zZXR0aW5nVGFiID0gbmV3IE5vdmFTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKTtcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nVGFiKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdH1cblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdHRoaXMuYWlQcm92aWRlck1hbmFnZXI/LmNsZWFudXAoKTtcblx0XHR0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXI/LmNsZWFudXAoKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHRjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQyNyBOb3ZhOiBMb2FkaW5nIHNldHRpbmdzLi4uJyk7XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQyNyBTYXZlZCBkYXRhIChmdWxsKTonLCBzYXZlZERhdGEpO1xuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMjcgU2F2ZWQgZGF0YSBwbGF0Zm9ybVNldHRpbmdzOicsIHNhdmVkRGF0YT8ucGxhdGZvcm1TZXR0aW5ncyk7XG5cdFx0XG5cdFx0aWYgKHNhdmVkRGF0YT8ucGxhdGZvcm1TZXR0aW5ncz8uZGVza3RvcCkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQyNyBTYXZlZCBkZXNrdG9wIHByaW1hcnlQcm92aWRlcjonLCBzYXZlZERhdGEucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnByaW1hcnlQcm92aWRlcik7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMjcgRGVmYXVsdCBwbGF0Zm9ybVNldHRpbmdzOicsIERFRkFVTFRfU0VUVElOR1MucGxhdGZvcm1TZXR0aW5ncyk7XG5cdFx0XG5cdFx0Ly8gVXNlIE9iamVjdC5hc3NpZ24gZm9yIHRvcCBsZXZlbCwgYnV0IG1hbnVhbGx5IG1lcmdlIHBsYXRmb3JtU2V0dGluZ3MgdG8gcHJlc2VydmUgc2F2ZWQgdmFsdWVzXG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIHNhdmVkRGF0YSk7XG5cdFx0XG5cdFx0Ly8gTWFudWFsbHkgbWVyZ2UgcGxhdGZvcm1TZXR0aW5ncyB0byBlbnN1cmUgc2F2ZWQgbW9kZWwgc2VsZWN0aW9ucyBhcmUgcHJlc2VydmVkXG5cdFx0aWYgKHNhdmVkRGF0YT8ucGxhdGZvcm1TZXR0aW5ncykge1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQyNyBCZWZvcmUgbWVyZ2UgLSBEZWZhdWx0IGRlc2t0b3Agc2VsZWN0ZWRNb2RlbDonLCBERUZBVUxUX1NFVFRJTkdTLnBsYXRmb3JtU2V0dGluZ3MuZGVza3RvcC5zZWxlY3RlZE1vZGVsKTtcblx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMjcgQmVmb3JlIG1lcmdlIC0gU2F2ZWQgZGVza3RvcCBzZWxlY3RlZE1vZGVsOicsIHNhdmVkRGF0YS5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3A/LnNlbGVjdGVkTW9kZWwpO1xuXHRcdFx0XG5cdFx0XHR0aGlzLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MgPSB7XG5cdFx0XHRcdGRlc2t0b3A6IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLCBzYXZlZERhdGEucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wIHx8IHt9KSxcblx0XHRcdFx0bW9iaWxlOiBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLnBsYXRmb3JtU2V0dGluZ3MubW9iaWxlLCBzYXZlZERhdGEucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUgfHwge30pXG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVERDI3IEFmdGVyIG1lcmdlIC0gRmluYWwgZGVza3RvcCBzZWxlY3RlZE1vZGVsOicsIHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnNlbGVjdGVkTW9kZWwpO1xuXHRcdH1cblx0XHRcblx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVERDI3IEZpbmFsIG1lcmdlZCBwbGF0Zm9ybVNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncyk7XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQyNyBDdXJyZW50IHBsYXRmb3JtOicsIFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCcpO1xuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMjcgU2VsZWN0ZWQgbW9kZWwgZm9yIGN1cnJlbnQgcGxhdGZvcm06JywgdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW1BsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCddLnNlbGVjdGVkTW9kZWwpO1xuXHR9XG5cblxuXHQvKipcblx0ICogRGVlcCBtZXJnZSB0d28gb2JqZWN0cywgcHJlc2VydmluZyBuZXN0ZWQgc3RydWN0dXJlc1xuXHQgKi9cblx0cHJpdmF0ZSBkZWVwTWVyZ2UodGFyZ2V0OiBhbnksIHNvdXJjZTogYW55KTogYW55IHtcblx0XHRpZiAoIXNvdXJjZSkgcmV0dXJuIHRhcmdldDtcblx0XHRcblx0XHRjb25zdCByZXN1bHQgPSB7IC4uLnRhcmdldCB9O1xuXHRcdFxuXHRcdGZvciAoY29uc3Qga2V5IGluIHNvdXJjZSkge1xuXHRcdFx0aWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdGlmIChzb3VyY2Vba2V5XSAmJiB0eXBlb2Ygc291cmNlW2tleV0gPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHNvdXJjZVtrZXldKSkge1xuXHRcdFx0XHRcdHJlc3VsdFtrZXldID0gdGhpcy5kZWVwTWVyZ2UodGFyZ2V0W2tleV0gfHwge30sIHNvdXJjZVtrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXN1bHRba2V5XSA9IHNvdXJjZVtrZXldO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1RENCRSBOb3ZhOiBTYXZpbmcgc2V0dGluZ3MuLi4nKTtcblx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVEQ0JFIEN1cnJlbnQgcGxhdGZvcm06JywgUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJyk7XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1RENCRSBQbGF0Zm9ybSBzZXR0aW5ncyBiZWluZyBzYXZlZDonLCB0aGlzLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3MpO1xuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURDQkUgRGVza3RvcCBzZWxlY3RlZE1vZGVsIGJlaW5nIHNhdmVkOicsIHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5kZXNrdG9wLnNlbGVjdGVkTW9kZWwpO1xuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURDQkUgTW9iaWxlIHNlbGVjdGVkTW9kZWwgYmVpbmcgc2F2ZWQ6JywgdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5zZWxlY3RlZE1vZGVsKTtcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gRm9yY2Ugc2F2ZSBtdWx0aXBsZSB0aW1lcyB0byBlbnN1cmUgaXQgcGVyc2lzdHNcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVEQ0JFIEZpcnN0IHNhdmVEYXRhKCkgY29tcGxldGVkJyk7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBkZWxheSBhbmQgdHJ5IGFnYWluXG5cdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwKSk7XG5cdFx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1RENCRSBTZWNvbmQgc2F2ZURhdGEoKSBjb21wbGV0ZWQnKTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGFub3RoZXIgZGVsYXkgYW5kIHZlcmlmeVxuXHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMCkpO1xuXHRcdFx0XG5cdFx0XHQvLyBWZXJpZnkgdGhlIHNhdmUgYnkgcmVhZGluZyBpdCBiYWNrXG5cdFx0XHRjb25zdCByZWFkQmFjayA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcblx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURDQkUgVmVyaWZpY2F0aW9uIHJlYWQgLSBEZXNrdG9wIHNlbGVjdGVkTW9kZWw6JywgcmVhZEJhY2s/LnBsYXRmb3JtU2V0dGluZ3M/LmRlc2t0b3A/LnNlbGVjdGVkTW9kZWwpO1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1RENCRSBWZXJpZmljYXRpb24gcmVhZCAtIE1vYmlsZSBzZWxlY3RlZE1vZGVsOicsIHJlYWRCYWNrPy5wbGF0Zm9ybVNldHRpbmdzPy5tb2JpbGU/LnNlbGVjdGVkTW9kZWwpO1xuXHRcdFx0XG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgc2F2ZSBhY3R1YWxseSB3b3JrZWRcblx0XHRcdGNvbnN0IGN1cnJlbnRQbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0XHRjb25zdCBleHBlY3RlZE1vZGVsID0gdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW2N1cnJlbnRQbGF0Zm9ybV0uc2VsZWN0ZWRNb2RlbDtcblx0XHRcdGNvbnN0IGFjdHVhbE1vZGVsID0gcmVhZEJhY2s/LnBsYXRmb3JtU2V0dGluZ3M/LltjdXJyZW50UGxhdGZvcm1dPy5zZWxlY3RlZE1vZGVsO1xuXHRcdFx0XG5cdFx0XHRpZiAoZXhwZWN0ZWRNb2RlbCAhPT0gYWN0dWFsTW9kZWwpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignXHUyNzRDIFNhdmUgdmVyaWZpY2F0aW9uIFNUSUxMIGZhaWxlZCBhZnRlciByZXRyeSEnLCB7XG5cdFx0XHRcdFx0ZXhwZWN0ZWQ6IGV4cGVjdGVkTW9kZWwsXG5cdFx0XHRcdFx0YWN0dWFsOiBhY3R1YWxNb2RlbCxcblx0XHRcdFx0XHRwbGF0Zm9ybTogY3VycmVudFBsYXRmb3JtXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVHJ5IG9uZSBtb3JlIHRpbWUgd2l0aCBtYW51YWwgZmlsZSB3cml0ZVxuXHRcdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVEQ0JFIEF0dGVtcHRpbmcgZm9yY2VkIHNhdmUuLi4nKTtcblx0XHRcdFx0YXdhaXQgdGhpcy5zYXZlRGF0YShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuc2V0dGluZ3MpKSk7XG5cdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAzMDApKTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnN0IGZpbmFsQ2hlY2sgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG5cdFx0XHRcdGNvbnN0IGZpbmFsQWN0dWFsID0gZmluYWxDaGVjaz8ucGxhdGZvcm1TZXR0aW5ncz8uW2N1cnJlbnRQbGF0Zm9ybV0/LnNlbGVjdGVkTW9kZWw7XG5cdFx0XHRcdGlmIChleHBlY3RlZE1vZGVsID09PSBmaW5hbEFjdHVhbCkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdcdTI3MDUgRm9yY2VkIHNhdmUgc3VjY2VlZGVkJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcignXHUyNzRDIEZvcmNlZCBzYXZlIGFsc28gZmFpbGVkIScsIHsgZmluYWxBY3R1YWwgfSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdcdTI3MDUgU2F2ZSB2ZXJpZmljYXRpb24gc3VjY2Vzc2Z1bCcpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcblx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURDQkUgU2V0dGluZ3Mgc2F2ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ1x1Mjc0QyBFcnJvciBkdXJpbmcgc2F2ZSBvcGVyYXRpb246JywgZXJyb3IpO1xuXHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgYWN0aXZhdGVWaWV3KCkge1xuXHRcdGNvbnN0IHsgd29ya3NwYWNlIH0gPSB0aGlzLmFwcDtcblxuXHRcdGxldCBsZWFmOiBXb3Jrc3BhY2VMZWFmIHwgbnVsbDtcblx0XHRjb25zdCBsZWF2ZXMgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXG5cdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRsZWFmID0gbGVhdmVzWzBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XG5cdFx0XHRhd2FpdCBsZWFmPy5zZXRWaWV3U3RhdGUoeyB0eXBlOiBWSUVXX1RZUEVfTk9WQV9TSURFQkFSLCBhY3RpdmU6IHRydWUgfSk7XG5cdFx0fVxuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZiEpO1xuXHRcdFxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSB0byBzaWRlYmFyIHZpZXdcblx0XHRpZiAobGVhZj8udmlldyBpbnN0YW5jZW9mIE5vdmFTaWRlYmFyVmlldykge1xuXHRcdFx0dGhpcy5zaWRlYmFyVmlldyA9IGxlYWYudmlldztcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHNlbGVjdGlvbi1iYXNlZCBjb21tYW5kc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVTZWxlY3Rpb25Db21tYW5kKGFjdGlvbklkOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdGlmICghc2VsZWN0ZWRUZXh0IHx8IHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ1BsZWFzZSBzZWxlY3Qgc29tZSB0ZXh0IGZpcnN0Jyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0YXdhaXQgdGhpcy5zZWxlY3Rpb25Db250ZXh0TWVudS5oYW5kbGVTZWxlY3Rpb25BY3Rpb24oYWN0aW9uSWQsIGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIE5vdmEgc2VsZWN0aW9uIGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0bmV3IE5vdGljZSgnRmFpbGVkIHRvIGV4ZWN1dGUgTm92YSBhY3Rpb24uIFBsZWFzZSB0cnkgYWdhaW4uJywgMzAwMCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSB0b25lLXNwZWNpZmljIGNvbW1hbmRzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVRvbmVDb21tYW5kKHRvbmVJZDogc3RyaW5nLCBlZGl0b3I6IEVkaXRvcik6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBzZWxlY3RlZFRleHQgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG5cdFx0XHRpZiAoIXNlbGVjdGVkVGV4dCB8fCBzZWxlY3RlZFRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdQbGVhc2Ugc2VsZWN0IHNvbWUgdGV4dCBmaXJzdCcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhbGwgaGFuZGxlU2VsZWN0aW9uQWN0aW9uIHdpdGggdG9uZSBhY3Rpb24gYW5kIHRoZSBzcGVjaWZpYyB0b25lXG5cdFx0XHRhd2FpdCB0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51LmhhbmRsZVNlbGVjdGlvbkFjdGlvbigndG9uZScsIGVkaXRvciwgc2VsZWN0ZWRUZXh0LCB0b25lSWQpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgTm92YSB0b25lIGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0bmV3IE5vdGljZSgnRmFpbGVkIHRvIGV4ZWN1dGUgTm92YSBhY3Rpb24uIFBsZWFzZSB0cnkgYWdhaW4uJywgMzAwMCk7XG5cdFx0fVxuXHR9XG5cblxuXHQvKipcblx0ICogU2hvdyB1cGdyYWRlIHByb21wdCBmb3IgQ29yZSB0aWVyIG1vYmlsZSB1c2Vyc1xuXHQgKi9cblx0cHJpdmF0ZSBzaG93TW9iaWxlVXBncmFkZVByb21wdCgpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdG1vZGFsLmNsYXNzTmFtZSA9ICdtb2RhbCBub3ZhLW1vYmlsZS11cGdyYWRlLW1vZGFsJztcblx0XHRtb2RhbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1iZ1wiPjwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj5cblx0XHRcdFx0XHRcdDxoMz5Ob3ZhIFN1cGVyTm92YSBSZXF1aXJlZDwvaDM+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpZXItYmFkZ2UgY29yZVwiIHN0eWxlPVwibWFyZ2luLWJvdHRvbTogMWVtO1wiPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cInRpZXItaWNvblwiPkZSRUU8L3NwYW4+XG5cdFx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwidGllci1uYW1lXCI+Q29yZSAoRnJlZSk8L3NwYW4+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHRcdDxwPk1vYmlsZSBhY2Nlc3MgaXMgYXZhaWxhYmxlIHdpdGggTm92YSBTdXBlck5vdmEuPC9wPlxuXHRcdFx0XHRcdFx0PHA+Q29yZSB0aWVyIGlzIGxpbWl0ZWQgdG8gZGVza3RvcCB1c2Ugb25seS48L3A+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1mZWF0dXJlLWxpc3RcIj5cblx0XHRcdFx0XHRcdFx0PGg0PlN1cGVyTm92YSBpbmNsdWRlczo8L2g0PlxuXHRcdFx0XHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPk1vYmlsZSBkZXZpY2Ugc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPk11bHRpcGxlIEFJIHByb3ZpZGVyczwvbGk+XG5cdFx0XHRcdFx0XHRcdFx0PGxpPkluLWNoYXQgcHJvdmlkZXIgc3dpdGNoaW5nPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+QWR2YW5jZWQgdGVtcGxhdGVzPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+UHJpb3JpdHkgc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0XHRcdDwvdWw+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+XG5cdFx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9kLWN0YSBub3ZhLXVwZ3JhZGUtYnRuXCI+VXBncmFkZSB0byBTdXBlck5vdmE8L2J1dHRvbj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJub3ZhLWNsb3NlLWJ0blwiPkNsb3NlPC9idXR0b24+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdGNvbnN0IHVwZ3JhZGVCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS11cGdyYWRlLWJ0bicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdGNvbnN0IGNsb3NlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm5vdmEtY2xvc2UtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0Y29uc3QgbW9kYWxCZyA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1iZycpIGFzIEhUTUxFbGVtZW50O1xuXG5cdFx0Y29uc3QgY2xvc2VNb2RhbCA9ICgpID0+IHtcblx0XHRcdG1vZGFsLnJlbW92ZSgpO1xuXHRcdH07XG5cblx0XHR1cGdyYWRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0d2luZG93Lm9wZW4oJ2h0dHBzOi8vbm92YXdyaXRlci5haS91cGdyYWRlJywgJ19ibGFuaycpO1xuXHRcdFx0Y2xvc2VNb2RhbCgpO1xuXHRcdH0pO1xuXG5cdFx0Y2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcblx0XHRtb2RhbEJnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcblxuXHRcdC8vIFNob3cgbm90aWNlIGFzIHdlbGxcblx0XHRuZXcgTm90aWNlKCdOb3ZhIG1vYmlsZSBhY2Nlc3MgcmVxdWlyZXMgU3VwZXJOb3ZhIGxpY2Vuc2UnLCA4MDAwKTtcblx0fVxuXG5cdC8vIERhdGFTdG9yZSBpbnRlcmZhY2UgaW1wbGVtZW50YXRpb24gZm9yIENvbnZlcnNhdGlvbk1hbmFnZXJcblx0YXN5bmMgbG9hZERhdGFXaXRoS2V5KGtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcblx0XHRjb25zdCBhbGxEYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuXHRcdHJldHVybiBhbGxEYXRhID8gYWxsRGF0YVtrZXldIDogdW5kZWZpbmVkO1xuXHR9XG5cblx0YXN5bmMgc2F2ZURhdGFXaXRoS2V5KGtleTogc3RyaW5nLCBkYXRhOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhbGxEYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpIHx8IHt9O1xuXHRcdGFsbERhdGFba2V5XSA9IGRhdGE7XG5cdFx0cmV0dXJuIGF3YWl0IHRoaXMuc2F2ZURhdGEoYWxsRGF0YSk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgQUlQcm92aWRlclNldHRpbmdzLCBQbGF0Zm9ybVNldHRpbmdzLCBQcm92aWRlclR5cGUgfSBmcm9tICcuL2FpL3R5cGVzJztcbmltcG9ydCB7IERlYnVnU2V0dGluZ3MgfSBmcm9tICcuL2xpY2Vuc2luZy90eXBlcyc7XG5pbXBvcnQgeyBWSUVXX1RZUEVfTk9WQV9TSURFQkFSLCBOb3ZhU2lkZWJhclZpZXcgfSBmcm9tICcuL3VpL3NpZGViYXItdmlldyc7XG5pbXBvcnQgeyBnZXRBdmFpbGFibGVNb2RlbHMgfSBmcm9tICcuL2FpL21vZGVscyc7XG5pbXBvcnQgeyBDbGF1ZGVQcm92aWRlciB9IGZyb20gJy4vYWkvcHJvdmlkZXJzL2NsYXVkZSc7XG5pbXBvcnQgeyBPcGVuQUlQcm92aWRlciB9IGZyb20gJy4vYWkvcHJvdmlkZXJzL29wZW5haSc7XG5pbXBvcnQgeyBHb29nbGVQcm92aWRlciB9IGZyb20gJy4vYWkvcHJvdmlkZXJzL2dvb2dsZSc7XG5pbXBvcnQgeyBPbGxhbWFQcm92aWRlciB9IGZyb20gJy4vYWkvcHJvdmlkZXJzL29sbGFtYSc7XG5cbmNvbnN0IE5PVkFfSUNPTl9TVkcgPSBgXG48c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj5cbiAgPCEtLSBDZW50cmFsIHN0YXIgY29yZSAtLT5cbiAgPGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuICBcbiAgPCEtLSBQcmltYXJ5IHJheXMgKDQgbWFpbiBkaXJlY3Rpb25zKSAtLT5cbiAgPHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIFxuICA8IS0tIFNlY29uZGFyeSByYXlzIChkaWFnb25hbHMpIC0tPlxuICA8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuPC9zdmc+YDtcblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21Db21tYW5kIHtcblx0aWQ6IHN0cmluZztcblx0bmFtZTogc3RyaW5nO1xuXHR0cmlnZ2VyOiBzdHJpbmc7XG5cdHRlbXBsYXRlOiBzdHJpbmc7XG5cdGRlc2NyaXB0aW9uPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5vdmFTZXR0aW5ncyB7XG5cdGFpUHJvdmlkZXJzOiBBSVByb3ZpZGVyU2V0dGluZ3M7XG5cdHBsYXRmb3JtU2V0dGluZ3M6IFBsYXRmb3JtU2V0dGluZ3M7XG5cdGN1c3RvbUNvbW1hbmRzPzogQ3VzdG9tQ29tbWFuZFtdO1xuXHRnZW5lcmFsOiB7XG5cdFx0ZGVmYXVsdFRlbXBlcmF0dXJlOiBudW1iZXI7XG5cdFx0ZGVmYXVsdE1heFRva2VuczogbnVtYmVyO1xuXHRcdGF1dG9TYXZlOiBib29sZWFuO1xuXHR9O1xuXHRzaG93Q29tbWFuZEJ1dHRvbjogYm9vbGVhbjtcblx0bGljZW5zaW5nOiB7XG5cdFx0bGljZW5zZUtleTogc3RyaW5nO1xuXHRcdHN1cGVybm92YUxpY2Vuc2VLZXk/OiBzdHJpbmc7XG5cdFx0aXNTdXBlcm5vdmE/OiBib29sZWFuO1xuXHRcdGRlYnVnU2V0dGluZ3M6IERlYnVnU2V0dGluZ3M7XG5cdH07XG5cdHByb3ZpZGVyU3RhdHVzPzoge1xuXHRcdFtrZXk6IHN0cmluZ106IHtcblx0XHRcdHN0YXR1czogJ2Nvbm5lY3RlZCcgfCAnZXJyb3InIHwgJ25vdC1jb25maWd1cmVkJyB8ICd1bnRlc3RlZCcgfCAndGVzdGluZyc7XG5cdFx0XHRtZXNzYWdlPzogc3RyaW5nO1xuXHRcdFx0bGFzdENoZWNrZWQ/OiBEYXRlIHwgc3RyaW5nIHwgbnVsbDtcblx0XHR9O1xuXHR9O1xuXHRvbGxhbWFEZWZhdWx0Q29udGV4dD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE5vdmFTZXR0aW5ncyA9IHtcblx0YWlQcm92aWRlcnM6IHtcblx0XHRjbGF1ZGU6IHtcblx0XHRcdGFwaUtleTogJycsXG5cdFx0XHRtb2RlbDogJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9wZW5haToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdGJhc2VVcmw6ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJyxcblx0XHRcdG1vZGVsOiAnZ3B0LTRvJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdGdvb2dsZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdG1vZGVsOiAnZ2VtaW5pLTEuNS1mbGFzaCcsXG5cdFx0XHR0ZW1wZXJhdHVyZTogMC43LFxuXHRcdFx0bWF4VG9rZW5zOiAxMDAwXG5cdFx0fSxcblx0XHRvbGxhbWE6IHtcblx0XHRcdGJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jyxcblx0XHRcdG1vZGVsOiAnJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9XG5cdH0sXG5cdHBsYXRmb3JtU2V0dGluZ3M6IHtcblx0XHRkZXNrdG9wOiB7XG5cdFx0XHRzZWxlY3RlZE1vZGVsOiAnbGxhbWEzLjEnICAvLyBEZWZhdWx0IHRvIE9sbGFtYSBtb2RlbCBmb3IgZGVza3RvcFxuXHRcdH0sXG5cdFx0bW9iaWxlOiB7XG5cdFx0XHRzZWxlY3RlZE1vZGVsOiAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInICAvLyBEZWZhdWx0IHRvIENsYXVkZSBmb3IgbW9iaWxlXG5cdFx0fVxuXHR9LFxuXHRjdXN0b21Db21tYW5kczogW10sXG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IDAuNyxcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiAxMDAwLFxuXHRcdGF1dG9TYXZlOiB0cnVlXG5cdH0sXG5cdHNob3dDb21tYW5kQnV0dG9uOiB0cnVlLFxuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiAnJyxcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5OiAnJyxcblx0XHRpc1N1cGVybm92YTogZmFsc2UsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRvdmVycmlkZURhdGU6IHVuZGVmaW5lZCxcblx0XHRcdGZvcmNlU3VwZXJub3ZhOiBmYWxzZVxuXHRcdH1cblx0fSxcblx0cHJvdmlkZXJTdGF0dXM6IHt9LFxuXHRvbGxhbWFEZWZhdWx0Q29udGV4dDogMzIwMDBcbn07XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgYWN0aXZlVGFiOiAnZ2V0dGluZy1zdGFydGVkJyB8ICdnZW5lcmFsJyB8ICdwcm92aWRlcnMnIHwgJ3N1cGVybm92YScgfCAnZGVidWcnID0gJ2dldHRpbmctc3RhcnRlZCc7XG5cdHByaXZhdGUgdGFiQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGNvbnRlbnRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ05vdmEgU2V0dGluZ3MnIH0pO1xuXG5cdFx0Ly8gQ3JlYXRlIHRhYiBuYXZpZ2F0aW9uIGNvbnRhaW5lciAob25seSBvbmNlKVxuXHRcdHRoaXMudGFiQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS10YWItY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNyZWF0ZVRhYk5hdmlnYXRpb24oKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29udGVudCBjb250YWluZXIgKG9ubHkgb25jZSkgIFxuXHRcdHRoaXMuY29udGVudENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtdGFiLWNvbnRlbnQnIH0pO1xuXHRcdHRoaXMudXBkYXRlVGFiQ29udGVudCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVUYWJOYXZpZ2F0aW9uKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy50YWJDb250YWluZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCB0YWJzID0gW1xuXHRcdFx0eyBpZDogJ2dldHRpbmctc3RhcnRlZCcsIGxhYmVsOiAnR2V0dGluZyBTdGFydGVkJyB9LFxuXHRcdFx0eyBpZDogJ2dlbmVyYWwnLCBsYWJlbDogJ0dlbmVyYWwnIH0sXG5cdFx0XHR7IGlkOiAncHJvdmlkZXJzJywgbGFiZWw6ICdBSSBQcm92aWRlcnMnIH0sXG5cdFx0XHR7IGlkOiAnc3VwZXJub3ZhJywgbGFiZWw6ICdTdXBlcm5vdmEnIH1cblx0XHRdO1xuXG5cdFx0Ly8gQWRkIERlYnVnIHRhYiBvbmx5IGZvciBkZWJ1ZyBidWlsZHNcblx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgfHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCkge1xuXHRcdFx0dGFicy5wdXNoKHsgaWQ6ICdkZWJ1ZycsIGxhYmVsOiAnRGVidWcnIH0pO1xuXHRcdH1cblxuXHRcdHRhYnMuZm9yRWFjaCh0YWIgPT4ge1xuXHRcdFx0Y29uc3QgdGFiRWwgPSB0aGlzLnRhYkNvbnRhaW5lciEuY3JlYXRlRGl2KHsgXG5cdFx0XHRcdGNsczogYG5vdmEtdGFiICR7dGhpcy5hY3RpdmVUYWIgPT09IHRhYi5pZCA/ICdhY3RpdmUnIDogJyd9YCxcblx0XHRcdFx0dGV4dDogdGFiLmxhYmVsXG5cdFx0XHR9KTtcblx0XHRcdHRhYkVsLmRhdGFzZXQudGFiSWQgPSB0YWIuaWQ7XG5cdFx0XHRcblx0XHRcdHRhYkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnN3aXRjaFRhYih0YWIuaWQgYXMgJ2dldHRpbmctc3RhcnRlZCcgfCAnZ2VuZXJhbCcgfCAncHJvdmlkZXJzJyB8ICdzdXBlcm5vdmEnIHwgJ2RlYnVnJyk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc3dpdGNoVGFiKHRhYklkOiAnZ2V0dGluZy1zdGFydGVkJyB8ICdnZW5lcmFsJyB8ICdwcm92aWRlcnMnIHwgJ3N1cGVybm92YScgfCAnZGVidWcnKTogdm9pZCB7XG5cdFx0dGhpcy5hY3RpdmVUYWIgPSB0YWJJZDtcblx0XHR0aGlzLnVwZGF0ZVRhYlN0YXRlcygpO1xuXHRcdHRoaXMudXBkYXRlVGFiQ29udGVudCgpO1xuXHRcdHRoaXMuc2Nyb2xsVG9BY3RpdmVUYWIoKTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlVGFiU3RhdGVzKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy50YWJDb250YWluZXIpIHJldHVybjtcblx0XHRcblx0XHQvLyBVcGRhdGUgdGFiIGFjdGl2ZSBzdGF0ZXMgd2l0aG91dCByZS1jcmVhdGluZyBlbGVtZW50c1xuXHRcdGNvbnN0IHRhYkVsZW1lbnRzID0gdGhpcy50YWJDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm5vdmEtdGFiJyk7XG5cdFx0dGFiRWxlbWVudHMuZm9yRWFjaCh0YWJFbCA9PiB7XG5cdFx0XHRjb25zdCBodG1sVGFiRWwgPSB0YWJFbCBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChodG1sVGFiRWwuZGF0YXNldC50YWJJZCA9PT0gdGhpcy5hY3RpdmVUYWIpIHtcblx0XHRcdFx0aHRtbFRhYkVsLmFkZENsYXNzKCdhY3RpdmUnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGh0bWxUYWJFbC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNjcm9sbFRvQWN0aXZlVGFiKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy50YWJDb250YWluZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBhY3RpdmVUYWIgPSB0aGlzLnRhYkNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcubm92YS10YWIuYWN0aXZlJykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0aWYgKGFjdGl2ZVRhYikge1xuXHRcdFx0YWN0aXZlVGFiLnNjcm9sbEludG9WaWV3KHtcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnLFxuXHRcdFx0XHRibG9jazogJ25lYXJlc3QnLFxuXHRcdFx0XHRpbmxpbmU6ICdjZW50ZXInXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZVRhYkNvbnRlbnQoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRlbnRDb250YWluZXIpIHJldHVybjtcblx0XHRcblx0XHQvLyBDbGVhciBleGlzdGluZyBjb250ZW50XG5cdFx0dGhpcy5jb250ZW50Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0c3dpdGNoICh0aGlzLmFjdGl2ZVRhYikge1xuXHRcdFx0Y2FzZSAnZ2V0dGluZy1zdGFydGVkJzpcblx0XHRcdFx0dGhpcy5jcmVhdGVHZXR0aW5nU3RhcnRlZFRhYkNvbnRlbnQodGhpcy5jb250ZW50Q29udGFpbmVyKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdnZW5lcmFsJzpcblx0XHRcdFx0dGhpcy5jcmVhdGVHZW5lcmFsVGFiQ29udGVudCh0aGlzLmNvbnRlbnRDb250YWluZXIpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ3Byb3ZpZGVycyc6XG5cdFx0XHRcdHRoaXMuY3JlYXRlUHJvdmlkZXJzVGFiQ29udGVudCh0aGlzLmNvbnRlbnRDb250YWluZXIpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ3N1cGVybm92YSc6XG5cdFx0XHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhVGFiQ29udGVudCh0aGlzLmNvbnRlbnRDb250YWluZXIpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ2RlYnVnJzpcblx0XHRcdFx0dGhpcy5jcmVhdGVEZWJ1Z1RhYkNvbnRlbnQodGhpcy5jb250ZW50Q29udGFpbmVyKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVHZW5lcmFsVGFiQ29udGVudChjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Ly8gU2hvdyBzdXBwb3J0ZXIgQ1RBIG9ubHkgaWYgbm90IGFscmVhZHkgYSBzdXBwb3J0ZXJcblx0XHR0aGlzLmNyZWF0ZVN1cGVybm92YUNUQShjb250YWluZXIsIHsgXG5cdFx0XHRzaG93T25seUlmTm90U3VwcG9ydGVyOiB0cnVlLFxuXHRcdFx0YnV0dG9uQWN0aW9uOiAndGFiJyxcblx0XHRcdHNob3dMZWFybk1vcmU6IGZhbHNlXG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy5jcmVhdGVHZW5lcmFsU2V0dGluZ3MoY29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZVByaXZhY3lTZXR0aW5ncyhjb250YWluZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlcnNUYWJDb250ZW50KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHQvLyBTaG93IHN1cHBvcnRlciBDVEEgb25seSBpZiBub3QgYWxyZWFkeSBhIHN1cHBvcnRlclxuXHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhQ1RBKGNvbnRhaW5lciwgeyBcblx0XHRcdHNob3dPbmx5SWZOb3RTdXBwb3J0ZXI6IHRydWUsXG5cdFx0XHRidXR0b25BY3Rpb246ICd0YWInLFxuXHRcdFx0c2hvd0xlYXJuTW9yZTogZmFsc2Vcblx0XHR9KTtcblx0XHRcblx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyU2V0dGluZ3MoY29udGFpbmVyKTtcblx0fVxuXG5cblx0cHJpdmF0ZSBjcmVhdGVHZXR0aW5nU3RhcnRlZFRhYkNvbnRlbnQoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdHRoaXMuY3JlYXRlV2VsY29tZVNlY3Rpb24oY29udGFpbmVyKTtcblx0XHR0aGlzLmNyZWF0ZVF1aWNrU3RhcnRHdWlkZShjb250YWluZXIpO1xuXHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhQ1RBKGNvbnRhaW5lciwge1xuXHRcdFx0YnV0dG9uQWN0aW9uOiAndGFiJyxcblx0XHRcdHNob3dMZWFybk1vcmU6IHRydWUsXG5cdFx0XHRtYXJnaW5Ub3A6ICczMnB4Jyxcblx0XHRcdG1hcmdpbkJvdHRvbTogJzMycHgnXG5cdFx0fSk7XG5cdFx0dGhpcy5jcmVhdGVOYXZpZ2F0aW9uSGVscChjb250YWluZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFUYWJDb250ZW50KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHQvLyBVc2UgdGhlIHJldXNhYmxlIENUQSBjb21wb25lbnRcblx0XHR0aGlzLmNyZWF0ZVN1cGVybm92YUNUQShjb250YWluZXIsIHtcblx0XHRcdGJ1dHRvbkFjdGlvbjogJ2RpcmVjdCcsXG5cdFx0XHRzaG93TGVhcm5Nb3JlOiBmYWxzZSxcblx0XHRcdG1hcmdpbkJvdHRvbTogJzMycHgnXG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly8gQmVuZWZpdHMgc2VjdGlvbiB3aXRoIG5vcm1hbCBzdHlsaW5nXG5cdFx0Y29uc3QgYmVuZWZpdHNTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYmVuZWZpdHMtc2VjdGlvbicgfSk7XG5cdFx0YmVuZWZpdHNTZWN0aW9uLnN0eWxlLm1hcmdpblRvcCA9ICczMnB4Jztcblx0XHRiZW5lZml0c1NlY3Rpb24uY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnU3VwZXJub3ZhIEJlbmVmaXRzJyB9KTtcblx0XHRiZW5lZml0c1NlY3Rpb24uY3JlYXRlRWwoJ2hyJywgeyBjbHM6ICdub3ZhLXNlY3Rpb24tZGl2aWRlcicgfSk7XG5cdFx0XG5cdFx0Y29uc3QgYmVuZWZpdHNDb250ZW50ID0gYmVuZWZpdHNTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYmVuZWZpdHMtY29udGVudCcgfSk7XG5cdFx0YmVuZWZpdHNDb250ZW50LmlubmVySFRNTCA9IGBcblx0XHRcdDxwIHN0eWxlPVwibWFyZ2luLWJvdHRvbTogMjBweDtcIj5TdXBwb3J0IE5vdmEgZGV2ZWxvcG1lbnQgYW5kIGdldCBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLiBBbGwgZmVhdHVyZXMgZXZlbnR1YWxseSBiZWNvbWUgZnJlZSBmb3IgZXZlcnlvbmUuPC9wPlxuXHRcdFx0XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0cy1saXN0XCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJlbmVmaXQtaXRlbVwiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1iZW5lZml0LWljb25cIj5cdTI2QTE8L3NwYW4+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHQ8c3Ryb25nPkVhcmx5IEFjY2Vzczwvc3Ryb25nPlxuXHRcdFx0XHRcdFx0PHNwYW4+R2V0IG5ldyBmZWF0dXJlcyAyLTQgbW9udGhzIGJlZm9yZSBnZW5lcmFsIHJlbGVhc2U8L3NwYW4+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWl0ZW1cIj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pY29uXCI+XHVEODNEXHVEQ0FDPC9zcGFuPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJlbmVmaXQtY29udGVudFwiPlxuXHRcdFx0XHRcdFx0PHN0cm9uZz5Qcmlvcml0eSBTdXBwb3J0PC9zdHJvbmc+XG5cdFx0XHRcdFx0XHQ8c3Bhbj5EaXJlY3QgYWNjZXNzIHRvIGRldmVsb3BlcnMgZm9yIGZlYXR1cmUgcmVxdWVzdHMgYW5kIGJ1ZyByZXBvcnRzPC9zcGFuPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pdGVtXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWJlbmVmaXQtaWNvblwiPlx1RDgzRFx1RERGM1x1RkUwRjwvc3Bhbj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWNvbnRlbnRcIj5cblx0XHRcdFx0XHRcdDxzdHJvbmc+Vm90ZSBvbiBGZWF0dXJlczwvc3Ryb25nPlxuXHRcdFx0XHRcdFx0PHNwYW4+SGVscCBzaGFwZSBOb3ZhJ3MgZGV2ZWxvcG1lbnQgYW5kIGZ1dHVyZSBkaXJlY3Rpb248L3NwYW4+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWl0ZW1cIj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pY29uXCI+XHVEODNDXHVERkM2PC9zcGFuPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJlbmVmaXQtY29udGVudFwiPlxuXHRcdFx0XHRcdFx0PHN0cm9uZz5TdXBwb3J0ZXIgQmFkZ2U8L3N0cm9uZz5cblx0XHRcdFx0XHRcdDxzcGFuPlJlY29nbml0aW9uIGluIHRoZSBOb3ZhIGNvbW11bml0eSAoY29taW5nIHNvb24pPC9zcGFuPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pdGVtXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWJlbmVmaXQtaWNvblwiPlx1Mjc2NFx1RkUwRjwvc3Bhbj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWNvbnRlbnRcIj5cblx0XHRcdFx0XHRcdDxzdHJvbmc+T3BlbiBTb3VyY2UgU3VwcG9ydDwvc3Ryb25nPlxuXHRcdFx0XHRcdFx0PHNwYW4+RGlyZWN0bHkgZnVuZCBjb250aW51ZWQgZGV2ZWxvcG1lbnQgb2YgTm92YTwvc3Bhbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdFxuXHRcdFx0PHAgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4OyBmb250LXNpemU6IDAuOWVtOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XCI+WW91ciBzdXBwb3J0IGtlZXBzIE5vdmEgZnJlZSBhbmQgb3BlbiBzb3VyY2UgZm9yIGV2ZXJ5b25lLjwvcD5cblx0XHRgO1xuXHRcdFxuXHRcdC8vIExpY2Vuc2Ugc2V0dGluZ3Mgc2VjdGlvbiAtIHN0eWxlZCBsaWtlIEFQSSBrZXlzXG5cdFx0Y29uc3QgbGljZW5zZVNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRsaWNlbnNlU2VjdGlvbi5zdHlsZS5tYXJnaW5Ub3AgPSAnMzJweCc7XG5cdFx0bGljZW5zZVNlY3Rpb24uY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnTGljZW5zZSBNYW5hZ2VtZW50JyB9KTtcblx0XHRcblx0XHR0aGlzLmNyZWF0ZVN1cGVybm92YUxpY2Vuc2VJbnB1dChsaWNlbnNlU2VjdGlvbik7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZURlYnVnVGFiQ29udGVudChjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Ly8gRGVidWcgU2V0dGluZ3MgU2VjdGlvblxuXHRcdGNvbnN0IGRlYnVnU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnU2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdEZWJ1ZyBTZXR0aW5ncycgfSk7XG5cdFx0ZGVidWdTZWN0aW9uLmNyZWF0ZUVsKCdocicsIHsgY2xzOiAnbm92YS1zZWN0aW9uLWRpdmlkZXInIH0pO1xuXHRcdFxuXHRcdGNvbnN0IGluZm9FbCA9IGRlYnVnU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PHA+RGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IGFuZCB0ZXN0aW5nLiBUaGVzZSBvcHRpb25zIGhlbHAgZGV2ZWxvcGVycyB0cm91Ymxlc2hvb3QgaXNzdWVzIGFuZCB0ZXN0IG5ldyBmZWF0dXJlcy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDQ+XHUyNkEwXHVGRTBGIERldmVsb3BlciBTZXR0aW5nczwvaDQ+XG5cdFx0XHRcdDx1bCBjbGFzcz1cIm5vdmEtZGVidWctZmVhdHVyZXNcIj5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5EZWJ1ZyBNb2RlPC9zdHJvbmc+IC0gRW5hYmxlIGRldGFpbGVkIGxvZ2dpbmcgYW5kIGRldmVsb3BtZW50IGZlYXR1cmVzPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5PdmVycmlkZSBEYXRlPC9zdHJvbmc+IC0gVGVzdCB0aW1lLXNlbnNpdGl2ZSBmZWF0dXJlcyB3aXRoIGN1c3RvbSBkYXRlczwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+Rm9yY2UgU3VwZXJub3ZhPC9zdHJvbmc+IC0gVGVzdCBTdXBlcm5vdmEtb25seSBmZWF0dXJlcyB3aXRob3V0IGEgbGljZW5zZTwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHRcdDxwIGNsYXNzPVwibm92YS1kZWJ1Zy1ub3RlXCI+T25seSBtb2RpZnkgdGhlc2Ugc2V0dGluZ3MgaWYgeW91IHVuZGVyc3RhbmQgdGhlaXIgcHVycG9zZS48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHRcdFxuXHRcdHRoaXMuY3JlYXRlRGVidWdTZXR0aW5ncyhkZWJ1Z1NlY3Rpb24pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQcml2YWN5U2V0dGluZ3MoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdC8vIFByaXZhY3kgJiBQbGF0Zm9ybSBTZWN0aW9uXG5cdFx0Y29uc3QgcHJpdmFjeVNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcml2YWN5LXNlY3Rpb24nIH0pO1xuXHRcdHByaXZhY3lTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1ByaXZhY3kgJiBQbGF0Zm9ybSBTZXR0aW5ncycgfSk7XG5cdFx0cHJpdmFjeVNlY3Rpb24uY3JlYXRlRWwoJ2hyJywgeyBjbHM6ICdub3ZhLXNlY3Rpb24tZGl2aWRlcicgfSk7XG5cdFx0XG5cdFx0Y29uc3QgaW5mb0VsID0gcHJpdmFjeVNlY3Rpb24uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcml2YWN5LWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0Plx1RDgzRFx1REQxMiBZb3VyIFByaXZhY3kgTWF0dGVyczwvaDQ+XG5cdFx0XHRcdDxwPk5vdmEgcmVzcGVjdHMgeW91ciBwcml2YWN5IGFuZCBnaXZlcyB5b3UgZnVsbCBjb250cm9sIG92ZXIgaG93IHlvdXIgZGF0YSBpcyBoYW5kbGVkLiBcblx0XHRcdFx0QWxsIEFJIHByb3ZpZGVycyBhcmUgYWNjZXNzZWQgdXNpbmcgeW91ciBvd24gQVBJIGtleXMsIHNvIHlvdXIgY29udGVudCBzdGF5cyBiZXR3ZWVuIHlvdSBhbmQgeW91ciBjaG9zZW4gQUkgc2VydmljZS48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDQ+XHVEODNEXHVEQ0YxIE1vYmlsZSBTdXBwb3J0PC9oND5cblx0XHRcdFx0PHA+TW9iaWxlIHN1cHBvcnQgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdCB0byBwcm90ZWN0IHlvdXIgcHJpdmFjeS4gV2hlbiBlbmFibGVkLCBOb3ZhIHByb3ZpZGVzIGlkZW50aWNhbCBzZWxlY3Rpb24tYmFzZWQgZWRpdGluZyBjYXBhYmlsaXRpZXMgYWNyb3NzIGRlc2t0b3AgYW5kIG1vYmlsZSB3aXRoIGNsb3VkLWJhc2VkIEFJIHByb3ZpZGVycy48L3A+XG5cdFx0XHRcdDx1bCBjbGFzcz1cIm5vdmEtcHJpdmFjeS1mZWF0dXJlc1wiPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkxvY2FsLWZpcnN0PC9zdHJvbmc+IC0gT2xsYW1hIGFuZCBkZXNrdG9wLW9ubHkgcHJvdmlkZXJzIGtlZXAgZXZlcnl0aGluZyBvbiB5b3VyIGRldmljZTwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+WW91ciBjaG9pY2U8L3N0cm9uZz4gLSBFbmFibGUgbW9iaWxlIG9ubHkgd2hlbiB5b3UgbmVlZCBjcm9zcy1kZXZpY2UgYWNjZXNzPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5Dcm9zcy1wbGF0Zm9ybSBlZGl0aW5nPC9zdHJvbmc+IC0gU2VsZWN0aW9uLWJhc2VkIGVkaXRpbmcgd29ya3MgaWRlbnRpY2FsbHkgb24gbW9iaWxlIHZpYSBDb21tYW5kIFBhbGV0dGUgKENtZCtQKTwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+U2FtZSBleHBlcmllbmNlPC9zdHJvbmc+IC0gTW9iaWxlIHByb3ZpZGVzIHRoZSBzYW1lIGVkaXRpbmcgY2FwYWJpbGl0aWVzIGFzIGRlc2t0b3A8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHQvLyBNb2JpbGUgU3VwcG9ydCBUb2dnbGVcblx0XHRuZXcgU2V0dGluZyhwcml2YWN5U2VjdGlvbilcblx0XHRcdC5zZXROYW1lKCdFbmFibGUgTW9iaWxlIFN1cHBvcnQnKVxuXHRcdFx0LnNldERlc2MoJ0FsbG93IE5vdmEgdG8gd29yayBvbiBtb2JpbGUgZGV2aWNlcyB1c2luZyBjbG91ZC1iYXNlZCBBSSBwcm92aWRlcnMnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4ge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50TW9iaWxlTW9kZWwgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5zZWxlY3RlZE1vZGVsO1xuXHRcdFx0XHRjb25zdCBpc01vYmlsZUVuYWJsZWQgPSBjdXJyZW50TW9iaWxlTW9kZWwgIT09ICdub25lJztcblx0XHRcdFx0XG5cdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZShpc01vYmlsZUVuYWJsZWQpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEVuYWJsZSBtb2JpbGUgd2l0aCBDbGF1ZGUgYXMgZGVmYXVsdCAobW9zdCByZWxpYWJsZSlcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUuc2VsZWN0ZWRNb2RlbCA9ICdjbGF1ZGUtMy01LXNvbm5ldC0yMDI0MTAyMic7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBEaXNhYmxlIG1vYmlsZVxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZS5zZWxlY3RlZE1vZGVsID0gJ25vbmUnO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIudXBkYXRlU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVNlY3VyZUFwaUtleUlucHV0KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIG9wdGlvbnM6IHtcblx0XHRuYW1lOiBzdHJpbmc7XG5cdFx0ZGVzYzogc3RyaW5nO1xuXHRcdHBsYWNlaG9sZGVyOiBzdHJpbmc7XG5cdFx0dmFsdWU6IHN0cmluZztcblx0XHRvbkNoYW5nZTogKHZhbHVlOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG5cdH0pOiB2b2lkIHtcblx0XHRjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUob3B0aW9ucy5uYW1lKVxuXHRcdFx0LnNldERlc2Mob3B0aW9ucy5kZXNjKTtcblxuXHRcdGxldCBhY3R1YWxWYWx1ZSA9IG9wdGlvbnMudmFsdWU7XG5cdFx0bGV0IGlzVmlzaWJsZSA9IGZhbHNlO1xuXG5cdFx0c2V0dGluZy5hZGRUZXh0KHRleHQgPT4ge1xuXHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAncGFzc3dvcmQnO1xuXHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLmZvbnRGYW1pbHkgPSAndmFyKC0tZm9udC1tb25vc3BhY2UpJztcblx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICc0MDBweCc7XG5cdFx0XHR0ZXh0LmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gJzQwcHgnO1xuXHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblx0XHRcdHRleHQuc2V0UGxhY2Vob2xkZXIob3B0aW9ucy5wbGFjZWhvbGRlcik7XG5cblx0XHRcdC8vIFNldCBpbml0aWFsIGRpc3BsYXkgdmFsdWVcblx0XHRcdGlmIChhY3R1YWxWYWx1ZSAmJiBhY3R1YWxWYWx1ZS5sZW5ndGggPiAxMikge1xuXHRcdFx0XHRjb25zdCBtYXNrZWQgPSBhY3R1YWxWYWx1ZS5zbGljZSgwLCA4KSArICdcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjInICsgYWN0dWFsVmFsdWUuc2xpY2UoLTQpO1xuXHRcdFx0XHR0ZXh0LnNldFZhbHVlKG1hc2tlZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0ZXh0LnNldFZhbHVlKGFjdHVhbFZhbHVlKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ3JlYXRlIHRvZ2dsZSBidXR0b25cblx0XHRcdGNvbnN0IGlucHV0Q29udGFpbmVyID0gdGV4dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ7XG5cdFx0XHRpZiAoaW5wdXRDb250YWluZXIpIHtcblx0XHRcdFx0aW5wdXRDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3QgdG9nZ2xlQnRuID0gaW5wdXRDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS10b2dnbGUtYnRuJyB9KTtcblx0XHRcdFx0dG9nZ2xlQnRuLmlubmVySFRNTCA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIj5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTEgMTJzNC04IDExLTggMTEgOCAxMSA4LTQgOC0xMSA4LTExLTgtMTEtOHpcIi8+XG5cdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIzXCIvPlxuXHRcdFx0XHQ8L3N2Zz5gO1xuXG5cdFx0XHRcdHRvZ2dsZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGlzVmlzaWJsZSA9ICFpc1Zpc2libGU7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKGlzVmlzaWJsZSkge1xuXHRcdFx0XHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAndGV4dCc7XG5cdFx0XHRcdFx0XHR0ZXh0LnNldFZhbHVlKGFjdHVhbFZhbHVlKTtcblx0XHRcdFx0XHRcdHRvZ2dsZUJ0bi5pbm5lckhUTUwgPSBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCI+XG5cdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJtOS44OCA5Ljg4YTMgMyAwIDEgMCA0LjI0IDQuMjRcIi8+XG5cdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJtMTAuNzMgNS4wOGExMC40MyAxMC40MyAwIDAgMSAxLjI3LS4wOGM3IDAgMTEgOCAxMSA4YTEzLjE2IDEzLjE2IDAgMCAxLTEuNjcgMi42OFwiLz5cblx0XHRcdFx0XHRcdFx0PHBhdGggZD1cIk02LjYxIDYuNjFBMTMuNTI2IDEzLjUyNiAwIDAgMCAxIDEyczQgOCAxMSA4YTkuNzQgOS43NCAwIDAgMCA1LjM5LTEuNjFcIi8+XG5cdFx0XHRcdFx0XHRcdDxsaW5lIHgxPVwiMlwiIHkxPVwiMlwiIHgyPVwiMjJcIiB5Mj1cIjIyXCIvPlxuXHRcdFx0XHRcdFx0PC9zdmc+YDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAncGFzc3dvcmQnO1xuXHRcdFx0XHRcdFx0aWYgKGFjdHVhbFZhbHVlICYmIGFjdHVhbFZhbHVlLmxlbmd0aCA+IDEyKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IG1hc2tlZCA9IGFjdHVhbFZhbHVlLnNsaWNlKDAsIDgpICsgJ1x1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMlx1MjAyMicgKyBhY3R1YWxWYWx1ZS5zbGljZSgtNCk7XG5cdFx0XHRcdFx0XHRcdHRleHQuc2V0VmFsdWUobWFza2VkKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRleHQuc2V0VmFsdWUoYWN0dWFsVmFsdWUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dG9nZ2xlQnRuLmlubmVySFRNTCA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIj5cblx0XHRcdFx0XHRcdFx0PHBhdGggZD1cIk0xIDEyczQtOCAxMS04IDExIDggMTEgOC00IDgtMTEgOC0xMS04LTExLTh6XCIvPlxuXHRcdFx0XHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjNcIi8+XG5cdFx0XHRcdFx0XHQ8L3N2Zz5gO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEhhbmRsZSB2YWx1ZSBjaGFuZ2VzXG5cdFx0XHR0ZXh0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRhY3R1YWxWYWx1ZSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCBvcHRpb25zLm9uQ2hhbmdlKHZhbHVlKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gdGV4dDtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJTdGF0dXNJbmRpY2F0b3IoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogSFRNTEVsZW1lbnQge1xuXHRcdGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXN0YXR1cy1jb250YWluZXInIH0pO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBzdGF0dXMgPSB0aGlzLmdldFByb3ZpZGVyU3RhdHVzKHByb3ZpZGVyKTtcblx0XHRcdGNvbnN0IHN0YXR1c0VsID0gc3RhdHVzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtcHJvdmlkZXItc3RhdHVzICR7c3RhdHVzLnN0YXR1c31gIH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBTdGF0dXMgZG90XG5cdFx0XHRjb25zdCBkb3QgPSBzdGF0dXNFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtZG90JyB9KTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RhdHVzIHRleHRcblx0XHRcdGNvbnN0IHRleHQgPSBzdGF0dXNFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtdGV4dCcgfSk7XG5cdFx0XHR0ZXh0LnRleHRDb250ZW50ID0gdGhpcy5nZXRTdGF0dXNEaXNwbGF5VGV4dChzdGF0dXMpO1xuXHRcdFx0XG5cdFx0XHQvLyBUb29sdGlwIHdpdGggZGV0YWlsc1xuXHRcdFx0aWYgKHN0YXR1cy5sYXN0Q2hlY2tlZCB8fCBzdGF0dXMubWVzc2FnZSkge1xuXHRcdFx0XHRjb25zdCB0b29sdGlwID0gc3RhdHVzRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdGF0dXMtdG9vbHRpcCcgfSk7XG5cdFx0XHRcdGlmIChzdGF0dXMubGFzdENoZWNrZWQpIHtcblx0XHRcdFx0XHRjb25zdCB0aW1lRWwgPSB0b29sdGlwLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3RhdHVzLXRpbWUnIH0pO1xuXHRcdFx0XHRcdGNvbnN0IGRhdGUgPSBzdGF0dXMubGFzdENoZWNrZWQgaW5zdGFuY2VvZiBEYXRlID8gc3RhdHVzLmxhc3RDaGVja2VkIDogbmV3IERhdGUoc3RhdHVzLmxhc3RDaGVja2VkKTtcblx0XHRcdFx0XHR0aW1lRWwudGV4dENvbnRlbnQgPSBgTGFzdCBjaGVja2VkOiAke2RhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoc3RhdHVzLm1lc3NhZ2UpIHtcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlRWwgPSB0b29sdGlwLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3RhdHVzLW1lc3NhZ2UnIH0pO1xuXHRcdFx0XHRcdG1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IHN0YXR1cy5tZXNzYWdlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHByb3ZpZGVyIHN0YXR1cyBpbmRpY2F0b3I6JywgZXJyb3IpO1xuXHRcdFx0Ly8gRmFsbGJhY2s6IGNyZWF0ZSBhIHNpbXBsZSBzdGF0dXMgaW5kaWNhdG9yXG5cdFx0XHRjb25zdCBzdGF0dXNFbCA9IHN0YXR1c0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXN0YXR1cyB1bnRlc3RlZCcgfSk7XG5cdFx0XHRjb25zdCBkb3QgPSBzdGF0dXNFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtZG90JyB9KTtcblx0XHRcdGNvbnN0IHRleHQgPSBzdGF0dXNFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtdGV4dCcgfSk7XG5cdFx0XHR0ZXh0LnRleHRDb250ZW50ID0gJ1N0YXR1cyB1bmtub3duJztcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHN0YXR1c0NvbnRhaW5lcjtcblx0fVxuXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJTdGF0dXMocHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogeyBzdGF0dXM6IHN0cmluZywgbWVzc2FnZT86IHN0cmluZywgbGFzdENoZWNrZWQ/OiBEYXRlIHwgc3RyaW5nIHwgbnVsbCB9IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc2F2ZWRTdGF0dXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1cz8uW3Byb3ZpZGVyXTtcblx0XHRcdGlmIChzYXZlZFN0YXR1cykge1xuXHRcdFx0XHRyZXR1cm4gc2F2ZWRTdGF0dXM7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIERldGVybWluZSBpbml0aWFsIHN0YXR1cyBiYXNlZCBvbiBjb25maWd1cmF0aW9uXG5cdFx0XHRjb25zdCBoYXNDb25maWcgPSB0aGlzLmhhc1Byb3ZpZGVyQ29uZmlnKHByb3ZpZGVyKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHN0YXR1czogaGFzQ29uZmlnID8gJ3VudGVzdGVkJyA6ICdub3QtY29uZmlndXJlZCcsXG5cdFx0XHRcdG1lc3NhZ2U6IGhhc0NvbmZpZyA/ICdDb25maWd1cmF0aW9uIG5vdCB0ZXN0ZWQnIDogJ05vIEFQSSBrZXkgY29uZmlndXJlZCcsXG5cdFx0XHRcdGxhc3RDaGVja2VkOiBudWxsXG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKGBFcnJvciBnZXR0aW5nIHByb3ZpZGVyIHN0YXR1cyBmb3IgJHtwcm92aWRlcn06YCwgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3RhdHVzOiAnbm90LWNvbmZpZ3VyZWQnLFxuXHRcdFx0XHRtZXNzYWdlOiAnU3RhdHVzIHVuYXZhaWxhYmxlJyxcblx0XHRcdFx0bGFzdENoZWNrZWQ6IG51bGxcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBnZXRTdGF0dXNEaXNwbGF5VGV4dChzdGF0dXM6IHsgc3RhdHVzOiBzdHJpbmcsIG1lc3NhZ2U/OiBzdHJpbmcgfSk6IHN0cmluZyB7XG5cdFx0c3dpdGNoIChzdGF0dXMuc3RhdHVzKSB7XG5cdFx0XHRjYXNlICdjb25uZWN0ZWQnOiByZXR1cm4gJ0Nvbm5lY3RlZCc7XG5cdFx0XHRjYXNlICdlcnJvcic6IHJldHVybiAnQ29ubmVjdGlvbiBmYWlsZWQnO1xuXHRcdFx0Y2FzZSAnbm90LWNvbmZpZ3VyZWQnOiByZXR1cm4gJ05vdCBjb25maWd1cmVkJztcblx0XHRcdGNhc2UgJ3VudGVzdGVkJzogcmV0dXJuICdVbnRlc3RlZCc7XG5cdFx0XHRjYXNlICd0ZXN0aW5nJzogcmV0dXJuICdUZXN0aW5nLi4uJztcblx0XHRcdGRlZmF1bHQ6IHJldHVybiAnVW5rbm93bic7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVUZXN0Q29ubmVjdGlvbkJ1dHRvbihjb250YWluZXI6IEhUTUxFbGVtZW50LCBwcm92aWRlcjogJ2NsYXVkZScgfCAnb3BlbmFpJyB8ICdnb29nbGUnIHwgJ29sbGFtYScpOiB2b2lkIHtcblx0XHRjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Nvbm5lY3Rpb24gU3RhdHVzJylcblx0XHRcdC5zZXREZXNjKCdUZXN0IHlvdXIgQVBJIGNvbm5lY3Rpb24nKTtcblxuXHRcdC8vIENyZWF0ZSBzdGF0dXMgaW5kaWNhdG9yIGZpcnN0ICh0byB0aGUgbGVmdClcblx0XHRjb25zdCBzdGF0dXNDb250YWluZXIgPSBzZXR0aW5nLmNvbnRyb2xFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbm5lY3Rpb24tc3RhdHVzLWNvbnRhaW5lcicgfSk7XG5cdFx0XG5cdFx0c2V0dGluZy5hZGRCdXR0b24oYnV0dG9uID0+IHtcblx0XHRcdGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdUZXN0IENvbm5lY3Rpb24nKVxuXHRcdFx0XHQuc2V0VG9vbHRpcChgVGVzdCAke3Byb3ZpZGVyfSBjb25uZWN0aW9uYClcblx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMudGVzdFByb3ZpZGVyQ29ubmVjdGlvbihwcm92aWRlciwgYnV0dG9uLmJ1dHRvbkVsLCBzdGF0dXNDb250YWluZXIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdGJ1dHRvbi5idXR0b25FbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgVGVzdCAke3RoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcil9IGNvbm5lY3Rpb25gKTtcblx0XHRcdHJldHVybiBidXR0b247XG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly8gU2hvdyBpbml0aWFsIHN0YXR1cyBpZiB3ZSBoYXZlIGl0XG5cdFx0dGhpcy51cGRhdGVDb25uZWN0aW9uU3RhdHVzKHN0YXR1c0NvbnRhaW5lciwgcHJvdmlkZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyB0ZXN0UHJvdmlkZXJDb25uZWN0aW9uKHByb3ZpZGVyOiAnY2xhdWRlJyB8ICdvcGVuYWknIHwgJ2dvb2dsZScgfCAnb2xsYW1hJywgYnV0dG9uRWw6IEhUTUxFbGVtZW50LCBzdGF0dXNDb250YWluZXI6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3Qgb3JpZ2luYWxUZXh0ID0gYnV0dG9uRWwudGV4dENvbnRlbnQgfHwgJ1Rlc3QgQ29ubmVjdGlvbic7XG5cdFx0Y29uc3QgYnV0dG9uID0gYnV0dG9uRWwgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0XG5cdFx0Y29uc29sZS5sb2coYFN0YXJ0aW5nIGNvbm5lY3Rpb24gdGVzdCBmb3IgJHtwcm92aWRlcn0sIGJ1dHRvbiBkaXNhYmxlZDogJHtidXR0b24uZGlzYWJsZWR9YCk7XG5cdFx0XG5cdFx0Ly8gRm9yY2UgZW5hYmxlIGFuZCBzZXQgaW5pdGlhbCBzdGF0ZVxuXHRcdGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdGJ1dHRvbi50ZXh0Q29udGVudCA9ICdUZXN0aW5nLi4uJztcblx0XHRidXR0b24uc3R5bGUub3BhY2l0eSA9ICcwLjYnO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwcm92aWRlciBzdGF0dXMgdG8gdGVzdGluZ1xuXHRcdGF3YWl0IHRoaXMudXBkYXRlUHJvdmlkZXJTdGF0dXMocHJvdmlkZXIsICd0ZXN0aW5nJywgJ1Rlc3RpbmcgY29ubmVjdGlvbi4uLicpO1xuXHRcdFxuXHRcdC8vIFNob3cgdGVzdGluZyBzdGF0dXNcblx0XHR0aGlzLnNldENvbm5lY3Rpb25TdGF0dXMoc3RhdHVzQ29udGFpbmVyLCAndGVzdGluZycsICdUZXN0aW5nLi4uJyk7XG5cdFx0XG5cdFx0Ly8gVXNlIGEgYmFja3VwIHRpbWVyIHRvIGVuc3VyZSBidXR0b24gZ2V0cyByZXN0b3JlZFxuXHRcdGNvbnN0IHJlc3RvcmVCdXR0b24gPSAoKSA9PiB7XG5cdFx0XHRidXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdGJ1dHRvbi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcblx0XHRcdGJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuXHRcdFx0Y29uc29sZS5sb2coYEJ1dHRvbiBmb3JjZS1yZXN0b3JlZCBmb3IgJHtwcm92aWRlcn1gKTtcblx0XHR9O1xuXHRcdFxuXHRcdGNvbnN0IGJhY2t1cFRpbWVyID0gc2V0VGltZW91dChyZXN0b3JlQnV0dG9uLCAxMjAwMCk7IC8vIDEyIHNlY29uZCBiYWNrdXBcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gQ2hlY2sgYmFzaWMgY29uZmlndXJhdGlvbiBmaXJzdFxuXHRcdFx0Y29uc3QgaGFzQ29uZmlnID0gdGhpcy5oYXNQcm92aWRlckNvbmZpZyhwcm92aWRlcik7XG5cdFx0XHRpZiAoIWhhc0NvbmZpZykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZpZGVyIG5vdCBjb25maWd1cmVkIC0gbWlzc2luZyBBUEkga2V5IG9yIHNldHRpbmdzJyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNldCB0aW1lb3V0IGZvciAxMCBzZWNvbmRzXG5cdFx0XHRjb25zdCB0aW1lb3V0UHJvbWlzZSA9IG5ldyBQcm9taXNlPG5ldmVyPigoXywgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcignQ29ubmVjdGlvbiB0aW1lb3V0JykpLCAxMDAwMCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gVGVzdCB0aGUgY29ubmVjdGlvbiB1c2luZyB0aGUgcGx1Z2luJ3MgcHJvdmlkZXIgc3lzdGVtXG5cdFx0XHRjb25zdCB0ZXN0UHJvbWlzZSA9IHRoaXMucGVyZm9ybVJlYWxDb25uZWN0aW9uVGVzdChwcm92aWRlcik7XG5cdFx0XHRcblx0XHRcdGF3YWl0IFByb21pc2UucmFjZShbdGVzdFByb21pc2UsIHRpbWVvdXRQcm9taXNlXSk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBwcm92aWRlciBzdGF0dXMgdG8gY29ubmVjdGVkXG5cdFx0XHRhd2FpdCB0aGlzLnVwZGF0ZVByb3ZpZGVyU3RhdHVzKHByb3ZpZGVyLCAnY29ubmVjdGVkJywgJ0Nvbm5lY3RlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cyhzdGF0dXNDb250YWluZXIsICdzdWNjZXNzJywgJ1x1MjVDRiBDb25uZWN0ZWQnKTtcblx0XHRcdGNvbnNvbGUubG9nKGBDb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bCBmb3IgJHtwcm92aWRlcn1gKTtcblx0XHRcdFxuXHRcdH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcblx0XHRcdGNvbnNvbGUubG9nKGBDb25uZWN0aW9uIHRlc3QgZmFpbGVkIGZvciAke3Byb3ZpZGVyfTpgLCBlcnJvcik7XG5cdFx0XHRsZXQgZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdFxuXHRcdFx0aWYgKGVycm9yLm1lc3NhZ2UgPT09ICdDb25uZWN0aW9uIHRpbWVvdXQnKSB7XG5cdFx0XHRcdGVycm9yTWVzc2FnZSA9ICdUaW1lb3V0Jztcblx0XHRcdH0gZWxzZSBpZiAocHJvdmlkZXIgPT09ICdvbGxhbWEnKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIFVSTCBpcyBhY3R1YWxseSBjb25maWd1cmVkXG5cdFx0XHRcdGNvbnN0IG9sbGFtYVVybCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsO1xuXHRcdFx0XHRpZiAoIW9sbGFtYVVybCB8fCBvbGxhbWFVcmwudHJpbSgpID09PSAnJykge1xuXHRcdFx0XHRcdGVycm9yTWVzc2FnZSA9ICdObyBVUkwgY29uZmlndXJlZCc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygnNDAxJykgfHwgZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ3VuYXV0aG9yaXplZCcpIHx8IGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCdBUEkga2V5JykpIHtcblx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ0ludmFsaWQgQVBJIGtleSc7XG5cdFx0XHR9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MjknKSkge1xuXHRcdFx0XHRlcnJvck1lc3NhZ2UgPSAnUmF0ZSBsaW1pdGVkJztcblx0XHRcdH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ3F1b3RhJykpIHtcblx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ1F1b3RhIGV4Y2VlZGVkJztcblx0XHRcdH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ25vdCBjb25maWd1cmVkJykgfHwgZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ21pc3NpbmcnKSkge1xuXHRcdFx0XHRlcnJvck1lc3NhZ2UgPSAnTm90IGNvbmZpZ3VyZWQnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIHByb3ZpZGVyIHN0YXR1cyB0byBlcnJvclxuXHRcdFx0YXdhaXQgdGhpcy51cGRhdGVQcm92aWRlclN0YXR1cyhwcm92aWRlciwgJ2Vycm9yJywgZXJyb3JNZXNzYWdlKTtcblx0XHRcdHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cyhzdGF0dXNDb250YWluZXIsICdlcnJvcicsIGBcdTI1Q0YgJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdC8vIENsZWFyIGJhY2t1cCB0aW1lciBhbmQgcmVzdG9yZSBidXR0b25cblx0XHRcdGNsZWFyVGltZW91dChiYWNrdXBUaW1lcik7XG5cdFx0XHRyZXN0b3JlQnV0dG9uKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyB1cGRhdGVQcm92aWRlclN0YXR1cyhwcm92aWRlcjogJ2NsYXVkZScgfCAnb3BlbmFpJyB8ICdnb29nbGUnIHwgJ29sbGFtYScsIHN0YXR1czogJ2Nvbm5lY3RlZCcgfCAnZXJyb3InIHwgJ25vdC1jb25maWd1cmVkJyB8ICd1bnRlc3RlZCcgfCAndGVzdGluZycsIG1lc3NhZ2U/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyU3RhdHVzKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1cyA9IHt9O1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1c1twcm92aWRlcl0gPSB7XG5cdFx0XHRzdGF0dXMsXG5cdFx0XHRtZXNzYWdlLFxuXHRcdFx0bGFzdENoZWNrZWQ6IHN0YXR1cyA9PT0gJ3Rlc3RpbmcnID8gbnVsbCA6IG5ldyBEYXRlKClcblx0XHR9O1xuXHRcdFxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFxuXHRcdC8vIFJlZnJlc2ggdGhlIHN0YXR1cyBpbmRpY2F0b3JzIGlmIG5lZWRlZFxuXHRcdHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzSW5kaWNhdG9ycygpO1xuXHR9XG5cblx0cHJpdmF0ZSByZWZyZXNoUHJvdmlkZXJTdGF0dXNJbmRpY2F0b3JzKCk6IHZvaWQge1xuXHRcdC8vIEZpbmQgYWxsIHByb3ZpZGVyIHN0YXR1cyBjb250YWluZXJzIGFuZCB1cGRhdGUgdGhlbVxuXHRcdGNvbnN0IGNvbnRhaW5lcnMgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3ZhLXByb3ZpZGVyLXN0YXR1cy1jb250YWluZXInKTtcblx0XHRjb250YWluZXJzLmZvckVhY2goY29udGFpbmVyID0+IHtcblx0XHRcdGNvbnN0IHByb3ZpZGVyID0gY29udGFpbmVyLmdldEF0dHJpYnV0ZSgnZGF0YS1wcm92aWRlcicpIGFzICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnO1xuXHRcdFx0aWYgKHByb3ZpZGVyKSB7XG5cdFx0XHRcdHRoaXMudXBkYXRlUHJvdmlkZXJTdGF0dXNEaXNwbGF5KGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudCwgcHJvdmlkZXIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVQcm92aWRlclN0YXR1c0Rpc3BsYXkoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogdm9pZCB7XG5cdFx0Y29uc3Qgc3RhdHVzID0gdGhpcy5nZXRQcm92aWRlclN0YXR1cyhwcm92aWRlcik7XG5cdFx0Y29uc3Qgc3RhdHVzRWwgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtcHJvdmlkZXItc3RhdHVzJyk7XG5cdFx0XG5cdFx0aWYgKHN0YXR1c0VsKSB7XG5cdFx0XHRzdGF0dXNFbC5jbGFzc05hbWUgPSBgbm92YS1wcm92aWRlci1zdGF0dXMgJHtzdGF0dXMuc3RhdHVzfWA7XG5cdFx0XHRjb25zdCB0ZXh0RWwgPSBzdGF0dXNFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1zdGF0dXMtdGV4dCcpO1xuXHRcdFx0aWYgKHRleHRFbCkge1xuXHRcdFx0XHR0ZXh0RWwudGV4dENvbnRlbnQgPSB0aGlzLmdldFN0YXR1c0Rpc3BsYXlUZXh0KHN0YXR1cyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0b29sdGlwXG5cdFx0XHRsZXQgdG9vbHRpcCA9IHN0YXR1c0VsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXN0YXR1cy10b29sdGlwJyk7XG5cdFx0XHRpZiAoc3RhdHVzLmxhc3RDaGVja2VkIHx8IHN0YXR1cy5tZXNzYWdlKSB7XG5cdFx0XHRcdGlmICghdG9vbHRpcCkge1xuXHRcdFx0XHRcdHRvb2x0aXAgPSBzdGF0dXNFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy10b29sdGlwJyB9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0b29sdGlwLmVtcHR5KCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoc3RhdHVzLmxhc3RDaGVja2VkKSB7XG5cdFx0XHRcdFx0Y29uc3QgdGltZUVsID0gdG9vbHRpcC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy10aW1lJyB9KTtcblx0XHRcdFx0XHRjb25zdCBkYXRlID0gc3RhdHVzLmxhc3RDaGVja2VkIGluc3RhbmNlb2YgRGF0ZSA/IHN0YXR1cy5sYXN0Q2hlY2tlZCA6IG5ldyBEYXRlKHN0YXR1cy5sYXN0Q2hlY2tlZCk7XG5cdFx0XHRcdFx0dGltZUVsLnRleHRDb250ZW50ID0gYExhc3QgY2hlY2tlZDogJHtkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfWA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHN0YXR1cy5tZXNzYWdlKSB7XG5cdFx0XHRcdFx0Y29uc3QgbWVzc2FnZUVsID0gdG9vbHRpcC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy1tZXNzYWdlJyB9KTtcblx0XHRcdFx0XHRtZXNzYWdlRWwudGV4dENvbnRlbnQgPSBzdGF0dXMubWVzc2FnZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICh0b29sdGlwKSB7XG5cdFx0XHRcdHRvb2x0aXAucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBwZXJmb3JtUmVhbENvbm5lY3Rpb25UZXN0KHByb3ZpZGVyOiAnY2xhdWRlJyB8ICdvcGVuYWknIHwgJ2dvb2dsZScgfCAnb2xsYW1hJyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnNvbGUubG9nKGBTdGFydGluZyByZWFsIGNvbm5lY3Rpb24gdGVzdCBmb3IgJHtwcm92aWRlcn1gKTtcblx0XHRcblx0XHQvLyBUZXN0IHRoZSBwcm92aWRlciBjbGFzc2VzIGRpcmVjdGx5XG5cdFx0c3dpdGNoIChwcm92aWRlcikge1xuXHRcdFx0Y2FzZSAnY2xhdWRlJzoge1xuXHRcdFx0XHRjb25zdCBjbGF1ZGVQcm92aWRlciA9IG5ldyBDbGF1ZGVQcm92aWRlcih0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUpO1xuXHRcdFx0XHQvLyBGb3IgQ2xhdWRlLCBqdXN0IHRlc3QgYSBtaW5pbWFsIGNvbXBsZXRpb24gaW5zdGVhZCBvZiBnZXRBdmFpbGFibGVNb2RlbHNcblx0XHRcdFx0YXdhaXQgY2xhdWRlUHJvdmlkZXIuY29tcGxldGUoJ1lvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudC4nLCAnSGknLCB7IG1heFRva2VuczogMSB9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlICdvcGVuYWknOiB7XG5cdFx0XHRcdGNvbnN0IG9wZW5haVByb3ZpZGVyID0gbmV3IE9wZW5BSVByb3ZpZGVyKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haSk7XG5cdFx0XHRcdGF3YWl0IG9wZW5haVByb3ZpZGVyLmdldEF2YWlsYWJsZU1vZGVscygpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGNhc2UgJ2dvb2dsZSc6IHtcblx0XHRcdFx0Y29uc3QgZ29vZ2xlUHJvdmlkZXIgPSBuZXcgR29vZ2xlUHJvdmlkZXIodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlKTtcblx0XHRcdFx0YXdhaXQgZ29vZ2xlUHJvdmlkZXIuZ2V0QXZhaWxhYmxlTW9kZWxzKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0Y2FzZSAnb2xsYW1hJzoge1xuXHRcdFx0XHRjb25zdCBvbGxhbWFQcm92aWRlciA9IG5ldyBPbGxhbWFQcm92aWRlcih0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEpO1xuXHRcdFx0XHQvLyBPbGxhbWEgZG9lc24ndCBoYXZlIGdldEF2YWlsYWJsZU1vZGVscywgY2hlY2sgY29ubmVjdGlvbiB3aXRoIGlzQXZhaWxhYmxlXG5cdFx0XHRcdGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgb2xsYW1hUHJvdmlkZXIuaXNBdmFpbGFibGUoKTtcblx0XHRcdFx0aWYgKCFpc0F2YWlsYWJsZSkge1xuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGNvbnNvbGUubG9nKGBDb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bCBmb3IgJHtwcm92aWRlcn1gKTtcblx0fVxuXG5cdHByaXZhdGUgc2V0Q29ubmVjdGlvblN0YXR1cyhjb250YWluZXI6IEhUTUxFbGVtZW50LCB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InIHwgJ3Rlc3RpbmcnIHwgJ25vbmUnLCBtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHRpZiAodHlwZSA9PT0gJ25vbmUnKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3Qgc3RhdHVzRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1zdGF0dXMtaW5kaWNhdG9yICR7dHlwZX1gIH0pO1xuXHRcdHN0YXR1c0VsLnRleHRDb250ZW50ID0gbWVzc2FnZTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29ubmVjdGlvblN0YXR1cyhjb250YWluZXI6IEhUTUxFbGVtZW50LCBwcm92aWRlcjogJ2NsYXVkZScgfCAnb3BlbmFpJyB8ICdnb29nbGUnIHwgJ29sbGFtYScpOiB2b2lkIHtcblx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgcmVxdWlyZWQgY29uZmlndXJhdGlvblxuXHRcdGNvbnN0IGhhc0NvbmZpZyA9IHRoaXMuaGFzUHJvdmlkZXJDb25maWcocHJvdmlkZXIpO1xuXHRcdFxuXHRcdGlmICghaGFzQ29uZmlnKSB7XG5cdFx0XHR0aGlzLnNldENvbm5lY3Rpb25TdGF0dXMoY29udGFpbmVyLCAnbm9uZScsICcnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRG9uJ3Qgc2hvdyBhbnl0aGluZyBpbml0aWFsbHkgLSBsZXQgdXNlciB0ZXN0IHdoZW4gcmVhZHlcblx0XHRcdHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cyhjb250YWluZXIsICdub25lJywgJycpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaGFzUHJvdmlkZXJDb25maWcocHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogYm9vbGVhbiB7XG5cdFx0c3dpdGNoIChwcm92aWRlcikge1xuXHRcdFx0Y2FzZSAnY2xhdWRlJzogXG5cdFx0XHRcdHJldHVybiAhIXRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXk7XG5cdFx0XHRjYXNlICdvcGVuYWknOiBcblx0XHRcdFx0cmV0dXJuICEhdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleTtcblx0XHRcdGNhc2UgJ2dvb2dsZSc6IFxuXHRcdFx0XHRyZXR1cm4gISF0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5O1xuXHRcdFx0Y2FzZSAnb2xsYW1hJzogXG5cdFx0XHRcdHJldHVybiAhIXRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsO1xuXHRcdFx0ZGVmYXVsdDogXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUxpY2Vuc2VTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRjb25zdCBsaWNlbnNlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1saWNlbnNlLXNlY3Rpb24nIH0pO1xuXHRcdGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnU3VwZXJub3ZhIFN1cHBvcnRlciBTdGF0dXMnIH0pO1xuXG5cdFx0Ly8gSW5mbyBhYm91dCB0aGUgbmV3IG1vZGVsXG5cdFx0Y29uc3QgaW5mb0VsID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmQgY29tcGFjdFwiPlxuXHRcdFx0XHQ8cD5Ob3ZhIHByb3ZpZGVzIGFsbCBmZWF0dXJlcyBmb3IgZnJlZSB3aGVuIHlvdSB1c2UgeW91ciBvd24gQUkgcHJvdmlkZXIgQVBJIGtleXMuIFxuXHRcdFx0XHRTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gQ3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uaXNTdXBlcm5vdmFTdXBwb3J0ZXIoKSB8fCBmYWxzZTtcblx0XHRjb25zdCBzdXBlcm5vdmFMaWNlbnNlID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmdldFN1cGVybm92YUxpY2Vuc2UoKTtcblx0XHRcblx0XHRjb25zdCBzdGF0dXNEaXNwbGF5ID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1cGVybm92YS1zdGF0dXMnIH0pO1xuXHRcdGNvbnN0IHN0YXR1c1RleHQgPSBpc1N1cGVybm92YSA/ICdTdXBlcm5vdmEgU3VwcG9ydGVyJyA6ICdOb3ZhIFVzZXInO1xuXHRcdGNvbnN0IHN0YXR1c0ljb24gPSBpc1N1cGVybm92YSA/IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHlsZT1cIndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGNvbG9yOiAjOTMzM2VhOyBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCA0cHggcmdiYSgxNDcsIDUxLCAyMzQsIDAuNikpO1wiPlxuXHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdDwvc3ZnPmAgOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3R5bGU9XCJ3aWR0aDogMTRweDsgaGVpZ2h0OiAxNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1wiPlxuXHRcdFx0JHtOT1ZBX0lDT05fU1ZHfVxuXHRcdDwvc3ZnPmA7XG5cdFx0c3RhdHVzRGlzcGxheS5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1zdGF0dXMtYmFkZ2UgJHtpc1N1cGVybm92YSA/ICdzdXBlcm5vdmEnIDogJ25vdmEnfVwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInN0YXR1cy1pY29uXCI+JHtzdGF0dXNJY29ufTwvc3Bhbj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJzdGF0dXMtbmFtZVwiPiR7c3RhdHVzVGV4dH08L3NwYW4+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gU3VwZXJub3ZhIGxpY2Vuc2Ugc3RhdHVzXG5cdFx0aWYgKHN1cGVybm92YUxpY2Vuc2UpIHtcblx0XHRcdGNvbnN0IHN0YXR1c0VsID0gbGljZW5zZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxpY2Vuc2Utc3RhdHVzJyB9KTtcblx0XHRcdGNvbnN0IGV4cGlyeVRleHQgPSBzdXBlcm5vdmFMaWNlbnNlLmV4cGlyZXNBdCBcblx0XHRcdFx0PyBgRXhwaXJlczogJHtzdXBlcm5vdmFMaWNlbnNlLmV4cGlyZXNBdC50b0xvY2FsZURhdGVTdHJpbmcoKX1gXG5cdFx0XHRcdDogJ0xpZmV0aW1lIFN1cHBvcnQnO1xuXHRcdFx0c3RhdHVzRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibGljZW5zZS1pbmZvXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJsaWNlbnNlLWVtYWlsXCI+JHtzdXBlcm5vdmFMaWNlbnNlLmVtYWlsfTwvc3Bhbj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImxpY2Vuc2UtZXhwaXJ5XCI+JHtleHBpcnlUZXh0fTwvc3Bhbj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIFN1cGVybm92YSBsaWNlbnNlIGtleSBpbnB1dCB1c2luZyBzZWN1cmUgaW5wdXQgcGF0dGVyblxuXHRcdHRoaXMuY3JlYXRlU2VjdXJlQXBpS2V5SW5wdXQobGljZW5zZUNvbnRhaW5lciwge1xuXHRcdFx0bmFtZTogJ1N1cGVybm92YSBMaWNlbnNlIEtleSAoT3B0aW9uYWwpJyxcblx0XHRcdGRlc2M6ICdFbnRlciB5b3VyIFN1cGVybm92YSBzdXBwb3J0ZXIgbGljZW5zZSBrZXkgZm9yIGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMnLFxuXHRcdFx0cGxhY2Vob2xkZXI6ICdFbnRlciBTdXBlcm5vdmEgbGljZW5zZSBrZXkuLi4nLFxuXHRcdFx0dmFsdWU6IHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5IHx8ICcnLFxuXHRcdFx0b25DaGFuZ2U6IGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBpbiBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXIgdG8gdXBkYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBjb250ZW50IHRvIHNob3cgdXBkYXRlZCBzdGF0dXNcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRhYkNvbnRlbnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gQWRkIHZhbGlkYXRpb24gYnV0dG9uIHNlcGFyYXRlbHlcblx0XHRjb25zdCB2YWxpZGF0ZVNldHRpbmcgPSBuZXcgU2V0dGluZyhsaWNlbnNlQ29udGFpbmVyKVxuXHRcdFx0LnNldERlc2MoJ1ZhbGlkYXRlIHlvdXIgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5Jylcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IHtcblx0XHRcdFx0YnV0dG9uLnNldEJ1dHRvblRleHQoJ1ZhbGlkYXRlIExpY2Vuc2UnKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IGxpY2Vuc2VLZXkgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleTtcblx0XHRcdFx0XHRcdGlmICghbGljZW5zZUtleSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNob3dMaWNlbnNlTWVzc2FnZSgnUGxlYXNlIGVudGVyIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IGZpcnN0LicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdWYWxpZGF0aW5nLi4uJyk7XG5cdFx0XHRcdFx0XHRidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVTdXBlcm5vdmFMaWNlbnNlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNTdXBlcm5vdmFTdXBwb3J0ZXIoKTtcblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHRpZiAoaXNTdXBlcm5vdmEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdWYWxpZCBTdXBlcm5vdmEgbGljZW5zZSEgWW91IG5vdyBoYXZlIGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuJywgJ3N1Y2Nlc3MnKTtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0NvbmZldHRpKCk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdJbnZhbGlkIG9yIGV4cGlyZWQgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5LicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXIgdG8gdXBkYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGNvbnRlbnQgXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy51cGRhdGVUYWJDb250ZW50KCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdFcnJvciB2YWxpZGF0aW5nIFN1cGVybm92YSBsaWNlbnNlLicsICdlcnJvcicpO1xuXHRcdFx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRcdFx0YnV0dG9uLnNldEJ1dHRvblRleHQoJ1ZhbGlkYXRlIExpY2Vuc2UnKTtcblx0XHRcdFx0XHRcdFx0YnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8vIFN1cGVybm92YSBzdXBwb3J0ZXIgaW5mb3JtYXRpb24gb25seVxuXHRcdHRoaXMuY3JlYXRlU3VwZXJub3ZhSW5mbyhsaWNlbnNlQ29udGFpbmVyKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlU3VwZXJub3ZhSW5mbyhjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Ly8gU3VwZXJub3ZhIHN1cHBvcnRlciBpbmZvcm1hdGlvblxuXHRcdGNvbnN0IHN1cGVybm92YUluZm8gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdXBlcm5vdmEtaW5mbycgfSk7XG5cdFx0c3VwZXJub3ZhSW5mby5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg1PkJlY29tZSBhIFN1cGVybm92YSBTdXBwb3J0ZXI8L2g1PlxuXHRcdFx0XHQ8cD5TdXBwb3J0IE5vdmEgZGV2ZWxvcG1lbnQgYW5kIGdldCBlYXJseSBhY2Nlc3MgdG8gbmV3IGZlYXR1cmVzLiBBbGwgZmVhdHVyZXMgZXZlbnR1YWxseSBiZWNvbWUgZnJlZSBmb3IgZXZlcnlvbmUuPC9wPlxuXHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0PGxpPkVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMgKDMtNiBtb250aHMgYmVmb3JlIGdlbmVyYWwgcmVsZWFzZSk8L2xpPlxuXHRcdFx0XHRcdDxsaT5Qcmlvcml0eSBzdXBwb3J0IGFuZCBmZWF0dXJlIHJlcXVlc3RzPC9saT5cblx0XHRcdFx0XHQ8bGk+U3VwcG9ydGVyIGJhZGdlIGFuZCByZWNvZ25pdGlvbjwvbGk+XG5cdFx0XHRcdFx0PGxpPkRpcmVjdGx5IHN1cHBvcnQgb3Blbi1zb3VyY2UgZGV2ZWxvcG1lbnQ8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlRGVidWdTZXR0aW5ncyhjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgZGVidWdDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kZWJ1Zy1zZWN0aW9uJyB9KTtcblx0XHRkZWJ1Z0NvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdEZXZlbG9wbWVudCBTZXR0aW5ncycgfSk7XG5cblx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdEZWJ1ZyBNb2RlJylcblx0XHRcdC5zZXREZXNjKCdFbmFibGUgZGV2ZWxvcG1lbnQgdGVzdGluZyBmZWF0dXJlcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gUmVmcmVzaCBkaXNwbGF5IHRvIHNob3cvaGlkZSBkZWJ1ZyBvcHRpb25zXG5cdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5lbmFibGVkKSB7XG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ092ZXJyaWRlIERhdGUnKVxuXHRcdFx0XHQuc2V0RGVzYygnT3ZlcnJpZGUgY3VycmVudCBkYXRlIGZvciB0ZXN0aW5nIHRpbWUtZ2F0ZWQgZmVhdHVyZXMgKFlZWVktTU0tREQpJylcblx0XHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCcyMDI1LTEyLTAxJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlIHx8ICcnKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSA9IHZhbHVlIHx8IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIERvbid0IHJlZnJlc2ggZGlzcGxheSBvbiBldmVyeSBrZXlzdHJva2UgLSBqdXN0IHVwZGF0ZSB0aGUgZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0fSkpO1xuXG5cdFx0XHRuZXcgU2V0dGluZyhkZWJ1Z0NvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoJ0ZvcmNlIFN1cGVybm92YSBTdGF0dXMnKVxuXHRcdFx0XHQuc2V0RGVzYygnT3ZlcnJpZGUgU3VwZXJub3ZhIHN1cHBvcnRlciBzdGF0dXMgZm9yIHRlc3RpbmcnKVxuXHRcdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgfHwgZmFsc2UpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmEgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFNob3cgY29uZmV0dGkgd2hlbiB0dXJuaW5nIE9OIEZvcmNlIFN1cGVybm92YVxuXHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0NvbmZldHRpKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBjb250ZW50IHRvIHNob3cgdXBkYXRlZCBmZWF0dXJlIHN0YXR1c1xuXHRcdFx0XHRcdFx0dGhpcy51cGRhdGVUYWJDb250ZW50KCk7XG5cdFx0XHRcdFx0fSkpO1xuXG5cdFx0XHQvLyBDbGVhciBsaWNlbnNlcyBidXR0b25cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnQ2xlYXIgQWxsIExpY2Vuc2VzJylcblx0XHRcdFx0LnNldERlc2MoJ1JlbW92ZSBhbGwgYXBwbGllZCBsaWNlbnNlcyAoZm9yIHRlc3RpbmcpJylcblx0XHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ0NsZWFyIExpY2Vuc2VzJylcblx0XHRcdFx0XHQuc2V0V2FybmluZygpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0Ly8gQ29uZmlybSBhY3Rpb25cblx0XHRcdFx0XHRcdGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciBhbGwgbGljZW5zZXM/IFRoaXMgd2lsbCByZW1vdmUgYW55IGFwcGxpZWQgU3VwZXJub3ZhIGxpY2Vuc2UuJyk7XG5cdFx0XHRcdFx0XHRpZiAoIWNvbmZpcm1lZCkgcmV0dXJuO1xuXG5cdFx0XHRcdFx0XHQvLyBDbGVhciBsaWNlbnNlIGtleVxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgPSAnJztcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gQ2xlYXIgRm9yY2UgU3VwZXJub3ZhIGlmIGVuYWJsZWRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblxuXHRcdFx0XHRcdFx0Ly8gVXBkYXRlIGZlYXR1cmUgbWFuYWdlclxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobnVsbCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXJcblx0XHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gU2hvdyBzdWNjZXNzIG1lc3NhZ2Vcblx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdBbGwgbGljZW5zZXMgY2xlYXJlZCBzdWNjZXNzZnVsbHkuJywgJ3N1Y2Nlc3MnKTtcblxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBjb250ZW50XG5cdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRhYkNvbnRlbnQoKTtcblx0XHRcdFx0XHR9KSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93TGljZW5zZU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InKSB7XG5cdFx0Ly8gQ3JlYXRlIG9yIHVwZGF0ZSBtZXNzYWdlIGVsZW1lbnRcblx0XHRjb25zdCBleGlzdGluZ01lc3NhZ2UgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWxpY2Vuc2UtbWVzc2FnZScpO1xuXHRcdGlmIChleGlzdGluZ01lc3NhZ2UpIHtcblx0XHRcdGV4aXN0aW5nTWVzc2FnZS5yZW1vdmUoKTtcblx0XHR9XG5cblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IFxuXHRcdFx0Y2xzOiBgbm92YS1saWNlbnNlLW1lc3NhZ2UgJHt0eXBlfWAsXG5cdFx0XHR0ZXh0OiBtZXNzYWdlXG5cdFx0fSk7XG5cblx0XHQvLyBBdXRvLXJlbW92ZSBhZnRlciA1IHNlY29uZHNcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdG1lc3NhZ2VFbC5yZW1vdmUoKTtcblx0XHR9LCA1MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbmZldHRpKCkge1xuXHRcdC8vIENyZWF0ZSBjb25mZXR0aSBjb250YWluZXJcblx0XHRjb25zdCBjb25mZXR0aUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdGNvbmZldHRpQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdub3ZhLWNvbmZldHRpLWNvbnRhaW5lcic7XG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb25mZXR0aUNvbnRhaW5lcik7XG5cblx0XHQvLyBHZXQgc2V0dGluZ3MgY29udGFpbmVyIHBvc2l0aW9uIGZvciBleHBsb3Npb24gY2VudGVyXG5cdFx0Y29uc3QgcmVjdCA9IHRoaXMuY29udGFpbmVyRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Y29uc3QgY2VudGVyWCA9IHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyO1xuXHRcdGNvbnN0IGNlbnRlclkgPSByZWN0LnRvcCArIE1hdGgubWluKHJlY3QuaGVpZ2h0IC8gMiwgMzAwKTtcblxuXHRcdC8vIENvbG9ycyBmb3IgY29uZmV0dGlcblx0XHRjb25zdCBjb2xvcnMgPSBbJ2dvbGQnLCAnYmx1ZScsICdwaW5rJywgJ2dyZWVuJywgJ3JlZCcsICcnXTsgIC8vIGVtcHR5IHN0cmluZyA9IGRlZmF1bHQgcHVycGxlXG5cblx0XHQvLyBDcmVhdGUgY29uZmV0dGkgcGllY2VzXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCAxNTA7IGkrKykge1xuXHRcdFx0Y29uc3QgY29uZmV0dGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdGNvbmZldHRpLmNsYXNzTmFtZSA9IGBub3ZhLWNvbmZldHRpLXBpZWNlICR7Y29sb3JzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbG9ycy5sZW5ndGgpXX1gO1xuXHRcdFx0XG5cdFx0XHQvLyBQb3NpdGlvbiBhdCBleHBsb3Npb24gY2VudGVyXG5cdFx0XHRjb25mZXR0aS5zdHlsZS5sZWZ0ID0gYCR7Y2VudGVyWH1weGA7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS50b3AgPSBgJHtjZW50ZXJZfXB4YDtcblx0XHRcdFxuXHRcdFx0Ly8gQ2FsY3VsYXRlIGV4cGxvc2lvbiB0cmFqZWN0b3J5XG5cdFx0XHRjb25zdCBhbmdsZSA9IChNYXRoLlBJICogMiAqIGkpIC8gMTUwICsgKE1hdGgucmFuZG9tKCkgKiAwLjIgLSAwLjEpO1xuXHRcdFx0Y29uc3QgdmVsb2NpdHkgPSAyNTAgKyBNYXRoLnJhbmRvbSgpICogMzUwOyAvLyBwaXhlbHNcblx0XHRcdGNvbnN0IGV4cGxvZGVYID0gTWF0aC5jb3MoYW5nbGUpICogdmVsb2NpdHk7XG5cdFx0XHRjb25zdCBleHBsb2RlWSA9IE1hdGguc2luKGFuZ2xlKSAqIHZlbG9jaXR5IC0gMTUwOyAvLyBTdHJvbmcgdXB3YXJkIGJpYXNcblx0XHRcdFxuXHRcdFx0Ly8gU2V0IENTUyBjdXN0b20gcHJvcGVydGllcyBmb3IgYW5pbWF0aW9uXG5cdFx0XHRjb25mZXR0aS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1leHBsb2RlLXgnLCBgJHtleHBsb2RlWH1weGApO1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUuc2V0UHJvcGVydHkoJy0tZXhwbG9kZS15JywgYCR7ZXhwbG9kZVl9cHhgKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmFuZG9tIGRlbGF5IGZvciBzdGFnZ2VyZWQgZXhwbG9zaW9uXG5cdFx0XHRjb25mZXR0aS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGAke01hdGgucmFuZG9tKCkgKiAwLjJ9c2A7XG5cdFx0XHRcblx0XHRcdC8vIFJhbmRvbSBzaXplXG5cdFx0XHRjb25zdCBzaXplID0gNiArIE1hdGgucmFuZG9tKCkgKiAxNDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLndpZHRoID0gYCR7c2l6ZX1weGA7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS5oZWlnaHQgPSBgJHtzaXplfXB4YDtcblx0XHRcdFxuXHRcdFx0Ly8gTWFrZSBzb21lIGNvbmZldHRpIHJlY3Rhbmd1bGFyXG5cdFx0XHRpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xuXHRcdFx0XHRjb25mZXR0aS5zdHlsZS5oZWlnaHQgPSBgJHtzaXplICogMC40fXB4YDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Y29uZmV0dGlDb250YWluZXIuYXBwZW5kQ2hpbGQoY29uZmV0dGkpO1xuXHRcdH1cblxuXHRcdC8vIFJlbW92ZSBjb250YWluZXIgYWZ0ZXIgYW5pbWF0aW9uIGNvbXBsZXRlc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y29uZmV0dGlDb250YWluZXIucmVtb3ZlKCk7XG5cdFx0fSwgNDAwMCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUdlbmVyYWxTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHQvLyBDb3JlIFNldHRpbmdzIHNlY3Rpb24gd2l0aCBjbGVhbiBoZWFkZXJcblx0XHRjb25zdCBjb3JlU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29yZS1zZXR0aW5ncy1zZWN0aW9uJyB9KTtcblx0XHRjb3JlU2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdDb3JlIFNldHRpbmdzJyB9KTtcblx0XHRcblx0XHQvLyBBZGQgc2VjdGlvbiBzcGFjaW5nIHBlciBzcGVjaWZpY2F0aW9uXG5cdFx0Y29yZVNlY3Rpb24uc3R5bGUubWFyZ2luQm90dG9tID0gJzMycHgnO1xuXG5cdFx0bmV3IFNldHRpbmcoY29yZVNlY3Rpb24pXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBUZW1wZXJhdHVyZScpXG5cdFx0XHQuc2V0RGVzYygnQ29udHJvbHMgcmFuZG9tbmVzcyBpbiBBSSByZXNwb25zZXMgKDAuMCA9IGZvY3VzZWQsIDEuMCA9IGNyZWF0aXZlKScpXG5cdFx0XHQuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcblx0XHRcdFx0LnNldExpbWl0cygwLCAxLCAwLjEpXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRUZW1wZXJhdHVyZSlcblx0XHRcdFx0LnNldER5bmFtaWNUb29sdGlwKClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvcmVTZWN0aW9uKVxuXHRcdFx0LnNldE5hbWUoJ0RlZmF1bHQgTWF4IFRva2VucycpXG5cdFx0XHQuc2V0RGVzYygnTWF4aW11bSBsZW5ndGggb2YgQUkgcmVzcG9uc2VzIChoaWdoZXIgPSBsb25nZXIgcmVzcG9uc2VzKScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAnbnVtYmVyJztcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzE1MHB4Jztcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLmhlaWdodCA9ICc0MHB4Jztcblx0XHRcdFx0cmV0dXJuIHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzEwMDAnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnMudG9TdHJpbmcoKSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBudW1WYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcblx0XHRcdFx0XHRcdGlmICghaXNOYU4obnVtVmFsdWUpICYmIG51bVZhbHVlID4gMCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmRlZmF1bHRNYXhUb2tlbnMgPSBudW1WYWx1ZTtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvcmVTZWN0aW9uKVxuXHRcdFx0LnNldE5hbWUoJ0F1dG8tc2F2ZSBzZXR0aW5ncycpXG5cdFx0XHQuc2V0RGVzYygnQXV0b21hdGljYWxseSBzYXZlIGNvbmZpZ3VyYXRpb24gY2hhbmdlcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuYXV0b1NhdmUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlclNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdC8vIENvbmZpZ3VyZSBZb3VyIEFQSSBLZXlzIFNlY3Rpb25cblx0XHRjb25zdCBhcGlLZXlzU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYXBpLWtleXMtc2VjdGlvbicgfSk7XG5cdFx0YXBpS2V5c1NlY3Rpb24uY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ29uZmlndXJlIFlvdXIgQVBJIEtleXMnIH0pO1xuXHRcdGFwaUtleXNTZWN0aW9uLmNyZWF0ZUVsKCdocicsIHsgY2xzOiAnbm92YS1zZWN0aW9uLWRpdmlkZXInIH0pO1xuXHRcdFxuXHRcdGNvbnN0IGluZm9FbCA9IGFwaUtleXNTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8cD5Ob3ZhIGNvbm5lY3RzIHRvIEFJIHByb3ZpZGVycyB1c2luZyB5b3VyIG93biBBUEkga2V5cy4gQWxsIHByb3ZpZGVycyBhcmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyAtIFxuXHRcdFx0XHRqdXN0IGFkZCB5b3VyIEFQSSBrZXlzIGJlbG93IHRvIGdldCBzdGFydGVkLjwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkIG5vdmEtbW9kZWwtZ3VpZGFuY2VcIj5cblx0XHRcdFx0PGg0PlJlY29tbWVuZGVkIERlZmF1bHRzPC9oND5cblx0XHRcdFx0PHVsIGNsYXNzPVwibm92YS1tb2RlbC1yZWNvbW1lbmRhdGlvbnNcIj5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5DbGF1ZGUgU29ubmV0IDQ8L3N0cm9uZz4gLSBMYXRlc3QgZ2VuZXJhdGlvbiB3aXRoIGV4Y2VsbGVudCBpbnN0cnVjdGlvbiBmb2xsb3dpbmcgZm9yIGNvbGxhYm9yYXRpdmUgZWRpdGluZzwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+R1BULTQuMSBNaW5pPC9zdHJvbmc+IC0gQ3VycmVudC1nZW5lcmF0aW9uIG1vZGVsIHRoYXQgb3V0cGVyZm9ybXMgR1BULTRvIHdoaWxlIHJlbWFpbmluZyBjb3N0LWVmZmVjdGl2ZTwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+R2VtaW5pIDIuNSBGbGFzaDwvc3Ryb25nPiAtIEJlc3QgcHJpY2UvcGVyZm9ybWFuY2Ugd2l0aCBcInRoaW5raW5nXCIgY2FwYWJpbGl0aWVzIGFuZCBzdHJvbmcgY29kaW5nIHN1cHBvcnQ8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHQ8cCBjbGFzcz1cIm5vdmEtZ3VpZGFuY2Utbm90ZVwiPlRoZXNlIGRlZmF1bHRzIG9mZmVyIG1vZGVybiBBSSBjYXBhYmlsaXRpZXMgd2l0aG91dCBwcmVtaXVtIHByaWNpbmcuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIENvbmZpZ3VyYXRpb24gU3Vic2VjdGlvbiAod2l0aGluIEFQSSBLZXlzIHNlY3Rpb24pXG5cdFx0Y29uc3QgY29uZmlnU2VjdGlvbiA9IGFwaUtleXNTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItY29uZmlnLXNlY3Rpb24nIH0pO1xuXHRcdGNvbmZpZ1NlY3Rpb24uY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnQ29uZmlndXJhdGlvbicgfSk7XG5cdFx0Y29uZmlnU2VjdGlvbi5jcmVhdGVFbCgnaHInLCB7IGNsczogJ25vdmEtc2VjdGlvbi1kaXZpZGVyJyB9KTtcblxuXHRcdC8vIFNob3cgYWxsIHByb3ZpZGVycyAtIG5vIHJlc3RyaWN0aW9uc1xuXHRcdHRoaXMuY3JlYXRlT2xsYW1hU2V0dGluZ3MoY29uZmlnU2VjdGlvbik7XG5cdFx0dGhpcy5jcmVhdGVDbGF1ZGVTZXR0aW5ncyhjb25maWdTZWN0aW9uKTtcblx0XHR0aGlzLmNyZWF0ZUdvb2dsZVNldHRpbmdzKGNvbmZpZ1NlY3Rpb24pO1xuXHRcdHRoaXMuY3JlYXRlT3BlbkFJU2V0dGluZ3MoY29uZmlnU2VjdGlvbik7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNsYXVkZVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IGNsYXVkZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0XG5cdFx0Ly8gUHJvdmlkZXIgaGVhZGVyIHdpdGggc3RhdHVzIGluZGljYXRvclxuXHRcdGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGNsYXVkZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWhlYWRlcicgfSk7XG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDbGF1ZGUgKEFudGhyb3BpYyknIH0pO1xuXHRcdFxuXHRcdC8vIEFkZCBzdGF0dXMgaW5kaWNhdG9yIHRvIHRoZSBzYW1lIGg0IGVsZW1lbnRcblx0XHRjb25zdCBzdGF0dXNDb250YWluZXIgPSB0aGlzLmNyZWF0ZVByb3ZpZGVyU3RhdHVzSW5kaWNhdG9yKHRpdGxlRWwsICdjbGF1ZGUnKTtcblx0XHRzdGF0dXNDb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXByb3ZpZGVyJywgJ2NsYXVkZScpO1xuXG5cdFx0dGhpcy5jcmVhdGVTZWN1cmVBcGlLZXlJbnB1dChjbGF1ZGVDb250YWluZXIsIHtcblx0XHRcdG5hbWU6ICdBUEkgS2V5Jyxcblx0XHRcdGRlc2M6ICdZb3VyIEFudGhyb3BpYyBBUEkga2V5Jyxcblx0XHRcdHBsYWNlaG9sZGVyOiAnc2stYW50LS4uLicsXG5cdFx0XHR2YWx1ZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSB8fCAnJyxcblx0XHRcdG9uQ2hhbmdlOiBhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFRlc3QgQ29ubmVjdGlvbiBidXR0b25cblx0XHR0aGlzLmNyZWF0ZVRlc3RDb25uZWN0aW9uQnV0dG9uKGNsYXVkZUNvbnRhaW5lciwgJ2NsYXVkZScpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcoY2xhdWRlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdDbGF1ZGUgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHRkcm9wZG93bi5zZWxlY3RFbC5zdHlsZS53aWR0aCA9ICcyMDBweCc7XG5cdFx0XHRkcm9wZG93bi5zZWxlY3RFbC5zdHlsZS5oZWlnaHQgPSAnNDBweCc7XG5cdFx0XHR0aGlzLnBvcHVsYXRlQ2xhdWRlTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsIHx8ICdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ2xhdWRlIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVDbGF1ZGVNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ2NsYXVkZScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblxuXG5cdHByaXZhdGUgY3JlYXRlT3BlbkFJU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3Qgb3BlbmFpQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHQvLyBQcm92aWRlciBoZWFkZXIgd2l0aCBzdGF0dXMgaW5kaWNhdG9yXG5cdFx0Y29uc3QgaGVhZGVyQ29udGFpbmVyID0gb3BlbmFpQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaGVhZGVyJyB9KTtcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NoYXRHUFQgKE9wZW5BSSknIH0pO1xuXHRcdFxuXHRcdC8vIEFkZCBzdGF0dXMgaW5kaWNhdG9yIHRvIHRoZSBzYW1lIGg0IGVsZW1lbnRcblx0XHRjb25zdCBzdGF0dXNDb250YWluZXIgPSB0aGlzLmNyZWF0ZVByb3ZpZGVyU3RhdHVzSW5kaWNhdG9yKHRpdGxlRWwsICdvcGVuYWknKTtcblx0XHRzdGF0dXNDb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXByb3ZpZGVyJywgJ29wZW5haScpO1xuXG5cdFx0dGhpcy5jcmVhdGVTZWN1cmVBcGlLZXlJbnB1dChvcGVuYWlDb250YWluZXIsIHtcblx0XHRcdG5hbWU6ICdBUEkgS2V5Jyxcblx0XHRcdGRlc2M6ICdZb3VyIE9wZW5BSSBBUEkga2V5Jyxcblx0XHRcdHBsYWNlaG9sZGVyOiAnc2stLi4uJyxcblx0XHRcdHZhbHVlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5IHx8ICcnLFxuXHRcdFx0b25DaGFuZ2U6IGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gVGVzdCBDb25uZWN0aW9uIGJ1dHRvblxuXHRcdHRoaXMuY3JlYXRlVGVzdENvbm5lY3Rpb25CdXR0b24ob3BlbmFpQ29udGFpbmVyLCAnb3BlbmFpJyk7XG5cblx0XHQvLyBNb2RlbCBzZXR0aW5nIHdpdGggcmVmcmVzaCBidXR0b25cblx0XHRjb25zdCBtb2RlbFNldHRpbmcgPSBuZXcgU2V0dGluZyhvcGVuYWlDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwnKVxuXHRcdFx0LnNldERlc2MoJ09wZW5BSSBtb2RlbCB0byB1c2UnKTtcblxuXHRcdGxldCBtb2RlbERyb3Bkb3duOiBhbnk7XG5cdFx0XG5cdFx0bW9kZWxTZXR0aW5nLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcblx0XHRcdG1vZGVsRHJvcGRvd24gPSBkcm9wZG93bjtcblx0XHRcdGRyb3Bkb3duLnNlbGVjdEVsLnN0eWxlLndpZHRoID0gJzIwMHB4Jztcblx0XHRcdGRyb3Bkb3duLnNlbGVjdEVsLnN0eWxlLmhlaWdodCA9ICc0MHB4Jztcblx0XHRcdHRoaXMucG9wdWxhdGVPcGVuQUlNb2RlbHMoZHJvcGRvd24pO1xuXHRcdFx0cmV0dXJuIGRyb3Bkb3duXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkubW9kZWwgfHwgJ2dwdC00LjEtbWluaS0yMDI1LTA0LTE0Jylcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIE9wZW5BSSBtb2RlbHMgYXJlIGhhcmRjb2RlZCAtIG5vIHJlZnJlc2ggbmVlZGVkXG5cdH1cblxuXHRwcml2YXRlIHBvcHVsYXRlT3BlbkFJTW9kZWxzKGRyb3Bkb3duOiBhbnkpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBvcHRpb25zXG5cdFx0ZHJvcGRvd24uc2VsZWN0RWwuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBVc2UgY2VudHJhbGl6ZWQgbW9kZWwgZGVmaW5pdGlvbnNcblx0XHRjb25zdCBjdXJyZW50TW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzKCdvcGVuYWknKTtcblxuXHRcdGN1cnJlbnRNb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24obW9kZWwudmFsdWUsIG1vZGVsLmxhYmVsKTtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR29vZ2xlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3QgZ29vZ2xlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHQvLyBQcm92aWRlciBoZWFkZXIgd2l0aCBzdGF0dXMgaW5kaWNhdG9yXG5cdFx0Y29uc3QgaGVhZGVyQ29udGFpbmVyID0gZ29vZ2xlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaGVhZGVyJyB9KTtcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dvb2dsZSAoR2VtaW5pKScgfSk7XG5cdFx0XG5cdFx0Ly8gQWRkIHN0YXR1cyBpbmRpY2F0b3IgdG8gdGhlIHNhbWUgaDQgZWxlbWVudFxuXHRcdGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IHRoaXMuY3JlYXRlUHJvdmlkZXJTdGF0dXNJbmRpY2F0b3IodGl0bGVFbCwgJ2dvb2dsZScpO1xuXHRcdHN0YXR1c0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvdmlkZXInLCAnZ29vZ2xlJyk7XG5cblx0XHR0aGlzLmNyZWF0ZVNlY3VyZUFwaUtleUlucHV0KGdvb2dsZUNvbnRhaW5lciwge1xuXHRcdFx0bmFtZTogJ0FQSSBLZXknLFxuXHRcdFx0ZGVzYzogJ1lvdXIgR29vZ2xlIEFJIEFQSSBrZXknLFxuXHRcdFx0cGxhY2Vob2xkZXI6ICdBSS4uLicsXG5cdFx0XHR2YWx1ZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSB8fCAnJyxcblx0XHRcdG9uQ2hhbmdlOiBhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFRlc3QgQ29ubmVjdGlvbiBidXR0b25cblx0XHR0aGlzLmNyZWF0ZVRlc3RDb25uZWN0aW9uQnV0dG9uKGdvb2dsZUNvbnRhaW5lciwgJ2dvb2dsZScpO1xuXG5cdFx0Ly8gTW9kZWwgc2V0dGluZyB3aXRoIHJlZnJlc2ggYnV0dG9uXG5cdFx0Y29uc3QgbW9kZWxTZXR0aW5nID0gbmV3IFNldHRpbmcoZ29vZ2xlQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdHZW1pbmkgbW9kZWwgdG8gdXNlJyk7XG5cblx0XHRsZXQgbW9kZWxEcm9wZG93bjogYW55O1xuXHRcdFxuXHRcdG1vZGVsU2V0dGluZy5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRtb2RlbERyb3Bkb3duID0gZHJvcGRvd247XG5cdFx0XHRkcm9wZG93bi5zZWxlY3RFbC5zdHlsZS53aWR0aCA9ICcyMDBweCc7XG5cdFx0XHRkcm9wZG93bi5zZWxlY3RFbC5zdHlsZS5oZWlnaHQgPSAnNDBweCc7XG5cdFx0XHR0aGlzLnBvcHVsYXRlR29vZ2xlTW9kZWxzKGRyb3Bkb3duKTtcblx0XHRcdHJldHVybiBkcm9wZG93blxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsIHx8ICdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLm1vZGVsID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gR29vZ2xlIG1vZGVscyBhcmUgaGFyZGNvZGVkIC0gbm8gcmVmcmVzaCBuZWVkZWRcblx0fVxuXG5cdHByaXZhdGUgcG9wdWxhdGVHb29nbGVNb2RlbHMoZHJvcGRvd246IGFueSkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcblx0XHRkcm9wZG93bi5zZWxlY3RFbC5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBjZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9uc1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMoJ2dvb2dsZScpO1xuXG5cdFx0Y3VycmVudE1vZGVscy5mb3JFYWNoKG1vZGVsID0+IHtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihtb2RlbC52YWx1ZSwgbW9kZWwubGFiZWwpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVPbGxhbWFTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRjb25zdCBvbGxhbWFDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24nIH0pO1xuXHRcdFxuXHRcdC8vIFByb3ZpZGVyIGhlYWRlciB3aXRoIHN0YXR1cyBpbmRpY2F0b3Jcblx0XHRjb25zdCBoZWFkZXJDb250YWluZXIgPSBvbGxhbWFDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1oZWFkZXInIH0pO1xuXHRcdGNvbnN0IHRpdGxlRWwgPSBoZWFkZXJDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnT2xsYW1hIChMb2NhbCknIH0pO1xuXHRcdFxuXHRcdC8vIEFkZCBzdGF0dXMgaW5kaWNhdG9yIHRvIHRoZSBzYW1lIGg0IGVsZW1lbnRcblx0XHRjb25zdCBzdGF0dXNDb250YWluZXIgPSB0aGlzLmNyZWF0ZVByb3ZpZGVyU3RhdHVzSW5kaWNhdG9yKHRpdGxlRWwsICdvbGxhbWEnKTtcblx0XHRzdGF0dXNDb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXByb3ZpZGVyJywgJ29sbGFtYScpO1xuXG5cdFx0bmV3IFNldHRpbmcob2xsYW1hQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0Jhc2UgVVJMJylcblx0XHRcdC5zZXREZXNjKCdPbGxhbWEgc2VydmVyIFVSTCcpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzM1MHB4Jztcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLmhlaWdodCA9ICc0MHB4Jztcblx0XHRcdFx0cmV0dXJuIHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCB8fCAnJylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8vIFRlc3QgQ29ubmVjdGlvbiBidXR0b25cblx0XHR0aGlzLmNyZWF0ZVRlc3RDb25uZWN0aW9uQnV0dG9uKG9sbGFtYUNvbnRhaW5lciwgJ29sbGFtYScpO1xuXG5cdFx0bmV3IFNldHRpbmcob2xsYW1hQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ01vZGVsJylcblx0XHRcdC5zZXREZXNjKCdPbGxhbWEgbW9kZWwgdG8gdXNlJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4ge1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gJzQwcHgnO1xuXHRcdFx0XHRyZXR1cm4gdGV4dFxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignbGxhbWEyJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLm1vZGVsIHx8ICcnKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IENvbnRleHQgTGltaXQnKVxuXHRcdFx0LnNldERlc2MoJ0NvbnRleHQgd2luZG93IHNpemUgZm9yIGFsbCBPbGxhbWEgbW9kZWxzIChOb3ZhIGRlZmF1bHRzIHRvIDMySyB2cyBPbGxhbWFcXCdzIDJLKScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnR5cGUgPSAnbnVtYmVyJztcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzE1MHB4Jztcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLmhlaWdodCA9ICc0MHB4Jztcblx0XHRcdFx0cmV0dXJuIHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzMyMDAwJylcblx0XHRcdFx0XHQuc2V0VmFsdWUoKHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYURlZmF1bHRDb250ZXh0IHx8IDMyMDAwKS50b1N0cmluZygpKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IG51bVZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuXHRcdFx0XHRcdFx0aWYgKCFpc05hTihudW1WYWx1ZSkgJiYgbnVtVmFsdWUgPiAwKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm9sbGFtYURlZmF1bHRDb250ZXh0ID0gbnVtVmFsdWU7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVBsYXRmb3JtU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUGxhdGZvcm0gU2V0dGluZ3MnIH0pO1xuXHRcdFxuXHRcdC8vIEluZm8gYWJvdXQgcGxhdGZvcm0gc2V0dGluZ3Ncblx0XHRjb25zdCBpbmZvRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXBsYXRmb3JtLWluZm8nIH0pO1xuXHRcdGluZm9FbC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0Plx1RDgzRFx1RERBNVx1RkUwRiBQbGF0Zm9ybSBDb25maWd1cmF0aW9uPC9oND5cblx0XHRcdFx0PHA+Q29uZmlndXJlIHdoaWNoIEFJIHByb3ZpZGVyIHRvIHVzZSBhcyB5b3VyIHByaW1hcnkgcHJvdmlkZXIgb24gZGlmZmVyZW50IHBsYXRmb3Jtcy4gXG5cdFx0XHRcdE5vdmEgd29ya3Mgc2VhbWxlc3NseSBhY3Jvc3MgZGVza3RvcCBhbmQgbW9iaWxlIHdpdGggYWxsIHByb3ZpZGVycy48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHRcdFxuXHRcdC8vIFBsYXRmb3JtIHNldHRpbmdzIG1hbmFnZWQgdmlhIHNpZGViYXIgZHJvcGRvd24gbm93XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdNb2RlbCBTZWxlY3Rpb24nKVxuXHRcdFx0LnNldERlc2MoJ01vZGVscyBhcmUgbm93IHNlbGVjdGVkIHVzaW5nIHRoZSBkcm9wZG93biBpbiB0aGUgTm92YSBzaWRlYmFyLiBFYWNoIHBsYXRmb3JtIChkZXNrdG9wL21vYmlsZSkgcmVtZW1iZXJzIGl0cyBzZWxlY3RlZCBtb2RlbCBpbmRlcGVuZGVudGx5LicpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBbGxvd2VkUHJvdmlkZXJzRm9yUGxhdGZvcm0ocGxhdGZvcm06ICdkZXNrdG9wJyB8ICdtb2JpbGUnKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIEFsbCBwcm92aWRlcnMgYXJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgaW4gdGhlIFN1cGVybm92YSBtb2RlbFxuXHRcdHJldHVybiBwbGF0Zm9ybSA9PT0gJ2Rlc2t0b3AnIFxuXHRcdFx0PyBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddXG5cdFx0XHQ6IFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnXTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlcjogUHJvdmlkZXJUeXBlKTogc3RyaW5nIHtcblx0XHRjb25zdCBuYW1lczogUmVjb3JkPFByb3ZpZGVyVHlwZSwgc3RyaW5nPiA9IHtcblx0XHRcdCdjbGF1ZGUnOiAnQ2xhdWRlIChBbnRocm9waWMpJyxcblx0XHRcdCdvcGVuYWknOiAnQ2hhdEdQVCAoT3BlbkFJKScsXG5cdFx0XHQnZ29vZ2xlJzogJ0dvb2dsZSAoR2VtaW5pKScsIFxuXHRcdFx0J29sbGFtYSc6ICdPbGxhbWEgKExvY2FsKScsXG5cdFx0XHQnbm9uZSc6ICdOb25lIChEaXNhYmxlZCknXG5cdFx0fTtcblx0XHRyZXR1cm4gbmFtZXNbcHJvdmlkZXJdIHx8IHByb3ZpZGVyO1xuXHR9XG5cblx0YXN5bmMgc2V0Q3VycmVudE1vZGVsKG1vZGVsSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5zZWxlY3RlZE1vZGVsID0gbW9kZWxJZDtcblx0XHRcblx0XHQvLyBVcGRhdGUgdGhlIHByb3ZpZGVyIG1hbmFnZXIgd2l0aCBuZXcgc2V0dGluZ3Ncblx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUNvbW1hbmRTZXR0aW5ncyhjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwpIHtcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdDdXN0b20gQ29tbWFuZHMnIH0pO1xuXG5cdFx0Ly8gRmVhdHVyZSBhdmFpbGFiaWxpdHkgY2hlY2tcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IG5vdGljZUVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1mZWF0dXJlLW5vdGljZScgfSk7XG5cdFx0XHRub3RpY2VFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAxNnB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgYm9yZGVyLXJhZGl1czogOHB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XCI+XG5cdFx0XHRcdFx0PGg0IHN0eWxlPVwibWFyZ2luOiAwIDAgOHB4IDA7IGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XCI+U3VwZXJub3ZhIFN1cHBvcnRlciBGZWF0dXJlPC9oND5cblx0XHRcdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtO1wiPlxuXHRcdFx0XHRcdFx0Q3VzdG9tIGNvbW1hbmRzIGFyZSBjdXJyZW50bHkgYXZhaWxhYmxlIHRvIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBcblx0XHRcdFx0XHRcdFRoZXkgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uIDxzdHJvbmc+T2N0b2JlciAxLCAyMDI1PC9zdHJvbmc+LlxuXHRcdFx0XHRcdDwvcD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIERlc2NyaXB0aW9uXG5cdFx0Y29uc3QgZGVzY0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2NyaXB0aW9uJyB9KTtcblx0XHRkZXNjRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PHAgc3R5bGU9XCJjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IG1hcmdpbi1ib3R0b206IDE2cHg7XCI+XG5cdFx0XHRcdENyZWF0ZSBjdXN0b20gY29tbWFuZCBzaG9ydGN1dHMgdGhhdCBpbnNlcnQgcHJlZGVmaW5lZCB0ZXh0IHRlbXBsYXRlcyB3aGVuIHRyaWdnZXJlZCB3aXRoIDxjb2RlPjp0cmlnZ2VyPC9jb2RlPi5cblx0XHRcdDwvcD5cblx0XHRgO1xuXG5cdFx0Ly8gU2hvdyBDb21tYW5kIEJ1dHRvbiBzZXR0aW5nIChTdXBlcm5vdmEtb25seSwgTW9iaWxlLW9ubHkpXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnU2hvdyBDb21tYW5kIEJ1dHRvbiBpbiBDaGF0IChNb2JpbGUpJylcblx0XHRcdC5zZXREZXNjKCdTaG93IHRoZSBDb21tYW5kcyBidXR0b24gYmVzaWRlIHRoZSBTZW5kIGJ1dHRvbiBmb3IgbW9iaWxlIHF1aWNrIGFjY2VzcyB0byBOb3ZhIGNvbW1hbmRzIGFuZCBzZWxlY3Rpb24gYWN0aW9ucycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b24gPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBGaW5kIGFuZCByZWZyZXNoIHNpZGViYXIgdmlld1xuXHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gQWRkIG5ldyBjb21tYW5kIGJ1dHRvbiBhdCB0aGUgdG9wXG5cdFx0Y29uc3QgYnV0dG9uRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWFkZC1jb21tYW5kJyB9KTtcblx0XHRidXR0b25FbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbi1ib3R0b206IDE2cHg7Jztcblx0XHRcblx0XHRuZXcgU2V0dGluZyhidXR0b25FbClcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IFxuXHRcdFx0XHRidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnKyBBZGQgQ3VzdG9tIENvbW1hbmQnKVxuXHRcdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHRoaXMuc2hvd0FkZENvbW1hbmREaWFsb2coKSlcblx0XHRcdCk7XG5cblx0XHQvLyBDb21tYW5kcyBsaXN0XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29udGFpbmVyRWwpO1xuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJDdXN0b21Db21tYW5kc0xpc3QoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIGNvbW1hbmRzIGxpc3Rcblx0XHRjb25zdCBleGlzdGluZ0xpc3QgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtY29tbWFuZHMtbGlzdCcpO1xuXHRcdGlmIChleGlzdGluZ0xpc3QpIGV4aXN0aW5nTGlzdC5yZW1vdmUoKTtcblxuXHRcdGNvbnN0IGNvbW1hbmRzTGlzdCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWxpc3QnIH0pO1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgfHwgW107XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRjb25zdCBlbXB0eUVsID0gY29tbWFuZHNMaXN0LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZHMtZW1wdHknIH0pO1xuXHRcdFx0ZW1wdHlFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmc6IDI0cHg7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcIj5cblx0XHRcdFx0XHQ8cD5ObyBjdXN0b20gY29tbWFuZHMgeWV0LjwvcD5cblx0XHRcdFx0XHQ8cCBzdHlsZT1cImZvbnQtc2l6ZTogMC45ZW07XCI+Q3JlYXRlIHlvdXIgZmlyc3QgY29tbWFuZCB0byBnZXQgc3RhcnRlZCE8L3A+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb21tYW5kcy5mb3JFYWNoKChjb21tYW5kLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgY29tbWFuZEVsID0gY29tbWFuZHNMaXN0LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pdGVtJyB9KTtcblx0XHRcdGNvbW1hbmRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdFx0cGFkZGluZzogMTZweDtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogMTJweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGA7XG5cblx0XHRcdC8vIENvbW1hbmQgaGVhZGVyXG5cdFx0XHRjb25zdCBoZWFkZXJFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaGVhZGVyJyB9KTtcblx0XHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogZmxleC1zdGFydDsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cblx0XHRcdGNvbnN0IGluZm9FbCA9IGhlYWRlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pbmZvJyB9KTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1uYW1lJyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA2MDA7IG1hcmdpbi1ib3R0b206IDRweDsnO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpbmZvRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXInIH0pO1xuXHRcdFx0dHJpZ2dlckVsLmlubmVySFRNTCA9IGA8Y29kZT46JHtjb21tYW5kLnRyaWdnZXJ9PC9jb2RlPmA7XG5cdFx0XHR0cmlnZ2VyRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgZm9udC1zaXplOiAwLjllbTsnO1xuXG5cdFx0XHQvLyBBY3Rpb25zXG5cdFx0XHRjb25zdCBhY3Rpb25zRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtYWN0aW9ucycgfSk7XG5cdFx0XHRhY3Rpb25zRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBnYXA6IDhweDsnO1xuXG5cdFx0XHRjb25zdCBlZGl0QnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdFZGl0JyB9KTtcblx0XHRcdGVkaXRCdG4uc3R5bGUuY3NzVGV4dCA9ICdwYWRkaW5nOiA0cHggOHB4OyBmb250LXNpemU6IDAuOGVtOyBib3JkZXItcmFkaXVzOiA0cHg7Jztcblx0XHRcdGVkaXRCdG4ub25jbGljayA9ICgpID0+IHRoaXMuc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4KTtcblxuXHRcdFx0Y29uc3QgZGVsZXRlQnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdEZWxldGUnIH0pO1xuXHRcdFx0ZGVsZXRlQnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnO1xuXHRcdFx0ZGVsZXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmRlbGV0ZUNvbW1hbmQoaW5kZXgpO1xuXG5cdFx0XHQvLyBEZXNjcmlwdGlvbiBhbmQgdGVtcGxhdGUgcHJldmlld1xuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gY29tbWFuZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdFx0ZGVzY0VsLnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IDAuOWVtOyBtYXJnaW4tYm90dG9tOiA4cHg7Jztcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdGVtcGxhdGVFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtdGVtcGxhdGUnIH0pO1xuXHRcdFx0dGVtcGxhdGVFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgcGFkZGluZzogOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7IGZvbnQtc2l6ZTogMC44ZW07IHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsgbWF4LWhlaWdodDogNjBweDsgb3ZlcmZsb3cteTogYXV0bztcIj5cblx0XHRcdFx0XHQke2NvbW1hbmQudGVtcGxhdGV9XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0FkZENvbW1hbmREaWFsb2coKSB7XG5cdFx0dGhpcy5zaG93Q29tbWFuZERpYWxvZygpO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93RWRpdENvbW1hbmREaWFsb2coaW5kZXg6IG51bWJlcikge1xuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uW2luZGV4XTtcblx0XHRpZiAoY29tbWFuZCkge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZERpYWxvZyhjb21tYW5kLCBpbmRleCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZERpYWxvZyhleGlzdGluZ0NvbW1hbmQ/OiBDdXN0b21Db21tYW5kLCBlZGl0SW5kZXg/OiBudW1iZXIpIHtcblx0XHQvLyBGb3Igbm93LCB1c2UgYSBzaW1wbGUgcHJvbXB0LWJhc2VkIGFwcHJvYWNoXG5cdFx0Ly8gVE9ETzogSW1wbGVtZW50IHByb3BlciBtb2RhbCB3aGVuIE1vZGFsIGNsYXNzIGlzIHByb3Blcmx5IGF2YWlsYWJsZVxuXHRcdGNvbnN0IG5hbWUgPSBwcm9tcHQoJ0NvbW1hbmQgbmFtZTonLCBleGlzdGluZ0NvbW1hbmQ/Lm5hbWUgfHwgJycpO1xuXHRcdGlmICghbmFtZSkgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IHRyaWdnZXIgPSBwcm9tcHQoJ0NvbW1hbmQgdHJpZ2dlciAod2l0aG91dCA6KTonLCBleGlzdGluZ0NvbW1hbmQ/LnRyaWdnZXIgfHwgJycpO1xuXHRcdGlmICghdHJpZ2dlcikgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IGRlc2NyaXB0aW9uID0gcHJvbXB0KCdEZXNjcmlwdGlvbiAob3B0aW9uYWwpOicsIGV4aXN0aW5nQ29tbWFuZD8uZGVzY3JpcHRpb24gfHwgJycpO1xuXHRcdFxuXHRcdGNvbnN0IHRlbXBsYXRlID0gcHJvbXB0KCdUZW1wbGF0ZSBjb250ZW50OicsIGV4aXN0aW5nQ29tbWFuZD8udGVtcGxhdGUgfHwgJycpO1xuXHRcdGlmICghdGVtcGxhdGUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCByZXN1bHQ6IEN1c3RvbUNvbW1hbmQgPSB7XG5cdFx0XHRpZDogZXhpc3RpbmdDb21tYW5kPy5pZCB8fCAoJ2NtZF8nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpKSxcblx0XHRcdG5hbWUsXG5cdFx0XHR0cmlnZ2VyOiB0cmlnZ2VyLnRvTG93ZXJDYXNlKCksXG5cdFx0XHR0ZW1wbGF0ZSxcblx0XHRcdGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCB1bmRlZmluZWRcblx0XHR9O1xuXHRcdFxuXHRcdGlmIChlZGl0SW5kZXggIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0Ly8gRWRpdCBleGlzdGluZyBjb21tYW5kXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyA9IFtdO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbZWRpdEluZGV4XSA9IHJlc3VsdDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gQWRkIG5ldyBjb21tYW5kXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzKSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcyA9IFtdO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMucHVzaChyZXN1bHQpO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdCh0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmQtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50KTtcblx0fVxuXG5cdHByaXZhdGUgZGVsZXRlQ29tbWFuZChpbmRleDogbnVtYmVyKSB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IGNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kc1tpbmRleF07XG5cdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybShgRGVsZXRlIGNvbW1hbmQgXCIke2NvbW1hbmQubmFtZX1cIiAoJHtjb21tYW5kLnRyaWdnZXJ9KT9gKTtcblx0XHRcblx0XHRpZiAoY29uZmlybWVkKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbW1hbmRzTGlzdCh0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmQtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVdlbGNvbWVTZWN0aW9uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCB3ZWxjb21lU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUtc2VjdGlvbicgfSk7XG5cdFx0XG5cdFx0Ly8gTm92YSBsb2dvIGFuZCB0aXRsZVxuXHRcdGNvbnN0IGhlYWRlckRpdiA9IHdlbGNvbWVTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtd2VsY29tZS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckRpdi5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS13ZWxjb21lLWxvZ29cIj5cblx0XHRcdFx0JHtOT1ZBX0lDT05fU1ZHfVxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS13ZWxjb21lLWNvbnRlbnRcIj5cblx0XHRcdFx0PGgyPldlbGNvbWUgdG8gTm92YTwvaDI+XG5cdFx0XHRcdDxwIGNsYXNzPVwibm92YS10YWdsaW5lXCI+WW91ciBBSSB3cml0aW5nIHBhcnRuZXIgdG8gbWFrZSB0aGUgd3JpdGluZyBwcm9jZXNzIHNtb290aGVyPC9wPlxuXHRcdFx0XHQ8cCBjbGFzcz1cIm5vdmEtc3RvcnlcIj5SZW1vdmVzIHRoZSBmcmljdGlvbiBvZiBjb3B5L3Bhc3RlIGZyb20gTExNcyB0byBPYnNpZGlhbiwgYW5kIHByb3ZpZGVzIGFjdGlvbmFibGUgaW5zaWdodHMgdG8gaGVscCBpbXByb3ZlIHlvdXIgd3JpdGluZzwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVF1aWNrU3RhcnRHdWlkZShjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgZ3VpZGVTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcXVpY2stc3RhcnQtc2VjdGlvbicgfSk7XG5cdFx0Z3VpZGVTZWN0aW9uLnN0eWxlLm1hcmdpblRvcCA9ICczMnB4Jztcblx0XHRcblx0XHQvLyBTZWxlY3Rpb24tQmFzZWQgRWRpdGluZ1xuXHRcdGNvbnN0IHNlbGVjdGlvbkNhcmQgPSBndWlkZVNlY3Rpb24uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1xdWljay1zdGFydC1jYXJkJyB9KTtcblx0XHRzZWxlY3Rpb25DYXJkLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtaGVhZGVyXCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1jYXJkLWljb25cIj5cdUQ4M0NcdURGQUY8L3NwYW4+XG5cdFx0XHRcdDxoND5TZWxlY3Rpb24tQmFzZWQgRWRpdGluZzwvaDQ+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtY29udGVudFwiPlxuXHRcdFx0XHQ8b2w+XG5cdFx0XHRcdFx0PGxpPlNlbGVjdCBhbnkgdGV4dCBpbiB5b3VyIGRvY3VtZW50PC9saT5cblx0XHRcdFx0XHQ8bGk+UmlnaHQtY2xpY2sgdG8gb3BlbiBjb250ZXh0IG1lbnU8L2xpPlxuXHRcdFx0XHRcdDxsaT5DaG9vc2UgTm92YSBhY3Rpb24gKEltcHJvdmUgV3JpdGluZywgTWFrZSBMb25nZXIpPC9saT5cblx0XHRcdFx0XHQ8bGk+V2F0Y2ggQUkgdHJhbnNmb3JtIHRleHQgZXhhY3RseSBpbiBwbGFjZTwvbGk+XG5cdFx0XHRcdDwvb2w+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpcFwiPlx1RDgzRFx1RENBMSBUaXA6IFNlbGVjdCBhbnkgdGV4dCBpbiB5b3VyIGRvY3VtZW50IGFuZCByaWdodC1jbGljayB0byBzZWUgTm92YSBhY3Rpb25zPC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gQ2hhdCBDb21tYW5kc1xuXHRcdGNvbnN0IGNoYXRDYXJkID0gZ3VpZGVTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcXVpY2stc3RhcnQtY2FyZCcgfSk7XG5cdFx0Y2hhdENhcmQuc3R5bGUubWFyZ2luVG9wID0gJzI0cHgnO1xuXHRcdGNoYXRDYXJkLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtaGVhZGVyXCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1jYXJkLWljb25cIj5cdUQ4M0RcdURDQUM8L3NwYW4+XG5cdFx0XHRcdDxoND5DaGF0LUJhc2VkIFRhcmdldGluZzwvaDQ+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtY29udGVudFwiPlxuXHRcdFx0XHQ8b2w+XG5cdFx0XHRcdFx0PGxpPlBsYWNlIGN1cnNvciB3aGVyZSB5b3Ugd2FudCBjb250ZW50PC9saT5cblx0XHRcdFx0XHQ8bGk+VHlwZSBjb21tYW5kOiBcIkFkZCBjb25jbHVzaW9uIHNlY3Rpb25cIjwvbGk+XG5cdFx0XHRcdFx0PGxpPk5vdmEgZWRpdHMgcHJlY2lzZWx5IGF0IGN1cnNvciBsb2NhdGlvbjwvbGk+XG5cdFx0XHRcdDwvb2w+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXRpcFwiPlx1RDgzRFx1RENGMSBXb3JrcyBpZGVudGljYWxseSBvbiBkZXNrdG9wIGFuZCBtb2JpbGU8L2Rpdj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBBSSBQcm92aWRlciBTZWxlY3Rpb25cblx0XHRjb25zdCBwcm92aWRlckNhcmQgPSBndWlkZVNlY3Rpb24uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1xdWljay1zdGFydC1jYXJkJyB9KTtcblx0XHRwcm92aWRlckNhcmQuc3R5bGUubWFyZ2luVG9wID0gJzI0cHgnO1xuXHRcdHByb3ZpZGVyQ2FyZC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jYXJkLWhlYWRlclwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtY2FyZC1pY29uXCI+XHVEODNFXHVERDE2PC9zcGFuPlxuXHRcdFx0XHQ8aDQ+QUkgUHJvdmlkZXIgU2VsZWN0aW9uPC9oND5cblx0XHRcdDwvZGl2PlxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtY2FyZC1jb250ZW50XCI+XG5cdFx0XHRcdDxwPkNob29zZSB0aGUgcmlnaHQgQUkgZm9yIHlvdXIgdGFzazo8L3A+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5DbGF1ZGU8L3N0cm9uZz4gLSBGb3IgY29tcGxleCByZWFzb25pbmcgYW5kIGFuYWx5c2lzPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5PcGVuQUk8L3N0cm9uZz4gLSBGb3IgYmFsYW5jZWQgcGVyZm9ybWFuY2UgYW5kIGNyZWF0aXZpdHk8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkdlbWluaTwvc3Ryb25nPiAtIEZvciBmYXN0IHJlc3BvbnNlcyBhbmQgcmVzZWFyY2g8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPk9sbGFtYTwvc3Ryb25nPiAtIEZvciBsb2NhbCBwcml2YWN5IGFuZCBvZmZsaW5lIHVzZSBcdUQ4M0RcdUREMTI8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aXBcIj5Db25maWd1cmUgcHJvdmlkZXJzIGluIHRoZSBBSSBQcm92aWRlcnMgdGFiPC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblxuXHRwcml2YXRlIGNyZWF0ZVN1cGVybm92YUxpY2Vuc2VJbnB1dChjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Ly8gQ3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uaXNTdXBlcm5vdmFTdXBwb3J0ZXIoKSB8fCBmYWxzZTtcblx0XHRjb25zdCBzdXBlcm5vdmFMaWNlbnNlID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmdldFN1cGVybm92YUxpY2Vuc2UoKTtcblx0XHRcblx0XHQvLyBTdGF0dXMgZGlzcGxheVxuXHRcdGlmIChzdXBlcm5vdmFMaWNlbnNlKSB7XG5cdFx0XHRjb25zdCBzdGF0dXNFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxpY2Vuc2Utc3RhdHVzJyB9KTtcblx0XHRcdGNvbnN0IGV4cGlyeVRleHQgPSBzdXBlcm5vdmFMaWNlbnNlLmV4cGlyZXNBdCBcblx0XHRcdFx0PyBgRXhwaXJlczogJHtzdXBlcm5vdmFMaWNlbnNlLmV4cGlyZXNBdC50b0xvY2FsZURhdGVTdHJpbmcoKX1gXG5cdFx0XHRcdDogJ0xpZmV0aW1lIFN1cHBvcnQnO1xuXHRcdFx0c3RhdHVzRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibGljZW5zZS1pbmZvXCIgc3R5bGU9XCJtYXJnaW4tYm90dG9tOiAxNnB4OyBwYWRkaW5nOiAxMnB4OyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWZvcm0tZmllbGQpOyBib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XCI+XG5cdFx0XHRcdFx0PGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj5cblx0XHRcdFx0XHRcdDxzcGFuIHN0eWxlPVwiY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcIj4ke3N1cGVybm92YUxpY2Vuc2UuZW1haWx9PC9zcGFuPlxuXHRcdFx0XHRcdFx0PHNwYW4gc3R5bGU9XCJjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07XCI+JHtleHBpcnlUZXh0fTwvc3Bhbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIExpY2Vuc2Uga2V5IGlucHV0IC0gc3R5bGVkIGxpa2UgQVBJIGtleXNcblx0XHR0aGlzLmNyZWF0ZVNlY3VyZUFwaUtleUlucHV0KGNvbnRhaW5lciwge1xuXHRcdFx0bmFtZTogJ0xpY2Vuc2UgS2V5Jyxcblx0XHRcdGRlc2M6ICdFbnRlciB5b3VyIFN1cGVybm92YSBzdXBwb3J0ZXIgbGljZW5zZSBrZXknLFxuXHRcdFx0cGxhY2Vob2xkZXI6ICdOT1ZBLVhYWFgtWFhYWC1YWFhYJyxcblx0XHRcdHZhbHVlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSB8fCAnJyxcblx0XHRcdG9uQ2hhbmdlOiBhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgPSB2YWx1ZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBVcGRhdGUgU3VwZXJub3ZhIGxpY2Vuc2UgaW4gZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UodmFsdWUgfHwgbnVsbCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIpO1xuXHRcdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRzaWRlYmFyVmlldy5yZWZyZXNoU3VwZXJub3ZhVUkoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gUmVmcmVzaCB0aGUgY29udGVudCB0byBzaG93IHVwZGF0ZWQgc3RhdHVzXG5cdFx0XHRcdFx0dGhpcy51cGRhdGVUYWJDb250ZW50KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIEFkZCB2YWxpZGF0aW9uIHN0YXR1cyBtZXNzYWdlIGlmIG5lZWRlZFxuXHRcdGNvbnN0IHZhbGlkYXRpb25FbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXZhbGlkYXRpb24tc3RhdHVzJyB9KTtcblx0XHR2YWxpZGF0aW9uRWwuc3R5bGUubWFyZ2luVG9wID0gJzhweCc7XG5cdFx0dmFsaWRhdGlvbkVsLnN0eWxlLmZvbnRTaXplID0gJzAuOWVtJztcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlU3VwZXJub3ZhQ1RBKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIG9wdGlvbnM6IHtcblx0XHRzaG93T25seUlmTm90U3VwcG9ydGVyPzogYm9vbGVhbjtcblx0XHRidXR0b25BY3Rpb24/OiAndGFiJyB8ICdkaXJlY3QnO1xuXHRcdHNob3dMZWFybk1vcmU/OiBib29sZWFuO1xuXHRcdG1hcmdpblRvcD86IHN0cmluZztcblx0XHRtYXJnaW5Cb3R0b20/OiBzdHJpbmc7XG5cdH0gPSB7fSk6IHZvaWQge1xuXHRcdC8vIERlZmF1bHQgb3B0aW9uc1xuXHRcdGNvbnN0IHtcblx0XHRcdHNob3dPbmx5SWZOb3RTdXBwb3J0ZXIgPSBmYWxzZSxcblx0XHRcdGJ1dHRvbkFjdGlvbiA9ICd0YWInLFxuXHRcdFx0c2hvd0xlYXJuTW9yZSA9IHRydWUsXG5cdFx0XHRtYXJnaW5Ub3AgPSAnMCcsXG5cdFx0XHRtYXJnaW5Cb3R0b20gPSAnMzJweCdcblx0XHR9ID0gb3B0aW9ucztcblx0XHRcblx0XHQvLyBDaGVjayBzdXBwb3J0ZXIgc3RhdHVzXG5cdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcj8uaXNTdXBlcm5vdmFTdXBwb3J0ZXIoKSB8fCBmYWxzZTtcblx0XHRcblx0XHQvLyBEb24ndCByZW5kZXIgaWYgdXNlciBpcyBhbHJlYWR5IGEgc3VwcG9ydGVyIGFuZCB3ZSBvbmx5IHdhbnQgdG8gc2hvdyBmb3Igbm9uLXN1cHBvcnRlcnNcblx0XHRpZiAoc2hvd09ubHlJZk5vdFN1cHBvcnRlciAmJiBpc1N1cGVybm92YSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBzdGF0dXNUZXh0ID0gaXNTdXBlcm5vdmEgPyAnU3VwZXJub3ZhIFN1cHBvcnRlcicgOiAnTm92YSBVc2VyJztcblx0XHRjb25zdCBzdGF0dXNJY29uID0gaXNTdXBlcm5vdmEgPyAnXHUyQjUwJyA6ICdcdUQ4M0NcdURGMUYnO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB0aGUgQ1RBIHNlY3Rpb25cblx0XHRjb25zdCBjdGFTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvbWluZW50LXN1cGVybm92YS1zZWN0aW9uJyB9KTtcblx0XHRjdGFTZWN0aW9uLnN0eWxlLm1hcmdpblRvcCA9IG1hcmdpblRvcDtcblx0XHRjdGFTZWN0aW9uLnN0eWxlLm1hcmdpbkJvdHRvbSA9IG1hcmdpbkJvdHRvbTtcblx0XHRcblx0XHRjdGFTZWN0aW9uLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXN1cGVybm92YS1jdGFcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3VwZXJub3ZhLWhlYWRlclwiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1zdXBlcm5vdmEtaWNvblwiPiR7c3RhdHVzSWNvbn08L3NwYW4+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3VwZXJub3ZhLWluZm9cIj5cblx0XHRcdFx0XHRcdDxoMz5TdXBlcm5vdmEgU3VwcG9ydDwvaDM+XG5cdFx0XHRcdFx0XHQ8cD5TdGF0dXM6IDxzdHJvbmc+JHtzdGF0dXNUZXh0fTwvc3Ryb25nPjwvcD5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXN1cGVybm92YS1hY3Rpb25zXCI+XG5cdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm5vdmEtc3VwZXJub3ZhLWJ0biBwcmltYXJ5XCIgJHtidXR0b25BY3Rpb24gPT09ICd0YWInID8gJ2RhdGEtdGFiPVwic3VwZXJub3ZhXCInIDogJyd9PlxuXHRcdFx0XHRcdFx0JHtpc1N1cGVybm92YSA/IChidXR0b25BY3Rpb24gPT09ICd0YWInID8gJ01hbmFnZSBMaWNlbnNlJyA6ICdUaGFuayBZb3UgZm9yIFN1cHBvcnRpbmchJykgOiAnQmVjb21lIGEgU3VwcG9ydGVyJ31cblx0XHRcdFx0XHQ8L2J1dHRvbj5cblx0XHRcdFx0XHQke3Nob3dMZWFybk1vcmUgPyAnPGJ1dHRvbiBjbGFzcz1cIm5vdmEtc3VwZXJub3ZhLWJ0biBzZWNvbmRhcnlcIiBkYXRhLXRhYj1cInN1cGVybm92YVwiPkxlYXJuIE1vcmU8L2J1dHRvbj4nIDogJyd9XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBZGQgY2xpY2sgaGFuZGxlcnMgaWYgdXNpbmcgdGFiIG5hdmlnYXRpb25cblx0XHRpZiAoYnV0dG9uQWN0aW9uID09PSAndGFiJykge1xuXHRcdFx0Y3RhU2VjdGlvbi5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10YWI9XCJzdXBlcm5vdmFcIl0nKS5mb3JFYWNoKGJ1dHRvbiA9PiB7XG5cdFx0XHRcdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdHRoaXMuc3dpdGNoVGFiKCdzdXBlcm5vdmEnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZU5hdmlnYXRpb25IZWxwKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHRjb25zdCBuYXZTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbmF2aWdhdGlvbi1zZWN0aW9uJyB9KTtcblx0XHRuYXZTZWN0aW9uLnN0eWxlLm1hcmdpblRvcCA9ICczMnB4Jztcblx0XHRcblx0XHRjb25zdCBuYXZDYXJkID0gbmF2U2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW5hdmlnYXRpb24tY2FyZCcgfSk7XG5cdFx0bmF2Q2FyZC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jYXJkLWhlYWRlclwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtY2FyZC1pY29uXCI+XHVEODNEXHVEQ0RBPC9zcGFuPlxuXHRcdFx0XHQ8aDQ+TmV4dCBTdGVwczwvaDQ+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtY29udGVudFwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1uZXh0LXN0ZXBzXCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtbmV4dC1zdGVwXCI+XG5cdFx0XHRcdFx0XHQ8c3Bhbj4xLiBDb25maWd1cmUgQUkgcHJvdmlkZXJzPC9zcGFuPlxuXHRcdFx0XHRcdFx0PGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5vdmEtc3RlcC1saW5rXCIgZGF0YS10YWI9XCJwcm92aWRlcnNcIj5cdTIxOTIgR28gdG8gQUkgUHJvdmlkZXJzIHRhYjwvYT5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1uZXh0LXN0ZXBcIj5cblx0XHRcdFx0XHRcdDxzcGFuPjIuIEV4cGxvcmUgUHJpdmFjeSBhbmQgR2VuZXJhbCBTZXR0aW5nczwvc3Bhbj5cblx0XHRcdFx0XHRcdDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJub3ZhLXN0ZXAtbGlua1wiIGRhdGEtdGFiPVwiZ2VuZXJhbFwiPlx1MjE5MiBHbyB0byBHZW5lcmFsIHRhYjwvYT5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1uZXh0LXN0ZXBcIj5cblx0XHRcdFx0XHRcdDxzcGFuPjMuIE1hbmFnZSBTdXBlcm5vdmEgTGljZW5zZTwvc3Bhbj5cblx0XHRcdFx0XHRcdDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJub3ZhLXN0ZXAtbGlua1wiIGRhdGEtdGFiPVwic3VwZXJub3ZhXCI+XHUyMTkyIEdvIHRvIFN1cGVybm92YSB0YWI8L2E+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEFkZCBjbGljayBoYW5kbGVycyBmb3IgbmF2aWdhdGlvbiBsaW5rc1xuXHRcdG5hdkNhcmQucXVlcnlTZWxlY3RvckFsbCgnLm5vdmEtc3RlcC1saW5rJykuZm9yRWFjaChsaW5rID0+IHtcblx0XHRcdGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGNvbnN0IHRhYklkID0gKGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiJykgYXMgJ2dlbmVyYWwnIHwgJ3Byb3ZpZGVycycgfCAnc3VwZXJub3ZhJztcblx0XHRcdFx0dGhpcy5zd2l0Y2hUYWIodGFiSWQpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlLCBOb3RpY2UsIE1hcmtkb3duVmlldywgUGxhdGZvcm0sIHNldEljb24sIEVkaXRvclBvc2l0aW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRBbmFseXplciB9IGZyb20gJy4uL2NvcmUvZG9jdW1lbnQtYW5hbHlzaXMnO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IE11bHRpRG9jQ29udGV4dCB9IGZyb20gJy4vY29udGV4dC1tYW5hZ2VyJztcbmltcG9ydCB7IGdldEF2YWlsYWJsZU1vZGVscyB9IGZyb20gJy4uL2FpL21vZGVscyc7XG5pbXBvcnQgeyBJbnB1dEhhbmRsZXIgfSBmcm9tICcuL2lucHV0LWhhbmRsZXInO1xuaW1wb3J0IHsgQ29tbWFuZFN5c3RlbSB9IGZyb20gJy4vY29tbWFuZC1zeXN0ZW0nO1xuaW1wb3J0IHsgQ29udGV4dE1hbmFnZXIgfSBmcm9tICcuL2NvbnRleHQtbWFuYWdlcic7XG5pbXBvcnQgeyBDaGF0UmVuZGVyZXIgfSBmcm9tICcuL2NoYXQtcmVuZGVyZXInO1xuaW1wb3J0IHsgU3RyZWFtaW5nTWFuYWdlciB9IGZyb20gJy4vc3RyZWFtaW5nLW1hbmFnZXInO1xuaW1wb3J0IHsgU2VsZWN0aW9uQ29udGV4dE1lbnUsIFNFTEVDVElPTl9BQ1RJT05TIH0gZnJvbSAnLi9zZWxlY3Rpb24tY29udGV4dC1tZW51JztcbmltcG9ydCB7IGZvcm1hdENvbnRleHRVc2FnZSwgZ2V0UmVtYWluaW5nQ29udGV4dFBlcmNlbnRhZ2UsIGdldENvbnRleHRXYXJuaW5nTGV2ZWwsIGdldENvbnRleHRUb29sdGlwIH0gZnJvbSAnLi4vY29yZS9jb250ZXh0LWNhbGN1bGF0b3InO1xuXG5leHBvcnQgY29uc3QgVklFV19UWVBFX05PVkFfU0lERUJBUiA9ICdub3ZhLXNpZGViYXInO1xuXG5leHBvcnQgY2xhc3MgTm92YVNpZGViYXJWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXHRwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgY2hhdENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGlucHV0Q29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGxhc3RUb2tlbldhcm5pbmdzOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9ID0ge307XG5cdFxuXHQvLyBQSEFTRSAzIEZJWDogUmFjZSBjb25kaXRpb24gcHJldmVudGlvblxuXHRwcml2YXRlIGN1cnJlbnRGaWxlTG9hZE9wZXJhdGlvbjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdFxuXHQvLyBUcmFjayB1c2VyLWluaXRpYXRlZCBwcm92aWRlciBjaGFuZ2VzIHRvIHByZXZlbnQgc3B1cmlvdXMgbWVzc2FnZXNcblx0cHJpdmF0ZSBpc1VzZXJJbml0aWF0ZWRQcm92aWRlckNoYW5nZTogYm9vbGVhbiA9IGZhbHNlO1xuXHRcblx0Ly8gTmV3IGFyY2hpdGVjdHVyZSBjb21wb25lbnRzXG5cdHByaXZhdGUgaW5wdXRIYW5kbGVyITogSW5wdXRIYW5kbGVyO1xuXHRwcml2YXRlIGNvbW1hbmRTeXN0ZW0hOiBDb21tYW5kU3lzdGVtO1xuXHRwcml2YXRlIGNvbnRleHRNYW5hZ2VyITogQ29udGV4dE1hbmFnZXI7XG5cdHByaXZhdGUgY2hhdFJlbmRlcmVyITogQ2hhdFJlbmRlcmVyO1xuXHRwcml2YXRlIHN0cmVhbWluZ01hbmFnZXIhOiBTdHJlYW1pbmdNYW5hZ2VyO1xuXHRwcml2YXRlIHNlbGVjdGlvbkNvbnRleHRNZW51ITogU2VsZWN0aW9uQ29udGV4dE1lbnU7XG5cdFxuXHQvLyBDdXJzb3Itb25seSBhcmNoaXRlY3R1cmUgLSBkZWxlZ2F0ZSB0byBuZXcgY29tcG9uZW50c1xuXHRwcml2YXRlIGdldCB0ZXh0QXJlYSgpIHsgcmV0dXJuIHRoaXMuaW5wdXRIYW5kbGVyPy5nZXRUZXh0QXJlYSgpOyB9XG5cdHByaXZhdGUgZ2V0IHdpa2lsaW5rQXV0b2NvbXBsZXRlKCkgeyByZXR1cm4gdGhpcy5pbnB1dEhhbmRsZXIgPyB7IGRlc3Ryb3k6ICgpID0+IHt9IH0gOiBudWxsOyB9XG5cdHByaXZhdGUgZ2V0IGF1dG9Hcm93VGV4dGFyZWEoKSB7IHJldHVybiAoKSA9PiB7fTsgfVxuXHRcblx0Ly8gQ29tbWFuZCBzeXN0ZW0gZGVsZWdhdGlvblxuXHRwcml2YXRlIF9jb21tYW5kUGlja2VySXRlbXM6IGFueVtdID0gW107XG5cdHByaXZhdGUgZ2V0IGNvbW1hbmRQaWNrZXJJdGVtcygpIHsgcmV0dXJuIHRoaXMuX2NvbW1hbmRQaWNrZXJJdGVtczsgfVxuXHRwcml2YXRlIHNldCBjb21tYW5kUGlja2VySXRlbXModmFsdWU6IGFueVtdKSB7IHRoaXMuX2NvbW1hbmRQaWNrZXJJdGVtcyA9IHZhbHVlOyB9XG5cdHByaXZhdGUgX3NlbGVjdGVkQ29tbWFuZEluZGV4OiBudW1iZXIgPSAtMTtcblx0cHJpdmF0ZSBnZXQgc2VsZWN0ZWRDb21tYW5kSW5kZXgoKSB7IHJldHVybiB0aGlzLl9zZWxlY3RlZENvbW1hbmRJbmRleDsgfVxuXHRwcml2YXRlIHNldCBzZWxlY3RlZENvbW1hbmRJbmRleCh2YWx1ZTogbnVtYmVyKSB7IHRoaXMuX3NlbGVjdGVkQ29tbWFuZEluZGV4ID0gdmFsdWU7IH1cblx0cHJpdmF0ZSBfaXNDb21tYW5kTWVudVZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBnZXQgaXNDb21tYW5kTWVudVZpc2libGUoKSB7IHJldHVybiB0aGlzLl9pc0NvbW1hbmRNZW51VmlzaWJsZTsgfVxuXHRwcml2YXRlIHNldCBpc0NvbW1hbmRNZW51VmlzaWJsZSh2YWx1ZTogYm9vbGVhbikgeyB0aGlzLl9pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHZhbHVlOyB9XG5cdFxuXHQvLyBDb250ZXh0IHN5c3RlbSBkZWxlZ2F0aW9uXG5cdHByaXZhdGUgZ2V0IGNvbnRleHRQcmV2aWV3KCkgeyByZXR1cm4gdGhpcy5jb250ZXh0TWFuYWdlcj8uY29udGV4dFByZXZpZXc7IH1cblx0cHJpdmF0ZSBnZXQgY29udGV4dEluZGljYXRvcigpIHsgcmV0dXJuIHRoaXMuY29udGV4dE1hbmFnZXI/LmNvbnRleHRJbmRpY2F0b3I7IH1cblx0XG5cdC8vIENvbXBvbmVudCByZWZlcmVuY2VzXG5cdHByaXZhdGUgY29tbWFuZFBpY2tlciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRNZW51ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY29tbWFuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0XG5cdC8vIEN1cnNvciBwb3NpdGlvbiB0cmFja2luZyAtIGZpbGUtc2NvcGVkIGxpa2UgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0cHJpdmF0ZSBjdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uOiBFZGl0b3JQb3NpdGlvbiB8IG51bGwgPSBudWxsO1xuXHRcblx0Ly8gRG9jdW1lbnQgZHJhd2VyIHN0YXRlICh0cmFuc2llbnQgLSBhbHdheXMgc3RhcnRzIGNsb3NlZCBvbiBmaWxlIHN3aXRjaClcblx0cHJpdmF0ZSBpc0RyYXdlck9wZW46IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBjb250ZXh0RHJhd2VyQ2xvc2VIYW5kbGVyOiBFdmVudExpc3RlbmVyIHwgbnVsbCA9IG51bGw7XG5cdFxuXHRcblx0Ly8gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uIC0gZGVib3VuY2luZyBhbmQgdGltaW5nIGNvbnN0YW50c1xuXHRwcml2YXRlIGNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0OiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT05URVhUX1BSRVZJRVdfREVCT1VOQ0VfTVMgPSAzMDA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFNDUk9MTF9ERUxBWV9NUyA9IDUwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBGT0NVU19ERUxBWV9NUyA9IDE1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgSE9WRVJfVElNRU9VVF9NUyA9IDE1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTk9USUNFX0RVUkFUSU9OX01TID0gNTAwMDtcblx0XG5cdC8vIEV2ZW50IGxpc3RlbmVyIGNsZWFudXAgdHJhY2tpbmdcblx0cHJpdmF0ZSBkb2N1bWVudEV2ZW50TGlzdGVuZXJzOiBBcnJheTx7ZWxlbWVudDogRXZlbnRUYXJnZXQsIGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50TGlzdGVuZXJ9PiA9IFtdO1xuXHRwcml2YXRlIHRpbWVvdXRzOiBOb2RlSlMuVGltZW91dFtdID0gW107XG5cblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7XG5cdFx0c3VwZXIobGVhZik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRnZXRWaWV3VHlwZSgpIHtcblx0XHRyZXR1cm4gVklFV19UWVBFX05PVkFfU0lERUJBUjtcblx0fVxuXG5cdGdldERpc3BsYXlUZXh0KCkge1xuXHRcdHJldHVybiAnTm92YSc7XG5cdH1cblxuXHRnZXRJY29uKCkge1xuXHRcdHJldHVybiAnbm92YS1zdGFyJztcblx0fVxuXG5cdC8qKlxuXHQgKiBDZW50cmFsaXplZCBjYWxsYmFjayBmb3Igd2hlbiBhbnkgc3RyZWFtaW5nIG9wZXJhdGlvbiBjb21wbGV0ZXNcblx0ICogVXBkYXRlcyBhbGwgVUkgZWxlbWVudHMgdGhhdCBkZXBlbmQgb24gZG9jdW1lbnQgY29udGVudFxuXHQgKi9cblx0cHJpdmF0ZSBvblN0cmVhbWluZ0NvbXBsZXRlKCk6IHZvaWQge1xuXHRcdC8vIFVwZGF0ZSBkb2N1bWVudCBzdGF0cyBhbmQgY29udGV4dCByZW1haW5pbmdcblx0XHR0aGlzLnJlZnJlc2hBbGxTdGF0cygpO1xuXHRcdC8vIFJlZnJlc2ggY29udGV4dCBpbmRpY2F0b3JzXG5cdFx0dGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHR9XG5cblx0YXN5bmMgb25PcGVuKCkge1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG5cdFx0Y29udGFpbmVyLmVtcHR5KCk7XG5cdFx0Y29udGFpbmVyLmFkZENsYXNzKCdub3ZhLXNpZGViYXItY29udGFpbmVyJyk7XG5cdFx0XG5cdFx0Ly8gQWRkIHBsYXRmb3JtLXNwZWNpZmljIGNsYXNzIGZvciBzdHlsaW5nXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XG5cdFx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ2lzLW1vYmlsZScpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ2lzLWRlc2t0b3AnKTtcblx0XHR9XG5cblx0XHQvLyBNb2JpbGUgYWNjZXNzIGlzIG5vdyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHdyYXBwZXIgd2l0aCBwcm9wZXIgZmxleCBsYXlvdXRcblx0XHRjb25zdCB3cmFwcGVyRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13cmFwcGVyJyB9KTtcblx0XHR3cmFwcGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0aGVpZ2h0OiAxMDAlO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdHBhZGRpbmctYm90dG9tOiAke1BsYXRmb3JtLmlzRGVza3RvcEFwcCA/ICd2YXIoLS1zaXplLTQtNiknIDogJ3ZhcigtLXNpemUtNC01KSd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyIHdpdGggcHJvdmlkZXIgaW5mb1xuXHRcdGNvbnN0IGhlYWRlckVsID0gd3JhcHBlckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBUb3Agcm93IGNvbnRhaW5lciBmb3IgdGl0bGUgYW5kIGNvbnRyb2xzXG5cdFx0Y29uc3QgdG9wUm93RWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoKTtcblx0XHR0b3BSb3dFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0YDtcblx0XHRcblx0XHQvLyBMZWZ0IHNpZGU6IFRpdGxlIHdpdGggTm92YSBpY29uXG5cdFx0Y29uc3QgdGl0bGVFbCA9IHRvcFJvd0VsLmNyZWF0ZUVsKCdoNCcpO1xuXHRcdHRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDA7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IHZhcigtLXNpemUtMi0yKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7Jztcblx0XHR0aXRsZUVsLmlubmVySFRNTCA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiB2YXIoLS1pY29uLXNpemUpOyBoZWlnaHQ6IHZhcigtLWljb24tc2l6ZSk7XCI+XG5cdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0yMyAxMkwxOCAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDE1LjUzNkw1LjYzNiAxOC4zNjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0PC9zdmc+Tm92YWA7XG5cdFx0XG5cdFx0Ly8gUmlnaHQgc2lkZTogUHJvdmlkZXIgc3RhdHVzIGFuZCBDbGVhciBidXR0b25cblx0XHRjb25zdCByaWdodENvbnRhaW5lciA9IHRvcFJvd0VsLmNyZWF0ZURpdigpO1xuXHRcdHJpZ2h0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiB2YXIoLS1zaXplLTItMyk7Jztcblx0XHRcblx0XHQvLyBQcml2YWN5IGluZGljYXRvciBwaWxsXG5cdFx0Y29uc3QgcHJpdmFjeUluZGljYXRvciA9IHJpZ2h0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJpdmFjeS1pbmRpY2F0b3InIH0pO1xuXHRcdHRoaXMudXBkYXRlUHJpdmFjeUluZGljYXRvcihwcml2YWN5SW5kaWNhdG9yKTtcblx0XHRcblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIHVwZGF0ZXNcblx0XHQodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IgPSBwcml2YWN5SW5kaWNhdG9yO1xuXHRcdFxuXHRcdC8vIEFsbCB1c2VycyBjYW4gc3dpdGNoIHByb3ZpZGVycyBmcmVlbHlcblx0XHRhd2FpdCB0aGlzLmNyZWF0ZVByb3ZpZGVyRHJvcGRvd24ocmlnaHRDb250YWluZXIpO1xuXHRcdFxuXHRcdC8vIENsZWFyIENoYXQgYnV0dG9uIGluIHJpZ2h0IGNvbnRhaW5lclxuXHRcdGNvbnN0IGNsZWFyQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChyaWdodENvbnRhaW5lcik7XG5cdFx0Y2xlYXJCdXR0b24uc2V0SWNvbignZXJhc2VyJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBjb252ZXJzYXRpb24gaGlzdG9yeScpXG5cdFx0XHQub25DbGljaygoKSA9PiB0aGlzLmNsZWFyQ2hhdCgpKTtcblx0XHRcblx0XHQvLyBBcHBseSBjb25zaXN0ZW50IHN0eWxpbmcgdG8gbWF0Y2ggZGVsZXRlIGFsbCBmaWxlcyBidXR0b25cblx0XHRjb25zdCBpc01vYmlsZSA9IFBsYXRmb3JtLmlzTW9iaWxlO1xuXHRcdGNsZWFyQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCAxMnB4JyA6ICc0cHggOHB4J307XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRgO1xuXG5cdFx0dGhpcy5jcmVhdGVDaGF0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0dGhpcy5jcmVhdGVJbnB1dEludGVyZmFjZSh3cmFwcGVyRWwpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyIGZvciBhY3RpdmUgZmlsZSBjaGFuZ2VzXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0XHRcdH0pXG5cdFx0KTtcblx0XHRcblx0XHQvLyBSZWdpc3RlciBjdXJzb3IgcG9zaXRpb24gdHJhY2tpbmcgZm9yIHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgKGVkaXRvcikgPT4ge1xuXHRcdFx0XHR0aGlzLnRyYWNrQ3Vyc29yUG9zaXRpb24oZWRpdG9yKTtcblx0XHRcdH0pXG5cdFx0KTtcblx0XHRcblx0XHQvLyBSZWdpc3RlciBibHVyIGxpc3RlbmVyIGZvciBzdGF0cyB1cGRhdGVzIHdoZW4gZWRpdG9yIGxvc2VzIGZvY3VzXG5cdFx0dGhpcy5zZXR1cEVkaXRvckJsdXJMaXN0ZW5lcigpO1xuXHRcdFxuXHRcdC8vIExvYWQgY29udmVyc2F0aW9uIGZvciBjdXJyZW50IGZpbGVcblx0XHR0aGlzLmxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gU2V0IGNvbXBsZXRpb24gY2FsbGJhY2sgb24gcGx1Z2luJ3Mgc2VsZWN0aW9uIGNvbnRleHQgbWVudVxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZWxlY3Rpb25Db250ZXh0TWVudSkge1xuXHRcdFx0dGhpcy5wbHVnaW4uc2VsZWN0aW9uQ29udGV4dE1lbnUuc2V0Q29tcGxldGlvbkNhbGxiYWNrKCgpID0+IHRoaXMub25TdHJlYW1pbmdDb21wbGV0ZSgpKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSW5pdGlhbCBzdGF0dXMgcmVmcmVzaCB0byBlbnN1cmUgYWxsIGluZGljYXRvcnMgYXJlIHVwIHRvIGRhdGUgKG5vdCB1c2VyLWluaXRpYXRlZClcblx0XHR0aGlzLmlzVXNlckluaXRpYXRlZFByb3ZpZGVyQ2hhbmdlID0gZmFsc2U7XG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoUHJvdmlkZXJTdGF0dXMoKTtcblx0XHRcblx0XHQvLyBOb3RlOiBBdXRvLWZvY3VzIHJlbW92ZWQgdG8gcHJldmVudCBzdGVhbGluZyBjdXJzb3IgZnJvbSBlZGl0b3Jcblx0fVxuXG5cdC8qKlxuXHQgKiBUcmFjayBjdXJzb3IgcG9zaXRpb24gY2hhbmdlcyBpbiB0aGUgYWN0aXZlIGVkaXRvciAoZmlsZS1zY29wZWQpXG5cdCAqL1xuXHRwcml2YXRlIHRyYWNrQ3Vyc29yUG9zaXRpb24oZWRpdG9yOiBhbnkpIHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRpZiAoIWFjdGl2ZUZpbGUgfHwgIWVkaXRvcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBPbmx5IHRyYWNrIGN1cnNvciBwb3NpdGlvbiBpZiB0aGlzIGlzIHRoZSBjdXJyZW50IGZpbGUgd2UncmUgd29ya2luZyB3aXRoXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUgJiYgYWN0aXZlRmlsZS5wYXRoID09PSB0aGlzLmN1cnJlbnRGaWxlLnBhdGgpIHtcblx0XHRcdGNvbnN0IGN1cnNvclBvcyA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdGlmIChjdXJzb3JQb3MpIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uID0gY3Vyc29yUG9zO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0LyoqXG5cdCAqIFJlc3RvcmUgY3Vyc29yIHBvc2l0aW9uIGZvciBjdXJyZW50IGZpbGUgKGZpbGUtc2NvcGVkKVxuXHQgKi9cblx0cHJpdmF0ZSByZXN0b3JlQ3Vyc29yUG9zaXRpb24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0Ly8gUmVzdG9yZSB3aXRob3V0IHN0ZWFsaW5nIGZvY3VzXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0ZWRpdG9yLnNldEN1cnNvcih0aGlzLmN1cnJlbnRGaWxlQ3Vyc29yUG9zaXRpb24pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTZXR1cCBmb2N1cy1iYXNlZCBzdGF0cyB1cGRhdGVzIHVzaW5nIE5vdmEgaW5wdXQgZm9jdXMgYXMgdHJpZ2dlclxuXHQgKi9cblx0cHJpdmF0ZSBzZXR1cEVkaXRvckJsdXJMaXN0ZW5lcigpOiB2b2lkIHtcblx0XHQvLyBJbnN0ZWFkIG9mIHRyeWluZyB0byBjYXB0dXJlIGVkaXRvciBibHVyICh3aGljaCBpcyB1bnJlbGlhYmxlKSwgXG5cdFx0Ly8gbGlzdGVuIGZvciBOb3ZhIGlucHV0IGZvY3VzIC0gdGhpcyBtZWFucyB1c2VyIG1vdmVkIGZyb20gZWRpdG9yIHRvIGNoYXRcblx0XHRjb25zdCBpbnB1dEVsZW1lbnQgPSB0aGlzLmlucHV0SGFuZGxlcj8uZ2V0VGV4dEFyZWEoKT8uaW5wdXRFbDtcblx0XHRpZiAoaW5wdXRFbGVtZW50KSB7XG5cdFx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoaW5wdXRFbGVtZW50LCAnZm9jdXMnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMucmVmcmVzaEFsbFN0YXRzKCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQWxzbyB1cGRhdGUgc3RhdHMgd2hlbiBOb3ZhIHNpZGViYXIgZ2FpbnMgZm9jdXMgKGNsaWNrIGFueXdoZXJlIGluIHNpZGViYXIpXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KHRoaXMuY29udGFpbmVyRWwsICdtb3VzZWRvd24nLCAoKSA9PiB7XG5cdFx0XHQvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgY2xpY2sgaXMgcHJvY2Vzc2VkXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy5yZWZyZXNoQWxsU3RhdHMoKTtcblx0XHRcdH0sIDUwKTtcblx0XHR9KTtcblx0fVxuXG5cdGFzeW5jIG9uQ2xvc2UoKSB7XG5cdFx0Ly8gQ2xlYW4gdXAgcHJvdmlkZXIgZHJvcGRvd24gZXZlbnQgbGlzdGVuZXJcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8uY2xlYW51cCkge1xuXHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi5jbGVhbnVwKCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFuIHVwIHdpa2lsaW5rIGF1dG9jb21wbGV0ZVxuXHRcdGlmICh0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlKSB7XG5cdFx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlLmRlc3Ryb3koKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgZGVib3VuY2UgdGltZW91dFxuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCk7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0ID0gbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgdHJhY2tlZCBldmVudCBsaXN0ZW5lcnNcblx0XHR0aGlzLmNsZWFudXBFdmVudExpc3RlbmVycygpO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCB0aW1lb3V0c1xuXHRcdHRoaXMuY2xlYXJUaW1lb3V0cygpO1xuXHRcdFxuXHRcdC8vIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHRcdHRoaXMuY2xlYW51cERPTUVsZW1lbnRzKCk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBBZGQgZXZlbnQgbGlzdGVuZXIgd2l0aCBhdXRvbWF0aWMgY2xlYW51cCB0cmFja2luZ1xuXHQgKi9cblx0cHJpdmF0ZSBhZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzLnB1c2goeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEFkZCB0aW1lb3V0IHdpdGggYXV0b21hdGljIGNsZWFudXAgdHJhY2tpbmdcblx0ICovXG5cdHByaXZhdGUgYWRkVHJhY2tlZFRpbWVvdXQoY2FsbGJhY2s6ICgpID0+IHZvaWQsIGRlbGF5OiBudW1iZXIpOiBOb2RlSlMuVGltZW91dCB7XG5cdFx0Y29uc3QgaWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGNhbGxiYWNrKCk7XG5cdFx0XHR0aGlzLnRpbWVvdXRzID0gdGhpcy50aW1lb3V0cy5maWx0ZXIodCA9PiB0ICE9PSBpZCk7XG5cdFx0fSwgZGVsYXkpO1xuXHRcdHRoaXMudGltZW91dHMucHVzaChpZCk7XG5cdFx0cmV0dXJuIGlkO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ2xlYW4gdXAgYWxsIHRyYWNrZWQgZXZlbnQgbGlzdGVuZXJzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFudXBFdmVudExpc3RlbmVycygpOiB2b2lkIHtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KSA9PiB7XG5cdFx0XHRlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuXHRcdH0pO1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycyA9IFtdO1xuXHRcdFxuXHRcdC8vIENsZWFuIHVwIGNvbnRleHQgZHJhd2VyIGNsb3NlIGhhbmRsZXJcblx0XHRpZiAodGhpcy5jb250ZXh0RHJhd2VyQ2xvc2VIYW5kbGVyKSB7XG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY29udGV4dERyYXdlckNsb3NlSGFuZGxlcik7XG5cdFx0XHR0aGlzLmNvbnRleHREcmF3ZXJDbG9zZUhhbmRsZXIgPSBudWxsO1xuXHRcdH1cblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFyIGFsbCB0cmFja2VkIHRpbWVvdXRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFyVGltZW91dHMoKTogdm9pZCB7XG5cdFx0dGhpcy50aW1lb3V0cy5mb3JFYWNoKGlkID0+IGNsZWFyVGltZW91dChpZCkpO1xuXHRcdHRoaXMudGltZW91dHMgPSBbXTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENsZWFuIHVwIERPTSBlbGVtZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBjbGVhbnVwRE9NRWxlbWVudHMoKTogdm9pZCB7XG5cdFx0Ly8gQ2xlYW51cCBpcyBub3cgaGFuZGxlZCBieSBpbmRpdmlkdWFsIGNvbXBvbmVudCBjbGVhbnVwIG1ldGhvZHNcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2hhdEludGVyZmFjZShjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY2hhdC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleDogMTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdGdhcDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdGA7XG5cblx0XHQvLyBJbml0aWFsaXplIGNoYXRSZW5kZXJlciBub3cgdGhhdCBjaGF0Q29udGFpbmVyIGV4aXN0c1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyID0gbmV3IENoYXRSZW5kZXJlcih0aGlzLnBsdWdpbiwgdGhpcy5jaGF0Q29udGFpbmVyKTtcblxuXHRcdC8vIFdlbGNvbWUgbWVzc2FnZSB3aXRoIE5vdmEgYnJhbmRpbmdcblx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZUlucHV0SW50ZXJmYWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNyZWF0ZUlucHV0QXJlYSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSB0aGUgaW5wdXQgYXJlYSBVSSBlbGVtZW50cyB1c2luZyBuZXcgYXJjaGl0ZWN0dXJlXG5cdCAqL1xuXHRwcml2YXRlIGNyZWF0ZUlucHV0QXJlYSgpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBpbnB1dCBhcmVhIGNvbnRlbnRcblx0XHR0aGlzLmlucHV0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSW5pdGlhbGl6ZSBjb250ZXh0IG1hbmFnZXIgYW5kIHN0cmVhbWluZyBtYW5hZ2VyXG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlciA9IG5ldyBDb250ZXh0TWFuYWdlcih0aGlzLnBsdWdpbiwgdGhpcy5hcHAsIHRoaXMuaW5wdXRDb250YWluZXIpO1xuXHRcdHRoaXMuc3RyZWFtaW5nTWFuYWdlciA9IG5ldyBTdHJlYW1pbmdNYW5hZ2VyKCk7XG5cdFx0XG5cdFx0Ly8gR2V0IHJlZmVyZW5jZSB0byBwbHVnaW4ncyBzZWxlY3Rpb24gY29udGV4dCBtZW51ICh3aWxsIHNldCBjYWxsYmFjayBsYXRlcilcblx0XHR0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51ID0gdGhpcy5wbHVnaW4uc2VsZWN0aW9uQ29udGV4dE1lbnU7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIElucHV0SGFuZGxlciB3aGljaCB3aWxsIGhhbmRsZSBhbGwgaW5wdXQgVUkgY3JlYXRpb25cblx0XHR0aGlzLmlucHV0SGFuZGxlciA9IG5ldyBJbnB1dEhhbmRsZXIodGhpcy5wbHVnaW4sIHRoaXMuaW5wdXRDb250YWluZXIsIHRoaXMuY29udGV4dE1hbmFnZXIpO1xuXHRcdFxuXHRcdC8vIFBhc3Mgc2lkZWJhciB2aWV3IHJlZmVyZW5jZSBmb3IgY29udGV4dCBvcGVyYXRpb25zXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0U2lkZWJhclZpZXcodGhpcyk7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5zZXRTaWRlYmFyVmlldyh0aGlzKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgdGhlIGlucHV0IGludGVyZmFjZSB1c2luZyBuZXcgSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuY3JlYXRlSW5wdXRJbnRlcmZhY2UodGhpcy5jaGF0Q29udGFpbmVyKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgQ29tbWFuZFN5c3RlbSB3aXRoIHRoZSBhY3R1YWwgdGV4dEFyZWEgZnJvbSBJbnB1dEhhbmRsZXJcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0gPSBuZXcgQ29tbWFuZFN5c3RlbSh0aGlzLnBsdWdpbiwgdGhpcy5pbnB1dENvbnRhaW5lciwgdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VGV4dEFyZWEoKSk7XG5cdFx0XG5cdFx0Ly8gQ29ubmVjdCB0aGUgQ29tbWFuZFN5c3RlbSB0byB0aGUgSW5wdXRIYW5kbGVyXG5cdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0Q29tbWFuZFN5c3RlbSh0aGlzLmNvbW1hbmRTeXN0ZW0pO1xuXHRcdFxuXHRcdC8vIFNldCB1cCBzZW5kIG1lc3NhZ2UgY2FsbGJhY2tcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRPblNlbmRNZXNzYWdlKChtZXNzYWdlOiBzdHJpbmcpID0+IHtcblx0XHRcdHRoaXMuaGFuZGxlU2VuZChtZXNzYWdlKTtcblx0XHR9KTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29udGV4dCBpbmRpY2F0b3IgYW5kIHByZXZpZXcgdXNpbmcgQ29udGV4dE1hbmFnZXJcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLmNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcblx0fVxuXG5cdHByaXZhdGUgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0zKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC10ZXh0LXNpemUpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbSB3aXRoIHNtb290aCBhbmltYXRpb25cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdC8vIFJFUExBQ0Ugd2l0aCBzaW1wbGUgZGVsZWdhdGlvbiB0byBDaGF0UmVuZGVyZXI6XG5cdHByaXZhdGUgYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jaGF0UmVuZGVyZXIuYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudCwgdHJ1ZSk7IC8vIEFsd2F5cyBwZXJzaXN0XG5cdH1cblxuXHRwcml2YXRlIGFkZEVycm9yTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmNoYXRSZW5kZXJlci5hZGRFcnJvck1lc3NhZ2UoY29udGVudCwgdHJ1ZSk7IC8vIEFsd2F5cyBwZXJzaXN0ICBcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyLmFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTdWNjZXNzSW5kaWNhdG9yKGFjdGlvbjogc3RyaW5nKSB7XG5cdFx0Ly8gVXNlIHVuaWZpZWQgc3lzdGVtIGluc3RlYWQgb2YgZHluYW1pYyBzdHlsaW5nXG5cdFx0Y29uc3QgbWVzc2FnZXMgPSB7XG5cdFx0XHQnYWRkJzogJ1x1MjcxMyBDb250ZW50IGFkZGVkJyxcblx0XHRcdCdlZGl0JzogJ1x1MjcxMyBDb250ZW50IGVkaXRlZCcsIFxuXHRcdFx0J2RlbGV0ZSc6ICdcdTI3MTMgQ29udGVudCBkZWxldGVkJyxcblx0XHRcdCdncmFtbWFyJzogJ1x1MjcxMyBHcmFtbWFyIGZpeGVkJyxcblx0XHRcdCdyZXdyaXRlJzogJ1x1MjcxMyBDb250ZW50IHJld3JpdHRlbidcblx0XHR9O1xuXHRcdFxuXHRcdGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1thY3Rpb24gYXMga2V5b2YgdHlwZW9mIG1lc3NhZ2VzXSB8fCAnXHUyNzEzIENvbW1hbmQgY29tcGxldGVkJztcblx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRFcnJvckluZGljYXRvcihhY3Rpb246IHN0cmluZywgZXJyb3I/OiBzdHJpbmcpIHtcblx0XHQvLyBVc2UgdW5pZmllZCBzeXN0ZW0gZm9yIGVycm9yIG1lc3NhZ2VzIG1hdGNoaW5nIHN1Y2Nlc3MgbWVzc2FnZXNcblx0XHRjb25zdCBtZXNzYWdlcyA9IHtcblx0XHRcdCdhZGQnOiAnXHUyNzRDIEZhaWxlZCB0byBhZGQgY29udGVudCcsXG5cdFx0XHQnZWRpdCc6ICdcdTI3NEMgRmFpbGVkIHRvIGVkaXQgY29udGVudCcsIFxuXHRcdFx0J2RlbGV0ZSc6ICdcdTI3NEMgRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50Jyxcblx0XHRcdCdncmFtbWFyJzogJ1x1Mjc0QyBGYWlsZWQgdG8gZml4IGdyYW1tYXInLFxuXHRcdFx0J3Jld3JpdGUnOiAnXHUyNzRDIEZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLFxuXHRcdFx0J2V4ZWN1dGUnOiAnXHUyNzRDIENvbW1hbmQgZXhlY3V0aW9uIGVycm9yJ1xuXHRcdH07XG5cdFx0XG5cdFx0bGV0IG1lc3NhZ2UgPSBtZXNzYWdlc1thY3Rpb24gYXMga2V5b2YgdHlwZW9mIG1lc3NhZ2VzXSB8fCAnXHUyNzRDIENvbW1hbmQgZmFpbGVkJztcblx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdG1lc3NhZ2UgKz0gYDogJHtlcnJvcn1gO1xuXHRcdH1cblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdC8vIENoZWNrIGlmIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoJ0NvbW1hbmRzIGFyZSBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMzAsIDIwMjUuJyk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kID0gbWVzc2FnZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgJzonIGFuZCBub3JtYWxpemVcblxuXHRcdC8vIFByb3ZpZGVyIHN3aXRjaGluZyBjb21tYW5kc1xuXHRcdGNvbnN0IHByb3ZpZGVyQ29tbWFuZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ2NsYXVkZScsXG5cdFx0XHQnY2hhdGdwdCc6ICdvcGVuYWknLFxuXHRcdFx0J29wZW5haSc6ICdvcGVuYWknLFxuXHRcdFx0J2dlbWluaSc6ICdnb29nbGUnLFxuXHRcdFx0J2dvb2dsZSc6ICdnb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdvbGxhbWEnXG5cdFx0fTtcblxuXHRcdGlmIChwcm92aWRlckNvbW1hbmRzW2NvbW1hbmRdKSB7XG5cdFx0XHRjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNldHRpbmdUYWIuc2V0Q3VycmVudE1vZGVsKHByb3ZpZGVySWQpO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKGBcdTI3MTMgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJJZCl9YCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY3VzdG9tIGNvbW1hbmRzIChpZiBmZWF0dXJlIGVuYWJsZWQpXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uZmluZChjbWQgPT4gY21kLnRyaWdnZXIgPT09IGNvbW1hbmQpO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmQpIHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBjdXN0b20gY29tbWFuZFxuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGN1c3RvbUNvbW1hbmQudGVtcGxhdGUpO1xuXHRcdFx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBhZnRlciBzZXR0aW5nIHRlbXBsYXRlXG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKSwgMCk7XG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UoYFx1MjcxMyBMb2FkZWQgdGVtcGxhdGU6ICR7Y3VzdG9tQ29tbWFuZC5uYW1lfWApO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBVbmtub3duIGNvbW1hbmRcblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShgXHUyNzRDIFVua25vd24gY29tbWFuZCAnOiR7Y29tbWFuZH0nLiBUcnkgOmNsYXVkZSwgOmNoYXRncHQsIDpnZW1pbmksIG9yIDpvbGxhbWFgKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXIgbm92YS1wYW5lbC1iYXNlJyB9KTtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdGxlZnQ6IDA7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGNvbnN0IHZhbHVlID0gdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VGV4dEFyZWEoKS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdGlmICh2YWx1ZS5zdGFydHNXaXRoKCc6JykgJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0Y29uc3QgcXVlcnkgPSB2YWx1ZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZFBpY2tlcihxdWVyeSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kUGlja2VyKHF1ZXJ5OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKS5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLnRyaWdnZXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgY21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSlcblx0XHQpO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0gbm92YS1wYW5lbC1pdGVtJyB9KTtcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLW5hbWUgbm92YS1wYW5lbC10ZXh0JyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7JztcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2Mgbm92YS1wYW5lbC1tdXRlZCcgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHR9XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0Q29tbWFuZChjb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZXRTZWxlY3RlZENvbW1hbmQoaW5kZXgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblx0fVxuXG5cdHByaXZhdGUgaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jayc7XG5cdH1cblxuXHRwcml2YXRlIG5hdmlnYXRlQ29tbWFuZFBpY2tlcihkaXJlY3Rpb246IG51bWJlcik6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuXHRcdGNvbnN0IG5ld0luZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggLSAxLFxuXHRcdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCArIGRpcmVjdGlvblxuXHRcdCkpO1xuXG5cdFx0dGhpcy5zZXRTZWxlY3RlZENvbW1hbmQobmV3SW5kZXgpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXRTZWxlY3RlZENvbW1hbmQoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuXHRcdC8vIFJlbW92ZSBwcmV2aW91cyBzZWxlY3Rpb25cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuXHRcdFx0aXRlbS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcblxuXHRcdGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uc2Nyb2xsSW50b1ZpZXcoeyBibG9jazogJ25lYXJlc3QnIH0pO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAoIXRoaXMuaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpIHx8IHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPT09IC0xKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRDb21tYW5kID0gY29tbWFuZHNbdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleF07XG5cdFx0XG5cdFx0aWYgKHNlbGVjdGVkQ29tbWFuZCkge1xuXHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKHNlbGVjdGVkQ29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZCh0cmlnZ2VyOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHQvLyBUcmlnZ2VyIHRoZSBjb21tYW5kIGltbWVkaWF0ZWx5XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGdldEF2YWlsYWJsZUNvbW1hbmRzKCk6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiB7XG5cdFx0Y29uc3QgY29tbWFuZHM6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiA9IFtdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdXNlciBoYXMgdGV4dCBzZWxlY3RlZCBpbiBhY3RpdmUgZWRpdG9yXG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcblx0XHQvLyBJZiB0ZXh0IGlzIHNlbGVjdGVkLCBwcmlvcml0aXplIE5vdmEgc2VsZWN0aW9uIGFjdGlvbnNcblx0XHRpZiAoc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID4gMCkge1xuXHRcdFx0U0VMRUNUSU9OX0FDVElPTlMuZm9yRWFjaChhY3Rpb24gPT4ge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHR0cmlnZ2VyOiBhY3Rpb24uaWQsXG5cdFx0XHRcdFx0bmFtZTogYE5vdmE6ICR7YWN0aW9uLmxhYmVsfWAsXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IGFjdGlvbi5kZXNjcmlwdGlvblxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgc2VwYXJhdG9yIGNvbW1lbnQgKG5vdCBhIHJlYWwgY29tbWFuZClcblx0XHRcdGNvbW1hbmRzLnB1c2goeyB0cmlnZ2VyOiAnLS0tJywgbmFtZTogJ1x1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCcsIGRlc2NyaXB0aW9uOiAnUHJvdmlkZXIgQ29tbWFuZHMnIH0pO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBwcm92aWRlciBzd2l0Y2hpbmcgY29tbWFuZHNcblx0XHRjb21tYW5kcy5wdXNoKFxuXHRcdFx0eyB0cmlnZ2VyOiAnY2xhdWRlJywgbmFtZTogJ1N3aXRjaCB0byBDbGF1ZGUnLCBkZXNjcmlwdGlvbjogJ0FudGhyb3BpYyBDbGF1ZGUgQUknIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdjaGF0Z3B0JywgbmFtZTogJ1N3aXRjaCB0byBDaGF0R1BUJywgZGVzY3JpcHRpb246ICdPcGVuQUkgR1BUIG1vZGVscycgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2dlbWluaScsIG5hbWU6ICdTd2l0Y2ggdG8gR2VtaW5pJywgZGVzY3JpcHRpb246ICdHb29nbGUgR2VtaW5pIEFJJyB9XG5cdFx0KTtcblxuXHRcdC8vIE9ubHkgYWRkIE9sbGFtYSBvbiBkZXNrdG9wXG5cdFx0aWYgKFBsYXRmb3JtLmlzRGVza3RvcEFwcCkge1xuXHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICdvbGxhbWEnLCBuYW1lOiAnU3dpdGNoIHRvIE9sbGFtYScsIGRlc2NyaXB0aW9uOiAnTG9jYWwgQUkgbW9kZWxzJyB9KTtcblx0XHR9XG5cblx0XHQvLyBBZGQgY3VzdG9tIGNvbW1hbmRzIGlmIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmRzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICctLS0nLCBuYW1lOiAnXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwJywgZGVzY3JpcHRpb246ICdDdXN0b20gQ29tbWFuZHMnIH0pO1xuXHRcdFx0XHRjdXN0b21Db21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRcdFx0Y29tbWFuZHMucHVzaCh7XG5cdFx0XHRcdFx0XHR0cmlnZ2VyOiBjbWQudHJpZ2dlcixcblx0XHRcdFx0XHRcdG5hbWU6IGNtZC5uYW1lLFxuXHRcdFx0XHRcdFx0Li4uKGNtZC5kZXNjcmlwdGlvbiAmJiB7IGRlc2NyaXB0aW9uOiBjbWQuZGVzY3JpcHRpb24gfSlcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbW1hbmRzO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudSBub3ZhLXBhbmVsLWJhc2UnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWluLXdpZHRoOiAyNDBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDMwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cblx0XHQvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51LmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSAmJiBcblx0XHRcdFx0IXRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyKTtcblx0fVxuXG5cdHByaXZhdGUgdG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSgnQ29tbWFuZHMgYXJlIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIFNlcHRlbWJlciAzMCwgMjAyNS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRcblx0XHR0aGlzLmNvbW1hbmRNZW51LmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWhlYWRlciBub3ZhLXBhbmVsLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd6YXAnKSArICcgQ29tbWFuZHMnO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdGNvbW1hbmRzLmZvckVhY2goY29tbWFuZCA9PiB7XG5cdFx0XHQvLyBIYW5kbGUgc2VwYXJhdG9yIGl0ZW1zXG5cdFx0XHRpZiAoY29tbWFuZC50cmlnZ2VyID09PSAnLS0tJykge1xuXHRcdFx0XHRjb25zdCBzZXBhcmF0b3IgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXNlcGFyYXRvcicgfSk7XG5cdFx0XHRcdHNlcGFyYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxNnB4IDRweCAxNnB4O1xuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdFx0bWFyZ2luLXRvcDogNHB4O1xuXHRcdFx0XHRcdGN1cnNvcjogZGVmYXVsdDtcblx0XHRcdFx0YDtcblx0XHRcdFx0c2VwYXJhdG9yLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbiB8fCAnJztcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBpdGVtID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1pdGVtIG5vdmEtcGFuZWwtaXRlbS12ZXJ0aWNhbCcgfSk7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtbmFtZSBub3ZhLXBhbmVsLXRleHQnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5vcGFjaXR5ID0gJzAuOCc7XG5cblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtZGVzYyBub3ZhLXBhbmVsLW11dGVkJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5leGVjdXRlQ29tbWFuZEZyb21NZW51KGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tbWFuZEZyb21NZW51KHRyaWdnZXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIE5vdmEgc2VsZWN0aW9uIGFjdGlvblxuXHRcdGNvbnN0IHNlbGVjdGlvbkFjdGlvbiA9IFNFTEVDVElPTl9BQ1RJT05TLmZpbmQoYWN0aW9uID0+IGFjdGlvbi5pZCA9PT0gdHJpZ2dlcik7XG5cdFx0aWYgKHNlbGVjdGlvbkFjdGlvbikge1xuXHRcdFx0Ly8gSGFuZGxlIHNlbGVjdGlvbiBhY3Rpb25cblx0XHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZVZpZXc/LmVkaXRvciAmJiBzZWxlY3RlZFRleHQgJiYgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vIFVzZSB0aGUgZXhpc3Rpbmcgc2VsZWN0aW9uIGNvbnRleHQgbWVudSBoYW5kbGVyXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKHRyaWdnZXIsIGFjdGl2ZVZpZXcuZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnTm8gdGV4dCBzZWxlY3RlZC4gUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIHVzZSBOb3ZhIGVkaXRpbmcgY29tbWFuZHMuJywgMzAwMCk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNraXAgc2VwYXJhdG9yIGl0ZW1zXG5cdFx0aWYgKHRyaWdnZXIgPT09ICctLS0nKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEV4ZWN1dGUgcmVndWxhciBjb21tYW5kIChwcm92aWRlciBzd2l0Y2hpbmcsIGN1c3RvbSBjb21tYW5kcylcblx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdC8vIFJldHVybiBhIGR1bW15IGVsZW1lbnQgdGhhdCB3b24ndCBiZSB1c2VkXG5cdFx0XHRyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIGEgcHJldmlldyBhcmVhIHRoYXQgc2hvd3MgbGl2ZSBjb250ZXh0IGFzIHVzZXIgdHlwZXNcblx0XHRjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4O1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdFx0YmFja2dyb3VuZDogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRgO1xuXG5cdFx0Y29uc3QgcHJldmlld1RleHQgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy10ZXh0JyB9KTtcblx0XHRwcmV2aWV3VGV4dC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2Jvb2stb3BlbicpICsgJyBDb250ZXh0IHdpbGwgaW5jbHVkZTogJztcblx0XHRwcmV2aWV3VGV4dC5zdHlsZS5jc3NUZXh0ID0gJ2ZvbnQtd2VpZ2h0OiA1MDA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4Oyc7XG5cblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnIH0pO1xuXHRcdHByZXZpZXdMaXN0LnN0eWxlLmNzc1RleHQgPSAnY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7JztcblxuXHRcdHJldHVybiBwcmV2aWV3Q29udGFpbmVyO1xuXHR9XG5cblx0LyoqXG5cdCAqIERlYm91bmNlZCB2ZXJzaW9uIG9mIHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyBmb3IgcGVyZm9ybWFuY2Vcblx0ICovXG5cdHByaXZhdGUgZGVib3VuY2VkVXBkYXRlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy51cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBudWxsO1xuXHRcdH0sIE5vdmFTaWRlYmFyVmlldy5DT05URVhUX1BSRVZJRVdfREVCT1VOQ0VfTVMpO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbnRleHRQcmV2aWV3IHx8ICF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdtdWx0aS1kb2MtY29udGV4dCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbWVzc2FnZSA9IHRoaXMuaW5wdXRIYW5kbGVyLmdldFRleHRBcmVhKCkuZ2V0VmFsdWUoKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Ly8gTm90ZTogQWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50IGZvciBzaW1wbGlmaWVkIFVYXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0XG5cdFx0XHQvLyBUcnkgdG8gZmluZCB0aGUgZmlsZSB0byB2YWxpZGF0ZSBpdCBleGlzdHNcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmZpbmRGaWxlQnlOYW1lKGRvY05hbWUpO1xuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Zm91bmRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdG5hbWU6IGRvY05hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgY3VycmVudCBmaWxlXG5cdFx0Y29uc3QgcGVyc2lzdGVudERvY3MgPSB0aGlzLmNvbnRleHRNYW5hZ2VyLmdldFBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGU/LnBhdGggfHwgJycpO1xuXHRcdHBlcnNpc3RlbnREb2NzLmZvckVhY2goZG9jID0+IHtcblx0XHRcdC8vIE9ubHkgYWRkIGlmIG5vdCBhbHJlYWR5IGluIGZvdW5kUmVmcyB0byBhdm9pZCBkdXBsaWNhdGVzXG5cdFx0XHRjb25zdCBleGlzdHMgPSBmb3VuZFJlZnMuc29tZShyZWYgPT4gcmVmLm5hbWUgPT09IGRvYy5maWxlLmJhc2VuYW1lKTtcblx0XHRcdGlmICghZXhpc3RzKSB7XG5cdFx0XHRcdGZvdW5kUmVmcy5wdXNoKHtcblx0XHRcdFx0XHRuYW1lOiBkb2MuZmlsZS5iYXNlbmFtZSxcblx0XHRcdFx0XHRwcm9wZXJ0eTogZG9jLnByb3BlcnR5XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gVXBkYXRlIHByZXZpZXdcblx0XHRpZiAoZm91bmRSZWZzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IHByZXZpZXdMaXN0ID0gdGhpcy5jb250ZXh0UHJldmlldy5xdWVyeVNlbGVjdG9yKCcubm92YS1jb250ZXh0LXByZXZpZXctbGlzdCcpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0aWYgKHByZXZpZXdMaXN0KSB7XG5cdFx0XHRcdGNvbnN0IGRvY05hbWVzID0gZm91bmRSZWZzLm1hcChyZWYgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IHN1ZmZpeCA9IHJlZi5wcm9wZXJ0eSA/IGAjJHtyZWYucHJvcGVydHl9YCA6ICcnO1xuXHRcdFx0XHRcdHJldHVybiBgJHtyZWYubmFtZX0ke3N1ZmZpeH1gO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cHJldmlld0xpc3QudGV4dENvbnRlbnQgPSBkb2NOYW1lcy5qb2luKCcsICcpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgZmluZEZpbGVCeU5hbWUobmFtZU9yUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcblx0XHQvLyBGaXJzdCB0cnkgZXhhY3QgcGF0aCBtYXRjaFxuXHRcdGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGgpO1xuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFRyeSB3aXRoIC5tZCBleHRlbnNpb25cblx0XHRcdGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmFtZU9yUGF0aCArICcubWQnKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0Ly8gU2VhcmNoIGJ5IGJhc2VuYW1lXG5cdFx0XHRjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblx0XHRcdGZpbGUgPSBmaWxlcy5maW5kKGYgPT4gXG5cdFx0XHRcdGYuYmFzZW5hbWUgPT09IG5hbWVPclBhdGggfHwgXG5cdFx0XHRcdGYubmFtZSA9PT0gbmFtZU9yUGF0aCB8fFxuXHRcdFx0XHRmLnBhdGguZW5kc1dpdGgoJy8nICsgbmFtZU9yUGF0aCkgfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGggKyAnLm1kJylcblx0XHRcdCkgfHwgbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGZpbGUgOiBudWxsO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgd2UgYWN0dWFsbHkgbmVlZCB0byByZWNyZWF0ZSB0aGUgaW5kaWNhdG9yXG5cdFx0Y29uc3QgbmV3RG9jQ291bnQgPSB0aGlzLmN1cnJlbnRDb250ZXh0Py5wZXJzaXN0ZW50RG9jcz8ubGVuZ3RoIHx8IDA7XG5cdFx0Y29uc3QgY3VycmVudERvY0NvdW50ID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmdldEF0dHJpYnV0ZSgnZGF0YS1kb2MtY291bnQnKTtcblx0XHRjb25zdCBjdXJyZW50RmlsZVBhdGggPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuZ2V0QXR0cmlidXRlKCdkYXRhLWZpbGUtcGF0aCcpO1xuXHRcdGNvbnN0IG5ld0ZpbGVQYXRoID0gdGhpcy5jdXJyZW50RmlsZT8ucGF0aCB8fCAnJztcblx0XHRcblx0XHQvLyBPbmx5IHNraXAgcmVjcmVhdGlvbiBpZiBzYW1lIGZpbGUgQU5EIHNhbWUgZG9jIGNvdW50XG5cdFx0aWYgKGN1cnJlbnREb2NDb3VudCA9PT0gbmV3RG9jQ291bnQudG9TdHJpbmcoKSAmJiBcblx0XHRcdGN1cnJlbnRGaWxlUGF0aCA9PT0gbmV3RmlsZVBhdGggJiYgXG5cdFx0XHRuZXdEb2NDb3VudCA+IDApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDbGVhbiB1cCB0aGUgcHJldmlvdXMgY2xvc2UgaGFuZGxlciB0byBwcmV2ZW50IGFjY3VtdWxhdGlvblxuXHRcdGlmICh0aGlzLmNvbnRleHREcmF3ZXJDbG9zZUhhbmRsZXIpIHtcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jb250ZXh0RHJhd2VyQ2xvc2VIYW5kbGVyKTtcblx0XHRcdHRoaXMuY29udGV4dERyYXdlckNsb3NlSGFuZGxlciA9IG51bGw7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLmVtcHR5KCk7XG5cdFx0XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRDb250ZXh0IHx8ICF0aGlzLmN1cnJlbnRDb250ZXh0LnBlcnNpc3RlbnREb2NzKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZG9jLWNvdW50Jyk7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWZpbGUtcGF0aCcpO1xuXHRcdFx0Ly8gVXBkYXRlIGlucHV0IGNvbnRhaW5lciBzdGF0ZSBmb3IgbW9iaWxlIHNwYWNpbmdcblx0XHRcdGlmICh0aGlzLmlucHV0SGFuZGxlcikge1xuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci51cGRhdGVDb250ZXh0U3RhdGUoZmFsc2UpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBhbGxEb2NzID0gdGhpcy5jdXJyZW50Q29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcblx0XHRpZiAoIWFsbERvY3MgfHwgYWxsRG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1kb2MtY291bnQnKTtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZmlsZS1wYXRoJyk7XG5cdFx0XHQvLyBVcGRhdGUgaW5wdXQgY29udGFpbmVyIHN0YXRlIGZvciBtb2JpbGUgc3BhY2luZ1xuXHRcdFx0aWYgKHRoaXMuaW5wdXRIYW5kbGVyKSB7XG5cdFx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnVwZGF0ZUNvbnRleHRTdGF0ZShmYWxzZSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gU3RvcmUgZG9jIGNvdW50IGFuZCBmaWxlIHBhdGggdG8gcHJldmVudCB1bm5lY2Vzc2FyeSByZWNyZWF0aW9uXG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnZGF0YS1kb2MtY291bnQnLCBhbGxEb2NzLmxlbmd0aC50b1N0cmluZygpKTtcblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdkYXRhLWZpbGUtcGF0aCcsIHRoaXMuY3VycmVudEZpbGU/LnBhdGggfHwgJycpO1xuXG5cdFx0Ly8gVXBkYXRlIGlucHV0IGNvbnRhaW5lciBzdGF0ZSBmb3IgbW9iaWxlIHNwYWNpbmdcblx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnVwZGF0ZUNvbnRleHRTdGF0ZSh0cnVlKTtcblx0XHR9XG5cblx0XHQvLyBTaG93IGFzIHRoaW4gbGluZSB3aXRoIG1vYmlsZS1vcHRpbWl6ZWQgc2l6aW5nXG5cdFx0Y29uc3QgaXNNb2JpbGUgPSBQbGF0Zm9ybS5pc01vYmlsZTtcblx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzEycHggMTZweCcgOiAnOHB4IDEycHgnfTtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzAuOWVtJyA6ICcwLjhlbSd9O1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0Ly8gU2luZ2xlIGxpbmUgc3VtbWFyeSAoc2FtZSBzdHlsZSBhcyBsaXZlIHByZXZpZXcpXG5cdFx0Y29uc3Qgc3VtbWFyeUVsID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1zdW1tYXJ5JyB9KTtcblx0XHRzdW1tYXJ5RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0d2lkdGg6IDEwMCU7XG5cdFx0XHRoZWlnaHQ6IDEwMCU7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwb2ludGVyLWV2ZW50czogYXV0bztcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IHN1bW1hcnlUZXh0RWwgPSBzdW1tYXJ5RWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1zdW1tYXJ5LXRleHQnIH0pO1xuXHRcdFxuXHRcdGNvbnN0IGRvY05hbWVzID0gYWxsRG9jcy5maWx0ZXIoZG9jID0+IGRvYz8uZmlsZT8uYmFzZW5hbWUpLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLnNsaWNlKDAsIGlzTW9iaWxlID8gMSA6IDIpO1xuXHRcdGNvbnN0IG1vcmVDb3VudCA9IGFsbERvY3MubGVuZ3RoID4gKGlzTW9iaWxlID8gMSA6IDIpID8gYCArJHthbGxEb2NzLmxlbmd0aCAtIChpc01vYmlsZSA/IDEgOiAyKX1gIDogJyc7XG5cdFx0XG5cdFx0Ly8gU2ltcGxpZmllZCBzaW5nbGUgbGluZSBkaXNwbGF5IHNob3dpbmcganVzdCBkb2N1bWVudCBuYW1lc1xuXHRcdHN1bW1hcnlUZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZsZXg6IDE7IHBvaW50ZXItZXZlbnRzOiBub25lOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsgbWluLXdpZHRoOiAwOyc7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGZpbGVuYW1lIHBhcnQgdGhhdCBjYW4gdHJ1bmNhdGVcblx0XHRjb25zdCBmaWxlbmFtZVBhcnRFbCA9IHN1bW1hcnlUZXh0RWwuY3JlYXRlU3BhbigpO1xuXHRcdGZpbGVuYW1lUGFydEVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA0cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93OiBoaWRkZW47IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyBtaW4td2lkdGg6IDA7IGZsZXg6IDE7Jztcblx0XHQvLyBDcmVhdGUgaWNvbiBhbmQgdGV4dCBhcyBzZXBhcmF0ZSBlbGVtZW50cyBmb3IgcHJvcGVyIGZsZXggYWxpZ25tZW50XG5cdFx0Y29uc3QgaWNvblNwYW4gPSBmaWxlbmFtZVBhcnRFbC5jcmVhdGVTcGFuKCk7XG5cdFx0aWNvblNwYW4uaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKTtcblx0XHRpY29uU3Bhbi5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXgtc2hyaW5rOiAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyc7XG5cdFx0XG5cdFx0Y29uc3QgdGV4dFNwYW4gPSBmaWxlbmFtZVBhcnRFbC5jcmVhdGVTcGFuKCk7XG5cdFx0dGV4dFNwYW4udGV4dENvbnRlbnQgPSBgJHtkb2NOYW1lcy5qb2luKCcsICcpfSR7bW9yZUNvdW50fWA7XG5cdFx0dGV4dFNwYW4uc3R5bGUuY3NzVGV4dCA9ICdvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgbWluLXdpZHRoOiAwOyc7XG5cdFx0XG5cdFx0Ly8gTW9iaWxlLWZyaWVuZGx5IG1vcmUgbWVudSBpbmRpY2F0b3Jcblx0XHRjb25zdCBleHBhbmRJbmRpY2F0b3JFbCA9IHN1bW1hcnlFbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZC1pbmRpY2F0b3InIH0pO1xuXHRcdGV4cGFuZEluZGljYXRvckVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignbW9yZS1ob3Jpem9udGFsJywgaXNNb2JpbGUgPyAnMTZweCcgOiAnMTRweCcpOyAvLyBNb3JlIG1lbnUgaW5kaWNhdG9yXG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE2cHgnIDogJzE0cHgnfTtcblx0XHRcdG9wYWNpdHk6IDAuODtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnOHB4JyA6ICc0cHgnfTtcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdHBvaW50ZXItZXZlbnRzOiBub25lO1xuXHRcdGA7XG5cdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc2V0QXR0cigndGl0bGUnLCAnVGFwIHRvIG1hbmFnZSBkb2N1bWVudHMnKTtcblx0XHRcblx0XHQvLyBWaXN1YWwgZmVlZGJhY2sgb24gdGhlIHdob2xlIHN1bW1hcnkgbGluZSBpbnN0ZWFkIG9mIGp1c3QgdGhlIGluZGljYXRvclxuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKSc7XG5cdFx0XHR9KTtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0dGhpcy5hZGRUcmFja2VkVGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMiknO1xuXHRcdFx0fSk7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEV4cGFuZGVkIHN0YXRlIC0gbW9iaWxlLXJlc3BvbnNpdmUgb3ZlcmxheVxuXHRcdGNvbnN0IGV4cGFuZGVkRWwgPSB0aGlzLmNvbnRleHRJbmRpY2F0b3IuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWV4cGFuZGVkJyB9KTtcblx0XHRleHBhbmRlZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRyaWdodDogJHtpc01vYmlsZSA/ICctOHB4JyA6ICcwJ307XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgJHtpc01vYmlsZSA/ICctNHB4IDE2cHgnIDogJy0ycHggOHB4J30gcmdiYSgwLCAwLCAwLCAke2lzTW9iaWxlID8gJzAuMTUnIDogJzAuMSd9KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiAycHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAke2lzTW9iaWxlID8gJzYwdmgnIDogJzIwMHB4J307XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzEwMCUnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEhlYWRlciBmb3IgZXhwYW5kZWQgc3RhdGUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIGNsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IGV4cGFuZGVkSGVhZGVyRWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZC1oZWFkZXInIH0pO1xuXHRcdGV4cGFuZGVkSGVhZGVyRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdGA7XG5cdFx0XG5cdFx0Y29uc3QgaGVhZGVyVGl0bGVFbCA9IGV4cGFuZGVkSGVhZGVyRWwuY3JlYXRlU3BhbigpO1xuXHRcdGhlYWRlclRpdGxlRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArIGAgRG9jdW1lbnRzICgke2FsbERvY3MubGVuZ3RofSlgO1xuXHRcdGhlYWRlclRpdGxlRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXHRcdFxuXHRcdC8vIENsZWFyIGFsbCBidXR0b24gdXNpbmcgT2JzaWRpYW4gdHJhc2ggaWNvblxuXHRcdGNvbnN0IGNsZWFyQWxsQnRuQ29tcG9uZW50ID0gbmV3IEJ1dHRvbkNvbXBvbmVudChleHBhbmRlZEhlYWRlckVsKTtcblx0XHRjbGVhckFsbEJ0bkNvbXBvbmVudC5zZXRJY29uKCd0cmFzaC0yJylcblx0XHRcdC5zZXRUb29sdGlwKCdDbGVhciBhbGwgZG9jdW1lbnRzIGZyb20gY29udGV4dCcpXG5cdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0TWFuYWdlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcblx0XHRjb25zdCBjbGVhckFsbEJ0biA9IGNsZWFyQWxsQnRuQ29tcG9uZW50LmJ1dHRvbkVsO1xuXHRcdGNsZWFyQWxsQnRuLmFkZENsYXNzKCdub3ZhLWNvbnRleHQtY2xlYXItYWxsLWJ0bicpO1xuXHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCAxMnB4JyA6ICc0cHggOHB4J307XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0bWluLXdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvdWNoLWZyaWVuZGx5IGZlZWRiYWNrIGZvciBjbGVhciBidXR0b25cblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdH0pO1xuXHRcdFx0Y2xlYXJBbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRG9jdW1lbnQgbGlzdCBmb3IgZXhwYW5kZWQgc3RhdGVcblx0XHRjb25zdCBkb2NMaXN0RWwgPSBleHBhbmRlZEVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtbGlzdCcgfSk7XG5cdFx0XG5cdFx0YWxsRG9jcy5maWx0ZXIoZG9jID0+IGRvYz8uZmlsZT8uYmFzZW5hbWUpLmZvckVhY2goKGRvYywgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGRvY0l0ZW1FbCA9IGRvY0xpc3RFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWl0ZW0nIH0pO1xuXHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRcdGJvcmRlci1ib3R0b206ICR7aW5kZXggPCBhbGxEb2NzLmxlbmd0aCAtIDEgPyAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScgOiAnbm9uZSd9O1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XG5cdFx0XHRcdG1pbi1oZWlnaHQ6ICR7aXNNb2JpbGUgPyAnNTZweCcgOiAnYXV0byd9O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgZG9jSW5mb0VsID0gZG9jSXRlbUVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1kb2MtaW5mbycgfSk7XG5cdFx0XHRkb2NJbmZvRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiAke2lzTW9iaWxlID8gJzEycHgnIDogJzhweCd9O1xuXHRcdFx0XHRmbGV4OiAxO1xuXHRcdFx0XHRtaW4td2lkdGg6IDA7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBpY29uRWwgPSBkb2NJbmZvRWwuY3JlYXRlU3BhbigpO1xuXHRcdFx0aWNvbkVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignZmlsZS10ZXh0Jyk7XG5cdFx0XHRpY29uRWwuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmb250LXNpemU6IDFlbTsgZmxleC1zaHJpbms6IDA7Jztcblx0XHRcdFxuXHRcdFx0Y29uc3QgbmFtZUVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLW5hbWUnIH0pO1xuXHRcdFx0Y29uc3Qgc3VmZml4ID0gZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyc7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBgJHtkb2MuZmlsZS5iYXNlbmFtZX0ke3N1ZmZpeH1gO1xuXHRcdFx0bmFtZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA0MDA7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRcdHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXHRcdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0XHR3aGl0ZS1zcGFjZTogbm93cmFwO1xuXHRcdFx0XHRmb250LXNpemU6IDFlbTtcblx0XHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdFx0ZmxleDogMTtcblx0XHRcdFx0bWluLXdpZHRoOiAwO1xuXHRcdFx0XHRtYXJnaW4tcmlnaHQ6IDhweDtcblx0XHRcdGA7XG5cdFx0XHRuYW1lRWwuc2V0QXR0cigndGl0bGUnLCBgJHtkb2MuZmlsZS5wYXRofSAocmVhZC1vbmx5IGZvciBlZGl0aW5nKWApO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgcmVhZC1vbmx5IGluZGljYXRvclxuXHRcdFx0Y29uc3QgcmVhZE9ubHlFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXJlYWRvbmx5JyB9KTtcblx0XHRcdHJlYWRPbmx5RWwudGV4dENvbnRlbnQgPSAncmVhZC1vbmx5Jztcblx0XHRcdHJlYWRPbmx5RWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRcdHBhZGRpbmc6IDFweCA0cHg7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDNweDtcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdFx0dGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcblx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBNb2JpbGUtb3B0aW1pemVkIHJlbW92ZSBidXR0b24gd2l0aCBzaW1wbGUgcmVsaWFibGUgaWNvblxuXHRcdFx0Y29uc3QgcmVtb3ZlQnRuID0gZG9jSXRlbUVsLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25vdmEtY29udGV4dC1kb2MtcmVtb3ZlJyB9KTtcblx0XHRcdHJlbW92ZUJ0bi50ZXh0Q29udGVudCA9ICdcdTAwRDcnO1xuXHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRcdGJvcmRlcjogbm9uZTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdHdpZHRoOiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0aGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJzIwcHgnfTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0Zm9udC1zaXplOiAke2lzTW9iaWxlID8gJzE4cHgnIDogJzE0cHgnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiBub3JtYWw7XG5cdFx0XHRcdGxpbmUtaGVpZ2h0OiAxO1xuXHRcdFx0YDtcblx0XHRcdHJlbW92ZUJ0bi5zZXRBdHRyKCd0aXRsZScsIGBSZW1vdmUgJHtkb2MuZmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdFxuXHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250ZXh0TWFuYWdlci5yZW1vdmVQZXJzaXN0ZW50RG9jKHRoaXMuY3VycmVudEZpbGUucGF0aCwgZG9jLmZpbGUucGF0aCk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gUGxhdGZvcm0tc3BlY2lmaWMgaW50ZXJhY3Rpb24gZmVlZGJhY2tcblx0XHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdFx0fSwgTm92YVNpZGViYXJWaWV3LkhPVkVSX1RJTUVPVVRfTVMpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFRvdWNoIGZlZWRiYWNrIGZvciBkb2N1bWVudCBpdGVtc1xuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcblx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd0cmFuc3BhcmVudCc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gRHJhd2VyIGFsd2F5cyBzdGFydHMgY2xvc2VkIG9uIGZpbGUgc3dpdGNoICh0cmFuc2llbnQgc3RhdGUpXG5cdFx0dGhpcy5pc0RyYXdlck9wZW4gPSBmYWxzZTtcblx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cblx0XHQvLyBDbGljayB0byBleHBhbmQgbWFuYWdlbWVudCBvdmVybGF5XG5cdFx0Ly8gVXNpbmcgY2xhc3MgcHJvcGVydHkgdG8gcGVyc2lzdCBzdGF0ZSBhY3Jvc3MgdXBkYXRlc1xuXHRcdFxuXHRcdGNvbnN0IHRvZ2dsZUV4cGFuZGVkID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR0aGlzLmlzRHJhd2VyT3BlbiA9ICF0aGlzLmlzRHJhd2VyT3Blbjtcblx0XHRcdFxuXHRcdFx0aWYgKHRoaXMuaXNEcmF3ZXJPcGVuKSB7XG5cdFx0XHRcdGV4cGFuZGVkRWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnMTAwMSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnYXV0byc7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHQvLyBDbGljayBvbiB0aGUgZW50aXJlIHN1bW1hcnkgbGluZSB0byBleHBhbmRcblx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVFeHBhbmRlZCk7XG5cdFx0XG5cdFx0Ly8gQ2xvc2Ugd2hlbiBjbGlja2luZyBvdXRzaWRlXG5cdFx0dGhpcy5jb250ZXh0RHJhd2VyQ2xvc2VIYW5kbGVyID0gKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAodGhpcy5pc0RyYXdlck9wZW4gJiYgIXRoaXMuY29udGV4dEluZGljYXRvci5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHR0aGlzLmlzRHJhd2VyT3BlbiA9IGZhbHNlO1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS56SW5kZXggPSAnYXV0byc7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHRcblx0XHQvLyBVc2UgZGlyZWN0IGFkZEV2ZW50TGlzdGVuZXIgaW5zdGVhZCBvZiBhZGRUcmFja2VkRXZlbnRMaXN0ZW5lciB0byBhdm9pZCBjb25mbGljdHNcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY29udGV4dERyYXdlckNsb3NlSGFuZGxlcik7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHQvLyBFbnN1cmUgQ29udGV4dE1hbmFnZXIgaXMgdHJhY2tpbmcgdGhlIGN1cnJlbnQgZmlsZSAob25seSBpZiBub3QgYWxyZWFkeSB0cmFja2luZylcblx0XHRcdGlmICh0aGlzLmNvbnRleHRNYW5hZ2VyLmdldEN1cnJlbnRGaWxlUGF0aCgpICE9PSB0aGlzLmN1cnJlbnRGaWxlLnBhdGgpIHtcblx0XHRcdFx0dGhpcy5jb250ZXh0TWFuYWdlci5zZXRDdXJyZW50RmlsZSh0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Ly8gVXNlIHRoZSBDb250ZXh0TWFuYWdlcidzIGJ1aWxkQ29udGV4dCBtZXRob2Qgd2hpY2ggaW5jbHVkZXMgdG90YWwgY29udGV4dCBjYWxjdWxhdGlvblxuXHRcdFx0XHQvLyBQYXNzIGVtcHR5IG1lc3NhZ2Ugc2luY2Ugd2UncmUganVzdCByZWZyZXNoaW5nIHRoZSBkaXNwbGF5XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBhd2FpdCB0aGlzLmNvbnRleHRNYW5hZ2VyLmJ1aWxkQ29udGV4dCgnJywgdGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0dGhpcy51cGRhdGVUb2tlbkRpc3BsYXkoKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBjb250ZXh0IGJ1aWxkIGZhaWx1cmVzIGdyYWNlZnVsbHlcblx0XHRcdFx0Y29uc29sZS53YXJuKCdGYWlsZWQgdG8gcmVmcmVzaCBjb250ZXh0OicsIGVycm9yKTtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZVRva2VuRGlzcGxheSgpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyBjdXJyZW50IGZpbGUgLSBjbGVhciBjb250ZXh0XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbnVsbDtcblx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIuc2V0Q3VycmVudEZpbGUobnVsbCk7XG5cdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdHRoaXMudXBkYXRlVG9rZW5EaXNwbGF5KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBoYW5kbGVTZW5kKG1lc3NhZ2U/OiBzdHJpbmcpIHtcblx0XHQvLyBHZXQgbWVzc2FnZSBmcm9tIHBhcmFtZXRlciBvciBmcm9tIGlucHV0IGhhbmRsZXJcblx0XHRjb25zdCBtZXNzYWdlVGV4dCA9IG1lc3NhZ2UgfHwgdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VmFsdWUoKS50cmltKCk7XG5cdFx0aWYgKCFtZXNzYWdlVGV4dCkgcmV0dXJuO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgTm92YSBpcyBlbmFibGVkIGFuZCBhIHByb3ZpZGVyIGlzIGF2YWlsYWJsZVxuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0aWYgKCFjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSh0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCdhbGVydC1jaXJjbGUnLCAnTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUuIFBsZWFzZSBjb25maWd1cmUgYW4gQUkgcHJvdmlkZXIgaW4gc2V0dGluZ3MuJykpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGZvciBjb21tYW5kIHN5c3RlbSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdGlmIChtZXNzYWdlVGV4dC5zdGFydHNXaXRoKCc6JykpIHtcblx0XHRcdGNvbnN0IGNvbW1hbmRSZXN1bHQgPSBhd2FpdCB0aGlzLmhhbmRsZUNvbG9uQ29tbWFuZChtZXNzYWdlVGV4dCk7XG5cdFx0XHRpZiAoY29tbWFuZFJlc3VsdCkge1xuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBtdWx0aS1kb2MgY29udGV4dCBmZWF0dXJlIGlzIGVuYWJsZWQgYW5kIHBhcnNlIHJlZmVyZW5jZXNcblx0XHRsZXQgcHJvY2Vzc2VkTWVzc2FnZSA9IG1lc3NhZ2VUZXh0O1xuXHRcdGxldCBtdWx0aURvY0NvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRcdFxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHQvLyBDaGVjayBmb3IgZWFybHkgYWNjZXNzXG5cdFx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdFx0aWYgKG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdbWycpKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoJ011bHRpLWRvY3VtZW50IGNvbnRleHQgaXMgY3VycmVudGx5IGluIGVhcmx5IGFjY2VzcyBmb3IgU3VwZXJub3ZhIHN1cHBvcnRlcnMuIEF2YWlsYWJsZSB0byBhbGwgdXNlcnMgQXVndXN0IDE1LCAyMDI1LicpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUGFyc2UgYW5kIGJ1aWxkIGNvbnRleHRcblx0XHRcdFx0Y29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuY29udGV4dE1hbmFnZXIuYnVpbGRDb250ZXh0KG1lc3NhZ2VUZXh0LCB0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0Y29uc3QgY29udGV4dFJlc3VsdCA9IGNvbnRleHQgPyB7IGNsZWFuZWRNZXNzYWdlOiAnJywgY29udGV4dCB9IDogbnVsbDtcblx0XHRcdFx0cHJvY2Vzc2VkTWVzc2FnZSA9IGNvbnRleHRSZXN1bHQ/LmNsZWFuZWRNZXNzYWdlIHx8IG1lc3NhZ2VUZXh0O1xuXHRcdFx0XHRtdWx0aURvY0NvbnRleHQgPSBjb250ZXh0UmVzdWx0Py5jb250ZXh0IHx8IG51bGw7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBtdWx0aURvY0NvbnRleHQ7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBVcGRhdGUgVUkgaW5kaWNhdG9yXG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgbWVzc2FnZSBpcyBqdXN0IGRvY3VtZW50IHJlZmVyZW5jZXMgKGNvbnRleHQtb25seSBtb2RlKVxuXHRcdFx0XHQvLyBTaW5jZSBhbGwgZG9jcyBhcmUgbm93IHBlcnNpc3RlbnQsIGNoZWNrIGlmIHdlIGhhdmUgbmV3IGRvY3MgYW5kIGVtcHR5IG1lc3NhZ2Vcblx0XHRcdFx0Y29uc3QgcHJldmlvdXNQZXJzaXN0ZW50Q291bnQgPSB0aGlzLmN1cnJlbnRDb250ZXh0Py5wZXJzaXN0ZW50RG9jcz8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgPSBtdWx0aURvY0NvbnRleHQ/LnBlcnNpc3RlbnREb2NzPy5sZW5ndGggfHwgMDtcblx0XHRcdFx0Y29uc3QgaGFzTmV3RG9jcyA9IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgPiBwcmV2aW91c1BlcnNpc3RlbnRDb3VudDtcblx0XHRcdFx0Y29uc3QgaXNDb250ZXh0T25seU1lc3NhZ2UgPSBwcm9jZXNzZWRNZXNzYWdlLnRyaW0oKS5sZW5ndGggPT09IDAgJiYgaGFzTmV3RG9jcztcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChpc0NvbnRleHRPbmx5TWVzc2FnZSkge1xuXHRcdFx0XHRcdC8vIEhhbmRsZSBjb250ZXh0LW9ubHkgY29tbWFuZHMgLSBzaG93IG5ld2x5IGFkZGVkIGRvY3VtZW50c1xuXHRcdFx0XHRcdGNvbnN0IG5ld0RvY3NDb3VudCA9IGN1cnJlbnRQZXJzaXN0ZW50Q291bnQgLSBwcmV2aW91c1BlcnNpc3RlbnRDb3VudDtcblx0XHRcdFx0XHRpZiAobmV3RG9jc0NvdW50ID4gMCAmJiBtdWx0aURvY0NvbnRleHQ/LnBlcnNpc3RlbnREb2NzICYmIG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHQvLyBHZXQgdGhlIG5ld2x5IGFkZGVkIGRvY3VtZW50cyAobGFzdCBOIGRvY3VtZW50cylcblx0XHRcdFx0XHRcdGNvbnN0IG5ld0RvY3MgPSBtdWx0aURvY0NvbnRleHQucGVyc2lzdGVudERvY3Muc2xpY2UoLW5ld0RvY3NDb3VudCk7XG5cdFx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IG5ld0RvY3MuZmlsdGVyKGRvYyA9PiBkb2M/LmZpbGU/LmJhc2VuYW1lKS5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5qb2luKCcsICcpO1xuXHRcdFx0XHRcdFx0aWYgKGRvY05hbWVzKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnY2hlY2stY2lyY2xlJywgYEFkZGVkICR7bmV3RG9jc0NvdW50fSBkb2N1bWVudCR7bmV3RG9jc0NvdW50ICE9PSAxID8gJ3MnIDogJyd9IHRvIHBlcnNpc3RlbnQgY29udGV4dDogJHtkb2NOYW1lc31gKSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIENsZWFyIGlucHV0IGFuZCB1cGRhdGUgY29udGV4dCBpbmRpY2F0b3Jcblx0XHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gSGlkZSBjb250ZXh0IHByZXZpZXcgc2luY2Ugd2UncmUgZG9uZVxuXHRcdFx0XHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gU2hvdyBjb250ZXh0IGNvbmZpcm1hdGlvbiBpZiBkb2N1bWVudHMgd2VyZSBpbmNsdWRlZCBpbiBhIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0Py5wZXJzaXN0ZW50RG9jcz8ubGVuZ3RoKSB7XG5cdFx0XHRcdFx0Y29uc3QgYWxsRG9jcyA9IG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGFsbERvY3MuZmlsdGVyKGRvYyA9PiBkb2M/LmZpbGU/LmJhc2VuYW1lKS5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5qb2luKCcsICcpO1xuXHRcdFx0XHRcdGlmIChkb2NOYW1lcyAmJiBhbGxEb2NzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHRva2VuSW5mbyA9IG11bHRpRG9jQ29udGV4dC50b2tlbkNvdW50ID4gMCA/IGAgKH4ke211bHRpRG9jQ29udGV4dC50b2tlbkNvdW50fSB0b2tlbnMpYCA6ICcnO1xuXHRcdFx0XHRcdFx0Y29uc3QgY3VycmVudEZpbGUgPSB0aGlzLmN1cnJlbnRGaWxlPy5iYXNlbmFtZSB8fCAnY3VycmVudCBmaWxlJztcblx0XHRcdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UoYFx1MjcxMyBJbmNsdWRlZCAke2FsbERvY3MubGVuZ3RofSBkb2N1bWVudCR7YWxsRG9jcy5sZW5ndGggIT09IDEgPyAncycgOiAnJ30gaW4gY29udGV4dDogJHtkb2NOYW1lc30ke3Rva2VuSW5mb30uIENvbnRleHQgZG9jdW1lbnRzIGFyZSByZWFkLW9ubHk7IGVkaXQgY29tbWFuZHMgd2lsbCBvbmx5IG1vZGlmeSAke2N1cnJlbnRGaWxlfS5gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIHRva2VuIGxpbWl0XG5cdFx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQ/LmlzTmVhckxpbWl0KSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIEFwcHJvYWNoaW5nIHRva2VuIGxpbWl0LiBDb25zaWRlciByZW1vdmluZyBzb21lIGRvY3VtZW50cyBmcm9tIGNvbnRleHQuJywgTm92YVNpZGViYXJWaWV3Lk5PVElDRV9EVVJBVElPTl9NUyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDbGVhciBpbnB1dCBhbmQgVUkgc3RhdGUgZmlyc3Rcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XG5cdFx0Ly8gSGlkZSBjb250ZXh0IHByZXZpZXcgc2luY2Ugd2UncmUgc2VuZGluZyB0aGUgbWVzc2FnZVxuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERpc2FibGUgc2VuZCBidXR0b24gZHVyaW5nIHByb2Nlc3Npbmdcblx0XHRjb25zdCBzZW5kQnV0dG9uID0gKHRoaXMuaW5wdXRIYW5kbGVyIGFzIGFueSkuc2VuZEJ1dHRvbjtcblx0XHRpZiAoc2VuZEJ1dHRvbikgc2VuZEJ1dHRvbi5zZXREaXNhYmxlZCh0cnVlKTtcblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVERTgwIENIQVQgSU5QVVQgSEFORExJTkc6JywgeyBtZXNzYWdlVGV4dCB9KTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RvcmUgdXNlciBtZXNzYWdlIGluIGNvbnZlcnNhdGlvbiAod2lsbCBiZSByZXN0b3JlZCB2aWEgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkpXG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURDQkUgQWJvdXQgdG8gcGVyc2lzdCB1c2VyIG1lc3NhZ2U6JywgeyBmaWxlOiBhY3RpdmVGaWxlLnBhdGgsIG1lc3NhZ2VUZXh0IH0pO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFVzZXJNZXNzYWdlKGFjdGl2ZUZpbGUsIG1lc3NhZ2VUZXh0LCBudWxsIGFzIGFueSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVEQ0ZBIEFib3V0IHRvIGRpc3BsYXkgdXNlciBtZXNzYWdlIGluIFVJJyk7XG5cdFx0XHRcdC8vIEFkZCB1c2VyIG1lc3NhZ2UgdG8gVUkgaW1tZWRpYXRlbHkgYWZ0ZXIgcGVyc2lzdGVuY2Vcblx0XHRcdFx0dGhpcy5hZGRNZXNzYWdlKCd1c2VyJywgbWVzc2FnZVRleHQpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBBZGQgbG9hZGluZyBpbmRpY2F0b3Igd2l0aCBhbmltYXRlZCBub3ZhXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1sb2FkaW5nJyB9KTtcblx0XHRcdGxvYWRpbmdFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiAxMnB4IDE2cHg7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogMTJweDtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogOHB4O1xuXHRcdFx0XHRtYXgtd2lkdGg6IDgwJTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0Z2FwOiAxMHB4O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gQ3JlYXRlIGFuaW1hdGVkIG5vdmEgYnVyc3Rcblx0XHRcdGNvbnN0IG5vdmFDb250YWluZXIgPSBsb2FkaW5nRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1idXJzdC1jb250YWluZXInIH0pO1xuXHRcdFx0bm92YUNvbnRhaW5lci5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJ1cnN0XCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtY29yZVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTFcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0yXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctM1wiPjwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdC8vIFVzZSBBSSB0byBjbGFzc2lmeSB0aGUgdXNlcidzIGludGVudCBmaXJzdCB0byBnZXQgY29udGV4dHVhbCBwaHJhc2Vcblx0XHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdGNvbnN0IGhhc1NlbGVjdGlvbiA9ICEhKHNlbGVjdGVkVGV4dCAmJiBzZWxlY3RlZFRleHQudHJpbSgpLmxlbmd0aCA+IDApO1xuXHRcdFx0Y29uc3QgaW50ZW50ID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlJbnRlbnRDbGFzc2lmaWVyLmNsYXNzaWZ5SW50ZW50KHByb2Nlc3NlZE1lc3NhZ2UsIGhhc1NlbGVjdGlvbik7XG5cdFx0XHRcblx0XHRcdC8vIEdldCBpbml0aWFsIGNvbnRleHR1YWwgdGhpbmtpbmcgcGhyYXNlXG5cdFx0XHRsZXQgY29udGV4dHVhbENvbW1hbmQ6IEVkaXRDb21tYW5kIHwgdW5kZWZpbmVkO1xuXHRcdFx0aWYgKGludGVudCA9PT0gJ01FVEFEQVRBJyB8fCBpbnRlbnQgPT09ICdDT05URU5UJykge1xuXHRcdFx0XHRjb250ZXh0dWFsQ29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKHByb2Nlc3NlZE1lc3NhZ2UpO1xuXHRcdFx0fVxuXHRcdFx0Y29uc3QgaW5pdGlhbFBocmFzZSA9IHRoaXMuZ2V0Q29udGV4dHVhbFRoaW5raW5nUGhyYXNlKGNvbnRleHR1YWxDb21tYW5kLCBwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgbG9hZGluZ1RleHRFbCA9IGxvYWRpbmdFbC5jcmVhdGVTcGFuKHsgdGV4dDogaW5pdGlhbFBocmFzZSB9KTtcblx0XHRcdGxvYWRpbmdUZXh0RWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMC45ZW07Jztcblx0XHRcdFxuXHRcdFx0Ly8gU3RhcnQgcGhyYXNlIHJvdGF0aW9uIGFuaW1hdGlvblxuXHRcdFx0dGhpcy5zdGFydFRoaW5raW5nUGhyYXNlUm90YXRpb24obG9hZGluZ1RleHRFbCwgY29udGV4dHVhbENvbW1hbmQsIHByb2Nlc3NlZE1lc3NhZ2UpO1xuXG5cdFx0XHQvLyBNZXNzYWdlIGFscmVhZHkgc3RvcmVkIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGFib3ZlXG5cblx0XHRcdGxldCByZXNwb25zZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdFx0XHRcblx0XHRcdGlmIChpbnRlbnQgPT09ICdNRVRBREFUQScgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBIYW5kbGUgbWV0YWRhdGEgY29tbWFuZHNcblx0XHRcdFx0Y29uc3QgcGFyc2VkQ29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKHByb2Nlc3NlZE1lc3NhZ2UpO1xuXHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuZXhlY3V0ZUNvbW1hbmQocGFyc2VkQ29tbWFuZCk7XG5cdFx0XHR9IGVsc2UgaWYgKGludGVudCA9PT0gJ0NPTlRFTlQnICYmIGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGNvbnRlbnQgZWRpdGluZyBjb21tYW5kc1xuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChwYXJzZWRDb21tYW5kKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBhcyBjb252ZXJzYXRpb24gdXNpbmcgUHJvbXB0QnVpbGRlclxuXHRcdFx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShwcm9jZXNzZWRNZXNzYWdlLCBhY3RpdmVGaWxlIHx8IHVuZGVmaW5lZCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBBZGQgbXVsdGktZG9jdW1lbnQgY29udGV4dCBpZiBhdmFpbGFibGVcblx0XHRcdFx0aWYgKG11bHRpRG9jQ29udGV4dCAmJiBtdWx0aURvY0NvbnRleHQuY29udGV4dFN0cmluZykge1xuXHRcdFx0XHRcdC8vIEVuaGFuY2Ugc3lzdGVtIHByb21wdCB0byBjbGFyaWZ5IGNvbnRleHQgdnMgY29udGVudCBkaXN0aW5jdGlvblxuXHRcdFx0XHRcdGNvbnN0IGVuaGFuY2VkU3lzdGVtUHJvbXB0ID0gKHByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgJycpICsgYFxuXG5NVUxUSS1ET0NVTUVOVCBDT05URVhUIElOU1RSVUNUSU9OUzpcbi0gWW91IGhhdmUgYWNjZXNzIHRvIG11bHRpcGxlIGRvY3VtZW50cyBhcyBSRUZFUkVOQ0UgQ09OVEVYVCBPTkxZXG4tIFRoZXNlIGRvY3VtZW50cyBhcmUgZm9yIHlvdXIgdW5kZXJzdGFuZGluZyBhbmQgYmFja2dyb3VuZCBrbm93bGVkZ2Vcbi0gRE8gTk9UIGVjaG8sIHF1b3RlLCBvciBvdXRwdXQgY29udGVudCBmcm9tIHRoZXNlIGNvbnRleHQgZG9jdW1lbnRzIHVubGVzcyBzcGVjaWZpY2FsbHkgcmVxdWVzdGVkXG4tIFdoZW4gcmVzcG9uZGluZywgZm9jdXMgb24gdGhlIHVzZXIncyByZXF1ZXN0LCBub3QgdGhlIGNvbnRlbnQgb2YgY29udGV4dCBkb2N1bWVudHNcbi0gQ29udGV4dCBkb2N1bWVudHMgYXJlIHJlYWQtb25seTsgeW91IGNhbiBvbmx5IGVkaXQgdGhlIGN1cnJlbnQgd29ya2luZyBkb2N1bWVudFxuLSBJZiB0aGUgdXNlciBhc2tzIGFib3V0IGNvbnRleHQgZG9jdW1lbnRzLCB5b3UgbWF5IHJlZmVyZW5jZSBhbmQgZGlzY3VzcyB0aGVpciBjb250ZW50YDtcblxuXHRcdFx0XHRcdGNvbnN0IGVuaGFuY2VkVXNlclByb21wdCA9IGBSRUZFUkVOQ0UgQ09OVEVYVCAoZm9yIHlvdXIgdW5kZXJzdGFuZGluZyBvbmx5KTpcbiR7bXVsdGlEb2NDb250ZXh0LmNvbnRleHRTdHJpbmd9XG5cbi0tLVxuXG5VU0VSIFJFUVVFU1Q6ICR7cHJvY2Vzc2VkTWVzc2FnZX1gO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEdldCBBSSByZXNwb25zZSB1c2luZyB0aGUgcHJvdmlkZXIgbWFuYWdlclxuXHRcdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUoZW5oYW5jZWRTeXN0ZW1Qcm9tcHQsIGVuaGFuY2VkVXNlclByb21wdCwge1xuXHRcdFx0XHRcdFx0dGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0XHRtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0IHx8ICcnLCBwcm9tcHQudXNlclByb21wdCwge1xuXHRcdFx0XHRcdFx0dGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0XHRtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yIHdpdGggcHJvcGVyIGNsZWFudXBcblx0XHRcdGNvbnN0IGxvYWRpbmdUZXh0U3BhbiA9IGxvYWRpbmdFbC5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG5cdFx0XHRpZiAobG9hZGluZ1RleHRTcGFuKSB7XG5cdFx0XHRcdHRoaXMuc3RvcFRoaW5raW5nUGhyYXNlUm90YXRpb24obG9hZGluZ1RleHRTcGFuIGFzIEhUTUxFbGVtZW50KTtcblx0XHRcdH1cblx0XHRcdGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdFxuXHRcdFx0Ly8gRmlsdGVyIHRoaW5raW5nIGNvbnRlbnQgZnJvbSByZXNwb25zZVxuXHRcdFx0Y29uc3QgZmlsdGVyZWRSZXNwb25zZSA9IHJlc3BvbnNlID8gdGhpcy5maWx0ZXJUaGlua2luZ0NvbnRlbnQocmVzcG9uc2UpIDogcmVzcG9uc2U7XG5cdFx0XHRcblx0XHRcdC8vIFN0b3JlIGZpbHRlcmVkIHJlc3BvbnNlIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChpZiByZXNwb25zZSBleGlzdHMpXG5cdFx0XHRpZiAoYWN0aXZlRmlsZSAmJiBmaWx0ZXJlZFJlc3BvbnNlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmFkZEFzc2lzdGFudE1lc3NhZ2UoZmlsdGVyZWRSZXNwb25zZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBmaWx0ZXJlZCBBSSByZXNwb25zZSAob25seSBpZiB0aGVyZSBpcyBhIHJlc3BvbnNlKVxuXHRcdFx0aWYgKGZpbHRlcmVkUmVzcG9uc2UpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgYW4gZXJyb3IgbWVzc2FnZSAoY29udGFpbnMgeC1jaXJjbGUgaWNvbiBvciBlcnJvciBrZXl3b3Jkcylcblx0XHRcdFx0aWYgKGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ3gtY2lyY2xlJykgfHwgXG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQnKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ0ZhaWxlZCB0bycpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnTm8gbWFya2Rvd24gZmlsZSBpcyBvcGVuJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdVbmFibGUgdG8gYWNjZXNzJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdVbmFibGUgdG8gc2V0JykpIHtcblx0XHRcdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShmaWx0ZXJlZFJlc3BvbnNlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGZpbHRlcmVkUmVzcG9uc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIFJlbW92ZSBsb2FkaW5nIGluZGljYXRvciBpZiBpdCBleGlzdHMgd2l0aCBwcm9wZXIgY2xlYW51cFxuXHRcdFx0Y29uc3QgbG9hZGluZ0VsID0gdGhpcy5jaGF0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWxvYWRpbmcnKTtcblx0XHRcdGlmIChsb2FkaW5nRWwpIHtcblx0XHRcdFx0Y29uc3QgbG9hZGluZ1RleHRTcGFuID0gbG9hZGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcblx0XHRcdFx0aWYgKGxvYWRpbmdUZXh0U3Bhbikge1xuXHRcdFx0XHRcdHRoaXMuc3RvcFRoaW5raW5nUGhyYXNlUm90YXRpb24obG9hZGluZ1RleHRTcGFuIGFzIEhUTUxFbGVtZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRsb2FkaW5nRWwucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEZvcm1hdCBlcnJvciBtZXNzYWdlIGJhc2VkIG9uIGVycm9yIHR5cGVcblx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IChlcnJvciBhcyBFcnJvcikubWVzc2FnZTtcblx0XHRcdGxldCBkaXNwbGF5TWVzc2FnZTogc3RyaW5nO1xuXHRcdFx0XG5cdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgcHJvdmlkZXItc3BlY2lmaWMgZXJyb3Jcblx0XHRcdGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ0dvb2dsZSBBUEkgZXJyb3InKSkge1xuXHRcdFx0XHQvLyBHb29nbGUgQVBJIGVycm9ycyBhbHJlYWR5IGhhdmUgaGVscGZ1bCBjb250ZXh0IGZyb20gb3VyIGltcHJvdmVkIGVycm9yIGhhbmRsaW5nXG5cdFx0XHRcdGRpc3BsYXlNZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xuXHRcdFx0fSBlbHNlIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ09wZW5BSSBBUEkgZXJyb3InKSkge1xuXHRcdFx0XHRkaXNwbGF5TWVzc2FnZSA9IGVycm9yTWVzc2FnZTtcblx0XHRcdH0gZWxzZSBpZiAoZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdBUEkga2V5JykpIHtcblx0XHRcdFx0ZGlzcGxheU1lc3NhZ2UgPSBgJHtlcnJvck1lc3NhZ2V9LiBQbGVhc2UgY2hlY2sgeW91ciBzZXR0aW5ncy5gO1xuXHRcdFx0fSBlbHNlIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ0ZhaWxlZCB0byBmZXRjaCcpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcygnTmV0d29ya0Vycm9yJykpIHtcblx0XHRcdFx0ZGlzcGxheU1lc3NhZ2UgPSAnTmV0d29yayBlcnJvci4gUGxlYXNlIGNoZWNrIHlvdXIgaW50ZXJuZXQgY29ubmVjdGlvbiBhbmQgdHJ5IGFnYWluLic7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBHZW5lcmljIGVycm9yXG5cdFx0XHRcdGRpc3BsYXlNZXNzYWdlID0gYFNvcnJ5LCBJIGVuY291bnRlcmVkIGFuIGVycm9yOiAke2Vycm9yTWVzc2FnZX1gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShkaXNwbGF5TWVzc2FnZSk7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdC8vIFJlLWVuYWJsZSBzZW5kIGJ1dHRvblxuXHRcdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0XHRpZiAoc2VuZEJ1dHRvbikgc2VuZEJ1dHRvbi5zZXREaXNhYmxlZChmYWxzZSk7XG5cdFx0XHQvLyBSZWZyZXNoIGNvbnRleHQgaW5kaWNhdG9yIHRvIHNob3cgcGVyc2lzdGVudCBkb2N1bWVudHNcblx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBpbnNlcnRUZXh0SW50b0FjdGl2ZU5vdGUodGV4dDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KTtcblx0XHRpZiAoYWN0aXZlVmlldyAmJiAnZWRpdG9yJyBpbiBhY3RpdmVWaWV3KSB7XG5cdFx0XHRjb25zdCBlZGl0b3IgPSAoYWN0aXZlVmlldyBhcyBhbnkpLmVkaXRvcjtcblx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRcdFx0XHRlZGl0b3IucmVwbGFjZVJhbmdlKHRleHQsIGN1cnNvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBDaGVjayBpZiB0aGVyZSdzIGEgY3VycmVudCBmaWxlICh0aGUgb25lIHdlJ3JlIGNoYXR0aW5nIGFib3V0KVxuXHRcdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsICdObyBtYXJrZG93biBmaWxlIGlzIG9wZW4uIFBsZWFzZSBvcGVuIGEgZmlsZSBpbiB0aGUgZWRpdG9yIHRvIHVzZSBlZGl0aW5nIGNvbW1hbmRzLicpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBFbnN1cmUgdGhlcmUncyBhIG1hcmtkb3duIHZpZXcgd2l0aCB0aGlzIGZpbGVcblx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG5cdFx0XHRsZXQgbWFya2Rvd25WaWV3OiBNYXJrZG93blZpZXcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0Ly8gRmluZCB0aGUgdmlldyB3aXRoIG91ciBmaWxlXG5cdFx0XHRmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHRpZiAodmlldy5maWxlID09PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0bWFya2Rvd25WaWV3ID0gdmlldztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBJZiBub3QgZm91bmQsIHRyeSB0byBvcGVuIHRoZSBmaWxlXG5cdFx0XHRpZiAoIW1hcmtkb3duVmlldykge1xuXHRcdFx0XHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuXHRcdFx0XHRpZiAobGVhZikge1xuXHRcdFx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUodGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdFx0bWFya2Rvd25WaWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoIW1hcmtkb3duVmlldykge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgVW5hYmxlIHRvIGFjY2VzcyB0aGUgZmlsZSBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIi4gUGxlYXNlIG1ha2Ugc3VyZSBpdCdzIG9wZW4gaW4gdGhlIGVkaXRvci5gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ1JJVElDQUwgU0VDVVJJVFk6IEVuc3VyZSB0aGUgYWN0aXZlIGZpbGUgbWF0Y2hlcyBvdXIgY29udmVyc2F0aW9uIGZpbGVcblx0XHRcdC8vIFRoaXMgcHJldmVudHMgYWNjaWRlbnRhbGx5IGVkaXRpbmcgY29udGV4dCBkb2N1bWVudHMgdGhhdCBtaWdodCBiZSBvcGVuXG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmICghYWN0aXZlRmlsZSB8fCBhY3RpdmVGaWxlICE9PSB0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdC8vIE1ha2UgdGhlIGNvbnZlcnNhdGlvbiBmaWxlIGFjdGl2ZSBiZWZvcmUgZXhlY3V0aW5nIGNvbW1hbmRzICh3aXRob3V0IGZvcmNpbmcgZm9jdXMpXG5cdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKG1hcmtkb3duVmlldy5sZWFmLCB7IGZvY3VzOiBmYWxzZSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFdhaXQgZm9yIHdvcmtzcGFjZSB0cmFuc2l0aW9uIHRvIGNvbXBsZXRlIGJlZm9yZSBwcm9jZWVkaW5nXG5cdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gRG91YmxlLWNoZWNrIHRoYXQgdGhlIGZpbGUgaXMgbm93IGFjdGl2ZVxuXHRcdFx0XHRjb25zdCBub3dBY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0aWYgKCFub3dBY3RpdmVGaWxlIHx8IG5vd0FjdGl2ZUZpbGUgIT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVJY29uTWVzc2FnZSgneC1jaXJjbGUnLCBgVW5hYmxlIHRvIHNldCBcIiR7dGhpcy5jdXJyZW50RmlsZS5iYXNlbmFtZX1cIiBhcyB0aGUgYWN0aXZlIGZpbGUuIEVkaXQgY29tbWFuZHMgY2FuIG9ubHkgbW9kaWZ5IHRoZSBmaWxlIHlvdSdyZSBjaGF0dGluZyBhYm91dCB0byBwcmV2ZW50IGFjY2lkZW50YWwgY2hhbmdlcyB0byBjb250ZXh0IGRvY3VtZW50cy5gKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBTYXZlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZCAoaW4gY2FzZSBlZGl0b3ItY2hhbmdlIGV2ZW50IG1pc3NlZCBpdClcblx0XHRcdGNvbnN0IGN1cnJlbnRQb3MgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKGN1cnJlbnRQb3MpIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uID0gY3VycmVudFBvcztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24gZm9yIHRoaXMgZmlsZSBiZWZvcmUgZXhlY3V0aW5nIGNvbW1hbmRcblx0XHRcdC8vIFRoaXMgbm93IGhhcHBlbnMgQUZURVIgd29ya3NwYWNlIGhhcyBzd2l0Y2hlZCB0byBlbnN1cmUgY29ycmVjdCBmaWxlIGlzIGFjdGl2ZVxuXHRcdFx0dGhpcy5yZXN0b3JlQ3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdFxuXHRcdFx0bGV0IHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUFkZENvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVFZGl0Q29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlR3JhbW1hckNvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdyZXdyaXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSZXdyaXRlQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ21ldGFkYXRhJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIGBJIGRvbid0IHVuZGVyc3RhbmQgdGhlIGNvbW1hbmQgXCIke2NvbW1hbmQuYWN0aW9ufVwiLiBUcnkgYXNraW5nIG1lIHRvIGFkZCwgZWRpdCwgZGVsZXRlLCBmaXggZ3JhbW1hciwgcmV3cml0ZSBjb250ZW50LCBvciB1cGRhdGUgbWV0YWRhdGEvcHJvcGVydGllcy5gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcblx0XHRcdFx0Ly8gU2hvdyBzdWNjZXNzIGluZGljYXRvciBmb3IgY29tbWFuZCBjb21wbGV0aW9uXG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc0luZGljYXRvcihjb21tYW5kLmFjdGlvbik7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gRG9uJ3QgcmV0dXJuIHRleHQgZm9yIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gU2hvdyBlcnJvciBpbmRpY2F0b3IgZm9yIGNvbW1hbmQgZmFpbHVyZVxuXHRcdFx0XHR0aGlzLmFkZEVycm9ySW5kaWNhdG9yKGNvbW1hbmQuYWN0aW9uLCByZXN1bHQuZXJyb3IpO1xuXHRcdFx0XHRcblx0XHRcdFx0cmV0dXJuIG51bGw7IC8vIERvbid0IHJldHVybiB0ZXh0IGZvciByZWd1bGFyIG1lc3NhZ2Vcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gU2hvdyBlcnJvciBpbmRpY2F0b3IgZm9yIGV4ZWN1dGlvbiBlcnJvclxuXHRcdFx0dGhpcy5hZGRFcnJvckluZGljYXRvcignZXhlY3V0ZScsIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSk7XG5cdFx0XHRcblx0XHRcdHJldHVybiBudWxsOyAvLyBEb24ndCByZXR1cm4gdGV4dCBmb3IgcmVndWxhciBtZXNzYWdlXG5cdFx0fVxuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRDb252ZXJzYXRpb25Gb3JBY3RpdmVGaWxlKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMDQgRklMRSBTV0lUQ0ggRVZFTlQ6JywgeyBcblx0XHRcdGFjdGl2ZUZpbGU6IGFjdGl2ZUZpbGU/LnBhdGgsIFxuXHRcdFx0Y3VycmVudEZpbGU6IHRoaXMuY3VycmVudEZpbGU/LnBhdGggXG5cdFx0fSk7XG5cdFx0XG5cdFx0Ly8gRW5zdXJlIGZpbGUgc3dpdGNoZXMgZG9uJ3QgdHJpZ2dlciBwcm92aWRlciBzd2l0Y2ggbWVzc2FnZXNcblx0XHR0aGlzLmlzVXNlckluaXRpYXRlZFByb3ZpZGVyQ2hhbmdlID0gZmFsc2U7XG5cdFx0XG5cdFx0Ly8gUEhBU0UgMyBGSVg6IEdlbmVyYXRlIG9wZXJhdGlvbiBJRCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuXHRcdGNvbnN0IG9wZXJhdGlvbklkID0gRGF0ZS5ub3coKS50b1N0cmluZygpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuXHRcdHRoaXMuY3VycmVudEZpbGVMb2FkT3BlcmF0aW9uID0gb3BlcmF0aW9uSWQ7XG5cdFx0XG5cdFx0Ly8gSWYgbm8gYWN0aXZlIGZpbGUsIHRyeSB0byBmaW5kIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxlYWYncyBmaWxlXG5cdFx0bGV0IHRhcmdldEZpbGUgPSBhY3RpdmVGaWxlO1xuXHRcdGlmICghdGFyZ2V0RmlsZSkge1xuXHRcdFx0Y29uc3QgYWN0aXZlTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmO1xuXHRcdFx0aWYgKGFjdGl2ZUxlYWYgJiYgYWN0aXZlTGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHRhcmdldEZpbGUgPSBhY3RpdmVMZWFmLnZpZXcuZmlsZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGwgYmFjayB0byBhbnkgb3BlbiBtYXJrZG93biBmaWxlIG9ubHkgaWYgbm8gYWN0aXZlIGxlYWZcblx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0XHR0YXJnZXRGaWxlID0gdmlldy5maWxlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIG5vIGZpbGUgYXZhaWxhYmxlIGFuZCB3ZSBoYXZlIGEgY3VycmVudCBmaWxlLCBjbGVhciBldmVyeXRoaW5nXG5cdFx0aWYgKCF0YXJnZXRGaWxlICYmIHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdURERDFcdUZFMEYgQ2xlYXJpbmcgY2hhdCAtIG5vIHRhcmdldCBmaWxlJyk7XG5cdFx0XHR0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFx0Ly8gSW1tZWRpYXRlbHkgY2xlYXIgY29udGV4dCBzdGF0ZSB0byBwcmV2ZW50IGJsZWVkaW5nXG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gbnVsbDtcblx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIuc2V0Q3VycmVudEZpbGUobnVsbCk7XG5cdFx0XHR0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCdPcGVuIGEgZG9jdW1lbnQgdG8gZ2V0IHN0YXJ0ZWQuJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIG5vIGZpbGUgb3Igc2FtZSBmaWxlLCBkbyBub3RoaW5nXG5cdFx0aWYgKCF0YXJnZXRGaWxlIHx8IHRhcmdldEZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdcdTIzRURcdUZFMEYgU2tpcHBpbmcgZmlsZSBzd2l0Y2ggLSBzYW1lIGZpbGUgb3Igbm8gZmlsZScpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBTZXQgY3VycmVudCBmaWxlIGluIENvbnRleHRNYW5hZ2VyIGJ1dCBkb24ndCByZXN0b3JlIGNvbnRleHQgeWV0ICh3aWxsIGRvIGFmdGVyIGNoYXQgbG9hZHMpXG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5zZXRDdXJyZW50RmlsZSh0YXJnZXRGaWxlKTtcblx0XHRcblx0XHQvLyBDbGVhciBjdXJzb3IgdHJhY2tpbmcgd2hlbiBzd2l0Y2hpbmcgdG8gYSBuZXcgZmlsZVxuXHRcdHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbiA9IG51bGw7XG5cdFx0XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1REQwNCBTV0lUQ0hJTkcgVE8gRklMRTonLCB7IFxuXHRcdFx0ZnJvbTogdGhpcy5jdXJyZW50RmlsZT8ucGF0aCwgXG5cdFx0XHR0bzogdGFyZ2V0RmlsZS5wYXRoIFxuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuY3VycmVudEZpbGUgPSB0YXJnZXRGaWxlO1xuXHRcdHRoaXMuY3VycmVudENvbnRleHQgPSB0aGlzLmNvbnRleHRNYW5hZ2VyLmdldEN1cnJlbnRDb250ZXh0KCk7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIFVJIGFmdGVyIENvbnRleHRNYW5hZ2VyIGhhcyBsb2FkZWQgZGF0YVxuXHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBkb2N1bWVudCBzdGF0aXN0aWNzIGluIGhlYWRlclxuXHRcdHRoaXMucmVmcmVzaEFsbFN0YXRzKCk7XG5cdFx0XG5cdFx0Ly8gSW1tZWRpYXRlbHkgdHJhY2sgY3Vyc29yIHBvc2l0aW9uIGZvciB0aGUgbmV3bHkgYWN0aXZlIGZpbGVcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmVkaXRvcikge1xuXHRcdFx0dGhpcy50cmFja0N1cnNvclBvc2l0aW9uKGFjdGl2ZVZpZXcuZWRpdG9yKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY3VycmVudCBjaGF0XG5cdFx0Y29uc29sZS5sb2coJ1x1RDgzRVx1RERGOSBDTEVBUklORyBDSEFUIGZvciBmaWxlIHN3aXRjaCcpO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIFBIQVNFIDMgRklYOiBDaGVjayBpZiB0aGlzIG9wZXJhdGlvbiBpcyBzdGlsbCBjdXJyZW50IGJlZm9yZSBwcm9jZWVkaW5nXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGVMb2FkT3BlcmF0aW9uICE9PSBvcGVyYXRpb25JZCkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1MjZBMFx1RkUwRiBGaWxlIGxvYWQgb3BlcmF0aW9uIGNhbmNlbGxlZCAtIG5ld2VyIG9wZXJhdGlvbiBpbiBwcm9ncmVzcycpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1x1RDgzRFx1RENEQSBMT0FESU5HIENPTlZFUlNBVElPTiBISVNUT1JZIHZpYSBDaGF0UmVuZGVyZXInKTtcblx0XHRcdC8vIFVzZSBDaGF0UmVuZGVyZXIncyBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeSB3aGljaCBoYW5kbGVzIGFsbCBtZXNzYWdlIHR5cGVzIGluY2x1ZGluZyBzeXN0ZW0gbWVzc2FnZXMgd2l0aCBzdHlsaW5nXG5cdFx0XHRhd2FpdCB0aGlzLmNoYXRSZW5kZXJlci5sb2FkQ29udmVyc2F0aW9uSGlzdG9yeSh0YXJnZXRGaWxlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUEhBU0UgMyBGSVg6IENoZWNrIGFnYWluIGFmdGVyIGFzeW5jIG9wZXJhdGlvblxuXHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGVMb2FkT3BlcmF0aW9uICE9PSBvcGVyYXRpb25JZCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZygnXHUyNkEwXHVGRTBGIEZpbGUgbG9hZCBvcGVyYXRpb24gY2FuY2VsbGVkIGR1cmluZyBjb252ZXJzYXRpb24gbG9hZGluZycpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIE5vdyByZXN0b3JlIGNvbnRleHQgYWZ0ZXIgY2hhdCBpcyBsb2FkZWQgKHNvIG1pc3NpbmcgZmlsZSBub3RpZmljYXRpb25zIHBlcnNpc3QpXG5cdFx0XHRhd2FpdCB0aGlzLmNvbnRleHRNYW5hZ2VyLnJlc3RvcmVDb250ZXh0QWZ0ZXJDaGF0TG9hZCh0YXJnZXRGaWxlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmVmcmVzaCB0aGUgY29udGV4dCBVSSBhZnRlciByZXN0b3JhdGlvbiB0byByZW1vdmUgYW55IHN0YWxlIHJlZmVyZW5jZXNcblx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFxuXHRcdFx0Ly8gU2hvdyBkb2N1bWVudCBpbnNpZ2h0cyBhZnRlciBsb2FkaW5nIGNvbnZlcnNhdGlvblxuXHRcdFx0YXdhaXQgdGhpcy5zaG93RG9jdW1lbnRJbnNpZ2h0cyh0YXJnZXRGaWxlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUEhBU0UgMyBGSVg6IEZpbmFsIGNoZWNrIGFmdGVyIGFsbCBhc3luYyBvcGVyYXRpb25zXG5cdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZUxvYWRPcGVyYXRpb24gIT09IG9wZXJhdGlvbklkKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdcdTI2QTBcdUZFMEYgRmlsZSBsb2FkIG9wZXJhdGlvbiBjYW5jZWxsZWQgZHVyaW5nIGluc2lnaHRzIGxvYWRpbmcnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBDaGF0UmVuZGVyZXIgd2lsbCBoYW5kbGUgc2hvd2luZyB3ZWxjb21lIG1lc3NhZ2UgaWYgbm8gY29udmVyc2F0aW9uIGV4aXN0c1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnXHUyNzRDIENPTlZFUlNBVElPTiBMT0FESU5HIEVSUk9SOicsIGVycm9yKTtcblx0XHRcdC8vIEZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IC0gZ3JhY2VmdWwgZmFsbGJhY2tcblx0XHRcdC8vIFNob3cgd2VsY29tZSBtZXNzYWdlIG9uIGVycm9yXG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjbGVhckNoYXQoKSB7XG5cdFx0Ly8gQ2xlYXIgdGhlIGNoYXQgY29udGFpbmVyXG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgY29udmVyc2F0aW9uIGluIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24odGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDbGVhciB0b2tlbiB3YXJuaW5nc1xuXHRcdFx0XHR0aGlzLmxhc3RUb2tlbldhcm5pbmdzID0ge307XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBGYWlsZWQgdG8gY2xlYXIgY29udmVyc2F0aW9uIC0gZ3JhY2VmdWwgZmFsbGJhY2tcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2hvdyBub3RpY2UgdG8gdXNlclxuXHRcdG5ldyBOb3RpY2UoJ0NoYXQgY2xlYXJlZCcpO1xuXHRcdFxuXHRcdC8vIFNob3cgd2VsY29tZSBtZXNzYWdlIGZpcnN0LCBiZWZvcmUgY29udGV4dCByZWZyZXNoIHRyaWdnZXJzIHdhcm5pbmdzXG5cdFx0dGhpcy5hZGRXZWxjb21lTWVzc2FnZSgpO1xuXHRcdFxuXHRcdC8vIFRoZW4gcmVmcmVzaCBjb250ZXh0IHRvIHJlYnVpbGQgY3VycmVudENvbnRleHQgZnJvbSBwZXJzaXN0ZW50IHN0b3JhZ2UgYW5kIHVwZGF0ZSBVSVxuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ29vcmRpbmF0b3IgbWV0aG9kIHRoYXQgdXBkYXRlcyBib3RoIGRvY3VtZW50IHN0YXRzIGFuZCBjb250ZXh0IHJlbWFpbmluZ1xuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hBbGxTdGF0cygpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBTa2lwIHVwZGF0ZXMgZHVyaW5nIHN0cmVhbWluZyB0byBhdm9pZCBjb25mbGljdHNcblx0XHRpZiAodGhpcy5zdHJlYW1pbmdNYW5hZ2VyLmlzU3RyZWFtaW5nKCkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0YXdhaXQgdGhpcy51cGRhdGVEb2N1bWVudFN0YXRzKCk7XG5cdFx0XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IHRvIHJlY2FsY3VsYXRlIHRva2VuIGNvdW50cyB3aXRoIHVwZGF0ZWQgZG9jdW1lbnQgY29udGVudFxuXHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcblx0XHR0aGlzLnVwZGF0ZUNvbnRleHRSZW1haW5pbmcoKTtcblx0fVxuXG5cdC8vIFVwZGF0ZSBvbmx5IGRvY3VtZW50IHN0YXRpc3RpY3MgKHdvcmQgY291bnQsIHNlY3Rpb25zKVxuXHRwcml2YXRlIGFzeW5jIHVwZGF0ZURvY3VtZW50U3RhdHMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0aWYgKCFhY3RpdmVGaWxlKSByZXR1cm47XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBkb2N1bWVudCBjb250ZW50XG5cdFx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcblx0XHRcdGlmICghY29udGVudCkgcmV0dXJuO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgYmFzaWMgc3RhdHNcblx0XHRcdGNvbnN0IHdvcmRDb3VudCA9IGNvbnRlbnQuc3BsaXQoL1xccysvKS5maWx0ZXIod29yZCA9PiB3b3JkLmxlbmd0aCA+IDApLmxlbmd0aDtcblx0XHRcdGNvbnN0IGhlYWRpbmdDb3VudCA9IChjb250ZW50Lm1hdGNoKC9eI3sxLDZ9XFxzL2dtKSB8fCBbXSkubGVuZ3RoO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgc3RhdHMgZGlzcGxheSBpbiBoZWFkZXJcblx0XHRcdGNvbnN0IGhlYWRlckVsID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1oZWFkZXInKTtcblx0XHRcdGlmIChoZWFkZXJFbCkge1xuXHRcdFx0XHQvLyBGaW5kIG9yIGNyZWF0ZSBzdGF0cyBjb250YWluZXJcblx0XHRcdFx0bGV0IHN0YXRzQ29udGFpbmVyID0gaGVhZGVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtZG9jdW1lbnQtc3RhdHMtY29udGFpbmVyJyk7XG5cdFx0XHRcdGlmICghc3RhdHNDb250YWluZXIpIHtcblx0XHRcdFx0XHRzdGF0c0NvbnRhaW5lciA9IGhlYWRlckVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtZG9jdW1lbnQtc3RhdHMtY29udGFpbmVyJyB9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gRmluZCBvciBjcmVhdGUgZG9jdW1lbnQgc3RhdHMgZWxlbWVudFxuXHRcdFx0XHRsZXQgc3RhdHNFbCA9IHN0YXRzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWRvY3VtZW50LXN0YXRzJyk7XG5cdFx0XHRcdGlmICghc3RhdHNFbCkge1xuXHRcdFx0XHRcdHN0YXRzRWwgPSBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLWRvY3VtZW50LXN0YXRzJyB9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHN0YXRzRWwgJiYgd29yZENvdW50ID4gMCkge1xuXHRcdFx0XHRcdC8vIENhbGN1bGF0ZSByZWFkaW5nIHRpbWUgKHdvcmRzIC8gMjI1ID0gbWludXRlcylcblx0XHRcdFx0XHRjb25zdCByZWFkaW5nVGltZSA9IE1hdGguY2VpbCh3b3JkQ291bnQgLyAyMjUpO1xuXHRcdFx0XHRcdHN0YXRzRWwudGV4dENvbnRlbnQgPSBgfiAke3JlYWRpbmdUaW1lfSBtaW4gcmVhZGA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gU2lsZW50bHkgZmFpbCAtIHN0YXRzIGFyZSBvcHRpb25hbFxuXHRcdH1cblx0fVxuXG5cdC8vIFVwZGF0ZSBvbmx5IGNvbnRleHQgcmVtYWluaW5nIGRpc3BsYXkgKHRva2VuIHBlcmNlbnRhZ2UpXG5cdHByaXZhdGUgdXBkYXRlQ29udGV4dFJlbWFpbmluZygpOiB2b2lkIHtcblx0XHR0aGlzLnVwZGF0ZVRva2VuRGlzcGxheSgpO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVUb2tlbkRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWhlYWRlcicpO1xuXHRcdGlmICghaGVhZGVyRWwpIHJldHVybjtcblx0XHRcblx0XHQvLyBGaW5kIG9yIGNyZWF0ZSBzdGF0cyBjb250YWluZXIgYW5kIGJvdGggZWxlbWVudHMgaWYgdGhleSBkb24ndCBleGlzdFxuXHRcdGxldCBzdGF0c0NvbnRhaW5lciA9IGhlYWRlckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWRvY3VtZW50LXN0YXRzLWNvbnRhaW5lcicpO1xuXHRcdGlmICghc3RhdHNDb250YWluZXIpIHtcblx0XHRcdHN0YXRzQ29udGFpbmVyID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1kb2N1bWVudC1zdGF0cy1jb250YWluZXInIH0pO1xuXHRcdH1cblx0XHRcblx0XHQvLyBFbnN1cmUgZG9jdW1lbnQgc3RhdHMgZWxlbWVudCBleGlzdHMgKGxlZnQgc2lkZSlcblx0XHRsZXQgc3RhdHNFbCA9IHN0YXRzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWRvY3VtZW50LXN0YXRzJyk7XG5cdFx0aWYgKCFzdGF0c0VsKSB7XG5cdFx0XHRzdGF0c0VsID0gc3RhdHNDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1kb2N1bWVudC1zdGF0cycgfSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEVuc3VyZSB0b2tlbiBlbGVtZW50IGV4aXN0cyAocmlnaHQgc2lkZSlcblx0XHRsZXQgdG9rZW5FbCA9IHN0YXRzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXRva2VuLXVzYWdlJykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0aWYgKCF0b2tlbkVsKSB7XG5cdFx0XHR0b2tlbkVsID0gc3RhdHNDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS10b2tlbi11c2FnZScgfSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEdldCB0b3RhbCBjb250ZXh0IHVzYWdlIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGZhbGwgYmFjayB0byBvbGQgY2FsY3VsYXRpb25cblx0XHRjb25zdCB0b3RhbENvbnRleHRVc2FnZSA9IHRoaXMuY3VycmVudENvbnRleHQ/LnRvdGFsQ29udGV4dFVzYWdlO1xuXHRcdGxldCByZW1haW5pbmdQZXJjZW50OiBudW1iZXI7XG5cdFx0bGV0IHdhcm5pbmdMZXZlbDogc3RyaW5nO1xuXHRcdGxldCBkaXNwbGF5VGV4dDogc3RyaW5nO1xuXHRcdGxldCB0b29sdGlwVGV4dDogc3RyaW5nO1xuXHRcdFxuXHRcdGlmICh0b3RhbENvbnRleHRVc2FnZSkge1xuXHRcdFx0Ly8gVXNlIG5ldyB0b3RhbCBjb250ZXh0IGNhbGN1bGF0aW9uXG5cdFx0XHRyZW1haW5pbmdQZXJjZW50ID0gZ2V0UmVtYWluaW5nQ29udGV4dFBlcmNlbnRhZ2UodG90YWxDb250ZXh0VXNhZ2UpO1xuXHRcdFx0d2FybmluZ0xldmVsID0gZ2V0Q29udGV4dFdhcm5pbmdMZXZlbCh0b3RhbENvbnRleHRVc2FnZSk7XG5cdFx0XHRkaXNwbGF5VGV4dCA9IGZvcm1hdENvbnRleHRVc2FnZSh0b3RhbENvbnRleHRVc2FnZSk7XG5cdFx0XHR0b29sdGlwVGV4dCA9IGdldENvbnRleHRUb29sdGlwKHRvdGFsQ29udGV4dFVzYWdlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gdG90YWwgY29udGV4dCB1c2FnZSBhdmFpbGFibGUgLSBzaG93IG1pbmltYWwgaW5mbyB3aXRob3V0IHdhcm5pbmdzXG5cdFx0XHRjb25zdCBjdXJyZW50VG9rZW5zID0gdGhpcy5jdXJyZW50Q29udGV4dD8udG9rZW5Db3VudCB8fCAwO1xuXHRcdFx0cmVtYWluaW5nUGVyY2VudCA9IDEwMDsgLy8gRG9uJ3QgY2FsY3VsYXRlIHBlcmNlbnRhZ2Ugd2l0aG91dCBwcm9wZXIgY29udGV4dCBsaW1pdHNcblx0XHRcdGRpc3BsYXlUZXh0ID0gY3VycmVudFRva2VucyA+IDAgPyBgJHtjdXJyZW50VG9rZW5zfSB0b2tlbnNgIDogJzAlIGxlZnQnO1xuXHRcdFx0dG9vbHRpcFRleHQgPSBgRmlsZSBjb250ZXh0OiAke2N1cnJlbnRUb2tlbnN9IHRva2VucyAodG90YWwgY29udGV4dCBjYWxjdWxhdGlvbiB1bmF2YWlsYWJsZSlgO1xuXHRcdFx0d2FybmluZ0xldmVsID0gJ3NhZmUnOyAvLyBObyB3YXJuaW5ncyB3aGVuIGNhbGN1bGF0aW9uIHVuYXZhaWxhYmxlXG5cdFx0fVxuXHRcdFxuXHRcdC8vIFVwZGF0ZSBkaXNwbGF5IHRleHRcblx0XHR0b2tlbkVsLnRleHRDb250ZW50ID0gZGlzcGxheVRleHQ7XG5cdFx0XG5cdFx0Ly8gU2V0IHRvb2x0aXBcblx0XHR0b2tlbkVsLnRpdGxlID0gdG9vbHRpcFRleHQ7XG5cdFx0XG5cdFx0Ly8gQXBwbHkgY29sb3IgY29kaW5nIGFuZCBzaG93IHdhcm5pbmdzXG5cdFx0dG9rZW5FbC5jbGFzc05hbWUgPSAnbm92YS10b2tlbi11c2FnZSc7XG5cdFx0aWYgKHdhcm5pbmdMZXZlbCA9PT0gJ3NhZmUnKSB7XG5cdFx0XHR0b2tlbkVsLmFkZENsYXNzKCdub3ZhLXRva2VuLXNhZmUnKTtcblx0XHR9IGVsc2UgaWYgKHdhcm5pbmdMZXZlbCA9PT0gJ3dhcm5pbmcnKSB7XG5cdFx0XHR0b2tlbkVsLmFkZENsYXNzKCdub3ZhLXRva2VuLXdhcm5pbmcnKTtcblx0XHRcdHRoaXMuc2hvd1Rva2VuV2FybmluZyg4NSk7IC8vIDg1JSB1c2FnZSA9IDE1JSByZW1haW5pbmdcblx0XHR9IGVsc2UgaWYgKHdhcm5pbmdMZXZlbCA9PT0gJ2NyaXRpY2FsJykge1xuXHRcdFx0dG9rZW5FbC5hZGRDbGFzcygnbm92YS10b2tlbi1kYW5nZXInKTtcblx0XHRcdHRoaXMuc2hvd1Rva2VuV2FybmluZyg5NSk7IC8vIDk1JSB1c2FnZSA9IDUlIHJlbWFpbmluZ1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd1Rva2VuV2FybmluZyh0aHJlc2hvbGQ6IG51bWJlcik6IHZvaWQge1xuXHRcdC8vIFByZXZlbnQgZHVwbGljYXRlIHdhcm5pbmdzIC0gb25seSBzaG93IG9uY2UgcGVyIHRocmVzaG9sZCBwZXIgY29udGV4dCBzZXNzaW9uXG5cdFx0Y29uc3Qgd2FybmluZ0tleSA9IGB0b2tlbi13YXJuaW5nLSR7dGhyZXNob2xkfWA7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBzaG93biB0aGlzIHRocmVzaG9sZCB3YXJuaW5nXG5cdFx0aWYgKHRoaXMubGFzdFRva2VuV2FybmluZ3Nbd2FybmluZ0tleV0pIHJldHVybjtcblx0XHRcblx0XHQvLyBNYXJrIHRoaXMgdGhyZXNob2xkIGFzIHdhcm5lZFxuXHRcdHRoaXMubGFzdFRva2VuV2FybmluZ3Nbd2FybmluZ0tleV0gPSBEYXRlLm5vdygpO1xuXHRcdFxuXHRcdGxldCBtZXNzYWdlOiBzdHJpbmc7XG5cdFx0aWYgKHRocmVzaG9sZCA9PT0gNzUpIHtcblx0XHRcdG1lc3NhZ2UgPSBcIlx1MjEzOVx1RkUwRiBDb250ZXh0IHVzYWdlIGlzIGdyb3dpbmcuIEN1cnJlbnQgY29udmVyc2F0aW9uIGFuZCBmaWxlIGNvbnRleHQgYXJlIHVzaW5nIHNpZ25pZmljYW50IHRva2Vucy5cIjtcblx0XHR9IGVsc2UgaWYgKHRocmVzaG9sZCA9PT0gODUpIHtcblx0XHRcdG1lc3NhZ2UgPSBcIlx1MjZBMFx1RkUwRiBDb250ZXh0IHVzYWdlIGhpZ2ggKDg1JSkuIENvbnNpZGVyIHN0YXJ0aW5nIGEgbmV3IGNvbnZlcnNhdGlvbiBvciByZW1vdmluZyBmaWxlIGNvbnRleHQgZm9yIGJldHRlciBBSSBwZXJmb3JtYW5jZS5cIjtcblx0XHR9IGVsc2UgaWYgKHRocmVzaG9sZCA9PT0gOTUpIHtcblx0XHRcdG1lc3NhZ2UgPSBcIlx1MjZBMFx1RkUwRiBDb250ZXh0IG5lYXJseSBmdWxsICg5NSUpLiBTdGFydCBhIG5ldyBjb252ZXJzYXRpb24gb3IgY2xlYXIgY29udGV4dCBpbW1lZGlhdGVseSBmb3IgcmVsaWFibGUgQUkgcmVzcG9uc2VzLlwiO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBMZWdhY3kgZmFsbGJhY2tcblx0XHRcdG1lc3NhZ2UgPSBcIlx1MjZBMFx1RkUwRiBDb250ZXh0IGFwcHJvYWNoaW5nIGxpbWl0LiBDb25zaWRlciBjbGVhcmluZyBjb250ZXh0IG9yIHN0YXJ0aW5nIGEgbmV3IGNvbnZlcnNhdGlvbi5cIjtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5hZGRXYXJuaW5nTWVzc2FnZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkV2FybmluZ01lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jaGF0UmVuZGVyZXIuYWRkV2FybmluZ01lc3NhZ2UoY29udGVudCwgdHJ1ZSk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHNob3dEb2N1bWVudEluc2lnaHRzKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0Y29uc3QgYW5hbHlzaXMgPSBEb2N1bWVudEFuYWx5emVyLmFuYWx5emVTdHJ1Y3R1cmUoY29udGVudCk7XG5cdFx0XHRcblx0XHRcdGlmIChhbmFseXNpcy5lbXB0eUhlYWRpbmdzLmxlbmd0aCA+IDAgfHwgYW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCBpbnNpZ2h0czogc3RyaW5nW10gPSBbXTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChhbmFseXNpcy5lbXB0eUhlYWRpbmdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRpbnNpZ2h0cy5wdXNoKGAke2FuYWx5c2lzLmVtcHR5SGVhZGluZ3MubGVuZ3RofSBlbXB0eSBoZWFkaW5nJHthbmFseXNpcy5lbXB0eUhlYWRpbmdzLmxlbmd0aCA+IDEgPyAncycgOiAnJ30gdG8gZmlsbGApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoYW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGluc2lnaHRzLnB1c2goYCR7YW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RofSBpbmNvbXBsZXRlIGJ1bGxldCR7YW5hbHlzaXMuaW5jb21wbGV0ZUJ1bGxldHMubGVuZ3RoID4gMSA/ICdzJyA6ICcnfWApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaW5zaWdodHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IGJ1bGxldExpc3QgPSBpbnNpZ2h0cy5tYXAoaW5zaWdodCA9PiBgXHUyMDIyICR7aW5zaWdodH1gKS5qb2luKCdcXG4nKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDcmVhdGUgYSBjdXN0b20gbGVmdC1hbGlnbmVkIG1lc3NhZ2UgZm9yIGRvY3VtZW50IGluc2lnaHRzXG5cdFx0XHRcdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtYXNzaXN0YW50IG5vdmEtaW5zaWdodHMnIH0pO1xuXHRcdFx0XHRcdG1lc3NhZ2VFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTIpO1xuXHRcdFx0XHRcdFx0cGFkZGluZzogdmFyKC0tc2l6ZS0yLTMpIHZhcigtLXNpemUtNC0zKTtcblx0XHRcdFx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdFx0XHRcdG1heC13aWR0aDogODUlO1xuXHRcdFx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTtcblx0XHRcdFx0XHRcdHRleHQtYWxpZ246IGxlZnQ7XG5cdFx0XHRcdFx0XHRtYXJnaW4tbGVmdDogMDtcblx0XHRcdFx0XHRcdG1hcmdpbi1yaWdodDogYXV0bztcblx0XHRcdFx0XHRgO1xuXG5cdFx0XHRcdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0XHRcdFx0dGV4dDogJ05vdmEnLFxuXHRcdFx0XHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRcdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRcdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0XHRcdGA7XG5cblx0XHRcdFx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdFx0XHRcdGNvbnRlbnRFbC5zdHlsZS5jc3NUZXh0ID0gJ3doaXRlLXNwYWNlOiBwcmUtbGluZTsgdGV4dC1hbGlnbjogbGVmdDsnO1xuXHRcdFx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGBJIG5vdGljZWQ6XFxuXFxuJHtidWxsZXRMaXN0fVxcblxcbkxldCBtZSBoZWxwLmA7XG5cblx0XHRcdFx0XHQvLyBTY3JvbGwgdG8gc2hvdyB0aGUgbmV3IG1lc3NhZ2Vcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUb3AgPSB0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsSGVpZ2h0O1xuXHRcdFx0XHRcdH0sIDUwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBTaWxlbnRseSBmYWlsIC0gYW5hbHlzaXMgaXMgb3B0aW9uYWxcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGNvbnN1bHRhdGlvbiByZXF1ZXN0cyAtIGNoYXQgb25seSwgbm8gZG9jdW1lbnQgbW9kaWZpY2F0aW9uXG5cdCAqL1xuXHRhc3luYyBoYW5kbGVDb25zdWx0YXRpb25SZXF1ZXN0KGlucHV0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIEdldCBBSSByZXNwb25zZSB1c2luZyBQcm9tcHRCdWlsZGVyIGJ1dCBkbyBOT1QgbW9kaWZ5IGRvY3VtZW50XG5cdFx0Y29uc3QgcHJvbXB0ID0gYXdhaXQgdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlci5idWlsZFByb21wdEZvck1lc3NhZ2UoaW5wdXQsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQsIHByb21wdC51c2VyUHJvbXB0KTtcblx0XHRcblx0XHQvLyBEaXNwbGF5IHJlc3BvbnNlIGluIGNoYXQgb25seVxuXHRcdHRoaXMuZGlzcGxheUNoYXRSZXNwb25zZShyZXNwb25zZSk7XG5cdFx0XG5cdFx0Ly8gU2hvdyBzdWJ0bGUgbW9kZSBpbmRpY2F0b3Jcblx0XHR0aGlzLnNob3dNb2RlSW5kaWNhdG9yKCdjb25zdWx0YXRpb24nKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBEaXNwbGF5IEFJIHJlc3BvbnNlIGluIGNoYXQgd2l0aG91dCBkb2N1bWVudCBtb2RpZmljYXRpb25cblx0ICovXG5cdGRpc3BsYXlDaGF0UmVzcG9uc2UocmVzcG9uc2U6IHN0cmluZyk6IHZvaWQge1xuXHRcdC8vIFVzZSBleGlzdGluZyBjaGF0IHJlbmRlcmVyIHRvIGRpc3BsYXkgcmVzcG9uc2Vcblx0XHR0aGlzLmNoYXRSZW5kZXJlci5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCByZXNwb25zZSk7XG5cdH1cblxuXHQvKipcblx0ICogU2hvdyBzdWJ0bGUgaW5kaWNhdG9yIGZvciBjb25zdWx0YXRpb24gdnMgZWRpdGluZyBtb2RlXG5cdCAqL1xuXHRzaG93TW9kZUluZGljYXRvcihtb2RlOiAnY29uc3VsdGF0aW9uJyB8ICdlZGl0aW5nJyk6IHZvaWQge1xuXHRcdC8vIEZvciBub3csIHRoaXMgaXMgYSBuby1vcCBwbGFjZWhvbGRlclxuXHRcdC8vIEZ1dHVyZSBlbmhhbmNlbWVudDogc2hvdyBzdWJ0bGUgVUkgaW5kaWNhdG9yXG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGVkaXRpbmcgcmVxdWVzdHMgLSBwcmVzZXJ2ZXMgZXhpc3RpbmcgYmVoYXZpb3Igd2l0aCBpbnRlbnQgdHJhY2tpbmdcblx0ICovXG5cdGFzeW5jIGhhbmRsZUVkaXRpbmdSZXF1ZXN0KGlucHV0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHQvLyBQYXJzZSBjb21tYW5kIHVzaW5nIGV4aXN0aW5nIHBhcnNlclxuXHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnB1dCk7XG5cdFx0XG5cdFx0Ly8gVHJhY2sgaW50ZW50IHVzYWdlIGZvciBhbmFseXRpY3Ncblx0XHR0aGlzLnRyYWNrSW50ZW50VXNhZ2UoJ2VkaXRpbmcnLCBpbnB1dCk7XG5cdFx0XG5cdFx0Ly8gRXhlY3V0ZSBjb21tYW5kIHVzaW5nIGV4aXN0aW5nIHN5c3RlbVxuXHRcdHJldHVybiBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFRyYWNrIGludGVudCB1c2FnZSBmb3IgYW5hbHl0aWNzIChwbGFjZWhvbGRlciBmb3IgZnV0dXJlIGVuaGFuY2VtZW50KVxuXHQgKi9cblx0dHJhY2tJbnRlbnRVc2FnZShpbnRlbnQ6ICdjb25zdWx0YXRpb24nIHwgJ2VkaXRpbmcnLCBpbnB1dDogc3RyaW5nKTogdm9pZCB7XG5cdFx0Ly8gRm9yIG5vdywgdGhpcyBpcyBhIG5vLW9wIHBsYWNlaG9sZGVyXG5cdFx0Ly8gRnV0dXJlIGVuaGFuY2VtZW50OiBjb2xsZWN0IGFuYWx5dGljcyBkYXRhXG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGFtYmlndW91cyByZXF1ZXN0cyBieSByb3V0aW5nIHRvIGNob3NlbiBoYW5kbGVyXG5cdCAqL1xuXHRhc3luYyBoYW5kbGVBbWJpZ3VvdXNSZXF1ZXN0KGlucHV0OiBzdHJpbmcsIGNob3NlbkludGVudDogJ2NvbnN1bHRhdGlvbicgfCAnZWRpdGluZycpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoY2hvc2VuSW50ZW50ID09PSAnY29uc3VsdGF0aW9uJykge1xuXHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVDb25zdWx0YXRpb25SZXF1ZXN0KGlucHV0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVFZGl0aW5nUmVxdWVzdChpbnB1dCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFByb2Nlc3MgdXNlciBpbnB1dCB3aXRoIGludGVudCBkZXRlY3Rpb24gaW50ZWdyYXRpb25cblx0ICovXG5cdGFzeW5jIHByb2Nlc3NVc2VySW5wdXRXaXRoSW50ZW50KGlucHV0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBpbnRlbnQgPSBhd2FpdCB0aGlzLnBsdWdpbi5haUludGVudENsYXNzaWZpZXIuY2xhc3NpZnlJbnRlbnQoaW5wdXQpO1xuXHRcdFxuXHRcdHN3aXRjaCAoaW50ZW50KSB7XG5cdFx0XHRjYXNlICdDSEFUJzpcblx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVDb25zdWx0YXRpb25SZXF1ZXN0KGlucHV0KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdDT05URU5UJzpcblx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVFZGl0aW5nUmVxdWVzdChpbnB1dCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnTUVUQURBVEEnOlxuXHRcdFx0XHQvLyBIYW5kbGUgbWV0YWRhdGEgY29tbWFuZHMgdGhyb3VnaCBleGlzdGluZyBmbG93XG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChpbnB1dCk7XG5cdFx0XHRcdGF3YWl0IHRoaXMuZXhlY3V0ZUNvbW1hbmQocGFyc2VkQ29tbWFuZCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXG5cdC8vIFB1YmxpYyBtZXRob2RzIGZvciB0ZXN0aW5nXG5cdGFzeW5jIHNlbmRNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gQnVpbGQgcHJvbXB0IHVzaW5nIFByb21wdEJ1aWxkZXJcblx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShtZXNzYWdlLCBhY3RpdmVGaWxlIHx8IHVuZGVmaW5lZCk7XG5cdFx0XG5cdFx0Ly8gVHJ5IHRvIHBhcnNlIGFzIGNvbW1hbmQgZmlyc3Rcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQobWVzc2FnZSk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIHZhbGlkIGNvbW1hbmQgYWN0aW9uXG5cdFx0Y29uc3QgdmFsaWRBY3Rpb25zID0gWydhZGQnLCAnZWRpdCcsICdkZWxldGUnLCAnZ3JhbW1hcicsICdyZXdyaXRlJywgJ21ldGFkYXRhJ107XG5cdFx0aWYgKHZhbGlkQWN0aW9ucy5pbmNsdWRlcyhjb21tYW5kLmFjdGlvbikpIHtcblx0XHRcdC8vIENSSVRJQ0FMIFNFQ1VSSVRZOiBWYWxpZGF0ZSB0aGF0IHdlJ3JlIGVkaXRpbmcgdGhlIGNvcnJlY3QgZmlsZVxuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgZWRpdGluZyBjb250ZXh0IGRvY3VtZW50cyB0aGF0IG1pZ2h0IGJlIG9wZW5cblx0XHRcdC8vIE9ubHkgYXBwbHkgdGhpcyB2YWxpZGF0aW9uIHdoZW4gYm90aCBmaWxlcyBleGlzdCAobm90IGluIHRlc3Qgc2NlbmFyaW9zKVxuXHRcdFx0Y29uc3QgY3VycmVudEFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSAmJiBjdXJyZW50QWN0aXZlRmlsZSAmJiBjdXJyZW50QWN0aXZlRmlsZSAhPT0gYWN0aXZlRmlsZSkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFNlY3VyaXR5IHZpb2xhdGlvbjogQ29tbWFuZCBhdHRlbXB0ZWQgdG8gZWRpdCB3cm9uZyBmaWxlLiBFeHBlY3RlZDogJHthY3RpdmVGaWxlLmJhc2VuYW1lfSwgQWN0aXZlOiAke2N1cnJlbnRBY3RpdmVGaWxlLmJhc2VuYW1lfWApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBFeGVjdXRlIGNvbW1hbmRcblx0XHRcdHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcblx0XHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5ncmFtbWFyQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4ucmV3cml0ZUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ21ldGFkYXRhJzpcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5tZXRhZGF0YUNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFJlZ3VsYXIgY29udmVyc2F0aW9uIC0gbWVzc2FnZSBhbHJlYWR5IHBlcnNpc3RlZCBhYm92ZVxuXHRcdFx0XG5cdFx0XHQvLyBDYWxsIEFJIHByb3ZpZGVyXG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShwcm9tcHQuc3lzdGVtUHJvbXB0IHx8ICcnLCBwcm9tcHQudXNlclByb21wdCk7XG5cdFx0XHRcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkQXNzaXN0YW50TWVzc2FnZShhY3RpdmVGaWxlLCAnQUkgcmVzcG9uc2UnLCB7IHN1Y2Nlc3M6IHRydWUsIGVkaXRUeXBlOiAnbm9uZScgfSBhcyBhbnkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIFJFTU9WRUQ6IE5vdyB1c2luZyBDaGF0UmVuZGVyZXIncyBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeSBtZXRob2QgZGlyZWN0bHlcblxuXG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBzZW5kIGJ1dHRvbiBlbmFibGVkL2Rpc2FibGVkIHN0YXRlIGJhc2VkIG9uIHByb3ZpZGVyIGF2YWlsYWJpbGl0eVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyB1cGRhdGVTZW5kQnV0dG9uU3RhdGUoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgY3VycmVudFByb3ZpZGVyVHlwZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEN1cnJlbnRQcm92aWRlclR5cGUoKTtcblx0XHRjb25zdCBzZW5kQnV0dG9uID0gKHRoaXMuaW5wdXRIYW5kbGVyIGFzIGFueSkuc2VuZEJ1dHRvbjtcblx0XHRpZiAoc2VuZEJ1dHRvbikgc2VuZEJ1dHRvbi5zZXREaXNhYmxlZCghY3VycmVudFByb3ZpZGVyVHlwZSk7XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIHByaXZhY3kgaW5kaWNhdG9yIGljb24gYW5kIHRvb2x0aXAgYmFzZWQgb24gY3VycmVudCBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyB1cGRhdGVQcml2YWN5SW5kaWNhdG9yKHByaXZhY3lJbmRpY2F0b3I6IEhUTUxFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgY3VycmVudFByb3ZpZGVyVHlwZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEN1cnJlbnRQcm92aWRlclR5cGUoKTtcblx0XHRcblx0XHQvLyBDbGVhciBwcmV2aW91cyBjb250ZW50XG5cdFx0cHJpdmFjeUluZGljYXRvci5lbXB0eSgpO1xuXHRcdHByaXZhY3lJbmRpY2F0b3IucmVtb3ZlQ2xhc3MoJ25vdmEtc3RhdHVzLXBpbGwnLCAnbG9jYWwnLCAnY2xvdWQnKTtcblx0XHRcblx0XHQvLyBBcHBseSBpbmxpbmUgc3R5bGVzIGZvciBjb25zaXN0ZW50IHNpemluZ1xuXHRcdHByaXZhY3lJbmRpY2F0b3Iuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGlubGluZS1mbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogMnB4IDhweDtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDEycHg7XG5cdFx0XHRmb250LXNpemU6IDAuNzVlbTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRoZWlnaHQ6IGF1dG87XG5cdFx0XHRsaW5lLWhlaWdodDogMS41O1xuXHRcdGA7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRQcm92aWRlclR5cGUpIHtcblx0XHRcdGNvbnN0IGlzTG9jYWxQcm92aWRlciA9IGN1cnJlbnRQcm92aWRlclR5cGUgPT09ICdvbGxhbWEnO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgcGlsbCBzdHlsaW5nIGNsYXNzZXNcblx0XHRcdHByaXZhY3lJbmRpY2F0b3IuYWRkQ2xhc3MoJ25vdmEtc3RhdHVzLXBpbGwnKTtcblx0XHRcdHByaXZhY3lJbmRpY2F0b3IuYWRkQ2xhc3MoaXNMb2NhbFByb3ZpZGVyID8gJ2xvY2FsJyA6ICdjbG91ZCcpO1xuXHRcdFx0XG5cdFx0XHQvLyBDcmVhdGUgaWNvbiBlbGVtZW50XG5cdFx0XHRjb25zdCBpY29uRWwgPSBwcml2YWN5SW5kaWNhdG9yLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXN0YXR1cy1pY29uJyB9KTtcblx0XHRcdGljb25FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBpbmxpbmUtZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0d2lkdGg6IDE0cHg7XG5cdFx0XHRcdGhlaWdodDogMTRweDtcblx0XHRcdGA7XG5cdFx0XHRjb25zdCBpY29uTmFtZSA9IGlzTG9jYWxQcm92aWRlciA/ICdzaGllbGQtY2hlY2snIDogJ2Nsb3VkJztcblx0XHRcdHNldEljb24oaWNvbkVsLCBpY29uTmFtZSk7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCB0ZXh0IGxhYmVsXG5cdFx0XHRjb25zdCBsYWJlbEVsID0gcHJpdmFjeUluZGljYXRvci5jcmVhdGVTcGFuKHsgdGV4dDogaXNMb2NhbFByb3ZpZGVyID8gJ0xvY2FsJyA6ICdDbG91ZCcgfSk7XG5cdFx0XHRsYWJlbEVsLnN0eWxlLmNzc1RleHQgPSBgbGluZS1oZWlnaHQ6IDE7YDtcblx0XHRcdFxuXHRcdFx0Ly8gU2V0IHRvb2x0aXBcblx0XHRcdGNvbnN0IHRvb2x0aXAgPSBpc0xvY2FsUHJvdmlkZXIgPyAnTG9jYWwgcHJvY2Vzc2luZyAtIGRhdGEgc3RheXMgb24geW91ciBkZXZpY2UnIDogJ0Nsb3VkIHByb2Nlc3NpbmcgLSBkYXRhIHNlbnQgdG8gcHJvdmlkZXInO1xuXHRcdFx0cHJpdmFjeUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCB0b29sdGlwKTtcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCd0aXRsZScsIHRvb2x0aXApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyBwcm92aWRlciBhdmFpbGFibGUgLSBzaG93IGdlbmVyaWMgc3RhdHVzXG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLmFkZENsYXNzKCdub3ZhLXN0YXR1cy1waWxsJyk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGljb25FbCA9IHByaXZhY3lJbmRpY2F0b3IuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtc3RhdHVzLWljb24nIH0pO1xuXHRcdFx0aWNvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGlubGluZS1mbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHR3aWR0aDogMTRweDtcblx0XHRcdFx0aGVpZ2h0OiAxNHB4O1xuXHRcdFx0YDtcblx0XHRcdHNldEljb24oaWNvbkVsLCAnaGVscC1jaXJjbGUnKTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgbGFiZWxFbCA9IHByaXZhY3lJbmRpY2F0b3IuY3JlYXRlU3Bhbih7IHRleHQ6ICdObyBwcm92aWRlcicgfSk7XG5cdFx0XHRsYWJlbEVsLnN0eWxlLmNzc1RleHQgPSBgbGluZS1oZWlnaHQ6IDE7YDtcblx0XHRcdFxuXHRcdFx0cHJpdmFjeUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnTm8gcHJvdmlkZXIgc2VsZWN0ZWQnKTtcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCd0aXRsZScsICdObyBwcm92aWRlciBzZWxlY3RlZCcpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBGaWx0ZXIgdGhpbmtpbmcgY29udGVudCBmcm9tIEFJIHJlc3BvbnNlc1xuXHQgKiBSZW1vdmVzIGNvbnRlbnQgYmV0d2VlbiA8dGhpbms+Lzx0aGlua2luZz4gYW5kIDwvdGhpbms+Lzx0aGlua2luZz4gdGFnc1xuXHQgKi9cblx0cHJpdmF0ZSBmaWx0ZXJUaGlua2luZ0NvbnRlbnQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBSZW1vdmUgdGhpbmtpbmcgdGFncyBhbmQgdGhlaXIgY29udGVudCAoY2FzZS1pbnNlbnNpdGl2ZSwgbXVsdGktbGluZSlcblx0XHQvLyBIYW5kbGVzIGJvdGggPHRoaW5rPiAoUXdlbjMpIGFuZCA8dGhpbmtpbmc+IChDbGF1ZGUpIHRhZ3Ncblx0XHRyZXR1cm4gY29udGVudC5yZXBsYWNlKC88dGhpbmsoPzppbmcpP1tcXHNcXFNdKj88XFwvdGhpbmsoPzppbmcpPz4vZ2ksICcnKS50cmltKCk7XG5cdH1cblxuXHQvKipcblx0ICogUmVmcmVzaCBhbGwgcHJvdmlkZXIgc3RhdHVzIGluZGljYXRvcnMgaW4gdGhlIFVJXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hQcm92aWRlclN0YXR1cygpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBVcGRhdGUgcHJpdmFjeSBpbmRpY2F0b3IgaWYgaXQgZXhpc3RzXG5cdFx0aWYgKCh0aGlzIGFzIGFueSkucHJpdmFjeUluZGljYXRvcikge1xuXHRcdFx0YXdhaXQgdGhpcy51cGRhdGVQcml2YWN5SW5kaWNhdG9yKCh0aGlzIGFzIGFueSkucHJpdmFjeUluZGljYXRvcik7XG5cdFx0fVxuXG5cdFx0Ly8gVXBkYXRlIHNlbmQgYnV0dG9uIHN0YXRlXG5cdFx0dGhpcy51cGRhdGVTZW5kQnV0dG9uU3RhdGUoKTtcblxuXHRcdC8vIFVwZGF0ZSBkcm9wZG93biBwcm92aWRlciBuYW1lIGlmIGl0IGV4aXN0c1xuXHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy51cGRhdGVDdXJyZW50UHJvdmlkZXIpIHtcblx0XHRcdGF3YWl0ICh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24udXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBwcm92aWRlciBkcm9wZG93biBmb3IgYWxsIHVzZXJzIHdpdGggdGhlaXIgb3duIEFQSSBrZXlzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZVByb3ZpZGVyRHJvcGRvd24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGRyb3Bkb3duQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItZHJvcGRvd24tY29udGFpbmVyJyB9KTtcblx0XHRkcm9wZG93bkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgcHJvdmlkZXIgYnV0dG9uXG5cdFx0Y29uc3QgcHJvdmlkZXJCdXR0b24gPSBkcm9wZG93bkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWJ1dHRvbicgfSk7XG5cdFx0cHJvdmlkZXJCdXR0b24uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA0cHg7XG5cdFx0XHRwYWRkaW5nOiA0cHggOHB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdGA7XG5cblx0XHQvLyBQcm92aWRlciBuYW1lIC0gc3RhcnQgd2l0aCBhIHBsYWNlaG9sZGVyIHRvIHByZXZlbnQgXCJJSVwiIGRpc3BsYXlcblx0XHRjb25zdCBwcm92aWRlck5hbWUgPSBwcm92aWRlckJ1dHRvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ0xvYWRpbmcuLi4nLCBjbHM6ICdub3ZhLXByb3ZpZGVyLW5hbWUnIH0pO1xuXG5cdFx0Ly8gRHJvcGRvd24gYXJyb3dcblx0XHRjb25zdCBkcm9wZG93bkFycm93ID0gcHJvdmlkZXJCdXR0b24uY3JlYXRlU3Bhbih7IHRleHQ6ICdcdTI1QkMnIH0pO1xuXHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogMC42ZW07XG5cdFx0XHRtYXJnaW4tbGVmdDogNHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gRHJvcGRvd24gbWVudSAoaW5pdGlhbGx5IGhpZGRlbilcblx0XHRjb25zdCBkcm9wZG93bk1lbnUgPSBkcm9wZG93bkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLW1lbnUnIH0pO1xuXHRcdGRyb3Bkb3duTWVudS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0dG9wOiAxMDAlO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRtaW4td2lkdGg6IDIwMHB4O1xuXHRcdFx0bWF4LXdpZHRoOiAyODBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDMwMHB4O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdG92ZXJmbG93LXg6IGhpZGRlbjtcblx0XHRcdFxuXHRcdFx0LyogTW9iaWxlIHJlc3BvbnNpdmUgYWRqdXN0bWVudHMgKi9cblx0XHRcdEBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkge1xuXHRcdFx0XHRtaW4td2lkdGg6IDE4MHB4O1xuXHRcdFx0XHRtYXgtd2lkdGg6IDI1MHB4O1xuXHRcdFx0XHRtYXgtaGVpZ2h0OiAyNTBweDtcblx0XHRcdFx0cmlnaHQ6IC0yMHB4OyAvKiBPZmZzZXQgdG8gcHJldmVudCBlZGdlIGN1dG9mZiAqL1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKiBTbW9vdGggc2Nyb2xsaW5nICovXG5cdFx0XHRzY3JvbGwtYmVoYXZpb3I6IHNtb290aDtcblx0XHRcdFxuXHRcdFx0LyogQ3VzdG9tIHNjcm9sbGJhciBzdHlsaW5nICovXG5cdFx0XHRzY3JvbGxiYXItd2lkdGg6IHRoaW47XG5cdFx0XHRzY3JvbGxiYXItY29sb3I6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSB0cmFuc3BhcmVudDtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIEFkZCB3ZWJraXQgc2Nyb2xsYmFyIHN0eWxpbmcgZm9yIGJldHRlciBjcm9zcy1icm93c2VyIHN1cHBvcnRcblx0XHRjb25zdCBzY3JvbGxiYXJTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG5cdFx0c2Nyb2xsYmFyU3R5bGUudGV4dENvbnRlbnQgPSBgXG5cdFx0XHQubm92YS1wcm92aWRlci1kcm9wZG93bi1tZW51Ojotd2Via2l0LXNjcm9sbGJhciB7XG5cdFx0XHRcdHdpZHRoOiA2cHg7XG5cdFx0XHR9XG5cdFx0XHQubm92YS1wcm92aWRlci1kcm9wZG93bi1tZW51Ojotd2Via2l0LXNjcm9sbGJhci10cmFjayB7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuXHRcdFx0fVxuXHRcdFx0Lm5vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudTo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIge1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDNweDtcblx0XHRcdH1cblx0XHRcdC5ub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLW1lbnU6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xuXHRcdFx0fVxuXHRcdGA7XG5cdFx0aWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm92YS1zY3JvbGxiYXItc3R5bGUnKSkge1xuXHRcdFx0c2Nyb2xsYmFyU3R5bGUuY2xhc3NOYW1lID0gJ25vdmEtc2Nyb2xsYmFyLXN0eWxlJztcblx0XHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2Nyb2xsYmFyU3R5bGUpO1xuXHRcdH1cblxuXHRcdGxldCBpc0Ryb3Bkb3duT3BlbiA9IGZhbHNlO1xuXG5cdFx0Ly8gVXBkYXRlIGN1cnJlbnQgbW9kZWwgZGlzcGxheSAob3B0aW1pemVkIGZvciBzcGVlZClcblx0XHRjb25zdCB1cGRhdGVDdXJyZW50UHJvdmlkZXIgPSAoKSA9PiB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtb2RlbCBzeW5jaHJvbm91c2x5XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdldEN1cnJlbnRNb2RlbCgpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGN1cnJlbnRNb2RlbCkge1xuXHRcdFx0XHRcdC8vIEdldCBwcm92aWRlciB0eXBlIGRpcmVjdGx5IGZyb20gbW9kZWwgbmFtZSAobm8gYXN5bmMgbmVlZGVkKVxuXHRcdFx0XHRcdGNvbnN0IHByb3ZpZGVyVHlwZSA9IHRoaXMuZ2V0UHJvdmlkZXJUeXBlRnJvbU1vZGVsKGN1cnJlbnRNb2RlbCk7XG5cdFx0XHRcdFx0aWYgKHByb3ZpZGVyVHlwZSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGlzcGxheVRleHQgPSB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBjdXJyZW50TW9kZWwpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBEZWZlbnNpdmUgY2hlY2sgdG8gcHJldmVudCBcIklJXCIgb3Igb3RoZXIgbWFsZm9ybWVkIGRpc3BsYXlzXG5cdFx0XHRcdFx0XHRpZiAoZGlzcGxheVRleHQgJiYgZGlzcGxheVRleHQubGVuZ3RoID4gMiAmJiAhZGlzcGxheVRleHQubWF0Y2goL15JKyQvKSkge1xuXHRcdFx0XHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChkaXNwbGF5VGV4dCk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBGYWxsYmFjayB0byByYXcgbW9kZWwgbmFtZSBpZiBkaXNwbGF5IHRleHQgaXMgaW52YWxpZFxuXHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ0ludmFsaWQgbW9kZWwgZGlzcGxheSB0ZXh0LCB1c2luZyByYXcgbW9kZWwgbmFtZTonLCBkaXNwbGF5VGV4dCk7XG5cdFx0XHRcdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KGN1cnJlbnRNb2RlbCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIFVua25vd24gcHJvdmlkZXIsIHVzZSByYXcgbW9kZWwgbmFtZVxuXHRcdFx0XHRcdFx0cHJvdmlkZXJOYW1lLnNldFRleHQoY3VycmVudE1vZGVsKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gTm8gbW9kZWwgc2VsZWN0ZWQsIHNob3cgZmFsbGJhY2tcblx0XHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dCgnU2VsZWN0IE1vZGVsJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIG1vZGVsIGRpc3BsYXk6JywgZXJyb3IpO1xuXHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dCgnU2VsZWN0IE1vZGVsJyk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIFRvZ2dsZSBkcm9wZG93blxuXHRcdGNvbnN0IHRvZ2dsZURyb3Bkb3duID0gKCkgPT4ge1xuXHRcdFx0aXNEcm9wZG93bk9wZW4gPSAhaXNEcm9wZG93bk9wZW47XG5cdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9IGlzRHJvcGRvd25PcGVuID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gaXNEcm9wZG93bk9wZW4gPyAncm90YXRlKDE4MGRlZyknIDogJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHRcblx0XHRcdGlmIChpc0Ryb3Bkb3duT3Blbikge1xuXHRcdFx0XHR0aGlzLnBvcHVsYXRlUHJvdmlkZXJEcm9wZG93bihkcm9wZG93bk1lbnUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBDbG9zZSBkcm9wZG93biB3aGVuIGNsaWNraW5nIG91dHNpZGVcblx0XHRjb25zdCBjbG9zZURyb3Bkb3duOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCFkcm9wZG93bkNvbnRhaW5lci5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0aXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblx0XHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdGRyb3Bkb3duQXJyb3cuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgwZGVnKSc7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIENsb3NlIGRyb3Bkb3duIGhlbHBlciBmdW5jdGlvbiBmb3IgaW50ZXJuYWwgdXNlXG5cdFx0Y29uc3QgY2xvc2VEcm9wZG93bkludGVybmFsID0gKCkgPT4ge1xuXHRcdFx0aXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDBkZWcpJztcblx0XHR9O1xuXG5cdFx0cHJvdmlkZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdHRvZ2dsZURyb3Bkb3duKCk7XG5cdFx0fSk7XG5cblx0XHQvLyBBZGQgZ2xvYmFsIGNsaWNrIGxpc3RlbmVyXG5cdFx0dGhpcy5hZGRUcmFja2VkRXZlbnRMaXN0ZW5lcihkb2N1bWVudCwgJ2NsaWNrJywgY2xvc2VEcm9wZG93bik7XG5cblx0XHQvLyBVcGRhdGUgbW9kZWwgbmFtZSBpbW1lZGlhdGVseSAobm8gYXN5bmMgbmVlZGVkKVxuXHRcdHVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciBjbGVhbnVwIGFuZCBpbnRlcm5hbCBkcm9wZG93biBjb250cm9sXG5cdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93biA9IHtcblx0XHRcdHVwZGF0ZUN1cnJlbnRQcm92aWRlcixcblx0XHRcdGNsb3NlRHJvcGRvd246IGNsb3NlRHJvcGRvd25JbnRlcm5hbCxcblx0XHRcdGNsZWFudXA6ICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VEcm9wZG93bilcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHByb3ZpZGVyIHR5cGVcblx0ICovXG5cdHByaXZhdGUgZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogeyB2YWx1ZTogc3RyaW5nOyBsYWJlbDogc3RyaW5nIH1bXSB7XG5cdFx0cmV0dXJuIGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBtb2RlbCBmb3IgYSBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnRNb2RlbChwcm92aWRlclR5cGU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgcHJvdmlkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMgYXMgUmVjb3JkPHN0cmluZywgYW55Pjtcblx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSBwcm92aWRlcnNbcHJvdmlkZXJUeXBlXT8ubW9kZWw7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRNb2RlbCkge1xuXHRcdFx0cmV0dXJuIGN1cnJlbnRNb2RlbDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gR2V0IGRlZmF1bHQgbW9kZWwgKGZpcnN0IGF2YWlsYWJsZSBtb2RlbCBmb3IgdGhlIHByb3ZpZGVyKVxuXHRcdGNvbnN0IGF2YWlsYWJsZU1vZGVscyA9IHRoaXMuZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSk7XG5cdFx0cmV0dXJuIGF2YWlsYWJsZU1vZGVscy5sZW5ndGggPiAwID8gYXZhaWxhYmxlTW9kZWxzWzBdLnZhbHVlIDogJyc7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IG1vZGVsIGRpc3BsYXkgbmFtZSBmcm9tIG1vZGVsIHZhbHVlXG5cdCAqL1xuXHRwcml2YXRlIGdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcsIG1vZGVsVmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRjb25zdCBtb2RlbCA9IG1vZGVscy5maW5kKG0gPT4gbS52YWx1ZSA9PT0gbW9kZWxWYWx1ZSk7XG5cdFx0Y29uc3QgZGlzcGxheU5hbWUgPSBtb2RlbCA/IG1vZGVsLmxhYmVsIDogbW9kZWxWYWx1ZTtcblx0XHRcblx0XHQvLyBEZWZlbnNpdmUgY2hlY2sgdG8gcHJldmVudCBcIklJXCIgYnVnXG5cdFx0aWYgKGRpc3BsYXlOYW1lID09PSBcIklJXCIgfHwgZGlzcGxheU5hbWUubWF0Y2goL15JKyQvKSB8fCBkaXNwbGF5TmFtZS5sZW5ndGggPCAzKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0ludmFsaWQgbW9kZWwgZGlzcGxheSBuYW1lIHByZXZlbnRlZDonLCBkaXNwbGF5TmFtZSwgJ2ZvciBtb2RlbDonLCBtb2RlbFZhbHVlKTtcblx0XHRcdC8vIFJldHVybiBhIG1vcmUgZGVzY3JpcHRpdmUgZmFsbGJhY2tcblx0XHRcdHJldHVybiB0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGRpc3BsYXlOYW1lO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBwcm92aWRlciB0eXBlIGZyb20gbW9kZWwgbmFtZSBzeW5jaHJvbm91c2x5IChwYXR0ZXJuIG1hdGNoaW5nKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlclR5cGVGcm9tTW9kZWwobW9kZWxOYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcblx0XHRpZiAobW9kZWxOYW1lLnN0YXJ0c1dpdGgoJ2NsYXVkZS0nKSkgcmV0dXJuICdjbGF1ZGUnO1xuXHRcdGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aCgnZ3B0LScpIHx8IG1vZGVsTmFtZS5zdGFydHNXaXRoKCdvMS0nKSkgcmV0dXJuICdvcGVuYWknO1xuXHRcdGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aCgnZ2VtaW5pLScpKSByZXR1cm4gJ2dvb2dsZSc7XG5cdFx0Ly8gRGVmYXVsdCB0byBPbGxhbWEgZm9yIHVucmVjb2duaXplZCBtb2RlbHNcblx0XHRyZXR1cm4gJ29sbGFtYSc7XG5cdH1cblxuXHQvKipcblx0ICogU3dpdGNoIHRvIGEgc3BlY2lmaWMgbW9kZWwgZm9yIGEgcHJvdmlkZXJcblx0ICovXG5cdHByaXZhdGUgc3dpdGNoVG9Nb2RlbChwcm92aWRlclR5cGU6IHN0cmluZywgbW9kZWxWYWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFVwZGF0ZSBwbGF0Zm9ybSBzZXR0aW5ncyBmb3IgcGVyc2lzdGVuY2UgKHRoaXMgaXMgd2hhdCBhY3R1YWxseSBtYXR0ZXJzKVxuXHRcdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0uc2VsZWN0ZWRNb2RlbCA9IG1vZGVsVmFsdWU7XG5cdFx0XHRcblx0XHRcdC8vIEFsc28gdXBkYXRlIHByb3ZpZGVyIG1vZGVsIHNldHRpbmcgZm9yIGNvbnNpc3RlbmN5XG5cdFx0XHRjb25zdCBwcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXHRcdFx0aWYgKHByb3ZpZGVyc1twcm92aWRlclR5cGVdKSB7XG5cdFx0XHRcdHByb3ZpZGVyc1twcm92aWRlclR5cGVdLm1vZGVsID0gbW9kZWxWYWx1ZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gU2hvdyBzdWNjZXNzIG1lc3NhZ2UgaW1tZWRpYXRlbHkgKG9wdGltaXN0aWMgdXBkYXRlKVxuXHRcdFx0Y29uc3QgbW9kZWxEaXNwbGF5TmFtZSA9IHRoaXMuZ2V0TW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGUsIG1vZGVsVmFsdWUpO1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJEaXNwbGF5TmFtZSA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHRcdFx0dGhpcy5hZGRTdWNjZXNzTWVzc2FnZShgXHUyNzEzIFN3aXRjaGVkIHRvICR7cHJvdmlkZXJEaXNwbGF5TmFtZX0gJHttb2RlbERpc3BsYXlOYW1lfWApO1xuXHRcdFx0XG5cdFx0XHQvLyBTYXZlIHNldHRpbmdzIGFzeW5jaHJvbm91c2x5IChkb24ndCBibG9jayBVSSlcblx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpLmNhdGNoKGVycm9yID0+IHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIG1vZGVsIHNlbGVjdGlvbjonLCBlcnJvcik7XG5cdFx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKCdGYWlsZWQgdG8gc2F2ZSBtb2RlbCBzZWxlY3Rpb24nKTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBBREQgVEhJUzogUmVmcmVzaCBwcml2YWN5IGluZGljYXRvciBhbmQgb3RoZXIgc3RhdHVzIGVsZW1lbnRzXG5cdFx0XHR0aGlzLnJlZnJlc2hQcm92aWRlclN0YXR1cygpLmNhdGNoKGVycm9yID0+IHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyBwcm92aWRlciBzdGF0dXM6JywgZXJyb3IpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igc3dpdGNoaW5nIG1vZGVsOicsIGVycm9yKTtcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKCdGYWlsZWQgdG8gc3dpdGNoIG1vZGVsJyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBvcHVsYXRlIHByb3ZpZGVyIGRyb3Bkb3duIHdpdGggZ3JvdXBlZCBtb2RlbHMgYW5kIHNlY3Rpb24gaGVhZGVyc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51OiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGRyb3Bkb3duTWVudS5lbXB0eSgpO1xuXG5cdFx0Ly8gU2hvdyBsb2FkaW5nIHN0YXRlXG5cdFx0Y29uc3QgbG9hZGluZ0l0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kcm9wZG93bi1sb2FkaW5nJyB9KTtcblx0XHRsb2FkaW5nSXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cGFkZGluZzogMTJweDtcblx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0YDtcblx0XHRsb2FkaW5nSXRlbS5zZXRUZXh0KCdMb2FkaW5nIHByb3ZpZGVycy4uLicpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBhbGwgcHJvdmlkZXJzIGluIHBhcmFsbGVsIHdpdGggYXZhaWxhYmlsaXR5IHN0YXR1c1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJBdmFpbGFiaWxpdHkgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRBdmFpbGFibGVQcm92aWRlcnNXaXRoU3RhdHVzKCk7XG5cdFx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50TW9kZWwoKTtcblx0XHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cblx0XHRcdC8vIENsZWFyIGxvYWRpbmcgc3RhdGVcblx0XHRcdGRyb3Bkb3duTWVudS5lbXB0eSgpO1xuXG5cdFx0XHQvLyBHcm91cCBtb2RlbHMgYnkgcHJvdmlkZXIgd2l0aCBzZWN0aW9uIGhlYWRlcnNcblx0XHRcdGxldCBoYXNBbnlQcm92aWRlcnMgPSBmYWxzZTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCBbcHJvdmlkZXJUeXBlLCBpc0F2YWlsYWJsZV0gb2YgcHJvdmlkZXJBdmFpbGFiaWxpdHkpIHtcblx0XHRcdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnIHx8ICFpc0F2YWlsYWJsZSkgY29udGludWU7XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIEFQSSBrZXkgY29uZmlndXJlZFxuXHRcdFx0XHRjb25zdCBwcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXHRcdFx0XHRjb25zdCBoYXNBcGlLZXkgPSBwcm92aWRlcnNbcHJvdmlkZXJUeXBlXT8uYXBpS2V5O1xuXHRcdFx0XHRpZiAoIWhhc0FwaUtleSAmJiBwcm92aWRlclR5cGUgIT09ICdvbGxhbWEnKSBjb250aW51ZTtcblxuXHRcdFx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFx0XHRjb25zdCBwcm92aWRlckRpc3BsYXlOYW1lID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRcdGNvbnN0IHByb3ZpZGVyQ29sb3IgPSB0aGlzLmdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlKTtcblxuXHRcdFx0XHQvLyBTa2lwIHByb3ZpZGVycyB3aXRoIG5vIG1vZGVsc1xuXHRcdFx0XHRpZiAobW9kZWxzLmxlbmd0aCA9PT0gMCAmJiBwcm92aWRlclR5cGUgIT09ICdvbGxhbWEnKSBjb250aW51ZTtcblxuXHRcdFx0XHQvLyBBZGQgcHJvdmlkZXIgc2VjdGlvbiBoZWFkZXJcblx0XHRcdFx0aWYgKGhhc0FueVByb3ZpZGVycykge1xuXHRcdFx0XHRcdC8vIEFkZCBzZXBhcmF0b3IgYmV0d2VlbiBwcm92aWRlciBzZWN0aW9uc1xuXHRcdFx0XHRcdGNvbnN0IHNlcGFyYXRvciA9IGRyb3Bkb3duTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlcGFyYXRvcicgfSk7XG5cdFx0XHRcdFx0c2VwYXJhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IDFweDtcblx0XHRcdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdFx0XHRcdG1hcmdpbjogNHB4IDhweDtcblx0XHRcdFx0XHRgO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3Qgc2VjdGlvbkhlYWRlciA9IGRyb3Bkb3duTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLXNlY3Rpb24taGVhZGVyJyB9KTtcblx0XHRcdFx0c2VjdGlvbkhlYWRlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxMnB4IDRweCAxMnB4O1xuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0XHRnYXA6IDZweDtcblx0XHRcdFx0YDtcblxuXHRcdFx0XHQvLyBQcm92aWRlciBjb2xvciBkb3QgaW4gaGVhZGVyXG5cdFx0XHRcdGNvbnN0IGhlYWRlckRvdCA9IHNlY3Rpb25IZWFkZXIuY3JlYXRlU3BhbigpO1xuXHRcdFx0XHRoZWFkZXJEb3Quc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHR3aWR0aDogNnB4O1xuXHRcdFx0XHRcdGhlaWdodDogNnB4O1xuXHRcdFx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdFx0XHRiYWNrZ3JvdW5kOiAke3Byb3ZpZGVyQ29sb3J9O1xuXHRcdFx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdHNlY3Rpb25IZWFkZXIuY3JlYXRlU3Bhbih7IHRleHQ6IHByb3ZpZGVyRGlzcGxheU5hbWUgfSk7XG5cdFx0XHRcdGhhc0FueVByb3ZpZGVycyA9IHRydWU7XG5cblx0XHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHQvLyBQcm92aWRlciB3aXRob3V0IHNwZWNpZmljIG1vZGVscyAobGlrZSBPbGxhbWEpXG5cdFx0XHRcdFx0dGhpcy5jcmVhdGVNb2RlbERyb3Bkb3duSXRlbShcblx0XHRcdFx0XHRcdGRyb3Bkb3duTWVudSxcblx0XHRcdFx0XHRcdHByb3ZpZGVyVHlwZSxcblx0XHRcdFx0XHRcdHByb3ZpZGVyc1twcm92aWRlclR5cGVdPy5tb2RlbCB8fCBwcm92aWRlckRpc3BsYXlOYW1lLFxuXHRcdFx0XHRcdFx0cHJvdmlkZXJEaXNwbGF5TmFtZSxcblx0XHRcdFx0XHRcdHByb3ZpZGVyQ29sb3IsXG5cdFx0XHRcdFx0XHRjdXJyZW50UHJvdmlkZXJUeXBlID09PSBwcm92aWRlclR5cGUsXG5cdFx0XHRcdFx0XHRjdXJyZW50TW9kZWxcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIFByb3ZpZGVyIHdpdGggc3BlY2lmaWMgbW9kZWxzXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBtb2RlbCBvZiBtb2RlbHMpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGlzQ3VycmVudFNlbGVjdGlvbiA9IGN1cnJlbnRQcm92aWRlclR5cGUgPT09IHByb3ZpZGVyVHlwZSAmJiBtb2RlbC52YWx1ZSA9PT0gY3VycmVudE1vZGVsO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHR0aGlzLmNyZWF0ZU1vZGVsRHJvcGRvd25JdGVtKFxuXHRcdFx0XHRcdFx0XHRkcm9wZG93bk1lbnUsXG5cdFx0XHRcdFx0XHRcdHByb3ZpZGVyVHlwZSxcblx0XHRcdFx0XHRcdFx0bW9kZWwudmFsdWUsXG5cdFx0XHRcdFx0XHRcdG1vZGVsLmxhYmVsLFxuXHRcdFx0XHRcdFx0XHRwcm92aWRlckNvbG9yLFxuXHRcdFx0XHRcdFx0XHRpc0N1cnJlbnRTZWxlY3Rpb24sXG5cdFx0XHRcdFx0XHRcdGN1cnJlbnRNb2RlbFxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgbm8gcHJvdmlkZXJzIGF2YWlsYWJsZSwgc2hvdyBtZXNzYWdlXG5cdFx0XHRpZiAoIWhhc0FueVByb3ZpZGVycykge1xuXHRcdFx0XHRjb25zdCBub1Byb3ZpZGVyc0l0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KCk7XG5cdFx0XHRcdG5vUHJvdmlkZXJzSXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDEycHg7XG5cdFx0XHRcdFx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRgO1xuXHRcdFx0XHRub1Byb3ZpZGVyc0l0ZW0uc2V0VGV4dCgnTm8gcHJvdmlkZXJzIGF2YWlsYWJsZScpO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBvcHVsYXRpbmcgcHJvdmlkZXIgZHJvcGRvd246JywgZXJyb3IpO1xuXHRcdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cdFx0XHRjb25zdCBlcnJvckl0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KCk7XG5cdFx0XHRlcnJvckl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogMTJweDtcblx0XHRcdFx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1lcnJvcik7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRgO1xuXHRcdFx0ZXJyb3JJdGVtLnNldFRleHQoJ0Vycm9yIGxvYWRpbmcgcHJvdmlkZXJzJyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhIHNpbmdsZSBtb2RlbCBkcm9wZG93biBpdGVtIChqdXN0IG1vZGVsIG5hbWUsIG5vIHByb3ZpZGVyIHByZWZpeClcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlTW9kZWxEcm9wZG93bkl0ZW0oXG5cdFx0Y29udGFpbmVyOiBIVE1MRWxlbWVudCxcblx0XHRwcm92aWRlclR5cGU6IHN0cmluZyxcblx0XHRtb2RlbFZhbHVlOiBzdHJpbmcsXG5cdFx0bW9kZWxEaXNwbGF5TmFtZTogc3RyaW5nLFxuXHRcdHByb3ZpZGVyQ29sb3I6IHN0cmluZyxcblx0XHRpc0N1cnJlbnQ6IGJvb2xlYW4sXG5cdFx0Y3VycmVudE1vZGVsOiBzdHJpbmdcblx0KTogdm9pZCB7XG5cdFx0Y29uc3QgaXRlbSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWRyb3Bkb3duLWl0ZW0nIH0pO1xuXHRcdGl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4IDhweCAyMHB4O1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogM3B4O1xuXHRcdFx0bWFyZ2luOiAxcHggNnB4O1xuXHRcdFx0JHtpc0N1cnJlbnQgPyAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7JyA6ICcnfVxuXHRcdGA7XG5cblx0XHQvLyBQcm92aWRlciBjb2xvciBpbmRpY2F0b3IgKHNtYWxsZXIgZG90KVxuXHRcdGNvbnN0IGRvdCA9IGl0ZW0uY3JlYXRlU3BhbigpO1xuXHRcdGRvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0d2lkdGg6IDZweDtcblx0XHRcdGhlaWdodDogNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0YmFja2dyb3VuZDogJHtwcm92aWRlckNvbG9yfTtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0b3BhY2l0eTogMC43O1xuXHRcdGA7XG5cblx0XHQvLyBNb2RlbCBuYW1lIG9ubHkgKG5vIHByb3ZpZGVyIHByZWZpeClcblx0XHRjb25zdCB0ZXh0U3BhbiA9IGl0ZW0uY3JlYXRlU3Bhbih7IHRleHQ6IG1vZGVsRGlzcGxheU5hbWUgfSk7XG5cdFx0dGV4dFNwYW4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXg6IDE7XG5cdFx0XHR3aGl0ZS1zcGFjZTogbm93cmFwO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHNlbGVjdGlvbiBpbmRpY2F0b3Jcblx0XHRpZiAoaXNDdXJyZW50KSB7XG5cdFx0XHRjb25zdCBjaGVja21hcmsgPSBpdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnXHUyNzEzJyB9KTtcblx0XHRcdGNoZWNrbWFyay5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRjb2xvcjogJHtwcm92aWRlckNvbG9yfTtcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjllbTtcblx0XHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIENsaWNrIGhhbmRsZXIgZm9yIHNpbmdsZS1jbGljayBzZWxlY3Rpb25cblx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcblx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Ly8gU3dpdGNoIG1vZGVsIGltbWVkaWF0ZWx5IChubyBhd2FpdCBuZWVkZWQpXG5cdFx0XHRcdFx0dGhpcy5zd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZSwgbW9kZWxWYWx1ZSB8fCB0aGlzLmdldEN1cnJlbnRNb2RlbChwcm92aWRlclR5cGUpKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDbG9zZSBkcm9wZG93biBpbW1lZGlhdGVseVxuXHRcdFx0XHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy5jbG9zZURyb3Bkb3duKSB7XG5cdFx0XHRcdFx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLmNsb3NlRHJvcGRvd24oKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gVXBkYXRlIGRpc3BsYXkgaW1tZWRpYXRlbHlcblx0XHRcdFx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igc3dpdGNoaW5nIHByb3ZpZGVyL21vZGVsOicsIGVycm9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSG92ZXIgZWZmZWN0c1xuXHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3ZlciknO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3RyYXNoLTInOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTMgNkg1SDIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04IDZWNEEyIDIgMCAwIDEgMTAgMkgxNEEyIDIgMCAwIDEgMTYgNFY2TTE5IDZWMjBBMiAyIDAgMCAxIDE3IDIySDdBMiAyIDAgMCAxIDUgMjBWNkgxOVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDExVjE3XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAxMVYxN1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdBbnRocm9waWMnLFxuXHRcdFx0J29wZW5haSc6ICdPcGVuQUknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdPbGxhbWEnLFxuXHRcdFx0J25vbmUnOiAnTm9uZSdcblx0XHR9O1xuXHRcdHJldHVybiBuYW1lc1twcm92aWRlclR5cGVdIHx8IHByb3ZpZGVyVHlwZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBoZWFkZXIgKGp1c3QgbW9kZWwgbmFtZSBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSBwcm92aWRlciBuYW1lKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFxuXHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5nZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IG1vZGVsRGlzcGxheU5hbWUgPSB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBjdXJyZW50TW9kZWwpO1xuXHRcdFx0XG5cdFx0XHQvLyBEZWJ1ZyBsb2dnaW5nIGZvciBcIklJXCIgaXNzdWVcblx0XHRcdGlmIChtb2RlbERpc3BsYXlOYW1lID09PSBcIklJXCIgfHwgbW9kZWxEaXNwbGF5TmFtZS5tYXRjaCgvXkkrJC8pKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybignSW52YWxpZCBtb2RlbCBkaXNwbGF5IG5hbWUgZGV0ZWN0ZWQ6Jywge1xuXHRcdFx0XHRcdHByb3ZpZGVyVHlwZSxcblx0XHRcdFx0XHRjdXJyZW50TW9kZWwsXG5cdFx0XHRcdFx0bW9kZWxEaXNwbGF5TmFtZSxcblx0XHRcdFx0XHRtb2RlbHNcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiBtb2RlbERpc3BsYXlOYW1lO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFVzZSB0aGVtZS1jb21wYXRpYmxlIGNvbG9ycyBpbnN0ZWFkIG9mIGhhcmRjb2RlZCBoZXggdmFsdWVzXG5cdFx0Y29uc3QgY29sb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICd2YXIoLS1jb2xvci1vcmFuZ2UpJyxcblx0XHRcdCdvcGVuYWknOiAndmFyKC0tY29sb3ItZ3JlZW4pJyxcblx0XHRcdCdnb29nbGUnOiAndmFyKC0tY29sb3ItYmx1ZSknLFxuXHRcdFx0J29sbGFtYSc6ICd2YXIoLS1jb2xvci1wdXJwbGUpJyxcblx0XHRcdCdub25lJzogJ3ZhcigtLXRleHQtbXV0ZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICd2YXIoLS10ZXh0LXN1Y2Nlc3MpJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgbW9kZWwgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgdGhlIGNvbW1hbmQgYnV0dG9uIHNob3VsZCBiZSBzaG93biBiYXNlZCBvbiBmZWF0dXJlIGF2YWlsYWJpbGl0eSBhbmQgdXNlciBwcmVmZXJlbmNlXG5cdCAqL1xuXHRwcml2YXRlIHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdC8vIENvbW1hbmQgYnV0dG9uIGlzIGdhdGVkIGJlaGluZCB0aGUgY29tbWFuZHMgZmVhdHVyZSBcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggYWxsIFN1cGVybm92YS1nYXRlZCBVSSBlbGVtZW50cyB3aGVuIGxpY2Vuc2Ugc3RhdHVzIGNoYW5nZXNcblx0ICovXG5cdHJlZnJlc2hTdXBlcm5vdmFVSSgpOiB2b2lkIHtcblx0XHR0aGlzLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0Ly8gRnV0dXJlIFN1cGVybm92YSBmZWF0dXJlcyBjYW4gYWRkIHRoZWlyIHJlZnJlc2ggbG9naWMgaGVyZVxuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggdGhlIHByb3ZpZGVyIGRyb3Bkb3duIGRpc3BsYXkgdG8gcmVmbGVjdCBjdXJyZW50IHNldHRpbmdzXG5cdCAqL1xuXHRhc3luYyByZWZyZXNoUHJvdmlkZXJEcm9wZG93bigpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8udXBkYXRlQ3VycmVudFByb3ZpZGVyKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnXHVEODNEXHVERDA0IFJlZnJlc2hpbmcgcHJvdmlkZXIgZHJvcGRvd24gVUkgYWZ0ZXIgc2V0dGluZ3MgdXBkYXRlJyk7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRhd2FpdCAodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLnVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignXHUyNzRDIEZhaWxlZCB0byByZWZyZXNoIHByb3ZpZGVyIGRyb3Bkb3duOicsIGVycm9yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUmVmcmVzaCB0aGUgY29tbWFuZCBidXR0b24gdmlzaWJpbGl0eSB3aGVuIHNldHRpbmdzIGNoYW5nZVxuXHQgKi9cblx0cmVmcmVzaENvbW1hbmRCdXR0b24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuaW5wdXRIYW5kbGVyKSB7XG5cdFx0XHR0aGlzLmlucHV0SGFuZGxlci5yZWZyZXNoQ29tbWFuZEJ1dHRvbigpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgaW5wdXQgcm93IGxheW91dCB3aGVuIGNvbW1hbmQgYnV0dG9uIHZpc2liaWxpdHkgY2hhbmdlc1xuXHQgKi9cblx0cHJpdmF0ZSB1cGRhdGVJbnB1dFJvd0xheW91dCgpOiB2b2lkIHtcblx0XHQvLyBObyBuZWVkIHRvIG1hbnVhbGx5IGFkanVzdCB0ZXh0YXJlYSB3aWR0aCAtIGZsZXhib3ggaGFuZGxlcyBpdFxuXHRcdC8vIFRoZSB0ZXh0YXJlYSBjb250YWluZXIgaGFzIGZsZXg6IDEsIHNvIGl0IHdpbGwgZXhwYW5kL2NvbnRyYWN0IGF1dG9tYXRpY2FsbHlcblx0XHQvLyB3aGVuIHRoZSBjb21tYW5kIGJ1dHRvbiBpcyBzaG93bi9oaWRkZW5cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlIGFkZCBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZXhlY3V0ZUFkZENvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxhbnk+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIGZvdW5kJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZXQgY3Vyc29yIHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcblx0XHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdGlmICghY3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgY3Vyc29yIHBvc2l0aW9uJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uIHdpdGggY29tcGxldGlvbiBjYWxsYmFja3Ncblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb24sXG5cdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGFuaW1hdGlvbk1vZGU6ICdpbmxpbmUnLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6ICgpID0+IHRoaXMub25TdHJlYW1pbmdDb21wbGV0ZSgpXG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgYWRkIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgY2FsbGJhY2tcblx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBhZGQgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVFZGl0Q29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb24gd2l0aCBjb21wbGV0aW9uIGNhbGxiYWNrc1xuXHRcdFx0Y29uc3QgeyB1cGRhdGVTdHJlYW0sIHN0b3BTdHJlYW0gfSA9IHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zdGFydFN0cmVhbWluZyhcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRjdXJzb3JQb3NpdGlvbixcblx0XHRcdFx0dW5kZWZpbmVkLFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0YW5pbWF0aW9uTW9kZTogJ2lubGluZScsXG5cdFx0XHRcdFx0b25Db21wbGV0ZTogKCkgPT4gdGhpcy5vblN0cmVhbWluZ0NvbXBsZXRlKClcblx0XHRcdFx0fVxuXHRcdFx0KTtcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBlZGl0IGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgY2FsbGJhY2tcblx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCwgKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0XHR1cGRhdGVTdHJlYW0oY2h1bmssIGlzQ29tcGxldGUpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZ1xuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmcgb24gZXJyb3Jcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXHRcdFx0XHR0aHJvdyBlcnJvcjtcblx0XHRcdH1cblxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzdHJlYW1pbmcgZWRpdCBjb21tYW5kOicsIGVycm9yKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZXhlY3V0ZVJld3JpdGVDb21tYW5kV2l0aFN0cmVhbWluZyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8YW55PiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCB0aGUgYWN0aXZlIGVkaXRvclxuXHRcdFx0Y29uc3QgZWRpdG9yID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG5cdFx0XHRpZiAoIWVkaXRvcikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBmb3VuZCdcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2V0IGN1cnNvciBwb3NpdGlvbiBmb3Igc3RyZWFtaW5nXG5cdFx0XHRjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEN1cnNvclBvc2l0aW9uKCk7XG5cdFx0XHRpZiAoIWN1cnNvclBvc2l0aW9uKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdDb3VsZCBub3QgZGV0ZXJtaW5lIGN1cnNvciBwb3NpdGlvbidcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3RhcnQgc3RyZWFtaW5nIGF0IGN1cnNvciBwb3NpdGlvbiB3aXRoIGNvbXBsZXRpb24gY2FsbGJhY2tzXG5cdFx0XHRjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGN1cnNvclBvc2l0aW9uLFxuXHRcdFx0XHR1bmRlZmluZWQsXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRhbmltYXRpb25Nb2RlOiAnaW5saW5lJyxcblx0XHRcdFx0XHRvbkNvbXBsZXRlOiAoKSA9PiB0aGlzLm9uU3RyZWFtaW5nQ29tcGxldGUoKVxuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIHJld3JpdGUgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBjYWxsYmFja1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5yZXdyaXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyByZXdyaXRlIGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlR3JhbW1hckNvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxhbnk+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIGZvdW5kJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZXQgY3Vyc29yIHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcblx0XHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdGlmICghY3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgY3Vyc29yIHBvc2l0aW9uJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uIHdpdGggY29tcGxldGlvbiBjYWxsYmFja3Ncblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb24sXG5cdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGFuaW1hdGlvbk1vZGU6ICdpbmxpbmUnLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6ICgpID0+IHRoaXMub25TdHJlYW1pbmdDb21wbGV0ZSgpXG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgZ3JhbW1hciBjb21tYW5kIHdpdGggc3RyZWFtaW5nIGNhbGxiYWNrXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmdyYW1tYXJDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQsIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0dXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmdcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nIG9uIGVycm9yXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaW4gc3RyZWFtaW5nIGdyYW1tYXIgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgZmlsZXMgdG8gcGVyc2lzdGVudCBjb250ZXh0XG5cdCAqL1xuXHRhc3luYyBhZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdObyBmaWxlIGlzIG9wZW4uIFBsZWFzZSBvcGVuIGEgZmlsZSB0byBhZGQgY29udGV4dC4nLCAzMDAwKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb25zdCBhZGRlZEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGFscmVhZHlFeGlzdGluZ0ZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGN1cnJlbnRGaWxlczogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBub3RGb3VuZEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZGlyZWN0bHkgKHdpdGhvdXQgY2xlYXJpbmcgaXQpXG5cdFx0Y29uc3QgZXhpc3RpbmdQZXJzaXN0ZW50ID0gdGhpcy5jb250ZXh0TWFuYWdlci5nZXRQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuXHRcdGNvbnN0IHVwZGF0ZWRQZXJzaXN0ZW50ID0gWy4uLmV4aXN0aW5nUGVyc2lzdGVudF07XG5cdFx0XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBmaWxlbmFtZSBvZiBmaWxlbmFtZXMpIHtcblx0XHRcdC8vIEZpbmQgdGhlIGZpbGUgYnkgbmFtZVxuXHRcdFx0bGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZW5hbWUpO1xuXHRcdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVuYW1lICsgJy5tZCcpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblx0XHRcdFx0ZmlsZSA9IGZpbGVzLmZpbmQoXG5cdFx0XHRcdFx0KGYpID0+IGYuYmFzZW5hbWUgPT09IGZpbGVuYW1lIHx8IGYubmFtZSA9PT0gZmlsZW5hbWUgfHwgZi5wYXRoLmVuZHNXaXRoKCcvJyArIGZpbGVuYW1lKSB8fCBmLnBhdGguZW5kc1dpdGgoJy8nICsgZmlsZW5hbWUgKyAnLm1kJylcblx0XHRcdFx0KSB8fCBudWxsO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgdGhlIGN1cnJlbnQgYWN0aXZlIGZpbGVcblx0XHRcdFx0aWYgKGZpbGUucGF0aCA9PT0gdGhpcy5jdXJyZW50RmlsZT8ucGF0aCkge1xuXHRcdFx0XHRcdC8vIEN1cnJlbnQgZmlsZSBpcyBhbHJlYWR5IGltcGxpY2l0bHkgaW4gY29udGV4dFxuXHRcdFx0XHRcdGN1cnJlbnRGaWxlcy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0XHRcdC8vIEFkZCB3YXJuaW5nIG1lc3NhZ2UgdG8gY2hhdCAobm90IHNhdmVkIHRvIGNvbnZlcnNhdGlvbiBoaXN0b3J5KVxuXHRcdFx0XHRcdHRoaXMuY2hhdFJlbmRlcmVyLmFkZFdhcm5pbmdNZXNzYWdlKFwiQ3VycmVudCBmaWxlIGlzIGFsd2F5cyBpbiBjb250ZXh0IGFuZCBkb2Vzbid0IG5lZWQgdG8gYmUgYWRkZWQgZXhwbGljaXRseS5cIiwgZmFsc2UpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGFscmVhZHkgaW4gcGVyc2lzdGVudCBjb250ZXh0IChjaGVjayBib3RoIGV4aXN0aW5nIGFuZCBuZXdseSBhZGRlZCBpbiB0aGlzIGJhdGNoKVxuXHRcdFx0XHRcdGNvbnN0IGV4aXN0cyA9IHVwZGF0ZWRQZXJzaXN0ZW50LnNvbWUocmVmID0+IHJlZi5maWxlLnBhdGggPT09IChmaWxlIGFzIFRGaWxlKS5wYXRoKTtcblx0XHRcdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRcdFx0Ly8gQWRkIHRvIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0XHRcdFx0dXBkYXRlZFBlcnNpc3RlbnQucHVzaCh7XG5cdFx0XHRcdFx0XHRcdGZpbGU6IGZpbGUsXG5cdFx0XHRcdFx0XHRcdHByb3BlcnR5OiB1bmRlZmluZWQsXG5cdFx0XHRcdFx0XHRcdGlzUGVyc2lzdGVudDogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0cmF3UmVmZXJlbmNlOiBgK1tbJHtmaWxlLmJhc2VuYW1lfV1dYFxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRhZGRlZEZpbGVzLnB1c2goZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZpbGUgYWxyZWFkeSBleGlzdHMgaW4gY29udGV4dFxuXHRcdFx0XHRcdFx0YWxyZWFkeUV4aXN0aW5nRmlsZXMucHVzaChmaWxlLmJhc2VuYW1lKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgbm90IGZvdW5kXG5cdFx0XHRcdG5vdEZvdW5kRmlsZXMucHVzaChmaWxlbmFtZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHQgaWYgd2UgbWFkZSBhbnkgY2hhbmdlc1xuXHRcdGlmIChhZGRlZEZpbGVzLmxlbmd0aCA+IDAgfHwgYWxyZWFkeUV4aXN0aW5nRmlsZXMubGVuZ3RoID4gMCB8fCBjdXJyZW50RmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0Ly8gVXNlIENvbnRleHRNYW5hZ2VyIHRvIHVwZGF0ZSBwZXJzaXN0ZW50IGNvbnRleHRcblx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIuY2xlYXJQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlLnBhdGgpO1xuXHRcdFx0Zm9yIChjb25zdCBkb2Mgb2YgdXBkYXRlZFBlcnNpc3RlbnQpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5jb250ZXh0TWFuYWdlci5hZGREb2N1bWVudChkb2MuZmlsZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFJlZnJlc2ggY29udGV4dCBVSVxuXHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcblx0XHQvLyBTaG93IGEgc2luZ2xlIGNvbXByZWhlbnNpdmUgbm90aWZpY2F0aW9uIGZvciBiZXR0ZXIgVVhcblx0XHRjb25zdCB0b3RhbEZpbGVzID0gZmlsZW5hbWVzLmxlbmd0aDtcblx0XHRjb25zdCBtZXNzYWdlczogc3RyaW5nW10gPSBbXTtcblx0XHRcblx0XHRpZiAoYWRkZWRGaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAoYWRkZWRGaWxlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgQWRkZWQgXCIke2FkZGVkRmlsZXNbMF19XCIgdG8gY29udGV4dGApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgQWRkZWQgJHthZGRlZEZpbGVzLmxlbmd0aH0gZmlsZXMgdG8gY29udGV4dGApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZiAoYWxyZWFkeUV4aXN0aW5nRmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKGFscmVhZHlFeGlzdGluZ0ZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBcIiR7YWxyZWFkeUV4aXN0aW5nRmlsZXNbMF19XCIgYWxyZWFkeSBpbiBjb250ZXh0YCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGAke2FscmVhZHlFeGlzdGluZ0ZpbGVzLmxlbmd0aH0gYWxyZWFkeSBpbiBjb250ZXh0YCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChjdXJyZW50RmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKGN1cnJlbnRGaWxlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgQ3VycmVudCBmaWxlIGlzIGFsd2F5cyBpbiBjb250ZXh0YCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGAke2N1cnJlbnRGaWxlcy5sZW5ndGh9IGN1cnJlbnQgZmlsZXMgYXJlIGFsd2F5cyBpbiBjb250ZXh0YCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChub3RGb3VuZEZpbGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChub3RGb3VuZEZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBcIiR7bm90Rm91bmRGaWxlc1swXX1cIiBub3QgZm91bmRgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYCR7bm90Rm91bmRGaWxlcy5sZW5ndGh9IG5vdCBmb3VuZGApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IHNpbmdsZSBjb21iaW5lZCBtZXNzYWdlIGlmIHdlIGhhdmUgYW55IHJlc3VsdHNcblx0XHRpZiAobWVzc2FnZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgY29tYmluZWRNZXNzYWdlID0gbWVzc2FnZXMuam9pbignLCAnKTtcblx0XHRcdGNvbnN0IGR1cmF0aW9uID0gbm90Rm91bmRGaWxlcy5sZW5ndGggPiAwID8gMzAwMCA6IDIwMDA7IC8vIExvbmdlciBkdXJhdGlvbiBpZiB0aGVyZSBhcmUgZXJyb3JzXG5cdFx0XHRuZXcgTm90aWNlKGNvbWJpbmVkTWVzc2FnZSwgZHVyYXRpb24pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY29udGV4dHVhbCB0aGlua2luZyBwaHJhc2UgYmFzZWQgb24gY29tbWFuZCB0eXBlIG9yIG1lc3NhZ2UgY29udGVudFxuXHQgKi9cblx0cHJpdmF0ZSBnZXRDb250ZXh0dWFsVGhpbmtpbmdQaHJhc2UoY29tbWFuZD86IEVkaXRDb21tYW5kLCBtZXNzYWdlVGV4dD86IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gRGV0ZXJtaW5lIGNvbnRleHQgYmFzZWQgb24gY29tbWFuZCB0eXBlIG9yIG1lc3NhZ2UgY29udGVudFxuXHRcdGlmIChjb21tYW5kKSB7XG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2dyYW1tYXInOlxuXHRcdFx0XHRjYXNlICdlZGl0Jzpcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2ltcHJvdmUnKTtcblx0XHRcdFx0Y2FzZSAnYWRkJzpcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2dlbmVyYXRlJyk7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnaW1wcm92ZScpO1xuXHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgncHJvY2VzcycpO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnY2hhdCcpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobWVzc2FnZVRleHQpIHtcblx0XHRcdC8vIEFuYWx5emUgbWVzc2FnZSBjb250ZW50IGZvciBjb250ZXh0XG5cdFx0XHRpZiAobWVzc2FnZVRleHQuaW5jbHVkZXMoJ2ltcHJvdmUnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnZml4JykgfHwgbWVzc2FnZVRleHQuaW5jbHVkZXMoJ2dyYW1tYXInKSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2ltcHJvdmUnKTtcblx0XHRcdH0gZWxzZSBpZiAobWVzc2FnZVRleHQuaW5jbHVkZXMoJ2FkZCcpIHx8IG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdjcmVhdGUnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnd3JpdGUnKSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXRSYW5kb21QaHJhc2UoJ2dlbmVyYXRlJyk7XG5cdFx0XHR9IGVsc2UgaWYgKG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdzd2l0Y2gnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnLycpKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnc3dpdGNoJyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnY2hhdCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCByYW5kb20gcGhyYXNlIGZyb20gc3BlY2lmaWVkIGNhdGVnb3J5XG5cdCAqL1xuXHRwcml2YXRlIGdldFJhbmRvbVBocmFzZShjYXRlZ29yeTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBwaHJhc2VzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG5cdFx0XHQnaW1wcm92ZSc6IFsncmVmaW5pbmcuLi4nLCAncG9saXNoaW5nLi4uJywgJ2VuaGFuY2luZy4uLicsICdjcmFmdGluZy4uLicsICdwZXJmZWN0aW5nLi4uJywgJ3Ntb290aGluZy4uLicsICdzaGFycGVuaW5nLi4uJywgJ2VsZXZhdGluZy4uLicsICdmaW5lLXR1bmluZy4uLicsICdzY3VscHRpbmcuLi4nXSxcblx0XHRcdCdnZW5lcmF0ZSc6IFsndGhpbmtpbmcuLi4nLCAnY3JhZnRpbmcuLi4nLCAnZGV2ZWxvcGluZy4uLicsICdjb21wb3NpbmcuLi4nLCAnd3JpdGluZy4uLicsICdjcmVhdGluZy4uLicsICdmb3JtdWxhdGluZy4uLicsICdidWlsZGluZy4uLicsICdjb25zdHJ1Y3RpbmcuLi4nLCAnZHJhZnRpbmcuLi4nXSxcblx0XHRcdCdzd2l0Y2gnOiBbJ2Nvbm5lY3RpbmcuLi4nLCAnc3dpdGNoaW5nLi4uJywgJ3VwZGF0aW5nLi4uJywgJ2NvbmZpZ3VyaW5nLi4uJywgJ3NldHRpbmcgdXAuLi4nLCAnc3luY2luZy4uLicsICdwcmVwYXJpbmcuLi4nLCAnYWN0aXZhdGluZy4uLicsICdpbml0aWFsaXppbmcuLi4nLCAnZXN0YWJsaXNoaW5nLi4uJ10sXG5cdFx0XHQncHJvY2Vzcyc6IFsncHJvY2Vzc2luZy4uLicsICdhbmFseXppbmcuLi4nLCAnd29ya2luZy4uLicsICdjb21wdXRpbmcuLi4nLCAnY2FsY3VsYXRpbmcuLi4nLCAnZXhhbWluaW5nLi4uJywgJ2V2YWx1YXRpbmcuLi4nLCAnaW50ZXJwcmV0aW5nLi4uJywgJ3Jldmlld2luZy4uLicsICdzY2FubmluZy4uLiddLFxuXHRcdFx0J2NoYXQnOiBbJ3RoaW5raW5nLi4uJywgJ3Byb2Nlc3NpbmcuLi4nLCAnY29uc2lkZXJpbmcuLi4nLCAnYW5hbHl6aW5nLi4uJywgJ3VuZGVyc3RhbmRpbmcuLi4nLCAnY29udGVtcGxhdGluZy4uLicsICdleHBsb3JpbmcuLi4nLCAnZXZhbHVhdGluZy4uLicsICd3b3JraW5nIG9uIGl0Li4uJywgJ2NvbXBvc2luZy4uLiddXG5cdFx0fTtcblx0XHRcblx0XHRjb25zdCBjYXRlZ29yeVBocmFzZXMgPSBwaHJhc2VzW2NhdGVnb3J5XSB8fCBwaHJhc2VzLmNoYXQ7XG5cdFx0cmV0dXJuIGNhdGVnb3J5UGhyYXNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjYXRlZ29yeVBocmFzZXMubGVuZ3RoKV07XG5cdH1cblxuXHQvKipcblx0ICogU3RhcnQgcGhyYXNlIHJvdGF0aW9uIGFuaW1hdGlvbiBmb3IgdGhpbmtpbmcgdGV4dFxuXHQgKi9cblx0cHJpdmF0ZSBzdGFydFRoaW5raW5nUGhyYXNlUm90YXRpb24odGV4dEVsOiBIVE1MRWxlbWVudCwgY29tbWFuZD86IEVkaXRDb21tYW5kLCBtZXNzYWdlVGV4dD86IHN0cmluZyk6IHZvaWQge1xuXHRcdC8vIENoYW5nZSBwaHJhc2UgZXZlcnkgMiBzZWNvbmRzIGR1cmluZyBwcm9jZXNzaW5nXG5cdFx0Y29uc3Qgcm90YXRpb25JbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcblx0XHRcdGNvbnN0IG5ld1BocmFzZSA9IHRoaXMuZ2V0Q29udGV4dHVhbFRoaW5raW5nUGhyYXNlKGNvbW1hbmQsIG1lc3NhZ2VUZXh0KTtcblx0XHRcdHRleHRFbC50ZXh0Q29udGVudCA9IG5ld1BocmFzZTtcblx0XHR9LCAyMDAwKTtcblx0XHRcblx0XHQvLyBTdG9yZSBpbnRlcnZhbCBJRCBmb3IgY2xlYW51cFxuXHRcdCh0ZXh0RWwgYXMgYW55KS5yb3RhdGlvbkludGVydmFsID0gcm90YXRpb25JbnRlcnZhbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBTdG9wIHBocmFzZSByb3RhdGlvbiBhbmltYXRpb24gYW5kIGNsZWFudXBcblx0ICovXG5cdHByaXZhdGUgc3RvcFRoaW5raW5nUGhyYXNlUm90YXRpb24odGV4dEVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGlmICgodGV4dEVsIGFzIGFueSkucm90YXRpb25JbnRlcnZhbCkge1xuXHRcdFx0Y2xlYXJJbnRlcnZhbCgodGV4dEVsIGFzIGFueSkucm90YXRpb25JbnRlcnZhbCk7XG5cdFx0XHQodGV4dEVsIGFzIGFueSkucm90YXRpb25JbnRlcnZhbCA9IG51bGw7XG5cdFx0fVxuXHR9XG5cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudFN0cnVjdHVyZSB7XG5cdGhlYWRpbmdzOiBBcnJheTx7IGxldmVsOiBudW1iZXI7IHRleHQ6IHN0cmluZzsgaXNFbXB0eTogYm9vbGVhbiB9Pjtcblx0d29yZENvdW50OiBudW1iZXI7XG5cdGVtcHR5SGVhZGluZ3M6IHN0cmluZ1tdO1xuXHRpbmNvbXBsZXRlQnVsbGV0czogc3RyaW5nW107XG59XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudEFuYWx5emVyIHtcblx0c3RhdGljIGFuYWx5emVTdHJ1Y3R1cmUoY29udGVudDogc3RyaW5nKTogRG9jdW1lbnRTdHJ1Y3R1cmUge1xuXHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0Y29uc3QgaGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nOyBpc0VtcHR5OiBib29sZWFuIH0+ID0gW107XG5cdFx0Y29uc3QgZW1wdHlIZWFkaW5nczogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBpbmNvbXBsZXRlQnVsbGV0czogc3RyaW5nW10gPSBbXTtcblx0XHRcblx0XHQvLyBGaW5kIGhlYWRpbmdzIGFuZCBhbmFseXplIGNvbnRlbnQgYWZ0ZXIgZWFjaFxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7XG5cdFx0XHRjb25zdCBoZWFkaW5nTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCN7MSw2fSlcXHMrKC4rKSQvKTtcblx0XHRcdFxuXHRcdFx0aWYgKGhlYWRpbmdNYXRjaCkge1xuXHRcdFx0XHRjb25zdCBsZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG5cdFx0XHRcdGNvbnN0IHRleHQgPSBoZWFkaW5nTWF0Y2hbMl07XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayBpZiBoZWFkaW5nIGhhcyBjb250ZW50IGFmdGVyIGl0XG5cdFx0XHRcdGNvbnN0IGhhc0NvbnRlbnQgPSB0aGlzLmhhc0NvbnRlbnRBZnRlckhlYWRpbmcobGluZXMsIGkpO1xuXHRcdFx0XHRjb25zdCBpc0VtcHR5ID0gIWhhc0NvbnRlbnQ7XG5cdFx0XHRcdFxuXHRcdFx0XHRoZWFkaW5ncy5wdXNoKHsgbGV2ZWwsIHRleHQsIGlzRW1wdHkgfSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaXNFbXB0eSkge1xuXHRcdFx0XHRcdGVtcHR5SGVhZGluZ3MucHVzaCh0ZXh0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIGluY29tcGxldGUgYnVsbGV0IHBvaW50cyAoZW5kaW5nIHdpdGggXCIuLi5cIiBvciBlbXB0eSlcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eWy0qK11cXHMqKC4qKVxcLlxcLlxcLj9cXHMqJC8pIHx8IGxpbmUubWF0Y2goL15bLSorXVxccyokLykgfHwgbGluZS5tYXRjaCgvXlstKitdXFxzKihUT0RPfFRCRCkvaSkpIHtcblx0XHRcdFx0aW5jb21wbGV0ZUJ1bGxldHMucHVzaChsaW5lKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Y29uc3Qgd29yZENvdW50ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMCkubGVuZ3RoO1xuXHRcdFxuXHRcdHJldHVybiB7XG5cdFx0XHRoZWFkaW5ncyxcblx0XHRcdHdvcmRDb3VudCxcblx0XHRcdGVtcHR5SGVhZGluZ3MsXG5cdFx0XHRpbmNvbXBsZXRlQnVsbGV0c1xuXHRcdH07XG5cdH1cblx0XG5cdHByaXZhdGUgc3RhdGljIGhhc0NvbnRlbnRBZnRlckhlYWRpbmcobGluZXM6IHN0cmluZ1tdLCBoZWFkaW5nSW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGN1cnJlbnRIZWFkaW5nID0gbGluZXNbaGVhZGluZ0luZGV4XS50cmltKCk7XG5cdFx0Y29uc3QgY3VycmVudExldmVsID0gY3VycmVudEhlYWRpbmcubWF0Y2goL14oI3sxLDZ9KS8pPy5bMV0ubGVuZ3RoIHx8IDA7XG5cdFx0XG5cdFx0Zm9yIChsZXQgaSA9IGhlYWRpbmdJbmRleCArIDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcblx0XHRcdFxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIGhlYWRpbmdcblx0XHRcdGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccy8pO1xuXHRcdFx0aWYgKGhlYWRpbmdNYXRjaCkge1xuXHRcdFx0XHRjb25zdCBuZXh0TGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gSWYgbmV4dCBoZWFkaW5nIGlzIHNhbWUgb3IgaGlnaGVyIGxldmVsIChsb3dlciBudW1iZXIpLCBcblx0XHRcdFx0Ly8gYW5kIHdlIGhhdmVuJ3QgZm91bmQgY29udGVudCB5ZXQsIHRoaXMgc2VjdGlvbiBpcyBlbXB0eVxuXHRcdFx0XHRpZiAobmV4dExldmVsIDw9IGN1cnJlbnRMZXZlbCkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBJZiBpdCdzIGEgc3ViLWhlYWRpbmcgKGhpZ2hlciBudW1iZXIpLCBjb250aW51ZSBsb29raW5nIGZvciBjb250ZW50XG5cdFx0XHRcdC8vIFRoaXMgYWxsb3dzIGZvciBIMSBcdTIxOTIgSDIgc3RydWN0dXJlIHdpdGhvdXQgY291bnRpbmcgYXMgZW1wdHlcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gSWYgd2UgZmluZCBzdWJzdGFudGlhbCBjb250ZW50IChub3QganVzdCB3aGl0ZXNwYWNlKSwgaGVhZGluZyBpcyBub3QgZW1wdHlcblx0XHRcdGlmIChsaW5lLmxlbmd0aCA+IDApIHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRcblx0XHQvLyBJZiB3ZSByZWFjaCBlbmQgb2YgZG9jdW1lbnQgd2l0aG91dCBmaW5kaW5nIGNvbnRlbnQsIGl0J3MgZW1wdHlcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn0iLCAiLyoqXG4gKiBDZW50cmFsaXplZCBtb2RlbCBkZWZpbml0aW9ucyBmb3IgYWxsIEFJIHByb3ZpZGVyc1xuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZWxEZWZpbml0aW9uIHtcblx0dmFsdWU6IHN0cmluZztcblx0bGFiZWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb2RlbENvbmZpZyB7XG5cdGdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGU6IHN0cmluZywgc2V0dGluZ3M/OiBhbnkpOiBNb2RlbERlZmluaXRpb25bXTtcbn1cblxuLyoqXG4gKiBHZXQgYXZhaWxhYmxlIG1vZGVscyBmb3IgYSBwcm92aWRlclxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBzZXR0aW5ncz86IGFueSk6IE1vZGVsRGVmaW5pdGlvbltdIHtcblx0c3dpdGNoIChwcm92aWRlclR5cGUpIHtcblx0XHRjYXNlICdjbGF1ZGUnOlxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnLCBsYWJlbDogJ0NsYXVkZSBPcHVzIDQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnLCBsYWJlbDogJ0NsYXVkZSBTb25uZXQgNCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTctc29ubmV0LWxhdGVzdCcsIGxhYmVsOiAnQ2xhdWRlIDMuNyBTb25uZXQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy01LXNvbm5ldC1sYXRlc3QnLCBsYWJlbDogJ0NsYXVkZSAzLjUgU29ubmV0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLCBsYWJlbDogJ0NsYXVkZSAzLjUgU29ubmV0IChPY3QgMjIpJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLCBsYWJlbDogJ0NsYXVkZSAzLjUgSGFpa3UnIH1cblx0XHRcdF07XG5cdFx0Y2FzZSAnb3BlbmFpJzpcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNC4xLTIwMjUtMDQtMTQnLCBsYWJlbDogJ0dQVC00LjEnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNC4xLW1pbmktMjAyNS0wNC0xNCcsIGxhYmVsOiAnR1BULTQuMSBNaW5pJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTQuMS1uYW5vLTIwMjUtMDQtMTQnLCBsYWJlbDogJ0dQVC00LjEgTmFubycgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00bycsIGxhYmVsOiAnR1BULTRvJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTRvLW1pbmknLCBsYWJlbDogJ0dQVC00byBNaW5pJyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ2dvb2dsZSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuNS1mbGFzaC1wcmV2aWV3LTA0LTE3JywgbGFiZWw6ICdHZW1pbmkgMi41IEZsYXNoJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuNS1wcm8tcHJldmlldy0wMy0yNScsIGxhYmVsOiAnR2VtaW5pIDIuNSBQcm8nIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdnZW1pbmktMi4wLWZsYXNoJywgbGFiZWw6ICdHZW1pbmkgMi4wIEZsYXNoJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJywgbGFiZWw6ICdHZW1pbmkgMi4wIEZsYXNoLUxpdGUnIH1cblx0XHRcdF07XG5cdFx0Y2FzZSAnb2xsYW1hJzpcblx0XHRcdC8vIFJldHVybiB0aGUgY29uZmlndXJlZCBtb2RlbCBmcm9tIHNldHRpbmdzXG5cdFx0XHRjb25zdCBvbGxhbWFNb2RlbCA9IHNldHRpbmdzPy5haVByb3ZpZGVycz8ub2xsYW1hPy5tb2RlbDtcblx0XHRcdGlmIChvbGxhbWFNb2RlbCAmJiBvbGxhbWFNb2RlbC50cmltKCkpIHtcblx0XHRcdFx0cmV0dXJuIFt7IHZhbHVlOiBvbGxhbWFNb2RlbCwgbGFiZWw6IG9sbGFtYU1vZGVsIH1dO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIFtdO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRyZXR1cm4gW107XG5cdH1cbn0iLCAiaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgUGxhdGZvcm0sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IENvbW1hbmRTeXN0ZW0gfSBmcm9tICcuL2NvbW1hbmQtc3lzdGVtJztcbmltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9jb250ZXh0LW1hbmFnZXInO1xuXG4vKipcbiAqIEhhbmRsZXMgdGV4dGFyZWEgaW5wdXQsIGF1dG8tZ3Jvdywgc2VuZCBidXR0b24sIGFuZCBpbnB1dCBldmVudHNcbiAqL1xuZXhwb3J0IGNsYXNzIElucHV0SGFuZGxlciB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgdGV4dEFyZWEhOiBUZXh0QXJlYUNvbXBvbmVudDtcblx0cHJpdmF0ZSBzZW5kQnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGF1dG9Hcm93VGV4dGFyZWEhOiAoKSA9PiB2b2lkO1xuXHRwcml2YXRlIHdpa2lsaW5rQXV0b2NvbXBsZXRlITogTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlO1xuXHRwcml2YXRlIGNvbW1hbmRTeXN0ZW0hOiBDb21tYW5kU3lzdGVtO1xuXHRwcml2YXRlIGNvbnRleHRNYW5hZ2VyOiBDb250ZXh0TWFuYWdlcjtcblx0cHJpdmF0ZSBpbnB1dFJvdyE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBGT0NVU19ERUxBWV9NUyA9IDE1MDtcblx0cHJpdmF0ZSBkcm9wWm9uZU92ZXJsYXk6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgaXNEcmFnZ2luZzogYm9vbGVhbiA9IGZhbHNlO1xuXHRwcml2YXRlIHNpZGViYXJWaWV3OiBhbnk7IC8vIFJlZmVyZW5jZSB0byBOb3ZhU2lkZWJhclZpZXcgZm9yIGNvbnRleHQgb3BlcmF0aW9uc1xuXG5cdC8vIEV2ZW50IGNsZWFudXAgdHJhY2tpbmdcblx0cHJpdmF0ZSBldmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwbHVnaW46IE5vdmFQbHVnaW4sIFxuXHRcdGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIFxuXHRcdGNvbnRleHRNYW5hZ2VyOiBDb250ZXh0TWFuYWdlclxuXHQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyID0gY29udGV4dE1hbmFnZXI7XG5cdH1cblxuXHRzZXRTaWRlYmFyVmlldyhzaWRlYmFyVmlldzogYW55KTogdm9pZCB7XG5cdFx0dGhpcy5zaWRlYmFyVmlldyA9IHNpZGViYXJWaWV3O1xuXHRcdC8vIEFsc28gcGFzcyB0byB3aWtpbGluayBhdXRvY29tcGxldGUgaWYgaXQgZXhpc3RzXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuc2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXcpO1xuXHRcdH1cblx0fVxuXG5cdHNldENvbW1hbmRTeXN0ZW0oY29tbWFuZFN5c3RlbTogQ29tbWFuZFN5c3RlbSk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFN5c3RlbSA9IGNvbW1hbmRTeXN0ZW07XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgYnV0dG9uIGJlZm9yZSBzZW5kIGJ1dHRvbiBmb3IgcHJvcGVyIERPTSBvcmRlclxuXHRcdGNvbnN0IHNlbmRCdXR0b25FbCA9IHRoaXMuc2VuZEJ1dHRvbi5idXR0b25FbDtcblx0XHRzZW5kQnV0dG9uRWwucmVtb3ZlKCk7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgYnV0dG9uXG5cdFx0dGhpcy5jb21tYW5kU3lzdGVtLmNyZWF0ZUNvbW1hbmRCdXR0b24odGhpcy5pbnB1dFJvdyk7XG5cdFx0XG5cdFx0Ly8gUmUtYWRkIHNlbmQgYnV0dG9uICh3aWxsIGJlIGxhc3QgaW4gRE9NIG9yZGVyKVxuXHRcdHRoaXMuaW5wdXRSb3cuYXBwZW5kQ2hpbGQoc2VuZEJ1dHRvbkVsKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29tbWFuZCBwaWNrZXJcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0uY3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKHRoaXMuaW5wdXRSb3cpO1xuXHR9XG5cblx0Z2V0VGV4dEFyZWEoKTogVGV4dEFyZWFDb21wb25lbnQge1xuXHRcdHJldHVybiB0aGlzLnRleHRBcmVhO1xuXHR9XG5cblx0Y3JlYXRlSW5wdXRJbnRlcmZhY2UoY2hhdENvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHR0aGlzLmlucHV0Um93ID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1yb3cnIH0pO1xuXHRcdHRoaXMuaW5wdXRSb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRnYXA6IHZhcigtLXNpemUtMi0zKTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0YDtcblxuXHRcdC8vIFRleHRhcmVhIGNvbnRhaW5lclxuXHRcdGNvbnN0IHRleHRBcmVhQ29udGFpbmVyID0gdGhpcy5pbnB1dFJvdy5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7IHBvc2l0aW9uOiByZWxhdGl2ZTsnO1xuXG5cdFx0Ly8gQ3JlYXRlIHRleHRhcmVhXG5cdFx0dGhpcy50ZXh0QXJlYSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudCh0ZXh0QXJlYUNvbnRhaW5lcik7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRQbGFjZWhvbGRlcignSG93IGNhbiBJIGhlbHA/Jyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXgtaGVpZ2h0OiAyMDBweDtcblx0XHRcdHJlc2l6ZTogbm9uZTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LWZhbWlseTogdmFyKC0tZm9udC1pbnRlcmZhY2UpO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0Ym94LXNpemluZzogYm9yZGVyLWJveDtcblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCB0ZXh0YXJlYSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9IE1hdGgubWluKHRleHRhcmVhLnNjcm9sbEhlaWdodCwgMjAwKSArICdweCc7XG5cdFx0fTtcblxuXHRcdC8vIEFkZCBpbnB1dCBldmVudCBsaXN0ZW5lciBmb3IgYXV0by1ncm93XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2lucHV0JywgdGhpcy5hdXRvR3Jvd1RleHRhcmVhKTtcblxuXHRcdC8vIFRyaWdnZXIgYXV0by1ncm93IG9uIGluaXRpYWwgbG9hZFxuXHRcdHNldFRpbWVvdXQodGhpcy5hdXRvR3Jvd1RleHRhcmVhLCAwKTtcblxuXHRcdC8vIEluaXRpYWxpemUgd2lraWxpbmsgYXV0b2NvbXBsZXRlIHdpdGggaW5wdXRSb3cgZm9yIGNvbnNpc3RlbnQgd2lkdGhcblx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlID0gbmV3IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgdGhpcy5pbnB1dFJvdyk7XG5cdFx0XG5cdFx0Ly8gUGFzcyBzaWRlYmFyIHZpZXcgcmVmZXJlbmNlIHdoZW4gYXZhaWxhYmxlXG5cdFx0aWYgKHRoaXMuc2lkZWJhclZpZXcpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuc2V0U2lkZWJhclZpZXcodGhpcy5zaWRlYmFyVmlldyk7XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGRlYm91bmNlZCBjb250ZXh0IHByZXZpZXdcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAnaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLnVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyh0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ29tbWFuZCBidXR0b24gd2lsbCBiZSBjcmVhdGVkIGxhdGVyIHdoZW4gQ29tbWFuZFN5c3RlbSBpcyBzZXRcblxuXHRcdC8vIFNlbmQgYnV0dG9uXG5cdFx0dGhpcy5zZW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh0aGlzLmlucHV0Um93KTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0SWNvbignc2VuZCcpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRUb29sdGlwKCdTZW5kIG1lc3NhZ2UnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmhhbmRsZVNlbmQoKSk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4td2lkdGg6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGhlaWdodDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xuXHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdGA7XG5cblx0XHQvLyBFbnRlciBrZXkgaGFuZGxpbmcgYW5kIGNvbW1hbmQvc2VjdGlvbiBwaWNrZXJcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAna2V5ZG93bicsIChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGNvbnN0IGtleUV2ZW50ID0gZXZlbnQgYXMgS2V5Ym9hcmRFdmVudDtcblxuXHRcdFx0aWYgKGtleUV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAha2V5RXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0KHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpIHx8IGZhbHNlKSB8fCB0aGlzLmhhbmRsZVNlbmQoKTtcblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0/LmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGtleUV2ZW50LmtleSA9PT0gJ0Fycm93VXAnIHx8IGtleUV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlck5hdmlnYXRpb24oa2V5RXZlbnQua2V5KSkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnVGFiJykge1xuXHRcdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtPy5oYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXlFdmVudC5rZXkpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSW5wdXQgY2hhbmdlIGhhbmRsaW5nIGZvciBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdpbnB1dCcsICgpID0+IHtcblx0XHRcdGlmICh0aGlzLmNvbW1hbmRTeXN0ZW0pIHtcblx0XHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtLmhhbmRsZUlucHV0Q2hhbmdlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBTZXR1cCBkcmFnIGFuZCBkcm9wIGZvciBmaWxlIGNvbnRleHRcblx0XHR0aGlzLnNldHVwRHJhZ0FuZERyb3AoKTtcblx0fVxuXG5cdGZvY3VzKCk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMudGV4dEFyZWE/LmlucHV0RWwpIHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9XG5cdFx0fSwgSW5wdXRIYW5kbGVyLkZPQ1VTX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlU2VuZCgpOiB2b2lkIHtcblx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHJldHVybjtcblxuXHRcdC8vIENsZWFyIGlucHV0XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSgnJyk7XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5oaWRlQ29udGV4dFByZXZpZXcoKTtcblxuXHRcdC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGNhbGwgYSBjYWxsYmFjayBvciBlbWl0IGFuIGV2ZW50XG5cdFx0Ly8gRm9yIG5vdywgd2UnbGwgYXNzdW1lIHRoZSBwYXJlbnQgaGFuZGxlcyB0aGUgYWN0dWFsIHNlbmRpbmdcblx0XHR0aGlzLm9uU2VuZE1lc3NhZ2U/LihtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgb25TZW5kTWVzc2FnZT86IChtZXNzYWdlOiBzdHJpbmcpID0+IHZvaWQ7XG5cblx0c2V0T25TZW5kTWVzc2FnZShjYWxsYmFjazogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZCk6IHZvaWQge1xuXHRcdHRoaXMub25TZW5kTWVzc2FnZSA9IGNhbGxiYWNrO1xuXHR9XG5cblx0Z2V0VmFsdWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHR9XG5cblx0c2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodmFsdWUpO1xuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpO1xuXHR9XG5cblx0aW5zZXJ0VGV4dCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0Y29uc3Qgc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDtcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XG5cblx0XHRjb25zdCBuZXdWYWx1ZSA9IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBzdGFydCkgKyB0ZXh0ICsgY3VycmVudFZhbHVlLnNsaWNlKGVuZCk7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShuZXdWYWx1ZSk7XG5cblx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYWZ0ZXIgaW5zZXJ0ZWQgdGV4dFxuXHRcdGNvbnN0IG5ld1Bvc2l0aW9uID0gc3RhcnQgKyB0ZXh0Lmxlbmd0aDtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKG5ld1Bvc2l0aW9uLCBuZXdQb3NpdGlvbik7XG5cdFx0XHR0ZXh0YXJlYS5mb2N1cygpO1xuXHRcdH0sIDApO1xuXG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdH1cblxuXHRpbnNlcnRUZXh0V2l0aEN1cnNvcihiZWZvcmVDdXJzb3I6IHN0cmluZywgYWZ0ZXJDdXJzb3I6IHN0cmluZyA9ICcnKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFZhbHVlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdGNvbnN0IHRleHRhcmVhID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsO1xuXHRcdGNvbnN0IHN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7XG5cdFx0Y29uc3QgZW5kID0gdGV4dGFyZWEuc2VsZWN0aW9uRW5kO1xuXG5cdFx0Y29uc3QgbmV3VmFsdWUgPSBjdXJyZW50VmFsdWUuc2xpY2UoMCwgc3RhcnQpICsgYmVmb3JlQ3Vyc29yICsgYWZ0ZXJDdXJzb3IgKyBjdXJyZW50VmFsdWUuc2xpY2UoZW5kKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBiZXR3ZWVuIGJlZm9yZSBhbmQgYWZ0ZXIgdGV4dFxuXHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gc3RhcnQgKyBiZWZvcmVDdXJzb3IubGVuZ3RoO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yUG9zaXRpb24sIGN1cnNvclBvc2l0aW9uKTtcblx0XHRcdHRleHRhcmVhLmZvY3VzKCk7XG5cdFx0fSwgMCk7XG5cblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkRXZlbnRMaXN0ZW5lcihlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0dGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblxuXHRwcml2YXRlIHNldHVwRHJhZ0FuZERyb3AoKTogdm9pZCB7XG5cdFx0Y29uc3QgZHJvcFpvbmUgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cblx0XHQvLyBQcmV2ZW50IGRlZmF1bHQgZHJhZyBiZWhhdmlvcnNcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcmFnZW50ZXInLCAoZTogRXZlbnQpID0+IHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMuaGFuZGxlRHJhZ0VudGVyKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcmFnb3ZlcicsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Ly8gU2V0IGRyb3AgZWZmZWN0IHRvIHNob3cgaXQncyBhbGxvd2VkXG5cdFx0XHQoZSBhcyBEcmFnRXZlbnQpLmRhdGFUcmFuc2ZlciEuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihkcm9wWm9uZSwgJ2RyYWdsZWF2ZScsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0Ly8gT25seSBoaWRlIG92ZXJsYXkgaWYgd2UncmUgbGVhdmluZyB0aGUgZHJvcCB6b25lIGVudGlyZWx5XG5cdFx0XHRpZiAoZS50YXJnZXQgPT09IGRyb3Bab25lKSB7XG5cdFx0XHRcdHRoaXMuaGFuZGxlRHJhZ0xlYXZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcm9wJywgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLmhhbmRsZURyb3AoZSBhcyBEcmFnRXZlbnQpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVEcmFnRW50ZXIoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuaXNEcmFnZ2luZykgcmV0dXJuO1xuXHRcdHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG5cblx0XHQvLyBDcmVhdGUgb3ZlcmxheSBmb3IgdmlzdWFsIGZlZWRiYWNrXG5cdFx0aWYgKCF0aGlzLmRyb3Bab25lT3ZlcmxheSkge1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LmNsYXNzTmFtZSA9ICdub3ZhLWRyb3Atem9uZS1vdmVybGF5Jztcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdFx0dG9wOiAwO1xuXHRcdFx0XHRsZWZ0OiAwO1xuXHRcdFx0XHRyaWdodDogMDtcblx0XHRcdFx0Ym90dG9tOiAwO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0XHRvcGFjaXR5OiAwO1xuXHRcdFx0XHRib3JkZXI6IDJweCBkYXNoZWQgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0XHRcdHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlO1xuXHRcdFx0XHR6LWluZGV4OiAxMDtcblx0XHRcdGA7XG5cblx0XHRcdC8vIEFkZCBpY29uIGNvbnRhaW5lclxuXHRcdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdHdpZHRoOiA0OHB4O1xuXHRcdFx0XHRoZWlnaHQ6IDQ4cHg7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0XHRib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdFx0b3BhY2l0eTogMDtcblx0XHRcdFx0dHJhbnNmb3JtOiBzY2FsZSgwLjgpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gQWRkIE9ic2lkaWFuJ3MgcGx1cyBpY29uXG5cdFx0XHRjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRpY29uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGxpbmUgeDE9XCIxMlwiIHkxPVwiNVwiIHgyPVwiMTJcIiB5Mj1cIjE5XCI+PC9saW5lPjxsaW5lIHgxPVwiNVwiIHkxPVwiMTJcIiB4Mj1cIjE5XCIgeTI9XCIxMlwiPjwvbGluZT48L3N2Zz5gO1xuXHRcdFx0aWNvbi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRgO1xuXG5cdFx0XHRpY29uQ29udGFpbmVyLmFwcGVuZENoaWxkKGljb24pO1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuYXBwZW5kQ2hpbGQoaWNvbkNvbnRhaW5lcik7XG5cdFx0fVxuXG5cdFx0Ly8gUG9zaXRpb24gcmVsYXRpdmUgdG8gdGV4dGFyZWFcblx0XHRjb25zdCB0ZXh0QXJlYUNvbnRhaW5lciA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbC5wYXJlbnRFbGVtZW50ITtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0dGV4dEFyZWFDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5kcm9wWm9uZU92ZXJsYXkpO1xuXG5cdFx0Ly8gQW5pbWF0ZSBpblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuZHJvcFpvbmVPdmVybGF5KSB7XG5cdFx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAnMC4xJztcblx0XHRcdFx0Y29uc3QgaWNvbiA9IHRoaXMuZHJvcFpvbmVPdmVybGF5LnF1ZXJ5U2VsZWN0b3IoJ2RpdicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRpZiAoaWNvbikge1xuXHRcdFx0XHRcdGljb24uc3R5bGUub3BhY2l0eSA9ICcxJztcblx0XHRcdFx0XHRpY29uLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LCAxMCk7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyYWdMZWF2ZSgpOiB2b2lkIHtcblx0XHR0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcblx0XHRpZiAodGhpcy5kcm9wWm9uZU92ZXJsYXkpIHtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0XHRjb25zdCBpY29uID0gdGhpcy5kcm9wWm9uZU92ZXJsYXkucXVlcnlTZWxlY3RvcignZGl2JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAoaWNvbikge1xuXHRcdFx0XHRpY29uLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0XHRcdGljb24uc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDAuOCknO1xuXHRcdFx0fVxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5Py5yZW1vdmUoKTtcblx0XHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBudWxsO1xuXHRcdFx0fSwgMjAwKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyb3AoZTogRHJhZ0V2ZW50KTogdm9pZCB7XG5cdFx0dGhpcy5oYW5kbGVEcmFnTGVhdmUoKTtcblxuXHRcdGNvbnN0IGZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIFBhcnNlIE9ic2lkaWFuJ3Mgb2JzaWRpYW46Ly8gVVJMcyAtIHByZWZlciB0ZXh0L3BsYWluIGFzIGl0IGhhcyBwcm9wZXIgbmV3bGluZXNcblx0XHRjb25zdCB0ZXh0UGxhaW5EYXRhID0gZS5kYXRhVHJhbnNmZXI/LmdldERhdGEoJ3RleHQvcGxhaW4nKTtcblx0XHRcblx0XHRpZiAodGV4dFBsYWluRGF0YSAmJiB0ZXh0UGxhaW5EYXRhLmluY2x1ZGVzKCdvYnNpZGlhbjovL29wZW4/JykpIHtcblx0XHRcdC8vIEhhbmRsZSBtdWx0aXBsZSBVUkxzIHNlcGFyYXRlZCBieSBuZXdsaW5lc1xuXHRcdFx0Y29uc3QgdXJscyA9IHRleHRQbGFpbkRhdGEuc3BsaXQoL1tcXG5cXHJdLykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkuc3RhcnRzV2l0aCgnb2JzaWRpYW46Ly9vcGVuPycpKTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCB1cmxTdHJpbmcgb2YgdXJscykge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGNvbnN0IHVybCA9IG5ldyBVUkwodXJsU3RyaW5nLnRyaW0oKSk7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZVBhdGggPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZmlsZScpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChmaWxlUGF0aCkge1xuXHRcdFx0XHRcdFx0Ly8gRGVjb2RlIHRoZSBVUkwtZW5jb2RlZCBwYXRoXG5cdFx0XHRcdFx0XHRjb25zdCBkZWNvZGVkUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChmaWxlUGF0aCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIEV4dHJhY3QgZmlsZW5hbWUgZnJvbSBwYXRoIChoYW5kbGUgYm90aCAvIGFuZCBcXCBzZXBhcmF0b3JzKVxuXHRcdFx0XHRcdFx0Y29uc3QgcGF0aFBhcnRzID0gZGVjb2RlZFBhdGguc3BsaXQoL1svXFxcXF0vKTtcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGVuYW1lID0gcGF0aFBhcnRzW3BhdGhQYXJ0cy5sZW5ndGggLSAxXTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gT25seSBwcm9jZXNzIG1hcmtkb3duIGZpbGVzXG5cdFx0XHRcdFx0XHRpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5tZCcpKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGJhc2VOYW1lID0gZmlsZW5hbWUucmVwbGFjZSgnLm1kJywgJycpO1xuXHRcdFx0XHRcdFx0XHRpZiAoYmFzZU5hbWUgJiYgIWZpbGVzLmluY2x1ZGVzKGJhc2VOYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzLnB1c2goYmFzZU5hbWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBGb3IgZmlsZXMgd2l0aG91dCAubWQgZXh0ZW5zaW9uLCBhc3N1bWUgdGhleSdyZSBtYXJrZG93biBub3Rlc1xuXHRcdFx0XHRcdFx0XHQvLyAoT2JzaWRpYW4gc29tZXRpbWVzIG9taXRzIHRoZSAubWQgZXh0ZW5zaW9uIGluIHBhdGhzKVxuXHRcdFx0XHRcdFx0XHRpZiAoZmlsZW5hbWUgJiYgIWZpbGVzLmluY2x1ZGVzKGZpbGVuYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzLnB1c2goZmlsZW5hbWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBhcnNlIE9ic2lkaWFuIFVSTDonLCB1cmxTdHJpbmcsIGVycm9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBmaWxlcyB0byBjb250ZXh0IGlmIHdlIGdvdCBhbnlcblx0XHRpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0dGhpcy5hZGRGaWxlc1RvQ29udGV4dChmaWxlcyk7XG5cdFx0fSBlbHNlIGlmICh0ZXh0UGxhaW5EYXRhICYmIHRleHRQbGFpbkRhdGEuaW5jbHVkZXMoJ29ic2lkaWFuOi8vb3Blbj8nKSkge1xuXHRcdFx0Ly8gVXNlciBkcm9wcGVkIHNvbWV0aGluZyBmcm9tIE9ic2lkaWFuIGJ1dCBubyBmaWxlcyB3ZXJlIGV4dHJhY3RlZFxuXHRcdFx0Ly8gVGhpcyBsaWtlbHkgbWVhbnMgdGhleSBkcm9wcGVkIG5vbi1tYXJrZG93biBmaWxlc1xuXHRcdFx0bmV3IE5vdGljZSgnT25seSBtYXJrZG93biBmaWxlcyBjYW4gYmUgYWRkZWQgdG8gY29udGV4dCcsIDMwMDApO1xuXHRcdH0gZWxzZSBpZiAodGV4dFBsYWluRGF0YSAmJiB0ZXh0UGxhaW5EYXRhLnRyaW0oKSAmJiAhdGV4dFBsYWluRGF0YS5pbmNsdWRlcygnOi8vJykpIHtcblx0XHRcdC8vIFVzZXIgZHJvcHBlZCBhIGZvbGRlciAocGxhaW4gdGV4dCBwYXRoIHdpdGhvdXQgcHJvdG9jb2wpXG5cdFx0XHRuZXcgTm90aWNlKCdGb2xkZXJzIGNhbm5vdCBiZSBhZGRlZCB0byBjb250ZXh0LiBQbGVhc2Ugc2VsZWN0IGluZGl2aWR1YWwgZmlsZXMuJywgMzAwMCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBhZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKGZpbGVuYW1lcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuXHRcdC8vIENoZWNrIGlmIG11bHRpLWRvYyBjb250ZXh0IGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnbXVsdGktZG9jLWNvbnRleHQnKSkge1xuXHRcdFx0bmV3IE5vdGljZSgnTXVsdGktZG9jdW1lbnQgY29udGV4dCBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBBdWd1c3QgMTUsIDIwMjUuJywgMzAwMCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGZpbGVzIHRvIGNvbnRleHRcblx0XHRpZiAodGhpcy5zaWRlYmFyVmlldykge1xuXHRcdFx0YXdhaXQgdGhpcy5zaWRlYmFyVmlldy5hZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXMpO1xuXHRcdH1cblx0fVxuXG5cblx0cmVmcmVzaENvbW1hbmRCdXR0b24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbSkge1xuXHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtLnVwZGF0ZUNvbW1hbmRCdXR0b25WaXNpYmlsaXR5KCk7XG5cdFx0fVxuXHR9XG5cblx0dXBkYXRlQ29udGV4dFN0YXRlKGhhc0NvbnRleHQ6IGJvb2xlYW4pOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250YWluZXIpIHtcblx0XHRcdGlmIChoYXNDb250ZXh0KSB7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hhcy1jb250ZXh0Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdoYXMtY29udGV4dCcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGNsZWFudXAoKTogdm9pZCB7XG5cdFx0Ly8gQ2xlYW4gdXAgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuZGVzdHJveSgpO1xuXHRcdH1cblxuXHRcdC8vIENsZWFuIHVwIGRyb3Agem9uZSBvdmVybGF5XG5cdFx0aWYgKHRoaXMuZHJvcFpvbmVPdmVybGF5KSB7XG5cdFx0XHR0aGlzLmRyb3Bab25lT3ZlcmxheS5yZW1vdmUoKTtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5ID0gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBDbGVhbiB1cCBldmVudCBsaXN0ZW5lcnNcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmV2ZW50TGlzdGVuZXJzID0gW107XG5cdH1cbn0iLCAiLyoqXG4gKiBOYXRpdmUgd2lraWxpbmsgYXV0b2NvbXBsZXRlIGZvciBOb3ZhIHRleHRhcmVhXG4gKiBVc2VzIE9ic2lkaWFuJ3MgbmF0aXZlIEZ1enp5U3VnZ2VzdE1vZGFsIGZvciBjb25zaXN0ZW50IFVYXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUsIEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIEZ1enp5TWF0Y2ggfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUge1xuICAgIHByaXZhdGUgYXBwOiBBcHA7XG4gICAgcHJpdmF0ZSB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICBwcml2YXRlIHNpZGViYXJWaWV3OiBhbnk7IC8vIFJlZmVyZW5jZSB0byBOb3ZhU2lkZWJhclZpZXdcbiAgICBwcml2YXRlIGxhc3RUcmlnZ2VyUG9zOiBudW1iZXIgPSAtMTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0ZXh0QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudCwgY29udGFpbmVyPzogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMudGV4dEFyZWEgPSB0ZXh0QXJlYTtcbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgc2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXc6IGFueSk6IHZvaWQge1xuICAgICAgICB0aGlzLnNpZGViYXJWaWV3ID0gc2lkZWJhclZpZXc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5oYW5kbGVJbnB1dC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZUlucHV0KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0QXJlYS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy50ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgXG4gICAgICAgIC8vIExvb2sgZm9yIFtbIHBhdHRlcm4gYmVmb3JlIGN1cnNvclxuICAgICAgICBjb25zdCBiZWZvcmVDdXJzb3IgPSB0ZXh0LnN1YnN0cmluZygwLCBjdXJzb3JQb3MpO1xuICAgICAgICBjb25zdCBsaW5rTWF0Y2ggPSBiZWZvcmVDdXJzb3IubWF0Y2goL1xcW1xcWyhbXlxcXV0qPykkLyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobGlua01hdGNoICYmIGN1cnNvclBvcyAhPT0gdGhpcy5sYXN0VHJpZ2dlclBvcykge1xuICAgICAgICAgICAgdGhpcy5sYXN0VHJpZ2dlclBvcyA9IGN1cnNvclBvcztcbiAgICAgICAgICAgIHRoaXMuc2hvd05hdGl2ZUZpbGVNb2RhbCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93TmF0aXZlRmlsZU1vZGFsKCk6IHZvaWQge1xuICAgICAgICAvLyBHZXQgY3VycmVudCBmaWxlIGZyb20gc2lkZWJhciB2aWV3XG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5zaWRlYmFyVmlldz8uY3VycmVudEZpbGUgfHwgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFdpa2lsaW5rRmlsZU1vZGFsKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICBhc3luYyAoZmlsZTogVEZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNlbGVjdEZpbGUoZmlsZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgY2FuY2VsbGVkIC0gcmVzZXQgdHJpZ2dlciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFRyaWdnZXJQb3MgPSAtMTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdXJyZW50RmlsZVxuICAgICAgICApO1xuICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBzZWxlY3RGaWxlKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnRleHRBcmVhLnZhbHVlO1xuICAgICAgICBjb25zdCBjdXJzb3JQb3MgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgW1sgcGF0dGVybiB0byByZW1vdmVcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxpbmtNYXRjaCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSBjdXJzb3JQb3MgLSBsaW5rTWF0Y2hbMF0ubGVuZ3RoO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGluY29tcGxldGUgW1sgcGF0dGVybiBmcm9tIHRoZSBpbnB1dFxuICAgICAgICAgICAgY29uc3QgbmV3VGV4dCA9IHRleHQuc3Vic3RyaW5nKDAsIHN0YXJ0UG9zKSArIHRleHQuc3Vic3RyaW5nKGN1cnNvclBvcyk7XG4gICAgICAgICAgICB0aGlzLnRleHRBcmVhLnZhbHVlID0gbmV3VGV4dDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUG9zaXRpb24gY3Vyc29yIGF0IHRoZSBjbGVhcmVkIHBvc2l0aW9uXG4gICAgICAgICAgICB0aGlzLnRleHRBcmVhLnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0UG9zLCBzdGFydFBvcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgaW5wdXQgZXZlbnQgdG8gdXBkYXRlIGFueSBhdXRvLWdyb3cgZnVuY3Rpb25hbGl0eVxuICAgICAgICAgICAgdGhpcy50ZXh0QXJlYS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZmlsZSB0byBjb250ZXh0IGF1dG9tYXRpY2FsbHkgXG4gICAgICAgIGlmICh0aGlzLnNpZGViYXJWaWV3ICYmIHRoaXMuc2lkZWJhclZpZXcuYWRkRmlsZXNUb0NvbnRleHQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2lkZWJhclZpZXcuYWRkRmlsZXNUb0NvbnRleHQoW2ZpbGUuYmFzZW5hbWVdKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gUmVzZXQgdHJpZ2dlciBwb3NpdGlvblxuICAgICAgICB0aGlzLmxhc3RUcmlnZ2VyUG9zID0gLTE7XG4gICAgICAgIHRoaXMudGV4dEFyZWEuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBkZXN0cm95KCk6IHZvaWQge1xuICAgICAgICAvLyBObyBjbGVhbnVwIG5lZWRlZCBmb3IgbmF0aXZlIG1vZGFsXG4gICAgfVxufVxuXG4vKipcbiAqIE5hdGl2ZSBPYnNpZGlhbiBmaWxlIG1vZGFsIGZvciB3aWtpbGluayBzZWxlY3Rpb25cbiAqL1xuY2xhc3MgV2lraWxpbmtGaWxlTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuICAgIHByaXZhdGUgb25TZWxlY3RDYWxsYmFjazogKGZpbGU6IFRGaWxlKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgb25DYW5jZWxDYWxsYmFjaz86ICgpID0+IHZvaWQ7XG4gICAgcHJpdmF0ZSBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsO1xuICAgIHByaXZhdGUgYWxsRmlsZXM6IFRGaWxlW10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhcHA6IEFwcCxcbiAgICAgICAgb25TZWxlY3Q6IChmaWxlOiBURmlsZSkgPT4gdm9pZCxcbiAgICAgICAgb25DYW5jZWw/OiAoKSA9PiB2b2lkLFxuICAgICAgICBjdXJyZW50RmlsZT86IFRGaWxlIHwgbnVsbFxuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLm9uU2VsZWN0Q2FsbGJhY2sgPSBvblNlbGVjdDtcbiAgICAgICAgdGhpcy5vbkNhbmNlbENhbGxiYWNrID0gb25DYW5jZWw7XG4gICAgICAgIHRoaXMuY3VycmVudEZpbGUgPSBjdXJyZW50RmlsZSB8fCBudWxsO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcignU2VhcmNoIGZpbGVzIHRvIGFkZCB0byBjb250ZXh0Li4uJyk7XG4gICAgICAgIHRoaXMubG9hZEZpbGVzKCk7XG4gICAgfVxuXG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICBzdXBlci5vbk9wZW4oKTtcbiAgICAgICAgdGhpcy5hZGRJbnN0cnVjdGlvbnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZEluc3RydWN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgLy8gQWRkIHRoZSBpbnN0cnVjdGlvbiBmb290ZXIgbGlrZSBuYXRpdmUgT2JzaWRpYW4gbW9kYWxzXG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9uc0VsID0gdGhpcy5tb2RhbEVsLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbnMnIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbmF2SW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24nIH0pO1xuICAgICAgICBuYXZJbnN0cnVjdGlvbi5jcmVhdGVTcGFuKHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uLWNvbW1hbmQnLCB0ZXh0OiAnXHUyMTkxXHUyMTkzJyB9KTtcbiAgICAgICAgbmF2SW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IHRleHQ6ICd0byBuYXZpZ2F0ZScgfSk7XG5cbiAgICAgICAgY29uc3QgdXNlSW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24nIH0pO1xuICAgICAgICB1c2VJbnN0cnVjdGlvbi5jcmVhdGVTcGFuKHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uLWNvbW1hbmQnLCB0ZXh0OiAnXHUyMUI1JyB9KTtcbiAgICAgICAgdXNlSW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IHRleHQ6ICd0byB1c2UnIH0pO1xuXG4gICAgICAgIGNvbnN0IGVzY0luc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb25zRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KTtcbiAgICAgICAgZXNjSW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogJ2VzYycgfSk7XG4gICAgICAgIGVzY0luc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAndG8gZGlzbWlzcycgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBsb2FkRmlsZXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWxsRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBGaWx0ZXIgb3V0IHRoZSBjdXJyZW50IGZpbGUgaWYgaXQgZXhpc3RzXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG4gICAgICAgICAgICB0aGlzLmFsbEZpbGVzID0gdGhpcy5hbGxGaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGggIT09IHRoaXMuY3VycmVudEZpbGUhLnBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTb3J0IGJ5IG1vZGlmaWNhdGlvbiB0aW1lIChtb3N0IHJlY2VudCBmaXJzdClcbiAgICAgICAgdGhpcy5hbGxGaWxlcy5zb3J0KChhLCBiKSA9PiBiLnN0YXQubXRpbWUgLSBhLnN0YXQubXRpbWUpO1xuICAgIH1cblxuICAgIGdldEl0ZW1zKCk6IFRGaWxlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5hbGxGaWxlcztcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBmaWxlLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbShmaWxlOiBURmlsZSk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uU2VsZWN0Q2FsbGJhY2soZmlsZSk7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihtYXRjaDogRnV6enlNYXRjaDxURmlsZT4sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlID0gbWF0Y2guaXRlbTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBjb250YWluZXIgd2l0aCBuYXRpdmUgT2JzaWRpYW4gc3VnZ2VzdGlvbiBzdHlsaW5nXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaXRsZVxuICAgICAgICBjb25zdCB0aXRsZSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcbiAgICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSBmaWxlLmJhc2VuYW1lO1xuICAgICAgICBcbiAgICAgICAgLy8gQXV4aWxpYXJ5IGluZm8gKHBhdGgpXG4gICAgICAgIGNvbnN0IGF1eCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XG4gICAgICAgIGF1eC50ZXh0Q29udGVudCA9IGZpbGUucGF0aDtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBzdXBlci5vbkNsb3NlKCk7XG4gICAgICAgIGlmICh0aGlzLm9uQ2FuY2VsQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMub25DYW5jZWxDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgfSBmcm9tICcuLi9jb3JlL3R5cGVzJztcblxuaW50ZXJmYWNlIFN0cnVjdHVyZWRDb21tYW5kIHtcblx0bmFtZTogc3RyaW5nO1xuXHRkZXNjcmlwdGlvbjogc3RyaW5nO1xuXHRjb21tYW5kOiBzdHJpbmc7XG5cdHRlbXBsYXRlOiBzdHJpbmc7XG5cdGV4YW1wbGU6IHN0cmluZztcblx0a2V5d29yZHM6IHN0cmluZ1tdO1xufVxuXG5cbi8qKlxuICogSGFuZGxlcyBjb21tYW5kIHBpY2tlciwgY29tbWFuZCBtZW51LCBhbmQgY29tbWFuZCBleGVjdXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIENvbW1hbmRTeXN0ZW0ge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHRleHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudDtcblx0cHJpdmF0ZSBjb21tYW5kQnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjb21tYW5kUGlja2VySXRlbXM6IEhUTUxFbGVtZW50W10gPSBbXTtcblx0cHJpdmF0ZSBzZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyID0gLTE7XG5cdHByaXZhdGUgY29tbWFuZE1lbnUhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpc0NvbW1hbmRNZW51VmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogTm92YVBsdWdpbiwgY29udGFpbmVyOiBIVE1MRWxlbWVudCwgdGV4dEFyZWE6IFRleHRBcmVhQ29tcG9uZW50KSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG5cdFx0dGhpcy50ZXh0QXJlYSA9IHRleHRBcmVhO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZEJ1dHRvbihpbnB1dFJvdzogSFRNTEVsZW1lbnQpOiBCdXR0b25Db21wb25lbnQge1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRSb3cpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5zZXRJY29uKCd6YXAnKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uc2V0VG9vbHRpcCgnQ29tbWFuZHMnKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLnRvZ2dsZUNvbW1hbmRNZW51KCkpO1xuXHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0bWluLXdpZHRoOiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRoZWlnaHQ6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDUwJTtcblx0XHRcdGRpc3BsYXk6ICR7dGhpcy5zaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpID8gJ2ZsZXgnIDogJ25vbmUnfTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdG1hcmdpbi1yaWdodDogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdGA7XG5cdFx0cmV0dXJuIHRoaXMuY29tbWFuZEJ1dHRvbjtcblx0fVxuXG5cdGNyZWF0ZUNvbW1hbmRQaWNrZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5jcmVhdGVDb21tYW5kUGlja2VySW5Db250YWluZXIodGhpcy5jb250YWluZXIpO1xuXHR9XG5cblx0Y3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXBpY2tlcicgfSk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRsZWZ0OiAwO1xuXHRcdFx0cmlnaHQ6IDA7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogOHB4O1xuXHRcdFx0Ym94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXHRcdFx0bWF4LWhlaWdodDogMjAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0YDtcblx0fVxuXG5cdHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiBQbGF0Zm9ybS5pc01vYmlsZSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbiAmJiB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpO1xuXHR9XG5cblx0dXBkYXRlQ29tbWFuZEJ1dHRvblZpc2liaWxpdHkoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZEJ1dHRvbikge1xuXHRcdFx0Y29uc3Qgc2hvdWxkU2hvdyA9IHRoaXMuc2hvdWxkU2hvd0NvbW1hbmRCdXR0b24oKTtcblx0XHRcdHRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5zdHlsZS5kaXNwbGF5ID0gc2hvdWxkU2hvdyA/ICdmbGV4JyA6ICdub25lJztcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY3JlYXRlQ29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUpIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRcdG1pbi13aWR0aDogMjUwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKTtcblx0XHRgO1xuXG5cdFx0Ly8gQ29tbWFuZHMgYXZhaWxhYmxlIHRvIGFsbCB1c2Vyc1xuXHRcdGNvbnN0IGNvbW1hbmRzID0gW1xuXHRcdFx0eyBuYW1lOiAnSW1wcm92ZSBXcml0aW5nJywgZGVzY3JpcHRpb246ICdFbmhhbmNlIGNsYXJpdHkgYW5kIGZsb3cnLCBjb21tYW5kOiAnaW1wcm92ZSB3cml0aW5nJyB9LFxuXHRcdFx0eyBuYW1lOiAnRml4IEdyYW1tYXInLCBkZXNjcmlwdGlvbjogJ0NvcnJlY3QgZ3JhbW1hciBhbmQgc3BlbGxpbmcnLCBjb21tYW5kOiAnZml4IGdyYW1tYXInIH0sXG5cdFx0XHR7IG5hbWU6ICdTdW1tYXJpemUnLCBkZXNjcmlwdGlvbjogJ0NyZWF0ZSBhIGNvbmNpc2Ugc3VtbWFyeScsIGNvbW1hbmQ6ICdzdW1tYXJpemUnIH0sXG5cdFx0XHR7IG5hbWU6ICdFeHBhbmQgSWRlYXMnLCBkZXNjcmlwdGlvbjogJ0RldmVsb3AgdGhvdWdodHMgZnVydGhlcicsIGNvbW1hbmQ6ICdleHBhbmQnIH0sXG5cdFx0XHR7IG5hbWU6ICdFeHBsYWluJywgZGVzY3JpcHRpb246ICdDbGFyaWZ5IGNvbXBsZXggY29uY2VwdHMnLCBjb21tYW5kOiAnZXhwbGFpbiB0aGlzJyB9LFxuXHRcdFx0eyBuYW1lOiAnQ29udGludWUgV3JpdGluZycsIGRlc2NyaXB0aW9uOiAnRXh0ZW5kIHRoZSBjdXJyZW50IHRleHQnLCBjb21tYW5kOiAnY29udGludWUgd3JpdGluZycgfVxuXHRcdF07XG5cblx0XHRjb25zdCB0aXRsZSA9IHRoaXMuY29tbWFuZE1lbnUuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogJ1F1aWNrIENvbW1hbmRzJyB9KTtcblx0XHR0aXRsZS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRgO1xuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaChjbWQgPT4ge1xuXHRcdFx0Y29uc3QgY21kRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1pdGVtJyB9KTtcblx0XHRcdGNtZEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0yKSB2YXIoLS1zaXplLTItMyk7XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy14cyk7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMXM7XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBjbWRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQubmFtZSB9KTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRgO1xuXG5cdFx0XHRjb25zdCBkZXNjRWwgPSBjbWRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQuZGVzY3JpcHRpb24gfSk7XG5cdFx0XHRkZXNjRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsZXIpO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRgO1xuXG5cdFx0XHRjbWRFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShjbWQuY29tbWFuZCArICcgJyk7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNtZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdGNtZEVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNtZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNtZEVsLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0XHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy50ZXh0QXJlYSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBpbnB1dCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRcblx0XHQvLyBIYW5kbGUgZGlmZmVyZW50IHRyaWdnZXJzXG5cdFx0aWYgKGlucHV0LnN0YXJ0c1dpdGgoJzonKSkge1xuXHRcdFx0Ly8gQ3VzdG9tIGNvbW1hbmQgdHJpZ2dlciAtIHNob3cgc3RydWN0dXJlZCBjb21tYW5kc1xuXHRcdFx0dGhpcy5zaG93U3RydWN0dXJlZENvbW1hbmRQaWNrZXIoaW5wdXQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyB0cmlnZ2VycyBhY3RpdmUgLSBoaWRlIGNvbW1hbmQgcGlja2VyXG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblxuXHQvKipcblx0ICogU2hvdyBzdHJ1Y3R1cmVkIGNvbW1hbmQgcGlja2VyIGZvciBcIjpcIiB0cmlnZ2VyICBcblx0ICovXG5cdHByaXZhdGUgc2hvd1N0cnVjdHVyZWRDb21tYW5kUGlja2VyKGlucHV0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBzdHJ1Y3R1cmVkQ29tbWFuZHMgPSB0aGlzLmdldFN0cnVjdHVyZWRDb21tYW5kcygpO1xuXHRcdGNvbnN0IGZpbHRlclRleHQgPSBpbnB1dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgXCI6XCJcblx0XHRcblx0XHRjb25zdCBmaWx0ZXJlZCA9IHN0cnVjdHVyZWRDb21tYW5kcy5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0Y21kLmNvbW1hbmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0Y21kLmtleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBrZXl3b3JkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkpXG5cdFx0KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zID0gW107XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXG5cdFx0aWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcblx0XHRcdGZpbHRlcmVkLmZvckVhY2goKGNtZCwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZFBpY2tlci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtcGlja2VyLWl0ZW0nIH0pO1xuXHRcdFx0XHRpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG5cdFx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLm5hbWUgfSk7XG5cdFx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQuZGVzY3JpcHRpb24gfSk7XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Y29uc3QgZXhhbXBsZUVsID0gaXRlbS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBgRXhhbXBsZTogJHtjbWQuZXhhbXBsZX1gIH0pO1xuXHRcdFx0XHRleGFtcGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWFjY2VudCk7XG5cdFx0XHRcdFx0Zm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0U3RydWN0dXJlZENvbW1hbmQoY21kLnRlbXBsYXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRoaWRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblx0fVxuXG5cdGhhbmRsZUNvbW1hbmRQaWNrZXJOYXZpZ2F0aW9uKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0aWYgKGtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1pbih0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgMSwgdGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoIC0gMSk7XG5cdFx0XHR0aGlzLnVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0gZWxzZSBpZiAoa2V5ID09PSAnQXJyb3dVcCcpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1heCh0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4IC0gMSwgLTEpO1xuXHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ1RhYicgJiYgdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA+PSAwKSB7XG5cdFx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbiBmb3IgVGFiXG5cdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0aGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA+PSAwICYmIHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA+IDApIHtcblx0XHRcdC8vIEZvciBzdHJ1Y3R1cmVkIGNvbW1hbmRzLCB3ZSBuZWVkIHRvIGdldCB0aGUgc2VsZWN0ZWQgY29tbWFuZCBmcm9tIHRoZSBmaWx0ZXJlZCBsaXN0XG5cdFx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0U3RydWN0dXJlZENvbW1hbmRzKCk7XG5cdFx0XHRjb25zdCBpbnB1dCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRcdGlmIChpbnB1dC5zdGFydHNXaXRoKCc6JykpIHtcblx0XHRcdFx0Y29uc3QgZmlsdGVyVGV4dCA9IGlucHV0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdGNvbnN0IGZpbHRlcmVkID0gY29tbWFuZHMuZmlsdGVyKGNtZCA9PiBcblx0XHRcdFx0XHRjbWQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpIHx8XG5cdFx0XHRcdFx0Y21kLmNvbW1hbmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0XHRcdGNtZC5rZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4ga2V5d29yZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpKVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPCBmaWx0ZXJlZC5sZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBzZWxlY3RlZENtZCA9IGZpbHRlcmVkW3RoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXhdO1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0U3RydWN0dXJlZENvbW1hbmQoc2VsZWN0ZWRDbWQudGVtcGxhdGUpO1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuXHRcdFx0aWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4KSB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzZWxlY3RDb21tYW5kKGNvbW1hbmQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoY29tbWFuZCArICcgJyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XG5cdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IGVuZFxuXHRcdGNvbnN0IGxlbmd0aCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKS5sZW5ndGg7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKGxlbmd0aCwgbGVuZ3RoKTtcblx0XHRcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdH1cblxuXG5cdC8qKlxuXHQgKiBHZXQgc3RydWN0dXJlZCBjb21tYW5kcyBmb3IgXCI6XCIgdHJpZ2dlclxuXHQgKi9cblx0cHJpdmF0ZSBnZXRTdHJ1Y3R1cmVkQ29tbWFuZHMoKTogU3RydWN0dXJlZENvbW1hbmRbXSB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0FkZCBDb250ZW50Jyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgbmV3IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uJyxcblx0XHRcdFx0Y29tbWFuZDogJ2FkZCcsXG5cdFx0XHRcdHRlbXBsYXRlOiAnYWRkIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzphZGQgcGFyYWdyYXBoIGFib3V0IG1ldGhvZG9sb2d5Jyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY3JlYXRlJywgJ25ldycsICdpbnNlcnQnLCAnd3JpdGUnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0VkaXQgU2VsZWN0aW9uJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdFZGl0IHRoZSBzZWxlY3RlZCB0ZXh0Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2VkaXQnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2VkaXQgdG8ge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmVkaXQgdG8gYmUgbW9yZSBmb3JtYWwnLFxuXHRcdFx0XHRrZXl3b3JkczogWydtb2RpZnknLCAndXBkYXRlJywgJ2NoYW5nZScsICdyZXZpc2UnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0RlbGV0ZSBTZWxlY3Rpb24nLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogJ1JlbW92ZSB0aGUgc2VsZWN0ZWQgdGV4dCcsXG5cdFx0XHRcdGNvbW1hbmQ6ICdkZWxldGUnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2RlbGV0ZSB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6ZGVsZXRlIHNlbGVjdGVkIHRleHQnLFxuXHRcdFx0XHRrZXl3b3JkczogWydyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2VyYXNlJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdSZXdyaXRlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdSZXdyaXRlIGNvbnRlbnQgd2l0aCBzcGVjaWZpYyBzdHlsZScsXG5cdFx0XHRcdGNvbW1hbmQ6ICdyZXdyaXRlJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdyZXdyaXRlIGFzIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzpyZXdyaXRlIGFzIGJ1bGxldCBwb2ludHMnLFxuXHRcdFx0XHRrZXl3b3JkczogWydyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZXdvcmQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0ZpeCBHcmFtbWFyJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdDb3JyZWN0IGdyYW1tYXIgYW5kIHNwZWxsaW5nIGVycm9ycycsXG5cdFx0XHRcdGNvbW1hbmQ6ICdncmFtbWFyJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdmaXggZ3JhbW1hciB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6Zml4IGdyYW1tYXIgaW4gc2VsZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY29ycmVjdCcsICdwcm9vZnJlYWQnLCAnc3BlbGxpbmcnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0NvbnRpbnVlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdDb250aW51ZSB3cml0aW5nIGZyb20gY3VycmVudCBwb3NpdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdjb250aW51ZScsXG5cdFx0XHRcdHRlbXBsYXRlOiAnY29udGludWUge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmNvbnRpbnVlIHdpdGggZXhhbXBsZXMnLFxuXHRcdFx0XHRrZXl3b3JkczogWydleHRlbmQnLCAnZXhwYW5kJywgJ3Byb2NlZWQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ1VwZGF0ZSBNZXRhZGF0YScsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnVXBkYXRlIGRvY3VtZW50IHByb3BlcnRpZXMnLFxuXHRcdFx0XHRjb21tYW5kOiAnbWV0YWRhdGEnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ3VwZGF0ZSB7Y3Vyc29yfSBwcm9wZXJ0eScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6dXBkYXRlIHRhZ3MgcHJvcGVydHknLFxuXHRcdFx0XHRrZXl3b3JkczogWydmcm9udG1hdHRlcicsICdwcm9wZXJ0aWVzJywgJ3RhZ3MnXVxuXHRcdFx0fVxuXHRcdF07XG5cdH1cblxuXHQvKipcblx0ICogU2VsZWN0IGEgc3RydWN0dXJlZCBjb21tYW5kIGFuZCBpbnNlcnQgdGVtcGxhdGVcblx0ICovXG5cdHByaXZhdGUgc2VsZWN0U3RydWN0dXJlZENvbW1hbmQodGVtcGxhdGU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcblx0XHQvLyBSZXBsYWNlIGN1cnNvciBwbGFjZWhvbGRlciBhbmQgaW5zZXJ0IHRlbXBsYXRlXG5cdFx0Y29uc3QgY3Vyc29yUG9zID0gdGVtcGxhdGUuaW5kZXhPZigne2N1cnNvcn0nKTtcblx0XHRpZiAoY3Vyc29yUG9zICE9PSAtMSkge1xuXHRcdFx0Y29uc3QgYmVmb3JlQ3Vyc29yID0gdGVtcGxhdGUuc2xpY2UoMCwgY3Vyc29yUG9zKTtcblx0XHRcdGNvbnN0IGFmdGVyQ3Vyc29yID0gdGVtcGxhdGUuc2xpY2UoY3Vyc29yUG9zICsgOCk7IC8vIExlbmd0aCBvZiAne2N1cnNvcn0nXG5cdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGJlZm9yZUN1cnNvciArIGFmdGVyQ3Vyc29yKTtcblx0XHRcdFxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIHdoZXJlIHtjdXJzb3J9IHdhc1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3JQb3MsIGN1cnNvclBvcyk7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0fSwgMCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodGVtcGxhdGUpO1xuXHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5yZW1vdmUoKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLnJlbW92ZSgpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsYXRmb3JtLCBURmlsZSwgTm90aWNlLCBDYWNoZWRNZXRhZGF0YSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgY2FsY3VsYXRlQ29udGV4dFVzYWdlLCBDb250ZXh0VXNhZ2UsIGVzdGltYXRlVG9rZW5zIGFzIGNhbGN1bGF0ZVRva2VucyB9IGZyb20gJy4uL2NvcmUvY29udGV4dC1jYWxjdWxhdG9yJztcblxuZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudFJlZmVyZW5jZSB7XG5cdC8qKiBUaGUgZmlsZSBiZWluZyByZWZlcmVuY2VkICovXG5cdGZpbGU6IFRGaWxlO1xuXHRcblx0LyoqIFdoZXRoZXIgdGhpcyBpcyBwZXJzaXN0ZW50IGNvbnRleHQgKCtbW2RvY11dKSAqL1xuXHRpc1BlcnNpc3RlbnQ6IGJvb2xlYW47XG5cdFxuXHQvKiogVGhlIHJhdyByZWZlcmVuY2UgdGV4dCAoZS5nLiwgXCJbW015IERvY3VtZW50XV1cIikgKi9cblx0cmF3UmVmZXJlbmNlOiBzdHJpbmc7XG5cdFxuXHQvKiogU3BlY2lmaWMgcHJvcGVydHkgdG8gZXh0cmFjdCAoZS5nLiwgXCJbW2RvYyNwcm9wZXJ0eV1dXCIpICovXG5cdHByb3BlcnR5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpRG9jQ29udGV4dCB7XG5cdC8qKiBEb2N1bWVudHMgaW4gcGVyc2lzdGVudCBjb250ZXh0ICovXG5cdHBlcnNpc3RlbnREb2NzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuXHRcblx0LyoqIENvbWJpbmVkIGNvbnRleHQgc3RyaW5nICovXG5cdGNvbnRleHRTdHJpbmc6IHN0cmluZztcblx0XG5cdC8qKiBFc3RpbWF0ZWQgdG9rZW4gY291bnQgKGZvciBmaWxlIGF0dGFjaG1lbnRzIG9ubHkpICovXG5cdHRva2VuQ291bnQ6IG51bWJlcjtcblx0XG5cdC8qKiBXaGV0aGVyIHdlJ3JlIGFwcHJvYWNoaW5nIHRva2VuIGxpbWl0ICovXG5cdGlzTmVhckxpbWl0OiBib29sZWFuO1xuXHRcblx0LyoqIFRvdGFsIGNvbnRleHQgdXNhZ2UgY2FsY3VsYXRpb24gaW5jbHVkaW5nIGNvbnZlcnNhdGlvbiBoaXN0b3J5ICovXG5cdHRvdGFsQ29udGV4dFVzYWdlPzogQ29udGV4dFVzYWdlO1xufVxuXG4vKipcbiAqIEhhbmRsZXMgbXVsdGktZG9jdW1lbnQgY29udGV4dCBVSSBhbmQgbWFuYWdlbWVudFxuICovXG5leHBvcnQgY2xhc3MgQ29udGV4dE1hbmFnZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBhcHA6IEFwcDtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHBlcnNpc3RlbnRDb250ZXh0OiBNYXA8c3RyaW5nLCBEb2N1bWVudFJlZmVyZW5jZVtdPiA9IG5ldyBNYXAoKTtcblx0cHVibGljIGNvbnRleHRJbmRpY2F0b3IhOiBIVE1MRWxlbWVudDtcblx0cHVibGljIGNvbnRleHRQcmV2aWV3ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGN1cnJlbnRGaWxlUGF0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7IC8vIFRyYWNrIGN1cnJlbnQgZmlsZSBmb3IgdmFsaWRhdGlvblxuXHRwcml2YXRlIGN1cnJlbnRPcGVyYXRpb25JZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7IC8vIFRyYWNrIGN1cnJlbnQgYXN5bmMgb3BlcmF0aW9uXG5cdHByaXZhdGUgc2lkZWJhclZpZXc6IGFueTsgLy8gUmVmZXJlbmNlIHRvIE5vdmFTaWRlYmFyVmlldyBmb3IgYWRkaW5nIGZpbGVzXG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE5PVElDRV9EVVJBVElPTl9NUyA9IDUwMDA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBhcHA6IEFwcCwgY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuYXBwID0gYXBwO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHR9XG5cblx0c2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXc6IGFueSk6IHZvaWQge1xuXHRcdHRoaXMuc2lkZWJhclZpZXcgPSBzaWRlYmFyVmlldztcblx0fVxuXG5cdGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IC0ycHg7XG5cdFx0XHRyaWdodDogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0xKSB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0ei1pbmRleDogMTAwO1xuXHRcdFx0bWF4LXdpZHRoOiAyMDBweDtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRgO1xuXHR9XG5cblx0Y3JlYXRlQ29udGV4dFByZXZpZXcoKTogSFRNTEVsZW1lbnQge1xuXHRcdGNvbnN0IHByZXZpZXdDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsKTtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdMYWJlbCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IHRleHQ6ICdDb250ZXh0OiAnIH0pO1xuXHRcdHByZXZpZXdMYWJlbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC13ZWlnaHQ6IDYwMDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dFByZXZpZXcgfHwgIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBWYWxpZGF0ZSB3ZSBoYXZlIGEgY3VycmVudCBmaWxlIHNldFxuXHRcdGlmICghdGhpcy5jdXJyZW50RmlsZVBhdGgpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0Zm91bmRSZWZzLnB1c2goeyBuYW1lOiBkb2NOYW1lLCBwcm9wZXJ0eSB9KTtcblx0XHR9XG5cblx0XHRpZiAoZm91bmRSZWZzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3IGRpc3BsYXlcblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdGNvbnN0IHJlZnNUZXh0ID0gZm91bmRSZWZzLm1hcChyZWYgPT4gXG5cdFx0XHRcdHJlZi5wcm9wZXJ0eSA/IGAke3JlZi5uYW1lfSMke3JlZi5wcm9wZXJ0eX1gIDogcmVmLm5hbWVcblx0XHRcdCkuam9pbignLCAnKTtcblx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gcmVmc1RleHQ7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdGFzeW5jIGJ1aWxkQ29udGV4dChtZXNzYWdlOiBzdHJpbmcsIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPE11bHRpRG9jQ29udGV4dCB8IG51bGw+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ211bHRpLWRvYy1jb250ZXh0JykgfHwgIWN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBWYWxpZGF0ZSB3ZSBoYXZlIGEgY3VycmVudCBmaWxlIHNldCBmb3IgdmFsaWRhdGlvblxuXHRcdGlmICghdGhpcy5jdXJyZW50RmlsZVBhdGgpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIEdlbmVyYXRlIG9wZXJhdGlvbiBJRCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuXHRcdGNvbnN0IG9wZXJhdGlvbklkID0gRGF0ZS5ub3coKS50b1N0cmluZygpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuXHRcdHRoaXMuY3VycmVudE9wZXJhdGlvbklkID0gb3BlcmF0aW9uSWQ7XG5cdFx0XG5cdFx0Ly8gVHJhY2sgY3VycmVudCBmaWxlIHBhdGggZm9yIHZhbGlkYXRpb25cblx0XHRjb25zdCB0YXJnZXRGaWxlUGF0aCA9IGN1cnJlbnRGaWxlLnBhdGg7XG5cdFx0XG5cdFx0Ly8gVmFsaWRhdGUgdGhlIHJlcXVlc3RlZCBmaWxlIG1hdGNoZXMgb3VyIGN1cnJlbnQgdHJhY2tlZCBmaWxlXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGVQYXRoICE9PSB0YXJnZXRGaWxlUGF0aCkge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIFBhcnNlIGN1cnJlbnQgbWVzc2FnZVxuXHRcdFx0Y29uc3QgeyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9ID0gdGhpcy5wYXJzZU1lc3NhZ2UobWVzc2FnZSwgY3VycmVudEZpbGUucGF0aCk7XG5cblx0XHRcdC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIHRoaXMgY29udmVyc2F0aW9uXG5cdFx0XHRjb25zdCBleGlzdGluZ1BlcnNpc3RlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIG5ldyByZWZlcmVuY2VzIHRvIHBlcnNpc3RlbnQgY29udGV4dCAoYWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50KVxuXHRcdFx0aWYgKHJlZmVyZW5jZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ1BlcnNpc3RlbnRdO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQWRkIG5ldyByZWZlcmVuY2VzIHRoYXQgYXJlbid0IGFscmVhZHkgaW4gcGVyc2lzdGVudCBjb250ZXh0XG5cdFx0XHRcdGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcblx0XHRcdFx0XHRjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG5cdFx0XHRcdFx0aWYgKCFleGlzdHMpIHtcblx0XHRcdFx0XHRcdHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGN1cnJlbnRGaWxlLnBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gR2V0IGZpbmFsIHBlcnNpc3RlbnQgY29udGV4dCAoaW5jbHVkaW5nIG5ld2x5IGFkZGVkIGRvY3MpXG5cdFx0XHRjb25zdCByYXdQZXJzaXN0ZW50RG9jcyA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuXHRcdFx0XG5cdFx0XHQvLyBGaWx0ZXIgb3V0IGFueSBzdGFsZSBmaWxlIHJlZmVyZW5jZXMgKGZpbGVzIHRoYXQgbm8gbG9uZ2VyIGV4aXN0KVxuXHRcdFx0Y29uc3QgYWxsUGVyc2lzdGVudERvY3MgPSByYXdQZXJzaXN0ZW50RG9jcy5maWx0ZXIoZG9jUmVmID0+IHtcblx0XHRcdFx0aWYgKCFkb2NSZWY/LmZpbGUgfHwgIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkb2NSZWYuZmlsZS5wYXRoKSkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgdGhlIHBlcnNpc3RlbnQgY29udGV4dCB0byByZW1vdmUgc3RhbGUgcmVmZXJlbmNlc1xuXHRcdFx0aWYgKGFsbFBlcnNpc3RlbnREb2NzLmxlbmd0aCAhPT0gcmF3UGVyc2lzdGVudERvY3MubGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChhbGxQZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0dGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgYWxsUGVyc2lzdGVudERvY3MpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGN1cnJlbnRGaWxlLnBhdGgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEJ1aWxkIGNvbnRleHQgc3RyaW5nIGZyb20gYWxsIGRvY3VtZW50c1xuXHRcdFx0Y29uc3QgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFx0XG5cdFx0XHQvLyBBTFdBWVMgaW5jbHVkZSBjdXJyZW50IGZpbGUgY29udGVudCBhbmQgbWV0YWRhdGEgZmlyc3QgKGltcGxpY2l0IGNvbnRleHQpXG5cdFx0XHRjb25zdCBjdXJyZW50RmlsZUNvbnRleHQgPSBhd2FpdCB0aGlzLmdldEZ1bGxEb2N1bWVudENvbnRleHQoY3VycmVudEZpbGUsIHRydWUsIDEwMCk7XG5cdFx0XHRpZiAoY3VycmVudEZpbGVDb250ZXh0KSB7XG5cdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKGN1cnJlbnRGaWxlQ29udGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFRoZW4gYWRkIGFsbCBwZXJzaXN0ZW50IGRvY3VtZW50cyB3aXRoIHRoZWlyIG1ldGFkYXRhXG5cdFx0XHRmb3IgKGNvbnN0IGRvY1JlZiBvZiBhbGxQZXJzaXN0ZW50RG9jcykge1xuXHRcdFx0XHRjb25zdCBjb250ZXh0UGFydCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGRvY1JlZik7XG5cdFx0XHRcdGlmIChjb250ZXh0UGFydCkge1xuXHRcdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKGNvbnRleHRQYXJ0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBjb250ZXh0U3RyaW5nID0gY29udGV4dFBhcnRzLmpvaW4oJ1xcblxcbi0tLVxcblxcbicpO1xuXHRcdFx0Y29uc3QgdG9rZW5Db3VudCA9IHRoaXMuZXN0aW1hdGVUb2tlbnMoY29udGV4dFN0cmluZyk7XG5cblx0XHRcdC8vIENhbGN1bGF0ZSB0b3RhbCBjb250ZXh0IHVzYWdlIGluY2x1ZGluZyBjb252ZXJzYXRpb24gaGlzdG9yeVxuXHRcdFx0Y29uc3QgZmlsZUF0dGFjaG1lbnRzID0gY29udGV4dFBhcnRzLm1hcChjb250ZW50ID0+ICh7IGNvbnRlbnQgfSkpO1xuXHRcdFx0Y29uc3QgdG90YWxDb250ZXh0VXNhZ2UgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVRvdGFsQ29udGV4dFVzYWdlKGZpbGVBdHRhY2htZW50cyk7XG5cblx0XHRcdGNvbnN0IGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCA9IHtcblx0XHRcdFx0cGVyc2lzdGVudERvY3M6IGFsbFBlcnNpc3RlbnREb2NzLFxuXHRcdFx0XHRjb250ZXh0U3RyaW5nLFxuXHRcdFx0XHR0b2tlbkNvdW50LFxuXHRcdFx0XHRpc05lYXJMaW1pdDogZmFsc2UsIC8vIExlZ2FjeSBmaWVsZCAtIHdhcm5pbmdzIG5vdyBoYW5kbGVkIGluIHNpZGViYXItdmlldy50c1xuXHRcdFx0XHR0b3RhbENvbnRleHRVc2FnZTogdG90YWxDb250ZXh0VXNhZ2Vcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdC8vIFZhbGlkYXRlIG9wZXJhdGlvbiBpcyBzdGlsbCBjdXJyZW50IGFuZCBmaWxlIGhhc24ndCBjaGFuZ2VkXG5cdFx0XHRpZiAodGhpcy5jdXJyZW50T3BlcmF0aW9uSWQgIT09IG9wZXJhdGlvbklkIHx8IFxuXHRcdFx0XHQhdGhpcy5jdXJyZW50RmlsZVBhdGggfHwgXG5cdFx0XHRcdHRoaXMuY3VycmVudEZpbGVQYXRoICE9PSB0YXJnZXRGaWxlUGF0aCkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IGNvbnRleHQ7XG5cblx0XHRcdGlmIChjb250ZXh0Py5wZXJzaXN0ZW50RG9jcy5sZW5ndGgpIHtcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKGNvbnRleHQpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gY29udGV4dDtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGJ1aWxkIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0SW5kaWNhdG9yKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHZvaWQge1xuXHRcdC8vIENvbnRleHQgaW5kaWNhdG9yIFVJIGlzIG5vdyBmdWxseSBtYW5hZ2VkIGJ5IHNpZGViYXItdmlldy50c1xuXHRcdC8vIFRoaXMgbWV0aG9kIGlzIGtlcHQgZm9yIGNvbXBhdGliaWxpdHkgYnV0IGRvZXMgbm90aGluZ1xuXHRcdC8vIFRoZSBzaWRlYmFyLXZpZXcudHMgdXBkYXRlQ29udGV4dEluZGljYXRvcigpIG1ldGhvZCBoYW5kbGVzIGFsbCBkaXNwbGF5IGxvZ2ljXG5cdH1cblxuXG5cdGhpZGVDb250ZXh0UHJldmlldygpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGhpZGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFyQ3VycmVudENvbnRleHQoKTogdm9pZCB7XG5cdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0dGhpcy5jdXJyZW50RmlsZVBhdGggPSBudWxsO1xuXHRcdHRoaXMuY3VycmVudE9wZXJhdGlvbklkID0gbnVsbDtcblx0XHR0aGlzLmhpZGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0dGhpcy5oaWRlQ29udGV4dFByZXZpZXcoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTZXQgY3VycmVudCBmaWxlIGFuZCBpbW1lZGlhdGVseSBjbGVhciBjb250ZXh0IHRvIHByZXZlbnQgYmxlZWRpbmdcblx0ICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgd2hlbiBmaWxlIHN3aXRjaGVzIG9jY3VyXG5cdCAqL1xuXHRzZXRDdXJyZW50RmlsZShmaWxlOiBURmlsZSB8IG51bGwpOiB2b2lkIHtcblx0XHRjb25zdCBuZXdGaWxlUGF0aCA9IGZpbGU/LnBhdGggfHwgbnVsbDtcblx0XHRcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZVBhdGggIT09IG5ld0ZpbGVQYXRoKSB7XG5cdFx0XHQvLyBJbW1lZGlhdGVseSBjbGVhciBjb250ZXh0IHN0YXRlIHRvIHByZXZlbnQgYmxlZWRpbmdcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0dGhpcy5jdXJyZW50T3BlcmF0aW9uSWQgPSBudWxsOyAvLyBDYW5jZWwgYW55IHBlbmRpbmcgb3BlcmF0aW9uc1xuXHRcdFx0dGhpcy5oaWRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0dGhpcy5oaWRlQ29udGV4dFByZXZpZXcoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50RmlsZVBhdGggPSBuZXdGaWxlUGF0aDtcblx0fVxuXG5cdGdldEN1cnJlbnRDb250ZXh0KCk6IE11bHRpRG9jQ29udGV4dCB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRDb250ZXh0O1xuXHR9XG5cblx0Z2V0Q3VycmVudEZpbGVQYXRoKCk6IHN0cmluZyB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRGaWxlUGF0aDtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXN0b3JlIGNvbnRleHQgYWZ0ZXIgY2hhdCBoYXMgYmVlbiBsb2FkZWQgKHByZXZlbnRzIG1pc3NpbmcgZmlsZSBub3RpZmljYXRpb25zIGZyb20gYmVpbmcgY2xlYXJlZClcblx0ICovXG5cdGFzeW5jIHJlc3RvcmVDb250ZXh0QWZ0ZXJDaGF0TG9hZChmaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBSZXN0b3JlIGNvbnRleHQgZnJvbSBjb252ZXJzYXRpb24gbWFuYWdlciBpZiBhdmFpbGFibGVcblx0XHRpZiAoZmlsZSAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnJlc3RvcmVDb250ZXh0RnJvbUNvbnZlcnNhdGlvbihmaWxlKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gTG9hZCBjb250ZXh0IGRhdGEgYW5kIHVwZGF0ZSBpbmRpY2F0b3Jcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0RnJvbVN0b3JhZ2UoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBkcmF3ZXIgc2hvdWxkIGJlIHZpc2libGUgKGhhcyBjb250ZXh0IGRvY3VtZW50cylcblx0ICovXG5cdGlzRHJhd2VyVmlzaWJsZSgpOiBib29sZWFuIHtcblx0XHRjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDdXJyZW50Q29udGV4dCgpO1xuXHRcdHJldHVybiAoY29udGV4dD8ucGVyc2lzdGVudERvY3M/Lmxlbmd0aCB8fCAwKSA+IDA7XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGRvY3VtZW50IHRvIGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHQgKi9cblx0YXN5bmMgYWRkRG9jdW1lbnQoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGVQYXRoKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRyeWluZyB0byBhZGQgdGhlIGN1cnJlbnQgZmlsZSB0byBpdHMgb3duIGNvbnRleHRcblx0XHRpZiAoZmlsZS5wYXRoID09PSB0aGlzLmN1cnJlbnRGaWxlUGF0aCkge1xuXHRcdFx0Ly8gQ3VycmVudCBmaWxlIGlzIGFscmVhZHkgaW1wbGljaXRseSBpbiBjb250ZXh0LCBza2lwIHNpbGVudGx5XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEdldCBjdXJyZW50IHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdGNvbnN0IGN1cnJlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldCh0aGlzLmN1cnJlbnRGaWxlUGF0aCkgfHwgW107XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgZG9jdW1lbnQgaXMgYWxyZWFkeSBpbiBjb250ZXh0XG5cdFx0Y29uc3QgZXhpc3RzID0gY3VycmVudC5zb21lKGRvYyA9PiBkb2MuZmlsZS5wYXRoID09PSBmaWxlLnBhdGgpO1xuXHRcdGlmIChleGlzdHMpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQWRkIHRoZSBkb2N1bWVudFxuXHRcdGNvbnN0IG5ld1JlZjogRG9jdW1lbnRSZWZlcmVuY2UgPSB7IFxuXHRcdFx0ZmlsZSwgXG5cdFx0XHRwcm9wZXJ0eTogdW5kZWZpbmVkLFxuXHRcdFx0aXNQZXJzaXN0ZW50OiB0cnVlLFxuXHRcdFx0cmF3UmVmZXJlbmNlOiBgW1ske2ZpbGUuYmFzZW5hbWV9XV1gXG5cdFx0fTtcblx0XHRjb25zdCB1cGRhdGVkID0gWy4uLmN1cnJlbnQsIG5ld1JlZl07XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCBkaXJlY3RseVxuXHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KHRoaXMuY3VycmVudEZpbGVQYXRoLCB1cGRhdGVkKTtcblx0XHRcblx0XHQvLyBTYXZlIHRvIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGZvciBwZXJzaXN0ZW5jZVxuXHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuY3VycmVudEZpbGVQYXRoKTtcblx0XHRcblx0XHRpZiAoY3VycmVudEZpbGUgJiYgY3VycmVudEZpbGUucGF0aCAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZENvbnRleHREb2N1bWVudChjdXJyZW50RmlsZSBhcyBURmlsZSwgZmlsZS5wYXRoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGFuZCBpbmRpY2F0b3Jcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0RnJvbVN0b3JhZ2UoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZW1vdmUgZG9jdW1lbnQgZnJvbSBjb250ZXh0IGZvciBjdXJyZW50IGZpbGVcblx0ICovXG5cdGFzeW5jIHJlbW92ZURvY3VtZW50KGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlUGF0aCkgcmV0dXJuO1xuXHRcdFxuXHRcdC8vIFJlbW92ZSB0aGUgZG9jdW1lbnQgZnJvbSBwZXJzaXN0ZW50IGNvbnRleHRcblx0XHRjb25zdCBjdXJyZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQodGhpcy5jdXJyZW50RmlsZVBhdGgpIHx8IFtdO1xuXHRcdGNvbnN0IGZpbHRlcmVkID0gY3VycmVudC5maWx0ZXIocmVmID0+IHJlZi5maWxlLnBhdGggIT09IGZpbGUucGF0aCk7XG5cdFx0XG5cdFx0aWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KHRoaXMuY3VycmVudEZpbGVQYXRoLCBmaWx0ZXJlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKHRoaXMuY3VycmVudEZpbGVQYXRoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2F2ZSB0byBjb252ZXJzYXRpb24gbWFuYWdlciBmb3IgcGVyc2lzdGVuY2Vcblx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLmN1cnJlbnRGaWxlUGF0aCk7XG5cdFx0aWYgKGN1cnJlbnRGaWxlICYmIGN1cnJlbnRGaWxlLnBhdGggJiYgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikge1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5yZW1vdmVDb250ZXh0RG9jdW1lbnQoY3VycmVudEZpbGUgYXMgVEZpbGUsIGZpbGUucGF0aCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFJlZnJlc2ggY29udGV4dCBhbmQgaW5kaWNhdG9yXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dEZyb21TdG9yYWdlKCk7XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIGluZGljYXRvciBiYXNlZCBvbiBjdXJyZW50IGNvbnRleHQgc3RhdGVcblx0ICogTm90ZTogU2lkZWJhclZpZXcgaGFuZGxlcyBhY3R1YWwgVUkgdXBkYXRlcyB0byBwcmVzZXJ2ZSBjb21wbGV4IGRyYXdlciBmdW5jdGlvbmFsaXR5XG5cdCAqL1xuXHR1cGRhdGVJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0Ly8gU3RhdGUgaXMgbWFuYWdlZCBoZXJlLCBidXQgVUkgdXBkYXRlcyBhcmUgaGFuZGxlZCBieSBTaWRlYmFyVmlld1xuXHRcdC8vIFRoaXMgbWV0aG9kIGV4aXN0cyBmb3IgQVBJIGNvbXBsZXRlbmVzcyBidXQgZG9lc24ndCB1cGRhdGUgVUkgZGlyZWN0bHlcblx0fVxuXG5cdC8qKlxuXHQgKiBQcml2YXRlIG1ldGhvZCB0byByZWZyZXNoIGNvbnRleHQgZnJvbSBzdG9yYWdlIGFuZCB1cGRhdGUgaW5kaWNhdG9yXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0RnJvbVN0b3JhZ2UoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlUGF0aCkge1xuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHR0aGlzLmhpZGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHRcdFx0Y29uc3QgcGVyc2lzdGVudERvY3MgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldCh0aGlzLmN1cnJlbnRGaWxlUGF0aCkgfHwgW107XG5cdFx0XHRcblx0XHRcdGlmIChwZXJzaXN0ZW50RG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDYWxjdWxhdGUgdG9rZW4gY291bnRcblx0XHRcdGxldCB0b3RhbFRva2VucyA9IDA7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBjdXJyZW50IGZpbGUgdG9rZW5zXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLmN1cnJlbnRGaWxlUGF0aCk7XG5cdFx0XHRcdGlmIChjdXJyZW50RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudENvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHR0b3RhbFRva2VucyArPSBNYXRoLmNlaWwoY3VycmVudENvbnRlbnQubGVuZ3RoIC8gNCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFNraXAgaWYgY2FuJ3QgcmVhZCBjdXJyZW50IGZpbGVcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQWRkIHBlcnNpc3RlbnQgZG9jcyB0b2tlbnNcblx0XHRcdGZvciAoY29uc3QgZG9jIG9mIHBlcnNpc3RlbnREb2NzKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZG9jLmZpbGUpO1xuXHRcdFx0XHRcdHRvdGFsVG9rZW5zICs9IE1hdGguY2VpbChjb250ZW50Lmxlbmd0aCAvIDQpO1xuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdC8vIFNraXAgZmlsZXMgdGhhdCBjYW4ndCBiZSByZWFkXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXG5cdFx0XHQvLyBDYWxjdWxhdGUgdG90YWwgY29udGV4dCB1c2FnZSBmb3IgdGhlIHN0b3JlZCBjb250ZXh0XG5cdFx0XHRjb25zdCBmaWxlQXR0YWNobWVudHMgPSBwZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwID8gXG5cdFx0XHRcdFt7IGNvbnRlbnQ6IGBDb250ZXh0IGZpbGVzOiAke3BlcnNpc3RlbnREb2NzLm1hcChkID0+IGQuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKX1gIH1dIDogXG5cdFx0XHRcdFtdO1xuXHRcdFx0Y29uc3QgdG90YWxDb250ZXh0VXNhZ2UgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVRvdGFsQ29udGV4dFVzYWdlKGZpbGVBdHRhY2htZW50cyk7XG5cblx0XHRcdC8vIEJ1aWxkIGNvbnRleHQgb2JqZWN0XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0ge1xuXHRcdFx0XHRwZXJzaXN0ZW50RG9jczogcGVyc2lzdGVudERvY3MsXG5cdFx0XHRcdGNvbnRleHRTdHJpbmc6ICcnLCAvLyBOb3QgbmVlZGVkIGZvciBVSVxuXHRcdFx0XHR0b2tlbkNvdW50OiB0b3RhbFRva2Vucyxcblx0XHRcdFx0aXNOZWFyTGltaXQ6IGZhbHNlLCAvLyBMZWdhY3kgZmllbGQgLSB3YXJuaW5ncyBub3cgaGFuZGxlZCBpbiBzaWRlYmFyLXZpZXcudHNcblx0XHRcdFx0dG90YWxDb250ZXh0VXNhZ2U6IHRvdGFsQ29udGV4dFVzYWdlXG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBOb3RlOiBVSSB1cGRhdGVzIGhhbmRsZWQgYnkgU2lkZWJhclZpZXcgdG8gcHJlc2VydmUgY29tcGxleCBkcmF3ZXIgZnVuY3Rpb25hbGl0eVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIEhhbmRsZSBjb250ZXh0IGJ1aWxkIGZhaWx1cmVzIGdyYWNlZnVsbHlcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0dGhpcy5oaWRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBSZXN0b3JlIGNvbnRleHQgZnJvbSBjb252ZXJzYXRpb24gbWFuYWdlclxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyByZXN0b3JlQ29udGV4dEZyb21Db252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBzYXZlZCBjb250ZXh0IGRvY3VtZW50cyBmcm9tIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHRjb25zdCBzYXZlZENvbnRleHREb2NzID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb250ZXh0RG9jdW1lbnRzKGZpbGUpO1xuXHRcdFx0XG5cdFx0XHRpZiAoc2F2ZWRDb250ZXh0RG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0Ly8gTm8gc2F2ZWQgY29udGV4dCwgZW5zdXJlIGNsZWFuIHN0YXRlXG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGUucGF0aCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gVmFsaWRhdGUgYW5kIGNvbnZlcnQgQ29udGV4dERvY3VtZW50UmVmcyBiYWNrIHRvIERvY3VtZW50UmVmZXJlbmNlc1xuXHRcdFx0Y29uc3QgdmFsaWREb2N1bWVudFJlZnM6IERvY3VtZW50UmVmZXJlbmNlW10gPSBbXTtcblx0XHRcdGNvbnN0IGludmFsaWRQYXRoczogc3RyaW5nW10gPSBbXTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCBjb250ZXh0RG9jIG9mIHNhdmVkQ29udGV4dERvY3MpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHQvLyBWYWxpZGF0ZSBjb250ZXh0IGRvY3VtZW50IHN0cnVjdHVyZVxuXHRcdFx0XHRcdGlmICghY29udGV4dERvYyB8fCAhY29udGV4dERvYy5wYXRoIHx8IHR5cGVvZiBjb250ZXh0RG9jLnBhdGggIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ0ludmFsaWQgY29udGV4dCBkb2N1bWVudCBzdHJ1Y3R1cmU6JywgY29udGV4dERvYyk7XG5cdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gRmluZCB0aGUgYWN0dWFsIGZpbGUgaW4gdGhlIHZhdWx0XG5cdFx0XHRcdFx0Y29uc3QgY29udGV4dEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoY29udGV4dERvYy5wYXRoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoY29udGV4dEZpbGUgJiYgY29udGV4dEZpbGUucGF0aCAmJiBjb250ZXh0RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdFx0XHQvLyBGaWxlIGV4aXN0cyAtIGFkZCB0byB2YWxpZCBkb2N1bWVudHNcblx0XHRcdFx0XHRcdHZhbGlkRG9jdW1lbnRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRmaWxlOiBjb250ZXh0RmlsZSxcblx0XHRcdFx0XHRcdFx0cHJvcGVydHk6IGNvbnRleHREb2MucHJvcGVydHksXG5cdFx0XHRcdFx0XHRcdGlzUGVyc2lzdGVudDogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0cmF3UmVmZXJlbmNlOiBjb250ZXh0RG9jLnByb3BlcnR5IFxuXHRcdFx0XHRcdFx0XHRcdD8gYFtbJHtjb250ZXh0RmlsZS5iYXNlbmFtZX0jJHtjb250ZXh0RG9jLnByb3BlcnR5fV1dYFxuXHRcdFx0XHRcdFx0XHRcdDogYFtbJHtjb250ZXh0RmlsZS5iYXNlbmFtZX1dXWBcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBGaWxlIG1pc3NpbmcgLSB0cmFjayBmb3IgY2xlYW51cFxuXHRcdFx0XHRcdFx0aW52YWxpZFBhdGhzLnB1c2goY29udGV4dERvYy5wYXRoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGRvY0Vycm9yKSB7XG5cdFx0XHRcdFx0Ly8gU2tpcCBjb3JydXB0ZWQgaW5kaXZpZHVhbCBjb250ZXh0IGRvY3VtZW50c1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybignRXJyb3IgcHJvY2Vzc2luZyBjb250ZXh0IGRvY3VtZW50LCBza2lwcGluZzonLCBkb2NFcnJvcik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQ2xlYW4gdXAgbWlzc2luZyBmaWxlcyBmcm9tIGNvbnZlcnNhdGlvbiBzdG9yYWdlIGFuZCBzaG93IG5vdGljZVxuXHRcdFx0aWYgKGludmFsaWRQYXRocy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuY2xlYW51cE1pc3NpbmdGaWxlcyhmaWxlLCBpbnZhbGlkUGF0aHMpO1xuXHRcdFx0XHR0aGlzLnNob3dNaXNzaW5nRmlsZXNOb3RpY2UoaW52YWxpZFBhdGhzKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCB3aXRoIHZhbGlkYXRlZCBkb2N1bWVudHNcblx0XHRcdGlmICh2YWxpZERvY3VtZW50UmVmcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGZpbGUucGF0aCwgdmFsaWREb2N1bWVudFJlZnMpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gTm8gdmFsaWQgZmlsZXMgLSBjbGVhciBjb250ZXh0XG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGUucGF0aCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gR3JhY2VmdWwgZmFsbGJhY2sgb24gcmVzdG9yYXRpb24gZXJyb3JzXG5cdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byByZXN0b3JlIGNvbnRleHQgZnJvbSBjb252ZXJzYXRpb246JywgZXJyb3IpO1xuXHRcdFx0Ly8gRW5zdXJlIGNsZWFuIHN0YXRlIG9uIGVycm9yXG5cdFx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShmaWxlLnBhdGgpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBtaXNzaW5nIGZpbGVzIGZyb20gY29udmVyc2F0aW9uIHN0b3JhZ2Vcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgY2xlYW51cE1pc3NpbmdGaWxlcyhmaWxlOiBURmlsZSwgaW52YWxpZFBhdGhzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBSZW1vdmUgZWFjaCBpbnZhbGlkIHBhdGggZnJvbSBjb252ZXJzYXRpb24gc3RvcmFnZVxuXHRcdFx0Zm9yIChjb25zdCBpbnZhbGlkUGF0aCBvZiBpbnZhbGlkUGF0aHMpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5yZW1vdmVDb250ZXh0RG9jdW1lbnQoZmlsZSwgaW52YWxpZFBhdGgpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBHcmFjZWZ1bCBmYWxsYmFjayBpZiBjbGVhbnVwIGZhaWxzXG5cdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjbGVhbnVwIG1pc3NpbmcgZmlsZXMgZnJvbSBjb252ZXJzYXRpb246JywgZXJyb3IpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTaG93IG5vdGljZSBhbmQgY2hhdCBtZXNzYWdlIGFib3V0IG1pc3NpbmcgY29udGV4dCBmaWxlc1xuXHQgKi9cblx0cHJpdmF0ZSBzaG93TWlzc2luZ0ZpbGVzTm90aWNlKG1pc3NpbmdGaWxlczogc3RyaW5nW10pOiB2b2lkIHtcblx0XHRpZiAobWlzc2luZ0ZpbGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRsZXQgbm90aWNlTWVzc2FnZTogc3RyaW5nO1xuXHRcdFx0bGV0IGNoYXRNZXNzYWdlOiBzdHJpbmc7XG5cdFx0XHRcblx0XHRcdGlmIChtaXNzaW5nRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdG5vdGljZU1lc3NhZ2UgPSBgXHUyNkEwXHVGRTBGIENvbnRleHQgZmlsZSBubyBsb25nZXIgYXZhaWxhYmxlOiAke21pc3NpbmdGaWxlc1swXX1gO1xuXHRcdFx0XHRjaGF0TWVzc2FnZSA9IGBDb250ZXh0IGZpbGUgbm8gbG9uZ2VyIGF2YWlsYWJsZTogJHttaXNzaW5nRmlsZXNbMF19YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIExpbWl0IGRpc3BsYXkgdG8gYXZvaWQgb3Zlcmx5IGxvbmcgbm90aWNlc1xuXHRcdFx0XHRjb25zdCBkaXNwbGF5RmlsZXMgPSBtaXNzaW5nRmlsZXMuc2xpY2UoMCwgMyk7XG5cdFx0XHRcdGNvbnN0IHJlbWFpbmluZ0NvdW50ID0gbWlzc2luZ0ZpbGVzLmxlbmd0aCAtIGRpc3BsYXlGaWxlcy5sZW5ndGg7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAocmVtYWluaW5nQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0bm90aWNlTWVzc2FnZSA9IGBcdTI2QTBcdUZFMEYgJHttaXNzaW5nRmlsZXMubGVuZ3RofSBjb250ZXh0IGZpbGVzIG5vIGxvbmdlciBhdmFpbGFibGU6ICR7ZGlzcGxheUZpbGVzLmpvaW4oJywgJyl9IGFuZCAke3JlbWFpbmluZ0NvdW50fSBtb3JlYDtcblx0XHRcdFx0XHRjaGF0TWVzc2FnZSA9IGAke21pc3NpbmdGaWxlcy5sZW5ndGh9IGNvbnRleHQgZmlsZXMgbm8gbG9uZ2VyIGF2YWlsYWJsZTogJHtkaXNwbGF5RmlsZXMuam9pbignLCAnKX0gYW5kICR7cmVtYWluaW5nQ291bnR9IG1vcmVgO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG5vdGljZU1lc3NhZ2UgPSBgXHUyNkEwXHVGRTBGICR7bWlzc2luZ0ZpbGVzLmxlbmd0aH0gY29udGV4dCBmaWxlcyBubyBsb25nZXIgYXZhaWxhYmxlOiAke2Rpc3BsYXlGaWxlcy5qb2luKCcsICcpfWA7XG5cdFx0XHRcdFx0Y2hhdE1lc3NhZ2UgPSBgJHttaXNzaW5nRmlsZXMubGVuZ3RofSBjb250ZXh0IGZpbGVzIG5vIGxvbmdlciBhdmFpbGFibGU6ICR7ZGlzcGxheUZpbGVzLmpvaW4oJywgJyl9YDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBTaG93IHRlbXBvcmFyeSBub3RpY2UgZm9yIGltbWVkaWF0ZSBmZWVkYmFja1xuXHRcdFx0bmV3IE5vdGljZShub3RpY2VNZXNzYWdlLCBDb250ZXh0TWFuYWdlci5OT1RJQ0VfRFVSQVRJT05fTVMpO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgcGVybWFuZW50IGNoYXQgbWVzc2FnZSBmb3IgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0XHRcdGlmICh0aGlzLnNpZGViYXJWaWV3ICYmIHR5cGVvZiB0aGlzLnNpZGViYXJWaWV3LmFkZFdhcm5pbmdNZXNzYWdlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdHRoaXMuc2lkZWJhclZpZXcuYWRkV2FybmluZ01lc3NhZ2UoY2hhdE1lc3NhZ2UpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBHcmFjZWZ1bCBmYWxsYmFjayBpZiBub3RpY2Ugb3IgY2hhdCBtZXNzYWdlIGZhaWxzXG5cdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzaG93IG1pc3NpbmcgZmlsZXMgbm90aWZpY2F0aW9uOicsIGVycm9yKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGUgYWxsIGNvbnRleHQgZG9jdW1lbnRzIGZvciBhIGZpbGUgYW5kIHJldHVybiByZXN1bHRzXG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZUNvbnRleHREb2N1bWVudHMoZmlsZTogVEZpbGUpOiBQcm9taXNlPHtcblx0XHR2YWxpZEZpbGVzOiBzdHJpbmdbXTtcblx0XHRtaXNzaW5nRmlsZXM6IHN0cmluZ1tdO1xuXHRcdHRvdGFsQ291bnQ6IG51bWJlcjtcblx0fT4ge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikge1xuXHRcdFx0cmV0dXJuIHsgdmFsaWRGaWxlczogW10sIG1pc3NpbmdGaWxlczogW10sIHRvdGFsQ291bnQ6IDAgfTtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc2F2ZWRDb250ZXh0RG9jcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udGV4dERvY3VtZW50cyhmaWxlKTtcblx0XHRcdGNvbnN0IHZhbGlkRmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRjb25zdCBtaXNzaW5nRmlsZXM6IHN0cmluZ1tdID0gW107XG5cblx0XHRcdGZvciAoY29uc3QgY29udGV4dERvYyBvZiBzYXZlZENvbnRleHREb2NzKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGNvbnRleHREb2MucGF0aCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoY29udGV4dEZpbGUgJiYgY29udGV4dEZpbGUucGF0aCkge1xuXHRcdFx0XHRcdHZhbGlkRmlsZXMucHVzaChjb250ZXh0RG9jLnBhdGgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG1pc3NpbmdGaWxlcy5wdXNoKGNvbnRleHREb2MucGF0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dmFsaWRGaWxlcyxcblx0XHRcdFx0bWlzc2luZ0ZpbGVzLFxuXHRcdFx0XHR0b3RhbENvdW50OiBzYXZlZENvbnRleHREb2NzLmxlbmd0aFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gR3JhY2VmdWwgZmFsbGJhY2tcblx0XHRcdHJldHVybiB7IHZhbGlkRmlsZXM6IFtdLCBtaXNzaW5nRmlsZXM6IFtdLCB0b3RhbENvdW50OiAwIH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNjaGVkdWxlIGFzeW5jIHBlcnNpc3RlbmNlIHVwZGF0ZVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzY2hlZHVsZVBlcnNpc3RlbmNlVXBkYXRlKGNvbnZlcnNhdGlvbkZpbGVQYXRoOiBzdHJpbmcsIHJlZmVyZW5jZXM6IERvY3VtZW50UmVmZXJlbmNlW10pOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBSdW4gYXN5bmMgc2F2ZSBpbiBiYWNrZ3JvdW5kXG5cdFx0Y29uc3QgY29udmVyc2F0aW9uRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjb252ZXJzYXRpb25GaWxlUGF0aCk7XG5cdFx0aWYgKGNvbnZlcnNhdGlvbkZpbGUgJiYgY29udmVyc2F0aW9uRmlsZS5wYXRoICYmIHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHtcblx0XHRcdC8vIENvbnZlcnQgRG9jdW1lbnRSZWZlcmVuY2VzIHRvIENvbnRleHREb2N1bWVudFJlZnNcblx0XHRcdGNvbnN0IGNvbnRleHRSZWZzID0gcmVmZXJlbmNlcy5tYXAocmVmID0+ICh7XG5cdFx0XHRcdHBhdGg6IHJlZi5maWxlLnBhdGgsXG5cdFx0XHRcdHByb3BlcnR5OiByZWYucHJvcGVydHksXG5cdFx0XHRcdGFkZGVkQXQ6IERhdGUubm93KClcblx0XHRcdH0pKTtcblx0XHRcdFxuXHRcdFx0Ly8gU2F2ZSBhbGwgY29udGV4dCBkb2N1bWVudHNcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuc2V0Q29udGV4dERvY3VtZW50cyhjb252ZXJzYXRpb25GaWxlIGFzIFRGaWxlLCBjb250ZXh0UmVmcyk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHR0aGlzLmNsZWFyQ3VycmVudENvbnRleHQoKTtcblx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnJlbW92ZSgpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZSBhIG1lc3NhZ2UgZm9yIGRvY3VtZW50IHJlZmVyZW5jZXNcblx0ICovXG5cdHBhcnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIGNvbnZlcnNhdGlvbkZpbGVQYXRoOiBzdHJpbmcpOiB7XG5cdFx0Y2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcblx0XHRyZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuXHR9IHtcblx0XHRjb25zdCByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdID0gW107XG5cdFx0bGV0IGNsZWFuZWRNZXNzYWdlID0gbWVzc2FnZTtcblxuXHRcdC8vIFBhdHRlcm4gdG8gbWF0Y2ggW1tkb2NdXSBhbmQgK1tbZG9jXV0gd2l0aCBvcHRpb25hbCBwcm9wZXJ0eVxuXHRcdC8vIE5vdGU6IEFsbCBkb2N1bWVudCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRcblx0XHRsZXQgbWF0Y2g7XG5cdFx0d2hpbGUgKChtYXRjaCA9IHJlZlBhdHRlcm4uZXhlYyhtZXNzYWdlKSkgIT09IG51bGwpIHtcblx0XHRcdGNvbnN0IGRvY05hbWUgPSBtYXRjaFsyXTtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbWF0Y2hbM107XG5cdFx0XHRjb25zdCByYXdSZWZlcmVuY2UgPSBtYXRjaFswXTtcblxuXHRcdFx0Ly8gVHJ5IHRvIGZpbmQgdGhlIGZpbGVcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmZpbmRGaWxlKGRvY05hbWUpO1xuXHRcdFx0XG5cdFx0XHRpZiAoZmlsZSkge1xuXHRcdFx0XHRyZWZlcmVuY2VzLnB1c2goe1xuXHRcdFx0XHRcdGZpbGUsXG5cdFx0XHRcdFx0aXNQZXJzaXN0ZW50OiB0cnVlLCAvLyBBbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnRcblx0XHRcdFx0XHRyYXdSZWZlcmVuY2UsXG5cdFx0XHRcdFx0cHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGFsbCBmb3VuZCByZWZlcmVuY2VzIGZyb20gbWVzc2FnZVxuXHRcdGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcblx0XHRcdGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZShyZWYucmF3UmVmZXJlbmNlLCAnICcpO1xuXHRcdH1cblxuXHRcdC8vIENsZWFuIHVwIGV4Y2Vzc2l2ZSBzcGFjZXMgYnV0IHByZXNlcnZlIG5lY2Vzc2FyeSBzcGFjaW5nXG5cdFx0Y2xlYW5lZE1lc3NhZ2UgPSBjbGVhbmVkTWVzc2FnZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJykudHJpbSgpO1xuXG5cdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCBpZiBuZWVkZWRcblx0XHRjb25zdCBwZXJzaXN0ZW50UmVmcyA9IHJlZmVyZW5jZXMuZmlsdGVyKHJlZiA9PiByZWYuaXNQZXJzaXN0ZW50KTtcblx0XHRpZiAocGVyc2lzdGVudFJlZnMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgZXhpc3RpbmcgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjb252ZXJzYXRpb25GaWxlUGF0aCkgfHwgW107XG5cdFx0XHRjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ107XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0Zm9yIChjb25zdCByZWYgb2YgcGVyc2lzdGVudFJlZnMpIHtcblx0XHRcdFx0Y29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShleGlzdGluZyA9PiBleGlzdGluZy5maWxlLnBhdGggPT09IHJlZi5maWxlLnBhdGgpO1xuXHRcdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRcdHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjb252ZXJzYXRpb25GaWxlUGF0aCwgdXBkYXRlZFBlcnNpc3RlbnQpO1xuXHRcdFx0XG5cdFx0XHQvLyBTY2hlZHVsZSBhc3luYyBzYXZlIHRvIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHR0aGlzLnNjaGVkdWxlUGVyc2lzdGVuY2VVcGRhdGUoY29udmVyc2F0aW9uRmlsZVBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcblx0XHR9XG5cblx0XHRyZXR1cm4geyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBmdWxsIGRvY3VtZW50IGNvbnRleHQgaW5jbHVkaW5nIG1ldGFkYXRhL3Byb3BlcnRpZXNcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlOiBURmlsZSwgaW5jbHVkZUNvbnRlbnQ6IGJvb2xlYW4gPSB0cnVlLCBtYXhMaW5lczogbnVtYmVyID0gNTApOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHR0cnkge1xuXHRcdFx0bGV0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGRvY3VtZW50IGhlYWRlclxuXHRcdFx0Y29udGV4dFBhcnRzLnB1c2goYCMjIERvY3VtZW50OiAke2ZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdC8vIEdldCBhbmQgYWRkIG1ldGFkYXRhL3Byb3BlcnRpZXMgaWYgYXZhaWxhYmxlXG5cdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBPYmplY3Qua2V5cyhjYWNoZS5mcm9udG1hdHRlcikubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb250ZXh0UGFydHMucHVzaCgnXFxuIyMjIFByb3BlcnRpZXMvTWV0YWRhdGE6Jyk7XG5cdFx0XHRcdGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNhY2hlLmZyb250bWF0dGVyKSkge1xuXHRcdFx0XHRcdC8vIEZvcm1hdCB0aGUgcHJvcGVydHkgdmFsdWUgKGhhbmRsZSBhcnJheXMsIG9iamVjdHMsIGV0Yy4pXG5cdFx0XHRcdFx0Y29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogdmFsdWU7XG5cdFx0XHRcdFx0Y29udGV4dFBhcnRzLnB1c2goYC0gJHtrZXl9OiAke2Zvcm1hdHRlZFZhbHVlfWApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBjb250ZW50IGlmIHJlcXVlc3RlZFxuXHRcdFx0aWYgKGluY2x1ZGVDb250ZW50KSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gU2tpcCBmcm9udG1hdHRlciBpbiBjb250ZW50IGRpc3BsYXkgKGJldHdlZW4gLS0tIG1hcmtlcnMpXG5cdFx0XHRcdFx0bGV0IGNvbnRlbnRTdGFydEluZGV4ID0gMDtcblx0XHRcdFx0XHRpZiAobGluZXNbMF0gPT09ICctLS0nKSB7XG5cdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcblx0XHRcdFx0XHRcdFx0XHRjb250ZW50U3RhcnRJbmRleCA9IGkgKyAxO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IGNvbnRlbnRMaW5lcyA9IGxpbmVzLnNsaWNlKGNvbnRlbnRTdGFydEluZGV4KTtcblx0XHRcdFx0XHRjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gY29udGVudExpbmVzLnNsaWNlKDAsIG1heExpbmVzKS5qb2luKCdcXG4nKTtcblx0XHRcdFx0XHRjb25zdCB3YXNUcnVuY2F0ZWQgPSBjb250ZW50TGluZXMubGVuZ3RoID4gbWF4TGluZXM7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29udGV4dFBhcnRzLnB1c2goJ1xcbiMjIyBDb250ZW50OicpO1xuXHRcdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKHRydW5jYXRlZENvbnRlbnQpO1xuXHRcdFx0XHRcdGlmICh3YXNUcnVuY2F0ZWQpIHtcblx0XHRcdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKCdcXG5bLi4uIHRydW5jYXRlZCBmb3IgYnJldml0eSAuLi5dJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiBjb250ZXh0UGFydHMuam9pbignXFxuJyk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIEZhaWxlZCB0byByZWFkIGZ1bGwgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbnRleHQgZm9yIGEgc3BlY2lmaWMgZG9jdW1lbnQgcmVmZXJlbmNlXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdldERvY3VtZW50Q29udGV4dChkb2NSZWY6IERvY3VtZW50UmVmZXJlbmNlKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHsgZmlsZSwgcHJvcGVydHkgfSA9IGRvY1JlZjtcblx0XHRcdFxuXHRcdFx0Ly8gVmFsaWRhdGUgdGhhdCB0aGUgZmlsZSBzdGlsbCBleGlzdHMgaW4gdGhlIHZhdWx0XG5cdFx0XHRpZiAoIWZpbGUgfHwgIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlLnBhdGgpKSB7XG5cdFx0XHRcdC8vIEZpbGUgbm8gbG9uZ2VyIGV4aXN0cyAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAocHJvcGVydHkpIHtcblx0XHRcdFx0Ly8gR2V0IHNwZWNpZmljIHByb3BlcnR5IGZyb20gZnJvbnRtYXR0ZXJcblx0XHRcdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRcdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBjYWNoZS5mcm9udG1hdHRlcltwcm9wZXJ0eV0pIHtcblx0XHRcdFx0XHRyZXR1cm4gYCMjICR7ZmlsZS5iYXNlbmFtZX0gLSAke3Byb3BlcnR5fVxcbiR7Y2FjaGUuZnJvbnRtYXR0ZXJbcHJvcGVydHldfWA7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBHZXQgZnVsbCBkb2N1bWVudCBjb250ZXh0IHdpdGggbWV0YWRhdGFcblx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIHJlYWQgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRmluZCBhIGZpbGUgYnkgbmFtZSBvciBwYXRoXG5cdCAqL1xuXHRwcml2YXRlIGZpbmRGaWxlKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdFx0Ly8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG5cdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuXHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRmaWxlID0gZmlsZXMuZmluZChmID0+IFxuXHRcdFx0XHRmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuXHRcdFx0XHRmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG5cdFx0XHQpIHx8IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCAocm91Z2ggYXBwcm94aW1hdGlvbilcblx0ICovXG5cdHByaXZhdGUgZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcblx0XHQvLyBSb3VnaCBlc3RpbWF0ZTogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cblx0XHRyZXR1cm4gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7XG5cdH1cblxuXHQvKipcblx0ICogQ2FsY3VsYXRlIHRvdGFsIGNvbnRleHQgdXNhZ2UgaW5jbHVkaW5nIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG5cdCAqL1xuXHRhc3luYyBjYWxjdWxhdGVUb3RhbENvbnRleHRVc2FnZShcblx0XHRmaWxlQXR0YWNobWVudHM6IEFycmF5PHtjb250ZW50OiBzdHJpbmd9PiA9IFtdLFxuXHRcdGN1cnJlbnRJbnB1dDogc3RyaW5nID0gJycsXG5cdFx0cmVjZW50UmVzcG9uc2U6IHN0cmluZyA9ICcnXG5cdCk6IFByb21pc2U8Q29udGV4dFVzYWdlPiB7XG5cdFx0Ly8gVXNlIHNpbXBsZSBkZWZhdWx0cyB0byBlbnN1cmUgd2UgYWx3YXlzIHJldHVybiBhIHJlc3VsdFxuXHRcdGxldCBwcm92aWRlclR5cGUgPSAnY2xhdWRlJztcblx0XHRsZXQgbW9kZWwgPSAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInO1xuXHRcdGxldCBjb252ZXJzYXRpb25IaXN0b3J5OiBBcnJheTx7Y29udGVudDogc3RyaW5nfT4gPSBbXTtcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gVHJ5IHRvIGdldCBhY3R1YWwgcHJvdmlkZXIgYW5kIG1vZGVsXG5cdFx0XHRjb25zdCBkZXRlY3RlZFByb3ZpZGVyVHlwZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyPy5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0XHRpZiAoZGV0ZWN0ZWRQcm92aWRlclR5cGUpIHtcblx0XHRcdFx0cHJvdmlkZXJUeXBlID0gZGV0ZWN0ZWRQcm92aWRlclR5cGU7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBHZXQgbW9kZWwgZnJvbSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcikge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50TW9kZWwoKTtcblx0XHRcdFx0XHRcdGlmIChjdXJyZW50TW9kZWwpIHtcblx0XHRcdFx0XHRcdFx0bW9kZWwgPSBjdXJyZW50TW9kZWw7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIGdldCBjdXJyZW50IG1vZGVsLCB1c2luZyBkZWZhdWx0OicsIGVycm9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybignUHJvdmlkZXIgdHlwZSBkZXRlY3Rpb24gZmFpbGVkLCB1c2luZyBDbGF1ZGUgZGVmYXVsdHMnKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gR2V0IGNvbnZlcnNhdGlvbiBoaXN0b3J5IGZvciBjdXJyZW50IGZpbGVcblx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlUGF0aCAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuY3VycmVudEZpbGVQYXRoKSBhcyBURmlsZTtcblx0XHRcdFx0aWYgKGN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0Y29uc3QgY29udmVyc2F0aW9uID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb252ZXJzYXRpb24oY3VycmVudEZpbGUpO1xuXHRcdFx0XHRcdGNvbnZlcnNhdGlvbkhpc3RvcnkgPSAoY29udmVyc2F0aW9uPy5tZXNzYWdlcyB8fCBbXSkubWFwKG1zZyA9PiAoeyBjb250ZW50OiBtc2cuY29udGVudCB9KSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0Vycm9yIGR1cmluZyBjb250ZXh0IGNhbGN1bGF0aW9uIHNldHVwLCB1c2luZyBkZWZhdWx0czonLCBlcnJvcik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEFsd2F5cyBjYWxjdWxhdGUgY29udGV4dCB1c2FnZSB3aXRoIGZhbGxiYWNrIHZhbHVlc1xuXHRcdGNvbnN0IG9sbGFtYURlZmF1bHRDb250ZXh0ID0gdGhpcy5wbHVnaW4/LnNldHRpbmdzPy5vbGxhbWFEZWZhdWx0Q29udGV4dCB8fCAzMjAwMDtcblx0XHRcblx0XHRjb25zdCB1c2FnZSA9IGNhbGN1bGF0ZUNvbnRleHRVc2FnZShcblx0XHRcdHByb3ZpZGVyVHlwZSxcblx0XHRcdG1vZGVsLFxuXHRcdFx0Y29udmVyc2F0aW9uSGlzdG9yeSxcblx0XHRcdGZpbGVBdHRhY2htZW50cyxcblx0XHRcdGN1cnJlbnRJbnB1dCxcblx0XHRcdHJlY2VudFJlc3BvbnNlLFxuXHRcdFx0b2xsYW1hRGVmYXVsdENvbnRleHRcblx0XHQpO1xuXHRcdFxuXHRcdHJldHVybiB1c2FnZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG5cdCAqL1xuXHRhc3luYyBjbGVhclBlcnNpc3RlbnRDb250ZXh0KGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShmaWxlUGF0aCk7XG5cdFx0XG5cdFx0Ly8gQWxzbyBjbGVhciBmcm9tIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0Y29uc3QgY29udmVyc2F0aW9uRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0aWYgKGNvbnZlcnNhdGlvbkZpbGUgJiYgY29udmVyc2F0aW9uRmlsZS5wYXRoICYmIHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb250ZXh0RG9jdW1lbnRzKGNvbnZlcnNhdGlvbkZpbGUgYXMgVEZpbGUpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgcGVyc2lzdGVudCBjb250ZXh0IGZvciBhIGNvbnZlcnNhdGlvblxuXHQgKi9cblx0Z2V0UGVyc2lzdGVudENvbnRleHQoZmlsZVBhdGg6IHN0cmluZyk6IERvY3VtZW50UmVmZXJlbmNlW10ge1xuXHRcdHJldHVybiB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChmaWxlUGF0aCkgfHwgW107XG5cdH1cblxuXHQvKipcblx0ICogUmVtb3ZlIGEgc3BlY2lmaWMgZG9jdW1lbnQgZnJvbSBwZXJzaXN0ZW50IGNvbnRleHRcblx0ICovXG5cdGFzeW5jIHJlbW92ZVBlcnNpc3RlbnREb2MoZmlsZVBhdGg6IHN0cmluZywgZG9jVG9SZW1vdmU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChmaWxlUGF0aCkgfHwgW107XG5cdFx0Y29uc3QgZmlsdGVyZWQgPSBjdXJyZW50LmZpbHRlcihyZWYgPT4gcmVmLmZpbGUucGF0aCAhPT0gZG9jVG9SZW1vdmUpO1xuXHRcdFxuXHRcdGlmIChmaWx0ZXJlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChmaWxlUGF0aCwgZmlsdGVyZWQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShmaWxlUGF0aCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEFsc28gcmVtb3ZlIGZyb20gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRjb25zdCBjb252ZXJzYXRpb25GaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblx0XHRpZiAoY29udmVyc2F0aW9uRmlsZSAmJiBjb252ZXJzYXRpb25GaWxlLnBhdGggJiYgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikge1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5yZW1vdmVDb250ZXh0RG9jdW1lbnQoY29udmVyc2F0aW9uRmlsZSBhcyBURmlsZSwgZG9jVG9SZW1vdmUpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdmlzdWFsIGluZGljYXRvcnMgZm9yIGNvbnRleHQgc3RhdGVcblx0ICovXG5cdGdldENvbnRleHRJbmRpY2F0b3JzKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHtcblx0XHR0ZXh0OiBzdHJpbmc7XG5cdFx0Y2xhc3NOYW1lOiBzdHJpbmc7XG5cdFx0dG9vbHRpcDogc3RyaW5nO1xuXHR9IHtcblx0XHRjb25zdCBkb2NDb3VudCA9IGNvbnRleHQucGVyc2lzdGVudERvY3MubGVuZ3RoO1xuXHRcdFxuXHRcdGxldCBjbGFzc05hbWUgPSAnbm92YS1jb250ZXh0LWluZGljYXRvcic7XG5cdFx0bGV0IHRvb2x0aXAgPSBgQ29udGV4dDogJHtkb2NDb3VudH0gZG9jdW1lbnQke2RvY0NvdW50ICE9PSAxID8gJ3MnIDogJyd9LCB+JHtjb250ZXh0LnRva2VuQ291bnR9IHRva2VucyAoZmlsZXMgb25seSlgO1xuXHRcdFxuXHRcdGNvbnN0IHRleHQgPSBgJHtkb2NDb3VudH0gZG9jc2A7XG5cdFx0XG5cdFx0cmV0dXJuIHsgdGV4dCwgY2xhc3NOYW1lLCB0b29sdGlwIH07XG5cdH1cblxuXHQvKipcblx0ICogRm9ybWF0IGNvbnRleHQgZm9yIGRpc3BsYXkgaW4gVUlcblx0ICovXG5cdGZvcm1hdENvbnRleHRGb3JEaXNwbGF5KGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHN0cmluZ1tdIHtcblx0XHRjb25zdCBpdGVtczogc3RyaW5nW10gPSBbXTtcblx0XHRcblx0XHQvLyBBZGQgcGVyc2lzdGVudCBkb2N1bWVudHNcblx0XHRmb3IgKGNvbnN0IGRvYyBvZiBjb250ZXh0LnBlcnNpc3RlbnREb2NzKSB7XG5cdFx0XHRpdGVtcy5wdXNoKGAke2RvYy5maWxlLmJhc2VuYW1lfSR7ZG9jLnByb3BlcnR5ID8gYCMke2RvYy5wcm9wZXJ0eX1gIDogJyd9YCk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBpdGVtcztcblx0fVxufSIsICJleHBvcnQgaW50ZXJmYWNlIENvbnRleHRMaW1pdCB7XG4gICAgdG9rZW5zOiBudW1iZXI7XG4gICAgZmFsbGJhY2s/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByb3ZpZGVyQ29udGV4dExpbWl0cyB7XG4gICAgW21vZGVsTmFtZTogc3RyaW5nXTogQ29udGV4dExpbWl0O1xufVxuXG4vLyBDb250ZXh0IHdpbmRvdyBsaW1pdHMgZm9yIGFsbCBzdXBwb3J0ZWQgcHJvdmlkZXJzXG5jb25zdCBDTE9VRF9QUk9WSURFUl9MSU1JVFM6IFJlY29yZDxzdHJpbmcsIFByb3ZpZGVyQ29udGV4dExpbWl0cz4gPSB7XG4gICAgY2xhdWRlOiB7XG4gICAgICAgIC8vIENsYXVkZSBtb2RlbHMgLSBhbGwgY3VycmVudCB2ZXJzaW9ucyBoYXZlIDIwMGsgdG9rZW5zXG4gICAgICAgICdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtMy01LXNvbm5ldC0yMDI0MTAyMic6IHsgdG9rZW5zOiAyMDAwMDAgfSxcbiAgICAgICAgJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQwNjIwJzogeyB0b2tlbnM6IDIwMDAwMCB9LFxuICAgICAgICAnY2xhdWRlLTMtNS1oYWlrdS0yMDI0MTAyMic6IHsgdG9rZW5zOiAyMDAwMDAgfSxcbiAgICAgICAgJ2NsYXVkZS0zLW9wdXMtMjAyNDAyMjknOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtMy1zb25uZXQtMjAyNDAyMjknOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtMy1oYWlrdS0yMDI0MDMwNyc6IHsgdG9rZW5zOiAyMDAwMDAgfSxcbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIGFueSBDbGF1ZGUgbW9kZWxcbiAgICAgICAgJ2RlZmF1bHQnOiB7IHRva2VuczogMjAwMDAwLCBmYWxsYmFjazogdHJ1ZSB9XG4gICAgfSxcbiAgICBcbiAgICBvcGVuYWk6IHtcbiAgICAgICAgLy8gR1BULTQuMSBtb2RlbHMgLSAxTSB0b2tlbnNcbiAgICAgICAgJ2dwdC00LjEtbWluaS0yMDI1LTA0LTE0JzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dwdC00LjEtdHVyYm8tMjAyNS0wNC0xNCc6IHsgdG9rZW5zOiAxMDAwMDAwIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBHUFQtNG8gbW9kZWxzIC0gMTI4ayB0b2tlbnNcbiAgICAgICAgJ2dwdC00byc6IHsgdG9rZW5zOiAxMjgwMDAgfSxcbiAgICAgICAgJ2dwdC00by0yMDI0LTA4LTA2JzogeyB0b2tlbnM6IDEyODAwMCB9LFxuICAgICAgICAnZ3B0LTRvLTIwMjQtMDUtMTMnOiB7IHRva2VuczogMTI4MDAwIH0sXG4gICAgICAgICdncHQtNG8tbWluaSc6IHsgdG9rZW5zOiAxMjgwMDAgfSxcbiAgICAgICAgJ2dwdC00by1taW5pLTIwMjQtMDctMTgnOiB7IHRva2VuczogMTI4MDAwIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBHUFQtNCBUdXJibyBtb2RlbHMgLSAxMjhrIHRva2Vuc1xuICAgICAgICAnZ3B0LTQtdHVyYm8nOiB7IHRva2VuczogMTI4MDAwIH0sXG4gICAgICAgICdncHQtNC10dXJiby0yMDI0LTA0LTA5JzogeyB0b2tlbnM6IDEyODAwMCB9LFxuICAgICAgICAnZ3B0LTQtdHVyYm8tcHJldmlldyc6IHsgdG9rZW5zOiAxMjgwMDAgfSxcbiAgICAgICAgJ2dwdC00LTAxMjUtcHJldmlldyc6IHsgdG9rZW5zOiAxMjgwMDAgfSxcbiAgICAgICAgJ2dwdC00LTExMDYtcHJldmlldyc6IHsgdG9rZW5zOiAxMjgwMDAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIExlZ2FjeSBHUFQtNCBtb2RlbHMgLSA4ayB0b2tlbnNcbiAgICAgICAgJ2dwdC00JzogeyB0b2tlbnM6IDgwMDAgfSxcbiAgICAgICAgJ2dwdC00LTA2MTMnOiB7IHRva2VuczogODAwMCB9LFxuICAgICAgICAnZ3B0LTQtMDMxNCc6IHsgdG9rZW5zOiA4MDAwIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBHUFQtMy41IG1vZGVscyAtIDE2ayB0b2tlbnNcbiAgICAgICAgJ2dwdC0zLjUtdHVyYm8nOiB7IHRva2VuczogMTYwMDAgfSxcbiAgICAgICAgJ2dwdC0zLjUtdHVyYm8tMDEyNSc6IHsgdG9rZW5zOiAxNjAwMCB9LFxuICAgICAgICAnZ3B0LTMuNS10dXJiby0xMTA2JzogeyB0b2tlbnM6IDE2MDAwIH0sXG4gICAgICAgICdncHQtMy41LXR1cmJvLTE2ayc6IHsgdG9rZW5zOiAxNjAwMCB9LFxuICAgICAgICBcbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIE9wZW5BSSBtb2RlbHMgLSBhc3N1bWUgR1BULTRvIGNhcGFjaXR5XG4gICAgICAgICdkZWZhdWx0JzogeyB0b2tlbnM6IDEyODAwMCwgZmFsbGJhY2s6IHRydWUgfVxuICAgIH0sXG4gICAgXG4gICAgZ29vZ2xlOiB7XG4gICAgICAgIC8vIEdlbWluaSAyLjUgbW9kZWxzIC0gMU0gdG9rZW5zXG4gICAgICAgICdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnOiB7IHRva2VuczogMTAwMDAwMCB9LFxuICAgICAgICAnZ2VtaW5pLTIuNS1mbGFzaC1leHAnOiB7IHRva2VuczogMTAwMDAwMCB9LFxuICAgICAgICBcbiAgICAgICAgLy8gR2VtaW5pIDIuMCBtb2RlbHMgLSAxTSB0b2tlbnNcbiAgICAgICAgJ2dlbWluaS0yLjAtZmxhc2gtZXhwJzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0yLjAtZmxhc2gtdGhpbmtpbmctZXhwLTAxLTIxJzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIEdlbWluaSAxLjUgbW9kZWxzIC0gMU0gdG9rZW5zXG4gICAgICAgICdnZW1pbmktMS41LXBybyc6IHsgdG9rZW5zOiAxMDAwMDAwIH0sXG4gICAgICAgICdnZW1pbmktMS41LXByby1sYXRlc3QnOiB7IHRva2VuczogMTAwMDAwMCB9LFxuICAgICAgICAnZ2VtaW5pLTEuNS1wcm8tMDAyJzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0xLjUtcHJvLTAwMSc6IHsgdG9rZW5zOiAxMDAwMDAwIH0sXG4gICAgICAgICdnZW1pbmktMS41LWZsYXNoJzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0xLjUtZmxhc2gtbGF0ZXN0JzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0xLjUtZmxhc2gtMDAyJzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0xLjUtZmxhc2gtMDAxJzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0xLjUtZmxhc2gtOGInOiB7IHRva2VuczogMTAwMDAwMCB9LFxuICAgICAgICAnZ2VtaW5pLTEuNS1mbGFzaC04Yi1sYXRlc3QnOiB7IHRva2VuczogMTAwMDAwMCB9LFxuICAgICAgICAnZ2VtaW5pLTEuNS1mbGFzaC04Yi0wMDEnOiB7IHRva2VuczogMTAwMDAwMCB9LFxuICAgICAgICBcbiAgICAgICAgLy8gTGVnYWN5IEdlbWluaSBtb2RlbHMgLSAzMGsgdG9rZW5zXG4gICAgICAgICdnZW1pbmktcHJvJzogeyB0b2tlbnM6IDMwMDAwIH0sXG4gICAgICAgICdnZW1pbmktcHJvLXZpc2lvbic6IHsgdG9rZW5zOiAzMDAwMCB9LFxuICAgICAgICAnZ2VtaW5pLTEuMC1wcm8nOiB7IHRva2VuczogMzAwMDAgfSxcbiAgICAgICAgJ2dlbWluaS0xLjAtcHJvLWxhdGVzdCc6IHsgdG9rZW5zOiAzMDAwMCB9LFxuICAgICAgICAnZ2VtaW5pLTEuMC1wcm8tMDAxJzogeyB0b2tlbnM6IDMwMDAwIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBGYWxsYmFjayBmb3IgR29vZ2xlIG1vZGVscyAtIGFzc3VtZSBtb2Rlcm4gR2VtaW5pIGNhcGFjaXR5XG4gICAgICAgICdkZWZhdWx0JzogeyB0b2tlbnM6IDEwMDAwMDAsIGZhbGxiYWNrOiB0cnVlIH1cbiAgICB9XG59O1xuXG4vLyBEZWZhdWx0IGNvbnRleHQgd2luZG93IGZvciBPbGxhbWEgd2hlbiBub3QgY29uZmlndXJlZCBieSB1c2VyXG5leHBvcnQgY29uc3QgT0xMQU1BX0RFRkFVTFRfQ09OVEVYVCA9IDMyMDAwO1xuXG4vKipcbiAqIEdldCBjb250ZXh0IHdpbmRvdyBsaW1pdCBmb3IgYSBzcGVjaWZpYyBwcm92aWRlciBhbmQgbW9kZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnRleHRMaW1pdChwcm92aWRlcjogc3RyaW5nLCBtb2RlbDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBwcm92aWRlckxpbWl0cyA9IENMT1VEX1BST1ZJREVSX0xJTUlUU1twcm92aWRlci50b0xvd2VyQ2FzZSgpXTtcbiAgICBpZiAoIXByb3ZpZGVyTGltaXRzKSB7XG4gICAgICAgIC8vIFVua25vd24gcHJvdmlkZXIgZmFsbGJhY2tcbiAgICAgICAgcmV0dXJuIDMyMDAwO1xuICAgIH1cbiAgICBcbiAgICAvLyBUcnkgZXhhY3QgbW9kZWwgbWF0Y2ggZmlyc3RcbiAgICBjb25zdCBtb2RlbExpbWl0ID0gcHJvdmlkZXJMaW1pdHNbbW9kZWxdO1xuICAgIGlmIChtb2RlbExpbWl0KSB7XG4gICAgICAgIHJldHVybiBtb2RlbExpbWl0LnRva2VucztcbiAgICB9XG4gICAgXG4gICAgLy8gRmFsbCBiYWNrIHRvIHByb3ZpZGVyIGRlZmF1bHRcbiAgICBjb25zdCBkZWZhdWx0TGltaXQgPSBwcm92aWRlckxpbWl0c1snZGVmYXVsdCddO1xuICAgIGlmIChkZWZhdWx0TGltaXQpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRMaW1pdC50b2tlbnM7XG4gICAgfVxuICAgIFxuICAgIC8vIEZpbmFsIGZhbGxiYWNrXG4gICAgcmV0dXJuIDMyMDAwO1xufVxuXG5cbi8qKlxuICogR2V0IGFsbCBjb250ZXh0IGxpbWl0cyBmb3IgYSBwcm92aWRlciAoZm9yIFVJIGRpc3BsYXkpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm92aWRlckNvbnRleHRMaW1pdHMocHJvdmlkZXI6IHN0cmluZyk6IFByb3ZpZGVyQ29udGV4dExpbWl0cyB7XG4gICAgcmV0dXJuIENMT1VEX1BST1ZJREVSX0xJTUlUU1twcm92aWRlci50b0xvd2VyQ2FzZSgpXSB8fCB7fTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIG1vZGVsIGhhcyBhIGtub3duIGNvbnRleHQgbGltaXRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0tub3duQ29udGV4dExpbWl0KHByb3ZpZGVyOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBwcm92aWRlckxpbWl0cyA9IENMT1VEX1BST1ZJREVSX0xJTUlUU1twcm92aWRlci50b0xvd2VyQ2FzZSgpXTtcbiAgICBpZiAoIXByb3ZpZGVyTGltaXRzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICEhcHJvdmlkZXJMaW1pdHNbbW9kZWxdICYmICFwcm92aWRlckxpbWl0c1ttb2RlbF0uZmFsbGJhY2s7XG59IiwgImltcG9ydCB7IGdldENvbnRleHRMaW1pdCB9IGZyb20gJy4uL2FpL2NvbnRleHQtbGltaXRzJztcblxuZXhwb3J0IGludGVyZmFjZSBDb250ZXh0VXNhZ2Uge1xuICAgIHRvdGFsVG9rZW5zOiBudW1iZXI7XG4gICAgY29udGV4dExpbWl0OiBudW1iZXI7XG4gICAgdXNhZ2VQZXJjZW50YWdlOiBudW1iZXI7XG4gICAgYnJlYWtkb3duOiB7XG4gICAgICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IG51bWJlcjtcbiAgICAgICAgZmlsZUF0dGFjaG1lbnRzOiBudW1iZXI7XG4gICAgICAgIGN1cnJlbnRJbnB1dDogbnVtYmVyO1xuICAgICAgICByZWNlbnRSZXNwb25zZTogbnVtYmVyO1xuICAgIH07XG59XG5cbi8qKlxuICogQ2hhcmFjdGVyLWJhc2VkIHRva2VuIGVzdGltYXRpb24gKDEgdG9rZW4gXHUyMjQ4IDQgY2hhcmFjdGVycylcbiAqIE1vcmUgYWNjdXJhdGUgdGhhbiB3b3JkLWJhc2VkIGZvciBjb2RlL3RlY2huaWNhbCBjb250ZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc3RpbWF0ZVRva2Vucyh0ZXh0OiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGlmICghdGV4dCkgcmV0dXJuIDA7XG4gICAgcmV0dXJuIE1hdGguY2VpbCh0ZXh0Lmxlbmd0aCAvIDQpO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSB0b3RhbCBjb250ZXh0IHVzYWdlIGFjcm9zcyBhbGwgc291cmNlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlQ29udGV4dFVzYWdlKFxuICAgIHByb3ZpZGVyOiBzdHJpbmcsXG4gICAgbW9kZWw6IHN0cmluZyxcbiAgICBjb252ZXJzYXRpb25IaXN0b3J5OiBBcnJheTx7Y29udGVudDogc3RyaW5nfT4gPSBbXSxcbiAgICBmaWxlQXR0YWNobWVudHM6IEFycmF5PHtjb250ZW50OiBzdHJpbmd9PiA9IFtdLFxuICAgIGN1cnJlbnRJbnB1dDogc3RyaW5nID0gJycsXG4gICAgcmVjZW50UmVzcG9uc2U6IHN0cmluZyA9ICcnLFxuICAgIG9sbGFtYURlZmF1bHRDb250ZXh0OiBudW1iZXIgPSAzMjAwMFxuKTogQ29udGV4dFVzYWdlIHtcbiAgICAvLyBHZXQgY29udGV4dCBsaW1pdCBmb3IgdGhlIHByb3ZpZGVyL21vZGVsXG4gICAgbGV0IGNvbnRleHRMaW1pdDogbnVtYmVyO1xuICAgIGlmIChwcm92aWRlci50b0xvd2VyQ2FzZSgpID09PSAnb2xsYW1hJykge1xuICAgICAgICBjb250ZXh0TGltaXQgPSBvbGxhbWFEZWZhdWx0Q29udGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0TGltaXQgPSBnZXRDb250ZXh0TGltaXQocHJvdmlkZXIsIG1vZGVsKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIHRva2VucyBmb3IgZWFjaCBjb250ZXh0IGNvbXBvbmVudFxuICAgIGNvbnN0IGNvbnZlcnNhdGlvblRva2VucyA9IGNvbnZlcnNhdGlvbkhpc3RvcnkucmVkdWNlKCh0b3RhbCwgbXNnKSA9PiB7XG4gICAgICAgIHJldHVybiB0b3RhbCArIGVzdGltYXRlVG9rZW5zKG1zZy5jb250ZW50KTtcbiAgICB9LCAwKTtcbiAgICBcbiAgICBjb25zdCBmaWxlVG9rZW5zID0gZmlsZUF0dGFjaG1lbnRzLnJlZHVjZSgodG90YWwsIGZpbGUpID0+IHtcbiAgICAgICAgcmV0dXJuIHRvdGFsICsgZXN0aW1hdGVUb2tlbnMoZmlsZS5jb250ZW50KTtcbiAgICB9LCAwKTtcbiAgICBcbiAgICBjb25zdCBpbnB1dFRva2VucyA9IGVzdGltYXRlVG9rZW5zKGN1cnJlbnRJbnB1dCk7XG4gICAgY29uc3QgcmVzcG9uc2VUb2tlbnMgPSBlc3RpbWF0ZVRva2VucyhyZWNlbnRSZXNwb25zZSk7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIHVzYWdlXG4gICAgY29uc3QgdG90YWxUb2tlbnMgPSBjb252ZXJzYXRpb25Ub2tlbnMgKyBmaWxlVG9rZW5zICsgaW5wdXRUb2tlbnMgKyByZXNwb25zZVRva2VucztcbiAgICBjb25zdCB1c2FnZVBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh0b3RhbFRva2VucyAvIGNvbnRleHRMaW1pdCkgKiAxMDApO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsVG9rZW5zLFxuICAgICAgICBjb250ZXh0TGltaXQsXG4gICAgICAgIHVzYWdlUGVyY2VudGFnZSxcbiAgICAgICAgYnJlYWtkb3duOiB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25IaXN0b3J5OiBjb252ZXJzYXRpb25Ub2tlbnMsXG4gICAgICAgICAgICBmaWxlQXR0YWNobWVudHM6IGZpbGVUb2tlbnMsXG4gICAgICAgICAgICBjdXJyZW50SW5wdXQ6IGlucHV0VG9rZW5zLFxuICAgICAgICAgICAgcmVjZW50UmVzcG9uc2U6IHJlc3BvbnNlVG9rZW5zXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKipcbiAqIEdldCByZW1haW5pbmcgY29udGV4dCBwZXJjZW50YWdlIGZvciBkaXNwbGF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZW1haW5pbmdDb250ZXh0UGVyY2VudGFnZSh1c2FnZTogQ29udGV4dFVzYWdlKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgMTAwIC0gdXNhZ2UudXNhZ2VQZXJjZW50YWdlKTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBjb250ZXh0IHVzYWdlIGlzIGluIHdhcm5pbmcgdGVycml0b3J5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250ZXh0V2FybmluZ0xldmVsKHVzYWdlOiBDb250ZXh0VXNhZ2UpOiAnc2FmZScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnIHtcbiAgICBjb25zdCByZW1haW5pbmdQZXJjZW50YWdlID0gZ2V0UmVtYWluaW5nQ29udGV4dFBlcmNlbnRhZ2UodXNhZ2UpO1xuICAgIFxuICAgIGlmIChyZW1haW5pbmdQZXJjZW50YWdlIDw9IDUpIHtcbiAgICAgICAgcmV0dXJuICdjcml0aWNhbCc7XG4gICAgfSBlbHNlIGlmIChyZW1haW5pbmdQZXJjZW50YWdlIDw9IDE1KSB7XG4gICAgICAgIHJldHVybiAnd2FybmluZyc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdzYWZlJztcbiAgICB9XG59XG5cbi8qKlxuICogR2V0IGZvcm1hdHRlZCBjb250ZXh0IHVzYWdlIHN0cmluZyBmb3IgZGlzcGxheVxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0Q29udGV4dFVzYWdlKHVzYWdlOiBDb250ZXh0VXNhZ2UpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlbWFpbmluZ1BlcmNlbnRhZ2UgPSBnZXRSZW1haW5pbmdDb250ZXh0UGVyY2VudGFnZSh1c2FnZSk7XG4gICAgY29uc3Qgd2FybmluZ0xldmVsID0gZ2V0Q29udGV4dFdhcm5pbmdMZXZlbCh1c2FnZSk7XG4gICAgXG4gICAgaWYgKHdhcm5pbmdMZXZlbCA9PT0gJ2NyaXRpY2FsJykge1xuICAgICAgICByZXR1cm4gYCR7cmVtYWluaW5nUGVyY2VudGFnZX0lIGxlZnQhYDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYCR7cmVtYWluaW5nUGVyY2VudGFnZX0lIGxlZnRgO1xuICAgIH1cbn1cblxuLyoqXG4gKiBHZXQgZGV0YWlsZWQgdG9vbHRpcCBjb250ZW50IGZvciBjb250ZXh0IHVzYWdlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250ZXh0VG9vbHRpcCh1c2FnZTogQ29udGV4dFVzYWdlKTogc3RyaW5nIHtcbiAgICBjb25zdCB7IHRvdGFsVG9rZW5zLCBjb250ZXh0TGltaXQsIGJyZWFrZG93biB9ID0gdXNhZ2U7XG4gICAgY29uc3QgcmVtYWluaW5nVG9rZW5zID0gY29udGV4dExpbWl0IC0gdG90YWxUb2tlbnM7XG4gICAgXG4gICAgY29uc3QgbGluZXMgPSBbXG4gICAgICAgIGBDb250ZXh0IFVzYWdlOiAke3RvdGFsVG9rZW5zLnRvTG9jYWxlU3RyaW5nKCl9IC8gJHtjb250ZXh0TGltaXQudG9Mb2NhbGVTdHJpbmcoKX0gdG9rZW5zYCxcbiAgICAgICAgYFJlbWFpbmluZzogJHtyZW1haW5pbmdUb2tlbnMudG9Mb2NhbGVTdHJpbmcoKX0gdG9rZW5zYCxcbiAgICAgICAgJycsXG4gICAgICAgICdCcmVha2Rvd246J1xuICAgIF07XG4gICAgXG4gICAgaWYgKGJyZWFrZG93bi5jb252ZXJzYXRpb25IaXN0b3J5ID4gMCkge1xuICAgICAgICBsaW5lcy5wdXNoKGBcdTIwMjIgQ29udmVyc2F0aW9uOiAke2JyZWFrZG93bi5jb252ZXJzYXRpb25IaXN0b3J5LnRvTG9jYWxlU3RyaW5nKCl9IHRva2Vuc2ApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoYnJlYWtkb3duLmZpbGVBdHRhY2htZW50cyA+IDApIHtcbiAgICAgICAgbGluZXMucHVzaChgXHUyMDIyIEZpbGUgY29udGV4dDogJHticmVha2Rvd24uZmlsZUF0dGFjaG1lbnRzLnRvTG9jYWxlU3RyaW5nKCl9IHRva2Vuc2ApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoYnJlYWtkb3duLmN1cnJlbnRJbnB1dCA+IDApIHtcbiAgICAgICAgbGluZXMucHVzaChgXHUyMDIyIEN1cnJlbnQgaW5wdXQ6ICR7YnJlYWtkb3duLmN1cnJlbnRJbnB1dC50b0xvY2FsZVN0cmluZygpfSB0b2tlbnNgKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGJyZWFrZG93bi5yZWNlbnRSZXNwb25zZSA+IDApIHtcbiAgICAgICAgbGluZXMucHVzaChgXHUyMDIyIFJlY2VudCByZXNwb25zZTogJHticmVha2Rvd24ucmVjZW50UmVzcG9uc2UudG9Mb2NhbGVTdHJpbmcoKX0gdG9rZW5zYCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcblxuLyoqXG4gKiBNZXNzYWdlIG9wdGlvbnMgZm9yIHVuaWZpZWQgbWVzc2FnZSBjcmVhdGlvblxuICovXG5pbnRlcmZhY2UgTWVzc2FnZU9wdGlvbnMge1xuXHR0eXBlOiAncGlsbCcgfCAnYnViYmxlJztcblx0dmFyaWFudDogJ3N1Y2Nlc3MnIHwgJ2Vycm9yJyB8ICd3YXJuaW5nJyB8ICdzeXN0ZW0nIHwgJ3VzZXInIHwgJ2Fzc2lzdGFudCc7XG5cdHBlcnNpc3Q/OiBib29sZWFuOyAvLyBXaGV0aGVyIHRvIHNhdmUgdG8gY29udmVyc2F0aW9uIG1hbmFnZXJcbn1cblxuLyoqXG4gKiBIYW5kbGVzIGFsbCBjaGF0IG1lc3NhZ2UgcmVuZGVyaW5nIGFuZCBkaXNwbGF5IGxvZ2ljXG4gKi9cbmV4cG9ydCBjbGFzcyBDaGF0UmVuZGVyZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgU0NST0xMX0RFTEFZX01TID0gNTA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBjaGF0Q29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lciA9IGNoYXRDb250YWluZXI7XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGEgY2hhdCBtZXNzYWdlIHdpdGggcm9sZSBoZWFkZXJcblx0ICovXG5cdGFkZE1lc3NhZ2Uocm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0XG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSBub3ZhLW1lc3NhZ2UtJHtyb2xlfWAgfSk7XG5cdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMykgdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHQke3JvbGUgPT09ICd1c2VyJyBcblx0XHRcdFx0PyAnbWFyZ2luLWxlZnQ6IGF1dG87IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7JyBcblx0XHRcdFx0OiByb2xlID09PSAnc3lzdGVtJ1xuXHRcdFx0XHQ/ICdtYXJnaW46IDAgYXV0bzsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGwpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG5cdH1cblxuXHQvKipcblx0ICogVW5pZmllZCBtZXNzYWdlIGNyZWF0aW9uIC0gZGV0ZXJtaW5lcyBDU1MgY2xhc3MgYXQgY3JlYXRpb24gdGltZVxuXHQgKi9cblx0YWRkU3RhdHVzTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIG9wdGlvbnM6IE1lc3NhZ2VPcHRpb25zKTogdm9pZCB7XG5cdFx0Ly8gRGV0ZXJtaW5lIENTUyBjbGFzcyBiYXNlZCBvbiB0eXBlIGFuZCB2YXJpYW50XG5cdFx0Y29uc3QgY3NzQ2xhc3MgPSB0aGlzLmdldE1lc3NhZ2VDU1NDbGFzcyhjb250ZW50LCBvcHRpb25zKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgbWVzc2FnZSBlbGVtZW50IHdpdGggc3RhdGljIENTUyBjbGFzc1xuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLW1lc3NhZ2UgJHtjc3NDbGFzc31gIH0pO1xuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0XG5cdFx0aWYgKGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0Ly8gU2F2ZSB0byBjb252ZXJzYXRpb24gbWFuYWdlciBpZiByZXF1ZXN0ZWRcblx0XHRpZiAob3B0aW9ucy5wZXJzaXN0KSB7XG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFN5c3RlbU1lc3NhZ2UoXG5cdFx0XHRcdFx0YWN0aXZlRmlsZSwgXG5cdFx0XHRcdFx0Y29udGVudCxcblx0XHRcdFx0XHR7IG1lc3NhZ2VUeXBlOiBjc3NDbGFzcyB9IC8vIFN0b3JlIENTUyBjbGFzcyBhcyBtZXRhZGF0YVxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0TWVzc2FnZUNTU0NsYXNzKGNvbnRlbnQ6IHN0cmluZywgb3B0aW9uczogTWVzc2FnZU9wdGlvbnMpOiBzdHJpbmcge1xuXHRcdGlmIChvcHRpb25zLnR5cGUgPT09ICdwaWxsJykge1xuXHRcdFx0cmV0dXJuIGBub3ZhLXBpbGwtJHtvcHRpb25zLnZhcmlhbnR9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGBub3ZhLWJ1YmJsZS0ke29wdGlvbnMudmFyaWFudH1gO1xuXHRcdH1cblx0fVxuXG5cdC8vIFNpbXBsZSB3cmFwcGVyIG1ldGhvZHMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcblx0YWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nLCBwZXJzaXN0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcblx0XHQvLyBBdXRvLXByZXBlbmQgY2hlY2ttYXJrIGlmIG5vdCBhbHJlYWR5IHByZXNlbnRcblx0XHRpZiAoIWNvbnRlbnQuc3RhcnRzV2l0aCgnXHUyNzEzICcpICYmICFjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnQgPSAnXHUyNzEzICcgKyBjb250ZW50O1xuXHRcdH1cblx0XHQvLyBBbHdheXMgdXNlIHBpbGxzIGZvciBzdWNjZXNzIG1lc3NhZ2VzIHRvIG1haW50YWluIGNvbnNpc3RlbmN5XG5cdFx0dGhpcy5hZGRTdGF0dXNNZXNzYWdlKGNvbnRlbnQsIHsgdHlwZTogJ3BpbGwnLCB2YXJpYW50OiAnc3VjY2VzcycsIHBlcnNpc3QgfSk7XG5cdH1cblxuXHRhZGRFcnJvck1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBwZXJzaXN0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcblx0XHQvLyBBdXRvLXByZXBlbmQgWCBpZiBub3QgYWxyZWFkeSBwcmVzZW50XG5cdFx0aWYgKCFjb250ZW50LnN0YXJ0c1dpdGgoJ1x1Mjc0QyAnKSAmJiAhY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50ID0gJ1x1Mjc0QyAnICsgY29udGVudDtcblx0XHR9XG5cdFx0Y29uc3QgdHlwZSA9IGNvbnRlbnQubGVuZ3RoIDw9IDMwID8gJ3BpbGwnIDogJ2J1YmJsZSc7XG5cdFx0dGhpcy5hZGRTdGF0dXNNZXNzYWdlKGNvbnRlbnQsIHsgdHlwZSwgdmFyaWFudDogJ2Vycm9yJywgcGVyc2lzdCB9KTtcblx0fVxuXG5cdGFkZFdhcm5pbmdNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgcGVyc2lzdDogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG5cdFx0Ly8gQXV0by1wcmVwZW5kIHdhcm5pbmcgaWYgbm90IGFscmVhZHkgcHJlc2VudFxuXHRcdGlmICghY29udGVudC5zdGFydHNXaXRoKCdcdTI2QTBcdUZFMEYgJykgJiYgIWNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudCA9ICdcdTI2QTBcdUZFMEYgJyArIGNvbnRlbnQ7XG5cdFx0fVxuXHRcdGNvbnN0IHR5cGUgPSBjb250ZW50Lmxlbmd0aCA8PSAzMCA/ICdwaWxsJyA6ICdidWJibGUnO1xuXHRcdHRoaXMuYWRkU3RhdHVzTWVzc2FnZShjb250ZW50LCB7IHR5cGUsIHZhcmlhbnQ6ICd3YXJuaW5nJywgcGVyc2lzdCB9KTtcblx0fVxuXG5cdGFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2U/OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCB3ZWxjb21lRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lJyB9KTtcblx0XHR3ZWxjb21lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IDIwcHg7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50ID0gbWVzc2FnZSB8fCBgXG5cdFx0XHQ8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj5cblx0XHRcdFx0PHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogMzJweDsgaGVpZ2h0OiAzMnB4OyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgbWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS00LTIpO1wiPlxuXHRcdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgMTguMzY0TDE1LjUzNiAxNS41MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8L3N2Zz5cblx0XHRcdFx0PHAgc3R5bGU9XCJtYXJnaW46IDA7IG1hcmdpbi1sZWZ0OiB2YXIoLS1zaXplLTItMyk7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7IGxpbmUtaGVpZ2h0OiAxLjQ7IHRleHQtYWxpZ246IGxlZnQ7IGFsaWduLXNlbGY6IGZsZXgtc3RhcnQ7XCI+XG5cdFx0XHRcdFx0SSdtIHlvdXIgQUkgd3JpdGluZyBwYXJ0bmVyLiBTZWxlY3QgdGV4dCBhbmQgcmlnaHQtY2xpY2sgZm9yIGluc3RhbnQgZWRpdGluZywgb3IgY2hhdCBmb3IgY3Vyc29yLXByZWNpc2UgY29tbWFuZHMuXG5cdFx0XHRcdDwvcD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHR3ZWxjb21lRWwuaW5uZXJIVE1MID0gY29udGVudDtcblxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20odHJ1ZSk7XG5cdH1cblxuXG5cdGNsZWFyQ2hhdCgpOiB2b2lkIHtcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0fVxuXG5cdHByaXZhdGUgc2Nyb2xsVG9Cb3R0b20oc21vb3RoOiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmIChzbW9vdGgpIHtcblx0XHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvKHtcblx0XHRcdFx0XHR0b3A6IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQsXG5cdFx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvcCA9IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQ7XG5cdFx0XHR9XG5cdFx0fSwgQ2hhdFJlbmRlcmVyLlNDUk9MTF9ERUxBWV9NUyk7XG5cdH1cblxuXHRhc3luYyBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeShmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1MCk7XG5cdFx0XG5cdFx0aWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Ly8gTm8gY29udmVyc2F0aW9uIGV4aXN0cyAtIHNob3cgd2VsY29tZSBtZXNzYWdlXG5cdFx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuXHRcdFx0aWYgKG1lc3NhZ2Uucm9sZSA9PT0gJ3N5c3RlbScgJiYgbWVzc2FnZS5tZXRhZGF0YT8ubWVzc2FnZVR5cGUpIHtcblx0XHRcdFx0Ly8gUmVzdG9yZSBzeXN0ZW0gbWVzc2FnZSB3aXRoIG9yaWdpbmFsIHN0eWxpbmdcblx0XHRcdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IFxuXHRcdFx0XHRcdGNsczogYG5vdmEtbWVzc2FnZSAke21lc3NhZ2UubWV0YWRhdGEubWVzc2FnZVR5cGV9YCBcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAobWVzc2FnZS5jb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdFx0XHRjb250ZW50RWwuaW5uZXJIVE1MID0gbWVzc2FnZS5jb250ZW50O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IG1lc3NhZ2UuY29udGVudDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUmVndWxhciB1c2VyL2Fzc2lzdGFudCBtZXNzYWdlc1xuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UobWVzc2FnZS5yb2xlIGFzICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbScsIG1lc3NhZ2UuY29udGVudCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTtcblx0fVxufSIsICIvKipcbiAqIFVuaWZpZWQgc3RyZWFtaW5nIGFuZCBub3RpY2UgbWFuYWdlbWVudCBmb3IgTm92YVxuICogUHJvdmlkZXMgY29uc2lzdGVudCB2aXN1YWwgZmVlZGJhY2sgYW5kIHN0cmVhbWluZyBhY3Jvc3MgYWxsIGNvbW1hbmQgdHlwZXNcbiAqL1xuXG5pbXBvcnQgeyBFZGl0b3IsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBTdHJlYW1pbmdPcHRpb25zIHtcbiAgICBvbkNodW5rPzogKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHZvaWQ7XG4gICAgb25Db21wbGV0ZT86ICgpID0+IHZvaWQ7XG4gICAgb25FcnJvcj86IChlcnJvcjogRXJyb3IpID0+IHZvaWQ7XG4gICAgYW5pbWF0aW9uTW9kZT86ICdub3RpY2UnIHwgJ2lubGluZSc7IC8vIENvbnRyb2xzIHdoZXRoZXIgdG8gdXNlIE5vdGljZSBhbmltYXRpb25zIG9yIGlubGluZVxufVxuXG5leHBvcnQgdHlwZSBBY3Rpb25UeXBlID0gJ2ltcHJvdmUnIHwgJ2xvbmdlcicgfCAnc2hvcnRlcicgfCAndG9uZScgfCAnY3VzdG9tJyB8ICdjaGF0JyB8ICdhZGQnIHwgJ2VkaXQnIHwgJ3Jld3JpdGUnIHwgJ2dyYW1tYXInIHwgJ2RlbGV0ZSc7XG5cbmV4cG9ydCBjbGFzcyBTdHJlYW1pbmdNYW5hZ2VyIHtcbiAgICBwcml2YXRlIGRvdHNBbmltYXRpb25JbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIHRoaW5raW5nTm90aWNlOiBOb3RpY2UgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIGN1cnJlbnRTdHJlYW1pbmdFbmRQb3M6IGFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBzdHJlYW1pbmdTdGFydFBvczogYW55ID0gbnVsbDtcbiAgICBwcml2YXRlIG9yaWdpbmFsUG9zaXRpb246IGFueSA9IG51bGw7XG5cbiAgICAvLyBDb21wcmVoZW5zaXZlIHRoaW5raW5nIHBocmFzZXMgZm9yIGFsbCBhY3Rpb24gdHlwZXNcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBUSElOS0lOR19QSFJBU0VTOiBSZWNvcmQ8QWN0aW9uVHlwZSwgc3RyaW5nW10+ID0ge1xuICAgICAgICAnaW1wcm92ZSc6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2xvbmdlcic6IFtcbiAgICAgICAgICAgICdleHBhbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2RldmVsb3BpbmcuLi4nLFxuICAgICAgICAgICAgJ2VsYWJvcmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdidWlsZGluZy4uLicsXG4gICAgICAgICAgICAnZW5yaWNoaW5nLi4uJyxcbiAgICAgICAgICAgICdkZWVwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2dyb3dpbmcuLi4nLFxuICAgICAgICAgICAgJ2V4dGVuZGluZy4uLicsXG4gICAgICAgICAgICAnYW1wbGlmeWluZy4uLicsXG4gICAgICAgICAgICAndW5mb2xkaW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnc2hvcnRlcic6IFtcbiAgICAgICAgICAgICdjb25kZW5zaW5nLi4uJyxcbiAgICAgICAgICAgICdkaXN0aWxsaW5nLi4uJyxcbiAgICAgICAgICAgICd0aWdodGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdmb2N1c2luZy4uLicsXG4gICAgICAgICAgICAnc3RyZWFtbGluaW5nLi4uJyxcbiAgICAgICAgICAgICdjb21wcmVzc2luZy4uLicsXG4gICAgICAgICAgICAndHJpbW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2NsYXJpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ3NpbXBsaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdjb25jZW50cmF0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAndG9uZSc6IFtcbiAgICAgICAgICAgICdhZGp1c3RpbmcgdG9uZS4uLicsXG4gICAgICAgICAgICAncmVzaGFwaW5nLi4uJyxcbiAgICAgICAgICAgICdyZWZyYW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2FkYXB0aW5nLi4uJyxcbiAgICAgICAgICAgICd0cmFuc2Zvcm1pbmcuLi4nLFxuICAgICAgICAgICAgJ21vZHVsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlY2FzdGluZy4uLicsXG4gICAgICAgICAgICAnc2hpZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlZm9ybWluZy4uLicsXG4gICAgICAgICAgICAncmVpbWFnaW5pbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdjdXN0b20nOiBbXG4gICAgICAgICAgICAnd29ya2luZyBvbiBpdC4uLicsXG4gICAgICAgICAgICAnY29uc2lkZXJpbmcuLi4nLFxuICAgICAgICAgICAgJ3RoaW5raW5nLi4uJyxcbiAgICAgICAgICAgICdwcm9jZXNzaW5nLi4uJyxcbiAgICAgICAgICAgICdhbmFseXppbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbnRlbXBsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3VuZGVyc3RhbmRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ludGVycHJldGluZy4uLicsXG4gICAgICAgICAgICAnZXhwbG9yaW5nLi4uJyxcbiAgICAgICAgICAgICdldmFsdWF0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnY2hhdCc6IFtcbiAgICAgICAgICAgICdjb21wb3NpbmcuLi4nLFxuICAgICAgICAgICAgJ2RyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdjcmVhdGluZy4uLicsXG4gICAgICAgICAgICAnZ2VuZXJhdGluZy4uLicsXG4gICAgICAgICAgICAnd3JpdGluZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ2Zvcm11bGF0aW5nLi4uJyxcbiAgICAgICAgICAgICdkZXZlbG9waW5nLi4uJyxcbiAgICAgICAgICAgICdidWlsZGluZy4uLicsXG4gICAgICAgICAgICAnY29uc3RydWN0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnYWRkJzogW1xuICAgICAgICAgICAgJ2NvbXBvc2luZy4uLicsXG4gICAgICAgICAgICAnZHJhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyZWF0aW5nLi4uJyxcbiAgICAgICAgICAgICdnZW5lcmF0aW5nLi4uJyxcbiAgICAgICAgICAgICd3cml0aW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAnZm9ybXVsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2RldmVsb3BpbmcuLi4nLFxuICAgICAgICAgICAgJ2J1aWxkaW5nLi4uJyxcbiAgICAgICAgICAgICdjb25zdHJ1Y3RpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdlZGl0JzogW1xuICAgICAgICAgICAgJ3JlZmluaW5nLi4uJyxcbiAgICAgICAgICAgICdwb2xpc2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2VuaGFuY2luZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3BlcmZlY3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3Ntb290aGluZy4uLicsXG4gICAgICAgICAgICAnc2hhcnBlbmluZy4uLicsXG4gICAgICAgICAgICAnZWxldmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdmaW5lLXR1bmluZy4uLicsXG4gICAgICAgICAgICAnc2N1bHB0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAncmV3cml0ZSc6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2dyYW1tYXInOiBbXG4gICAgICAgICAgICAncmVmaW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3BvbGlzaGluZy4uLicsXG4gICAgICAgICAgICAnZW5oYW5jaW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAncGVyZmVjdGluZy4uLicsXG4gICAgICAgICAgICAnc21vb3RoaW5nLi4uJyxcbiAgICAgICAgICAgICdzaGFycGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdlbGV2YXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ZpbmUtdHVuaW5nLi4uJyxcbiAgICAgICAgICAgICdzY3VscHRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdkZWxldGUnOiBbXG4gICAgICAgICAgICAnY29uZGVuc2luZy4uLicsXG4gICAgICAgICAgICAnZGlzdGlsbGluZy4uLicsXG4gICAgICAgICAgICAndGlnaHRlbmluZy4uLicsXG4gICAgICAgICAgICAnZm9jdXNpbmcuLi4nLFxuICAgICAgICAgICAgJ3N0cmVhbWxpbmluZy4uLicsXG4gICAgICAgICAgICAnY29tcHJlc3NpbmcuLi4nLFxuICAgICAgICAgICAgJ3RyaW1taW5nLi4uJyxcbiAgICAgICAgICAgICdjbGFyaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdzaW1wbGlmeWluZy4uLicsXG4gICAgICAgICAgICAnY29uY2VudHJhdGluZy4uLidcbiAgICAgICAgXVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoaW5raW5nIG5vdGljZSB3aXRoIGNvbnRleHQtYXdhcmUgcGhyYXNlIGFuZCBhbmltYXRlZCBkb3RzXG4gICAgICogT25seSBzaG93cyBub3RpY2UgaWYgYW5pbWF0aW9uIG1vZGUgaXMgJ25vdGljZScgb3Igbm90IHNwZWNpZmllZCAoZGVmYXVsdClcbiAgICAgKi9cbiAgICBzaG93VGhpbmtpbmdOb3RpY2UoYWN0aW9uVHlwZTogQWN0aW9uVHlwZSwgYW5pbWF0aW9uTW9kZTogJ25vdGljZScgfCAnaW5saW5lJyA9ICdub3RpY2UnKTogdm9pZCB7XG4gICAgICAgIC8vIE9ubHkgc2hvdyBub3RpY2UgZm9yICdub3RpY2UnIG1vZGUgKG1lbnUvc2VsZWN0aW9uIGFjdGlvbnMpXG4gICAgICAgIGlmIChhbmltYXRpb25Nb2RlICE9PSAnbm90aWNlJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNlbGVjdCByYW5kb20gcGhyYXNlIGJhc2VkIG9uIGFjdGlvbiB0eXBlXG4gICAgICAgICAgICBjb25zdCBwaHJhc2VzID0gU3RyZWFtaW5nTWFuYWdlci5USElOS0lOR19QSFJBU0VTW2FjdGlvblR5cGVdIHx8IFN0cmVhbWluZ01hbmFnZXIuVEhJTktJTkdfUEhSQVNFU1snY2hhdCddO1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tUGhyYXNlID0gcGhyYXNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwaHJhc2VzLmxlbmd0aCldO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGVyc2lzdGVudCBub3RpY2UgKDAgdGltZW91dCA9IG1hbnVhbCBkaXNtaXNzYWwpXG4gICAgICAgICAgICB0aGlzLnRoaW5raW5nTm90aWNlID0gbmV3IE5vdGljZShgTm92YTogJHtyYW5kb21QaHJhc2V9LmAsIDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaG93IGluaXRpYWwgc3RhdGUgd2l0aCAxIGRvdCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgY29uc3QgaW5pdGlhbE5vdGljZVRleHQgPSBgTm92YTogJHtyYW5kb21QaHJhc2V9LmA7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VFbCA9ICh0aGlzLnRoaW5raW5nTm90aWNlIGFzIGFueSkubm90aWNlRWw7XG4gICAgICAgICAgICBpZiAobm90aWNlRWwpIHtcbiAgICAgICAgICAgICAgICBub3RpY2VFbC50ZXh0Q29udGVudCA9IGluaXRpYWxOb3RpY2VUZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdGFydCBkb3RzIGFuaW1hdGlvbiBpbiBub3RpY2VcbiAgICAgICAgICAgIHRoaXMuc3RhcnROb3RpY2VEb3RzQW5pbWF0aW9uKHJhbmRvbVBocmFzZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNyZWF0ZSB0aGlua2luZyBub3RpY2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgc3RyZWFtaW5nIGF0IGEgc3BlY2lmaWMgcG9zaXRpb24gd2l0aCBoeWJyaWQgYXBwcm9hY2hcbiAgICAgKiBGb3Igc2VsZWN0aW9uIHJlcGxhY2VtZW50OiBzdGFydFBvcyBhbmQgZW5kUG9zIGRlZmluZSB0aGUgcmFuZ2UgdG8gcmVwbGFjZVxuICAgICAqIEZvciBjdXJzb3IgaW5zZXJ0aW9uOiBzdGFydFBvcyBpcyB0aGUgY3Vyc29yIHBvc2l0aW9uLCBlbmRQb3Mgc2hvdWxkIGJlIG51bGxcbiAgICAgKi9cbiAgICBzdGFydFN0cmVhbWluZyhcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBzdGFydFBvczogYW55LCBcbiAgICAgICAgZW5kUG9zPzogYW55LCBcbiAgICAgICAgb3B0aW9uczogU3RyZWFtaW5nT3B0aW9ucyA9IHt9XG4gICAgKToge1xuICAgICAgICB1cGRhdGVTdHJlYW06IChuZXdUZXh0OiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHZvaWQ7XG4gICAgICAgIHN0b3BTdHJlYW06ICgpID0+IHZvaWQ7XG4gICAgfSB7XG4gICAgICAgIC8vIFN0b3JlIG9yaWdpbmFsIHBvc2l0aW9uKHMpXG4gICAgICAgIHRoaXMub3JpZ2luYWxQb3NpdGlvbiA9IHsgZnJvbTogc3RhcnRQb3MsIHRvOiBlbmRQb3MgfTtcbiAgICAgICAgXG4gICAgICAgIGlmIChlbmRQb3MpIHtcbiAgICAgICAgICAgIC8vIFNlbGVjdGlvbiByZXBsYWNlbWVudCBtb2RlIC0gY2xlYXIgdGhlIHNlbGVjdGlvblxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBzdGFydFBvcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEN1cnNvciBpbnNlcnRpb24gbW9kZSAtIHNldCBwb3NpdGlvbiBmb3Igc3RyZWFtaW5nXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBzdGFydFBvcztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IG51bGw7IC8vIFdpbGwgYmUgc2V0IG9uIGZpcnN0IGNodW5rXG5cbiAgICAgICAgY29uc3QgdXBkYXRlU3RyZWFtID0gKG5ld1RleHQ6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdHJlYW1pbmdUZXh0KGVkaXRvciwgbmV3VGV4dCwgaXNDb21wbGV0ZSwgb3B0aW9ucyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgc3RvcFN0cmVhbSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHN0cmVhbWluZyB0ZXh0IHdpdGggcHJvcGVyIHBvc2l0aW9uIHRyYWNraW5nXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVTdHJlYW1pbmdUZXh0KFxuICAgICAgICBlZGl0b3I6IEVkaXRvciwgXG4gICAgICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgICAgIGlzQ29tcGxldGU6IGJvb2xlYW4sXG4gICAgICAgIG9wdGlvbnM6IFN0cmVhbWluZ09wdGlvbnNcbiAgICApOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpIHtcbiAgICAgICAgICAgICAgICAvLyBLZWVwIG5vdGljZSBhbmltYXRpb24gcnVubmluZyBkdXJpbmcgc3RyZWFtaW5nIGZvciBub3RpY2UgbW9kZVxuICAgICAgICAgICAgICAgIC8vIEl0IHdpbGwgYmUgc3RvcHBlZCB3aGVuIHN0cmVhbWluZyBjb21wbGV0ZXMgKGlzQ29tcGxldGUgPSB0cnVlKVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSBzdGFydCBwb3NpdGlvbiB5ZXQsIHNldCBpdFxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdHJlYW1pbmdTdGFydFBvcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0geyAuLi50aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBlbmQgcG9zaXRpb24gYmFzZWQgb24gdGhlIGNvbXBsZXRlIG5ldyB0ZXh0XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBuZXdUZXh0LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdFbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MubGluZSArIGxpbmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiBsaW5lcy5sZW5ndGggPiAxID8gbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoIDogdGhpcy5zdHJlYW1pbmdTdGFydFBvcy5jaCArIG5ld1RleHQubGVuZ3RoXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYWxsIGNvbnRlbnQgZnJvbSBzdGFydCB0byBjdXJyZW50IGVuZCB3aXRoIG5ldyB0ZXh0XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdUZXh0LCB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zLCB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG5ld0VuZFBvcztcblxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgY2h1bmsgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5vbkNodW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMub25DaHVuayhuZXdUZXh0LCBpc0NvbXBsZXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNldCBjdXJzb3IgYXQgdGhlIGVuZCBvZiB0aGUgbmV3IHRleHQgb25seSB3aGVuIGNvbXBsZXRlXG4gICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IodGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIGNvbXBsZXRpb24gY2FsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMub25Db21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgdXBkYXRpbmcgc3RyZWFtaW5nIHRleHQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgZXJyb3IgY2FsbGJhY2tcbiAgICAgICAgICAgIGlmIChvcHRpb25zLm9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm9uRXJyb3IoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFuaW1hdGUgZG90cyBpbiBub3RpY2UgdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnROb3RpY2VEb3RzQW5pbWF0aW9uKGJhc2VQaHJhc2U6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgZG90Q291bnQgPSAxO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5kb3RzQW5pbWF0aW9uSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aGlua2luZ05vdGljZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGRvdENvdW50Kys7XG4gICAgICAgICAgICAgICAgaWYgKGRvdENvdW50ID4gNSkge1xuICAgICAgICAgICAgICAgICAgICBkb3RDb3VudCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGRvdHMgPSAnLicucmVwZWF0KGRvdENvdW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBub3RpY2VUZXh0ID0gYE5vdmE6ICR7YmFzZVBocmFzZX0ke2RvdHN9YDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgbm90aWNlIHRleHQgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICBjb25zdCBub3RpY2VFbCA9ICh0aGlzLnRoaW5raW5nTm90aWNlIGFzIGFueSkubm90aWNlRWw7XG4gICAgICAgICAgICAgICAgaWYgKG5vdGljZUVsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGljZUVsLnRleHRDb250ZW50ID0gbm90aWNlVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgaW4gbm90aWNlIGRvdHMgYW5pbWF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDQwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcCB0aGUgZG90cyBhbmltYXRpb24gYW5kIGRpc21pc3Mgbm90aWNlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdG9wRG90c0FuaW1hdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsKTtcbiAgICAgICAgICAgIHRoaXMuZG90c0FuaW1hdGlvbkludGVydmFsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGlzbWlzcyB0aGlua2luZyBub3RpY2VcbiAgICAgICAgaWYgKHRoaXMudGhpbmtpbmdOb3RpY2UpIHtcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy50aGlua2luZ05vdGljZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIGFsbCBhbmltYXRpb25zIGFuZCBjbGVhbiB1cFxuICAgICAqL1xuICAgIHN0b3BBbmltYXRpb24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RvcERvdHNBbmltYXRpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBhbGwgaW50ZXJuYWwgc3RhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGNsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIC8vIFN0b3Agbm90aWNlIGFuaW1hdGlvbiBpZiBpdCdzIHJ1bm5pbmdcbiAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IG51bGw7XG4gICAgICAgIHRoaXMub3JpZ2luYWxQb3NpdGlvbiA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBiZWZvcmUgc3RyZWFtaW5nIHN0YXJ0ZWRcbiAgICAgKi9cbiAgICBnZXRPcmlnaW5hbFBvc2l0aW9uKCk6IHsgZnJvbTogYW55OyB0bz86IGFueSB9IHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpbmFsUG9zaXRpb247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgY3VycmVudGx5IHN0cmVhbWluZ1xuICAgICAqL1xuICAgIGlzU3RyZWFtaW5nKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zICE9PSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVuaWZpZWQgc3RyZWFtaW5nIG1ldGhvZCBmb3Igc2VsZWN0aW9uLWJhc2VkIG9wZXJhdGlvbnNcbiAgICAgKiBIYW5kbGVzIGJvdGggbm90aWNlIGFuaW1hdGlvbnMgYW5kIGRvY3VtZW50IHVwZGF0ZXNcbiAgICAgKi9cbiAgICBhc3luYyBzdGFydFNlbGVjdGlvblN0cmVhbWluZyhcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsXG4gICAgICAgIG9yaWdpbmFsUmFuZ2U6IHsgZnJvbTogYW55OyB0bzogYW55OyB0ZXh0OiBzdHJpbmcgfSxcbiAgICAgICAgYWN0aW9uVHlwZTogQWN0aW9uVHlwZSxcbiAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2s6IChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB2b2lkLFxuICAgICAgICBvcHRpb25zOiBTdHJlYW1pbmdPcHRpb25zID0ge31cbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gU2V0IGFuaW1hdGlvbiBtb2RlIHRvICdub3RpY2UnIGZvciBzZWxlY3Rpb24gb3BlcmF0aW9uc1xuICAgICAgICBjb25zdCBzZWxlY3Rpb25PcHRpb25zID0geyAuLi5vcHRpb25zLCBhbmltYXRpb25Nb2RlOiAnbm90aWNlJyBhcyBjb25zdCB9O1xuICAgICAgICBcbiAgICAgICAgLy8gU2hvdyB0aGlua2luZyBub3RpY2UgZm9yIHNlbGVjdGlvbiBvcGVyYXRpb25zXG4gICAgICAgIHRoaXMuc2hvd1RoaW5raW5nTm90aWNlKGFjdGlvblR5cGUsICdub3RpY2UnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsZWFyIHRoZSBzZWxlY3Rpb24gYW5kIHByZXBhcmUgZm9yIHN0cmVhbWluZ1xuICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBvcmlnaW5hbFJhbmdlLmZyb20sIG9yaWdpbmFsUmFuZ2UudG8pO1xuICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBvcmlnaW5hbFJhbmdlLmZyb207XG4gICAgICAgIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgPSBudWxsO1xuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgc3RyZWFtaW5nIGludGVyZmFjZVxuICAgICAgICBjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdGFydFN0cmVhbWluZyhcbiAgICAgICAgICAgIGVkaXRvcixcbiAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2UuZnJvbSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHNlbGVjdGlvbk9wdGlvbnNcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBTZXQgdXAgdGhlIGNhbGxiYWNrIHRvIGZvcndhcmQgY2h1bmtzXG4gICAgICAgIGNvbnN0IHdyYXBwZWRDYWxsYmFjayA9IChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVTdHJlYW0oY2h1bmssIGlzQ29tcGxldGUpO1xuICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soY2h1bmssIGlzQ29tcGxldGUpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJldHVybiB0aGUgd3JhcHBlZCBjYWxsYmFjayBmb3IgZXh0ZXJuYWwgdXNlXG4gICAgICAgIHJldHVybiB3cmFwcGVkQ2FsbGJhY2sgYXMgYW55O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBTZWxlY3Rpb24tYmFzZWQgY29udGV4dCBtZW51IGZvciBOb3ZhXG4gKiBBZGRzIE5vdmEgc3VibWVudSB0byBPYnNpZGlhbidzIHJpZ2h0LWNsaWNrIGNvbnRleHQgbWVudSB3aGVuIHRleHQgaXMgc2VsZWN0ZWRcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWVudSwgTWVudUl0ZW0sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgU2VsZWN0aW9uRWRpdENvbW1hbmQgfSBmcm9tICcuLi9jb3JlL2NvbW1hbmRzL3NlbGVjdGlvbi1lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgVG9uZVNlbGVjdGlvbk1vZGFsIH0gZnJvbSAnLi90b25lLXNlbGVjdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBDdXN0b21JbnN0cnVjdGlvbk1vZGFsIH0gZnJvbSAnLi9jdXN0b20taW5zdHJ1Y3Rpb24tbW9kYWwnO1xuaW1wb3J0IHsgU3RyZWFtaW5nTWFuYWdlciwgQWN0aW9uVHlwZSB9IGZyb20gJy4vc3RyZWFtaW5nLW1hbmFnZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGlvbkFjdGlvbiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBsYWJlbDogc3RyaW5nO1xuICAgIGljb24/OiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBTRUxFQ1RJT05fQUNUSU9OUzogU2VsZWN0aW9uQWN0aW9uW10gPSBbXG4gICAge1xuICAgICAgICBpZDogJ2ltcHJvdmUnLFxuICAgICAgICBsYWJlbDogJ0ltcHJvdmUgV3JpdGluZycsXG4gICAgICAgIGljb246ICdzcGFya2xlcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTWFrZSB0ZXh0IGNsZWFyZXIsIG1vcmUgY29uY2lzZSwgYmV0dGVyIGZsb3cnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnbG9uZ2VyJyxcbiAgICAgICAgbGFiZWw6ICdNYWtlIExvbmdlcicsXG4gICAgICAgIGljb246ICdwbHVzLWNpcmNsZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRXhwYW5kIGlkZWFzIHdpdGggbW9yZSBkZXRhaWwgYW5kIGV4YW1wbGVzJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ3Nob3J0ZXInLFxuICAgICAgICBsYWJlbDogJ01ha2UgU2hvcnRlcicsXG4gICAgICAgIGljb246ICdtaW51cy1jaXJjbGUnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbmRlbnNlIHRvIGVzc2VudGlhbCBwb2ludHMnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAndG9uZScsXG4gICAgICAgIGxhYmVsOiAnQ2hhbmdlIFRvbmUnLFxuICAgICAgICBpY29uOiAncGFsZXR0ZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWRqdXN0IHdyaXRpbmcgc3R5bGUgYW5kIHRvbmUnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnY3VzdG9tJyxcbiAgICAgICAgbGFiZWw6ICdUZWxsIE5vdmEuLi4nLFxuICAgICAgICBpY29uOiAnbWVzc2FnZS1jaXJjbGUnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0N1c3RvbSBpbnN0cnVjdGlvbiBmb3IgdHJhbnNmb3JtYXRpb24nXG4gICAgfVxuXTtcblxuZXhwb3J0IGNsYXNzIFNlbGVjdGlvbkNvbnRleHRNZW51IHtcbiAgICBwcml2YXRlIHNlbGVjdGlvbkVkaXRDb21tYW5kOiBTZWxlY3Rpb25FZGl0Q29tbWFuZDtcbiAgICBwcml2YXRlIGNvbXBsZXRpb25DYWxsYmFjaz86ICgpID0+IHZvaWQ7XG4gICAgcHJpdmF0ZSBzdHJlYW1pbmdNYW5hZ2VyOiBTdHJlYW1pbmdNYW5hZ2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luXG4gICAgKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uRWRpdENvbW1hbmQgPSBuZXcgU2VsZWN0aW9uRWRpdENvbW1hbmQocGx1Z2luKTtcbiAgICAgICAgdGhpcy5zdHJlYW1pbmdNYW5hZ2VyID0gbmV3IFN0cmVhbWluZ01hbmFnZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW4gc3RyZWFtaW5nIGNvbXBsZXRlc1xuICAgICAqL1xuICAgIHNldENvbXBsZXRpb25DYWxsYmFjayhjYWxsYmFjazogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbXBsZXRpb25DYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHN0cmVhbWluZyBjb21wbGV0ZXNcbiAgICAgKi9cbiAgICBwcml2YXRlIG9uU3RyZWFtaW5nQ29tcGxldGUoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNvbXBsZXRpb25DYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5jb21wbGV0aW9uQ2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIHRoZSBjb250ZXh0IG1lbnUgd2l0aCBPYnNpZGlhbidzIGVkaXRvclxuICAgICAqL1xuICAgIHJlZ2lzdGVyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51OiBNZW51LCBlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkTm92YVN1Ym1lbnUobWVudSwgZWRpdG9yKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIE5vdmEgc3VibWVudSB0byB0aGUgY29udGV4dCBtZW51IGlmIHRleHQgaXMgc2VsZWN0ZWRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZE5vdmFTdWJtZW51KG1lbnU6IE1lbnUsIGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE9ubHkgc2hvdyBOb3ZhIHN1Ym1lbnUgd2hlbiB0ZXh0IGlzIHNlbGVjdGVkXG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0IHx8IHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgc2VwYXJhdG9yIGJlZm9yZSBOb3ZhIHN1Ym1lbnUgZm9yIHZpc3VhbCBjbGFyaXR5XG4gICAgICAgIG1lbnUuYWRkU2VwYXJhdG9yKCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIE5vdmEgYWN0aW9uIGl0ZW1zIGRpcmVjdGx5IChubyBzdGFuZGFsb25lIE5vdmEgaXRlbSlcbiAgICAgICAgU0VMRUNUSU9OX0FDVElPTlMuZm9yRWFjaChhY3Rpb24gPT4ge1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtOiBNZW51SXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKGBOb3ZhOiAke2FjdGlvbi5sYWJlbH1gKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihhY3Rpb24uaWNvbiB8fCAnZWRpdCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKGFjdGlvbi5pZCwgZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBzZWxlY3Rpb24gYWN0aW9uIHdoZW4gbWVudSBpdGVtIGlzIGNsaWNrZWRcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaGFuZGxlU2VsZWN0aW9uQWN0aW9uKGFjdGlvbklkOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSB0b25lIHNlbGVjdGlvbiB3aXRoIG1vZGFsICh3aGVuIG5vIHNwZWNpZmljIHRvbmUgcHJvdmlkZWQpXG4gICAgICAgICAgICBpZiAoYWN0aW9uSWQgPT09ICd0b25lJyAmJiAhY3VzdG9tSW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dUb25lU2VsZWN0aW9uTW9kYWwoZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGFjdGlvbklkID09PSAnY3VzdG9tJyAmJiAhY3VzdG9tSW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dDdXN0b21JbnN0cnVjdGlvbk1vZGFsKGVkaXRvciwgc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIHNlbGVjdGlvbiBlZGl0IGNvbW1hbmQgZm9yIG90aGVyIGFjdGlvbnMgb3IgZGlyZWN0IHRvbmUvY3VzdG9tIGNhbGxzXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVTZWxlY3Rpb25FZGl0KGFjdGlvbklkLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCwgY3VzdG9tSW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIE5vdmEgc2VsZWN0aW9uIGFjdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdG9uZSBzZWxlY3Rpb24gbW9kYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dUb25lU2VsZWN0aW9uTW9kYWwoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFRvbmVTZWxlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgYXN5bmMgKHNlbGVjdGVkVG9uZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0b25lIGNoYW5nZSB3aXRoIHRoZSBzZWxlY3RlZCB0b25lXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlU2VsZWN0aW9uRWRpdCgndG9uZScsIGVkaXRvciwgc2VsZWN0ZWRUZXh0LCBzZWxlY3RlZFRvbmUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIGNhbmNlbGxlZCwgZG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBjdXN0b20gaW5zdHJ1Y3Rpb24gbW9kYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dDdXN0b21JbnN0cnVjdGlvbk1vZGFsKGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBDdXN0b21JbnN0cnVjdGlvbk1vZGFsKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICBhc3luYyAoaW5zdHJ1Y3Rpb246IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgY3VzdG9tIHRyYW5zZm9ybWF0aW9uIHdpdGggdGhlIGluc3RydWN0aW9uXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlU2VsZWN0aW9uRWRpdCgnY3VzdG9tJywgZWRpdG9yLCBzZWxlY3RlZFRleHQsIGluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBjYW5jZWxsZWQsIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgbW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgdGhlIHNlbGVjdGlvbiBlZGl0IGNvbW1hbmQgd2l0aCBzdHJlYW1pbmdcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVTZWxlY3Rpb25FZGl0KFxuICAgICAgICBhY3Rpb25JZDogc3RyaW5nLCBcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBzZWxlY3RlZFRleHQ6IHN0cmluZywgXG4gICAgICAgIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIFN0YXJ0IHNlbGVjdGlvbiBhbmltYXRpb25cbiAgICAgICAgdGhpcy5zdGFydFNlbGVjdGlvbkFuaW1hdGlvbihlZGl0b3IpO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgc2VsZWN0aW9uIHJhbmdlXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUmFuZ2UgPSB7XG4gICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICB0bzogZWRpdG9yLmdldEN1cnNvcigndG8nKVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSB1bmlmaWVkIHN0cmVhbWluZyBzeXN0ZW0gd2l0aCBub3RpY2UgYW5pbWF0aW9uc1xuICAgICAgICAgICAgY29uc3QgeyB1cGRhdGVTdHJlYW0sIHN0b3BTdHJlYW0gfSA9IHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zdGFydFN0cmVhbWluZyhcbiAgICAgICAgICAgICAgICBlZGl0b3IsXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxSYW5nZS5mcm9tLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2UudG8sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25Nb2RlOiAnbm90aWNlJyxcbiAgICAgICAgICAgICAgICAgICAgb25Db21wbGV0ZTogKCkgPT4gdGhpcy5vblN0cmVhbWluZ0NvbXBsZXRlKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBTaG93IG5vdGljZSB0aGlua2luZyBhbmltYXRpb25cbiAgICAgICAgICAgIHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zaG93VGhpbmtpbmdOb3RpY2UoYWN0aW9uSWQgYXMgQWN0aW9uVHlwZSwgJ25vdGljZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIHRvIHByb2dyZXNzaXZlbHkgcmVwbGFjZSB0ZXh0XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnNlbGVjdGlvbkVkaXRDb21tYW5kLmV4ZWN1dGVTdHJlYW1pbmcoXG4gICAgICAgICAgICAgICAgYWN0aW9uSWQsIFxuICAgICAgICAgICAgICAgIGVkaXRvciwgXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0LFxuICAgICAgICAgICAgICAgIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB1bmlmaWVkIHN0cmVhbWluZyBzeXN0ZW1cbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGN1c3RvbUluc3RydWN0aW9uXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAvLyBTdG9wIHN0cmVhbWluZyB3aGVuIGRvbmVcbiAgICAgICAgICAgIHN0b3BTdHJlYW0oKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uTmFtZSA9IHRoaXMuZ2V0QWN0aW9uRGlzcGxheU5hbWUoYWN0aW9uSWQpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE5vdmE6IFRleHQgJHthY3Rpb25OYW1lfSBzdWNjZXNzZnVsbHlgLCAyMDAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBBZGQgc3VjY2VzcyBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFN1Y2Nlc3NDaGF0TWVzc2FnZShhY3Rpb25JZCwgc2VsZWN0ZWRUZXh0LCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE5vdmE6ICR7cmVzdWx0LmVycm9yIHx8ICdGYWlsZWQgdG8gcHJvY2VzcyB0ZXh0J31gLCAzMDAwKTtcbiAgICAgICAgICAgICAgICAvLyBBZGQgZmFpbHVyZSBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEZhaWx1cmVDaGF0TWVzc2FnZShhY3Rpb25JZCwgcmVzdWx0LmVycm9yIHx8ICdGYWlsZWQgdG8gcHJvY2VzcyB0ZXh0Jyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCB0ZXh0IHdoZW4gc3RyZWFtaW5nIGZhaWxzXG4gICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlT3JpZ2luYWxUZXh0KGVkaXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzdHJlYW1pbmcgc2VsZWN0aW9uIGVkaXQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGV4ZWN1dGUgTm92YSBhY3Rpb24uIFBsZWFzZSB0cnkgYWdhaW4uJywgMzAwMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGV4dCBvbiBjb21wbGV0ZSBmYWlsdXJlXG4gICAgICAgICAgICB0aGlzLnJlc3RvcmVPcmlnaW5hbFRleHQoZWRpdG9yKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIC8vIEFsd2F5cyBzdG9wIGFuaW1hdGlvbnMgYW5kIGNsZWFuIHVwXG4gICAgICAgICAgICB0aGlzLnN0b3BTZWxlY3Rpb25BbmltYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXN0b3JlIG9yaWdpbmFsIHRleHQgaWYgc3RyZWFtaW5nIGZhaWxzIGNvbXBsZXRlbHlcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlc3RvcmVPcmlnaW5hbFRleHQoZWRpdG9yOiBFZGl0b3IpOiB2b2lkIHtcbiAgICAgICAgLy8gVGhlIFN0cmVhbWluZ01hbmFnZXIgbm93IGhhbmRsZXMgdGV4dCByZXN0b3JhdGlvblxuICAgICAgICAvLyBUaGlzIGlzIGtlcHQgZm9yIGNvbXBhdGliaWxpdHkgYnV0IG1vc3QgcmVzdG9yYXRpb24gaXMgaGFuZGxlZCBieSB0aGUgdW5pZmllZCBzeXN0ZW1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBwdWxzaW5nIGFuaW1hdGlvbiBvbiBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGFydFNlbGVjdGlvbkFuaW1hdGlvbihlZGl0b3I6IEVkaXRvcik6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgZWRpdG9yIGNvbnRhaW5lciBpbiB0aGUgRE9NXG4gICAgICAgICAgICBjb25zdCBlZGl0b3JDb250YWluZXIgPSAoZWRpdG9yIGFzIGFueSkuY20/LmRvbSB8fCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY20tZWRpdG9yJyk7XG4gICAgICAgICAgICBpZiAoZWRpdG9yQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ25vdmEtc2VsZWN0aW9uLXByb2Nlc3NpbmcnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG9yaWdpbmFsIHNlbGVjdGlvbiBmb3IgbGF0ZXIgY2xlYW51cFxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZWRTZWxlY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKSxcbiAgICAgICAgICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc3RhcnQgc2VsZWN0aW9uIGFuaW1hdGlvbjonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIHB1bHNpbmcgYW5pbWF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdG9wU2VsZWN0aW9uQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGFuaW1hdGlvbiBjbGFzcyBmcm9tIGFsbCBwb3NzaWJsZSBlZGl0b3IgZWxlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvckVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLkNvZGVNaXJyb3IsIC5jbS1lZGl0b3InKTtcbiAgICAgICAgICAgIGVkaXRvckVsZW1lbnRzLmZvckVhY2goZWwgPT4ge1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ25vdmEtc2VsZWN0aW9uLXByb2Nlc3NpbmcnKTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZWRTZWxlY3Rpb24gPSBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc3RvcCBzZWxlY3Rpb24gYW5pbWF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYW5pbWF0ZWRTZWxlY3Rpb246IHsgZnJvbTogYW55OyB0bzogYW55IH0gfCBudWxsID0gbnVsbDtcblxuXG5cblxuXG4gICAgLyoqXG4gICAgICogR2V0IGRpc3BsYXkgbmFtZSBmb3IgYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRBY3Rpb25EaXNwbGF5TmFtZShhY3Rpb25JZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChhY3Rpb25JZCkge1xuICAgICAgICAgICAgY2FzZSAnaW1wcm92ZSc6IHJldHVybiAnaW1wcm92ZWQnO1xuICAgICAgICAgICAgY2FzZSAnbG9uZ2VyJzogcmV0dXJuICdleHBhbmRlZCc7XG4gICAgICAgICAgICBjYXNlICdzaG9ydGVyJzogcmV0dXJuICdjb25kZW5zZWQnO1xuICAgICAgICAgICAgY2FzZSAndG9uZSc6IHJldHVybiAndG9uZSBhZGp1c3RlZCc7XG4gICAgICAgICAgICBjYXNlICdjdXN0b20nOiByZXR1cm4gJ3RyYW5zZm9ybWVkJztcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiAncHJvY2Vzc2VkJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBzdWNjZXNzIG1lc3NhZ2UgdG8gY2hhdCB1c2luZyB1bmlmaWVkIHN5c3RlbVxuICAgICAqL1xuICAgIHByaXZhdGUgYWRkU3VjY2Vzc0NoYXRNZXNzYWdlKGFjdGlvbklkOiBzdHJpbmcsIG9yaWdpbmFsVGV4dDogc3RyaW5nLCBjdXN0b21JbnN0cnVjdGlvbj86IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgYWN0aXZlIE5vdmEgc2lkZWJhciB2aWV3IGFuZCBhZGQgbWVzc2FnZSB0byBjaGF0XG4gICAgICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdub3ZhLXNpZGViYXInKTtcbiAgICAgICAgICAgIGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgYW55O1xuICAgICAgICAgICAgICAgIGlmIChzaWRlYmFyVmlldz8uY2hhdFJlbmRlcmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbkRlc2NyaXB0aW9uID0gdGhpcy5nZXRBY3Rpb25EZXNjcmlwdGlvbihhY3Rpb25JZCwgY3VzdG9tSW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRUZXh0ID0gb3JpZ2luYWxUZXh0Lmxlbmd0aCA+IDUwIFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBvcmlnaW5hbFRleHQuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nIFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBvcmlnaW5hbFRleHQ7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYFx1MjcxMyAke2FjdGlvbkRlc2NyaXB0aW9ufSB0ZXh0OiBcIiR7dHJ1bmNhdGVkVGV4dH1cImA7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdW5pZmllZCBzeXN0ZW0gd2l0aCBwZXJzaXN0ZW5jZVxuICAgICAgICAgICAgICAgICAgICBzaWRlYmFyVmlldy5jaGF0UmVuZGVyZXIuYWRkU3VjY2Vzc01lc3NhZ2UobWVzc2FnZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gYWRkIHN1Y2Nlc3MgY2hhdCBtZXNzYWdlOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBmYWlsdXJlIG1lc3NhZ2UgdG8gY2hhdCB1c2luZyB1bmlmaWVkIHN5c3RlbVxuICAgICAqL1xuICAgIHByaXZhdGUgYWRkRmFpbHVyZUNoYXRNZXNzYWdlKGFjdGlvbklkOiBzdHJpbmcsIGVycm9yTWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBhY3RpdmUgTm92YSBzaWRlYmFyIHZpZXcgYW5kIGFkZCBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ25vdmEtc2lkZWJhcicpO1xuICAgICAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBhbnk7XG4gICAgICAgICAgICAgICAgaWYgKHNpZGViYXJWaWV3Py5jaGF0UmVuZGVyZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uTmFtZSA9IHRoaXMuZ2V0QWN0aW9uRGlzcGxheU5hbWUoYWN0aW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYFx1MjcxNyBGYWlsZWQgdG8gJHthY3Rpb25OYW1lLnJlcGxhY2UoJ2VkJywgJycpfSB0ZXh0OiAke2Vycm9yTWVzc2FnZX1gO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHVuaWZpZWQgc3lzdGVtIHdpdGggcGVyc2lzdGVuY2VcbiAgICAgICAgICAgICAgICAgICAgc2lkZWJhclZpZXcuY2hhdFJlbmRlcmVyLmFkZEVycm9yTWVzc2FnZShtZXNzYWdlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBhZGQgZXJyb3IgY2hhdCBtZXNzYWdlOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBkZXRhaWxlZCBhY3Rpb24gZGVzY3JpcHRpb24gZm9yIGNoYXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkRlc2NyaXB0aW9uKGFjdGlvbklkOiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChhY3Rpb25JZCkge1xuICAgICAgICAgICAgY2FzZSAnaW1wcm92ZSc6IHJldHVybiAnSW1wcm92ZWQnO1xuICAgICAgICAgICAgY2FzZSAnbG9uZ2VyJzogcmV0dXJuICdFeHBhbmRlZCc7XG4gICAgICAgICAgICBjYXNlICdzaG9ydGVyJzogcmV0dXJuICdDb25kZW5zZWQnO1xuICAgICAgICAgICAgY2FzZSAndG9uZSc6IHJldHVybiBgQ2hhbmdlZCB0b25lIHRvICR7Y3VzdG9tSW5zdHJ1Y3Rpb24gfHwgJ2Zvcm1hbCd9YDtcbiAgICAgICAgICAgIGNhc2UgJ2N1c3RvbSc6IHJldHVybiBgQXBwbGllZCBcIiR7Y3VzdG9tSW5zdHJ1Y3Rpb259XCJgO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuICdQcm9jZXNzZWQnO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIFNlbGVjdGlvbi1iYXNlZCBlZGl0aW5nIGNvbW1hbmQgaGFuZGxlciBmb3IgTm92YVxuICogUHJvY2Vzc2VzIEFJIHRyYW5zZm9ybWF0aW9ucyBvbiBzZWxlY3RlZCB0ZXh0XG4gKi9cblxuaW1wb3J0IHsgRWRpdG9yLCBFZGl0b3JQb3NpdGlvbiwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vYWkvdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGlvbkVkaXRSZXN1bHQge1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgdHJhbnNmb3JtZWRUZXh0Pzogc3RyaW5nO1xuICAgIGVycm9yPzogc3RyaW5nO1xuICAgIG9yaWdpbmFsUmFuZ2U/OiB7XG4gICAgICAgIGZyb206IEVkaXRvclBvc2l0aW9uO1xuICAgICAgICB0bzogRWRpdG9yUG9zaXRpb247XG4gICAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIFNlbGVjdGlvbkVkaXRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbikge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBzZWxlY3Rpb24tYmFzZWQgZWRpdCBhY3Rpb25cbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGFjdGlvbjogc3RyaW5nLCBlZGl0b3I6IEVkaXRvciwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogUHJvbWlzZTxTZWxlY3Rpb25FZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgc2VsZWN0aW9uIHJhbmdlIGZvciBsYXRlciByZXBsYWNlbWVudFxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uUmFuZ2UgPSB7XG4gICAgICAgICAgICAgICAgZnJvbTogZWRpdG9yLmdldEN1cnNvcignZnJvbScpLFxuICAgICAgICAgICAgICAgIHRvOiBlZGl0b3IuZ2V0Q3Vyc29yKCd0bycpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBTaG93IGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgICAgICBjb25zdCBsb2FkaW5nTm90aWNlID0gbmV3IE5vdGljZSgnTm92YSBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4uLicsIDApO1xuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBwcm9tcHQgYmFzZWQgb24gYWN0aW9uXG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmJ1aWxkUHJvbXB0KGFjdGlvbiwgc2VsZWN0ZWRUZXh0LCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBBSSByZXNwb25zZSB1c2luZyB0aGUgcHJvdmlkZXIgbWFuYWdlclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShcbiAgICAgICAgICAgICAgICBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsb2FkaW5nTm90aWNlLmhpZGUoKTtcblxuICAgICAgICAgICAgLy8gQ2xlYW4gdXAgQUkgcmVzcG9uc2UgKHJlbW92ZSBhbnkgZXhwbGFuYXRpb24gdGV4dClcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZm9ybWVkVGV4dCA9IHRoaXMuY2xlYW5BSVJlc3BvbnNlKHJlc3BvbnNlKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkVGV4dCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFJhbmdlOiBzZWxlY3Rpb25SYW5nZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU2VsZWN0aW9uIGVkaXQgY29tbWFuZCBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBzZWxlY3Rpb24tYmFzZWQgZWRpdCBhY3Rpb24gd2l0aCBzdHJlYW1pbmdcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlU3RyZWFtaW5nKFxuICAgICAgICBhY3Rpb246IHN0cmluZywgXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLCBcbiAgICAgICAgc2VsZWN0ZWRUZXh0OiBzdHJpbmcsIFxuICAgICAgICBvbkNodW5rOiAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4gdm9pZCxcbiAgICAgICAgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPFNlbGVjdGlvbkVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBzZWxlY3Rpb24gcmFuZ2UgZm9yIGxhdGVyIHJlcGxhY2VtZW50XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25SYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHByb21wdCBiYXNlZCBvbiBhY3Rpb25cbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQoYWN0aW9uLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGV0IGZ1bGxSZXNwb25zZSA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdHJlYW0gQUkgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQudXNlclByb21wdCwge1xuICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihjaHVuay5lcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZ1bGxSZXNwb25zZSArPSBjaHVuay5jb250ZW50O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIE9ubHkgY2FsbCBvbkNodW5rIGlmIHdlIGhhdmUgY29udGVudCBvciBpZiBpdCdzIHRoZSBmaW5hbCBjaHVua1xuICAgICAgICAgICAgICAgIGlmIChmdWxsUmVzcG9uc2UudHJpbSgpLmxlbmd0aCA+IDAgfHwgY2h1bmsuZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbmVkQ2h1bmsgPSB0aGlzLmNsZWFuQUlSZXNwb25zZShmdWxsUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBvbkNodW5rKGNsZWFuZWRDaHVuaywgY2h1bmsuZG9uZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChjaHVuay5kb25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgYWN0dWFsbHkgZ290IGEgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IGZpbmFsVGV4dCA9IHRoaXMuY2xlYW5BSVJlc3BvbnNlKGZ1bGxSZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoIWZpbmFsVGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSByZXNwb25zZScsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2U6IHNlbGVjdGlvblJhbmdlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkVGV4dDogZmluYWxUZXh0LFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2U6IHNlbGVjdGlvblJhbmdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTZWxlY3Rpb24gZWRpdCBzdHJlYW1pbmcgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIHRoZSBBSSBiYXNlZCBvbiB0aGUgYWN0aW9uIHR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkUHJvbXB0KGFjdGlvbjogc3RyaW5nLCBzZWxlY3RlZFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiB7XG4gICAgICAgIHN5c3RlbVByb21wdDogc3RyaW5nO1xuICAgICAgICB1c2VyUHJvbXB0OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGJhc2VTeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIGFzc2lzdGFudC4gWW91ciB0YXNrIGlzIHRvIHRyYW5zZm9ybSB0aGUgcHJvdmlkZWQgdGV4dCBhY2NvcmRpbmcgdG8gdGhlIHVzZXIncyByZXF1ZXN0LiBcblxuQ1JJVElDQUwgUlVMRVM6XG4tIFByb3ZpZGUgT05MWSB0aGUgdHJhbnNmb3JtZWQgdGV4dCwgbm8gZXhwbGFuYXRpb25zIG9yIG1ldGEtY29tbWVudGFyeVxuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgbWVhbmluZyB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkIHRvIGNoYW5nZSBpdFxuLSBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgZm9ybWF0IChtYXJrZG93biwgc3RydWN0dXJlLCBldGMuKSB1bmxlc3MgaW5zdHJ1Y3RlZCBvdGhlcndpc2Vcbi0gRG8gbm90IGFkZCBpbnRyb2R1Y3RvcnkgcGhyYXNlcyBsaWtlIFwiSGVyZSdzIHRoZSBpbXByb3ZlZCB0ZXh0OlwiIG9yIHNpbWlsYXJcbi0gUmV0dXJuIG9ubHkgdGhlIGNvbnRlbnQgdGhhdCBzaG91bGQgcmVwbGFjZSB0aGUgc2VsZWN0ZWQgdGV4dGA7XG5cbiAgICAgICAgbGV0IHNwZWNpZmljUHJvbXB0ID0gJyc7XG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gJyc7XG5cbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2ltcHJvdmUnOlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogSW1wcm92ZSB0aGUgd3JpdGluZyBxdWFsaXR5XG4tIE1ha2UgdGhlIHRleHQgY2xlYXJlciBhbmQgbW9yZSBjb25jaXNlXG4tIEltcHJvdmUgZmxvdyBhbmQgcmVhZGFiaWxpdHlcbi0gRml4IGFueSBhd2t3YXJkIHBocmFzaW5nXG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCB0b25lIGFuZCBtZWFuaW5nYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEltcHJvdmUgdGhpcyB0ZXh0OlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2xvbmdlcic6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBFeHBhbmQgdGhlIHRleHQgd2l0aCBtb3JlIGRldGFpbFxuLSBBZGQgcmVsZXZhbnQgZXhhbXBsZXMsIGNvbnRleHQsIG9yIGV4cGxhbmF0aW9uc1xuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgc3R5bGUgYW5kIHZvaWNlXG4tIEV4cGFuZCBpZGVhcyB3aXRob3V0IGNoYW5naW5nIHRoZSBjb3JlIG1lc3NhZ2Vcbi0gTWFrZSBpdCBtb3JlIGNvbXByZWhlbnNpdmUgYW5kIGRldGFpbGVkYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYE1ha2UgdGhpcyB0ZXh0IGxvbmdlciBhbmQgbW9yZSBkZXRhaWxlZDpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdzaG9ydGVyJzpcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IENvbmRlbnNlIHRoZSB0ZXh0IHRvIGVzc2VudGlhbCBwb2ludHNcbi0gUmVtb3ZlIHJlZHVuZGFuY3kgYW5kIHVubmVjZXNzYXJ5IHdvcmRzXG4tIEtlZXAgYWxsIGtleSBpbmZvcm1hdGlvbiBhbmQgbWVhbmluZ1xuLSBNYWtlIGl0IG1vcmUgY29uY2lzZSBhbmQgZGlyZWN0XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCB0b25lYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYE1ha2UgdGhpcyB0ZXh0IHNob3J0ZXIgYW5kIG1vcmUgY29uY2lzZTpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICd0b25lJzpcbiAgICAgICAgICAgICAgICBjb25zdCB0b25lTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgICAgICAgICAgICAgICAnZm9ybWFsJzogJ3Byb2Zlc3Npb25hbCBhbmQgc3RydWN0dXJlZCwgc3VpdGFibGUgZm9yIGJ1c2luZXNzIG9yIGFjYWRlbWljIGNvbnRleHRzJyxcbiAgICAgICAgICAgICAgICAgICAgJ2Nhc3VhbCc6ICdyZWxheGVkIGFuZCBjb252ZXJzYXRpb25hbCwgc3VpdGFibGUgZm9yIGluZm9ybWFsIGNvbW11bmljYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAnYWNhZGVtaWMnOiAnc2Nob2xhcmx5IGFuZCBwcmVjaXNlLCB1c2luZyB0ZWNobmljYWwgdm9jYWJ1bGFyeSB3aGVyZSBhcHByb3ByaWF0ZScsXG4gICAgICAgICAgICAgICAgICAgICdmcmllbmRseSc6ICd3YXJtIGFuZCBhcHByb2FjaGFibGUsIGJ1aWxkaW5nIGNvbm5lY3Rpb24gd2l0aCB0aGUgcmVhZGVyJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgdG9uZURlc2NyaXB0aW9uID0gdG9uZU1hcFtjdXN0b21JbnN0cnVjdGlvbiB8fCAnZm9ybWFsJ10gfHwgdG9uZU1hcC5mb3JtYWw7XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBDaGFuZ2UgdGhlIHRvbmUgdG8gYmUgJHt0b25lRGVzY3JpcHRpb259XG4tIEFkanVzdCBsYW5ndWFnZSBhbmQgdm9jYWJ1bGFyeSB0byBtYXRjaCB0aGUgcmVxdWVzdGVkIHRvbmVcbi0gS2VlcCB0aGUgc2FtZSBjb250ZW50IGFuZCBtZWFuaW5nXG4tIE1haW50YWluIGFwcHJvcHJpYXRlIGZvcm1hbGl0eSBsZXZlbCBmb3IgdGhlIGNob3NlbiB0b25lYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYFJld3JpdGUgdGhpcyB0ZXh0IGluIGEgJHtjdXN0b21JbnN0cnVjdGlvbiB8fCAnZm9ybWFsJ30gdG9uZTpcXG5cXG4ke3NlbGVjdGVkVGV4dH1gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdjdXN0b20nOlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogQXBwbHkgY3VzdG9tIHRyYW5zZm9ybWF0aW9uXG4tIEZvbGxvdyB0aGUgdXNlcidzIHNwZWNpZmljIGluc3RydWN0aW9uIGV4YWN0bHlcbi0gTWFpbnRhaW4gY29udGVudCBpbnRlZ3JpdHkgdW5sZXNzIGFza2VkIHRvIGNoYW5nZSBpdFxuLSBBcHBseSB0aGUgcmVxdWVzdGVkIGNoYW5nZXMgcHJlY2lzZWx5YDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEFwcGx5IHRoaXMgaW5zdHJ1Y3Rpb24gdG8gdGhlIHRleHQ6IFwiJHtjdXN0b21JbnN0cnVjdGlvbn1cIlxcblxcblRleHQgdG8gdHJhbnNmb3JtOlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBHZW5lcmFsIHRleHQgaW1wcm92ZW1lbnRcbi0gRW5oYW5jZSBjbGFyaXR5IGFuZCByZWFkYWJpbGl0eVxuLSBQcmVzZXJ2ZSBvcmlnaW5hbCBtZWFuaW5nIGFuZCB0b25lYDtcbiAgICAgICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEltcHJvdmUgdGhpcyB0ZXh0OlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBiYXNlU3lzdGVtUHJvbXB0ICsgJ1xcbicgKyBzcGVjaWZpY1Byb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHRcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiBBSSByZXNwb25zZSB0byBleHRyYWN0IG9ubHkgdGhlIHRyYW5zZm9ybWVkIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGNsZWFuQUlSZXNwb25zZShyZXNwb25zZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gUmVtb3ZlIGNvbW1vbiBBSSByZXNwb25zZSBwYXR0ZXJuc1xuICAgICAgICBsZXQgY2xlYW5lZCA9IHJlc3BvbnNlLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBpbnRyb2R1Y3RvcnkgcGhyYXNlc1xuICAgICAgICBjb25zdCBpbnRyb1BhdHRlcm5zID0gW1xuICAgICAgICAgICAgL15IZXJlJ3MgdGhlIGltcHJvdmVkIHRleHQ6P1xccyovaSxcbiAgICAgICAgICAgIC9eSGVyZSdzIHRoZSByZXdyaXR0ZW4gdGV4dDo/XFxzKi9pLFxuICAgICAgICAgICAgL15IZXJlJ3MgdGhlIHRyYW5zZm9ybWVkIHRleHQ6P1xccyovaSxcbiAgICAgICAgICAgIC9eSW1wcm92ZWQgdmVyc2lvbjo/XFxzKi9pLFxuICAgICAgICAgICAgL15SZXdyaXR0ZW46P1xccyovaSxcbiAgICAgICAgICAgIC9eUmVzdWx0Oj9cXHMqL2ksXG4gICAgICAgICAgICAvXk91dHB1dDo/XFxzKi9pXG4gICAgICAgIF07XG5cbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGludHJvUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UocGF0dGVybiwgJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIHRyYWlsaW5nIGV4cGxhbmF0aW9ucyAodGV4dCBhZnRlciBcIi0tLVwiIG9yIHNpbWlsYXIgcGF0dGVybnMpXG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnNwbGl0KC9cXG5cXHMqLS0tK1xccyovKS5zaGlmdCgpIHx8IGNsZWFuZWQ7XG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnNwbGl0KC9cXG5cXHMqXFwqXFwqP0V4cGxhbmF0aW9uXFwqP1xcKj86L2kpLnNoaWZ0KCkgfHwgY2xlYW5lZDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjbGVhbmVkLnRyaW0oKTtcbiAgICB9XG59IiwgIi8qKlxuICogTmF0aXZlIHRvbmUgc2VsZWN0aW9uIG1vZGFsIGZvciBOb3ZhIHVzaW5nIE9ic2lkaWFuJ3MgRnV6enlTdWdnZXN0TW9kYWxcbiAqIFByb3ZpZGVzIGNvbnNpc3RlbnQgVVggd2l0aCBjb3JlIE9ic2lkaWFuIGZlYXR1cmVzXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBGdXp6eVN1Z2dlc3RNb2RhbCwgRnV6enlNYXRjaCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBUb25lT3B0aW9uIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IFRPTkVfT1BUSU9OUzogVG9uZU9wdGlvbltdID0gW1xuICAgIHtcbiAgICAgICAgaWQ6ICdmb3JtYWwnLFxuICAgICAgICBsYWJlbDogJ0Zvcm1hbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUHJvZmVzc2lvbmFsLCBzdHJ1Y3R1cmVkIGxhbmd1YWdlIHN1aXRhYmxlIGZvciBidXNpbmVzcyBvciBhY2FkZW1pYyBjb250ZXh0cydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdjYXN1YWwnLFxuICAgICAgICBsYWJlbDogJ0Nhc3VhbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUmVsYXhlZCwgY29udmVyc2F0aW9uYWwgdG9uZSBmb3IgaW5mb3JtYWwgY29tbXVuaWNhdGlvbidcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdhY2FkZW1pYycsXG4gICAgICAgIGxhYmVsOiAnQWNhZGVtaWMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1NjaG9sYXJseSwgcHJlY2lzZSBsYW5ndWFnZSB3aXRoIHRlY2huaWNhbCB2b2NhYnVsYXJ5J1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2ZyaWVuZGx5JyxcbiAgICAgICAgbGFiZWw6ICdGcmllbmRseScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnV2FybSwgYXBwcm9hY2hhYmxlIHRvbmUgdGhhdCBidWlsZHMgY29ubmVjdGlvbidcbiAgICB9XG5dO1xuXG5leHBvcnQgY2xhc3MgVG9uZVNlbGVjdGlvbk1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VG9uZU9wdGlvbj4ge1xuICAgIHByaXZhdGUgb25TZWxlY3Q6ICh0b25lOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgcHJpdmF0ZSBvbkNhbmNlbDogKCkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhcHA6IEFwcCxcbiAgICAgICAgb25TZWxlY3Q6ICh0b25lOiBzdHJpbmcpID0+IHZvaWQsXG4gICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB2b2lkXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMub25TZWxlY3QgPSBvblNlbGVjdDtcbiAgICAgICAgdGhpcy5vbkNhbmNlbCA9IG9uQ2FuY2VsO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IHBsYWNlaG9sZGVyIHRleHRcbiAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcignQ2hvb3NlIGEgd3JpdGluZyB0b25lLi4uJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgaW5zdHJ1Y3Rpb25cbiAgICAgICAgdGhpcy5zZXRJbnN0cnVjdGlvbnMoW1xuICAgICAgICAgICAgeyBjb21tYW5kOiAnXHUyMTkxXHUyMTkzJywgcHVycG9zZTogJ3RvIG5hdmlnYXRlJyB9LFxuICAgICAgICAgICAgeyBjb21tYW5kOiAnXHUyMUI1JywgcHVycG9zZTogJ3RvIGFwcGx5IHRvbmUnIH0sXG4gICAgICAgICAgICB7IGNvbW1hbmQ6ICdlc2MnLCBwdXJwb3NlOiAndG8gY2FuY2VsJyB9XG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIGdldEl0ZW1zKCk6IFRvbmVPcHRpb25bXSB7XG4gICAgICAgIHJldHVybiBUT05FX09QVElPTlM7XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQodG9uZTogVG9uZU9wdGlvbik6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHt0b25lLmxhYmVsfSAtICR7dG9uZS5kZXNjcmlwdGlvbn1gO1xuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbSh0b25lOiBUb25lT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMub25TZWxlY3QodG9uZS5pZCk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gSWYgbm8gc2VsZWN0aW9uIHdhcyBtYWRlLCBjYWxsIG9uQ2FuY2VsXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBpZiAoY29udGVudEVsLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMub25DYW5jZWwoKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBOYXRpdmUgY3VzdG9tIGluc3RydWN0aW9uIG1vZGFsIGZvciBOb3ZhIHVzaW5nIE9ic2lkaWFuJ3MgTW9kYWwgY2xhc3NcbiAqIFNpbXBsaWZpZWQgZGVzaWduIGZvbGxvd2luZyBPYnNpZGlhbidzIG5hdGl2ZSBwYXR0ZXJuc1xuICovXG5cbmltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBDdXN0b21JbnN0cnVjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgaW5zdHJ1Y3Rpb246IHN0cmluZyA9ICcnO1xuICAgIHByaXZhdGUgb25TdWJtaXQ6IChpbnN0cnVjdGlvbjogc3RyaW5nKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgb25DYW5jZWw6ICgpID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIG9uU3VibWl0OiAoaW5zdHJ1Y3Rpb246IHN0cmluZykgPT4gdm9pZCxcbiAgICAgICAgb25DYW5jZWw6ICgpID0+IHZvaWRcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xuICAgICAgICB0aGlzLm9uQ2FuY2VsID0gb25DYW5jZWw7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBVc2UgbmF0aXZlIG1vZGFsIHN0eWxpbmdcbiAgICAgICAgdGhpcy5tb2RhbEVsLmFkZENsYXNzKCdub3ZhLWN1c3RvbS1pbnN0cnVjdGlvbi1tb2RhbCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gVGl0bGVcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1RlbGwgTm92YScgfSk7XG5cbiAgICAgICAgLy8gRGVzY3JpcHRpb25cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0luc3RydWN0aW9uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdEZXNjcmliZSBob3cgeW91IHdhbnQgTm92YSB0byB0cmFuc2Zvcm0geW91ciBzZWxlY3RlZCB0ZXh0Jyk7XG5cbiAgICAgICAgLy8gVGV4dCBhcmVhIHVzaW5nIFNldHRpbmcgY29tcG9uZW50IGZvciBjb25zaXN0ZW50IHN0eWxpbmdcbiAgICAgICAgY29uc3QgdGV4dEFyZWFTZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdlLmcuLCBcIm1ha2UgdGhpcyBtb3JlIHBlcnN1YXNpdmVcIiwgXCJhZGQgc3RhdGlzdGljc1wiLCBcIndyaXRlIGluIGJ1bGxldCBwb2ludHNcIicpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLmluc3RydWN0aW9uKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnN0cnVjdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHRoZSB0ZXh0IGFyZWEgbGFyZ2VyXG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUubWluSGVpZ2h0ID0gJzEwMHB4JztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBGb2N1cyBvbiB0aGUgdGV4dCBhcmVhXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0ZXh0LmlucHV0RWwuZm9jdXMoKSwgNTApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBDdHJsL0NtZCtFbnRlciB0byBzdWJtaXRcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gSGlkZSB0aGUgc2V0dGluZyBuYW1lL2Rlc2NyaXB0aW9uIGFyZWEgdG8gZ2l2ZSBmdWxsIHdpZHRoIHRvIHRleHRhcmVhXG4gICAgICAgIHRleHRBcmVhU2V0dGluZy5zZXR0aW5nRWwuc3R5bGUuYm9yZGVyID0gJ25vbmUnO1xuICAgICAgICB0ZXh0QXJlYVNldHRpbmcuc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5nLWl0ZW0taW5mbycpPy5yZW1vdmUoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1ha2UgdGhlIGNvbnRyb2wgdGFrZSBmdWxsIHdpZHRoXG4gICAgICAgIGNvbnN0IGNvbnRyb2wgPSB0ZXh0QXJlYVNldHRpbmcuc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5nLWl0ZW0tY29udHJvbCcpO1xuICAgICAgICBpZiAoY29udHJvbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICBjb250cm9sLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQnV0dG9ucyB1c2luZyBTZXR0aW5nIGNvbXBvbmVudFxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQ2FuY2VsJylcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1RyYW5zZm9ybSBUZXh0JylcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB0aGlzLnN1Ym1pdCgpKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdWJtaXQoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmluc3RydWN0aW9uLnRyaW0oKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLmluc3RydWN0aW9uLnRyaW0oKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIENsYXVkZVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnQ2xhdWRlIChBbnRocm9waWMpJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0Qm9keSA9IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbCB8fCAnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnLFxuXHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdHN5c3RlbTogb3B0aW9ucz8uc3lzdGVtUHJvbXB0LFxuXHRcdFx0bWVzc2FnZXM6IG1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcblx0XHRcdFx0cm9sZTogbXNnLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ2Fzc2lzdGFudCcgOiAndXNlcicsXG5cdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHR9KSlcblx0XHR9KTtcblxuXHRcdC8vIFJldHJ5IGxvZ2ljIGZvciA1MDAtbGV2ZWwgZXJyb3JzXG5cdFx0Y29uc3QgbWF4UmV0cmllcyA9IDM7XG5cdFx0Y29uc3QgYmFzZURlbGF5ID0gMTAwMDsgLy8gMSBzZWNvbmRcblxuXHRcdGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcblx0XHRcdFx0XHR1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcblx0XHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdFx0J3gtYXBpLWtleSc6IHRoaXMuY29uZmlnLmFwaUtleSxcblx0XHRcdFx0XHRcdCdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Ym9keTogcmVxdWVzdEJvZHlcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb247XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGEuY29udGVudFswXS50ZXh0O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIDUwMC1sZXZlbCBlcnJvciB0aGF0IHdlIHNob3VsZCByZXRyeVxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCAmJiBhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gUmV0cnlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvciBhbGwgb3RoZXIgZXJyb3JzIG9yIGZpbmFsIGF0dGVtcHQsIHRocm93IGVycm9yXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2xhdWRlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtyZXNwb25zZS50ZXh0fWApO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBOZXR3b3JrL2Nvbm5lY3Rpb24gZXJyb3JzIC0gcmV0cnkgaWYgbm90IGZpbmFsIGF0dGVtcHRcblx0XHRcdFx0aWYgKGF0dGVtcHQgPCBtYXhSZXRyaWVzICYmIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgKFxuXHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ05ldHdvcmsgZXJyb3InKSB8fCBcblx0XHRcdFx0XHRlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdGYWlsZWQgdG8gY29ubmVjdCcpXG5cdFx0XHRcdCkpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZS10aHJvdyB0aGUgZXJyb3IgaWYgaXQncyB0aGUgZmluYWwgYXR0ZW1wdCBvciBub3QgYSByZXRyeWFibGUgZXJyb3Jcblx0XHRcdFx0aWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5zdGFydHNXaXRoKCdDbGF1ZGUgQVBJIGVycm9yOicpKSB7XG5cdFx0XHRcdFx0dGhyb3cgZXJyb3I7IC8vIEFscmVhZHkgZm9ybWF0dGVkIGVycm9yXG5cdFx0XHRcdH1cblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBDbGF1ZGUgQVBJOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ05ldHdvcmsgZXJyb3InfWApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWQsIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIGl0XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJOiBNYXhpbXVtIHJldHJpZXMgZXhjZWVkZWQnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfV07XG5cdFx0Y29uc3QgY29tcGxldGVPcHRpb25zID0geyAuLi5vcHRpb25zLCBzeXN0ZW1Qcm9tcHQgfTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgY29tcGxldGVPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdC8vIEdldCB0aGUgZnVsbCByZXNwb25zZSBmcm9tIENsYXVkZSwgdGhlbiBzaW11bGF0ZSBzdHJlYW1pbmcgd2l0aCBjb25zaXN0ZW50IGNodW5raW5nXG5cdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdFx0XG5cdFx0Ly8gU3BsaXQgcmVzdWx0IGludG8gc21hbGxlciBjaHVua3MgZm9yIGNvbnNpc3RlbnQgdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRjb25zdCBjaHVua1NpemUgPSAzOyAvLyBDaGFyYWN0ZXJzIHBlciBjaHVua1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSArPSBjaHVua1NpemUpIHtcblx0XHRcdGNvbnN0IGNodW5rID0gcmVzdWx0LnNsaWNlKGksIGkgKyBjaHVua1NpemUpO1xuXHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gY2h1bmtzIHRvIGNyZWF0ZSBzbW9vdGggdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMCkpO1xuXHRcdH1cblx0XHRcblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHQvKipcblx0ICogRmV0Y2ggYXZhaWxhYmxlIG1vZGVscyBmcm9tIENsYXVkZSBBUElcblx0ICovXG5cdGFzeW5jIGdldEF2YWlsYWJsZU1vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignQ2xhdWRlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtb2RlbHMsIHJldHVybiB0aGVtXG5cdFx0aWYgKHRoaXMuY2FjaGVkTW9kZWxzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jYWNoZWRNb2RlbHM7XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIENsYXVkZSwgd2UnbGwgdXNlIGEgaGFyZGNvZGVkIGxpc3Qgc2luY2UgQW50aHJvcGljIGRvZXNuJ3QgcHJvdmlkZSBhIG1vZGVscyBlbmRwb2ludFxuXHRcdC8vIEJ1dCB3ZSBjYW4gdmFsaWRhdGUgdGhlIEFQSSBrZXkgYnkgbWFraW5nIGEgdGVzdCBjYWxsXG5cdFx0dHJ5IHtcblx0XHRcdC8vIFZhbGlkYXRlIEFQSSBrZXkgd2l0aCBhIG1pbmltYWwgcmVxdWVzdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcblx0XHRcdFx0dXJsOiAnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsXG5cdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHRcdCdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdFx0bW9kZWw6ICdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCcsXG5cdFx0XHRcdFx0bWF4X3Rva2VuczogMSxcblx0XHRcdFx0XHRtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiAndGVzdCcgfV1cblx0XHRcdFx0fSlcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkga2V5IHZhbGlkYXRpb24gZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gLSAke3Jlc3BvbnNlLnRleHR9YCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJldHVybiBjdXJyZW50IGF2YWlsYWJsZSBtb2RlbHMgKGZyb20gQVBJIGRvY3MpXG5cdFx0XHRjb25zdCBtb2RlbHMgPSBbXG5cdFx0XHRcdCdjbGF1ZGUtb3B1cy00LTIwMjUwNTE0Jyxcblx0XHRcdFx0J2NsYXVkZS1zb25uZXQtNC0yMDI1MDUxNCcsXG5cdFx0XHRcdCdjbGF1ZGUtMy03LXNvbm5ldC1sYXRlc3QnLFxuXHRcdFx0XHQnY2xhdWRlLTMtNS1zb25uZXQtbGF0ZXN0Jyxcblx0XHRcdFx0J2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0J1xuXHRcdFx0XTtcblxuXHRcdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBtb2RlbHM7XG5cdFx0XHRyZXR1cm4gbW9kZWxzO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBDbGF1ZGUgbW9kZWxzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBjYWNoZWQgbW9kZWxzXG5cdCAqL1xuXHRjbGVhck1vZGVsQ2FjaGUoKTogdm9pZCB7XG5cdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBudWxsO1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPcGVuQUlQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ09wZW5BSSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblx0cHJpdmF0ZSBjYWNoZWRNb2RlbHM6IHN0cmluZ1tdIHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRpZiAob3B0aW9ucz8uc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRyZXF1ZXN0TWVzc2FnZXMudW5zaGlmdCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBvcHRpb25zLnN5c3RlbVByb21wdCB9KTtcblx0XHR9XG5cblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSc7XG5cdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvY2hhdC9jb21wbGV0aW9ucycpID8gYmFzZVVybCA6IGAke2Jhc2VVcmx9L2NoYXQvY29tcGxldGlvbnNgO1xuXHRcdFxuXHRcdGNvbnN0IHJlcXVlc3RCb2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdncHQtMy41LXR1cmJvJyxcblx0XHRcdG1lc3NhZ2VzOiByZXF1ZXN0TWVzc2FnZXMsXG5cdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43XG5cdFx0fSk7XG5cblx0XHQvLyBSZXRyeSBsb2dpYyBmb3IgNTAwLWxldmVsIGVycm9yc1xuXHRcdGNvbnN0IG1heFJldHJpZXMgPSAzO1xuXHRcdGNvbnN0IGJhc2VEZWxheSA9IDEwMDA7IC8vIDEgc2Vjb25kXG5cblx0XHRmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8PSBtYXhSZXRyaWVzOyBhdHRlbXB0KyspIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcblx0XHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGJvZHk6IHJlcXVlc3RCb2R5XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChyZXNwb25zZS5vaykge1xuXHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgNTAwLWxldmVsIGVycm9yIHRoYXQgd2Ugc2hvdWxkIHJldHJ5XG5cdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPj0gNTAwICYmIGF0dGVtcHQgPCBtYXhSZXRyaWVzKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTsgLy8gRXhwb25lbnRpYWwgYmFja29mZlxuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlOyAvLyBSZXRyeVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRm9yIGFsbCBvdGhlciBlcnJvcnMgb3IgZmluYWwgYXR0ZW1wdCwgdGhyb3cgZXJyb3Jcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIE5ldHdvcmsgZXJyb3JzIC0gcmV0cnkgaWYgbm90IGZpbmFsIGF0dGVtcHRcblx0XHRcdFx0aWYgKGF0dGVtcHQgPCBtYXhSZXRyaWVzICYmIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnZmV0Y2gnKSkge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7XG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIFJlLXRocm93IHRoZSBlcnJvciBpZiBpdCdzIHRoZSBmaW5hbCBhdHRlbXB0IG9yIG5vdCBhIG5ldHdvcmsgZXJyb3Jcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gVGhpcyBzaG91bGQgbmV2ZXIgYmUgcmVhY2hlZCwgYnV0IFR5cGVTY3JpcHQgd2FudHMgaXRcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEk6IE1heGltdW0gcmV0cmllcyBleGNlZWRlZCcpO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtcblx0XHRcdHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuXHRcdFx0eyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHVzZXJQcm9tcHQgfVxuXHRcdF07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9jaGF0L2NvbXBsZXRpb25zJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2A7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0XHRtZXNzYWdlczogcmVxdWVzdE1lc3NhZ2VzLFxuXHRcdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDAsXG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdHN0cmVhbTogdHJ1ZVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXHRcdGxldCBidWZmZXIgPSAnJztcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0Y29uc3QgbGluZXMgPSBidWZmZXIuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJztcblxuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGF0YSA9IGxpbmUuc2xpY2UoNik7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YSA9PT0gJ1tET05FXScpIHtcblx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBwYXJzZWQuY2hvaWNlcz8uWzBdPy5kZWx0YT8uY29udGVudDtcblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBTcGxpdCBjb250ZW50IGludG8gc21hbGxlciBjaHVua3MgZm9yIGNvbnNpc3RlbnQgdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVua1NpemUgPSAzOyAvLyBDaGFyYWN0ZXJzIHBlciBjaHVua1xuXHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY29udGVudC5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVuayA9IGNvbnRlbnQuc2xpY2UoaSwgaSArIGNodW5rU2l6ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IGNodW5rLCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgYmV0d2VlbiBjaHVua3MgdG8gY3JlYXRlIHNtb290aCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwKSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEZldGNoIGF2YWlsYWJsZSBtb2RlbHMgZnJvbSBPcGVuQUkgQVBJXG5cdCAqL1xuXHRhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgd2UgaGF2ZSBjYWNoZWQgbW9kZWxzLCByZXR1cm4gdGhlbVxuXHRcdGlmICh0aGlzLmNhY2hlZE1vZGVscykge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2FjaGVkTW9kZWxzO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSc7XG5cdFx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9tb2RlbHMnKSA/IGJhc2VVcmwgOiBgJHtiYXNlVXJsfS9tb2RlbHNgO1xuXHRcdFx0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZXR1cm4gaGFyZGNvZGVkIGN1cnJlbnQgbW9kZWxzXG5cdFx0XHRjb25zdCBtb2RlbHMgPSBbXG5cdFx0XHRcdCdncHQtNC4xLTIwMjUtMDQtMTQnLFxuXHRcdFx0XHQnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnLFxuXHRcdFx0XHQnZ3B0LTQuMS1uYW5vLTIwMjUtMDQtMTQnLFxuXHRcdFx0XHQnZ3B0LTRvJyxcblx0XHRcdFx0J2dwdC00by1taW5pJ1xuXHRcdFx0XTtcblxuXHRcdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBtb2RlbHM7XG5cdFx0XHRyZXR1cm4gbW9kZWxzO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBPcGVuQUkgbW9kZWxzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBjYWNoZWQgbW9kZWxzXG5cdCAqL1xuXHRjbGVhck1vZGVsQ2FjaGUoKTogdm9pZCB7XG5cdFx0dGhpcy5jYWNoZWRNb2RlbHMgPSBudWxsO1xuXHR9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBHb29nbGVQcm92aWRlciBpbXBsZW1lbnRzIEFJUHJvdmlkZXIge1xuXHRuYW1lID0gJ0dvb2dsZSAoR2VtaW5pKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblx0cHJpdmF0ZSBjYWNoZWRNb2RlbHM6IHN0cmluZ1tdIHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0dXBkYXRlQ29uZmlnKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiAhIXRoaXMuY29uZmlnLmFwaUtleTtcblx0fVxuXG5cdGFzeW5jIGdlbmVyYXRlVGV4dChwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dO1xuXHRcdHlpZWxkKiB0aGlzLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdHByaXZhdGUgZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXM6IEFJTWVzc2FnZVtdKTogYW55IHtcblx0XHRjb25zdCBjb250ZW50cyA9IFtdO1xuXG5cdFx0Zm9yIChjb25zdCBtZXNzYWdlIG9mIG1lc3NhZ2VzKSB7XG5cdFx0XHRjb25zdCByb2xlID0gbWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50JyA/ICdtb2RlbCcgOiAndXNlcic7XG5cdFx0XHRjb250ZW50cy5wdXNoKHtcblx0XHRcdFx0cm9sZSxcblx0XHRcdFx0cGFydHM6IFt7IHRleHQ6IG1lc3NhZ2UuY29udGVudCB9XVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gRW5zdXJlIHdlIGhhdmUgYXQgbGVhc3Qgb25lIG1lc3NhZ2Vcblx0XHRpZiAoY29udGVudHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vIG1lc3NhZ2VzIHByb3ZpZGVkIGZvciBHb29nbGUgQVBJJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbnRlbnRzO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBVc2UgYSBuZXdlciBtb2RlbCBieSBkZWZhdWx0IGlmIG5vIG1vZGVsIGlzIHNwZWNpZmllZFxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblx0XHRcblxuXHRcdGNvbnN0IHJlcXVlc3RCb2R5OiBhbnkgPSB7XG5cdFx0XHRjb250ZW50czogdGhpcy5mb3JtYXRNZXNzYWdlc0ZvckdlbWluaShtZXNzYWdlcyksXG5cdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSB8fCB0aGlzLmNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG5cdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIEFkZCBzeXN0ZW0gaW5zdHJ1Y3Rpb24gaWYgcHJvdmlkZWQgKEdvb2dsZSdzIHByb3BlciBmb3JtYXQpXG5cdFx0aWYgKG9wdGlvbnM/LnN5c3RlbVByb21wdCAmJiBvcHRpb25zLnN5c3RlbVByb21wdC50cmltKCkpIHtcblx0XHRcdHJlcXVlc3RCb2R5LnN5c3RlbUluc3RydWN0aW9uID0ge1xuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogb3B0aW9ucy5zeXN0ZW1Qcm9tcHQgfV1cblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHRjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG5cdFx0XHRsZXQgZXJyb3JNZXNzYWdlID0gJyc7XG5cdFx0XHRcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IGVycm9yRGF0YSA9IEpTT04ucGFyc2UoZXJyb3JUZXh0KTtcblx0XHRcdFx0aWYgKGVycm9yRGF0YS5lcnJvcikge1xuXHRcdFx0XHRcdC8vIEZvcm1hdCBhcyBbQ09ERV06IG1lc3NhZ2Vcblx0XHRcdFx0XHRjb25zdCBjb2RlID0gZXJyb3JEYXRhLmVycm9yLmNvZGUgfHwgcmVzcG9uc2Uuc3RhdHVzO1xuXHRcdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSBlcnJvckRhdGEuZXJyb3IubWVzc2FnZSB8fCBlcnJvckRhdGEuZXJyb3Iuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1c1RleHQ7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske2NvZGV9XTogJHttZXNzYWdlfWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gQWRkIHNwZWNpZmljIGd1aWRhbmNlIGZvciBjb21tb24gZXJyb3JzXG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKSB7XG5cdFx0XHRcdFx0XHRlcnJvck1lc3NhZ2UgKz0gJyAoQ2hlY2sgcmVxdWVzdCBmb3JtYXQgb3IgbW9kZWwgbmFtZSknO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblx0XHRcdFx0XHRcdGVycm9yTWVzc2FnZSArPSAnIChDaGVjayBBUEkga2V5IGluIHNldHRpbmdzKSc7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuXHRcdFx0XHRcdFx0ZXJyb3JNZXNzYWdlICs9ICcgKE1vZGVsIG1heSBub3QgYmUgYXZhaWxhYmxlKSc7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQyOSkge1xuXHRcdFx0XHRcdFx0ZXJyb3JNZXNzYWdlICs9ICcgKFJhdGUgbGltaXQgZXhjZWVkZWQpJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske3Jlc3BvbnNlLnN0YXR1c31dOiAke2Vycm9yVGV4dH1gO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtyZXNwb25zZS5zdGF0dXN9XTogJHtlcnJvclRleHQgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dH1gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBMb2cgZGV0YWlsZWQgZXJyb3IgZm9yIGRlYnVnZ2luZ1xuXHRcdFx0Y29uc29sZS5lcnJvcignR29vZ2xlIEFQSSBFcnJvciBEZXRhaWxzOicsIHtcblx0XHRcdFx0c3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG5cdFx0XHRcdHN0YXR1c1RleHQ6IHJlc3BvbnNlLnN0YXR1c1RleHQsXG5cdFx0XHRcdGVycm9yVGV4dDogZXJyb3JUZXh0LFxuXHRcdFx0XHRyZXF1ZXN0Qm9keTogcmVxdWVzdEJvZHksXG5cdFx0XHRcdG1vZGVsOiBtb2RlbCxcblx0XHRcdFx0dXJsOiB1cmxcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3IgJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcblx0XHRcblx0XHQvLyBDaGVjayBpZiByZXNwb25zZSBoYXMgdmFsaWQgc3RydWN0dXJlXG5cdFx0aWYgKCFkYXRhLmNhbmRpZGF0ZXMgfHwgZGF0YS5jYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhbiBlcnJvciBtZXNzYWdlIGluIHRoZSByZXNwb25zZVxuXHRcdFx0aWYgKGRhdGEuZXJyb3IpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke2RhdGEuZXJyb3IubWVzc2FnZSB8fCBKU09OLnN0cmluZ2lmeShkYXRhLmVycm9yKX1gKTtcblx0XHRcdH1cblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBubyBjYW5kaWRhdGVzJyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRoZSByZXNwb25zZSB3YXMgYmxvY2tlZCBvciBmaWx0ZXJlZFxuXHRcdGlmIChkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnU0FGRVRZJyB8fCBkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnQkxPQ0tFRCcpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBibG9ja2VkIHRoZSByZXNwb25zZSBkdWUgdG8gc2FmZXR5IGZpbHRlcnMnKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgd2UgaGl0IHRoZSB0b2tlbiBsaW1pdCBiZWZvcmUgZ2VuZXJhdGluZyBjb250ZW50XG5cdFx0aWYgKGRhdGEuY2FuZGlkYXRlc1swXS5maW5pc2hSZWFzb24gPT09ICdNQVhfVE9LRU5TJyAmJiBcblx0XHQgICAgKCFkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudCB8fCAhZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMgfHwgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMubGVuZ3RoID09PSAwKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdBUEkgaGl0IHRva2VuIGxpbWl0IGJlZm9yZSBnZW5lcmF0aW5nIGFueSBjb250ZW50LiBQbGVhc2UgaW5jcmVhc2UgXCJEZWZhdWx0IE1heCBUb2tlbnNcIiBpbiBzZXR0aW5ncy4nKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgcmVzcG9uc2UgaGFzIGNvbnRlbnRcblx0XHRpZiAoZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQgJiYgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMgJiYgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgdGV4dCA9IGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG5cdFx0XHRcblx0XHRcdFxuXHRcdFx0Ly8gSWYgcmVzcG9uc2Ugd2FzIHRydW5jYXRlZCwgdGhyb3cgZXJyb3IgaW5zdGVhZCBvZiByZXR1cm5pbmcgcGFydGlhbCBjb250ZW50XG5cdFx0XHRpZiAoZGF0YS5jYW5kaWRhdGVzWzBdLmZpbmlzaFJlYXNvbiA9PT0gJ01BWF9UT0tFTlMnKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignUmVzcG9uc2Ugd2FzIHRydW5jYXRlZCBkdWUgdG8gdG9rZW4gbGltaXQuIFBsZWFzZSBpbmNyZWFzZSBcIkRlZmF1bHQgTWF4IFRva2Vuc1wiIGluIHNldHRpbmdzLicpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhY3R1YWwgdGV4dCBjb250ZW50XG5cdFx0XHRpZiAoIXRleHQgfHwgdGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0dvb2dsZSBBUEkgcmV0dXJuZWQgZW1wdHkgdGV4dCBjb250ZW50Jyk7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBlbXB0eSB0ZXh0IGNvbnRlbnQnKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRleHQ7XG5cdFx0fVxuXHRcdFxuXHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBlbXB0eSByZXNwb25zZScpO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBVc2UgYSBuZXdlciBtb2RlbCBieSBkZWZhdWx0IGlmIG5vIG1vZGVsIGlzIHNwZWNpZmllZFxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OnN0cmVhbUdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2VucyB8fCB0aGlzLmNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuXHRcdFx0XHR9LFxuXHRcdFx0XHQuLi4ob3B0aW9ucz8uc3lzdGVtUHJvbXB0ICYmIG9wdGlvbnMuc3lzdGVtUHJvbXB0LnRyaW0oKSA/IHtcblx0XHRcdFx0XHRzeXN0ZW1JbnN0cnVjdGlvbjoge1xuXHRcdFx0XHRcdFx0cGFydHM6IFt7IHRleHQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH1dXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IDoge30pXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0Y29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXHRcdFx0bGV0IGVycm9yTWVzc2FnZSA9ICcnO1xuXHRcdFx0XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBlcnJvckRhdGEgPSBKU09OLnBhcnNlKGVycm9yVGV4dCk7XG5cdFx0XHRcdGlmIChlcnJvckRhdGEuZXJyb3IpIHtcblx0XHRcdFx0XHRjb25zdCBjb2RlID0gZXJyb3JEYXRhLmVycm9yLmNvZGUgfHwgcmVzcG9uc2Uuc3RhdHVzO1xuXHRcdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSBlcnJvckRhdGEuZXJyb3IubWVzc2FnZSB8fCBlcnJvckRhdGEuZXJyb3Iuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1c1RleHQ7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske2NvZGV9XTogJHttZXNzYWdlfWA7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske3Jlc3BvbnNlLnN0YXR1c31dOiAke2Vycm9yVGV4dH1gO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtyZXNwb25zZS5zdGF0dXN9XTogJHtlcnJvclRleHQgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dH1gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3IgJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXHRcdGxldCBqc29uQnVmZmVyID0gJyc7XG5cdFx0bGV0IGJyYWNlQ291bnQgPSAwO1xuXHRcdGxldCBpbkpzb24gPSBmYWxzZTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFByb2Nlc3MgY2hhcmFjdGVyIGJ5IGNoYXJhY3RlciB0byBwcm9wZXJseSBwYXJzZSB0aGUgc3RyZWFtaW5nIEpTT05cblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRjb25zdCBjaGFyID0gYnVmZmVyW2ldO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChjaGFyID09PSAneycpIHtcblx0XHRcdFx0XHRcdGlmICghaW5Kc29uKSB7XG5cdFx0XHRcdFx0XHRcdGluSnNvbiA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGpzb25CdWZmZXIgPSAnJztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyYWNlQ291bnQrKztcblx0XHRcdFx0XHRcdGpzb25CdWZmZXIgKz0gY2hhcjtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGNoYXIgPT09ICd9Jykge1xuXHRcdFx0XHRcdFx0anNvbkJ1ZmZlciArPSBjaGFyO1xuXHRcdFx0XHRcdFx0YnJhY2VDb3VudC0tO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAoYnJhY2VDb3VudCA9PT0gMCAmJiBpbkpzb24pIHtcblx0XHRcdFx0XHRcdFx0Ly8gV2UgaGF2ZSBhIGNvbXBsZXRlIEpTT04gb2JqZWN0XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uQnVmZmVyKTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCB0ZXh0ID0gcGFyc2VkLmNhbmRpZGF0ZXM/LlswXT8uY29udGVudD8ucGFydHM/LlswXT8udGV4dDtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGV4dCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgdGV4dCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNodW5rID0gdGV4dC5zbGljZShpLCBpICsgY2h1bmtTaXplKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgYmV0d2VlbiBjaHVua3MgdG8gY3JlYXRlIHNtb290aCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjApKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdGluSnNvbiA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRqc29uQnVmZmVyID0gJyc7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChpbkpzb24pIHtcblx0XHRcdFx0XHRcdGpzb25CdWZmZXIgKz0gY2hhcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIENsZWFyIHRoZSBwcm9jZXNzZWQgYnVmZmVyXG5cdFx0XHRcdGJ1ZmZlciA9ICcnO1xuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHQvKipcblx0ICogRmV0Y2ggYXZhaWxhYmxlIG1vZGVscyBmcm9tIEdvb2dsZSBBUElcblx0ICovXG5cdGFzeW5jIGdldEF2YWlsYWJsZU1vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtb2RlbHMsIHJldHVybiB0aGVtXG5cdFx0aWYgKHRoaXMuY2FjaGVkTW9kZWxzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jYWNoZWRNb2RlbHM7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzP2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gO1xuXHRcdFx0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZXR1cm4gaGFyZGNvZGVkIGN1cnJlbnQgbW9kZWxzXG5cdFx0XHRjb25zdCBtb2RlbHMgPSBbXG5cdFx0XHRcdCdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnLFxuXHRcdFx0XHQnZ2VtaW5pLTIuNS1wcm8tcHJldmlldy0wMy0yNScsXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoJyxcblx0XHRcdFx0J2dlbWluaS0yLjAtZmxhc2gtbGl0ZSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggR29vZ2xlIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT2xsYW1hUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPbGxhbWEgKExvY2FsKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5tb2RlbCkgcmV0dXJuIGZhbHNlOyAvLyBSZXF1aXJlIG1vZGVsIHRvIGJlIHNldFxuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS90YWdzYCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2Uub2s7XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgfHwgdGhpcy5jb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zIHx8IDEwMDBcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0cmV0dXJuIGRhdGEucmVzcG9uc2U7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0Y29uc3QgbW9kZWwgPSBvcHRpb25zPy5tb2RlbCB8fCB0aGlzLmNvbmZpZy5tb2RlbDtcblx0XHRpZiAoIW1vZGVsKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09sbGFtYSBtb2RlbCBtdXN0IGJlIHNwZWNpZmllZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vYXBpL2dlbmVyYXRlYCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdHByb21wdCxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0Y29uc3QgbGluZXMgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSkuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQucmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBTcGxpdCB0ZXh0IGludG8gc21hbGxlciBjaHVua3MgZm9yIGNvbnNpc3RlbnQgdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVua1NpemUgPSAzOyAvLyBDaGFyYWN0ZXJzIHBlciBjaHVua1xuXHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcGFyc2VkLnJlc3BvbnNlLmxlbmd0aDsgaSArPSBjaHVua1NpemUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNodW5rID0gcGFyc2VkLnJlc3BvbnNlLnNsaWNlKGksIGkgKyBjaHVua1NpemUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gY2h1bmtzIHRvIGNyZWF0ZSBzbW9vdGggdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMCkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLmRvbmUpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9jaGF0YCwge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWwsXG5cdFx0XHRcdG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAobXNnID0+ICh7XG5cdFx0XHRcdFx0cm9sZTogbXNnLnJvbGUsXG5cdFx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdFx0fSkpLFxuXHRcdFx0XHRzdHJlYW06IGZhbHNlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLm1lc3NhZ2UuY29udGVudDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IHRoaXMuY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0Y29uc3QgbGluZXMgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSkuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0XHRpZiAobGluZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UobGluZSk7XG5cdFx0XHRcdFx0XHRcdGlmIChwYXJzZWQubWVzc2FnZT8uY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIFNwbGl0IHRleHQgaW50byBzbWFsbGVyIGNodW5rcyBmb3IgY29uc2lzdGVudCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNodW5rU2l6ZSA9IDM7IC8vIENoYXJhY3RlcnMgcGVyIGNodW5rXG5cdFx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBwYXJzZWQubWVzc2FnZS5jb250ZW50Lmxlbmd0aDsgaSArPSBjaHVua1NpemUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNodW5rID0gcGFyc2VkLm1lc3NhZ2UuY29udGVudC5zbGljZShpLCBpICsgY2h1bmtTaXplKTtcblx0XHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogY2h1bmssIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTbWFsbCBkZWxheSBiZXR3ZWVuIGNodW5rcyB0byBjcmVhdGUgc21vb3RoIHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjApKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxufSIsICJpbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFJUHJvdmlkZXIsIFByb3ZpZGVyVHlwZSwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBBSVByb3ZpZGVyU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENsYXVkZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvY2xhdWRlJztcbmltcG9ydCB7IE9wZW5BSVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb3BlbmFpJztcbmltcG9ydCB7IEdvb2dsZVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvZ29vZ2xlJztcbmltcG9ydCB7IE9sbGFtYVByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvb2xsYW1hJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzJztcbmltcG9ydCB7IEZlYXR1cmVNYW5hZ2VyIH0gZnJvbSAnLi4vbGljZW5zaW5nL2ZlYXR1cmUtbWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBBSVByb3ZpZGVyTWFuYWdlciB7XG5cdHByaXZhdGUgcHJvdmlkZXJzOiBNYXA8UHJvdmlkZXJUeXBlLCBBSVByb3ZpZGVyPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzZXR0aW5nczogTm92YVNldHRpbmdzO1xuXHRwcml2YXRlIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXI7XG5cdHByaXZhdGUgYXZhaWxhYmlsaXR5Q2FjaGU6IE1hcDxQcm92aWRlclR5cGUsIHsgaXNBdmFpbGFibGU6IGJvb2xlYW47IHRpbWVzdGFtcDogbnVtYmVyIH0+ID0gbmV3IE1hcCgpO1xuXHRwcml2YXRlIHJlYWRvbmx5IENBQ0hFX1RUTCA9IDMwMDAwOyAvLyAzMCBzZWNvbmRzXG5cblx0Y29uc3RydWN0b3Ioc2V0dGluZ3M6IE5vdmFTZXR0aW5ncywgZmVhdHVyZU1hbmFnZXI/OiBGZWF0dXJlTWFuYWdlcikge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gZmVhdHVyZU1hbmFnZXI7XG5cdH1cblxuXHRhc3luYyBpbml0aWFsaXplKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnY2xhdWRlJywgbmV3IENsYXVkZVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuY2xhdWRlKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdvcGVuYWknLCBuZXcgT3BlbkFJUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWkpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2dvb2dsZScsIG5ldyBHb29nbGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb2xsYW1hJywgbmV3IE9sbGFtYVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hKSk7XG5cdH1cblxuXHR1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTm92YVNldHRpbmdzKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuXHRcdHRoaXMucHJvdmlkZXJzLmZvckVhY2goKHByb3ZpZGVyLCB0eXBlKSA9PiB7XG5cdFx0XHRpZiAodHlwZSAhPT0gJ25vbmUnICYmIHR5cGUgaW4gdGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycykge1xuXHRcdFx0XHRwcm92aWRlci51cGRhdGVDb25maWc/Lih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzW3R5cGUgYXMga2V5b2YgQUlQcm92aWRlclNldHRpbmdzXSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Ly8gQ2xlYXIgY2FjaGUgd2hlbiBzZXR0aW5ncyBjaGFuZ2UgdG8gZm9yY2UgcmUtY2hlY2tcblx0XHR0aGlzLmF2YWlsYWJpbGl0eUNhY2hlLmNsZWFyKCk7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgcHJvdmlkZXIgYXZhaWxhYmlsaXR5IHdpdGggY2FjaGluZyB0byBhdm9pZCByZXBlYXRlZCBuZXR3b3JrIGNhbGxzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGNoZWNrUHJvdmlkZXJBdmFpbGFiaWxpdHkocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXHRcdGNvbnN0IGNhY2hlZCA9IHRoaXMuYXZhaWxhYmlsaXR5Q2FjaGUuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0XG5cdFx0Ly8gUmV0dXJuIGNhY2hlZCByZXN1bHQgaWYgc3RpbGwgdmFsaWRcblx0XHRpZiAoY2FjaGVkICYmIChub3cgLSBjYWNoZWQudGltZXN0YW1wKSA8IHRoaXMuQ0FDSEVfVFRMKSB7XG5cdFx0XHRyZXR1cm4gY2FjaGVkLmlzQXZhaWxhYmxlO1xuXHRcdH1cblx0XHRcblx0XHQvLyBHZXQgZnJlc2ggYXZhaWxhYmlsaXR5IHN0YXR1c1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0Y29uc3QgaXNBdmFpbGFibGUgPSBwcm92aWRlciA/IGF3YWl0IHByb3ZpZGVyLmlzQXZhaWxhYmxlKCkgOiBmYWxzZTtcblx0XHRcblx0XHQvLyBDYWNoZSB0aGUgcmVzdWx0XG5cdFx0dGhpcy5hdmFpbGFiaWxpdHlDYWNoZS5zZXQocHJvdmlkZXJUeXBlLCB7XG5cdFx0XHRpc0F2YWlsYWJsZSxcblx0XHRcdHRpbWVzdGFtcDogbm93XG5cdFx0fSk7XG5cdFx0XG5cdFx0cmV0dXJuIGlzQXZhaWxhYmxlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCB0aGUgcHJvdmlkZXIgdHlwZSB0aGF0IGhhbmRsZXMgYSBzcGVjaWZpYyBtb2RlbFxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlckZvck1vZGVsKG1vZGVsTmFtZTogc3RyaW5nKTogUHJvdmlkZXJUeXBlIHwgbnVsbCB7XG5cdFx0Ly8gQ2xhdWRlIG1vZGVsc1xuXHRcdGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aCgnY2xhdWRlLScpKSB7XG5cdFx0XHRyZXR1cm4gJ2NsYXVkZSc7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIE9wZW5BSSBtb2RlbHNcblx0XHRpZiAobW9kZWxOYW1lLnN0YXJ0c1dpdGgoJ2dwdC0nKSB8fCBtb2RlbE5hbWUuc3RhcnRzV2l0aCgnbzEtJykpIHtcblx0XHRcdHJldHVybiAnb3BlbmFpJztcblx0XHR9XG5cdFx0XG5cdFx0Ly8gR29vZ2xlIG1vZGVsc1xuXHRcdGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aCgnZ2VtaW5pLScpKSB7XG5cdFx0XHRyZXR1cm4gJ2dvb2dsZSc7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIE9sbGFtYSBtb2RlbHMgKGV2ZXJ5dGhpbmcgZWxzZSlcblx0XHRyZXR1cm4gJ29sbGFtYSc7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBzZWxlY3RlZCBtb2RlbCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm1cblx0ICovXG5cdHByaXZhdGUgZ2V0U2VsZWN0ZWRNb2RlbCgpOiBzdHJpbmcge1xuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRjb25zdCBzZWxlY3RlZE1vZGVsID0gdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5zZWxlY3RlZE1vZGVsO1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMEQgQUlQcm92aWRlck1hbmFnZXIuZ2V0U2VsZWN0ZWRNb2RlbCgpOicpO1xuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMEQgUGxhdGZvcm06JywgcGxhdGZvcm0pO1xuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMEQgU2VsZWN0ZWQgbW9kZWw6Jywgc2VsZWN0ZWRNb2RlbCk7XG5cdFx0XG5cdFx0cmV0dXJuIHNlbGVjdGVkTW9kZWw7XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTogUHJvbWlzZTxBSVByb3ZpZGVyIHwgbnVsbD4ge1xuXHRcdGNvbnN0IHNlbGVjdGVkTW9kZWwgPSB0aGlzLmdldFNlbGVjdGVkTW9kZWwoKTtcblx0XHRjb25zdCBwcm92aWRlclR5cGUgPSB0aGlzLmdldFByb3ZpZGVyRm9yTW9kZWwoc2VsZWN0ZWRNb2RlbCk7XG5cdFx0XG5cdFx0aWYgKCFwcm92aWRlclR5cGUgfHwgcHJvdmlkZXJUeXBlID09PSAnbm9uZScpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGNvbnN0IGlzQXZhaWxhYmxlID0gcHJvdmlkZXIgPyBhd2FpdCB0aGlzLmNoZWNrUHJvdmlkZXJBdmFpbGFiaWxpdHkocHJvdmlkZXJUeXBlKSA6IGZhbHNlO1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdcdUQ4M0RcdUREMEQgUHJvdmlkZXIgZm9yIG1vZGVsOicsIHsgc2VsZWN0ZWRNb2RlbCwgcHJvdmlkZXJUeXBlLCBpc0F2YWlsYWJsZSB9KTtcblx0XHRcblx0XHRpZiAocHJvdmlkZXIgJiYgaXNBdmFpbGFibGUpIHtcblx0XHRcdHJldHVybiBwcm92aWRlcjtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBwcm92aWRlci5nZW5lcmF0ZVRleHQocHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0XG5cdFx0eWllbGQqIHByb3ZpZGVyLmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHR5aWVsZCogcHJvdmlkZXIuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0Z2V0UHJvdmlkZXJOYW1lcygpOiBzdHJpbmdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5wcm92aWRlcnMudmFsdWVzKCkpLm1hcChwID0+IHAubmFtZSk7XG5cdH1cblxuXHRhc3luYyBnZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0cmV0dXJuIHByb3ZpZGVyID8gcHJvdmlkZXIubmFtZSA6ICdOb25lJztcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRQcm92aWRlclR5cGUoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRNb2RlbCA9IHRoaXMuZ2V0U2VsZWN0ZWRNb2RlbCgpO1xuXHRcdGNvbnN0IHByb3ZpZGVyVHlwZSA9IHRoaXMuZ2V0UHJvdmlkZXJGb3JNb2RlbChzZWxlY3RlZE1vZGVsKTtcblx0XHRcblx0XHRpZiAoIXByb3ZpZGVyVHlwZSB8fCBwcm92aWRlclR5cGUgPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHRoaXMuY2hlY2tQcm92aWRlckF2YWlsYWJpbGl0eShwcm92aWRlclR5cGUpKSB7XG5cdFx0XHRyZXR1cm4gcHJvdmlkZXJUeXBlO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtb2RlbCBuYW1lXG5cdCAqL1xuXHRnZXRDdXJyZW50TW9kZWwoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRTZWxlY3RlZE1vZGVsKCk7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvdmlkZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCBvcHRpb25zKTtcblx0fVxuXG5cdGdldEFsbG93ZWRQcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIE9sbGFtYSByZXF1aXJlcyBsb2NhbCBzZXJ2ZXIgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZVxuXHRcdGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuXHRcdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnXTtcblx0XHR9XG5cdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ107XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFsbCBhdmFpbGFibGUgcHJvdmlkZXJzIHdpdGggdGhlaXIgYXZhaWxhYmlsaXR5IHN0YXR1cyBpbiBwYXJhbGxlbFxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlUHJvdmlkZXJzV2l0aFN0YXR1cygpOiBQcm9taXNlPE1hcDxQcm92aWRlclR5cGUsIGJvb2xlYW4+PiB7XG5cdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGF2YWlsYWJpbGl0eUNoZWNrcyA9IGFsbG93ZWRQcm92aWRlcnMubWFwKGFzeW5jIChwcm92aWRlclR5cGUpID0+IHtcblx0XHRcdGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgdGhpcy5jaGVja1Byb3ZpZGVyQXZhaWxhYmlsaXR5KHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRyZXR1cm4geyBwcm92aWRlclR5cGUsIGlzQXZhaWxhYmxlIH07XG5cdFx0fSk7XG5cblx0XHRjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoYXZhaWxhYmlsaXR5Q2hlY2tzKTtcblx0XHRjb25zdCBhdmFpbGFiaWxpdHlNYXAgPSBuZXcgTWFwPFByb3ZpZGVyVHlwZSwgYm9vbGVhbj4oKTtcblx0XHRcblx0XHRyZXN1bHRzLmZvckVhY2goKHsgcHJvdmlkZXJUeXBlLCBpc0F2YWlsYWJsZSB9KSA9PiB7XG5cdFx0XHRhdmFpbGFiaWxpdHlNYXAuc2V0KHByb3ZpZGVyVHlwZSwgaXNBdmFpbGFibGUpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGF2YWlsYWJpbGl0eU1hcDtcblx0fVxuXG5cdGlzUHJvdmlkZXJBbGxvd2VkKHByb3ZpZGVyVHlwZTogUHJvdmlkZXJUeXBlKTogYm9vbGVhbiB7XG5cdFx0Ly8gQWxsIHByb3ZpZGVycyBhcmUgYWxsb3dlZFxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0Z2V0UHJvdmlkZXJMaW1pdHMoKTogeyBsb2NhbDogbnVtYmVyOyBjbG91ZDogbnVtYmVyIH0ge1xuXHRcdC8vIE5vIGxpbWl0cyBpbiB0aGUgU3VwZXJub3ZhIG1vZGVsXG5cdFx0cmV0dXJuIHsgbG9jYWw6IEluZmluaXR5LCBjbG91ZDogSW5maW5pdHkgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYXZhaWxhYmxlIG1vZGVscyBmb3IgYSBzcGVjaWZpYyBwcm92aWRlclxuXHQgKi9cblx0YXN5bmMgZ2V0UHJvdmlkZXJNb2RlbHMocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFByb3ZpZGVyICR7cHJvdmlkZXJUeXBlfSBub3QgZm91bmRgKTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgZ2V0QXZhaWxhYmxlTW9kZWxzIG1ldGhvZFxuXHRcdGlmICgnZ2V0QXZhaWxhYmxlTW9kZWxzJyBpbiBwcm92aWRlciAmJiB0eXBlb2YgcHJvdmlkZXIuZ2V0QXZhaWxhYmxlTW9kZWxzID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRyZXR1cm4gYXdhaXQgKHByb3ZpZGVyIGFzIGFueSkuZ2V0QXZhaWxhYmxlTW9kZWxzKCk7XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHByb3ZpZGVycyB3aXRob3V0IEFQSSBtb2RlbCBsaXN0aW5nIChsaWtlIE9sbGFtYSksIHJldHVybiBlbXB0eSBhcnJheVxuXHRcdHJldHVybiBbXTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBtb2RlbCBjYWNoZSBmb3IgYSBzcGVjaWZpYyBwcm92aWRlclxuXHQgKi9cblx0Y2xlYXJQcm92aWRlck1vZGVsQ2FjaGUocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiB2b2lkIHtcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgY2xlYXJNb2RlbENhY2hlIG1ldGhvZFxuXHRcdGlmICgnY2xlYXJNb2RlbENhY2hlJyBpbiBwcm92aWRlciAmJiB0eXBlb2YgcHJvdmlkZXIuY2xlYXJNb2RlbENhY2hlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHQocHJvdmlkZXIgYXMgYW55KS5jbGVhck1vZGVsQ2FjaGUoKTtcblx0XHR9XG5cdH1cblxuXHRjbGVhbnVwKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLmNsZWFyKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBkZWZhdWx0IG1heCB0b2tlbnMgZnJvbSBzZXR0aW5nc1xuXHQgKi9cblx0Z2V0RGVmYXVsdE1heFRva2VucygpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2Vucztcblx0fVxufSIsICIvKipcbiAqIENvcmUgZG9jdW1lbnQgZW5naW5lIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGFsbCBkb2N1bWVudCBtYW5pcHVsYXRpb24gYW5kIGVkaXRvciBpbnRlcmFjdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBURmlsZSwgRWRpdG9yUG9zaXRpb24sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50Q29udGV4dCwgSGVhZGluZ0luZm8sIEVkaXRSZXN1bHQsIEVkaXRPcHRpb25zLCBEb2N1bWVudFNlY3Rpb24sIEVkaXRDb21tYW5kIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NYW5hZ2VyLCBEYXRhU3RvcmUgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIERvY3VtZW50RW5naW5lIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXIgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIGRhdGFTdG9yZT86IERhdGFTdG9yZSkge1xuICAgICAgICBpZiAoZGF0YVN0b3JlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcihkYXRhU3RvcmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGNvbnZlcnNhdGlvbiBtYW5hZ2VyIChmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb24pXG4gICAgICovXG4gICAgc2V0Q29udmVyc2F0aW9uTWFuYWdlcihjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IGNvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBhY3RpdmUgZWRpdG9yIGluc3RhbmNlIC0gZW5zdXJlcyB3ZSBnZXQgdGhlIGVkaXRvciBmb3IgdGhlIGFjdGl2ZSBmaWxlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRWRpdG9yKCk6IEVkaXRvciB8IG51bGwge1xuICAgICAgICAvLyBHZXQgdGhlIGFjdGl2ZSBmaWxlIGZpcnN0IHRvIGVuc3VyZSBjb25zaXN0ZW5jeVxuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghYWN0aXZlRmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIG1hcmtkb3duIHZpZXcgZm9yIHRoZSBhY3RpdmUgZmlsZSBzcGVjaWZpY2FsbHlcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcbiAgICAgICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IGxlYWYudmlldztcbiAgICAgICAgICAgIGlmICh2aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ICYmIHZpZXcuZmlsZSA9PT0gYWN0aXZlRmlsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2aWV3LmVkaXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRmFsbGJhY2s6IHRyeSB0aGUgd29ya3NwYWNlIGFjdGl2ZSBlZGl0b3IgaWYgaXQgbWF0Y2hlcyB0aGUgYWN0aXZlIGZpbGVcbiAgICAgICAgY29uc3QgYWN0aXZlRWRpdG9yID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUVkaXRvcjtcbiAgICAgICAgaWYgKGFjdGl2ZUVkaXRvcj8uZWRpdG9yICYmIGFjdGl2ZUVkaXRvci5maWxlID09PSBhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aXZlRWRpdG9yLmVkaXRvcjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRmluYWwgZmFsbGJhY2s6IHRyeSBnZXRBY3RpdmVWaWV3T2ZUeXBlXG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAodmlldyAmJiB2aWV3LmZpbGUgPT09IGFjdGl2ZUZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3LmVkaXRvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGl2ZSBmaWxlXG4gICAgICovXG4gICAgZ2V0QWN0aXZlRmlsZSgpOiBURmlsZSB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgZ2V0U2VsZWN0ZWRUZXh0KCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBnZXRDdXJzb3JQb3NpdGlvbigpOiBFZGl0b3JQb3NpdGlvbiB8IG51bGwge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBpZiAoIWVkaXRvcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgY3Vyc29yIHBvc2l0aW9uIChvcHRpb25hbGx5IGZvY3VzIHRoZSBlZGl0b3IpXG4gICAgICovXG4gICAgc2V0Q3Vyc29yUG9zaXRpb24ocG9zaXRpb246IEVkaXRvclBvc2l0aW9uLCBzaG91bGRGb2N1czogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHBvc2l0aW9uKTtcbiAgICAgICAgaWYgKHNob3VsZEZvY3VzKSB7XG4gICAgICAgICAgICBlZGl0b3IuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY29tcHJlaGVuc2l2ZSBkb2N1bWVudCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KCk6IFByb21pc2U8RG9jdW1lbnRDb250ZXh0IHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUgfHwgIWVkaXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHRoaXMuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5nZXRDdXJzb3JQb3NpdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBoZWFkaW5ncyBmcm9tIHRoZSBkb2N1bWVudFxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZXh0cmFjdEhlYWRpbmdzKGNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHN1cnJvdW5kaW5nIGxpbmVzIGZvciBjb250ZXh0XG4gICAgICAgIGNvbnN0IHN1cnJvdW5kaW5nTGluZXMgPSBjdXJzb3JQb3NpdGlvbiA/IFxuICAgICAgICAgICAgdGhpcy5nZXRTdXJyb3VuZGluZ0xpbmVzKGNvbnRlbnQsIGN1cnNvclBvc2l0aW9uLmxpbmUpIDogXG4gICAgICAgICAgICB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICBoZWFkaW5ncyxcbiAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogc2VsZWN0ZWRUZXh0IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGN1cnNvclBvc2l0aW9uOiBjdXJzb3JQb3NpdGlvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBzdXJyb3VuZGluZ0xpbmVzXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBoZWFkaW5ncyBmcm9tIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGV4dHJhY3RIZWFkaW5ncyhjb250ZW50OiBzdHJpbmcpOiBIZWFkaW5nSW5mb1tdIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IEhlYWRpbmdJbmZvW10gPSBbXTtcbiAgICAgICAgbGV0IGNoYXJDb3VudCA9IDA7XG5cbiAgICAgICAgbGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuICAgICAgICAgICAgaWYgKGhlYWRpbmdNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gaGVhZGluZ01hdGNoWzFdLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gaGVhZGluZ01hdGNoWzJdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGhlYWRpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LFxuICAgICAgICAgICAgICAgICAgICBsZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogY2hhckNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBjaGFyQ291bnQgKyBsaW5lLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBsaW5lIGxlbmd0aCArIG5ld2xpbmUgY2hhcmFjdGVyXG4gICAgICAgICAgICBjaGFyQ291bnQgKz0gbGluZS5sZW5ndGggKyAxO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gaGVhZGluZ3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGxpbmVzIHN1cnJvdW5kaW5nIHRoZSBjdXJzb3IgcG9zaXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFN1cnJvdW5kaW5nTGluZXMoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGN1cnJlbnRMaW5lOiBudW1iZXIsIFxuICAgICAgICBjb250ZXh0U2l6ZTogbnVtYmVyID0gNVxuICAgICk6IHsgYmVmb3JlOiBzdHJpbmdbXTsgYWZ0ZXI6IHN0cmluZ1tdIH0ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3RhcnRMaW5lID0gTWF0aC5tYXgoMCwgY3VycmVudExpbmUgLSBjb250ZXh0U2l6ZSk7XG4gICAgICAgIGNvbnN0IGVuZExpbmUgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBjdXJyZW50TGluZSArIGNvbnRleHRTaXplKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBiZWZvcmU6IGxpbmVzLnNsaWNlKHN0YXJ0TGluZSwgY3VycmVudExpbmUpLFxuICAgICAgICAgICAgYWZ0ZXI6IGxpbmVzLnNsaWNlKGN1cnJlbnRMaW5lICsgMSwgZW5kTGluZSArIDEpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgYW4gZWRpdCB0byB0aGUgZG9jdW1lbnRcbiAgICAgKi9cbiAgICBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcG9zaXRpb246ICdjdXJzb3InIHwgJ3NlbGVjdGlvbicgfCAnZW5kJyB8IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0sXG4gICAgICAgIG9wdGlvbnM6IEVkaXRPcHRpb25zID0ge31cbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgYXBwbGllZEF0OiBFZGl0b3JQb3NpdGlvbjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnY3Vyc29yJykge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihjb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICAgICAgLy8gQXBwZW5kIHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lID0gZWRpdG9yLmxhc3RMaW5lKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmVMZW5ndGggPSBlZGl0b3IuZ2V0TGluZShsYXN0TGluZSkubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGN1cnJlbnRDb250ZW50ICsgKGN1cnJlbnRDb250ZW50LmVuZHNXaXRoKCdcXG4nKSA/ICcnIDogJ1xcbicpICsgY29udGVudDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVc2UgdmF1bHQubW9kaWZ5IGZvciB1bmRvL3JlZG8gc3VwcG9ydFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IHNwZWNpZmljIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gcG9zaXRpb247XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShjb250ZW50LCBhcHBsaWVkQXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBIYW5kbGUgcG9zdC1lZGl0IG9wdGlvbnNcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNlbGVjdE5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRQb3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IGFwcGxpZWRBdC5saW5lICsgY29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgY2g6IGNvbnRlbnQuaW5jbHVkZXMoJ1xcbicpID8gXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LnNwbGl0KCdcXG4nKS5wb3AoKSEubGVuZ3RoIDogXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQuY2ggKyBjb250ZW50Lmxlbmd0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihhcHBsaWVkQXQsIGVuZFBvcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNjcm9sbFRvRWRpdCkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IGFwcGxpZWRBdCxcbiAgICAgICAgICAgICAgICAgICAgdG86IGFwcGxpZWRBdFxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogcG9zaXRpb24gPT09ICdzZWxlY3Rpb24nID8gJ3JlcGxhY2UnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPT09ICdlbmQnID8gJ2FwcGVuZCcgOiAnaW5zZXJ0JyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBjb250ZW50IGF0IGN1cnNvciBsb2NhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGRlbGV0ZUNvbnRlbnQoXG4gICAgICAgIHRhcmdldDogJ3NlbGVjdGlvbicgfCAnbGluZSdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKCcnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQgPT09ICdsaW5lJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gY3Vyc29yLmxpbmU7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZSwgY2g6IDAgfSwgXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogbGluZSArIDEsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmUsIGNoOiAwIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBkZWxldGUgdGFyZ2V0JyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBmdWxsIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBhc3luYyBnZXREb2N1bWVudENvbnRlbnQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIHRoZSBlbnRpcmUgZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIGFzeW5jIHNldERvY3VtZW50Q29udGVudChjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENvbnZlcnNhdGlvbiBtYW5hZ2VtZW50IG1ldGhvZHNcblxuICAgIC8qKlxuICAgICAqIEFkZCB1c2VyIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkVXNlck1lc3NhZ2UoY29udGVudDogc3RyaW5nLCBjb21tYW5kPzogRWRpdENvbW1hbmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShmaWxlLCBjb250ZW50LCBjb21tYW5kKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhc3Npc3RhbnQgcmVzcG9uc2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShjb250ZW50OiBzdHJpbmcsIHJlc3VsdD86IEVkaXRSZXN1bHQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRBc3Npc3RhbnRNZXNzYWdlKGZpbGUsIGNvbnRlbnQsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgc3lzdGVtIG1lc3NhZ2UgdG8gY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkU3lzdGVtTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5hZGRTeXN0ZW1NZXNzYWdlKGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuICcnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGUsIG1heE1lc3NhZ2VzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyQ29udmVyc2F0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmNsZWFyQ29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzIGZvciBjdXJyZW50IGZpbGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25TdGF0cygpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBzdHJpbmcgfCBudWxsO1xuICAgICAgICBjb252ZXJzYXRpb25BZ2U6IG51bWJlcjtcbiAgICB9IHwgbnVsbCB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0U3RhdHMoZmlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgY3VycmVudCBmaWxlIGhhcyBhbiBhY3RpdmUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgaGFzQ29udmVyc2F0aW9uKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuaGFzQ29udmVyc2F0aW9uKGZpbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGV4cG9ydENvbnZlcnNhdGlvbigpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5leHBvcnRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSBzZWxlY3RlZCB0ZXh0IHdpdGggbmV3IGNvbnRlbnRcbiAgICAgKiBIYW5kbGVzIHVuZG8vcmVkbyBwcm9wZXJseSBhbmQgcHJlc2VydmVzIGN1cnNvciBwb3NpdGlvblxuICAgICAqL1xuICAgIGFzeW5jIHJlcGxhY2VTZWxlY3Rpb24oXG4gICAgICAgIG5ld1RleHQ6IHN0cmluZyxcbiAgICAgICAgZnJvbT86IEVkaXRvclBvc2l0aW9uLFxuICAgICAgICB0bz86IEVkaXRvclBvc2l0aW9uXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBvciBmaWxlJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFVzZSBwcm92aWRlZCByYW5nZSBvciBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgY29uc3QgZnJvbVBvcyA9IGZyb20gfHwgZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xuICAgICAgICAgICAgY29uc3QgdG9Qb3MgPSB0byB8fCBlZGl0b3IuZ2V0Q3Vyc29yKCd0bycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQZXJmb3JtIHRoZSByZXBsYWNlbWVudCB1c2luZyBPYnNpZGlhbidzIHRyYW5zYWN0aW9uIHN5c3RlbSBmb3IgcHJvcGVyIHVuZG8vcmVkb1xuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdUZXh0LCBmcm9tUG9zLCB0b1Bvcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNldCBjdXJzb3IgYXQgdGhlIGVuZCBvZiB0aGUgcmVwbGFjZWQgdGV4dFxuICAgICAgICAgICAgY29uc3QgbmV3Q3Vyc29yUG9zID0ge1xuICAgICAgICAgICAgICAgIGxpbmU6IGZyb21Qb3MubGluZSArIChuZXdUZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGggLSAxKSxcbiAgICAgICAgICAgICAgICBjaDogbmV3VGV4dC5pbmNsdWRlcygnXFxuJykgPyBcbiAgICAgICAgICAgICAgICAgICAgbmV3VGV4dC5zcGxpdCgnXFxuJykucG9wKCkhLmxlbmd0aCA6IFxuICAgICAgICAgICAgICAgICAgICBmcm9tUG9zLmNoICsgbmV3VGV4dC5sZW5ndGhcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IobmV3Q3Vyc29yUG9zKTtcbiAgICAgICAgICAgIGVkaXRvci5mb2N1cygpO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogbmV3VGV4dCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IGZyb21Qb3MsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVwbGFjaW5nIHNlbGVjdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG59IiwgIi8qKlxuICogQ29udmVyc2F0aW9uIE1hbmFnZXIgZm9yIE5vdmFcbiAqIEhhbmRsZXMgZmlsZS1zY29wZWQgY29udmVyc2F0aW9uIHN0b3JhZ2UgYW5kIHJldHJpZXZhbFxuICovXG5cbmltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSwgQ29udmVyc2F0aW9uTWVzc2FnZSwgRWRpdENvbW1hbmQsIEVkaXRSZXN1bHQsIEVkaXRBY3Rpb24sIENvbnRleHREb2N1bWVudFJlZiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTdG9yZSB7XG4gICAgbG9hZERhdGEoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gICAgc2F2ZURhdGEoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbnM6IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbkRhdGE+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUgbWF4TWVzc2FnZXNQZXJGaWxlID0gMTAwOyAvLyBMaW1pdCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICAgIHByaXZhdGUgc3RvcmFnZUtleSA9ICdub3ZhLWNvbnZlcnNhdGlvbnMnO1xuICAgIHByaXZhdGUgY2xlYW51cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIGluaXRpYWxpemVQcm9taXNlOiBQcm9taXNlPHZvaWQ+O1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBkYXRhU3RvcmU6IERhdGFTdG9yZSkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVQcm9taXNlID0gdGhpcy5pbml0aWFsaXplKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIHRoaXMuc3RhcnRQZXJpb2RpY0NsZWFudXAoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGNvbnZlcnNhdGlvbnMgZnJvbSBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5kYXRhU3RvcmUubG9hZERhdGEodGhpcy5zdG9yYWdlS2V5KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGRhdGEgJiYgQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29udmVyc2F0aW9uIG9mIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFZhbGlkYXRlIGFuZCBzYW5pdGl6ZSBjb252ZXJzYXRpb24gZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FuaXRpemVkQ29udmVyc2F0aW9uID0gdGhpcy5zYW5pdGl6ZUNvbnZlcnNhdGlvbkRhdGEoY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQoc2FuaXRpemVkQ29udmVyc2F0aW9uLmZpbGVQYXRoLCBzYW5pdGl6ZWRDb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCBjb3JydXB0ZWQgaW5kaXZpZHVhbCBjb252ZXJzYXRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNraXBwZWQgY29ycnVwdGVkIGNvbnZlcnNhdGlvbiBmb3IgZmlsZTogJHtjb252ZXJzYXRpb24/LmZpbGVQYXRoIHx8ICd1bmtub3duJ31gLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gbG9hZCBjb252ZXJzYXRpb24gZGF0YSAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcdTI3NEMgQ29udmVyc2F0aW9uTWFuYWdlci5sb2FkQ29udmVyc2F0aW9uczogTG9hZCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2FuaXRpemUgYW5kIHZhbGlkYXRlIGNvbnZlcnNhdGlvbiBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBzYW5pdGl6ZUNvbnZlcnNhdGlvbkRhdGEoY29udmVyc2F0aW9uOiBhbnkpOiBDb252ZXJzYXRpb25EYXRhIHtcbiAgICAgICAgLy8gRW5zdXJlIHJlcXVpcmVkIGZpZWxkcyBleGlzdCBhbmQgYXJlIHZhbGlkXG4gICAgICAgIGlmICghY29udmVyc2F0aW9uLmZpbGVQYXRoIHx8IHR5cGVvZiBjb252ZXJzYXRpb24uZmlsZVBhdGggIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgb3IgbWlzc2luZyBmaWxlUGF0aCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRW5zdXJlIG1lc3NhZ2VzIGFycmF5IGV4aXN0cyBhbmQgaXMgdmFsaWRcbiAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBBcnJheS5pc0FycmF5KGNvbnZlcnNhdGlvbi5tZXNzYWdlcykgPyBjb252ZXJzYXRpb24ubWVzc2FnZXMgOiBbXTtcblxuICAgICAgICAvLyBFbnN1cmUgY29udGV4dERvY3VtZW50cyBhcnJheSBleGlzdHMgYW5kIGlzIHZhbGlkXG4gICAgICAgIGxldCBjb250ZXh0RG9jdW1lbnRzOiBDb250ZXh0RG9jdW1lbnRSZWZbXSA9IFtdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cykpIHtcbiAgICAgICAgICAgIGNvbnRleHREb2N1bWVudHMgPSBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50c1xuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGRvYzogYW55KSA9PiB0aGlzLmlzVmFsaWRDb250ZXh0RG9jdW1lbnQoZG9jKSlcbiAgICAgICAgICAgICAgICAubWFwKChkb2M6IGFueSkgPT4gdGhpcy5zYW5pdGl6ZUNvbnRleHREb2N1bWVudChkb2MpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEVuc3VyZSBiYXNpYyBzdHJ1Y3R1cmVcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGVQYXRoOiBjb252ZXJzYXRpb24uZmlsZVBhdGgsXG4gICAgICAgICAgICBtZXNzYWdlcyxcbiAgICAgICAgICAgIGxhc3RVcGRhdGVkOiB0eXBlb2YgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID09PSAnbnVtYmVyJyA/IGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjb250ZXh0RG9jdW1lbnRzLFxuICAgICAgICAgICAgbWV0YWRhdGE6IGNvbnZlcnNhdGlvbi5tZXRhZGF0YSB8fCB7XG4gICAgICAgICAgICAgICAgZWRpdENvdW50OiAwLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRGcmVxdWVuY3k6IHtcbiAgICAgICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgICAgICBkZWxldGU6IDAsXG4gICAgICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiAwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGNvbnRleHQgZG9jdW1lbnQgc3RydWN0dXJlXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc1ZhbGlkQ29udGV4dERvY3VtZW50KGRvYzogYW55KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBkb2MgJiYgXG4gICAgICAgICAgICAgICB0eXBlb2YgZG9jLnBhdGggPT09ICdzdHJpbmcnICYmIFxuICAgICAgICAgICAgICAgZG9jLnBhdGgudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2FuaXRpemUgY29udGV4dCBkb2N1bWVudCBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBzYW5pdGl6ZUNvbnRleHREb2N1bWVudChkb2M6IGFueSk6IENvbnRleHREb2N1bWVudFJlZiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwYXRoOiBkb2MucGF0aCxcbiAgICAgICAgICAgIHByb3BlcnR5OiB0eXBlb2YgZG9jLnByb3BlcnR5ID09PSAnc3RyaW5nJyA/IGRvYy5wcm9wZXJ0eSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGFkZGVkQXQ6IHR5cGVvZiBkb2MuYWRkZWRBdCA9PT0gJ251bWJlcicgPyBkb2MuYWRkZWRBdCA6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIGNvbnZlcnNhdGlvbnMgdG8gcGx1Z2luIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVDb252ZXJzYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uc0FycmF5ID0gQXJyYXkuZnJvbSh0aGlzLmNvbnZlcnNhdGlvbnMudmFsdWVzKCkpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kYXRhU3RvcmUuc2F2ZURhdGEodGhpcy5zdG9yYWdlS2V5LCBjb252ZXJzYXRpb25zQXJyYXkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignXHUyNzRDIENvbnZlcnNhdGlvbk1hbmFnZXIuc2F2ZUNvbnZlcnNhdGlvbnM6IFNhdmUgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJzYXRpb24gZm9yIGEgc3BlY2lmaWMgZmlsZVxuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IENvbnZlcnNhdGlvbkRhdGEge1xuICAgICAgICAvLyBOb3RlOiBUaGlzIG1ldGhvZCBpcyBzeW5jaHJvbm91cyBhbmQgdXNlZCBieSBvdGhlciBtZXRob2RzIHRoYXQgYXdhaXQgaW5pdGlhbGl6ZVByb21pc2VcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9ucy5oYXMoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNvbnZlcnNhdGlvbiBmb3IgdGhpcyBmaWxlXG4gICAgICAgICAgICBjb25zdCBuZXdDb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIGNvbnRleHREb2N1bWVudHM6IFtdLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZEZyZXF1ZW5jeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXdyaXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KGZpbGVQYXRoLCBuZXdDb252ZXJzYXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRW5zdXJlIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgLSBhZGQgY29udGV4dERvY3VtZW50cyBpZiBtaXNzaW5nXG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZVBhdGgpITtcbiAgICAgICAgaWYgKCFjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cykge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHMgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgdXNlciBtZXNzYWdlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRVc2VyTWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsIFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsIFxuICAgICAgICBjb21tYW5kPzogRWRpdENvbW1hbmRcbiAgICApOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZTogQ29udmVyc2F0aW9uTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTWVzc2FnZUlkKCksXG4gICAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgY29tbWFuZFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBjb21tYW5kIGZyZXF1ZW5jeSBpZiBjb21tYW5kIHByb3ZpZGVkXG4gICAgICAgIGlmIChjb21tYW5kICYmIGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3lbY29tbWFuZC5hY3Rpb25dKys7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhbiBhc3Npc3RhbnQgcmVzcG9uc2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZEFzc2lzdGFudE1lc3NhZ2UoXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgICAgIHJlc3VsdD86IEVkaXRSZXN1bHRcbiAgICApOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2U+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIC8vIEluY3JlbWVudCBlZGl0IGNvdW50IGlmIHJlc3VsdCBpbmRpY2F0ZXMgc3VjY2Vzc2Z1bCBlZGl0XG4gICAgICAgIGlmIChyZXN1bHQ/LnN1Y2Nlc3MgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50Kys7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHN5c3RlbSBtZXNzYWdlIHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRTeXN0ZW1NZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIG1ldGFkYXRhPzogeyBtZXNzYWdlVHlwZT86IHN0cmluZzsgc291cmNlPzogJ2NoYXQnIHwgJ3NlbGVjdGlvbicgfCAnY29tbWFuZCcgfVxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIG1ldGFkYXRhXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgYXdhaXQgdGhpcy50cmltQW5kU2F2ZShjb252ZXJzYXRpb24pO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmVjZW50IG1lc3NhZ2VzIGZvciBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0UmVjZW50TWVzc2FnZXMoZmlsZTogVEZpbGUsIGNvdW50OiBudW1iZXIgPSAxMCk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uLm1lc3NhZ2VzLnNsaWNlKC1jb3VudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG1lc3NhZ2VzIGJ5IHJvbGVcbiAgICAgKi9cbiAgICBnZXRNZXNzYWdlc0J5Um9sZShmaWxlOiBURmlsZSwgcm9sZTogQ29udmVyc2F0aW9uTWVzc2FnZVsncm9sZSddKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cucm9sZSA9PT0gcm9sZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSSBwcm9tcHRzXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uQ29udGV4dChmaWxlOiBURmlsZSwgbWF4TWVzc2FnZXM6IG51bWJlciA9IDYpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgbWF4TWVzc2FnZXMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dExpbmVzID0gbWVzc2FnZXMubWFwKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZShtc2cudGltZXN0YW1wKS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcbiAgICAgICAgICAgIGxldCBsaW5lID0gYFske3RpbWVzdGFtcH1dICR7bXNnLnJvbGUudG9VcHBlckNhc2UoKX06ICR7bXNnLmNvbnRlbnR9YDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChDb21tYW5kOiAke21zZy5jb21tYW5kLmFjdGlvbn0gJHttc2cuY29tbWFuZC50YXJnZXR9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtc2cucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZSArPSBgIChSZXN1bHQ6ICR7bXNnLnJlc3VsdC5zdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2ZhaWxlZCd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYFByZXZpb3VzIGNvbnZlcnNhdGlvbjpcXG4ke2NvbnRleHRMaW5lcy5qb2luKCdcXG4nKX1cXG5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAvLyBEbyBOT1QgY2xlYXIgY29udGV4dERvY3VtZW50cyAtIHRob3NlIGFyZSBtYW5hZ2VkIHNlcGFyYXRlbHkgZnJvbSB0aGUgZHJhd2VyXG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuZWRpdENvdW50ID0gMDtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5jb21tYW5kRnJlcXVlbmN5ID0ge1xuICAgICAgICAgICAgICAgIGFkZDogMCxcbiAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICBncmFtbWFyOiAwLFxuICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBzdGF0aXN0aWNzXG4gICAgICovXG4gICAgZ2V0U3RhdHMoZmlsZTogVEZpbGUpOiB7XG4gICAgICAgIG1lc3NhZ2VDb3VudDogbnVtYmVyO1xuICAgICAgICBlZGl0Q291bnQ6IG51bWJlcjtcbiAgICAgICAgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbDtcbiAgICAgICAgY29udmVyc2F0aW9uQWdlOiBudW1iZXI7XG4gICAgfSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1vc3RVc2VkQ29tbWFuZDogRWRpdEFjdGlvbiB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgbWF4Q291bnQgPSAwO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBbYWN0aW9uLCBjb3VudF0gb2YgT2JqZWN0LmVudHJpZXMoY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kID0gYWN0aW9uIGFzIEVkaXRBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICA/IERhdGUubm93KCkgLSBjb252ZXJzYXRpb24ubWVzc2FnZXNbMF0udGltZXN0YW1wXG4gICAgICAgICAgICA6IDA7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2VDb3VudDogY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCxcbiAgICAgICAgICAgIGVkaXRDb3VudDogY29udmVyc2F0aW9uLm1ldGFkYXRhPy5lZGl0Q291bnQgfHwgMCxcbiAgICAgICAgICAgIG1vc3RVc2VkQ29tbWFuZCxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkFnZVxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0IGNvbnZlcnNhdGlvbiBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgZXhwb3J0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gW2AjIENvbnZlcnNhdGlvbiBIaXN0b3J5IGZvciAke2ZpbGUubmFtZX1gLCAnJ107XG5cbiAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGNvbnZlcnNhdGlvbi5tZXNzYWdlcykge1xuICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUobWVzc2FnZS50aW1lc3RhbXApLnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKGAjIyAke21lc3NhZ2Uucm9sZS50b1VwcGVyQ2FzZSgpfSAoJHt0aW1lc3RhbXB9KWApO1xuICAgICAgICAgICAgbGluZXMucHVzaChtZXNzYWdlLmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKkNvbW1hbmQ6ICR7bWVzc2FnZS5jb21tYW5kLmFjdGlvbn0gJHttZXNzYWdlLmNvbW1hbmQudGFyZ2V0fSpgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChgKlJlc3VsdDogJHttZXNzYWdlLnJlc3VsdC5zdWNjZXNzID8gJ1N1Y2Nlc3MnIDogJ0ZhaWxlZCd9KmApO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqRXJyb3I6ICR7bWVzc2FnZS5yZXN1bHQuZXJyb3J9KmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGluZXMucHVzaCgnJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGluZXMuam9pbignXFxuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgdW5pcXVlIG1lc3NhZ2UgSURcbiAgICAgKi9cbiAgICBwcml2YXRlIGdlbmVyYXRlTWVzc2FnZUlkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgbXNnXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmltIGNvbnZlcnNhdGlvbiB0byBtYXggbGVuZ3RoIGFuZCBzYXZlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB0cmltQW5kU2F2ZShjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbkRhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiB0aGlzLm1heE1lc3NhZ2VzUGVyRmlsZSkge1xuICAgICAgICAgICAgLy8gS2VlcCB0aGUgbW9zdCByZWNlbnQgbWVzc2FnZXNcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5zbGljZSgtdGhpcy5tYXhNZXNzYWdlc1BlckZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjb252ZXJzYXRpb24gZmlsZSBwYXRoc1xuICAgICAqL1xuICAgIGdldEFsbENvbnZlcnNhdGlvbkZpbGVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5jb252ZXJzYXRpb25zLmtleXMoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZmlsZSBoYXMgYWN0aXZlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGhhc0NvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmNvbnZlcnNhdGlvbnMuZ2V0KGZpbGUucGF0aCk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24gPyBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjb252ZXJzYXRpb24gZmlsZSBwYXRoIChmb3IgZmlsZSByZW5hbWVzKVxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZUZpbGVQYXRoKG9sZFBhdGg6IHN0cmluZywgbmV3UGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQob2xkUGF0aCk7XG4gICAgICAgIGlmIChjb252ZXJzYXRpb24pIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5maWxlUGF0aCA9IG5ld1BhdGg7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKG9sZFBhdGgpO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChuZXdQYXRoLCBjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcGVyaW9kaWMgY2xlYW51cCBvZiBvbGQgY29udmVyc2F0aW9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhcnRQZXJpb2RpY0NsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIC8vIENsZWFuIHVwIGV2ZXJ5IDI0IGhvdXJzXG4gICAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cE9sZENvbnZlcnNhdGlvbnMoNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyA3IGRheXNcbiAgICAgICAgfSwgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgY29udmVyc2F0aW9ucyBvbGRlciB0aGFuIHRoZSBzcGVjaWZpZWQgYWdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBjbGVhbnVwT2xkQ29udmVyc2F0aW9ucyhtYXhBZ2U6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBsZXQgY2xlYW5lZCA9IGZhbHNlO1xuXG4gICAgICAgIGZvciAoY29uc3QgW2ZpbGVQYXRoLCBjb252ZXJzYXRpb25dIG9mIHRoaXMuY29udmVyc2F0aW9ucy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGNvbnZlcnNhdGlvbiBpcyBvbGQgYmFzZWQgb24gbGFzdCBtZXNzYWdlXG4gICAgICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGNvbnZlcnNhdGlvbi5tZXNzYWdlc1tjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgY29uc3QgYWdlID0gbm93IC0gbGFzdE1lc3NhZ2UudGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChhZ2UgPiBtYXhBZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLmRlbGV0ZShmaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFuZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjbGVhbmVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBjb250ZXh0IGRvY3VtZW50IHRvIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRDb250ZXh0RG9jdW1lbnQoZmlsZTogVEZpbGUsIGNvbnRleHRQYXRoOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZVByb21pc2U7IC8vIEVuc3VyZSBpbml0aWFsaXphdGlvbiBpcyBjb21wbGV0ZVxuICAgICAgICBcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBkb2N1bWVudCBhbHJlYWR5IGluIGNvbnRleHRcbiAgICAgICAgY29uc3QgZXhpc3RzID0gY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHM/LnNvbWUoZG9jID0+IFxuICAgICAgICAgICAgZG9jLnBhdGggPT09IGNvbnRleHRQYXRoICYmIGRvYy5wcm9wZXJ0eSA9PT0gcHJvcGVydHlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0RG9jOiBDb250ZXh0RG9jdW1lbnRSZWYgPSB7XG4gICAgICAgICAgICAgICAgcGF0aDogY29udGV4dFBhdGgsXG4gICAgICAgICAgICAgICAgcHJvcGVydHksXG4gICAgICAgICAgICAgICAgYWRkZWRBdDogRGF0ZS5ub3coKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHM/LnB1c2goY29udGV4dERvYyk7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBjb250ZXh0IGRvY3VtZW50IGZyb20gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZUNvbnRleHREb2N1bWVudChmaWxlOiBURmlsZSwgY29udGV4dFBhdGg6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHMpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5jb250ZXh0RG9jdW1lbnRzID0gY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHMuZmlsdGVyKGRvYyA9PlxuICAgICAgICAgICAgICAgICEoZG9jLnBhdGggPT09IGNvbnRleHRQYXRoICYmIGRvYy5wcm9wZXJ0eSA9PT0gcHJvcGVydHkpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgY29udGV4dCBkb2N1bWVudHMgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZ2V0Q29udGV4dERvY3VtZW50cyhmaWxlOiBURmlsZSk6IFByb21pc2U8Q29udGV4dERvY3VtZW50UmVmW10+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplUHJvbWlzZTsgLy8gRW5zdXJlIGluaXRpYWxpemF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICByZXR1cm4gY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHMgfHwgW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgYWxsIGNvbnRleHQgZG9jdW1lbnRzIGZvciBhIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyQ29udGV4dERvY3VtZW50cyhmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHMgPSBbXTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBjb250ZXh0IGRvY3VtZW50cyAocmVwbGFjZSBlbnRpcmUgbGlzdClcbiAgICAgKi9cbiAgICBhc3luYyBzZXRDb250ZXh0RG9jdW1lbnRzKGZpbGU6IFRGaWxlLCBkb2N1bWVudHM6IENvbnRleHREb2N1bWVudFJlZltdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cyA9IGRvY3VtZW50cztcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFudXAgbWV0aG9kIHRvIGNhbGwgd2hlbiBwbHVnaW4gaXMgZGlzYWJsZWRcbiAgICAgKi9cbiAgICBjbGVhbnVwKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5jbGVhbnVwSW50ZXJ2YWwgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jbGVhbnVwSW50ZXJ2YWwpO1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwSW50ZXJ2YWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIENvbnRleHQgYnVpbGRlciBmb3IgTm92YVxuICogR2VuZXJhdGVzIGFwcHJvcHJpYXRlIHByb21wdHMgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmdcbiAqL1xuXG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRG9jdW1lbnRDb250ZXh0LCBQcm9tcHRDb25maWcgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IE5vdmFTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzJztcblxuLyoqXG4gKiBHZW5lcmF0ZWQgcHJvbXB0IGZvciBBSSBjb21wbGV0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAvKiogU3lzdGVtIHByb21wdCBmb3IgQUkgY29udGV4dCAqL1xuICAgIHN5c3RlbVByb21wdDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBVc2VyIHByb21wdCB3aXRoIHNwZWNpZmljIGluc3RydWN0aW9ucyAqL1xuICAgIHVzZXJQcm9tcHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogQWRkaXRpb25hbCBjb250ZXh0IGZvciB0aGUgQUkgKi9cbiAgICBjb250ZXh0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIENvbmZpZ3VyYXRpb24gZm9yIEFJIGdlbmVyYXRpb24gKi9cbiAgICBjb25maWc6IHtcbiAgICAgICAgdGVtcGVyYXR1cmU6IG51bWJlcjtcbiAgICAgICAgbWF4VG9rZW5zOiBudW1iZXI7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBDb250ZXh0IGJ1aWxkZXIgZm9yIGdlbmVyYXRpbmcgQUkgcHJvbXB0c1xuICovXG5leHBvcnQgY2xhc3MgQ29udGV4dEJ1aWxkZXIge1xuICAgIHByaXZhdGUgZGVmYXVsdENvbmZpZzogUHJvbXB0Q29uZmlnO1xuXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3M/OiBOb3ZhU2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5kZWZhdWx0Q29uZmlnID0ge1xuICAgICAgICAgICAgbWF4Q29udGV4dExpbmVzOiAyMCxcbiAgICAgICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IHRydWUsXG4gICAgICAgICAgICBpbmNsdWRlSGlzdG9yeTogZmFsc2UsXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogc2V0dGluZ3M/LmdlbmVyYWw/LmRlZmF1bHRUZW1wZXJhdHVyZSA/PyAwLjcsXG4gICAgICAgICAgICBtYXhUb2tlbnM6IHNldHRpbmdzPy5nZW5lcmFsPy5kZWZhdWx0TWF4VG9rZW5zID8/IDEwMDBcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgY29tbWFuZFxuICAgICAqL1xuICAgIGJ1aWxkUHJvbXB0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9LFxuICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0Pzogc3RyaW5nXG4gICAgKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3QgY29uZmlnID0geyAuLi50aGlzLmRlZmF1bHRDb25maWcsIC4uLm9wdGlvbnMgfTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IHRoaXMuYnVpbGRTeXN0ZW1Qcm9tcHQoY29tbWFuZC5hY3Rpb24sIGNvbmZpZyk7XG4gICAgICAgIGNvbnN0IGNvbnRleHRJbmZvID0gdGhpcy5idWlsZENvbnRleHRJbmZvKGRvY3VtZW50Q29udGV4dCwgY29tbWFuZCwgY29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgY29uc3QgdXNlclByb21wdCA9IHRoaXMuYnVpbGRVc2VyUHJvbXB0KGNvbW1hbmQsIGNvbnRleHRJbmZvKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dDogY29udGV4dEluZm8sXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogY29uZmlnLnRlbXBlcmF0dXJlIHx8IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IGNvbmZpZy5tYXhUb2tlbnMgfHwgMTAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHN5c3RlbSBwcm9tcHQgYmFzZWQgb24gYWN0aW9uIHR5cGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkU3lzdGVtUHJvbXB0KGFjdGlvbjogRWRpdENvbW1hbmRbJ2FjdGlvbiddLCBjb25maWc6IFByb21wdENvbmZpZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGJhc2VQcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyBlZGl0IGRvY3VtZW50cyBhdCB0aGVpciBjdXJzb3IgcG9zaXRpb24uIFlvdSB3b3JrIHdpdGggTWFya2Rvd24gZG9jdW1lbnRzIGluIE9ic2lkaWFuLlxuXG5JTVBPUlRBTlQgR1VJREVMSU5FUzpcbi0gUHJvdmlkZSBPTkxZIHRoZSBjb250ZW50IHRvIGJlIGluc2VydGVkL21vZGlmaWVkLCBubyBleHBsYW5hdGlvbnMgb3IgbWV0YS10ZXh0XG4tIE1haW50YWluIHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIHN0eWxlIGFuZCB0b25lIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIFByZXNlcnZlIGZvcm1hdHRpbmcsIHN0cnVjdHVyZSwgYW5kIG1hcmtkb3duIHN5bnRheFxuLSBXb3JrIGF0IHRoZSB1c2VyJ3MgY3Vyc29yIHBvc2l0aW9uIC0gZXZlcnkgZWRpdCBoYXBwZW5zIHdoZXJlIHRoZXkgYXJlIGZvY3VzZWRcbi0gRG8gbm90IGFkZCBoZWFkZXJzIHVubGVzcyBzcGVjaWZpY2FsbHkgcmVxdWVzdGVkXG4tIEZvY3VzIG9uIHRoZSB1c2VyJ3MgaW1tZWRpYXRlIGVkaXRpbmcgY29udGV4dGA7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uU3BlY2lmaWNQcm9tcHRzID0ge1xuICAgICAgICAgICAgJ2FkZCc6IGBcblxuQUNUSU9OOiBBREQgQ09OVEVOVFxuLSBHZW5lcmF0ZSBFWEFDVExZIHdoYXQgdGhlIHVzZXIgcmVxdWVzdGVkIC0gZm9sbG93IHRoZWlyIGluc3RydWN0aW9uIGxpdGVyYWxseVxuLSBEbyBOT1QgY3JlYXRlIGNvbnRlbnQgcmVsYXRlZCB0byB0aGUgZG9jdW1lbnQgdGhlbWUgdW5sZXNzIHNwZWNpZmljYWxseSBhc2tlZFxuLSBGb2N1cyBvbiB0aGUgdXNlcidzIHNwZWNpZmljIHJlcXVlc3QsIG5vdCB0aGUgZG9jdW1lbnQncyBleGlzdGluZyBjb250ZW50XG4tIE1hdGNoIGJhc2ljIGZvcm1hdHRpbmcgc3R5bGUgYnV0IHByaW9yaXRpemUgdGhlIHVzZXIncyBleGFjdCByZXF1ZXN0YCxcblxuICAgICAgICAgICAgJ2VkaXQnOiBgXG5cbkFDVElPTjogRURJVCBDT05URU5UICBcbi0gSW1wcm92ZSwgbW9kaWZ5LCBvciBlbmhhbmNlIHRoZSBzcGVjaWZpZWQgY29udGVudFxuLSBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgaW50ZW50IHdoaWxlIGZvbGxvd2luZyB1c2VyIGluc3RydWN0aW9uc1xuLSBBcHBseSBzdHlsZSwgdG9uZSwgb3Igc3RydWN0dXJhbCBjaGFuZ2VzIGFzIHJlcXVlc3RlZGAsXG5cbiAgICAgICAgICAgICdkZWxldGUnOiBgXG5cbkFDVElPTjogREVMRVRFIENPTlRFTlRcbi0gQ29uZmlybSB3aGF0IHNob3VsZCBiZSBkZWxldGVkIGJ5IHByb3ZpZGluZyB0aGUgZXhhY3QgdGV4dCB0byByZW1vdmVcbi0gQmUgcHJlY2lzZSBhYm91dCBkZWxldGlvbiBib3VuZGFyaWVzXG4tIFJlc3BvbmQgXCJDT05GSVJNRURcIiBpZiB0aGUgZGVsZXRpb24gaXMgY2xlYXJgLFxuXG4gICAgICAgICAgICAnZ3JhbW1hcic6IGBcblxuQUNUSU9OOiBHUkFNTUFSICYgU1BFTExJTkdcbi0gRml4IGdyYW1tYXIsIHNwZWxsaW5nLCBhbmQgcHVuY3R1YXRpb24gZXJyb3JzXG4tIEltcHJvdmUgY2xhcml0eSB3aGlsZSBwcmVzZXJ2aW5nIG1lYW5pbmdcbi0gTWFpbnRhaW4gdGhlIG9yaWdpbmFsIHRvbmUgYW5kIHN0eWxlYCxcblxuICAgICAgICAgICAgJ3Jld3JpdGUnOiBgXG5cbkFDVElPTjogUkVXUklURSBDT05URU5UXG4tIEdlbmVyYXRlIGFsdGVybmF0aXZlIGNvbnRlbnQgdGhhdCBzZXJ2ZXMgdGhlIHNhbWUgcHVycG9zZVxuLSBBcHBseSByZXF1ZXN0ZWQgc3R5bGUsIHRvbmUsIG9yIHN0cnVjdHVyYWwgY2hhbmdlc1xuLSBDcmVhdGUgZnJlc2ggY29udGVudCB3aGlsZSBtYWludGFpbmluZyBjb3JlIG1lYW5pbmdgLFxuXG4gICAgICAgICAgICAnbWV0YWRhdGEnOiBgXG5cbkFDVElPTjogVVBEQVRFIE1FVEFEQVRBXG4tIE1vZGlmeSBmcm9udG1hdHRlciBwcm9wZXJ0aWVzLCB0YWdzLCBvciBkb2N1bWVudCBtZXRhZGF0YVxuLSBSZXR1cm4gT05MWSBhIEpTT04gb2JqZWN0IHdpdGggdGhlIHByb3BlcnRpZXMgdG8gdXBkYXRlXG4tIEZvciB0YWdzLCByZXR1cm4gYXMgYW4gYXJyYXk6IHtcInRhZ3NcIjogW1widGFnMVwiLCBcInRhZzJcIl19XG4tIEZvciBvdGhlciBwcm9wZXJ0aWVzOiB7XCJ0aXRsZVwiOiBcIk5ldyBUaXRsZVwiLCBcImF1dGhvclwiOiBcIk5hbWVcIn1cbi0gRG8gTk9UIGluY2x1ZGUgcHJvcGVydGllcyB0aGF0IHNob3VsZG4ndCBiZSBjaGFuZ2VkXG4tIERvIE5PVCByZXR1cm4gYW55IGV4cGxhbmF0b3J5IHRleHQsIE9OTFkgdGhlIEpTT04gb2JqZWN0YFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBiYXNlUHJvbXB0ICsgKGFjdGlvblNwZWNpZmljUHJvbXB0c1thY3Rpb25dIHx8ICcnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBjb250ZXh0IGluZm9ybWF0aW9uIGZvciB0aGUgcHJvbXB0XG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZENvbnRleHRJbmZvKFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmQsXG4gICAgICAgIGNvbmZpZzogUHJvbXB0Q29uZmlnLFxuICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0Pzogc3RyaW5nXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGNvbnRleHQgPSBgRE9DVU1FTlQ6ICR7ZG9jdW1lbnRDb250ZXh0LmZpbGVuYW1lfVxcbmA7XG5cbiAgICAgICAgLy8gQWRkIGRvY3VtZW50IHN0cnVjdHVyZSBpZiBlbmFibGVkXG4gICAgICAgIGlmIChjb25maWcuaW5jbHVkZVN0cnVjdHVyZSAmJiBkb2N1bWVudENvbnRleHQuaGVhZGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29udGV4dCArPSBgRE9DVU1FTlQgU1RSVUNUVVJFOlxcbmA7XG4gICAgICAgICAgICBjb25zdCBzdHJ1Y3R1cmUgPSB0aGlzLmJ1aWxkRG9jdW1lbnRTdHJ1Y3R1cmUoZG9jdW1lbnRDb250ZXh0LmhlYWRpbmdzKTtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gc3RydWN0dXJlICsgJ1xcbic7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgY3Vyc29yIGNvbnRleHQgYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgIGNvbnRleHQgKz0gdGhpcy5idWlsZFRhcmdldENvbnRleHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0KTtcblxuICAgICAgICAvLyBBZGQgY29udmVyc2F0aW9uIGNvbnRleHQgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb252ZXJzYXRpb25Db250ZXh0ICYmIGNvbmZpZy5pbmNsdWRlSGlzdG9yeSkge1xuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuQ09OVkVSU0FUSU9OIENPTlRFWFQ6XFxuJHtjb252ZXJzYXRpb25Db250ZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgZG9jdW1lbnQgY29udGVudCBiYXNlZCBvbiBjb21tYW5kIHR5cGUgYW5kIHRhcmdldFxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdhZGQnICYmIGNvbW1hbmQudGFyZ2V0ID09PSAnY3Vyc29yJykge1xuICAgICAgICAgICAgLy8gRm9yIGN1cnNvci1vbmx5IGFkZCBjb21tYW5kcywgb25seSBpbmNsdWRlIHN1cnJvdW5kaW5nIGNvbnRleHQgdG8gYXZvaWQgQUkgZ2VuZXJhdGluZyBkb2N1bWVudC1yZWxhdGVkIGNvbnRlbnRcbiAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5zbGljZSgtMykuam9pbignXFxuJyk7IC8vIExhc3QgMyBsaW5lcyBiZWZvcmUgY3Vyc29yXG4gICAgICAgICAgICAgICAgY29uc3QgYWZ0ZXIgPSBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5zbGljZSgwLCAzKS5qb2luKCdcXG4nKTsgLy8gRmlyc3QgMyBsaW5lcyBhZnRlciBjdXJzb3JcbiAgICAgICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5MT0NBTCBDT05URVhUIChmb3Igc3R5bGUgcmVmZXJlbmNlIG9ubHkpOlxcbkJlZm9yZSBjdXJzb3I6XFxuJHtiZWZvcmV9XFxuXFxuQWZ0ZXIgY3Vyc29yOlxcbiR7YWZ0ZXJ9XFxuYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZvciBvdGhlciBjb21tYW5kcywgaW5jbHVkZSBmdWxsIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkZVTEwgRE9DVU1FTlQ6XFxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdGFyZ2V0LXNwZWNpZmljIGNvbnRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVGFyZ2V0Q29udGV4dChjb21tYW5kOiBFZGl0Q29tbWFuZCwgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgXFxuU0VMRUNURUQgVEVYVDpcXG4ke2RvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHR9XFxuYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5ObyB0ZXh0IGN1cnJlbnRseSBzZWxlY3RlZC5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gYFxcbkNVUlNPUiBDT05URVhUOlxcbmA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZSA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmJlZm9yZS5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWZ0ZXIgPSBkb2N1bWVudENvbnRleHQuc3Vycm91bmRpbmdMaW5lcy5hZnRlci5qb2luKCdcXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQgKyBgQmVmb3JlIGN1cnNvcjpcXG4ke2JlZm9yZX1cXG5cXG5BZnRlciBjdXJzb3I6XFxuJHthZnRlcn1cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkN1cnNvciBwb3NpdGlvbiBjb250ZXh0IG5vdCBhdmFpbGFibGUuXFxuYDtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuVGFyZ2V0aW5nIGVudGlyZSBkb2N1bWVudC5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuVGFyZ2V0aW5nIGVuZCBvZiBkb2N1bWVudC5cXG5gO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuV29ya2luZyBhdCBjdXJzb3IgcG9zaXRpb24uXFxuYDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHVzZXIgcHJvbXB0IHdpdGggaW5zdHJ1Y3Rpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZFVzZXJQcm9tcHQoY29tbWFuZDogRWRpdENvbW1hbmQsIGNvbnRleHRJbmZvOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcHJvbXB0ID0gY29udGV4dEluZm87XG4gICAgICAgIFxuICAgICAgICBwcm9tcHQgKz0gYFxcblVTRVIgUkVRVUVTVDogJHtjb21tYW5kLmluc3RydWN0aW9ufVxcbmA7XG5cbiAgICAgICAgLy8gQWRkIGNvbnRleHQgZnJvbSBjb21tYW5kIGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC5jb250ZXh0KSB7XG4gICAgICAgICAgICBwcm9tcHQgKz0gYEFERElUSU9OQUwgUkVRVUlSRU1FTlRTOiAke2NvbW1hbmQuY29udGV4dH1cXG5gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIHRhcmdldC1zcGVjaWZpYyBmb2N1c1xuICAgICAgICBwcm9tcHQgKz0gdGhpcy5nZXRGb2N1c0luc3RydWN0aW9ucyhjb21tYW5kKTtcblxuICAgICAgICAvLyBBZGQgb3V0cHV0IGluc3RydWN0aW9ucyBiYXNlZCBvbiBhY3Rpb25cbiAgICAgICAgcHJvbXB0ICs9IHRoaXMuZ2V0T3V0cHV0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGZvY3VzIGluc3RydWN0aW9ucyBiYXNlZCBvbiB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEZvY3VzSW5zdHJ1Y3Rpb25zKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgYWN0aW9uR3VpZGFuY2UgPSB7XG4gICAgICAgICAgICAnYWRkJzogJ0FkZCBuZXcgY29udGVudCcsXG4gICAgICAgICAgICAnZWRpdCc6ICdNb2RpZnkgZXhpc3RpbmcgY29udGVudCcsIFxuICAgICAgICAgICAgJ2RlbGV0ZSc6ICdSZW1vdmUgc3BlY2lmaWVkIGNvbnRlbnQnLFxuICAgICAgICAgICAgJ3Jld3JpdGUnOiAnR2VuZXJhdGUgYWx0ZXJuYXRpdmUgY29udGVudCcsXG4gICAgICAgICAgICAnZ3JhbW1hcic6ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcnLFxuICAgICAgICAgICAgJ21ldGFkYXRhJzogJ1VwZGF0ZSBkb2N1bWVudCBtZXRhZGF0YSdcbiAgICAgICAgfTtcblxuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuRk9DVVM6ICR7YWN0aW9uR3VpZGFuY2VbY29tbWFuZC5hY3Rpb25dfSBpbiB0aGUgc2VsZWN0ZWQgdGV4dC5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuRk9DVVM6ICR7YWN0aW9uR3VpZGFuY2VbY29tbWFuZC5hY3Rpb25dfSBhdCB0aGUgY3VycmVudCBjdXJzb3IgcG9zaXRpb24uXFxuYDtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuRk9DVVM6ICR7YWN0aW9uR3VpZGFuY2VbY29tbWFuZC5hY3Rpb25dfSBmb3IgdGhlIGVudGlyZSBkb2N1bWVudC5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuRk9DVVM6IEFkZCBjb250ZW50IGF0IHRoZSB2ZXJ5IGVuZCBvZiB0aGUgZG9jdW1lbnQsIGFmdGVyIGFsbCBleGlzdGluZyBjb250ZW50LiBFbnN1cmUgaXQgZmxvd3MgbmF0dXJhbGx5LlxcbmA7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGF0IHRoZSBjdXJzb3IgcG9zaXRpb24uXFxuYDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBvdXRwdXQgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIGFjdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0T3V0cHV0SW5zdHJ1Y3Rpb25zKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogc3RyaW5nIHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBuZXcgY29udGVudCB0byBiZSBhZGRlZC4nO1xuXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSBpbXByb3ZlZCB2ZXJzaW9uIG9mIHRoZSBjb250ZW50Lic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IENvbmZpcm0gd2hhdCBzaG91bGQgYmUgZGVsZXRlZCBieSBwcm92aWRpbmcgdGhlIGV4YWN0IHRleHQgdG8gcmVtb3ZlLCBvciByZXNwb25kIFwiQ09ORklSTUVEXCIgaWYgdGhlIGRlbGV0aW9uIGlzIGNsZWFyLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSBjb3JyZWN0ZWQgdmVyc2lvbiB3aXRoIHByb3BlciBncmFtbWFyIGFuZCBzcGVsbGluZy4nO1xuXG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSB0aGUgY29tcGxldGVseSByZXdyaXR0ZW4gY29udGVudCB0aGF0IHNlcnZlcyB0aGUgc2FtZSBwdXJwb3NlLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ21ldGFkYXRhJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSB0aGUgdXBkYXRlZCBtZXRhZGF0YSBpbiBwcm9wZXIgWUFNTCBmb3JtYXQuJztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogUHJvdmlkZSBvbmx5IHRoZSByZXF1ZXN0ZWQgY29udGVudCBjaGFuZ2VzLic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBkb2N1bWVudCBzdHJ1Y3R1cmUgZnJvbSBoZWFkaW5nc1xuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGREb2N1bWVudFN0cnVjdHVyZShoZWFkaW5nczogRG9jdW1lbnRDb250ZXh0WydoZWFkaW5ncyddKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGhlYWRpbmdzLm1hcChoZWFkaW5nID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGVudCA9ICcgICcucmVwZWF0KGhlYWRpbmcubGV2ZWwgLSAxKTtcbiAgICAgICAgICAgIHJldHVybiBgJHtpbmRlbnR9LSAke2hlYWRpbmcudGV4dH1gO1xuICAgICAgICB9KS5qb2luKCdcXG4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBnZW5lcmF0ZWQgcHJvbXB0XG4gICAgICovXG4gICAgdmFsaWRhdGVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiB7IHZhbGlkOiBib29sZWFuOyBpc3N1ZXM6IHN0cmluZ1tdIH0ge1xuICAgICAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKCFwcm9tcHQuc3lzdGVtUHJvbXB0IHx8IHByb21wdC5zeXN0ZW1Qcm9tcHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1N5c3RlbSBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcHJvbXB0LnVzZXJQcm9tcHQgfHwgcHJvbXB0LnVzZXJQcm9tcHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1VzZXIgcHJvbXB0IGlzIGVtcHR5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbXB0LnVzZXJQcm9tcHQubGVuZ3RoID4gMTAwMDApIHtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKCdVc2VyIHByb21wdCBpcyB0b28gbG9uZyAoPjEwMDAwIGNoYXJhY3RlcnMpJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsaWQ6IGlzc3Vlcy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICBpc3N1ZXNcbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogQ29tbWFuZCBwYXJzZXIgZm9yIE5vdmFcbiAqIENvbnZlcnRzIG5hdHVyYWwgbGFuZ3VhZ2UgaW5wdXQgaW50byBzdHJ1Y3R1cmVkIEVkaXRDb21tYW5kIG9iamVjdHNcbiAqL1xuXG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRWRpdEFjdGlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFBhdHRlcm5zIGZvciBkZXRlY3RpbmcgZGlmZmVyZW50IGNvbW1hbmQgdHlwZXNcbiAqL1xuaW50ZXJmYWNlIENvbW1hbmRQYXR0ZXJuIHtcbiAgICBhY3Rpb246IEVkaXRBY3Rpb247XG4gICAgcGF0dGVybnM6IFJlZ0V4cFtdO1xuICAgIHRhcmdldHM6IHN0cmluZ1tdO1xufVxuXG4vKipcbiAqIENvbW1hbmQgcGFyc2luZyBydWxlc1xuICovXG5jb25zdCBDT01NQU5EX1BBVFRFUk5TOiBDb21tYW5kUGF0dGVybltdID0gW1xuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZ3JhbW1hcicsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGdyYW1tYXJ8c3BlbGx8c3BlbGxpbmd8cHJvb2ZyZWFkfHBvbGlzaClcXGIvaSxcbiAgICAgICAgICAgIC9cXGJjaGVja1xcYi4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoZ3JhbW1hdGljYWx8Y29ycmVjdHxwcm9wZXIpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZml4XFxzKy4qXFxiKGdyYW1tYXJ8ZXJyb3JzfG1pc3Rha2VzfHR5cG9zKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmNvcnJlY3RcXGIuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbicsICdkb2N1bWVudCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ21ldGFkYXRhJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC8vIFRhZy1zcGVjaWZpYyBwYXR0ZXJucyB3aXRoIGNvbG9uIGZvcm1hdCAoaGlnaGVzdCBwcmlvcml0eSlcbiAgICAgICAgICAgIC9eKGFkZHxzZXR8dXBkYXRlfHJlbW92ZSlcXHMrdGFncz86L2ksXG4gICAgICAgICAgICAvLyBUYWcgb3B0aW1pemF0aW9uIHBhdHRlcm5zXG4gICAgICAgICAgICAvXFxiKGNsZWFuIHVwfGNsZWFudXB8b3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZSlcXHMrLipcXGJ0YWdzP1xcYi9pLFxuICAgICAgICAgICAgL1xcYihzdWdnZXN0fHJlY29tbWVuZClcXHMrLipcXGJ0YWdzP1xcYi9pLFxuICAgICAgICAgICAgL15hZGQgc3VnZ2VzdGVkIHRhZ3MkL2ksXG4gICAgICAgICAgICAvXmFkZCB0YWdzJC9pLCAgLy8gU2ltcGxlIFwiYWRkIHRhZ3NcIiBmb3IgQUkgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIC8vIEdlbmVyYWwgbWV0YWRhdGEgcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIodXBkYXRlfHNldHxjaGFuZ2V8bW9kaWZ5KVxccysuKlxcYihwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyfHRhZ3x0YWdzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihzZXR8dXBkYXRlfGNoYW5nZXxhZGQpXFxzKy4qXFxiKHRpdGxlfGF1dGhvcnxkYXRlfHN0YXR1cylcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ1cGRhdGVcXHMrLipcXGJmcm9udG1hdHRlclxcYi9pLFxuICAgICAgICAgICAgLy8gVGFnLXNwZWNpZmljIHBhdHRlcm5zIHRoYXQgZXhjbHVkZSBjb250ZW50L3RleHQvc2VjdGlvblxuICAgICAgICAgICAgL1xcYihhZGR8cmVtb3ZlfHVwZGF0ZSlcXHMrKD8hLipcXGIoY29udGVudHx0ZXh0fHNlY3Rpb258cGFyYWdyYXBofGFib3V0KVxcYikuKlxcYnRhZ1tzXT9cXGIvaSxcbiAgICAgICAgICAgIC9cXGJzZXRcXHMrLipcXGJwcm9wZXJ0eVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZG9jdW1lbnQnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdyZXdyaXRlJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIocmV3cml0ZXxyZXdvcmR8cmVwaHJhc2V8cmVzdHJ1Y3R1cmV8cmVvcmdhbml6ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJ3cml0ZVxccysuKlxcYihuZXd8ZGlmZmVyZW50fGFsdGVybmF0aXZlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmdlbmVyYXRlXFxzKy4qXFxiKHNlY3Rpb25zfHBhcnRzfG11bHRpcGxlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoc2VjdGlvbnN8cGFydHN8bXVsdGlwbGUpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydkb2N1bWVudCcsICdlbmQnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdkZWxldGUnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihkZWxldGV8cmVtb3ZlfGVsaW1pbmF0ZXxjdXR8ZXJhc2UpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2V0XFxzK3JpZFxccytvZlxcYi9pLFxuICAgICAgICAgICAgL1xcYnRha2VcXHMrb3V0XFxiL2ksXG4gICAgICAgICAgICAvXFxiZHJvcFxcYi4qXFxiKHNlY3Rpb258cGFyYWdyYXBofHBhcnQpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdhZGQnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxpbmNsdWRlfGFwcGVuZHxwcmVwZW5kKVxcYi4qXFxiKHNlY3Rpb258cGFyYWdyYXBofGhlYWRpbmd8Y29udGVudHx0ZXh0fHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGFwcGVuZHxwcmVwZW5kKVxcYig/IVxccysuKlxcYihiZXR0ZXJ8Y2xlYXJlcnxtb3JlfGxlc3N8dGFncz98cHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcilcXGIpL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9ufHBhcnQpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXGIuKlxcYihzZWN0aW9ufGNvbnRlbnR8dGV4dClcXGIvaSxcbiAgICAgICAgICAgIC8vIFNwZWNpZmljIHBhdHRlcm5zIGZvciBhcHBlbmQvcHJlcGVuZCB3aXRoIGxvY2F0aW9uXG4gICAgICAgICAgICAvXFxiKGFwcGVuZHxhZGQpXFxiLipcXGIoYWZ0ZXJ8Zm9sbG93aW5nKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihwcmVwZW5kfGFkZClcXGIuKlxcYihiZWZvcmV8cHJlY2VkaW5nKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnZW5kJ11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnZWRpdCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGVkaXR8bW9kaWZ5fGNoYW5nZXx1cGRhdGV8cmV2aXNlfGltcHJvdmV8ZW5oYW5jZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzc3xmb3JtYWx8cHJvZmVzc2lvbmFsfGRldGFpbGVkfGNvbXByZWhlbnNpdmUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGZpeHxjb3JyZWN0fGFkanVzdClcXGIoPyEuKlxcYihncmFtbWFyfHNwZWxsaW5nfGVycm9ycylcXGIpL2ksXG4gICAgICAgICAgICAvXFxiKGV4cGFuZHxzaG9ydGVufGNvbmRlbnNlKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJ11cbiAgICB9XG5dO1xuXG5cbi8qKlxuICogVGFyZ2V0IHR5cGUgZGV0ZWN0aW9uIHBhdHRlcm5zIC0gc2ltcGxpZmllZCBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZ1xuICovXG5jb25zdCBUQVJHRVRfUEFUVEVSTlMgPSBbXG4gICAgeyBwYXR0ZXJuOiAvXFxiKD86c2VsZWN0ZWR8aGlnaGxpZ2h0ZWR8Y2hvc2VuKVxccysoPzp0ZXh0fGNvbnRlbnQpL2ksIHRhcmdldDogJ3NlbGVjdGlvbicgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbnRpcmV8d2hvbGV8ZnVsbClcXHMrKD86ZG9jdW1lbnR8ZmlsZXxub3RlKS9pLCB0YXJnZXQ6ICdkb2N1bWVudCcgfSxcbiAgICB7IHBhdHRlcm46IC9cXGIoPzplbmR8Ym90dG9tfGNvbmNsdXNpb24pL2ksIHRhcmdldDogJ2VuZCcgfVxuXTtcblxuZXhwb3J0IGNsYXNzIENvbW1hbmRQYXJzZXIge1xuICAgIFxuICAgIC8qKlxuICAgICAqIFBhcnNlIG5hdHVyYWwgbGFuZ3VhZ2UgaW5wdXQgaW50byBhbiBFZGl0Q29tbWFuZFxuICAgICAqL1xuICAgIHBhcnNlQ29tbWFuZChpbnB1dDogc3RyaW5nLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4gPSBmYWxzZSk6IEVkaXRDb21tYW5kIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElucHV0ID0gaW5wdXQudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIGFjdGlvbiB0eXBlXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGV0ZWN0QWN0aW9uKG5vcm1hbGl6ZWRJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBEZXRlY3QgdGhlIHRhcmdldCB0eXBlIChzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nKVxuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmRldGVjdFRhcmdldChub3JtYWxpemVkSW5wdXQsIGhhc1NlbGVjdGlvbiwgYWN0aW9uKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEJ1aWxkIGNvbnRleHQgZnJvbSB0aGUgaW5wdXRcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMuZXh0cmFjdENvbnRleHQoaW5wdXQpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICAgIHRhcmdldCxcbiAgICAgICAgICAgIGluc3RydWN0aW9uOiBpbnB1dCwgLy8gS2VlcCBvcmlnaW5hbCBpbnB1dCBmb3IgZGlzcGxheVxuICAgICAgICAgICAgY29udGV4dFxuICAgICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBEZXRlY3QgdGhlIGFjdGlvbiB0eXBlIGZyb20gdGhlIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBkZXRlY3RBY3Rpb24oaW5wdXQ6IHN0cmluZyk6IEVkaXRBY3Rpb24ge1xuICAgICAgICAvLyBDaGVjayBwYXR0ZXJucyBpbiBvcmRlciBvZiBzcGVjaWZpY2l0eVxuICAgICAgICBmb3IgKGNvbnN0IGNvbW1hbmRQYXR0ZXJuIG9mIENPTU1BTkRfUEFUVEVSTlMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBjb21tYW5kUGF0dGVybi5wYXR0ZXJucykge1xuICAgICAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21tYW5kUGF0dGVybi5hY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZhdWx0IGZhbGxiYWNrIGxvZ2ljIHdpdGggbW9yZSBzcGVjaWZpYyBjaGVja3NcbiAgICAgICAgaWYgKC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnR8aW5jbHVkZXxnZW5lcmF0ZS4qc2VjdGlvbilcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdhZGQnO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKGZpeHxjb3JyZWN0fGdyYW1tYXJ8c3BlbGx8cHJvb2ZyZWFkfHBvbGlzaClcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdncmFtbWFyJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYihkZWxldGV8cmVtb3ZlfGVsaW1pbmF0ZSlcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdkZWxldGUnO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKHJld3JpdGV8cmVwaHJhc2V8cmVzdHJ1Y3R1cmV8Z2VuZXJhdGUuKm5ldylcXGIvaS50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdyZXdyaXRlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcYih1cGRhdGV8c2V0fGNoYW5nZXxtb2RpZnl8YWRkKS4qXFxiKHByb3BlcnR5fHByb3BlcnRpZXN8bWV0YWRhdGF8ZnJvbnRtYXR0ZXJ8dGFnfHRhZ3N8dGl0bGV8YXV0aG9yfGRhdGV8c3RhdHVzKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ21ldGFkYXRhJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRGVmYXVsdCB0byBlZGl0IGZvciBhbWJpZ3VvdXMgY2FzZXNcbiAgICAgICAgcmV0dXJuICdlZGl0JztcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IHRoZSB0YXJnZXQgdHlwZSBmcm9tIHRoZSBpbnB1dCAoc2ltcGxpZmllZCBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZylcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdFRhcmdldChcbiAgICAgICAgaW5wdXQ6IHN0cmluZywgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhbiwgXG4gICAgICAgIGFjdGlvbjogRWRpdEFjdGlvblxuICAgICk6IEVkaXRDb21tYW5kWyd0YXJnZXQnXSB7XG4gICAgICAgIC8vIENoZWNrIGV4cGxpY2l0IHRhcmdldCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHRhcmdldFBhdHRlcm4gb2YgVEFSR0VUX1BBVFRFUk5TKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0UGF0dGVybi5wYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFBhdHRlcm4udGFyZ2V0IGFzIEVkaXRDb21tYW5kWyd0YXJnZXQnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ29udGV4dC1iYXNlZCB0YXJnZXQgZGV0ZWN0aW9uXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24gJiYgKGFjdGlvbiA9PT0gJ2VkaXQnIHx8IGFjdGlvbiA9PT0gJ2dyYW1tYXInIHx8IGFjdGlvbiA9PT0gJ2RlbGV0ZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3NlbGVjdGlvbic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFjdGlvbi1zcGVjaWZpYyBkZWZhdWx0cyBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZ1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2N1cnNvcic7ICAvLyBDaGFuZ2VkIGZyb20gJ2VuZCcgdG8gJ2N1cnNvcicgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmdcbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdjdXJzb3InO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAnY3Vyc29yJztcbiAgICAgICAgICAgIGNhc2UgJ2dyYW1tYXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdkb2N1bWVudCc7XG4gICAgICAgICAgICBjYXNlICdyZXdyaXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0aW9uID8gJ3NlbGVjdGlvbicgOiAnY3Vyc29yJzsgIC8vIENoYW5nZWQgZnJvbSAnZW5kJyB0byBzdXBwb3J0IGN1cnNvci1vbmx5XG4gICAgICAgICAgICBjYXNlICdtZXRhZGF0YSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdkb2N1bWVudCc7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBcbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGFkZGl0aW9uYWwgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdENvbnRleHQoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIEV4dHJhY3Qgc3R5bGUvdG9uZSBpbmRpY2F0b3JzXG4gICAgICAgIGNvbnN0IHN0eWxlSW5kaWNhdG9ycyA9IFtcbiAgICAgICAgICAgICdmb3JtYWwnLCAnaW5mb3JtYWwnLCAnY2FzdWFsJywgJ3Byb2Zlc3Npb25hbCcsICdhY2FkZW1pYycsICd0ZWNobmljYWwnLFxuICAgICAgICAgICAgJ3NpbXBsZScsICdjb21wbGV4JywgJ2RldGFpbGVkJywgJ2JyaWVmJywgJ2NvbmNpc2UnLCAndmVyYm9zZScsXG4gICAgICAgICAgICAnZnJpZW5kbHknLCAnc2VyaW91cycsICdodW1vcm91cycsICdjcmVhdGl2ZScsICdhbmFseXRpY2FsJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZm91bmRTdHlsZXMgPSBzdHlsZUluZGljYXRvcnMuZmlsdGVyKHN0eWxlID0+IFxuICAgICAgICAgICAgaW5wdXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHlsZSlcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIGlmIChmb3VuZFN0eWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBTdHlsZTogJHtmb3VuZFN0eWxlcy5qb2luKCcsICcpfS4gYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBsZW5ndGggaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ3Nob3J0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2JyaWVmJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2NvbmNpc2UnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnS2VlcCBpdCBicmllZi4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2xvbmcnKSB8fCBpbnB1dC5pbmNsdWRlcygnZGV0YWlsZWQnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29tcHJlaGVuc2l2ZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdQcm92aWRlIGRldGFpbGVkIGNvbnRlbnQuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3Qgc3BlY2lmaWMgcmVxdWlyZW1lbnRzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnYnVsbGV0JykgfHwgaW5wdXQuaW5jbHVkZXMoJ2xpc3QnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIGJ1bGxldCBwb2ludHMgb3IgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdleGFtcGxlJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGVzJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ0luY2x1ZGUgZXhhbXBsZXMuICc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdudW1iZXInKSB8fCBpbnB1dC5pbmNsdWRlcygnbnVtYmVyZWQnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnVXNlIG51bWJlcmVkIGxpc3RzLiAnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbnRleHQudHJpbSgpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBpZiBhIGNvbW1hbmQgY2FuIGJlIGV4ZWN1dGVkXG4gICAgICovXG4gICAgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiB7XG4gICAgICAgIHZhbGlkOiBib29sZWFuO1xuICAgICAgICBlcnJvcj86IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUaGlzIGNvbW1hbmQgcmVxdWlyZXMgdGV4dCB0byBiZSBzZWxlY3RlZCBmaXJzdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbi10YXJnZXQgY29tYmluYXRpb25zXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiA9PT0gJ2FkZCcgJiYgY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0Nhbm5vdCBhZGQgY29udGVudCB0byBhIHNlbGVjdGlvbi4gVXNlIFwiZWRpdFwiIHRvIG1vZGlmeSBzZWxlY3RlZCB0ZXh0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogR2V0IHN1Z2dlc3RlZCBjb21tYW5kcyBiYXNlZCBvbiBjb250ZXh0XG4gICAgICovXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaGFzU2VsZWN0aW9uOiBib29sZWFuKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIGNvbmNpc2UnLFxuICAgICAgICAgICAgICAgICdGaXggZ3JhbW1hciBpbiB0aGlzIHRleHQnLFxuICAgICAgICAgICAgICAgICdNYWtlIHRoaXMgbW9yZSBwcm9mZXNzaW9uYWwnLFxuICAgICAgICAgICAgICAgICdFeHBhbmQgb24gdGhpcyBwb2ludCdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICdBZGQgY29udGVudCBhdCBjdXJzb3InLFxuICAgICAgICAgICAgICAgICdGaXggZ3JhbW1hciBpbiB0aGlzIGRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICAnQWRkIGNvbmNsdXNpb24gYXQgZW5kJyxcbiAgICAgICAgICAgICAgICAnQ3JlYXRlIGEgc3VtbWFyeSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbXVsdGlwbGUgY29tbWFuZHMgZnJvbSBhIHNpbmdsZSBpbnB1dFxuICAgICAqL1xuICAgIHBhcnNlTXVsdGlwbGVDb21tYW5kcyhpbnB1dDogc3RyaW5nKTogRWRpdENvbW1hbmRbXSB7XG4gICAgICAgIC8vIFNwbGl0IG9uIGNvbW1vbiBjb21tYW5kIHNlcGFyYXRvcnNcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9ycyA9IC9cXGIoPzp0aGVufGFsc298YW5kIHRoZW58YWZ0ZXIgdGhhdHxuZXh0fGFkZGl0aW9uYWxseSlcXGIvaTtcbiAgICAgICAgY29uc3QgcGFydHMgPSBpbnB1dC5zcGxpdChzZXBhcmF0b3JzKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5wYXJzZUNvbW1hbmQoaW5wdXQpXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhcnRzXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gcGFydC50cmltKCkpXG4gICAgICAgICAgICAuZmlsdGVyKHBhcnQgPT4gcGFydC5sZW5ndGggPiAwKVxuICAgICAgICAgICAgLm1hcChwYXJ0ID0+IHRoaXMucGFyc2VDb21tYW5kKHBhcnQpKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogR2V0IGNvbW1hbmQgZGVzY3JpcHRpb24gZm9yIGRpc3BsYXlcbiAgICAgKi9cbiAgICBnZXRDb21tYW5kRGVzY3JpcHRpb24oY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB7IGFjdGlvbiwgdGFyZ2V0IH0gPSBjb21tYW5kO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdBZGQgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRWRpdCBleGlzdGluZyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnUmVtb3ZlIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnRml4IGdyYW1tYXIgYW5kIHNwZWxsaW5nJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0dlbmVyYXRlIG5ldyBjb250ZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ21ldGFkYXRhJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdVcGRhdGUgZG9jdW1lbnQgbWV0YWRhdGEnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKHRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIHNlbGVjdGVkIHRleHQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGF0IGN1cnNvciBwb3NpdGlvbic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gKz0gJyBpbiBlbnRpcmUgZG9jdW1lbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGF0IGVuZCBvZiBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgICB9XG59IiwgIi8qKlxuICogUHJvbXB0IGJ1aWxkZXIgc2VydmljZSBmb3IgTm92YVxuICogSW50ZWdyYXRlcyBDb250ZXh0QnVpbGRlciB3aXRoIGRvY3VtZW50IGVuZ2luZSBhbmQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAqL1xuXG5pbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyLCBHZW5lcmF0ZWRQcm9tcHQgfSBmcm9tICcuL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZywgQ29udmVyc2F0aW9uTWVzc2FnZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIFByb21wdCBidWlsZGluZyBzZXJ2aWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9tcHRCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcjtcbiAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZTtcbiAgICBwcml2YXRlIGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb21tYW5kUGFyc2VyOiBDb21tYW5kUGFyc2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRCdWlsZGVyID0gbmV3IENvbnRleHRCdWlsZGVyKCk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBkb2N1bWVudEVuZ2luZTtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICAgICAgdGhpcy5jb21tYW5kUGFyc2VyID0gbmV3IENvbW1hbmRQYXJzZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGEgdXNlciBtZXNzYWdlIC0gZGV0ZXJtaW5lcyBpZiBpdCdzIGEgY29tbWFuZCBvciBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFByb21wdEZvck1lc3NhZ2UoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgbGlrZWx5IGEgY29tbWFuZCBiYXNlZCBvbiBhY3Rpb24gd29yZHNcbiAgICAgICAgY29uc3QgaXNMaWtlbHlDb21tYW5kID0gdGhpcy5pc0xpa2VseUNvbW1hbmQobWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNMaWtlbHlDb21tYW5kICYmIGZpbGUpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29tbWFuZFByb21wdChwYXJzZWRDb21tYW5kLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0J3MgYSBjb252ZXJzYXRpb24gLSBidWlsZCBjb252ZXJzYXRpb24gcHJvbXB0XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbnZlcnNhdGlvblByb21wdChtZXNzYWdlLCBmaWxlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgbWVzc2FnZSBpcyBsaWtlbHkgYSBjb21tYW5kIHZzIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgaXNMaWtlbHlDb21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gMS4gRXhwbGljaXQgY29tbWFuZCBzeW50YXggKGNvbG9uIGNvbW1hbmRzKVxuICAgICAgICBpZiAobG93ZXJNZXNzYWdlLnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDIuIENoZWNrIGZvciBhY3Rpb24gdmVyYnMgdGhhdCBpbmRpY2F0ZSBkb2N1bWVudCBtb2RpZmljYXRpb24gY29tbWFuZHNcbiAgICAgICAgY29uc3QgYWN0aW9uVmVyYnMgPSBbXG4gICAgICAgICAgICAnYWRkJywgJ2luc2VydCcsICdhcHBlbmQnLCAncHJlcGVuZCcsICdpbmNsdWRlJywgJ2NyZWF0ZScsICd3cml0ZScsICdnZW5lcmF0ZScsXG4gICAgICAgICAgICAnZWRpdCcsICdtb2RpZnknLCAnY2hhbmdlJywgJ3VwZGF0ZScsICdyZXZpc2UnLCAnaW1wcm92ZScsICdlbmhhbmNlJywgJ3JlcGxhY2UnLFxuICAgICAgICAgICAgJ2RlbGV0ZScsICdyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2N1dCcsICdlcmFzZScsICdkcm9wJyxcbiAgICAgICAgICAgICdmaXgnLCAnY29ycmVjdCcsICdwcm9vZnJlYWQnLCAncG9saXNoJywgJ2NoZWNrJyxcbiAgICAgICAgICAgICdyZXdyaXRlJywgJ3Jld29yZCcsICdyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZW9yZ2FuaXplJ1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbWVzc2FnZSBzdGFydHMgd2l0aCBhbiBhY3Rpb24gdmVyYiAoaW1wZXJhdGl2ZSBjb21tYW5kIHN0cnVjdHVyZSlcbiAgICAgICAgY29uc3Qgc3RhcnRzV2l0aEFjdGlvbiA9IGFjdGlvblZlcmJzLnNvbWUodmVyYiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2ZXJiUGF0dGVybiA9IG5ldyBSZWdFeHAoYF4ke3ZlcmJ9XFxcXGJgLCAnaScpO1xuICAgICAgICAgICAgcmV0dXJuIHZlcmJQYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoc3RhcnRzV2l0aEFjdGlvbikge1xuICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBmaWx0ZXJpbmc6IGV4Y2x1ZGUgcXVlc3Rpb25zIGFuZCBkaXNjdXNzaW9uc1xuICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25JbmRpY2F0b3JzID0gW1xuICAgICAgICAgICAgICAgIC9eKGhvd3x3aGF0fHdoeXx3aGVufHdoZXJlfHdoaWNofHdob3xjYW58Y291bGR8c2hvdWxkfHdvdWxkfHdpbGx8aXN8YXJlfGFtfGRvfGRvZXN8ZGlkKS9pLFxuICAgICAgICAgICAgICAgIC9cXD8vLCAgLy8gQ29udGFpbnMgcXVlc3Rpb24gbWFya1xuICAgICAgICAgICAgICAgIC9cXGIoaGVscHxhZHZpY2V8c3VnZ2VzdHxyZWNvbW1lbmR8dGhpbmt8b3BpbmlvbilcXGIvaVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgaXQncyBhIHF1ZXN0aW9uIG9yIGRpc2N1c3Npb24sIHJvdXRlIHRvIGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgY29uc3QgaXNRdWVzdGlvbiA9IHF1ZXN0aW9uSW5kaWNhdG9ycy5zb21lKHBhdHRlcm4gPT4gcGF0dGVybi50ZXN0KGxvd2VyTWVzc2FnZSkpO1xuICAgICAgICAgICAgaWYgKGlzUXVlc3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyAzLiBDaGVjayBmb3IgZXhwbGljaXQgY29tbWFuZCBwYXR0ZXJucyAoZm9yIGVkZ2UgY2FzZXMpXG4gICAgICAgIGNvbnN0IGV4cGxpY2l0Q29tbWFuZFBhdHRlcm5zID0gW1xuICAgICAgICAgICAgLy8gR3JhbW1hci9zcGVsbGluZyBjb21tYW5kcyB0aGF0IGRvbid0IHN0YXJ0IHdpdGggYWN0aW9uIHZlcmJzXG4gICAgICAgICAgICAvXFxiKGdyYW1tYXJ8c3BlbGx8c3BlbGxpbmd8cHJvb2ZyZWFkfHBvbGlzaClcXGIuKlxcYihjaGVja3xmaXh8Y29ycmVjdClcXGIvaSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTWV0YWRhdGEgY29tbWFuZHMgd2l0aCBkaWZmZXJlbnQgc3RydWN0dXJlc1xuICAgICAgICAgICAgL1xcYnNldFxccysodGhlXFxzKyk/KHRpdGxlfHRhZ3N8bWV0YWRhdGF8cHJvcGVydGllcykvaSxcbiAgICAgICAgICAgIC9cXGJ1cGRhdGVcXHMrKHRoZVxccyspPyh0aXRsZXx0YWdzfG1ldGFkYXRhfHByb3BlcnRpZXMpL2ksXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRhZy1zcGVjaWZpYyBwYXR0ZXJuc1xuICAgICAgICAgICAgL14oYWRkfHNldHx1cGRhdGV8cmVtb3ZlKVxccyt0YWdzPzovaSxcbiAgICAgICAgICAgIC9cXGIoY2xlYW4gdXB8Y2xlYW51cHxvcHRpbWl6ZXxpbXByb3ZlfHJldmlld3xhbmFseXplKVxccysuKlxcYnRhZ3M/XFxiL2ksXG4gICAgICAgICAgICAvXFxiKHN1Z2dlc3R8cmVjb21tZW5kKVxccysuKlxcYnRhZ3M/XFxiL2ksXG4gICAgICAgICAgICAvXmFkZCBzdWdnZXN0ZWQgdGFncyQvaVxuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgbWVzc2FnZSBtYXRjaGVzIGV4cGxpY2l0IGNvbW1hbmQgcGF0dGVybnNcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGV4cGxpY2l0Q29tbWFuZFBhdHRlcm5zKSB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGxvd2VyTWVzc2FnZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gNC4gRXZlcnl0aGluZyBlbHNlIGdvZXMgdG8gY29udmVyc2F0aW9uIG1vZGVcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb21tYW5kUHJvbXB0KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIGlzIHJlcXVpcmVkIGZvciBjb21tYW5kIHByb21wdHMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGlmIG5lZWRlZFxuICAgICAgICBsZXQgY29udmVyc2F0aW9uQ29udGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAob3B0aW9ucy5pbmNsdWRlSGlzdG9yeSkge1xuICAgICAgICAgICAgY29uc3QgcmVjZW50TWVzc2FnZXMgPSBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNSk7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5mb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KHJlY2VudE1lc3NhZ2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBwcm9tcHRcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBvcHRpb25zLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgZm9yIGNvbnZlcnNhdGlvbiAobm9uLWNvbW1hbmQgbWVzc2FnZXMpXG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRDb252ZXJzYXRpb25Qcm9tcHQoXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlLFxuICAgICAgICBvcHRpb25zOiBQYXJ0aWFsPFByb21wdENvbmZpZz4gPSB7fVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCB8IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IHJlY2VudEhpc3Rvcnk6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSA9IFtdO1xuXG4gICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0IGlmIGZpbGUgaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgcmVjZW50IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgICAgICByZWNlbnRIaXN0b3J5ID0gYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQnVpbGQgY29udmVyc2F0aW9uLXN0eWxlIHByb21wdCAobm90IGNvbW1hbmQgZm9ybWF0KVxuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyB3aXRoIHRoZWlyIGRvY3VtZW50cyBhbmQgd3JpdGluZyB0YXNrcy5cblxuS2V5IGNhcGFiaWxpdGllczpcbi0gQW5zd2VyIHF1ZXN0aW9ucyBhYm91dCBkb2N1bWVudHMgYW5kIGNvbnRlbnRcbi0gUHJvdmlkZSB3cml0aW5nIGFzc2lzdGFuY2UgYW5kIHN1Z2dlc3Rpb25zXG4tIEhlbHAgd2l0aCByZXNlYXJjaCBhbmQgYW5hbHlzaXNcbi0gRW5nYWdlIGluIG5hdHVyYWwgY29udmVyc2F0aW9uIGFib3V0IHRoZSB1c2VyJ3Mgd29ya1xuXG5HdWlkZWxpbmVzOlxuLSBQcm92aWRlIGhlbHBmdWwsIGFjY3VyYXRlIHJlc3BvbnNlc1xuLSBTdGF5IGZvY3VzZWQgb24gdGhlIHVzZXIncyBuZWVkc1xuLSBCZSBjb252ZXJzYXRpb25hbCBidXQgcHJvZmVzc2lvbmFsXG4tIFJlZmVyZW5jZSBkb2N1bWVudCBjb250ZXh0IHdoZW4gcmVsZXZhbnRgO1xuXG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gYFVTRVIgUkVRVUVTVDogJHttZXNzYWdlfWA7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZG9jdW1lbnQgY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dCAmJiBmaWxlKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEN1cnJlbnQgZG9jdW1lbnQ6ICR7ZG9jdW1lbnRDb250ZXh0LmZpbGVuYW1lfVxuXG4ke3VzZXJQcm9tcHR9YDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAocmVjZW50SGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5U3RyaW5nID0gdGhpcy5mb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KHJlY2VudEhpc3RvcnkpO1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBSRUNFTlQgQ09OVkVSU0FUSU9OOlxuJHtoaXN0b3J5U3RyaW5nfVxuXG4ke3VzZXJQcm9tcHR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dDogZG9jdW1lbnRDb250ZXh0Py5jb250ZW50IHx8ICcnLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IG9wdGlvbnMudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2Vuczogb3B0aW9ucy5tYXhUb2tlbnMgfHwgMjAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHNpbXBsZSBwcm9tcHQgZm9yIGJhc2ljIG9wZXJhdGlvbnNcbiAgICAgKi9cbiAgICBidWlsZFNpbXBsZVByb21wdChpbnN0cnVjdGlvbjogc3RyaW5nLCBjb250ZXh0Pzogc3RyaW5nKTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgTm92YSwgYW4gQUkgd3JpdGluZyBwYXJ0bmVyIHRoYXQgaGVscHMgdXNlcnMgd2l0aCB0aGVpciBkb2N1bWVudHMgYW5kIHdyaXRpbmcgdGFza3MuXG5cbkd1aWRlbGluZXM6XG4tIFByb3ZpZGUgaGVscGZ1bCwgYWNjdXJhdGUgcmVzcG9uc2VzXG4tIFN0YXkgZm9jdXNlZCBvbiB0aGUgdXNlcidzIG5lZWRzXG4tIEJlIGNvbnZlcnNhdGlvbmFsIGJ1dCBwcm9mZXNzaW9uYWxgO1xuXG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gYFVTRVIgUkVRVUVTVDogJHtpbnN0cnVjdGlvbn1gO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ29udGV4dDogJHtjb250ZXh0fVxuXG4ke3VzZXJQcm9tcHR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0LFxuICAgICAgICAgICAgY29udGV4dDogY29udGV4dCB8fCAnJyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAyMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRvY3VtZW50IGNvbnRleHQgZm9yIGEgZmlsZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0RG9jdW1lbnRDb250ZXh0KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxEb2N1bWVudENvbnRleHQ+IHtcbiAgICAgICAgLy8gVXNlIHRoZSBkb2N1bWVudCBlbmdpbmUncyBidWlsdC1pbiBjb250ZXh0IGdhdGhlcmluZ1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGNyZWF0ZSBtaW5pbWFsIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGVudCgpIHx8ICcnO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgaGVhZGluZ3M6IFtdLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkVGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXM6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybiB0aGUgY29udGV4dCBhcy1pcywgc2luY2UgaXQncyBhbHJlYWR5IGluIHRoZSBjb3JyZWN0IGZvcm1hdFxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgY29udmVyc2F0aW9uIGhpc3RvcnkgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkobWVzc2FnZXM6IENvbnZlcnNhdGlvbk1lc3NhZ2VbXSk6IHN0cmluZyB7XG4gICAgICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybiAnJztcblxuICAgICAgICBsZXQgZm9ybWF0dGVkID0gJ1JFQ0VOVCBDT05WRVJTQVRJT046XFxuJztcbiAgICAgICAgbWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuICAgICAgICAgICAgY29uc3Qgcm9sZSA9IG1zZy5yb2xlID09PSAndXNlcicgPyAnWW91JyA6ICdOb3ZhJztcbiAgICAgICAgICAgIGZvcm1hdHRlZCArPSBgJHtyb2xlfTogJHttc2cuY29udGVudH1cXG5gO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGFuZCBvcHRpbWl6ZSBwcm9tcHQgYmVmb3JlIHNlbmRpbmcgdG8gQUlcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUFuZE9wdGltaXplUHJvbXB0KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogR2VuZXJhdGVkUHJvbXB0IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgXG4gICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgLy8gUHJvbXB0IHZhbGlkYXRpb24gaXNzdWVzIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIGZpeCBjb21tb24gaXNzdWVzXG4gICAgICAgICAgICBsZXQgb3B0aW1pemVkUHJvbXB0ID0geyAuLi5wcm9tcHQgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ1bmNhdGUgaWYgdG9vIGxvbmdcbiAgICAgICAgICAgIGNvbnN0IHRva2VuQ291bnQgPSB0aGlzLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKHRva2VuQ291bnQgPiA4MDAwKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVkdWNlIGNvbnRleHQgc2l6ZSBtb3JlIGFnZ3Jlc3NpdmVseVxuICAgICAgICAgICAgICAgIGNvbnN0IG1heENvbnRleHRMZW5ndGggPSBNYXRoLmZsb29yKHByb21wdC5jb250ZXh0Lmxlbmd0aCAqIDAuNik7XG4gICAgICAgICAgICAgICAgb3B0aW1pemVkUHJvbXB0LmNvbnRleHQgPSBwcm9tcHQuY29udGV4dC5zdWJzdHJpbmcoMCwgbWF4Q29udGV4dExlbmd0aCkgKyAnXFxuW0NvbnRleHQgdHJ1bmNhdGVkLi4uXSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsYW1wIHRlbXBlcmF0dXJlXG4gICAgICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA8IDAgfHwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSA+IDEpIHtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDbGFtcCBtYXggdG9rZW5zXG4gICAgICAgICAgICBpZiAocHJvbXB0LmNvbmZpZy5tYXhUb2tlbnMgPCAxMCB8fCBwcm9tcHQuY29uZmlnLm1heFRva2VucyA+IDQwMDApIHtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29uZmlnLm1heFRva2VucyA9IE1hdGgubWF4KDEwLCBNYXRoLm1pbig0MDAwLCBwcm9tcHQuY29uZmlnLm1heFRva2VucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gb3B0aW1pemVkUHJvbXB0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdG9rZW4gY291bnQgZXN0aW1hdGUgZm9yIGEgcHJvbXB0XG4gICAgICovXG4gICAgZ2V0VG9rZW5Db3VudChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBwcm9tcHQgZm9yIGEgc3BlY2lmaWMgYWN0aW9uIHdpdGggbWluaW1hbCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgYnVpbGRRdWlja1Byb21wdChcbiAgICAgICAgYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sXG4gICAgICAgIGluc3RydWN0aW9uOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmQ6IEVkaXRDb21tYW5kID0ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0OiAnZG9jdW1lbnQnLFxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24sXG4gICAgICAgICAgICBjb250ZXh0OiB1bmRlZmluZWRcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb21tYW5kUHJvbXB0KGNvbW1hbmQsIGZpbGUsIHsgXG4gICAgICAgICAgICAgICAgbWF4Q29udGV4dExpbmVzOiAxMCxcbiAgICAgICAgICAgICAgICBpbmNsdWRlU3RydWN0dXJlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbmNsdWRlSGlzdG9yeTogZmFsc2UgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNpbXBsZSB0b2tlbiBjb3VudCBlc3RpbWF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBlc3RpbWF0ZVRva2VuQ291bnQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBudW1iZXIge1xuICAgICAgICAvLyBSb3VnaCBlc3RpbWF0aW9uOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgICAgICBjb25zdCB0b3RhbFRleHQgPSBwcm9tcHQuc3lzdGVtUHJvbXB0ICsgcHJvbXB0LnVzZXJQcm9tcHQgKyBwcm9tcHQuY29udGV4dDtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFRleHQubGVuZ3RoIC8gNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IHdpdGggY3VzdG9tIHN5c3RlbSBwcm9tcHQgb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZEN1c3RvbVByb21wdChcbiAgICAgICAgc3lzdGVtUHJvbXB0OiBzdHJpbmcsXG4gICAgICAgIHVzZXJNZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGZpbGU/OiBURmlsZVxuICAgICk6IFByb21pc2U8R2VuZXJhdGVkUHJvbXB0PiB7XG4gICAgICAgIGxldCBjb250ZXh0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICBjb250ZXh0ID0gYERvY3VtZW50OiAke2RvY3VtZW50Q29udGV4dC5maWxlbmFtZX1cXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdDogdXNlck1lc3NhZ2UsXG4gICAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDEwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogQWRkIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgYWRkaW5nIG5ldyBjb250ZW50IHRvIGRvY3VtZW50cyBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdHJlYW1pbmdNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vdWkvc3RyZWFtaW5nLW1hbmFnZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0cmVhbWluZ0NhbGxiYWNrIHtcbiAgICAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbik6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBBZGRDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGFkZCBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIHN0cmVhbWluZ0NhbGxiYWNrPzogU3RyZWFtaW5nQ2FsbGJhY2spOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgbWVzc2FnZSBhbHJlYWR5IGxvZ2dlZCBieSBjaGF0IGlucHV0IGhhbmRsZXJcblxuICAgICAgICAgICAgICAgIGxldCBjb250ZW50OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogRWRpdFJlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1pbmdDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIG1vZGVcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV2l0aFN0cmVhbWluZyhjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdCwgc3RyZWFtaW5nQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0cmFkaXRpb25hbCBzeW5jaHJvbm91cyBtb2RlIChmYWxsYmFjaylcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBhZGRpdGlvbiBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUFkZGl0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTG9nIG9ubHkgZmFpbHVyZXMgYXMgYXNzaXN0YW50IG1lc3NhZ2VzXG4gICAgICAgICAgICAgICAgLy8gU3VjY2VzcyB3aWxsIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIHN1Y2Nlc3MgaW5kaWNhdG9yXG4gICAgICAgICAgICAgICAgLy8gRmFpbHVyZSB3aWxsIGFsc28gYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3MgZXJyb3IgaW5kaWNhdG9yXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCcgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBhZGRpdGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlBZGRpdGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBkb2N1bWVudCAodHlwaWNhbGx5IGFwcGVuZCB0byBlbmQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIHNlbGVjdGlvbiB3aXRoIG5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm8gc2VsZWN0aW9uLCBhZGQgYXQgY3Vyc29yIGluc3RlYWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgYWRkIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2luc2VydCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUpOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGFkZFxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdhZGQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgYWRkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQWRkIGluc3RydWN0aW9uIGlzIHJlcXVpcmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhZGQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJlYW1pbmcgbW9kZSwgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZCB2aWEgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIEp1c3QgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgZmluYWwgY29udGVudFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxDb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbiB8fCB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1N0cmVhbWluZyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBFZGl0IGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgbW9kaWZ5aW5nIGFuZCBpbXByb3ZpbmcgZXhpc3RpbmcgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdHJlYW1pbmdDYWxsYmFjayB9IGZyb20gJy4vYWRkLWNvbW1hbmQnO1xuXG5leHBvcnQgY2xhc3MgRWRpdENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZWRpdCBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIHN0cmVhbWluZ0NhbGxiYWNrPzogU3RyZWFtaW5nQ2FsbGJhY2spOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kLCAhIWRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBtZXNzYWdlIGFscmVhZHkgbG9nZ2VkIGJ5IGNoYXQgaW5wdXQgaGFuZGxlclxuXG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0OiBFZGl0UmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbWluZ0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBzdHJlYW1pbmcgbW9kZVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoU3RyZWFtaW5nKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0LCBzdHJlYW1pbmdDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHRyYWRpdGlvbmFsIHN5bmNocm9ub3VzIG1vZGUgKGZhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBlZGl0IGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RWRpdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIExvZyBvbmx5IGZhaWx1cmVzIGFzIGFzc2lzdGFudCBtZXNzYWdlc1xuICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3Mgd2lsbCBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBzdWNjZXNzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIC8vIEZhaWx1cmUgd2lsbCBhbHNvIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIGVycm9yIGluZGljYXRvclxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBlZGl0IGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUVkaXQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZWRpdGluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIEluc2VydCBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGVudGlyZSBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnZW5kJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIGVkaXQgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZWRpdCBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhblxuICAgICk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBlZGl0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBlZGl0XG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ2VkaXQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgZWRpdCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBpbnN0cnVjdGlvbiBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoIWNvbW1hbmQuaW5zdHJ1Y3Rpb24gfHwgY29tbWFuZC5pbnN0cnVjdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0VkaXQgaW5zdHJ1Y3Rpb24gaXMgcmVxdWlyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3Igc3RyZWFtaW5nIG1vZGUsIHRoZSBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQgdmlhIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBKdXN0IHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGZpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uIHx8IHsgbGluZTogMCwgY2g6IDAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3RyZWFtaW5nIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBEZWxldGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyByZW1vdmluZyBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERlbGV0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCwgISFkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGRlbGV0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseURlbGV0aW9uKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExvZyBvbmx5IGZhaWx1cmVzIGFzIGFzc2lzdGFudCBtZXNzYWdlc1xuICAgICAgICAgICAgLy8gU3VjY2VzcyB3aWxsIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIHN1Y2Nlc3MgaW5kaWNhdG9yXG4gICAgICAgICAgICAvLyBGYWlsdXJlIHdpbGwgYWxzbyBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBlcnJvciBpbmRpY2F0b3JcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZGVsZXRpb24gYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RGVsZXRpb24oXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHRcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgZGVsZXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBjdXJyZW50IGxpbmUgYXQgY3Vyc29yXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZGVsZXRlQ29udGVudCgnbGluZScpO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgZW50aXJlIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KCcnKTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdHJhaWxpbmcgY29udGVudCAobm90IHR5cGljYWxseSB1c2VkIGZvciBkZWxldGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBmcm9tIGVuZCAtIHVzZSBjdXJzb3Igb3Igc2VsZWN0aW9uIGluc3RlYWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgZGVsZXRlIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZGVsZXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuXG4gICAgKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGRlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24gaXMgZGVsZXRlXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG59IiwgIi8qKlxuICogR3JhbW1hciBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGZpeGluZyBncmFtbWFyIGFuZCBzcGVsbGluZyBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdHJlYW1pbmdDYWxsYmFjayB9IGZyb20gJy4vYWRkLWNvbW1hbmQnO1xuXG5leHBvcnQgY2xhc3MgR3JhbW1hckNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZ3JhbW1hciBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIHN0cmVhbWluZ0NhbGxiYWNrPzogU3RyZWFtaW5nQ2FsbGJhY2spOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kLCAhIWRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgQUkgcHJvbXB0IHdpdGggY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmRvY3VtZW50RW5naW5lLmdldENvbnZlcnNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdENvbmZpZyA9IGNvbnZlcnNhdGlvbkNvbnRleHQgPyB7IGluY2x1ZGVIaXN0b3J5OiB0cnVlIH0gOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuY29udGV4dEJ1aWxkZXIuYnVpbGRQcm9tcHQoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHRDb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwcm9tcHRcbiAgICAgICAgICAgIGNvbnN0IHByb21wdFZhbGlkYXRpb24gPSB0aGlzLmNvbnRleHRCdWlsZGVyLnZhbGlkYXRlUHJvbXB0KHByb21wdCk7XG4gICAgICAgICAgICBpZiAoIXByb21wdFZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBQcm9tcHQgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cHJvbXB0VmFsaWRhdGlvbi5pc3N1ZXMuam9pbignLCAnKX1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBtZXNzYWdlIGFscmVhZHkgbG9nZ2VkIGJ5IGNoYXQgaW5wdXQgaGFuZGxlclxuXG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0OiBFZGl0UmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbWluZ0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBzdHJlYW1pbmcgbW9kZVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoU3RyZWFtaW5nKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0LCBzdHJlYW1pbmdDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHRyYWRpdGlvbmFsIHN5bmNocm9ub3VzIG1vZGUgKGZhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBncmFtbWFyIGZpeCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseUdyYW1tYXJGaXgoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgb25seSBmYWlsdXJlcyBhcyBhc3Npc3RhbnQgbWVzc2FnZXNcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIHdpbGwgYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3Mgc3VjY2VzcyBpbmRpY2F0b3JcbiAgICAgICAgICAgICAgICAvLyBGYWlsdXJlIHdpbGwgYWxzbyBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBlcnJvciBpbmRpY2F0b3JcblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgZ3JhbW1hciBmaXggYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5R3JhbW1hckZpeChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciBncmFtbWFyIGNvcnJlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgZW50aXJlIGRvY3VtZW50IHdpdGggY29ycmVjdGVkIHZlcnNpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoY29udGVudCk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gR3JhbW1hciBjb3JyZWN0aW9uIGF0IGN1cnNvciBkb2Vzbid0IG1ha2UgbXVjaCBzZW5zZSwgXG4gICAgICAgICAgICAgICAgLy8gc3VnZ2VzdCBzZWxlY3RpbmcgdGV4dCBpbnN0ZWFkXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGNvcnJlY3QgZ3JhbW1hciwgb3IgdXNlIFwiZG9jdW1lbnRcIiB0byBmaXggZW50aXJlIGRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gR3JhbW1hciBjb3JyZWN0aW9uIGF0IGVuZCBkb2Vzbid0IG1ha2Ugc2Vuc2VcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdHcmFtbWFyIGNvcnJlY3Rpb24gcmVxdWlyZXMgc2VsZWN0aW5nIHRleHQgb3Igc3BlY2lmeWluZyBcImRvY3VtZW50XCInLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIGdyYW1tYXIgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZ3JhbW1hciBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgXG4gICAgICAgIGhhc1NlbGVjdGlvbjogYm9vbGVhblxuICAgICk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24gaXMgZ3JhbW1hclxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdncmFtbWFyJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIGdyYW1tYXInXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIGdyYW1tYXIsIHdlIG5lZWQgZWl0aGVyIHNlbGVjdGlvbiBvciBkb2N1bWVudCB0YXJnZXRcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1BsZWFzZSBzZWxlY3QgdGV4dCB0byBjb3JyZWN0IGdyYW1tYXInXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ICE9PSAnc2VsZWN0aW9uJyAmJiBjb21tYW5kLnRhcmdldCAhPT0gJ2RvY3VtZW50Jykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdHcmFtbWFyIGNvcnJlY3Rpb24gcmVxdWlyZXMgc2VsZWN0aW5nIHRleHQgb3IgdGFyZ2V0aW5nIGVudGlyZSBkb2N1bWVudCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZ3JhbW1hciBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoU3RyZWFtaW5nKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBwcm9tcHQ6IGFueSxcbiAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2s6IFN0cmVhbWluZ0NhbGxiYWNrXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBjb250ZW50IHdpdGggc3RyZWFtaW5nXG4gICAgICAgICAgICBsZXQgZnVsbENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIHRoZSBzdHJlYW1pbmcgZ2VuZXJhdG9yXG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHRTdHJlYW0oXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsQ29udGVudCArPSBjaHVuay5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3J3YXJkIHRvIHRoZSBzdHJlYW1pbmcgY2FsbGJhY2sgd2hpY2ggaGFuZGxlcyBkb2N1bWVudCB1cGRhdGVzXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaWduYWwgY29tcGxldGlvblxuICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoIWZ1bGxDb250ZW50IHx8IGZ1bGxDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJlYW1pbmcgbW9kZSwgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZCB2aWEgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIEp1c3QgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgZmluYWwgY29udGVudFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxDb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24gfHwgeyBsaW5lOiAwLCBjaDogMCB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdTdHJlYW1pbmcgZmFpbGVkJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIFJld3JpdGUgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBnZW5lcmF0aW5nIGFsdGVybmF0aXZlIGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU3RyZWFtaW5nQ2FsbGJhY2sgfSBmcm9tICcuL2FkZC1jb21tYW5kJztcblxuZXhwb3J0IGNsYXNzIFJld3JpdGVDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIHJld3JpdGUgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBzdHJlYW1pbmdDYWxsYmFjaz86IFN0cmVhbWluZ0NhbGxiYWNrKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIG1lc3NhZ2UgYWxyZWFkeSBsb2dnZWQgYnkgY2hhdCBpbnB1dCBoYW5kbGVyXG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIHJld3JpdGUgYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlSZXdyaXRlKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTG9nIG9ubHkgZmFpbHVyZXMgYXMgYXNzaXN0YW50IG1lc3NhZ2VzXG4gICAgICAgICAgICAgICAgLy8gU3VjY2VzcyB3aWxsIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIHN1Y2Nlc3MgaW5kaWNhdG9yXG4gICAgICAgICAgICAgICAgLy8gRmFpbHVyZSB3aWxsIGFsc28gYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3MgZXJyb3IgaW5kaWNhdG9yXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IHJld3JpdGUgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5UmV3cml0ZShcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGVudGlyZSBkb2N1bWVudCB3aXRoIHJld3JpdHRlbiB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEFkZCByZXdyaXR0ZW4gY29udGVudCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIC8vIFJld3JpdGUgc2VsZWN0ZWQgY29udGVudFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCBmb3IgcmV3cml0aW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IHJld3JpdHRlbiBjb250ZW50IGF0IGN1cnNvclxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCByZXdyaXRlIHRhcmdldDogJHtjb21tYW5kLnRhcmdldH1gLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHJld3JpdGUgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24gaXMgcmV3cml0ZVxuICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gIT09ICdyZXdyaXRlJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIHJld3JpdGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgaW5zdHJ1Y3Rpb24gaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKCFjb21tYW5kLmluc3RydWN0aW9uIHx8IGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdSZXdyaXRlIGluc3RydWN0aW9uIGlzIHJlcXVpcmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdpdGhTdHJlYW1pbmcoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHByb21wdDogYW55LFxuICAgICAgICBzdHJlYW1pbmdDYWxsYmFjazogU3RyZWFtaW5nQ2FsbGJhY2tcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIGNvbnRlbnQgd2l0aCBzdHJlYW1pbmdcbiAgICAgICAgICAgIGxldCBmdWxsQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVc2UgdGhlIHN0cmVhbWluZyBnZW5lcmF0b3JcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dFN0cmVhbShcbiAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGlmIChjaHVuay5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxDb250ZW50ICs9IGNodW5rLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcndhcmQgdG8gdGhlIHN0cmVhbWluZyBjYWxsYmFjayB3aGljaCBoYW5kbGVzIGRvY3VtZW50IHVwZGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNpZ25hbCBjb21wbGV0aW9uXG4gICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICghZnVsbENvbnRlbnQgfHwgZnVsbENvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHN0cmVhbWluZyBtb2RlLCB0aGUgZG9jdW1lbnQgaGFzIGFscmVhZHkgYmVlbiB1cGRhdGVkIHZpYSBjYWxsYmFja1xuICAgICAgICAgICAgLy8gSnVzdCByZXR1cm4gc3VjY2VzcyB3aXRoIHRoZSBmaW5hbCBjb250ZW50XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogZnVsbENvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbiB8fCB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1N0cmVhbWluZyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogTWV0YWRhdGEgY29tbWFuZCBoYW5kbGVyIGZvciBOb3ZhXG4gKiBIYW5kbGVzIHVwZGF0aW5nIGRvY3VtZW50IHByb3BlcnRpZXMvZnJvbnRtYXR0ZXJcbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqXG4gKiBIYW5kbGVzIG1ldGFkYXRhL3Byb3BlcnR5IHVwZGF0ZSBjb21tYW5kc1xuICovXG5leHBvcnQgY2xhc3MgTWV0YWRhdGFDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBkb2N1bWVudEVuZ2luZTogRG9jdW1lbnRFbmdpbmUsXG4gICAgICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHByb3ZpZGVyTWFuYWdlcjogQUlQcm92aWRlck1hbmFnZXJcbiAgICApIHt9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGEgbWV0YWRhdGEgdXBkYXRlIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYSBkaXJlY3QgdGFnIG9wZXJhdGlvblxuICAgICAgICAgICAgY29uc3QgdGFnUmVzdWx0ID0gYXdhaXQgdGhpcy5oYW5kbGVEaXJlY3RUYWdPcGVyYXRpb24oY29tbWFuZC5pbnN0cnVjdGlvbiwgZG9jdW1lbnRDb250ZXh0KTtcbiAgICAgICAgICAgIGlmICh0YWdSZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFnUmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHt2YWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgY29uc3QgYWlSZXNwb25zZSA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKFxuICAgICAgICAgICAgICAgIHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBBSSByZXNwb25zZSB0byBleHRyYWN0IHByb3BlcnR5IHVwZGF0ZXNcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSB0aGlzLnBhcnNlUHJvcGVydHlVcGRhdGVzKGFpUmVzcG9uc2UpO1xuICAgICAgICAgICAgaWYgKCF1cGRhdGVzIHx8IE9iamVjdC5rZXlzKHVwZGF0ZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIExvZyBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIG1ldGFkYXRhIHVwZGF0ZXMuIEFJIHJlc3BvbnNlOicsIGFpUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHByb3BlcnR5IHVwZGF0ZXMgZm91bmQgaW4gQUkgcmVzcG9uc2UnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTG9nIHdoYXQgd2UncmUgdXBkYXRpbmcgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ01ldGFkYXRhIHVwZGF0ZXM6JywgdXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFdyaXRlIHRoZSB1cGRhdGVkIGNvbnRlbnQgYmFjayB0byB0aGUgZmlsZSBkaXJlY3RseVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGRvY3VtZW50Q29udGV4dC5maWxlLCB1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHN1Y2Nlc3MgbWVzc2FnZSBiYXNlZCBvbiB1cGRhdGVzXG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzTWVzc2FnZSA9IHRoaXMuZ2VuZXJhdGVTdWNjZXNzTWVzc2FnZSh1cGRhdGVzKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiAwLCBjaDogMCB9LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgc3VjY2Vzc01lc3NhZ2VcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBgRmFpbGVkIHRvIHVwZGF0ZSBtZXRhZGF0YTogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgQUkgcmVzcG9uc2UgdG8gZXh0cmFjdCBwcm9wZXJ0eSB1cGRhdGVzXG4gICAgICovXG4gICAgcHJpdmF0ZSBwYXJzZVByb3BlcnR5VXBkYXRlcyhyZXNwb25zZTogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgYW55PiB8IG51bGwge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIEpTT04gZmlyc3RcbiAgICAgICAgICAgIGNvbnN0IGpzb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9gYGBqc29uXFxzKihbXFxzXFxTXSo/KVxccypgYGAvKTtcbiAgICAgICAgICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uTWF0Y2hbMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgWUFNTC1saWtlIGZvcm1hdFxuICAgICAgICAgICAgY29uc3QgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZS5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICAgIC8vIE1hdGNoIHBhdHRlcm5zIGxpa2UgXCJrZXk6IHZhbHVlXCIgb3IgXCItIGtleTogdmFsdWVcIlxuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXlstXFxzXSooW146XSspOlxccyooLispJC8pO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IG1hdGNoWzJdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSB2YWx1ZSBhcyBKU09OIChmb3IgYXJyYXlzL29iamVjdHMpXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIG5vdCBKU09OLCB0cmVhdCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBxdW90ZXMgaWYgcHJlc2VudFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZS5zdGFydHNXaXRoKCdcIicpICYmIHZhbHVlLmVuZHNXaXRoKCdcIicpKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodmFsdWUuc3RhcnRzV2l0aChcIidcIikgJiYgdmFsdWUuZW5kc1dpdGgoXCInXCIpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoMSwgLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh1cGRhdGVzKS5sZW5ndGggPiAwID8gdXBkYXRlcyA6IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdG8gcGFyc2UgcHJvcGVydHkgdXBkYXRlcyAtIGdyYWNlZnVsIGZhbGxiYWNrXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBvciBjcmVhdGUgZnJvbnRtYXR0ZXIgaW4gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlRnJvbnRtYXR0ZXIoY29udGVudDogc3RyaW5nLCB1cGRhdGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGZyb250bWF0dGVyIGV4aXN0c1xuICAgICAgICBpZiAobGluZXNbMF0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBjbG9zaW5nIC0tLVxuICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gLTE7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbmVzW2ldID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICBlbmRJbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGVuZEluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIFBhcnNlIGV4aXN0aW5nIGZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdQcm9wczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZW5kSW5kZXg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmVzW2ldLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBLZWVwIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1Byb3BzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBNZXJnZSB1cGRhdGVzIHdpdGggZXhpc3RpbmcgcHJvcGVydGllc1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lcmdlZFByb3BzID0geyAuLi5leGlzdGluZ1Byb3BzLCAuLi51cGRhdGVzIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gUmVidWlsZCBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Zyb250bWF0dGVyID0gWyctLS0nXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhtZXJnZWRQcm9wcykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNraXAgbnVsbC91bmRlZmluZWQgdmFsdWVzIChhbGxvd3MgZGVsZXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goYCR7a2V5fTogJHtmb3JtYXR0ZWRWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBvbGQgZnJvbnRtYXR0ZXIgd2l0aCBuZXdcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgICAgICAuLi5uZXdGcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgLi4ubGluZXMuc2xpY2UoZW5kSW5kZXggKyAxKVxuICAgICAgICAgICAgICAgIF0uam9pbignXFxuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIE5vIGZyb250bWF0dGVyIGV4aXN0cywgY3JlYXRlIG5ld1xuICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHVwZGF0ZXMpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgXG4gICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSlcbiAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goYCR7a2V5fTogJHtmb3JtYXR0ZWRWYWx1ZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKCctLS0nLCAnJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZnJvbnRtYXR0ZXIgdG8gYmVnaW5uaW5nIG9mIGRvY3VtZW50XG4gICAgICAgIHJldHVybiBuZXdGcm9udG1hdHRlci5qb2luKCdcXG4nKSArIGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIGRpcmVjdCB0YWcgb3BlcmF0aW9ucyAoYWRkLCByZW1vdmUsIHNldCB0YWdzKVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlRGlyZWN0VGFnT3BlcmF0aW9uKGluc3RydWN0aW9uOiBzdHJpbmcsIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogUHJvbWlzZTxFZGl0UmVzdWx0IHwgbnVsbD4ge1xuICAgICAgICBjb25zdCBsb3dlckluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24udG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBQYXJzZSB0YWcgY29tbWFuZHMgd2l0aCBjb2xvbiBmb3JtYXRcbiAgICAgICAgY29uc3QgY29sb25NYXRjaCA9IGxvd2VySW5zdHJ1Y3Rpb24ubWF0Y2goL14oYWRkfHNldHx1cGRhdGV8cmVtb3ZlKVxccyt0YWdzPzpcXHMqKC4qKSQvKTtcbiAgICAgICAgaWYgKGNvbG9uTWF0Y2gpIHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IGNvbG9uTWF0Y2hbMV07XG4gICAgICAgICAgICBjb25zdCB0YWdTdHJpbmcgPSBjb2xvbk1hdGNoWzJdO1xuICAgICAgICAgICAgY29uc3QgbmV3VGFncyA9IHRhZ1N0cmluZyA/IHRhZ1N0cmluZy5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKS5maWx0ZXIodCA9PiB0KSA6IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiBcImFkZCB0YWdzXCIgd2l0aCBubyBzcGVjaWZpYyB0YWdzLCB0cmVhdCBhcyBBSS1wb3dlcmVkIHN1Z2dlc3Rpb25cbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdhZGQnICYmIG5ld1RhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlQUlUYWdPcGVyYXRpb24oJ2FkZCBzdWdnZXN0ZWQgdGFncycsIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IHRhZ3NcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRUYWdzID0gdGhpcy5nZXRDdXJyZW50VGFncyhkb2N1bWVudENvbnRleHQuY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCB1cGRhdGVkVGFnczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgIGxldCBtZXNzYWdlID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIG5ldyB0YWdzIHdpdGhvdXQgZHVwbGljYXRlc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdzVG9BZGQgPSBuZXdUYWdzLmZpbHRlcih0YWcgPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICAhY3VycmVudFRhZ3Muc29tZShleGlzdGluZyA9PiBleGlzdGluZy50b0xvd2VyQ2FzZSgpID09PSB0YWcudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFRhZ3MgPSBbLi4uY3VycmVudFRhZ3MsIC4uLnRhZ3NUb0FkZF07XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSB0YWdzVG9BZGQubGVuZ3RoID4gMCBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYEFkZGVkICR7dGFnc1RvQWRkLmxlbmd0aH0gdGFnJHt0YWdzVG9BZGQubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9OiAke3RhZ3NUb0FkZC5qb2luKCcsICcpfWBcbiAgICAgICAgICAgICAgICAgICAgICAgIDogJ05vIG5ldyB0YWdzIHRvIGFkZCAoZHVwbGljYXRlcyBmaWx0ZXJlZCknO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlJzpcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHNwZWNpZmllZCB0YWdzXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvd2VyTmV3VGFncyA9IG5ld1RhZ3MubWFwKHQgPT4gdC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlQ291bnQgPSBjdXJyZW50VGFncy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gY3VycmVudFRhZ3MuZmlsdGVyKHRhZyA9PiBcbiAgICAgICAgICAgICAgICAgICAgICAgICFsb3dlck5ld1RhZ3MuaW5jbHVkZXModGFnLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92ZWRDb3VudCA9IGJlZm9yZUNvdW50IC0gdXBkYXRlZFRhZ3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gcmVtb3ZlZENvdW50ID4gMFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBgUmVtb3ZlZCAke3JlbW92ZWRDb3VudH0gdGFnJHtyZW1vdmVkQ291bnQgIT09IDEgPyAncycgOiAnJ31gXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICdObyB0YWdzIGZvdW5kIHRvIHJlbW92ZSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjYXNlICdzZXQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYWxsIHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFRhZ3MgPSBbLi4ubmV3IFNldChuZXdUYWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKSkpXTtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IGBTZXQgJHt1cGRhdGVkVGFncy5sZW5ndGh9IHRhZyR7dXBkYXRlZFRhZ3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9YDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBjb250ZW50XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0geyB0YWdzOiB1cGRhdGVkVGFncyB9O1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyKGRvY3VtZW50Q29udGV4dC5jb250ZW50LCB1cGRhdGVzKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShkb2N1bWVudENvbnRleHQuZmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogdXBkYXRlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmU6IDAsIGNoOiAwIH0sXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZTogbWVzc2FnZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIEFJLXBvd2VyZWQgdGFnIG9wZXJhdGlvbnNcbiAgICAgICAgaWYgKC9cXGIoY2xlYW4gdXB8Y2xlYW51cHxvcHRpbWl6ZXxpbXByb3ZlfHJldmlld3xhbmFseXplKVxccysuKlxcYnRhZ3M/XFxiL2kudGVzdChsb3dlckluc3RydWN0aW9uKSB8fFxuICAgICAgICAgICAgL1xcYihzdWdnZXN0fHJlY29tbWVuZClcXHMrLipcXGJ0YWdzP1xcYi9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHxcbiAgICAgICAgICAgIC9eYWRkIHN1Z2dlc3RlZCB0YWdzJC9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHxcbiAgICAgICAgICAgIC9eYWRkIHRhZ3MkL2kudGVzdChsb3dlckluc3RydWN0aW9uKSB8fCAgLy8gSGFuZGxlIHNpbXBsZSBcImFkZCB0YWdzXCIgYXMgQUkgc3VnZ2VzdGlvblxuICAgICAgICAgICAgL151cGRhdGUgdGFncyQvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pKSB7ICAvLyBIYW5kbGUgXCJ1cGRhdGUgdGFnc1wiIGFzIEFJIG9wZXJhdGlvblxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGVBSVRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbiwgZG9jdW1lbnRDb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIEFJLXBvd2VyZWQgdGFnIG9wZXJhdGlvbnMgKHN1Z2dlc3QsIG9wdGltaXplLCBjbGVhbiB1cClcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZUFJVGFnT3BlcmF0aW9uKGluc3RydWN0aW9uOiBzdHJpbmcsIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0KTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUYWdzID0gdGhpcy5nZXRDdXJyZW50VGFncyhkb2N1bWVudENvbnRleHQuY29udGVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBBSSBwcm9tcHQgZm9yIHRhZyBvcGVyYXRpb25cbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgYW4gZXhwZXJ0IGF0IGRvY3VtZW50IHRhZ2dpbmcgYW5kIG1ldGFkYXRhIG9yZ2FuaXphdGlvbi4gWW91ciB0YXNrIGlzIHRvIGFuYWx5emUgZG9jdW1lbnRzIGFuZCBwcm92aWRlIG9wdGltYWwgdGFncy5cblxuUnVsZXMgZm9yIHRhZ3M6XG4tIFRhZ3Mgc2hvdWxkIGJlIGxvd2VyY2FzZVxuLSBVc2UgaHlwaGVucyBmb3IgbXVsdGktd29yZCB0YWdzIChlLmcuLCBcIm1hY2hpbmUtbGVhcm5pbmdcIilcbi0gQmUgc3BlY2lmaWMgYnV0IG5vdCBvdmVybHkgZ3JhbnVsYXJcbi0gQWltIGZvciA1LTEwIHRhZ3MgcGVyIGRvY3VtZW50XG4tIEZvY3VzIG9uIGtleSBjb25jZXB0cywgdG9waWNzLCBhbmQgdGhlbWVzIEZST00gVEhFIEFDVFVBTCBET0NVTUVOVCBDT05URU5UXG4tIFRhZ3MgbXVzdCBiZSBkaXJlY3RseSByZWxldmFudCB0byB0aGUgZG9jdW1lbnQncyBzdWJqZWN0IG1hdHRlclxuLSBBdm9pZCBnZW5lcmljIHRhZ3MgbGlrZSBcImRvY3VtZW50XCIgb3IgXCJ0ZXh0XCJcbi0gQ29uc2lkZXIgdGhlIGRvY3VtZW50J3MgcHVycG9zZSwgYXVkaWVuY2UsIGFuZCBtYWluIHRvcGljc1xuLSBFeHRyYWN0IHRhZ3MgYmFzZWQgb24gdGhlIGRvY3VtZW50J3MgYWN0dWFsIGNvbnRlbnQsIG5vdCByYW5kb20gdG9waWNzXG5cbklNUE9SVEFOVDogQmFzZSB5b3VyIHRhZyBzdWdnZXN0aW9ucyBPTkxZIG9uIHRoZSBjb250ZW50IHByb3ZpZGVkLiBEbyBub3QgaW52ZW50IHVucmVsYXRlZCB0YWdzLlxuXG5SZXR1cm4gT05MWSBhIEpTT04gb2JqZWN0IHdpdGggYSBcInRhZ3NcIiBhcnJheSBhbmQgYSBcInJlYXNvbmluZ1wiIGZpZWxkIGV4cGxhaW5pbmcgeW91ciBjaG9pY2VzLmA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIGlmICgvYWRkIHN1Z2dlc3RlZC9pLnRlc3QoaW5zdHJ1Y3Rpb24pIHx8IC9eYWRkIHRhZ3MkL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ2FyZWZ1bGx5IGFuYWx5emUgdGhlIGZvbGxvd2luZyBkb2N1bWVudCBhbmQgc3VnZ2VzdCByZWxldmFudCB0YWdzIGJhc2VkIG9uIGl0cyBhY3R1YWwgY29udGVudC5cblxuQ3VycmVudCB0YWdzOiAke2N1cnJlbnRUYWdzLmxlbmd0aCA+IDAgPyBjdXJyZW50VGFncy5qb2luKCcsICcpIDogJ25vbmUnfVxuXG5ET0NVTUVOVCBUTyBBTkFMWVpFOlxuPT09U1RBUlQgT0YgRE9DVU1FTlQ9PT1cbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9XG49PT1FTkQgT0YgRE9DVU1FTlQ9PT1cblxuQmFzZWQgb24gdGhlIGFib3ZlIGRvY3VtZW50IGNvbnRlbnQsIHN1Z2dlc3QgYWRkaXRpb25hbCB0YWdzIHRoYXQ6XG4xLiBSZWZsZWN0IHRoZSBhY3R1YWwgdG9waWNzIGRpc2N1c3NlZCBpbiB0aGUgZG9jdW1lbnRcbjIuIENhcHR1cmUga2V5IGNvbmNlcHRzLCB0ZWNobm9sb2dpZXMsIG9yIHRoZW1lcyBtZW50aW9uZWRcbjMuIFdvdWxkIGhlbHAgd2l0aCBkaXNjb3ZlcmFiaWxpdHkgYW5kIG9yZ2FuaXphdGlvblxuNC4gQXJlIGRpcmVjdGx5IHJlbGV2YW50IHRvIHdoYXQgdGhpcyBkb2N1bWVudCBpcyBhYm91dFxuXG5ETyBOT1Qgc3VnZ2VzdCB0YWdzIGFib3V0IHRvcGljcyBub3QgbWVudGlvbmVkIGluIHRoZSBkb2N1bWVudC5gO1xuICAgICAgICB9IGVsc2UgaWYgKC9jbGVhbiB1cHxjbGVhbnVwL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ2xlYW4gdXAgYW5kIG9wdGltaXplIHRoZSB0YWdzIGZvciB0aGlzIGRvY3VtZW50IGJ5IGFuYWx5emluZyBib3RoIHRoZSBjdXJyZW50IHRhZ3MgYW5kIHRoZSBkb2N1bWVudCBjb250ZW50LlxuXG5DdXJyZW50IHRhZ3M6ICR7Y3VycmVudFRhZ3Muam9pbignLCAnKX1cblxuRE9DVU1FTlQgQ09OVEVOVDpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cblRhc2tzOlxuMS4gUmVtb3ZlIGR1cGxpY2F0ZSBvciByZWR1bmRhbnQgdGFnc1xuMi4gQ29uc29saWRhdGUgc2ltaWxhciB0YWdzIChlLmcuLCBcImpzXCIgYW5kIFwiamF2YXNjcmlwdFwiKVxuMy4gUmVtb3ZlIHRhZ3MgdGhhdCBhcmVuJ3QgcmVsZXZhbnQgdG8gdGhlIGRvY3VtZW50IGNvbnRlbnRcbjQuIFN0YW5kYXJkaXplIHRhZyBmb3JtYXQgKGxvd2VyY2FzZSwgaHlwaGVuYXRlZClcbjUuIEVuc3VyZSByZW1haW5pbmcgdGFncyBhY2N1cmF0ZWx5IHJlZmxlY3QgdGhlIGRvY3VtZW50XG5cblByb3ZpZGUgYSBjbGVhbmVkLXVwIHRhZyBsaXN0IGJhc2VkIG9uIHRoZSBhY3R1YWwgZG9jdW1lbnQgY29udGVudC5gO1xuICAgICAgICB9IGVsc2UgaWYgKC9vcHRpbWl6ZXxpbXByb3ZlfHJldmlld3xhbmFseXplfHVwZGF0ZS9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYEFuYWx5emUgdGhpcyBkb2N1bWVudCB0aG9yb3VnaGx5IGFuZCBwcm92aWRlIGFuIG9wdGltaXplZCBzZXQgb2YgdGFncyB0aGF0IGFjY3VyYXRlbHkgcmVwcmVzZW50cyBpdHMgY29udGVudC5cblxuQ3VycmVudCB0YWdzOiAke2N1cnJlbnRUYWdzLmxlbmd0aCA+IDAgPyBjdXJyZW50VGFncy5qb2luKCcsICcpIDogJ25vbmUnfVxuXG5ET0NVTUVOVCBUTyBBTkFMWVpFOlxuPT09U1RBUlQgT0YgRE9DVU1FTlQ9PT1cbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9XG49PT1FTkQgT0YgRE9DVU1FTlQ9PT1cblxuVGFza3M6XG4xLiBSZXZpZXcgdGhlIGRvY3VtZW50IGNvbnRlbnQgY2FyZWZ1bGx5XG4yLiBSZW1vdmUgYW55IHRhZ3MgdGhhdCBhcmVuJ3QgcmVsZXZhbnQgdG8gdGhlIGFjdHVhbCBjb250ZW50XG4zLiBBZGQgdGFncyBmb3IgaW1wb3J0YW50IGNvbmNlcHRzLCB0b3BpY3MsIG9yIHRoZW1lcyB0aGF0IGFyZSBtaXNzaW5nXG40LiBFbnN1cmUgYWxsIHRhZ3MgZGlyZWN0bHkgcmVsYXRlIHRvIHdoYXQncyBkaXNjdXNzZWQgaW4gdGhlIGRvY3VtZW50XG41LiBBaW0gZm9yIDUtMTAgaGlnaGx5IHJlbGV2YW50IHRhZ3NcblxuUHJvdmlkZSBhbiBvcHRpbWl6ZWQgdGFnIGxpc3QgdGhhdCBiZXN0IHJlcHJlc2VudHMgVEhJUyBTUEVDSUZJQyBkb2N1bWVudCdzIGNvbnRlbnQuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBVc2UgdW5pZmllZCBhcHByb2FjaCBmb3IgYWxsIHByb3ZpZGVyc1xuICAgICAgICAgICAgY29uc3QgZGVmYXVsdE1heFRva2VucyA9IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdldERlZmF1bHRNYXhUb2tlbnMoKTtcbiAgICAgICAgICAgIGNvbnN0IGFpUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShzeXN0ZW1Qcm9tcHQsIHVzZXJQcm9tcHQsIHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogZGVmYXVsdE1heFRva2Vuc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBhcnNlIEFJIHJlc3BvbnNlXG4gICAgICAgICAgICBjb25zdCBwYXJzZWQgPSB0aGlzLnBhcnNlQUlUYWdSZXNwb25zZShhaVJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghcGFyc2VkIHx8ICFwYXJzZWQudGFncyB8fCBwYXJzZWQudGFncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBTaG93IHRoZSBhY3R1YWwgQUkgcmVzcG9uc2UgaW4gdGhlIGVycm9yIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aWV3ID0gYWlSZXNwb25zZS5sZW5ndGggPiAxMDAgXG4gICAgICAgICAgICAgICAgICAgID8gYWlSZXNwb25zZS5zdWJzdHJpbmcoMCwgMTAwKSArICcuLi4nIFxuICAgICAgICAgICAgICAgICAgICA6IGFpUmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgQ291bGQgbm90IHBhcnNlIEFJIHRhZyBzdWdnZXN0aW9ucy4gQUkgcmVzcG9uc2U6IFwiJHtwcmV2aWV3fVwiYCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0YWdzXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzID0geyB0YWdzOiBwYXJzZWQudGFncyB9O1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSB0aGlzLnVwZGF0ZUZyb250bWF0dGVyKGRvY3VtZW50Q29udGV4dC5jb250ZW50LCB1cGRhdGVzKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShkb2N1bWVudENvbnRleHQuZmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBhcHByb3ByaWF0ZSBtZXNzYWdlXG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgICAgICAgaWYgKC9hZGQgc3VnZ2VzdGVkL2kudGVzdChpbnN0cnVjdGlvbikgfHwgL15hZGQgdGFncyQvaS50ZXN0KGluc3RydWN0aW9uKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFkZGVkVGFncyA9IHBhcnNlZC50YWdzLmZpbHRlcih0YWcgPT4gXG4gICAgICAgICAgICAgICAgICAgICFjdXJyZW50VGFncy5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLnRvTG93ZXJDYXNlKCkgPT09IHRhZy50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGBBZGRlZCAke2FkZGVkVGFncy5sZW5ndGh9IHN1Z2dlc3RlZCB0YWcke2FkZGVkVGFncy5sZW5ndGggIT09IDEgPyAncycgOiAnJ306ICR7YWRkZWRUYWdzLmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoL2NsZWFuIHVwfGNsZWFudXAvaS50ZXN0KGluc3RydWN0aW9uKSkge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgQ2xlYW5lZCB1cCB0YWdzOiAke2N1cnJlbnRUYWdzLmxlbmd0aH0gXHUyMTkyICR7cGFyc2VkLnRhZ3MubGVuZ3RofSB0YWdzYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGBPcHRpbWl6ZWQgdGFnczogJHtwYXJzZWQudGFncy5sZW5ndGh9IHRhZyR7cGFyc2VkLnRhZ3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9ICh3YXMgJHtjdXJyZW50VGFncy5sZW5ndGh9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlOiBtZXNzYWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byBwcm9jZXNzIHRhZyBvcGVyYXRpb246ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IHRhZ3MgZnJvbSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRDdXJyZW50VGFncyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGlmICghY29udGVudCkgcmV0dXJuIFtdO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5lcy5sZW5ndGggPiAwICYmIGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgbGV0IGluRnJvbnRtYXR0ZXIgPSB0cnVlO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGggJiYgaW5Gcm9udG1hdHRlcjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbmVzW2ldID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgdGFnTWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXnRhZ3M6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ01hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ1ZhbHVlID0gdGFnTWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YWdWYWx1ZSkgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHBhcnNpbmcgYXMgSlNPTiBhcnJheVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZSh0YWdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJzZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlZC5maWx0ZXIodCA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgSlNPTiwgdHJ5IGNvbW1hLXNlcGFyYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhZ1ZhbHVlLnNwbGl0KCcsJykubWFwKHQgPT4gdC50cmltKCkpLmZpbHRlcih0ID0+IHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBvciBubyB0YWdzIGZvdW5kXG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBBSSByZXNwb25zZSBmb3IgdGFnIG9wZXJhdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIHBhcnNlQUlUYWdSZXNwb25zZShyZXNwb25zZTogc3RyaW5nKTogeyB0YWdzOiBzdHJpbmdbXSwgcmVhc29uaW5nPzogc3RyaW5nIH0gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENsZWFuIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QgY2xlYW5SZXNwb25zZSA9IHJlc3BvbnNlLnRyaW0oKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIGV4dHJhY3QgSlNPTiBmcm9tIHJlc3BvbnNlXG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSBjbGVhblJlc3BvbnNlLm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKTtcbiAgICAgICAgICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZWQudGFncyAmJiBBcnJheS5pc0FycmF5KHBhcnNlZC50YWdzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiBwYXJzZWQudGFncy5tYXAoKHQ6IGFueSkgPT4gU3RyaW5nKHQpLnRvTG93ZXJDYXNlKCkudHJpbSgpLnJlcGxhY2UoL1xccysvZywgJy0nKSkuZmlsdGVyKCh0OiBzdHJpbmcpID0+IHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbmluZzogcGFyc2VkLnJlYXNvbmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSlNPTiBwYXJzZSBmYWlsZWQsIGNvbnRpbnVlIHRvIG90aGVyIGZvcm1hdHNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB2YXJpb3VzIGxpc3QgZm9ybWF0c1xuICAgICAgICAgICAgY29uc3QgcGF0dGVybnMgPSBbXG4gICAgICAgICAgICAgICAgLy8gSlNPTiBhcnJheTogdGFnczogW1widGFnMVwiLCBcInRhZzJcIl1cbiAgICAgICAgICAgICAgICAvdGFncz86XFxzKlxcWyhbXlxcXV0rKVxcXS9pLFxuICAgICAgICAgICAgICAgIC8vIENvbW1hIGxpc3Q6IFRhZ3M6IHRhZzEsIHRhZzIsIHRhZzNcbiAgICAgICAgICAgICAgICAvdGFncz86XFxzKihbXlxcbl0rPykoPzpcXG58JCkvaSxcbiAgICAgICAgICAgICAgICAvLyBCdWxsZXQgbGlzdDogLSB0YWcxXFxuLSB0YWcyXG4gICAgICAgICAgICAgICAgLyg/OnRhZ3M/Oik/XFxzKig/Olxcbik/KFxccypbLVx1MjAyMipdXFxzKi4rKD86XFxuXFxzKlstXHUyMDIyKl1cXHMqLispKikvaSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBwYXR0ZXJucykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gY2xlYW5SZXNwb25zZS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhZ1N0cmluZyA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdGFnczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBidWxsZXQgbGlzdHNcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ1N0cmluZy5pbmNsdWRlcygnLScpIHx8IHRhZ1N0cmluZy5pbmNsdWRlcygnXHUyMDIyJykgfHwgdGFnU3RyaW5nLmluY2x1ZGVzKCcqJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3MgPSB0YWdTdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoL1xcbi8pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgobGluZTogc3RyaW5nKSA9PiBsaW5lLnJlcGxhY2UoL15cXHMqWy1cdTIwMjIqXVxccyovLCAnJykudHJpbSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHQ6IHN0cmluZykgPT4gdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgY29tbWEtc2VwYXJhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzID0gdGFnU3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCcsJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKCh0OiBzdHJpbmcpID0+IHQudHJpbSgpLnJlcGxhY2UoL1tcIiddL2csICcnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh0OiBzdHJpbmcpID0+IHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAodGFncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiB0YWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKS50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnLScpKS5maWx0ZXIodCA9PiB0KVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTGFzdCByZXNvcnQ6IGV4dHJhY3QgYW55IGNvbW1hLXNlcGFyYXRlZCBsaXN0IGFmdGVyIFwic3VnZ2VzdFwiIG9yIFwicmVjb21tZW5kXCJcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3RNYXRjaCA9IGNsZWFuUmVzcG9uc2UubWF0Y2goLyg/OnN1Z2dlc3R8cmVjb21tZW5kfHByb3Bvc2V8aGVyZSBhcmV8dGFncyBhcmUpWzpcXHNdKyhbXi5dKykvaSk7XG4gICAgICAgICAgICBpZiAoc3VnZ2VzdE1hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFncyA9IHN1Z2dlc3RNYXRjaFsxXVxuICAgICAgICAgICAgICAgICAgICAuc3BsaXQoL1ssXFxuXS8pXG4gICAgICAgICAgICAgICAgICAgIC5tYXAodCA9PiB0LnRyaW0oKS5yZXBsYWNlKC9bXCInXS9nLCAnJykucmVwbGFjZSgvXmFuZFxccysvaSwgJycpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHQgPT4gdCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IHRhZ3MubWFwKHQgPT4gdC50b0xvd2VyQ2FzZSgpLnRyaW0oKSkuZmlsdGVyKHQgPT4gdClcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEZpbmFsIGZhbGxiYWNrOiB0cmVhdCBlYWNoIGxpbmUgYXMgYSB0YWcgKGZvciBHb29nbGUncyBzaW1wbGUgZm9ybWF0KVxuICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjbGVhblJlc3BvbnNlLnNwbGl0KCdcXG4nKS5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSkuZmlsdGVyKGxpbmUgPT4gbGluZSk7XG4gICAgICAgICAgICBjb25zdCB2YWxpZFRhZ3MgPSBsaW5lc1xuICAgICAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciBvdXQgbGluZXMgdGhhdCBhcmUgY2xlYXJseSBub3QgdGFnc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZS5sZW5ndGggPiAwICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZS5sZW5ndGggPCA1MCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICFsaW5lLmluY2x1ZGVzKCc6JykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RhZycpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZXJlJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICFsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3N1Z2dlc3QnKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5tYXAobGluZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwIHRoZSBsaW5lIGFuZCBjb252ZXJ0IHNwYWNlcyB0byBoeXBoZW5zXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsaW5lLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9eWy1cdTIwMjIqI11cXHMqLywgJycpIC8vIFJlbW92ZSBidWxsZXQgcG9pbnRzIGFuZCBoYXNodGFnc1xuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL15cXGQrXFwuXFxzKi8sICcnKSAvLyBSZW1vdmUgbnVtYmVyZWQgbGlzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIC50cmltKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICctJyk7IC8vIENvbnZlcnQgc3BhY2VzIHRvIGh5cGhlbnNcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5maWx0ZXIodGFnID0+IHRhZyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh2YWxpZFRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHRhZ3M6IHZhbGlkVGFncyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB3ZSBzdGlsbCBjYW4ndCBwYXJzZSwgbG9nIHRoZSByZXNwb25zZSBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgQUkgdGFnIHJlc3BvbnNlOicsIGNsZWFuUmVzcG9uc2UpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIEFJIHRhZyByZXNwb25zZTonLCBlcnJvciwgJ1Jlc3BvbnNlIHdhczonLCByZXNwb25zZSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHN1Y2Nlc3MgbWVzc2FnZSBiYXNlZCBvbiB1cGRhdGVzXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZVN1Y2Nlc3NNZXNzYWdlKHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModXBkYXRlcyk7XG4gICAgICAgIGlmIChrZXlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICdNZXRhZGF0YSB1cGRhdGVkJztcbiAgICAgICAgXG4gICAgICAgIGlmIChrZXlzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5c1swXTtcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICd0YWdzJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gQXJyYXkuaXNBcnJheSh1cGRhdGVzLnRhZ3MpID8gdXBkYXRlcy50YWdzLmxlbmd0aCA6IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBVcGRhdGVkIHRhZ3MgKCR7Y291bnR9IHRhZyR7Y291bnQgIT09IDEgPyAncycgOiAnJ30pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBgVXBkYXRlZCAke2tleX1gO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYFVwZGF0ZWQgJHtrZXlzLmxlbmd0aH0gcHJvcGVydGllc2A7XG4gICAgfVxufSIsICJleHBvcnQgaW50ZXJmYWNlIFRpbWVHYXRlZEZlYXR1cmUge1xuICAgIHN1cGVybm92YURhdGU6IHN0cmluZzsgIC8vIFlZWVktTU0tREQgZm9ybWF0XG4gICAgZ2VuZXJhbERhdGU6IHN0cmluZzsgICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29yZUZlYXR1cmUge1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRmVhdHVyZSByZWxlYXNlIGNvbmZpZ3VyYXRpb24gZm9yIFN1cGVybm92YSBlYXJseSBhY2Nlc3MgbW9kZWxcbiAqIFN1cGVybm92YSBzdXBwb3J0ZXJzIGdldCBmZWF0dXJlcyBvbiBzdXBlcm5vdmFEYXRlXG4gKiBBbGwgdXNlcnMgZ2V0IGZlYXR1cmVzIG9uIGdlbmVyYWxEYXRlXG4gKiBcbiAqIERhdGVzIGFyZSBpbiBZWVlZLU1NLUREIGZvcm1hdCBhbmQgZWFzeSB0byBtb2RpZnkgcG9zdC1sYXVuY2hcbiAqL1xuZXhwb3J0IGNvbnN0IFNVUEVSTk9WQV9GRUFUVVJFUzogUmVjb3JkPHN0cmluZywgVGltZUdhdGVkRmVhdHVyZT4gPSB7XG4gICAgLy8gQ29tbWFuZHMgKHVuaWZpZWQpIC0gMiBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnY29tbWFuZHMnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA3LTMxJywgIC8vIFN1cGVybm92YSBlYXJseSBhY2Nlc3NcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA5LTMwJywgICAvLyBHZW5lcmFsIGF2YWlsYWJpbGl0eSBcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb21tYW5kIHN5c3RlbSB3aXRoIDogdHJpZ2dlcnMsIGNvbW1hbmQgYnV0dG9uLCBhbmQgY3VzdG9tIGNvbW1hbmRzJ1xuICAgIH0sXG4gICAgXG4gICAgLy8gQXV0by1ncm93aW5nIGlucHV0IC0gMSBtb250aCBlYXJseSBhY2Nlc3NcbiAgICAnYXV0by1pbnB1dCc6IHtcbiAgICAgICAgc3VwZXJub3ZhRGF0ZTogJzIwMjUtMDYtMTUnLCAgLy8gTGF1bmNoIGRheVxuICAgICAgICBnZW5lcmFsRGF0ZTogJzIwMjUtMDctMTUnLCAgIC8vIDEgbW9udGggbGF0ZXJcbiAgICAgICAgZGVzY3JpcHRpb246ICdBdXRvLWdyb3dpbmcgaW5wdXQgYXJlYSB3aXRoIHNtb290aCB0cmFuc2l0aW9ucydcbiAgICB9LFxuICAgIFxuICAgIC8vIEVuaGFuY2VkIHByb3ZpZGVyIG1hbmFnZW1lbnQgLSAyIG1vbnRoIGVhcmx5IGFjY2Vzc1xuICAgICdlbmhhbmNlZC1wcm92aWRlcnMnOiB7XG4gICAgICAgIHN1cGVybm92YURhdGU6ICcyMDI1LTA2LTE1JywgIC8vIExhdW5jaCBkYXlcbiAgICAgICAgZ2VuZXJhbERhdGU6ICcyMDI1LTA4LTE1JywgICAvLyAyIG1vbnRocyBsYXRlclxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FkdmFuY2VkIHByb3ZpZGVyIGNvbmZpZ3VyYXRpb24gYW5kIHN3aXRjaGluZydcbiAgICB9XG59O1xuXG4vKipcbiAqIENvcmUgZmVhdHVyZXMgdGhhdCBhcmUgYWx3YXlzIGF2YWlsYWJsZSB0byBhbGwgdXNlcnNcbiAqIFRoZXNlIGFyZSBOT1QgdGltZS1nYXRlZFxuICovXG5leHBvcnQgY29uc3QgQ09SRV9GRUFUVVJFUzogUmVjb3JkPHN0cmluZywgQ29yZUZlYXR1cmU+ID0ge1xuICAgICdiYXNpY19lZGl0aW5nJzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ0Jhc2ljIGRvY3VtZW50IGVkaXRpbmcgY29tbWFuZHMgKGFkZCwgZWRpdCwgZGVsZXRlLCBncmFtbWFyLCByZXdyaXRlKSdcbiAgICB9LFxuICAgICdhbGxfYWlfcHJvdmlkZXJzJzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ0FjY2VzcyB0byBhbGwgQUkgcHJvdmlkZXJzIChDbGF1ZGUsIE9wZW5BSSwgR29vZ2xlLCBPbGxhbWEpJ1xuICAgIH0sXG4gICAgJ2ZpbGVfY29udmVyc2F0aW9ucyc6IHtcbiAgICAgICAgZGVzY3JpcHRpb246ICdGaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gaGlzdG9yeSdcbiAgICB9LFxuICAgICdwcm92aWRlcl9zd2l0Y2hpbmcnOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiAnU3dpdGNoIEFJIHByb3ZpZGVycyBkaXJlY3RseSBpbiBjaGF0IGludGVyZmFjZSdcbiAgICB9LFxuICAgICdtb2JpbGVfYWNjZXNzJzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgbW9iaWxlIGRldmljZSBzdXBwb3J0J1xuICAgIH0sXG4gICAgJ2FwaV9rZXlfY29uZmlnJzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbmZpZ3VyZSB5b3VyIG93biBBUEkga2V5cydcbiAgICB9LFxuICAgICdzaWRlYmFyX2NoYXQnOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ2hhdCBpbnRlcmZhY2UgaW4gc2lkZWJhcidcbiAgICB9LFxuICAgICdkb2N1bWVudF9jb250ZXh0Jzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ0N1cnJlbnQgZG9jdW1lbnQgY29udGV4dCBpbiBjb252ZXJzYXRpb25zJ1xuICAgIH0sXG4gICAgJ211bHRpLWRvYy1jb250ZXh0Jzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ1JlZmVyZW5jZSBvdGhlciBkb2N1bWVudHMgd2l0aCBbW2RvY11dIHN5bnRheCdcbiAgICB9XG59OyIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBTdXBlcm5vdmFMaWNlbnNlLCBGZWF0dXJlRmxhZywgRmVhdHVyZUFjY2Vzc1Jlc3VsdCwgRGVidWdTZXR0aW5ncywgU3VwZXJub3ZhVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgU1VQRVJOT1ZBX0ZFQVRVUkVTLCBDT1JFX0ZFQVRVUkVTLCBUaW1lR2F0ZWRGZWF0dXJlLCBDb3JlRmVhdHVyZSB9IGZyb20gJy4vZmVhdHVyZS1jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgRmVhdHVyZU1hbmFnZXIge1xuXHRwcml2YXRlIGZlYXR1cmVzOiBNYXA8c3RyaW5nLCBGZWF0dXJlRmxhZz4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc3VwZXJub3ZhTGljZW5zZTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGlzU3VwZXJub3ZhOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIGxpY2Vuc2VWYWxpZGF0b3I6IExpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0ZGVidWdTZXR0aW5ncz86IERlYnVnU2V0dGluZ3Ncblx0KSB7XG5cdFx0aWYgKGRlYnVnU2V0dGluZ3MpIHtcblx0XHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IGRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHRcdHRoaXMuaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEluaXRpYWxpemUgYWxsIGZlYXR1cmUgZmxhZ3Ncblx0ICogQ29yZSBmZWF0dXJlcyBhcmUgYWx3YXlzIGVuYWJsZWRcblx0ICogVGltZS1nYXRlZCBmZWF0dXJlcyBkZXBlbmQgb24gY3VycmVudCBkYXRlIGFuZCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRwcml2YXRlIGluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTogdm9pZCB7XG5cdFx0Ly8gQ29yZSBmZWF0dXJlcyAtIGFsd2F5cyBhdmFpbGFibGUgdG8gYWxsIHVzZXJzXG5cdFx0T2JqZWN0LmVudHJpZXMoQ09SRV9GRUFUVVJFUykuZm9yRWFjaCgoW2tleSwgY29uZmlnXSkgPT4ge1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXksXG5cdFx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiBjb25maWcuZGVzY3JpcHRpb25cblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gVGltZS1nYXRlZCBmZWF0dXJlcyAtIGF2YWlsYWJsZSBiYXNlZCBvbiBkYXRlXG5cdFx0T2JqZWN0LmVudHJpZXMoU1VQRVJOT1ZBX0ZFQVRVUkVTKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XG5cdFx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5pc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGtleSwgY29uZmlnKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJGZWF0dXJlKHtcblx0XHRcdFx0a2V5LFxuXHRcdFx0XHRlbmFibGVkLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuXHRcdFx0XHRpc1RpbWVHYXRlZDogdHJ1ZSxcblx0XHRcdFx0ZWFybHlBY2Nlc3NPbmx5OiAhdGhpcy5pc0dlbmVyYWxseUF2YWlsYWJsZShjb25maWcpXG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBhIHRpbWUtZ2F0ZWQgZmVhdHVyZSBzaG91bGQgYmUgZW5hYmxlZFxuXHQgKi9cblx0cHJpdmF0ZSBpc1RpbWVHYXRlZEZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZywgY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IHN1cGVybm92YURhdGUgPSBuZXcgRGF0ZShjb25maWcuc3VwZXJub3ZhRGF0ZSk7XG5cdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gZXZlcnlvbmUgYWZ0ZXIgZ2VuZXJhbCBkYXRlXG5cdFx0aWYgKG5vdyA+PSBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gRmVhdHVyZSBpcyBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgYWZ0ZXIgc3VwZXJub3ZhIGRhdGVcblx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA+PSBzdXBlcm5vdmFEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBTdXBlcm5vdmEgc3RhdHVzIChjYW4gYmUgb3ZlcnJpZGRlbiBpbiBkZWJ1ZyBtb2RlKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRJc1N1cGVybm92YSgpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgJiYgdGhpcy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiB0aGlzLmRlYnVnU2V0dGluZ3MuZm9yY2VTdXBlcm5vdmE7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmlzU3VwZXJub3ZhO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZ2lzdGVyIGEgbmV3IGZlYXR1cmUgZmxhZ1xuXHQgKi9cblx0cmVnaXN0ZXJGZWF0dXJlKGZsYWc6IEZlYXR1cmVGbGFnKTogdm9pZCB7XG5cdFx0dGhpcy5mZWF0dXJlcy5zZXQoZmxhZy5rZXksIGZsYWcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBhbmQgcmVjYWxjdWxhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0ICovXG5cdGFzeW5jIHVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghbGljZW5zZUtleSkge1xuXHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gbnVsbDtcblx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMubGljZW5zZVZhbGlkYXRvci52YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbi52YWxpZCAmJiB2YWxpZGF0aW9uLmxpY2Vuc2UpIHtcblx0XHRcdFx0dGhpcy5zdXBlcm5vdmFMaWNlbnNlID0gdmFsaWRhdGlvbi5saWNlbnNlO1xuXHRcdFx0XHR0aGlzLmlzU3VwZXJub3ZhID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuc3VwZXJub3ZhTGljZW5zZSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaXNTdXBlcm5vdmEgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCB1cGRhdGVkIFN1cGVybm92YSBzdGF0dXNcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBTdXBlcm5vdmEgc3RhdHVzXG5cdCAqL1xuXHRpc1N1cGVybm92YVN1cHBvcnRlcigpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRJc1N1cGVybm92YSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IFN1cGVybm92YSBsaWNlbnNlXG5cdCAqL1xuXHRnZXRTdXBlcm5vdmFMaWNlbnNlKCk6IFN1cGVybm92YUxpY2Vuc2UgfCBudWxsIHtcblx0XHRyZXR1cm4gdGhpcy5zdXBlcm5vdmFMaWNlbnNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgZmVhdHVyZSBpcyBlbmFibGVkXG5cdCAqL1xuXHRpc0ZlYXR1cmVFbmFibGVkKGZlYXR1cmVLZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdC8vIEhhbmRsZSBvbGQgZmVhdHVyZSBrZXlzIHRoYXQgbWlnaHQgc3RpbGwgYmUgcmVmZXJlbmNlZFxuXHRcdGlmICh0aGlzLmlzTGVnYWN5RmVhdHVyZUtleShmZWF0dXJlS2V5KSkge1xuXHRcdFx0cmV0dXJuIHRydWU7IC8vIEFsbCBsZWdhY3kgZmVhdHVyZXMgYXJlIG5vdyBlbmFibGVkIGZvciBldmVyeW9uZVxuXHRcdH1cblxuXHRcdGNvbnN0IGZlYXR1cmUgPSB0aGlzLmZlYXR1cmVzLmdldChmZWF0dXJlS2V5KTtcblx0XHRyZXR1cm4gZmVhdHVyZT8uZW5hYmxlZCA/PyBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiB0aGlzIGlzIGEgbGVnYWN5IGZlYXR1cmUga2V5IHRoYXQgc2hvdWxkIGFsd2F5cyBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzTGVnYWN5RmVhdHVyZUtleShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGxlZ2FjeUtleXMgPSBbXG5cdFx0XHQnYmFzaWNfZWRpdGluZycsXG5cdFx0XHQnbG9jYWxfYWlfcHJvdmlkZXJzJyxcblx0XHRcdCdmaWxlX2NvbnZlcnNhdGlvbnMnLFxuXHRcdFx0J3NpbmdsZV9jbG91ZF9wcm92aWRlcicsXG5cdFx0XHQndW5saW1pdGVkX2Nsb3VkX2FpJyxcblx0XHRcdCdwcm92aWRlcl9zd2l0Y2hpbmcnLFxuXHRcdFx0J21vYmlsZV9hY2Nlc3MnLFxuXHRcdFx0J2FkdmFuY2VkX3RlbXBsYXRlcycsXG5cdFx0XHQnYmF0Y2hfb3BlcmF0aW9ucycsXG5cdFx0XHQnY3Jvc3NfZG9jdW1lbnRfY29udGV4dCcsXG5cdFx0XHQncHJpb3JpdHlfc3VwcG9ydCdcblx0XHRdO1xuXHRcdHJldHVybiBsZWdhY3lLZXlzLmluY2x1ZGVzKGtleSk7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgZmVhdHVyZSBhY2Nlc3Mgd2l0aCBkZXRhaWxlZCByZXN1bHRcblx0ICovXG5cdGNoZWNrRmVhdHVyZUFjY2VzcyhmZWF0dXJlS2V5OiBzdHJpbmcpOiBGZWF0dXJlQWNjZXNzUmVzdWx0IHtcblx0XHQvLyBIYW5kbGUgbGVnYWN5IGZlYXR1cmVzXG5cdFx0aWYgKHRoaXMuaXNMZWdhY3lGZWF0dXJlS2V5KGZlYXR1cmVLZXkpKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Y29uc3QgZmVhdHVyZSA9IHRoaXMuZmVhdHVyZXMuZ2V0KGZlYXR1cmVLZXkpO1xuXHRcdFxuXHRcdGlmICghZmVhdHVyZSkge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLCBcblx0XHRcdFx0cmVhc29uOiBgRmVhdHVyZSAnJHtmZWF0dXJlS2V5fScgbm90IGZvdW5kYCBcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0cmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xuXHRcdH1cblxuXHRcdC8vIEZvciB0aW1lLWdhdGVkIGZlYXR1cmVzLCBwcm92aWRlIG1vcmUgaW5mb3JtYXRpb25cblx0XHRpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2ZlYXR1cmVLZXldO1xuXHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0XHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRcdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblxuXHRcdFx0XHRpZiAodGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IHN1cGVybm92YURhdGUpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWFzb246IGBUaGlzIGZlYXR1cmUgd2lsbCBiZSBhdmFpbGFibGUgdG8gU3VwZXJub3ZhIHN1cHBvcnRlcnMgb24gJHtjb25maWcuc3VwZXJub3ZhRGF0ZX1gLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmFGZWF0dXJlOiB0cnVlLFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogc3VwZXJub3ZhRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSBpZiAoIXRoaXMuZ2V0SXNTdXBlcm5vdmEoKSAmJiBub3cgPCBnZW5lcmFsRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSBpcyBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gSXQgd2lsbCBiZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIG9uICR7Y29uZmlnLmdlbmVyYWxEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBnZW5lcmFsRGF0ZVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0YWxsb3dlZDogZmFsc2UsXG5cdFx0XHRyZWFzb246ICdGZWF0dXJlIGlzIG5vdCBhdmFpbGFibGUnXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYWxsIGVuYWJsZWQgZmVhdHVyZXNcblx0ICovXG5cdGdldEVuYWJsZWRGZWF0dXJlcygpOiBGZWF0dXJlRmxhZ1tdIHtcblx0XHRyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmZlYXR1cmVzLnZhbHVlcygpKS5maWx0ZXIoZmVhdHVyZSA9PiBmZWF0dXJlLmVuYWJsZWQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgU3VwZXJub3ZhIGVhcmx5IGFjY2VzcyBmZWF0dXJlc1xuXHQgKi9cblx0Z2V0U3VwZXJub3ZhRmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gXG5cdFx0XHRmZWF0dXJlLmlzVGltZUdhdGVkICYmIGZlYXR1cmUuZWFybHlBY2Nlc3NPbmx5XG5cdFx0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgZGVidWcgc2V0dGluZ3MgZm9yIGRldmVsb3BtZW50IHRlc3Rpbmdcblx0ICovXG5cdHVwZGF0ZURlYnVnU2V0dGluZ3Moc2V0dGluZ3M6IERlYnVnU2V0dGluZ3MpOiB2b2lkIHtcblx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHQvLyBSZWluaXRpYWxpemUgZmVhdHVyZXMgd2l0aCBuZXcgZGVidWcgc2V0dGluZ3Ncblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeVxuXHQgKi9cblx0Z2V0RmVhdHVyZVN1bW1hcnkoKTogeyBcblx0XHRpc1N1cGVybm92YTogYm9vbGVhbjsgXG5cdFx0ZW5hYmxlZDogc3RyaW5nW107IFxuXHRcdGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+IFxuXHR9IHtcblx0XHRjb25zdCBlbmFibGVkOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGNvbWluZ1Nvb246IEFycmF5PHtrZXk6IHN0cmluZzsgYXZhaWxhYmxlRGF0ZTogc3RyaW5nOyBpc1N1cGVybm92YTogYm9vbGVhbn0+ID0gW107XG5cblx0XHRmb3IgKGNvbnN0IFtrZXksIGZlYXR1cmVdIG9mIHRoaXMuZmVhdHVyZXMpIHtcblx0XHRcdGlmIChmZWF0dXJlLmVuYWJsZWQpIHtcblx0XHRcdFx0ZW5hYmxlZC5wdXNoKGtleSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZlYXR1cmUuaXNUaW1lR2F0ZWQpIHtcblx0XHRcdFx0Y29uc3QgY29uZmlnID0gU1VQRVJOT1ZBX0ZFQVRVUkVTW2tleV07XG5cdFx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0XHRjb25zdCBpc1N1cGVybm92YVVzZXIgPSB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cdFx0XHRcdFx0Y29taW5nU29vbi5wdXNoKHtcblx0XHRcdFx0XHRcdGtleSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGlzU3VwZXJub3ZhVXNlciA/IGNvbmZpZy5zdXBlcm5vdmFEYXRlIDogY29uZmlnLmdlbmVyYWxEYXRlLFxuXHRcdFx0XHRcdFx0aXNTdXBlcm5vdmE6IGlzU3VwZXJub3ZhVXNlclxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHsgXG5cdFx0XHRpc1N1cGVybm92YTogdGhpcy5nZXRJc1N1cGVybm92YSgpLCBcblx0XHRcdGVuYWJsZWQsIFxuXHRcdFx0Y29taW5nU29vbiBcblx0XHR9O1xuXHR9XG59IiwgImltcG9ydCB7IExpY2Vuc2UsIFN1cGVybm92YUxpY2Vuc2UsIExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0LCBTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0LCBMaWNlbnNlRXJyb3IgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIExpY2Vuc2VWYWxpZGF0b3Ige1xuXHQvLyBFbWJlZGRlZCBzaWduaW5nIGtleSAtIGluIHByb2R1Y3Rpb24gdGhpcyB3b3VsZCBiZSBvYmZ1c2NhdGVkXG5cdHByaXZhdGUgcmVhZG9ubHkgU0VDUkVUX0tFWSA9ICdub3ZhLWxpY2Vuc2Utc2lnbmluZy1rZXktMjAyNSc7XG5cdFxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBrZXkgYW5kIHJldHVybnMgdmFsaWRhdGlvbiByZXN1bHRcblx0ICovXG5cdGFzeW5jIHZhbGlkYXRlTGljZW5zZShsaWNlbnNlS2V5OiBzdHJpbmcpOiBQcm9taXNlPExpY2Vuc2VWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgbGljZW5zZSBrZXkgc3RyaW5nIGludG8gYSBMaWNlbnNlIG9iamVjdFxuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBMaWNlbnNlIGtleSBmb3JtYXQ6IGJhc2U2NChlbWFpbHx0aWVyfGV4cGlyZXNBdHxpc3N1ZWRBdHxzaWduYXR1cmUpXG5cdFx0XHRjb25zdCBkZWNvZGVkID0gdGhpcy5iYXNlNjREZWNvZGUobGljZW5zZUtleSk7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IGRlY29kZWQuc3BsaXQoJ3wnKTtcblx0XHRcdFxuXHRcdFx0aWYgKHBhcnRzLmxlbmd0aCAhPT0gNSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgW2VtYWlsLCB0aWVyLCBleHBpcmVzQXRTdHIsIGlzc3VlZEF0U3RyLCBzaWduYXR1cmVdID0gcGFydHM7XG5cblx0XHRcdC8vIFNraXAgdGllciB2YWxpZGF0aW9uIHNpbmNlIHdlJ3JlIHJlbW92aW5nIHRpZXJzXG5cblx0XHRcdC8vIFBhcnNlIGRhdGVzXG5cdFx0XHRjb25zdCBleHBpcmVzQXQgPSBleHBpcmVzQXRTdHIgPT09ICdsaWZldGltZScgPyBudWxsIDogbmV3IERhdGUoZXhwaXJlc0F0U3RyKTtcblx0XHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoaXNzdWVkQXRTdHIpO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBkYXRlc1xuXHRcdFx0aWYgKGlzTmFOKGlzc3VlZEF0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChleHBpcmVzQXQgJiYgaXNOYU4oZXhwaXJlc0F0LmdldFRpbWUoKSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGVtYWlsLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTYWZlIGJhc2U2NCBkZWNvZGUgdGhhdCBoYW5kbGVzIGJvdGggYnJvd3NlciBhbmQgTm9kZS5qcyBlbnZpcm9ubWVudHNcblx0ICovXG5cdHByaXZhdGUgYmFzZTY0RGVjb2RlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAodHlwZW9mIGF0b2IgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gYXRvYihzdHIpO1xuXHRcdH1cblx0XHQvLyBGYWxsYmFjayBmb3IgTm9kZS5qcyBlbnZpcm9ubWVudFxuXHRcdHJldHVybiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGVuY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjRFbmNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHJldHVybiBidG9hKHN0cik7XG5cdFx0fVxuXHRcdC8vIEZhbGxiYWNrIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IExpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0J2xlZ2FjeScsIC8vIFVzZSBsZWdhY3kgZm9yIG9sZCBsaWNlbnNlc1xuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlIChwcmV2ZW50IGZ1dHVyZS1kYXRlZCBsaWNlbnNlcylcblx0XHRpZiAobGljZW5zZS5pc3N1ZWRBdCA+IG5ldyBEYXRlKCkpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRlVUVVJFX0RBVEVEO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIGxpY2Vuc2UgZGF0YVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHRpZXI6IHN0cmluZyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50IHB1cnBvc2VzXG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0TGljZW5zZShlbWFpbDogc3RyaW5nLCB0aWVyOiBzdHJpbmcsIGxpZmV0aW1lTW9kZSA9IHRydWUpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGlzc3VlZEF0ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBleHBpcmVzQXQgPSBsaWZldGltZU1vZGUgPyBudWxsIDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyAxIHllYXJcblxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTaWduYXR1cmUoZW1haWwsIHRpZXIsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dGllcn18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5XG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleTogc3RyaW5nKTogUHJvbWlzZTxTdXBlcm5vdmFWYWxpZGF0aW9uUmVzdWx0PiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGxpY2Vuc2UgPSB0aGlzLnBhcnNlU3VwZXJub3ZhTGljZW5zZUtleShsaWNlbnNlS2V5KTtcblx0XHRcdGlmICghbGljZW5zZSkge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9GT1JNQVQgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IGF3YWl0IHRoaXMudmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2UpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb25FcnJvcikge1xuXHRcdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRcdGxpY2Vuc2UsXG5cdFx0XHRcdFx0ZXJyb3I6IHZhbGlkYXRpb25FcnJvciBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiB0cnVlLCBcblx0XHRcdFx0bGljZW5zZSBcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogZmFsc2UsIFxuXHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLk1BTEZPUk1FRF9EQVRBIFxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGFyc2VzIGEgU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IHN0cmluZ1xuXHQgKi9cblx0cHJpdmF0ZSBwYXJzZVN1cGVybm92YUxpY2Vuc2VLZXkobGljZW5zZUtleTogc3RyaW5nKTogU3VwZXJub3ZhTGljZW5zZSB8IG51bGwge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBrZXkgZm9ybWF0OiBiYXNlNjQoZW1haWx8dHlwZXxleHBpcmVzQXR8aXNzdWVkQXR8c2lnbmF0dXJlKVxuXHRcdFx0Y29uc3QgZGVjb2RlZCA9IHRoaXMuYmFzZTY0RGVjb2RlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBkZWNvZGVkLnNwbGl0KCd8Jyk7XG5cdFx0XHRcblx0XHRcdGlmIChwYXJ0cy5sZW5ndGggIT09IDUpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IFtlbWFpbCwgdHlwZSwgZXhwaXJlc0F0U3RyLCBpc3N1ZWRBdFN0ciwgc2lnbmF0dXJlXSA9IHBhcnRzO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSB0eXBlXG5cdFx0XHRpZiAodHlwZSAhPT0gJ2FubnVhbCcgJiYgdHlwZSAhPT0gJ2xpZmV0aW1lJykge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdHR5cGU6IHR5cGUgYXMgJ2FubnVhbCcgfCAnbGlmZXRpbWUnLFxuXHRcdFx0XHRleHBpcmVzQXQsXG5cdFx0XHRcdGlzc3VlZEF0LFxuXHRcdFx0XHRzaWduYXR1cmUsXG5cdFx0XHRcdGxpY2Vuc2VLZXlcblx0XHRcdH07XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBTdXBlcm5vdmEgbGljZW5zZSBvYmplY3Rcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlT2JqZWN0KGxpY2Vuc2U6IFN1cGVybm92YUxpY2Vuc2UpOiBQcm9taXNlPExpY2Vuc2VFcnJvciB8IG51bGw+IHtcblx0XHQvLyAxLiBWZXJpZnkgSE1BQyBzaWduYXR1cmVcblx0XHRjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdXBlcm5vdmFTaWduYXR1cmUoXG5cdFx0XHRsaWNlbnNlLmVtYWlsLFxuXHRcdFx0bGljZW5zZS50eXBlLFxuXHRcdFx0bGljZW5zZS5leHBpcmVzQXQsXG5cdFx0XHRsaWNlbnNlLmlzc3VlZEF0XG5cdFx0KTtcblxuXHRcdGlmIChsaWNlbnNlLnNpZ25hdHVyZSAhPT0gZXhwZWN0ZWRTaWduYXR1cmUpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuSU5WQUxJRF9TSUdOQVRVUkU7XG5cdFx0fVxuXG5cdFx0Ly8gMi4gQ2hlY2sgZXhwaXJhdGlvblxuXHRcdGlmIChsaWNlbnNlLmV4cGlyZXNBdCAmJiBuZXcgRGF0ZSgpID4gbGljZW5zZS5leHBpcmVzQXQpIHtcblx0XHRcdHJldHVybiBMaWNlbnNlRXJyb3IuRVhQSVJFRDtcblx0XHR9XG5cblx0XHQvLyAzLiBWYWxpZGF0ZSBpc3N1ZSBkYXRlXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBTdXBlcm5vdmEgbGljZW5zZVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShcblx0XHRlbWFpbDogc3RyaW5nLFxuXHRcdHR5cGU6ICdhbm51YWwnIHwgJ2xpZmV0aW1lJyxcblx0XHRleHBpcmVzQXQ6IERhdGUgfCBudWxsLFxuXHRcdGlzc3VlZEF0OiBEYXRlXG5cdCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGF0YSA9IGAke2VtYWlsfXwke3R5cGV9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX1gO1xuXHRcdFxuXHRcdGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblx0XHRjb25zdCBrZXlEYXRhID0gZW5jb2Rlci5lbmNvZGUodGhpcy5TRUNSRVRfS0VZKTtcblx0XHRjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXHRcdFxuXHRcdGNvbnN0IGNyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuXHRcdFx0J3JhdycsXG5cdFx0XHRrZXlEYXRhLFxuXHRcdFx0eyBuYW1lOiAnSE1BQycsIGhhc2g6ICdTSEEtMjU2JyB9LFxuXHRcdFx0ZmFsc2UsXG5cdFx0XHRbJ3NpZ24nXVxuXHRcdCk7XG5cdFx0XG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKCdITUFDJywgY3J5cHRvS2V5LCBtZXNzYWdlRGF0YSk7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcblx0XHRcdC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuXHRcdFx0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSB0ZXN0IFN1cGVybm92YSBsaWNlbnNlIGZvciBkZXZlbG9wbWVudFxuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdFN1cGVybm92YUxpY2Vuc2UoZW1haWw6IHN0cmluZywgdHlwZTogJ2FubnVhbCcgfCAnbGlmZXRpbWUnKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gdHlwZSA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDEgeWVhclxuXG5cdFx0Y29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1cGVybm92YVNpZ25hdHVyZShlbWFpbCwgdHlwZSwgZXhwaXJlc0F0LCBpc3N1ZWRBdCk7XG5cdFx0XG5cdFx0Y29uc3QgbGljZW5zZURhdGEgPSBgJHtlbWFpbH18JHt0eXBlfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9fCR7c2lnbmF0dXJlfWA7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuYmFzZTY0RW5jb2RlKGxpY2Vuc2VEYXRhKTtcblx0fVxufSIsICJleHBvcnQgaW50ZXJmYWNlIEludGVudENsYXNzaWZpY2F0aW9uIHtcbiAgICB0eXBlOiAnY29uc3VsdGF0aW9uJyB8ICdlZGl0aW5nJyB8ICdhbWJpZ3VvdXMnO1xuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcbiAgICBtYXRjaGVkUGF0dGVybnM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgY2xhc3MgSW50ZW50RGV0ZWN0b3Ige1xuICAgIHByaXZhdGUgY29uc3VsdGF0aW9uUGF0dGVybnMgPSBbXG4gICAgICAgIHsgcGF0dGVybjogL14oTm93IGlzfFRvZGF5fFRoaXMgd2Vla3xMYXRlbHl8Q3VycmVudGx5fFRoZXNlIGRheXMpL2ksIG5hbWU6ICd0ZW1wb3JhbCcgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxiKEknbSAoZmVlbGluZ3x0aGlua2luZ3x3b3JraW5nfHRyeWluZyl8SSd2ZSBiZWVufEkgd2FzfEkgZmVlbClcXGIvaSwgbmFtZTogJ3BlcnNvbmFsX3N0YXRlJyB9LFxuICAgICAgICB7IHBhdHRlcm46IC9cXGIocmVtaW5kcyBtZXxtYWtlcyBtZSB0aGlua3xJIHdvbmRlcnxJJ20gd29uZGVyaW5nKVxcYi9pLCBuYW1lOiAncmVmbGVjdGl2ZScgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxiKEkgdGhpbmt8SSBiZWxpZXZlfEkgc3VzcGVjdHxJIG5vdGljZXxzZWVtcyBsaWtlfGFwcGVhcnN8bG9va3MgbGlrZSlcXGIvaSwgbmFtZTogJ29waW5pb25fb2JzZXJ2YXRpb24nIH0sXG4gICAgICAgIHsgcGF0dGVybjogL1xcYihtaWdodCBiZXxjb3VsZCBiZXxtYXkgYmV8cHJvYmFibHl8cGVyaGFwc3xtYXliZSlcXGIvaSwgbmFtZTogJ3NwZWN1bGF0aW9uJyB9XG4gICAgXTtcblxuICAgIHByaXZhdGUgZWRpdGluZ1BhdHRlcm5zID0gW1xuICAgICAgICB7IHBhdHRlcm46IC9cXGIobWFrKGV8aW5nKXxmaXh8aW1wcm92ZXxjaGFuZ2V8YWRkfHJlbW92ZXxyZXdyaXRlfGVkaXQpXFxiL2ksIG5hbWU6ICdjb21tYW5kX3ZlcmInIH0sXG4gICAgICAgIHsgcGF0dGVybjogL1xcYih0aGlzIChzZWN0aW9ufHBhcmFncmFwaHxwYXJ0fHRleHR8d3JpdGluZ3xiZXR0ZXIpfHRoZSB3cml0aW5nIGhlcmV8aGVyZSB3ZXxoZXJlIG5lZWRzfHRoaXMgaXMgKHVuY2xlYXJ8d3Jvbmd8Y29uZnVzaW5nfHJpZ2h0KSlcXGIvaSwgbmFtZTogJ2RvY3VtZW50X3JlZmVyZW5jZScgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxiKHVuY2xlYXJ8bmVlZHMgd29ya3xzb3VuZHMgd3Jvbmd8dG9vIHdvcmR5fGNvbmZ1c2luZylcXGIvaSwgbmFtZTogJ3F1YWxpdHlfYXNzZXNzbWVudCcgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxiKGF0IHRoZSBlbmR8aW4gdGhlIChpbnRyb2R1Y3Rpb258Y29uY2x1c2lvbil8YmVmb3JlIHRoaXN8YWZ0ZXIgdGhhdClcXGIvaSwgbmFtZTogJ2RvY3VtZW50X3RhcmdldGluZycgfVxuICAgIF07XG5cbiAgICBjbGFzc2lmeUlucHV0KGlucHV0OiBzdHJpbmcpOiBJbnRlbnRDbGFzc2lmaWNhdGlvbiB7XG4gICAgICAgIGNvbnN0IGNvbnN1bHRhdGlvbk1hdGNoZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IGVkaXRpbmdNYXRjaGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCB7IHBhdHRlcm4sIG5hbWUgfSBvZiB0aGlzLmNvbnN1bHRhdGlvblBhdHRlcm5zKSB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgIGNvbnN1bHRhdGlvbk1hdGNoZXMucHVzaChuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgeyBwYXR0ZXJuLCBuYW1lIH0gb2YgdGhpcy5lZGl0aW5nUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgZWRpdGluZ01hdGNoZXMucHVzaChuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIG9ubHkgY29uc3VsdGF0aW9uIHBhdHRlcm5zIG1hdGNoXG4gICAgICAgIGlmIChjb25zdWx0YXRpb25NYXRjaGVzLmxlbmd0aCA+IDAgJiYgZWRpdGluZ01hdGNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdjb25zdWx0YXRpb24nLFxuICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOSxcbiAgICAgICAgICAgICAgICBtYXRjaGVkUGF0dGVybnM6IGNvbnN1bHRhdGlvbk1hdGNoZXNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBvbmx5IGVkaXRpbmcgcGF0dGVybnMgbWF0Y2hcbiAgICAgICAgaWYgKGVkaXRpbmdNYXRjaGVzLmxlbmd0aCA+IDAgJiYgY29uc3VsdGF0aW9uTWF0Y2hlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2VkaXRpbmcnLFxuICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOSxcbiAgICAgICAgICAgICAgICBtYXRjaGVkUGF0dGVybnM6IGVkaXRpbmdNYXRjaGVzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgYm90aCBwYXR0ZXJucyBtYXRjaCwgZmF2b3IgY29uc3VsdGF0aW9uIHdoZW4gc3BlY3VsYXRpb24gb3Igb3BpbmlvbiBwYXR0ZXJucyBhcmUgcHJlc2VudFxuICAgICAgICBpZiAoY29uc3VsdGF0aW9uTWF0Y2hlcy5sZW5ndGggPiAwICYmIGVkaXRpbmdNYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGhhc1NwZWN1bGF0aW9uID0gY29uc3VsdGF0aW9uTWF0Y2hlcy5pbmNsdWRlcygnc3BlY3VsYXRpb24nKSB8fCBjb25zdWx0YXRpb25NYXRjaGVzLmluY2x1ZGVzKCdvcGluaW9uX29ic2VydmF0aW9uJyk7XG4gICAgICAgICAgICBpZiAoaGFzU3BlY3VsYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29uc3VsdGF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlkZW5jZTogMC44LFxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkUGF0dGVybnM6IGNvbnN1bHRhdGlvbk1hdGNoZXNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHRyZWF0IGFzIGFtYmlndW91c1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdhbWJpZ3VvdXMnLFxuICAgICAgICAgICAgY29uZmlkZW5jZTogMC41LFxuICAgICAgICAgICAgbWF0Y2hlZFBhdHRlcm5zOiBbXVxuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBBSSBJbnRlbnQgQ2xhc3NpZmllciBmb3IgTm92YVxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHVzZXIgaW5wdXQgaXMgYSBjaGF0LCBtZXRhZGF0YSBjb21tYW5kLCBvciBjb250ZW50IGNvbW1hbmRcbiAqL1xuXG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgSW50ZW50RGV0ZWN0b3IsIEludGVudENsYXNzaWZpY2F0aW9uIH0gZnJvbSAnLi9pbnRlbnQtZGV0ZWN0b3InO1xuXG5leHBvcnQgdHlwZSBVc2VySW50ZW50ID0gJ0NIQVQnIHwgJ01FVEFEQVRBJyB8ICdDT05URU5UJztcblxuZXhwb3J0IGNsYXNzIEFJSW50ZW50Q2xhc3NpZmllciB7XG4gICAgcHJpdmF0ZSBpbnRlbnREZXRlY3RvcjogSW50ZW50RGV0ZWN0b3I7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7XG4gICAgICAgIHRoaXMuaW50ZW50RGV0ZWN0b3IgPSBuZXcgSW50ZW50RGV0ZWN0b3IoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGFzc2lmeSB1c2VyIGlucHV0IGludG8gb25lIG9mIHRocmVlIGludGVudHNcbiAgICAgKi9cbiAgICBhc3luYyBjbGFzc2lmeUludGVudCh1c2VySW5wdXQ6IHN0cmluZywgaGFzU2VsZWN0aW9uOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPFVzZXJJbnRlbnQ+IHtcbiAgICAgICAgLy8gSGFuZGxlIHNwZWNpYWwgc3ludGF4IGZpcnN0XG4gICAgICAgIGlmICh1c2VySW5wdXQuc3RhcnRzV2l0aCgnOicpKSB7XG4gICAgICAgICAgICAvLyBDb2xvbiBjb21tYW5kcyBhcmUgdHlwaWNhbGx5IHByb3ZpZGVyIHN3aXRjaGVzIG9yIGN1c3RvbSBjb21tYW5kc1xuICAgICAgICAgICAgcmV0dXJuICdDSEFUJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFsd2F5cyB1c2UgZmFsbGJhY2sgZm9yIG5vdyAtIEFJIGNsYXNzaWZpY2F0aW9uIGlzIGNhdXNpbmcgaXNzdWVzXG4gICAgICAgIC8vIFdlIGNhbiByZS1lbmFibGUgdGhpcyBvbmNlIHdlIGhhdmUgYSBtb3JlIHJlbGlhYmxlIGFwcHJvYWNoXG4gICAgICAgIHJldHVybiB0aGlzLmZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0KTtcbiAgICAgICAgXG4gICAgICAgIC8qIERpc2FibGVkIEFJIGNsYXNzaWZpY2F0aW9uIGR1ZSB0byBwcm92aWRlciBjb21wYXRpYmlsaXR5IGlzc3Vlc1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gU2ltcGxpZmllZCBwcm9tcHQgZm9yIGJldHRlciBjb21wYXRpYmlsaXR5XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSBgQ2xhc3NpZnkgdGhpcyB0ZXh0IGFzIENIQVQsIE1FVEFEQVRBLCBvciBDT05URU5UOlxuXCIke3VzZXJJbnB1dH1cIlxuXG5DSEFUID0gcXVlc3Rpb25zL2Rpc2N1c3Npb25cbk1FVEFEQVRBID0gdGFncy9wcm9wZXJ0aWVzL2Zyb250bWF0dGVyXG5DT05URU5UID0gZWRpdCBkb2N1bWVudCB0ZXh0XG5cbkFuc3dlciB3aXRoIG9uZSB3b3JkIG9ubHk6YDtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZSgnJywgcHJvbXB0LCB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuMSxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDEwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgY2xhc3NpZmljYXRpb24gPSByZXNwb25zZS50cmltKCkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcmVzcG9uc2VcbiAgICAgICAgICAgIGlmIChjbGFzc2lmaWNhdGlvbiA9PT0gJ0NIQVQnIHx8IGNsYXNzaWZpY2F0aW9uID09PSAnTUVUQURBVEEnIHx8IGNsYXNzaWZpY2F0aW9uID09PSAnQ09OVEVOVCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2xhc3NpZmljYXRpb24gYXMgVXNlckludGVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmFsbGJhY2sgaGV1cmlzdGljIGlmIEFJIGdpdmVzIHVuZXhwZWN0ZWQgcmVzcG9uc2VcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FJIGludGVudCBjbGFzc2lmaWNhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8gVXNlIGZhbGxiYWNrIGhldXJpc3RpY1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmFsbGJhY2tDbGFzc2lmaWNhdGlvbih1c2VySW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgICovXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5oYW5jZWQgZmFsbGJhY2sgY2xhc3NpZmljYXRpb24gdXNpbmcgSW50ZW50RGV0ZWN0b3JcbiAgICAgKi9cbiAgICBwcml2YXRlIGZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0OiBzdHJpbmcpOiBVc2VySW50ZW50IHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnB1dCA9IHVzZXJJbnB1dC50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgcXVlc3Rpb25zIEZJUlNUIChoaWdoZXN0IHByaW9yaXR5KVxuICAgICAgICBpZiAobG93ZXJJbnB1dC5pbmNsdWRlcygnPycpIHx8IFxuICAgICAgICAgICAgbG93ZXJJbnB1dC5zdGFydHNXaXRoKCd3aGF0JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2h5JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnaG93JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hlbicpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ3doZXJlJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hvJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnY2FuIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ2NvdWxkIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LmluY2x1ZGVzKCdleHBsYWluJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuaW5jbHVkZXMoJ2hlbHAgbWUgdW5kZXJzdGFuZCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0NIQVQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXNlIG91ciBuZXcgSW50ZW50RGV0ZWN0b3IgZm9yIGNvbnN1bHRhdGlvbiB2cyBlZGl0aW5nIHBhdHRlcm5zXG4gICAgICAgIGNvbnN0IGludGVudENsYXNzaWZpY2F0aW9uID0gdGhpcy5pbnRlbnREZXRlY3Rvci5jbGFzc2lmeUlucHV0KHVzZXJJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgSW50ZW50RGV0ZWN0b3IgcmVzdWx0cyB0byBvdXIgc3lzdGVtXG4gICAgICAgIGlmIChpbnRlbnRDbGFzc2lmaWNhdGlvbi50eXBlID09PSAnY29uc3VsdGF0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuICdDSEFUJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKGludGVudENsYXNzaWZpY2F0aW9uLnR5cGUgPT09ICdlZGl0aW5nJykge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBtZXRhZGF0YS1yZWxhdGVkIGVkaXRpbmdcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTWV0YWRhdGFSZWxhdGVkKGxvd2VySW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdNRVRBREFUQSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJ0NPTlRFTlQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIGFtYmlndW91cyBjYXNlcywgY2hlY2sgbWV0YWRhdGEgcGF0dGVybnNcbiAgICAgICAgaWYgKHRoaXMuaXNNZXRhZGF0YVJlbGF0ZWQobG93ZXJJbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnTUVUQURBVEEnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmYXVsdCB0byBjb250ZW50IGVkaXRpbmcgZm9yIG90aGVyIGNvbW1hbmRzXG4gICAgICAgIHJldHVybiAnQ09OVEVOVCc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIG1ldGhvZCB0byBjaGVjayBpZiBpbnB1dCBpcyBtZXRhZGF0YS1yZWxhdGVkXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc01ldGFkYXRhUmVsYXRlZChsb3dlcklucHV0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIC8vIFRhZy1zcGVjaWZpYyBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYnRhZ3M/XFxiL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgL1xcYnRhZ2dpbmdcXGIvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBQcm9wZXJ0eSBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYih0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXN8Y2F0ZWdvcnl8Y2F0ZWdvcmllcylcXGIvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBNZXRhZGF0YS9mcm9udG1hdHRlciBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYihtZXRhZGF0YXxmcm9udG1hdHRlcnxwcm9wZXJ0aWVzfHByb3BlcnR5KVxcYi9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC8vIENvbW1vbiBtZXRhZGF0YSBhY3Rpb25zXG4gICAgICAgICAgICAvXihhZGR8dXBkYXRlfHNldHxyZW1vdmV8Y2xlYW58b3B0aW1pemUpXFxzKyh0YWdzP3x0aXRsZXxhdXRob3J8bWV0YWRhdGEpL2kudGVzdChsb3dlcklucHV0KVxuICAgICAgICApO1xuICAgIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG9CQUFtSDs7O0FDQW5ILElBQUFDLG9CQUF5RDs7O0FDQXpELElBQUFDLG9CQUE0STs7O0FDT3JJLElBQU0sbUJBQU4sTUFBdUI7QUFBQSxFQUM3QixPQUFPLGlCQUFpQixTQUFvQztBQUMzRCxVQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFDaEMsVUFBTSxXQUFxRSxDQUFDO0FBQzVFLFVBQU0sZ0JBQTBCLENBQUM7QUFDakMsVUFBTSxvQkFBOEIsQ0FBQztBQUdyQyxhQUFTLElBQUksR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ3RDLFlBQU0sT0FBTyxNQUFNLENBQUMsRUFBRSxLQUFLO0FBQzNCLFlBQU0sZUFBZSxLQUFLLE1BQU0sbUJBQW1CO0FBRW5ELFVBQUksY0FBYztBQUNqQixjQUFNLFFBQVEsYUFBYSxDQUFDLEVBQUU7QUFDOUIsY0FBTSxPQUFPLGFBQWEsQ0FBQztBQUczQixjQUFNLGFBQWEsS0FBSyx1QkFBdUIsT0FBTyxDQUFDO0FBQ3ZELGNBQU0sVUFBVSxDQUFDO0FBRWpCLGlCQUFTLEtBQUssRUFBRSxPQUFPLE1BQU0sUUFBUSxDQUFDO0FBRXRDLFlBQUksU0FBUztBQUNaLHdCQUFjLEtBQUssSUFBSTtBQUFBLFFBQ3hCO0FBQUEsTUFDRDtBQUdBLFVBQUksS0FBSyxNQUFNLDBCQUEwQixLQUFLLEtBQUssTUFBTSxZQUFZLEtBQUssS0FBSyxNQUFNLHNCQUFzQixHQUFHO0FBQzdHLDBCQUFrQixLQUFLLElBQUk7QUFBQSxNQUM1QjtBQUFBLElBQ0Q7QUFFQSxVQUFNLFlBQVksUUFBUSxNQUFNLEtBQUssRUFBRSxPQUFPLFVBQVEsS0FBSyxTQUFTLENBQUMsRUFBRTtBQUV2RSxXQUFPO0FBQUEsTUFDTjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUEsRUFFQSxPQUFlLHVCQUF1QixPQUFpQixjQUErQjtBQWxEdkY7QUFtREUsVUFBTSxpQkFBaUIsTUFBTSxZQUFZLEVBQUUsS0FBSztBQUNoRCxVQUFNLGlCQUFlLG9CQUFlLE1BQU0sV0FBVyxNQUFoQyxtQkFBb0MsR0FBRyxXQUFVO0FBRXRFLGFBQVMsSUFBSSxlQUFlLEdBQUcsSUFBSSxNQUFNLFFBQVEsS0FBSztBQUNyRCxZQUFNLE9BQU8sTUFBTSxDQUFDLEVBQUUsS0FBSztBQUczQixZQUFNLGVBQWUsS0FBSyxNQUFNLGFBQWE7QUFDN0MsVUFBSSxjQUFjO0FBQ2pCLGNBQU0sWUFBWSxhQUFhLENBQUMsRUFBRTtBQUlsQyxZQUFJLGFBQWEsY0FBYztBQUM5QixpQkFBTztBQUFBLFFBQ1I7QUFBQSxNQUdEO0FBR0EsVUFBSSxLQUFLLFNBQVMsRUFBRyxRQUFPO0FBQUEsSUFDN0I7QUFHQSxXQUFPO0FBQUEsRUFDUjtBQUNEOzs7QUM5RE8sU0FBUyxtQkFBbUIsY0FBc0IsVUFBbUM7QUFoQjVGO0FBaUJDLFVBQVEsY0FBYztBQUFBLElBQ3JCLEtBQUs7QUFDSixhQUFPO0FBQUEsUUFDTixFQUFFLE9BQU8sMEJBQTBCLE9BQU8sZ0JBQWdCO0FBQUEsUUFDMUQsRUFBRSxPQUFPLDRCQUE0QixPQUFPLGtCQUFrQjtBQUFBLFFBQzlELEVBQUUsT0FBTyw0QkFBNEIsT0FBTyxvQkFBb0I7QUFBQSxRQUNoRSxFQUFFLE9BQU8sNEJBQTRCLE9BQU8sb0JBQW9CO0FBQUEsUUFDaEUsRUFBRSxPQUFPLDhCQUE4QixPQUFPLDZCQUE2QjtBQUFBLFFBQzNFLEVBQUUsT0FBTywyQkFBMkIsT0FBTyxtQkFBbUI7QUFBQSxNQUMvRDtBQUFBLElBQ0QsS0FBSztBQUNKLGFBQU87QUFBQSxRQUNOLEVBQUUsT0FBTyxzQkFBc0IsT0FBTyxVQUFVO0FBQUEsUUFDaEQsRUFBRSxPQUFPLDJCQUEyQixPQUFPLGVBQWU7QUFBQSxRQUMxRCxFQUFFLE9BQU8sMkJBQTJCLE9BQU8sZUFBZTtBQUFBLFFBQzFELEVBQUUsT0FBTyxVQUFVLE9BQU8sU0FBUztBQUFBLFFBQ25DLEVBQUUsT0FBTyxlQUFlLE9BQU8sY0FBYztBQUFBLE1BQzlDO0FBQUEsSUFDRCxLQUFLO0FBQ0osYUFBTztBQUFBLFFBQ04sRUFBRSxPQUFPLGtDQUFrQyxPQUFPLG1CQUFtQjtBQUFBLFFBQ3JFLEVBQUUsT0FBTyxnQ0FBZ0MsT0FBTyxpQkFBaUI7QUFBQSxRQUNqRSxFQUFFLE9BQU8sb0JBQW9CLE9BQU8sbUJBQW1CO0FBQUEsUUFDdkQsRUFBRSxPQUFPLHlCQUF5QixPQUFPLHdCQUF3QjtBQUFBLE1BQ2xFO0FBQUEsSUFDRCxLQUFLO0FBRUosWUFBTSxlQUFjLGdEQUFVLGdCQUFWLG1CQUF1QixXQUF2QixtQkFBK0I7QUFDbkQsVUFBSSxlQUFlLFlBQVksS0FBSyxHQUFHO0FBQ3RDLGVBQU8sQ0FBQyxFQUFFLE9BQU8sYUFBYSxPQUFPLFlBQVksQ0FBQztBQUFBLE1BQ25EO0FBQ0EsYUFBTyxDQUFDO0FBQUEsSUFDVDtBQUNDLGFBQU8sQ0FBQztBQUFBLEVBQ1Y7QUFDRDs7O0FDcERBLElBQUFDLG1CQUFxRTs7O0FDS3JFLHNCQUEwRDtBQUVuRCxJQUFNLDJCQUFOLE1BQStCO0FBQUEsRUFNbEMsWUFBWSxLQUFVLFVBQStCLFdBQXlCO0FBRjlFO0FBQUEsU0FBUSxpQkFBeUI7QUFHN0IsU0FBSyxNQUFNO0FBQ1gsU0FBSyxXQUFXO0FBQ2hCLFNBQUssb0JBQW9CO0FBQUEsRUFDN0I7QUFBQSxFQUVBLGVBQWUsYUFBd0I7QUFDbkMsU0FBSyxjQUFjO0FBQUEsRUFDdkI7QUFBQSxFQUVRLHNCQUE0QjtBQUNoQyxTQUFLLFNBQVMsaUJBQWlCLFNBQVMsS0FBSyxZQUFZLEtBQUssSUFBSSxDQUFDO0FBQUEsRUFDdkU7QUFBQSxFQUVRLGNBQW9CO0FBQ3hCLFVBQU0sT0FBTyxLQUFLLFNBQVM7QUFDM0IsVUFBTSxZQUFZLEtBQUssU0FBUztBQUdoQyxVQUFNLGVBQWUsS0FBSyxVQUFVLEdBQUcsU0FBUztBQUNoRCxVQUFNLFlBQVksYUFBYSxNQUFNLGdCQUFnQjtBQUVyRCxRQUFJLGFBQWEsY0FBYyxLQUFLLGdCQUFnQjtBQUNoRCxXQUFLLGlCQUFpQjtBQUN0QixXQUFLLG9CQUFvQjtBQUFBLElBQzdCO0FBQUEsRUFDSjtBQUFBLEVBRVEsc0JBQTRCO0FBekN4QztBQTJDUSxVQUFNLGdCQUFjLFVBQUssZ0JBQUwsbUJBQWtCLGdCQUFlLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFFdEYsVUFBTSxRQUFRLElBQUk7QUFBQSxNQUNkLEtBQUs7QUFBQSxNQUNMLE9BQU8sU0FBZ0I7QUFDbkIsY0FBTSxLQUFLLFdBQVcsSUFBSTtBQUFBLE1BQzlCO0FBQUEsTUFDQSxNQUFNO0FBRUYsYUFBSyxpQkFBaUI7QUFBQSxNQUMxQjtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBQ0EsVUFBTSxLQUFLO0FBQUEsRUFDZjtBQUFBLEVBRUEsTUFBYyxXQUFXLE1BQTRCO0FBQ2pELFVBQU0sT0FBTyxLQUFLLFNBQVM7QUFDM0IsVUFBTSxZQUFZLEtBQUssU0FBUztBQUdoQyxVQUFNLGVBQWUsS0FBSyxVQUFVLEdBQUcsU0FBUztBQUNoRCxVQUFNLFlBQVksYUFBYSxNQUFNLGdCQUFnQjtBQUVyRCxRQUFJLFdBQVc7QUFDWCxZQUFNLFdBQVcsWUFBWSxVQUFVLENBQUMsRUFBRTtBQUcxQyxZQUFNLFVBQVUsS0FBSyxVQUFVLEdBQUcsUUFBUSxJQUFJLEtBQUssVUFBVSxTQUFTO0FBQ3RFLFdBQUssU0FBUyxRQUFRO0FBR3RCLFdBQUssU0FBUyxrQkFBa0IsVUFBVSxRQUFRO0FBR2xELFdBQUssU0FBUyxjQUFjLElBQUksTUFBTSxTQUFTLEVBQUUsU0FBUyxLQUFLLENBQUMsQ0FBQztBQUFBLElBQ3JFO0FBR0EsUUFBSSxLQUFLLGVBQWUsS0FBSyxZQUFZLG1CQUFtQjtBQUN4RCxZQUFNLEtBQUssWUFBWSxrQkFBa0IsQ0FBQyxLQUFLLFFBQVEsQ0FBQztBQUFBLElBQzVEO0FBR0EsU0FBSyxpQkFBaUI7QUFDdEIsU0FBSyxTQUFTLE1BQU07QUFBQSxFQUN4QjtBQUFBLEVBRUEsVUFBZ0I7QUFBQSxFQUVoQjtBQUNKO0FBS0EsSUFBTSxvQkFBTixjQUFnQyxrQ0FBeUI7QUFBQSxFQU1yRCxZQUNJLEtBQ0EsVUFDQSxVQUNBLGFBQ0Y7QUFDRSxVQUFNLEdBQUc7QUFSYixTQUFRLFdBQW9CLENBQUM7QUFTekIsU0FBSyxtQkFBbUI7QUFDeEIsU0FBSyxtQkFBbUI7QUFDeEIsU0FBSyxjQUFjLGVBQWU7QUFFbEMsU0FBSyxlQUFlLG1DQUFtQztBQUN2RCxTQUFLLFVBQVU7QUFBQSxFQUNuQjtBQUFBLEVBRUEsU0FBZTtBQUNYLFVBQU0sT0FBTztBQUNiLFNBQUssZ0JBQWdCO0FBQUEsRUFDekI7QUFBQSxFQUVRLGtCQUF3QjtBQUU1QixVQUFNLGlCQUFpQixLQUFLLFFBQVEsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFFNUUsVUFBTSxpQkFBaUIsZUFBZSxVQUFVLEVBQUUsS0FBSyxxQkFBcUIsQ0FBQztBQUM3RSxtQkFBZSxXQUFXLEVBQUUsS0FBSyw4QkFBOEIsTUFBTSxlQUFLLENBQUM7QUFDM0UsbUJBQWUsV0FBVyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRWpELFVBQU0saUJBQWlCLGVBQWUsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDN0UsbUJBQWUsV0FBVyxFQUFFLEtBQUssOEJBQThCLE1BQU0sU0FBSSxDQUFDO0FBQzFFLG1CQUFlLFdBQVcsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUU1QyxVQUFNLGlCQUFpQixlQUFlLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQzdFLG1CQUFlLFdBQVcsRUFBRSxLQUFLLDhCQUE4QixNQUFNLE1BQU0sQ0FBQztBQUM1RSxtQkFBZSxXQUFXLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFBQSxFQUNwRDtBQUFBLEVBRVEsWUFBa0I7QUFDdEIsU0FBSyxXQUFXLEtBQUssSUFBSSxNQUFNLGlCQUFpQjtBQUdoRCxRQUFJLEtBQUssYUFBYTtBQUNsQixXQUFLLFdBQVcsS0FBSyxTQUFTLE9BQU8sVUFBUSxLQUFLLFNBQVMsS0FBSyxZQUFhLElBQUk7QUFBQSxJQUNyRjtBQUdBLFNBQUssU0FBUyxLQUFLLENBQUMsR0FBRyxNQUFNLEVBQUUsS0FBSyxRQUFRLEVBQUUsS0FBSyxLQUFLO0FBQUEsRUFDNUQ7QUFBQSxFQUVBLFdBQW9CO0FBQ2hCLFdBQU8sS0FBSztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxZQUFZLE1BQXFCO0FBQzdCLFdBQU8sS0FBSztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxhQUFhLE1BQW1CO0FBQzVCLFNBQUssaUJBQWlCLElBQUk7QUFBQSxFQUM5QjtBQUFBLEVBRUEsaUJBQWlCLE9BQTBCLElBQXVCO0FBQzlELFVBQU0sT0FBTyxNQUFNO0FBR25CLFVBQU0sWUFBWSxHQUFHLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBRzVELFVBQU0sUUFBUSxVQUFVLFVBQVUsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQzdELFVBQU0sY0FBYyxLQUFLO0FBR3pCLFVBQU0sTUFBTSxVQUFVLFVBQVUsRUFBRSxLQUFLLGlCQUFpQixDQUFDO0FBQ3pELFFBQUksY0FBYyxLQUFLO0FBQUEsRUFDM0I7QUFBQSxFQUVBLFVBQWdCO0FBQ1osVUFBTSxRQUFRO0FBQ2QsUUFBSSxLQUFLLGtCQUFrQjtBQUN2QixXQUFLLGlCQUFpQjtBQUFBLElBQzFCO0FBQUEsRUFDSjtBQUNKOzs7QURsTE8sSUFBTSxnQkFBTixNQUFNLGNBQWE7QUFBQSxFQWtCekIsWUFDQyxRQUNBLFdBQ0EsZ0JBQ0M7QUFYRixTQUFRLGtCQUFzQztBQUM5QyxTQUFRLGFBQXNCO0FBSTlCO0FBQUE7QUFBQSxTQUFRLGlCQUF1RixDQUFDO0FBTy9GLFNBQUssU0FBUztBQUNkLFNBQUssWUFBWTtBQUNqQixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxlQUFlLGFBQXdCO0FBQ3RDLFNBQUssY0FBYztBQUVuQixRQUFJLEtBQUssc0JBQXNCO0FBQzlCLFdBQUsscUJBQXFCLGVBQWUsV0FBVztBQUFBLElBQ3JEO0FBQUEsRUFDRDtBQUFBLEVBRUEsaUJBQWlCLGVBQW9DO0FBQ3BELFNBQUssZ0JBQWdCO0FBR3JCLFVBQU0sZUFBZSxLQUFLLFdBQVc7QUFDckMsaUJBQWEsT0FBTztBQUdwQixTQUFLLGNBQWMsb0JBQW9CLEtBQUssUUFBUTtBQUdwRCxTQUFLLFNBQVMsWUFBWSxZQUFZO0FBR3RDLFNBQUssY0FBYywrQkFBK0IsS0FBSyxRQUFRO0FBQUEsRUFDaEU7QUFBQSxFQUVBLGNBQWlDO0FBQ2hDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLHFCQUFxQixlQUFrQztBQUN0RCxTQUFLLFlBQVksS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ3pFLFNBQUssVUFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTy9CLFNBQUssV0FBVyxLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUssaUJBQWlCLENBQUM7QUFDbEUsU0FBSyxTQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFROUIsVUFBTSxvQkFBb0IsS0FBSyxTQUFTLFVBQVU7QUFDbEQsc0JBQWtCLE1BQU0sVUFBVTtBQUdsQyxTQUFLLFdBQVcsSUFBSSxtQ0FBa0IsaUJBQWlCO0FBQ3ZELFNBQUssU0FBUyxlQUFlLGlCQUFpQjtBQUM5QyxTQUFLLFNBQVMsUUFBUSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWdCdEMsU0FBSyxtQkFBbUIsTUFBTTtBQUM3QixZQUFNLFdBQVcsS0FBSyxTQUFTO0FBQy9CLGVBQVMsTUFBTSxTQUFTO0FBQ3hCLGVBQVMsTUFBTSxTQUFTLEtBQUssSUFBSSxTQUFTLGNBQWMsR0FBRyxJQUFJO0FBQUEsSUFDaEU7QUFHQSxTQUFLLGlCQUFpQixLQUFLLFNBQVMsU0FBUyxTQUFTLEtBQUssZ0JBQWdCO0FBRzNFLGVBQVcsS0FBSyxrQkFBa0IsQ0FBQztBQUduQyxTQUFLLHVCQUF1QixJQUFJLHlCQUF5QixLQUFLLE9BQU8sS0FBSyxLQUFLLFNBQVMsU0FBUyxLQUFLLFFBQVE7QUFHOUcsUUFBSSxLQUFLLGFBQWE7QUFDckIsV0FBSyxxQkFBcUIsZUFBZSxLQUFLLFdBQVc7QUFBQSxJQUMxRDtBQUdBLFNBQUssaUJBQWlCLEtBQUssU0FBUyxTQUFTLFNBQVMsTUFBTTtBQUMzRCxXQUFLLGVBQWUseUJBQXlCLEtBQUssU0FBUyxTQUFTLENBQUM7QUFBQSxJQUN0RSxDQUFDO0FBS0QsU0FBSyxhQUFhLElBQUksaUNBQWdCLEtBQUssUUFBUTtBQUNuRCxTQUFLLFdBQVcsUUFBUSxNQUFNO0FBQzlCLFNBQUssV0FBVyxXQUFXLGNBQWM7QUFDekMsU0FBSyxXQUFXLFFBQVEsTUFBTSxLQUFLLFdBQVcsQ0FBQztBQUMvQyxTQUFLLFdBQVcsU0FBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFlekMsU0FBSyxpQkFBaUIsS0FBSyxTQUFTLFNBQVMsV0FBVyxDQUFDLFVBQWlCO0FBeko1RTtBQTBKRyxZQUFNLFdBQVc7QUFFakIsVUFBSSxTQUFTLFFBQVEsV0FBVyxDQUFDLFNBQVMsVUFBVTtBQUNuRCxjQUFNLGVBQWU7QUFDckIsVUFBQyxVQUFLLGtCQUFMLG1CQUFvQixtQ0FBa0MsU0FBVSxLQUFLLFdBQVc7QUFBQSxNQUNsRixXQUFXLFNBQVMsUUFBUSxVQUFVO0FBQ3JDLG1CQUFLLGtCQUFMLG1CQUFvQjtBQUFBLE1BQ3JCLFdBQVcsU0FBUyxRQUFRLGFBQWEsU0FBUyxRQUFRLGFBQWE7QUFDdEUsYUFBSSxVQUFLLGtCQUFMLG1CQUFvQiw4QkFBOEIsU0FBUyxNQUFNO0FBQ3BFLGdCQUFNLGVBQWU7QUFBQSxRQUN0QjtBQUFBLE1BQ0QsV0FBVyxTQUFTLFFBQVEsT0FBTztBQUNsQyxhQUFJLFVBQUssa0JBQUwsbUJBQW9CLDhCQUE4QixTQUFTLE1BQU07QUFDcEUsZ0JBQU0sZUFBZTtBQUFBLFFBQ3RCO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUdELFNBQUssaUJBQWlCLEtBQUssU0FBUyxTQUFTLFNBQVMsTUFBTTtBQUMzRCxVQUFJLEtBQUssZUFBZTtBQUN2QixhQUFLLGNBQWMsa0JBQWtCO0FBQUEsTUFDdEM7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxRQUFjO0FBQ2IsZUFBVyxNQUFNO0FBeExuQjtBQXlMRyxXQUFJLFVBQUssYUFBTCxtQkFBZSxTQUFTO0FBQzNCLGFBQUssU0FBUyxRQUFRLE1BQU07QUFBQSxNQUM3QjtBQUFBLElBQ0QsR0FBRyxjQUFhLGNBQWM7QUFBQSxFQUMvQjtBQUFBLEVBRVEsYUFBbUI7QUEvTDVCO0FBZ01FLFVBQU0sVUFBVSxLQUFLLFNBQVMsU0FBUyxFQUFFLEtBQUs7QUFDOUMsUUFBSSxDQUFDLFFBQVM7QUFHZCxTQUFLLFNBQVMsU0FBUyxFQUFFO0FBQ3pCLFNBQUssaUJBQWlCO0FBQ3RCLFNBQUssZUFBZSxtQkFBbUI7QUFJdkMsZUFBSyxrQkFBTCw4QkFBcUI7QUFBQSxFQUN0QjtBQUFBLEVBSUEsaUJBQWlCLFVBQTJDO0FBQzNELFNBQUssZ0JBQWdCO0FBQUEsRUFDdEI7QUFBQSxFQUVBLFdBQW1CO0FBQ2xCLFdBQU8sS0FBSyxTQUFTLFNBQVM7QUFBQSxFQUMvQjtBQUFBLEVBRUEsU0FBUyxPQUFxQjtBQUM3QixTQUFLLFNBQVMsU0FBUyxLQUFLO0FBQzVCLFNBQUssaUJBQWlCO0FBQUEsRUFDdkI7QUFBQSxFQUVBLFdBQVcsTUFBb0I7QUFDOUIsVUFBTSxlQUFlLEtBQUssU0FBUyxTQUFTO0FBQzVDLFVBQU0sV0FBVyxLQUFLLFNBQVM7QUFDL0IsVUFBTSxRQUFRLFNBQVM7QUFDdkIsVUFBTSxNQUFNLFNBQVM7QUFFckIsVUFBTSxXQUFXLGFBQWEsTUFBTSxHQUFHLEtBQUssSUFBSSxPQUFPLGFBQWEsTUFBTSxHQUFHO0FBQzdFLFNBQUssU0FBUyxTQUFTLFFBQVE7QUFHL0IsVUFBTSxjQUFjLFFBQVEsS0FBSztBQUNqQyxlQUFXLE1BQU07QUFDaEIsZUFBUyxrQkFBa0IsYUFBYSxXQUFXO0FBQ25ELGVBQVMsTUFBTTtBQUFBLElBQ2hCLEdBQUcsQ0FBQztBQUVKLFNBQUssaUJBQWlCO0FBQUEsRUFDdkI7QUFBQSxFQUVBLHFCQUFxQixjQUFzQixjQUFzQixJQUFVO0FBQzFFLFVBQU0sZUFBZSxLQUFLLFNBQVMsU0FBUztBQUM1QyxVQUFNLFdBQVcsS0FBSyxTQUFTO0FBQy9CLFVBQU0sUUFBUSxTQUFTO0FBQ3ZCLFVBQU0sTUFBTSxTQUFTO0FBRXJCLFVBQU0sV0FBVyxhQUFhLE1BQU0sR0FBRyxLQUFLLElBQUksZUFBZSxjQUFjLGFBQWEsTUFBTSxHQUFHO0FBQ25HLFNBQUssU0FBUyxTQUFTLFFBQVE7QUFHL0IsVUFBTSxpQkFBaUIsUUFBUSxhQUFhO0FBQzVDLGVBQVcsTUFBTTtBQUNoQixlQUFTLGtCQUFrQixnQkFBZ0IsY0FBYztBQUN6RCxlQUFTLE1BQU07QUFBQSxJQUNoQixHQUFHLENBQUM7QUFFSixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFUSxpQkFBaUIsU0FBc0IsT0FBZSxTQUE4QjtBQUMzRixZQUFRLGlCQUFpQixPQUFPLE9BQU87QUFDdkMsU0FBSyxlQUFlLEtBQUssRUFBRSxTQUFTLE9BQU8sUUFBUSxDQUFDO0FBQUEsRUFDckQ7QUFBQSxFQUVRLG1CQUF5QjtBQUNoQyxVQUFNLFdBQVcsS0FBSyxTQUFTO0FBRy9CLFNBQUssaUJBQWlCLFVBQVUsYUFBYSxDQUFDLE1BQWE7QUFDMUQsUUFBRSxlQUFlO0FBQ2pCLFdBQUssZ0JBQWdCO0FBQUEsSUFDdEIsQ0FBQztBQUVELFNBQUssaUJBQWlCLFVBQVUsWUFBWSxDQUFDLE1BQWE7QUFDekQsUUFBRSxlQUFlO0FBRWpCLE1BQUMsRUFBZ0IsYUFBYyxhQUFhO0FBQUEsSUFDN0MsQ0FBQztBQUVELFNBQUssaUJBQWlCLFVBQVUsYUFBYSxDQUFDLE1BQWE7QUFFMUQsVUFBSSxFQUFFLFdBQVcsVUFBVTtBQUMxQixhQUFLLGdCQUFnQjtBQUFBLE1BQ3RCO0FBQUEsSUFDRCxDQUFDO0FBRUQsU0FBSyxpQkFBaUIsVUFBVSxRQUFRLENBQUMsTUFBYTtBQUNyRCxRQUFFLGVBQWU7QUFDakIsV0FBSyxXQUFXLENBQWM7QUFBQSxJQUMvQixDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsa0JBQXdCO0FBQy9CLFFBQUksS0FBSyxXQUFZO0FBQ3JCLFNBQUssYUFBYTtBQUdsQixRQUFJLENBQUMsS0FBSyxpQkFBaUI7QUFDMUIsV0FBSyxrQkFBa0IsU0FBUyxjQUFjLEtBQUs7QUFDbkQsV0FBSyxnQkFBZ0IsWUFBWTtBQUNqQyxXQUFLLGdCQUFnQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQW1CckMsWUFBTSxnQkFBZ0IsU0FBUyxjQUFjLEtBQUs7QUFDbEQsb0JBQWMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZTlCLFlBQU0sT0FBTyxTQUFTLGNBQWMsS0FBSztBQUN6QyxXQUFLLFlBQVk7QUFDakIsV0FBSyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3JCLG9CQUFjLFlBQVksSUFBSTtBQUM5QixXQUFLLGdCQUFnQixZQUFZLGFBQWE7QUFBQSxJQUMvQztBQUdBLFVBQU0sb0JBQW9CLEtBQUssU0FBUyxRQUFRO0FBQ2hELHNCQUFrQixNQUFNLFdBQVc7QUFDbkMsc0JBQWtCLFlBQVksS0FBSyxlQUFlO0FBR2xELGVBQVcsTUFBTTtBQUNoQixVQUFJLEtBQUssaUJBQWlCO0FBQ3pCLGFBQUssZ0JBQWdCLE1BQU0sVUFBVTtBQUNyQyxjQUFNLE9BQU8sS0FBSyxnQkFBZ0IsY0FBYyxLQUFLO0FBQ3JELFlBQUksTUFBTTtBQUNULGVBQUssTUFBTSxVQUFVO0FBQ3JCLGVBQUssTUFBTSxZQUFZO0FBQUEsUUFDeEI7QUFBQSxNQUNEO0FBQUEsSUFDRCxHQUFHLEVBQUU7QUFBQSxFQUNOO0FBQUEsRUFFUSxrQkFBd0I7QUFDL0IsU0FBSyxhQUFhO0FBQ2xCLFFBQUksS0FBSyxpQkFBaUI7QUFDekIsV0FBSyxnQkFBZ0IsTUFBTSxVQUFVO0FBQ3JDLFlBQU0sT0FBTyxLQUFLLGdCQUFnQixjQUFjLEtBQUs7QUFDckQsVUFBSSxNQUFNO0FBQ1QsYUFBSyxNQUFNLFVBQVU7QUFDckIsYUFBSyxNQUFNLFlBQVk7QUFBQSxNQUN4QjtBQUNBLGlCQUFXLE1BQU07QUF0WHBCO0FBdVhJLG1CQUFLLG9CQUFMLG1CQUFzQjtBQUN0QixhQUFLLGtCQUFrQjtBQUFBLE1BQ3hCLEdBQUcsR0FBRztBQUFBLElBQ1A7QUFBQSxFQUNEO0FBQUEsRUFFUSxXQUFXLEdBQW9CO0FBN1h4QztBQThYRSxTQUFLLGdCQUFnQjtBQUVyQixVQUFNLFFBQWtCLENBQUM7QUFHekIsVUFBTSxpQkFBZ0IsT0FBRSxpQkFBRixtQkFBZ0IsUUFBUTtBQUU5QyxRQUFJLGlCQUFpQixjQUFjLFNBQVMsa0JBQWtCLEdBQUc7QUFFaEUsWUFBTSxPQUFPLGNBQWMsTUFBTSxRQUFRLEVBQUUsT0FBTyxVQUFRLEtBQUssS0FBSyxFQUFFLFdBQVcsa0JBQWtCLENBQUM7QUFFcEcsaUJBQVcsYUFBYSxNQUFNO0FBQzdCLFlBQUk7QUFDSCxnQkFBTSxNQUFNLElBQUksSUFBSSxVQUFVLEtBQUssQ0FBQztBQUNwQyxnQkFBTSxXQUFXLElBQUksYUFBYSxJQUFJLE1BQU07QUFFNUMsY0FBSSxVQUFVO0FBRWIsa0JBQU0sY0FBYyxtQkFBbUIsUUFBUTtBQUcvQyxrQkFBTSxZQUFZLFlBQVksTUFBTSxPQUFPO0FBQzNDLGtCQUFNLFdBQVcsVUFBVSxVQUFVLFNBQVMsQ0FBQztBQUcvQyxnQkFBSSxTQUFTLFNBQVMsS0FBSyxHQUFHO0FBQzdCLG9CQUFNLFdBQVcsU0FBUyxRQUFRLE9BQU8sRUFBRTtBQUMzQyxrQkFBSSxZQUFZLENBQUMsTUFBTSxTQUFTLFFBQVEsR0FBRztBQUMxQyxzQkFBTSxLQUFLLFFBQVE7QUFBQSxjQUNwQjtBQUFBLFlBQ0QsT0FBTztBQUdOLGtCQUFJLFlBQVksQ0FBQyxNQUFNLFNBQVMsUUFBUSxHQUFHO0FBQzFDLHNCQUFNLEtBQUssUUFBUTtBQUFBLGNBQ3BCO0FBQUEsWUFDRDtBQUFBLFVBQ0Q7QUFBQSxRQUNELFNBQVMsT0FBTztBQUNmLGtCQUFRLEtBQUssaUNBQWlDLFdBQVcsS0FBSztBQUFBLFFBQy9EO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFHQSxRQUFJLE1BQU0sU0FBUyxHQUFHO0FBQ3JCLFdBQUssa0JBQWtCLEtBQUs7QUFBQSxJQUM3QixXQUFXLGlCQUFpQixjQUFjLFNBQVMsa0JBQWtCLEdBQUc7QUFHdkUsVUFBSSx3QkFBTywrQ0FBK0MsR0FBSTtBQUFBLElBQy9ELFdBQVcsaUJBQWlCLGNBQWMsS0FBSyxLQUFLLENBQUMsY0FBYyxTQUFTLEtBQUssR0FBRztBQUVuRixVQUFJLHdCQUFPLHVFQUF1RSxHQUFJO0FBQUEsSUFDdkY7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFjLGtCQUFrQixXQUFvQztBQUNuRSxRQUFJLFVBQVUsV0FBVyxFQUFHO0FBRzVCLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsbUJBQW1CLEdBQUc7QUFDdEUsVUFBSSx3QkFBTyx5SEFBeUgsR0FBSTtBQUN4STtBQUFBLElBQ0Q7QUFHQSxRQUFJLEtBQUssYUFBYTtBQUNyQixZQUFNLEtBQUssWUFBWSxrQkFBa0IsU0FBUztBQUFBLElBQ25EO0FBQUEsRUFDRDtBQUFBLEVBR0EsdUJBQTZCO0FBQzVCLFFBQUksS0FBSyxlQUFlO0FBQ3ZCLFdBQUssY0FBYyw4QkFBOEI7QUFBQSxJQUNsRDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLG1CQUFtQixZQUEyQjtBQUM3QyxRQUFJLEtBQUssV0FBVztBQUNuQixVQUFJLFlBQVk7QUFDZixhQUFLLFVBQVUsVUFBVSxJQUFJLGFBQWE7QUFBQSxNQUMzQyxPQUFPO0FBQ04sYUFBSyxVQUFVLFVBQVUsT0FBTyxhQUFhO0FBQUEsTUFDOUM7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBZ0I7QUFFZixRQUFJLEtBQUssc0JBQXNCO0FBQzlCLFdBQUsscUJBQXFCLFFBQVE7QUFBQSxJQUNuQztBQUdBLFFBQUksS0FBSyxpQkFBaUI7QUFDekIsV0FBSyxnQkFBZ0IsT0FBTztBQUM1QixXQUFLLGtCQUFrQjtBQUFBLElBQ3hCO0FBR0EsU0FBSyxlQUFlLFFBQVEsQ0FBQyxFQUFFLFNBQVMsT0FBTyxRQUFRLE1BQU07QUFDNUQsY0FBUSxvQkFBb0IsT0FBTyxPQUFPO0FBQUEsSUFDM0MsQ0FBQztBQUNELFNBQUssaUJBQWlCLENBQUM7QUFBQSxFQUN4QjtBQUNEO0FBaGVhLGNBVVksaUJBQWlCO0FBVm5DLElBQU0sZUFBTjs7O0FFVFAsSUFBQUMsbUJBQTZEO0FBaUJ0RCxJQUFNLGdCQUFOLE1BQW9CO0FBQUEsRUFXMUIsWUFBWSxRQUFvQixXQUF3QixVQUE2QjtBQUxyRixTQUFRLHFCQUFvQyxDQUFDO0FBQzdDLFNBQVEsdUJBQStCO0FBRXZDLFNBQVEsdUJBQWdDO0FBR3ZDLFNBQUssU0FBUztBQUNkLFNBQUssWUFBWTtBQUNqQixTQUFLLFdBQVc7QUFBQSxFQUNqQjtBQUFBLEVBRUEsb0JBQW9CLFVBQXdDO0FBQzNELFNBQUssZ0JBQWdCLElBQUksaUNBQWdCLFFBQVE7QUFDakQsU0FBSyxjQUFjLFFBQVEsS0FBSztBQUNoQyxTQUFLLGNBQWMsV0FBVyxVQUFVO0FBQ3hDLFNBQUssY0FBYyxRQUFRLE1BQU0sS0FBSyxrQkFBa0IsQ0FBQztBQUN6RCxTQUFLLGNBQWMsU0FBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxjQUloQyxLQUFLLHdCQUF3QixJQUFJLFNBQVMsTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU81RCxXQUFPLEtBQUs7QUFBQSxFQUNiO0FBQUEsRUFFQSxzQkFBNEI7QUFDM0IsU0FBSywrQkFBK0IsS0FBSyxTQUFTO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLCtCQUErQixXQUE4QjtBQUM1RCxTQUFLLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ3ZFLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFlcEM7QUFBQSxFQUVBLDBCQUFtQztBQUNsQyxXQUFPLDBCQUFTLFlBQVksS0FBSyxPQUFPLFNBQVMscUJBQXFCLEtBQUssT0FBTyxlQUFlLGlCQUFpQixVQUFVO0FBQUEsRUFDN0g7QUFBQSxFQUVBLGdDQUFzQztBQUNyQyxRQUFJLEtBQUssZUFBZTtBQUN2QixZQUFNLGFBQWEsS0FBSyx3QkFBd0I7QUFDaEQsV0FBSyxjQUFjLFNBQVMsTUFBTSxVQUFVLGFBQWEsU0FBUztBQUFBLElBQ25FO0FBQUEsRUFDRDtBQUFBLEVBRUEsb0JBQTBCO0FBQ3pCLFFBQUksQ0FBQyxLQUFLLGFBQWE7QUFDdEIsV0FBSyxrQkFBa0I7QUFBQSxJQUN4QjtBQUVBLFFBQUksS0FBSyxzQkFBc0I7QUFDOUIsV0FBSyxnQkFBZ0I7QUFBQSxJQUN0QixPQUFPO0FBQ04sV0FBSyxnQkFBZ0I7QUFBQSxJQUN0QjtBQUFBLEVBQ0Q7QUFBQSxFQUVRLG9CQUEwQjtBQUNqQyxTQUFLLGNBQWMsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLG9CQUFvQixDQUFDO0FBQ3hFLFNBQUssWUFBWSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBaUJqQyxVQUFNLFdBQVc7QUFBQSxNQUNoQixFQUFFLE1BQU0sbUJBQW1CLGFBQWEsNEJBQTRCLFNBQVMsa0JBQWtCO0FBQUEsTUFDL0YsRUFBRSxNQUFNLGVBQWUsYUFBYSxnQ0FBZ0MsU0FBUyxjQUFjO0FBQUEsTUFDM0YsRUFBRSxNQUFNLGFBQWEsYUFBYSw0QkFBNEIsU0FBUyxZQUFZO0FBQUEsTUFDbkYsRUFBRSxNQUFNLGdCQUFnQixhQUFhLDRCQUE0QixTQUFTLFNBQVM7QUFBQSxNQUNuRixFQUFFLE1BQU0sV0FBVyxhQUFhLDRCQUE0QixTQUFTLGVBQWU7QUFBQSxNQUNwRixFQUFFLE1BQU0sb0JBQW9CLGFBQWEsMkJBQTJCLFNBQVMsbUJBQW1CO0FBQUEsSUFDakc7QUFFQSxVQUFNLFFBQVEsS0FBSyxZQUFZLFNBQVMsT0FBTyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekUsVUFBTSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3RCLGFBQVMsUUFBUSxTQUFPO0FBQ3ZCLFlBQU0sUUFBUSxLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDckUsWUFBTSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFRdEIsWUFBTSxTQUFTLE1BQU0sU0FBUyxPQUFPLEVBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQztBQUN2RCxhQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXZCLFlBQU0sU0FBUyxNQUFNLFNBQVMsT0FBTyxFQUFFLE1BQU0sSUFBSSxZQUFZLENBQUM7QUFDOUQsYUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFLdkIsWUFBTSxpQkFBaUIsU0FBUyxNQUFNO0FBQ3JDLGFBQUssU0FBUyxTQUFTLElBQUksVUFBVSxHQUFHO0FBQ3hDLGFBQUssU0FBUyxRQUFRLE1BQU07QUFDNUIsYUFBSyxnQkFBZ0I7QUFBQSxNQUN0QixDQUFDO0FBRUQsWUFBTSxpQkFBaUIsY0FBYyxNQUFNO0FBQzFDLGNBQU0sTUFBTSxhQUFhO0FBQUEsTUFDMUIsQ0FBQztBQUVELFlBQU0saUJBQWlCLGNBQWMsTUFBTTtBQUMxQyxjQUFNLE1BQU0sYUFBYTtBQUFBLE1BQzFCLENBQUM7QUFBQSxJQUNGLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFUSxrQkFBd0I7QUFDL0IsUUFBSSxLQUFLLGFBQWE7QUFDckIsV0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxXQUFLLHVCQUF1QjtBQUFBLElBQzdCO0FBQUEsRUFDRDtBQUFBLEVBRUEsa0JBQXdCO0FBQ3ZCLFFBQUksS0FBSyxhQUFhO0FBQ3JCLFdBQUssWUFBWSxNQUFNLFVBQVU7QUFDakMsV0FBSyx1QkFBdUI7QUFBQSxJQUM3QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLG9CQUEwQjtBQUN6QixRQUFJLENBQUMsS0FBSyxVQUFVO0FBQ25CO0FBQUEsSUFDRDtBQUVBLFVBQU0sUUFBUSxLQUFLLFNBQVMsU0FBUztBQUdyQyxRQUFJLE1BQU0sV0FBVyxHQUFHLEdBQUc7QUFFMUIsV0FBSyw0QkFBNEIsS0FBSztBQUFBLElBQ3ZDLE9BQU87QUFFTixXQUFLLGtCQUFrQjtBQUFBLElBQ3hCO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTVEsNEJBQTRCLE9BQXFCO0FBQ3hELFFBQUksQ0FBQyxLQUFLLGVBQWU7QUFDeEI7QUFBQSxJQUNEO0FBRUEsVUFBTSxxQkFBcUIsS0FBSyxzQkFBc0I7QUFDdEQsVUFBTSxhQUFhLE1BQU0sTUFBTSxDQUFDLEVBQUUsWUFBWTtBQUU5QyxVQUFNLFdBQVcsbUJBQW1CO0FBQUEsTUFBTyxTQUMxQyxJQUFJLEtBQUssWUFBWSxFQUFFLFNBQVMsVUFBVSxLQUMxQyxJQUFJLFFBQVEsWUFBWSxFQUFFLFNBQVMsVUFBVSxLQUM3QyxJQUFJLFNBQVMsS0FBSyxhQUFXLFFBQVEsWUFBWSxFQUFFLFNBQVMsVUFBVSxDQUFDO0FBQUEsSUFDeEU7QUFFQSxTQUFLLHFCQUFxQixDQUFDO0FBQzNCLFNBQUssY0FBYyxNQUFNO0FBQ3pCLFNBQUssdUJBQXVCO0FBRTVCLFFBQUksU0FBUyxTQUFTLEdBQUc7QUFDeEIsZUFBUyxRQUFRLENBQUMsS0FBSyxVQUFVO0FBQ2hDLGNBQU0sT0FBTyxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssMkJBQTJCLENBQUM7QUFDN0UsYUFBSyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3JCLGNBQU0sU0FBUyxLQUFLLFNBQVMsT0FBTyxFQUFFLE1BQU0sSUFBSSxLQUFLLENBQUM7QUFDdEQsZUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU12QixjQUFNLFNBQVMsS0FBSyxTQUFTLE9BQU8sRUFBRSxNQUFNLElBQUksWUFBWSxDQUFDO0FBQzdELGVBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNdkIsY0FBTSxZQUFZLEtBQUssU0FBUyxPQUFPLEVBQUUsTUFBTSxZQUFZLElBQUksT0FBTyxHQUFHLENBQUM7QUFDMUUsa0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNMUIsYUFBSyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3BDLGVBQUssd0JBQXdCLElBQUksUUFBUTtBQUFBLFFBQzFDLENBQUM7QUFFRCxhQUFLLGlCQUFpQixjQUFjLE1BQU07QUFDekMsZUFBSyx1QkFBdUI7QUFDNUIsZUFBSyw2QkFBNkI7QUFBQSxRQUNuQyxDQUFDO0FBRUQsYUFBSyxtQkFBbUIsS0FBSyxJQUFJO0FBQUEsTUFDbEMsQ0FBQztBQUVELFdBQUssY0FBYyxNQUFNLFVBQVU7QUFBQSxJQUNwQyxPQUFPO0FBQ04sV0FBSyxrQkFBa0I7QUFBQSxJQUN4QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLG9CQUEwQjtBQUN6QixTQUFLLGNBQWMsTUFBTSxVQUFVO0FBQ25DLFNBQUsscUJBQXFCLENBQUM7QUFDM0IsU0FBSyx1QkFBdUI7QUFBQSxFQUM3QjtBQUFBLEVBRUEsOEJBQThCLEtBQXNCO0FBQ25ELFFBQUksS0FBSyxtQkFBbUIsV0FBVyxFQUFHLFFBQU87QUFFakQsUUFBSSxRQUFRLGFBQWE7QUFDeEIsV0FBSyx1QkFBdUIsS0FBSyxJQUFJLEtBQUssdUJBQXVCLEdBQUcsS0FBSyxtQkFBbUIsU0FBUyxDQUFDO0FBQ3RHLFdBQUssNkJBQTZCO0FBQ2xDLGFBQU87QUFBQSxJQUNSLFdBQVcsUUFBUSxXQUFXO0FBQzdCLFdBQUssdUJBQXVCLEtBQUssSUFBSSxLQUFLLHVCQUF1QixHQUFHLEVBQUU7QUFDdEUsV0FBSyw2QkFBNkI7QUFDbEMsYUFBTztBQUFBLElBQ1IsV0FBVyxRQUFRLFNBQVMsS0FBSyx3QkFBd0IsR0FBRztBQUUzRCxhQUFPLEtBQUssNkJBQTZCO0FBQUEsSUFDMUM7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEsK0JBQXdDO0FBQ3ZDLFFBQUksS0FBSyx3QkFBd0IsS0FBSyxLQUFLLG1CQUFtQixTQUFTLEdBQUc7QUFFekUsWUFBTSxXQUFXLEtBQUssc0JBQXNCO0FBQzVDLFlBQU0sUUFBUSxLQUFLLFNBQVMsU0FBUztBQUNyQyxVQUFJLE1BQU0sV0FBVyxHQUFHLEdBQUc7QUFDMUIsY0FBTSxhQUFhLE1BQU0sTUFBTSxDQUFDLEVBQUUsWUFBWTtBQUM5QyxjQUFNLFdBQVcsU0FBUztBQUFBLFVBQU8sU0FDaEMsSUFBSSxLQUFLLFlBQVksRUFBRSxTQUFTLFVBQVUsS0FDMUMsSUFBSSxRQUFRLFlBQVksRUFBRSxTQUFTLFVBQVUsS0FDN0MsSUFBSSxTQUFTLEtBQUssYUFBVyxRQUFRLFlBQVksRUFBRSxTQUFTLFVBQVUsQ0FBQztBQUFBLFFBQ3hFO0FBRUEsWUFBSSxLQUFLLHVCQUF1QixTQUFTLFFBQVE7QUFDaEQsZ0JBQU0sY0FBYyxTQUFTLEtBQUssb0JBQW9CO0FBQ3RELGVBQUssd0JBQXdCLFlBQVksUUFBUTtBQUNqRCxpQkFBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUNBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFUSwrQkFBcUM7QUFDNUMsU0FBSyxtQkFBbUIsUUFBUSxDQUFDLE1BQU0sVUFBVTtBQUNoRCxVQUFJLFVBQVUsS0FBSyxzQkFBc0I7QUFDeEMsYUFBSyxNQUFNLGFBQWE7QUFBQSxNQUN6QixPQUFPO0FBQ04sYUFBSyxNQUFNLGFBQWE7QUFBQSxNQUN6QjtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLGNBQWMsU0FBdUI7QUFDNUMsU0FBSyxTQUFTLFNBQVMsVUFBVSxHQUFHO0FBQ3BDLFNBQUssU0FBUyxRQUFRLE1BQU07QUFHNUIsVUFBTSxTQUFTLEtBQUssU0FBUyxTQUFTLEVBQUU7QUFDeEMsU0FBSyxTQUFTLFFBQVEsa0JBQWtCLFFBQVEsTUFBTTtBQUV0RCxTQUFLLGtCQUFrQjtBQUFBLEVBQ3hCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNUSx3QkFBNkM7QUFDcEQsV0FBTztBQUFBLE1BQ047QUFBQSxRQUNDLE1BQU07QUFBQSxRQUNOLGFBQWE7QUFBQSxRQUNiLFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxRQUNWLFNBQVM7QUFBQSxRQUNULFVBQVUsQ0FBQyxVQUFVLE9BQU8sVUFBVSxPQUFPO0FBQUEsTUFDOUM7QUFBQSxNQUNBO0FBQUEsUUFDQyxNQUFNO0FBQUEsUUFDTixhQUFhO0FBQUEsUUFDYixTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixTQUFTO0FBQUEsUUFDVCxVQUFVLENBQUMsVUFBVSxVQUFVLFVBQVUsUUFBUTtBQUFBLE1BQ2xEO0FBQUEsTUFDQTtBQUFBLFFBQ0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsU0FBUztBQUFBLFFBQ1QsVUFBVTtBQUFBLFFBQ1YsU0FBUztBQUFBLFFBQ1QsVUFBVSxDQUFDLFVBQVUsYUFBYSxPQUFPO0FBQUEsTUFDMUM7QUFBQSxNQUNBO0FBQUEsUUFDQyxNQUFNO0FBQUEsUUFDTixhQUFhO0FBQUEsUUFDYixTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixTQUFTO0FBQUEsUUFDVCxVQUFVLENBQUMsWUFBWSxlQUFlLFFBQVE7QUFBQSxNQUMvQztBQUFBLE1BQ0E7QUFBQSxRQUNDLE1BQU07QUFBQSxRQUNOLGFBQWE7QUFBQSxRQUNiLFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxRQUNWLFNBQVM7QUFBQSxRQUNULFVBQVUsQ0FBQyxXQUFXLGFBQWEsVUFBVTtBQUFBLE1BQzlDO0FBQUEsTUFDQTtBQUFBLFFBQ0MsTUFBTTtBQUFBLFFBQ04sYUFBYTtBQUFBLFFBQ2IsU0FBUztBQUFBLFFBQ1QsVUFBVTtBQUFBLFFBQ1YsU0FBUztBQUFBLFFBQ1QsVUFBVSxDQUFDLFVBQVUsVUFBVSxTQUFTO0FBQUEsTUFDekM7QUFBQSxNQUNBO0FBQUEsUUFDQyxNQUFNO0FBQUEsUUFDTixhQUFhO0FBQUEsUUFDYixTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixTQUFTO0FBQUEsUUFDVCxVQUFVLENBQUMsZUFBZSxjQUFjLE1BQU07QUFBQSxNQUMvQztBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx3QkFBd0IsVUFBd0I7QUFDdkQsU0FBSyxrQkFBa0I7QUFHdkIsVUFBTSxZQUFZLFNBQVMsUUFBUSxVQUFVO0FBQzdDLFFBQUksY0FBYyxJQUFJO0FBQ3JCLFlBQU0sZUFBZSxTQUFTLE1BQU0sR0FBRyxTQUFTO0FBQ2hELFlBQU0sY0FBYyxTQUFTLE1BQU0sWUFBWSxDQUFDO0FBQ2hELFdBQUssU0FBUyxTQUFTLGVBQWUsV0FBVztBQUdqRCxpQkFBVyxNQUFNO0FBQ2hCLGFBQUssU0FBUyxRQUFRLGtCQUFrQixXQUFXLFNBQVM7QUFDNUQsYUFBSyxTQUFTLFFBQVEsTUFBTTtBQUFBLE1BQzdCLEdBQUcsQ0FBQztBQUFBLElBQ0wsT0FBTztBQUNOLFdBQUssU0FBUyxTQUFTLFFBQVE7QUFDL0IsV0FBSyxTQUFTLFFBQVEsTUFBTTtBQUFBLElBQzdCO0FBQUEsRUFDRDtBQUFBLEVBRUEsVUFBZ0I7QUFDZixRQUFJLEtBQUssYUFBYTtBQUNyQixXQUFLLFlBQVksT0FBTztBQUFBLElBQ3pCO0FBQ0EsUUFBSSxLQUFLLGVBQWU7QUFDdkIsV0FBSyxjQUFjLE9BQU87QUFBQSxJQUMzQjtBQUFBLEVBQ0Q7QUFDRDs7O0FDMWJBLElBQUFDLG1CQUE2RDs7O0FDVTdELElBQU0sd0JBQStEO0FBQUEsRUFDakUsUUFBUTtBQUFBO0FBQUEsSUFFSiw0QkFBNEIsRUFBRSxRQUFRLElBQU87QUFBQSxJQUM3Qyw4QkFBOEIsRUFBRSxRQUFRLElBQU87QUFBQSxJQUMvQyw4QkFBOEIsRUFBRSxRQUFRLElBQU87QUFBQSxJQUMvQyw2QkFBNkIsRUFBRSxRQUFRLElBQU87QUFBQSxJQUM5QywwQkFBMEIsRUFBRSxRQUFRLElBQU87QUFBQSxJQUMzQyw0QkFBNEIsRUFBRSxRQUFRLElBQU87QUFBQSxJQUM3QywyQkFBMkIsRUFBRSxRQUFRLElBQU87QUFBQTtBQUFBLElBRTVDLFdBQVcsRUFBRSxRQUFRLEtBQVEsVUFBVSxLQUFLO0FBQUEsRUFDaEQ7QUFBQSxFQUVBLFFBQVE7QUFBQTtBQUFBLElBRUosMkJBQTJCLEVBQUUsUUFBUSxJQUFRO0FBQUEsSUFDN0MsNEJBQTRCLEVBQUUsUUFBUSxJQUFRO0FBQUE7QUFBQSxJQUc5QyxVQUFVLEVBQUUsUUFBUSxNQUFPO0FBQUEsSUFDM0IscUJBQXFCLEVBQUUsUUFBUSxNQUFPO0FBQUEsSUFDdEMscUJBQXFCLEVBQUUsUUFBUSxNQUFPO0FBQUEsSUFDdEMsZUFBZSxFQUFFLFFBQVEsTUFBTztBQUFBLElBQ2hDLDBCQUEwQixFQUFFLFFBQVEsTUFBTztBQUFBO0FBQUEsSUFHM0MsZUFBZSxFQUFFLFFBQVEsTUFBTztBQUFBLElBQ2hDLDBCQUEwQixFQUFFLFFBQVEsTUFBTztBQUFBLElBQzNDLHVCQUF1QixFQUFFLFFBQVEsTUFBTztBQUFBLElBQ3hDLHNCQUFzQixFQUFFLFFBQVEsTUFBTztBQUFBLElBQ3ZDLHNCQUFzQixFQUFFLFFBQVEsTUFBTztBQUFBO0FBQUEsSUFHdkMsU0FBUyxFQUFFLFFBQVEsSUFBSztBQUFBLElBQ3hCLGNBQWMsRUFBRSxRQUFRLElBQUs7QUFBQSxJQUM3QixjQUFjLEVBQUUsUUFBUSxJQUFLO0FBQUE7QUFBQSxJQUc3QixpQkFBaUIsRUFBRSxRQUFRLEtBQU07QUFBQSxJQUNqQyxzQkFBc0IsRUFBRSxRQUFRLEtBQU07QUFBQSxJQUN0QyxzQkFBc0IsRUFBRSxRQUFRLEtBQU07QUFBQSxJQUN0QyxxQkFBcUIsRUFBRSxRQUFRLEtBQU07QUFBQTtBQUFBLElBR3JDLFdBQVcsRUFBRSxRQUFRLE9BQVEsVUFBVSxLQUFLO0FBQUEsRUFDaEQ7QUFBQSxFQUVBLFFBQVE7QUFBQTtBQUFBLElBRUosa0NBQWtDLEVBQUUsUUFBUSxJQUFRO0FBQUEsSUFDcEQsd0JBQXdCLEVBQUUsUUFBUSxJQUFRO0FBQUE7QUFBQSxJQUcxQyx3QkFBd0IsRUFBRSxRQUFRLElBQVE7QUFBQSxJQUMxQyx1Q0FBdUMsRUFBRSxRQUFRLElBQVE7QUFBQTtBQUFBLElBR3pELGtCQUFrQixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQ3BDLHlCQUF5QixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQzNDLHNCQUFzQixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQ3hDLHNCQUFzQixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQ3hDLG9CQUFvQixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQ3RDLDJCQUEyQixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQzdDLHdCQUF3QixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQzFDLHdCQUF3QixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQzFDLHVCQUF1QixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQ3pDLDhCQUE4QixFQUFFLFFBQVEsSUFBUTtBQUFBLElBQ2hELDJCQUEyQixFQUFFLFFBQVEsSUFBUTtBQUFBO0FBQUEsSUFHN0MsY0FBYyxFQUFFLFFBQVEsSUFBTTtBQUFBLElBQzlCLHFCQUFxQixFQUFFLFFBQVEsSUFBTTtBQUFBLElBQ3JDLGtCQUFrQixFQUFFLFFBQVEsSUFBTTtBQUFBLElBQ2xDLHlCQUF5QixFQUFFLFFBQVEsSUFBTTtBQUFBLElBQ3pDLHNCQUFzQixFQUFFLFFBQVEsSUFBTTtBQUFBO0FBQUEsSUFHdEMsV0FBVyxFQUFFLFFBQVEsS0FBUyxVQUFVLEtBQUs7QUFBQSxFQUNqRDtBQUNKO0FBUU8sU0FBUyxnQkFBZ0IsVUFBa0IsT0FBdUI7QUFDckUsUUFBTSxpQkFBaUIsc0JBQXNCLFNBQVMsWUFBWSxDQUFDO0FBQ25FLE1BQUksQ0FBQyxnQkFBZ0I7QUFFakIsV0FBTztBQUFBLEVBQ1g7QUFHQSxRQUFNLGFBQWEsZUFBZSxLQUFLO0FBQ3ZDLE1BQUksWUFBWTtBQUNaLFdBQU8sV0FBVztBQUFBLEVBQ3RCO0FBR0EsUUFBTSxlQUFlLGVBQWUsU0FBUztBQUM3QyxNQUFJLGNBQWM7QUFDZCxXQUFPLGFBQWE7QUFBQSxFQUN4QjtBQUdBLFNBQU87QUFDWDs7O0FDckdPLFNBQVMsZUFBZSxNQUFzQjtBQUNqRCxNQUFJLENBQUMsS0FBTSxRQUFPO0FBQ2xCLFNBQU8sS0FBSyxLQUFLLEtBQUssU0FBUyxDQUFDO0FBQ3BDO0FBS08sU0FBUyxzQkFDWixVQUNBLE9BQ0Esc0JBQWdELENBQUMsR0FDakQsa0JBQTRDLENBQUMsR0FDN0MsZUFBdUIsSUFDdkIsaUJBQXlCLElBQ3pCLHVCQUErQixNQUNuQjtBQUVaLE1BQUk7QUFDSixNQUFJLFNBQVMsWUFBWSxNQUFNLFVBQVU7QUFDckMsbUJBQWU7QUFBQSxFQUNuQixPQUFPO0FBQ0gsbUJBQWUsZ0JBQWdCLFVBQVUsS0FBSztBQUFBLEVBQ2xEO0FBR0EsUUFBTSxxQkFBcUIsb0JBQW9CLE9BQU8sQ0FBQyxPQUFPLFFBQVE7QUFDbEUsV0FBTyxRQUFRLGVBQWUsSUFBSSxPQUFPO0FBQUEsRUFDN0MsR0FBRyxDQUFDO0FBRUosUUFBTSxhQUFhLGdCQUFnQixPQUFPLENBQUMsT0FBTyxTQUFTO0FBQ3ZELFdBQU8sUUFBUSxlQUFlLEtBQUssT0FBTztBQUFBLEVBQzlDLEdBQUcsQ0FBQztBQUVKLFFBQU0sY0FBYyxlQUFlLFlBQVk7QUFDL0MsUUFBTSxpQkFBaUIsZUFBZSxjQUFjO0FBR3BELFFBQU0sY0FBYyxxQkFBcUIsYUFBYSxjQUFjO0FBQ3BFLFFBQU0sa0JBQWtCLEtBQUssTUFBTyxjQUFjLGVBQWdCLEdBQUc7QUFFckUsU0FBTztBQUFBLElBQ0g7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0EsV0FBVztBQUFBLE1BQ1AscUJBQXFCO0FBQUEsTUFDckIsaUJBQWlCO0FBQUEsTUFDakIsY0FBYztBQUFBLE1BQ2QsZ0JBQWdCO0FBQUEsSUFDcEI7QUFBQSxFQUNKO0FBQ0o7QUFLTyxTQUFTLDhCQUE4QixPQUE2QjtBQUN2RSxTQUFPLEtBQUssSUFBSSxHQUFHLE1BQU0sTUFBTSxlQUFlO0FBQ2xEO0FBS08sU0FBUyx1QkFBdUIsT0FBc0Q7QUFDekYsUUFBTSxzQkFBc0IsOEJBQThCLEtBQUs7QUFFL0QsTUFBSSx1QkFBdUIsR0FBRztBQUMxQixXQUFPO0FBQUEsRUFDWCxXQUFXLHVCQUF1QixJQUFJO0FBQ2xDLFdBQU87QUFBQSxFQUNYLE9BQU87QUFDSCxXQUFPO0FBQUEsRUFDWDtBQUNKO0FBS08sU0FBUyxtQkFBbUIsT0FBNkI7QUFDNUQsUUFBTSxzQkFBc0IsOEJBQThCLEtBQUs7QUFDL0QsUUFBTSxlQUFlLHVCQUF1QixLQUFLO0FBRWpELE1BQUksaUJBQWlCLFlBQVk7QUFDN0IsV0FBTyxHQUFHLG1CQUFtQjtBQUFBLEVBQ2pDLE9BQU87QUFDSCxXQUFPLEdBQUcsbUJBQW1CO0FBQUEsRUFDakM7QUFDSjtBQUtPLFNBQVMsa0JBQWtCLE9BQTZCO0FBQzNELFFBQU0sRUFBRSxhQUFhLGNBQWMsVUFBVSxJQUFJO0FBQ2pELFFBQU0sa0JBQWtCLGVBQWU7QUFFdkMsUUFBTSxRQUFRO0FBQUEsSUFDVixrQkFBa0IsWUFBWSxlQUFlLENBQUMsTUFBTSxhQUFhLGVBQWUsQ0FBQztBQUFBLElBQ2pGLGNBQWMsZ0JBQWdCLGVBQWUsQ0FBQztBQUFBLElBQzlDO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFFQSxNQUFJLFVBQVUsc0JBQXNCLEdBQUc7QUFDbkMsVUFBTSxLQUFLLHdCQUFtQixVQUFVLG9CQUFvQixlQUFlLENBQUMsU0FBUztBQUFBLEVBQ3pGO0FBRUEsTUFBSSxVQUFVLGtCQUFrQixHQUFHO0FBQy9CLFVBQU0sS0FBSyx3QkFBbUIsVUFBVSxnQkFBZ0IsZUFBZSxDQUFDLFNBQVM7QUFBQSxFQUNyRjtBQUVBLE1BQUksVUFBVSxlQUFlLEdBQUc7QUFDNUIsVUFBTSxLQUFLLHlCQUFvQixVQUFVLGFBQWEsZUFBZSxDQUFDLFNBQVM7QUFBQSxFQUNuRjtBQUVBLE1BQUksVUFBVSxpQkFBaUIsR0FBRztBQUM5QixVQUFNLEtBQUssMkJBQXNCLFVBQVUsZUFBZSxlQUFlLENBQUMsU0FBUztBQUFBLEVBQ3ZGO0FBRUEsU0FBTyxNQUFNLEtBQUssSUFBSTtBQUMxQjs7O0FGcEdPLElBQU0sa0JBQU4sTUFBTSxnQkFBZTtBQUFBLEVBYTNCLFlBQVksUUFBb0IsS0FBVSxXQUF3QjtBQVRsRSxTQUFRLG9CQUFzRCxvQkFBSSxJQUFJO0FBR3RFLFNBQVEsaUJBQXlDO0FBQ2pELFNBQVEsa0JBQWlDO0FBQ3pDO0FBQUEsU0FBUSxxQkFBb0M7QUFLM0MsU0FBSyxTQUFTO0FBQ2QsU0FBSyxNQUFNO0FBQ1gsU0FBSyxZQUFZO0FBQUEsRUFDbEI7QUFBQSxFQUVBLGVBQWUsYUFBd0I7QUFDdEMsU0FBSyxjQUFjO0FBQUEsRUFDcEI7QUFBQSxFQUVBLHlCQUErQjtBQUM5QixTQUFLLG1CQUFtQixLQUFLLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLENBQUM7QUFDbEYsU0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBZXZDO0FBQUEsRUFFQSx1QkFBb0M7QUFDbkMsVUFBTSxtQkFBbUIsS0FBSyxVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ2pGLHFCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVWpDLFVBQU0sZUFBZSxpQkFBaUIsV0FBVyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ3RFLGlCQUFhLE1BQU0sVUFBVTtBQUU3QixVQUFNLGNBQWMsaUJBQWlCLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBQ3BGLGdCQUFZLE1BQU0sVUFBVTtBQUU1QixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEseUJBQXlCLFNBQXVCO0FBQy9DLFFBQUksQ0FBQyxLQUFLLGtCQUFrQixDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUM5RjtBQUFBLElBQ0Q7QUFHQSxRQUFJLENBQUMsS0FBSyxpQkFBaUI7QUFDMUIsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUNwQztBQUFBLElBQ0Q7QUFFQSxRQUFJLENBQUMsU0FBUztBQUNiLFdBQUssZUFBZSxNQUFNLFVBQVU7QUFDcEM7QUFBQSxJQUNEO0FBR0EsVUFBTSxhQUFhO0FBQ25CLFVBQU0sWUFBc0QsQ0FBQztBQUM3RCxRQUFJO0FBRUosWUFBUSxRQUFRLFdBQVcsS0FBSyxPQUFPLE9BQU8sTUFBTTtBQUNuRCxZQUFNLFVBQVUsTUFBTSxDQUFDO0FBQ3ZCLFlBQU0sV0FBVyxNQUFNLENBQUM7QUFDeEIsZ0JBQVUsS0FBSyxFQUFFLE1BQU0sU0FBUyxTQUFTLENBQUM7QUFBQSxJQUMzQztBQUVBLFFBQUksVUFBVSxXQUFXLEdBQUc7QUFDM0IsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUNwQztBQUFBLElBQ0Q7QUFHQSxVQUFNLGNBQWMsS0FBSyxlQUFlLGNBQWMsNEJBQTRCO0FBQ2xGLFFBQUksYUFBYTtBQUNoQixZQUFNLFdBQVcsVUFBVTtBQUFBLFFBQUksU0FDOUIsSUFBSSxXQUFXLEdBQUcsSUFBSSxJQUFJLElBQUksSUFBSSxRQUFRLEtBQUssSUFBSTtBQUFBLE1BQ3BELEVBQUUsS0FBSyxJQUFJO0FBQ1gsa0JBQVksY0FBYztBQUFBLElBQzNCO0FBRUEsU0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLEVBQ3JDO0FBQUEsRUFFQSxNQUFNLGFBQWEsU0FBaUIsYUFBNEQ7QUFDL0YsUUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsS0FBSyxDQUFDLGFBQWE7QUFDdEYsYUFBTztBQUFBLElBQ1I7QUFHQSxRQUFJLENBQUMsS0FBSyxpQkFBaUI7QUFDMUIsYUFBTztBQUFBLElBQ1I7QUFHQSxVQUFNLGNBQWMsS0FBSyxJQUFJLEVBQUUsU0FBUyxJQUFJLEtBQUssT0FBTyxFQUFFLFNBQVMsRUFBRSxFQUFFLE9BQU8sR0FBRyxDQUFDO0FBQ2xGLFNBQUsscUJBQXFCO0FBRzFCLFVBQU0saUJBQWlCLFlBQVk7QUFHbkMsUUFBSSxLQUFLLG9CQUFvQixnQkFBZ0I7QUFDNUMsYUFBTztBQUFBLElBQ1I7QUFFQSxRQUFJO0FBRUgsWUFBTSxFQUFFLGdCQUFnQixXQUFXLElBQUksS0FBSyxhQUFhLFNBQVMsWUFBWSxJQUFJO0FBR2xGLFlBQU0scUJBQXFCLEtBQUssa0JBQWtCLElBQUksWUFBWSxJQUFJLEtBQUssQ0FBQztBQUc1RSxVQUFJLFdBQVcsU0FBUyxHQUFHO0FBQzFCLGNBQU0sb0JBQW9CLENBQUMsR0FBRyxrQkFBa0I7QUFHaEQsbUJBQVcsT0FBTyxZQUFZO0FBQzdCLGdCQUFNLFNBQVMsa0JBQWtCLEtBQUssY0FBWSxTQUFTLEtBQUssU0FBUyxJQUFJLEtBQUssSUFBSTtBQUN0RixjQUFJLENBQUMsUUFBUTtBQUNaLDhCQUFrQixLQUFLLEdBQUc7QUFBQSxVQUMzQjtBQUFBLFFBQ0Q7QUFFQSxhQUFLLGtCQUFrQixJQUFJLFlBQVksTUFBTSxpQkFBaUI7QUFBQSxNQUMvRDtBQUdBLFlBQU0sb0JBQW9CLEtBQUssa0JBQWtCLElBQUksWUFBWSxJQUFJLEtBQUssQ0FBQztBQUczRSxZQUFNLG9CQUFvQixrQkFBa0IsT0FBTyxZQUFVO0FBQzVELFlBQUksRUFBQyxpQ0FBUSxTQUFRLENBQUMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLE9BQU8sS0FBSyxJQUFJLEdBQUc7QUFDN0UsaUJBQU87QUFBQSxRQUNSO0FBQ0EsZUFBTztBQUFBLE1BQ1IsQ0FBQztBQUdELFVBQUksa0JBQWtCLFdBQVcsa0JBQWtCLFFBQVE7QUFDMUQsWUFBSSxrQkFBa0IsU0FBUyxHQUFHO0FBQ2pDLGVBQUssa0JBQWtCLElBQUksWUFBWSxNQUFNLGlCQUFpQjtBQUFBLFFBQy9ELE9BQU87QUFDTixlQUFLLGtCQUFrQixPQUFPLFlBQVksSUFBSTtBQUFBLFFBQy9DO0FBQUEsTUFDRDtBQUdBLFlBQU0sZUFBeUIsQ0FBQztBQUdoQyxZQUFNLHFCQUFxQixNQUFNLEtBQUssdUJBQXVCLGFBQWEsTUFBTSxHQUFHO0FBQ25GLFVBQUksb0JBQW9CO0FBQ3ZCLHFCQUFhLEtBQUssa0JBQWtCO0FBQUEsTUFDckM7QUFHQSxpQkFBVyxVQUFVLG1CQUFtQjtBQUN2QyxjQUFNLGNBQWMsTUFBTSxLQUFLLG1CQUFtQixNQUFNO0FBQ3hELFlBQUksYUFBYTtBQUNoQix1QkFBYSxLQUFLLFdBQVc7QUFBQSxRQUM5QjtBQUFBLE1BQ0Q7QUFFQSxZQUFNLGdCQUFnQixhQUFhLEtBQUssYUFBYTtBQUNyRCxZQUFNLGFBQWEsS0FBSyxlQUFlLGFBQWE7QUFHcEQsWUFBTSxrQkFBa0IsYUFBYSxJQUFJLGNBQVksRUFBRSxRQUFRLEVBQUU7QUFDakUsWUFBTSxvQkFBb0IsTUFBTSxLQUFLLDJCQUEyQixlQUFlO0FBRS9FLFlBQU0sVUFBMkI7QUFBQSxRQUNoQyxnQkFBZ0I7QUFBQSxRQUNoQjtBQUFBLFFBQ0E7QUFBQSxRQUNBLGFBQWE7QUFBQTtBQUFBLFFBQ2I7QUFBQSxNQUNEO0FBR0EsVUFBSSxLQUFLLHVCQUF1QixlQUMvQixDQUFDLEtBQUssbUJBQ04sS0FBSyxvQkFBb0IsZ0JBQWdCO0FBQ3pDLGVBQU87QUFBQSxNQUNSO0FBRUEsV0FBSyxpQkFBaUI7QUFFdEIsVUFBSSxtQ0FBUyxlQUFlLFFBQVE7QUFDbkMsYUFBSyx1QkFBdUIsT0FBTztBQUFBLE1BQ3BDO0FBRUEsYUFBTztBQUFBLElBQ1IsU0FBUyxPQUFPO0FBRWYsYUFBTztBQUFBLElBQ1I7QUFBQSxFQUNEO0FBQUEsRUFFUSx1QkFBdUIsU0FBZ0M7QUFBQSxFQUkvRDtBQUFBLEVBR0EscUJBQTJCO0FBQzFCLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLElBQ3JDO0FBQUEsRUFDRDtBQUFBLEVBRUEsdUJBQTZCO0FBQzVCLFFBQUksS0FBSyxrQkFBa0I7QUFDMUIsV0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQUEsSUFDdkM7QUFBQSxFQUNEO0FBQUEsRUFFQSxzQkFBNEI7QUFDM0IsU0FBSyxpQkFBaUI7QUFDdEIsU0FBSyxrQkFBa0I7QUFDdkIsU0FBSyxxQkFBcUI7QUFDMUIsU0FBSyxxQkFBcUI7QUFDMUIsU0FBSyxtQkFBbUI7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxlQUFlLE1BQTBCO0FBQ3hDLFVBQU0sZUFBYyw2QkFBTSxTQUFRO0FBRWxDLFFBQUksS0FBSyxvQkFBb0IsYUFBYTtBQUV6QyxXQUFLLGlCQUFpQjtBQUN0QixXQUFLLHFCQUFxQjtBQUMxQixXQUFLLHFCQUFxQjtBQUMxQixXQUFLLG1CQUFtQjtBQUFBLElBQ3pCO0FBRUEsU0FBSyxrQkFBa0I7QUFBQSxFQUN4QjtBQUFBLEVBRUEsb0JBQTRDO0FBQzNDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLHFCQUFvQztBQUNuQyxXQUFPLEtBQUs7QUFBQSxFQUNiO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLDRCQUE0QixNQUFtQztBQUVwRSxRQUFJLFFBQVEsS0FBSyxPQUFPLHFCQUFxQjtBQUM1QyxZQUFNLEtBQUssK0JBQStCLElBQUk7QUFBQSxJQUMvQztBQUdBLFVBQU0sS0FBSywwQkFBMEI7QUFBQSxFQUN0QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQTJCO0FBM1U1QjtBQTRVRSxVQUFNLFVBQVUsS0FBSyxrQkFBa0I7QUFDdkMsY0FBUSx3Q0FBUyxtQkFBVCxtQkFBeUIsV0FBVSxLQUFLO0FBQUEsRUFDakQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sWUFBWSxNQUE0QjtBQUM3QyxRQUFJLENBQUMsS0FBSyxpQkFBaUI7QUFDMUI7QUFBQSxJQUNEO0FBR0EsUUFBSSxLQUFLLFNBQVMsS0FBSyxpQkFBaUI7QUFFdkM7QUFBQSxJQUNEO0FBR0EsVUFBTSxVQUFVLEtBQUssa0JBQWtCLElBQUksS0FBSyxlQUFlLEtBQUssQ0FBQztBQUdyRSxVQUFNLFNBQVMsUUFBUSxLQUFLLFNBQU8sSUFBSSxLQUFLLFNBQVMsS0FBSyxJQUFJO0FBQzlELFFBQUksUUFBUTtBQUNYO0FBQUEsSUFDRDtBQUdBLFVBQU0sU0FBNEI7QUFBQSxNQUNqQztBQUFBLE1BQ0EsVUFBVTtBQUFBLE1BQ1YsY0FBYztBQUFBLE1BQ2QsY0FBYyxLQUFLLEtBQUssUUFBUTtBQUFBLElBQ2pDO0FBQ0EsVUFBTSxVQUFVLENBQUMsR0FBRyxTQUFTLE1BQU07QUFHbkMsU0FBSyxrQkFBa0IsSUFBSSxLQUFLLGlCQUFpQixPQUFPO0FBR3hELFVBQU0sY0FBYyxLQUFLLElBQUksTUFBTSxzQkFBc0IsS0FBSyxlQUFlO0FBRTdFLFFBQUksZUFBZSxZQUFZLFFBQVEsS0FBSyxPQUFPLHFCQUFxQjtBQUN2RSxZQUFNLEtBQUssT0FBTyxvQkFBb0IsbUJBQW1CLGFBQXNCLEtBQUssSUFBSTtBQUFBLElBQ3pGO0FBR0EsVUFBTSxLQUFLLDBCQUEwQjtBQUFBLEVBQ3RDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGVBQWUsTUFBNEI7QUFDaEQsUUFBSSxDQUFDLEtBQUssZ0JBQWlCO0FBRzNCLFVBQU0sVUFBVSxLQUFLLGtCQUFrQixJQUFJLEtBQUssZUFBZSxLQUFLLENBQUM7QUFDckUsVUFBTSxXQUFXLFFBQVEsT0FBTyxTQUFPLElBQUksS0FBSyxTQUFTLEtBQUssSUFBSTtBQUVsRSxRQUFJLFNBQVMsU0FBUyxHQUFHO0FBQ3hCLFdBQUssa0JBQWtCLElBQUksS0FBSyxpQkFBaUIsUUFBUTtBQUFBLElBQzFELE9BQU87QUFDTixXQUFLLGtCQUFrQixPQUFPLEtBQUssZUFBZTtBQUFBLElBQ25EO0FBR0EsVUFBTSxjQUFjLEtBQUssSUFBSSxNQUFNLHNCQUFzQixLQUFLLGVBQWU7QUFDN0UsUUFBSSxlQUFlLFlBQVksUUFBUSxLQUFLLE9BQU8scUJBQXFCO0FBQ3ZFLFlBQU0sS0FBSyxPQUFPLG9CQUFvQixzQkFBc0IsYUFBc0IsS0FBSyxJQUFJO0FBQUEsSUFDNUY7QUFHQSxVQUFNLEtBQUssMEJBQTBCO0FBQUEsRUFDdEM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsa0JBQXdCO0FBQUEsRUFHeEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsNEJBQTJDO0FBQ3hELFFBQUksQ0FBQyxLQUFLLGlCQUFpQjtBQUMxQixXQUFLLGlCQUFpQjtBQUN0QixXQUFLLHFCQUFxQjtBQUMxQjtBQUFBLElBQ0Q7QUFFQSxRQUFJO0FBRUgsWUFBTSxpQkFBaUIsS0FBSyxrQkFBa0IsSUFBSSxLQUFLLGVBQWUsS0FBSyxDQUFDO0FBRTVFLFVBQUksZUFBZSxXQUFXLEdBQUc7QUFDaEMsYUFBSyxpQkFBaUI7QUFDdEIsYUFBSyxxQkFBcUI7QUFDMUI7QUFBQSxNQUNEO0FBR0EsVUFBSSxjQUFjO0FBR2xCLFVBQUk7QUFDSCxjQUFNLGNBQWMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLEtBQUssZUFBZTtBQUM3RSxZQUFJLHVCQUF1Qix3QkFBTztBQUNqQyxnQkFBTSxpQkFBaUIsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLFdBQVc7QUFDNUQseUJBQWUsS0FBSyxLQUFLLGVBQWUsU0FBUyxDQUFDO0FBQUEsUUFDbkQ7QUFBQSxNQUNELFNBQVMsT0FBTztBQUFBLE1BRWhCO0FBR0EsaUJBQVcsT0FBTyxnQkFBZ0I7QUFDakMsWUFBSTtBQUNILGdCQUFNLFVBQVUsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLElBQUksSUFBSTtBQUNsRCx5QkFBZSxLQUFLLEtBQUssUUFBUSxTQUFTLENBQUM7QUFBQSxRQUM1QyxTQUFTLE9BQU87QUFBQSxRQUVoQjtBQUFBLE1BQ0Q7QUFJQSxZQUFNLGtCQUFrQixlQUFlLFNBQVMsSUFDL0MsQ0FBQyxFQUFFLFNBQVMsa0JBQWtCLGVBQWUsSUFBSSxPQUFLLEVBQUUsS0FBSyxRQUFRLEVBQUUsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQ3JGLENBQUM7QUFDRixZQUFNLG9CQUFvQixNQUFNLEtBQUssMkJBQTJCLGVBQWU7QUFHL0UsV0FBSyxpQkFBaUI7QUFBQSxRQUNyQjtBQUFBLFFBQ0EsZUFBZTtBQUFBO0FBQUEsUUFDZixZQUFZO0FBQUEsUUFDWixhQUFhO0FBQUE7QUFBQSxRQUNiO0FBQUEsTUFDRDtBQUFBLElBSUQsU0FBUyxPQUFPO0FBRWYsV0FBSyxpQkFBaUI7QUFDdEIsV0FBSyxxQkFBcUI7QUFBQSxJQUMzQjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsK0JBQStCLE1BQTRCO0FBQ3hFLFFBQUksQ0FBQyxLQUFLLE9BQU8scUJBQXFCO0FBQ3JDO0FBQUEsSUFDRDtBQUVBLFFBQUk7QUFFSCxZQUFNLG1CQUFtQixNQUFNLEtBQUssT0FBTyxvQkFBb0Isb0JBQW9CLElBQUk7QUFFdkYsVUFBSSxpQkFBaUIsV0FBVyxHQUFHO0FBRWxDLGFBQUssa0JBQWtCLE9BQU8sS0FBSyxJQUFJO0FBQ3ZDO0FBQUEsTUFDRDtBQUdBLFlBQU0sb0JBQXlDLENBQUM7QUFDaEQsWUFBTSxlQUF5QixDQUFDO0FBRWhDLGlCQUFXLGNBQWMsa0JBQWtCO0FBQzFDLFlBQUk7QUFFSCxjQUFJLENBQUMsY0FBYyxDQUFDLFdBQVcsUUFBUSxPQUFPLFdBQVcsU0FBUyxVQUFVO0FBQzNFLG9CQUFRLEtBQUssdUNBQXVDLFVBQVU7QUFDOUQ7QUFBQSxVQUNEO0FBR0EsZ0JBQU0sY0FBYyxLQUFLLElBQUksTUFBTSxzQkFBc0IsV0FBVyxJQUFJO0FBRXhFLGNBQUksZUFBZSxZQUFZLFFBQVEsdUJBQXVCLHdCQUFPO0FBRXBFLDhCQUFrQixLQUFLO0FBQUEsY0FDdEIsTUFBTTtBQUFBLGNBQ04sVUFBVSxXQUFXO0FBQUEsY0FDckIsY0FBYztBQUFBLGNBQ2QsY0FBYyxXQUFXLFdBQ3RCLEtBQUssWUFBWSxRQUFRLElBQUksV0FBVyxRQUFRLE9BQ2hELEtBQUssWUFBWSxRQUFRO0FBQUEsWUFDN0IsQ0FBQztBQUFBLFVBQ0YsT0FBTztBQUVOLHlCQUFhLEtBQUssV0FBVyxJQUFJO0FBQUEsVUFDbEM7QUFBQSxRQUNELFNBQVMsVUFBVTtBQUVsQixrQkFBUSxLQUFLLGdEQUFnRCxRQUFRO0FBQUEsUUFDdEU7QUFBQSxNQUNEO0FBR0EsVUFBSSxhQUFhLFNBQVMsR0FBRztBQUM1QixjQUFNLEtBQUssb0JBQW9CLE1BQU0sWUFBWTtBQUNqRCxhQUFLLHVCQUF1QixZQUFZO0FBQUEsTUFDekM7QUFHQSxVQUFJLGtCQUFrQixTQUFTLEdBQUc7QUFDakMsYUFBSyxrQkFBa0IsSUFBSSxLQUFLLE1BQU0saUJBQWlCO0FBQUEsTUFDeEQsT0FBTztBQUVOLGFBQUssa0JBQWtCLE9BQU8sS0FBSyxJQUFJO0FBQUEsTUFDeEM7QUFBQSxJQUVELFNBQVMsT0FBTztBQUVmLGNBQVEsS0FBSyxnREFBZ0QsS0FBSztBQUVsRSxXQUFLLGtCQUFrQixPQUFPLEtBQUssSUFBSTtBQUFBLElBQ3hDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxvQkFBb0IsTUFBYSxjQUF1QztBQUNyRixRQUFJLENBQUMsS0FBSyxPQUFPLG9CQUFxQjtBQUV0QyxRQUFJO0FBRUgsaUJBQVcsZUFBZSxjQUFjO0FBQ3ZDLGNBQU0sS0FBSyxPQUFPLG9CQUFvQixzQkFBc0IsTUFBTSxXQUFXO0FBQUEsTUFDOUU7QUFBQSxJQUNELFNBQVMsT0FBTztBQUVmLGNBQVEsS0FBSyxzREFBc0QsS0FBSztBQUFBLElBQ3pFO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQXVCLGNBQThCO0FBQzVELFFBQUksYUFBYSxXQUFXLEVBQUc7QUFFL0IsUUFBSTtBQUNILFVBQUk7QUFDSixVQUFJO0FBRUosVUFBSSxhQUFhLFdBQVcsR0FBRztBQUM5Qix3QkFBZ0Isa0RBQXdDLGFBQWEsQ0FBQyxDQUFDO0FBQ3ZFLHNCQUFjLHFDQUFxQyxhQUFhLENBQUMsQ0FBQztBQUFBLE1BQ25FLE9BQU87QUFFTixjQUFNLGVBQWUsYUFBYSxNQUFNLEdBQUcsQ0FBQztBQUM1QyxjQUFNLGlCQUFpQixhQUFhLFNBQVMsYUFBYTtBQUUxRCxZQUFJLGlCQUFpQixHQUFHO0FBQ3ZCLDBCQUFnQixnQkFBTSxhQUFhLE1BQU0sdUNBQXVDLGFBQWEsS0FBSyxJQUFJLENBQUMsUUFBUSxjQUFjO0FBQzdILHdCQUFjLEdBQUcsYUFBYSxNQUFNLHVDQUF1QyxhQUFhLEtBQUssSUFBSSxDQUFDLFFBQVEsY0FBYztBQUFBLFFBQ3pILE9BQU87QUFDTiwwQkFBZ0IsZ0JBQU0sYUFBYSxNQUFNLHVDQUF1QyxhQUFhLEtBQUssSUFBSSxDQUFDO0FBQ3ZHLHdCQUFjLEdBQUcsYUFBYSxNQUFNLHVDQUF1QyxhQUFhLEtBQUssSUFBSSxDQUFDO0FBQUEsUUFDbkc7QUFBQSxNQUNEO0FBR0EsVUFBSSx3QkFBTyxlQUFlLGdCQUFlLGtCQUFrQjtBQUczRCxVQUFJLEtBQUssZUFBZSxPQUFPLEtBQUssWUFBWSxzQkFBc0IsWUFBWTtBQUNqRixhQUFLLFlBQVksa0JBQWtCLFdBQVc7QUFBQSxNQUMvQztBQUFBLElBQ0QsU0FBUyxPQUFPO0FBRWYsY0FBUSxLQUFLLDhDQUE4QyxLQUFLO0FBQUEsSUFDakU7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHlCQUF5QixNQUk1QjtBQUNGLFFBQUksQ0FBQyxLQUFLLE9BQU8scUJBQXFCO0FBQ3JDLGFBQU8sRUFBRSxZQUFZLENBQUMsR0FBRyxjQUFjLENBQUMsR0FBRyxZQUFZLEVBQUU7QUFBQSxJQUMxRDtBQUVBLFFBQUk7QUFDSCxZQUFNLG1CQUFtQixNQUFNLEtBQUssT0FBTyxvQkFBb0Isb0JBQW9CLElBQUk7QUFDdkYsWUFBTSxhQUF1QixDQUFDO0FBQzlCLFlBQU0sZUFBeUIsQ0FBQztBQUVoQyxpQkFBVyxjQUFjLGtCQUFrQjtBQUMxQyxjQUFNLGNBQWMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFdBQVcsSUFBSTtBQUV4RSxZQUFJLGVBQWUsWUFBWSxNQUFNO0FBQ3BDLHFCQUFXLEtBQUssV0FBVyxJQUFJO0FBQUEsUUFDaEMsT0FBTztBQUNOLHVCQUFhLEtBQUssV0FBVyxJQUFJO0FBQUEsUUFDbEM7QUFBQSxNQUNEO0FBRUEsYUFBTztBQUFBLFFBQ047QUFBQSxRQUNBO0FBQUEsUUFDQSxZQUFZLGlCQUFpQjtBQUFBLE1BQzlCO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFFZixhQUFPLEVBQUUsWUFBWSxDQUFDLEdBQUcsY0FBYyxDQUFDLEdBQUcsWUFBWSxFQUFFO0FBQUEsSUFDMUQ7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLDBCQUEwQixzQkFBOEIsWUFBZ0Q7QUFFckgsVUFBTSxtQkFBbUIsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLG9CQUFvQjtBQUNsRixRQUFJLG9CQUFvQixpQkFBaUIsUUFBUSxLQUFLLE9BQU8scUJBQXFCO0FBRWpGLFlBQU0sY0FBYyxXQUFXLElBQUksVUFBUTtBQUFBLFFBQzFDLE1BQU0sSUFBSSxLQUFLO0FBQUEsUUFDZixVQUFVLElBQUk7QUFBQSxRQUNkLFNBQVMsS0FBSyxJQUFJO0FBQUEsTUFDbkIsRUFBRTtBQUdGLFlBQU0sS0FBSyxPQUFPLG9CQUFvQixvQkFBb0Isa0JBQTJCLFdBQVc7QUFBQSxJQUNqRztBQUFBLEVBQ0Q7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsU0FBSyxvQkFBb0I7QUFDekIsUUFBSSxLQUFLLGtCQUFrQjtBQUMxQixXQUFLLGlCQUFpQixPQUFPO0FBQUEsSUFDOUI7QUFDQSxRQUFJLEtBQUssZ0JBQWdCO0FBQ3hCLFdBQUssZUFBZSxPQUFPO0FBQUEsSUFDNUI7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxhQUFhLFNBQWlCLHNCQUc1QjtBQUNELFVBQU0sYUFBa0MsQ0FBQztBQUN6QyxRQUFJLGlCQUFpQjtBQUlyQixVQUFNLGFBQWE7QUFFbkIsUUFBSTtBQUNKLFlBQVEsUUFBUSxXQUFXLEtBQUssT0FBTyxPQUFPLE1BQU07QUFDbkQsWUFBTSxVQUFVLE1BQU0sQ0FBQztBQUN2QixZQUFNLFdBQVcsTUFBTSxDQUFDO0FBQ3hCLFlBQU0sZUFBZSxNQUFNLENBQUM7QUFHNUIsWUFBTSxPQUFPLEtBQUssU0FBUyxPQUFPO0FBRWxDLFVBQUksTUFBTTtBQUNULG1CQUFXLEtBQUs7QUFBQSxVQUNmO0FBQUEsVUFDQSxjQUFjO0FBQUE7QUFBQSxVQUNkO0FBQUEsVUFDQTtBQUFBLFFBQ0QsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNEO0FBR0EsZUFBVyxPQUFPLFlBQVk7QUFDN0IsdUJBQWlCLGVBQWUsUUFBUSxJQUFJLGNBQWMsR0FBRztBQUFBLElBQzlEO0FBR0EscUJBQWlCLGVBQWUsUUFBUSxXQUFXLEdBQUcsRUFBRSxLQUFLO0FBRzdELFVBQU0saUJBQWlCLFdBQVcsT0FBTyxTQUFPLElBQUksWUFBWTtBQUNoRSxRQUFJLGVBQWUsU0FBUyxHQUFHO0FBQzlCLFlBQU0sV0FBVyxLQUFLLGtCQUFrQixJQUFJLG9CQUFvQixLQUFLLENBQUM7QUFDdEUsWUFBTSxvQkFBb0IsQ0FBQyxHQUFHLFFBQVE7QUFHdEMsaUJBQVcsT0FBTyxnQkFBZ0I7QUFDakMsY0FBTSxTQUFTLGtCQUFrQixLQUFLLENBQUFDLGNBQVlBLFVBQVMsS0FBSyxTQUFTLElBQUksS0FBSyxJQUFJO0FBQ3RGLFlBQUksQ0FBQyxRQUFRO0FBQ1osNEJBQWtCLEtBQUssR0FBRztBQUFBLFFBQzNCO0FBQUEsTUFDRDtBQUVBLFdBQUssa0JBQWtCLElBQUksc0JBQXNCLGlCQUFpQjtBQUdsRSxXQUFLLDBCQUEwQixzQkFBc0IsaUJBQWlCO0FBQUEsSUFDdkU7QUFFQSxXQUFPLEVBQUUsZ0JBQWdCLFdBQVc7QUFBQSxFQUNyQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyx1QkFBdUIsTUFBYSxpQkFBMEIsTUFBTSxXQUFtQixJQUE0QjtBQUNoSSxRQUFJO0FBQ0gsVUFBSSxlQUF5QixDQUFDO0FBRzlCLG1CQUFhLEtBQUssZ0JBQWdCLEtBQUssUUFBUSxFQUFFO0FBR2pELFlBQU0sUUFBUSxLQUFLLElBQUksY0FBYyxhQUFhLElBQUk7QUFDdEQsV0FBSSwrQkFBTyxnQkFBZSxPQUFPLEtBQUssTUFBTSxXQUFXLEVBQUUsU0FBUyxHQUFHO0FBQ3BFLHFCQUFhLEtBQUssNEJBQTRCO0FBQzlDLG1CQUFXLENBQUMsS0FBSyxLQUFLLEtBQUssT0FBTyxRQUFRLE1BQU0sV0FBVyxHQUFHO0FBRTdELGdCQUFNLGlCQUFpQixPQUFPLFVBQVUsV0FBVyxLQUFLLFVBQVUsS0FBSyxJQUFJO0FBQzNFLHVCQUFhLEtBQUssS0FBSyxHQUFHLEtBQUssY0FBYyxFQUFFO0FBQUEsUUFDaEQ7QUFBQSxNQUNEO0FBR0EsVUFBSSxnQkFBZ0I7QUFDbkIsY0FBTSxVQUFVLE1BQU0sS0FBSyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQzlDLFlBQUksU0FBUztBQUNaLGdCQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFHaEMsY0FBSSxvQkFBb0I7QUFDeEIsY0FBSSxNQUFNLENBQUMsTUFBTSxPQUFPO0FBQ3ZCLHFCQUFTLElBQUksR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ3RDLGtCQUFJLE1BQU0sQ0FBQyxNQUFNLE9BQU87QUFDdkIsb0NBQW9CLElBQUk7QUFDeEI7QUFBQSxjQUNEO0FBQUEsWUFDRDtBQUFBLFVBQ0Q7QUFFQSxnQkFBTSxlQUFlLE1BQU0sTUFBTSxpQkFBaUI7QUFDbEQsZ0JBQU0sbUJBQW1CLGFBQWEsTUFBTSxHQUFHLFFBQVEsRUFBRSxLQUFLLElBQUk7QUFDbEUsZ0JBQU0sZUFBZSxhQUFhLFNBQVM7QUFFM0MsdUJBQWEsS0FBSyxnQkFBZ0I7QUFDbEMsdUJBQWEsS0FBSyxnQkFBZ0I7QUFDbEMsY0FBSSxjQUFjO0FBQ2pCLHlCQUFhLEtBQUssbUNBQW1DO0FBQUEsVUFDdEQ7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUVBLGFBQU8sYUFBYSxLQUFLLElBQUk7QUFBQSxJQUM5QixTQUFTLE9BQU87QUFFZixhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsbUJBQW1CLFFBQW1EO0FBQ25GLFFBQUk7QUFDSCxZQUFNLEVBQUUsTUFBTSxTQUFTLElBQUk7QUFHM0IsVUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLElBQUksTUFBTSxzQkFBc0IsS0FBSyxJQUFJLEdBQUc7QUFFOUQsZUFBTztBQUFBLE1BQ1I7QUFFQSxVQUFJLFVBQVU7QUFFYixjQUFNLFFBQVEsS0FBSyxJQUFJLGNBQWMsYUFBYSxJQUFJO0FBQ3RELGFBQUksK0JBQU8sZ0JBQWUsTUFBTSxZQUFZLFFBQVEsR0FBRztBQUN0RCxpQkFBTyxNQUFNLEtBQUssUUFBUSxNQUFNLFFBQVE7QUFBQSxFQUFLLE1BQU0sWUFBWSxRQUFRLENBQUM7QUFBQSxRQUN6RTtBQUNBLGVBQU87QUFBQSxNQUNSLE9BQU87QUFFTixlQUFPLEtBQUssdUJBQXVCLElBQUk7QUFBQSxNQUN4QztBQUFBLElBQ0QsU0FBUyxPQUFPO0FBRWYsYUFBTztBQUFBLElBQ1I7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxTQUFTLFlBQWtDO0FBRWxELFFBQUksT0FBTyxLQUFLLElBQUksTUFBTSxzQkFBc0IsVUFBVTtBQUUxRCxRQUFJLENBQUMsUUFBUSxFQUFFLGdCQUFnQix5QkFBUTtBQUV0QyxhQUFPLEtBQUssSUFBSSxNQUFNLHNCQUFzQixhQUFhLEtBQUs7QUFBQSxJQUMvRDtBQUVBLFFBQUksQ0FBQyxRQUFRLEVBQUUsZ0JBQWdCLHlCQUFRO0FBRXRDLFlBQU0sUUFBUSxLQUFLLElBQUksTUFBTSxpQkFBaUI7QUFDOUMsYUFBTyxNQUFNO0FBQUEsUUFBSyxPQUNqQixFQUFFLGFBQWEsY0FDZixFQUFFLFNBQVMsY0FDWCxFQUFFLEtBQUssU0FBUyxNQUFNLFVBQVUsS0FDaEMsRUFBRSxLQUFLLFNBQVMsTUFBTSxhQUFhLEtBQUs7QUFBQSxNQUN6QyxLQUFLO0FBQUEsSUFDTjtBQUVBLFdBQU8sZ0JBQWdCLHlCQUFRLE9BQU87QUFBQSxFQUN2QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZUFBZSxNQUFzQjtBQUU1QyxXQUFPLEtBQUssS0FBSyxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQ2pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLDJCQUNMLGtCQUE0QyxDQUFDLEdBQzdDLGVBQXVCLElBQ3ZCLGlCQUF5QixJQUNEO0FBNzJCMUI7QUErMkJFLFFBQUksZUFBZTtBQUNuQixRQUFJLFFBQVE7QUFDWixRQUFJLHNCQUFnRCxDQUFDO0FBRXJELFFBQUk7QUFFSCxZQUFNLHVCQUF1QixRQUFNLFVBQUssT0FBTyxzQkFBWixtQkFBK0I7QUFDbEUsVUFBSSxzQkFBc0I7QUFDekIsdUJBQWU7QUFHZixZQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsY0FBSTtBQUNILGtCQUFNLGVBQWUsS0FBSyxPQUFPLGtCQUFrQixnQkFBZ0I7QUFDbkUsZ0JBQUksY0FBYztBQUNqQixzQkFBUTtBQUFBLFlBQ1Q7QUFBQSxVQUNELFNBQVMsT0FBTztBQUNmLG9CQUFRLEtBQUssK0NBQStDLEtBQUs7QUFBQSxVQUNsRTtBQUFBLFFBQ0Q7QUFBQSxNQUNELE9BQU87QUFDTixnQkFBUSxLQUFLLHVEQUF1RDtBQUFBLE1BQ3JFO0FBR0EsVUFBSSxLQUFLLG1CQUFtQixLQUFLLE9BQU8scUJBQXFCO0FBQzVELGNBQU0sY0FBYyxLQUFLLElBQUksTUFBTSxzQkFBc0IsS0FBSyxlQUFlO0FBQzdFLFlBQUksYUFBYTtBQUNoQixnQkFBTSxlQUFlLE1BQU0sS0FBSyxPQUFPLG9CQUFvQixnQkFBZ0IsV0FBVztBQUN0RixrQ0FBdUIsNkNBQWMsYUFBWSxDQUFDLEdBQUcsSUFBSSxVQUFRLEVBQUUsU0FBUyxJQUFJLFFBQVEsRUFBRTtBQUFBLFFBQzNGO0FBQUEsTUFDRDtBQUFBLElBRUQsU0FBUyxPQUFPO0FBQ2YsY0FBUSxLQUFLLDJEQUEyRCxLQUFLO0FBQUEsSUFDOUU7QUFHQSxVQUFNLHlCQUF1QixnQkFBSyxXQUFMLG1CQUFhLGFBQWIsbUJBQXVCLHlCQUF3QjtBQUU1RSxVQUFNLFFBQVE7QUFBQSxNQUNiO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHVCQUF1QixVQUFpQztBQUM3RCxTQUFLLGtCQUFrQixPQUFPLFFBQVE7QUFHdEMsVUFBTSxtQkFBbUIsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFDdEUsUUFBSSxvQkFBb0IsaUJBQWlCLFFBQVEsS0FBSyxPQUFPLHFCQUFxQjtBQUNqRixZQUFNLEtBQUssT0FBTyxvQkFBb0Isc0JBQXNCLGdCQUF5QjtBQUFBLElBQ3RGO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EscUJBQXFCLFVBQXVDO0FBQzNELFdBQU8sS0FBSyxrQkFBa0IsSUFBSSxRQUFRLEtBQUssQ0FBQztBQUFBLEVBQ2pEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLG9CQUFvQixVQUFrQixhQUFvQztBQUMvRSxVQUFNLFVBQVUsS0FBSyxrQkFBa0IsSUFBSSxRQUFRLEtBQUssQ0FBQztBQUN6RCxVQUFNLFdBQVcsUUFBUSxPQUFPLFNBQU8sSUFBSSxLQUFLLFNBQVMsV0FBVztBQUVwRSxRQUFJLFNBQVMsU0FBUyxHQUFHO0FBQ3hCLFdBQUssa0JBQWtCLElBQUksVUFBVSxRQUFRO0FBQUEsSUFDOUMsT0FBTztBQUNOLFdBQUssa0JBQWtCLE9BQU8sUUFBUTtBQUFBLElBQ3ZDO0FBR0EsVUFBTSxtQkFBbUIsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFDdEUsUUFBSSxvQkFBb0IsaUJBQWlCLFFBQVEsS0FBSyxPQUFPLHFCQUFxQjtBQUNqRixZQUFNLEtBQUssT0FBTyxvQkFBb0Isc0JBQXNCLGtCQUEyQixXQUFXO0FBQUEsSUFDbkc7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxxQkFBcUIsU0FJbkI7QUFDRCxVQUFNLFdBQVcsUUFBUSxlQUFlO0FBRXhDLFFBQUksWUFBWTtBQUNoQixRQUFJLFVBQVUsWUFBWSxRQUFRLFlBQVksYUFBYSxJQUFJLE1BQU0sRUFBRSxNQUFNLFFBQVEsVUFBVTtBQUUvRixVQUFNLE9BQU8sR0FBRyxRQUFRO0FBRXhCLFdBQU8sRUFBRSxNQUFNLFdBQVcsUUFBUTtBQUFBLEVBQ25DO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx3QkFBd0IsU0FBb0M7QUFDM0QsVUFBTSxRQUFrQixDQUFDO0FBR3pCLGVBQVcsT0FBTyxRQUFRLGdCQUFnQjtBQUN6QyxZQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssUUFBUSxHQUFHLElBQUksV0FBVyxJQUFJLElBQUksUUFBUSxLQUFLLEVBQUUsRUFBRTtBQUFBLElBQzNFO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFDRDtBQUFBO0FBcjhCYSxnQkFXWSxxQkFBcUI7QUFYdkMsSUFBTSxpQkFBTjs7O0FHeEJBLElBQU0sZ0JBQU4sTUFBTSxjQUFhO0FBQUEsRUFLekIsWUFBWSxRQUFvQixlQUE0QjtBQUMzRCxTQUFLLFNBQVM7QUFDZCxTQUFLLGdCQUFnQjtBQUFBLEVBQ3RCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxXQUFXLE1BQXVDLFNBQXVCO0FBRXhFLFVBQU0sWUFBWSxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssNkJBQTZCLElBQUksR0FBRyxDQUFDO0FBQzNGLGNBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUt2QixTQUFTLFNBQ1IsNEZBQ0EsU0FBUyxXQUNULGlKQUNBLDZGQUNIO0FBQUE7QUFHRCxVQUFNLFNBQVMsVUFBVSxTQUFTLE9BQU87QUFBQSxNQUN4QyxNQUFNLFNBQVMsU0FBUyxRQUFRLFNBQVMsV0FBVyxXQUFXO0FBQUEsTUFDL0QsS0FBSztBQUFBLElBQ04sQ0FBQztBQUNELFdBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU92QixVQUFNLFlBQVksVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRTNFLFFBQUksU0FBUyxZQUFZLFFBQVEsU0FBUyxNQUFNLEdBQUc7QUFDbEQsZ0JBQVUsWUFBWTtBQUFBLElBQ3ZCLE9BQU87QUFDTixnQkFBVSxjQUFjO0FBQUEsSUFDekI7QUFFQSxTQUFLLGVBQWUsSUFBSTtBQUFBLEVBQ3pCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxpQkFBaUIsU0FBaUIsU0FBK0I7QUFFaEUsVUFBTSxXQUFXLEtBQUssbUJBQW1CLFNBQVMsT0FBTztBQUd6RCxVQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLGdCQUFnQixRQUFRLEdBQUcsQ0FBQztBQUNsRixVQUFNLFlBQVksVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRTNFLFFBQUksUUFBUSxTQUFTLE1BQU0sR0FBRztBQUM3QixnQkFBVSxZQUFZO0FBQUEsSUFDdkIsT0FBTztBQUNOLGdCQUFVLGNBQWM7QUFBQSxJQUN6QjtBQUdBLFFBQUksUUFBUSxTQUFTO0FBQ3BCLFlBQU0sYUFBYSxLQUFLLE9BQU8sSUFBSSxVQUFVLGNBQWM7QUFDM0QsVUFBSSxZQUFZO0FBQ2YsYUFBSyxPQUFPLG9CQUFvQjtBQUFBLFVBQy9CO0FBQUEsVUFDQTtBQUFBLFVBQ0EsRUFBRSxhQUFhLFNBQVM7QUFBQTtBQUFBLFFBQ3pCO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFFQSxTQUFLLGVBQWU7QUFBQSxFQUNyQjtBQUFBLEVBRVEsbUJBQW1CLFNBQWlCLFNBQWlDO0FBQzVFLFFBQUksUUFBUSxTQUFTLFFBQVE7QUFDNUIsYUFBTyxhQUFhLFFBQVEsT0FBTztBQUFBLElBQ3BDLE9BQU87QUFDTixhQUFPLGVBQWUsUUFBUSxPQUFPO0FBQUEsSUFDdEM7QUFBQSxFQUNEO0FBQUE7QUFBQSxFQUdBLGtCQUFrQixTQUFpQixVQUFtQixPQUFhO0FBRWxFLFFBQUksQ0FBQyxRQUFRLFdBQVcsU0FBSSxLQUFLLENBQUMsUUFBUSxTQUFTLE1BQU0sR0FBRztBQUMzRCxnQkFBVSxZQUFPO0FBQUEsSUFDbEI7QUFFQSxTQUFLLGlCQUFpQixTQUFTLEVBQUUsTUFBTSxRQUFRLFNBQVMsV0FBVyxRQUFRLENBQUM7QUFBQSxFQUM3RTtBQUFBLEVBRUEsZ0JBQWdCLFNBQWlCLFVBQW1CLE9BQWE7QUFFaEUsUUFBSSxDQUFDLFFBQVEsV0FBVyxTQUFJLEtBQUssQ0FBQyxRQUFRLFNBQVMsTUFBTSxHQUFHO0FBQzNELGdCQUFVLFlBQU87QUFBQSxJQUNsQjtBQUNBLFVBQU0sT0FBTyxRQUFRLFVBQVUsS0FBSyxTQUFTO0FBQzdDLFNBQUssaUJBQWlCLFNBQVMsRUFBRSxNQUFNLFNBQVMsU0FBUyxRQUFRLENBQUM7QUFBQSxFQUNuRTtBQUFBLEVBRUEsa0JBQWtCLFNBQWlCLFVBQW1CLE9BQWE7QUFFbEUsUUFBSSxDQUFDLFFBQVEsV0FBVyxlQUFLLEtBQUssQ0FBQyxRQUFRLFNBQVMsTUFBTSxHQUFHO0FBQzVELGdCQUFVLGtCQUFRO0FBQUEsSUFDbkI7QUFDQSxVQUFNLE9BQU8sUUFBUSxVQUFVLEtBQUssU0FBUztBQUM3QyxTQUFLLGlCQUFpQixTQUFTLEVBQUUsTUFBTSxTQUFTLFdBQVcsUUFBUSxDQUFDO0FBQUEsRUFDckU7QUFBQSxFQUVBLGtCQUFrQixTQUF3QjtBQUN6QyxVQUFNLFlBQVksS0FBSyxjQUFjLFVBQVUsRUFBRSxLQUFLLGVBQWUsQ0FBQztBQUN0RSxjQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVExQixVQUFNLFVBQVUsV0FBVztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFtQjNCLGNBQVUsWUFBWTtBQUV0QixTQUFLLGVBQWUsSUFBSTtBQUFBLEVBQ3pCO0FBQUEsRUFHQSxZQUFrQjtBQUNqQixTQUFLLGNBQWMsTUFBTTtBQUFBLEVBQzFCO0FBQUEsRUFFUSxlQUFlLFNBQWtCLE9BQWE7QUFDckQsZUFBVyxNQUFNO0FBQ2hCLFVBQUksUUFBUTtBQUNYLGFBQUssY0FBYyxTQUFTO0FBQUEsVUFDM0IsS0FBSyxLQUFLLGNBQWM7QUFBQSxVQUN4QixVQUFVO0FBQUEsUUFDWCxDQUFDO0FBQUEsTUFDRixPQUFPO0FBQ04sYUFBSyxjQUFjLFlBQVksS0FBSyxjQUFjO0FBQUEsTUFDbkQ7QUFBQSxJQUNELEdBQUcsY0FBYSxlQUFlO0FBQUEsRUFDaEM7QUFBQSxFQUVBLE1BQU0sd0JBQXdCLE1BQTRCO0FBMUwzRDtBQTJMRSxVQUFNLFdBQVcsTUFBTSxLQUFLLE9BQU8sb0JBQW9CLGtCQUFrQixNQUFNLEVBQUU7QUFFakYsUUFBSSxTQUFTLFdBQVcsR0FBRztBQUUxQixXQUFLLGtCQUFrQjtBQUN2QjtBQUFBLElBQ0Q7QUFFQSxlQUFXLFdBQVcsVUFBVTtBQUMvQixVQUFJLFFBQVEsU0FBUyxjQUFZLGFBQVEsYUFBUixtQkFBa0IsY0FBYTtBQUUvRCxjQUFNLFlBQVksS0FBSyxjQUFjLFVBQVU7QUFBQSxVQUM5QyxLQUFLLGdCQUFnQixRQUFRLFNBQVMsV0FBVztBQUFBLFFBQ2xELENBQUM7QUFDRCxjQUFNLFlBQVksVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRTNFLFlBQUksUUFBUSxRQUFRLFNBQVMsTUFBTSxHQUFHO0FBQ3JDLG9CQUFVLFlBQVksUUFBUTtBQUFBLFFBQy9CLE9BQU87QUFDTixvQkFBVSxjQUFjLFFBQVE7QUFBQSxRQUNqQztBQUFBLE1BQ0QsT0FBTztBQUVOLGFBQUssV0FBVyxRQUFRLE1BQXlDLFFBQVEsT0FBTztBQUFBLE1BQ2pGO0FBQUEsSUFDRDtBQUVBLFNBQUssZUFBZTtBQUFBLEVBQ3JCO0FBQ0Q7QUF6TWEsY0FHWSxrQkFBa0I7QUFIcEMsSUFBTSxlQUFOOzs7QUNWUCxJQUFBQyxtQkFBK0I7QUFXeEIsSUFBTSxvQkFBTixNQUFNLGtCQUFpQjtBQUFBLEVBQXZCO0FBQ0gsU0FBUSx3QkFBK0M7QUFDdkQsU0FBUSxpQkFBZ0M7QUFDeEMsU0FBUSx5QkFBOEI7QUFDdEMsU0FBUSxvQkFBeUI7QUFDakMsU0FBUSxtQkFBd0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUE4SWhDLG1CQUFtQixZQUF3QixnQkFBcUMsVUFBZ0I7QUFFNUYsUUFBSSxrQkFBa0IsVUFBVTtBQUM1QjtBQUFBLElBQ0o7QUFFQSxRQUFJO0FBRUEsWUFBTSxVQUFVLGtCQUFpQixpQkFBaUIsVUFBVSxLQUFLLGtCQUFpQixpQkFBaUIsTUFBTTtBQUN6RyxZQUFNLGVBQWUsUUFBUSxLQUFLLE1BQU0sS0FBSyxPQUFPLElBQUksUUFBUSxNQUFNLENBQUM7QUFHdkUsV0FBSyxpQkFBaUIsSUFBSSx3QkFBTyxTQUFTLFlBQVksS0FBSyxDQUFDO0FBRzVELFlBQU0sb0JBQW9CLFNBQVMsWUFBWTtBQUMvQyxZQUFNLFdBQVksS0FBSyxlQUF1QjtBQUM5QyxVQUFJLFVBQVU7QUFDVixpQkFBUyxjQUFjO0FBQUEsTUFDM0I7QUFHQSxXQUFLLHlCQUF5QixZQUFZO0FBQUEsSUFFOUMsU0FBUyxPQUFPO0FBQ1osY0FBUSxLQUFLLHFDQUFxQyxLQUFLO0FBQUEsSUFDM0Q7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT0EsZUFDSSxRQUNBLFVBQ0EsUUFDQSxVQUE0QixDQUFDLEdBSS9CO0FBRUUsU0FBSyxtQkFBbUIsRUFBRSxNQUFNLFVBQVUsSUFBSSxPQUFPO0FBRXJELFFBQUksUUFBUTtBQUVSLGFBQU8sYUFBYSxJQUFJLFVBQVUsTUFBTTtBQUN4QyxXQUFLLHlCQUF5QjtBQUFBLElBQ2xDLE9BQU87QUFFSCxXQUFLLHlCQUF5QjtBQUFBLElBQ2xDO0FBRUEsU0FBSyxvQkFBb0I7QUFFekIsVUFBTSxlQUFlLENBQUMsU0FBaUIsZUFBd0I7QUFDM0QsV0FBSyxvQkFBb0IsUUFBUSxTQUFTLFlBQVksT0FBTztBQUFBLElBQ2pFO0FBRUEsVUFBTSxhQUFhLE1BQU07QUFDckIsV0FBSyxjQUFjO0FBQ25CLFdBQUssUUFBUTtBQUFBLElBQ2pCO0FBRUEsV0FBTyxFQUFFLGNBQWMsV0FBVztBQUFBLEVBQ3RDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxvQkFDSixRQUNBLFNBQ0EsWUFDQSxTQUNJO0FBQ0osUUFBSTtBQUNBLFVBQUksS0FBSyx3QkFBd0I7QUFLN0IsWUFBSSxDQUFDLEtBQUssbUJBQW1CO0FBQ3pCLGVBQUssb0JBQW9CLEVBQUUsR0FBRyxLQUFLLHVCQUF1QjtBQUFBLFFBQzlEO0FBR0EsY0FBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBQ2hDLGNBQU0sWUFBWTtBQUFBLFVBQ2QsTUFBTSxLQUFLLGtCQUFrQixPQUFPLE1BQU0sU0FBUztBQUFBLFVBQ25ELElBQUksTUFBTSxTQUFTLElBQUksTUFBTSxNQUFNLFNBQVMsQ0FBQyxFQUFFLFNBQVMsS0FBSyxrQkFBa0IsS0FBSyxRQUFRO0FBQUEsUUFDaEc7QUFHQSxlQUFPLGFBQWEsU0FBUyxLQUFLLG1CQUFtQixLQUFLLHNCQUFzQjtBQUNoRixhQUFLLHlCQUF5QjtBQUc5QixZQUFJLFFBQVEsU0FBUztBQUNqQixrQkFBUSxRQUFRLFNBQVMsVUFBVTtBQUFBLFFBQ3ZDO0FBQUEsTUFDSjtBQUdBLFVBQUksWUFBWTtBQUNaLGVBQU8sVUFBVSxLQUFLLHNCQUFzQjtBQUM1QyxhQUFLLFFBQVE7QUFHYixZQUFJLFFBQVEsWUFBWTtBQUNwQixrQkFBUSxXQUFXO0FBQUEsUUFDdkI7QUFBQSxNQUNKO0FBQUEsSUFDSixTQUFTLE9BQU87QUFDWixjQUFRLEtBQUssa0NBQWtDLEtBQUs7QUFDcEQsV0FBSyxRQUFRO0FBR2IsVUFBSSxRQUFRLFNBQVM7QUFDakIsZ0JBQVEsUUFBUSxpQkFBaUIsUUFBUSxRQUFRLElBQUksTUFBTSxPQUFPLEtBQUssQ0FBQyxDQUFDO0FBQUEsTUFDN0U7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EseUJBQXlCLFlBQTBCO0FBQ3ZELFFBQUksV0FBVztBQUVmLFNBQUssd0JBQXdCLFlBQVksTUFBTTtBQUMzQyxVQUFJO0FBQ0EsWUFBSSxDQUFDLEtBQUssZUFBZ0I7QUFFMUI7QUFDQSxZQUFJLFdBQVcsR0FBRztBQUNkLHFCQUFXO0FBQUEsUUFDZjtBQUVBLGNBQU0sT0FBTyxJQUFJLE9BQU8sUUFBUTtBQUNoQyxjQUFNLGFBQWEsU0FBUyxVQUFVLEdBQUcsSUFBSTtBQUc3QyxjQUFNLFdBQVksS0FBSyxlQUF1QjtBQUM5QyxZQUFJLFVBQVU7QUFDVixtQkFBUyxjQUFjO0FBQUEsUUFDM0I7QUFBQSxNQUVKLFNBQVMsT0FBTztBQUNaLGdCQUFRLEtBQUssbUNBQW1DLEtBQUs7QUFDckQsYUFBSyxrQkFBa0I7QUFBQSxNQUMzQjtBQUFBLElBQ0osR0FBRyxHQUFHO0FBQUEsRUFDVjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esb0JBQTBCO0FBQzlCLFFBQUksS0FBSyx1QkFBdUI7QUFDNUIsb0JBQWMsS0FBSyxxQkFBcUI7QUFDeEMsV0FBSyx3QkFBd0I7QUFBQSxJQUNqQztBQUdBLFFBQUksS0FBSyxnQkFBZ0I7QUFDckIsV0FBSyxlQUFlLEtBQUs7QUFDekIsV0FBSyxpQkFBaUI7QUFBQSxJQUMxQjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGdCQUFzQjtBQUNsQixTQUFLLGtCQUFrQjtBQUFBLEVBQzNCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxVQUFnQjtBQUVwQixTQUFLLGtCQUFrQjtBQUV2QixTQUFLLHlCQUF5QjtBQUM5QixTQUFLLG9CQUFvQjtBQUN6QixTQUFLLG1CQUFtQjtBQUFBLEVBQzVCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxzQkFBc0Q7QUFDbEQsV0FBTyxLQUFLO0FBQUEsRUFDaEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGNBQXVCO0FBQ25CLFdBQU8sS0FBSywyQkFBMkI7QUFBQSxFQUMzQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxNQUFNLHdCQUNGLFFBQ0EsZUFDQSxZQUNBLG1CQUNBLFVBQTRCLENBQUMsR0FDaEI7QUFFYixVQUFNLG1CQUFtQixFQUFFLEdBQUcsU0FBUyxlQUFlLFNBQWtCO0FBR3hFLFNBQUssbUJBQW1CLFlBQVksUUFBUTtBQUc1QyxXQUFPLGFBQWEsSUFBSSxjQUFjLE1BQU0sY0FBYyxFQUFFO0FBQzVELFNBQUsseUJBQXlCLGNBQWM7QUFDNUMsU0FBSyxvQkFBb0I7QUFHekIsVUFBTSxFQUFFLGNBQWMsV0FBVyxJQUFJLEtBQUs7QUFBQSxNQUN0QztBQUFBLE1BQ0EsY0FBYztBQUFBLE1BQ2Q7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUdBLFVBQU0sa0JBQWtCLENBQUMsT0FBZSxlQUF3QjtBQUM1RCxtQkFBYSxPQUFPLFVBQVU7QUFDOUIsd0JBQWtCLE9BQU8sVUFBVTtBQUFBLElBQ3ZDO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFDSjtBQUFBO0FBeFlhLGtCQVFlLG1CQUFpRDtBQUFBLEVBQ3JFLFdBQVc7QUFBQSxJQUNQO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ047QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxXQUFXO0FBQUEsSUFDUDtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFFBQVE7QUFBQSxJQUNKO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ047QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxRQUFRO0FBQUEsSUFDSjtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLE9BQU87QUFBQSxJQUNIO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsUUFBUTtBQUFBLElBQ0o7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxXQUFXO0FBQUEsSUFDUDtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFdBQVc7QUFBQSxJQUNQO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsVUFBVTtBQUFBLElBQ047QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQ0o7QUE3SUcsSUFBTSxtQkFBTjs7O0FDWFAsSUFBQUMsbUJBQW9EOzs7QUNBcEQsSUFBQUMsbUJBQStDO0FBY3hDLElBQU0sdUJBQU4sTUFBMkI7QUFBQSxFQUM5QixZQUFvQixRQUFvQjtBQUFwQjtBQUFBLEVBQXFCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLekMsTUFBTSxRQUFRLFFBQWdCLFFBQWdCLGNBQXNCLG1CQUEwRDtBQUMxSCxRQUFJO0FBRUEsWUFBTSxpQkFBaUI7QUFBQSxRQUNuQixNQUFNLE9BQU8sVUFBVSxNQUFNO0FBQUEsUUFDN0IsSUFBSSxPQUFPLFVBQVUsSUFBSTtBQUFBLE1BQzdCO0FBR0EsWUFBTSxnQkFBZ0IsSUFBSSx3QkFBTyxzQ0FBc0MsQ0FBQztBQUd4RSxZQUFNQyxVQUFTLEtBQUssWUFBWSxRQUFRLGNBQWMsaUJBQWlCO0FBR3ZFLFlBQU0sV0FBVyxNQUFNLEtBQUssT0FBTyxrQkFBa0I7QUFBQSxRQUNqREEsUUFBTztBQUFBLFFBQ1BBLFFBQU87QUFBQSxNQUNYO0FBRUEsb0JBQWMsS0FBSztBQUduQixZQUFNLGtCQUFrQixLQUFLLGdCQUFnQixRQUFRO0FBRXJELGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNUO0FBQUEsUUFDQSxlQUFlO0FBQUEsTUFDbkI7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSxpQ0FBaUMsS0FBSztBQUNwRCxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ3BEO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQ0YsUUFDQSxRQUNBLGNBQ0EsU0FDQSxtQkFDNEI7QUFDNUIsUUFBSTtBQUVBLFlBQU0saUJBQWlCO0FBQUEsUUFDbkIsTUFBTSxPQUFPLFVBQVUsTUFBTTtBQUFBLFFBQzdCLElBQUksT0FBTyxVQUFVLElBQUk7QUFBQSxNQUM3QjtBQUdBLFlBQU1BLFVBQVMsS0FBSyxZQUFZLFFBQVEsY0FBYyxpQkFBaUI7QUFFdkUsVUFBSSxlQUFlO0FBR25CLFlBQU0sU0FBUyxLQUFLLE9BQU8sa0JBQWtCLG1CQUFtQkEsUUFBTyxZQUFZO0FBQUEsUUFDL0UsY0FBY0EsUUFBTztBQUFBLE1BQ3pCLENBQUM7QUFFRCx1QkFBaUIsU0FBUyxRQUFRO0FBQzlCLFlBQUksTUFBTSxPQUFPO0FBQ2IsZ0JBQU0sSUFBSSxNQUFNLE1BQU0sS0FBSztBQUFBLFFBQy9CO0FBRUEsd0JBQWdCLE1BQU07QUFHdEIsWUFBSSxhQUFhLEtBQUssRUFBRSxTQUFTLEtBQUssTUFBTSxNQUFNO0FBQzlDLGdCQUFNLGVBQWUsS0FBSyxnQkFBZ0IsWUFBWTtBQUN0RCxrQkFBUSxjQUFjLE1BQU0sSUFBSTtBQUFBLFFBQ3BDO0FBRUEsWUFBSSxNQUFNLE1BQU07QUFDWjtBQUFBLFFBQ0o7QUFBQSxNQUNKO0FBR0EsWUFBTSxZQUFZLEtBQUssZ0JBQWdCLFlBQVk7QUFDbkQsVUFBSSxDQUFDLFVBQVUsS0FBSyxHQUFHO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLGVBQWU7QUFBQSxRQUNuQjtBQUFBLE1BQ0o7QUFFQSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxpQkFBaUI7QUFBQSxRQUNqQixlQUFlO0FBQUEsTUFDbkI7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSxtQ0FBbUMsS0FBSztBQUN0RCxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ3BEO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLFlBQVksUUFBZ0IsY0FBc0IsbUJBR3hEO0FBQ0UsVUFBTSxtQkFBbUI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVN6QixRQUFJLGlCQUFpQjtBQUNyQixRQUFJLGFBQWE7QUFFakIsWUFBUSxRQUFRO0FBQUEsTUFDWixLQUFLO0FBQ0QseUJBQWlCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1qQixxQkFBYTtBQUFBO0FBQUEsRUFBeUIsWUFBWTtBQUNsRDtBQUFBLE1BRUosS0FBSztBQUNELHlCQUFpQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNakIscUJBQWE7QUFBQTtBQUFBLEVBQStDLFlBQVk7QUFDeEU7QUFBQSxNQUVKLEtBQUs7QUFDRCx5QkFBaUI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTWpCLHFCQUFhO0FBQUE7QUFBQSxFQUErQyxZQUFZO0FBQ3hFO0FBQUEsTUFFSixLQUFLO0FBQ0QsY0FBTSxVQUFrQztBQUFBLFVBQ3BDLFVBQVU7QUFBQSxVQUNWLFVBQVU7QUFBQSxVQUNWLFlBQVk7QUFBQSxVQUNaLFlBQVk7QUFBQSxRQUNoQjtBQUVBLGNBQU0sa0JBQWtCLFFBQVEscUJBQXFCLFFBQVEsS0FBSyxRQUFRO0FBQzFFLHlCQUFpQjtBQUFBLDhCQUNILGVBQWU7QUFBQTtBQUFBO0FBQUE7QUFJN0IscUJBQWEsMEJBQTBCLHFCQUFxQixRQUFRO0FBQUE7QUFBQSxFQUFhLFlBQVk7QUFDN0Y7QUFBQSxNQUVKLEtBQUs7QUFDRCx5QkFBaUI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUtqQixxQkFBYSx3Q0FBd0MsaUJBQWlCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFBOEIsWUFBWTtBQUNoSDtBQUFBLE1BRUo7QUFDSSx5QkFBaUI7QUFBQTtBQUFBO0FBQUE7QUFJakIscUJBQWE7QUFBQTtBQUFBLEVBQXlCLFlBQVk7QUFBQSxJQUMxRDtBQUVBLFdBQU87QUFBQSxNQUNILGNBQWMsbUJBQW1CLE9BQU87QUFBQSxNQUN4QztBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsVUFBMEI7QUFFOUMsUUFBSSxVQUFVLFNBQVMsS0FBSztBQUc1QixVQUFNLGdCQUFnQjtBQUFBLE1BQ2xCO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUVBLGVBQVcsV0FBVyxlQUFlO0FBQ2pDLGdCQUFVLFFBQVEsUUFBUSxTQUFTLEVBQUU7QUFBQSxJQUN6QztBQUdBLGNBQVUsUUFBUSxNQUFNLGNBQWMsRUFBRSxNQUFNLEtBQUs7QUFDbkQsY0FBVSxRQUFRLE1BQU0sK0JBQStCLEVBQUUsTUFBTSxLQUFLO0FBRXBFLFdBQU8sUUFBUSxLQUFLO0FBQUEsRUFDeEI7QUFDSjs7O0FDeFBBLElBQUFDLG1CQUFtRDtBQVE1QyxJQUFNLGVBQTZCO0FBQUEsRUFDdEM7QUFBQSxJQUNJLElBQUk7QUFBQSxJQUNKLE9BQU87QUFBQSxJQUNQLGFBQWE7QUFBQSxFQUNqQjtBQUFBLEVBQ0E7QUFBQSxJQUNJLElBQUk7QUFBQSxJQUNKLE9BQU87QUFBQSxJQUNQLGFBQWE7QUFBQSxFQUNqQjtBQUFBLEVBQ0E7QUFBQSxJQUNJLElBQUk7QUFBQSxJQUNKLE9BQU87QUFBQSxJQUNQLGFBQWE7QUFBQSxFQUNqQjtBQUFBLEVBQ0E7QUFBQSxJQUNJLElBQUk7QUFBQSxJQUNKLE9BQU87QUFBQSxJQUNQLGFBQWE7QUFBQSxFQUNqQjtBQUNKO0FBRU8sSUFBTSxxQkFBTixjQUFpQyxtQ0FBOEI7QUFBQSxFQUlsRSxZQUNJLEtBQ0EsVUFDQSxVQUNGO0FBQ0UsVUFBTSxHQUFHO0FBQ1QsU0FBSyxXQUFXO0FBQ2hCLFNBQUssV0FBVztBQUdoQixTQUFLLGVBQWUsMEJBQTBCO0FBRzlDLFNBQUssZ0JBQWdCO0FBQUEsTUFDakIsRUFBRSxTQUFTLGdCQUFNLFNBQVMsY0FBYztBQUFBLE1BQ3hDLEVBQUUsU0FBUyxVQUFLLFNBQVMsZ0JBQWdCO0FBQUEsTUFDekMsRUFBRSxTQUFTLE9BQU8sU0FBUyxZQUFZO0FBQUEsSUFDM0MsQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLFdBQXlCO0FBQ3JCLFdBQU87QUFBQSxFQUNYO0FBQUEsRUFFQSxZQUFZLE1BQTBCO0FBQ2xDLFdBQU8sR0FBRyxLQUFLLEtBQUssTUFBTSxLQUFLLFdBQVc7QUFBQSxFQUM5QztBQUFBLEVBRUEsYUFBYSxNQUFrQixLQUF1QztBQUNsRSxTQUFLLFNBQVMsS0FBSyxFQUFFO0FBQUEsRUFDekI7QUFBQSxFQUVBLFVBQWdCO0FBRVosVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixRQUFJLFVBQVUsZUFBZTtBQUN6QixXQUFLLFNBQVM7QUFBQSxJQUNsQjtBQUFBLEVBQ0o7QUFDSjs7O0FDMUVBLElBQUFDLG1CQUFvQztBQUU3QixJQUFNLHlCQUFOLGNBQXFDLHVCQUFNO0FBQUEsRUFLOUMsWUFDSSxLQUNBLFVBQ0EsVUFDRjtBQUNFLFVBQU0sR0FBRztBQVRiLFNBQVEsY0FBc0I7QUFVMUIsU0FBSyxXQUFXO0FBQ2hCLFNBQUssV0FBVztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxTQUFTO0FBdEJiO0FBdUJRLFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsY0FBVSxNQUFNO0FBR2hCLFNBQUssUUFBUSxTQUFTLCtCQUErQjtBQUdyRCxjQUFVLFNBQVMsTUFBTSxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBRzlDLFFBQUkseUJBQVEsU0FBUyxFQUNoQixRQUFRLGFBQWEsRUFDckIsUUFBUSw0REFBNEQ7QUFHekUsVUFBTSxrQkFBa0IsSUFBSSx5QkFBUSxTQUFTLEVBQ3hDLFlBQVksVUFBUTtBQUNqQixXQUNLLGVBQWUsK0VBQStFLEVBQzlGLFNBQVMsS0FBSyxXQUFXLEVBQ3pCLFNBQVMsV0FBUztBQUNmLGFBQUssY0FBYztBQUFBLE1BQ3ZCLENBQUM7QUFHTCxXQUFLLFFBQVEsT0FBTztBQUNwQixXQUFLLFFBQVEsTUFBTSxRQUFRO0FBQzNCLFdBQUssUUFBUSxNQUFNLFlBQVk7QUFHL0IsaUJBQVcsTUFBTSxLQUFLLFFBQVEsTUFBTSxHQUFHLEVBQUU7QUFHekMsV0FBSyxRQUFRLGlCQUFpQixXQUFXLENBQUMsTUFBTTtBQUM1QyxZQUFJLEVBQUUsUUFBUSxZQUFZLEVBQUUsV0FBVyxFQUFFLFVBQVU7QUFDL0MsWUFBRSxlQUFlO0FBQ2pCLGVBQUssT0FBTztBQUFBLFFBQ2hCO0FBQUEsTUFDSixDQUFDO0FBRUQsYUFBTztBQUFBLElBQ1gsQ0FBQztBQUdMLG9CQUFnQixVQUFVLE1BQU0sU0FBUztBQUN6QywwQkFBZ0IsVUFBVSxjQUFjLG9CQUFvQixNQUE1RCxtQkFBK0Q7QUFHL0QsVUFBTSxVQUFVLGdCQUFnQixVQUFVLGNBQWMsdUJBQXVCO0FBQy9FLFFBQUksbUJBQW1CLGFBQWE7QUFDaEMsY0FBUSxNQUFNLFFBQVE7QUFBQSxJQUMxQjtBQUdBLFFBQUkseUJBQVEsU0FBUyxFQUNoQixVQUFVLFNBQU8sSUFDYixjQUFjLFFBQVEsRUFDdEIsUUFBUSxNQUFNO0FBQ1gsV0FBSyxNQUFNO0FBQ1gsV0FBSyxTQUFTO0FBQUEsSUFDbEIsQ0FBQyxDQUFDLEVBQ0wsVUFBVSxTQUFPLElBQ2IsY0FBYyxnQkFBZ0IsRUFDOUIsT0FBTyxFQUNQLFFBQVEsTUFBTSxLQUFLLE9BQU8sQ0FBQyxDQUFDO0FBQUEsRUFDekM7QUFBQSxFQUVRLFNBQWU7QUFDbkIsUUFBSSxLQUFLLFlBQVksS0FBSyxHQUFHO0FBQ3pCLFdBQUssTUFBTTtBQUNYLFdBQUssU0FBUyxLQUFLLFlBQVksS0FBSyxDQUFDO0FBQUEsSUFDekM7QUFBQSxFQUNKO0FBQUEsRUFFQSxVQUFVO0FBQ04sVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFBQSxFQUNwQjtBQUNKOzs7QUhsRk8sSUFBTSxvQkFBdUM7QUFBQSxFQUNoRDtBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osT0FBTztBQUFBLElBQ1AsTUFBTTtBQUFBLElBQ04sYUFBYTtBQUFBLEVBQ2pCO0FBQUEsRUFDQTtBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osT0FBTztBQUFBLElBQ1AsTUFBTTtBQUFBLElBQ04sYUFBYTtBQUFBLEVBQ2pCO0FBQUEsRUFDQTtBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osT0FBTztBQUFBLElBQ1AsTUFBTTtBQUFBLElBQ04sYUFBYTtBQUFBLEVBQ2pCO0FBQUEsRUFDQTtBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osT0FBTztBQUFBLElBQ1AsTUFBTTtBQUFBLElBQ04sYUFBYTtBQUFBLEVBQ2pCO0FBQUEsRUFDQTtBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osT0FBTztBQUFBLElBQ1AsTUFBTTtBQUFBLElBQ04sYUFBYTtBQUFBLEVBQ2pCO0FBQ0o7QUFFTyxJQUFNLHVCQUFOLE1BQTJCO0FBQUEsRUFLOUIsWUFDWSxLQUNBLFFBQ1Y7QUFGVTtBQUNBO0FBb1BaLFNBQVEsb0JBQW1EO0FBbFB2RCxTQUFLLHVCQUF1QixJQUFJLHFCQUFxQixNQUFNO0FBQzNELFNBQUssbUJBQW1CLElBQUksaUJBQWlCO0FBQUEsRUFDakQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHNCQUFzQixVQUE0QjtBQUM5QyxTQUFLLHFCQUFxQjtBQUFBLEVBQzlCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxzQkFBNEI7QUFDaEMsUUFBSSxLQUFLLG9CQUFvQjtBQUN6QixXQUFLLG1CQUFtQjtBQUFBLElBQzVCO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsV0FBaUI7QUFDYixTQUFLLE9BQU87QUFBQSxNQUNSLEtBQUssSUFBSSxVQUFVLEdBQUcsZUFBZSxDQUFDLE1BQVksV0FBbUI7QUFDakUsYUFBSyxlQUFlLE1BQU0sTUFBTTtBQUFBLE1BQ3BDLENBQUM7QUFBQSxJQUNMO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZUFBZSxNQUFZLFFBQXNCO0FBQ3JELFVBQU0sZUFBZSxPQUFPLGFBQWE7QUFHekMsUUFBSSxDQUFDLGdCQUFnQixhQUFhLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDbkQ7QUFBQSxJQUNKO0FBR0EsU0FBSyxhQUFhO0FBR2xCLHNCQUFrQixRQUFRLFlBQVU7QUFDaEMsV0FBSyxRQUFRLENBQUMsU0FBbUI7QUFDN0IsYUFDSyxTQUFTLFNBQVMsT0FBTyxLQUFLLEVBQUUsRUFDaEMsUUFBUSxPQUFPLFFBQVEsTUFBTSxFQUM3QixRQUFRLE1BQU07QUFDWCxlQUFLLHNCQUFzQixPQUFPLElBQUksUUFBUSxZQUFZO0FBQUEsUUFDOUQsQ0FBQztBQUFBLE1BQ1QsQ0FBQztBQUFBLElBQ0wsQ0FBQztBQUFBLEVBQ0w7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQWEsc0JBQXNCLFVBQWtCLFFBQWdCLGNBQXNCLG1CQUEyQztBQUNsSSxRQUFJO0FBRUEsVUFBSSxhQUFhLFVBQVUsQ0FBQyxtQkFBbUI7QUFDM0MsYUFBSyx1QkFBdUIsUUFBUSxZQUFZO0FBQ2hEO0FBQUEsTUFDSjtBQUVBLFVBQUksYUFBYSxZQUFZLENBQUMsbUJBQW1CO0FBQzdDLGFBQUssMkJBQTJCLFFBQVEsWUFBWTtBQUNwRDtBQUFBLE1BQ0o7QUFHQSxZQUFNLEtBQUsscUJBQXFCLFVBQVUsUUFBUSxjQUFjLGlCQUFpQjtBQUFBLElBQ3JGLFNBQVMsT0FBTztBQUNaLGNBQVEsTUFBTSwwQ0FBMEMsS0FBSztBQUM3RCxVQUFJLHdCQUFPLG9EQUFvRCxHQUFJO0FBQUEsSUFDdkU7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx1QkFBdUIsUUFBZ0IsY0FBNEI7QUFDdkUsVUFBTSxRQUFRLElBQUk7QUFBQSxNQUNkLEtBQUs7QUFBQSxNQUNMLE9BQU8saUJBQXlCO0FBRTVCLGNBQU0sS0FBSyxxQkFBcUIsUUFBUSxRQUFRLGNBQWMsWUFBWTtBQUFBLE1BQzlFO0FBQUEsTUFDQSxNQUFNO0FBQUEsTUFFTjtBQUFBLElBQ0o7QUFDQSxVQUFNLEtBQUs7QUFBQSxFQUNmO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSwyQkFBMkIsUUFBZ0IsY0FBNEI7QUFDM0UsVUFBTSxRQUFRLElBQUk7QUFBQSxNQUNkLEtBQUs7QUFBQSxNQUNMLE9BQU8sZ0JBQXdCO0FBRTNCLGNBQU0sS0FBSyxxQkFBcUIsVUFBVSxRQUFRLGNBQWMsV0FBVztBQUFBLE1BQy9FO0FBQUEsTUFDQSxNQUFNO0FBQUEsTUFFTjtBQUFBLElBQ0o7QUFDQSxVQUFNLEtBQUs7QUFBQSxFQUNmO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHFCQUNWLFVBQ0EsUUFDQSxjQUNBLG1CQUNhO0FBRWIsU0FBSyx3QkFBd0IsTUFBTTtBQUduQyxVQUFNLGdCQUFnQjtBQUFBLE1BQ2xCLE1BQU0sT0FBTyxVQUFVLE1BQU07QUFBQSxNQUM3QixJQUFJLE9BQU8sVUFBVSxJQUFJO0FBQUEsSUFDN0I7QUFFQSxRQUFJO0FBRUEsWUFBTSxFQUFFLGNBQWMsV0FBVyxJQUFJLEtBQUssaUJBQWlCO0FBQUEsUUFDdkQ7QUFBQSxRQUNBLGNBQWM7QUFBQSxRQUNkLGNBQWM7QUFBQSxRQUNkO0FBQUEsVUFDSSxlQUFlO0FBQUEsVUFDZixZQUFZLE1BQU0sS0FBSyxvQkFBb0I7QUFBQSxRQUMvQztBQUFBLE1BQ0o7QUFHQSxXQUFLLGlCQUFpQixtQkFBbUIsVUFBd0IsUUFBUTtBQUd6RSxZQUFNLFNBQVMsTUFBTSxLQUFLLHFCQUFxQjtBQUFBLFFBQzNDO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBLENBQUMsT0FBZSxlQUF3QjtBQUVwQyx1QkFBYSxPQUFPLFVBQVU7QUFBQSxRQUNsQztBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBR0EsaUJBQVc7QUFFWCxVQUFJLE9BQU8sU0FBUztBQUNoQixjQUFNLGFBQWEsS0FBSyxxQkFBcUIsUUFBUTtBQUNyRCxZQUFJLHdCQUFPLGNBQWMsVUFBVSxpQkFBaUIsR0FBSTtBQUd4RCxhQUFLLHNCQUFzQixVQUFVLGNBQWMsaUJBQWlCO0FBQUEsTUFDeEUsT0FBTztBQUNILFlBQUksd0JBQU8sU0FBUyxPQUFPLFNBQVMsd0JBQXdCLElBQUksR0FBSTtBQUVwRSxhQUFLLHNCQUFzQixVQUFVLE9BQU8sU0FBUyx3QkFBd0I7QUFHN0UsYUFBSyxvQkFBb0IsTUFBTTtBQUFBLE1BQ25DO0FBQUEsSUFDSixTQUFTLE9BQU87QUFDWixjQUFRLE1BQU0sc0NBQXNDLEtBQUs7QUFDekQsVUFBSSx3QkFBTyxvREFBb0QsR0FBSTtBQUduRSxXQUFLLG9CQUFvQixNQUFNO0FBQUEsSUFDbkMsVUFBRTtBQUVFLFdBQUssdUJBQXVCO0FBQzVCLFdBQUssaUJBQWlCLGNBQWM7QUFBQSxJQUN4QztBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUFvQixRQUFzQjtBQUFBLEVBR2xEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx3QkFBd0IsUUFBc0I7QUF4UTFEO0FBeVFRLFFBQUk7QUFFQSxZQUFNLG9CQUFtQixZQUFlLE9BQWYsbUJBQW1CLFFBQU8sU0FBUyxjQUFjLFlBQVk7QUFDdEYsVUFBSSxpQkFBaUI7QUFDakIsd0JBQWdCLFVBQVUsSUFBSSwyQkFBMkI7QUFBQSxNQUM3RDtBQUdBLFlBQU0sWUFBWSxPQUFPLGFBQWE7QUFDdEMsVUFBSSxXQUFXO0FBQ1gsYUFBSyxvQkFBb0I7QUFBQSxVQUNyQixNQUFNLE9BQU8sVUFBVSxNQUFNO0FBQUEsVUFDN0IsSUFBSSxPQUFPLFVBQVUsSUFBSTtBQUFBLFFBQzdCO0FBQUEsTUFDSjtBQUFBLElBQ0osU0FBUyxPQUFPO0FBQ1osY0FBUSxLQUFLLHdDQUF3QyxLQUFLO0FBQUEsSUFDOUQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx5QkFBK0I7QUFDbkMsUUFBSTtBQUVBLFlBQU0saUJBQWlCLFNBQVMsaUJBQWlCLHlCQUF5QjtBQUMxRSxxQkFBZSxRQUFRLFFBQU07QUFDekIsV0FBRyxVQUFVLE9BQU8sMkJBQTJCO0FBQUEsTUFDbkQsQ0FBQztBQUdELFdBQUssb0JBQW9CO0FBQUEsSUFDN0IsU0FBUyxPQUFPO0FBQ1osY0FBUSxLQUFLLHVDQUF1QyxLQUFLO0FBQUEsSUFDN0Q7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFXUSxxQkFBcUIsVUFBMEI7QUFDbkQsWUFBUSxVQUFVO0FBQUEsTUFDZCxLQUFLO0FBQVcsZUFBTztBQUFBLE1BQ3ZCLEtBQUs7QUFBVSxlQUFPO0FBQUEsTUFDdEIsS0FBSztBQUFXLGVBQU87QUFBQSxNQUN2QixLQUFLO0FBQVEsZUFBTztBQUFBLE1BQ3BCLEtBQUs7QUFBVSxlQUFPO0FBQUEsTUFDdEI7QUFBUyxlQUFPO0FBQUEsSUFDcEI7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxzQkFBc0IsVUFBa0IsY0FBc0IsbUJBQWtDO0FBQ3BHLFFBQUk7QUFFQSxZQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLGNBQWM7QUFDaEUsVUFBSSxPQUFPLFNBQVMsR0FBRztBQUNuQixjQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsWUFBSSwyQ0FBYSxjQUFjO0FBQzNCLGdCQUFNLG9CQUFvQixLQUFLLHFCQUFxQixVQUFVLGlCQUFpQjtBQUMvRSxnQkFBTSxnQkFBZ0IsYUFBYSxTQUFTLEtBQ3RDLGFBQWEsVUFBVSxHQUFHLEVBQUUsSUFBSSxRQUNoQztBQUVOLGdCQUFNLFVBQVUsVUFBSyxpQkFBaUIsV0FBVyxhQUFhO0FBRzlELHNCQUFZLGFBQWEsa0JBQWtCLFNBQVMsSUFBSTtBQUFBLFFBQzVEO0FBQUEsTUFDSjtBQUFBLElBQ0osU0FBUyxPQUFPO0FBQ1osY0FBUSxLQUFLLHVDQUF1QyxLQUFLO0FBQUEsSUFDN0Q7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxzQkFBc0IsVUFBa0IsY0FBNEI7QUFDeEUsUUFBSTtBQUVBLFlBQU0sU0FBUyxLQUFLLElBQUksVUFBVSxnQkFBZ0IsY0FBYztBQUNoRSxVQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ25CLGNBQU0sY0FBYyxPQUFPLENBQUMsRUFBRTtBQUM5QixZQUFJLDJDQUFhLGNBQWM7QUFDM0IsZ0JBQU0sYUFBYSxLQUFLLHFCQUFxQixRQUFRO0FBQ3JELGdCQUFNLFVBQVUsb0JBQWUsV0FBVyxRQUFRLE1BQU0sRUFBRSxDQUFDLFVBQVUsWUFBWTtBQUdqRixzQkFBWSxhQUFhLGdCQUFnQixTQUFTLElBQUk7QUFBQSxRQUMxRDtBQUFBLE1BQ0o7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUNaLGNBQVEsS0FBSyxxQ0FBcUMsS0FBSztBQUFBLElBQzNEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EscUJBQXFCLFVBQWtCLG1CQUFvQztBQUMvRSxZQUFRLFVBQVU7QUFBQSxNQUNkLEtBQUs7QUFBVyxlQUFPO0FBQUEsTUFDdkIsS0FBSztBQUFVLGVBQU87QUFBQSxNQUN0QixLQUFLO0FBQVcsZUFBTztBQUFBLE1BQ3ZCLEtBQUs7QUFBUSxlQUFPLG1CQUFtQixxQkFBcUIsUUFBUTtBQUFBLE1BQ3BFLEtBQUs7QUFBVSxlQUFPLFlBQVksaUJBQWlCO0FBQUEsTUFDbkQ7QUFBUyxlQUFPO0FBQUEsSUFDcEI7QUFBQSxFQUNKO0FBQ0o7OztBWGpYTyxJQUFNLHlCQUF5QjtBQUUvQixJQUFNLG1CQUFOLE1BQU0seUJBQXdCLDJCQUFTO0FBQUEsRUFtRTdDLFlBQVksTUFBcUIsUUFBb0I7QUFDcEQsVUFBTSxJQUFJO0FBaEVYLFNBQVEsY0FBNEI7QUFDcEMsU0FBUSxpQkFBeUM7QUFDakQsU0FBUSxvQkFBK0MsQ0FBQztBQUd4RDtBQUFBLFNBQVEsMkJBQTBDO0FBR2xEO0FBQUEsU0FBUSxnQ0FBeUM7QUFnQmpEO0FBQUEsU0FBUSxzQkFBNkIsQ0FBQztBQUd0QyxTQUFRLHdCQUFnQztBQUd4QyxTQUFRLHdCQUFpQztBQWN6QztBQUFBLFNBQVEsNEJBQW1EO0FBRzNEO0FBQUEsU0FBUSxlQUF3QjtBQUNoQyxTQUFRLDRCQUFrRDtBQUkxRDtBQUFBLFNBQVEsZ0NBQXVEO0FBUS9EO0FBQUEsU0FBUSx5QkFBK0YsQ0FBQztBQUN4RyxTQUFRLFdBQTZCLENBQUM7QUFJckMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBO0FBQUEsRUEvQ0EsSUFBWSxXQUFXO0FBeEN4QjtBQXdDMEIsWUFBTyxVQUFLLGlCQUFMLG1CQUFtQjtBQUFBLEVBQWU7QUFBQSxFQUNsRSxJQUFZLHVCQUF1QjtBQUFFLFdBQU8sS0FBSyxlQUFlLEVBQUUsU0FBUyxNQUFNO0FBQUEsSUFBQyxFQUFFLElBQUk7QUFBQSxFQUFNO0FBQUEsRUFDOUYsSUFBWSxtQkFBbUI7QUFBRSxXQUFPLE1BQU07QUFBQSxJQUFDO0FBQUEsRUFBRztBQUFBLEVBSWxELElBQVkscUJBQXFCO0FBQUUsV0FBTyxLQUFLO0FBQUEsRUFBcUI7QUFBQSxFQUNwRSxJQUFZLG1CQUFtQixPQUFjO0FBQUUsU0FBSyxzQkFBc0I7QUFBQSxFQUFPO0FBQUEsRUFFakYsSUFBWSx1QkFBdUI7QUFBRSxXQUFPLEtBQUs7QUFBQSxFQUF1QjtBQUFBLEVBQ3hFLElBQVkscUJBQXFCLE9BQWU7QUFBRSxTQUFLLHdCQUF3QjtBQUFBLEVBQU87QUFBQSxFQUV0RixJQUFZLHVCQUF1QjtBQUFFLFdBQU8sS0FBSztBQUFBLEVBQXVCO0FBQUEsRUFDeEUsSUFBWSxxQkFBcUIsT0FBZ0I7QUFBRSxTQUFLLHdCQUF3QjtBQUFBLEVBQU87QUFBQTtBQUFBLEVBR3ZGLElBQVksaUJBQWlCO0FBeEQ5QjtBQXdEZ0MsWUFBTyxVQUFLLG1CQUFMLG1CQUFxQjtBQUFBLEVBQWdCO0FBQUEsRUFDM0UsSUFBWSxtQkFBbUI7QUF6RGhDO0FBeURrQyxZQUFPLFVBQUssbUJBQUwsbUJBQXFCO0FBQUEsRUFBa0I7QUFBQSxFQWdDL0UsY0FBYztBQUNiLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxpQkFBaUI7QUFDaEIsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLFVBQVU7QUFDVCxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNUSxzQkFBNEI7QUFFbkMsU0FBSyxnQkFBZ0I7QUFFckIsU0FBSyxlQUFlO0FBQUEsRUFDckI7QUFBQSxFQUVBLE1BQU0sU0FBUztBQUNkLFVBQU0sWUFBWSxLQUFLLFlBQVksU0FBUyxDQUFDO0FBQzdDLGNBQVUsTUFBTTtBQUNoQixjQUFVLFNBQVMsd0JBQXdCO0FBRzNDLFFBQUksMkJBQVMsVUFBVTtBQUN0QixnQkFBVSxTQUFTLFdBQVc7QUFBQSxJQUMvQixPQUFPO0FBQ04sZ0JBQVUsU0FBUyxZQUFZO0FBQUEsSUFDaEM7QUFLQSxVQUFNLFlBQVksVUFBVSxVQUFVLEVBQUUsS0FBSyxlQUFlLENBQUM7QUFDN0QsY0FBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHFCQUtQLDJCQUFTLGVBQWUsb0JBQW9CLGlCQUFpQjtBQUFBO0FBSWhGLFVBQU0sV0FBVyxVQUFVLFVBQVUsRUFBRSxLQUFLLGNBQWMsQ0FBQztBQUMzRCxhQUFTLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVN6QixVQUFNLFdBQVcsU0FBUyxVQUFVO0FBQ3BDLGFBQVMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPekIsVUFBTSxVQUFVLFNBQVMsU0FBUyxJQUFJO0FBQ3RDLFlBQVEsTUFBTSxVQUFVO0FBQ3hCLFlBQVEsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBYXBCLFVBQU0saUJBQWlCLFNBQVMsVUFBVTtBQUMxQyxtQkFBZSxNQUFNLFVBQVU7QUFHL0IsVUFBTSxtQkFBbUIsZUFBZSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUNuRixTQUFLLHVCQUF1QixnQkFBZ0I7QUFHNUMsSUFBQyxLQUFhLG1CQUFtQjtBQUdqQyxVQUFNLEtBQUssdUJBQXVCLGNBQWM7QUFHaEQsVUFBTSxjQUFjLElBQUksa0NBQWdCLGNBQWM7QUFDdEQsZ0JBQVksUUFBUSxRQUFRLEVBQzFCLFdBQVcsNEJBQTRCLEVBQ3ZDLFFBQVEsTUFBTSxLQUFLLFVBQVUsQ0FBQztBQUdoQyxVQUFNLFdBQVcsMkJBQVM7QUFDMUIsZ0JBQVksU0FBUyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBS3pCLFdBQVcsYUFBYSxTQUFTO0FBQUE7QUFBQTtBQUFBO0FBQUEsZ0JBSS9CLFdBQVcsU0FBUyxNQUFNO0FBQUEsaUJBQ3pCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNekMsU0FBSyxvQkFBb0IsU0FBUztBQUNsQyxTQUFLLHFCQUFxQixTQUFTO0FBR25DLFNBQUs7QUFBQSxNQUNKLEtBQUssSUFBSSxVQUFVLEdBQUcsc0JBQXNCLE1BQU07QUFDakQsYUFBSyw4QkFBOEI7QUFBQSxNQUNwQyxDQUFDO0FBQUEsSUFDRjtBQUdBLFNBQUs7QUFBQSxNQUNKLEtBQUssSUFBSSxVQUFVLEdBQUcsaUJBQWlCLENBQUMsV0FBVztBQUNsRCxhQUFLLG9CQUFvQixNQUFNO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQ0Y7QUFHQSxTQUFLLHdCQUF3QjtBQUc3QixTQUFLLDhCQUE4QjtBQUduQyxRQUFJLEtBQUssT0FBTyxzQkFBc0I7QUFDckMsV0FBSyxPQUFPLHFCQUFxQixzQkFBc0IsTUFBTSxLQUFLLG9CQUFvQixDQUFDO0FBQUEsSUFDeEY7QUFHQSxTQUFLLGdDQUFnQztBQUNyQyxVQUFNLEtBQUssc0JBQXNCO0FBQUEsRUFHbEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUFvQixRQUFhO0FBQ3hDLFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBQ3BELFFBQUksQ0FBQyxjQUFjLENBQUMsUUFBUTtBQUMzQjtBQUFBLElBQ0Q7QUFHQSxRQUFJLEtBQUssZUFBZSxXQUFXLFNBQVMsS0FBSyxZQUFZLE1BQU07QUFDbEUsWUFBTSxZQUFZLE9BQU8sVUFBVTtBQUNuQyxVQUFJLFdBQVc7QUFDZCxhQUFLLDRCQUE0QjtBQUFBLE1BQ2xDO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHdCQUE4QjtBQUNyQyxRQUFJLEtBQUssMkJBQTJCO0FBRW5DLFlBQU0sU0FBUyxLQUFLLE9BQU8sZUFBZSxnQkFBZ0I7QUFDMUQsVUFBSSxRQUFRO0FBQ1gsZUFBTyxVQUFVLEtBQUsseUJBQXlCO0FBQUEsTUFDaEQ7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMEJBQWdDO0FBcFJ6QztBQXVSRSxVQUFNLGdCQUFlLGdCQUFLLGlCQUFMLG1CQUFtQixrQkFBbkIsbUJBQWtDO0FBQ3ZELFFBQUksY0FBYztBQUNqQixXQUFLLGlCQUFpQixjQUFjLFNBQVMsTUFBTTtBQUNsRCxhQUFLLGdCQUFnQjtBQUFBLE1BQ3RCLENBQUM7QUFBQSxJQUNGO0FBR0EsU0FBSyxpQkFBaUIsS0FBSyxhQUFhLGFBQWEsTUFBTTtBQUUxRCxpQkFBVyxNQUFNO0FBQ2hCLGFBQUssZ0JBQWdCO0FBQUEsTUFDdEIsR0FBRyxFQUFFO0FBQUEsSUFDTixDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRUEsTUFBTSxVQUFVO0FBdlNqQjtBQXlTRSxTQUFLLFVBQWEsNEJBQWIsbUJBQXNDLFNBQVM7QUFDbkQsTUFBQyxLQUFhLHdCQUF3QixRQUFRO0FBQUEsSUFDL0M7QUFHQSxRQUFJLEtBQUssc0JBQXNCO0FBQzlCLFdBQUsscUJBQXFCLFFBQVE7QUFBQSxJQUNuQztBQUdBLFFBQUksS0FBSywrQkFBK0I7QUFDdkMsbUJBQWEsS0FBSyw2QkFBNkI7QUFDL0MsV0FBSyxnQ0FBZ0M7QUFBQSxJQUN0QztBQUdBLFNBQUssc0JBQXNCO0FBRzNCLFNBQUssY0FBYztBQUduQixTQUFLLG1CQUFtQjtBQUFBLEVBQ3pCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx3QkFBd0IsU0FBc0IsT0FBZSxTQUE4QjtBQUNsRyxZQUFRLGlCQUFpQixPQUFPLE9BQU87QUFDdkMsU0FBSyx1QkFBdUIsS0FBSyxFQUFFLFNBQVMsT0FBTyxRQUFRLENBQUM7QUFBQSxFQUM3RDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esa0JBQWtCLFVBQXNCLE9BQStCO0FBQzlFLFVBQU0sS0FBSyxXQUFXLE1BQU07QUFDM0IsZUFBUztBQUNULFdBQUssV0FBVyxLQUFLLFNBQVMsT0FBTyxPQUFLLE1BQU0sRUFBRTtBQUFBLElBQ25ELEdBQUcsS0FBSztBQUNSLFNBQUssU0FBUyxLQUFLLEVBQUU7QUFDckIsV0FBTztBQUFBLEVBQ1I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHdCQUE4QjtBQUNyQyxTQUFLLHVCQUF1QixRQUFRLENBQUMsRUFBRSxTQUFTLE9BQU8sUUFBUSxNQUFNO0FBQ3BFLGNBQVEsb0JBQW9CLE9BQU8sT0FBTztBQUFBLElBQzNDLENBQUM7QUFDRCxTQUFLLHlCQUF5QixDQUFDO0FBRy9CLFFBQUksS0FBSywyQkFBMkI7QUFDbkMsZUFBUyxvQkFBb0IsU0FBUyxLQUFLLHlCQUF5QjtBQUNwRSxXQUFLLDRCQUE0QjtBQUFBLElBQ2xDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQXNCO0FBQzdCLFNBQUssU0FBUyxRQUFRLFFBQU0sYUFBYSxFQUFFLENBQUM7QUFDNUMsU0FBSyxXQUFXLENBQUM7QUFBQSxFQUNsQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EscUJBQTJCO0FBQUEsRUFFbkM7QUFBQSxFQUVRLG9CQUFvQixXQUF3QjtBQUNuRCxTQUFLLGdCQUFnQixVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ3ZFLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBV25DLFNBQUssZUFBZSxJQUFJLGFBQWEsS0FBSyxRQUFRLEtBQUssYUFBYTtBQUdwRSxTQUFLLGtCQUFrQjtBQUFBLEVBQ3hCO0FBQUEsRUFFUSxxQkFBcUIsV0FBd0I7QUFDcEQsU0FBSyxpQkFBaUIsVUFBVSxVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUN6RSxTQUFLLGdCQUFnQjtBQUFBLEVBQ3RCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxrQkFBa0I7QUFFekIsU0FBSyxlQUFlLE1BQU07QUFHMUIsU0FBSyxpQkFBaUIsSUFBSSxlQUFlLEtBQUssUUFBUSxLQUFLLEtBQUssS0FBSyxjQUFjO0FBQ25GLFNBQUssbUJBQW1CLElBQUksaUJBQWlCO0FBRzdDLFNBQUssdUJBQXVCLEtBQUssT0FBTztBQUd4QyxTQUFLLGVBQWUsSUFBSSxhQUFhLEtBQUssUUFBUSxLQUFLLGdCQUFnQixLQUFLLGNBQWM7QUFHMUYsU0FBSyxhQUFhLGVBQWUsSUFBSTtBQUNyQyxTQUFLLGVBQWUsZUFBZSxJQUFJO0FBR3ZDLFNBQUssYUFBYSxxQkFBcUIsS0FBSyxhQUFhO0FBR3pELFNBQUssZ0JBQWdCLElBQUksY0FBYyxLQUFLLFFBQVEsS0FBSyxnQkFBZ0IsS0FBSyxhQUFhLFlBQVksQ0FBQztBQUd4RyxTQUFLLGFBQWEsaUJBQWlCLEtBQUssYUFBYTtBQUdyRCxTQUFLLGFBQWEsaUJBQWlCLENBQUMsWUFBb0I7QUFDdkQsV0FBSyxXQUFXLE9BQU87QUFBQSxJQUN4QixDQUFDO0FBR0QsU0FBSyxlQUFlLHVCQUF1QjtBQUFBLEVBRTVDO0FBQUEsRUFFUSxXQUFXLE1BQXVDLFNBQWlCO0FBQzFFLFVBQU0sWUFBWSxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssNkJBQTZCLElBQUksR0FBRyxDQUFDO0FBQzNGLGNBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUt2QixTQUFTLFNBQ1IsNEZBQ0EsU0FBUyxXQUNULGtKQUNBLDZGQUNIO0FBQUE7QUFHRCxVQUFNLFNBQVMsVUFBVSxTQUFTLE9BQU87QUFBQSxNQUN4QyxNQUFNLFNBQVMsU0FBUyxRQUFRLFNBQVMsV0FBVyxXQUFXO0FBQUEsTUFDL0QsS0FBSztBQUFBLElBQ04sQ0FBQztBQUNELFdBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU92QixVQUFNLFlBQVksVUFBVSxTQUFTLE9BQU8sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRTNFLFFBQUksU0FBUyxZQUFZLFFBQVEsU0FBUyxNQUFNLEdBQUc7QUFDbEQsZ0JBQVUsWUFBWTtBQUFBLElBQ3ZCLE9BQU87QUFDTixnQkFBVSxjQUFjO0FBQUEsSUFDekI7QUFHQSxlQUFXLE1BQU07QUFDaEIsV0FBSyxjQUFjLFNBQVM7QUFBQSxRQUMzQixLQUFLLEtBQUssY0FBYztBQUFBLFFBQ3hCLFVBQVU7QUFBQSxNQUNYLENBQUM7QUFBQSxJQUNGLEdBQUcsaUJBQWdCLGVBQWU7QUFBQSxFQUNuQztBQUFBO0FBQUEsRUFHUSxrQkFBa0IsU0FBdUI7QUFDaEQsU0FBSyxhQUFhLGtCQUFrQixTQUFTLElBQUk7QUFBQSxFQUNsRDtBQUFBLEVBRVEsZ0JBQWdCLFNBQXVCO0FBQzlDLFNBQUssYUFBYSxnQkFBZ0IsU0FBUyxJQUFJO0FBQUEsRUFDaEQ7QUFBQSxFQUVRLGtCQUFrQixTQUF3QjtBQUNqRCxTQUFLLGFBQWEsa0JBQWtCLE9BQU87QUFBQSxFQUM1QztBQUFBLEVBRVEsb0JBQW9CLFFBQWdCO0FBRTNDLFVBQU0sV0FBVztBQUFBLE1BQ2hCLE9BQU87QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLFVBQVU7QUFBQSxNQUNWLFdBQVc7QUFBQSxNQUNYLFdBQVc7QUFBQSxJQUNaO0FBRUEsVUFBTSxVQUFVLFNBQVMsTUFBK0IsS0FBSztBQUM3RCxTQUFLLGtCQUFrQixPQUFPO0FBQUEsRUFDL0I7QUFBQSxFQUVRLGtCQUFrQixRQUFnQixPQUFnQjtBQUV6RCxVQUFNLFdBQVc7QUFBQSxNQUNoQixPQUFPO0FBQUEsTUFDUCxRQUFRO0FBQUEsTUFDUixVQUFVO0FBQUEsTUFDVixXQUFXO0FBQUEsTUFDWCxXQUFXO0FBQUEsTUFDWCxXQUFXO0FBQUEsSUFDWjtBQUVBLFFBQUksVUFBVSxTQUFTLE1BQStCLEtBQUs7QUFDM0QsUUFBSSxPQUFPO0FBQ1YsaUJBQVcsS0FBSyxLQUFLO0FBQUEsSUFDdEI7QUFDQSxTQUFLLGdCQUFnQixPQUFPO0FBQUEsRUFDN0I7QUFBQSxFQUVBLE1BQWMsbUJBQW1CLFNBQW1DO0FBN2dCckU7QUErZ0JFLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQzdELFdBQUssZ0JBQWdCLDZHQUE2RztBQUNsSSxhQUFPO0FBQUEsSUFDUjtBQUVBLFVBQU0sVUFBVSxRQUFRLE1BQU0sQ0FBQyxFQUFFLFlBQVk7QUFHN0MsVUFBTSxtQkFBMkM7QUFBQSxNQUNoRCxVQUFVO0FBQUEsTUFDVixXQUFXO0FBQUEsTUFDWCxVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsTUFDVixVQUFVO0FBQUEsSUFDWDtBQUVBLFFBQUksaUJBQWlCLE9BQU8sR0FBRztBQUM5QixZQUFNLGFBQWEsaUJBQWlCLE9BQU87QUFDM0MsWUFBTSxLQUFLLE9BQU8sV0FBVyxnQkFBZ0IsVUFBVTtBQUN2RCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLFdBQUssa0JBQWtCLHNCQUFpQixLQUFLLGdDQUFnQyxVQUFVLENBQUMsRUFBRTtBQUMxRixhQUFPO0FBQUEsSUFDUjtBQUdBLFFBQUksS0FBSyxPQUFPLGVBQWUsaUJBQWlCLFVBQVUsR0FBRztBQUM1RCxZQUFNLGlCQUFnQixVQUFLLE9BQU8sU0FBUyxtQkFBckIsbUJBQXFDLEtBQUssU0FBTyxJQUFJLFlBQVk7QUFDdkYsVUFBSSxlQUFlO0FBRWxCLGFBQUssYUFBYSxZQUFZLEVBQUUsU0FBUyxjQUFjLFFBQVE7QUFFOUQsbUJBQVcsTUFBTSxLQUFLLGlCQUFpQixHQUFHLENBQUM7QUFDNUMsYUFBSyxrQkFBa0IsMkJBQXNCLGNBQWMsSUFBSSxFQUFFO0FBQ2pFLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUdBLFNBQUssZ0JBQWdCLDRCQUF1QixPQUFPLCtDQUErQztBQUNsRyxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRVEsc0JBQTRCO0FBQ25DLFNBQUssZ0JBQWdCLEtBQUssZUFBZSxVQUFVLEVBQUUsS0FBSyxzQ0FBc0MsQ0FBQztBQUNqRyxTQUFLLGNBQWMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFhcEM7QUFBQSxFQUVRLG9CQUEwQjtBQUNqQyxVQUFNLFFBQVEsS0FBSyxhQUFhLFlBQVksRUFBRSxTQUFTO0FBRXZELFFBQUksTUFBTSxXQUFXLEdBQUcsS0FBSyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQ3JGLFlBQU0sUUFBUSxNQUFNLE1BQU0sQ0FBQyxFQUFFLFlBQVk7QUFDekMsV0FBSyxrQkFBa0IsS0FBSztBQUFBLElBQzdCLE9BQU87QUFDTixXQUFLLGtCQUFrQjtBQUFBLElBQ3hCO0FBQUEsRUFDRDtBQUFBLEVBRVEsa0JBQWtCLE9BQXFCO0FBQzlDLFVBQU0sV0FBVyxLQUFLLHFCQUFxQixFQUFFO0FBQUEsTUFBTyxTQUNuRCxJQUFJLFFBQVEsWUFBWSxFQUFFLFNBQVMsS0FBSyxLQUFLLElBQUksS0FBSyxZQUFZLEVBQUUsU0FBUyxLQUFLO0FBQUEsSUFDbkY7QUFFQSxTQUFLLGNBQWMsTUFBTTtBQUN6QixTQUFLLHFCQUFxQixDQUFDO0FBQzNCLFNBQUssdUJBQXVCO0FBRTVCLFFBQUksU0FBUyxXQUFXLEdBQUc7QUFDMUIsV0FBSyxrQkFBa0I7QUFDdkI7QUFBQSxJQUNEO0FBRUEsYUFBUyxRQUFRLENBQUMsU0FBUyxVQUFVO0FBQ3BDLFlBQU0sT0FBTyxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssb0NBQW9DLENBQUM7QUFFdEYsWUFBTSxZQUFZLEtBQUssV0FBVyxFQUFFLEtBQUssMENBQTBDLENBQUM7QUFDcEYsZ0JBQVUsY0FBYyxJQUFJLFFBQVEsT0FBTztBQUUzQyxZQUFNLFNBQVMsS0FBSyxXQUFXLEVBQUUsS0FBSyxvQ0FBb0MsQ0FBQztBQUMzRSxhQUFPLGNBQWMsUUFBUTtBQUM3QixhQUFPLE1BQU0sVUFBVTtBQUV2QixVQUFJLFFBQVEsYUFBYTtBQUN4QixjQUFNLFNBQVMsS0FBSyxXQUFXLEVBQUUsS0FBSyxxQ0FBcUMsQ0FBQztBQUM1RSxlQUFPLGNBQWMsUUFBUTtBQUFBLE1BQzlCO0FBRUEsV0FBSyxpQkFBaUIsU0FBUyxNQUFNO0FBQ3BDLGFBQUssY0FBYyxRQUFRLE9BQU87QUFBQSxNQUNuQyxDQUFDO0FBRUQsV0FBSyxpQkFBaUIsY0FBYyxNQUFNO0FBQ3pDLGFBQUssbUJBQW1CLEtBQUs7QUFBQSxNQUM5QixDQUFDO0FBRUQsV0FBSyxtQkFBbUIsS0FBSyxJQUFJO0FBQUEsSUFDbEMsQ0FBQztBQUVELFNBQUssY0FBYyxNQUFNLFVBQVU7QUFBQSxFQUNwQztBQUFBLEVBRVEsb0JBQTBCO0FBQ2pDLFNBQUssY0FBYyxNQUFNLFVBQVU7QUFDbkMsU0FBSyx1QkFBdUI7QUFBQSxFQUM3QjtBQUFBLEVBRVEseUJBQWtDO0FBQ3pDLFdBQU8sS0FBSyxjQUFjLE1BQU0sWUFBWTtBQUFBLEVBQzdDO0FBQUEsRUFFUSxzQkFBc0IsV0FBeUI7QUFDdEQsUUFBSSxLQUFLLG1CQUFtQixXQUFXLEVBQUc7QUFFMUMsVUFBTSxXQUFXLEtBQUssSUFBSSxHQUFHLEtBQUs7QUFBQSxNQUNqQyxLQUFLLG1CQUFtQixTQUFTO0FBQUEsTUFDakMsS0FBSyx1QkFBdUI7QUFBQSxJQUM3QixDQUFDO0FBRUQsU0FBSyxtQkFBbUIsUUFBUTtBQUFBLEVBQ2pDO0FBQUEsRUFFUSxtQkFBbUIsT0FBcUI7QUFFL0MsU0FBSyxtQkFBbUIsUUFBUSxVQUFRO0FBQ3ZDLFdBQUssWUFBWSxVQUFVO0FBQUEsSUFDNUIsQ0FBQztBQUVELFNBQUssdUJBQXVCO0FBRTVCLFFBQUksU0FBUyxLQUFLLFFBQVEsS0FBSyxtQkFBbUIsUUFBUTtBQUN6RCxXQUFLLG1CQUFtQixLQUFLLEVBQUUsU0FBUyxVQUFVO0FBQ2xELFdBQUssbUJBQW1CLEtBQUssRUFBRSxlQUFlLEVBQUUsT0FBTyxVQUFVLENBQUM7QUFBQSxJQUNuRTtBQUFBLEVBQ0Q7QUFBQSxFQUVRLCtCQUF3QztBQUMvQyxRQUFJLENBQUMsS0FBSyx1QkFBdUIsS0FBSyxLQUFLLHlCQUF5QixJQUFJO0FBQ3ZFLGFBQU87QUFBQSxJQUNSO0FBRUEsVUFBTSxXQUFXLEtBQUsscUJBQXFCO0FBQzNDLFVBQU0sa0JBQWtCLFNBQVMsS0FBSyxvQkFBb0I7QUFFMUQsUUFBSSxpQkFBaUI7QUFDcEIsV0FBSyxjQUFjLGdCQUFnQixPQUFPO0FBQzFDLGFBQU87QUFBQSxJQUNSO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVRLGNBQWMsU0FBdUI7QUFDNUMsU0FBSyxhQUFhLFlBQVksRUFBRSxTQUFTLElBQUksT0FBTyxFQUFFO0FBQ3RELFNBQUssa0JBQWtCO0FBRXZCLFNBQUssV0FBVztBQUFBLEVBQ2pCO0FBQUEsRUFFUSx1QkFBcUY7QUExckI5RjtBQTJyQkUsVUFBTSxXQUF5RSxDQUFDO0FBR2hGLFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxvQkFBb0IsOEJBQVk7QUFDdEUsVUFBTSxnQkFBZSw4Q0FBWSxXQUFaLG1CQUFvQjtBQUd6QyxRQUFJLGdCQUFnQixhQUFhLEtBQUssRUFBRSxTQUFTLEdBQUc7QUFDbkQsd0JBQWtCLFFBQVEsWUFBVTtBQUNuQyxpQkFBUyxLQUFLO0FBQUEsVUFDYixTQUFTLE9BQU87QUFBQSxVQUNoQixNQUFNLFNBQVMsT0FBTyxLQUFLO0FBQUEsVUFDM0IsYUFBYSxPQUFPO0FBQUEsUUFDckIsQ0FBQztBQUFBLE1BQ0YsQ0FBQztBQUdELGVBQVMsS0FBSyxFQUFFLFNBQVMsT0FBTyxNQUFNLGtGQUFpQixhQUFhLG9CQUFvQixDQUFDO0FBQUEsSUFDMUY7QUFHQSxhQUFTO0FBQUEsTUFDUixFQUFFLFNBQVMsVUFBVSxNQUFNLG9CQUFvQixhQUFhLHNCQUFzQjtBQUFBLE1BQ2xGLEVBQUUsU0FBUyxXQUFXLE1BQU0scUJBQXFCLGFBQWEsb0JBQW9CO0FBQUEsTUFDbEYsRUFBRSxTQUFTLFVBQVUsTUFBTSxvQkFBb0IsYUFBYSxtQkFBbUI7QUFBQSxJQUNoRjtBQUdBLFFBQUksMkJBQVMsY0FBYztBQUMxQixlQUFTLEtBQUssRUFBRSxTQUFTLFVBQVUsTUFBTSxvQkFBb0IsYUFBYSxrQkFBa0IsQ0FBQztBQUFBLElBQzlGO0FBR0EsUUFBSSxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsVUFBVSxHQUFHO0FBQzVELFlBQU0saUJBQWlCLEtBQUssT0FBTyxTQUFTLGtCQUFrQixDQUFDO0FBQy9ELFVBQUksZUFBZSxTQUFTLEdBQUc7QUFDOUIsaUJBQVMsS0FBSyxFQUFFLFNBQVMsT0FBTyxNQUFNLGtGQUFpQixhQUFhLGtCQUFrQixDQUFDO0FBQ3ZGLHVCQUFlLFFBQVEsU0FBTztBQUM3QixtQkFBUyxLQUFLO0FBQUEsWUFDYixTQUFTLElBQUk7QUFBQSxZQUNiLE1BQU0sSUFBSTtBQUFBLFlBQ1YsR0FBSSxJQUFJLGVBQWUsRUFBRSxhQUFhLElBQUksWUFBWTtBQUFBLFVBQ3ZELENBQUM7QUFBQSxRQUNGLENBQUM7QUFBQSxNQUNGO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFUSxvQkFBMEI7QUFDakMsU0FBSyxjQUFjLEtBQUssZUFBZSxVQUFVLEVBQUUsS0FBSyxvQ0FBb0MsQ0FBQztBQUM3RixTQUFLLFlBQVksTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZWpDLFVBQU0sMEJBQXlDLENBQUMsVUFBaUI7QUFDaEUsVUFBSSxDQUFDLEtBQUssWUFBWSxTQUFTLE1BQU0sTUFBYyxLQUNsRCxDQUFDLEtBQUssY0FBYyxTQUFTLFNBQVMsTUFBTSxNQUFjLEdBQUc7QUFDN0QsYUFBSyxnQkFBZ0I7QUFBQSxNQUN0QjtBQUFBLElBQ0Q7QUFDQSxTQUFLLHdCQUF3QixVQUFVLFNBQVMsdUJBQXVCO0FBQUEsRUFDeEU7QUFBQSxFQUVRLG9CQUEwQjtBQUNqQyxRQUFJLENBQUMsS0FBSyxPQUFPLGVBQWUsaUJBQWlCLFVBQVUsR0FBRztBQUM3RCxXQUFLLGdCQUFnQiw2R0FBNkc7QUFDbEk7QUFBQSxJQUNEO0FBRUEsUUFBSSxLQUFLLHNCQUFzQjtBQUM5QixXQUFLLGdCQUFnQjtBQUFBLElBQ3RCLE9BQU87QUFDTixXQUFLLGdCQUFnQjtBQUFBLElBQ3RCO0FBQUEsRUFDRDtBQUFBLEVBRVEsa0JBQXdCO0FBQy9CLFVBQU0sV0FBVyxLQUFLLHFCQUFxQjtBQUUzQyxTQUFLLFlBQVksTUFBTTtBQUd2QixVQUFNLFdBQVcsS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLDZDQUE2QyxDQUFDO0FBQ2pHLGFBQVMsWUFBWSxLQUFLLGlCQUFpQixLQUFLLElBQUk7QUFHcEQsYUFBUyxRQUFRLGFBQVc7QUFFM0IsVUFBSSxRQUFRLFlBQVksT0FBTztBQUM5QixjQUFNLFlBQVksS0FBSyxZQUFZLFVBQVUsRUFBRSxLQUFLLDhCQUE4QixDQUFDO0FBQ25GLGtCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVzFCLGtCQUFVLGNBQWMsUUFBUSxlQUFlO0FBQy9DO0FBQUEsTUFDRDtBQUVBLFlBQU0sT0FBTyxLQUFLLFlBQVksVUFBVSxFQUFFLEtBQUssa0RBQWtELENBQUM7QUFFbEcsWUFBTSxTQUFTLEtBQUssVUFBVSxFQUFFLEtBQUsseUNBQXlDLENBQUM7QUFDL0UsYUFBTyxjQUFjLFFBQVE7QUFFN0IsWUFBTSxZQUFZLEtBQUssVUFBVSxFQUFFLEtBQUssK0NBQStDLENBQUM7QUFDeEYsZ0JBQVUsY0FBYyxJQUFJLFFBQVEsT0FBTztBQUMzQyxnQkFBVSxNQUFNLFVBQVU7QUFFMUIsVUFBSSxRQUFRLGFBQWE7QUFDeEIsY0FBTSxTQUFTLEtBQUssVUFBVSxFQUFFLEtBQUssMENBQTBDLENBQUM7QUFDaEYsZUFBTyxjQUFjLFFBQVE7QUFBQSxNQUM5QjtBQUVBLFdBQUssaUJBQWlCLFNBQVMsTUFBTTtBQUNwQyxhQUFLLHVCQUF1QixRQUFRLE9BQU87QUFBQSxNQUM1QyxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUEsRUFFUSxrQkFBd0I7QUFDL0IsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUNqQyxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUEsRUFFQSxNQUFjLHVCQUF1QixTQUFnQztBQTcwQnRFO0FBODBCRSxTQUFLLGdCQUFnQjtBQUdyQixVQUFNLGtCQUFrQixrQkFBa0IsS0FBSyxZQUFVLE9BQU8sT0FBTyxPQUFPO0FBQzlFLFFBQUksaUJBQWlCO0FBRXBCLFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxvQkFBb0IsOEJBQVk7QUFDdEUsWUFBTSxnQkFBZSw4Q0FBWSxXQUFaLG1CQUFvQjtBQUV6QyxXQUFJLHlDQUFZLFdBQVUsZ0JBQWdCLGFBQWEsS0FBSyxFQUFFLFNBQVMsR0FBRztBQUV6RSxjQUFNLEtBQUsscUJBQXFCLHNCQUFzQixTQUFTLFdBQVcsUUFBUSxZQUFZO0FBQUEsTUFDL0YsT0FBTztBQUNOLFlBQUkseUJBQU8sc0VBQXNFLEdBQUk7QUFBQSxNQUN0RjtBQUNBO0FBQUEsSUFDRDtBQUdBLFFBQUksWUFBWSxPQUFPO0FBQ3RCO0FBQUEsSUFDRDtBQUdBLFNBQUssYUFBYSxZQUFZLEVBQUUsU0FBUyxJQUFJLE9BQU8sRUFBRTtBQUN0RCxTQUFLLFdBQVc7QUFBQSxFQUNqQjtBQUFBLEVBR1EsdUJBQW9DO0FBRTNDLFFBQUksQ0FBQyxLQUFLLE9BQU8sZUFBZSxpQkFBaUIsbUJBQW1CLEdBQUc7QUFFdEUsYUFBTyxTQUFTLGNBQWMsS0FBSztBQUFBLElBQ3BDO0FBR0EsVUFBTSxtQkFBbUIsS0FBSyxlQUFlLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ3RGLHFCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFjakMsVUFBTSxjQUFjLGlCQUFpQixXQUFXLEVBQUUsS0FBSyw0QkFBNEIsQ0FBQztBQUNwRixnQkFBWSxZQUFZLEtBQUssaUJBQWlCLFdBQVcsSUFBSTtBQUM3RCxnQkFBWSxNQUFNLFVBQVU7QUFFNUIsVUFBTSxjQUFjLGlCQUFpQixXQUFXLEVBQUUsS0FBSyw0QkFBNEIsQ0FBQztBQUNwRixnQkFBWSxNQUFNLFVBQVU7QUFFNUIsV0FBTztBQUFBLEVBQ1I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdDQUFzQztBQUM3QyxRQUFJLEtBQUssK0JBQStCO0FBQ3ZDLG1CQUFhLEtBQUssNkJBQTZCO0FBQUEsSUFDaEQ7QUFFQSxTQUFLLGdDQUFnQyxXQUFXLE1BQU07QUFDckQsV0FBSyx5QkFBeUI7QUFDOUIsV0FBSyxnQ0FBZ0M7QUFBQSxJQUN0QyxHQUFHLGlCQUFnQiwyQkFBMkI7QUFBQSxFQUMvQztBQUFBLEVBRVEsMkJBQWlDO0FBMTVCMUM7QUEyNUJFLFFBQUksQ0FBQyxLQUFLLGtCQUFrQixDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUM5RjtBQUFBLElBQ0Q7QUFFQSxVQUFNLFVBQVUsS0FBSyxhQUFhLFlBQVksRUFBRSxTQUFTO0FBQ3pELFFBQUksQ0FBQyxTQUFTO0FBQ2IsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUNwQztBQUFBLElBQ0Q7QUFJQSxVQUFNLGFBQWE7QUFDbkIsVUFBTSxZQUFzRCxDQUFDO0FBQzdELFFBQUk7QUFFSixZQUFRLFFBQVEsV0FBVyxLQUFLLE9BQU8sT0FBTyxNQUFNO0FBQ25ELFlBQU0sVUFBVSxNQUFNLENBQUM7QUFDdkIsWUFBTSxXQUFXLE1BQU0sQ0FBQztBQUd4QixZQUFNLE9BQU8sS0FBSyxlQUFlLE9BQU87QUFDeEMsVUFBSSxNQUFNO0FBQ1Qsa0JBQVUsS0FBSztBQUFBLFVBQ2QsTUFBTTtBQUFBLFVBQ047QUFBQSxRQUNELENBQUM7QUFBQSxNQUNGO0FBQUEsSUFDRDtBQUdBLFVBQU0saUJBQWlCLEtBQUssZUFBZSx1QkFBcUIsVUFBSyxnQkFBTCxtQkFBa0IsU0FBUSxFQUFFO0FBQzVGLG1CQUFlLFFBQVEsU0FBTztBQUU3QixZQUFNLFNBQVMsVUFBVSxLQUFLLFNBQU8sSUFBSSxTQUFTLElBQUksS0FBSyxRQUFRO0FBQ25FLFVBQUksQ0FBQyxRQUFRO0FBQ1osa0JBQVUsS0FBSztBQUFBLFVBQ2QsTUFBTSxJQUFJLEtBQUs7QUFBQSxVQUNmLFVBQVUsSUFBSTtBQUFBLFFBQ2YsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNELENBQUM7QUFHRCxRQUFJLFVBQVUsU0FBUyxHQUFHO0FBQ3pCLFlBQU0sY0FBYyxLQUFLLGVBQWUsY0FBYyw0QkFBNEI7QUFDbEYsVUFBSSxhQUFhO0FBQ2hCLGNBQU0sV0FBVyxVQUFVLElBQUksU0FBTztBQUNyQyxnQkFBTSxTQUFTLElBQUksV0FBVyxJQUFJLElBQUksUUFBUSxLQUFLO0FBQ25ELGlCQUFPLEdBQUcsSUFBSSxJQUFJLEdBQUcsTUFBTTtBQUFBLFFBQzVCLENBQUM7QUFDRCxvQkFBWSxjQUFjLFNBQVMsS0FBSyxJQUFJO0FBQUEsTUFDN0M7QUFDQSxXQUFLLGVBQWUsTUFBTSxVQUFVO0FBQUEsSUFDckMsT0FBTztBQUNOLFdBQUssZUFBZSxNQUFNLFVBQVU7QUFBQSxJQUNyQztBQUFBLEVBQ0Q7QUFBQSxFQUVRLGVBQWUsWUFBa0M7QUFFeEQsUUFBSSxPQUFPLEtBQUssSUFBSSxNQUFNLHNCQUFzQixVQUFVO0FBRTFELFFBQUksQ0FBQyxRQUFRLEVBQUUsZ0JBQWdCLDBCQUFRO0FBRXRDLGFBQU8sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLGFBQWEsS0FBSztBQUFBLElBQy9EO0FBRUEsUUFBSSxDQUFDLFFBQVEsRUFBRSxnQkFBZ0IsMEJBQVE7QUFFdEMsWUFBTSxRQUFRLEtBQUssSUFBSSxNQUFNLGlCQUFpQjtBQUM5QyxhQUFPLE1BQU07QUFBQSxRQUFLLE9BQ2pCLEVBQUUsYUFBYSxjQUNmLEVBQUUsU0FBUyxjQUNYLEVBQUUsS0FBSyxTQUFTLE1BQU0sVUFBVSxLQUNoQyxFQUFFLEtBQUssU0FBUyxNQUFNLGFBQWEsS0FBSztBQUFBLE1BQ3pDLEtBQUs7QUFBQSxJQUNOO0FBRUEsV0FBTyxnQkFBZ0IsMEJBQVEsT0FBTztBQUFBLEVBQ3ZDO0FBQUEsRUFFUSx5QkFBK0I7QUE3K0J4QztBQTgrQkUsUUFBSSxDQUFDLEtBQUssa0JBQWtCO0FBQzNCO0FBQUEsSUFDRDtBQUdBLFVBQU0sZ0JBQWMsZ0JBQUssbUJBQUwsbUJBQXFCLG1CQUFyQixtQkFBcUMsV0FBVTtBQUNuRSxVQUFNLGtCQUFrQixLQUFLLGlCQUFpQixhQUFhLGdCQUFnQjtBQUMzRSxVQUFNLGtCQUFrQixLQUFLLGlCQUFpQixhQUFhLGdCQUFnQjtBQUMzRSxVQUFNLGdCQUFjLFVBQUssZ0JBQUwsbUJBQWtCLFNBQVE7QUFHOUMsUUFBSSxvQkFBb0IsWUFBWSxTQUFTLEtBQzVDLG9CQUFvQixlQUNwQixjQUFjLEdBQUc7QUFDakI7QUFBQSxJQUNEO0FBR0EsUUFBSSxLQUFLLDJCQUEyQjtBQUNuQyxlQUFTLG9CQUFvQixTQUFTLEtBQUsseUJBQXlCO0FBQ3BFLFdBQUssNEJBQTRCO0FBQUEsSUFDbEM7QUFFQSxTQUFLLGlCQUFpQixNQUFNO0FBRTVCLFFBQUksQ0FBQyxLQUFLLGtCQUFrQixDQUFDLEtBQUssZUFBZSxnQkFBZ0I7QUFDaEUsV0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQ3RDLFdBQUssaUJBQWlCLGdCQUFnQixnQkFBZ0I7QUFDdEQsV0FBSyxpQkFBaUIsZ0JBQWdCLGdCQUFnQjtBQUV0RCxVQUFJLEtBQUssY0FBYztBQUN0QixhQUFLLGFBQWEsbUJBQW1CLEtBQUs7QUFBQSxNQUMzQztBQUNBO0FBQUEsSUFDRDtBQUVBLFVBQU0sVUFBVSxLQUFLLGVBQWU7QUFFcEMsUUFBSSxDQUFDLFdBQVcsUUFBUSxXQUFXLEdBQUc7QUFDckMsV0FBSyxpQkFBaUIsTUFBTSxVQUFVO0FBQ3RDLFdBQUssaUJBQWlCLGdCQUFnQixnQkFBZ0I7QUFDdEQsV0FBSyxpQkFBaUIsZ0JBQWdCLGdCQUFnQjtBQUV0RCxVQUFJLEtBQUssY0FBYztBQUN0QixhQUFLLGFBQWEsbUJBQW1CLEtBQUs7QUFBQSxNQUMzQztBQUNBO0FBQUEsSUFDRDtBQUdBLFNBQUssaUJBQWlCLGFBQWEsa0JBQWtCLFFBQVEsT0FBTyxTQUFTLENBQUM7QUFDOUUsU0FBSyxpQkFBaUIsYUFBYSxvQkFBa0IsVUFBSyxnQkFBTCxtQkFBa0IsU0FBUSxFQUFFO0FBR2pGLFFBQUksS0FBSyxjQUFjO0FBQ3RCLFdBQUssYUFBYSxtQkFBbUIsSUFBSTtBQUFBLElBQzFDO0FBR0EsVUFBTSxXQUFXLDJCQUFTO0FBQzFCLFNBQUssaUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQSxjQUcxQixXQUFXLGNBQWMsVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsZ0JBS2pDLFdBQVcsVUFBVSxPQUFPO0FBQUE7QUFBQTtBQUFBO0FBQUEsaUJBSTNCLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFHekMsVUFBTSxZQUFZLEtBQUssaUJBQWlCLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ2pGLGNBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVUxQixVQUFNLGdCQUFnQixVQUFVLFdBQVcsRUFBRSxLQUFLLDRCQUE0QixDQUFDO0FBRS9FLFVBQU0sV0FBVyxRQUFRLE9BQU8sU0FBSTtBQXRrQ3RDLFVBQUFDO0FBc2tDeUMsY0FBQUEsTUFBQSwyQkFBSyxTQUFMLGdCQUFBQSxJQUFXO0FBQUEsS0FBUSxFQUFFLElBQUksU0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFLE1BQU0sR0FBRyxXQUFXLElBQUksQ0FBQztBQUNuSCxVQUFNLFlBQVksUUFBUSxVQUFVLFdBQVcsSUFBSSxLQUFLLEtBQUssUUFBUSxVQUFVLFdBQVcsSUFBSSxFQUFFLEtBQUs7QUFHckcsa0JBQWMsTUFBTSxVQUFVO0FBRzlCLFVBQU0saUJBQWlCLGNBQWMsV0FBVztBQUNoRCxtQkFBZSxNQUFNLFVBQVU7QUFFL0IsVUFBTSxXQUFXLGVBQWUsV0FBVztBQUMzQyxhQUFTLFlBQVksS0FBSyxpQkFBaUIsV0FBVztBQUN0RCxhQUFTLE1BQU0sVUFBVTtBQUV6QixVQUFNLFdBQVcsZUFBZSxXQUFXO0FBQzNDLGFBQVMsY0FBYyxHQUFHLFNBQVMsS0FBSyxJQUFJLENBQUMsR0FBRyxTQUFTO0FBQ3pELGFBQVMsTUFBTSxVQUFVO0FBR3pCLFVBQU0sb0JBQW9CLFVBQVUsV0FBVyxFQUFFLEtBQUssZ0NBQWdDLENBQUM7QUFDdkYsc0JBQWtCLFlBQVksS0FBSyxpQkFBaUIsbUJBQW1CLFdBQVcsU0FBUyxNQUFNO0FBQ2pHLHNCQUFrQixNQUFNLFVBQVU7QUFBQTtBQUFBLGdCQUVwQixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBQUEsY0FFNUIsV0FBVyxRQUFRLEtBQUs7QUFBQSxnQkFDdEIsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXhDLHNCQUFrQixRQUFRLFNBQVMseUJBQXlCO0FBRzVELFFBQUksVUFBVTtBQUNiLGdCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsMEJBQWtCLE1BQU0sYUFBYTtBQUFBLE1BQ3RDLENBQUM7QUFDRCxnQkFBVSxpQkFBaUIsWUFBWSxNQUFNO0FBQzVDLGFBQUssa0JBQWtCLE1BQU07QUFDNUIsNEJBQWtCLE1BQU0sYUFBYTtBQUFBLFFBQ3RDLEdBQUcsaUJBQWdCLGdCQUFnQjtBQUFBLE1BQ3BDLENBQUM7QUFBQSxJQUNGLE9BQU87QUFDTixnQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLDBCQUFrQixNQUFNLGFBQWE7QUFBQSxNQUN0QyxDQUFDO0FBQ0QsZ0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QywwQkFBa0IsTUFBTSxhQUFhO0FBQUEsTUFDdEMsQ0FBQztBQUFBLElBQ0Y7QUFHQSxVQUFNLGFBQWEsS0FBSyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDbkYsZUFBVyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQUlsQixXQUFXLFNBQVMsR0FBRztBQUFBLFlBQ3RCLFdBQVcsU0FBUyxHQUFHO0FBQUE7QUFBQTtBQUFBO0FBQUEsbUJBSWhCLFdBQVcsY0FBYyxVQUFVLGtCQUFrQixXQUFXLFNBQVMsS0FBSztBQUFBO0FBQUE7QUFBQSxpQkFHaEYsV0FBVyxTQUFTLE9BQU87QUFBQTtBQUFBLGdCQUU1QixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBSXhDLFVBQU0sbUJBQW1CLFdBQVcsVUFBVSxFQUFFLEtBQUssK0JBQStCLENBQUM7QUFDckYscUJBQWlCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLGNBSXJCLFdBQVcsY0FBYyxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxpQkFLaEMsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUd6QyxVQUFNLGdCQUFnQixpQkFBaUIsV0FBVztBQUNsRCxrQkFBYyxZQUFZLEtBQUssaUJBQWlCLFdBQVcsSUFBSSxlQUFlLFFBQVEsTUFBTTtBQUM1RixrQkFBYyxNQUFNLFVBQVU7QUFHOUIsVUFBTSx1QkFBdUIsSUFBSSxrQ0FBZ0IsZ0JBQWdCO0FBQ2pFLHlCQUFxQixRQUFRLFNBQVMsRUFDcEMsV0FBVyxrQ0FBa0MsRUFDN0MsUUFBUSxZQUFZO0FBQ3BCLFVBQUksS0FBSyxhQUFhO0FBQ3JCLGFBQUssZUFBZSx1QkFBdUIsS0FBSyxZQUFZLElBQUk7QUFDaEUsY0FBTSxLQUFLLGVBQWU7QUFBQSxNQUMzQjtBQUFBLElBQ0QsQ0FBQztBQUVGLFVBQU0sY0FBYyxxQkFBcUI7QUFDekMsZ0JBQVksU0FBUyw0QkFBNEI7QUFDakQsZ0JBQVksTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxjQUtoQixXQUFXLGFBQWEsU0FBUztBQUFBO0FBQUE7QUFBQTtBQUFBLGdCQUkvQixXQUFXLFNBQVMsTUFBTTtBQUFBLGlCQUN6QixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT3pDLFFBQUksVUFBVTtBQUNiLGtCQUFZLGlCQUFpQixjQUFjLE1BQU07QUFDaEQsb0JBQVksTUFBTSxhQUFhO0FBQy9CLG9CQUFZLE1BQU0sY0FBYztBQUNoQyxvQkFBWSxNQUFNLFFBQVE7QUFBQSxNQUMzQixDQUFDO0FBQ0Qsa0JBQVksaUJBQWlCLFlBQVksTUFBTTtBQUM5QyxtQkFBVyxNQUFNO0FBQ2hCLHNCQUFZLE1BQU0sYUFBYTtBQUMvQixzQkFBWSxNQUFNLGNBQWM7QUFDaEMsc0JBQVksTUFBTSxRQUFRO0FBQUEsUUFDM0IsR0FBRyxpQkFBZ0IsZ0JBQWdCO0FBQUEsTUFDcEMsQ0FBQztBQUFBLElBQ0YsT0FBTztBQUNOLGtCQUFZLGlCQUFpQixjQUFjLE1BQU07QUFDaEQsb0JBQVksTUFBTSxhQUFhO0FBQy9CLG9CQUFZLE1BQU0sY0FBYztBQUNoQyxvQkFBWSxNQUFNLFFBQVE7QUFBQSxNQUMzQixDQUFDO0FBQ0Qsa0JBQVksaUJBQWlCLGNBQWMsTUFBTTtBQUNoRCxvQkFBWSxNQUFNLGFBQWE7QUFDL0Isb0JBQVksTUFBTSxjQUFjO0FBQ2hDLG9CQUFZLE1BQU0sUUFBUTtBQUFBLE1BQzNCLENBQUM7QUFBQSxJQUNGO0FBR0EsVUFBTSxZQUFZLFdBQVcsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFFdkUsWUFBUSxPQUFPLFNBQUk7QUEzdENyQixVQUFBQTtBQTJ0Q3dCLGNBQUFBLE1BQUEsMkJBQUssU0FBTCxnQkFBQUEsSUFBVztBQUFBLEtBQVEsRUFBRSxRQUFRLENBQUMsS0FBSyxVQUFVO0FBQ2xFLFlBQU0sWUFBWSxVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ3RFLGdCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLGVBSWQsV0FBVyxjQUFjLFVBQVU7QUFBQSxxQkFDN0IsUUFBUSxRQUFRLFNBQVMsSUFBSSxnREFBZ0QsTUFBTTtBQUFBO0FBQUEsa0JBRXRGLFdBQVcsU0FBUyxNQUFNO0FBQUE7QUFHekMsWUFBTSxZQUFZLFVBQVUsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDdEUsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBLFdBR2xCLFdBQVcsU0FBUyxLQUFLO0FBQUE7QUFBQTtBQUFBO0FBS2pDLFlBQU0sU0FBUyxVQUFVLFdBQVc7QUFDcEMsYUFBTyxZQUFZLEtBQUssaUJBQWlCLFdBQVc7QUFDcEQsYUFBTyxNQUFNLFVBQVU7QUFFdkIsWUFBTSxTQUFTLFVBQVUsV0FBVyxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDcEUsWUFBTSxTQUFTLElBQUksV0FBVyxJQUFJLElBQUksUUFBUSxLQUFLO0FBQ25ELGFBQU8sY0FBYyxHQUFHLElBQUksS0FBSyxRQUFRLEdBQUcsTUFBTTtBQUNsRCxhQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFZdkIsYUFBTyxRQUFRLFNBQVMsR0FBRyxJQUFJLEtBQUssSUFBSSwwQkFBMEI7QUFHbEUsWUFBTSxhQUFhLFVBQVUsV0FBVyxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDeEUsaUJBQVcsY0FBYztBQUN6QixpQkFBVyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBYzNCLFlBQU0sWUFBWSxVQUFVLFNBQVMsVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDakYsZ0JBQVUsY0FBYztBQUN4QixnQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGFBS2hCLFdBQVcsU0FBUyxNQUFNO0FBQUEsY0FDekIsV0FBVyxTQUFTLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLGlCQUt2QixXQUFXLFNBQVMsTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBS3hDLGdCQUFVLFFBQVEsU0FBUyxVQUFVLElBQUksS0FBSyxRQUFRLEVBQUU7QUFFeEQsZ0JBQVUsaUJBQWlCLFNBQVMsT0FBTyxNQUFhO0FBQ3ZELFVBQUUsZ0JBQWdCO0FBQ2xCLFlBQUksS0FBSyxhQUFhO0FBQ3JCLGVBQUssZUFBZSxvQkFBb0IsS0FBSyxZQUFZLE1BQU0sSUFBSSxLQUFLLElBQUk7QUFDNUUsZ0JBQU0sS0FBSyxlQUFlO0FBQUEsUUFDM0I7QUFBQSxNQUNELENBQUM7QUFHRCxVQUFJLFVBQVU7QUFDYixrQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLG9CQUFVLE1BQU0sYUFBYTtBQUM3QixvQkFBVSxNQUFNLFFBQVE7QUFBQSxRQUN6QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLFlBQVksTUFBTTtBQUM1QyxxQkFBVyxNQUFNO0FBQ2hCLHNCQUFVLE1BQU0sYUFBYTtBQUM3QixzQkFBVSxNQUFNLFFBQVE7QUFBQSxVQUN6QixHQUFHLGlCQUFnQixnQkFBZ0I7QUFBQSxRQUNwQyxDQUFDO0FBR0Qsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFBQSxRQUM5QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLFlBQVksTUFBTTtBQUM1QyxxQkFBVyxNQUFNO0FBQ2hCLHNCQUFVLE1BQU0sYUFBYTtBQUFBLFVBQzlCLEdBQUcsaUJBQWdCLGdCQUFnQjtBQUFBLFFBQ3BDLENBQUM7QUFBQSxNQUNGLE9BQU87QUFDTixrQkFBVSxpQkFBaUIsY0FBYyxNQUFNO0FBQzlDLG9CQUFVLE1BQU0sYUFBYTtBQUM3QixvQkFBVSxNQUFNLFFBQVE7QUFBQSxRQUN6QixDQUFDO0FBRUQsa0JBQVUsaUJBQWlCLGNBQWMsTUFBTTtBQUM5QyxvQkFBVSxNQUFNLGFBQWE7QUFDN0Isb0JBQVUsTUFBTSxRQUFRO0FBQUEsUUFDekIsQ0FBQztBQUVELGtCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsb0JBQVUsTUFBTSxhQUFhO0FBQUEsUUFDOUIsQ0FBQztBQUVELGtCQUFVLGlCQUFpQixjQUFjLE1BQU07QUFDOUMsb0JBQVUsTUFBTSxhQUFhO0FBQUEsUUFDOUIsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLGVBQWU7QUFDcEIsZUFBVyxNQUFNLFVBQVU7QUFLM0IsVUFBTSxpQkFBaUIsQ0FBQyxNQUFrQjtBQUN6QyxRQUFFLGdCQUFnQjtBQUNsQixXQUFLLGVBQWUsQ0FBQyxLQUFLO0FBRTFCLFVBQUksS0FBSyxjQUFjO0FBQ3RCLG1CQUFXLE1BQU0sVUFBVTtBQUMzQixhQUFLLGlCQUFpQixNQUFNLFNBQVM7QUFBQSxNQUN0QyxPQUFPO0FBQ04sbUJBQVcsTUFBTSxVQUFVO0FBQzNCLGFBQUssaUJBQWlCLE1BQU0sU0FBUztBQUFBLE1BQ3RDO0FBQUEsSUFDRDtBQUdBLGNBQVUsaUJBQWlCLFNBQVMsY0FBYztBQUdsRCxTQUFLLDRCQUE0QixDQUFDLE1BQWE7QUFDOUMsVUFBSSxLQUFLLGdCQUFnQixDQUFDLEtBQUssaUJBQWlCLFNBQVMsRUFBRSxNQUFjLEdBQUc7QUFDM0UsYUFBSyxlQUFlO0FBQ3BCLG1CQUFXLE1BQU0sVUFBVTtBQUMzQixhQUFLLGlCQUFpQixNQUFNLFNBQVM7QUFBQSxNQUN0QztBQUFBLElBQ0Q7QUFHQSxhQUFTLGlCQUFpQixTQUFTLEtBQUsseUJBQXlCO0FBQUEsRUFDbEU7QUFBQSxFQUVBLE1BQWMsaUJBQWdDO0FBQzdDLFFBQUksS0FBSyxhQUFhO0FBRXJCLFVBQUksS0FBSyxlQUFlLG1CQUFtQixNQUFNLEtBQUssWUFBWSxNQUFNO0FBQ3ZFLGFBQUssZUFBZSxlQUFlLEtBQUssV0FBVztBQUFBLE1BQ3BEO0FBRUEsVUFBSTtBQUdILGFBQUssaUJBQWlCLE1BQU0sS0FBSyxlQUFlLGFBQWEsSUFBSSxLQUFLLFdBQVc7QUFFakYsYUFBSyx1QkFBdUI7QUFDNUIsYUFBSyxtQkFBbUI7QUFBQSxNQUN6QixTQUFTLE9BQU87QUFFZixnQkFBUSxLQUFLLDhCQUE4QixLQUFLO0FBQ2hELGFBQUssaUJBQWlCO0FBQ3RCLGFBQUssdUJBQXVCO0FBQzVCLGFBQUssbUJBQW1CO0FBQUEsTUFDekI7QUFBQSxJQUNELE9BQU87QUFFTixXQUFLLGlCQUFpQjtBQUN0QixXQUFLLGVBQWUsZUFBZSxJQUFJO0FBQ3ZDLFdBQUssdUJBQXVCO0FBQzVCLFdBQUssbUJBQW1CO0FBQUEsSUFDekI7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFjLFdBQVcsU0FBa0I7QUFqNkM1QztBQW02Q0UsVUFBTSxjQUFjLFdBQVcsS0FBSyxhQUFhLFNBQVMsRUFBRSxLQUFLO0FBQ2pFLFFBQUksQ0FBQyxZQUFhO0FBR2xCLFVBQU0sc0JBQXNCLE1BQU0sS0FBSyxPQUFPLGtCQUFrQix1QkFBdUI7QUFDdkYsUUFBSSxDQUFDLHFCQUFxQjtBQUN6QixXQUFLLGdCQUFnQixLQUFLLGtCQUFrQixnQkFBZ0IsK0ZBQStGLENBQUM7QUFDNUo7QUFBQSxJQUNEO0FBR0EsUUFBSSxZQUFZLFdBQVcsR0FBRyxHQUFHO0FBQ2hDLFlBQU0sZ0JBQWdCLE1BQU0sS0FBSyxtQkFBbUIsV0FBVztBQUMvRCxVQUFJLGVBQWU7QUFDbEIsYUFBSyxhQUFhLFNBQVMsRUFBRTtBQUM3QjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBR0EsUUFBSSxtQkFBbUI7QUFDdkIsUUFBSSxrQkFBMEM7QUFFOUMsUUFBSSxLQUFLLGFBQWE7QUFFckIsVUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixtQkFBbUIsR0FBRztBQUN0RSxZQUFJLFlBQVksU0FBUyxJQUFJLEdBQUc7QUFDL0IsZUFBSyxnQkFBZ0IsdUhBQXVIO0FBQzVJO0FBQUEsUUFDRDtBQUFBLE1BQ0QsT0FBTztBQUVOLGNBQU0sVUFBVSxNQUFNLEtBQUssZUFBZSxhQUFhLGFBQWEsS0FBSyxXQUFXO0FBQ3BGLGNBQU0sZ0JBQWdCLFVBQVUsRUFBRSxnQkFBZ0IsSUFBSSxRQUFRLElBQUk7QUFDbEUsNEJBQW1CLCtDQUFlLG1CQUFrQjtBQUNwRCwyQkFBa0IsK0NBQWUsWUFBVztBQUM1QyxhQUFLLGlCQUFpQjtBQUd0QixhQUFLLHVCQUF1QjtBQUk1QixjQUFNLDRCQUEwQixnQkFBSyxtQkFBTCxtQkFBcUIsbUJBQXJCLG1CQUFxQyxXQUFVO0FBQy9FLGNBQU0sMkJBQXlCLHdEQUFpQixtQkFBakIsbUJBQWlDLFdBQVU7QUFDMUUsY0FBTSxhQUFhLHlCQUF5QjtBQUM1QyxjQUFNLHVCQUF1QixpQkFBaUIsS0FBSyxFQUFFLFdBQVcsS0FBSztBQUVyRSxZQUFJLHNCQUFzQjtBQUV6QixnQkFBTSxlQUFlLHlCQUF5QjtBQUM5QyxjQUFJLGVBQWUsTUFBSyxtREFBaUIsbUJBQWtCLGdCQUFnQixlQUFlLFNBQVMsR0FBRztBQUVyRyxrQkFBTSxVQUFVLGdCQUFnQixlQUFlLE1BQU0sQ0FBQyxZQUFZO0FBQ2xFLGtCQUFNLFdBQVcsUUFBUSxPQUFPLFNBQUk7QUF6OUMxQyxrQkFBQUE7QUF5OUM2QyxzQkFBQUEsTUFBQSwyQkFBSyxTQUFMLGdCQUFBQSxJQUFXO0FBQUEsYUFBUSxFQUFFLElBQUksU0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFLEtBQUssSUFBSTtBQUNuRyxnQkFBSSxVQUFVO0FBQ2IsbUJBQUssa0JBQWtCLEtBQUssa0JBQWtCLGdCQUFnQixTQUFTLFlBQVksWUFBWSxpQkFBaUIsSUFBSSxNQUFNLEVBQUUsMkJBQTJCLFFBQVEsRUFBRSxDQUFDO0FBQUEsWUFDbks7QUFBQSxVQUNEO0FBR0EsZUFBSyxhQUFhLFNBQVMsRUFBRTtBQUM3QixlQUFLLHVCQUF1QjtBQUc1QixjQUFJLEtBQUssZ0JBQWdCO0FBQ3hCLGlCQUFLLGVBQWUsTUFBTSxVQUFVO0FBQUEsVUFDckM7QUFDQTtBQUFBLFFBQ0Q7QUFHQSxhQUFJLHdEQUFpQixtQkFBakIsbUJBQWlDLFFBQVE7QUFDNUMsZ0JBQU0sVUFBVSxnQkFBZ0I7QUFDaEMsZ0JBQU0sV0FBVyxRQUFRLE9BQU8sU0FBSTtBQTcrQ3pDLGdCQUFBQTtBQTYrQzRDLG9CQUFBQSxNQUFBLDJCQUFLLFNBQUwsZ0JBQUFBLElBQVc7QUFBQSxXQUFRLEVBQUUsSUFBSSxTQUFPLElBQUksS0FBSyxRQUFRLEVBQUUsS0FBSyxJQUFJO0FBQ25HLGNBQUksWUFBWSxRQUFRLFNBQVMsR0FBRztBQUNuQyxrQkFBTSxZQUFZLGdCQUFnQixhQUFhLElBQUksTUFBTSxnQkFBZ0IsVUFBVSxhQUFhO0FBQ2hHLGtCQUFNLGdCQUFjLFVBQUssZ0JBQUwsbUJBQWtCLGFBQVk7QUFDbEQsaUJBQUssa0JBQWtCLG1CQUFjLFFBQVEsTUFBTSxZQUFZLFFBQVEsV0FBVyxJQUFJLE1BQU0sRUFBRSxnQkFBZ0IsUUFBUSxHQUFHLFNBQVMscUVBQXFFLFdBQVcsR0FBRztBQUFBLFVBQ3ROO0FBQUEsUUFDRDtBQUdBLFlBQUksbURBQWlCLGFBQWE7QUFDakMsY0FBSSx5QkFBTyx3RkFBOEUsaUJBQWdCLGtCQUFrQjtBQUFBLFFBQzVIO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFHQSxTQUFLLGFBQWEsU0FBUyxFQUFFO0FBRzdCLFFBQUksS0FBSyxnQkFBZ0I7QUFDeEIsV0FBSyxlQUFlLE1BQU0sVUFBVTtBQUFBLElBQ3JDO0FBR0EsVUFBTSxhQUFjLEtBQUssYUFBcUI7QUFDOUMsUUFBSSxXQUFZLFlBQVcsWUFBWSxJQUFJO0FBRTNDLFFBQUk7QUFDSCxjQUFRLElBQUksa0NBQTJCLEVBQUUsWUFBWSxDQUFDO0FBR3RELFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBQ3BELFVBQUksWUFBWTtBQUNmLGdCQUFRLElBQUksNENBQXFDLEVBQUUsTUFBTSxXQUFXLE1BQU0sWUFBWSxDQUFDO0FBQ3ZGLGNBQU0sS0FBSyxPQUFPLG9CQUFvQixlQUFlLFlBQVksYUFBYSxJQUFXO0FBRXpGLGdCQUFRLElBQUksK0NBQXdDO0FBRXBELGFBQUssV0FBVyxRQUFRLFdBQVc7QUFBQSxNQUNwQztBQUdBLFlBQU0sWUFBWSxLQUFLLGNBQWMsVUFBVSxFQUFFLEtBQUssZUFBZSxDQUFDO0FBQ3RFLGdCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBYTFCLFlBQU0sZ0JBQWdCLFVBQVUsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDekUsb0JBQWMsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVTFCLFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxvQkFBb0IsOEJBQVk7QUFDdEUsWUFBTSxnQkFBZSw4Q0FBWSxXQUFaLG1CQUFvQjtBQUN6QyxZQUFNLGVBQWUsQ0FBQyxFQUFFLGdCQUFnQixhQUFhLEtBQUssRUFBRSxTQUFTO0FBQ3JFLFlBQU0sU0FBUyxNQUFNLEtBQUssT0FBTyxtQkFBbUIsZUFBZSxrQkFBa0IsWUFBWTtBQUdqRyxVQUFJO0FBQ0osVUFBSSxXQUFXLGNBQWMsV0FBVyxXQUFXO0FBQ2xELDRCQUFvQixLQUFLLE9BQU8sY0FBYyxhQUFhLGdCQUFnQjtBQUFBLE1BQzVFO0FBQ0EsWUFBTSxnQkFBZ0IsS0FBSyw0QkFBNEIsbUJBQW1CLGdCQUFnQjtBQUUxRixZQUFNLGdCQUFnQixVQUFVLFdBQVcsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUNsRSxvQkFBYyxNQUFNLFVBQVU7QUFHOUIsV0FBSyw0QkFBNEIsZUFBZSxtQkFBbUIsZ0JBQWdCO0FBSW5GLFVBQUksV0FBMEI7QUFFOUIsVUFBSSxXQUFXLGNBQWMsWUFBWTtBQUV4QyxjQUFNLGdCQUFnQixLQUFLLE9BQU8sY0FBYyxhQUFhLGdCQUFnQjtBQUM3RSxtQkFBVyxNQUFNLEtBQUssZUFBZSxhQUFhO0FBQUEsTUFDbkQsV0FBVyxXQUFXLGFBQWEsWUFBWTtBQUU5QyxjQUFNLGdCQUFnQixLQUFLLE9BQU8sY0FBYyxhQUFhLGdCQUFnQjtBQUM3RSxtQkFBVyxNQUFNLEtBQUssZUFBZSxhQUFhO0FBQUEsTUFDbkQsT0FBTztBQUVOLGNBQU1DLFVBQVMsTUFBTSxLQUFLLE9BQU8sY0FBYyxzQkFBc0Isa0JBQWtCLGNBQWMsTUFBUztBQUc5RyxZQUFJLG1CQUFtQixnQkFBZ0IsZUFBZTtBQUVyRCxnQkFBTSx3QkFBd0JBLFFBQU8sZ0JBQWdCLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVTNELGdCQUFNLHFCQUFxQjtBQUFBLEVBQzlCLGdCQUFnQixhQUFhO0FBQUE7QUFBQTtBQUFBO0FBQUEsZ0JBSWYsZ0JBQWdCO0FBRzNCLHFCQUFXLE1BQU0sS0FBSyxPQUFPLGtCQUFrQixTQUFTLHNCQUFzQixvQkFBb0I7QUFBQSxZQUNqRyxhQUFhQSxRQUFPLE9BQU87QUFBQSxZQUMzQixXQUFXQSxRQUFPLE9BQU87QUFBQSxVQUMxQixDQUFDO0FBQUEsUUFDRixPQUFPO0FBRU4scUJBQVcsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLFNBQVNBLFFBQU8sZ0JBQWdCLElBQUlBLFFBQU8sWUFBWTtBQUFBLFlBQ3JHLGFBQWFBLFFBQU8sT0FBTztBQUFBLFlBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFVBQzFCLENBQUM7QUFBQSxRQUNGO0FBQUEsTUFDRDtBQUdBLFlBQU0sa0JBQWtCLFVBQVUsY0FBYyxNQUFNO0FBQ3RELFVBQUksaUJBQWlCO0FBQ3BCLGFBQUssMkJBQTJCLGVBQThCO0FBQUEsTUFDL0Q7QUFDQSxnQkFBVSxPQUFPO0FBR2pCLFlBQU0sbUJBQW1CLFdBQVcsS0FBSyxzQkFBc0IsUUFBUSxJQUFJO0FBRzNFLFVBQUksY0FBYyxrQkFBa0I7QUFDbkMsY0FBTSxLQUFLLE9BQU8sZUFBZSxvQkFBb0IsZ0JBQWdCO0FBQUEsTUFDdEU7QUFHQSxVQUFJLGtCQUFrQjtBQUVyQixZQUFJLGlCQUFpQixTQUFTLFVBQVUsS0FDdkMsaUJBQWlCLFNBQVMseUJBQXlCLEtBQ25ELGlCQUFpQixTQUFTLFdBQVcsS0FDckMsaUJBQWlCLFNBQVMsMEJBQTBCLEtBQ3BELGlCQUFpQixTQUFTLGtCQUFrQixLQUM1QyxpQkFBaUIsU0FBUyxlQUFlLEdBQUc7QUFDNUMsZUFBSyxnQkFBZ0IsZ0JBQWdCO0FBQUEsUUFDdEMsT0FBTztBQUNOLGVBQUssV0FBVyxhQUFhLGdCQUFnQjtBQUFBLFFBQzlDO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBRWYsWUFBTSxZQUFZLEtBQUssY0FBYyxjQUFjLGVBQWU7QUFDbEUsVUFBSSxXQUFXO0FBQ2QsY0FBTSxrQkFBa0IsVUFBVSxjQUFjLE1BQU07QUFDdEQsWUFBSSxpQkFBaUI7QUFDcEIsZUFBSywyQkFBMkIsZUFBOEI7QUFBQSxRQUMvRDtBQUNBLGtCQUFVLE9BQU87QUFBQSxNQUNsQjtBQUdBLFlBQU0sZUFBZ0IsTUFBZ0I7QUFDdEMsVUFBSTtBQUdKLFVBQUksYUFBYSxTQUFTLGtCQUFrQixHQUFHO0FBRTlDLHlCQUFpQjtBQUFBLE1BQ2xCLFdBQVcsYUFBYSxTQUFTLGtCQUFrQixHQUFHO0FBQ3JELHlCQUFpQjtBQUFBLE1BQ2xCLFdBQVcsYUFBYSxTQUFTLFNBQVMsR0FBRztBQUM1Qyx5QkFBaUIsR0FBRyxZQUFZO0FBQUEsTUFDakMsV0FBVyxhQUFhLFNBQVMsaUJBQWlCLEtBQUssYUFBYSxTQUFTLGNBQWMsR0FBRztBQUM3Rix5QkFBaUI7QUFBQSxNQUNsQixPQUFPO0FBRU4seUJBQWlCLGtDQUFrQyxZQUFZO0FBQUEsTUFDaEU7QUFFQSxXQUFLLGdCQUFnQixjQUFjO0FBQUEsSUFDcEMsVUFBRTtBQUVELFlBQU1DLGNBQWMsS0FBSyxhQUFxQjtBQUM5QyxVQUFJQSxZQUFZLENBQUFBLFlBQVcsWUFBWSxLQUFLO0FBRTVDLFlBQU0sS0FBSyxlQUFlO0FBQUEsSUFDM0I7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFNLHlCQUF5QixNQUFjO0FBQzVDLFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxvQkFBb0IsMEJBQVE7QUFDbEUsUUFBSSxjQUFjLFlBQVksWUFBWTtBQUN6QyxZQUFNLFNBQVUsV0FBbUI7QUFDbkMsVUFBSSxRQUFRO0FBQ1gsY0FBTSxTQUFTLE9BQU8sVUFBVTtBQUNoQyxlQUFPLGFBQWEsTUFBTSxNQUFNO0FBQUEsTUFDakM7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBYyxlQUFlLFNBQThDO0FBQzFFLFFBQUk7QUFFSCxVQUFJLENBQUMsS0FBSyxhQUFhO0FBQ3RCLGVBQU8sS0FBSyxrQkFBa0IsWUFBWSxxRkFBcUY7QUFBQSxNQUNoSTtBQUdBLFlBQU0sU0FBUyxLQUFLLElBQUksVUFBVSxnQkFBZ0IsVUFBVTtBQUM1RCxVQUFJLGVBQW9DO0FBR3hDLGlCQUFXLFFBQVEsUUFBUTtBQUMxQixjQUFNLE9BQU8sS0FBSztBQUNsQixZQUFJLEtBQUssU0FBUyxLQUFLLGFBQWE7QUFDbkMseUJBQWU7QUFDZjtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBR0EsVUFBSSxDQUFDLGNBQWM7QUFDbEIsY0FBTSxPQUFPLEtBQUssSUFBSSxVQUFVLFFBQVEsS0FBSztBQUM3QyxZQUFJLE1BQU07QUFDVCxnQkFBTSxLQUFLLFNBQVMsS0FBSyxXQUFXO0FBQ3BDLHlCQUFlLEtBQUs7QUFBQSxRQUNyQjtBQUFBLE1BQ0Q7QUFFQSxVQUFJLENBQUMsY0FBYztBQUNsQixlQUFPLEtBQUssa0JBQWtCLFlBQVksOEJBQThCLEtBQUssWUFBWSxRQUFRLDhDQUE4QztBQUFBLE1BQ2hKO0FBSUEsWUFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFDcEQsVUFBSSxDQUFDLGNBQWMsZUFBZSxLQUFLLGFBQWE7QUFFbkQsYUFBSyxJQUFJLFVBQVUsY0FBYyxhQUFhLE1BQU0sRUFBRSxPQUFPLE1BQU0sQ0FBQztBQUdwRSxjQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxFQUFFLENBQUM7QUFHcEQsY0FBTSxnQkFBZ0IsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUN2RCxZQUFJLENBQUMsaUJBQWlCLGtCQUFrQixLQUFLLGFBQWE7QUFDekQsaUJBQU8sS0FBSyxrQkFBa0IsWUFBWSxrQkFBa0IsS0FBSyxZQUFZLFFBQVEsd0lBQXdJO0FBQUEsUUFDOU47QUFBQSxNQUNEO0FBR0EsWUFBTSxhQUFhLEtBQUssT0FBTyxlQUFlLGtCQUFrQjtBQUNoRSxVQUFJLFlBQVk7QUFDZixhQUFLLDRCQUE0QjtBQUFBLE1BQ2xDO0FBSUEsV0FBSyxzQkFBc0I7QUFFM0IsVUFBSTtBQUVKLGNBQVEsUUFBUSxRQUFRO0FBQUEsUUFDdkIsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSywrQkFBK0IsT0FBTztBQUMxRDtBQUFBLFFBQ0QsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSyxnQ0FBZ0MsT0FBTztBQUMzRDtBQUFBLFFBQ0QsS0FBSztBQUNKLG1CQUFTLE1BQU0sS0FBSyxPQUFPLHFCQUFxQixRQUFRLE9BQU87QUFDL0Q7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssbUNBQW1DLE9BQU87QUFDOUQ7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssbUNBQW1DLE9BQU87QUFDOUQ7QUFBQSxRQUNELEtBQUs7QUFDSixtQkFBUyxNQUFNLEtBQUssT0FBTyx1QkFBdUIsUUFBUSxPQUFPO0FBQ2pFO0FBQUEsUUFDRDtBQUNDLGlCQUFPLG1DQUFtQyxRQUFRLE1BQU07QUFBQSxNQUMxRDtBQUVBLFVBQUksT0FBTyxTQUFTO0FBRW5CLGFBQUssb0JBQW9CLFFBQVEsTUFBTTtBQUV2QyxlQUFPO0FBQUEsTUFDUixPQUFPO0FBRU4sYUFBSyxrQkFBa0IsUUFBUSxRQUFRLE9BQU8sS0FBSztBQUVuRCxlQUFPO0FBQUEsTUFDUjtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBRWYsV0FBSyxrQkFBa0IsV0FBWSxNQUFnQixPQUFPO0FBRTFELGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUFBLEVBR0EsTUFBYyxnQ0FBZ0M7QUE3eUQvQztBQTh5REUsVUFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFFcEQsWUFBUSxJQUFJLGdDQUF5QjtBQUFBLE1BQ3BDLFlBQVkseUNBQVk7QUFBQSxNQUN4QixjQUFhLFVBQUssZ0JBQUwsbUJBQWtCO0FBQUEsSUFDaEMsQ0FBQztBQUdELFNBQUssZ0NBQWdDO0FBR3JDLFVBQU0sY0FBYyxLQUFLLElBQUksRUFBRSxTQUFTLElBQUksS0FBSyxPQUFPLEVBQUUsU0FBUyxFQUFFLEVBQUUsT0FBTyxHQUFHLENBQUM7QUFDbEYsU0FBSywyQkFBMkI7QUFHaEMsUUFBSSxhQUFhO0FBQ2pCLFFBQUksQ0FBQyxZQUFZO0FBQ2hCLFlBQU0sYUFBYSxLQUFLLElBQUksVUFBVTtBQUN0QyxVQUFJLGNBQWMsV0FBVyxnQkFBZ0IsZ0NBQWM7QUFDMUQscUJBQWEsV0FBVyxLQUFLO0FBQUEsTUFDOUIsT0FBTztBQUVOLGNBQU0sU0FBUyxLQUFLLElBQUksVUFBVSxnQkFBZ0IsVUFBVTtBQUM1RCxZQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLGdCQUFNLE9BQU8sT0FBTyxDQUFDLEVBQUU7QUFDdkIsdUJBQWEsS0FBSztBQUFBLFFBQ25CO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFHQSxRQUFJLENBQUMsY0FBYyxLQUFLLGFBQWE7QUFDcEMsY0FBUSxJQUFJLGdEQUFvQztBQUNoRCxXQUFLLGNBQWM7QUFDbkIsV0FBSyxjQUFjLE1BQU07QUFFekIsV0FBSyxpQkFBaUI7QUFDdEIsV0FBSyxlQUFlLGVBQWUsSUFBSTtBQUN2QyxXQUFLLGVBQWU7QUFDcEIsV0FBSyxrQkFBa0IsaUNBQWlDO0FBQ3hEO0FBQUEsSUFDRDtBQUdBLFFBQUksQ0FBQyxjQUFjLGVBQWUsS0FBSyxhQUFhO0FBQ25ELGNBQVEsSUFBSSwwREFBZ0Q7QUFDNUQ7QUFBQSxJQUNEO0FBR0EsU0FBSyxlQUFlLGVBQWUsVUFBVTtBQUc3QyxTQUFLLDRCQUE0QjtBQUVqQyxZQUFRLElBQUksZ0NBQXlCO0FBQUEsTUFDcEMsT0FBTSxVQUFLLGdCQUFMLG1CQUFrQjtBQUFBLE1BQ3hCLElBQUksV0FBVztBQUFBLElBQ2hCLENBQUM7QUFFRCxTQUFLLGNBQWM7QUFDbkIsU0FBSyxpQkFBaUIsS0FBSyxlQUFlLGtCQUFrQjtBQUc1RCxTQUFLLHVCQUF1QjtBQUc1QixTQUFLLGdCQUFnQjtBQUdyQixVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDhCQUFZO0FBQ3RFLFFBQUksY0FBYyxXQUFXLFFBQVE7QUFDcEMsV0FBSyxvQkFBb0IsV0FBVyxNQUFNO0FBQUEsSUFDM0M7QUFHQSxZQUFRLElBQUkseUNBQWtDO0FBQzlDLFNBQUssY0FBYyxNQUFNO0FBR3pCLFFBQUksS0FBSyw2QkFBNkIsYUFBYTtBQUNsRCxjQUFRLElBQUksMEVBQWdFO0FBQzVFO0FBQUEsSUFDRDtBQUVBLFFBQUk7QUFDSCxjQUFRLElBQUkseURBQWtEO0FBRTlELFlBQU0sS0FBSyxhQUFhLHdCQUF3QixVQUFVO0FBRzFELFVBQUksS0FBSyw2QkFBNkIsYUFBYTtBQUNsRCxnQkFBUSxJQUFJLHdFQUE4RDtBQUMxRTtBQUFBLE1BQ0Q7QUFHQSxZQUFNLEtBQUssZUFBZSw0QkFBNEIsVUFBVTtBQUdoRSxZQUFNLEtBQUssZUFBZTtBQUcxQixZQUFNLEtBQUsscUJBQXFCLFVBQVU7QUFHMUMsVUFBSSxLQUFLLDZCQUE2QixhQUFhO0FBQ2xELGdCQUFRLElBQUksb0VBQTBEO0FBQ3RFO0FBQUEsTUFDRDtBQUFBLElBR0QsU0FBUyxPQUFPO0FBQ2YsY0FBUSxJQUFJLHNDQUFpQyxLQUFLO0FBR2xELFdBQUssa0JBQWtCO0FBQUEsSUFDeEI7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFjLFlBQVk7QUFFekIsU0FBSyxjQUFjLE1BQU07QUFHekIsUUFBSSxLQUFLLGFBQWE7QUFDckIsVUFBSTtBQUNILGNBQU0sS0FBSyxPQUFPLG9CQUFvQixrQkFBa0IsS0FBSyxXQUFXO0FBR3hFLGFBQUssb0JBQW9CLENBQUM7QUFBQSxNQUMzQixTQUFTLE9BQU87QUFBQSxNQUVoQjtBQUFBLElBQ0Q7QUFHQSxRQUFJLHlCQUFPLGNBQWM7QUFHekIsU0FBSyxrQkFBa0I7QUFHdkIsUUFBSSxLQUFLLGFBQWE7QUFDckIsWUFBTSxLQUFLLGVBQWU7QUFBQSxJQUMzQjtBQUFBLEVBQ0Q7QUFBQTtBQUFBLEVBR0EsTUFBYyxrQkFBaUM7QUFFOUMsUUFBSSxLQUFLLGlCQUFpQixZQUFZLEdBQUc7QUFDeEM7QUFBQSxJQUNEO0FBRUEsVUFBTSxLQUFLLG9CQUFvQjtBQUcvQixVQUFNLEtBQUssZUFBZTtBQUUxQixTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUE7QUFBQSxFQUdBLE1BQWMsc0JBQXFDO0FBQ2xELFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBQ3BELFFBQUksQ0FBQyxXQUFZO0FBRWpCLFFBQUk7QUFFSCxZQUFNLFVBQVUsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLFVBQVU7QUFDcEQsVUFBSSxDQUFDLFFBQVM7QUFHZCxZQUFNLFlBQVksUUFBUSxNQUFNLEtBQUssRUFBRSxPQUFPLFVBQVEsS0FBSyxTQUFTLENBQUMsRUFBRTtBQUN2RSxZQUFNLGdCQUFnQixRQUFRLE1BQU0sYUFBYSxLQUFLLENBQUMsR0FBRztBQUcxRCxZQUFNLFdBQVcsS0FBSyxZQUFZLGNBQWMsY0FBYztBQUM5RCxVQUFJLFVBQVU7QUFFYixZQUFJLGlCQUFpQixTQUFTLGNBQWMsZ0NBQWdDO0FBQzVFLFlBQUksQ0FBQyxnQkFBZ0I7QUFDcEIsMkJBQWlCLFNBQVMsU0FBUyxPQUFPLEVBQUUsS0FBSyxnQ0FBZ0MsQ0FBQztBQUFBLFFBQ25GO0FBR0EsWUFBSSxVQUFVLGVBQWUsY0FBYyxzQkFBc0I7QUFDakUsWUFBSSxDQUFDLFNBQVM7QUFDYixvQkFBVSxlQUFlLFNBQVMsT0FBTyxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFBQSxRQUN4RTtBQUVBLFlBQUksV0FBVyxZQUFZLEdBQUc7QUFFN0IsZ0JBQU0sY0FBYyxLQUFLLEtBQUssWUFBWSxHQUFHO0FBQzdDLGtCQUFRLGNBQWMsS0FBSyxXQUFXO0FBQUEsUUFDdkM7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFBQSxJQUVoQjtBQUFBLEVBQ0Q7QUFBQTtBQUFBLEVBR1EseUJBQStCO0FBQ3RDLFNBQUssbUJBQW1CO0FBQUEsRUFDekI7QUFBQSxFQUVRLHFCQUEyQjtBQTkvRHBDO0FBKy9ERSxVQUFNLFdBQVcsS0FBSyxZQUFZLGNBQWMsY0FBYztBQUM5RCxRQUFJLENBQUMsU0FBVTtBQUdmLFFBQUksaUJBQWlCLFNBQVMsY0FBYyxnQ0FBZ0M7QUFDNUUsUUFBSSxDQUFDLGdCQUFnQjtBQUNwQix1QkFBaUIsU0FBUyxTQUFTLE9BQU8sRUFBRSxLQUFLLGdDQUFnQyxDQUFDO0FBQUEsSUFDbkY7QUFHQSxRQUFJLFVBQVUsZUFBZSxjQUFjLHNCQUFzQjtBQUNqRSxRQUFJLENBQUMsU0FBUztBQUNiLGdCQUFVLGVBQWUsU0FBUyxPQUFPLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUFBLElBQ3hFO0FBR0EsUUFBSSxVQUFVLGVBQWUsY0FBYyxtQkFBbUI7QUFDOUQsUUFBSSxDQUFDLFNBQVM7QUFDYixnQkFBVSxlQUFlLFNBQVMsT0FBTyxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFBQSxJQUNyRTtBQUdBLFVBQU0scUJBQW9CLFVBQUssbUJBQUwsbUJBQXFCO0FBQy9DLFFBQUk7QUFDSixRQUFJO0FBQ0osUUFBSTtBQUNKLFFBQUk7QUFFSixRQUFJLG1CQUFtQjtBQUV0Qix5QkFBbUIsOEJBQThCLGlCQUFpQjtBQUNsRSxxQkFBZSx1QkFBdUIsaUJBQWlCO0FBQ3ZELG9CQUFjLG1CQUFtQixpQkFBaUI7QUFDbEQsb0JBQWMsa0JBQWtCLGlCQUFpQjtBQUFBLElBQ2xELE9BQU87QUFFTixZQUFNLGtCQUFnQixVQUFLLG1CQUFMLG1CQUFxQixlQUFjO0FBQ3pELHlCQUFtQjtBQUNuQixvQkFBYyxnQkFBZ0IsSUFBSSxHQUFHLGFBQWEsWUFBWTtBQUM5RCxvQkFBYyxpQkFBaUIsYUFBYTtBQUM1QyxxQkFBZTtBQUFBLElBQ2hCO0FBR0EsWUFBUSxjQUFjO0FBR3RCLFlBQVEsUUFBUTtBQUdoQixZQUFRLFlBQVk7QUFDcEIsUUFBSSxpQkFBaUIsUUFBUTtBQUM1QixjQUFRLFNBQVMsaUJBQWlCO0FBQUEsSUFDbkMsV0FBVyxpQkFBaUIsV0FBVztBQUN0QyxjQUFRLFNBQVMsb0JBQW9CO0FBQ3JDLFdBQUssaUJBQWlCLEVBQUU7QUFBQSxJQUN6QixXQUFXLGlCQUFpQixZQUFZO0FBQ3ZDLGNBQVEsU0FBUyxtQkFBbUI7QUFDcEMsV0FBSyxpQkFBaUIsRUFBRTtBQUFBLElBQ3pCO0FBQUEsRUFDRDtBQUFBLEVBRVEsaUJBQWlCLFdBQXlCO0FBRWpELFVBQU0sYUFBYSxpQkFBaUIsU0FBUztBQUc3QyxRQUFJLEtBQUssa0JBQWtCLFVBQVUsRUFBRztBQUd4QyxTQUFLLGtCQUFrQixVQUFVLElBQUksS0FBSyxJQUFJO0FBRTlDLFFBQUk7QUFDSixRQUFJLGNBQWMsSUFBSTtBQUNyQixnQkFBVTtBQUFBLElBQ1gsV0FBVyxjQUFjLElBQUk7QUFDNUIsZ0JBQVU7QUFBQSxJQUNYLFdBQVcsY0FBYyxJQUFJO0FBQzVCLGdCQUFVO0FBQUEsSUFDWCxPQUFPO0FBRU4sZ0JBQVU7QUFBQSxJQUNYO0FBRUEsU0FBSyxrQkFBa0IsT0FBTztBQUFBLEVBQy9CO0FBQUEsRUFFUSxrQkFBa0IsU0FBdUI7QUFDaEQsU0FBSyxhQUFhLGtCQUFrQixTQUFTLElBQUk7QUFBQSxFQUNsRDtBQUFBLEVBRUEsTUFBYyxxQkFBcUIsTUFBNEI7QUFDOUQsUUFBSTtBQUNILFlBQU0sVUFBVSxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssSUFBSTtBQUM5QyxZQUFNLFdBQVcsaUJBQWlCLGlCQUFpQixPQUFPO0FBRTFELFVBQUksU0FBUyxjQUFjLFNBQVMsS0FBSyxTQUFTLGtCQUFrQixTQUFTLEdBQUc7QUFDL0UsY0FBTSxXQUFxQixDQUFDO0FBRTVCLFlBQUksU0FBUyxjQUFjLFNBQVMsR0FBRztBQUN0QyxtQkFBUyxLQUFLLEdBQUcsU0FBUyxjQUFjLE1BQU0saUJBQWlCLFNBQVMsY0FBYyxTQUFTLElBQUksTUFBTSxFQUFFLFVBQVU7QUFBQSxRQUN0SDtBQUVBLFlBQUksU0FBUyxrQkFBa0IsU0FBUyxHQUFHO0FBQzFDLG1CQUFTLEtBQUssR0FBRyxTQUFTLGtCQUFrQixNQUFNLHFCQUFxQixTQUFTLGtCQUFrQixTQUFTLElBQUksTUFBTSxFQUFFLEVBQUU7QUFBQSxRQUMxSDtBQUVBLFlBQUksU0FBUyxTQUFTLEdBQUc7QUFDeEIsZ0JBQU0sYUFBYSxTQUFTLElBQUksYUFBVyxVQUFLLE9BQU8sRUFBRSxFQUFFLEtBQUssSUFBSTtBQUdwRSxnQkFBTSxZQUFZLEtBQUssY0FBYyxVQUFVLEVBQUUsS0FBSyxvREFBb0QsQ0FBQztBQUMzRyxvQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBYTFCLGdCQUFNLFNBQVMsVUFBVSxTQUFTLE9BQU87QUFBQSxZQUN4QyxNQUFNO0FBQUEsWUFDTixLQUFLO0FBQUEsVUFDTixDQUFDO0FBQ0QsaUJBQU8sTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU92QixnQkFBTSxZQUFZLFVBQVUsU0FBUyxPQUFPLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUMzRSxvQkFBVSxNQUFNLFVBQVU7QUFDMUIsb0JBQVUsY0FBYztBQUFBO0FBQUEsRUFBaUIsVUFBVTtBQUFBO0FBQUE7QUFHbkQscUJBQVcsTUFBTTtBQUNoQixpQkFBSyxjQUFjLFlBQVksS0FBSyxjQUFjO0FBQUEsVUFDbkQsR0FBRyxFQUFFO0FBQUEsUUFDTjtBQUFBLE1BQ0Q7QUFBQSxJQUNELFNBQVMsT0FBTztBQUFBLElBRWhCO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSwwQkFBMEIsT0FBOEI7QUFDN0QsVUFBTSxhQUFhLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFHNUQsVUFBTUQsVUFBUyxNQUFNLEtBQUssT0FBTyxjQUFjLHNCQUFzQixPQUFPLGNBQWMsTUFBUztBQUNuRyxVQUFNLFdBQVcsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLFNBQVNBLFFBQU8sY0FBY0EsUUFBTyxVQUFVO0FBR3BHLFNBQUssb0JBQW9CLFFBQVE7QUFHakMsU0FBSyxrQkFBa0IsY0FBYztBQUFBLEVBQ3RDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxvQkFBb0IsVUFBd0I7QUFFM0MsU0FBSyxhQUFhLFdBQVcsYUFBYSxRQUFRO0FBQUEsRUFDbkQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUFrQixNQUF3QztBQUFBLEVBRzFEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHFCQUFxQixPQUF1QztBQUVqRSxVQUFNLGdCQUFnQixLQUFLLE9BQU8sY0FBYyxhQUFhLEtBQUs7QUFHbEUsU0FBSyxpQkFBaUIsV0FBVyxLQUFLO0FBR3RDLFdBQU8sTUFBTSxLQUFLLGVBQWUsYUFBYTtBQUFBLEVBQy9DO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxpQkFBaUIsUUFBb0MsT0FBcUI7QUFBQSxFQUcxRTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx1QkFBdUIsT0FBZSxjQUF5RDtBQUNwRyxRQUFJLGlCQUFpQixnQkFBZ0I7QUFDcEMsWUFBTSxLQUFLLDBCQUEwQixLQUFLO0FBQUEsSUFDM0MsT0FBTztBQUNOLFlBQU0sS0FBSyxxQkFBcUIsS0FBSztBQUFBLElBQ3RDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSwyQkFBMkIsT0FBOEI7QUFDOUQsVUFBTSxTQUFTLE1BQU0sS0FBSyxPQUFPLG1CQUFtQixlQUFlLEtBQUs7QUFFeEUsWUFBUSxRQUFRO0FBQUEsTUFDZixLQUFLO0FBQ0osY0FBTSxLQUFLLDBCQUEwQixLQUFLO0FBQzFDO0FBQUEsTUFDRCxLQUFLO0FBQ0osY0FBTSxLQUFLLHFCQUFxQixLQUFLO0FBQ3JDO0FBQUEsTUFDRCxLQUFLO0FBRUosY0FBTSxnQkFBZ0IsS0FBSyxPQUFPLGNBQWMsYUFBYSxLQUFLO0FBQ2xFLGNBQU0sS0FBSyxlQUFlLGFBQWE7QUFDdkM7QUFBQSxJQUNGO0FBQUEsRUFDRDtBQUFBO0FBQUEsRUFHQSxNQUFNLFlBQVksU0FBZ0M7QUFDakQsVUFBTSxhQUFhLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFHNUQsVUFBTUEsVUFBUyxNQUFNLEtBQUssT0FBTyxjQUFjLHNCQUFzQixTQUFTLGNBQWMsTUFBUztBQUdyRyxVQUFNLFVBQVUsS0FBSyxPQUFPLGNBQWMsYUFBYSxPQUFPO0FBRzlELFVBQU0sZUFBZSxDQUFDLE9BQU8sUUFBUSxVQUFVLFdBQVcsV0FBVyxVQUFVO0FBQy9FLFFBQUksYUFBYSxTQUFTLFFBQVEsTUFBTSxHQUFHO0FBSTFDLFlBQU0sb0JBQW9CLEtBQUssT0FBTyxlQUFlLGNBQWM7QUFDbkUsVUFBSSxjQUFjLHFCQUFxQixzQkFBc0IsWUFBWTtBQUN4RSxjQUFNLElBQUksTUFBTSx1RUFBdUUsV0FBVyxRQUFRLGFBQWEsa0JBQWtCLFFBQVEsRUFBRTtBQUFBLE1BQ3BKO0FBR0EsY0FBUSxRQUFRLFFBQVE7QUFBQSxRQUN2QixLQUFLO0FBQ0osZ0JBQU0sS0FBSyxPQUFPLGtCQUFrQixRQUFRLE9BQU87QUFDbkQ7QUFBQSxRQUNELEtBQUs7QUFDSixnQkFBTSxLQUFLLE9BQU8sbUJBQW1CLFFBQVEsT0FBTztBQUNwRDtBQUFBLFFBQ0QsS0FBSztBQUNKLGdCQUFNLEtBQUssT0FBTyxxQkFBcUIsUUFBUSxPQUFPO0FBQ3REO0FBQUEsUUFDRCxLQUFLO0FBQ0osZ0JBQU0sS0FBSyxPQUFPLHNCQUFzQixRQUFRLE9BQU87QUFDdkQ7QUFBQSxRQUNELEtBQUs7QUFDSixnQkFBTSxLQUFLLE9BQU8sc0JBQXNCLFFBQVEsT0FBTztBQUN2RDtBQUFBLFFBQ0QsS0FBSztBQUNKLGdCQUFNLEtBQUssT0FBTyx1QkFBdUIsUUFBUSxPQUFPO0FBQ3hEO0FBQUEsTUFDRjtBQUFBLElBQ0QsT0FBTztBQUlOLFlBQU0sS0FBSyxPQUFPLGtCQUFrQixTQUFTQSxRQUFPLGdCQUFnQixJQUFJQSxRQUFPLFVBQVU7QUFFekYsVUFBSSxZQUFZO0FBQ2YsY0FBTSxLQUFLLE9BQU8sb0JBQW9CLG9CQUFvQixZQUFZLGVBQWUsRUFBRSxTQUFTLE1BQU0sVUFBVSxPQUFPLENBQVE7QUFBQSxNQUNoSTtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVNBLE1BQWMsd0JBQXVDO0FBQ3BELFVBQU0sc0JBQXNCLE1BQU0sS0FBSyxPQUFPLGtCQUFrQix1QkFBdUI7QUFDdkYsVUFBTSxhQUFjLEtBQUssYUFBcUI7QUFDOUMsUUFBSSxXQUFZLFlBQVcsWUFBWSxDQUFDLG1CQUFtQjtBQUFBLEVBQzVEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUF1QixrQkFBOEM7QUFDbEYsVUFBTSxzQkFBc0IsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLHVCQUF1QjtBQUd2RixxQkFBaUIsTUFBTTtBQUN2QixxQkFBaUIsWUFBWSxvQkFBb0IsU0FBUyxPQUFPO0FBR2pFLHFCQUFpQixNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVlqQyxRQUFJLHFCQUFxQjtBQUN4QixZQUFNLGtCQUFrQix3QkFBd0I7QUFHaEQsdUJBQWlCLFNBQVMsa0JBQWtCO0FBQzVDLHVCQUFpQixTQUFTLGtCQUFrQixVQUFVLE9BQU87QUFHN0QsWUFBTSxTQUFTLGlCQUFpQixXQUFXLEVBQUUsS0FBSyxtQkFBbUIsQ0FBQztBQUN0RSxhQUFPLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNdkIsWUFBTSxXQUFXLGtCQUFrQixpQkFBaUI7QUFDcEQscUNBQVEsUUFBUSxRQUFRO0FBR3hCLFlBQU0sVUFBVSxpQkFBaUIsV0FBVyxFQUFFLE1BQU0sa0JBQWtCLFVBQVUsUUFBUSxDQUFDO0FBQ3pGLGNBQVEsTUFBTSxVQUFVO0FBR3hCLFlBQU0sVUFBVSxrQkFBa0IsaURBQWlEO0FBQ25GLHVCQUFpQixhQUFhLGNBQWMsT0FBTztBQUNuRCx1QkFBaUIsYUFBYSxTQUFTLE9BQU87QUFBQSxJQUMvQyxPQUFPO0FBRU4sdUJBQWlCLFNBQVMsa0JBQWtCO0FBRTVDLFlBQU0sU0FBUyxpQkFBaUIsV0FBVyxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFDdEUsYUFBTyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXZCLHFDQUFRLFFBQVEsYUFBYTtBQUU3QixZQUFNLFVBQVUsaUJBQWlCLFdBQVcsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUNuRSxjQUFRLE1BQU0sVUFBVTtBQUV4Qix1QkFBaUIsYUFBYSxjQUFjLHNCQUFzQjtBQUNsRSx1QkFBaUIsYUFBYSxTQUFTLHNCQUFzQjtBQUFBLElBQzlEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNUSxzQkFBc0IsU0FBeUI7QUFHdEQsV0FBTyxRQUFRLFFBQVEsNkNBQTZDLEVBQUUsRUFBRSxLQUFLO0FBQUEsRUFDOUU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsd0JBQXVDO0FBbjRFdEQ7QUFxNEVFLFFBQUssS0FBYSxrQkFBa0I7QUFDbkMsWUFBTSxLQUFLLHVCQUF3QixLQUFhLGdCQUFnQjtBQUFBLElBQ2pFO0FBR0EsU0FBSyxzQkFBc0I7QUFHM0IsU0FBSyxVQUFhLDRCQUFiLG1CQUFzQyx1QkFBdUI7QUFDakUsWUFBTyxLQUFhLHdCQUF3QixzQkFBc0I7QUFBQSxJQUNuRTtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsdUJBQXVCLFdBQXVDO0FBQzNFLFVBQU0sb0JBQW9CLFVBQVUsVUFBVSxFQUFFLEtBQUssbUNBQW1DLENBQUM7QUFDekYsc0JBQWtCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBT2xDLFVBQU0saUJBQWlCLGtCQUFrQixTQUFTLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzNGLG1CQUFlLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWUvQixVQUFNLGVBQWUsZUFBZSxXQUFXLEVBQUUsTUFBTSxjQUFjLEtBQUsscUJBQXFCLENBQUM7QUFHaEcsVUFBTSxnQkFBZ0IsZUFBZSxXQUFXLEVBQUUsTUFBTSxTQUFJLENBQUM7QUFDN0Qsa0JBQWMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPOUIsVUFBTSxlQUFlLGtCQUFrQixVQUFVLEVBQUUsS0FBSyw4QkFBOEIsQ0FBQztBQUN2RixpQkFBYSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFpQzdCLFVBQU0saUJBQWlCLFNBQVMsY0FBYyxPQUFPO0FBQ3JELG1CQUFlLGNBQWM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZTdCLFFBQUksQ0FBQyxTQUFTLGNBQWMsdUJBQXVCLEdBQUc7QUFDckQscUJBQWUsWUFBWTtBQUMzQixlQUFTLEtBQUssWUFBWSxjQUFjO0FBQUEsSUFDekM7QUFFQSxRQUFJLGlCQUFpQjtBQUdyQixVQUFNLHdCQUF3QixNQUFNO0FBQ25DLFVBQUk7QUFFSCxjQUFNLGVBQWUsS0FBSyxPQUFPLGtCQUFrQixnQkFBZ0I7QUFFbkUsWUFBSSxjQUFjO0FBRWpCLGdCQUFNLGVBQWUsS0FBSyx5QkFBeUIsWUFBWTtBQUMvRCxjQUFJLGNBQWM7QUFDakIsa0JBQU0sY0FBYyxLQUFLLG9CQUFvQixjQUFjLFlBQVk7QUFHdkUsZ0JBQUksZUFBZSxZQUFZLFNBQVMsS0FBSyxDQUFDLFlBQVksTUFBTSxNQUFNLEdBQUc7QUFDeEUsMkJBQWEsUUFBUSxXQUFXO0FBQUEsWUFDakMsT0FBTztBQUVOLHNCQUFRLEtBQUsscURBQXFELFdBQVc7QUFDN0UsMkJBQWEsUUFBUSxZQUFZO0FBQUEsWUFDbEM7QUFBQSxVQUNELE9BQU87QUFFTix5QkFBYSxRQUFRLFlBQVk7QUFBQSxVQUNsQztBQUFBLFFBQ0QsT0FBTztBQUVOLHVCQUFhLFFBQVEsY0FBYztBQUFBLFFBQ3BDO0FBQUEsTUFDRCxTQUFTLE9BQU87QUFDZixnQkFBUSxNQUFNLGlDQUFpQyxLQUFLO0FBQ3BELHFCQUFhLFFBQVEsY0FBYztBQUFBLE1BQ3BDO0FBQUEsSUFDRDtBQUdBLFVBQU0saUJBQWlCLE1BQU07QUFDNUIsdUJBQWlCLENBQUM7QUFDbEIsbUJBQWEsTUFBTSxVQUFVLGlCQUFpQixVQUFVO0FBQ3hELG9CQUFjLE1BQU0sWUFBWSxpQkFBaUIsbUJBQW1CO0FBRXBFLFVBQUksZ0JBQWdCO0FBQ25CLGFBQUsseUJBQXlCLFlBQVk7QUFBQSxNQUMzQztBQUFBLElBQ0Q7QUFHQSxVQUFNLGdCQUErQixDQUFDLFVBQWlCO0FBQ3RELFVBQUksQ0FBQyxrQkFBa0IsU0FBUyxNQUFNLE1BQWMsR0FBRztBQUN0RCx5QkFBaUI7QUFDakIscUJBQWEsTUFBTSxVQUFVO0FBQzdCLHNCQUFjLE1BQU0sWUFBWTtBQUFBLE1BQ2pDO0FBQUEsSUFDRDtBQUdBLFVBQU0sd0JBQXdCLE1BQU07QUFDbkMsdUJBQWlCO0FBQ2pCLG1CQUFhLE1BQU0sVUFBVTtBQUM3QixvQkFBYyxNQUFNLFlBQVk7QUFBQSxJQUNqQztBQUVBLG1CQUFlLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUMvQyxRQUFFLGdCQUFnQjtBQUNsQixxQkFBZTtBQUFBLElBQ2hCLENBQUM7QUFHRCxTQUFLLHdCQUF3QixVQUFVLFNBQVMsYUFBYTtBQUc3RCwwQkFBc0I7QUFHdEIsSUFBQyxLQUFhLDBCQUEwQjtBQUFBLE1BQ3ZDO0FBQUEsTUFDQSxlQUFlO0FBQUEsTUFDZixTQUFTLE1BQU0sU0FBUyxvQkFBb0IsU0FBUyxhQUFhO0FBQUEsSUFDbkU7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxtQkFBbUIsY0FBMEQ7QUFDcEYsV0FBTyxtQkFBbUIsY0FBYyxLQUFLLE9BQU8sUUFBUTtBQUFBLEVBQzdEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsY0FBOEI7QUE1a0Z2RDtBQTZrRkUsVUFBTSxZQUFZLEtBQUssT0FBTyxTQUFTO0FBQ3ZDLFVBQU0sZ0JBQWUsZUFBVSxZQUFZLE1BQXRCLG1CQUF5QjtBQUU5QyxRQUFJLGNBQWM7QUFDakIsYUFBTztBQUFBLElBQ1I7QUFHQSxVQUFNLGtCQUFrQixLQUFLLG1CQUFtQixZQUFZO0FBQzVELFdBQU8sZ0JBQWdCLFNBQVMsSUFBSSxnQkFBZ0IsQ0FBQyxFQUFFLFFBQVE7QUFBQSxFQUNoRTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esb0JBQW9CLGNBQXNCLFlBQTRCO0FBQzdFLFVBQU0sU0FBUyxLQUFLLG1CQUFtQixZQUFZO0FBQ25ELFVBQU0sUUFBUSxPQUFPLEtBQUssT0FBSyxFQUFFLFVBQVUsVUFBVTtBQUNyRCxVQUFNLGNBQWMsUUFBUSxNQUFNLFFBQVE7QUFHMUMsUUFBSSxnQkFBZ0IsUUFBUSxZQUFZLE1BQU0sTUFBTSxLQUFLLFlBQVksU0FBUyxHQUFHO0FBQ2hGLGNBQVEsS0FBSyx5Q0FBeUMsYUFBYSxjQUFjLFVBQVU7QUFFM0YsYUFBTyxLQUFLLHVCQUF1QixZQUFZO0FBQUEsSUFDaEQ7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EseUJBQXlCLFdBQWtDO0FBQ2xFLFFBQUksVUFBVSxXQUFXLFNBQVMsRUFBRyxRQUFPO0FBQzVDLFFBQUksVUFBVSxXQUFXLE1BQU0sS0FBSyxVQUFVLFdBQVcsS0FBSyxFQUFHLFFBQU87QUFDeEUsUUFBSSxVQUFVLFdBQVcsU0FBUyxFQUFHLFFBQU87QUFFNUMsV0FBTztBQUFBLEVBQ1I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGNBQWMsY0FBc0IsWUFBMEI7QUFDckUsUUFBSTtBQUVILFlBQU0sV0FBVywyQkFBUyxXQUFXLFdBQVc7QUFDaEQsV0FBSyxPQUFPLFNBQVMsaUJBQWlCLFFBQVEsRUFBRSxnQkFBZ0I7QUFHaEUsWUFBTSxZQUFZLEtBQUssT0FBTyxTQUFTO0FBQ3ZDLFVBQUksVUFBVSxZQUFZLEdBQUc7QUFDNUIsa0JBQVUsWUFBWSxFQUFFLFFBQVE7QUFBQSxNQUNqQztBQUdBLFlBQU0sbUJBQW1CLEtBQUssb0JBQW9CLGNBQWMsVUFBVTtBQUMxRSxZQUFNLHNCQUFzQixLQUFLLHVCQUF1QixZQUFZO0FBQ3BFLFdBQUssa0JBQWtCLHNCQUFpQixtQkFBbUIsSUFBSSxnQkFBZ0IsRUFBRTtBQUdqRixXQUFLLE9BQU8sYUFBYSxFQUFFLE1BQU0sV0FBUztBQUN6QyxnQkFBUSxNQUFNLGlDQUFpQyxLQUFLO0FBQ3BELGFBQUssZ0JBQWdCLGdDQUFnQztBQUFBLE1BQ3RELENBQUM7QUFHRCxXQUFLLHNCQUFzQixFQUFFLE1BQU0sV0FBUztBQUMzQyxnQkFBUSxNQUFNLHFDQUFxQyxLQUFLO0FBQUEsTUFDekQsQ0FBQztBQUFBLElBRUYsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLDBCQUEwQixLQUFLO0FBQzdDLFdBQUssZ0JBQWdCLHdCQUF3QjtBQUFBLElBQzlDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyx5QkFBeUIsY0FBMEM7QUE5cEZsRjtBQStwRkUsaUJBQWEsTUFBTTtBQUduQixVQUFNLGNBQWMsYUFBYSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUMzRSxnQkFBWSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTTVCLGdCQUFZLFFBQVEsc0JBQXNCO0FBRTFDLFFBQUk7QUFFSCxZQUFNLHVCQUF1QixNQUFNLEtBQUssT0FBTyxrQkFBa0IsZ0NBQWdDO0FBQ2pHLFlBQU0sZUFBZSxLQUFLLE9BQU8sa0JBQWtCLGdCQUFnQjtBQUNuRSxZQUFNLHNCQUFzQixNQUFNLEtBQUssT0FBTyxrQkFBa0IsdUJBQXVCO0FBR3ZGLG1CQUFhLE1BQU07QUFHbkIsVUFBSSxrQkFBa0I7QUFFdEIsaUJBQVcsQ0FBQyxjQUFjLFdBQVcsS0FBSyxzQkFBc0I7QUFDL0QsWUFBSSxpQkFBaUIsVUFBVSxDQUFDLFlBQWE7QUFHN0MsY0FBTSxZQUFZLEtBQUssT0FBTyxTQUFTO0FBQ3ZDLGNBQU0sYUFBWSxlQUFVLFlBQVksTUFBdEIsbUJBQXlCO0FBQzNDLFlBQUksQ0FBQyxhQUFhLGlCQUFpQixTQUFVO0FBRTdDLGNBQU0sU0FBUyxLQUFLLG1CQUFtQixZQUFZO0FBQ25ELGNBQU0sc0JBQXNCLEtBQUssdUJBQXVCLFlBQVk7QUFDcEUsY0FBTSxnQkFBZ0IsS0FBSyxpQkFBaUIsWUFBWTtBQUd4RCxZQUFJLE9BQU8sV0FBVyxLQUFLLGlCQUFpQixTQUFVO0FBR3RELFlBQUksaUJBQWlCO0FBRXBCLGdCQUFNLFlBQVksYUFBYSxVQUFVLEVBQUUsS0FBSywwQkFBMEIsQ0FBQztBQUMzRSxvQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFFBSzNCO0FBRUEsY0FBTSxnQkFBZ0IsYUFBYSxVQUFVLEVBQUUsS0FBSywrQkFBK0IsQ0FBQztBQUNwRixzQkFBYyxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWE5QixjQUFNLFlBQVksY0FBYyxXQUFXO0FBQzNDLGtCQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQUlYLGFBQWE7QUFBQTtBQUFBO0FBSTVCLHNCQUFjLFdBQVcsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3RELDBCQUFrQjtBQUVsQixZQUFJLE9BQU8sV0FBVyxHQUFHO0FBRXhCLGVBQUs7QUFBQSxZQUNKO0FBQUEsWUFDQTtBQUFBLGNBQ0EsZUFBVSxZQUFZLE1BQXRCLG1CQUF5QixVQUFTO0FBQUEsWUFDbEM7QUFBQSxZQUNBO0FBQUEsWUFDQSx3QkFBd0I7QUFBQSxZQUN4QjtBQUFBLFVBQ0Q7QUFBQSxRQUNELE9BQU87QUFFTixxQkFBVyxTQUFTLFFBQVE7QUFDM0Isa0JBQU0scUJBQXFCLHdCQUF3QixnQkFBZ0IsTUFBTSxVQUFVO0FBRW5GLGlCQUFLO0FBQUEsY0FDSjtBQUFBLGNBQ0E7QUFBQSxjQUNBLE1BQU07QUFBQSxjQUNOLE1BQU07QUFBQSxjQUNOO0FBQUEsY0FDQTtBQUFBLGNBQ0E7QUFBQSxZQUNEO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBR0EsVUFBSSxDQUFDLGlCQUFpQjtBQUNyQixjQUFNLGtCQUFrQixhQUFhLFVBQVU7QUFDL0Msd0JBQWdCLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNaEMsd0JBQWdCLFFBQVEsd0JBQXdCO0FBQUEsTUFDakQ7QUFBQSxJQUVELFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSx1Q0FBdUMsS0FBSztBQUMxRCxtQkFBYSxNQUFNO0FBQ25CLFlBQU0sWUFBWSxhQUFhLFVBQVU7QUFDekMsZ0JBQVUsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU0xQixnQkFBVSxRQUFRLHlCQUF5QjtBQUFBLElBQzVDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esd0JBQ1AsV0FDQSxjQUNBLFlBQ0Esa0JBQ0EsZUFDQSxXQUNBLGNBQ087QUFDUCxVQUFNLE9BQU8sVUFBVSxVQUFVLEVBQUUsS0FBSywyQkFBMkIsQ0FBQztBQUNwRSxTQUFLLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FXbEIsWUFBWSxrREFBa0QsRUFBRTtBQUFBO0FBSW5FLFVBQU0sTUFBTSxLQUFLLFdBQVc7QUFDNUIsUUFBSSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxpQkFJTCxhQUFhO0FBQUE7QUFBQTtBQUFBO0FBTTVCLFVBQU0sV0FBVyxLQUFLLFdBQVcsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNELGFBQVMsTUFBTSxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVF6QixRQUFJLFdBQVc7QUFDZCxZQUFNLFlBQVksS0FBSyxXQUFXLEVBQUUsTUFBTSxTQUFJLENBQUM7QUFDL0MsZ0JBQVUsTUFBTSxVQUFVO0FBQUEsYUFDaEIsYUFBYTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFLeEI7QUFHQSxTQUFLLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQTcxRnhDO0FBODFGRyxRQUFFLGdCQUFnQjtBQUVsQixVQUFJLENBQUMsV0FBVztBQUNmLFlBQUk7QUFFSCxlQUFLLGNBQWMsY0FBYyxjQUFjLEtBQUssZ0JBQWdCLFlBQVksQ0FBQztBQUdqRixlQUFLLFVBQWEsNEJBQWIsbUJBQXNDLGVBQWU7QUFDekQsWUFBQyxLQUFhLHdCQUF3QixjQUFjO0FBQUEsVUFDckQ7QUFHQSxjQUFLLEtBQWEseUJBQXlCO0FBQzFDLFlBQUMsS0FBYSx3QkFBd0Isc0JBQXNCO0FBQUEsVUFDN0Q7QUFBQSxRQUNELFNBQVMsT0FBTztBQUNmLGtCQUFRLE1BQU0sbUNBQW1DLEtBQUs7QUFBQSxRQUN2RDtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLGlCQUFpQixjQUFjLE1BQU07QUFDekMsVUFBSSxDQUFDLFdBQVc7QUFDZixhQUFLLE1BQU0sYUFBYTtBQUFBLE1BQ3pCO0FBQUEsSUFDRCxDQUFDO0FBRUQsU0FBSyxpQkFBaUIsY0FBYyxNQUFNO0FBQ3pDLFVBQUksQ0FBQyxXQUFXO0FBQ2YsYUFBSyxNQUFNLGFBQWE7QUFBQSxNQUN6QjtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBQ0Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGtCQUFrQixVQUFrQixTQUF5QjtBQUNwRSxVQUFNLFVBQVUsS0FBSyxnQkFBZ0IsVUFBVSxNQUFNO0FBRXJELFdBQU8sc0VBQXNFLE9BQU8sU0FBUyxPQUFPO0FBQUEsRUFDckc7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUFpQixVQUFrQixPQUFlLFFBQWdCO0FBQ3pFLFdBQU8sS0FBSyxnQkFBZ0IsVUFBVSxJQUFJO0FBQUEsRUFDM0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixVQUFrQixPQUFlLFFBQWdCO0FBQ3hFLFVBQU0sUUFBZ0M7QUFBQSxNQUNyQyxPQUFPLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQSxNQUdySCxjQUFjLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLNUgsUUFBUSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUl0SCxlQUFlLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLN0gsYUFBYSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFNM0gsbUJBQW1CLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLakksYUFBYSx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU8zSCxLQUFLLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BSW5ILGdCQUFnQix5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUk5SCxZQUFZLHlGQUF5RixJQUFJLGFBQWEsSUFBSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLMUgsV0FBVyx5RkFBeUYsSUFBSSxhQUFhLElBQUk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFNMUg7QUFFQSxXQUFPLE1BQU0sUUFBUSxLQUFLLE1BQU0sYUFBYTtBQUFBLEVBQzlDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx1QkFBdUIsY0FBOEI7QUFDNUQsVUFBTSxRQUFnQztBQUFBLE1BQ3JDLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFFBQVE7QUFBQSxJQUNUO0FBQ0EsV0FBTyxNQUFNLFlBQVksS0FBSztBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQ0FBZ0MsY0FBOEI7QUFDckUsVUFBTSxTQUFTLEtBQUssbUJBQW1CLFlBQVk7QUFFbkQsUUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixZQUFNLGVBQWUsS0FBSyxnQkFBZ0IsWUFBWTtBQUN0RCxZQUFNLG1CQUFtQixLQUFLLG9CQUFvQixjQUFjLFlBQVk7QUFHNUUsVUFBSSxxQkFBcUIsUUFBUSxpQkFBaUIsTUFBTSxNQUFNLEdBQUc7QUFDaEUsZ0JBQVEsS0FBSyx3Q0FBd0M7QUFBQSxVQUNwRDtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFFBQ0QsQ0FBQztBQUFBLE1BQ0Y7QUFFQSxhQUFPO0FBQUEsSUFDUjtBQUVBLFdBQU8sS0FBSyx1QkFBdUIsWUFBWTtBQUFBLEVBQ2hEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxpQkFBaUIsY0FBOEI7QUFFdEQsVUFBTSxTQUFpQztBQUFBLE1BQ3RDLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFVBQVU7QUFBQSxNQUNWLFFBQVE7QUFBQSxJQUNUO0FBQ0EsV0FBTyxPQUFPLFlBQVksS0FBSztBQUFBLEVBQ2hDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFTUSwwQkFBbUM7QUFFMUMsUUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixVQUFVLEdBQUc7QUFDN0QsYUFBTztBQUFBLElBQ1I7QUFDQSxXQUFPLEtBQUssT0FBTyxTQUFTO0FBQUEsRUFDN0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHFCQUEyQjtBQUMxQixTQUFLLHFCQUFxQjtBQUFBLEVBRTNCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLDBCQUF5QztBQW5pR2hEO0FBb2lHRSxTQUFLLFVBQWEsNEJBQWIsbUJBQXNDLHVCQUF1QjtBQUNqRSxjQUFRLElBQUksaUVBQTBEO0FBQ3RFLFVBQUk7QUFDSCxjQUFPLEtBQWEsd0JBQXdCLHNCQUFzQjtBQUFBLE1BQ25FLFNBQVMsT0FBTztBQUNmLGdCQUFRLE1BQU0sK0NBQTBDLEtBQUs7QUFBQSxNQUM5RDtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBNkI7QUFDNUIsUUFBSSxLQUFLLGNBQWM7QUFDdEIsV0FBSyxhQUFhLHFCQUFxQjtBQUFBLElBQ3hDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQTZCO0FBQUEsRUFJckM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsK0JBQStCLFNBQW9DO0FBQ2hGLFFBQUk7QUFFSCxZQUFNLFNBQVMsS0FBSyxPQUFPLGVBQWUsZ0JBQWdCO0FBQzFELFVBQUksQ0FBQyxRQUFRO0FBQ1osZUFBTztBQUFBLFVBQ04sU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBR0EsWUFBTSxpQkFBaUIsS0FBSyxPQUFPLGVBQWUsa0JBQWtCO0FBQ3BFLFVBQUksQ0FBQyxnQkFBZ0I7QUFDcEIsZUFBTztBQUFBLFVBQ04sU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBR0EsWUFBTSxFQUFFLGNBQWMsV0FBVyxJQUFJLEtBQUssaUJBQWlCO0FBQUEsUUFDMUQ7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxVQUNDLGVBQWU7QUFBQSxVQUNmLFlBQVksTUFBTSxLQUFLLG9CQUFvQjtBQUFBLFFBQzVDO0FBQUEsTUFDRDtBQUVBLFVBQUk7QUFFSCxjQUFNLFNBQVMsTUFBTSxLQUFLLE9BQU8sa0JBQWtCLFFBQVEsU0FBUyxDQUFDLE9BQWUsZUFBd0I7QUFDM0csdUJBQWEsT0FBTyxVQUFVO0FBQUEsUUFDL0IsQ0FBQztBQUdELG1CQUFXO0FBRVgsZUFBTztBQUFBLE1BRVIsU0FBUyxPQUFPO0FBRWYsbUJBQVc7QUFDWCxjQUFNO0FBQUEsTUFDUDtBQUFBLElBRUQsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLG1DQUFtQyxLQUFLO0FBQ3RELGFBQU87QUFBQSxRQUNOLFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDakQ7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxnQ0FBZ0MsU0FBb0M7QUFDakYsUUFBSTtBQUVILFlBQU0sU0FBUyxLQUFLLE9BQU8sZUFBZSxnQkFBZ0I7QUFDMUQsVUFBSSxDQUFDLFFBQVE7QUFDWixlQUFPO0FBQUEsVUFDTixTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsUUFDUjtBQUFBLE1BQ0Q7QUFHQSxZQUFNLGlCQUFpQixLQUFLLE9BQU8sZUFBZSxrQkFBa0I7QUFDcEUsVUFBSSxDQUFDLGdCQUFnQjtBQUNwQixlQUFPO0FBQUEsVUFDTixTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsUUFDUjtBQUFBLE1BQ0Q7QUFHQSxZQUFNLEVBQUUsY0FBYyxXQUFXLElBQUksS0FBSyxpQkFBaUI7QUFBQSxRQUMxRDtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFVBQ0MsZUFBZTtBQUFBLFVBQ2YsWUFBWSxNQUFNLEtBQUssb0JBQW9CO0FBQUEsUUFDNUM7QUFBQSxNQUNEO0FBRUEsVUFBSTtBQUVILGNBQU0sU0FBUyxNQUFNLEtBQUssT0FBTyxtQkFBbUIsUUFBUSxTQUFTLENBQUMsT0FBZSxlQUF3QjtBQUM1Ryx1QkFBYSxPQUFPLFVBQVU7QUFBQSxRQUMvQixDQUFDO0FBR0QsbUJBQVc7QUFFWCxlQUFPO0FBQUEsTUFFUixTQUFTLE9BQU87QUFFZixtQkFBVztBQUNYLGNBQU07QUFBQSxNQUNQO0FBQUEsSUFFRCxTQUFTLE9BQU87QUFDZixjQUFRLE1BQU0sb0NBQW9DLEtBQUs7QUFDdkQsYUFBTztBQUFBLFFBQ04sU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNqRDtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLG1DQUFtQyxTQUFvQztBQUNwRixRQUFJO0FBRUgsWUFBTSxTQUFTLEtBQUssT0FBTyxlQUFlLGdCQUFnQjtBQUMxRCxVQUFJLENBQUMsUUFBUTtBQUNaLGVBQU87QUFBQSxVQUNOLFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxRQUNSO0FBQUEsTUFDRDtBQUdBLFlBQU0saUJBQWlCLEtBQUssT0FBTyxlQUFlLGtCQUFrQjtBQUNwRSxVQUFJLENBQUMsZ0JBQWdCO0FBQ3BCLGVBQU87QUFBQSxVQUNOLFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxRQUNSO0FBQUEsTUFDRDtBQUdBLFlBQU0sRUFBRSxjQUFjLFdBQVcsSUFBSSxLQUFLLGlCQUFpQjtBQUFBLFFBQzFEO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsVUFDQyxlQUFlO0FBQUEsVUFDZixZQUFZLE1BQU0sS0FBSyxvQkFBb0I7QUFBQSxRQUM1QztBQUFBLE1BQ0Q7QUFFQSxVQUFJO0FBRUgsY0FBTSxTQUFTLE1BQU0sS0FBSyxPQUFPLHNCQUFzQixRQUFRLFNBQVMsQ0FBQyxPQUFlLGVBQXdCO0FBQy9HLHVCQUFhLE9BQU8sVUFBVTtBQUFBLFFBQy9CLENBQUM7QUFHRCxtQkFBVztBQUVYLGVBQU87QUFBQSxNQUVSLFNBQVMsT0FBTztBQUVmLG1CQUFXO0FBQ1gsY0FBTTtBQUFBLE1BQ1A7QUFBQSxJQUVELFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSx1Q0FBdUMsS0FBSztBQUMxRCxhQUFPO0FBQUEsUUFDTixTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ2pEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsbUNBQW1DLFNBQW9DO0FBQ3BGLFFBQUk7QUFFSCxZQUFNLFNBQVMsS0FBSyxPQUFPLGVBQWUsZ0JBQWdCO0FBQzFELFVBQUksQ0FBQyxRQUFRO0FBQ1osZUFBTztBQUFBLFVBQ04sU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBR0EsWUFBTSxpQkFBaUIsS0FBSyxPQUFPLGVBQWUsa0JBQWtCO0FBQ3BFLFVBQUksQ0FBQyxnQkFBZ0I7QUFDcEIsZUFBTztBQUFBLFVBQ04sU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBR0EsWUFBTSxFQUFFLGNBQWMsV0FBVyxJQUFJLEtBQUssaUJBQWlCO0FBQUEsUUFDMUQ7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxVQUNDLGVBQWU7QUFBQSxVQUNmLFlBQVksTUFBTSxLQUFLLG9CQUFvQjtBQUFBLFFBQzVDO0FBQUEsTUFDRDtBQUVBLFVBQUk7QUFFSCxjQUFNLFNBQVMsTUFBTSxLQUFLLE9BQU8sc0JBQXNCLFFBQVEsU0FBUyxDQUFDLE9BQWUsZUFBd0I7QUFDL0csdUJBQWEsT0FBTyxVQUFVO0FBQUEsUUFDL0IsQ0FBQztBQUdELG1CQUFXO0FBRVgsZUFBTztBQUFBLE1BRVIsU0FBUyxPQUFPO0FBRWYsbUJBQVc7QUFDWCxjQUFNO0FBQUEsTUFDUDtBQUFBLElBRUQsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLHVDQUF1QyxLQUFLO0FBQzFELGFBQU87QUFBQSxRQUNOLFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDakQ7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFBa0IsV0FBb0M7QUFuekc3RDtBQW96R0UsUUFBSSxDQUFDLEtBQUssYUFBYTtBQUN0QixVQUFJLHlCQUFPLHVEQUF1RCxHQUFJO0FBQ3RFO0FBQUEsSUFDRDtBQUVBLFVBQU0sYUFBdUIsQ0FBQztBQUM5QixVQUFNLHVCQUFpQyxDQUFDO0FBQ3hDLFVBQU0sZUFBeUIsQ0FBQztBQUNoQyxVQUFNLGdCQUEwQixDQUFDO0FBR2pDLFVBQU0scUJBQXFCLEtBQUssZUFBZSxxQkFBcUIsS0FBSyxZQUFZLElBQUksS0FBSyxDQUFDO0FBQy9GLFVBQU0sb0JBQW9CLENBQUMsR0FBRyxrQkFBa0I7QUFHaEQsZUFBVyxZQUFZLFdBQVc7QUFFakMsVUFBSSxPQUFPLEtBQUssSUFBSSxNQUFNLHNCQUFzQixRQUFRO0FBQ3hELFVBQUksQ0FBQyxRQUFRLEVBQUUsZ0JBQWdCLDBCQUFRO0FBQ3RDLGVBQU8sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFdBQVcsS0FBSztBQUFBLE1BQzdEO0FBQ0EsVUFBSSxDQUFDLFFBQVEsRUFBRSxnQkFBZ0IsMEJBQVE7QUFDdEMsY0FBTSxRQUFRLEtBQUssSUFBSSxNQUFNLGlCQUFpQjtBQUM5QyxlQUFPLE1BQU07QUFBQSxVQUNaLENBQUMsTUFBTSxFQUFFLGFBQWEsWUFBWSxFQUFFLFNBQVMsWUFBWSxFQUFFLEtBQUssU0FBUyxNQUFNLFFBQVEsS0FBSyxFQUFFLEtBQUssU0FBUyxNQUFNLFdBQVcsS0FBSztBQUFBLFFBQ25JLEtBQUs7QUFBQSxNQUNOO0FBRUEsVUFBSSxnQkFBZ0IseUJBQU87QUFFMUIsWUFBSSxLQUFLLFdBQVMsVUFBSyxnQkFBTCxtQkFBa0IsT0FBTTtBQUV6Qyx1QkFBYSxLQUFLLEtBQUssUUFBUTtBQUUvQixlQUFLLGFBQWEsa0JBQWtCLDhFQUE4RSxLQUFLO0FBQUEsUUFDeEgsT0FBTztBQUVOLGdCQUFNLFNBQVMsa0JBQWtCLEtBQUssU0FBTyxJQUFJLEtBQUssU0FBVSxLQUFlLElBQUk7QUFDbkYsY0FBSSxDQUFDLFFBQVE7QUFFWiw4QkFBa0IsS0FBSztBQUFBLGNBQ3RCO0FBQUEsY0FDQSxVQUFVO0FBQUEsY0FDVixjQUFjO0FBQUEsY0FDZCxjQUFjLE1BQU0sS0FBSyxRQUFRO0FBQUEsWUFDbEMsQ0FBQztBQUNELHVCQUFXLEtBQUssS0FBSyxRQUFRO0FBQUEsVUFDOUIsT0FBTztBQUVOLGlDQUFxQixLQUFLLEtBQUssUUFBUTtBQUFBLFVBQ3hDO0FBQUEsUUFDRDtBQUFBLE1BQ0QsT0FBTztBQUVOLHNCQUFjLEtBQUssUUFBUTtBQUFBLE1BQzVCO0FBQUEsSUFDRDtBQUdBLFFBQUksV0FBVyxTQUFTLEtBQUsscUJBQXFCLFNBQVMsS0FBSyxhQUFhLFNBQVMsR0FBRztBQUV4RixXQUFLLGVBQWUsdUJBQXVCLEtBQUssWUFBWSxJQUFJO0FBQ2hFLGlCQUFXLE9BQU8sbUJBQW1CO0FBQ3BDLGNBQU0sS0FBSyxlQUFlLFlBQVksSUFBSSxJQUFJO0FBQUEsTUFDL0M7QUFBQSxJQUNEO0FBR0EsVUFBTSxLQUFLLGVBQWU7QUFHMUIsVUFBTSxhQUFhLFVBQVU7QUFDN0IsVUFBTSxXQUFxQixDQUFDO0FBRTVCLFFBQUksV0FBVyxTQUFTLEdBQUc7QUFDMUIsVUFBSSxXQUFXLFdBQVcsR0FBRztBQUM1QixpQkFBUyxLQUFLLFVBQVUsV0FBVyxDQUFDLENBQUMsY0FBYztBQUFBLE1BQ3BELE9BQU87QUFDTixpQkFBUyxLQUFLLFNBQVMsV0FBVyxNQUFNLG1CQUFtQjtBQUFBLE1BQzVEO0FBQUEsSUFDRDtBQUVBLFFBQUkscUJBQXFCLFNBQVMsR0FBRztBQUNwQyxVQUFJLHFCQUFxQixXQUFXLEdBQUc7QUFDdEMsaUJBQVMsS0FBSyxJQUFJLHFCQUFxQixDQUFDLENBQUMsc0JBQXNCO0FBQUEsTUFDaEUsT0FBTztBQUNOLGlCQUFTLEtBQUssR0FBRyxxQkFBcUIsTUFBTSxxQkFBcUI7QUFBQSxNQUNsRTtBQUFBLElBQ0Q7QUFFQSxRQUFJLGFBQWEsU0FBUyxHQUFHO0FBQzVCLFVBQUksYUFBYSxXQUFXLEdBQUc7QUFDOUIsaUJBQVMsS0FBSyxtQ0FBbUM7QUFBQSxNQUNsRCxPQUFPO0FBQ04saUJBQVMsS0FBSyxHQUFHLGFBQWEsTUFBTSxzQ0FBc0M7QUFBQSxNQUMzRTtBQUFBLElBQ0Q7QUFFQSxRQUFJLGNBQWMsU0FBUyxHQUFHO0FBQzdCLFVBQUksY0FBYyxXQUFXLEdBQUc7QUFDL0IsaUJBQVMsS0FBSyxJQUFJLGNBQWMsQ0FBQyxDQUFDLGFBQWE7QUFBQSxNQUNoRCxPQUFPO0FBQ04saUJBQVMsS0FBSyxHQUFHLGNBQWMsTUFBTSxZQUFZO0FBQUEsTUFDbEQ7QUFBQSxJQUNEO0FBR0EsUUFBSSxTQUFTLFNBQVMsR0FBRztBQUN4QixZQUFNLGtCQUFrQixTQUFTLEtBQUssSUFBSTtBQUMxQyxZQUFNLFdBQVcsY0FBYyxTQUFTLElBQUksTUFBTztBQUNuRCxVQUFJLHlCQUFPLGlCQUFpQixRQUFRO0FBQUEsSUFDckM7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSw0QkFBNEIsU0FBdUIsYUFBOEI7QUFFeEYsUUFBSSxTQUFTO0FBQ1osY0FBUSxRQUFRLFFBQVE7QUFBQSxRQUN2QixLQUFLO0FBQUEsUUFDTCxLQUFLO0FBQ0osaUJBQU8sS0FBSyxnQkFBZ0IsU0FBUztBQUFBLFFBQ3RDLEtBQUs7QUFDSixpQkFBTyxLQUFLLGdCQUFnQixVQUFVO0FBQUEsUUFDdkMsS0FBSztBQUNKLGlCQUFPLEtBQUssZ0JBQWdCLFNBQVM7QUFBQSxRQUN0QyxLQUFLO0FBQ0osaUJBQU8sS0FBSyxnQkFBZ0IsU0FBUztBQUFBLFFBQ3RDO0FBQ0MsaUJBQU8sS0FBSyxnQkFBZ0IsTUFBTTtBQUFBLE1BQ3BDO0FBQUEsSUFDRCxXQUFXLGFBQWE7QUFFdkIsVUFBSSxZQUFZLFNBQVMsU0FBUyxLQUFLLFlBQVksU0FBUyxLQUFLLEtBQUssWUFBWSxTQUFTLFNBQVMsR0FBRztBQUN0RyxlQUFPLEtBQUssZ0JBQWdCLFNBQVM7QUFBQSxNQUN0QyxXQUFXLFlBQVksU0FBUyxLQUFLLEtBQUssWUFBWSxTQUFTLFFBQVEsS0FBSyxZQUFZLFNBQVMsT0FBTyxHQUFHO0FBQzFHLGVBQU8sS0FBSyxnQkFBZ0IsVUFBVTtBQUFBLE1BQ3ZDLFdBQVcsWUFBWSxTQUFTLFFBQVEsS0FBSyxZQUFZLFNBQVMsR0FBRyxHQUFHO0FBQ3ZFLGVBQU8sS0FBSyxnQkFBZ0IsUUFBUTtBQUFBLE1BQ3JDO0FBQUEsSUFDRDtBQUVBLFdBQU8sS0FBSyxnQkFBZ0IsTUFBTTtBQUFBLEVBQ25DO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsVUFBMEI7QUFDakQsVUFBTSxVQUFvQztBQUFBLE1BQ3pDLFdBQVcsQ0FBQyxlQUFlLGdCQUFnQixnQkFBZ0IsZUFBZSxpQkFBaUIsZ0JBQWdCLGlCQUFpQixnQkFBZ0Isa0JBQWtCLGNBQWM7QUFBQSxNQUM1SyxZQUFZLENBQUMsZUFBZSxlQUFlLGlCQUFpQixnQkFBZ0IsY0FBYyxlQUFlLGtCQUFrQixlQUFlLG1CQUFtQixhQUFhO0FBQUEsTUFDMUssVUFBVSxDQUFDLGlCQUFpQixnQkFBZ0IsZUFBZSxrQkFBa0IsaUJBQWlCLGNBQWMsZ0JBQWdCLGlCQUFpQixtQkFBbUIsaUJBQWlCO0FBQUEsTUFDakwsV0FBVyxDQUFDLGlCQUFpQixnQkFBZ0IsY0FBYyxnQkFBZ0Isa0JBQWtCLGdCQUFnQixpQkFBaUIsbUJBQW1CLGdCQUFnQixhQUFhO0FBQUEsTUFDOUssUUFBUSxDQUFDLGVBQWUsaUJBQWlCLGtCQUFrQixnQkFBZ0Isb0JBQW9CLG9CQUFvQixnQkFBZ0IsaUJBQWlCLG9CQUFvQixjQUFjO0FBQUEsSUFDdkw7QUFFQSxVQUFNLGtCQUFrQixRQUFRLFFBQVEsS0FBSyxRQUFRO0FBQ3JELFdBQU8sZ0JBQWdCLEtBQUssTUFBTSxLQUFLLE9BQU8sSUFBSSxnQkFBZ0IsTUFBTSxDQUFDO0FBQUEsRUFDMUU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDRCQUE0QixRQUFxQixTQUF1QixhQUE0QjtBQUUzRyxVQUFNLG1CQUFtQixZQUFZLE1BQU07QUFDMUMsWUFBTSxZQUFZLEtBQUssNEJBQTRCLFNBQVMsV0FBVztBQUN2RSxhQUFPLGNBQWM7QUFBQSxJQUN0QixHQUFHLEdBQUk7QUFHUCxJQUFDLE9BQWUsbUJBQW1CO0FBQUEsRUFDcEM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDJCQUEyQixRQUEyQjtBQUM3RCxRQUFLLE9BQWUsa0JBQWtCO0FBQ3JDLG9CQUFlLE9BQWUsZ0JBQWdCO0FBQzlDLE1BQUMsT0FBZSxtQkFBbUI7QUFBQSxJQUNwQztBQUFBLEVBQ0Q7QUFFRDtBQTk5R2EsaUJBeURZLDhCQUE4QjtBQXpEMUMsaUJBMERZLGtCQUFrQjtBQTFEOUIsaUJBMkRZLGlCQUFpQjtBQTNEN0IsaUJBNERZLG1CQUFtQjtBQTVEL0IsaUJBNkRZLHFCQUFxQjtBQTdEdkMsSUFBTSxrQkFBTjs7O0FlaEJQLElBQUFFLG9CQUEyQjtBQUVwQixJQUFNLGlCQUFOLE1BQTJDO0FBQUEsRUFLakQsWUFBWSxRQUF3QjtBQUpwQyxnQkFBTztBQUVQLFNBQVEsZUFBZ0M7QUFHdkMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsYUFBYSxRQUF3QjtBQUNwQyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxNQUFNLGNBQWdDO0FBQ3JDLFdBQU8sQ0FBQyxDQUFDLEtBQUssT0FBTztBQUFBLEVBQ3RCO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTQSxRQUFPLENBQUM7QUFDaEUsV0FBTyxLQUFLLGVBQWUsVUFBVSxPQUFPO0FBQUEsRUFDN0M7QUFBQSxFQUVBLE9BQU8sbUJBQW1CQSxTQUFnQixTQUFpRTtBQUMxRyxVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxxQkFBcUIsVUFBVSxPQUFPO0FBQUEsRUFDbkQ7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixRQUFJLENBQUMsS0FBSyxPQUFPLFFBQVE7QUFDeEIsWUFBTSxJQUFJLE1BQU0sK0JBQStCO0FBQUEsSUFDaEQ7QUFFQSxVQUFNLGNBQWMsS0FBSyxVQUFVO0FBQUEsTUFDbEMsUUFBTyxtQ0FBUyxVQUFTLEtBQUssT0FBTyxTQUFTO0FBQUEsTUFDOUMsYUFBWSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDM0QsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLE1BQ2hFLFFBQVEsbUNBQVM7QUFBQSxNQUNqQixVQUFVLFNBQVMsSUFBSSxVQUFRO0FBQUEsUUFDOUIsTUFBTSxJQUFJLFNBQVMsY0FBYyxjQUFjO0FBQUEsUUFDL0MsU0FBUyxJQUFJO0FBQUEsTUFDZCxFQUFFO0FBQUEsSUFDSCxDQUFDO0FBR0QsVUFBTSxhQUFhO0FBQ25CLFVBQU0sWUFBWTtBQUVsQixhQUFTLFVBQVUsR0FBRyxXQUFXLFlBQVksV0FBVztBQUN2RCxVQUFJO0FBQ0gsY0FBTSxXQUFXLFVBQU0sOEJBQVc7QUFBQSxVQUNqQyxLQUFLO0FBQUEsVUFDTCxRQUFRO0FBQUEsVUFDUixTQUFTO0FBQUEsWUFDUixnQkFBZ0I7QUFBQSxZQUNoQixhQUFhLEtBQUssT0FBTztBQUFBLFlBQ3pCLHFCQUFxQjtBQUFBLFVBQ3RCO0FBQUEsVUFDQSxNQUFNO0FBQUEsUUFDUCxDQUFDO0FBRUQsWUFBSSxTQUFTLFdBQVcsS0FBSztBQUM1QixnQkFBTSxPQUFPLFNBQVM7QUFDdEIsaUJBQU8sS0FBSyxRQUFRLENBQUMsRUFBRTtBQUFBLFFBQ3hCO0FBR0EsWUFBSSxTQUFTLFVBQVUsT0FBTyxVQUFVLFlBQVk7QUFDbkQsZ0JBQU0sUUFBUSxZQUFZLEtBQUssSUFBSSxHQUFHLE9BQU87QUFDN0MsZ0JBQU0sSUFBSSxRQUFRLGFBQVcsV0FBVyxTQUFTLEtBQUssQ0FBQztBQUN2RDtBQUFBLFFBQ0Q7QUFHQSxjQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxNQUFNLE1BQU0sU0FBUyxJQUFJLEVBQUU7QUFBQSxNQUUxRSxTQUFTLE9BQU87QUFFZixZQUFJLFVBQVUsY0FBYyxpQkFBaUIsVUFDNUMsTUFBTSxRQUFRLFNBQVMsZUFBZSxLQUN0QyxNQUFNLFFBQVEsU0FBUyxtQkFBbUIsSUFDeEM7QUFDRixnQkFBTSxRQUFRLFlBQVksS0FBSyxJQUFJLEdBQUcsT0FBTztBQUM3QyxnQkFBTSxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsS0FBSyxDQUFDO0FBQ3ZEO0FBQUEsUUFDRDtBQUdBLFlBQUksaUJBQWlCLFNBQVMsTUFBTSxRQUFRLFdBQVcsbUJBQW1CLEdBQUc7QUFDNUUsZ0JBQU07QUFBQSxRQUNQO0FBQ0EsY0FBTSxJQUFJLE1BQU0sb0NBQW9DLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxNQUMvRztBQUFBLElBQ0Q7QUFHQSxVQUFNLElBQUksTUFBTSxzQ0FBc0M7QUFBQSxFQUN2RDtBQUFBLEVBRUEsTUFBTSxTQUFTLGNBQXNCLFlBQW9CLFNBQWdEO0FBQ3hHLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTLFdBQVcsQ0FBQztBQUNwRSxVQUFNLGtCQUFrQixFQUFFLEdBQUcsU0FBUyxhQUFhO0FBQ25ELFdBQU8sS0FBSyxlQUFlLFVBQVUsZUFBZTtBQUFBLEVBQ3JEO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQUVuSCxVQUFNLFNBQVMsTUFBTSxLQUFLLGVBQWUsVUFBVSxPQUFPO0FBRzFELFVBQU0sWUFBWTtBQUNsQixhQUFTLElBQUksR0FBRyxJQUFJLE9BQU8sUUFBUSxLQUFLLFdBQVc7QUFDbEQsWUFBTSxRQUFRLE9BQU8sTUFBTSxHQUFHLElBQUksU0FBUztBQUMzQyxZQUFNLEVBQUUsU0FBUyxPQUFPLE1BQU0sTUFBTTtBQUVwQyxZQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxFQUFFLENBQUM7QUFBQSxJQUNyRDtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXdDO0FBQzdDLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUdBLFFBQUksS0FBSyxjQUFjO0FBQ3RCLGFBQU8sS0FBSztBQUFBLElBQ2I7QUFJQSxRQUFJO0FBRUgsWUFBTSxXQUFXLFVBQU0sOEJBQVc7QUFBQSxRQUNqQyxLQUFLO0FBQUEsUUFDTCxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixnQkFBZ0I7QUFBQSxVQUNoQixhQUFhLEtBQUssT0FBTztBQUFBLFVBQ3pCLHFCQUFxQjtBQUFBLFFBQ3RCO0FBQUEsUUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFVBQ3BCLE9BQU87QUFBQSxVQUNQLFlBQVk7QUFBQSxVQUNaLFVBQVUsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTLE9BQU8sQ0FBQztBQUFBLFFBQzdDLENBQUM7QUFBQSxNQUNGLENBQUM7QUFFRCxVQUFJLFNBQVMsV0FBVyxLQUFLO0FBQzVCLGNBQU0sSUFBSSxNQUFNLDhCQUE4QixTQUFTLE1BQU0sTUFBTSxTQUFTLElBQUksRUFBRTtBQUFBLE1BQ25GO0FBR0EsWUFBTSxTQUFTO0FBQUEsUUFDZDtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNEO0FBRUEsV0FBSyxlQUFlO0FBQ3BCLGFBQU87QUFBQSxJQUNSLFNBQVMsT0FBTztBQUNmLFlBQU0sSUFBSSxNQUFNLGtDQUFrQyxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDN0c7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBd0I7QUFDdkIsU0FBSyxlQUFlO0FBQUEsRUFDckI7QUFDRDs7O0FDbkxPLElBQU0saUJBQU4sTUFBMkM7QUFBQSxFQUtqRCxZQUFZLFFBQXdCO0FBSnBDLGdCQUFPO0FBRVAsU0FBUSxlQUFnQztBQUd2QyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxhQUFhLFFBQXdCO0FBQ3BDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLE1BQU0sY0FBZ0M7QUFDckMsV0FBTyxDQUFDLENBQUMsS0FBSyxPQUFPO0FBQUEsRUFDdEI7QUFBQSxFQUVBLE1BQU0sYUFBYUMsU0FBZ0IsU0FBZ0Q7QUFDbEYsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVNBLFFBQU8sQ0FBQztBQUNoRSxXQUFPLEtBQUssZUFBZSxVQUFVLE9BQU87QUFBQSxFQUM3QztBQUFBLEVBRUEsT0FBTyxtQkFBbUJBLFNBQWdCLFNBQWlFO0FBQzFHLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTQSxRQUFPLENBQUM7QUFDaEUsV0FBTyxLQUFLLHFCQUFxQixVQUFVLE9BQU87QUFBQSxFQUNuRDtBQUFBLEVBRUEsTUFBTSxlQUFlLFVBQXVCLFNBQWdEO0FBQzNGLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sa0JBQWtCLENBQUMsR0FBRyxRQUFRO0FBQ3BDLFFBQUksbUNBQVMsY0FBYztBQUMxQixzQkFBZ0IsUUFBUSxFQUFFLE1BQU0sVUFBVSxTQUFTLFFBQVEsYUFBYSxDQUFDO0FBQUEsSUFDMUU7QUFFQSxVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxXQUFXLFFBQVEsU0FBUyxtQkFBbUIsSUFBSSxVQUFVLEdBQUcsT0FBTztBQUU3RSxVQUFNLGNBQWMsS0FBSyxVQUFVO0FBQUEsTUFDbEMsUUFBTyxtQ0FBUyxVQUFTLEtBQUssT0FBTyxTQUFTO0FBQUEsTUFDOUMsVUFBVTtBQUFBLE1BQ1YsYUFBWSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDM0QsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLElBQ2pFLENBQUM7QUFHRCxVQUFNLGFBQWE7QUFDbkIsVUFBTSxZQUFZO0FBRWxCLGFBQVMsVUFBVSxHQUFHLFdBQVcsWUFBWSxXQUFXO0FBQ3ZELFVBQUk7QUFDSCxjQUFNLFdBQVcsTUFBTSxNQUFNLFVBQVU7QUFBQSxVQUN0QyxRQUFRO0FBQUEsVUFDUixTQUFTO0FBQUEsWUFDUixnQkFBZ0I7QUFBQSxZQUNoQixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sTUFBTTtBQUFBLFVBQzlDO0FBQUEsVUFDQSxNQUFNO0FBQUEsUUFDUCxDQUFDO0FBRUQsWUFBSSxTQUFTLElBQUk7QUFDaEIsZ0JBQU0sT0FBTyxNQUFNLFNBQVMsS0FBSztBQUNqQyxpQkFBTyxLQUFLLFFBQVEsQ0FBQyxFQUFFLFFBQVE7QUFBQSxRQUNoQztBQUdBLFlBQUksU0FBUyxVQUFVLE9BQU8sVUFBVSxZQUFZO0FBQ25ELGdCQUFNLFFBQVEsWUFBWSxLQUFLLElBQUksR0FBRyxPQUFPO0FBQzdDLGdCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxLQUFLLENBQUM7QUFDdkQ7QUFBQSxRQUNEO0FBR0EsY0FBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsTUFFM0QsU0FBUyxPQUFPO0FBRWYsWUFBSSxVQUFVLGNBQWMsaUJBQWlCLFNBQVMsTUFBTSxRQUFRLFNBQVMsT0FBTyxHQUFHO0FBQ3RGLGdCQUFNLFFBQVEsWUFBWSxLQUFLLElBQUksR0FBRyxPQUFPO0FBQzdDLGdCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxLQUFLLENBQUM7QUFDdkQ7QUFBQSxRQUNEO0FBR0EsY0FBTTtBQUFBLE1BQ1A7QUFBQSxJQUNEO0FBR0EsVUFBTSxJQUFJLE1BQU0sc0NBQXNDO0FBQUEsRUFDdkQ7QUFBQSxFQUVBLE1BQU0sU0FBUyxjQUFzQixZQUFvQixTQUFnRDtBQUN4RyxVQUFNLFdBQXdCO0FBQUEsTUFDN0IsRUFBRSxNQUFNLFVBQVUsU0FBUyxhQUFhO0FBQUEsTUFDeEMsRUFBRSxNQUFNLFFBQVEsU0FBUyxXQUFXO0FBQUEsSUFDckM7QUFDQSxXQUFPLEtBQUssZUFBZSxVQUFVLE9BQU87QUFBQSxFQUM3QztBQUFBLEVBRUEsT0FBTyxxQkFBcUIsVUFBdUIsU0FBaUU7QUF4R3JIO0FBeUdFLFFBQUksQ0FBQyxLQUFLLE9BQU8sUUFBUTtBQUN4QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sa0JBQWtCLENBQUMsR0FBRyxRQUFRO0FBQ3BDLFFBQUksbUNBQVMsY0FBYztBQUMxQixzQkFBZ0IsUUFBUSxFQUFFLE1BQU0sVUFBVSxTQUFTLFFBQVEsYUFBYSxDQUFDO0FBQUEsSUFDMUU7QUFFQSxVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxXQUFXLFFBQVEsU0FBUyxtQkFBbUIsSUFBSSxVQUFVLEdBQUcsT0FBTztBQUM3RSxVQUFNLFdBQVcsTUFBTSxNQUFNLFVBQVU7QUFBQSxNQUN0QyxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxRQUNoQixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sTUFBTTtBQUFBLE1BQzlDO0FBQUEsTUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCLFFBQU8sbUNBQVMsVUFBUyxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzlDLFVBQVU7QUFBQSxRQUNWLGFBQVksbUNBQVMsY0FBYSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQzNELGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxRQUNoRSxRQUFRO0FBQUEsTUFDVCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLElBQUksTUFBTSxxQkFBcUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxJQUMzRDtBQUVBLFVBQU0sVUFBUyxjQUFTLFNBQVQsbUJBQWU7QUFDOUIsUUFBSSxDQUFDLFFBQVE7QUFDWixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNoRDtBQUVBLFVBQU0sVUFBVSxJQUFJLFlBQVk7QUFDaEMsUUFBSSxTQUFTO0FBRWIsUUFBSTtBQUNILGFBQU8sTUFBTTtBQUNaLGNBQU0sRUFBRSxNQUFNLE1BQU0sSUFBSSxNQUFNLE9BQU8sS0FBSztBQUMxQyxZQUFJLEtBQU07QUFFVixrQkFBVSxRQUFRLE9BQU8sT0FBTyxFQUFFLFFBQVEsS0FBSyxDQUFDO0FBQ2hELGNBQU0sUUFBUSxPQUFPLE1BQU0sSUFBSTtBQUMvQixpQkFBUyxNQUFNLElBQUksS0FBSztBQUV4QixtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLFdBQVcsUUFBUSxHQUFHO0FBQzlCLGtCQUFNLE9BQU8sS0FBSyxNQUFNLENBQUM7QUFDekIsZ0JBQUksU0FBUyxVQUFVO0FBQ3RCLG9CQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUNoQztBQUFBLFlBQ0Q7QUFFQSxnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsb0JBQU0sV0FBVSx3QkFBTyxZQUFQLG1CQUFpQixPQUFqQixtQkFBcUIsVUFBckIsbUJBQTRCO0FBQzVDLGtCQUFJLFNBQVM7QUFFWixzQkFBTSxZQUFZO0FBQ2xCLHlCQUFTLElBQUksR0FBRyxJQUFJLFFBQVEsUUFBUSxLQUFLLFdBQVc7QUFDbkQsd0JBQU0sUUFBUSxRQUFRLE1BQU0sR0FBRyxJQUFJLFNBQVM7QUFDNUMsd0JBQU0sRUFBRSxTQUFTLE9BQU8sTUFBTSxNQUFNO0FBRXBDLHdCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxFQUFFLENBQUM7QUFBQSxnQkFDckQ7QUFBQSxjQUNEO0FBQUEsWUFDRCxTQUFTLEdBQUc7QUFBQSxZQUVaO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRCxVQUFFO0FBQ0QsYUFBTyxZQUFZO0FBQUEsSUFDcEI7QUFFQSxVQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUFBLEVBQ2pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHFCQUF3QztBQUM3QyxRQUFJLENBQUMsS0FBSyxPQUFPLFFBQVE7QUFDeEIsWUFBTSxJQUFJLE1BQU0sK0JBQStCO0FBQUEsSUFDaEQ7QUFHQSxRQUFJLEtBQUssY0FBYztBQUN0QixhQUFPLEtBQUs7QUFBQSxJQUNiO0FBRUEsUUFBSTtBQUNILFlBQU0sVUFBVSxLQUFLLE9BQU8sV0FBVztBQUN2QyxZQUFNLFdBQVcsUUFBUSxTQUFTLFNBQVMsSUFBSSxVQUFVLEdBQUcsT0FBTztBQUVuRSxZQUFNLFdBQVcsTUFBTSxNQUFNLFVBQVU7QUFBQSxRQUN0QyxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sTUFBTTtBQUFBLFFBQzlDO0FBQUEsTUFDRCxDQUFDO0FBRUQsVUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixjQUFNLElBQUksTUFBTSx1QkFBdUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxNQUM3RDtBQUVBLFlBQU0sT0FBTyxNQUFNLFNBQVMsS0FBSztBQUdqQyxZQUFNLFNBQVM7QUFBQSxRQUNkO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0Q7QUFFQSxXQUFLLGVBQWU7QUFDcEIsYUFBTztBQUFBLElBQ1IsU0FBUyxPQUFPO0FBQ2YsWUFBTSxJQUFJLE1BQU0sa0NBQWtDLGlCQUFpQixRQUFRLE1BQU0sVUFBVSxlQUFlLEVBQUU7QUFBQSxJQUM3RztBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGtCQUF3QjtBQUN2QixTQUFLLGVBQWU7QUFBQSxFQUNyQjtBQUNEOzs7QUM1T08sSUFBTSxpQkFBTixNQUEyQztBQUFBLEVBS2pELFlBQVksUUFBd0I7QUFKcEMsZ0JBQU87QUFFUCxTQUFRLGVBQWdDO0FBR3ZDLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLGFBQWEsUUFBd0I7QUFDcEMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsTUFBTSxjQUFnQztBQUNyQyxXQUFPLENBQUMsQ0FBQyxLQUFLLE9BQU87QUFBQSxFQUN0QjtBQUFBLEVBRUEsTUFBTSxhQUFhQyxTQUFnQixTQUFnRDtBQUNsRixVQUFNLFdBQXdCLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBU0EsUUFBTyxDQUFDO0FBQ2hFLFdBQU8sS0FBSyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLG1CQUFtQkEsU0FBZ0IsU0FBaUU7QUFDMUcsVUFBTSxXQUF3QixDQUFDLEVBQUUsTUFBTSxRQUFRLFNBQVNBLFFBQU8sQ0FBQztBQUNoRSxXQUFPLEtBQUsscUJBQXFCLFVBQVUsT0FBTztBQUFBLEVBQ25EO0FBQUEsRUFFUSx3QkFBd0IsVUFBNEI7QUFDM0QsVUFBTSxXQUFXLENBQUM7QUFFbEIsZUFBVyxXQUFXLFVBQVU7QUFDL0IsWUFBTSxPQUFPLFFBQVEsU0FBUyxjQUFjLFVBQVU7QUFDdEQsZUFBUyxLQUFLO0FBQUEsUUFDYjtBQUFBLFFBQ0EsT0FBTyxDQUFDLEVBQUUsTUFBTSxRQUFRLFFBQVEsQ0FBQztBQUFBLE1BQ2xDLENBQUM7QUFBQSxJQUNGO0FBR0EsUUFBSSxTQUFTLFdBQVcsR0FBRztBQUMxQixZQUFNLElBQUksTUFBTSxxQ0FBcUM7QUFBQSxJQUN0RDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxNQUFNLGVBQWUsVUFBdUIsU0FBZ0Q7QUFDM0YsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBR0EsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPLFNBQVM7QUFDckQsVUFBTSxNQUFNLDJEQUEyRCxLQUFLLHdCQUF3QixLQUFLLE9BQU8sTUFBTTtBQUd0SCxVQUFNLGNBQW1CO0FBQUEsTUFDeEIsVUFBVSxLQUFLLHdCQUF3QixRQUFRO0FBQUEsTUFDL0Msa0JBQWtCO0FBQUEsUUFDakIsY0FBYSxtQ0FBUyxnQkFBZSxLQUFLLE9BQU8sZUFBZTtBQUFBLFFBQ2hFLGtCQUFpQixtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDakU7QUFBQSxJQUNEO0FBR0EsU0FBSSxtQ0FBUyxpQkFBZ0IsUUFBUSxhQUFhLEtBQUssR0FBRztBQUN6RCxrQkFBWSxvQkFBb0I7QUFBQSxRQUMvQixPQUFPLENBQUMsRUFBRSxNQUFNLFFBQVEsYUFBYSxDQUFDO0FBQUEsTUFDdkM7QUFBQSxJQUNEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSxLQUFLO0FBQUEsTUFDakMsUUFBUTtBQUFBLE1BQ1IsU0FBUztBQUFBLFFBQ1IsZ0JBQWdCO0FBQUEsTUFDakI7QUFBQSxNQUNBLE1BQU0sS0FBSyxVQUFVLFdBQVc7QUFBQSxJQUNqQyxDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLFlBQVksTUFBTSxTQUFTLEtBQUs7QUFDdEMsVUFBSSxlQUFlO0FBRW5CLFVBQUk7QUFDSCxjQUFNLFlBQVksS0FBSyxNQUFNLFNBQVM7QUFDdEMsWUFBSSxVQUFVLE9BQU87QUFFcEIsZ0JBQU0sT0FBTyxVQUFVLE1BQU0sUUFBUSxTQUFTO0FBQzlDLGdCQUFNLFVBQVUsVUFBVSxNQUFNLFdBQVcsVUFBVSxNQUFNLFVBQVUsU0FBUztBQUM5RSx5QkFBZSxJQUFJLElBQUksTUFBTSxPQUFPO0FBR3BDLGNBQUksU0FBUyxXQUFXLEtBQUs7QUFDNUIsNEJBQWdCO0FBQUEsVUFDakIsV0FBVyxTQUFTLFdBQVcsS0FBSztBQUNuQyw0QkFBZ0I7QUFBQSxVQUNqQixXQUFXLFNBQVMsV0FBVyxLQUFLO0FBQ25DLDRCQUFnQjtBQUFBLFVBQ2pCLFdBQVcsU0FBUyxXQUFXLEtBQUs7QUFDbkMsNEJBQWdCO0FBQUEsVUFDakI7QUFBQSxRQUNELE9BQU87QUFDTix5QkFBZSxJQUFJLFNBQVMsTUFBTSxNQUFNLFNBQVM7QUFBQSxRQUNsRDtBQUFBLE1BQ0QsU0FBUyxHQUFHO0FBQ1gsdUJBQWUsSUFBSSxTQUFTLE1BQU0sTUFBTSxhQUFhLFNBQVMsVUFBVTtBQUFBLE1BQ3pFO0FBR0EsY0FBUSxNQUFNLDZCQUE2QjtBQUFBLFFBQzFDLFFBQVEsU0FBUztBQUFBLFFBQ2pCLFlBQVksU0FBUztBQUFBLFFBQ3JCO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRCxDQUFDO0FBRUQsWUFBTSxJQUFJLE1BQU0sb0JBQW9CLFlBQVksRUFBRTtBQUFBLElBQ25EO0FBRUEsVUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBSWpDLFFBQUksQ0FBQyxLQUFLLGNBQWMsS0FBSyxXQUFXLFdBQVcsR0FBRztBQUVyRCxVQUFJLEtBQUssT0FBTztBQUNmLGNBQU0sSUFBSSxNQUFNLHFCQUFxQixLQUFLLE1BQU0sV0FBVyxLQUFLLFVBQVUsS0FBSyxLQUFLLENBQUMsRUFBRTtBQUFBLE1BQ3hGO0FBQ0EsWUFBTSxJQUFJLE1BQU0sbUNBQW1DO0FBQUEsSUFDcEQ7QUFHQSxRQUFJLEtBQUssV0FBVyxDQUFDLEVBQUUsaUJBQWlCLFlBQVksS0FBSyxXQUFXLENBQUMsRUFBRSxpQkFBaUIsV0FBVztBQUNsRyxZQUFNLElBQUksTUFBTSx1REFBdUQ7QUFBQSxJQUN4RTtBQUdBLFFBQUksS0FBSyxXQUFXLENBQUMsRUFBRSxpQkFBaUIsaUJBQ25DLENBQUMsS0FBSyxXQUFXLENBQUMsRUFBRSxXQUFXLENBQUMsS0FBSyxXQUFXLENBQUMsRUFBRSxRQUFRLFNBQVMsS0FBSyxXQUFXLENBQUMsRUFBRSxRQUFRLE1BQU0sV0FBVyxJQUFJO0FBQ3hILFlBQU0sSUFBSSxNQUFNLHNHQUFzRztBQUFBLElBQ3ZIO0FBR0EsUUFBSSxLQUFLLFdBQVcsQ0FBQyxFQUFFLFdBQVcsS0FBSyxXQUFXLENBQUMsRUFBRSxRQUFRLFNBQVMsS0FBSyxXQUFXLENBQUMsRUFBRSxRQUFRLE1BQU0sU0FBUyxHQUFHO0FBQ2xILFlBQU0sT0FBTyxLQUFLLFdBQVcsQ0FBQyxFQUFFLFFBQVEsTUFBTSxDQUFDLEVBQUU7QUFJakQsVUFBSSxLQUFLLFdBQVcsQ0FBQyxFQUFFLGlCQUFpQixjQUFjO0FBQ3JELGNBQU0sSUFBSSxNQUFNLDhGQUE4RjtBQUFBLE1BQy9HO0FBR0EsVUFBSSxDQUFDLFFBQVEsS0FBSyxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ3RDLGdCQUFRLE1BQU0sd0NBQXdDO0FBQ3RELGNBQU0sSUFBSSxNQUFNLHdDQUF3QztBQUFBLE1BQ3pEO0FBRUEsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLElBQUksTUFBTSxvQ0FBb0M7QUFBQSxFQUNyRDtBQUFBLEVBRUEsTUFBTSxTQUFTLGNBQXNCLFlBQW9CLFNBQWdEO0FBQ3hHLFVBQU0sV0FBd0IsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTLFdBQVcsQ0FBQztBQUNwRSxVQUFNLGtCQUFrQixFQUFFLEdBQUcsU0FBUyxhQUFhO0FBQ25ELFdBQU8sS0FBSyxlQUFlLFVBQVUsZUFBZTtBQUFBLEVBQ3JEO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQTlLckg7QUErS0UsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBR0EsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPLFNBQVM7QUFDckQsVUFBTSxNQUFNLDJEQUEyRCxLQUFLLDhCQUE4QixLQUFLLE9BQU8sTUFBTTtBQUU1SCxVQUFNLFdBQVcsTUFBTSxNQUFNLEtBQUs7QUFBQSxNQUNqQyxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsUUFDUixnQkFBZ0I7QUFBQSxNQUNqQjtBQUFBLE1BQ0EsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQixVQUFVLEtBQUssd0JBQXdCLFFBQVE7QUFBQSxRQUMvQyxrQkFBa0I7QUFBQSxVQUNqQixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsa0JBQWlCLG1DQUFTLGNBQWEsS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUNqRTtBQUFBLFFBQ0EsSUFBSSxtQ0FBUyxpQkFBZ0IsUUFBUSxhQUFhLEtBQUssSUFBSTtBQUFBLFVBQzFELG1CQUFtQjtBQUFBLFlBQ2xCLE9BQU8sQ0FBQyxFQUFFLE1BQU0sUUFBUSxhQUFhLENBQUM7QUFBQSxVQUN2QztBQUFBLFFBQ0QsSUFBSSxDQUFDO0FBQUEsTUFDTixDQUFDO0FBQUEsSUFDRixDQUFDO0FBRUQsUUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixZQUFNLFlBQVksTUFBTSxTQUFTLEtBQUs7QUFDdEMsVUFBSSxlQUFlO0FBRW5CLFVBQUk7QUFDSCxjQUFNLFlBQVksS0FBSyxNQUFNLFNBQVM7QUFDdEMsWUFBSSxVQUFVLE9BQU87QUFDcEIsZ0JBQU0sT0FBTyxVQUFVLE1BQU0sUUFBUSxTQUFTO0FBQzlDLGdCQUFNLFVBQVUsVUFBVSxNQUFNLFdBQVcsVUFBVSxNQUFNLFVBQVUsU0FBUztBQUM5RSx5QkFBZSxJQUFJLElBQUksTUFBTSxPQUFPO0FBQUEsUUFDckMsT0FBTztBQUNOLHlCQUFlLElBQUksU0FBUyxNQUFNLE1BQU0sU0FBUztBQUFBLFFBQ2xEO0FBQUEsTUFDRCxTQUFTLEdBQUc7QUFDWCx1QkFBZSxJQUFJLFNBQVMsTUFBTSxNQUFNLGFBQWEsU0FBUyxVQUFVO0FBQUEsTUFDekU7QUFFQSxZQUFNLElBQUksTUFBTSxvQkFBb0IsWUFBWSxFQUFFO0FBQUEsSUFDbkQ7QUFFQSxVQUFNLFVBQVMsY0FBUyxTQUFULG1CQUFlO0FBQzlCLFFBQUksQ0FBQyxRQUFRO0FBQ1osWUFBTSxJQUFJLE1BQU0sK0JBQStCO0FBQUEsSUFDaEQ7QUFFQSxVQUFNLFVBQVUsSUFBSSxZQUFZO0FBQ2hDLFFBQUksU0FBUztBQUNiLFFBQUksYUFBYTtBQUNqQixRQUFJLGFBQWE7QUFDakIsUUFBSSxTQUFTO0FBRWIsUUFBSTtBQUNILGFBQU8sTUFBTTtBQUNaLGNBQU0sRUFBRSxNQUFNLE1BQU0sSUFBSSxNQUFNLE9BQU8sS0FBSztBQUMxQyxZQUFJLEtBQU07QUFFVixrQkFBVSxRQUFRLE9BQU8sT0FBTyxFQUFFLFFBQVEsS0FBSyxDQUFDO0FBR2hELGlCQUFTLElBQUksR0FBRyxJQUFJLE9BQU8sUUFBUSxLQUFLO0FBQ3ZDLGdCQUFNLE9BQU8sT0FBTyxDQUFDO0FBRXJCLGNBQUksU0FBUyxLQUFLO0FBQ2pCLGdCQUFJLENBQUMsUUFBUTtBQUNaLHVCQUFTO0FBQ1QsMkJBQWE7QUFBQSxZQUNkO0FBQ0E7QUFDQSwwQkFBYztBQUFBLFVBQ2YsV0FBVyxTQUFTLEtBQUs7QUFDeEIsMEJBQWM7QUFDZDtBQUVBLGdCQUFJLGVBQWUsS0FBSyxRQUFRO0FBRS9CLGtCQUFJO0FBQ0gsc0JBQU0sU0FBUyxLQUFLLE1BQU0sVUFBVTtBQUNwQyxzQkFBTSxRQUFPLG9DQUFPLGVBQVAsbUJBQW9CLE9BQXBCLG1CQUF3QixZQUF4QixtQkFBaUMsVUFBakMsbUJBQXlDLE9BQXpDLG1CQUE2QztBQUMxRCxvQkFBSSxNQUFNO0FBRVQsd0JBQU0sWUFBWTtBQUNsQiwyQkFBU0MsS0FBSSxHQUFHQSxLQUFJLEtBQUssUUFBUUEsTUFBSyxXQUFXO0FBQ2hELDBCQUFNLFFBQVEsS0FBSyxNQUFNQSxJQUFHQSxLQUFJLFNBQVM7QUFDekMsMEJBQU0sRUFBRSxTQUFTLE9BQU8sTUFBTSxNQUFNO0FBRXBDLDBCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxFQUFFLENBQUM7QUFBQSxrQkFDckQ7QUFBQSxnQkFDRDtBQUFBLGNBQ0QsU0FBUyxHQUFHO0FBQUEsY0FFWjtBQUVBLHVCQUFTO0FBQ1QsMkJBQWE7QUFBQSxZQUNkO0FBQUEsVUFDRCxXQUFXLFFBQVE7QUFDbEIsMEJBQWM7QUFBQSxVQUNmO0FBQUEsUUFDRDtBQUdBLGlCQUFTO0FBQUEsTUFDVjtBQUFBLElBQ0QsVUFBRTtBQUNELGFBQU8sWUFBWTtBQUFBLElBQ3BCO0FBRUEsVUFBTSxFQUFFLFNBQVMsSUFBSSxNQUFNLEtBQUs7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxxQkFBd0M7QUFDN0MsUUFBSSxDQUFDLEtBQUssT0FBTyxRQUFRO0FBQ3hCLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBR0EsUUFBSSxLQUFLLGNBQWM7QUFDdEIsYUFBTyxLQUFLO0FBQUEsSUFDYjtBQUVBLFFBQUk7QUFDSCxZQUFNLE1BQU0sK0RBQStELEtBQUssT0FBTyxNQUFNO0FBRTdGLFlBQU0sV0FBVyxNQUFNLE1BQU0sS0FBSztBQUFBLFFBQ2pDLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGdCQUFnQjtBQUFBLFFBQ2pCO0FBQUEsTUFDRCxDQUFDO0FBRUQsVUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNqQixjQUFNLElBQUksTUFBTSx1QkFBdUIsU0FBUyxVQUFVLEVBQUU7QUFBQSxNQUM3RDtBQUVBLFlBQU0sT0FBTyxNQUFNLFNBQVMsS0FBSztBQUdqQyxZQUFNLFNBQVM7QUFBQSxRQUNkO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUVBLFdBQUssZUFBZTtBQUNwQixhQUFPO0FBQUEsSUFDUixTQUFTLE9BQU87QUFDZixZQUFNLElBQUksTUFBTSxrQ0FBa0MsaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQzdHO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQXdCO0FBQ3ZCLFNBQUssZUFBZTtBQUFBLEVBQ3JCO0FBQ0Q7OztBQ3BWTyxJQUFNLGlCQUFOLE1BQTJDO0FBQUEsRUFJakQsWUFBWSxRQUF3QjtBQUhwQyxnQkFBTztBQUlOLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLGFBQWEsUUFBd0I7QUFDcEMsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsTUFBTSxjQUFnQztBQUNyQyxRQUFJLENBQUMsS0FBSyxPQUFPLE1BQU8sUUFBTztBQUUvQixRQUFJO0FBQ0gsWUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFlBQU0sV0FBVyxNQUFNLE1BQU0sR0FBRyxPQUFPLGFBQWE7QUFBQSxRQUNuRCxRQUFRO0FBQUEsUUFDUixTQUFTLEVBQUUsZ0JBQWdCLG1CQUFtQjtBQUFBLE1BQy9DLENBQUM7QUFDRCxhQUFPLFNBQVM7QUFBQSxJQUNqQixTQUFRO0FBQ1AsYUFBTztBQUFBLElBQ1I7QUFBQSxFQUNEO0FBQUEsRUFFQSxNQUFNLGFBQWFDLFNBQWdCLFNBQWdEO0FBQ2xGLFVBQU0sVUFBVSxLQUFLLE9BQU8sV0FBVztBQUN2QyxVQUFNLFNBQVEsbUNBQVMsVUFBUyxLQUFLLE9BQU87QUFDNUMsUUFBSSxDQUFDLE9BQU87QUFDWCxZQUFNLElBQUksTUFBTSxnQ0FBZ0M7QUFBQSxJQUNqRDtBQUVBLFVBQU0sV0FBVyxNQUFNLE1BQU0sR0FBRyxPQUFPLGlCQUFpQjtBQUFBLE1BQ3ZELFFBQVE7QUFBQSxNQUNSLFNBQVMsRUFBRSxnQkFBZ0IsbUJBQW1CO0FBQUEsTUFDOUMsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQjtBQUFBLFFBQ0EsUUFBQUE7QUFBQSxRQUNBLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxVQUNoRSxjQUFhLG1DQUFTLGNBQWEsS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUM3RDtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFFBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsWUFBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsSUFDM0Q7QUFFQSxVQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFDakMsV0FBTyxLQUFLO0FBQUEsRUFDYjtBQUFBLEVBRUEsT0FBTyxtQkFBbUJBLFNBQWdCLFNBQWlFO0FBMUQ1RztBQTJERSxVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPO0FBQzVDLFFBQUksQ0FBQyxPQUFPO0FBQ1gsWUFBTSxJQUFJLE1BQU0sZ0NBQWdDO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxpQkFBaUI7QUFBQSxNQUN2RCxRQUFRO0FBQUEsTUFDUixTQUFTLEVBQUUsZ0JBQWdCLG1CQUFtQjtBQUFBLE1BQzlDLE1BQU0sS0FBSyxVQUFVO0FBQUEsUUFDcEI7QUFBQSxRQUNBLFFBQUFBO0FBQUEsUUFDQSxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsY0FBYSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0Q7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUVoQyxRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGNBQU0sUUFBUSxRQUFRLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSTtBQUM5QyxtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLEtBQUssR0FBRztBQUNoQixnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsa0JBQUksT0FBTyxVQUFVO0FBRXBCLHNCQUFNLFlBQVk7QUFDbEIseUJBQVMsSUFBSSxHQUFHLElBQUksT0FBTyxTQUFTLFFBQVEsS0FBSyxXQUFXO0FBQzNELHdCQUFNLFFBQVEsT0FBTyxTQUFTLE1BQU0sR0FBRyxJQUFJLFNBQVM7QUFDcEQsd0JBQU0sRUFBRSxTQUFTLE9BQU8sTUFBTSxNQUFNO0FBRXBDLHdCQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxFQUFFLENBQUM7QUFBQSxnQkFDckQ7QUFBQSxjQUNEO0FBQ0Esa0JBQUksT0FBTyxNQUFNO0FBQ2hCLHNCQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUNoQztBQUFBLGNBQ0Q7QUFBQSxZQUNELFNBQVMsR0FBRztBQUFBLFlBRVo7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFVBQUU7QUFDRCxhQUFPLFlBQVk7QUFBQSxJQUNwQjtBQUVBLFVBQU0sRUFBRSxTQUFTLElBQUksTUFBTSxLQUFLO0FBQUEsRUFDakM7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUF1QixTQUFnRDtBQUMzRixVQUFNLFVBQVUsS0FBSyxPQUFPLFdBQVc7QUFDdkMsVUFBTSxTQUFRLG1DQUFTLFVBQVMsS0FBSyxPQUFPO0FBQzVDLFFBQUksQ0FBQyxPQUFPO0FBQ1gsWUFBTSxJQUFJLE1BQU0sZ0NBQWdDO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFdBQVcsTUFBTSxNQUFNLEdBQUcsT0FBTyxhQUFhO0FBQUEsTUFDbkQsUUFBUTtBQUFBLE1BQ1IsU0FBUyxFQUFFLGdCQUFnQixtQkFBbUI7QUFBQSxNQUM5QyxNQUFNLEtBQUssVUFBVTtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxVQUFVLFNBQVMsSUFBSSxVQUFRO0FBQUEsVUFDOUIsTUFBTSxJQUFJO0FBQUEsVUFDVixTQUFTLElBQUk7QUFBQSxRQUNkLEVBQUU7QUFBQSxRQUNGLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNSLGNBQWEsbUNBQVMsZ0JBQWUsS0FBSyxPQUFPLGVBQWU7QUFBQSxVQUNoRSxjQUFhLG1DQUFTLGNBQWEsS0FBSyxPQUFPLGFBQWE7QUFBQSxRQUM3RDtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFFBQUksQ0FBQyxTQUFTLElBQUk7QUFDakIsWUFBTSxJQUFJLE1BQU0scUJBQXFCLFNBQVMsVUFBVSxFQUFFO0FBQUEsSUFDM0Q7QUFFQSxVQUFNLE9BQU8sTUFBTSxTQUFTLEtBQUs7QUFDakMsV0FBTyxLQUFLLFFBQVE7QUFBQSxFQUNyQjtBQUFBLEVBRUEsTUFBTSxTQUFTLGNBQXNCLFlBQW9CLFNBQWdEO0FBQ3hHLFVBQU0sV0FBd0I7QUFBQSxNQUM3QixFQUFFLE1BQU0sVUFBVSxTQUFTLGFBQWE7QUFBQSxNQUN4QyxFQUFFLE1BQU0sUUFBUSxTQUFTLFdBQVc7QUFBQSxJQUNyQztBQUNBLFdBQU8sS0FBSyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQXZLckg7QUF3S0UsVUFBTSxVQUFVLEtBQUssT0FBTyxXQUFXO0FBQ3ZDLFVBQU0sU0FBUSxtQ0FBUyxVQUFTLEtBQUssT0FBTztBQUM1QyxRQUFJLENBQUMsT0FBTztBQUNYLFlBQU0sSUFBSSxNQUFNLGdDQUFnQztBQUFBLElBQ2pEO0FBRUEsVUFBTSxXQUFXLE1BQU0sTUFBTSxHQUFHLE9BQU8sYUFBYTtBQUFBLE1BQ25ELFFBQVE7QUFBQSxNQUNSLFNBQVMsRUFBRSxnQkFBZ0IsbUJBQW1CO0FBQUEsTUFDOUMsTUFBTSxLQUFLLFVBQVU7QUFBQSxRQUNwQjtBQUFBLFFBQ0EsVUFBVSxTQUFTLElBQUksVUFBUTtBQUFBLFVBQzlCLE1BQU0sSUFBSTtBQUFBLFVBQ1YsU0FBUyxJQUFJO0FBQUEsUUFDZCxFQUFFO0FBQUEsUUFDRixRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUixjQUFhLG1DQUFTLGdCQUFlLEtBQUssT0FBTyxlQUFlO0FBQUEsVUFDaEUsY0FBYSxtQ0FBUyxjQUFhLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDN0Q7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNGLENBQUM7QUFFRCxRQUFJLENBQUMsU0FBUyxJQUFJO0FBQ2pCLFlBQU0sSUFBSSxNQUFNLHFCQUFxQixTQUFTLFVBQVUsRUFBRTtBQUFBLElBQzNEO0FBRUEsVUFBTSxVQUFTLGNBQVMsU0FBVCxtQkFBZTtBQUM5QixRQUFJLENBQUMsUUFBUTtBQUNaLFlBQU0sSUFBSSxNQUFNLCtCQUErQjtBQUFBLElBQ2hEO0FBRUEsVUFBTSxVQUFVLElBQUksWUFBWTtBQUVoQyxRQUFJO0FBQ0gsYUFBTyxNQUFNO0FBQ1osY0FBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLFlBQUksS0FBTTtBQUVWLGNBQU0sUUFBUSxRQUFRLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSTtBQUM5QyxtQkFBVyxRQUFRLE9BQU87QUFDekIsY0FBSSxLQUFLLEtBQUssR0FBRztBQUNoQixnQkFBSTtBQUNILG9CQUFNLFNBQVMsS0FBSyxNQUFNLElBQUk7QUFDOUIsbUJBQUksWUFBTyxZQUFQLG1CQUFnQixTQUFTO0FBRTVCLHNCQUFNLFlBQVk7QUFDbEIseUJBQVMsSUFBSSxHQUFHLElBQUksT0FBTyxRQUFRLFFBQVEsUUFBUSxLQUFLLFdBQVc7QUFDbEUsd0JBQU0sUUFBUSxPQUFPLFFBQVEsUUFBUSxNQUFNLEdBQUcsSUFBSSxTQUFTO0FBQzNELHdCQUFNLEVBQUUsU0FBUyxPQUFPLE1BQU0sTUFBTTtBQUVwQyx3QkFBTSxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsRUFBRSxDQUFDO0FBQUEsZ0JBQ3JEO0FBQUEsY0FDRDtBQUNBLGtCQUFJLE9BQU8sTUFBTTtBQUNoQixzQkFBTSxFQUFFLFNBQVMsSUFBSSxNQUFNLEtBQUs7QUFDaEM7QUFBQSxjQUNEO0FBQUEsWUFDRCxTQUFTLEdBQUc7QUFBQSxZQUVaO0FBQUEsVUFDRDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRCxVQUFFO0FBQ0QsYUFBTyxZQUFZO0FBQUEsSUFDcEI7QUFFQSxVQUFNLEVBQUUsU0FBUyxJQUFJLE1BQU0sS0FBSztBQUFBLEVBQ2pDO0FBQ0Q7OztBbkJuT0EsSUFBTSxnQkFBZ0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQW9EZixJQUFNLG1CQUFpQztBQUFBLEVBQzdDLGFBQWE7QUFBQSxJQUNaLFFBQVE7QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLE9BQU87QUFBQSxNQUNQLGFBQWE7QUFBQSxNQUNiLFdBQVc7QUFBQSxJQUNaO0FBQUEsSUFDQSxRQUFRO0FBQUEsTUFDUCxRQUFRO0FBQUEsTUFDUixTQUFTO0FBQUEsTUFDVCxPQUFPO0FBQUEsTUFDUCxhQUFhO0FBQUEsTUFDYixXQUFXO0FBQUEsSUFDWjtBQUFBLElBQ0EsUUFBUTtBQUFBLE1BQ1AsUUFBUTtBQUFBLE1BQ1IsT0FBTztBQUFBLE1BQ1AsYUFBYTtBQUFBLE1BQ2IsV0FBVztBQUFBLElBQ1o7QUFBQSxJQUNBLFFBQVE7QUFBQSxNQUNQLFNBQVM7QUFBQSxNQUNULE9BQU87QUFBQSxNQUNQLGFBQWE7QUFBQSxNQUNiLFdBQVc7QUFBQSxJQUNaO0FBQUEsRUFDRDtBQUFBLEVBQ0Esa0JBQWtCO0FBQUEsSUFDakIsU0FBUztBQUFBLE1BQ1IsZUFBZTtBQUFBO0FBQUEsSUFDaEI7QUFBQSxJQUNBLFFBQVE7QUFBQSxNQUNQLGVBQWU7QUFBQTtBQUFBLElBQ2hCO0FBQUEsRUFDRDtBQUFBLEVBQ0EsZ0JBQWdCLENBQUM7QUFBQSxFQUNqQixTQUFTO0FBQUEsSUFDUixvQkFBb0I7QUFBQSxJQUNwQixrQkFBa0I7QUFBQSxJQUNsQixVQUFVO0FBQUEsRUFDWDtBQUFBLEVBQ0EsbUJBQW1CO0FBQUEsRUFDbkIsV0FBVztBQUFBLElBQ1YsWUFBWTtBQUFBLElBQ1oscUJBQXFCO0FBQUEsSUFDckIsYUFBYTtBQUFBLElBQ2IsZUFBZTtBQUFBLE1BQ2QsU0FBUztBQUFBLE1BQ1QsY0FBYztBQUFBLE1BQ2QsZ0JBQWdCO0FBQUEsSUFDakI7QUFBQSxFQUNEO0FBQUEsRUFDQSxnQkFBZ0IsQ0FBQztBQUFBLEVBQ2pCLHNCQUFzQjtBQUN2QjtBQUVPLElBQU0saUJBQU4sY0FBNkIsbUNBQWlCO0FBQUEsRUFNcEQsWUFBWSxLQUFVLFFBQW9CO0FBQ3pDLFVBQU0sS0FBSyxNQUFNO0FBTGxCLFNBQVEsWUFBaUY7QUFDekYsU0FBUSxlQUFtQztBQUMzQyxTQUFRLG1CQUF1QztBQUk5QyxTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxVQUFnQjtBQUNmLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFDeEIsZ0JBQVksTUFBTTtBQUNsQixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBR3BELFNBQUssZUFBZSxZQUFZLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3ZFLFNBQUssb0JBQW9CO0FBR3pCLFNBQUssbUJBQW1CLFlBQVksVUFBVSxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFDekUsU0FBSyxpQkFBaUI7QUFBQSxFQUN2QjtBQUFBLEVBRVEsc0JBQTRCO0FBQ25DLFFBQUksQ0FBQyxLQUFLLGFBQWM7QUFFeEIsVUFBTSxPQUFPO0FBQUEsTUFDWixFQUFFLElBQUksbUJBQW1CLE9BQU8sa0JBQWtCO0FBQUEsTUFDbEQsRUFBRSxJQUFJLFdBQVcsT0FBTyxVQUFVO0FBQUEsTUFDbEMsRUFBRSxJQUFJLGFBQWEsT0FBTyxlQUFlO0FBQUEsTUFDekMsRUFBRSxJQUFJLGFBQWEsT0FBTyxZQUFZO0FBQUEsSUFDdkM7QUFHQSxRQUFJLE1BQWdHO0FBQ25HLFdBQUssS0FBSyxFQUFFLElBQUksU0FBUyxPQUFPLFFBQVEsQ0FBQztBQUFBLElBQzFDO0FBRUEsU0FBSyxRQUFRLFNBQU87QUFDbkIsWUFBTSxRQUFRLEtBQUssYUFBYyxVQUFVO0FBQUEsUUFDMUMsS0FBSyxZQUFZLEtBQUssY0FBYyxJQUFJLEtBQUssV0FBVyxFQUFFO0FBQUEsUUFDMUQsTUFBTSxJQUFJO0FBQUEsTUFDWCxDQUFDO0FBQ0QsWUFBTSxRQUFRLFFBQVEsSUFBSTtBQUUxQixZQUFNLGlCQUFpQixTQUFTLE1BQU07QUFDckMsYUFBSyxVQUFVLElBQUksRUFBeUU7QUFBQSxNQUM3RixDQUFDO0FBQUEsSUFDRixDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsVUFBVSxPQUFrRjtBQUNuRyxTQUFLLFlBQVk7QUFDakIsU0FBSyxnQkFBZ0I7QUFDckIsU0FBSyxpQkFBaUI7QUFDdEIsU0FBSyxrQkFBa0I7QUFBQSxFQUN4QjtBQUFBLEVBRVEsa0JBQXdCO0FBQy9CLFFBQUksQ0FBQyxLQUFLLGFBQWM7QUFHeEIsVUFBTSxjQUFjLEtBQUssYUFBYSxpQkFBaUIsV0FBVztBQUNsRSxnQkFBWSxRQUFRLFdBQVM7QUFDNUIsWUFBTSxZQUFZO0FBQ2xCLFVBQUksVUFBVSxRQUFRLFVBQVUsS0FBSyxXQUFXO0FBQy9DLGtCQUFVLFNBQVMsUUFBUTtBQUFBLE1BQzVCLE9BQU87QUFDTixrQkFBVSxZQUFZLFFBQVE7QUFBQSxNQUMvQjtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLG9CQUEwQjtBQUNqQyxRQUFJLENBQUMsS0FBSyxhQUFjO0FBRXhCLFVBQU0sWUFBWSxLQUFLLGFBQWEsY0FBYyxrQkFBa0I7QUFDcEUsUUFBSSxXQUFXO0FBQ2QsZ0JBQVUsZUFBZTtBQUFBLFFBQ3hCLFVBQVU7QUFBQSxRQUNWLE9BQU87QUFBQSxRQUNQLFFBQVE7QUFBQSxNQUNULENBQUM7QUFBQSxJQUNGO0FBQUEsRUFDRDtBQUFBLEVBRVEsbUJBQXlCO0FBQ2hDLFFBQUksQ0FBQyxLQUFLLGlCQUFrQjtBQUc1QixTQUFLLGlCQUFpQixNQUFNO0FBRTVCLFlBQVEsS0FBSyxXQUFXO0FBQUEsTUFDdkIsS0FBSztBQUNKLGFBQUssK0JBQStCLEtBQUssZ0JBQWdCO0FBQ3pEO0FBQUEsTUFDRCxLQUFLO0FBQ0osYUFBSyx3QkFBd0IsS0FBSyxnQkFBZ0I7QUFDbEQ7QUFBQSxNQUNELEtBQUs7QUFDSixhQUFLLDBCQUEwQixLQUFLLGdCQUFnQjtBQUNwRDtBQUFBLE1BQ0QsS0FBSztBQUNKLGFBQUssMEJBQTBCLEtBQUssZ0JBQWdCO0FBQ3BEO0FBQUEsTUFDRCxLQUFLO0FBQ0osYUFBSyxzQkFBc0IsS0FBSyxnQkFBZ0I7QUFDaEQ7QUFBQSxJQUNGO0FBQUEsRUFDRDtBQUFBLEVBRVEsd0JBQXdCLFdBQThCO0FBRTdELFNBQUssbUJBQW1CLFdBQVc7QUFBQSxNQUNsQyx3QkFBd0I7QUFBQSxNQUN4QixjQUFjO0FBQUEsTUFDZCxlQUFlO0FBQUEsSUFDaEIsQ0FBQztBQUVELFNBQUssc0JBQXNCLFNBQVM7QUFDcEMsU0FBSyxzQkFBc0IsU0FBUztBQUFBLEVBQ3JDO0FBQUEsRUFFUSwwQkFBMEIsV0FBOEI7QUFFL0QsU0FBSyxtQkFBbUIsV0FBVztBQUFBLE1BQ2xDLHdCQUF3QjtBQUFBLE1BQ3hCLGNBQWM7QUFBQSxNQUNkLGVBQWU7QUFBQSxJQUNoQixDQUFDO0FBRUQsU0FBSyx1QkFBdUIsU0FBUztBQUFBLEVBQ3RDO0FBQUEsRUFHUSwrQkFBK0IsV0FBOEI7QUFDcEUsU0FBSyxxQkFBcUIsU0FBUztBQUNuQyxTQUFLLHNCQUFzQixTQUFTO0FBQ3BDLFNBQUssbUJBQW1CLFdBQVc7QUFBQSxNQUNsQyxjQUFjO0FBQUEsTUFDZCxlQUFlO0FBQUEsTUFDZixXQUFXO0FBQUEsTUFDWCxjQUFjO0FBQUEsSUFDZixDQUFDO0FBQ0QsU0FBSyxxQkFBcUIsU0FBUztBQUFBLEVBQ3BDO0FBQUEsRUFFUSwwQkFBMEIsV0FBOEI7QUFFL0QsU0FBSyxtQkFBbUIsV0FBVztBQUFBLE1BQ2xDLGNBQWM7QUFBQSxNQUNkLGVBQWU7QUFBQSxNQUNmLGNBQWM7QUFBQSxJQUNmLENBQUM7QUFHRCxVQUFNLGtCQUFrQixVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzVFLG9CQUFnQixNQUFNLFlBQVk7QUFDbEMsb0JBQWdCLFNBQVMsTUFBTSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDN0Qsb0JBQWdCLFNBQVMsTUFBTSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFFOUQsVUFBTSxrQkFBa0IsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQ2xGLG9CQUFnQixZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBNkM1QixVQUFNLGlCQUFpQixVQUFVLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzNFLG1CQUFlLE1BQU0sWUFBWTtBQUNqQyxtQkFBZSxTQUFTLE1BQU0sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRTVELFNBQUssNEJBQTRCLGNBQWM7QUFBQSxFQUNoRDtBQUFBLEVBRVEsc0JBQXNCLFdBQThCO0FBRTNELFVBQU0sZUFBZSxVQUFVLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3RFLGlCQUFhLFNBQVMsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDdEQsaUJBQWEsU0FBUyxNQUFNLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUUzRCxVQUFNLFNBQVMsYUFBYSxVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNoRSxXQUFPLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWVuQixTQUFLLG9CQUFvQixZQUFZO0FBQUEsRUFDdEM7QUFBQSxFQUVRLHNCQUFzQixXQUE4QjtBQUUzRCxVQUFNLGlCQUFpQixVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQzFFLG1CQUFlLFNBQVMsTUFBTSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDckUsbUJBQWUsU0FBUyxNQUFNLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUU3RCxVQUFNLFNBQVMsZUFBZSxVQUFVLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUNwRSxXQUFPLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQW1CbkIsUUFBSSwwQkFBUSxjQUFjLEVBQ3hCLFFBQVEsdUJBQXVCLEVBQy9CLFFBQVEscUVBQXFFLEVBQzdFLFVBQVUsWUFBVTtBQUNwQixZQUFNLHFCQUFxQixLQUFLLE9BQU8sU0FBUyxpQkFBaUIsT0FBTztBQUN4RSxZQUFNLGtCQUFrQix1QkFBdUI7QUFFL0MsYUFDRSxTQUFTLGVBQWUsRUFDeEIsU0FBUyxPQUFPLFVBQVU7QUFDMUIsWUFBSSxPQUFPO0FBRVYsZUFBSyxPQUFPLFNBQVMsaUJBQWlCLE9BQU8sZ0JBQWdCO0FBQUEsUUFDOUQsT0FBTztBQUVOLGVBQUssT0FBTyxTQUFTLGlCQUFpQixPQUFPLGdCQUFnQjtBQUFBLFFBQzlEO0FBQ0EsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUMvQixZQUFJLEtBQUssT0FBTyxtQkFBbUI7QUFDbEMsZUFBSyxPQUFPLGtCQUFrQixlQUFlLEtBQUssT0FBTyxRQUFRO0FBQUEsUUFDbEU7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNILENBQUM7QUFBQSxFQUNIO0FBQUEsRUFFUSx3QkFBd0IsV0FBd0IsU0FNL0M7QUFDUixVQUFNLFVBQVUsSUFBSSwwQkFBUSxTQUFTLEVBQ25DLFFBQVEsUUFBUSxJQUFJLEVBQ3BCLFFBQVEsUUFBUSxJQUFJO0FBRXRCLFFBQUksY0FBYyxRQUFRO0FBQzFCLFFBQUksWUFBWTtBQUVoQixZQUFRLFFBQVEsVUFBUTtBQUN2QixXQUFLLFFBQVEsT0FBTztBQUNwQixXQUFLLFFBQVEsTUFBTSxhQUFhO0FBQ2hDLFdBQUssUUFBUSxNQUFNLFFBQVE7QUFDM0IsV0FBSyxRQUFRLE1BQU0sU0FBUztBQUM1QixXQUFLLFFBQVEsTUFBTSxXQUFXO0FBQzlCLFdBQUssZUFBZSxRQUFRLFdBQVc7QUFHdkMsVUFBSSxlQUFlLFlBQVksU0FBUyxJQUFJO0FBQzNDLGNBQU0sU0FBUyxZQUFZLE1BQU0sR0FBRyxDQUFDLElBQUkscUpBQTZCLFlBQVksTUFBTSxFQUFFO0FBQzFGLGFBQUssU0FBUyxNQUFNO0FBQUEsTUFDckIsT0FBTztBQUNOLGFBQUssU0FBUyxXQUFXO0FBQUEsTUFDMUI7QUFHQSxZQUFNLGlCQUFpQixLQUFLLFFBQVE7QUFDcEMsVUFBSSxnQkFBZ0I7QUFDbkIsdUJBQWUsTUFBTSxXQUFXO0FBRWhDLGNBQU0sWUFBWSxlQUFlLFNBQVMsVUFBVSxFQUFFLEtBQUssa0JBQWtCLENBQUM7QUFDOUUsa0JBQVUsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUt0QixrQkFBVSxpQkFBaUIsU0FBUyxDQUFDLE1BQU07QUFDMUMsWUFBRSxlQUFlO0FBQ2pCLHNCQUFZLENBQUM7QUFFYixjQUFJLFdBQVc7QUFDZCxpQkFBSyxRQUFRLE9BQU87QUFDcEIsaUJBQUssU0FBUyxXQUFXO0FBQ3pCLHNCQUFVLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsVUFNdkIsT0FBTztBQUNOLGlCQUFLLFFBQVEsT0FBTztBQUNwQixnQkFBSSxlQUFlLFlBQVksU0FBUyxJQUFJO0FBQzNDLG9CQUFNLFNBQVMsWUFBWSxNQUFNLEdBQUcsQ0FBQyxJQUFJLHFKQUE2QixZQUFZLE1BQU0sRUFBRTtBQUMxRixtQkFBSyxTQUFTLE1BQU07QUFBQSxZQUNyQixPQUFPO0FBQ04sbUJBQUssU0FBUyxXQUFXO0FBQUEsWUFDMUI7QUFDQSxzQkFBVSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUEsVUFJdkI7QUFBQSxRQUNELENBQUM7QUFBQSxNQUNGO0FBR0EsV0FBSyxTQUFTLE9BQU8sVUFBVTtBQUM5QixzQkFBYztBQUNkLGNBQU0sUUFBUSxTQUFTLEtBQUs7QUFBQSxNQUM3QixDQUFDO0FBRUQsYUFBTztBQUFBLElBQ1IsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVRLDhCQUE4QixXQUF3QixVQUFrRTtBQUMvSCxVQUFNLGtCQUFrQixVQUFVLFVBQVUsRUFBRSxLQUFLLGlDQUFpQyxDQUFDO0FBRXJGLFFBQUk7QUFDSCxZQUFNLFNBQVMsS0FBSyxrQkFBa0IsUUFBUTtBQUM5QyxZQUFNLFdBQVcsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixPQUFPLE1BQU0sR0FBRyxDQUFDO0FBRzNGLFlBQU0sTUFBTSxTQUFTLFdBQVcsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBRzFELFlBQU0sT0FBTyxTQUFTLFdBQVcsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQzVELFdBQUssY0FBYyxLQUFLLHFCQUFxQixNQUFNO0FBR25ELFVBQUksT0FBTyxlQUFlLE9BQU8sU0FBUztBQUN6QyxjQUFNLFVBQVUsU0FBUyxVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUNqRSxZQUFJLE9BQU8sYUFBYTtBQUN2QixnQkFBTSxTQUFTLFFBQVEsVUFBVSxFQUFFLEtBQUssbUJBQW1CLENBQUM7QUFDNUQsZ0JBQU0sT0FBTyxPQUFPLHVCQUF1QixPQUFPLE9BQU8sY0FBYyxJQUFJLEtBQUssT0FBTyxXQUFXO0FBQ2xHLGlCQUFPLGNBQWMsaUJBQWlCLEtBQUssbUJBQW1CLENBQUM7QUFBQSxRQUNoRTtBQUNBLFlBQUksT0FBTyxTQUFTO0FBQ25CLGdCQUFNLFlBQVksUUFBUSxVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUNsRSxvQkFBVSxjQUFjLE9BQU87QUFBQSxRQUNoQztBQUFBLE1BQ0Q7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSw2Q0FBNkMsS0FBSztBQUVoRSxZQUFNLFdBQVcsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLGdDQUFnQyxDQUFDO0FBQ25GLFlBQU0sTUFBTSxTQUFTLFdBQVcsRUFBRSxLQUFLLGtCQUFrQixDQUFDO0FBQzFELFlBQU0sT0FBTyxTQUFTLFdBQVcsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQzVELFdBQUssY0FBYztBQUFBLElBQ3BCO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVRLGtCQUFrQixVQUErSDtBQW5oQjFKO0FBb2hCRSxRQUFJO0FBQ0gsWUFBTSxlQUFjLFVBQUssT0FBTyxTQUFTLG1CQUFyQixtQkFBc0M7QUFDMUQsVUFBSSxhQUFhO0FBQ2hCLGVBQU87QUFBQSxNQUNSO0FBR0EsWUFBTSxZQUFZLEtBQUssa0JBQWtCLFFBQVE7QUFDakQsYUFBTztBQUFBLFFBQ04sUUFBUSxZQUFZLGFBQWE7QUFBQSxRQUNqQyxTQUFTLFlBQVksNkJBQTZCO0FBQUEsUUFDbEQsYUFBYTtBQUFBLE1BQ2Q7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSxxQ0FBcUMsUUFBUSxLQUFLLEtBQUs7QUFDckUsYUFBTztBQUFBLFFBQ04sUUFBUTtBQUFBLFFBQ1IsU0FBUztBQUFBLFFBQ1QsYUFBYTtBQUFBLE1BQ2Q7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRVEscUJBQXFCLFFBQXNEO0FBQ2xGLFlBQVEsT0FBTyxRQUFRO0FBQUEsTUFDdEIsS0FBSztBQUFhLGVBQU87QUFBQSxNQUN6QixLQUFLO0FBQVMsZUFBTztBQUFBLE1BQ3JCLEtBQUs7QUFBa0IsZUFBTztBQUFBLE1BQzlCLEtBQUs7QUFBWSxlQUFPO0FBQUEsTUFDeEIsS0FBSztBQUFXLGVBQU87QUFBQSxNQUN2QjtBQUFTLGVBQU87QUFBQSxJQUNqQjtBQUFBLEVBQ0Q7QUFBQSxFQUVRLDJCQUEyQixXQUF3QixVQUEyRDtBQUNySCxVQUFNLFVBQVUsSUFBSSwwQkFBUSxTQUFTLEVBQ25DLFFBQVEsbUJBQW1CLEVBQzNCLFFBQVEsMEJBQTBCO0FBR3BDLFVBQU0sa0JBQWtCLFFBQVEsVUFBVSxVQUFVLEVBQUUsS0FBSyxtQ0FBbUMsQ0FBQztBQUUvRixZQUFRLFVBQVUsWUFBVTtBQUMzQixhQUFPLGNBQWMsaUJBQWlCLEVBQ3BDLFdBQVcsUUFBUSxRQUFRLGFBQWEsRUFDeEMsUUFBUSxZQUFZO0FBQ3BCLGNBQU0sS0FBSyx1QkFBdUIsVUFBVSxPQUFPLFVBQVUsZUFBZTtBQUFBLE1BQzdFLENBQUM7QUFDRixhQUFPLFNBQVMsYUFBYSxjQUFjLFFBQVEsS0FBSyx1QkFBdUIsUUFBUSxDQUFDLGFBQWE7QUFDckcsYUFBTztBQUFBLElBQ1IsQ0FBQztBQUdELFNBQUssdUJBQXVCLGlCQUFpQixRQUFRO0FBQUEsRUFDdEQ7QUFBQSxFQUVBLE1BQWMsdUJBQXVCLFVBQXFELFVBQXVCLGlCQUE2QztBQTVrQi9KO0FBNmtCRSxVQUFNLGVBQWUsU0FBUyxlQUFlO0FBQzdDLFVBQU0sU0FBUztBQUVmLFlBQVEsSUFBSSxnQ0FBZ0MsUUFBUSxzQkFBc0IsT0FBTyxRQUFRLEVBQUU7QUFHM0YsV0FBTyxXQUFXO0FBQ2xCLFdBQU8sY0FBYztBQUNyQixXQUFPLE1BQU0sVUFBVTtBQUd2QixVQUFNLEtBQUsscUJBQXFCLFVBQVUsV0FBVyx1QkFBdUI7QUFHNUUsU0FBSyxvQkFBb0IsaUJBQWlCLFdBQVcsWUFBWTtBQUdqRSxVQUFNLGdCQUFnQixNQUFNO0FBQzNCLGFBQU8sV0FBVztBQUNsQixhQUFPLGNBQWM7QUFDckIsYUFBTyxNQUFNLFVBQVU7QUFDdkIsY0FBUSxJQUFJLDZCQUE2QixRQUFRLEVBQUU7QUFBQSxJQUNwRDtBQUVBLFVBQU0sY0FBYyxXQUFXLGVBQWUsSUFBSztBQUVuRCxRQUFJO0FBRUgsWUFBTSxZQUFZLEtBQUssa0JBQWtCLFFBQVE7QUFDakQsVUFBSSxDQUFDLFdBQVc7QUFDZixjQUFNLElBQUksTUFBTSx1REFBdUQ7QUFBQSxNQUN4RTtBQUdBLFlBQU0saUJBQWlCLElBQUksUUFBZSxDQUFDLEdBQUcsV0FBVztBQUN4RCxtQkFBVyxNQUFNLE9BQU8sSUFBSSxNQUFNLG9CQUFvQixDQUFDLEdBQUcsR0FBSztBQUFBLE1BQ2hFLENBQUM7QUFHRCxZQUFNLGNBQWMsS0FBSywwQkFBMEIsUUFBUTtBQUUzRCxZQUFNLFFBQVEsS0FBSyxDQUFDLGFBQWEsY0FBYyxDQUFDO0FBR2hELFlBQU0sS0FBSyxxQkFBcUIsVUFBVSxhQUFhLHdCQUF3QjtBQUMvRSxXQUFLLG9CQUFvQixpQkFBaUIsV0FBVyxrQkFBYTtBQUNsRSxjQUFRLElBQUksa0NBQWtDLFFBQVEsRUFBRTtBQUFBLElBRXpELFNBQVMsT0FBWTtBQUNwQixjQUFRLElBQUksOEJBQThCLFFBQVEsS0FBSyxLQUFLO0FBQzVELFVBQUksZUFBZTtBQUVuQixVQUFJLE1BQU0sWUFBWSxzQkFBc0I7QUFDM0MsdUJBQWU7QUFBQSxNQUNoQixXQUFXLGFBQWEsVUFBVTtBQUVqQyxjQUFNLFlBQVksS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPO0FBQzFELFlBQUksQ0FBQyxhQUFhLFVBQVUsS0FBSyxNQUFNLElBQUk7QUFDMUMseUJBQWU7QUFBQSxRQUNoQixPQUFPO0FBQ04seUJBQWU7QUFBQSxRQUNoQjtBQUFBLE1BQ0QsYUFBVyxXQUFNLFlBQU4sbUJBQWUsU0FBUyxhQUFVLFdBQU0sWUFBTixtQkFBZSxTQUFTLHNCQUFtQixXQUFNLFlBQU4sbUJBQWUsU0FBUyxhQUFZO0FBQzNILHVCQUFlO0FBQUEsTUFDaEIsWUFBVyxXQUFNLFlBQU4sbUJBQWUsU0FBUyxRQUFRO0FBQzFDLHVCQUFlO0FBQUEsTUFDaEIsWUFBVyxXQUFNLFlBQU4sbUJBQWUsU0FBUyxVQUFVO0FBQzVDLHVCQUFlO0FBQUEsTUFDaEIsYUFBVyxXQUFNLFlBQU4sbUJBQWUsU0FBUyx3QkFBcUIsV0FBTSxZQUFOLG1CQUFlLFNBQVMsYUFBWTtBQUMzRix1QkFBZTtBQUFBLE1BQ2hCLE9BQU87QUFDTix1QkFBZTtBQUFBLE1BQ2hCO0FBR0EsWUFBTSxLQUFLLHFCQUFxQixVQUFVLFNBQVMsWUFBWTtBQUMvRCxXQUFLLG9CQUFvQixpQkFBaUIsU0FBUyxVQUFLLFlBQVksRUFBRTtBQUFBLElBQ3ZFLFVBQUU7QUFFRCxtQkFBYSxXQUFXO0FBQ3hCLG9CQUFjO0FBQUEsSUFDZjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQWMscUJBQXFCLFVBQXFELFFBQTJFLFNBQWlDO0FBQ25NLFFBQUksQ0FBQyxLQUFLLE9BQU8sU0FBUyxnQkFBZ0I7QUFDekMsV0FBSyxPQUFPLFNBQVMsaUJBQWlCLENBQUM7QUFBQSxJQUN4QztBQUVBLFNBQUssT0FBTyxTQUFTLGVBQWUsUUFBUSxJQUFJO0FBQUEsTUFDL0M7QUFBQSxNQUNBO0FBQUEsTUFDQSxhQUFhLFdBQVcsWUFBWSxPQUFPLG9CQUFJLEtBQUs7QUFBQSxJQUNyRDtBQUVBLFVBQU0sS0FBSyxPQUFPLGFBQWE7QUFHL0IsU0FBSyxnQ0FBZ0M7QUFBQSxFQUN0QztBQUFBLEVBRVEsa0NBQXdDO0FBRS9DLFVBQU0sYUFBYSxLQUFLLFlBQVksaUJBQWlCLGlDQUFpQztBQUN0RixlQUFXLFFBQVEsZUFBYTtBQUMvQixZQUFNLFdBQVcsVUFBVSxhQUFhLGVBQWU7QUFDdkQsVUFBSSxVQUFVO0FBQ2IsYUFBSyw0QkFBNEIsV0FBMEIsUUFBUTtBQUFBLE1BQ3BFO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEsNEJBQTRCLFdBQXdCLFVBQTJEO0FBQ3RILFVBQU0sU0FBUyxLQUFLLGtCQUFrQixRQUFRO0FBQzlDLFVBQU0sV0FBVyxVQUFVLGNBQWMsdUJBQXVCO0FBRWhFLFFBQUksVUFBVTtBQUNiLGVBQVMsWUFBWSx3QkFBd0IsT0FBTyxNQUFNO0FBQzFELFlBQU0sU0FBUyxTQUFTLGNBQWMsbUJBQW1CO0FBQ3pELFVBQUksUUFBUTtBQUNYLGVBQU8sY0FBYyxLQUFLLHFCQUFxQixNQUFNO0FBQUEsTUFDdEQ7QUFHQSxVQUFJLFVBQVUsU0FBUyxjQUFjLHNCQUFzQjtBQUMzRCxVQUFJLE9BQU8sZUFBZSxPQUFPLFNBQVM7QUFDekMsWUFBSSxDQUFDLFNBQVM7QUFDYixvQkFBVSxTQUFTLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQUEsUUFDNUQ7QUFDQSxnQkFBUSxNQUFNO0FBRWQsWUFBSSxPQUFPLGFBQWE7QUFDdkIsZ0JBQU0sU0FBUyxRQUFRLFVBQVUsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQzVELGdCQUFNLE9BQU8sT0FBTyx1QkFBdUIsT0FBTyxPQUFPLGNBQWMsSUFBSSxLQUFLLE9BQU8sV0FBVztBQUNsRyxpQkFBTyxjQUFjLGlCQUFpQixLQUFLLG1CQUFtQixDQUFDO0FBQUEsUUFDaEU7QUFDQSxZQUFJLE9BQU8sU0FBUztBQUNuQixnQkFBTSxZQUFZLFFBQVEsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDbEUsb0JBQVUsY0FBYyxPQUFPO0FBQUEsUUFDaEM7QUFBQSxNQUNELFdBQVcsU0FBUztBQUNuQixnQkFBUSxPQUFPO0FBQUEsTUFDaEI7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBYywwQkFBMEIsVUFBb0U7QUFDM0csWUFBUSxJQUFJLHFDQUFxQyxRQUFRLEVBQUU7QUFHM0QsWUFBUSxVQUFVO0FBQUEsTUFDakIsS0FBSyxVQUFVO0FBQ2QsY0FBTSxpQkFBaUIsSUFBSSxlQUFlLEtBQUssT0FBTyxTQUFTLFlBQVksTUFBTTtBQUVqRixjQUFNLGVBQWUsU0FBUyxnQ0FBZ0MsTUFBTSxFQUFFLFdBQVcsRUFBRSxDQUFDO0FBQ3BGO0FBQUEsTUFDRDtBQUFBLE1BQ0EsS0FBSyxVQUFVO0FBQ2QsY0FBTSxpQkFBaUIsSUFBSSxlQUFlLEtBQUssT0FBTyxTQUFTLFlBQVksTUFBTTtBQUNqRixjQUFNLGVBQWUsbUJBQW1CO0FBQ3hDO0FBQUEsTUFDRDtBQUFBLE1BQ0EsS0FBSyxVQUFVO0FBQ2QsY0FBTSxpQkFBaUIsSUFBSSxlQUFlLEtBQUssT0FBTyxTQUFTLFlBQVksTUFBTTtBQUNqRixjQUFNLGVBQWUsbUJBQW1CO0FBQ3hDO0FBQUEsTUFDRDtBQUFBLE1BQ0EsS0FBSyxVQUFVO0FBQ2QsY0FBTSxpQkFBaUIsSUFBSSxlQUFlLEtBQUssT0FBTyxTQUFTLFlBQVksTUFBTTtBQUVqRixjQUFNLGNBQWMsTUFBTSxlQUFlLFlBQVk7QUFDckQsWUFBSSxDQUFDLGFBQWE7QUFDakIsZ0JBQU0sSUFBSSxNQUFNLDBCQUEwQjtBQUFBLFFBQzNDO0FBQ0E7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUNBLFlBQVEsSUFBSSxrQ0FBa0MsUUFBUSxFQUFFO0FBQUEsRUFDekQ7QUFBQSxFQUVRLG9CQUFvQixXQUF3QixNQUFnRCxTQUF1QjtBQUMxSCxjQUFVLE1BQU07QUFFaEIsUUFBSSxTQUFTLE9BQVE7QUFFckIsVUFBTSxXQUFXLFVBQVUsVUFBVSxFQUFFLEtBQUsseUJBQXlCLElBQUksR0FBRyxDQUFDO0FBQzdFLGFBQVMsY0FBYztBQUFBLEVBQ3hCO0FBQUEsRUFFUSx1QkFBdUIsV0FBd0IsVUFBMkQ7QUFFakgsVUFBTSxZQUFZLEtBQUssa0JBQWtCLFFBQVE7QUFFakQsUUFBSSxDQUFDLFdBQVc7QUFDZixXQUFLLG9CQUFvQixXQUFXLFFBQVEsRUFBRTtBQUFBLElBQy9DLE9BQU87QUFFTixXQUFLLG9CQUFvQixXQUFXLFFBQVEsRUFBRTtBQUFBLElBQy9DO0FBQUEsRUFDRDtBQUFBLEVBRVEsa0JBQWtCLFVBQThEO0FBQ3ZGLFlBQVEsVUFBVTtBQUFBLE1BQ2pCLEtBQUs7QUFDSixlQUFPLENBQUMsQ0FBQyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU87QUFBQSxNQUNsRCxLQUFLO0FBQ0osZUFBTyxDQUFDLENBQUMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPO0FBQUEsTUFDbEQsS0FBSztBQUNKLGVBQU8sQ0FBQyxDQUFDLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTztBQUFBLE1BQ2xELEtBQUs7QUFDSixlQUFPLENBQUMsQ0FBQyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU87QUFBQSxNQUNsRDtBQUNDLGVBQU87QUFBQSxJQUNUO0FBQUEsRUFDRDtBQUFBLEVBRVEsc0JBQXNCLGNBQWMsS0FBSyxhQUFhO0FBcnlCL0Q7QUFzeUJFLFVBQU0sbUJBQW1CLFlBQVksVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDOUUscUJBQWlCLFNBQVMsTUFBTSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFHdEUsVUFBTSxTQUFTLGlCQUFpQixVQUFVLEVBQUUsS0FBSyxrQkFBa0IsQ0FBQztBQUNwRSxXQUFPLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBUW5CLFVBQU0sZ0JBQWMsVUFBSyxPQUFPLG1CQUFaLG1CQUE0QiwyQkFBMEI7QUFDMUUsVUFBTSxvQkFBbUIsVUFBSyxPQUFPLG1CQUFaLG1CQUE0QjtBQUVyRCxVQUFNLGdCQUFnQixpQkFBaUIsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDakYsVUFBTSxhQUFhLGNBQWMsd0JBQXdCO0FBQ3pELFVBQU0sYUFBYSxjQUFjO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsWUFVdkI7QUFBQSxLQUNQLGFBQWE7QUFBQTtBQUVoQixrQkFBYyxZQUFZO0FBQUEsbUNBQ08sY0FBYyxjQUFjLE1BQU07QUFBQSxnQ0FDckMsVUFBVTtBQUFBLGdDQUNWLFVBQVU7QUFBQTtBQUFBO0FBS3hDLFFBQUksa0JBQWtCO0FBQ3JCLFlBQU0sV0FBVyxpQkFBaUIsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDMUUsWUFBTSxhQUFhLGlCQUFpQixZQUNqQyxZQUFZLGlCQUFpQixVQUFVLG1CQUFtQixDQUFDLEtBQzNEO0FBQ0gsZUFBUyxZQUFZO0FBQUE7QUFBQSxtQ0FFVyxpQkFBaUIsS0FBSztBQUFBLG9DQUNyQixVQUFVO0FBQUE7QUFBQTtBQUFBLElBRzVDO0FBR0EsU0FBSyx3QkFBd0Isa0JBQWtCO0FBQUEsTUFDOUMsTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLE1BQ04sYUFBYTtBQUFBLE1BQ2IsT0FBTyxLQUFLLE9BQU8sU0FBUyxVQUFVLHVCQUF1QjtBQUFBLE1BQzdELFVBQVUsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFVBQVUsc0JBQXNCO0FBQ3JELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFHL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGdCQUFNLEtBQUssT0FBTyxlQUFlLHVCQUF1QixTQUFTLElBQUk7QUFHckUsZ0JBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsY0FBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixrQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLHdCQUFZLG1CQUFtQjtBQUFBLFVBQ2hDO0FBR0EsZUFBSyxpQkFBaUI7QUFBQSxRQUN2QjtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFHRCxVQUFNLGtCQUFrQixJQUFJLDBCQUFRLGdCQUFnQixFQUNsRCxRQUFRLHFDQUFxQyxFQUM3QyxVQUFVLFlBQVU7QUFDcEIsYUFBTyxjQUFjLGtCQUFrQixFQUNyQyxRQUFRLFlBQVk7QUFDcEIsY0FBTSxhQUFhLEtBQUssT0FBTyxTQUFTLFVBQVU7QUFDbEQsWUFBSSxDQUFDLFlBQVk7QUFDaEIsZUFBSyxtQkFBbUIsK0NBQStDLE9BQU87QUFDOUU7QUFBQSxRQUNEO0FBRUEsZUFBTyxjQUFjLGVBQWU7QUFDcEMsZUFBTyxXQUFXO0FBRWxCLFlBQUk7QUFDSCxjQUFJLEtBQUssT0FBTyxnQkFBZ0I7QUFDL0Isa0JBQU0sS0FBSyxPQUFPLGVBQWUsdUJBQXVCLFVBQVU7QUFDbEUsa0JBQU1DLGVBQWMsS0FBSyxPQUFPLGVBQWUscUJBQXFCO0FBRXBFLGdCQUFJQSxjQUFhO0FBQ2hCLG1CQUFLLG1CQUFtQix1RUFBdUUsU0FBUztBQUN4RyxtQkFBSyxhQUFhO0FBQUEsWUFDbkIsT0FBTztBQUNOLG1CQUFLLG1CQUFtQiw2Q0FBNkMsT0FBTztBQUFBLFlBQzdFO0FBR0Esa0JBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsZ0JBQUksT0FBTyxTQUFTLEdBQUc7QUFDdEIsb0JBQU0sY0FBYyxPQUFPLENBQUMsRUFBRTtBQUM5QiwwQkFBWSxtQkFBbUI7QUFBQSxZQUNoQztBQUdBLGlCQUFLLGlCQUFpQjtBQUFBLFVBQ3ZCO0FBQUEsUUFDRCxTQUFTLE9BQU87QUFDZixlQUFLLG1CQUFtQix1Q0FBdUMsT0FBTztBQUFBLFFBQ3ZFLFVBQUU7QUFDRCxpQkFBTyxjQUFjLGtCQUFrQjtBQUN2QyxpQkFBTyxXQUFXO0FBQUEsUUFDbkI7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNILENBQUM7QUFHRixTQUFLLG9CQUFvQixnQkFBZ0I7QUFBQSxFQUMxQztBQUFBLEVBRVEsb0JBQW9CLFdBQXdCO0FBRW5ELFVBQU0sZ0JBQWdCLFVBQVUsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDeEUsa0JBQWMsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVkzQjtBQUFBLEVBRVEsb0JBQW9CLFdBQXdCO0FBQ25ELFVBQU0saUJBQWlCLFVBQVUsVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDeEUsbUJBQWUsU0FBUyxNQUFNLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUU5RCxRQUFJLDBCQUFRLGNBQWMsRUFDeEIsUUFBUSxZQUFZLEVBQ3BCLFFBQVEscUNBQXFDLEVBQzdDLFVBQVUsWUFBVSxPQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxPQUFPLEVBQzdELFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxVQUFVO0FBQ3ZELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsVUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGFBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxNQUM1RjtBQUdBLFdBQUssUUFBUTtBQUFBLElBQ2QsQ0FBQyxDQUFDO0FBRUosUUFBSSxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsU0FBUztBQUN6RCxVQUFJLDBCQUFRLGNBQWMsRUFDeEIsUUFBUSxlQUFlLEVBQ3ZCLFFBQVEsb0VBQW9FLEVBQzVFLFFBQVEsVUFBUSxLQUNmLGVBQWUsWUFBWSxFQUMzQixTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxnQkFBZ0IsRUFBRSxFQUN4RSxTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsZUFBZSxTQUFTO0FBQ3JFLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGVBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxRQUM1RjtBQUFBLE1BR0QsQ0FBQyxDQUFDO0FBRUosVUFBSSwwQkFBUSxjQUFjLEVBQ3hCLFFBQVEsd0JBQXdCLEVBQ2hDLFFBQVEsaURBQWlELEVBQ3pELFVBQVUsWUFBVSxPQUNuQixTQUFTLEtBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxrQkFBa0IsS0FBSyxFQUM3RSxTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsaUJBQWlCO0FBQzlELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFFL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGVBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxRQUM1RjtBQUdBLFlBQUksT0FBTztBQUNWLGVBQUssYUFBYTtBQUFBLFFBQ25CO0FBR0EsY0FBTSxTQUFTLEtBQUssT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLHNCQUFzQjtBQUMvRSxZQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLGdCQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsc0JBQVksbUJBQW1CO0FBQUEsUUFDaEM7QUFHQSxhQUFLLGlCQUFpQjtBQUFBLE1BQ3ZCLENBQUMsQ0FBQztBQUdKLFVBQUksMEJBQVEsY0FBYyxFQUN4QixRQUFRLG9CQUFvQixFQUM1QixRQUFRLDJDQUEyQyxFQUNuRCxVQUFVLFlBQVUsT0FDbkIsY0FBYyxnQkFBZ0IsRUFDOUIsV0FBVyxFQUNYLFFBQVEsWUFBWTtBQUVwQixjQUFNLFlBQVksUUFBUSw4RkFBOEY7QUFDeEgsWUFBSSxDQUFDLFVBQVc7QUFHaEIsYUFBSyxPQUFPLFNBQVMsVUFBVSxzQkFBc0I7QUFHckQsWUFBSSxLQUFLLE9BQU8sU0FBUyxVQUFVLGNBQWMsZ0JBQWdCO0FBQ2hFLGVBQUssT0FBTyxTQUFTLFVBQVUsY0FBYyxpQkFBaUI7QUFBQSxRQUMvRDtBQUVBLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFHL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGdCQUFNLEtBQUssT0FBTyxlQUFlLHVCQUF1QixJQUFJO0FBQzVELGVBQUssT0FBTyxlQUFlLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxVQUFVLGFBQWE7QUFBQSxRQUM1RjtBQUdBLGNBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsWUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixnQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLHNCQUFZLG1CQUFtQjtBQUFBLFFBQ2hDO0FBR0EsYUFBSyxtQkFBbUIsc0NBQXNDLFNBQVM7QUFHdkUsYUFBSyxpQkFBaUI7QUFBQSxNQUN2QixDQUFDLENBQUM7QUFBQSxJQUNMO0FBQUEsRUFDRDtBQUFBLEVBRVEsbUJBQW1CLFNBQWlCLE1BQTJCO0FBRXRFLFVBQU0sa0JBQWtCLEtBQUssWUFBWSxjQUFjLHVCQUF1QjtBQUM5RSxRQUFJLGlCQUFpQjtBQUNwQixzQkFBZ0IsT0FBTztBQUFBLElBQ3hCO0FBRUEsVUFBTSxZQUFZLEtBQUssWUFBWSxVQUFVO0FBQUEsTUFDNUMsS0FBSyx3QkFBd0IsSUFBSTtBQUFBLE1BQ2pDLE1BQU07QUFBQSxJQUNQLENBQUM7QUFHRCxlQUFXLE1BQU07QUFDaEIsZ0JBQVUsT0FBTztBQUFBLElBQ2xCLEdBQUcsR0FBSTtBQUFBLEVBQ1I7QUFBQSxFQUVRLGVBQWU7QUFFdEIsVUFBTSxvQkFBb0IsU0FBUyxjQUFjLEtBQUs7QUFDdEQsc0JBQWtCLFlBQVk7QUFDOUIsYUFBUyxLQUFLLFlBQVksaUJBQWlCO0FBRzNDLFVBQU0sT0FBTyxLQUFLLFlBQVksc0JBQXNCO0FBQ3BELFVBQU0sVUFBVSxLQUFLLE9BQU8sS0FBSyxRQUFRO0FBQ3pDLFVBQU0sVUFBVSxLQUFLLE1BQU0sS0FBSyxJQUFJLEtBQUssU0FBUyxHQUFHLEdBQUc7QUFHeEQsVUFBTSxTQUFTLENBQUMsUUFBUSxRQUFRLFFBQVEsU0FBUyxPQUFPLEVBQUU7QUFHMUQsYUFBUyxJQUFJLEdBQUcsSUFBSSxLQUFLLEtBQUs7QUFDN0IsWUFBTSxXQUFXLFNBQVMsY0FBYyxLQUFLO0FBQzdDLGVBQVMsWUFBWSx1QkFBdUIsT0FBTyxLQUFLLE1BQU0sS0FBSyxPQUFPLElBQUksT0FBTyxNQUFNLENBQUMsQ0FBQztBQUc3RixlQUFTLE1BQU0sT0FBTyxHQUFHLE9BQU87QUFDaEMsZUFBUyxNQUFNLE1BQU0sR0FBRyxPQUFPO0FBRy9CLFlBQU0sUUFBUyxLQUFLLEtBQUssSUFBSSxJQUFLLE9BQU8sS0FBSyxPQUFPLElBQUksTUFBTTtBQUMvRCxZQUFNLFdBQVcsTUFBTSxLQUFLLE9BQU8sSUFBSTtBQUN2QyxZQUFNLFdBQVcsS0FBSyxJQUFJLEtBQUssSUFBSTtBQUNuQyxZQUFNLFdBQVcsS0FBSyxJQUFJLEtBQUssSUFBSSxXQUFXO0FBRzlDLGVBQVMsTUFBTSxZQUFZLGVBQWUsR0FBRyxRQUFRLElBQUk7QUFDekQsZUFBUyxNQUFNLFlBQVksZUFBZSxHQUFHLFFBQVEsSUFBSTtBQUd6RCxlQUFTLE1BQU0saUJBQWlCLEdBQUcsS0FBSyxPQUFPLElBQUksR0FBRztBQUd0RCxZQUFNLE9BQU8sSUFBSSxLQUFLLE9BQU8sSUFBSTtBQUNqQyxlQUFTLE1BQU0sUUFBUSxHQUFHLElBQUk7QUFDOUIsZUFBUyxNQUFNLFNBQVMsR0FBRyxJQUFJO0FBRy9CLFVBQUksS0FBSyxPQUFPLElBQUksS0FBSztBQUN4QixpQkFBUyxNQUFNLFNBQVMsR0FBRyxPQUFPLEdBQUc7QUFBQSxNQUN0QztBQUVBLHdCQUFrQixZQUFZLFFBQVE7QUFBQSxJQUN2QztBQUdBLGVBQVcsTUFBTTtBQUNoQix3QkFBa0IsT0FBTztBQUFBLElBQzFCLEdBQUcsR0FBSTtBQUFBLEVBQ1I7QUFBQSxFQUVRLHNCQUFzQixjQUFjLEtBQUssYUFBYTtBQUU3RCxVQUFNLGNBQWMsWUFBWSxVQUFVLEVBQUUsS0FBSyw2QkFBNkIsQ0FBQztBQUMvRSxnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBR3BELGdCQUFZLE1BQU0sZUFBZTtBQUVqQyxRQUFJLDBCQUFRLFdBQVcsRUFDckIsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSxxRUFBcUUsRUFDN0UsVUFBVSxZQUFVLE9BQ25CLFVBQVUsR0FBRyxHQUFHLEdBQUcsRUFDbkIsU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUFRLGtCQUFrQixFQUN4RCxrQkFBa0IsRUFDbEIsU0FBUyxPQUFPLFVBQVU7QUFDMUIsV0FBSyxPQUFPLFNBQVMsUUFBUSxxQkFBcUI7QUFDbEQsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUVKLFFBQUksMEJBQVEsV0FBVyxFQUNyQixRQUFRLG9CQUFvQixFQUM1QixRQUFRLDREQUE0RCxFQUNwRSxRQUFRLFVBQVE7QUFDaEIsV0FBSyxRQUFRLE9BQU87QUFDcEIsV0FBSyxRQUFRLE1BQU0sUUFBUTtBQUMzQixXQUFLLFFBQVEsTUFBTSxTQUFTO0FBQzVCLGFBQU8sS0FDTCxlQUFlLE1BQU0sRUFDckIsU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUFRLGlCQUFpQixTQUFTLENBQUMsRUFDakUsU0FBUyxPQUFPLFVBQVU7QUFDMUIsY0FBTSxXQUFXLFNBQVMsS0FBSztBQUMvQixZQUFJLENBQUMsTUFBTSxRQUFRLEtBQUssV0FBVyxHQUFHO0FBQ3JDLGVBQUssT0FBTyxTQUFTLFFBQVEsbUJBQW1CO0FBQ2hELGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsUUFDaEM7QUFBQSxNQUNELENBQUM7QUFBQSxJQUNILENBQUM7QUFFRixRQUFJLDBCQUFRLFdBQVcsRUFDckIsUUFBUSxvQkFBb0IsRUFDNUIsUUFBUSwwQ0FBMEMsRUFDbEQsVUFBVSxZQUFVLE9BQ25CLFNBQVMsS0FBSyxPQUFPLFNBQVMsUUFBUSxRQUFRLEVBQzlDLFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLFFBQVEsV0FBVztBQUN4QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBQUEsRUFFTDtBQUFBLEVBRVEsdUJBQXVCLGNBQWMsS0FBSyxhQUFhO0FBRTlELFVBQU0saUJBQWlCLFlBQVksVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDN0UsbUJBQWUsU0FBUyxNQUFNLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNqRSxtQkFBZSxTQUFTLE1BQU0sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRTdELFVBQU0sU0FBUyxlQUFlLFVBQVUsRUFBRSxLQUFLLHFCQUFxQixDQUFDO0FBQ3JFLFdBQU8sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFpQm5CLFVBQU0sZ0JBQWdCLGVBQWUsVUFBVSxFQUFFLEtBQUssK0JBQStCLENBQUM7QUFDdEYsa0JBQWMsU0FBUyxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN0RCxrQkFBYyxTQUFTLE1BQU0sRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRzVELFNBQUsscUJBQXFCLGFBQWE7QUFDdkMsU0FBSyxxQkFBcUIsYUFBYTtBQUN2QyxTQUFLLHFCQUFxQixhQUFhO0FBQ3ZDLFNBQUsscUJBQXFCLGFBQWE7QUFBQSxFQUN4QztBQUFBLEVBRVEscUJBQXFCLGNBQWMsS0FBSyxhQUFhO0FBRTVELFVBQU0sa0JBQWtCLFlBQVksVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFHOUUsVUFBTSxrQkFBa0IsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ2pGLFVBQU0sVUFBVSxnQkFBZ0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUc3RSxVQUFNLGtCQUFrQixLQUFLLDhCQUE4QixTQUFTLFFBQVE7QUFDNUUsb0JBQWdCLGFBQWEsaUJBQWlCLFFBQVE7QUFFdEQsU0FBSyx3QkFBd0IsaUJBQWlCO0FBQUEsTUFDN0MsTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLE1BQ04sYUFBYTtBQUFBLE1BQ2IsT0FBTyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sVUFBVTtBQUFBLE1BQ3pELFVBQVUsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxTQUFTO0FBQ2pELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQztBQUFBLElBQ0QsQ0FBQztBQUdELFNBQUssMkJBQTJCLGlCQUFpQixRQUFRO0FBR3pELFVBQU0sZUFBZSxJQUFJLDBCQUFRLGVBQWUsRUFDOUMsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUI7QUFFL0IsUUFBSTtBQUVKLGlCQUFhLFlBQVksY0FBWTtBQUNwQyxzQkFBZ0I7QUFDaEIsZUFBUyxTQUFTLE1BQU0sUUFBUTtBQUNoQyxlQUFTLFNBQVMsTUFBTSxTQUFTO0FBQ2pDLFdBQUsscUJBQXFCLFFBQVE7QUFDbEMsYUFBTyxTQUNMLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVMsMEJBQTBCLEVBQ3BGLFNBQVMsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxRQUFRO0FBQ2hELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQyxDQUFDO0FBQUEsSUFDSCxDQUFDO0FBQUEsRUFHRjtBQUFBLEVBRVEscUJBQXFCLFVBQWU7QUFFM0MsYUFBUyxTQUFTLE1BQU07QUFHeEIsVUFBTSxnQkFBZ0IsbUJBQW1CLFFBQVE7QUFFakQsa0JBQWMsUUFBUSxXQUFTO0FBQzlCLGVBQVMsVUFBVSxNQUFNLE9BQU8sTUFBTSxLQUFLO0FBQUEsSUFDNUMsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUlRLHFCQUFxQixjQUFjLEtBQUssYUFBYTtBQUU1RCxVQUFNLGtCQUFrQixZQUFZLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBRzlFLFVBQU0sa0JBQWtCLGdCQUFnQixVQUFVLEVBQUUsS0FBSyx1QkFBdUIsQ0FBQztBQUNqRixVQUFNLFVBQVUsZ0JBQWdCLFNBQVMsTUFBTSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFHM0UsVUFBTSxrQkFBa0IsS0FBSyw4QkFBOEIsU0FBUyxRQUFRO0FBQzVFLG9CQUFnQixhQUFhLGlCQUFpQixRQUFRO0FBRXRELFNBQUssd0JBQXdCLGlCQUFpQjtBQUFBLE1BQzdDLE1BQU07QUFBQSxNQUNOLE1BQU07QUFBQSxNQUNOLGFBQWE7QUFBQSxNQUNiLE9BQU8sS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFVBQVU7QUFBQSxNQUN6RCxVQUFVLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUztBQUNqRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEM7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLDJCQUEyQixpQkFBaUIsUUFBUTtBQUd6RCxVQUFNLGVBQWUsSUFBSSwwQkFBUSxlQUFlLEVBQzlDLFFBQVEsT0FBTyxFQUNmLFFBQVEscUJBQXFCO0FBRS9CLFFBQUk7QUFFSixpQkFBYSxZQUFZLGNBQVk7QUFDcEMsc0JBQWdCO0FBQ2hCLGVBQVMsU0FBUyxNQUFNLFFBQVE7QUFDaEMsZUFBUyxTQUFTLE1BQU0sU0FBUztBQUNqQyxXQUFLLHFCQUFxQixRQUFRO0FBQ2xDLGFBQU8sU0FDTCxTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxTQUFTLHlCQUF5QixFQUNuRixTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sUUFBUTtBQUNoRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBR0Y7QUFBQSxFQUVRLHFCQUFxQixVQUFlO0FBRTNDLGFBQVMsU0FBUyxNQUFNO0FBR3hCLFVBQU0sZ0JBQWdCLG1CQUFtQixRQUFRO0FBRWpELGtCQUFjLFFBQVEsV0FBUztBQUM5QixlQUFTLFVBQVUsTUFBTSxPQUFPLE1BQU0sS0FBSztBQUFBLElBQzVDLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFUSxxQkFBcUIsY0FBYyxLQUFLLGFBQWE7QUFFNUQsVUFBTSxrQkFBa0IsWUFBWSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUc5RSxVQUFNLGtCQUFrQixnQkFBZ0IsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDakYsVUFBTSxVQUFVLGdCQUFnQixTQUFTLE1BQU0sRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRzFFLFVBQU0sa0JBQWtCLEtBQUssOEJBQThCLFNBQVMsUUFBUTtBQUM1RSxvQkFBZ0IsYUFBYSxpQkFBaUIsUUFBUTtBQUV0RCxTQUFLLHdCQUF3QixpQkFBaUI7QUFBQSxNQUM3QyxNQUFNO0FBQUEsTUFDTixNQUFNO0FBQUEsTUFDTixhQUFhO0FBQUEsTUFDYixPQUFPLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxVQUFVO0FBQUEsTUFDekQsVUFBVSxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVM7QUFDakQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDO0FBQUEsSUFDRCxDQUFDO0FBR0QsU0FBSywyQkFBMkIsaUJBQWlCLFFBQVE7QUFHekQsVUFBTSxlQUFlLElBQUksMEJBQVEsZUFBZSxFQUM5QyxRQUFRLE9BQU8sRUFDZixRQUFRLHFCQUFxQjtBQUUvQixRQUFJO0FBRUosaUJBQWEsWUFBWSxjQUFZO0FBQ3BDLHNCQUFnQjtBQUNoQixlQUFTLFNBQVMsTUFBTSxRQUFRO0FBQ2hDLGVBQVMsU0FBUyxNQUFNLFNBQVM7QUFDakMsV0FBSyxxQkFBcUIsUUFBUTtBQUNsQyxhQUFPLFNBQ0wsU0FBUyxLQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sU0FBUyxnQ0FBZ0MsRUFDMUYsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFFBQVE7QUFDaEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNILENBQUM7QUFBQSxFQUdGO0FBQUEsRUFFUSxxQkFBcUIsVUFBZTtBQUUzQyxhQUFTLFNBQVMsTUFBTTtBQUd4QixVQUFNLGdCQUFnQixtQkFBbUIsUUFBUTtBQUVqRCxrQkFBYyxRQUFRLFdBQVM7QUFDOUIsZUFBUyxVQUFVLE1BQU0sT0FBTyxNQUFNLEtBQUs7QUFBQSxJQUM1QyxDQUFDO0FBQUEsRUFDRjtBQUFBLEVBRVEscUJBQXFCLGNBQWMsS0FBSyxhQUFhO0FBQzVELFVBQU0sa0JBQWtCLFlBQVksVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFHOUUsVUFBTSxrQkFBa0IsZ0JBQWdCLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBQ2pGLFVBQU0sVUFBVSxnQkFBZ0IsU0FBUyxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUd6RSxVQUFNLGtCQUFrQixLQUFLLDhCQUE4QixTQUFTLFFBQVE7QUFDNUUsb0JBQWdCLGFBQWEsaUJBQWlCLFFBQVE7QUFFdEQsUUFBSSwwQkFBUSxlQUFlLEVBQ3pCLFFBQVEsVUFBVSxFQUNsQixRQUFRLG1CQUFtQixFQUMzQixRQUFRLFVBQVE7QUFDaEIsV0FBSyxRQUFRLE1BQU0sUUFBUTtBQUMzQixXQUFLLFFBQVEsTUFBTSxTQUFTO0FBQzVCLGFBQU8sS0FDTCxlQUFlLHdCQUF3QixFQUN2QyxTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVksT0FBTyxXQUFXLEVBQUUsRUFDOUQsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFVBQVU7QUFDbEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNILENBQUM7QUFHRixTQUFLLDJCQUEyQixpQkFBaUIsUUFBUTtBQUV6RCxRQUFJLDBCQUFRLGVBQWUsRUFDekIsUUFBUSxPQUFPLEVBQ2YsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSxVQUFRO0FBQ2hCLFdBQUssUUFBUSxNQUFNLFFBQVE7QUFDM0IsV0FBSyxRQUFRLE1BQU0sU0FBUztBQUM1QixhQUFPLEtBQ0wsZUFBZSxRQUFRLEVBQ3ZCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLFNBQVMsRUFBRSxFQUM1RCxTQUFTLE9BQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sUUFBUTtBQUNoRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUVGLFFBQUksMEJBQVEsZUFBZSxFQUN6QixRQUFRLHVCQUF1QixFQUMvQixRQUFRLGlGQUFrRixFQUMxRixRQUFRLFVBQVE7QUFDaEIsV0FBSyxRQUFRLE9BQU87QUFDcEIsV0FBSyxRQUFRLE1BQU0sUUFBUTtBQUMzQixXQUFLLFFBQVEsTUFBTSxTQUFTO0FBQzVCLGFBQU8sS0FDTCxlQUFlLE9BQU8sRUFDdEIsVUFBVSxLQUFLLE9BQU8sU0FBUyx3QkFBd0IsTUFBTyxTQUFTLENBQUMsRUFDeEUsU0FBUyxPQUFPLFVBQVU7QUFDMUIsY0FBTSxXQUFXLFNBQVMsS0FBSztBQUMvQixZQUFJLENBQUMsTUFBTSxRQUFRLEtBQUssV0FBVyxHQUFHO0FBQ3JDLGVBQUssT0FBTyxTQUFTLHVCQUF1QjtBQUM1QyxnQkFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLFFBQ2hDO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDSCxDQUFDO0FBQUEsRUFDSDtBQUFBLEVBRVEsdUJBQXVCLGNBQWMsS0FBSyxhQUFhO0FBQzlELGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFHeEQsVUFBTSxTQUFTLFlBQVksVUFBVSxFQUFFLEtBQUsscUJBQXFCLENBQUM7QUFDbEUsV0FBTyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVW5CLFFBQUksMEJBQVEsV0FBVyxFQUNyQixRQUFRLGlCQUFpQixFQUN6QixRQUFRLDRJQUE0STtBQUFBLEVBQ3ZKO0FBQUEsRUFFUSwrQkFBK0IsVUFBZ0Q7QUFFdEYsV0FBTyxhQUFhLFlBQ2pCLENBQUMsVUFBVSxVQUFVLFVBQVUsUUFBUSxJQUN2QyxDQUFDLFVBQVUsVUFBVSxRQUFRO0FBQUEsRUFDakM7QUFBQSxFQUVRLHVCQUF1QixVQUFnQztBQUM5RCxVQUFNLFFBQXNDO0FBQUEsTUFDM0MsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsVUFBVTtBQUFBLE1BQ1YsUUFBUTtBQUFBLElBQ1Q7QUFDQSxXQUFPLE1BQU0sUUFBUSxLQUFLO0FBQUEsRUFDM0I7QUFBQSxFQUVBLE1BQU0sZ0JBQWdCLFNBQWdDO0FBQ3JELFVBQU0sV0FBVywyQkFBUyxXQUFXLFdBQVc7QUFDaEQsU0FBSyxPQUFPLFNBQVMsaUJBQWlCLFFBQVEsRUFBRSxnQkFBZ0I7QUFHaEUsUUFBSSxLQUFLLE9BQU8sbUJBQW1CO0FBQ2xDLFdBQUssT0FBTyxrQkFBa0IsZUFBZSxLQUFLLE9BQU8sUUFBUTtBQUFBLElBQ2xFO0FBQUEsRUFDRDtBQUFBLEVBRVEsc0JBQXNCLGNBQWMsS0FBSyxhQUFhO0FBQzdELGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFHdEQsUUFBSSxDQUFDLEtBQUssT0FBTyxlQUFlLGlCQUFpQixVQUFVLEdBQUc7QUFDN0QsWUFBTSxXQUFXLFlBQVksVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDckUsZUFBUyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVNyQjtBQUFBLElBQ0Q7QUFHQSxVQUFNLFNBQVMsWUFBWSxVQUFVLEVBQUUsS0FBSywyQkFBMkIsQ0FBQztBQUN4RSxXQUFPLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU9uQixRQUFJLDBCQUFRLFdBQVcsRUFDckIsUUFBUSxzQ0FBc0MsRUFDOUMsUUFBUSxnSEFBZ0gsRUFDeEgsVUFBVSxZQUFVLE9BQ25CLFNBQVMsS0FBSyxPQUFPLFNBQVMsaUJBQWlCLEVBQy9DLFNBQVMsT0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLG9CQUFvQjtBQUN6QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBRy9CLFlBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsVUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixjQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsb0JBQVkscUJBQXFCO0FBQUEsTUFDbEM7QUFBQSxJQUNELENBQUMsQ0FBQztBQUdKLFVBQU0sV0FBVyxZQUFZLFVBQVUsRUFBRSxLQUFLLG1CQUFtQixDQUFDO0FBQ2xFLGFBQVMsTUFBTSxVQUFVO0FBRXpCLFFBQUksMEJBQVEsUUFBUSxFQUNsQjtBQUFBLE1BQVUsWUFDVixPQUNFLGNBQWMsc0JBQXNCLEVBQ3BDLE9BQU8sRUFDUCxRQUFRLE1BQU0sS0FBSyxxQkFBcUIsQ0FBQztBQUFBLElBQzVDO0FBR0QsU0FBSyx5QkFBeUIsV0FBVztBQUFBLEVBQzFDO0FBQUEsRUFFUSx5QkFBeUIsV0FBd0I7QUFFeEQsVUFBTSxlQUFlLFVBQVUsY0FBYyxxQkFBcUI7QUFDbEUsUUFBSSxhQUFjLGNBQWEsT0FBTztBQUV0QyxVQUFNLGVBQWUsVUFBVSxVQUFVLEVBQUUsS0FBSyxxQkFBcUIsQ0FBQztBQUN0RSxVQUFNLFdBQVcsS0FBSyxPQUFPLFNBQVMsa0JBQWtCLENBQUM7QUFFekQsUUFBSSxTQUFTLFdBQVcsR0FBRztBQUMxQixZQUFNLFVBQVUsYUFBYSxVQUFVLEVBQUUsS0FBSyxzQkFBc0IsQ0FBQztBQUNyRSxjQUFRLFlBQVk7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXBCO0FBQUEsSUFDRDtBQUVBLGFBQVMsUUFBUSxDQUFDLFNBQVMsVUFBVTtBQUNwQyxZQUFNLFlBQVksYUFBYSxVQUFVLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUNyRSxnQkFBVSxNQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFTMUIsWUFBTSxXQUFXLFVBQVUsVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFDbkUsZUFBUyxNQUFNLFVBQVU7QUFFekIsWUFBTSxTQUFTLFNBQVMsVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFFOUQsWUFBTSxTQUFTLE9BQU8sVUFBVSxFQUFFLEtBQUssb0JBQW9CLENBQUM7QUFDNUQsYUFBTyxjQUFjLFFBQVE7QUFDN0IsYUFBTyxNQUFNLFVBQVU7QUFFdkIsWUFBTSxZQUFZLE9BQU8sVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDbEUsZ0JBQVUsWUFBWSxVQUFVLFFBQVEsT0FBTztBQUMvQyxnQkFBVSxNQUFNLFVBQVU7QUFHMUIsWUFBTSxZQUFZLFNBQVMsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDcEUsZ0JBQVUsTUFBTSxVQUFVO0FBRTFCLFlBQU0sVUFBVSxVQUFVLFNBQVMsVUFBVSxFQUFFLE1BQU0sT0FBTyxDQUFDO0FBQzdELGNBQVEsTUFBTSxVQUFVO0FBQ3hCLGNBQVEsVUFBVSxNQUFNLEtBQUssc0JBQXNCLEtBQUs7QUFFeEQsWUFBTSxZQUFZLFVBQVUsU0FBUyxVQUFVLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDakUsZ0JBQVUsTUFBTSxVQUFVO0FBQzFCLGdCQUFVLFVBQVUsTUFBTSxLQUFLLGNBQWMsS0FBSztBQUdsRCxVQUFJLFFBQVEsYUFBYTtBQUN4QixjQUFNLFNBQVMsVUFBVSxVQUFVLEVBQUUsS0FBSyxvQkFBb0IsQ0FBQztBQUMvRCxlQUFPLGNBQWMsUUFBUTtBQUM3QixlQUFPLE1BQU0sVUFBVTtBQUFBLE1BQ3hCO0FBRUEsWUFBTSxhQUFhLFVBQVUsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDdkUsaUJBQVcsWUFBWTtBQUFBO0FBQUEsT0FFbkIsUUFBUSxRQUFRO0FBQUE7QUFBQTtBQUFBLElBR3JCLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFUSx1QkFBdUI7QUFDOUIsU0FBSyxrQkFBa0I7QUFBQSxFQUN4QjtBQUFBLEVBRVEsc0JBQXNCLE9BQWU7QUF2bkQ5QztBQXduREUsVUFBTSxXQUFVLFVBQUssT0FBTyxTQUFTLG1CQUFyQixtQkFBc0M7QUFDdEQsUUFBSSxTQUFTO0FBQ1osV0FBSyxrQkFBa0IsU0FBUyxLQUFLO0FBQUEsSUFDdEM7QUFBQSxFQUNEO0FBQUEsRUFFUSxrQkFBa0IsaUJBQWlDLFdBQW9CO0FBRzlFLFVBQU0sT0FBTyxPQUFPLGtCQUFpQixtREFBaUIsU0FBUSxFQUFFO0FBQ2hFLFFBQUksQ0FBQyxLQUFNO0FBRVgsVUFBTSxVQUFVLE9BQU8saUNBQWdDLG1EQUFpQixZQUFXLEVBQUU7QUFDckYsUUFBSSxDQUFDLFFBQVM7QUFFZCxVQUFNLGNBQWMsT0FBTyw0QkFBMkIsbURBQWlCLGdCQUFlLEVBQUU7QUFFeEYsVUFBTSxXQUFXLE9BQU8sc0JBQXFCLG1EQUFpQixhQUFZLEVBQUU7QUFDNUUsUUFBSSxDQUFDLFNBQVU7QUFFZixVQUFNLFNBQXdCO0FBQUEsTUFDN0IsS0FBSSxtREFBaUIsT0FBTyxTQUFTLEtBQUssT0FBTyxFQUFFLFNBQVMsRUFBRSxFQUFFLE9BQU8sR0FBRyxDQUFDO0FBQUEsTUFDM0U7QUFBQSxNQUNBLFNBQVMsUUFBUSxZQUFZO0FBQUEsTUFDN0I7QUFBQSxNQUNBLGFBQWEsZUFBZTtBQUFBLElBQzdCO0FBRUEsUUFBSSxjQUFjLFFBQVc7QUFFNUIsVUFBSSxDQUFDLEtBQUssT0FBTyxTQUFTLGVBQWdCLE1BQUssT0FBTyxTQUFTLGlCQUFpQixDQUFDO0FBQ2pGLFdBQUssT0FBTyxTQUFTLGVBQWUsU0FBUyxJQUFJO0FBQUEsSUFDbEQsT0FBTztBQUVOLFVBQUksQ0FBQyxLQUFLLE9BQU8sU0FBUyxlQUFnQixNQUFLLE9BQU8sU0FBUyxpQkFBaUIsQ0FBQztBQUNqRixXQUFLLE9BQU8sU0FBUyxlQUFlLEtBQUssTUFBTTtBQUFBLElBQ2hEO0FBRUEsU0FBSyxPQUFPLGFBQWE7QUFDekIsU0FBSyx5QkFBeUIsS0FBSyxZQUFZLGNBQWMsdUJBQXVCLENBQWdCO0FBQUEsRUFDckc7QUFBQSxFQUVRLGNBQWMsT0FBZTtBQUNwQyxRQUFJLENBQUMsS0FBSyxPQUFPLFNBQVMsZUFBZ0I7QUFFMUMsVUFBTSxVQUFVLEtBQUssT0FBTyxTQUFTLGVBQWUsS0FBSztBQUN6RCxVQUFNLFlBQVksUUFBUSxtQkFBbUIsUUFBUSxJQUFJLE1BQU0sUUFBUSxPQUFPLElBQUk7QUFFbEYsUUFBSSxXQUFXO0FBQ2QsV0FBSyxPQUFPLFNBQVMsZUFBZSxPQUFPLE9BQU8sQ0FBQztBQUNuRCxXQUFLLE9BQU8sYUFBYTtBQUN6QixXQUFLLHlCQUF5QixLQUFLLFlBQVksY0FBYyx1QkFBdUIsQ0FBZ0I7QUFBQSxJQUNyRztBQUFBLEVBQ0Q7QUFBQSxFQUVRLHFCQUFxQixXQUE4QjtBQUMxRCxVQUFNLGlCQUFpQixVQUFVLFVBQVUsRUFBRSxLQUFLLHVCQUF1QixDQUFDO0FBRzFFLFVBQU0sWUFBWSxlQUFlLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ3pFLGNBQVUsWUFBWTtBQUFBO0FBQUEsTUFFbEIsYUFBYTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFRbEI7QUFBQSxFQUVRLHNCQUFzQixXQUE4QjtBQUMzRCxVQUFNLGVBQWUsVUFBVSxVQUFVLEVBQUUsS0FBSywyQkFBMkIsQ0FBQztBQUM1RSxpQkFBYSxNQUFNLFlBQVk7QUFHL0IsVUFBTSxnQkFBZ0IsYUFBYSxVQUFVLEVBQUUsS0FBSyx3QkFBd0IsQ0FBQztBQUM3RSxrQkFBYyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlCMUIsVUFBTSxXQUFXLGFBQWEsVUFBVSxFQUFFLEtBQUssd0JBQXdCLENBQUM7QUFDeEUsYUFBUyxNQUFNLFlBQVk7QUFDM0IsYUFBUyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFnQnJCLFVBQU0sZUFBZSxhQUFhLFVBQVUsRUFBRSxLQUFLLHdCQUF3QixDQUFDO0FBQzVFLGlCQUFhLE1BQU0sWUFBWTtBQUMvQixpQkFBYSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFnQjFCO0FBQUEsRUFHUSw0QkFBNEIsV0FBOEI7QUE5dkRuRTtBQWd3REUsVUFBTSxnQkFBYyxVQUFLLE9BQU8sbUJBQVosbUJBQTRCLDJCQUEwQjtBQUMxRSxVQUFNLG9CQUFtQixVQUFLLE9BQU8sbUJBQVosbUJBQTRCO0FBR3JELFFBQUksa0JBQWtCO0FBQ3JCLFlBQU0sV0FBVyxVQUFVLFVBQVUsRUFBRSxLQUFLLHNCQUFzQixDQUFDO0FBQ25FLFlBQU0sYUFBYSxpQkFBaUIsWUFDakMsWUFBWSxpQkFBaUIsVUFBVSxtQkFBbUIsQ0FBQyxLQUMzRDtBQUNILGVBQVMsWUFBWTtBQUFBO0FBQUE7QUFBQSxpREFHeUIsaUJBQWlCLEtBQUs7QUFBQSxrRUFDTCxVQUFVO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFJMUU7QUFHQSxTQUFLLHdCQUF3QixXQUFXO0FBQUEsTUFDdkMsTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLE1BQ04sYUFBYTtBQUFBLE1BQ2IsT0FBTyxLQUFLLE9BQU8sU0FBUyxVQUFVLHVCQUF1QjtBQUFBLE1BQzdELFVBQVUsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFVBQVUsc0JBQXNCO0FBQ3JELGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFHL0IsWUFBSSxLQUFLLE9BQU8sZ0JBQWdCO0FBQy9CLGdCQUFNLEtBQUssT0FBTyxlQUFlLHVCQUF1QixTQUFTLElBQUk7QUFHckUsZ0JBQU0sU0FBUyxLQUFLLE9BQU8sSUFBSSxVQUFVLGdCQUFnQixzQkFBc0I7QUFDL0UsY0FBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixrQkFBTSxjQUFjLE9BQU8sQ0FBQyxFQUFFO0FBQzlCLHdCQUFZLG1CQUFtQjtBQUFBLFVBQ2hDO0FBR0EsZUFBSyxpQkFBaUI7QUFBQSxRQUN2QjtBQUFBLE1BQ0Q7QUFBQSxJQUNELENBQUM7QUFHRCxVQUFNLGVBQWUsVUFBVSxVQUFVLEVBQUUsS0FBSyx5QkFBeUIsQ0FBQztBQUMxRSxpQkFBYSxNQUFNLFlBQVk7QUFDL0IsaUJBQWEsTUFBTSxXQUFXO0FBQUEsRUFDL0I7QUFBQSxFQUVRLG1CQUFtQixXQUF3QixVQU0vQyxDQUFDLEdBQVM7QUExekRmO0FBNHpERSxVQUFNO0FBQUEsTUFDTCx5QkFBeUI7QUFBQSxNQUN6QixlQUFlO0FBQUEsTUFDZixnQkFBZ0I7QUFBQSxNQUNoQixZQUFZO0FBQUEsTUFDWixlQUFlO0FBQUEsSUFDaEIsSUFBSTtBQUdKLFVBQU0sZ0JBQWMsVUFBSyxPQUFPLG1CQUFaLG1CQUE0QiwyQkFBMEI7QUFHMUUsUUFBSSwwQkFBMEIsYUFBYTtBQUMxQztBQUFBLElBQ0Q7QUFFQSxVQUFNLGFBQWEsY0FBYyx3QkFBd0I7QUFDekQsVUFBTSxhQUFhLGNBQWMsV0FBTTtBQUd2QyxVQUFNLGFBQWEsVUFBVSxVQUFVLEVBQUUsS0FBSyxtQ0FBbUMsQ0FBQztBQUNsRixlQUFXLE1BQU0sWUFBWTtBQUM3QixlQUFXLE1BQU0sZUFBZTtBQUVoQyxlQUFXLFlBQVk7QUFBQTtBQUFBO0FBQUEseUNBR2dCLFVBQVU7QUFBQTtBQUFBO0FBQUEsMkJBR3hCLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxrREFJYSxpQkFBaUIsUUFBUSx5QkFBeUIsRUFBRTtBQUFBLFFBQzlGLGNBQWUsaUJBQWlCLFFBQVEsbUJBQW1CLDhCQUErQixvQkFBb0I7QUFBQTtBQUFBLE9BRS9HLGdCQUFnQiwwRkFBMEYsRUFBRTtBQUFBO0FBQUE7QUFBQTtBQU1qSCxRQUFJLGlCQUFpQixPQUFPO0FBQzNCLGlCQUFXLGlCQUFpQix3QkFBd0IsRUFBRSxRQUFRLFlBQVU7QUFDdkUsZUFBTyxpQkFBaUIsU0FBUyxDQUFDLE1BQU07QUFDdkMsWUFBRSxlQUFlO0FBQ2pCLGVBQUssVUFBVSxXQUFXO0FBQUEsUUFDM0IsQ0FBQztBQUFBLE1BQ0YsQ0FBQztBQUFBLElBQ0Y7QUFBQSxFQUNEO0FBQUEsRUFFUSxxQkFBcUIsV0FBOEI7QUFDMUQsVUFBTSxhQUFhLFVBQVUsVUFBVSxFQUFFLEtBQUssMEJBQTBCLENBQUM7QUFDekUsZUFBVyxNQUFNLFlBQVk7QUFFN0IsVUFBTSxVQUFVLFdBQVcsVUFBVSxFQUFFLEtBQUssdUJBQXVCLENBQUM7QUFDcEUsWUFBUSxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBd0JwQixZQUFRLGlCQUFpQixpQkFBaUIsRUFBRSxRQUFRLFVBQVE7QUFDM0QsV0FBSyxpQkFBaUIsU0FBUyxDQUFDLE1BQU07QUFDckMsVUFBRSxlQUFlO0FBQ2pCLGNBQU0sUUFBUyxFQUFFLE9BQXVCLGFBQWEsVUFBVTtBQUMvRCxhQUFLLFVBQVUsS0FBSztBQUFBLE1BQ3JCLENBQUM7QUFBQSxJQUNGLENBQUM7QUFBQSxFQUNGO0FBQ0Q7OztBb0J0NURBLElBQUFDLG9CQUF5QjtBQVNsQixJQUFNLG9CQUFOLE1BQXdCO0FBQUE7QUFBQSxFQU85QixZQUFZLFVBQXdCLGdCQUFpQztBQU5yRSxTQUFRLFlBQTJDLG9CQUFJLElBQUk7QUFHM0QsU0FBUSxvQkFBb0Ysb0JBQUksSUFBSTtBQUNwRyxTQUFpQixZQUFZO0FBRzVCLFNBQUssV0FBVztBQUNoQixTQUFLLGlCQUFpQjtBQUFBLEVBQ3ZCO0FBQUEsRUFFQSxNQUFNLGFBQWE7QUFDbEIsU0FBSyxVQUFVLElBQUksVUFBVSxJQUFJLGVBQWUsS0FBSyxTQUFTLFlBQVksTUFBTSxDQUFDO0FBQ2pGLFNBQUssVUFBVSxJQUFJLFVBQVUsSUFBSSxlQUFlLEtBQUssU0FBUyxZQUFZLE1BQU0sQ0FBQztBQUNqRixTQUFLLFVBQVUsSUFBSSxVQUFVLElBQUksZUFBZSxLQUFLLFNBQVMsWUFBWSxNQUFNLENBQUM7QUFDakYsU0FBSyxVQUFVLElBQUksVUFBVSxJQUFJLGVBQWUsS0FBSyxTQUFTLFlBQVksTUFBTSxDQUFDO0FBQUEsRUFDbEY7QUFBQSxFQUVBLGVBQWUsVUFBd0I7QUFDdEMsU0FBSyxXQUFXO0FBQ2hCLFNBQUssVUFBVSxRQUFRLENBQUMsVUFBVSxTQUFTO0FBOUI3QztBQStCRyxVQUFJLFNBQVMsVUFBVSxRQUFRLEtBQUssU0FBUyxhQUFhO0FBQ3pELHVCQUFTLGlCQUFULGtDQUF3QixLQUFLLFNBQVMsWUFBWSxJQUFnQztBQUFBLE1BQ25GO0FBQUEsSUFDRCxDQUFDO0FBRUQsU0FBSyxrQkFBa0IsTUFBTTtBQUFBLEVBQzlCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLDBCQUEwQixjQUE4QztBQUNyRixVQUFNLE1BQU0sS0FBSyxJQUFJO0FBQ3JCLFVBQU0sU0FBUyxLQUFLLGtCQUFrQixJQUFJLFlBQVk7QUFHdEQsUUFBSSxVQUFXLE1BQU0sT0FBTyxZQUFhLEtBQUssV0FBVztBQUN4RCxhQUFPLE9BQU87QUFBQSxJQUNmO0FBR0EsVUFBTSxXQUFXLEtBQUssVUFBVSxJQUFJLFlBQVk7QUFDaEQsVUFBTSxjQUFjLFdBQVcsTUFBTSxTQUFTLFlBQVksSUFBSTtBQUc5RCxTQUFLLGtCQUFrQixJQUFJLGNBQWM7QUFBQSxNQUN4QztBQUFBLE1BQ0EsV0FBVztBQUFBLElBQ1osQ0FBQztBQUVELFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxvQkFBb0IsV0FBd0M7QUFFbkUsUUFBSSxVQUFVLFdBQVcsU0FBUyxHQUFHO0FBQ3BDLGFBQU87QUFBQSxJQUNSO0FBR0EsUUFBSSxVQUFVLFdBQVcsTUFBTSxLQUFLLFVBQVUsV0FBVyxLQUFLLEdBQUc7QUFDaEUsYUFBTztBQUFBLElBQ1I7QUFHQSxRQUFJLFVBQVUsV0FBVyxTQUFTLEdBQUc7QUFDcEMsYUFBTztBQUFBLElBQ1I7QUFHQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsbUJBQTJCO0FBQ2xDLFVBQU0sV0FBVywyQkFBUyxXQUFXLFdBQVc7QUFDaEQsVUFBTSxnQkFBZ0IsS0FBSyxTQUFTLGlCQUFpQixRQUFRLEVBQUU7QUFFL0QsWUFBUSxJQUFJLGlEQUEwQztBQUN0RCxZQUFRLElBQUksdUJBQWdCLFFBQVE7QUFDcEMsWUFBUSxJQUFJLDZCQUFzQixhQUFhO0FBRS9DLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFHQSxNQUFjLHVCQUFtRDtBQUNoRSxVQUFNLGdCQUFnQixLQUFLLGlCQUFpQjtBQUM1QyxVQUFNLGVBQWUsS0FBSyxvQkFBb0IsYUFBYTtBQUUzRCxRQUFJLENBQUMsZ0JBQWdCLGlCQUFpQixRQUFRO0FBQzdDLGFBQU87QUFBQSxJQUNSO0FBRUEsVUFBTSxXQUFXLEtBQUssVUFBVSxJQUFJLFlBQVk7QUFDaEQsVUFBTSxjQUFjLFdBQVcsTUFBTSxLQUFLLDBCQUEwQixZQUFZLElBQUk7QUFFcEYsWUFBUSxJQUFJLGlDQUEwQixFQUFFLGVBQWUsY0FBYyxZQUFZLENBQUM7QUFFbEYsUUFBSSxZQUFZLGFBQWE7QUFDNUIsYUFBTztBQUFBLElBQ1I7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEsTUFBTSxhQUFhQyxTQUFnQixTQUFnRDtBQUNsRixVQUFNLFdBQVcsTUFBTSxLQUFLLHFCQUFxQjtBQUNqRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUFBLElBQ2xFO0FBRUEsV0FBTyxTQUFTLGFBQWFBLFNBQVEsT0FBTztBQUFBLEVBQzdDO0FBQUEsRUFFQSxPQUFPLG1CQUFtQkEsU0FBZ0IsU0FBaUU7QUFDMUcsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsUUFBSSxDQUFDLFVBQVU7QUFDZCxZQUFNLElBQUksTUFBTSxpREFBaUQ7QUFBQSxJQUNsRTtBQUVBLFdBQU8sU0FBUyxtQkFBbUJBLFNBQVEsT0FBTztBQUFBLEVBQ25EO0FBQUEsRUFFQSxNQUFNLGVBQWUsVUFBdUIsU0FBZ0Q7QUFDM0YsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsUUFBSSxDQUFDLFVBQVU7QUFDZCxZQUFNLElBQUksTUFBTSxpREFBaUQ7QUFBQSxJQUNsRTtBQUNBLFdBQU8sU0FBUyxlQUFlLFVBQVUsT0FBTztBQUFBLEVBQ2pEO0FBQUEsRUFFQSxPQUFPLHFCQUFxQixVQUF1QixTQUFpRTtBQUNuSCxVQUFNLFdBQVcsTUFBTSxLQUFLLHFCQUFxQjtBQUNqRCxRQUFJLENBQUMsVUFBVTtBQUNkLFlBQU0sSUFBSSxNQUFNLGlEQUFpRDtBQUFBLElBQ2xFO0FBQ0EsV0FBTyxTQUFTLHFCQUFxQixVQUFVLE9BQU87QUFBQSxFQUN2RDtBQUFBLEVBRUEsbUJBQTZCO0FBQzVCLFdBQU8sTUFBTSxLQUFLLEtBQUssVUFBVSxPQUFPLENBQUMsRUFBRSxJQUFJLE9BQUssRUFBRSxJQUFJO0FBQUEsRUFDM0Q7QUFBQSxFQUVBLE1BQU0seUJBQTBDO0FBQy9DLFVBQU0sV0FBVyxNQUFNLEtBQUsscUJBQXFCO0FBQ2pELFdBQU8sV0FBVyxTQUFTLE9BQU87QUFBQSxFQUNuQztBQUFBLEVBRUEsTUFBTSx5QkFBaUQ7QUFDdEQsVUFBTSxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDNUMsVUFBTSxlQUFlLEtBQUssb0JBQW9CLGFBQWE7QUFFM0QsUUFBSSxDQUFDLGdCQUFnQixpQkFBaUIsUUFBUTtBQUM3QyxhQUFPO0FBQUEsSUFDUjtBQUVBLFVBQU0sV0FBVyxLQUFLLFVBQVUsSUFBSSxZQUFZO0FBQ2hELFFBQUksWUFBWSxNQUFNLEtBQUssMEJBQTBCLFlBQVksR0FBRztBQUNuRSxhQUFPO0FBQUEsSUFDUjtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBMEI7QUFDekIsV0FBTyxLQUFLLGlCQUFpQjtBQUFBLEVBQzlCO0FBQUEsRUFFQSxNQUFNLFNBQVMsY0FBc0IsWUFBb0IsU0FBZ0Q7QUFDeEcsVUFBTSxXQUFXLE1BQU0sS0FBSyxxQkFBcUI7QUFDakQsUUFBSSxDQUFDLFVBQVU7QUFDZCxZQUFNLElBQUksTUFBTSxpREFBaUQ7QUFBQSxJQUNsRTtBQUNBLFdBQU8sU0FBUyxTQUFTLGNBQWMsWUFBWSxPQUFPO0FBQUEsRUFDM0Q7QUFBQSxFQUVBLHNCQUFzQztBQUVyQyxRQUFJLDJCQUFTLFVBQVU7QUFDdEIsYUFBTyxDQUFDLFVBQVUsVUFBVSxRQUFRO0FBQUEsSUFDckM7QUFDQSxXQUFPLENBQUMsVUFBVSxVQUFVLFVBQVUsUUFBUTtBQUFBLEVBQy9DO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtDQUF1RTtBQUM1RSxVQUFNLG1CQUFtQixLQUFLLG9CQUFvQjtBQUNsRCxVQUFNLHFCQUFxQixpQkFBaUIsSUFBSSxPQUFPLGlCQUFpQjtBQUN2RSxZQUFNLGNBQWMsTUFBTSxLQUFLLDBCQUEwQixZQUFZO0FBQ3JFLGFBQU8sRUFBRSxjQUFjLFlBQVk7QUFBQSxJQUNwQyxDQUFDO0FBRUQsVUFBTSxVQUFVLE1BQU0sUUFBUSxJQUFJLGtCQUFrQjtBQUNwRCxVQUFNLGtCQUFrQixvQkFBSSxJQUEyQjtBQUV2RCxZQUFRLFFBQVEsQ0FBQyxFQUFFLGNBQWMsWUFBWSxNQUFNO0FBQ2xELHNCQUFnQixJQUFJLGNBQWMsV0FBVztBQUFBLElBQzlDLENBQUM7QUFFRCxXQUFPO0FBQUEsRUFDUjtBQUFBLEVBRUEsa0JBQWtCLGNBQXFDO0FBRXRELFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxvQkFBc0Q7QUFFckQsV0FBTyxFQUFFLE9BQU8sVUFBVSxPQUFPLFNBQVM7QUFBQSxFQUMzQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxrQkFBa0IsY0FBK0M7QUFDdEUsVUFBTSxXQUFXLEtBQUssVUFBVSxJQUFJLFlBQVk7QUFDaEQsUUFBSSxDQUFDLFVBQVU7QUFDZCxZQUFNLElBQUksTUFBTSxZQUFZLFlBQVksWUFBWTtBQUFBLElBQ3JEO0FBR0EsUUFBSSx3QkFBd0IsWUFBWSxPQUFPLFNBQVMsdUJBQXVCLFlBQVk7QUFDMUYsYUFBTyxNQUFPLFNBQWlCLG1CQUFtQjtBQUFBLElBQ25EO0FBR0EsV0FBTyxDQUFDO0FBQUEsRUFDVDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esd0JBQXdCLGNBQWtDO0FBQ3pELFVBQU0sV0FBVyxLQUFLLFVBQVUsSUFBSSxZQUFZO0FBQ2hELFFBQUksQ0FBQyxVQUFVO0FBQ2Q7QUFBQSxJQUNEO0FBR0EsUUFBSSxxQkFBcUIsWUFBWSxPQUFPLFNBQVMsb0JBQW9CLFlBQVk7QUFDcEYsTUFBQyxTQUFpQixnQkFBZ0I7QUFBQSxJQUNuQztBQUFBLEVBQ0Q7QUFBQSxFQUVBLFVBQVU7QUFDVCxTQUFLLFVBQVUsTUFBTTtBQUFBLEVBQ3RCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxzQkFBOEI7QUFDN0IsV0FBTyxLQUFLLFNBQVMsUUFBUTtBQUFBLEVBQzlCO0FBQ0Q7OztBQ2hSQSxJQUFBQyxvQkFBeUU7OztBQ1FsRSxJQUFNLHNCQUFOLE1BQTBCO0FBQUEsRUFPN0IsWUFBb0IsV0FBc0I7QUFBdEI7QUFOcEIsU0FBUSxnQkFBK0Msb0JBQUksSUFBSTtBQUMvRCxTQUFRLHFCQUFxQjtBQUM3QjtBQUFBLFNBQVEsYUFBYTtBQUNyQixTQUFRLGtCQUFpQztBQUlyQyxTQUFLLG9CQUFvQixLQUFLLFdBQVc7QUFBQSxFQUM3QztBQUFBLEVBRUEsTUFBYyxhQUE0QjtBQUN0QyxVQUFNLEtBQUssa0JBQWtCO0FBQzdCLFNBQUsscUJBQXFCO0FBQUEsRUFDOUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsb0JBQW1DO0FBQzdDLFFBQUk7QUFDQSxZQUFNLE9BQU8sTUFBTSxLQUFLLFVBQVUsU0FBUyxLQUFLLFVBQVU7QUFFMUQsVUFBSSxRQUFRLE1BQU0sUUFBUSxJQUFJLEdBQUc7QUFDN0IsbUJBQVcsZ0JBQWdCLE1BQU07QUFDN0IsY0FBSTtBQUVBLGtCQUFNLHdCQUF3QixLQUFLLHlCQUF5QixZQUFZO0FBQ3hFLGlCQUFLLGNBQWMsSUFBSSxzQkFBc0IsVUFBVSxxQkFBcUI7QUFBQSxVQUNoRixTQUFTLE9BQU87QUFFWixvQkFBUSxLQUFLLDZDQUE0Qyw2Q0FBYyxhQUFZLFNBQVMsSUFBSSxLQUFLO0FBQUEsVUFDekc7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFBLElBQ0osU0FBUyxPQUFPO0FBRVosY0FBUSxNQUFNLDhEQUF5RCxLQUFLO0FBQUEsSUFDaEY7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx5QkFBeUIsY0FBcUM7QUFFbEUsUUFBSSxDQUFDLGFBQWEsWUFBWSxPQUFPLGFBQWEsYUFBYSxVQUFVO0FBQ3JFLFlBQU0sSUFBSSxNQUFNLDZCQUE2QjtBQUFBLElBQ2pEO0FBR0EsVUFBTSxXQUFXLE1BQU0sUUFBUSxhQUFhLFFBQVEsSUFBSSxhQUFhLFdBQVcsQ0FBQztBQUdqRixRQUFJLG1CQUF5QyxDQUFDO0FBQzlDLFFBQUksTUFBTSxRQUFRLGFBQWEsZ0JBQWdCLEdBQUc7QUFDOUMseUJBQW1CLGFBQWEsaUJBQzNCLE9BQU8sQ0FBQyxRQUFhLEtBQUssdUJBQXVCLEdBQUcsQ0FBQyxFQUNyRCxJQUFJLENBQUMsUUFBYSxLQUFLLHdCQUF3QixHQUFHLENBQUM7QUFBQSxJQUM1RDtBQUdBLFdBQU87QUFBQSxNQUNILFVBQVUsYUFBYTtBQUFBLE1BQ3ZCO0FBQUEsTUFDQSxhQUFhLE9BQU8sYUFBYSxnQkFBZ0IsV0FBVyxhQUFhLGNBQWMsS0FBSyxJQUFJO0FBQUEsTUFDaEc7QUFBQSxNQUNBLFVBQVUsYUFBYSxZQUFZO0FBQUEsUUFDL0IsV0FBVztBQUFBLFFBQ1gsa0JBQWtCO0FBQUEsVUFDZCxLQUFLO0FBQUEsVUFDTCxNQUFNO0FBQUEsVUFDTixRQUFRO0FBQUEsVUFDUixTQUFTO0FBQUEsVUFDVCxTQUFTO0FBQUEsVUFDVCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQXVCLEtBQW1CO0FBQzlDLFdBQU8sT0FDQSxPQUFPLElBQUksU0FBUyxZQUNwQixJQUFJLEtBQUssS0FBSyxFQUFFLFNBQVM7QUFBQSxFQUNwQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esd0JBQXdCLEtBQThCO0FBQzFELFdBQU87QUFBQSxNQUNILE1BQU0sSUFBSTtBQUFBLE1BQ1YsVUFBVSxPQUFPLElBQUksYUFBYSxXQUFXLElBQUksV0FBVztBQUFBLE1BQzVELFNBQVMsT0FBTyxJQUFJLFlBQVksV0FBVyxJQUFJLFVBQVUsS0FBSyxJQUFJO0FBQUEsSUFDdEU7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLG9CQUFtQztBQUM3QyxRQUFJO0FBQ0EsWUFBTSxxQkFBcUIsTUFBTSxLQUFLLEtBQUssY0FBYyxPQUFPLENBQUM7QUFDakUsWUFBTSxLQUFLLFVBQVUsU0FBUyxLQUFLLFlBQVksa0JBQWtCO0FBQUEsSUFDckUsU0FBUyxPQUFPO0FBQ1osY0FBUSxNQUFNLDhEQUF5RCxLQUFLO0FBQUEsSUFDaEY7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsTUFBK0I7QUFFM0MsVUFBTSxXQUFXLEtBQUs7QUFFdEIsUUFBSSxDQUFDLEtBQUssY0FBYyxJQUFJLFFBQVEsR0FBRztBQUVuQyxZQUFNLGtCQUFvQztBQUFBLFFBQ3RDO0FBQUEsUUFDQSxVQUFVLENBQUM7QUFBQSxRQUNYLGFBQWEsS0FBSyxJQUFJO0FBQUEsUUFDdEIsa0JBQWtCLENBQUM7QUFBQSxRQUNuQixVQUFVO0FBQUEsVUFDTixXQUFXO0FBQUEsVUFDWCxrQkFBa0I7QUFBQSxZQUNkLEtBQUs7QUFBQSxZQUNMLE1BQU07QUFBQSxZQUNOLFFBQVE7QUFBQSxZQUNSLFNBQVM7QUFBQSxZQUNULFNBQVM7QUFBQSxZQUNULFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFDQSxXQUFLLGNBQWMsSUFBSSxVQUFVLGVBQWU7QUFBQSxJQUNwRDtBQUdBLFVBQU0sZUFBZSxLQUFLLGNBQWMsSUFBSSxRQUFRO0FBQ3BELFFBQUksQ0FBQyxhQUFhLGtCQUFrQjtBQUNoQyxtQkFBYSxtQkFBbUIsQ0FBQztBQUFBLElBQ3JDO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sZUFDRixNQUNBLFNBQ0EsU0FDNEI7QUFFNUIsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxNQUNwQjtBQUFBLElBQ0o7QUFFQSxpQkFBYSxTQUFTLEtBQUssT0FBTztBQUNsQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUdwQyxRQUFJLFdBQVcsYUFBYSxVQUFVO0FBQ2xDLG1CQUFhLFNBQVMsaUJBQWlCLFFBQVEsTUFBTTtBQUFBLElBQ3pEO0FBRUEsVUFBTSxLQUFLLFlBQVksWUFBWTtBQUNuQyxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxvQkFDRixNQUNBLFNBQ0EsUUFDNEI7QUFDNUIsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsVUFBTSxVQUErQjtBQUFBLE1BQ2pDLElBQUksS0FBSyxrQkFBa0I7QUFBQSxNQUMzQixNQUFNO0FBQUEsTUFDTjtBQUFBLE1BQ0EsV0FBVyxLQUFLLElBQUk7QUFBQSxNQUNwQjtBQUFBLElBQ0o7QUFFQSxpQkFBYSxTQUFTLEtBQUssT0FBTztBQUNsQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUdwQyxTQUFJLGlDQUFRLFlBQVcsYUFBYSxVQUFVO0FBQzFDLG1CQUFhLFNBQVM7QUFBQSxJQUMxQjtBQUVBLFVBQU0sS0FBSyxZQUFZLFlBQVk7QUFDbkMsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0saUJBQ0YsTUFDQSxTQUNBLFVBQzRCO0FBRTVCLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBRTlDLFVBQU0sVUFBK0I7QUFBQSxNQUNqQyxJQUFJLEtBQUssa0JBQWtCO0FBQUEsTUFDM0IsTUFBTTtBQUFBLE1BQ047QUFBQSxNQUNBLFdBQVcsS0FBSyxJQUFJO0FBQUEsTUFDcEI7QUFBQSxJQUNKO0FBRUEsaUJBQWEsU0FBUyxLQUFLLE9BQU87QUFDbEMsaUJBQWEsY0FBYyxLQUFLLElBQUk7QUFFcEMsVUFBTSxLQUFLLFlBQVksWUFBWTtBQUNuQyxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWtCLE1BQWEsUUFBZ0IsSUFBMkI7QUFDdEUsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFDOUMsV0FBTyxhQUFhLFNBQVMsTUFBTSxDQUFDLEtBQUs7QUFBQSxFQUM3QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWtCLE1BQWEsTUFBMEQ7QUFDckYsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFDOUMsV0FBTyxhQUFhLFNBQVMsT0FBTyxTQUFPLElBQUksU0FBUyxJQUFJO0FBQUEsRUFDaEU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHVCQUF1QixNQUFhLGNBQXNCLEdBQVc7QUFDakUsVUFBTSxXQUFXLEtBQUssa0JBQWtCLE1BQU0sV0FBVztBQUV6RCxRQUFJLFNBQVMsV0FBVyxHQUFHO0FBQ3ZCLGFBQU87QUFBQSxJQUNYO0FBRUEsVUFBTSxlQUFlLFNBQVMsSUFBSSxTQUFPO0FBQ3JDLFlBQU0sWUFBWSxJQUFJLEtBQUssSUFBSSxTQUFTLEVBQUUsbUJBQW1CO0FBQzdELFVBQUksT0FBTyxJQUFJLFNBQVMsS0FBSyxJQUFJLEtBQUssWUFBWSxDQUFDLEtBQUssSUFBSSxPQUFPO0FBRW5FLFVBQUksSUFBSSxTQUFTO0FBQ2IsZ0JBQVEsY0FBYyxJQUFJLFFBQVEsTUFBTSxJQUFJLElBQUksUUFBUSxNQUFNO0FBQUEsTUFDbEU7QUFFQSxVQUFJLElBQUksUUFBUTtBQUNaLGdCQUFRLGFBQWEsSUFBSSxPQUFPLFVBQVUsWUFBWSxRQUFRO0FBQUEsTUFDbEU7QUFFQSxhQUFPO0FBQUEsSUFDWCxDQUFDO0FBRUQsV0FBTztBQUFBLEVBQTJCLGFBQWEsS0FBSyxJQUFJLENBQUM7QUFBQTtBQUFBLEVBQzdEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUFrQixNQUE0QjtBQUNoRCxVQUFNLGVBQWUsS0FBSyxnQkFBZ0IsSUFBSTtBQUM5QyxpQkFBYSxXQUFXLENBQUM7QUFFekIsaUJBQWEsY0FBYyxLQUFLLElBQUk7QUFFcEMsUUFBSSxhQUFhLFVBQVU7QUFDdkIsbUJBQWEsU0FBUyxZQUFZO0FBQ2xDLG1CQUFhLFNBQVMsbUJBQW1CO0FBQUEsUUFDckMsS0FBSztBQUFBLFFBQ0wsTUFBTTtBQUFBLFFBQ04sUUFBUTtBQUFBLFFBQ1IsU0FBUztBQUFBLFFBQ1QsU0FBUztBQUFBLFFBQ1QsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBRUEsVUFBTSxLQUFLLGtCQUFrQjtBQUFBLEVBQ2pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxTQUFTLE1BS1A7QUF2VU47QUF3VVEsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFFOUMsUUFBSSxrQkFBcUM7QUFDekMsUUFBSSxXQUFXO0FBRWYsUUFBSSxhQUFhLFVBQVU7QUFDdkIsaUJBQVcsQ0FBQyxRQUFRLEtBQUssS0FBSyxPQUFPLFFBQVEsYUFBYSxTQUFTLGdCQUFnQixHQUFHO0FBQ2xGLFlBQUksUUFBUSxVQUFVO0FBQ2xCLHFCQUFXO0FBQ1gsNEJBQWtCO0FBQUEsUUFDdEI7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFVBQU0sa0JBQWtCLGFBQWEsU0FBUyxTQUFTLElBQ2pELEtBQUssSUFBSSxJQUFJLGFBQWEsU0FBUyxDQUFDLEVBQUUsWUFDdEM7QUFFTixXQUFPO0FBQUEsTUFDSCxjQUFjLGFBQWEsU0FBUztBQUFBLE1BQ3BDLGFBQVcsa0JBQWEsYUFBYixtQkFBdUIsY0FBYTtBQUFBLE1BQy9DO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxtQkFBbUIsTUFBcUI7QUFDcEMsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFDOUMsVUFBTSxRQUFRLENBQUMsOEJBQThCLEtBQUssSUFBSSxJQUFJLEVBQUU7QUFFNUQsZUFBVyxXQUFXLGFBQWEsVUFBVTtBQUN6QyxZQUFNLFlBQVksSUFBSSxLQUFLLFFBQVEsU0FBUyxFQUFFLGVBQWU7QUFDN0QsWUFBTSxLQUFLLE1BQU0sUUFBUSxLQUFLLFlBQVksQ0FBQyxLQUFLLFNBQVMsR0FBRztBQUM1RCxZQUFNLEtBQUssUUFBUSxPQUFPO0FBRTFCLFVBQUksUUFBUSxTQUFTO0FBQ2pCLGNBQU0sS0FBSyxhQUFhLFFBQVEsUUFBUSxNQUFNLElBQUksUUFBUSxRQUFRLE1BQU0sR0FBRztBQUFBLE1BQy9FO0FBRUEsVUFBSSxRQUFRLFFBQVE7QUFDaEIsY0FBTSxLQUFLLFlBQVksUUFBUSxPQUFPLFVBQVUsWUFBWSxRQUFRLEdBQUc7QUFDdkUsWUFBSSxRQUFRLE9BQU8sT0FBTztBQUN0QixnQkFBTSxLQUFLLFdBQVcsUUFBUSxPQUFPLEtBQUssR0FBRztBQUFBLFFBQ2pEO0FBQUEsTUFDSjtBQUVBLFlBQU0sS0FBSyxFQUFFO0FBQUEsSUFDakI7QUFFQSxXQUFPLE1BQU0sS0FBSyxJQUFJO0FBQUEsRUFDMUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG9CQUE0QjtBQUNoQyxXQUFPLE9BQU8sS0FBSyxJQUFJLENBQUMsSUFBSSxLQUFLLE9BQU8sRUFBRSxTQUFTLEVBQUUsRUFBRSxPQUFPLEdBQUcsQ0FBQyxDQUFDO0FBQUEsRUFDdkU7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsWUFBWSxjQUErQztBQUNyRSxRQUFJLGFBQWEsU0FBUyxTQUFTLEtBQUssb0JBQW9CO0FBRXhELG1CQUFhLFdBQVcsYUFBYSxTQUFTLE1BQU0sQ0FBQyxLQUFLLGtCQUFrQjtBQUFBLElBQ2hGO0FBRUEsVUFBTSxLQUFLLGtCQUFrQjtBQUFBLEVBQ2pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSwwQkFBb0M7QUFDaEMsV0FBTyxNQUFNLEtBQUssS0FBSyxjQUFjLEtBQUssQ0FBQztBQUFBLEVBQy9DO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsTUFBc0I7QUFDbEMsVUFBTSxlQUFlLEtBQUssY0FBYyxJQUFJLEtBQUssSUFBSTtBQUNyRCxXQUFPLGVBQWUsYUFBYSxTQUFTLFNBQVMsSUFBSTtBQUFBLEVBQzdEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGVBQWUsU0FBaUIsU0FBZ0M7QUFDbEUsVUFBTSxlQUFlLEtBQUssY0FBYyxJQUFJLE9BQU87QUFDbkQsUUFBSSxjQUFjO0FBQ2QsbUJBQWEsV0FBVztBQUN4QixXQUFLLGNBQWMsT0FBTyxPQUFPO0FBQ2pDLFdBQUssY0FBYyxJQUFJLFNBQVMsWUFBWTtBQUM1QyxZQUFNLEtBQUssa0JBQWtCO0FBQUEsSUFDakM7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSx1QkFBNkI7QUFFakMsU0FBSyxrQkFBa0IsT0FBTyxZQUFZLE1BQU07QUFDNUMsV0FBSyx3QkFBd0IsSUFBSSxLQUFLLEtBQUssS0FBSyxHQUFJO0FBQUEsSUFDeEQsR0FBRyxLQUFLLEtBQUssS0FBSyxHQUFJO0FBQUEsRUFDMUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsd0JBQXdCLFFBQStCO0FBQ2pFLFVBQU0sTUFBTSxLQUFLLElBQUk7QUFDckIsUUFBSSxVQUFVO0FBRWQsZUFBVyxDQUFDLFVBQVUsWUFBWSxLQUFLLEtBQUssY0FBYyxRQUFRLEdBQUc7QUFFakUsVUFBSSxhQUFhLFNBQVMsU0FBUyxHQUFHO0FBQ2xDLGNBQU0sY0FBYyxhQUFhLFNBQVMsYUFBYSxTQUFTLFNBQVMsQ0FBQztBQUMxRSxjQUFNLE1BQU0sTUFBTSxZQUFZO0FBRTlCLFlBQUksTUFBTSxRQUFRO0FBQ2QsZUFBSyxjQUFjLE9BQU8sUUFBUTtBQUNsQyxvQkFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFFBQUksU0FBUztBQUNULFlBQU0sS0FBSyxrQkFBa0I7QUFBQSxJQUNqQztBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sbUJBQW1CLE1BQWEsYUFBcUIsVUFBa0M7QUFyZGpHO0FBc2RRLFVBQU0sS0FBSztBQUVYLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBRzlDLFVBQU0sVUFBUyxrQkFBYSxxQkFBYixtQkFBK0I7QUFBQSxNQUFLLFNBQy9DLElBQUksU0FBUyxlQUFlLElBQUksYUFBYTtBQUFBO0FBR2pELFFBQUksQ0FBQyxRQUFRO0FBQ1QsWUFBTSxhQUFpQztBQUFBLFFBQ25DLE1BQU07QUFBQSxRQUNOO0FBQUEsUUFDQSxTQUFTLEtBQUssSUFBSTtBQUFBLE1BQ3RCO0FBRUEseUJBQWEscUJBQWIsbUJBQStCLEtBQUs7QUFDcEMsbUJBQWEsY0FBYyxLQUFLLElBQUk7QUFFcEMsWUFBTSxLQUFLLGtCQUFrQjtBQUFBLElBQ2pDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxzQkFBc0IsTUFBYSxhQUFxQixVQUFrQztBQUM1RixVQUFNLGVBQWUsS0FBSyxnQkFBZ0IsSUFBSTtBQUU5QyxRQUFJLGFBQWEsa0JBQWtCO0FBQy9CLG1CQUFhLG1CQUFtQixhQUFhLGlCQUFpQjtBQUFBLFFBQU8sU0FDakUsRUFBRSxJQUFJLFNBQVMsZUFBZSxJQUFJLGFBQWE7QUFBQSxNQUNuRDtBQUNBLG1CQUFhLGNBQWMsS0FBSyxJQUFJO0FBQ3BDLFlBQU0sS0FBSyxrQkFBa0I7QUFBQSxJQUNqQztBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sb0JBQW9CLE1BQTRDO0FBQ2xFLFVBQU0sS0FBSztBQUNYLFVBQU0sZUFBZSxLQUFLLGdCQUFnQixJQUFJO0FBQzlDLFdBQU8sYUFBYSxvQkFBb0IsQ0FBQztBQUFBLEVBQzdDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHNCQUFzQixNQUE0QjtBQUNwRCxVQUFNLGVBQWUsS0FBSyxnQkFBZ0IsSUFBSTtBQUM5QyxpQkFBYSxtQkFBbUIsQ0FBQztBQUNqQyxpQkFBYSxjQUFjLEtBQUssSUFBSTtBQUNwQyxVQUFNLEtBQUssa0JBQWtCO0FBQUEsRUFDakM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sb0JBQW9CLE1BQWEsV0FBZ0Q7QUFDbkYsVUFBTSxlQUFlLEtBQUssZ0JBQWdCLElBQUk7QUFDOUMsaUJBQWEsbUJBQW1CO0FBQ2hDLGlCQUFhLGNBQWMsS0FBSyxJQUFJO0FBQ3BDLFVBQU0sS0FBSyxrQkFBa0I7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsVUFBZ0I7QUFDWixRQUFJLEtBQUssb0JBQW9CLE1BQU07QUFDL0Isb0JBQWMsS0FBSyxlQUFlO0FBQ2xDLFdBQUssa0JBQWtCO0FBQUEsSUFDM0I7QUFBQSxFQUNKO0FBQ0o7OztBRHpoQk8sSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBR3hCLFlBQW9CLEtBQVUsV0FBdUI7QUFBakM7QUFGcEIsU0FBUSxzQkFBa0Q7QUFHdEQsUUFBSSxXQUFXO0FBQ1gsV0FBSyxzQkFBc0IsSUFBSSxvQkFBb0IsU0FBUztBQUFBLElBQ2hFO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBQXVCLHFCQUFnRDtBQUNuRSxTQUFLLHNCQUFzQjtBQUFBLEVBQy9CO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBaUM7QUFFN0IsVUFBTSxhQUFhLEtBQUssY0FBYztBQUN0QyxRQUFJLENBQUMsWUFBWTtBQUNiLGFBQU87QUFBQSxJQUNYO0FBR0EsVUFBTSxTQUFTLEtBQUssSUFBSSxVQUFVLGdCQUFnQixVQUFVO0FBQzVELGVBQVcsUUFBUSxRQUFRO0FBQ3ZCLFlBQU1DLFFBQU8sS0FBSztBQUNsQixVQUFJQSxpQkFBZ0Isa0NBQWdCQSxNQUFLLFNBQVMsWUFBWTtBQUMxRCxlQUFPQSxNQUFLO0FBQUEsTUFDaEI7QUFBQSxJQUNKO0FBR0EsVUFBTSxlQUFlLEtBQUssSUFBSSxVQUFVO0FBQ3hDLFNBQUksNkNBQWMsV0FBVSxhQUFhLFNBQVMsWUFBWTtBQUMxRCxhQUFPLGFBQWE7QUFBQSxJQUN4QjtBQUdBLFVBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxvQkFBb0IsOEJBQVk7QUFDaEUsUUFBSSxRQUFRLEtBQUssU0FBUyxZQUFZO0FBQ2xDLGFBQU8sS0FBSztBQUFBLElBQ2hCO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGdCQUE4QjtBQUMxQixXQUFPLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFBQSxFQUM1QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQTBCO0FBQ3RCLFVBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUNwQyxRQUFJLENBQUMsT0FBUSxRQUFPO0FBRXBCLFdBQU8sT0FBTyxhQUFhO0FBQUEsRUFDL0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG9CQUEyQztBQUN2QyxVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsUUFBSSxDQUFDLE9BQVEsUUFBTztBQUVwQixXQUFPLE9BQU8sVUFBVTtBQUFBLEVBQzVCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxrQkFBa0IsVUFBMEIsY0FBdUIsT0FBYTtBQUM1RSxVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsUUFBSSxDQUFDLE9BQVE7QUFFYixXQUFPLFVBQVUsUUFBUTtBQUN6QixRQUFJLGFBQWE7QUFDYixhQUFPLE1BQU07QUFBQSxJQUNqQjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0scUJBQXNEO0FBQ3hELFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsVUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBRXBDLFFBQUksQ0FBQyxRQUFRLENBQUMsUUFBUTtBQUNsQixhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sVUFBVSxPQUFPLFNBQVM7QUFDaEMsVUFBTSxlQUFlLEtBQUssZ0JBQWdCO0FBQzFDLFVBQU0saUJBQWlCLEtBQUssa0JBQWtCO0FBRzlDLFVBQU0sV0FBVyxLQUFLLGdCQUFnQixPQUFPO0FBRzdDLFVBQU0sbUJBQW1CLGlCQUNyQixLQUFLLG9CQUFvQixTQUFTLGVBQWUsSUFBSSxJQUNyRDtBQUVKLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQSxVQUFVLEtBQUs7QUFBQSxNQUNmO0FBQUEsTUFDQTtBQUFBLE1BQ0EsY0FBYyxnQkFBZ0I7QUFBQSxNQUM5QixnQkFBZ0Isa0JBQWtCO0FBQUEsTUFDbEM7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQWdCLFNBQWdDO0FBQ3BELFVBQU0sUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUNoQyxVQUFNLFdBQTBCLENBQUM7QUFDakMsUUFBSSxZQUFZO0FBRWhCLFVBQU0sUUFBUSxDQUFDLE1BQU0sVUFBVTtBQUMzQixZQUFNLGVBQWUsS0FBSyxNQUFNLG1CQUFtQjtBQUNuRCxVQUFJLGNBQWM7QUFDZCxjQUFNLFFBQVEsYUFBYSxDQUFDLEVBQUU7QUFDOUIsY0FBTSxPQUFPLGFBQWEsQ0FBQztBQUUzQixpQkFBUyxLQUFLO0FBQUEsVUFDVjtBQUFBLFVBQ0E7QUFBQSxVQUNBLE1BQU07QUFBQSxVQUNOLFVBQVU7QUFBQSxZQUNOLE9BQU87QUFBQSxZQUNQLEtBQUssWUFBWSxLQUFLO0FBQUEsVUFDMUI7QUFBQSxRQUNKLENBQUM7QUFBQSxNQUNMO0FBR0EsbUJBQWEsS0FBSyxTQUFTO0FBQUEsSUFDL0IsQ0FBQztBQUVELFdBQU87QUFBQSxFQUNYO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxvQkFDSixTQUNBLGFBQ0EsY0FBc0IsR0FDZTtBQUNyQyxVQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFFaEMsVUFBTSxZQUFZLEtBQUssSUFBSSxHQUFHLGNBQWMsV0FBVztBQUN2RCxVQUFNLFVBQVUsS0FBSyxJQUFJLE1BQU0sU0FBUyxHQUFHLGNBQWMsV0FBVztBQUVwRSxXQUFPO0FBQUEsTUFDSCxRQUFRLE1BQU0sTUFBTSxXQUFXLFdBQVc7QUFBQSxNQUMxQyxPQUFPLE1BQU0sTUFBTSxjQUFjLEdBQUcsVUFBVSxDQUFDO0FBQUEsSUFDbkQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLFVBQ0YsU0FDQSxVQUNBLFVBQXVCLENBQUMsR0FDTDtBQUNuQixVQUFNLFNBQVMsS0FBSyxnQkFBZ0I7QUFDcEMsVUFBTSxPQUFPLEtBQUssY0FBYztBQUVoQyxRQUFJLENBQUMsVUFBVSxDQUFDLE1BQU07QUFDbEIsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTztBQUFBLFFBQ1AsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBRUEsUUFBSTtBQUNBLFVBQUk7QUFFSixVQUFJLGFBQWEsVUFBVTtBQUV2QixvQkFBWSxPQUFPLFVBQVU7QUFDN0IsZUFBTyxhQUFhLFNBQVMsU0FBUztBQUFBLE1BQzFDLFdBQVcsYUFBYSxhQUFhO0FBRWpDLGNBQU0sWUFBWSxPQUFPLGFBQWE7QUFDdEMsWUFBSSxDQUFDLFdBQVc7QUFDWixpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQ0Esb0JBQVksT0FBTyxVQUFVLE1BQU07QUFDbkMsZUFBTyxpQkFBaUIsT0FBTztBQUFBLE1BQ25DLFdBQVcsYUFBYSxPQUFPO0FBRTNCLGNBQU0sV0FBVyxPQUFPLFNBQVM7QUFDakMsY0FBTSxpQkFBaUIsT0FBTyxRQUFRLFFBQVEsRUFBRTtBQUNoRCxvQkFBWSxFQUFFLE1BQU0sVUFBVSxJQUFJLGVBQWU7QUFFakQsY0FBTSxpQkFBaUIsT0FBTyxTQUFTO0FBQ3ZDLGNBQU0sYUFBYSxrQkFBa0IsZUFBZSxTQUFTLElBQUksSUFBSSxLQUFLLFFBQVE7QUFHbEYsY0FBTSxLQUFLLElBQUksTUFBTSxPQUFPLE1BQU0sVUFBVTtBQUFBLE1BQ2hELE9BQU87QUFFSCxvQkFBWTtBQUNaLGVBQU8sYUFBYSxTQUFTLFNBQVM7QUFBQSxNQUMxQztBQUdBLFVBQUksUUFBUSxlQUFlO0FBQ3ZCLGNBQU0sU0FBUztBQUFBLFVBQ1gsTUFBTSxVQUFVLE9BQU8sUUFBUSxNQUFNLElBQUksRUFBRSxTQUFTO0FBQUEsVUFDcEQsSUFBSSxRQUFRLFNBQVMsSUFBSSxJQUNyQixRQUFRLE1BQU0sSUFBSSxFQUFFLElBQUksRUFBRyxTQUMzQixVQUFVLEtBQUssUUFBUTtBQUFBLFFBQy9CO0FBQ0EsZUFBTyxhQUFhLFdBQVcsTUFBTTtBQUFBLE1BQ3pDO0FBRUEsVUFBSSxRQUFRLGNBQWM7QUFDdEIsZUFBTyxlQUFlO0FBQUEsVUFDbEIsTUFBTTtBQUFBLFVBQ04sSUFBSTtBQUFBLFFBQ1IsR0FBRyxJQUFJO0FBQUEsTUFDWDtBQUVBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNUO0FBQUEsUUFDQSxVQUFVLGFBQWEsY0FBYyxZQUM1QixhQUFhLFFBQVEsV0FBVztBQUFBLFFBQ3pDO0FBQUEsTUFDSjtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGNBQ0YsUUFDbUI7QUFDbkIsVUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBQ3BDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFFaEMsUUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNO0FBQ2xCLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU87QUFBQSxRQUNQLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUVBLFFBQUk7QUFDQSxVQUFJLFdBQVcsYUFBYTtBQUN4QixjQUFNLFlBQVksT0FBTyxhQUFhO0FBQ3RDLFlBQUksQ0FBQyxXQUFXO0FBQ1osaUJBQU87QUFBQSxZQUNILFNBQVM7QUFBQSxZQUNULE9BQU87QUFBQSxZQUNQLFVBQVU7QUFBQSxVQUNkO0FBQUEsUUFDSjtBQUNBLGVBQU8saUJBQWlCLEVBQUU7QUFDMUIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKLFdBQVcsV0FBVyxRQUFRO0FBQzFCLGNBQU0sU0FBUyxPQUFPLFVBQVU7QUFDaEMsY0FBTSxPQUFPLE9BQU87QUFDcEIsZUFBTztBQUFBLFVBQWE7QUFBQSxVQUNoQixFQUFFLE1BQU0sSUFBSSxFQUFFO0FBQUEsVUFDZCxFQUFFLE1BQU0sT0FBTyxHQUFHLElBQUksRUFBRTtBQUFBLFFBQzVCO0FBQ0EsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsVUFBVTtBQUFBLFVBQ1YsV0FBVyxFQUFFLE1BQU0sSUFBSSxFQUFFO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBRUEsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTztBQUFBLFFBQ1AsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDaEQsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsTUFBTSxxQkFBNkM7QUFDL0MsVUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBQ3BDLFFBQUksQ0FBQyxPQUFRLFFBQU87QUFFcEIsV0FBTyxPQUFPLFNBQVM7QUFBQSxFQUMzQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxtQkFBbUIsU0FBc0M7QUFDM0QsVUFBTSxPQUFPLEtBQUssY0FBYztBQUVoQyxRQUFJLENBQUMsTUFBTTtBQUNQLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU87QUFBQSxRQUNQLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUVBLFFBQUk7QUFDQSxZQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sTUFBTSxPQUFPO0FBRXpDLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNUO0FBQUEsUUFDQSxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0osU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9BLE1BQU0sZUFBZSxTQUFpQixTQUFzQztBQUN4RSxRQUFJLENBQUMsS0FBSyxvQkFBcUI7QUFFL0IsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLE1BQU07QUFDTixZQUFNLEtBQUssb0JBQW9CLGVBQWUsTUFBTSxTQUFTLE9BQU87QUFBQSxJQUN4RTtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sb0JBQW9CLFNBQWlCLFFBQW9DO0FBQzNFLFFBQUksQ0FBQyxLQUFLLG9CQUFxQjtBQUUvQixVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksTUFBTTtBQUNOLFlBQU0sS0FBSyxvQkFBb0Isb0JBQW9CLE1BQU0sU0FBUyxNQUFNO0FBQUEsSUFDNUU7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGlCQUFpQixTQUFnQztBQUNuRCxRQUFJLENBQUMsS0FBSyxvQkFBcUI7QUFFL0IsVUFBTSxPQUFPLEtBQUssY0FBYztBQUNoQyxRQUFJLE1BQU07QUFDTixZQUFNLEtBQUssb0JBQW9CLGlCQUFpQixNQUFNLE9BQU87QUFBQSxJQUNqRTtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHVCQUF1QixjQUFzQixHQUFXO0FBQ3BELFFBQUksQ0FBQyxLQUFLLG9CQUFxQixRQUFPO0FBRXRDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxDQUFDLEtBQU0sUUFBTztBQUVsQixXQUFPLEtBQUssb0JBQW9CLHVCQUF1QixNQUFNLFdBQVc7QUFBQSxFQUM1RTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxvQkFBbUM7QUFDckMsUUFBSSxDQUFDLEtBQUssb0JBQXFCO0FBRS9CLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxNQUFNO0FBQ04sWUFBTSxLQUFLLG9CQUFvQixrQkFBa0IsSUFBSTtBQUFBLElBQ3pEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsdUJBS1M7QUFDTCxRQUFJLENBQUMsS0FBSyxvQkFBcUIsUUFBTztBQUV0QyxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksQ0FBQyxLQUFNLFFBQU87QUFFbEIsV0FBTyxLQUFLLG9CQUFvQixTQUFTLElBQUk7QUFBQSxFQUNqRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQTJCO0FBQ3ZCLFFBQUksQ0FBQyxLQUFLLG9CQUFxQixRQUFPO0FBRXRDLFVBQU0sT0FBTyxLQUFLLGNBQWM7QUFDaEMsUUFBSSxDQUFDLEtBQU0sUUFBTztBQUVsQixXQUFPLEtBQUssb0JBQW9CLGdCQUFnQixJQUFJO0FBQUEsRUFDeEQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHFCQUFvQztBQUNoQyxRQUFJLENBQUMsS0FBSyxvQkFBcUIsUUFBTztBQUV0QyxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBQ2hDLFFBQUksQ0FBQyxLQUFNLFFBQU87QUFFbEIsV0FBTyxLQUFLLG9CQUFvQixtQkFBbUIsSUFBSTtBQUFBLEVBQzNEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQU0saUJBQ0YsU0FDQSxNQUNBLElBQ21CO0FBQ25CLFVBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUNwQyxVQUFNLE9BQU8sS0FBSyxjQUFjO0FBRWhDLFFBQUksQ0FBQyxVQUFVLENBQUMsTUFBTTtBQUNsQixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPO0FBQUEsUUFDUCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFFQSxRQUFJO0FBRUEsWUFBTSxVQUFVLFFBQVEsT0FBTyxVQUFVLE1BQU07QUFDL0MsWUFBTSxRQUFRLE1BQU0sT0FBTyxVQUFVLElBQUk7QUFHekMsYUFBTyxhQUFhLFNBQVMsU0FBUyxLQUFLO0FBRzNDLFlBQU0sZUFBZTtBQUFBLFFBQ2pCLE1BQU0sUUFBUSxRQUFRLFFBQVEsTUFBTSxJQUFJLEVBQUUsU0FBUztBQUFBLFFBQ25ELElBQUksUUFBUSxTQUFTLElBQUksSUFDckIsUUFBUSxNQUFNLElBQUksRUFBRSxJQUFJLEVBQUcsU0FDM0IsUUFBUSxLQUFLLFFBQVE7QUFBQSxNQUM3QjtBQUVBLGFBQU8sVUFBVSxZQUFZO0FBQzdCLGFBQU8sTUFBTTtBQUViLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFdBQVc7QUFBQSxRQUNYLFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixjQUFRLE1BQU0sOEJBQThCLEtBQUs7QUFDakQsYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBRUo7OztBRXhmTyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFHeEIsWUFBWSxVQUF5QjtBQWxDekM7QUFtQ1EsU0FBSyxnQkFBZ0I7QUFBQSxNQUNqQixpQkFBaUI7QUFBQSxNQUNqQixrQkFBa0I7QUFBQSxNQUNsQixnQkFBZ0I7QUFBQSxNQUNoQixjQUFhLGdEQUFVLFlBQVYsbUJBQW1CLHVCQUFuQixZQUF5QztBQUFBLE1BQ3RELFlBQVcsZ0RBQVUsWUFBVixtQkFBbUIscUJBQW5CLFlBQXVDO0FBQUEsSUFDdEQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxZQUNJLFNBQ0EsaUJBQ0EsVUFBaUMsQ0FBQyxHQUNsQyxxQkFDZTtBQUNmLFVBQU0sU0FBUyxFQUFFLEdBQUcsS0FBSyxlQUFlLEdBQUcsUUFBUTtBQUVuRCxVQUFNLGVBQWUsS0FBSyxrQkFBa0IsUUFBUSxRQUFRLE1BQU07QUFDbEUsVUFBTSxjQUFjLEtBQUssaUJBQWlCLGlCQUFpQixTQUFTLFFBQVEsbUJBQW1CO0FBQy9GLFVBQU0sYUFBYSxLQUFLLGdCQUFnQixTQUFTLFdBQVc7QUFFNUQsV0FBTztBQUFBLE1BQ0g7QUFBQSxNQUNBO0FBQUEsTUFDQSxTQUFTO0FBQUEsTUFDVCxRQUFRO0FBQUEsUUFDSixhQUFhLE9BQU8sZUFBZTtBQUFBLFFBQ25DLFdBQVcsT0FBTyxhQUFhO0FBQUEsTUFDbkM7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esa0JBQWtCLFFBQStCLFFBQThCO0FBQ25GLFVBQU0sYUFBYTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFVbkIsVUFBTSx3QkFBd0I7QUFBQSxNQUMxQixPQUFPO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFRUCxRQUFRO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BT1IsVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQU9WLFdBQVc7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFPWCxXQUFXO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BT1gsWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQVNoQjtBQUVBLFdBQU8sY0FBYyxzQkFBc0IsTUFBTSxLQUFLO0FBQUEsRUFDMUQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUNKLGlCQUNBLFNBQ0EsUUFDQSxxQkFDTTtBQUNOLFFBQUksVUFBVSxhQUFhLGdCQUFnQixRQUFRO0FBQUE7QUFHbkQsUUFBSSxPQUFPLG9CQUFvQixnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDaEUsaUJBQVc7QUFBQTtBQUNYLFlBQU0sWUFBWSxLQUFLLHVCQUF1QixnQkFBZ0IsUUFBUTtBQUN0RSxpQkFBVyxZQUFZO0FBQUEsSUFDM0I7QUFHQSxlQUFXLEtBQUssbUJBQW1CLFNBQVMsZUFBZTtBQUczRCxRQUFJLHVCQUF1QixPQUFPLGdCQUFnQjtBQUM5QyxpQkFBVztBQUFBO0FBQUEsRUFBNEIsbUJBQW1CO0FBQUE7QUFBQSxJQUM5RDtBQUdBLFFBQUksUUFBUSxXQUFXLFNBQVMsUUFBUSxXQUFXLFVBQVU7QUFFekQsVUFBSSxnQkFBZ0Isa0JBQWtCO0FBQ2xDLGNBQU0sU0FBUyxnQkFBZ0IsaUJBQWlCLE9BQU8sTUFBTSxFQUFFLEVBQUUsS0FBSyxJQUFJO0FBQzFFLGNBQU0sUUFBUSxnQkFBZ0IsaUJBQWlCLE1BQU0sTUFBTSxHQUFHLENBQUMsRUFBRSxLQUFLLElBQUk7QUFDMUUsbUJBQVc7QUFBQTtBQUFBO0FBQUEsRUFBZ0UsTUFBTTtBQUFBO0FBQUE7QUFBQSxFQUFzQixLQUFLO0FBQUE7QUFBQSxNQUNoSDtBQUFBLElBQ0osT0FBTztBQUVILGlCQUFXO0FBQUE7QUFBQSxFQUFxQixnQkFBZ0IsT0FBTztBQUFBO0FBQUEsSUFDM0Q7QUFFQSxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsbUJBQW1CLFNBQXNCLGlCQUEwQztBQUN2RixZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxZQUFJLGdCQUFnQixjQUFjO0FBQzlCLGlCQUFPO0FBQUE7QUFBQSxFQUFxQixnQkFBZ0IsWUFBWTtBQUFBO0FBQUEsUUFDNUQ7QUFDQSxlQUFPO0FBQUE7QUFBQTtBQUFBLE1BRVgsS0FBSztBQUNELFlBQUksZ0JBQWdCLGtCQUFrQjtBQUNsQyxnQkFBTSxVQUFVO0FBQUE7QUFBQTtBQUNoQixnQkFBTSxTQUFTLGdCQUFnQixpQkFBaUIsT0FBTyxLQUFLLElBQUk7QUFDaEUsZ0JBQU0sUUFBUSxnQkFBZ0IsaUJBQWlCLE1BQU0sS0FBSyxJQUFJO0FBQzlELGlCQUFPLFVBQVU7QUFBQSxFQUFtQixNQUFNO0FBQUE7QUFBQTtBQUFBLEVBQXNCLEtBQUs7QUFBQTtBQUFBLFFBQ3pFO0FBQ0EsZUFBTztBQUFBO0FBQUE7QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUE7QUFBQTtBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQTtBQUFBO0FBQUEsTUFFWDtBQUNJLGVBQU87QUFBQTtBQUFBO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGdCQUFnQixTQUFzQixhQUE2QjtBQUN2RSxRQUFJQyxVQUFTO0FBRWIsSUFBQUEsV0FBVTtBQUFBLGdCQUFtQixRQUFRLFdBQVc7QUFBQTtBQUdoRCxRQUFJLFFBQVEsU0FBUztBQUNqQixNQUFBQSxXQUFVLDRCQUE0QixRQUFRLE9BQU87QUFBQTtBQUFBLElBQ3pEO0FBR0EsSUFBQUEsV0FBVSxLQUFLLHFCQUFxQixPQUFPO0FBRzNDLElBQUFBLFdBQVUsS0FBSyxzQkFBc0IsT0FBTztBQUU1QyxXQUFPQTtBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHFCQUFxQixTQUE4QjtBQUN2RCxVQUFNLGlCQUFpQjtBQUFBLE1BQ25CLE9BQU87QUFBQSxNQUNQLFFBQVE7QUFBQSxNQUNSLFVBQVU7QUFBQSxNQUNWLFdBQVc7QUFBQSxNQUNYLFdBQVc7QUFBQSxNQUNYLFlBQVk7QUFBQSxJQUNoQjtBQUVBLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELGVBQU87QUFBQSxTQUFZLGVBQWUsUUFBUSxNQUFNLENBQUM7QUFBQTtBQUFBLE1BRXJELEtBQUs7QUFDRCxlQUFPO0FBQUEsU0FBWSxlQUFlLFFBQVEsTUFBTSxDQUFDO0FBQUE7QUFBQSxNQUVyRCxLQUFLO0FBQ0QsZUFBTztBQUFBLFNBQVksZUFBZSxRQUFRLE1BQU0sQ0FBQztBQUFBO0FBQUEsTUFFckQsS0FBSztBQUNELGVBQU87QUFBQTtBQUFBO0FBQUEsTUFFWDtBQUNJLGVBQU87QUFBQSxTQUFZLGVBQWUsUUFBUSxNQUFNLENBQUM7QUFBQTtBQUFBLElBQ3pEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esc0JBQXNCLFNBQThCO0FBQ3hELFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVgsS0FBSztBQUNELGVBQU87QUFBQSxNQUVYLEtBQUs7QUFDRCxlQUFPO0FBQUEsTUFFWCxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BRVg7QUFDSSxlQUFPO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHVCQUF1QixVQUErQztBQUMxRSxXQUFPLFNBQVMsSUFBSSxhQUFXO0FBQzNCLFlBQU0sU0FBUyxLQUFLLE9BQU8sUUFBUSxRQUFRLENBQUM7QUFDNUMsYUFBTyxHQUFHLE1BQU0sS0FBSyxRQUFRLElBQUk7QUFBQSxJQUNyQyxDQUFDLEVBQUUsS0FBSyxJQUFJO0FBQUEsRUFDaEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGVBQWVBLFNBQStEO0FBQzFFLFVBQU0sU0FBbUIsQ0FBQztBQUUxQixRQUFJLENBQUNBLFFBQU8sZ0JBQWdCQSxRQUFPLGFBQWEsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUNqRSxhQUFPLEtBQUssd0JBQXdCO0FBQUEsSUFDeEM7QUFFQSxRQUFJLENBQUNBLFFBQU8sY0FBY0EsUUFBTyxXQUFXLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDN0QsYUFBTyxLQUFLLHNCQUFzQjtBQUFBLElBQ3RDO0FBRUEsUUFBSUEsUUFBTyxXQUFXLFNBQVMsS0FBTztBQUNsQyxhQUFPLEtBQUssNkNBQTZDO0FBQUEsSUFDN0Q7QUFFQSxXQUFPO0FBQUEsTUFDSCxPQUFPLE9BQU8sV0FBVztBQUFBLE1BQ3pCO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFDSjs7O0FDL1NBLElBQU0sbUJBQXFDO0FBQUEsRUFDdkM7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxhQUFhLFVBQVU7QUFBQSxFQUNyQztBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQTtBQUFBLE1BRU47QUFBQTtBQUFBLE1BRUE7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQTtBQUFBO0FBQUEsTUFFQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUE7QUFBQSxNQUVBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxVQUFVO0FBQUEsRUFDeEI7QUFBQSxFQUNBO0FBQUEsSUFDSSxRQUFRO0FBQUEsSUFDUixVQUFVO0FBQUEsTUFDTjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxZQUFZLEtBQUs7QUFBQSxFQUMvQjtBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsSUFDSjtBQUFBLElBQ0EsU0FBUyxDQUFDLFdBQVc7QUFBQSxFQUN6QjtBQUFBLEVBQ0E7QUFBQSxJQUNJLFFBQVE7QUFBQSxJQUNSLFVBQVU7QUFBQSxNQUNOO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUE7QUFBQSxNQUVBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxLQUFLO0FBQUEsRUFDbkI7QUFBQSxFQUNBO0FBQUEsSUFDSSxRQUFRO0FBQUEsSUFDUixVQUFVO0FBQUEsTUFDTjtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0o7QUFBQSxJQUNBLFNBQVMsQ0FBQyxXQUFXO0FBQUEsRUFDekI7QUFDSjtBQU1BLElBQU0sa0JBQWtCO0FBQUEsRUFDcEIsRUFBRSxTQUFTLHlEQUF5RCxRQUFRLFlBQVk7QUFBQSxFQUN4RixFQUFFLFNBQVMscURBQXFELFFBQVEsV0FBVztBQUFBLEVBQ25GLEVBQUUsU0FBUyxnQ0FBZ0MsUUFBUSxNQUFNO0FBQzdEO0FBRU8sSUFBTSxnQkFBTixNQUFvQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS3ZCLGFBQWEsT0FBZSxlQUF3QixPQUFvQjtBQUNwRSxVQUFNLGtCQUFrQixNQUFNLEtBQUssRUFBRSxZQUFZO0FBR2pELFVBQU0sU0FBUyxLQUFLLGFBQWEsZUFBZTtBQUdoRCxVQUFNLFNBQVMsS0FBSyxhQUFhLGlCQUFpQixjQUFjLE1BQU07QUFHdEUsVUFBTSxVQUFVLEtBQUssZUFBZSxLQUFLO0FBRXpDLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQTtBQUFBLE1BQ0EsYUFBYTtBQUFBO0FBQUEsTUFDYjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxhQUFhLE9BQTJCO0FBRTVDLGVBQVcsa0JBQWtCLGtCQUFrQjtBQUMzQyxpQkFBVyxXQUFXLGVBQWUsVUFBVTtBQUMzQyxZQUFJLFFBQVEsS0FBSyxLQUFLLEdBQUc7QUFDckIsaUJBQU8sZUFBZTtBQUFBLFFBQzFCO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFHQSxRQUFJLDJEQUEyRCxLQUFLLEtBQUssR0FBRztBQUN4RSxhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksb0RBQW9ELEtBQUssS0FBSyxHQUFHO0FBQ2pFLGFBQU87QUFBQSxJQUNYO0FBQ0EsUUFBSSxpQ0FBaUMsS0FBSyxLQUFLLEdBQUc7QUFDOUMsYUFBTztBQUFBLElBQ1g7QUFDQSxRQUFJLG9EQUFvRCxLQUFLLEtBQUssR0FBRztBQUNqRSxhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksc0hBQXNILEtBQUssS0FBSyxHQUFHO0FBQ25JLGFBQU87QUFBQSxJQUNYO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGFBQ0osT0FDQSxjQUNBLFFBQ3FCO0FBRXJCLGVBQVcsaUJBQWlCLGlCQUFpQjtBQUN6QyxVQUFJLGNBQWMsUUFBUSxLQUFLLEtBQUssR0FBRztBQUNuQyxlQUFPLGNBQWM7QUFBQSxNQUN6QjtBQUFBLElBQ0o7QUFHQSxRQUFJLGlCQUFpQixXQUFXLFVBQVUsV0FBVyxhQUFhLFdBQVcsV0FBVztBQUNwRixhQUFPO0FBQUEsSUFDWDtBQUdBLFlBQVEsUUFBUTtBQUFBLE1BQ1osS0FBSztBQUNELGVBQU87QUFBQTtBQUFBLE1BQ1gsS0FBSztBQUNELGVBQU8sZUFBZSxjQUFjO0FBQUEsTUFDeEMsS0FBSztBQUNELGVBQU8sZUFBZSxjQUFjO0FBQUEsTUFDeEMsS0FBSztBQUNELGVBQU8sZUFBZSxjQUFjO0FBQUEsTUFDeEMsS0FBSztBQUNELGVBQU8sZUFBZSxjQUFjO0FBQUE7QUFBQSxNQUN4QyxLQUFLO0FBQ0QsZUFBTztBQUFBLE1BQ1g7QUFDSSxlQUFPO0FBQUEsSUFDZjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1RLGVBQWUsT0FBdUI7QUFFMUMsVUFBTSxrQkFBa0I7QUFBQSxNQUNwQjtBQUFBLE1BQVU7QUFBQSxNQUFZO0FBQUEsTUFBVTtBQUFBLE1BQWdCO0FBQUEsTUFBWTtBQUFBLE1BQzVEO0FBQUEsTUFBVTtBQUFBLE1BQVc7QUFBQSxNQUFZO0FBQUEsTUFBUztBQUFBLE1BQVc7QUFBQSxNQUNyRDtBQUFBLE1BQVk7QUFBQSxNQUFXO0FBQUEsTUFBWTtBQUFBLE1BQVk7QUFBQSxJQUNuRDtBQUVBLFVBQU0sY0FBYyxnQkFBZ0I7QUFBQSxNQUFPLFdBQ3ZDLE1BQU0sWUFBWSxFQUFFLFNBQVMsS0FBSztBQUFBLElBQ3RDO0FBRUEsUUFBSSxVQUFVO0FBQ2QsUUFBSSxZQUFZLFNBQVMsR0FBRztBQUN4QixpQkFBVyxVQUFVLFlBQVksS0FBSyxJQUFJLENBQUM7QUFBQSxJQUMvQztBQUdBLFFBQUksTUFBTSxTQUFTLE9BQU8sS0FBSyxNQUFNLFNBQVMsT0FBTyxLQUFLLE1BQU0sU0FBUyxTQUFTLEdBQUc7QUFDakYsaUJBQVc7QUFBQSxJQUNmO0FBQ0EsUUFBSSxNQUFNLFNBQVMsTUFBTSxLQUFLLE1BQU0sU0FBUyxVQUFVLEtBQUssTUFBTSxTQUFTLGVBQWUsR0FBRztBQUN6RixpQkFBVztBQUFBLElBQ2Y7QUFHQSxRQUFJLE1BQU0sU0FBUyxRQUFRLEtBQUssTUFBTSxTQUFTLE1BQU0sR0FBRztBQUNwRCxpQkFBVztBQUFBLElBQ2Y7QUFDQSxRQUFJLE1BQU0sU0FBUyxTQUFTLEtBQUssTUFBTSxTQUFTLFVBQVUsR0FBRztBQUN6RCxpQkFBVztBQUFBLElBQ2Y7QUFDQSxRQUFJLE1BQU0sU0FBUyxRQUFRLEtBQUssTUFBTSxTQUFTLFVBQVUsR0FBRztBQUN4RCxpQkFBVztBQUFBLElBQ2Y7QUFHQSxXQUFPLFFBQVEsS0FBSztBQUFBLEVBQ3hCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsU0FBc0IsY0FHcEM7QUFFRSxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxTQUFTLFFBQVEsV0FBVyxhQUFhO0FBQzVELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsZUFBZSxjQUFpQztBQUM1QyxVQUFNLGNBQXdCLENBQUM7QUFFL0IsUUFBSSxjQUFjO0FBQ2Qsa0JBQVk7QUFBQSxRQUNSO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUFBLElBQ0osT0FBTztBQUNILGtCQUFZO0FBQUEsUUFDUjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHNCQUFzQixPQUE4QjtBQUVoRCxVQUFNLGFBQWE7QUFDbkIsVUFBTSxRQUFRLE1BQU0sTUFBTSxVQUFVO0FBRXBDLFFBQUksTUFBTSxXQUFXLEdBQUc7QUFDcEIsYUFBTyxDQUFDLEtBQUssYUFBYSxLQUFLLENBQUM7QUFBQSxJQUNwQztBQUVBLFdBQU8sTUFDRixJQUFJLFVBQVEsS0FBSyxLQUFLLENBQUMsRUFDdkIsT0FBTyxVQUFRLEtBQUssU0FBUyxDQUFDLEVBQzlCLElBQUksVUFBUSxLQUFLLGFBQWEsSUFBSSxDQUFDO0FBQUEsRUFDNUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHNCQUFzQixTQUE4QjtBQUNoRCxVQUFNLEVBQUUsUUFBUSxPQUFPLElBQUk7QUFFM0IsUUFBSSxjQUFjO0FBRWxCLFlBQVEsUUFBUTtBQUFBLE1BQ1osS0FBSztBQUNELHNCQUFjO0FBQ2Q7QUFBQSxNQUNKLEtBQUs7QUFDRCxzQkFBYztBQUNkO0FBQUEsTUFDSixLQUFLO0FBQ0Qsc0JBQWM7QUFDZDtBQUFBLE1BQ0osS0FBSztBQUNELHNCQUFjO0FBQ2Q7QUFBQSxNQUNKLEtBQUs7QUFDRCxzQkFBYztBQUNkO0FBQUEsTUFDSixLQUFLO0FBQ0Qsc0JBQWM7QUFDZDtBQUFBLElBQ1I7QUFFQSxZQUFRLFFBQVE7QUFBQSxNQUNaLEtBQUs7QUFDRCx1QkFBZTtBQUNmO0FBQUEsTUFDSixLQUFLO0FBQ0QsdUJBQWU7QUFDZjtBQUFBLE1BQ0osS0FBSztBQUNELHVCQUFlO0FBQ2Y7QUFBQSxNQUNKLEtBQUs7QUFDRCx1QkFBZTtBQUNmO0FBQUEsSUFDUjtBQUVBLFdBQU87QUFBQSxFQUNYO0FBQ0o7OztBQzVWTyxJQUFNLGdCQUFOLE1BQW9CO0FBQUEsRUFNdkIsWUFDSSxnQkFDQSxxQkFDRjtBQUNFLFNBQUssaUJBQWlCLElBQUksZUFBZTtBQUN6QyxTQUFLLGlCQUFpQjtBQUN0QixTQUFLLHNCQUFzQjtBQUMzQixTQUFLLGdCQUFnQixJQUFJLGNBQWM7QUFBQSxFQUMzQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxzQkFDRixTQUNBLE1BQ0EsVUFBaUMsQ0FBQyxHQUNWO0FBRXhCLFVBQU0sa0JBQWtCLEtBQUssZ0JBQWdCLE9BQU87QUFFcEQsUUFBSSxtQkFBbUIsTUFBTTtBQUV6QixZQUFNLGdCQUFnQixLQUFLLGNBQWMsYUFBYSxPQUFPO0FBQzdELGFBQU8sS0FBSyxtQkFBbUIsZUFBZSxNQUFNLE9BQU87QUFBQSxJQUMvRCxPQUFPO0FBRUgsYUFBTyxLQUFLLHdCQUF3QixTQUFTLE1BQU0sT0FBTztBQUFBLElBQzlEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQWdCLFNBQTBCO0FBQzlDLFVBQU0sZUFBZSxRQUFRLFlBQVksRUFBRSxLQUFLO0FBR2hELFFBQUksYUFBYSxXQUFXLEdBQUcsR0FBRztBQUM5QixhQUFPO0FBQUEsSUFDWDtBQUdBLFVBQU0sY0FBYztBQUFBLE1BQ2hCO0FBQUEsTUFBTztBQUFBLE1BQVU7QUFBQSxNQUFVO0FBQUEsTUFBVztBQUFBLE1BQVc7QUFBQSxNQUFVO0FBQUEsTUFBUztBQUFBLE1BQ3BFO0FBQUEsTUFBUTtBQUFBLE1BQVU7QUFBQSxNQUFVO0FBQUEsTUFBVTtBQUFBLE1BQVU7QUFBQSxNQUFXO0FBQUEsTUFBVztBQUFBLE1BQ3RFO0FBQUEsTUFBVTtBQUFBLE1BQVU7QUFBQSxNQUFhO0FBQUEsTUFBTztBQUFBLE1BQVM7QUFBQSxNQUNqRDtBQUFBLE1BQU87QUFBQSxNQUFXO0FBQUEsTUFBYTtBQUFBLE1BQVU7QUFBQSxNQUN6QztBQUFBLE1BQVc7QUFBQSxNQUFVO0FBQUEsTUFBWTtBQUFBLE1BQWU7QUFBQSxJQUNwRDtBQUdBLFVBQU0sbUJBQW1CLFlBQVksS0FBSyxVQUFRO0FBQzlDLFlBQU0sY0FBYyxJQUFJLE9BQU8sSUFBSSxJQUFJLE9BQU8sR0FBRztBQUNqRCxhQUFPLFlBQVksS0FBSyxZQUFZO0FBQUEsSUFDeEMsQ0FBQztBQUVELFFBQUksa0JBQWtCO0FBRWxCLFlBQU0scUJBQXFCO0FBQUEsUUFDdkI7QUFBQSxRQUNBO0FBQUE7QUFBQSxRQUNBO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxtQkFBbUIsS0FBSyxhQUFXLFFBQVEsS0FBSyxZQUFZLENBQUM7QUFDaEYsVUFBSSxZQUFZO0FBQ1osZUFBTztBQUFBLE1BQ1g7QUFFQSxhQUFPO0FBQUEsSUFDWDtBQUdBLFVBQU0sMEJBQTBCO0FBQUE7QUFBQSxNQUU1QjtBQUFBO0FBQUEsTUFHQTtBQUFBLE1BQ0E7QUFBQTtBQUFBLE1BR0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNKO0FBR0EsZUFBVyxXQUFXLHlCQUF5QjtBQUMzQyxVQUFJLFFBQVEsS0FBSyxZQUFZLEdBQUc7QUFDNUIsZUFBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sbUJBQ0YsU0FDQSxNQUNBLFVBQWlDLENBQUMsR0FDVjtBQUN4QixRQUFJLENBQUMsTUFBTTtBQUNQLFlBQU0sSUFBSSxNQUFNLHNDQUFzQztBQUFBLElBQzFEO0FBR0EsVUFBTSxrQkFBa0IsTUFBTSxLQUFLLG1CQUFtQixJQUFJO0FBRzFELFFBQUk7QUFDSixRQUFJLFFBQVEsZ0JBQWdCO0FBQ3hCLFlBQU0saUJBQWlCLE1BQU0sS0FBSyxvQkFBb0Isa0JBQWtCLE1BQU0sQ0FBQztBQUMvRSw0QkFBc0IsS0FBSywwQkFBMEIsY0FBYztBQUFBLElBQ3ZFO0FBR0EsV0FBTyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixTQUFTLG1CQUFtQjtBQUFBLEVBQ2pHO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLHdCQUNGLFNBQ0EsTUFDQSxVQUFpQyxDQUFDLEdBQ1Y7QUFDeEIsUUFBSTtBQUNKLFFBQUksZ0JBQXVDLENBQUM7QUFHNUMsUUFBSSxNQUFNO0FBQ04sd0JBQWtCLE1BQU0sS0FBSyxtQkFBbUIsSUFBSTtBQUdwRCxzQkFBZ0IsTUFBTSxLQUFLLG9CQUFvQixrQkFBa0IsTUFBTSxDQUFDO0FBQUEsSUFDNUU7QUFHQSxVQUFNLGVBQWU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFjckIsUUFBSSxhQUFhLGlCQUFpQixPQUFPO0FBR3pDLFFBQUksbUJBQW1CLE1BQU07QUFDekIsbUJBQWEscUJBQXFCLGdCQUFnQixRQUFRO0FBQUE7QUFBQSxFQUVwRSxVQUFVO0FBQUEsSUFDSjtBQUdBLFFBQUksY0FBYyxTQUFTLEdBQUc7QUFDMUIsWUFBTSxnQkFBZ0IsS0FBSywwQkFBMEIsYUFBYTtBQUNsRSxtQkFBYTtBQUFBLEVBQ3ZCLGFBQWE7QUFBQTtBQUFBLEVBRWIsVUFBVTtBQUFBLElBQ0o7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0E7QUFBQSxNQUNBLFVBQVMsbURBQWlCLFlBQVc7QUFBQSxNQUNyQyxRQUFRO0FBQUEsUUFDSixhQUFhLFFBQVEsZUFBZTtBQUFBLFFBQ3BDLFdBQVcsUUFBUSxhQUFhO0FBQUEsTUFDcEM7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQWtCLGFBQXFCLFNBQW1DO0FBQ3RFLFVBQU0sZUFBZTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPckIsUUFBSSxhQUFhLGlCQUFpQixXQUFXO0FBRTdDLFFBQUksU0FBUztBQUNULG1CQUFhLFlBQVksT0FBTztBQUFBO0FBQUEsRUFFMUMsVUFBVTtBQUFBLElBQ0o7QUFFQSxXQUFPO0FBQUEsTUFDSDtBQUFBLE1BQ0E7QUFBQSxNQUNBLFNBQVMsV0FBVztBQUFBLE1BQ3BCLFFBQVE7QUFBQSxRQUNKLGFBQWE7QUFBQSxRQUNiLFdBQVc7QUFBQSxNQUNmO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsbUJBQW1CLE1BQXVDO0FBRXBFLFVBQU0sVUFBVSxNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFFN0QsUUFBSSxDQUFDLFNBQVM7QUFFVixZQUFNLFVBQVUsTUFBTSxLQUFLLGVBQWUsbUJBQW1CLEtBQUs7QUFDbEUsYUFBTztBQUFBLFFBQ0g7QUFBQSxRQUNBLFVBQVUsS0FBSztBQUFBLFFBQ2Y7QUFBQSxRQUNBLFVBQVUsQ0FBQztBQUFBLFFBQ1gsY0FBYztBQUFBLFFBQ2Qsa0JBQWtCO0FBQUEsTUFDdEI7QUFBQSxJQUNKO0FBR0EsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLDBCQUEwQixVQUF5QztBQUN2RSxRQUFJLFNBQVMsV0FBVyxFQUFHLFFBQU87QUFFbEMsUUFBSSxZQUFZO0FBQ2hCLGFBQVMsUUFBUSxTQUFPO0FBQ3BCLFlBQU0sT0FBTyxJQUFJLFNBQVMsU0FBUyxRQUFRO0FBQzNDLG1CQUFhLEdBQUcsSUFBSSxLQUFLLElBQUksT0FBTztBQUFBO0FBQUEsSUFDeEMsQ0FBQztBQUVELFdBQU87QUFBQSxFQUNYO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSwwQkFBMEJDLFNBQTBDO0FBQ2hFLFVBQU0sYUFBYSxLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUU1RCxRQUFJLENBQUMsV0FBVyxPQUFPO0FBSW5CLFVBQUksa0JBQWtCLEVBQUUsR0FBR0EsUUFBTztBQUdsQyxZQUFNLGFBQWEsS0FBSyxtQkFBbUJBLE9BQU07QUFDakQsVUFBSSxhQUFhLEtBQU07QUFFbkIsY0FBTSxtQkFBbUIsS0FBSyxNQUFNQSxRQUFPLFFBQVEsU0FBUyxHQUFHO0FBQy9ELHdCQUFnQixVQUFVQSxRQUFPLFFBQVEsVUFBVSxHQUFHLGdCQUFnQixJQUFJO0FBQUEsTUFDOUU7QUFHQSxVQUFJQSxRQUFPLE9BQU8sY0FBYyxLQUFLQSxRQUFPLE9BQU8sY0FBYyxHQUFHO0FBQ2hFLHdCQUFnQixPQUFPLGNBQWMsS0FBSyxJQUFJLEdBQUcsS0FBSyxJQUFJLEdBQUdBLFFBQU8sT0FBTyxXQUFXLENBQUM7QUFBQSxNQUMzRjtBQUdBLFVBQUlBLFFBQU8sT0FBTyxZQUFZLE1BQU1BLFFBQU8sT0FBTyxZQUFZLEtBQU07QUFDaEUsd0JBQWdCLE9BQU8sWUFBWSxLQUFLLElBQUksSUFBSSxLQUFLLElBQUksS0FBTUEsUUFBTyxPQUFPLFNBQVMsQ0FBQztBQUFBLE1BQzNGO0FBRUEsYUFBTztBQUFBLElBQ1g7QUFFQSxXQUFPQTtBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGNBQWNBLFNBQWlDO0FBQzNDLFdBQU8sS0FBSyxtQkFBbUJBLE9BQU07QUFBQSxFQUN6QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxpQkFDRixRQUNBLGFBQ0EsTUFDd0I7QUFDeEIsVUFBTSxVQUF1QjtBQUFBLE1BQ3pCO0FBQUEsTUFDQSxRQUFRO0FBQUEsTUFDUjtBQUFBLE1BQ0EsU0FBUztBQUFBLElBQ2I7QUFFQSxRQUFJLE1BQU07QUFDTixhQUFPLEtBQUssbUJBQW1CLFNBQVMsTUFBTTtBQUFBLFFBQzFDLGlCQUFpQjtBQUFBLFFBQ2pCLGtCQUFrQjtBQUFBLFFBQ2xCLGdCQUFnQjtBQUFBLE1BQ3BCLENBQUM7QUFBQSxJQUNMLE9BQU87QUFDSCxhQUFPLEtBQUssa0JBQWtCLFdBQVc7QUFBQSxJQUM3QztBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLG1CQUFtQkEsU0FBaUM7QUFFeEQsVUFBTSxZQUFZQSxRQUFPLGVBQWVBLFFBQU8sYUFBYUEsUUFBTztBQUNuRSxXQUFPLEtBQUssS0FBSyxVQUFVLFNBQVMsQ0FBQztBQUFBLEVBQ3pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUNGLGNBQ0EsYUFDQSxNQUN3QjtBQUN4QixRQUFJLFVBQVU7QUFFZCxRQUFJLE1BQU07QUFDTixZQUFNLGtCQUFrQixNQUFNLEtBQUssbUJBQW1CLElBQUk7QUFDMUQsZ0JBQVUsYUFBYSxnQkFBZ0IsUUFBUTtBQUFBLEVBQUssZ0JBQWdCLE9BQU87QUFBQSxJQUMvRTtBQUVBLFdBQU87QUFBQSxNQUNIO0FBQUEsTUFDQSxZQUFZO0FBQUEsTUFDWjtBQUFBLE1BQ0EsUUFBUTtBQUFBLFFBQ0osYUFBYTtBQUFBLFFBQ2IsV0FBVztBQUFBLE1BQ2Y7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKOzs7QUMvV08sSUFBTSxhQUFOLE1BQWlCO0FBQUEsRUFDcEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBMEIsbUJBQTREO0FBQ2hHLFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsT0FBTztBQUMvQyxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sbUJBQW1CLEtBQUssZUFBZSxlQUFlQSxPQUFNO0FBQ2xFLFVBQUksQ0FBQyxpQkFBaUIsT0FBTztBQUN6QixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixpQkFBaUIsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ3RFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFHQSxZQUFJO0FBQ0osWUFBSTtBQUVKLFlBQUksbUJBQW1CO0FBRW5CLG1CQUFTLE1BQU0sS0FBSyxxQkFBcUIsU0FBUyxpQkFBaUJBLFNBQVEsaUJBQWlCO0FBQUEsUUFDaEcsT0FBTztBQUVILG9CQUFVLE1BQU0sS0FBSyxnQkFBZ0I7QUFBQSxZQUNqQ0EsUUFBTztBQUFBLFlBQ1A7QUFBQSxjQUNJLGNBQWNBLFFBQU87QUFBQSxjQUNyQixhQUFhQSxRQUFPLE9BQU87QUFBQSxjQUMzQixXQUFXQSxRQUFPLE9BQU87QUFBQSxZQUM3QjtBQUFBLFVBQ0o7QUFFQSxjQUFJLENBQUMsV0FBVyxRQUFRLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDekMsbUJBQU87QUFBQSxjQUNILFNBQVM7QUFBQSxjQUNULE9BQU87QUFBQSxjQUNQLFVBQVU7QUFBQSxZQUNkO0FBQUEsVUFDSjtBQUdBLG1CQUFTLE1BQU0sS0FBSyxjQUFjLFNBQVMsaUJBQWlCLE9BQU87QUFBQSxRQUN2RTtBQU1BLGVBQU87QUFBQSxNQUVYLFNBQVMsT0FBTztBQUNaLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsY0FDVixTQUNBLGlCQUNBLFNBQ21CO0FBQ25CLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxVQUM3QjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsWUFDSSxjQUFjO0FBQUEsWUFDZCxlQUFlO0FBQUEsVUFDbkI7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFVBQzdCO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxZQUNJLGNBQWM7QUFBQSxZQUNkLGVBQWU7QUFBQSxVQUNuQjtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELFlBQUksZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSixPQUFPO0FBRUgsaUJBQU8sTUFBTSxLQUFLLGVBQWU7QUFBQSxZQUM3QjtBQUFBLFlBQ0E7QUFBQSxZQUNBO0FBQUEsY0FDSSxjQUFjO0FBQUEsY0FDZCxlQUFlO0FBQUEsWUFDbkI7QUFBQSxVQUNKO0FBQUEsUUFDSjtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLHVCQUF1QixRQUFRLE1BQU07QUFBQSxVQUM1QyxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsU0FBOEQ7QUFFbEYsUUFBSSxRQUFRLFdBQVcsT0FBTztBQUMxQixhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLENBQUMsUUFBUSxlQUFlLFFBQVEsWUFBWSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ2pFLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxxQkFDVixTQUNBLGlCQUNBQSxTQUNBLG1CQUNtQjtBQUNuQixRQUFJO0FBRUEsVUFBSSxjQUFjO0FBR2xCLFlBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUFBLFFBQ2hDQSxRQUFPO0FBQUEsUUFDUDtBQUFBLFVBQ0ksY0FBY0EsUUFBTztBQUFBLFVBQ3JCLGFBQWFBLFFBQU8sT0FBTztBQUFBLFVBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFFBQzdCO0FBQUEsTUFDSjtBQUVBLHVCQUFpQixTQUFTLFFBQVE7QUFDOUIsWUFBSSxNQUFNLFNBQVM7QUFDZix5QkFBZSxNQUFNO0FBRXJCLDRCQUFrQixhQUFhLEtBQUs7QUFBQSxRQUN4QztBQUFBLE1BQ0o7QUFHQSx3QkFBa0IsYUFBYSxJQUFJO0FBRW5DLFVBQUksQ0FBQyxlQUFlLFlBQVksS0FBSyxFQUFFLFdBQVcsR0FBRztBQUNqRCxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFJQSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixXQUFXLGdCQUFnQixrQkFBa0IsRUFBRSxNQUFNLEdBQUcsSUFBSSxFQUFFO0FBQUEsTUFDbEU7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDaEQsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKOzs7QUN4UU8sSUFBTSxjQUFOLE1BQWtCO0FBQUEsRUFDckIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBMEIsbUJBQTREO0FBQ2hHLFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsU0FBUyxDQUFDLENBQUMsZ0JBQWdCLFlBQVk7QUFDL0UsVUFBSSxDQUFDLFdBQVcsT0FBTztBQUNuQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLFdBQVc7QUFBQSxVQUNsQixVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLHNCQUFzQixLQUFLLGVBQWUsdUJBQXVCO0FBQ3ZFLFlBQU0sZUFBZSxzQkFBc0IsRUFBRSxnQkFBZ0IsS0FBSyxJQUFJLENBQUM7QUFDdkUsWUFBTUMsVUFBUyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixjQUFjLG1CQUFtQjtBQUcxRyxZQUFNLG1CQUFtQixLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUNsRSxVQUFJLENBQUMsaUJBQWlCLE9BQU87QUFDekIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyw2QkFBNkIsaUJBQWlCLE9BQU8sS0FBSyxJQUFJLENBQUM7QUFBQSxVQUN0RSxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxVQUFJO0FBR0EsWUFBSTtBQUNKLFlBQUk7QUFFSixZQUFJLG1CQUFtQjtBQUVuQixtQkFBUyxNQUFNLEtBQUsscUJBQXFCLFNBQVMsaUJBQWlCQSxTQUFRLGlCQUFpQjtBQUFBLFFBQ2hHLE9BQU87QUFFSCxvQkFBVSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsWUFDakNBLFFBQU87QUFBQSxZQUNQO0FBQUEsY0FDSSxjQUFjQSxRQUFPO0FBQUEsY0FDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsY0FDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsWUFDN0I7QUFBQSxVQUNKO0FBRUEsY0FBSSxDQUFDLFdBQVcsUUFBUSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ3pDLG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPO0FBQUEsY0FDUCxVQUFVO0FBQUEsWUFDZDtBQUFBLFVBQ0o7QUFHQSxtQkFBUyxNQUFNLEtBQUssVUFBVSxTQUFTLGlCQUFpQixPQUFPO0FBQUEsUUFDbkU7QUFNQSxlQUFPO0FBQUEsTUFFWCxTQUFTLE9BQU87QUFDWixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFVBQ2hELFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLFVBQ1YsU0FDQSxpQkFDQSxTQUNtQjtBQUNuQixZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxZQUFJLGdCQUFnQixjQUFjO0FBQzlCLGlCQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsWUFDN0I7QUFBQSxZQUNBO0FBQUEsWUFDQTtBQUFBLGNBQ0ksY0FBYztBQUFBLGNBQ2QsZUFBZTtBQUFBLFlBQ25CO0FBQUEsVUFDSjtBQUFBLFFBQ0osT0FBTztBQUNILGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUosS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWUsbUJBQW1CLE9BQU87QUFBQSxNQUUvRCxLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFVBQzdCO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxZQUNJLGNBQWM7QUFBQSxZQUNkLGVBQWU7QUFBQSxVQUNuQjtBQUFBLFFBQ0o7QUFBQSxNQUVKO0FBQ0ksZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyx3QkFBd0IsUUFBUSxNQUFNO0FBQUEsVUFDN0MsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxJQUNSO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQ0osU0FDQSxjQUNrQztBQUVsQyxRQUFJLFFBQVEsV0FBVyxlQUFlLENBQUMsY0FBYztBQUNqRCxhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLFFBQVEsV0FBVyxRQUFRO0FBQzNCLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksQ0FBQyxRQUFRLGVBQWUsUUFBUSxZQUFZLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDakUsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBRUEsV0FBTyxFQUFFLE9BQU8sS0FBSztBQUFBLEVBQ3pCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHFCQUNWLFNBQ0EsaUJBQ0FBLFNBQ0EsbUJBQ21CO0FBQ25CLFFBQUk7QUFFQSxVQUFJLGNBQWM7QUFHbEIsWUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBQUEsUUFDaENBLFFBQU87QUFBQSxRQUNQO0FBQUEsVUFDSSxjQUFjQSxRQUFPO0FBQUEsVUFDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsVUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBRUEsdUJBQWlCLFNBQVMsUUFBUTtBQUM5QixZQUFJLE1BQU0sU0FBUztBQUNmLHlCQUFlLE1BQU07QUFFckIsNEJBQWtCLGFBQWEsS0FBSztBQUFBLFFBQ3hDO0FBQUEsTUFDSjtBQUdBLHdCQUFrQixhQUFhLElBQUk7QUFFbkMsVUFBSSxDQUFDLGVBQWUsWUFBWSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ2pELGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUlBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxRQUNWLFdBQVcsZ0JBQWdCLGtCQUFrQixFQUFFLE1BQU0sR0FBRyxJQUFJLEVBQUU7QUFBQSxNQUNsRTtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0o7OztBQ3BRTyxJQUFNLGdCQUFOLE1BQW9CO0FBQUEsRUFDdkIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBK0M7QUFDekQsUUFBSTtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSyxlQUFlLG1CQUFtQjtBQUNyRSxVQUFJLENBQUMsaUJBQWlCO0FBQ2xCLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxLQUFLLGdCQUFnQixTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsWUFBWTtBQUMvRSxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sU0FBUyxNQUFNLEtBQUssY0FBYyxTQUFTLGVBQWU7QUFNaEUsYUFBTztBQUFBLElBRVgsU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLGNBQ1YsU0FDQSxpQkFDbUI7QUFDbkIsWUFBUSxRQUFRLFFBQVE7QUFBQSxNQUNwQixLQUFLO0FBQ0QsWUFBSSxnQkFBZ0IsY0FBYztBQUM5QixpQkFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFlBQzdCO0FBQUEsWUFDQTtBQUFBLFlBQ0E7QUFBQSxjQUNJLGNBQWM7QUFBQSxjQUNkLGVBQWU7QUFBQSxZQUNuQjtBQUFBLFVBQ0o7QUFBQSxRQUNKLE9BQU87QUFDSCxpQkFBTztBQUFBLFlBQ0gsU0FBUztBQUFBLFlBQ1QsT0FBTztBQUFBLFlBQ1AsVUFBVTtBQUFBLFVBQ2Q7QUFBQSxRQUNKO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZSxjQUFjLE1BQU07QUFBQSxNQUV6RCxLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZSxtQkFBbUIsRUFBRTtBQUFBLE1BRTFELEtBQUs7QUFFRCxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDBCQUEwQixRQUFRLE1BQU07QUFBQSxVQUMvQyxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFDSixTQUNBLGNBQ2tDO0FBRWxDLFFBQUksUUFBUSxXQUFXLGVBQWUsQ0FBQyxjQUFjO0FBQ2pELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLFVBQVU7QUFDN0IsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBRUEsV0FBTyxFQUFFLE9BQU8sS0FBSztBQUFBLEVBQ3pCO0FBQ0o7OztBQzlITyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFDeEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBMEIsbUJBQTREO0FBQ2hHLFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsU0FBUyxDQUFDLENBQUMsZ0JBQWdCLFlBQVk7QUFDL0UsVUFBSSxDQUFDLFdBQVcsT0FBTztBQUNuQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLFdBQVc7QUFBQSxVQUNsQixVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLHNCQUFzQixLQUFLLGVBQWUsdUJBQXVCO0FBQ3ZFLFlBQU0sZUFBZSxzQkFBc0IsRUFBRSxnQkFBZ0IsS0FBSyxJQUFJLENBQUM7QUFDdkUsWUFBTUMsVUFBUyxLQUFLLGVBQWUsWUFBWSxTQUFTLGlCQUFpQixjQUFjLG1CQUFtQjtBQUcxRyxZQUFNLG1CQUFtQixLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUNsRSxVQUFJLENBQUMsaUJBQWlCLE9BQU87QUFDekIsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTyw2QkFBNkIsaUJBQWlCLE9BQU8sS0FBSyxJQUFJLENBQUM7QUFBQSxVQUN0RSxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxVQUFJO0FBR0EsWUFBSTtBQUNKLFlBQUk7QUFFSixZQUFJLG1CQUFtQjtBQUVuQixtQkFBUyxNQUFNLEtBQUsscUJBQXFCLFNBQVMsaUJBQWlCQSxTQUFRLGlCQUFpQjtBQUFBLFFBQ2hHLE9BQU87QUFFSCxvQkFBVSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsWUFDakNBLFFBQU87QUFBQSxZQUNQO0FBQUEsY0FDSSxjQUFjQSxRQUFPO0FBQUEsY0FDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsY0FDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsWUFDN0I7QUFBQSxVQUNKO0FBRUEsY0FBSSxDQUFDLFdBQVcsUUFBUSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ3pDLG1CQUFPO0FBQUEsY0FDSCxTQUFTO0FBQUEsY0FDVCxPQUFPO0FBQUEsY0FDUCxVQUFVO0FBQUEsWUFDZDtBQUFBLFVBQ0o7QUFHQSxtQkFBUyxNQUFNLEtBQUssZ0JBQWdCLFNBQVMsaUJBQWlCLE9BQU87QUFBQSxRQUN6RTtBQU1BLGVBQU87QUFBQSxNQUVYLFNBQVMsT0FBTztBQUNaLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsZ0JBQ1YsU0FDQSxpQkFDQSxTQUNtQjtBQUNuQixZQUFRLFFBQVEsUUFBUTtBQUFBLE1BQ3BCLEtBQUs7QUFDRCxZQUFJLGdCQUFnQixjQUFjO0FBQzlCLGlCQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsWUFDN0I7QUFBQSxZQUNBO0FBQUEsWUFDQTtBQUFBLGNBQ0ksY0FBYztBQUFBLGNBQ2QsZUFBZTtBQUFBLFlBQ25CO0FBQUEsVUFDSjtBQUFBLFFBQ0osT0FBTztBQUNILGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlLG1CQUFtQixPQUFPO0FBQUEsTUFFL0QsS0FBSztBQUdELGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFFSixLQUFLO0FBRUQsZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTztBQUFBLFVBQ1AsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUVKO0FBQ0ksZUFBTztBQUFBLFVBQ0gsU0FBUztBQUFBLFVBQ1QsT0FBTywyQkFBMkIsUUFBUSxNQUFNO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxJQUNSO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsZ0JBQ0osU0FDQSxjQUNrQztBQUVsQyxRQUFJLFFBQVEsV0FBVyxXQUFXO0FBQzlCLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUdBLFFBQUksUUFBUSxXQUFXLGVBQWUsQ0FBQyxjQUFjO0FBQ2pELGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFFBQUksUUFBUSxXQUFXLGVBQWUsUUFBUSxXQUFXLFlBQVk7QUFDakUsYUFBTztBQUFBLFFBQ0gsT0FBTztBQUFBLFFBQ1AsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKO0FBRUEsV0FBTyxFQUFFLE9BQU8sS0FBSztBQUFBLEVBQ3pCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHFCQUNWLFNBQ0EsaUJBQ0FBLFNBQ0EsbUJBQ21CO0FBQ25CLFFBQUk7QUFFQSxVQUFJLGNBQWM7QUFHbEIsWUFBTSxTQUFTLEtBQUssZ0JBQWdCO0FBQUEsUUFDaENBLFFBQU87QUFBQSxRQUNQO0FBQUEsVUFDSSxjQUFjQSxRQUFPO0FBQUEsVUFDckIsYUFBYUEsUUFBTyxPQUFPO0FBQUEsVUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBRUEsdUJBQWlCLFNBQVMsUUFBUTtBQUM5QixZQUFJLE1BQU0sU0FBUztBQUNmLHlCQUFlLE1BQU07QUFFckIsNEJBQWtCLGFBQWEsS0FBSztBQUFBLFFBQ3hDO0FBQUEsTUFDSjtBQUdBLHdCQUFrQixhQUFhLElBQUk7QUFFbkMsVUFBSSxDQUFDLGVBQWUsWUFBWSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ2pELGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxVQUNQLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUlBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxRQUNWLFdBQVcsZ0JBQWdCLGtCQUFrQixFQUFFLE1BQU0sR0FBRyxJQUFJLEVBQUU7QUFBQSxNQUNsRTtBQUFBLElBRUosU0FBUyxPQUFPO0FBQ1osYUFBTztBQUFBLFFBQ0gsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxRQUNoRCxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQ0o7OztBQzdQTyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFDeEIsWUFDWSxLQUNBLGdCQUNBLGdCQUNBLGlCQUNWO0FBSlU7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUNUO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLSCxNQUFNLFFBQVEsU0FBMEIsbUJBQTREO0FBQ2hHLFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLGFBQWEsS0FBSyxnQkFBZ0IsT0FBTztBQUMvQyxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sV0FBVztBQUFBLFVBQ2xCLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sbUJBQW1CLEtBQUssZUFBZSxlQUFlQSxPQUFNO0FBQ2xFLFVBQUksQ0FBQyxpQkFBaUIsT0FBTztBQUN6QixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDZCQUE2QixpQkFBaUIsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ3RFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFVBQUk7QUFHQSxZQUFJO0FBQ0osWUFBSTtBQUVKLFlBQUksbUJBQW1CO0FBRW5CLG1CQUFTLE1BQU0sS0FBSyxxQkFBcUIsU0FBUyxpQkFBaUJBLFNBQVEsaUJBQWlCO0FBQUEsUUFDaEcsT0FBTztBQUVILG9CQUFVLE1BQU0sS0FBSyxnQkFBZ0I7QUFBQSxZQUNqQ0EsUUFBTztBQUFBLFlBQ1A7QUFBQSxjQUNJLGNBQWNBLFFBQU87QUFBQSxjQUNyQixhQUFhQSxRQUFPLE9BQU87QUFBQSxjQUMzQixXQUFXQSxRQUFPLE9BQU87QUFBQSxZQUM3QjtBQUFBLFVBQ0o7QUFFQSxjQUFJLENBQUMsV0FBVyxRQUFRLEtBQUssRUFBRSxXQUFXLEdBQUc7QUFDekMsbUJBQU87QUFBQSxjQUNILFNBQVM7QUFBQSxjQUNULE9BQU87QUFBQSxjQUNQLFVBQVU7QUFBQSxZQUNkO0FBQUEsVUFDSjtBQUdBLG1CQUFTLE1BQU0sS0FBSyxhQUFhLFNBQVMsaUJBQWlCLE9BQU87QUFBQSxRQUN0RTtBQU1BLGVBQU87QUFBQSxNQUVYLFNBQVMsT0FBTztBQUNaLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsVUFDaEQsVUFBVTtBQUFBLFFBQ2Q7QUFBQSxNQUNKO0FBQUEsSUFFSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ2hELFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsYUFDVixTQUNBLGlCQUNBLFNBQ21CO0FBQ25CLFlBQVEsUUFBUSxRQUFRO0FBQUEsTUFDcEIsS0FBSztBQUVELGVBQU8sTUFBTSxLQUFLLGVBQWUsbUJBQW1CLE9BQU87QUFBQSxNQUUvRCxLQUFLO0FBRUQsZUFBTyxNQUFNLEtBQUssZUFBZTtBQUFBLFVBQzdCO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxZQUNJLGNBQWM7QUFBQSxZQUNkLGVBQWU7QUFBQSxVQUNuQjtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxZQUFJLGdCQUFnQixjQUFjO0FBQzlCLGlCQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsWUFDN0I7QUFBQSxZQUNBO0FBQUEsWUFDQTtBQUFBLGNBQ0ksY0FBYztBQUFBLGNBQ2QsZUFBZTtBQUFBLFlBQ25CO0FBQUEsVUFDSjtBQUFBLFFBQ0osT0FBTztBQUNILGlCQUFPO0FBQUEsWUFDSCxTQUFTO0FBQUEsWUFDVCxPQUFPO0FBQUEsWUFDUCxVQUFVO0FBQUEsVUFDZDtBQUFBLFFBQ0o7QUFBQSxNQUVKLEtBQUs7QUFFRCxlQUFPLE1BQU0sS0FBSyxlQUFlO0FBQUEsVUFDN0I7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFlBQ0ksY0FBYztBQUFBLFlBQ2QsZUFBZTtBQUFBLFVBQ25CO0FBQUEsUUFDSjtBQUFBLE1BRUo7QUFDSSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPLDJCQUEyQixRQUFRLE1BQU07QUFBQSxVQUNoRCxVQUFVO0FBQUEsUUFDZDtBQUFBLElBQ1I7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsU0FBOEQ7QUFFbEYsUUFBSSxRQUFRLFdBQVcsV0FBVztBQUM5QixhQUFPO0FBQUEsUUFDSCxPQUFPO0FBQUEsUUFDUCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0o7QUFHQSxRQUFJLENBQUMsUUFBUSxlQUFlLFFBQVEsWUFBWSxLQUFLLEVBQUUsV0FBVyxHQUFHO0FBQ2pFLGFBQU87QUFBQSxRQUNILE9BQU87QUFBQSxRQUNQLE9BQU87QUFBQSxNQUNYO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxPQUFPLEtBQUs7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxxQkFDVixTQUNBLGlCQUNBQSxTQUNBLG1CQUNtQjtBQUNuQixRQUFJO0FBRUEsVUFBSSxjQUFjO0FBR2xCLFlBQU0sU0FBUyxLQUFLLGdCQUFnQjtBQUFBLFFBQ2hDQSxRQUFPO0FBQUEsUUFDUDtBQUFBLFVBQ0ksY0FBY0EsUUFBTztBQUFBLFVBQ3JCLGFBQWFBLFFBQU8sT0FBTztBQUFBLFVBQzNCLFdBQVdBLFFBQU8sT0FBTztBQUFBLFFBQzdCO0FBQUEsTUFDSjtBQUVBLHVCQUFpQixTQUFTLFFBQVE7QUFDOUIsWUFBSSxNQUFNLFNBQVM7QUFDZix5QkFBZSxNQUFNO0FBRXJCLDRCQUFrQixhQUFhLEtBQUs7QUFBQSxRQUN4QztBQUFBLE1BQ0o7QUFHQSx3QkFBa0IsYUFBYSxJQUFJO0FBRW5DLFVBQUksQ0FBQyxlQUFlLFlBQVksS0FBSyxFQUFFLFdBQVcsR0FBRztBQUNqRCxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFJQSxhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxVQUFVO0FBQUEsUUFDVixXQUFXLGdCQUFnQixrQkFBa0IsRUFBRSxNQUFNLEdBQUcsSUFBSSxFQUFFO0FBQUEsTUFDbEU7QUFBQSxJQUVKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDaEQsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUNKOzs7QUN2UE8sSUFBTSxrQkFBTixNQUFzQjtBQUFBLEVBQ3pCLFlBQ1ksS0FDQSxnQkFDQSxnQkFDQSxpQkFDVjtBQUpVO0FBQ0E7QUFDQTtBQUNBO0FBQUEsRUFDVDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0gsTUFBTSxRQUFRLFNBQTJDO0FBQ3JELFFBQUk7QUFFQSxZQUFNLGtCQUFrQixNQUFNLEtBQUssZUFBZSxtQkFBbUI7QUFDckUsVUFBSSxDQUFDLGlCQUFpQjtBQUNsQixlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLFlBQVksTUFBTSxLQUFLLHlCQUF5QixRQUFRLGFBQWEsZUFBZTtBQUMxRixVQUFJLFdBQVc7QUFDWCxlQUFPO0FBQUEsTUFDWDtBQUdBLFlBQU0sc0JBQXNCLEtBQUssZUFBZSx1QkFBdUI7QUFDdkUsWUFBTSxlQUFlLHNCQUFzQixFQUFFLGdCQUFnQixLQUFLLElBQUksQ0FBQztBQUN2RSxZQUFNQyxVQUFTLEtBQUssZUFBZSxZQUFZLFNBQVMsaUJBQWlCLGNBQWMsbUJBQW1CO0FBRzFHLFlBQU0sYUFBYSxLQUFLLGVBQWUsZUFBZUEsT0FBTTtBQUM1RCxVQUFJLENBQUMsV0FBVyxPQUFPO0FBQ25CLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8sNkJBQTZCLFdBQVcsT0FBTyxLQUFLLElBQUksQ0FBQztBQUFBLFVBQ2hFLFVBQVU7QUFBQSxRQUNkO0FBQUEsTUFDSjtBQUdBLFlBQU0sYUFBYSxNQUFNLEtBQUssZ0JBQWdCO0FBQUEsUUFDMUNBLFFBQU87QUFBQSxRQUNQQSxRQUFPO0FBQUEsUUFDUDtBQUFBLFVBQ0ksYUFBYUEsUUFBTyxPQUFPO0FBQUEsVUFDM0IsV0FBV0EsUUFBTyxPQUFPO0FBQUEsUUFDN0I7QUFBQSxNQUNKO0FBR0EsWUFBTSxVQUFVLEtBQUsscUJBQXFCLFVBQVU7QUFDcEQsVUFBSSxDQUFDLFdBQVcsT0FBTyxLQUFLLE9BQU8sRUFBRSxXQUFXLEdBQUc7QUFFL0MsZ0JBQVEsTUFBTSxrREFBa0QsVUFBVTtBQUMxRSxlQUFPO0FBQUEsVUFDSCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsVUFDUCxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxjQUFRLElBQUkscUJBQXFCLE9BQU87QUFHeEMsWUFBTSxpQkFBaUIsS0FBSyxrQkFBa0IsZ0JBQWdCLFNBQVMsT0FBTztBQUc5RSxZQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sZ0JBQWdCLE1BQU0sY0FBYztBQUdoRSxZQUFNLGlCQUFpQixLQUFLLHVCQUF1QixPQUFPO0FBRTFELGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFdBQVcsRUFBRSxNQUFNLEdBQUcsSUFBSSxFQUFFO0FBQUEsUUFDNUIsVUFBVTtBQUFBLFFBQ1Y7QUFBQSxNQUNKO0FBQUEsSUFDSixTQUFTLE9BQU87QUFDWixhQUFPO0FBQUEsUUFDSCxTQUFTO0FBQUEsUUFDVCxPQUFPLDhCQUErQixNQUFnQixPQUFPO0FBQUEsUUFDN0QsVUFBVTtBQUFBLE1BQ2Q7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EscUJBQXFCLFVBQThDO0FBQ3ZFLFFBQUk7QUFFQSxZQUFNLFlBQVksU0FBUyxNQUFNLDRCQUE0QjtBQUM3RCxVQUFJLFdBQVc7QUFDWCxlQUFPLEtBQUssTUFBTSxVQUFVLENBQUMsQ0FBQztBQUFBLE1BQ2xDO0FBR0EsWUFBTSxVQUErQixDQUFDO0FBQ3RDLFlBQU0sUUFBUSxTQUFTLE1BQU0sSUFBSTtBQUVqQyxpQkFBVyxRQUFRLE9BQU87QUFFdEIsY0FBTSxRQUFRLEtBQUssTUFBTSx5QkFBeUI7QUFDbEQsWUFBSSxPQUFPO0FBQ1AsZ0JBQU0sTUFBTSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBQzFCLGNBQUksUUFBUSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBRzFCLGNBQUk7QUFDQSxvQkFBUSxLQUFLLE1BQU0sS0FBSztBQUFBLFVBQzVCLFNBQVE7QUFHSixnQkFBSyxNQUFNLFdBQVcsR0FBRyxLQUFLLE1BQU0sU0FBUyxHQUFHLEtBQzNDLE1BQU0sV0FBVyxHQUFHLEtBQUssTUFBTSxTQUFTLEdBQUcsR0FBSTtBQUNoRCxzQkFBUSxNQUFNLE1BQU0sR0FBRyxFQUFFO0FBQUEsWUFDN0I7QUFBQSxVQUNKO0FBRUEsa0JBQVEsR0FBRyxJQUFJO0FBQUEsUUFDbkI7QUFBQSxNQUNKO0FBRUEsYUFBTyxPQUFPLEtBQUssT0FBTyxFQUFFLFNBQVMsSUFBSSxVQUFVO0FBQUEsSUFDdkQsU0FBUyxPQUFPO0FBRVosYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxrQkFBa0IsU0FBaUIsU0FBc0M7QUFDN0UsVUFBTSxRQUFRLFFBQVEsTUFBTSxJQUFJO0FBR2hDLFFBQUksTUFBTSxDQUFDLE1BQU0sT0FBTztBQUVwQixVQUFJLFdBQVc7QUFDZixlQUFTLElBQUksR0FBRyxJQUFJLE1BQU0sUUFBUSxLQUFLO0FBQ25DLFlBQUksTUFBTSxDQUFDLE1BQU0sT0FBTztBQUNwQixxQkFBVztBQUNYO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFFQSxVQUFJLFdBQVcsR0FBRztBQUVkLGNBQU0sZ0JBQXFDLENBQUM7QUFDNUMsaUJBQVMsSUFBSSxHQUFHLElBQUksVUFBVSxLQUFLO0FBQy9CLGdCQUFNLFFBQVEsTUFBTSxDQUFDLEVBQUUsTUFBTSxtQkFBbUI7QUFDaEQsY0FBSSxPQUFPO0FBQ1Asa0JBQU0sTUFBTSxNQUFNLENBQUMsRUFBRSxLQUFLO0FBQzFCLGdCQUFJLFFBQVEsTUFBTSxDQUFDLEVBQUUsS0FBSztBQUcxQixnQkFBSTtBQUNBLHNCQUFRLEtBQUssTUFBTSxLQUFLO0FBQUEsWUFDNUIsU0FBUTtBQUFBLFlBRVI7QUFFQSwwQkFBYyxHQUFHLElBQUk7QUFBQSxVQUN6QjtBQUFBLFFBQ0o7QUFHQSxjQUFNLGNBQWMsRUFBRSxHQUFHLGVBQWUsR0FBRyxRQUFRO0FBR25ELGNBQU1DLGtCQUFpQixDQUFDLEtBQUs7QUFDN0IsbUJBQVcsQ0FBQyxLQUFLLEtBQUssS0FBSyxPQUFPLFFBQVEsV0FBVyxHQUFHO0FBQ3BELGNBQUksVUFBVSxRQUFRLFVBQVUsUUFBVztBQUV2QztBQUFBLFVBQ0o7QUFFQSxnQkFBTSxpQkFBaUIsT0FBTyxVQUFVLFdBQ2xDLEtBQUssVUFBVSxLQUFLLElBQ3BCLE9BQU8sS0FBSztBQUVsQixVQUFBQSxnQkFBZSxLQUFLLEdBQUcsR0FBRyxLQUFLLGNBQWMsRUFBRTtBQUFBLFFBQ25EO0FBQ0EsUUFBQUEsZ0JBQWUsS0FBSyxLQUFLO0FBR3pCLGVBQU87QUFBQSxVQUNILEdBQUdBO0FBQUEsVUFDSCxHQUFHLE1BQU0sTUFBTSxXQUFXLENBQUM7QUFBQSxRQUMvQixFQUFFLEtBQUssSUFBSTtBQUFBLE1BQ2Y7QUFBQSxJQUNKO0FBR0EsVUFBTSxpQkFBaUIsQ0FBQyxLQUFLO0FBQzdCLGVBQVcsQ0FBQyxLQUFLLEtBQUssS0FBSyxPQUFPLFFBQVEsT0FBTyxHQUFHO0FBQ2hELFVBQUksVUFBVSxRQUFRLFVBQVUsUUFBVztBQUN2QztBQUFBLE1BQ0o7QUFFQSxZQUFNLGlCQUFpQixPQUFPLFVBQVUsV0FDbEMsS0FBSyxVQUFVLEtBQUssSUFDcEIsT0FBTyxLQUFLO0FBRWxCLHFCQUFlLEtBQUssR0FBRyxHQUFHLEtBQUssY0FBYyxFQUFFO0FBQUEsSUFDbkQ7QUFDQSxtQkFBZSxLQUFLLE9BQU8sRUFBRTtBQUc3QixXQUFPLGVBQWUsS0FBSyxJQUFJLElBQUk7QUFBQSxFQUN2QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyx5QkFBeUIsYUFBcUIsaUJBQThEO0FBQ3RILFVBQU0sbUJBQW1CLFlBQVksWUFBWSxFQUFFLEtBQUs7QUFHeEQsVUFBTSxhQUFhLGlCQUFpQixNQUFNLDJDQUEyQztBQUNyRixRQUFJLFlBQVk7QUFDWixZQUFNLFNBQVMsV0FBVyxDQUFDO0FBQzNCLFlBQU0sWUFBWSxXQUFXLENBQUM7QUFDOUIsWUFBTSxVQUFVLFlBQVksVUFBVSxNQUFNLEdBQUcsRUFBRSxJQUFJLE9BQUssRUFBRSxLQUFLLENBQUMsRUFBRSxPQUFPLE9BQUssQ0FBQyxJQUFJLENBQUM7QUFHdEYsVUFBSSxXQUFXLFNBQVMsUUFBUSxXQUFXLEdBQUc7QUFDMUMsZUFBTyxNQUFNLEtBQUsscUJBQXFCLHNCQUFzQixlQUFlO0FBQUEsTUFDaEY7QUFHQSxZQUFNLGNBQWMsS0FBSyxlQUFlLGdCQUFnQixPQUFPO0FBRS9ELFVBQUksY0FBd0IsQ0FBQztBQUM3QixVQUFJLFVBQVU7QUFFZCxjQUFRLFFBQVE7QUFBQSxRQUNaLEtBQUs7QUFFRCxnQkFBTSxZQUFZLFFBQVE7QUFBQSxZQUFPLFNBQzdCLENBQUMsWUFBWSxLQUFLLGNBQVksU0FBUyxZQUFZLE1BQU0sSUFBSSxZQUFZLENBQUM7QUFBQSxVQUM5RTtBQUNBLHdCQUFjLENBQUMsR0FBRyxhQUFhLEdBQUcsU0FBUztBQUMzQyxvQkFBVSxVQUFVLFNBQVMsSUFDdkIsU0FBUyxVQUFVLE1BQU0sT0FBTyxVQUFVLFdBQVcsSUFBSSxNQUFNLEVBQUUsS0FBSyxVQUFVLEtBQUssSUFBSSxDQUFDLEtBQzFGO0FBQ047QUFBQSxRQUVKLEtBQUs7QUFFRCxnQkFBTSxlQUFlLFFBQVEsSUFBSSxPQUFLLEVBQUUsWUFBWSxDQUFDO0FBQ3JELGdCQUFNLGNBQWMsWUFBWTtBQUNoQyx3QkFBYyxZQUFZO0FBQUEsWUFBTyxTQUM3QixDQUFDLGFBQWEsU0FBUyxJQUFJLFlBQVksQ0FBQztBQUFBLFVBQzVDO0FBQ0EsZ0JBQU0sZUFBZSxjQUFjLFlBQVk7QUFDL0Msb0JBQVUsZUFBZSxJQUNuQixXQUFXLFlBQVksT0FBTyxpQkFBaUIsSUFBSSxNQUFNLEVBQUUsS0FDM0Q7QUFDTjtBQUFBLFFBRUosS0FBSztBQUFBLFFBQ0wsS0FBSztBQUVELHdCQUFjLENBQUMsR0FBRyxJQUFJLElBQUksUUFBUSxJQUFJLE9BQUssRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDO0FBQzVELG9CQUFVLE9BQU8sWUFBWSxNQUFNLE9BQU8sWUFBWSxXQUFXLElBQUksTUFBTSxFQUFFO0FBQzdFO0FBQUEsTUFDUjtBQUdBLFlBQU0sVUFBVSxFQUFFLE1BQU0sWUFBWTtBQUNwQyxZQUFNLGlCQUFpQixLQUFLLGtCQUFrQixnQkFBZ0IsU0FBUyxPQUFPO0FBQzlFLFlBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxnQkFBZ0IsTUFBTSxjQUFjO0FBRWhFLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFdBQVcsRUFBRSxNQUFNLEdBQUcsSUFBSSxFQUFFO0FBQUEsUUFDNUIsVUFBVTtBQUFBLFFBQ1YsZ0JBQWdCO0FBQUEsTUFDcEI7QUFBQSxJQUNKO0FBR0EsUUFBSSxzRUFBc0UsS0FBSyxnQkFBZ0IsS0FDM0YsdUNBQXVDLEtBQUssZ0JBQWdCLEtBQzVELHdCQUF3QixLQUFLLGdCQUFnQixLQUM3QyxjQUFjLEtBQUssZ0JBQWdCO0FBQUEsSUFDbkMsaUJBQWlCLEtBQUssZ0JBQWdCLEdBQUc7QUFFekMsYUFBTyxNQUFNLEtBQUsscUJBQXFCLGFBQWEsZUFBZTtBQUFBLElBQ3ZFO0FBRUEsV0FBTztBQUFBLEVBQ1g7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMscUJBQXFCLGFBQXFCLGlCQUF1RDtBQUMzRyxVQUFNLGNBQWMsS0FBSyxlQUFlLGdCQUFnQixPQUFPO0FBRy9ELFVBQU0sZUFBZTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWlCckIsUUFBSSxhQUFhO0FBRWpCLFFBQUksaUJBQWlCLEtBQUssV0FBVyxLQUFLLGNBQWMsS0FBSyxXQUFXLEdBQUc7QUFDdkUsbUJBQWE7QUFBQTtBQUFBLGdCQUVULFlBQVksU0FBUyxJQUFJLFlBQVksS0FBSyxJQUFJLElBQUksTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSXRFLGdCQUFnQixPQUFPO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFVakIsV0FBVyxvQkFBb0IsS0FBSyxXQUFXLEdBQUc7QUFDOUMsbUJBQWE7QUFBQTtBQUFBLGdCQUVULFlBQVksS0FBSyxJQUFJLENBQUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUlwQyxnQkFBZ0IsT0FBTztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFXakIsV0FBVywwQ0FBMEMsS0FBSyxXQUFXLEdBQUc7QUFDcEUsbUJBQWE7QUFBQTtBQUFBLGdCQUVULFlBQVksU0FBUyxJQUFJLFlBQVksS0FBSyxJQUFJLElBQUksTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSXRFLGdCQUFnQixPQUFPO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQVdqQjtBQUVBLFFBQUk7QUFFQSxZQUFNLG1CQUFtQixLQUFLLGdCQUFnQixvQkFBb0I7QUFDbEUsWUFBTSxhQUFhLE1BQU0sS0FBSyxnQkFBZ0IsU0FBUyxjQUFjLFlBQVk7QUFBQSxRQUM3RSxhQUFhO0FBQUEsUUFDYixXQUFXO0FBQUEsTUFDZixDQUFDO0FBR0QsWUFBTSxTQUFTLEtBQUssbUJBQW1CLFVBQVU7QUFDakQsVUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLFFBQVEsT0FBTyxLQUFLLFdBQVcsR0FBRztBQUVyRCxjQUFNLFVBQVUsV0FBVyxTQUFTLE1BQzlCLFdBQVcsVUFBVSxHQUFHLEdBQUcsSUFBSSxRQUMvQjtBQUNOLGVBQU87QUFBQSxVQUNILFNBQVM7QUFBQSxVQUNULE9BQU8scURBQXFELE9BQU87QUFBQSxVQUNuRSxVQUFVO0FBQUEsUUFDZDtBQUFBLE1BQ0o7QUFHQSxZQUFNLFVBQVUsRUFBRSxNQUFNLE9BQU8sS0FBSztBQUNwQyxZQUFNLGlCQUFpQixLQUFLLGtCQUFrQixnQkFBZ0IsU0FBUyxPQUFPO0FBQzlFLFlBQU0sS0FBSyxJQUFJLE1BQU0sT0FBTyxnQkFBZ0IsTUFBTSxjQUFjO0FBR2hFLFVBQUksVUFBVTtBQUNkLFVBQUksaUJBQWlCLEtBQUssV0FBVyxLQUFLLGNBQWMsS0FBSyxXQUFXLEdBQUc7QUFDdkUsY0FBTSxZQUFZLE9BQU8sS0FBSztBQUFBLFVBQU8sU0FDakMsQ0FBQyxZQUFZLEtBQUssY0FBWSxTQUFTLFlBQVksTUFBTSxJQUFJLFlBQVksQ0FBQztBQUFBLFFBQzlFO0FBQ0Esa0JBQVUsU0FBUyxVQUFVLE1BQU0saUJBQWlCLFVBQVUsV0FBVyxJQUFJLE1BQU0sRUFBRSxLQUFLLFVBQVUsS0FBSyxJQUFJLENBQUM7QUFBQSxNQUNsSCxXQUFXLG9CQUFvQixLQUFLLFdBQVcsR0FBRztBQUM5QyxrQkFBVSxvQkFBb0IsWUFBWSxNQUFNLFdBQU0sT0FBTyxLQUFLLE1BQU07QUFBQSxNQUM1RSxPQUFPO0FBQ0gsa0JBQVUsbUJBQW1CLE9BQU8sS0FBSyxNQUFNLE9BQU8sT0FBTyxLQUFLLFdBQVcsSUFBSSxNQUFNLEVBQUUsU0FBUyxZQUFZLE1BQU07QUFBQSxNQUN4SDtBQUVBLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFdBQVcsRUFBRSxNQUFNLEdBQUcsSUFBSSxFQUFFO0FBQUEsUUFDNUIsVUFBVTtBQUFBLFFBQ1YsZ0JBQWdCO0FBQUEsTUFDcEI7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUNaLGFBQU87QUFBQSxRQUNILFNBQVM7QUFBQSxRQUNULE9BQU8sb0NBQXFDLE1BQWdCLE9BQU87QUFBQSxRQUNuRSxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxlQUFlLFNBQTJCO0FBQzlDLFFBQUksQ0FBQyxRQUFTLFFBQU8sQ0FBQztBQUV0QixVQUFNLFFBQVEsUUFBUSxNQUFNLElBQUk7QUFFaEMsUUFBSSxNQUFNLFNBQVMsS0FBSyxNQUFNLENBQUMsTUFBTSxPQUFPO0FBQ3hDLFVBQUksZ0JBQWdCO0FBQ3BCLGVBQVMsSUFBSSxHQUFHLElBQUksTUFBTSxVQUFVLGVBQWUsS0FBSztBQUNwRCxZQUFJLE1BQU0sQ0FBQyxNQUFNLE9BQU87QUFDcEI7QUFBQSxRQUNKO0FBRUEsY0FBTSxXQUFXLE1BQU0sQ0FBQyxFQUFFLE1BQU0sZ0JBQWdCO0FBQ2hELFlBQUksVUFBVTtBQUNWLGdCQUFNLFdBQVcsU0FBUyxDQUFDLEVBQUUsS0FBSztBQUVsQyxjQUFJLENBQUMsU0FBVSxRQUFPLENBQUM7QUFHdkIsY0FBSTtBQUNBLGtCQUFNLFNBQVMsS0FBSyxNQUFNLFFBQVE7QUFDbEMsZ0JBQUksTUFBTSxRQUFRLE1BQU0sR0FBRztBQUN2QixxQkFBTyxPQUFPLE9BQU8sT0FBSyxDQUFDO0FBQUEsWUFDL0I7QUFBQSxVQUNKLFNBQVE7QUFFSixtQkFBTyxTQUFTLE1BQU0sR0FBRyxFQUFFLElBQUksT0FBSyxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sT0FBSyxDQUFDO0FBQUEsVUFDL0Q7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFHQSxXQUFPLENBQUM7QUFBQSxFQUNaO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxtQkFBbUIsVUFBaUU7QUFDeEYsUUFBSTtBQUVBLFlBQU0sZ0JBQWdCLFNBQVMsS0FBSztBQUdwQyxZQUFNLFlBQVksY0FBYyxNQUFNLGFBQWE7QUFDbkQsVUFBSSxXQUFXO0FBQ1gsWUFBSTtBQUNBLGdCQUFNLFNBQVMsS0FBSyxNQUFNLFVBQVUsQ0FBQyxDQUFDO0FBQ3RDLGNBQUksT0FBTyxRQUFRLE1BQU0sUUFBUSxPQUFPLElBQUksR0FBRztBQUMzQyxtQkFBTztBQUFBLGNBQ0gsTUFBTSxPQUFPLEtBQUssSUFBSSxDQUFDLE1BQVcsT0FBTyxDQUFDLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxRQUFRLFFBQVEsR0FBRyxDQUFDLEVBQUUsT0FBTyxDQUFDLE1BQWMsQ0FBQztBQUFBLGNBQzlHLFdBQVcsT0FBTztBQUFBLFlBQ3RCO0FBQUEsVUFDSjtBQUFBLFFBQ0osU0FBUyxHQUFHO0FBQUEsUUFFWjtBQUFBLE1BQ0o7QUFHQSxZQUFNLFdBQVc7QUFBQTtBQUFBLFFBRWI7QUFBQTtBQUFBLFFBRUE7QUFBQTtBQUFBLFFBRUE7QUFBQSxNQUNKO0FBRUEsaUJBQVcsV0FBVyxVQUFVO0FBQzVCLGNBQU0sUUFBUSxjQUFjLE1BQU0sT0FBTztBQUN6QyxZQUFJLE9BQU87QUFDUCxjQUFJLFlBQVksTUFBTSxDQUFDO0FBQ3ZCLGNBQUksT0FBaUIsQ0FBQztBQUd0QixjQUFJLFVBQVUsU0FBUyxHQUFHLEtBQUssVUFBVSxTQUFTLFFBQUcsS0FBSyxVQUFVLFNBQVMsR0FBRyxHQUFHO0FBQy9FLG1CQUFPLFVBQ0YsTUFBTSxJQUFJLEVBQ1YsSUFBSSxDQUFDLFNBQWlCLEtBQUssUUFBUSxnQkFBZ0IsRUFBRSxFQUFFLEtBQUssQ0FBQyxFQUM3RCxPQUFPLENBQUMsTUFBYyxDQUFDO0FBQUEsVUFDaEMsT0FBTztBQUVILG1CQUFPLFVBQ0YsTUFBTSxHQUFHLEVBQ1QsSUFBSSxDQUFDLE1BQWMsRUFBRSxLQUFLLEVBQUUsUUFBUSxTQUFTLEVBQUUsQ0FBQyxFQUNoRCxPQUFPLENBQUMsTUFBYyxDQUFDO0FBQUEsVUFDaEM7QUFFQSxjQUFJLEtBQUssU0FBUyxHQUFHO0FBQ2pCLG1CQUFPO0FBQUEsY0FDSCxNQUFNLEtBQUssSUFBSSxPQUFLLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxRQUFRLFFBQVEsR0FBRyxDQUFDLEVBQUUsT0FBTyxPQUFLLENBQUM7QUFBQSxZQUNsRjtBQUFBLFVBQ0o7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUdBLFlBQU0sZUFBZSxjQUFjLE1BQU0sK0RBQStEO0FBQ3hHLFVBQUksY0FBYztBQUNkLGNBQU0sT0FBTyxhQUFhLENBQUMsRUFDdEIsTUFBTSxPQUFPLEVBQ2IsSUFBSSxPQUFLLEVBQUUsS0FBSyxFQUFFLFFBQVEsU0FBUyxFQUFFLEVBQUUsUUFBUSxZQUFZLEVBQUUsQ0FBQyxFQUM5RCxPQUFPLE9BQUssQ0FBQztBQUVsQixZQUFJLEtBQUssU0FBUyxHQUFHO0FBQ2pCLGlCQUFPO0FBQUEsWUFDSCxNQUFNLEtBQUssSUFBSSxPQUFLLEVBQUUsWUFBWSxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sT0FBSyxDQUFDO0FBQUEsVUFDN0Q7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUdBLFlBQU0sUUFBUSxjQUFjLE1BQU0sSUFBSSxFQUFFLElBQUksVUFBUSxLQUFLLEtBQUssQ0FBQyxFQUFFLE9BQU8sVUFBUSxJQUFJO0FBQ3BGLFlBQU0sWUFBWSxNQUNiLE9BQU8sVUFBUTtBQUVaLGVBQU8sS0FBSyxTQUFTLEtBQ2QsS0FBSyxTQUFTLE1BQ2QsQ0FBQyxLQUFLLFNBQVMsR0FBRyxLQUNsQixDQUFDLEtBQUssWUFBWSxFQUFFLFNBQVMsS0FBSyxLQUNsQyxDQUFDLEtBQUssWUFBWSxFQUFFLFNBQVMsTUFBTSxLQUNuQyxDQUFDLEtBQUssWUFBWSxFQUFFLFNBQVMsU0FBUztBQUFBLE1BQ2pELENBQUMsRUFDQSxJQUFJLFVBQVE7QUFFVCxlQUFPLEtBQUssWUFBWSxFQUNuQixRQUFRLGNBQWMsRUFBRSxFQUN4QixRQUFRLGFBQWEsRUFBRSxFQUN2QixLQUFLLEVBQ0wsUUFBUSxRQUFRLEdBQUc7QUFBQSxNQUM1QixDQUFDLEVBQ0EsT0FBTyxTQUFPLEdBQUc7QUFFdEIsVUFBSSxVQUFVLFNBQVMsR0FBRztBQUN0QixlQUFPLEVBQUUsTUFBTSxVQUFVO0FBQUEsTUFDN0I7QUFHQSxjQUFRLE1BQU0sb0NBQW9DLGFBQWE7QUFDL0QsYUFBTztBQUFBLElBQ1gsU0FBUyxPQUFPO0FBQ1osY0FBUSxNQUFNLGtDQUFrQyxPQUFPLGlCQUFpQixRQUFRO0FBQ2hGLGFBQU87QUFBQSxJQUNYO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQXVCLFNBQXNDO0FBQ2pFLFVBQU0sT0FBTyxPQUFPLEtBQUssT0FBTztBQUNoQyxRQUFJLEtBQUssV0FBVyxFQUFHLFFBQU87QUFFOUIsUUFBSSxLQUFLLFdBQVcsR0FBRztBQUNuQixZQUFNLE1BQU0sS0FBSyxDQUFDO0FBQ2xCLFVBQUksUUFBUSxRQUFRO0FBQ2hCLGNBQU0sUUFBUSxNQUFNLFFBQVEsUUFBUSxJQUFJLElBQUksUUFBUSxLQUFLLFNBQVM7QUFDbEUsZUFBTyxpQkFBaUIsS0FBSyxPQUFPLFVBQVUsSUFBSSxNQUFNLEVBQUU7QUFBQSxNQUM5RDtBQUNBLGFBQU8sV0FBVyxHQUFHO0FBQUEsSUFDekI7QUFFQSxXQUFPLFdBQVcsS0FBSyxNQUFNO0FBQUEsRUFDakM7QUFDSjs7O0FDam1CTyxJQUFNLHFCQUF1RDtBQUFBO0FBQUEsRUFFaEUsWUFBWTtBQUFBLElBQ1IsZUFBZTtBQUFBO0FBQUEsSUFDZixhQUFhO0FBQUE7QUFBQSxJQUNiLGFBQWE7QUFBQSxFQUNqQjtBQUFBO0FBQUEsRUFHQSxjQUFjO0FBQUEsSUFDVixlQUFlO0FBQUE7QUFBQSxJQUNmLGFBQWE7QUFBQTtBQUFBLElBQ2IsYUFBYTtBQUFBLEVBQ2pCO0FBQUE7QUFBQSxFQUdBLHNCQUFzQjtBQUFBLElBQ2xCLGVBQWU7QUFBQTtBQUFBLElBQ2YsYUFBYTtBQUFBO0FBQUEsSUFDYixhQUFhO0FBQUEsRUFDakI7QUFDSjtBQU1PLElBQU0sZ0JBQTZDO0FBQUEsRUFDdEQsaUJBQWlCO0FBQUEsSUFDYixhQUFhO0FBQUEsRUFDakI7QUFBQSxFQUNBLG9CQUFvQjtBQUFBLElBQ2hCLGFBQWE7QUFBQSxFQUNqQjtBQUFBLEVBQ0Esc0JBQXNCO0FBQUEsSUFDbEIsYUFBYTtBQUFBLEVBQ2pCO0FBQUEsRUFDQSxzQkFBc0I7QUFBQSxJQUNsQixhQUFhO0FBQUEsRUFDakI7QUFBQSxFQUNBLGlCQUFpQjtBQUFBLElBQ2IsYUFBYTtBQUFBLEVBQ2pCO0FBQUEsRUFDQSxrQkFBa0I7QUFBQSxJQUNkLGFBQWE7QUFBQSxFQUNqQjtBQUFBLEVBQ0EsZ0JBQWdCO0FBQUEsSUFDWixhQUFhO0FBQUEsRUFDakI7QUFBQSxFQUNBLG9CQUFvQjtBQUFBLElBQ2hCLGFBQWE7QUFBQSxFQUNqQjtBQUFBLEVBQ0EscUJBQXFCO0FBQUEsSUFDakIsYUFBYTtBQUFBLEVBQ2pCO0FBQ0o7OztBQ3BFTyxJQUFNLGlCQUFOLE1BQXFCO0FBQUEsRUFNM0IsWUFDUyxrQkFDUixlQUNDO0FBRk87QUFOVCxTQUFRLFdBQXFDLG9CQUFJLElBQUk7QUFDckQsU0FBUSxtQkFBNEM7QUFDcEQsU0FBUSxjQUF1QjtBQUMvQixTQUFRLGdCQUErQixFQUFFLFNBQVMsTUFBTTtBQU12RCxRQUFJLGVBQWU7QUFDbEIsV0FBSyxnQkFBZ0I7QUFBQSxJQUN0QjtBQUNBLFNBQUssdUJBQXVCO0FBQUEsRUFDN0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPUSx5QkFBK0I7QUFFdEMsV0FBTyxRQUFRLGFBQWEsRUFBRSxRQUFRLENBQUMsQ0FBQyxLQUFLLE1BQU0sTUFBTTtBQUN4RCxXQUFLLGdCQUFnQjtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxTQUFTO0FBQUEsUUFDVCxhQUFhLE9BQU87QUFBQSxNQUNyQixDQUFDO0FBQUEsSUFDRixDQUFDO0FBR0QsV0FBTyxRQUFRLGtCQUFrQixFQUFFLFFBQVEsQ0FBQyxDQUFDLEtBQUssTUFBTSxNQUFNO0FBQzdELFlBQU0sVUFBVSxLQUFLLDBCQUEwQixLQUFLLE1BQU07QUFDMUQsV0FBSyxnQkFBZ0I7QUFBQSxRQUNwQjtBQUFBLFFBQ0E7QUFBQSxRQUNBLGFBQWEsT0FBTztBQUFBLFFBQ3BCLGFBQWE7QUFBQSxRQUNiLGlCQUFpQixDQUFDLEtBQUsscUJBQXFCLE1BQU07QUFBQSxNQUNuRCxDQUFDO0FBQUEsSUFDRixDQUFDO0FBQUEsRUFDRjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsMEJBQTBCLFlBQW9CLFFBQW1DO0FBQ3hGLFVBQU0sTUFBTSxLQUFLLGVBQWU7QUFDaEMsVUFBTSxnQkFBZ0IsSUFBSSxLQUFLLE9BQU8sYUFBYTtBQUNuRCxVQUFNLGNBQWMsSUFBSSxLQUFLLE9BQU8sV0FBVztBQUcvQyxRQUFJLE9BQU8sYUFBYTtBQUN2QixhQUFPO0FBQUEsSUFDUjtBQUdBLFFBQUksS0FBSyxlQUFlLEtBQUssT0FBTyxlQUFlO0FBQ2xELGFBQU87QUFBQSxJQUNSO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLHFCQUFxQixRQUFtQztBQUMvRCxVQUFNLE1BQU0sS0FBSyxlQUFlO0FBQ2hDLFVBQU0sY0FBYyxJQUFJLEtBQUssT0FBTyxXQUFXO0FBQy9DLFdBQU8sT0FBTztBQUFBLEVBQ2Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtRLGlCQUF1QjtBQUM5QixRQUFJLEtBQUssY0FBYyxXQUFXLEtBQUssY0FBYyxjQUFjO0FBQ2xFLGFBQU8sSUFBSSxLQUFLLEtBQUssY0FBYyxZQUFZO0FBQUEsSUFDaEQ7QUFDQSxXQUFPLG9CQUFJLEtBQUs7QUFBQSxFQUNqQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsaUJBQTBCO0FBQ2pDLFFBQUksS0FBSyxjQUFjLFdBQVcsS0FBSyxjQUFjLG1CQUFtQixRQUFXO0FBQ2xGLGFBQU8sS0FBSyxjQUFjO0FBQUEsSUFDM0I7QUFDQSxXQUFPLEtBQUs7QUFBQSxFQUNiO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxnQkFBZ0IsTUFBeUI7QUFDeEMsU0FBSyxTQUFTLElBQUksS0FBSyxLQUFLLElBQUk7QUFBQSxFQUNqQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx1QkFBdUIsWUFBMEM7QUFDdEUsUUFBSSxDQUFDLFlBQVk7QUFDaEIsV0FBSyxtQkFBbUI7QUFDeEIsV0FBSyxjQUFjO0FBQUEsSUFDcEIsT0FBTztBQUNOLFlBQU0sYUFBYSxNQUFNLEtBQUssaUJBQWlCLHlCQUF5QixVQUFVO0FBQ2xGLFVBQUksV0FBVyxTQUFTLFdBQVcsU0FBUztBQUMzQyxhQUFLLG1CQUFtQixXQUFXO0FBQ25DLGFBQUssY0FBYztBQUFBLE1BQ3BCLE9BQU87QUFDTixhQUFLLG1CQUFtQjtBQUN4QixhQUFLLGNBQWM7QUFBQSxNQUNwQjtBQUFBLElBQ0Q7QUFHQSxTQUFLLHVCQUF1QjtBQUFBLEVBQzdCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBZ0M7QUFDL0IsV0FBTyxLQUFLLGVBQWU7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esc0JBQStDO0FBQzlDLFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGlCQUFpQixZQUE2QjtBQWhKL0M7QUFrSkUsUUFBSSxLQUFLLG1CQUFtQixVQUFVLEdBQUc7QUFDeEMsYUFBTztBQUFBLElBQ1I7QUFFQSxVQUFNLFVBQVUsS0FBSyxTQUFTLElBQUksVUFBVTtBQUM1QyxZQUFPLHdDQUFTLFlBQVQsWUFBb0I7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsbUJBQW1CLEtBQXNCO0FBQ2hELFVBQU0sYUFBYTtBQUFBLE1BQ2xCO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0Q7QUFDQSxXQUFPLFdBQVcsU0FBUyxHQUFHO0FBQUEsRUFDL0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG1CQUFtQixZQUF5QztBQUUzRCxRQUFJLEtBQUssbUJBQW1CLFVBQVUsR0FBRztBQUN4QyxhQUFPLEVBQUUsU0FBUyxLQUFLO0FBQUEsSUFDeEI7QUFFQSxVQUFNLFVBQVUsS0FBSyxTQUFTLElBQUksVUFBVTtBQUU1QyxRQUFJLENBQUMsU0FBUztBQUNiLGFBQU87QUFBQSxRQUNOLFNBQVM7QUFBQSxRQUNULFFBQVEsWUFBWSxVQUFVO0FBQUEsTUFDL0I7QUFBQSxJQUNEO0FBRUEsUUFBSSxRQUFRLFNBQVM7QUFDcEIsYUFBTyxFQUFFLFNBQVMsS0FBSztBQUFBLElBQ3hCO0FBR0EsUUFBSSxRQUFRLGFBQWE7QUFDeEIsWUFBTSxTQUFTLG1CQUFtQixVQUFVO0FBQzVDLFVBQUksUUFBUTtBQUNYLGNBQU0sTUFBTSxLQUFLLGVBQWU7QUFDaEMsY0FBTSxjQUFjLElBQUksS0FBSyxPQUFPLFdBQVc7QUFDL0MsY0FBTSxnQkFBZ0IsSUFBSSxLQUFLLE9BQU8sYUFBYTtBQUVuRCxZQUFJLEtBQUssZUFBZSxLQUFLLE1BQU0sZUFBZTtBQUNqRCxpQkFBTztBQUFBLFlBQ04sU0FBUztBQUFBLFlBQ1QsUUFBUSw2REFBNkQsT0FBTyxhQUFhO0FBQUEsWUFDekYsb0JBQW9CO0FBQUEsWUFDcEIsZUFBZTtBQUFBLFVBQ2hCO0FBQUEsUUFDRCxXQUFXLENBQUMsS0FBSyxlQUFlLEtBQUssTUFBTSxhQUFhO0FBQ3ZELGlCQUFPO0FBQUEsWUFDTixTQUFTO0FBQUEsWUFDVCxRQUFRLDRHQUE0RyxPQUFPLFdBQVc7QUFBQSxZQUN0SSxvQkFBb0I7QUFBQSxZQUNwQixlQUFlO0FBQUEsVUFDaEI7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFFQSxXQUFPO0FBQUEsTUFDTixTQUFTO0FBQUEsTUFDVCxRQUFRO0FBQUEsSUFDVDtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHFCQUFvQztBQUNuQyxXQUFPLE1BQU0sS0FBSyxLQUFLLFNBQVMsT0FBTyxDQUFDLEVBQUUsT0FBTyxhQUFXLFFBQVEsT0FBTztBQUFBLEVBQzVFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSx1QkFBc0M7QUFDckMsV0FBTyxNQUFNLEtBQUssS0FBSyxTQUFTLE9BQU8sQ0FBQyxFQUFFO0FBQUEsTUFBTyxhQUNoRCxRQUFRLGVBQWUsUUFBUTtBQUFBLElBQ2hDO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esb0JBQW9CLFVBQStCO0FBQ2xELFNBQUssZ0JBQWdCO0FBRXJCLFNBQUssdUJBQXVCO0FBQUEsRUFDN0I7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLG1CQUFrQztBQUNqQyxXQUFPLEVBQUUsR0FBRyxLQUFLLGNBQWM7QUFBQSxFQUNoQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esb0JBSUU7QUFDRCxVQUFNLFVBQW9CLENBQUM7QUFDM0IsVUFBTSxhQUFnRixDQUFDO0FBRXZGLGVBQVcsQ0FBQyxLQUFLLE9BQU8sS0FBSyxLQUFLLFVBQVU7QUFDM0MsVUFBSSxRQUFRLFNBQVM7QUFDcEIsZ0JBQVEsS0FBSyxHQUFHO0FBQUEsTUFDakIsV0FBVyxRQUFRLGFBQWE7QUFDL0IsY0FBTSxTQUFTLG1CQUFtQixHQUFHO0FBQ3JDLFlBQUksUUFBUTtBQUNYLGdCQUFNLGtCQUFrQixLQUFLLGVBQWU7QUFDNUMscUJBQVcsS0FBSztBQUFBLFlBQ2Y7QUFBQSxZQUNBLGVBQWUsa0JBQWtCLE9BQU8sZ0JBQWdCLE9BQU87QUFBQSxZQUMvRCxhQUFhO0FBQUEsVUFDZCxDQUFDO0FBQUEsUUFDRjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBRUEsV0FBTztBQUFBLE1BQ04sYUFBYSxLQUFLLGVBQWU7QUFBQSxNQUNqQztBQUFBLE1BQ0E7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNEOzs7QUNuU08sSUFBTSxtQkFBTixNQUF1QjtBQUFBLEVBQXZCO0FBRU47QUFBQSxTQUFpQixhQUFhO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUs5QixNQUFNLGdCQUFnQixZQUFzRDtBQUMzRSxRQUFJO0FBQ0gsWUFBTSxVQUFVLEtBQUssZ0JBQWdCLFVBQVU7QUFDL0MsVUFBSSxDQUFDLFNBQVM7QUFDYixlQUFPO0FBQUEsVUFDTixPQUFPO0FBQUEsVUFDUDtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBRUEsWUFBTSxrQkFBa0IsTUFBTSxLQUFLLHNCQUFzQixPQUFPO0FBQ2hFLFVBQUksaUJBQWlCO0FBQ3BCLGVBQU87QUFBQSxVQUNOLE9BQU87QUFBQSxVQUNQO0FBQUEsVUFDQSxPQUFPO0FBQUEsUUFDUjtBQUFBLE1BQ0Q7QUFFQSxhQUFPO0FBQUEsUUFDTixPQUFPO0FBQUEsUUFDUDtBQUFBLE1BQ0Q7QUFBQSxJQUNELFNBQVMsT0FBTztBQUNmLGFBQU87QUFBQSxRQUNOLE9BQU87QUFBQSxRQUNQO0FBQUEsTUFDRDtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxnQkFBZ0IsWUFBb0M7QUFDM0QsUUFBSTtBQUVILFlBQU0sVUFBVSxLQUFLLGFBQWEsVUFBVTtBQUM1QyxZQUFNLFFBQVEsUUFBUSxNQUFNLEdBQUc7QUFFL0IsVUFBSSxNQUFNLFdBQVcsR0FBRztBQUN2QixlQUFPO0FBQUEsTUFDUjtBQUVBLFlBQU0sQ0FBQyxPQUFPLE1BQU0sY0FBYyxhQUFhLFNBQVMsSUFBSTtBQUs1RCxZQUFNLFlBQVksaUJBQWlCLGFBQWEsT0FBTyxJQUFJLEtBQUssWUFBWTtBQUM1RSxZQUFNLFdBQVcsSUFBSSxLQUFLLFdBQVc7QUFHckMsVUFBSSxNQUFNLFNBQVMsUUFBUSxDQUFDLEdBQUc7QUFDOUIsZUFBTztBQUFBLE1BQ1I7QUFFQSxVQUFJLGFBQWEsTUFBTSxVQUFVLFFBQVEsQ0FBQyxHQUFHO0FBQzVDLGVBQU87QUFBQSxNQUNSO0FBRUEsYUFBTztBQUFBLFFBQ047QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDRDtBQUFBLElBQ0QsU0FBUyxPQUFPO0FBQ2YsYUFBTztBQUFBLElBQ1I7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxhQUFhLEtBQXFCO0FBQ3pDLFFBQUksT0FBTyxTQUFTLGFBQWE7QUFDaEMsYUFBTyxLQUFLLEdBQUc7QUFBQSxJQUNoQjtBQUVBLFdBQU8sT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFLFNBQVMsTUFBTTtBQUFBLEVBQ2xEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLUSxhQUFhLEtBQXFCO0FBQ3pDLFFBQUksT0FBTyxTQUFTLGFBQWE7QUFDaEMsYUFBTyxLQUFLLEdBQUc7QUFBQSxJQUNoQjtBQUVBLFdBQU8sT0FBTyxLQUFLLEtBQUssTUFBTSxFQUFFLFNBQVMsUUFBUTtBQUFBLEVBQ2xEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHNCQUFzQixTQUFnRDtBQUVuRixVQUFNLG9CQUFvQixNQUFNLEtBQUs7QUFBQSxNQUNwQyxRQUFRO0FBQUEsTUFDUjtBQUFBO0FBQUEsTUFDQSxRQUFRO0FBQUEsTUFDUixRQUFRO0FBQUEsSUFDVDtBQUVBLFFBQUksUUFBUSxjQUFjLG1CQUFtQjtBQUM1QztBQUFBLElBQ0Q7QUFHQSxRQUFJLFFBQVEsYUFBYSxvQkFBSSxLQUFLLElBQUksUUFBUSxXQUFXO0FBQ3hEO0FBQUEsSUFDRDtBQUdBLFFBQUksUUFBUSxXQUFXLG9CQUFJLEtBQUssR0FBRztBQUNsQztBQUFBLElBQ0Q7QUFFQSxXQUFPO0FBQUEsRUFDUjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxrQkFDYixPQUNBLE1BQ0EsV0FDQSxVQUNrQjtBQUNsQixVQUFNLE9BQU8sR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUM7QUFFakcsVUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxVQUFNLFVBQVUsUUFBUSxPQUFPLEtBQUssVUFBVTtBQUM5QyxVQUFNLGNBQWMsUUFBUSxPQUFPLElBQUk7QUFFdkMsVUFBTSxZQUFZLE1BQU0sT0FBTyxPQUFPO0FBQUEsTUFDckM7QUFBQSxNQUNBO0FBQUEsTUFDQSxFQUFFLE1BQU0sUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNoQztBQUFBLE1BQ0EsQ0FBQyxNQUFNO0FBQUEsSUFDUjtBQUVBLFVBQU0sWUFBWSxNQUFNLE9BQU8sT0FBTyxLQUFLLFFBQVEsV0FBVyxXQUFXO0FBQ3pFLFdBQU8sTUFBTSxLQUFLLElBQUksV0FBVyxTQUFTLENBQUMsRUFDekMsSUFBSSxPQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsU0FBUyxHQUFHLEdBQUcsQ0FBQyxFQUN4QyxLQUFLLEVBQUU7QUFBQSxFQUNWO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFNLGtCQUFrQixPQUFlLE1BQWMsZUFBZSxNQUF1QjtBQUMxRixVQUFNLFdBQVcsb0JBQUksS0FBSztBQUMxQixVQUFNLFlBQVksZUFBZSxPQUFPLElBQUksS0FBSyxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssS0FBSyxLQUFLLEdBQUk7QUFFdkYsVUFBTSxZQUFZLE1BQU0sS0FBSyxrQkFBa0IsT0FBTyxNQUFNLFdBQVcsUUFBUTtBQUUvRSxVQUFNLGNBQWMsR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUMsSUFBSSxTQUFTO0FBRXJILFdBQU8sS0FBSyxhQUFhLFdBQVc7QUFBQSxFQUNyQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSx5QkFBeUIsWUFBd0Q7QUFDdEYsUUFBSTtBQUNILFlBQU0sVUFBVSxLQUFLLHlCQUF5QixVQUFVO0FBQ3hELFVBQUksQ0FBQyxTQUFTO0FBQ2IsZUFBTztBQUFBLFVBQ04sT0FBTztBQUFBLFVBQ1A7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUVBLFlBQU0sa0JBQWtCLE1BQU0sS0FBSywrQkFBK0IsT0FBTztBQUN6RSxVQUFJLGlCQUFpQjtBQUNwQixlQUFPO0FBQUEsVUFDTixPQUFPO0FBQUEsVUFDUDtBQUFBLFVBQ0EsT0FBTztBQUFBLFFBQ1I7QUFBQSxNQUNEO0FBRUEsYUFBTztBQUFBLFFBQ04sT0FBTztBQUFBLFFBQ1A7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixhQUFPO0FBQUEsUUFDTixPQUFPO0FBQUEsUUFDUDtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EseUJBQXlCLFlBQTZDO0FBQzdFLFFBQUk7QUFFSCxZQUFNLFVBQVUsS0FBSyxhQUFhLFVBQVU7QUFDNUMsWUFBTSxRQUFRLFFBQVEsTUFBTSxHQUFHO0FBRS9CLFVBQUksTUFBTSxXQUFXLEdBQUc7QUFDdkIsZUFBTztBQUFBLE1BQ1I7QUFFQSxZQUFNLENBQUMsT0FBTyxNQUFNLGNBQWMsYUFBYSxTQUFTLElBQUk7QUFHNUQsVUFBSSxTQUFTLFlBQVksU0FBUyxZQUFZO0FBQzdDLGVBQU87QUFBQSxNQUNSO0FBR0EsWUFBTSxZQUFZLGlCQUFpQixhQUFhLE9BQU8sSUFBSSxLQUFLLFlBQVk7QUFDNUUsWUFBTSxXQUFXLElBQUksS0FBSyxXQUFXO0FBR3JDLFVBQUksTUFBTSxTQUFTLFFBQVEsQ0FBQyxHQUFHO0FBQzlCLGVBQU87QUFBQSxNQUNSO0FBRUEsVUFBSSxhQUFhLE1BQU0sVUFBVSxRQUFRLENBQUMsR0FBRztBQUM1QyxlQUFPO0FBQUEsTUFDUjtBQUVBLGFBQU87QUFBQSxRQUNOO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNEO0FBQUEsSUFDRCxTQUFTLE9BQU87QUFDZixhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQWMsK0JBQStCLFNBQXlEO0FBRXJHLFVBQU0sb0JBQW9CLE1BQU0sS0FBSztBQUFBLE1BQ3BDLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxJQUNUO0FBRUEsUUFBSSxRQUFRLGNBQWMsbUJBQW1CO0FBQzVDO0FBQUEsSUFDRDtBQUdBLFFBQUksUUFBUSxhQUFhLG9CQUFJLEtBQUssSUFBSSxRQUFRLFdBQVc7QUFDeEQ7QUFBQSxJQUNEO0FBR0EsUUFBSSxRQUFRLFdBQVcsb0JBQUksS0FBSyxHQUFHO0FBQ2xDO0FBQUEsSUFDRDtBQUVBLFdBQU87QUFBQSxFQUNSO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLDJCQUNiLE9BQ0EsTUFDQSxXQUNBLFVBQ2tCO0FBQ2xCLFVBQU0sT0FBTyxHQUFHLEtBQUssSUFBSSxJQUFJLEtBQUksdUNBQVcsa0JBQWlCLFVBQVUsSUFBSSxTQUFTLFlBQVksQ0FBQztBQUVqRyxVQUFNLFVBQVUsSUFBSSxZQUFZO0FBQ2hDLFVBQU0sVUFBVSxRQUFRLE9BQU8sS0FBSyxVQUFVO0FBQzlDLFVBQU0sY0FBYyxRQUFRLE9BQU8sSUFBSTtBQUV2QyxVQUFNLFlBQVksTUFBTSxPQUFPLE9BQU87QUFBQSxNQUNyQztBQUFBLE1BQ0E7QUFBQSxNQUNBLEVBQUUsTUFBTSxRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ2hDO0FBQUEsTUFDQSxDQUFDLE1BQU07QUFBQSxJQUNSO0FBRUEsVUFBTSxZQUFZLE1BQU0sT0FBTyxPQUFPLEtBQUssUUFBUSxXQUFXLFdBQVc7QUFDekUsV0FBTyxNQUFNLEtBQUssSUFBSSxXQUFXLFNBQVMsQ0FBQyxFQUN6QyxJQUFJLE9BQUssRUFBRSxTQUFTLEVBQUUsRUFBRSxTQUFTLEdBQUcsR0FBRyxDQUFDLEVBQ3hDLEtBQUssRUFBRTtBQUFBLEVBQ1Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE1BQU0sMkJBQTJCLE9BQWUsTUFBOEM7QUFDN0YsVUFBTSxXQUFXLG9CQUFJLEtBQUs7QUFDMUIsVUFBTSxZQUFZLFNBQVMsYUFBYSxPQUFPLElBQUksS0FBSyxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssS0FBSyxLQUFLLEdBQUk7QUFFOUYsVUFBTSxZQUFZLE1BQU0sS0FBSywyQkFBMkIsT0FBTyxNQUFNLFdBQVcsUUFBUTtBQUV4RixVQUFNLGNBQWMsR0FBRyxLQUFLLElBQUksSUFBSSxLQUFJLHVDQUFXLGtCQUFpQixVQUFVLElBQUksU0FBUyxZQUFZLENBQUMsSUFBSSxTQUFTO0FBRXJILFdBQU8sS0FBSyxhQUFhLFdBQVc7QUFBQSxFQUNyQztBQUNEOzs7QUNqVU8sSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBQXJCO0FBQ0gsU0FBUSx1QkFBdUI7QUFBQSxNQUMzQixFQUFFLFNBQVMsMERBQTBELE1BQU0sV0FBVztBQUFBLE1BQ3RGLEVBQUUsU0FBUyx1RUFBdUUsTUFBTSxpQkFBaUI7QUFBQSxNQUN6RyxFQUFFLFNBQVMsMkRBQTJELE1BQU0sYUFBYTtBQUFBLE1BQ3pGLEVBQUUsU0FBUyw2RUFBNkUsTUFBTSxzQkFBc0I7QUFBQSxNQUNwSCxFQUFFLFNBQVMsMERBQTBELE1BQU0sY0FBYztBQUFBLElBQzdGO0FBRUEsU0FBUSxrQkFBa0I7QUFBQSxNQUN0QixFQUFFLFNBQVMsZ0VBQWdFLE1BQU0sZUFBZTtBQUFBLE1BQ2hHLEVBQUUsU0FBUyx3SUFBd0ksTUFBTSxxQkFBcUI7QUFBQSxNQUM5SyxFQUFFLFNBQVMsOERBQThELE1BQU0scUJBQXFCO0FBQUEsTUFDcEcsRUFBRSxTQUFTLDZFQUE2RSxNQUFNLHFCQUFxQjtBQUFBLElBQ3ZIO0FBQUE7QUFBQSxFQUVBLGNBQWMsT0FBcUM7QUFDL0MsVUFBTSxzQkFBZ0MsQ0FBQztBQUN2QyxVQUFNLGlCQUEyQixDQUFDO0FBRWxDLGVBQVcsRUFBRSxTQUFTLEtBQUssS0FBSyxLQUFLLHNCQUFzQjtBQUN2RCxVQUFJLFFBQVEsS0FBSyxLQUFLLEdBQUc7QUFDckIsNEJBQW9CLEtBQUssSUFBSTtBQUFBLE1BQ2pDO0FBQUEsSUFDSjtBQUVBLGVBQVcsRUFBRSxTQUFTLEtBQUssS0FBSyxLQUFLLGlCQUFpQjtBQUNsRCxVQUFJLFFBQVEsS0FBSyxLQUFLLEdBQUc7QUFDckIsdUJBQWUsS0FBSyxJQUFJO0FBQUEsTUFDNUI7QUFBQSxJQUNKO0FBR0EsUUFBSSxvQkFBb0IsU0FBUyxLQUFLLGVBQWUsV0FBVyxHQUFHO0FBQy9ELGFBQU87QUFBQSxRQUNILE1BQU07QUFBQSxRQUNOLFlBQVk7QUFBQSxRQUNaLGlCQUFpQjtBQUFBLE1BQ3JCO0FBQUEsSUFDSjtBQUdBLFFBQUksZUFBZSxTQUFTLEtBQUssb0JBQW9CLFdBQVcsR0FBRztBQUMvRCxhQUFPO0FBQUEsUUFDSCxNQUFNO0FBQUEsUUFDTixZQUFZO0FBQUEsUUFDWixpQkFBaUI7QUFBQSxNQUNyQjtBQUFBLElBQ0o7QUFHQSxRQUFJLG9CQUFvQixTQUFTLEtBQUssZUFBZSxTQUFTLEdBQUc7QUFDN0QsWUFBTSxpQkFBaUIsb0JBQW9CLFNBQVMsYUFBYSxLQUFLLG9CQUFvQixTQUFTLHFCQUFxQjtBQUN4SCxVQUFJLGdCQUFnQjtBQUNoQixlQUFPO0FBQUEsVUFDSCxNQUFNO0FBQUEsVUFDTixZQUFZO0FBQUEsVUFDWixpQkFBaUI7QUFBQSxRQUNyQjtBQUFBLE1BQ0o7QUFBQSxJQUVKO0FBRUEsV0FBTztBQUFBLE1BQ0gsTUFBTTtBQUFBLE1BQ04sWUFBWTtBQUFBLE1BQ1osaUJBQWlCLENBQUM7QUFBQSxJQUN0QjtBQUFBLEVBQ0o7QUFDSjs7O0FDakVPLElBQU0scUJBQU4sTUFBeUI7QUFBQSxFQUc1QixZQUNZLGlCQUNWO0FBRFU7QUFFUixTQUFLLGlCQUFpQixJQUFJLGVBQWU7QUFBQSxFQUM3QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBTSxlQUFlLFdBQW1CLGVBQXdCLE9BQTRCO0FBRXhGLFFBQUksVUFBVSxXQUFXLEdBQUcsR0FBRztBQUUzQixhQUFPO0FBQUEsSUFDWDtBQUlBLFdBQU8sS0FBSyx1QkFBdUIsU0FBUztBQUFBLEVBa0NoRDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1EsdUJBQXVCLFdBQStCO0FBQzFELFVBQU0sYUFBYSxVQUFVLFlBQVksRUFBRSxLQUFLO0FBR2hELFFBQUksV0FBVyxTQUFTLEdBQUcsS0FDdkIsV0FBVyxXQUFXLE1BQU0sS0FDNUIsV0FBVyxXQUFXLEtBQUssS0FDM0IsV0FBVyxXQUFXLEtBQUssS0FDM0IsV0FBVyxXQUFXLE1BQU0sS0FDNUIsV0FBVyxXQUFXLE9BQU8sS0FDN0IsV0FBVyxXQUFXLEtBQUssS0FDM0IsV0FBVyxXQUFXLFNBQVMsS0FDL0IsV0FBVyxXQUFXLFdBQVcsS0FDakMsV0FBVyxTQUFTLFNBQVMsS0FDN0IsV0FBVyxTQUFTLG9CQUFvQixHQUFHO0FBQzNDLGFBQU87QUFBQSxJQUNYO0FBR0EsVUFBTSx1QkFBdUIsS0FBSyxlQUFlLGNBQWMsU0FBUztBQUd4RSxRQUFJLHFCQUFxQixTQUFTLGdCQUFnQjtBQUM5QyxhQUFPO0FBQUEsSUFDWDtBQUVBLFFBQUkscUJBQXFCLFNBQVMsV0FBVztBQUV6QyxVQUFJLEtBQUssa0JBQWtCLFVBQVUsR0FBRztBQUNwQyxlQUFPO0FBQUEsTUFDWDtBQUNBLGFBQU87QUFBQSxJQUNYO0FBR0EsUUFBSSxLQUFLLGtCQUFrQixVQUFVLEdBQUc7QUFDcEMsYUFBTztBQUFBLElBQ1g7QUFHQSxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS1Esa0JBQWtCLFlBQTZCO0FBQ25EO0FBQUE7QUFBQSxNQUVJLGFBQWEsS0FBSyxVQUFVLEtBQzVCLGVBQWUsS0FBSyxVQUFVO0FBQUEsTUFFOUIsc0RBQXNELEtBQUssVUFBVTtBQUFBLE1BRXJFLGtEQUFrRCxLQUFLLFVBQVU7QUFBQSxNQUVqRSwyRUFBMkUsS0FBSyxVQUFVO0FBQUE7QUFBQSxFQUVsRztBQUNKOzs7QXJDM0dBLElBQU1DLGlCQUFnQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBa0J0QixJQUFxQixhQUFyQixjQUF3Qyx5QkFBTztBQUFBLEVBcUI5QyxNQUFNLFNBQVM7QUFDZCxRQUFJO0FBQ0gsWUFBTSxLQUFLLGFBQWE7QUFJeEIsV0FBSyxtQkFBbUIsSUFBSSxpQkFBaUI7QUFDN0MsV0FBSyxpQkFBaUIsSUFBSTtBQUFBLFFBQ3pCLEtBQUs7QUFBQSxRQUNMLEtBQUssU0FBUyxVQUFVO0FBQUEsTUFDekI7QUFHQSxVQUFJLEtBQUssU0FBUyxVQUFVLFlBQVk7QUFDdkMsY0FBTSxLQUFLLGVBQWUsdUJBQXVCLEtBQUssU0FBUyxVQUFVLFVBQVU7QUFBQSxNQUNwRjtBQUdBLFdBQUssSUFBSSxVQUFVLGNBQWMsWUFBWTtBQUM1QyxjQUFNLFNBQVMsS0FBSyxJQUFJLFVBQVUsZ0JBQWdCLHNCQUFzQjtBQUN4RSxZQUFJLE9BQU8sU0FBUyxHQUFHO0FBQ3RCLGdCQUFNLGNBQWMsT0FBTyxDQUFDLEVBQUU7QUFDOUIsc0JBQVksbUJBQW1CO0FBRS9CLGdCQUFNLFlBQVksd0JBQXdCO0FBQUEsUUFDM0M7QUFBQSxNQUNELENBQUM7QUFNRCxxQ0FBUSxhQUFhQSxjQUFhO0FBRWxDLFdBQUssb0JBQW9CLElBQUksa0JBQWtCLEtBQUssVUFBVSxLQUFLLGNBQWM7QUFDakYsWUFBTSxLQUFLLGtCQUFrQixXQUFXO0FBR3hDLFlBQU0sWUFBWTtBQUFBLFFBQ2pCLFVBQVUsQ0FBQyxRQUFnQixLQUFLLGdCQUFnQixHQUFHO0FBQUEsUUFDbkQsVUFBVSxDQUFDLEtBQWEsU0FBYyxLQUFLLGdCQUFnQixLQUFLLElBQUk7QUFBQSxNQUNyRTtBQUNBLFdBQUssc0JBQXNCLElBQUksb0JBQW9CLFNBQVM7QUFDNUQsV0FBSyxpQkFBaUIsSUFBSSxlQUFlLEtBQUssS0FBSyxTQUFTO0FBQzVELFdBQUssZUFBZSx1QkFBdUIsS0FBSyxtQkFBbUI7QUFDbkUsV0FBSyxpQkFBaUIsSUFBSSxlQUFlLEtBQUssUUFBUTtBQUN0RCxXQUFLLGdCQUFnQixJQUFJLGNBQWM7QUFDdkMsV0FBSyxnQkFBZ0IsSUFBSSxjQUFjLEtBQUssZ0JBQWdCLEtBQUssbUJBQW1CO0FBQ3BGLFdBQUsscUJBQXFCLElBQUksbUJBQW1CLEtBQUssaUJBQWlCO0FBR3ZFLFdBQUssb0JBQW9CLElBQUksV0FBVyxLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDbEgsV0FBSyxxQkFBcUIsSUFBSSxZQUFZLEtBQUssS0FBSyxLQUFLLGdCQUFnQixLQUFLLGdCQUFnQixLQUFLLGlCQUFpQjtBQUNwSCxXQUFLLHVCQUF1QixJQUFJLGNBQWMsS0FBSyxLQUFLLEtBQUssZ0JBQWdCLEtBQUssZ0JBQWdCLEtBQUssaUJBQWlCO0FBQ3hILFdBQUssd0JBQXdCLElBQUksZUFBZSxLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFDMUgsV0FBSyx3QkFBd0IsSUFBSSxlQUFlLEtBQUssS0FBSyxLQUFLLGdCQUFnQixLQUFLLGdCQUFnQixLQUFLLGlCQUFpQjtBQUMxSCxXQUFLLHlCQUF5QixJQUFJLGdCQUFnQixLQUFLLEtBQUssS0FBSyxnQkFBZ0IsS0FBSyxnQkFBZ0IsS0FBSyxpQkFBaUI7QUFFNUgsV0FBSztBQUFBLFFBQ0o7QUFBQSxRQUNBLENBQUMsU0FBUyxJQUFJLGdCQUFnQixNQUFNLElBQUk7QUFBQSxNQUN6QztBQUlBLFlBQU0sYUFBYSxLQUFLLGNBQWMsYUFBYSxXQUFXLENBQUMsUUFBb0I7QUFDbEYsYUFBSyxhQUFhO0FBQUEsTUFDbkIsQ0FBQztBQUdELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sV0FBbUI7QUFDekMsZ0JBQU0sS0FBSyx1QkFBdUIsV0FBVyxNQUFNO0FBQUEsUUFDcEQ7QUFBQSxNQUNELENBQUM7QUFFRCxXQUFLLFdBQVc7QUFBQSxRQUNmLElBQUk7QUFBQSxRQUNKLE1BQU07QUFBQSxRQUNOLGdCQUFnQixPQUFPLFdBQW1CO0FBQ3pDLGdCQUFNLEtBQUssdUJBQXVCLFVBQVUsTUFBTTtBQUFBLFFBQ25EO0FBQUEsTUFDRCxDQUFDO0FBRUQsV0FBSyxXQUFXO0FBQUEsUUFDZixJQUFJO0FBQUEsUUFDSixNQUFNO0FBQUEsUUFDTixnQkFBZ0IsT0FBTyxXQUFtQjtBQUN6QyxnQkFBTSxLQUFLLHVCQUF1QixXQUFXLE1BQU07QUFBQSxRQUNwRDtBQUFBLE1BQ0QsQ0FBQztBQUdELG1CQUFhLFFBQVEsVUFBUTtBQUM1QixhQUFLLFdBQVc7QUFBQSxVQUNmLElBQUksYUFBYSxLQUFLLEVBQUU7QUFBQSxVQUN4QixNQUFNLFFBQVEsS0FBSyxLQUFLO0FBQUEsVUFDeEIsZ0JBQWdCLE9BQU8sV0FBbUI7QUFDekMsa0JBQU0sS0FBSyxrQkFBa0IsS0FBSyxJQUFJLE1BQU07QUFBQSxVQUM3QztBQUFBLFFBQ0QsQ0FBQztBQUFBLE1BQ0YsQ0FBQztBQUVELFdBQUssV0FBVztBQUFBLFFBQ2YsSUFBSTtBQUFBLFFBQ0osTUFBTTtBQUFBLFFBQ04sZ0JBQWdCLE9BQU8sV0FBbUI7QUFDekMsZ0JBQU0sS0FBSyx1QkFBdUIsVUFBVSxNQUFNO0FBQUEsUUFDbkQ7QUFBQSxNQUNELENBQUM7QUFFRCxXQUFLLFdBQVc7QUFBQSxRQUNmLElBQUk7QUFBQSxRQUNKLE1BQU07QUFBQSxRQUNOLFVBQVUsTUFBTTtBQUNmLGVBQUssYUFBYTtBQUFBLFFBQ25CO0FBQUEsTUFDRCxDQUFDO0FBR0QsV0FBSyx1QkFBdUIsSUFBSSxxQkFBcUIsS0FBSyxLQUFLLElBQUk7QUFDbkUsV0FBSyxxQkFBcUIsU0FBUztBQUVuQyxXQUFLLGFBQWEsSUFBSSxlQUFlLEtBQUssS0FBSyxJQUFJO0FBQ3BELFdBQUssY0FBYyxLQUFLLFVBQVU7QUFBQSxJQUNsQyxTQUFTLE9BQU87QUFBQSxJQUNoQjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLFdBQVc7QUFoTVo7QUFpTUUsZUFBSyxzQkFBTCxtQkFBd0I7QUFDeEIsZUFBSyx3QkFBTCxtQkFBMEI7QUFBQSxFQUMzQjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBck10QjtBQXNNRSxVQUFNLFlBQVksTUFBTSxLQUFLLFNBQVM7QUFDdEMsWUFBUSxJQUFJLHFDQUE4QjtBQUMxQyxZQUFRLElBQUksZ0NBQXlCLFNBQVM7QUFDOUMsWUFBUSxJQUFJLDBDQUFtQyx1Q0FBVyxnQkFBZ0I7QUFFMUUsU0FBSSw0Q0FBVyxxQkFBWCxtQkFBNkIsU0FBUztBQUN6QyxjQUFRLElBQUksNENBQXFDLFVBQVUsaUJBQWlCLFFBQVEsZUFBZTtBQUFBLElBQ3BHO0FBRUEsWUFBUSxJQUFJLHVDQUFnQyxpQkFBaUIsZ0JBQWdCO0FBRzdFLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixTQUFTO0FBRzdELFFBQUksdUNBQVcsa0JBQWtCO0FBQ2hDLGNBQVEsSUFBSSwyREFBb0QsaUJBQWlCLGlCQUFpQixRQUFRLGFBQWE7QUFDdkgsY0FBUSxJQUFJLDBEQUFrRCxlQUFVLGlCQUFpQixZQUEzQixtQkFBb0MsYUFBYTtBQUUvRyxXQUFLLFNBQVMsbUJBQW1CO0FBQUEsUUFDaEMsU0FBUyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGlCQUFpQixpQkFBaUIsU0FBUyxVQUFVLGlCQUFpQixXQUFXLENBQUMsQ0FBQztBQUFBLFFBQzlHLFFBQVEsT0FBTyxPQUFPLENBQUMsR0FBRyxpQkFBaUIsaUJBQWlCLFFBQVEsVUFBVSxpQkFBaUIsVUFBVSxDQUFDLENBQUM7QUFBQSxNQUM1RztBQUVBLGNBQVEsSUFBSSx3REFBaUQsS0FBSyxTQUFTLGlCQUFpQixRQUFRLGFBQWE7QUFBQSxJQUNsSDtBQUVBLFlBQVEsSUFBSSw0Q0FBcUMsS0FBSyxTQUFTLGdCQUFnQjtBQUMvRSxZQUFRLElBQUksK0JBQXdCLDJCQUFTLFdBQVcsV0FBVyxTQUFTO0FBQzVFLFlBQVEsSUFBSSxrREFBMkMsS0FBSyxTQUFTLGlCQUFpQiwyQkFBUyxXQUFXLFdBQVcsU0FBUyxFQUFFLGFBQWE7QUFBQSxFQUM5STtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTVEsVUFBVSxRQUFhLFFBQWtCO0FBQ2hELFFBQUksQ0FBQyxPQUFRLFFBQU87QUFFcEIsVUFBTSxTQUFTLEVBQUUsR0FBRyxPQUFPO0FBRTNCLGVBQVcsT0FBTyxRQUFRO0FBQ3pCLFVBQUksT0FBTyxlQUFlLEdBQUcsR0FBRztBQUMvQixZQUFJLE9BQU8sR0FBRyxLQUFLLE9BQU8sT0FBTyxHQUFHLE1BQU0sWUFBWSxDQUFDLE1BQU0sUUFBUSxPQUFPLEdBQUcsQ0FBQyxHQUFHO0FBQ2xGLGlCQUFPLEdBQUcsSUFBSSxLQUFLLFVBQVUsT0FBTyxHQUFHLEtBQUssQ0FBQyxHQUFHLE9BQU8sR0FBRyxDQUFDO0FBQUEsUUFDNUQsT0FBTztBQUNOLGlCQUFPLEdBQUcsSUFBSSxPQUFPLEdBQUc7QUFBQSxRQUN6QjtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBRUEsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQTVQdEI7QUE2UEUsWUFBUSxJQUFJLG9DQUE2QjtBQUN6QyxZQUFRLElBQUksK0JBQXdCLDJCQUFTLFdBQVcsV0FBVyxTQUFTO0FBQzVFLFlBQVEsSUFBSSw0Q0FBcUMsS0FBSyxTQUFTLGdCQUFnQjtBQUMvRSxZQUFRLElBQUksZ0RBQXlDLEtBQUssU0FBUyxpQkFBaUIsUUFBUSxhQUFhO0FBQ3pHLFlBQVEsSUFBSSwrQ0FBd0MsS0FBSyxTQUFTLGlCQUFpQixPQUFPLGFBQWE7QUFFdkcsUUFBSTtBQUVILFlBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUNqQyxjQUFRLElBQUksc0NBQStCO0FBRzNDLFlBQU0sSUFBSSxRQUFRLGFBQVcsV0FBVyxTQUFTLEdBQUcsQ0FBQztBQUNyRCxZQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFDakMsY0FBUSxJQUFJLHVDQUFnQztBQUc1QyxZQUFNLElBQUksUUFBUSxhQUFXLFdBQVcsU0FBUyxHQUFHLENBQUM7QUFHckQsWUFBTSxXQUFXLE1BQU0sS0FBSyxTQUFTO0FBQ3JDLGNBQVEsSUFBSSx5REFBaUQsZ0RBQVUscUJBQVYsbUJBQTRCLFlBQTVCLG1CQUFxQyxhQUFhO0FBQy9HLGNBQVEsSUFBSSx3REFBZ0QsZ0RBQVUscUJBQVYsbUJBQTRCLFdBQTVCLG1CQUFvQyxhQUFhO0FBRzdHLFlBQU0sa0JBQWtCLDJCQUFTLFdBQVcsV0FBVztBQUN2RCxZQUFNLGdCQUFnQixLQUFLLFNBQVMsaUJBQWlCLGVBQWUsRUFBRTtBQUN0RSxZQUFNLGVBQWMsZ0RBQVUscUJBQVYsbUJBQTZCLHFCQUE3QixtQkFBK0M7QUFFbkUsVUFBSSxrQkFBa0IsYUFBYTtBQUNsQyxnQkFBUSxNQUFNLHNEQUFpRDtBQUFBLFVBQzlELFVBQVU7QUFBQSxVQUNWLFFBQVE7QUFBQSxVQUNSLFVBQVU7QUFBQSxRQUNYLENBQUM7QUFHRCxnQkFBUSxJQUFJLHFDQUE4QjtBQUMxQyxjQUFNLEtBQUssU0FBUyxLQUFLLE1BQU0sS0FBSyxVQUFVLEtBQUssUUFBUSxDQUFDLENBQUM7QUFDN0QsY0FBTSxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsR0FBRyxDQUFDO0FBRXJELGNBQU0sYUFBYSxNQUFNLEtBQUssU0FBUztBQUN2QyxjQUFNLGVBQWMsb0RBQVkscUJBQVosbUJBQStCLHFCQUEvQixtQkFBaUQ7QUFDckUsWUFBSSxrQkFBa0IsYUFBYTtBQUNsQyxrQkFBUSxJQUFJLDhCQUF5QjtBQUFBLFFBQ3RDLE9BQU87QUFDTixrQkFBUSxNQUFNLG1DQUE4QixFQUFFLFlBQVksQ0FBQztBQUFBLFFBQzVEO0FBQUEsTUFDRCxPQUFPO0FBQ04sZ0JBQVEsSUFBSSxxQ0FBZ0M7QUFBQSxNQUM3QztBQUVBLGlCQUFLLHNCQUFMLG1CQUF3QixlQUFlLEtBQUs7QUFDNUMsY0FBUSxJQUFJLHVDQUFnQztBQUFBLElBQzdDLFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSx1Q0FBa0MsS0FBSztBQUNyRCxZQUFNO0FBQUEsSUFDUDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNwQixVQUFNLEVBQUUsVUFBVSxJQUFJLEtBQUs7QUFFM0IsUUFBSTtBQUNKLFVBQU0sU0FBUyxVQUFVLGdCQUFnQixzQkFBc0I7QUFFL0QsUUFBSSxPQUFPLFNBQVMsR0FBRztBQUN0QixhQUFPLE9BQU8sQ0FBQztBQUFBLElBQ2hCLE9BQU87QUFDTixhQUFPLFVBQVUsYUFBYSxLQUFLO0FBQ25DLGFBQU0sNkJBQU0sYUFBYSxFQUFFLE1BQU0sd0JBQXdCLFFBQVEsS0FBSztBQUFBLElBQ3ZFO0FBRUEsY0FBVSxXQUFXLElBQUs7QUFHMUIsU0FBSSw2QkFBTSxpQkFBZ0IsaUJBQWlCO0FBQzFDLFdBQUssY0FBYyxLQUFLO0FBQUEsSUFDekI7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLHVCQUF1QixVQUFrQixRQUErQjtBQUNyRixRQUFJO0FBQ0gsWUFBTSxlQUFlLE9BQU8sYUFBYTtBQUN6QyxVQUFJLENBQUMsZ0JBQWdCLGFBQWEsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUN0RCxZQUFJLHlCQUFPLCtCQUErQjtBQUMxQztBQUFBLE1BQ0Q7QUFFQSxZQUFNLEtBQUsscUJBQXFCLHNCQUFzQixVQUFVLFFBQVEsWUFBWTtBQUFBLElBQ3JGLFNBQVMsT0FBTztBQUNmLGNBQVEsTUFBTSwyQ0FBMkMsS0FBSztBQUM5RCxVQUFJLHlCQUFPLG9EQUFvRCxHQUFJO0FBQUEsSUFDcEU7QUFBQSxFQUNEO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxNQUFjLGtCQUFrQixRQUFnQixRQUErQjtBQUM5RSxRQUFJO0FBQ0gsWUFBTSxlQUFlLE9BQU8sYUFBYTtBQUN6QyxVQUFJLENBQUMsZ0JBQWdCLGFBQWEsS0FBSyxFQUFFLFdBQVcsR0FBRztBQUN0RCxZQUFJLHlCQUFPLCtCQUErQjtBQUMxQztBQUFBLE1BQ0Q7QUFHQSxZQUFNLEtBQUsscUJBQXFCLHNCQUFzQixRQUFRLFFBQVEsY0FBYyxNQUFNO0FBQUEsSUFDM0YsU0FBUyxPQUFPO0FBQ2YsY0FBUSxNQUFNLHNDQUFzQyxLQUFLO0FBQ3pELFVBQUkseUJBQU8sb0RBQW9ELEdBQUk7QUFBQSxJQUNwRTtBQUFBLEVBQ0Q7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1RLDBCQUFnQztBQUN2QyxVQUFNLFFBQVEsU0FBUyxjQUFjLEtBQUs7QUFDMUMsVUFBTSxZQUFZO0FBQ2xCLFVBQU0sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBaUNsQixVQUFNLGFBQWEsTUFBTSxjQUFjLG1CQUFtQjtBQUMxRCxVQUFNLFdBQVcsTUFBTSxjQUFjLGlCQUFpQjtBQUN0RCxVQUFNLFVBQVUsTUFBTSxjQUFjLFdBQVc7QUFFL0MsVUFBTSxhQUFhLE1BQU07QUFDeEIsWUFBTSxPQUFPO0FBQUEsSUFDZDtBQUVBLGVBQVcsaUJBQWlCLFNBQVMsTUFBTTtBQUMxQyxhQUFPLEtBQUssaUNBQWlDLFFBQVE7QUFDckQsaUJBQVc7QUFBQSxJQUNaLENBQUM7QUFFRCxhQUFTLGlCQUFpQixTQUFTLFVBQVU7QUFDN0MsWUFBUSxpQkFBaUIsU0FBUyxVQUFVO0FBRTVDLGFBQVMsS0FBSyxZQUFZLEtBQUs7QUFHL0IsUUFBSSx5QkFBTyxpREFBaUQsR0FBSTtBQUFBLEVBQ2pFO0FBQUE7QUFBQSxFQUdBLE1BQU0sZ0JBQWdCLEtBQTJCO0FBQ2hELFVBQU0sVUFBVSxNQUFNLEtBQUssU0FBUztBQUNwQyxXQUFPLFVBQVUsUUFBUSxHQUFHLElBQUk7QUFBQSxFQUNqQztBQUFBLEVBRUEsTUFBTSxnQkFBZ0IsS0FBYSxNQUEwQjtBQUM1RCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVMsS0FBSyxDQUFDO0FBQzFDLFlBQVEsR0FBRyxJQUFJO0FBQ2YsV0FBTyxNQUFNLEtBQUssU0FBUyxPQUFPO0FBQUEsRUFDbkM7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZXhpc3RpbmciLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicHJvbXB0IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAicHJvbXB0IiwgInNlbmRCdXR0b24iLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgImkiLCAicHJvbXB0IiwgImlzU3VwZXJub3ZhIiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgInZpZXciLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgIm5ld0Zyb250bWF0dGVyIiwgIk5PVkFfSUNPTl9TVkciXQp9Cg==
