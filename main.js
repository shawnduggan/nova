/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => NovaPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian15 = require("obsidian");

// src/settings.ts
var import_obsidian12 = require("obsidian");

// src/ui/sidebar-view.ts
var import_obsidian10 = require("obsidian");

// src/core/document-analysis.ts
var DocumentAnalyzer = class {
  static analyzeStructure(content) {
    const lines = content.split("\n");
    const headings = [];
    const emptyHeadings = [];
    const incompleteBullets = [];
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i].trim();
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        const hasContent = this.hasContentAfterHeading(lines, i);
        const isEmpty = !hasContent;
        headings.push({ level, text, isEmpty });
        if (isEmpty) {
          emptyHeadings.push(text);
        }
      }
      if (line.match(/^[-*+]\s*(.*)\.\.\.?\s*$/) || line.match(/^[-*+]\s*$/) || line.match(/^[-*+]\s*(TODO|TBD)/i)) {
        incompleteBullets.push(line);
      }
    }
    const wordCount = content.split(/\s+/).filter((word) => word.length > 0).length;
    return {
      headings,
      wordCount,
      emptyHeadings,
      incompleteBullets
    };
  }
  static hasContentAfterHeading(lines, headingIndex) {
    var _a;
    const currentHeading = lines[headingIndex].trim();
    const currentLevel = ((_a = currentHeading.match(/^(#{1,6})/)) == null ? void 0 : _a[1].length) || 0;
    for (let i = headingIndex + 1; i < lines.length; i++) {
      const line = lines[i].trim();
      const headingMatch = line.match(/^(#{1,6})\s/);
      if (headingMatch) {
        const nextLevel = headingMatch[1].length;
        if (nextLevel <= currentLevel) {
          return false;
        }
      }
      if (line.length > 0) return true;
    }
    return false;
  }
};

// src/ai/models.ts
function getProviderTypeForModel(modelName, settings) {
  const providerTypes = ["claude", "openai", "google", "ollama"];
  for (const providerType of providerTypes) {
    const models = getAvailableModels(providerType, settings);
    const foundModel = models.find((m) => m.value === modelName);
    if (foundModel) {
      return providerType;
    }
  }
  return null;
}
function getAvailableModels(providerType, settings) {
  var _a, _b;
  switch (providerType) {
    case "claude":
      return [
        { value: "claude-opus-4-20250514", label: "Claude Opus 4" },
        { value: "claude-sonnet-4-20250514", label: "Claude Sonnet 4" },
        { value: "claude-3-7-sonnet-latest", label: "Claude 3.7 Sonnet" },
        { value: "claude-3-5-sonnet-latest", label: "Claude 3.5 Sonnet" },
        { value: "claude-3-5-haiku-latest", label: "Claude 3.5 Haiku" }
      ];
    case "openai":
      return [
        { value: "gpt-4.1-2025-04-14", label: "GPT-4.1" },
        { value: "gpt-4.1-mini-2025-04-14", label: "GPT-4.1 Mini" },
        { value: "gpt-4.1-nano-2025-04-14", label: "GPT-4.1 Nano" },
        { value: "o4-mini-2025-04-16", label: "o4 Mini" },
        { value: "o3-mini-2025-01-31", label: "o3 Mini" },
        { value: "o3-2025-04-16", label: "o3" },
        { value: "o1-2024-12-17", label: "o1" },
        { value: "gpt-4o", label: "GPT-4o" },
        { value: "gpt-4o-mini", label: "GPT-4o Mini" }
      ];
    case "google":
      return [
        { value: "gemini-2.5-pro", label: "Gemini 2.5 Pro" },
        { value: "gemini-2.5-flash", label: "Gemini 2.5 Flash" },
        { value: "gemini-2.5-flash-lite-preview-06-17", label: "Gemini 2.5 Flash-Lite" }
      ];
    case "ollama":
      const ollamaModel = (_b = (_a = settings == null ? void 0 : settings.aiProviders) == null ? void 0 : _a.ollama) == null ? void 0 : _b.model;
      if (ollamaModel && ollamaModel.trim()) {
        return [{ value: ollamaModel, label: ollamaModel }];
      }
      return [];
    default:
      return [];
  }
}

// src/ui/input-handler.ts
var import_obsidian2 = require("obsidian");

// src/ui/wikilink-suggest.ts
var import_obsidian = require("obsidian");
var NovaWikilinkAutocomplete = class {
  constructor(app, textArea, container) {
    // Reference to NovaSidebarView
    this.lastTriggerPos = -1;
    this.app = app;
    this.textArea = textArea;
    this.setupEventListeners();
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  setupEventListeners() {
    this.textArea.addEventListener("input", this.handleInput.bind(this));
  }
  handleInput() {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch && cursorPos !== this.lastTriggerPos) {
      this.lastTriggerPos = cursorPos;
      this.showNativeFileModal();
    }
  }
  showNativeFileModal() {
    var _a;
    const currentFile = ((_a = this.sidebarView) == null ? void 0 : _a.currentFile) || this.app.workspace.getActiveFile();
    const modal = new WikilinkFileModal(
      this.app,
      async (file) => {
        await this.selectFile(file);
      },
      () => {
        this.lastTriggerPos = -1;
      },
      currentFile
    );
    modal.open();
  }
  async selectFile(file) {
    const text = this.textArea.value;
    const cursorPos = this.textArea.selectionStart;
    const beforeCursor = text.substring(0, cursorPos);
    const linkMatch = beforeCursor.match(/\[\[([^\]]*?)$/);
    if (linkMatch) {
      const startPos = cursorPos - linkMatch[0].length;
      const newText = text.substring(0, startPos) + text.substring(cursorPos);
      this.textArea.value = newText;
      this.textArea.setSelectionRange(startPos, startPos);
      this.textArea.dispatchEvent(new Event("input", { bubbles: true }));
    }
    if (this.sidebarView && this.sidebarView.addFilesToContext) {
      await this.sidebarView.addFilesToContext([file.basename]);
    }
    this.lastTriggerPos = -1;
    this.textArea.focus();
  }
  destroy() {
  }
};
var WikilinkFileModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(app, onSelect, onCancel, currentFile) {
    super(app);
    this.allFiles = [];
    this.onSelectCallback = onSelect;
    this.onCancelCallback = onCancel;
    this.currentFile = currentFile || null;
    this.setPlaceholder("Search files to add to context...");
    this.loadFiles();
  }
  onOpen() {
    super.onOpen();
    this.addInstructions();
  }
  addInstructions() {
    const instructionsEl = this.modalEl.createDiv({ cls: "prompt-instructions" });
    const navInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    navInstruction.createSpan({ cls: "prompt-instruction-command", text: "\u2191\u2193" });
    navInstruction.createSpan({ text: "to navigate" });
    const useInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    useInstruction.createSpan({ cls: "prompt-instruction-command", text: "\u21B5" });
    useInstruction.createSpan({ text: "to use" });
    const escInstruction = instructionsEl.createDiv({ cls: "prompt-instruction" });
    escInstruction.createSpan({ cls: "prompt-instruction-command", text: "esc" });
    escInstruction.createSpan({ text: "to dismiss" });
  }
  loadFiles() {
    this.allFiles = this.app.vault.getMarkdownFiles();
    if (this.currentFile) {
      this.allFiles = this.allFiles.filter((file) => file.path !== this.currentFile.path);
    }
    this.allFiles.sort((a, b) => b.stat.mtime - a.stat.mtime);
  }
  getItems() {
    return this.allFiles;
  }
  getItemText(file) {
    return file.basename;
  }
  onChooseItem(file) {
    this.onSelectCallback(file);
  }
  renderSuggestion(match, el) {
    const file = match.item;
    const container = el.createDiv({ cls: "suggestion-content" });
    const title = container.createDiv({ cls: "suggestion-title" });
    title.textContent = file.basename;
    const aux = container.createDiv({ cls: "suggestion-aux" });
    aux.textContent = file.path;
  }
  onClose() {
    super.onClose();
    if (this.onCancelCallback) {
      this.onCancelCallback();
    }
  }
};

// src/ui/input-handler.ts
var _InputHandler = class _InputHandler {
  constructor(plugin, container, contextManager) {
    this.dropZoneOverlay = null;
    this.isDragging = false;
    // Reference to NovaSidebarView for context operations
    // Event cleanup tracking
    this.eventListeners = [];
    this.plugin = plugin;
    this.container = container;
    this.contextManager = contextManager;
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.setSidebarView(sidebarView);
    }
  }
  setCommandSystem(commandSystem) {
    this.commandSystem = commandSystem;
    const sendButtonEl = this.sendButton.buttonEl;
    sendButtonEl.remove();
    this.commandSystem.createCommandButton(this.inputRow);
    this.inputRow.appendChild(sendButtonEl);
    this.commandSystem.createCommandPickerInContainer(this.inputRow);
  }
  getTextArea() {
    return this.textArea;
  }
  createInputInterface(chatContainer) {
    this.container = this.container.createDiv({ cls: "nova-input-container" });
    this.container.style.cssText = `
			flex-shrink: 0;
			padding: var(--size-4-3);
			border-top: 1px solid var(--background-modifier-border);
			position: relative;
		`;
    this.inputRow = this.container.createDiv({ cls: "nova-input-row" });
    this.inputRow.style.cssText = `
			display: flex;
			gap: var(--size-2-3);
			align-items: center;
			position: relative;
		`;
    const textAreaContainer = this.inputRow.createDiv();
    textAreaContainer.style.cssText = "flex: 1; position: relative;";
    this.textArea = new import_obsidian2.TextAreaComponent(textAreaContainer);
    this.textArea.setPlaceholder("How can I help?");
    this.textArea.inputEl.style.cssText = `
			max-height: 200px;
			resize: none;
			overflow-y: auto;
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			border: 1px solid var(--background-modifier-border);
			background: var(--background-primary);
			color: var(--text-normal);
			font-family: var(--font-interface);
			line-height: 1.4;
			width: 100%;
			box-sizing: border-box;
		`;
    this.autoGrowTextarea = () => {
      const textarea = this.textArea.inputEl;
      textarea.style.height = "auto";
      textarea.style.height = Math.min(textarea.scrollHeight, 200) + "px";
    };
    this.addEventListener(this.textArea.inputEl, "input", this.autoGrowTextarea);
    setTimeout(this.autoGrowTextarea, 0);
    this.wikilinkAutocomplete = new NovaWikilinkAutocomplete(this.plugin.app, this.textArea.inputEl, this.inputRow);
    if (this.sidebarView) {
      this.wikilinkAutocomplete.setSidebarView(this.sidebarView);
    }
    this.addEventListener(this.textArea.inputEl, "input", () => {
      this.contextManager.updateLiveContextPreview(this.textArea.getValue());
    });
    this.sendButton = new import_obsidian2.ButtonComponent(this.inputRow);
    this.sendButton.setIcon("send");
    this.sendButton.setTooltip("Send message");
    this.sendButton.onClick(() => this.handleSend());
    this.sendButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			background: var(--interactive-accent);
			color: var(--text-on-accent);
			border: none;
		`;
    this.addEventListener(this.textArea.inputEl, "keydown", (event) => {
      var _a, _b, _c, _d;
      const keyEvent = event;
      if (keyEvent.key === "Enter" && !keyEvent.shiftKey) {
        event.preventDefault();
        ((_a = this.commandSystem) == null ? void 0 : _a.handleCommandPickerSelection()) || false || this.handleSend();
      } else if (keyEvent.key === "Escape") {
        (_b = this.commandSystem) == null ? void 0 : _b.hideCommandPicker();
      } else if (keyEvent.key === "ArrowUp" || keyEvent.key === "ArrowDown") {
        if ((_c = this.commandSystem) == null ? void 0 : _c.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      } else if (keyEvent.key === "Tab") {
        if ((_d = this.commandSystem) == null ? void 0 : _d.handleCommandPickerNavigation(keyEvent.key)) {
          event.preventDefault();
        }
      }
    });
    this.addEventListener(this.textArea.inputEl, "input", () => {
      if (this.commandSystem) {
        this.commandSystem.handleInputChange();
      }
    });
    this.setupDragAndDrop();
  }
  focus() {
    setTimeout(() => {
      var _a;
      if ((_a = this.textArea) == null ? void 0 : _a.inputEl) {
        this.textArea.inputEl.focus();
      }
    }, _InputHandler.FOCUS_DELAY_MS);
  }
  handleSend() {
    var _a;
    const message = this.textArea.getValue().trim();
    if (!message) return;
    this.textArea.setValue("");
    this.autoGrowTextarea();
    this.contextManager.hideContextPreview();
    (_a = this.onSendMessage) == null ? void 0 : _a.call(this, message);
  }
  setOnSendMessage(callback) {
    this.onSendMessage = callback;
  }
  getValue() {
    return this.textArea.getValue();
  }
  setValue(value) {
    this.textArea.setValue(value);
    this.autoGrowTextarea();
  }
  insertText(text) {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + text + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const newPosition = start + text.length;
    setTimeout(() => {
      textarea.setSelectionRange(newPosition, newPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  insertTextWithCursor(beforeCursor, afterCursor = "") {
    const currentValue = this.textArea.getValue();
    const textarea = this.textArea.inputEl;
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const newValue = currentValue.slice(0, start) + beforeCursor + afterCursor + currentValue.slice(end);
    this.textArea.setValue(newValue);
    const cursorPosition = start + beforeCursor.length;
    setTimeout(() => {
      textarea.setSelectionRange(cursorPosition, cursorPosition);
      textarea.focus();
    }, 0);
    this.autoGrowTextarea();
  }
  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.eventListeners.push({ element, event, handler });
  }
  setupDragAndDrop() {
    const dropZone = this.textArea.inputEl;
    this.addEventListener(dropZone, "dragenter", (e) => {
      e.preventDefault();
      this.handleDragEnter();
    });
    this.addEventListener(dropZone, "dragover", (e) => {
      e.preventDefault();
      e.dataTransfer.dropEffect = "copy";
    });
    this.addEventListener(dropZone, "dragleave", (e) => {
      if (e.target === dropZone) {
        this.handleDragLeave();
      }
    });
    this.addEventListener(dropZone, "drop", (e) => {
      e.preventDefault();
      this.handleDrop(e);
    });
  }
  handleDragEnter() {
    if (this.isDragging) return;
    this.isDragging = true;
    if (!this.dropZoneOverlay) {
      this.dropZoneOverlay = document.createElement("div");
      this.dropZoneOverlay.className = "nova-drop-zone-overlay";
      this.dropZoneOverlay.style.cssText = `
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: var(--interactive-accent);
				opacity: 0;
				border: 2px dashed var(--interactive-accent);
				border-radius: var(--radius-s);
				display: flex;
				align-items: center;
				justify-content: center;
				pointer-events: none;
				transition: opacity 0.2s ease;
				z-index: 10;
			`;
      const iconContainer = document.createElement("div");
      iconContainer.style.cssText = `
				background: var(--background-primary);
				border-radius: 50%;
				width: 48px;
				height: 48px;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
				opacity: 0;
				transform: scale(0.8);
				transition: all 0.2s ease;
			`;
      const icon = document.createElement("div");
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>`;
      icon.style.cssText = `
				color: var(--interactive-accent);
				display: flex;
				align-items: center;
				justify-content: center;
			`;
      iconContainer.appendChild(icon);
      this.dropZoneOverlay.appendChild(iconContainer);
    }
    const textAreaContainer = this.textArea.inputEl.parentElement;
    textAreaContainer.style.position = "relative";
    textAreaContainer.appendChild(this.dropZoneOverlay);
    setTimeout(() => {
      if (this.dropZoneOverlay) {
        this.dropZoneOverlay.style.opacity = "0.1";
        const icon = this.dropZoneOverlay.querySelector("div");
        if (icon) {
          icon.style.opacity = "1";
          icon.style.transform = "scale(1)";
        }
      }
    }, 10);
  }
  handleDragLeave() {
    this.isDragging = false;
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.style.opacity = "0";
      const icon = this.dropZoneOverlay.querySelector("div");
      if (icon) {
        icon.style.opacity = "0";
        icon.style.transform = "scale(0.8)";
      }
      setTimeout(() => {
        var _a;
        (_a = this.dropZoneOverlay) == null ? void 0 : _a.remove();
        this.dropZoneOverlay = null;
      }, 200);
    }
  }
  handleDrop(e) {
    var _a;
    this.handleDragLeave();
    const files = [];
    const textPlainData = (_a = e.dataTransfer) == null ? void 0 : _a.getData("text/plain");
    if (textPlainData && textPlainData.includes("obsidian://open?")) {
      const urls = textPlainData.split(/[\n\r]/).filter((line) => line.trim().startsWith("obsidian://open?"));
      for (const urlString of urls) {
        try {
          const url = new URL(urlString.trim());
          const filePath = url.searchParams.get("file");
          if (filePath) {
            const decodedPath = decodeURIComponent(filePath);
            const pathParts = decodedPath.split(/[/\\]/);
            const filename = pathParts[pathParts.length - 1];
            if (filename.endsWith(".md")) {
              const baseName = filename.replace(".md", "");
              if (baseName && !files.includes(baseName)) {
                files.push(baseName);
              }
            } else {
              if (filename && !files.includes(filename)) {
                files.push(filename);
              }
            }
          }
        } catch (error) {
          console.warn("Failed to parse Obsidian URL:", urlString, error);
        }
      }
    }
    if (files.length > 0) {
      this.addFilesToContext(files);
    } else if (textPlainData && textPlainData.includes("obsidian://open?")) {
      new import_obsidian2.Notice("Only markdown files can be added to context", 3e3);
    } else if (textPlainData && textPlainData.trim() && !textPlainData.includes("://")) {
      new import_obsidian2.Notice("Folders cannot be added to context. Please select individual files.", 3e3);
    }
  }
  async addFilesToContext(filenames) {
    if (filenames.length === 0) return;
    if (this.sidebarView) {
      await this.sidebarView.addFilesToContext(filenames);
    }
  }
  refreshCommandButton() {
    if (this.commandSystem) {
      this.commandSystem.updateCommandButtonVisibility();
    }
  }
  updateContextState(hasContext) {
    if (this.container) {
      if (hasContext) {
        this.container.classList.add("has-context");
      } else {
        this.container.classList.remove("has-context");
      }
    }
  }
  cleanup() {
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.dropZoneOverlay) {
      this.dropZoneOverlay.remove();
      this.dropZoneOverlay = null;
    }
    this.eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.eventListeners = [];
  }
};
_InputHandler.FOCUS_DELAY_MS = 150;
var InputHandler = _InputHandler;

// src/ui/command-system.ts
var import_obsidian3 = require("obsidian");
var CommandSystem = class {
  constructor(plugin, container, textArea) {
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    this.isCommandMenuVisible = false;
    this.plugin = plugin;
    this.container = container;
    this.textArea = textArea;
  }
  createCommandButton(inputRow) {
    this.commandButton = new import_obsidian3.ButtonComponent(inputRow);
    this.commandButton.setIcon("zap");
    this.commandButton.setTooltip("Commands");
    this.commandButton.onClick(() => this.toggleCommandMenu());
    this.commandButton.buttonEl.style.cssText = `
			min-width: var(--size-4-9);
			height: var(--size-4-9);
			border-radius: 50%;
			display: ${this.shouldShowCommandButton() ? "flex" : "none"};
			align-items: center;
			justify-content: center;
			padding: 0;
			flex-shrink: 0;
			margin-right: var(--size-2-3);
		`;
    return this.commandButton;
  }
  createCommandPicker() {
    this.createCommandPickerInContainer(this.container);
  }
  createCommandPickerInContainer(container) {
    this.commandPicker = container.createDiv({ cls: "nova-command-picker" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 8px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			margin-bottom: 4px;
		`;
  }
  shouldShowCommandButton() {
    return import_obsidian3.Platform.isMobile && this.plugin.settings.showCommandButton && this.plugin.featureManager.isFeatureEnabled("commands");
  }
  updateCommandButtonVisibility() {
    if (this.commandButton) {
      const shouldShow = this.shouldShowCommandButton();
      this.commandButton.buttonEl.style.display = shouldShow ? "flex" : "none";
    }
  }
  toggleCommandMenu() {
    if (!this.commandMenu) {
      this.createCommandMenu();
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  createCommandMenu() {
    this.commandMenu = this.container.createDiv({ cls: "nova-command-menu" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			box-shadow: var(--shadow-s);
			min-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			padding: var(--size-2-2);
		`;
    const commands = [
      { name: "Improve Writing", description: "Enhance clarity and flow", command: "improve writing" },
      { name: "Fix Grammar", description: "Correct grammar and spelling", command: "fix grammar" },
      { name: "Summarize", description: "Create a concise summary", command: "summarize" },
      { name: "Expand Ideas", description: "Develop thoughts further", command: "expand" },
      { name: "Explain", description: "Clarify complex concepts", command: "explain this" },
      { name: "Continue Writing", description: "Extend the current text", command: "continue writing" }
    ];
    const title = this.commandMenu.createEl("div", { text: "Quick Commands" });
    title.style.cssText = `
			font-size: var(--font-ui-medium);
			font-weight: 600;
			margin-bottom: var(--size-2-3);
			color: var(--text-normal);
		`;
    commands.forEach((cmd) => {
      const cmdEl = this.commandMenu.createDiv({ cls: "nova-command-item" });
      cmdEl.style.cssText = `
				padding: var(--size-2-2) var(--size-2-3);
				border-radius: var(--radius-xs);
				cursor: pointer;
				margin-bottom: var(--size-2-1);
				transition: background-color 0.1s;
			`;
      const nameEl = cmdEl.createEl("div", { text: cmd.name });
      nameEl.style.cssText = `
				font-weight: 500;
				color: var(--text-normal);
				margin-bottom: var(--size-2-1);
			`;
      const descEl = cmdEl.createEl("div", { text: cmd.description });
      descEl.style.cssText = `
				font-size: var(--font-ui-smaller);
				color: var(--text-muted);
			`;
      cmdEl.addEventListener("click", () => {
        this.textArea.setValue(cmd.command + " ");
        this.textArea.inputEl.focus();
        this.hideCommandMenu();
      });
      cmdEl.addEventListener("mouseenter", () => {
        cmdEl.style.background = "var(--background-modifier-hover)";
      });
      cmdEl.addEventListener("mouseleave", () => {
        cmdEl.style.background = "transparent";
      });
    });
  }
  showCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "block";
      this.isCommandMenuVisible = true;
    }
  }
  hideCommandMenu() {
    if (this.commandMenu) {
      this.commandMenu.style.display = "none";
      this.isCommandMenuVisible = false;
    }
  }
  handleInputChange() {
    if (!this.textArea) {
      return;
    }
    const input = this.textArea.getValue();
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.hideCommandPicker();
      return;
    }
    if (input.startsWith(":")) {
      this.showStructuredCommandPicker(input);
    } else {
      this.hideCommandPicker();
    }
  }
  /**
   * Show structured command picker for ":" trigger  
   */
  showStructuredCommandPicker(input) {
    if (!this.commandPicker) {
      return;
    }
    const structuredCommands = this.getStructuredCommands();
    const filterText = input.slice(1).toLowerCase();
    const filtered = structuredCommands.filter(
      (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
    );
    this.commandPickerItems = [];
    this.commandPicker.empty();
    this.selectedCommandIndex = -1;
    if (filtered.length > 0) {
      filtered.forEach((cmd, index) => {
        const item = this.commandPicker.createDiv({ cls: "nova-command-picker-item" });
        item.style.cssText = `
					padding: 8px 12px;
					cursor: pointer;
					border-bottom: 1px solid var(--background-modifier-border-hover);
					transition: background-color 0.2s;
				`;
        const nameEl = item.createEl("div", { text: cmd.name });
        nameEl.style.cssText = `
					font-weight: 500;
					color: var(--text-normal);
					margin-bottom: 4px;
				`;
        const descEl = item.createEl("div", { text: cmd.description });
        descEl.style.cssText = `
					font-size: 0.85em;
					color: var(--text-muted);
					margin-bottom: 4px;
				`;
        const exampleEl = item.createEl("div", { text: `Example: ${cmd.example}` });
        exampleEl.style.cssText = `
					font-size: 0.8em;
					color: var(--text-accent);
					font-family: var(--font-monospace);
				`;
        item.addEventListener("click", () => {
          this.selectStructuredCommand(cmd.template);
        });
        item.addEventListener("mouseenter", () => {
          this.selectedCommandIndex = index;
          this.updateCommandPickerSelection();
        });
        this.commandPickerItems.push(item);
      });
      this.commandPicker.style.display = "block";
    } else {
      this.hideCommandPicker();
    }
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
  }
  handleCommandPickerNavigation(key) {
    if (this.commandPickerItems.length === 0) return false;
    if (key === "ArrowDown") {
      this.selectedCommandIndex = Math.min(this.selectedCommandIndex + 1, this.commandPickerItems.length - 1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "ArrowUp") {
      this.selectedCommandIndex = Math.max(this.selectedCommandIndex - 1, -1);
      this.updateCommandPickerSelection();
      return true;
    } else if (key === "Tab" && this.selectedCommandIndex >= 0) {
      return this.handleCommandPickerSelection();
    }
    return false;
  }
  handleCommandPickerSelection() {
    if (this.selectedCommandIndex >= 0 && this.commandPickerItems.length > 0) {
      const commands = this.getStructuredCommands();
      const input = this.textArea.getValue();
      if (input.startsWith(":")) {
        const filterText = input.slice(1).toLowerCase();
        const filtered = commands.filter(
          (cmd) => cmd.name.toLowerCase().includes(filterText) || cmd.command.toLowerCase().includes(filterText) || cmd.keywords.some((keyword) => keyword.toLowerCase().includes(filterText))
        );
        if (this.selectedCommandIndex < filtered.length) {
          const selectedCmd = filtered[this.selectedCommandIndex];
          this.selectStructuredCommand(selectedCmd.template);
          return true;
        }
      }
    }
    return false;
  }
  updateCommandPickerSelection() {
    this.commandPickerItems.forEach((item, index) => {
      if (index === this.selectedCommandIndex) {
        item.style.background = "var(--background-modifier-hover)";
      } else {
        item.style.background = "transparent";
      }
    });
  }
  selectCommand(command) {
    this.textArea.setValue(command + " ");
    this.textArea.inputEl.focus();
    const length = this.textArea.getValue().length;
    this.textArea.inputEl.setSelectionRange(length, length);
    this.hideCommandPicker();
  }
  /**
   * Get structured commands for ":" trigger
   */
  getStructuredCommands() {
    return [
      {
        name: "Add Content",
        description: "Add new content at cursor position",
        command: "add",
        template: "add {cursor}",
        example: ":add paragraph about methodology",
        keywords: ["create", "new", "insert", "write"]
      },
      {
        name: "Edit Selection",
        description: "Edit the selected text",
        command: "edit",
        template: "edit to {cursor}",
        example: ":edit to be more formal",
        keywords: ["modify", "update", "change", "revise"]
      },
      {
        name: "Delete Selection",
        description: "Remove the selected text",
        command: "delete",
        template: "delete {cursor}",
        example: ":delete selected text",
        keywords: ["remove", "eliminate", "erase"]
      },
      {
        name: "Rewrite",
        description: "Rewrite content with specific style",
        command: "rewrite",
        template: "rewrite as {cursor}",
        example: ":rewrite as bullet points",
        keywords: ["rephrase", "restructure", "reword"]
      },
      {
        name: "Fix Grammar",
        description: "Correct grammar and spelling errors",
        command: "grammar",
        template: "fix grammar {cursor}",
        example: ":fix grammar in selection",
        keywords: ["correct", "proofread", "spelling"]
      },
      {
        name: "Continue",
        description: "Continue writing from current position",
        command: "continue",
        template: "continue {cursor}",
        example: ":continue with examples",
        keywords: ["extend", "expand", "proceed"]
      },
      {
        name: "Update Metadata",
        description: "Update document properties",
        command: "metadata",
        template: "update {cursor} property",
        example: ":update tags property",
        keywords: ["frontmatter", "properties", "tags"]
      }
    ];
  }
  /**
   * Select a structured command and insert template
   */
  selectStructuredCommand(template) {
    this.hideCommandPicker();
    const cursorPos = template.indexOf("{cursor}");
    if (cursorPos !== -1) {
      const beforeCursor = template.slice(0, cursorPos);
      const afterCursor = template.slice(cursorPos + 8);
      this.textArea.setValue(beforeCursor + afterCursor);
      setTimeout(() => {
        this.textArea.inputEl.setSelectionRange(cursorPos, cursorPos);
        this.textArea.inputEl.focus();
      }, 0);
    } else {
      this.textArea.setValue(template);
      this.textArea.inputEl.focus();
    }
  }
  cleanup() {
    if (this.commandMenu) {
      this.commandMenu.remove();
    }
    if (this.commandPicker) {
      this.commandPicker.remove();
    }
  }
};

// src/ui/context-manager.ts
var import_obsidian4 = require("obsidian");

// src/ai/context-limits.ts
var CLOUD_PROVIDER_LIMITS = {
  claude: {
    // Claude models - all current versions have 200k tokens
    "claude-opus-4-20250514": { tokens: 2e5 },
    "claude-sonnet-4-20250514": { tokens: 2e5 },
    "claude-3-7-sonnet-latest": { tokens: 2e5 },
    "claude-3-5-sonnet-latest": { tokens: 2e5 },
    "claude-3-5-haiku-latest": { tokens: 2e5 },
    // Fallback for any Claude model
    "default": { tokens: 2e5, fallback: true }
  },
  openai: {
    // GPT-4.1 models 
    "gpt-4.1-2025-04-14": { tokens: 1047576 },
    "gpt-4.1-mini-2025-04-14": { tokens: 1047576 },
    "gpt-4.1-nano-2025-04-14": { tokens: 1047576 },
    // o4 models 
    "o4-mini-2025-04-16": { tokens: 2e5 },
    // o3 models 
    "o3-2025-04-16": { tokens: 2e5 },
    "o3-mini-2025-01-31": { tokens: 2e5 },
    // o1 models 
    "o1-2024-12-17": { tokens: 128e3 },
    // GPT-4o models 
    "gpt-4o": { tokens: 128e3 },
    "gpt-4o-mini": { tokens: 128e3 },
    // Fallback for OpenAI models - assume GPT-4o capacity
    "default": { tokens: 128e3, fallback: true }
  },
  google: {
    // Gemini 2.5 models - 1M tokens
    "gemini-2.5-pro": { tokens: 1048576 },
    "gemini-2.5-flash": { tokens: 1048576 },
    "gemini-2.5-flash-lite-preview-06-17": { tokens: 1e6 },
    // Fallback for Google models - assume modern Gemini capacity
    "default": { tokens: 1e6, fallback: true }
  }
};
function getContextLimit(provider, model) {
  const providerLimits = CLOUD_PROVIDER_LIMITS[provider.toLowerCase()];
  if (!providerLimits) {
    return 32e3;
  }
  const modelLimit = providerLimits[model];
  if (modelLimit) {
    return modelLimit.tokens;
  }
  const defaultLimit = providerLimits["default"];
  if (defaultLimit) {
    return defaultLimit.tokens;
  }
  return 32e3;
}

// src/core/context-calculator.ts
function estimateTokens(text) {
  if (!text) return 0;
  return Math.ceil(text.length / 4);
}
function calculateContextUsage(provider, model, conversationHistory = [], fileAttachments = [], currentInput = "", recentResponse = "", ollamaDefaultContext = 32e3) {
  let contextLimit;
  if (provider.toLowerCase() === "ollama") {
    contextLimit = ollamaDefaultContext;
  } else {
    contextLimit = getContextLimit(provider, model);
  }
  const conversationTokens = conversationHistory.reduce((total, msg) => {
    return total + estimateTokens(msg.content);
  }, 0);
  const fileTokens = fileAttachments.reduce((total, file) => {
    return total + estimateTokens(file.content);
  }, 0);
  const inputTokens = estimateTokens(currentInput);
  const responseTokens = estimateTokens(recentResponse);
  const totalTokens = conversationTokens + fileTokens + inputTokens + responseTokens;
  const usagePercentage = Math.round(totalTokens / contextLimit * 100);
  return {
    totalTokens,
    contextLimit,
    usagePercentage,
    breakdown: {
      conversationHistory: conversationTokens,
      fileAttachments: fileTokens,
      currentInput: inputTokens,
      recentResponse: responseTokens
    }
  };
}
function getRemainingContextPercentage(usage) {
  return Math.max(0, 100 - usage.usagePercentage);
}
function getContextWarningLevel(usage) {
  const remainingPercentage = getRemainingContextPercentage(usage);
  if (remainingPercentage <= 5) {
    return "critical";
  } else if (remainingPercentage <= 15) {
    return "warning";
  } else {
    return "safe";
  }
}
function formatContextUsage(usage) {
  const remainingPercentage = getRemainingContextPercentage(usage);
  const warningLevel = getContextWarningLevel(usage);
  if (warningLevel === "critical") {
    return `${remainingPercentage}% left!`;
  } else {
    return `${remainingPercentage}% left`;
  }
}
function getContextTooltip(usage) {
  const { totalTokens, contextLimit, breakdown } = usage;
  const remainingTokens = contextLimit - totalTokens;
  const lines = [
    `Context Usage: ${totalTokens.toLocaleString()} / ${contextLimit.toLocaleString()} tokens`,
    `Remaining: ${remainingTokens.toLocaleString()} tokens`,
    "",
    "Breakdown:"
  ];
  if (breakdown.conversationHistory > 0) {
    lines.push(`\u2022 Conversation: ${breakdown.conversationHistory.toLocaleString()} tokens`);
  }
  if (breakdown.fileAttachments > 0) {
    lines.push(`\u2022 File context: ${breakdown.fileAttachments.toLocaleString()} tokens`);
  }
  if (breakdown.currentInput > 0) {
    lines.push(`\u2022 Current input: ${breakdown.currentInput.toLocaleString()} tokens`);
  }
  if (breakdown.recentResponse > 0) {
    lines.push(`\u2022 Recent response: ${breakdown.recentResponse.toLocaleString()} tokens`);
  }
  return lines.join("\n");
}

// src/ui/context-manager.ts
var _ContextManager = class _ContextManager {
  constructor(plugin, app, container) {
    this.persistentContext = /* @__PURE__ */ new Map();
    this.currentContext = null;
    this.currentFilePath = null;
    // Track current file for validation
    this.currentOperationId = null;
    this.plugin = plugin;
    this.app = app;
    this.container = container;
  }
  setSidebarView(sidebarView) {
    this.sidebarView = sidebarView;
  }
  createContextIndicator() {
    this.contextIndicator = this.container.createDiv({ cls: "nova-context-indicator" });
    this.contextIndicator.style.cssText = `
			position: absolute;
			top: -2px;
			right: var(--size-4-3);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-1) var(--size-2-2);
			font-size: var(--font-ui-smaller);
			color: var(--text-muted);
			display: none;
			z-index: 100;
			max-width: 200px;
			box-shadow: var(--shadow-s);
		`;
  }
  createContextPreview() {
    const previewContainer = this.container.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			background: var(--background-modifier-hover);
			border: 1px solid var(--background-modifier-border);
			border-radius: var(--radius-s);
			padding: var(--size-2-2) var(--size-2-3);
			margin-bottom: var(--size-2-2);
			font-size: var(--font-ui-small);
			display: none;
		`;
    const previewLabel = previewContainer.createSpan({ text: "Context: " });
    previewLabel.style.cssText = "color: var(--text-muted); font-weight: 600;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  updateLiveContextPreview(message) {
    if (!this.contextPreview) {
      return;
    }
    if (!this.currentFilePath) {
      this.contextPreview.style.display = "none";
      return;
    }
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      foundRefs.push({ name: docName, property });
    }
    if (foundRefs.length === 0) {
      this.contextPreview.style.display = "none";
      return;
    }
    const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
    if (previewList) {
      const refsText = foundRefs.map(
        (ref) => ref.property ? `${ref.name}#${ref.property}` : ref.name
      ).join(", ");
      previewList.textContent = refsText;
    }
    this.contextPreview.style.display = "block";
  }
  async buildContext(message, currentFile) {
    if (!currentFile) {
      return null;
    }
    if (!this.currentFilePath) {
      return null;
    }
    const operationId = Date.now().toString() + Math.random().toString(36).substr(2, 9);
    this.currentOperationId = operationId;
    const targetFilePath = currentFile.path;
    if (this.currentFilePath !== targetFilePath) {
      return null;
    }
    try {
      const { cleanedMessage, references } = this.parseMessage(message, currentFile.path);
      const existingPersistent = this.persistentContext.get(currentFile.path) || [];
      if (references.length > 0) {
        const updatedPersistent = [...existingPersistent];
        for (const ref of references) {
          const exists = updatedPersistent.some((existing) => existing.file.path === ref.file.path);
          if (!exists) {
            updatedPersistent.push(ref);
          }
        }
        this.persistentContext.set(currentFile.path, updatedPersistent);
      }
      const rawPersistentDocs = this.persistentContext.get(currentFile.path) || [];
      const allPersistentDocs = rawPersistentDocs.filter((docRef) => {
        if (!(docRef == null ? void 0 : docRef.file) || !this.app.vault.getAbstractFileByPath(docRef.file.path)) {
          return false;
        }
        return true;
      });
      if (allPersistentDocs.length !== rawPersistentDocs.length) {
        if (allPersistentDocs.length > 0) {
          this.persistentContext.set(currentFile.path, allPersistentDocs);
        } else {
          this.persistentContext.delete(currentFile.path);
        }
      }
      const contextParts = [];
      const currentFileContext = await this.getFullDocumentContext(currentFile, true, 100);
      if (currentFileContext) {
        contextParts.push(currentFileContext);
      }
      for (const docRef of allPersistentDocs) {
        const contextPart = await this.getDocumentContext(docRef);
        if (contextPart) {
          contextParts.push(contextPart);
        }
      }
      const contextString = contextParts.join("\n\n---\n\n");
      const tokenCount = this.estimateTokens(contextString);
      const fileAttachments = contextParts.map((content) => ({ content }));
      const totalContextUsage = await this.calculateTotalContextUsage(fileAttachments);
      const context = {
        persistentDocs: allPersistentDocs,
        contextString,
        tokenCount,
        isNearLimit: false,
        // Legacy field - warnings now handled in sidebar-view.ts
        totalContextUsage
      };
      if (this.currentOperationId !== operationId || !this.currentFilePath || this.currentFilePath !== targetFilePath) {
        return null;
      }
      this.currentContext = context;
      if (context == null ? void 0 : context.persistentDocs.length) {
        this.updateContextIndicator(context);
      }
      return context;
    } catch (error) {
      return null;
    }
  }
  updateContextIndicator(context) {
  }
  hideContextPreview() {
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
  }
  hideContextIndicator() {
    if (this.contextIndicator) {
      this.contextIndicator.style.display = "none";
    }
  }
  clearCurrentContext() {
    this.currentContext = null;
    this.currentFilePath = null;
    this.currentOperationId = null;
    this.hideContextIndicator();
    this.hideContextPreview();
  }
  /**
   * Set current file and immediately clear context to prevent bleeding
   * This should be called synchronously when file switches occur
   */
  setCurrentFile(file) {
    const newFilePath = (file == null ? void 0 : file.path) || null;
    if (this.currentFilePath !== newFilePath) {
      this.currentContext = null;
      this.currentOperationId = null;
      this.hideContextIndicator();
      this.hideContextPreview();
    }
    this.currentFilePath = newFilePath;
  }
  getCurrentContext() {
    return this.currentContext;
  }
  getCurrentFilePath() {
    return this.currentFilePath;
  }
  /**
   * Restore context after chat has been loaded (prevents missing file notifications from being cleared)
   */
  async restoreContextAfterChatLoad(file) {
    if (file && this.plugin.conversationManager) {
      await this.restoreContextFromConversation(file);
    }
    await this.refreshContextFromStorage();
  }
  /**
   * Check if drawer should be visible (has context documents)
   */
  isDrawerVisible() {
    var _a;
    const context = this.getCurrentContext();
    return (((_a = context == null ? void 0 : context.persistentDocs) == null ? void 0 : _a.length) || 0) > 0;
  }
  /**
   * Add document to context for current file
   */
  async addDocument(file) {
    if (!this.currentFilePath) {
      return;
    }
    if (file.path === this.currentFilePath) {
      return;
    }
    const current = this.persistentContext.get(this.currentFilePath) || [];
    const exists = current.some((doc) => doc.file.path === file.path);
    if (exists) {
      return;
    }
    const newRef = {
      file,
      property: void 0,
      isPersistent: true,
      rawReference: `[[${file.basename}]]`
    };
    const updated = [...current, newRef];
    this.persistentContext.set(this.currentFilePath, updated);
    const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
    if (currentFile && currentFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.addContextDocument(currentFile, file.path);
    }
    await this.refreshContextFromStorage();
  }
  /**
   * Remove document from context for current file
   */
  async removeDocument(file) {
    if (!this.currentFilePath) return;
    const current = this.persistentContext.get(this.currentFilePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== file.path);
    if (filtered.length > 0) {
      this.persistentContext.set(this.currentFilePath, filtered);
    } else {
      this.persistentContext.delete(this.currentFilePath);
    }
    const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
    if (currentFile && currentFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.removeContextDocument(currentFile, file.path);
    }
    await this.refreshContextFromStorage();
  }
  /**
   * Update indicator based on current context state
   * Note: SidebarView handles actual UI updates to preserve complex drawer functionality
   */
  updateIndicator() {
  }
  /**
   * Private method to refresh context from storage and update indicator
   */
  async refreshContextFromStorage() {
    if (!this.currentFilePath) {
      this.currentContext = null;
      this.hideContextIndicator();
      return;
    }
    try {
      const persistentDocs = this.persistentContext.get(this.currentFilePath) || [];
      if (persistentDocs.length === 0) {
        this.currentContext = null;
        this.hideContextIndicator();
        return;
      }
      let totalTokens = 0;
      try {
        const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
        if (currentFile instanceof import_obsidian4.TFile) {
          const currentContent = await this.app.vault.read(currentFile);
          totalTokens += Math.ceil(currentContent.length / 4);
        }
      } catch (error) {
      }
      for (const doc of persistentDocs) {
        try {
          const content = await this.app.vault.read(doc.file);
          totalTokens += Math.ceil(content.length / 4);
        } catch (error) {
        }
      }
      const fileAttachments = persistentDocs.length > 0 ? [{ content: `Context files: ${persistentDocs.map((d) => d.file.basename).join(", ")}` }] : [];
      const totalContextUsage = await this.calculateTotalContextUsage(fileAttachments);
      this.currentContext = {
        persistentDocs,
        contextString: "",
        // Not needed for UI
        tokenCount: totalTokens,
        isNearLimit: false,
        // Legacy field - warnings now handled in sidebar-view.ts
        totalContextUsage
      };
    } catch (error) {
      this.currentContext = null;
      this.hideContextIndicator();
    }
  }
  /**
   * Restore context from conversation manager
   */
  async restoreContextFromConversation(file) {
    if (!this.plugin.conversationManager) {
      return;
    }
    try {
      const savedContextDocs = await this.plugin.conversationManager.getContextDocuments(file);
      if (savedContextDocs.length === 0) {
        this.persistentContext.delete(file.path);
        return;
      }
      const validDocumentRefs = [];
      const invalidPaths = [];
      for (const contextDoc of savedContextDocs) {
        try {
          if (!contextDoc || !contextDoc.path || typeof contextDoc.path !== "string") {
            console.warn("Invalid context document structure:", contextDoc);
            continue;
          }
          const contextFile = this.app.vault.getAbstractFileByPath(contextDoc.path);
          if (contextFile && contextFile.path && contextFile instanceof import_obsidian4.TFile) {
            validDocumentRefs.push({
              file: contextFile,
              property: contextDoc.property,
              isPersistent: true,
              rawReference: contextDoc.property ? `[[${contextFile.basename}#${contextDoc.property}]]` : `[[${contextFile.basename}]]`
            });
          } else {
            invalidPaths.push(contextDoc.path);
          }
        } catch (docError) {
          console.warn("Error processing context document, skipping:", docError);
        }
      }
      if (invalidPaths.length > 0) {
        await this.cleanupMissingFiles(file, invalidPaths);
        this.showMissingFilesNotice(invalidPaths);
      }
      if (validDocumentRefs.length > 0) {
        this.persistentContext.set(file.path, validDocumentRefs);
      } else {
        this.persistentContext.delete(file.path);
      }
    } catch (error) {
      console.warn("Failed to restore context from conversation:", error);
      this.persistentContext.delete(file.path);
    }
  }
  /**
   * Clean up missing files from conversation storage
   */
  async cleanupMissingFiles(file, invalidPaths) {
    if (!this.plugin.conversationManager) return;
    try {
      for (const invalidPath of invalidPaths) {
        await this.plugin.conversationManager.removeContextDocument(file, invalidPath);
      }
    } catch (error) {
      console.warn("Failed to cleanup missing files from conversation:", error);
    }
  }
  /**
   * Show notice and chat message about missing context files
   */
  showMissingFilesNotice(missingFiles) {
    if (missingFiles.length === 0) return;
    try {
      let noticeMessage;
      let chatMessage;
      if (missingFiles.length === 1) {
        noticeMessage = `\u26A0\uFE0F Context file no longer available: ${missingFiles[0]}`;
        chatMessage = `Context file no longer available: ${missingFiles[0]}`;
      } else {
        const displayFiles = missingFiles.slice(0, 3);
        const remainingCount = missingFiles.length - displayFiles.length;
        if (remainingCount > 0) {
          noticeMessage = `\u26A0\uFE0F ${missingFiles.length} context files no longer available: ${displayFiles.join(", ")} and ${remainingCount} more`;
          chatMessage = `${missingFiles.length} context files no longer available: ${displayFiles.join(", ")} and ${remainingCount} more`;
        } else {
          noticeMessage = `\u26A0\uFE0F ${missingFiles.length} context files no longer available: ${displayFiles.join(", ")}`;
          chatMessage = `${missingFiles.length} context files no longer available: ${displayFiles.join(", ")}`;
        }
      }
      new import_obsidian4.Notice(noticeMessage, _ContextManager.NOTICE_DURATION_MS);
      if (this.sidebarView && typeof this.sidebarView.addWarningMessage === "function") {
        this.sidebarView.addWarningMessage(chatMessage);
      }
    } catch (error) {
      console.warn("Failed to show missing files notification:", error);
    }
  }
  /**
   * Validate all context documents for a file and return results
   */
  async validateContextDocuments(file) {
    if (!this.plugin.conversationManager) {
      return { validFiles: [], missingFiles: [], totalCount: 0 };
    }
    try {
      const savedContextDocs = await this.plugin.conversationManager.getContextDocuments(file);
      const validFiles = [];
      const missingFiles = [];
      for (const contextDoc of savedContextDocs) {
        const contextFile = this.app.vault.getAbstractFileByPath(contextDoc.path);
        if (contextFile && contextFile.path) {
          validFiles.push(contextDoc.path);
        } else {
          missingFiles.push(contextDoc.path);
        }
      }
      return {
        validFiles,
        missingFiles,
        totalCount: savedContextDocs.length
      };
    } catch (error) {
      return { validFiles: [], missingFiles: [], totalCount: 0 };
    }
  }
  /**
   * Schedule async persistence update
   */
  async schedulePersistenceUpdate(conversationFilePath, references) {
    const conversationFile = this.app.vault.getAbstractFileByPath(conversationFilePath);
    if (conversationFile && conversationFile.path && this.plugin.conversationManager) {
      const contextRefs = references.map((ref) => ({
        path: ref.file.path,
        property: ref.property,
        addedAt: Date.now()
      }));
      await this.plugin.conversationManager.setContextDocuments(conversationFile, contextRefs);
    }
  }
  cleanup() {
    this.clearCurrentContext();
    if (this.contextIndicator) {
      this.contextIndicator.remove();
    }
    if (this.contextPreview) {
      this.contextPreview.remove();
    }
  }
  /**
   * Parse a message for document references
   */
  parseMessage(message, conversationFilePath) {
    const references = [];
    let cleanedMessage = message;
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const rawReference = match[0];
      const file = this.findFile(docName);
      if (file) {
        references.push({
          file,
          isPersistent: true,
          // All references are now persistent
          rawReference,
          property
        });
      }
    }
    for (const ref of references) {
      cleanedMessage = cleanedMessage.replace(ref.rawReference, " ");
    }
    cleanedMessage = cleanedMessage.replace(/\s{2,}/g, " ").trim();
    const persistentRefs = references.filter((ref) => ref.isPersistent);
    if (persistentRefs.length > 0) {
      const existing = this.persistentContext.get(conversationFilePath) || [];
      const updatedPersistent = [...existing];
      for (const ref of persistentRefs) {
        const exists = updatedPersistent.some((existing2) => existing2.file.path === ref.file.path);
        if (!exists) {
          updatedPersistent.push(ref);
        }
      }
      this.persistentContext.set(conversationFilePath, updatedPersistent);
      this.schedulePersistenceUpdate(conversationFilePath, updatedPersistent);
    }
    return { cleanedMessage, references };
  }
  /**
   * Get full document context including metadata/properties
   */
  async getFullDocumentContext(file, includeContent = true, maxLines = 50) {
    try {
      let contextParts = [];
      contextParts.push(`## Document: ${file.basename}`);
      const cache = this.app.metadataCache.getFileCache(file);
      if ((cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).length > 0) {
        contextParts.push("\n### Properties/Metadata:");
        for (const [key, value] of Object.entries(cache.frontmatter)) {
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : value;
          contextParts.push(`- ${key}: ${formattedValue}`);
        }
      }
      if (includeContent) {
        const content = await this.app.vault.read(file);
        if (content) {
          const lines = content.split("\n");
          let contentStartIndex = 0;
          if (lines[0] === "---") {
            for (let i = 1; i < lines.length; i++) {
              if (lines[i] === "---") {
                contentStartIndex = i + 1;
                break;
              }
            }
          }
          const contentLines = lines.slice(contentStartIndex);
          const truncatedContent = contentLines.slice(0, maxLines).join("\n");
          const wasTruncated = contentLines.length > maxLines;
          contextParts.push("\n### Content:");
          contextParts.push(truncatedContent);
          if (wasTruncated) {
            contextParts.push("\n[... truncated for brevity ...]");
          }
        }
      }
      return contextParts.join("\n");
    } catch (error) {
      return null;
    }
  }
  /**
   * Get context for a specific document reference
   */
  async getDocumentContext(docRef) {
    try {
      const { file, property } = docRef;
      if (!file || !this.app.vault.getAbstractFileByPath(file.path)) {
        return null;
      }
      if (property) {
        const cache = this.app.metadataCache.getFileCache(file);
        if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[property]) {
          return `## ${file.basename} - ${property}
${cache.frontmatter[property]}`;
        }
        return null;
      } else {
        return this.getFullDocumentContext(file);
      }
    } catch (error) {
      return null;
    }
  }
  /**
   * Find a file by name or path
   */
  findFile(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian4.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian4.TFile ? file : null;
  }
  /**
   * Estimate token count (rough approximation)
   */
  estimateTokens(text) {
    return Math.ceil(text.length / 4);
  }
  /**
   * Calculate total context usage including conversation history
   */
  async calculateTotalContextUsage(fileAttachments = [], currentInput = "", recentResponse = "") {
    var _a, _b, _c;
    let providerType = null;
    let model = null;
    let conversationHistory = [];
    try {
      const detectedProviderType = await ((_a = this.plugin.aiProviderManager) == null ? void 0 : _a.getCurrentProviderType());
      if (detectedProviderType) {
        providerType = detectedProviderType;
        if (this.plugin.aiProviderManager) {
          try {
            const currentModel = this.plugin.aiProviderManager.getCurrentModel();
            if (currentModel) {
              model = currentModel;
            }
          } catch (error) {
            console.warn("Failed to get current model:", error);
          }
        }
      }
      if (!providerType || !model) {
        return {
          totalTokens: 0,
          contextLimit: 32e3,
          // Generic fallback context size
          usagePercentage: 0,
          breakdown: {
            conversationHistory: 0,
            fileAttachments: 0,
            currentInput: 0,
            recentResponse: 0
          }
        };
      }
      if (this.currentFilePath && this.plugin.conversationManager) {
        const currentFile = this.app.vault.getAbstractFileByPath(this.currentFilePath);
        if (currentFile) {
          const conversation = await this.plugin.conversationManager.getConversation(currentFile);
          conversationHistory = ((conversation == null ? void 0 : conversation.messages) || []).map((msg) => ({ content: msg.content }));
        }
      }
    } catch (error) {
      console.warn("Error during context calculation setup, using defaults:", error);
    }
    const ollamaDefaultContext = ((_c = (_b = this.plugin) == null ? void 0 : _b.settings) == null ? void 0 : _c.ollamaDefaultContext) || 32e3;
    const usage = calculateContextUsage(
      providerType,
      model,
      conversationHistory,
      fileAttachments,
      currentInput,
      recentResponse,
      ollamaDefaultContext
    );
    return usage;
  }
  /**
   * Clear persistent context for a conversation
   */
  async clearPersistentContext(filePath) {
    this.persistentContext.delete(filePath);
    const conversationFile = this.app.vault.getAbstractFileByPath(filePath);
    if (conversationFile && conversationFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.clearContextDocuments(conversationFile);
    }
  }
  /**
   * Get persistent context for a conversation
   */
  getPersistentContext(filePath) {
    return this.persistentContext.get(filePath) || [];
  }
  /**
   * Remove a specific document from persistent context
   */
  async removePersistentDoc(filePath, docToRemove) {
    const current = this.persistentContext.get(filePath) || [];
    const filtered = current.filter((ref) => ref.file.path !== docToRemove);
    if (filtered.length > 0) {
      this.persistentContext.set(filePath, filtered);
    } else {
      this.persistentContext.delete(filePath);
    }
    const conversationFile = this.app.vault.getAbstractFileByPath(filePath);
    if (conversationFile && conversationFile.path && this.plugin.conversationManager) {
      await this.plugin.conversationManager.removeContextDocument(conversationFile, docToRemove);
    }
  }
  /**
   * Get visual indicators for context state
   */
  getContextIndicators(context) {
    const docCount = context.persistentDocs.length;
    let className = "nova-context-indicator";
    let tooltip = `Context: ${docCount} document${docCount !== 1 ? "s" : ""}, ~${context.tokenCount} tokens (files only)`;
    const text = `${docCount} docs`;
    return { text, className, tooltip };
  }
  /**
   * Format context for display in UI
   */
  formatContextForDisplay(context) {
    const items = [];
    for (const doc of context.persistentDocs) {
      items.push(`${doc.file.basename}${doc.property ? `#${doc.property}` : ""}`);
    }
    return items;
  }
};
// Reference to NovaSidebarView for adding files
_ContextManager.NOTICE_DURATION_MS = 5e3;
var ContextManager = _ContextManager;

// src/ui/chat-renderer.ts
var _ChatRenderer = class _ChatRenderer {
  constructor(plugin, chatContainer) {
    this.plugin = plugin;
    this.chatContainer = chatContainer;
  }
  /**
   * Add a chat message with role header
   */
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-ui-small);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    this.scrollToBottom(true);
  }
  /**
   * Unified message creation - determines CSS class at creation time
   */
  addStatusMessage(content, options) {
    const cssClass = this.getMessageCSSClass(content, options);
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message ${cssClass}` });
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    if (options.persist) {
      const activeFile = this.plugin.app.workspace.getActiveFile();
      if (activeFile) {
        this.plugin.conversationManager.addSystemMessage(
          activeFile,
          content,
          { messageType: cssClass }
          // Store CSS class as metadata
        );
      }
    }
    this.scrollToBottom();
  }
  getMessageCSSClass(content, options) {
    if (options.type === "pill") {
      return `nova-pill-${options.variant}`;
    } else {
      return `nova-bubble-${options.variant}`;
    }
  }
  // Simple wrapper methods for backward compatibility
  addSuccessMessage(content, persist = false) {
    if (!content.startsWith("\u2713 ") && !content.includes("<svg")) {
      content = "\u2713 " + content;
    }
    this.addStatusMessage(content, { type: "pill", variant: "success", persist });
  }
  addErrorMessage(content, persist = false) {
    if (!content.startsWith("\u274C ") && !content.includes("<svg")) {
      content = "\u274C " + content;
    }
    const type = content.length <= 30 ? "pill" : "bubble";
    this.addStatusMessage(content, { type, variant: "error", persist });
  }
  addWarningMessage(content, persist = false) {
    if (!content.startsWith("\u26A0\uFE0F ") && !content.includes("<svg")) {
      content = "\u26A0\uFE0F " + content;
    }
    const type = content.length <= 30 ? "pill" : "bubble";
    this.addStatusMessage(content, { type, variant: "warning", persist });
  }
  addWelcomeMessage(message) {
    const welcomeEl = this.chatContainer.createDiv({ cls: "nova-welcome" });
    welcomeEl.style.cssText = `
			padding: 20px;
			margin-bottom: var(--size-4-3);
			background: var(--background-primary);
			border-radius: var(--radius-s);
			border: 1px solid var(--background-modifier-border);
		`;
    const content = message || `
			<div style="display: flex; flex-direction: column; align-items: center;">
				<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px; color: var(--interactive-accent); margin-bottom: var(--size-4-2);">
					<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
					<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
					<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
					<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
				</svg>
				<p style="margin: 0; margin-left: var(--size-2-3); color: var(--text-muted); font-size: var(--font-ui-medium); line-height: 1.4; text-align: left; align-self: flex-start;">
					I'm your AI writing partner. Select text and right-click for instant editing, or chat for cursor-precise commands.
				</p>
			</div>
		`;
    welcomeEl.innerHTML = content;
    this.scrollToBottom(true);
  }
  clearChat() {
    this.chatContainer.empty();
  }
  scrollToBottom(smooth = false) {
    setTimeout(() => {
      if (smooth) {
        this.chatContainer.scrollTo({
          top: this.chatContainer.scrollHeight,
          behavior: "smooth"
        });
      } else {
        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
      }
    }, _ChatRenderer.SCROLL_DELAY_MS);
  }
  async loadConversationHistory(file) {
    var _a;
    const messages = await this.plugin.conversationManager.getRecentMessages(file, 50);
    if (messages.length === 0) {
      this.addWelcomeMessage();
      return;
    }
    for (const message of messages) {
      if (message.role === "system" && ((_a = message.metadata) == null ? void 0 : _a.messageType)) {
        const messageEl = this.chatContainer.createDiv({
          cls: `nova-message ${message.metadata.messageType}`
        });
        const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
        if (message.content.includes("<svg")) {
          contentEl.innerHTML = message.content;
        } else {
          contentEl.textContent = message.content;
        }
      } else {
        this.addMessage(message.role, message.content);
      }
    }
    this.scrollToBottom();
  }
};
_ChatRenderer.SCROLL_DELAY_MS = 50;
var ChatRenderer = _ChatRenderer;

// src/ui/streaming-manager.ts
var import_obsidian5 = require("obsidian");
var _StreamingManager = class _StreamingManager {
  constructor() {
    this.dotsAnimationInterval = null;
    this.thinkingNotice = null;
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Show thinking notice with context-aware phrase and animated dots
   * Only shows notice if animation mode is 'notice' or not specified (default)
   */
  showThinkingNotice(actionType, animationMode = "notice") {
    if (animationMode !== "notice") {
      return;
    }
    try {
      const phrases = _StreamingManager.THINKING_PHRASES[actionType] || _StreamingManager.THINKING_PHRASES["chat"];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      this.thinkingNotice = new import_obsidian5.Notice(`Nova: ${randomPhrase}.`, 0);
      const initialNoticeText = `Nova: ${randomPhrase}.`;
      const noticeEl = this.thinkingNotice.noticeEl;
      if (noticeEl) {
        noticeEl.textContent = initialNoticeText;
      }
      this.startNoticeDotsAnimation(randomPhrase);
    } catch (error) {
      console.warn("Failed to create thinking notice:", error);
    }
  }
  /**
   * Start streaming at a specific position with hybrid approach
   * For selection replacement: startPos and endPos define the range to replace
   * For cursor insertion: startPos is the cursor position, endPos should be null
   */
  startStreaming(editor, startPos, endPos, options = {}) {
    this.originalPosition = { from: startPos, to: endPos };
    if (endPos) {
      editor.replaceRange("", startPos, endPos);
      this.currentStreamingEndPos = startPos;
    } else {
      this.currentStreamingEndPos = startPos;
    }
    this.streamingStartPos = null;
    const updateStream = (newText, isComplete) => {
      this.updateStreamingText(editor, newText, isComplete, options);
    };
    const stopStream = () => {
      this.stopAnimation();
      this.cleanup();
    };
    return { updateStream, stopStream };
  }
  /**
   * Update streaming text with proper position tracking
   */
  updateStreamingText(editor, newText, isComplete, options) {
    try {
      if (this.currentStreamingEndPos) {
        if (!this.streamingStartPos) {
          this.streamingStartPos = { ...this.currentStreamingEndPos };
        }
        const lines = newText.split("\n");
        const newEndPos = {
          line: this.streamingStartPos.line + lines.length - 1,
          ch: lines.length > 1 ? lines[lines.length - 1].length : this.streamingStartPos.ch + newText.length
        };
        editor.replaceRange(newText, this.streamingStartPos, this.currentStreamingEndPos);
        this.currentStreamingEndPos = newEndPos;
        if (options.onChunk) {
          options.onChunk(newText, isComplete);
        }
      }
      if (isComplete) {
        editor.setCursor(this.currentStreamingEndPos);
        this.cleanup();
        if (options.onComplete) {
          options.onComplete();
        }
      }
    } catch (error) {
      console.warn("Error updating streaming text:", error);
      this.cleanup();
      if (options.onError) {
        options.onError(error instanceof Error ? error : new Error(String(error)));
      }
    }
  }
  /**
   * Animate dots in notice text
   */
  startNoticeDotsAnimation(basePhrase) {
    let dotCount = 1;
    this.dotsAnimationInterval = setInterval(() => {
      try {
        if (!this.thinkingNotice) return;
        dotCount++;
        if (dotCount > 5) {
          dotCount = 1;
        }
        const dots = ".".repeat(dotCount);
        const noticeText = `Nova: ${basePhrase}${dots}`;
        const noticeEl = this.thinkingNotice.noticeEl;
        if (noticeEl) {
          noticeEl.textContent = noticeText;
        }
      } catch (error) {
        console.warn("Error in notice dots animation:", error);
        this.stopDotsAnimation();
      }
    }, 400);
  }
  /**
   * Stop the dots animation and dismiss notice
   */
  stopDotsAnimation() {
    if (this.dotsAnimationInterval) {
      clearInterval(this.dotsAnimationInterval);
      this.dotsAnimationInterval = null;
    }
    if (this.thinkingNotice) {
      this.thinkingNotice.hide();
      this.thinkingNotice = null;
    }
  }
  /**
   * Stop all animations and clean up
   */
  stopAnimation() {
    this.stopDotsAnimation();
  }
  /**
   * Clean up all internal state
   */
  cleanup() {
    this.stopDotsAnimation();
    this.currentStreamingEndPos = null;
    this.streamingStartPos = null;
    this.originalPosition = null;
  }
  /**
   * Get the original position before streaming started
   */
  getOriginalPosition() {
    return this.originalPosition;
  }
  /**
   * Check if currently streaming
   */
  isStreaming() {
    return this.currentStreamingEndPos !== null;
  }
  /**
   * Unified streaming method for selection-based operations
   * Handles both notice animations and document updates
   */
  async startSelectionStreaming(editor, originalRange, actionType, streamingCallback, options = {}) {
    const selectionOptions = { ...options, animationMode: "notice" };
    this.showThinkingNotice(actionType, "notice");
    editor.replaceRange("", originalRange.from, originalRange.to);
    this.currentStreamingEndPos = originalRange.from;
    this.streamingStartPos = null;
    const { updateStream, stopStream } = this.startStreaming(
      editor,
      originalRange.from,
      void 0,
      selectionOptions
    );
    const wrappedCallback = (chunk, isComplete) => {
      updateStream(chunk, isComplete);
      streamingCallback(chunk, isComplete);
    };
    return wrappedCallback;
  }
};
// Comprehensive thinking phrases for all action types
_StreamingManager.THINKING_PHRASES = {
  "improve": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "longer": [
    "expanding...",
    "developing...",
    "elaborating...",
    "building...",
    "enriching...",
    "deepening...",
    "growing...",
    "extending...",
    "amplifying...",
    "unfolding..."
  ],
  "shorter": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ],
  "tone": [
    "adjusting tone...",
    "reshaping...",
    "reframing...",
    "adapting...",
    "transforming...",
    "modulating...",
    "recasting...",
    "shifting...",
    "reforming...",
    "reimagining..."
  ],
  "custom": [
    "working on it...",
    "considering...",
    "thinking...",
    "processing...",
    "analyzing...",
    "contemplating...",
    "understanding...",
    "interpreting...",
    "exploring...",
    "evaluating..."
  ],
  "chat": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "add": [
    "composing...",
    "drafting...",
    "creating...",
    "generating...",
    "writing...",
    "crafting...",
    "formulating...",
    "developing...",
    "building...",
    "constructing..."
  ],
  "edit": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "rewrite": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "grammar": [
    "refining...",
    "polishing...",
    "enhancing...",
    "crafting...",
    "perfecting...",
    "smoothing...",
    "sharpening...",
    "elevating...",
    "fine-tuning...",
    "sculpting..."
  ],
  "delete": [
    "condensing...",
    "distilling...",
    "tightening...",
    "focusing...",
    "streamlining...",
    "compressing...",
    "trimming...",
    "clarifying...",
    "simplifying...",
    "concentrating..."
  ]
};
var StreamingManager = _StreamingManager;

// src/ui/selection-context-menu.ts
var import_obsidian9 = require("obsidian");

// src/core/commands/selection-edit-command.ts
var import_obsidian6 = require("obsidian");
var SelectionEditCommand = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Execute a selection-based edit action
   */
  async execute(action, editor, selectedText, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const loadingNotice = new import_obsidian6.Notice("Nova is processing your request...", 0);
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      const response = await this.plugin.aiProviderManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt
      );
      loadingNotice.hide();
      const transformedText = this.cleanAIResponse(response);
      return {
        success: true,
        transformedText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit command error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Execute a selection-based edit action with streaming
   */
  async executeStreaming(action, editor, selectedText, onChunk, customInstruction) {
    try {
      const selectionRange = {
        from: editor.getCursor("from"),
        to: editor.getCursor("to")
      };
      const prompt2 = this.buildPrompt(action, selectedText, customInstruction);
      let fullResponse = "";
      const stream = this.plugin.aiProviderManager.generateTextStream(prompt2.userPrompt, {
        systemPrompt: prompt2.systemPrompt
      });
      for await (const chunk of stream) {
        if (chunk.error) {
          throw new Error(chunk.error);
        }
        fullResponse += chunk.content;
        if (fullResponse.trim().length > 0 || chunk.done) {
          const cleanedChunk = this.cleanAIResponse(fullResponse);
          onChunk(cleanedChunk, chunk.done);
        }
        if (chunk.done) {
          break;
        }
      }
      const finalText = this.cleanAIResponse(fullResponse);
      if (!finalText.trim()) {
        return {
          success: false,
          error: "AI provider returned empty response",
          originalRange: selectionRange
        };
      }
      return {
        success: true,
        transformedText: finalText,
        originalRange: selectionRange
      };
    } catch (error) {
      console.error("Selection edit streaming error:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error occurred"
      };
    }
  }
  /**
   * Build prompt for the AI based on the action type
   */
  buildPrompt(action, selectedText, customInstruction) {
    const baseSystemPrompt = `You are Nova, an AI writing assistant. Your task is to transform the provided text according to the user's request. 

CRITICAL RULES:
- Provide ONLY the transformed text, no explanations or meta-commentary
- Maintain the original meaning unless specifically asked to change it
- Preserve the original format (markdown, structure, etc.) unless instructed otherwise
- Do not add introductory phrases like "Here's the improved text:" or similar
- Return only the content that should replace the selected text`;
    let specificPrompt = "";
    let userPrompt = "";
    switch (action) {
      case "improve":
        specificPrompt = `
TASK: Improve the writing quality
- Make the text clearer and more concise
- Improve flow and readability
- Fix any awkward phrasing
- Preserve the original tone and meaning`;
        userPrompt = `Improve this text:

${selectedText}`;
        break;
      case "longer":
        specificPrompt = `
TASK: Expand the text with more detail
- Add relevant examples, context, or explanations
- Maintain the original style and voice
- Expand ideas without changing the core message
- Make it more comprehensive and detailed`;
        userPrompt = `Make this text longer and more detailed:

${selectedText}`;
        break;
      case "shorter":
        specificPrompt = `
TASK: Condense the text to essential points
- Remove redundancy and unnecessary words
- Keep all key information and meaning
- Make it more concise and direct
- Preserve the original tone`;
        userPrompt = `Make this text shorter and more concise:

${selectedText}`;
        break;
      case "tone":
        const toneMap = {
          "formal": "professional and structured, suitable for business or academic contexts",
          "casual": "relaxed and conversational, suitable for informal communication",
          "academic": "scholarly and precise, using technical vocabulary where appropriate",
          "friendly": "warm and approachable, building connection with the reader"
        };
        const toneDescription = toneMap[customInstruction || "formal"] || toneMap.formal;
        specificPrompt = `
TASK: Change the tone to be ${toneDescription}
- Adjust language and vocabulary to match the requested tone
- Keep the same content and meaning
- Maintain appropriate formality level for the chosen tone`;
        userPrompt = `Rewrite this text in a ${customInstruction || "formal"} tone:

${selectedText}`;
        break;
      case "custom":
        specificPrompt = `
TASK: Apply custom transformation
- Follow the user's specific instruction exactly
- Maintain content integrity unless asked to change it
- Apply the requested changes precisely`;
        userPrompt = `Apply this instruction to the text: "${customInstruction}"

Text to transform:

${selectedText}`;
        break;
      default:
        specificPrompt = `
TASK: General text improvement
- Enhance clarity and readability
- Preserve original meaning and tone`;
        userPrompt = `Improve this text:

${selectedText}`;
    }
    return {
      systemPrompt: baseSystemPrompt + "\n" + specificPrompt,
      userPrompt
    };
  }
  /**
   * Clean AI response to extract only the transformed text
   */
  cleanAIResponse(response) {
    let cleaned = response.trim();
    const introPatterns = [
      /^Here's the improved text:?\s*/i,
      /^Here's the rewritten text:?\s*/i,
      /^Here's the transformed text:?\s*/i,
      /^Improved version:?\s*/i,
      /^Rewritten:?\s*/i,
      /^Result:?\s*/i,
      /^Output:?\s*/i
    ];
    for (const pattern of introPatterns) {
      cleaned = cleaned.replace(pattern, "");
    }
    cleaned = cleaned.split(/\n\s*---+\s*/).shift() || cleaned;
    cleaned = cleaned.split(/\n\s*\*\*?Explanation\*?\*?:/i).shift() || cleaned;
    return cleaned.trim();
  }
};

// src/ui/tone-selection-modal.ts
var import_obsidian7 = require("obsidian");
var TONE_OPTIONS = [
  {
    id: "formal",
    label: "Formal",
    description: "Professional, structured language suitable for business or academic contexts"
  },
  {
    id: "casual",
    label: "Casual",
    description: "Relaxed, conversational tone for informal communication"
  },
  {
    id: "academic",
    label: "Academic",
    description: "Scholarly, precise language with technical vocabulary"
  },
  {
    id: "friendly",
    label: "Friendly",
    description: "Warm, approachable tone that builds connection"
  }
];
var ToneSelectionModal = class extends import_obsidian7.FuzzySuggestModal {
  constructor(app, onSelect, onCancel) {
    super(app);
    this.onSelect = onSelect;
    this.onCancel = onCancel;
    this.setPlaceholder("Choose a writing tone...");
    this.setInstructions([
      { command: "\u2191\u2193", purpose: "to navigate" },
      { command: "\u21B5", purpose: "to apply tone" },
      { command: "esc", purpose: "to cancel" }
    ]);
  }
  getItems() {
    return TONE_OPTIONS;
  }
  getItemText(tone) {
    return `${tone.label} - ${tone.description}`;
  }
  onChooseItem(tone, evt) {
    this.onSelect(tone.id);
  }
  onClose() {
    const { contentEl } = this;
    if (contentEl.parentElement) {
      this.onCancel();
    }
  }
};

// src/ui/custom-instruction-modal.ts
var import_obsidian8 = require("obsidian");
var CustomInstructionModal = class extends import_obsidian8.Modal {
  constructor(app, onSubmit, onCancel) {
    super(app);
    this.instruction = "";
    this.onSubmit = onSubmit;
    this.onCancel = onCancel;
  }
  onOpen() {
    var _a;
    const { contentEl } = this;
    contentEl.empty();
    this.modalEl.addClass("nova-custom-instruction-modal");
    contentEl.createEl("h2", { text: "Tell Nova" });
    new import_obsidian8.Setting(contentEl).setName("Instruction").setDesc("Describe how you want Nova to transform your selected text");
    const textAreaSetting = new import_obsidian8.Setting(contentEl).addTextArea((text) => {
      text.setPlaceholder('e.g., "make this more persuasive", "add statistics", "write in bullet points"').setValue(this.instruction).onChange((value) => {
        this.instruction = value;
      });
      text.inputEl.rows = 4;
      text.inputEl.style.width = "100%";
      text.inputEl.style.minHeight = "100px";
      setTimeout(() => text.inputEl.focus(), 50);
      text.inputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && (e.ctrlKey || e.metaKey)) {
          e.preventDefault();
          this.submit();
        }
      });
      return text;
    });
    textAreaSetting.settingEl.style.border = "none";
    (_a = textAreaSetting.settingEl.querySelector(".setting-item-info")) == null ? void 0 : _a.remove();
    const control = textAreaSetting.settingEl.querySelector(".setting-item-control");
    if (control instanceof HTMLElement) {
      control.style.width = "100%";
    }
    new import_obsidian8.Setting(contentEl).addButton((btn) => btn.setButtonText("Cancel").onClick(() => {
      this.close();
      this.onCancel();
    })).addButton((btn) => btn.setButtonText("Transform Text").setCta().onClick(() => this.submit()));
  }
  submit() {
    if (this.instruction.trim()) {
      this.close();
      this.onSubmit(this.instruction.trim());
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/ui/selection-context-menu.ts
var SELECTION_ACTIONS = [
  {
    id: "improve",
    label: "Improve Writing",
    icon: "sparkles",
    description: "Make text clearer, more concise, better flow"
  },
  {
    id: "longer",
    label: "Make Longer",
    icon: "plus-circle",
    description: "Expand ideas with more detail and examples"
  },
  {
    id: "shorter",
    label: "Make Shorter",
    icon: "minus-circle",
    description: "Condense to essential points"
  },
  {
    id: "tone",
    label: "Change Tone",
    icon: "palette",
    description: "Adjust writing style and tone"
  },
  {
    id: "custom",
    label: "Tell Nova...",
    icon: "message-circle",
    description: "Custom instruction for transformation"
  }
];
var SelectionContextMenu = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.animatedSelection = null;
    this.selectionEditCommand = new SelectionEditCommand(plugin);
    this.streamingManager = new StreamingManager();
  }
  /**
   * Set callback to be called when streaming completes
   */
  setCompletionCallback(callback) {
    this.completionCallback = callback;
  }
  /**
   * Called when streaming completes
   */
  onStreamingComplete() {
    if (this.completionCallback) {
      this.completionCallback();
    }
  }
  /**
   * Register the context menu with Obsidian's editor
   */
  register() {
    this.plugin.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor) => {
        this.addNovaSubmenu(menu, editor);
      })
    );
  }
  /**
   * Add Nova submenu to the context menu if text is selected
   */
  addNovaSubmenu(menu, editor) {
    const selectedText = editor.getSelection();
    if (!selectedText || selectedText.trim().length === 0) {
      return;
    }
    menu.addSeparator();
    SELECTION_ACTIONS.forEach((action) => {
      menu.addItem((item) => {
        item.setTitle(`Nova: ${action.label}`).setIcon(action.icon || "edit").onClick(() => {
          this.handleSelectionAction(action.id, editor, selectedText);
        });
      });
    });
  }
  /**
   * Handle selection action when menu item is clicked
   */
  async handleSelectionAction(actionId, editor, selectedText, customInstruction) {
    try {
      if (actionId === "tone" && !customInstruction) {
        this.showToneSelectionModal(editor, selectedText);
        return;
      }
      if (actionId === "custom" && !customInstruction) {
        this.showCustomInstructionModal(editor, selectedText);
        return;
      }
      await this.executeSelectionEdit(actionId, editor, selectedText, customInstruction);
    } catch (error) {
      console.error("Error executing Nova selection action:", error);
      new import_obsidian9.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show tone selection modal
   */
  showToneSelectionModal(editor, selectedText) {
    const modal = new ToneSelectionModal(
      this.app,
      async (selectedTone) => {
        await this.executeSelectionEdit("tone", editor, selectedText, selectedTone);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Show custom instruction modal
   */
  showCustomInstructionModal(editor, selectedText) {
    const modal = new CustomInstructionModal(
      this.app,
      async (instruction) => {
        await this.executeSelectionEdit("custom", editor, selectedText, instruction);
      },
      () => {
      }
    );
    modal.open();
  }
  /**
   * Execute the selection edit command with streaming
   */
  async executeSelectionEdit(actionId, editor, selectedText, customInstruction) {
    this.startSelectionAnimation(editor);
    const originalRange = {
      from: editor.getCursor("from"),
      to: editor.getCursor("to")
    };
    try {
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        originalRange.from,
        originalRange.to,
        {
          animationMode: "notice",
          onComplete: () => this.onStreamingComplete()
        }
      );
      this.streamingManager.showThinkingNotice(actionId, "notice");
      const result = await this.selectionEditCommand.executeStreaming(
        actionId,
        editor,
        selectedText,
        (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        },
        customInstruction
      );
      stopStream();
      if (result.success) {
        const actionName = this.getActionDisplayName(actionId);
        new import_obsidian9.Notice(`Nova: Text ${actionName} successfully`, 2e3);
        this.addSuccessChatMessage(actionId, selectedText, customInstruction);
      } else {
        new import_obsidian9.Notice(`Nova: ${result.error || "Failed to process text"}`, 3e3);
        this.addFailureChatMessage(actionId, result.error || "Failed to process text");
        this.restoreOriginalText(editor);
      }
    } catch (error) {
      console.error("Error in streaming selection edit:", error);
      new import_obsidian9.Notice("Failed to execute Nova action. Please try again.", 3e3);
      this.restoreOriginalText(editor);
    } finally {
      this.stopSelectionAnimation();
      this.streamingManager.stopAnimation();
    }
  }
  /**
   * Restore original text if streaming fails completely
   */
  restoreOriginalText(editor) {
  }
  /**
   * Start pulsing animation on selected text
   */
  startSelectionAnimation(editor) {
    var _a;
    try {
      const editorContainer = ((_a = editor.cm) == null ? void 0 : _a.dom) || document.querySelector(".cm-editor");
      if (editorContainer) {
        editorContainer.classList.add("nova-selection-processing");
      }
      const selection = editor.getSelection();
      if (selection) {
        this.animatedSelection = {
          from: editor.getCursor("from"),
          to: editor.getCursor("to")
        };
      }
    } catch (error) {
      console.warn("Failed to start selection animation:", error);
    }
  }
  /**
   * Stop pulsing animation
   */
  stopSelectionAnimation() {
    try {
      const editorElements = document.querySelectorAll(".CodeMirror, .cm-editor");
      editorElements.forEach((el) => {
        el.classList.remove("nova-selection-processing");
      });
      this.animatedSelection = null;
    } catch (error) {
      console.warn("Failed to stop selection animation:", error);
    }
  }
  /**
   * Get display name for action
   */
  getActionDisplayName(actionId) {
    switch (actionId) {
      case "improve":
        return "improved";
      case "longer":
        return "expanded";
      case "shorter":
        return "condensed";
      case "tone":
        return "tone adjusted";
      case "custom":
        return "transformed";
      default:
        return "processed";
    }
  }
  /**
   * Add success message to chat using unified system
   */
  addSuccessChatMessage(actionId, originalText, customInstruction) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView == null ? void 0 : sidebarView.chatRenderer) {
          const actionDescription = this.getActionDescription(actionId, customInstruction);
          const truncatedText = originalText.length > 50 ? originalText.substring(0, 50) + "..." : originalText;
          const message = `\u2713 ${actionDescription} text: "${truncatedText}"`;
          sidebarView.chatRenderer.addSuccessMessage(message, true);
        }
      }
    } catch (error) {
      console.warn("Failed to add success chat message:", error);
    }
  }
  /**
   * Add failure message to chat using unified system
   */
  addFailureChatMessage(actionId, errorMessage) {
    try {
      const leaves = this.app.workspace.getLeavesOfType("nova-sidebar");
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        if (sidebarView == null ? void 0 : sidebarView.chatRenderer) {
          const actionName = this.getActionDisplayName(actionId);
          const message = `\u2717 Failed to ${actionName.replace("ed", "")} text: ${errorMessage}`;
          sidebarView.chatRenderer.addErrorMessage(message, true);
        }
      }
    } catch (error) {
      console.warn("Failed to add error chat message:", error);
    }
  }
  /**
   * Get detailed action description for chat
   */
  getActionDescription(actionId, customInstruction) {
    switch (actionId) {
      case "improve":
        return "Improved";
      case "longer":
        return "Expanded";
      case "shorter":
        return "Condensed";
      case "tone":
        return `Changed tone to ${customInstruction || "formal"}`;
      case "custom":
        return `Applied "${customInstruction}"`;
      default:
        return "Processed";
    }
  }
};

// src/ui/sidebar-view.ts
var VIEW_TYPE_NOVA_SIDEBAR = "nova-sidebar";
var _NovaSidebarView = class _NovaSidebarView extends import_obsidian10.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.currentFile = null;
    this.currentContext = null;
    this.lastTokenWarnings = {};
    // PHASE 3 FIX: Race condition prevention
    this.currentFileLoadOperation = null;
    // Track user-initiated provider changes to prevent spurious messages
    this.isUserInitiatedProviderChange = false;
    // Command system delegation
    this._commandPickerItems = [];
    this._selectedCommandIndex = -1;
    this._isCommandMenuVisible = false;
    // Cursor position tracking - file-scoped like conversation history
    this.currentFileCursorPosition = null;
    // Document drawer state (transient - always starts closed on file switch)
    this.isDrawerOpen = false;
    this.contextDrawerCloseHandler = null;
    // Performance optimization - debouncing and timing constants
    this.contextPreviewDebounceTimeout = null;
    // Event listener cleanup tracking
    this.documentEventListeners = [];
    this.timeouts = [];
    /**
     * Handle provider configuration events
     */
    this.handleProviderConfigured = async (event) => {
      var _a;
      if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
        try {
          this.currentProviderDropdown.updateCurrentProvider();
        } catch (error) {
          console.error("\u274C Failed to update provider display after configuration:", error);
        }
      }
      if (this.privacyIndicator) {
        await this.updatePrivacyIndicator(this.privacyIndicator);
      }
      const dropdownMenu = this.containerEl.querySelector(".nova-provider-dropdown-menu");
      if (dropdownMenu && dropdownMenu.style.display !== "none") {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    /**
     * Handle provider disconnection events - auto-switch to valid model if current becomes invalid
     */
    this.handleProviderDisconnected = async (event) => {
      var _a;
      const customEvent = event;
      const { provider: failedProvider } = customEvent.detail;
      const currentModel = this.plugin.aiProviderManager.getCurrentModel();
      const currentProviderType = getProviderTypeForModel(currentModel, this.plugin.settings);
      if (currentProviderType === failedProvider) {
        const firstAvailableModel = await this.getFirstAvailableModel();
        if (firstAvailableModel) {
          const fallbackProviderType = getProviderTypeForModel(firstAvailableModel, this.plugin.settings);
          if (fallbackProviderType) {
            this.switchToModel(fallbackProviderType, firstAvailableModel);
          }
        } else {
          const platform = import_obsidian10.Platform.isMobile ? "mobile" : "desktop";
          this.plugin.settings.platformSettings[platform].selectedModel = "";
          await this.plugin.saveSettings();
        }
      }
      if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
        try {
          this.currentProviderDropdown.updateCurrentProvider();
        } catch (error) {
          console.error("\u274C Failed to update provider display after disconnection:", error);
        }
      }
      if (this.privacyIndicator) {
        await this.updatePrivacyIndicator(this.privacyIndicator);
      }
      const dropdownMenu = this.containerEl.querySelector(".nova-provider-dropdown-menu");
      if (dropdownMenu && dropdownMenu.style.display !== "none") {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    this.plugin = plugin;
    this.registerDomEvent(document, "nova-provider-configured", this.handleProviderConfigured.bind(this));
    this.registerDomEvent(document, "nova-provider-disconnected", this.handleProviderDisconnected.bind(this));
  }
  // Cursor-only architecture - delegate to new components
  get textArea() {
    var _a;
    return (_a = this.inputHandler) == null ? void 0 : _a.getTextArea();
  }
  get wikilinkAutocomplete() {
    return this.inputHandler ? { destroy: () => {
    } } : null;
  }
  get autoGrowTextarea() {
    return () => {
    };
  }
  get commandPickerItems() {
    return this._commandPickerItems;
  }
  set commandPickerItems(value) {
    this._commandPickerItems = value;
  }
  get selectedCommandIndex() {
    return this._selectedCommandIndex;
  }
  set selectedCommandIndex(value) {
    this._selectedCommandIndex = value;
  }
  get isCommandMenuVisible() {
    return this._isCommandMenuVisible;
  }
  set isCommandMenuVisible(value) {
    this._isCommandMenuVisible = value;
  }
  // Context system delegation
  get contextPreview() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextPreview;
  }
  get contextIndicator() {
    var _a;
    return (_a = this.contextManager) == null ? void 0 : _a.contextIndicator;
  }
  getViewType() {
    return VIEW_TYPE_NOVA_SIDEBAR;
  }
  getDisplayText() {
    return "Nova";
  }
  getIcon() {
    return "nova-star";
  }
  /**
   * Centralized callback for when any streaming operation completes
   * Updates all UI elements that depend on document content
   */
  onStreamingComplete() {
    this.refreshAllStats();
    this.refreshContext();
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.addClass("nova-sidebar-container");
    if (import_obsidian10.Platform.isMobile) {
      container.addClass("is-mobile");
    } else {
      container.addClass("is-desktop");
    }
    const wrapperEl = container.createDiv({ cls: "nova-wrapper" });
    wrapperEl.style.cssText = `
			display: flex;
			flex-direction: column;
			height: 100%;
			overflow: hidden;
			padding-bottom: ${import_obsidian10.Platform.isDesktopApp ? "var(--size-4-6)" : "var(--size-4-5)"};
		`;
    const headerEl = wrapperEl.createDiv({ cls: "nova-header" });
    headerEl.style.cssText = `
			display: flex;
			flex-direction: column;
			padding: var(--size-4-2);
			border-bottom: 1px solid var(--background-modifier-border);
			flex-shrink: 0;
		`;
    const topRowEl = headerEl.createDiv();
    topRowEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
		`;
    const titleEl = topRowEl.createEl("h4");
    titleEl.style.cssText = "margin: 0; font-size: var(--font-ui-medium); display: flex; align-items: center; gap: var(--size-2-2); color: var(--interactive-accent);";
    titleEl.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--icon-size); height: var(--icon-size);">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>Nova`;
    const rightContainer = topRowEl.createDiv();
    rightContainer.style.cssText = "display: flex; align-items: center; gap: var(--size-2-3);";
    const privacyIndicator = rightContainer.createDiv({ cls: "nova-privacy-indicator" });
    this.updatePrivacyIndicator(privacyIndicator);
    this.privacyIndicator = privacyIndicator;
    await this.createProviderDropdown(rightContainer);
    const clearButton = new import_obsidian10.ButtonComponent(rightContainer);
    clearButton.setIcon("eraser").setTooltip("Clear conversation history").onClick(() => this.clearChat());
    const isMobile = import_obsidian10.Platform.isMobile;
    clearButton.buttonEl.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    this.createChatInterface(wrapperEl);
    this.createInputInterface(wrapperEl);
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        this.loadConversationForActiveFile();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-change", (editor) => {
        this.trackCursorPosition(editor);
      })
    );
    this.setupEditorBlurListener();
    this.loadConversationForActiveFile();
    if (this.plugin.selectionContextMenu) {
      this.plugin.selectionContextMenu.setCompletionCallback(() => this.onStreamingComplete());
    }
    this.isUserInitiatedProviderChange = false;
    await this.refreshProviderStatus();
  }
  /**
   * Track cursor position changes in the active editor (file-scoped)
   */
  trackCursorPosition(editor) {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile || !editor) {
      return;
    }
    if (this.currentFile && activeFile.path === this.currentFile.path) {
      const cursorPos = editor.getCursor();
      if (cursorPos) {
        this.currentFileCursorPosition = cursorPos;
      }
    }
  }
  /**
   * Restore cursor position for current file (file-scoped)
   */
  restoreCursorPosition() {
    if (this.currentFileCursorPosition) {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (editor) {
        editor.setCursor(this.currentFileCursorPosition);
      }
    }
  }
  /**
   * Setup focus-based stats updates using Nova input focus as trigger
   */
  setupEditorBlurListener() {
    var _a, _b;
    const inputElement = (_b = (_a = this.inputHandler) == null ? void 0 : _a.getTextArea()) == null ? void 0 : _b.inputEl;
    if (inputElement) {
      this.registerDomEvent(inputElement, "focus", () => {
        this.refreshAllStats();
      });
    }
    this.registerDomEvent(this.containerEl, "mousedown", () => {
      setTimeout(() => {
        this.refreshAllStats();
      }, 50);
    });
  }
  async onClose() {
    var _a;
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.cleanup) {
      this.currentProviderDropdown.cleanup();
    }
    if (this.wikilinkAutocomplete) {
      this.wikilinkAutocomplete.destroy();
    }
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
      this.contextPreviewDebounceTimeout = null;
    }
    this.cleanupEventListeners();
    this.clearTimeouts();
    this.cleanupDOMElements();
  }
  /**
   * Add event listener with automatic cleanup tracking
   */
  addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    this.documentEventListeners.push({ element, event, handler });
  }
  /**
   * Add timeout with automatic cleanup tracking
   */
  addTrackedTimeout(callback, delay) {
    const id = setTimeout(() => {
      callback();
      this.timeouts = this.timeouts.filter((t) => t !== id);
    }, delay);
    this.timeouts.push(id);
    return id;
  }
  /**
   * Clean up all tracked event listeners
   */
  cleanupEventListeners() {
    this.documentEventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    this.documentEventListeners = [];
    if (this.contextDrawerCloseHandler) {
      document.removeEventListener("click", this.contextDrawerCloseHandler);
      this.contextDrawerCloseHandler = null;
    }
  }
  /**
   * Clear all tracked timeouts
   */
  clearTimeouts() {
    this.timeouts.forEach((id) => clearTimeout(id));
    this.timeouts = [];
  }
  /**
   * Clean up DOM elements
   */
  cleanupDOMElements() {
  }
  createChatInterface(container) {
    this.chatContainer = container.createDiv({ cls: "nova-chat-container" });
    this.chatContainer.style.cssText = `
			flex: 1;
			overflow-y: auto;
			padding: var(--size-4-2);
			background: var(--background-secondary);
			display: flex;
			flex-direction: column;
			gap: var(--size-2-3);
		`;
    this.chatRenderer = new ChatRenderer(this.plugin, this.chatContainer);
    this.addWelcomeMessage();
  }
  createInputInterface(container) {
    this.inputContainer = container.createDiv({ cls: "nova-input-container" });
    this.createInputArea();
  }
  /**
   * Create the input area UI elements using new architecture
   */
  createInputArea() {
    this.inputContainer.empty();
    this.contextManager = new ContextManager(this.plugin, this.app, this.inputContainer);
    this.streamingManager = new StreamingManager();
    this.selectionContextMenu = this.plugin.selectionContextMenu;
    this.inputHandler = new InputHandler(this.plugin, this.inputContainer, this.contextManager);
    this.inputHandler.setSidebarView(this);
    this.contextManager.setSidebarView(this);
    this.inputHandler.createInputInterface(this.chatContainer);
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.commandSystem = new CommandSystem(this.plugin, this.inputContainer, this.inputHandler.getTextArea());
      this.inputHandler.setCommandSystem(this.commandSystem);
    }
    this.inputHandler.setOnSendMessage((message) => {
      this.handleSend(message);
    });
    this.contextManager.createContextIndicator();
  }
  addMessage(role, content) {
    const messageEl = this.chatContainer.createDiv({ cls: `nova-message nova-message-${role}` });
    messageEl.style.cssText = `
			margin-bottom: var(--size-4-2);
			padding: var(--size-2-3) var(--size-4-3);
			border-radius: var(--radius-s);
			max-width: 85%;
			${role === "user" ? "margin-left: auto; background: var(--interactive-accent); color: var(--text-on-accent);" : role === "system" ? "margin: 0 auto; background: var(--background-modifier-hover); color: var(--text-muted); text-align: center; font-size: var(--font-text-size);" : "background: var(--background-primary); border: 1px solid var(--background-modifier-border);"}
		`;
    const roleEl = messageEl.createEl("div", {
      text: role === "user" ? "You" : role === "system" ? "System" : "Nova",
      cls: "nova-message-role"
    });
    roleEl.style.cssText = `
			font-size: var(--font-ui-smaller);
			opacity: 0.7;
			margin-bottom: var(--size-2-1);
			font-weight: 600;
		`;
    const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
    if (role === "system" && content.includes("<svg")) {
      contentEl.innerHTML = content;
    } else {
      contentEl.textContent = content;
    }
    setTimeout(() => {
      this.chatContainer.scrollTo({
        top: this.chatContainer.scrollHeight,
        behavior: "smooth"
      });
    }, _NovaSidebarView.SCROLL_DELAY_MS);
  }
  // REPLACE with simple delegation to ChatRenderer:
  addSuccessMessage(content) {
    this.chatRenderer.addSuccessMessage(content, true);
  }
  addErrorMessage(content) {
    this.chatRenderer.addErrorMessage(content, true);
  }
  addWelcomeMessage(message) {
    this.chatRenderer.addWelcomeMessage(message);
  }
  addSuccessIndicator(action) {
    const messages = {
      "add": "\u2713 Content added",
      "edit": "\u2713 Content edited",
      "delete": "\u2713 Content deleted",
      "grammar": "\u2713 Grammar fixed",
      "rewrite": "\u2713 Content rewritten"
    };
    const message = messages[action] || "\u2713 Command completed";
    this.addSuccessMessage(message);
  }
  addErrorIndicator(action, error) {
    const messages = {
      "add": "\u274C Failed to add content",
      "edit": "\u274C Failed to edit content",
      "delete": "\u274C Failed to delete content",
      "grammar": "\u274C Failed to fix grammar",
      "rewrite": "\u274C Failed to rewrite content",
      "execute": "\u274C Command execution error"
    };
    let message = messages[action] || "\u274C Command failed";
    if (error) {
      message += `: ${error}`;
    }
    this.addErrorMessage(message);
  }
  async handleColonCommand(message) {
    var _a;
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addErrorMessage("Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025.");
      return true;
    }
    const command = message.slice(1).toLowerCase();
    const providerCommands = {
      "claude": "claude",
      "chatgpt": "openai",
      "openai": "openai",
      "gemini": "google",
      "google": "google",
      "ollama": "ollama"
    };
    if (providerCommands[command]) {
      const providerId = providerCommands[command];
      await this.plugin.settingTab.setCurrentModel(providerId);
      await this.plugin.saveSettings();
      this.addSuccessMessage(`\u2713 Switched to ${this.getProviderWithModelDisplayName(providerId)}`);
      return true;
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommand = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a.find((cmd) => cmd.trigger === command);
      if (customCommand) {
        this.inputHandler.getTextArea().setValue(customCommand.template);
        setTimeout(() => this.autoGrowTextarea(), 0);
        this.addSuccessMessage(`\u2713 Loaded template: ${customCommand.name}`);
        return true;
      }
    }
    this.addErrorMessage(`\u274C Unknown command ':${command}'. Try :claude, :chatgpt, :gemini, or :ollama`);
    return true;
  }
  createCommandPicker() {
    this.commandPicker = this.inputContainer.createDiv({ cls: "nova-command-picker nova-panel-base" });
    this.commandPicker.style.cssText = `
			position: absolute;
			bottom: 100%;
			left: 0;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			max-height: 200px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
  }
  handleInputChange() {
    const value = this.inputHandler.getTextArea().getValue();
    if (value.startsWith(":") && this.plugin.featureManager.isFeatureEnabled("commands")) {
      const query = value.slice(1).toLowerCase();
      this.showCommandPicker(query);
    } else {
      this.hideCommandPicker();
    }
  }
  showCommandPicker(query) {
    const commands = this.getAvailableCommands().filter(
      (cmd) => cmd.trigger.toLowerCase().includes(query) || cmd.name.toLowerCase().includes(query)
    );
    this.commandPicker.empty();
    this.commandPickerItems = [];
    this.selectedCommandIndex = -1;
    if (commands.length === 0) {
      this.hideCommandPicker();
      return;
    }
    commands.forEach((command, index) => {
      const item = this.commandPicker.createDiv({ cls: "nova-command-item nova-panel-item" });
      const triggerEl = item.createSpan({ cls: "nova-command-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      const nameEl = item.createSpan({ cls: "nova-command-name nova-panel-text" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "flex: 1;";
      if (command.description) {
        const descEl = item.createSpan({ cls: "nova-command-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.selectCommand(command.trigger);
      });
      item.addEventListener("mouseenter", () => {
        this.setSelectedCommand(index);
      });
      this.commandPickerItems.push(item);
    });
    this.commandPicker.style.display = "block";
  }
  hideCommandPicker() {
    this.commandPicker.style.display = "none";
    this.selectedCommandIndex = -1;
  }
  isCommandPickerVisible() {
    return this.commandPicker.style.display === "block";
  }
  navigateCommandPicker(direction) {
    if (this.commandPickerItems.length === 0) return;
    const newIndex = Math.max(0, Math.min(
      this.commandPickerItems.length - 1,
      this.selectedCommandIndex + direction
    ));
    this.setSelectedCommand(newIndex);
  }
  setSelectedCommand(index) {
    this.commandPickerItems.forEach((item) => {
      item.removeClass("selected");
    });
    this.selectedCommandIndex = index;
    if (index >= 0 && index < this.commandPickerItems.length) {
      this.commandPickerItems[index].addClass("selected");
      this.commandPickerItems[index].scrollIntoView({ block: "nearest" });
    }
  }
  handleCommandPickerSelection() {
    if (!this.isCommandPickerVisible() || this.selectedCommandIndex === -1) {
      return false;
    }
    const commands = this.getAvailableCommands();
    const selectedCommand = commands[this.selectedCommandIndex];
    if (selectedCommand) {
      this.selectCommand(selectedCommand.trigger);
      return true;
    }
    return false;
  }
  selectCommand(trigger) {
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.hideCommandPicker();
    this.handleSend();
  }
  getAvailableCommands() {
    var _a;
    const commands = [];
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
    if (selectedText && selectedText.trim().length > 0) {
      SELECTION_ACTIONS.forEach((action) => {
        commands.push({
          trigger: action.id,
          name: `Nova: ${action.label}`,
          description: action.description
        });
      });
      commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Provider Commands" });
    }
    commands.push(
      { trigger: "claude", name: "Switch to Claude", description: "Anthropic Claude AI" },
      { trigger: "chatgpt", name: "Switch to ChatGPT", description: "OpenAI GPT models" },
      { trigger: "gemini", name: "Switch to Gemini", description: "Google Gemini AI" }
    );
    if (import_obsidian10.Platform.isDesktopApp) {
      commands.push({ trigger: "ollama", name: "Switch to Ollama", description: "Local AI models" });
    }
    if (this.plugin.featureManager.isFeatureEnabled("commands")) {
      const customCommands = this.plugin.settings.customCommands || [];
      if (customCommands.length > 0) {
        commands.push({ trigger: "---", name: "\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500", description: "Custom Commands" });
        customCommands.forEach((cmd) => {
          commands.push({
            trigger: cmd.trigger,
            name: cmd.name,
            ...cmd.description && { description: cmd.description }
          });
        });
      }
    }
    return commands;
  }
  createCommandMenu() {
    this.commandMenu = this.inputContainer.createDiv({ cls: "nova-command-menu nova-panel-base" });
    this.commandMenu.style.cssText = `
			position: absolute;
			bottom: 100%;
			right: 0;
			border-bottom: none;
			border-radius: 8px 8px 0 0;
			min-width: 240px;
			max-height: 300px;
			overflow-y: auto;
			z-index: 1000;
			display: none;
			box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
		`;
    const commandMenuClickHandler = (event) => {
      if (!this.commandMenu.contains(event.target) && !this.commandButton.buttonEl.contains(event.target)) {
        this.hideCommandMenu();
      }
    };
    this.addTrackedEventListener(document, "click", commandMenuClickHandler);
  }
  toggleCommandMenu() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      this.addErrorMessage("Commands are currently in early access for Supernova supporters. Available to all users September 30, 2025.");
      return;
    }
    if (this.isCommandMenuVisible) {
      this.hideCommandMenu();
    } else {
      this.showCommandMenu();
    }
  }
  showCommandMenu() {
    const commands = this.getAvailableCommands();
    this.commandMenu.empty();
    const headerEl = this.commandMenu.createDiv({ cls: "nova-command-menu-header nova-panel-header" });
    headerEl.innerHTML = this.createInlineIcon("zap") + " Commands";
    commands.forEach((command) => {
      if (command.trigger === "---") {
        const separator = this.commandMenu.createDiv({ cls: "nova-command-menu-separator" });
        separator.style.cssText = `
					padding: 8px 16px 4px 16px;
					font-size: 0.75em;
					color: var(--text-muted);
					font-weight: 600;
					text-transform: uppercase;
					letter-spacing: 0.5px;
					border-top: 1px solid var(--background-modifier-border);
					margin-top: 4px;
					cursor: default;
				`;
        separator.textContent = command.description || "";
        return;
      }
      const item = this.commandMenu.createDiv({ cls: "nova-command-menu-item nova-panel-item-vertical" });
      const nameEl = item.createDiv({ cls: "nova-command-menu-name nova-panel-text" });
      nameEl.textContent = command.name;
      const triggerEl = item.createDiv({ cls: "nova-command-menu-trigger nova-panel-trigger" });
      triggerEl.textContent = `:${command.trigger}`;
      triggerEl.style.opacity = "0.8";
      if (command.description) {
        const descEl = item.createDiv({ cls: "nova-command-menu-desc nova-panel-muted" });
        descEl.textContent = command.description;
      }
      item.addEventListener("click", () => {
        this.executeCommandFromMenu(command.trigger);
      });
    });
    this.commandMenu.style.display = "block";
    this.isCommandMenuVisible = true;
  }
  hideCommandMenu() {
    this.commandMenu.style.display = "none";
    this.isCommandMenuVisible = false;
  }
  async executeCommandFromMenu(trigger) {
    var _a;
    this.hideCommandMenu();
    const selectionAction = SELECTION_ACTIONS.find((action) => action.id === trigger);
    if (selectionAction) {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
      const selectedText = (_a = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _a.getSelection();
      if ((activeView == null ? void 0 : activeView.editor) && selectedText && selectedText.trim().length > 0) {
        await this.selectionContextMenu.handleSelectionAction(trigger, activeView.editor, selectedText);
      } else {
        new import_obsidian10.Notice("No text selected. Please select text to use Nova editing commands.", 3e3);
      }
      return;
    }
    if (trigger === "---") {
      return;
    }
    this.inputHandler.getTextArea().setValue(`:${trigger}`);
    this.handleSend();
  }
  createContextPreview() {
    const previewContainer = this.inputContainer.createDiv({ cls: "nova-context-preview" });
    previewContainer.style.cssText = `
			display: none;
			padding: 8px 12px;
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: 0.8em;
			color: var(--text-muted);
			transition: all 0.2s ease;
			align-items: center;
			gap: 4px;
		`;
    const previewText = previewContainer.createSpan({ cls: "nova-context-preview-text" });
    previewText.innerHTML = this.createInlineIcon("book-open") + " Context will include: ";
    previewText.style.cssText = "font-weight: 500; display: flex; align-items: center; gap: 6px;";
    const previewList = previewContainer.createSpan({ cls: "nova-context-preview-list" });
    previewList.style.cssText = "color: var(--interactive-accent);";
    return previewContainer;
  }
  /**
   * Debounced version of updateLiveContextPreview for performance
   */
  debouncedUpdateContextPreview() {
    if (this.contextPreviewDebounceTimeout) {
      clearTimeout(this.contextPreviewDebounceTimeout);
    }
    this.contextPreviewDebounceTimeout = setTimeout(() => {
      this.updateLiveContextPreview();
      this.contextPreviewDebounceTimeout = null;
    }, _NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS);
  }
  updateLiveContextPreview() {
    var _a;
    if (!this.contextPreview) {
      return;
    }
    const message = this.inputHandler.getTextArea().getValue();
    if (!message) {
      this.contextPreview.style.display = "none";
      return;
    }
    const refPattern = /(\+)?\[\[([^\]]+?)(?:#([^\]]+?))?\]\]/g;
    const foundRefs = [];
    let match;
    while ((match = refPattern.exec(message)) !== null) {
      const docName = match[2];
      const property = match[3];
      const file = this.findFileByName(docName);
      if (file) {
        foundRefs.push({
          name: docName,
          property
        });
      }
    }
    const persistentDocs = this.contextManager.getPersistentContext(((_a = this.currentFile) == null ? void 0 : _a.path) || "");
    persistentDocs.forEach((doc) => {
      const exists = foundRefs.some((ref) => ref.name === doc.file.basename);
      if (!exists) {
        foundRefs.push({
          name: doc.file.basename,
          property: doc.property
        });
      }
    });
    if (foundRefs.length > 0) {
      const previewList = this.contextPreview.querySelector(".nova-context-preview-list");
      if (previewList) {
        const docNames = foundRefs.map((ref) => {
          const suffix = ref.property ? `#${ref.property}` : "";
          return `${ref.name}${suffix}`;
        });
        previewList.textContent = docNames.join(", ");
      }
      this.contextPreview.style.display = "block";
    } else {
      this.contextPreview.style.display = "none";
    }
  }
  findFileByName(nameOrPath) {
    let file = this.app.vault.getAbstractFileByPath(nameOrPath);
    if (!file || !(file instanceof import_obsidian10.TFile)) {
      file = this.app.vault.getAbstractFileByPath(nameOrPath + ".md");
    }
    if (!file || !(file instanceof import_obsidian10.TFile)) {
      const files = this.app.vault.getMarkdownFiles();
      file = files.find(
        (f) => f.basename === nameOrPath || f.name === nameOrPath || f.path.endsWith("/" + nameOrPath) || f.path.endsWith("/" + nameOrPath + ".md")
      ) || null;
    }
    return file instanceof import_obsidian10.TFile ? file : null;
  }
  updateContextIndicator() {
    var _a, _b, _c, _d;
    if (!this.contextIndicator) {
      return;
    }
    const newDocCount = ((_b = (_a = this.currentContext) == null ? void 0 : _a.persistentDocs) == null ? void 0 : _b.length) || 0;
    const currentDocCount = this.contextIndicator.getAttribute("data-doc-count");
    const currentFilePath = this.contextIndicator.getAttribute("data-file-path");
    const newFilePath = ((_c = this.currentFile) == null ? void 0 : _c.path) || "";
    if (currentDocCount === newDocCount.toString() && currentFilePath === newFilePath && newDocCount > 0) {
      return;
    }
    if (this.contextDrawerCloseHandler) {
      document.removeEventListener("click", this.contextDrawerCloseHandler);
      this.contextDrawerCloseHandler = null;
    }
    this.contextIndicator.empty();
    if (!this.currentContext || !this.currentContext.persistentDocs) {
      this.contextIndicator.style.display = "none";
      this.contextIndicator.removeAttribute("data-doc-count");
      this.contextIndicator.removeAttribute("data-file-path");
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    const allDocs = this.currentContext.persistentDocs;
    if (!allDocs || allDocs.length === 0) {
      this.contextIndicator.style.display = "none";
      this.contextIndicator.removeAttribute("data-doc-count");
      this.contextIndicator.removeAttribute("data-file-path");
      if (this.inputHandler) {
        this.inputHandler.updateContextState(false);
      }
      return;
    }
    this.contextIndicator.setAttribute("data-doc-count", allDocs.length.toString());
    this.contextIndicator.setAttribute("data-file-path", ((_d = this.currentFile) == null ? void 0 : _d.path) || "");
    if (this.inputHandler) {
      this.inputHandler.updateContextState(true);
    }
    const isMobile = import_obsidian10.Platform.isMobile;
    this.contextIndicator.style.cssText = `
			display: flex;
			position: relative;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			margin-bottom: 4px;
			background: rgba(var(--interactive-accent-rgb), 0.1);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			font-size: ${isMobile ? "0.9em" : "0.8em"};
			color: var(--text-muted);
			transition: all 0.2s ease;
			cursor: pointer;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const summaryEl = this.contextIndicator.createDiv({ cls: "nova-context-summary" });
    summaryEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%;
			height: 100%;
			cursor: pointer;
			pointer-events: auto;
		`;
    const summaryTextEl = summaryEl.createSpan({ cls: "nova-context-summary-text" });
    const docNames = allDocs.filter((doc) => {
      var _a2;
      return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
    }).map((doc) => doc.file.basename).slice(0, isMobile ? 1 : 2);
    const moreCount = allDocs.length > (isMobile ? 1 : 2) ? ` +${allDocs.length - (isMobile ? 1 : 2)}` : "";
    summaryTextEl.style.cssText = "font-weight: 500; color: var(--text-muted); flex: 1; pointer-events: none; display: flex; align-items: center; gap: 6px; min-width: 0;";
    const filenamePartEl = summaryTextEl.createSpan();
    filenamePartEl.style.cssText = "display: flex; align-items: center; gap: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; min-width: 0; flex: 1;";
    const iconSpan = filenamePartEl.createSpan();
    iconSpan.innerHTML = this.createInlineIcon("book-open");
    iconSpan.style.cssText = "flex-shrink: 0; display: flex; align-items: center;";
    const textSpan = filenamePartEl.createSpan();
    textSpan.textContent = `${docNames.join(", ")}${moreCount}`;
    textSpan.style.cssText = "overflow: hidden; text-overflow: ellipsis; min-width: 0;";
    const expandIndicatorEl = summaryEl.createSpan({ cls: "nova-context-expand-indicator" });
    expandIndicatorEl.innerHTML = this.createInlineIcon("more-horizontal", isMobile ? "16px" : "14px");
    expandIndicatorEl.style.cssText = `
			color: var(--interactive-accent);
			font-size: ${isMobile ? "16px" : "14px"};
			opacity: 0.8;
			padding: ${isMobile ? "8px" : "4px"};
			min-width: ${isMobile ? "44px" : "auto"};
			text-align: center;
			border-radius: 4px;
			transition: all 0.2s;
			pointer-events: none;
		`;
    expandIndicatorEl.setAttr("title", "Tap to manage documents");
    if (isMobile) {
      summaryEl.addEventListener("touchstart", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("touchend", () => {
        this.addTrackedTimeout(() => {
          expandIndicatorEl.style.background = "none";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      summaryEl.addEventListener("mouseenter", () => {
        expandIndicatorEl.style.background = "rgba(var(--interactive-accent-rgb), 0.2)";
      });
      summaryEl.addEventListener("mouseleave", () => {
        expandIndicatorEl.style.background = "none";
      });
    }
    const expandedEl = this.contextIndicator.createDiv({ cls: "nova-context-expanded" });
    expandedEl.style.cssText = `
			display: none;
			position: absolute;
			bottom: 100%;
			left: ${isMobile ? "-8px" : "0"};
			right: ${isMobile ? "-8px" : "0"};
			background: var(--background-primary);
			border: 1px solid rgba(var(--interactive-accent-rgb), 0.2);
			border-radius: 6px;
			box-shadow: 0 ${isMobile ? "-4px 16px" : "-2px 8px"} rgba(0, 0, 0, ${isMobile ? "0.15" : "0.1"});
			z-index: 1000;
			margin-bottom: 2px;
			max-height: ${isMobile ? "60vh" : "200px"};
			overflow-y: auto;
			min-width: ${isMobile ? "100%" : "auto"};
		`;
    const expandedHeaderEl = expandedEl.createDiv({ cls: "nova-context-expanded-header" });
    expandedHeaderEl.style.cssText = `
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: ${isMobile ? "12px 16px" : "8px 12px"};
			border-bottom: 1px solid var(--background-modifier-border);
			font-weight: 500;
			color: var(--text-normal);
			font-size: 1em;
			min-height: ${isMobile ? "44px" : "auto"};
		`;
    const headerTitleEl = expandedHeaderEl.createSpan();
    headerTitleEl.innerHTML = this.createInlineIcon("book-open") + ` Documents (${allDocs.length})`;
    headerTitleEl.style.cssText = "display: flex; align-items: center; gap: 6px;";
    const clearAllBtnComponent = new import_obsidian10.ButtonComponent(expandedHeaderEl);
    clearAllBtnComponent.setIcon("trash-2").setTooltip("Clear all documents from context").onClick(async () => {
      if (this.currentFile) {
        this.contextManager.clearPersistentContext(this.currentFile.path);
        await this.refreshContext();
      }
    });
    const clearAllBtn = clearAllBtnComponent.buttonEl;
    clearAllBtn.addClass("nova-context-clear-all-btn");
    clearAllBtn.style.cssText = `
			background: none;
			border: 1px solid var(--text-faint);
			color: var(--text-faint);
			cursor: pointer;
			padding: ${isMobile ? "8px 12px" : "4px 8px"};
			border-radius: 4px;
			font-size: 1em;
			transition: all 0.2s;
			min-width: ${isMobile ? "44px" : "auto"};
			min-height: ${isMobile ? "44px" : "auto"};
			display: flex;
			align-items: center;
			justify-content: center;
		`;
    if (isMobile) {
      clearAllBtn.addEventListener("touchstart", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("touchend", () => {
        setTimeout(() => {
          clearAllBtn.style.background = "none";
          clearAllBtn.style.borderColor = "var(--text-faint)";
          clearAllBtn.style.color = "var(--text-faint)";
        }, _NovaSidebarView.HOVER_TIMEOUT_MS);
      });
    } else {
      clearAllBtn.addEventListener("mouseenter", () => {
        clearAllBtn.style.background = "var(--background-modifier-error)";
        clearAllBtn.style.borderColor = "var(--text-error)";
        clearAllBtn.style.color = "var(--text-error)";
      });
      clearAllBtn.addEventListener("mouseleave", () => {
        clearAllBtn.style.background = "none";
        clearAllBtn.style.borderColor = "var(--text-faint)";
        clearAllBtn.style.color = "var(--text-faint)";
      });
    }
    const docListEl = expandedEl.createDiv({ cls: "nova-context-doc-list" });
    allDocs.filter((doc) => {
      var _a2;
      return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
    }).forEach((doc, index) => {
      const docItemEl = docListEl.createDiv({ cls: "nova-context-doc-item" });
      docItemEl.style.cssText = `
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: ${isMobile ? "12px 16px" : "8px 12px"};
				border-bottom: ${index < allDocs.length - 1 ? "1px solid var(--background-modifier-border)" : "none"};
				transition: background-color 0.2s;
				min-height: ${isMobile ? "56px" : "auto"};
			`;
      const docInfoEl = docItemEl.createDiv({ cls: "nova-context-doc-info" });
      docInfoEl.style.cssText = `
				display: flex;
				align-items: center;
				gap: ${isMobile ? "12px" : "8px"};
				flex: 1;
				min-width: 0;
			`;
      const iconEl = docInfoEl.createSpan();
      iconEl.innerHTML = this.createInlineIcon("file-text");
      iconEl.style.cssText = "display: flex; align-items: center; font-size: 1em; flex-shrink: 0;";
      const nameEl = docInfoEl.createSpan({ cls: "nova-context-doc-name" });
      const suffix = doc.property ? `#${doc.property}` : "";
      nameEl.textContent = `${doc.file.basename}${suffix}`;
      nameEl.style.cssText = `
				font-weight: 400;
				color: var(--text-normal);
				text-overflow: ellipsis;
				overflow: hidden;
				white-space: nowrap;
				font-size: 1em;
				line-height: 1.4;
				flex: 1;
				min-width: 0;
				margin-right: 8px;
			`;
      nameEl.setAttr("title", `${doc.file.path} (read-only for editing)`);
      const readOnlyEl = docInfoEl.createSpan({ cls: "nova-context-readonly" });
      readOnlyEl.textContent = "read-only";
      readOnlyEl.style.cssText = `
				font-size: 0.75em;
				color: var(--text-muted);
				background: var(--background-modifier-hover);
				padding: 1px 4px;
				border-radius: 3px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
				flex-shrink: 0;
				margin-right: 8px;
			`;
      const removeBtn = docItemEl.createEl("button", { cls: "nova-context-doc-remove" });
      removeBtn.textContent = "\xD7";
      removeBtn.style.cssText = `
				background: none;
				border: none;
				color: var(--text-faint);
				cursor: pointer;
				width: ${isMobile ? "44px" : "20px"};
				height: ${isMobile ? "44px" : "20px"};
				border-radius: 4px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: ${isMobile ? "18px" : "14px"};
				transition: all 0.2s;
				font-weight: normal;
				line-height: 1;
			`;
      removeBtn.setAttr("title", `Remove ${doc.file.basename}`);
      removeBtn.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (this.currentFile) {
          this.contextManager.removePersistentDoc(this.currentFile.path, doc.file.path);
          await this.refreshContext();
        }
      });
      if (isMobile) {
        removeBtn.addEventListener("touchstart", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("touchend", () => {
          setTimeout(() => {
            removeBtn.style.background = "none";
            removeBtn.style.color = "var(--text-faint)";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
        docItemEl.addEventListener("touchstart", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("touchend", () => {
          setTimeout(() => {
            docItemEl.style.background = "transparent";
          }, _NovaSidebarView.HOVER_TIMEOUT_MS);
        });
      } else {
        removeBtn.addEventListener("mouseenter", () => {
          removeBtn.style.background = "var(--background-modifier-error)";
          removeBtn.style.color = "var(--text-error)";
        });
        removeBtn.addEventListener("mouseleave", () => {
          removeBtn.style.background = "none";
          removeBtn.style.color = "var(--text-faint)";
        });
        docItemEl.addEventListener("mouseenter", () => {
          docItemEl.style.background = "var(--background-modifier-hover)";
        });
        docItemEl.addEventListener("mouseleave", () => {
          docItemEl.style.background = "transparent";
        });
      }
    });
    this.isDrawerOpen = false;
    expandedEl.style.display = "none";
    const toggleExpanded = (e) => {
      e.stopPropagation();
      this.isDrawerOpen = !this.isDrawerOpen;
      if (this.isDrawerOpen) {
        expandedEl.style.display = "block";
        this.contextIndicator.style.zIndex = "1001";
      } else {
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    summaryEl.addEventListener("click", toggleExpanded);
    this.contextDrawerCloseHandler = (e) => {
      if (this.isDrawerOpen && !this.contextIndicator.contains(e.target)) {
        this.isDrawerOpen = false;
        expandedEl.style.display = "none";
        this.contextIndicator.style.zIndex = "auto";
      }
    };
    document.addEventListener("click", this.contextDrawerCloseHandler);
  }
  async refreshContext() {
    if (this.currentFile) {
      if (this.contextManager.getCurrentFilePath() !== this.currentFile.path) {
        this.contextManager.setCurrentFile(this.currentFile);
      }
      try {
        this.currentContext = await this.contextManager.buildContext("", this.currentFile);
        this.updateContextIndicator();
        this.updateTokenDisplay();
      } catch (error) {
        console.warn("Failed to refresh context:", error);
        this.currentContext = null;
        this.updateContextIndicator();
        this.updateTokenDisplay();
      }
    } else {
      this.currentContext = null;
      this.contextManager.setCurrentFile(null);
      this.updateContextIndicator();
      this.updateTokenDisplay();
    }
  }
  async handleSend(message) {
    var _a, _b, _c, _d, _e, _f;
    const messageText = message || this.inputHandler.getValue().trim();
    if (!messageText) return;
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    if (!currentProviderType) {
      this.addErrorMessage(this.createIconMessage("alert-circle", "Nova is disabled or no AI provider is available. Please configure an AI provider in settings."));
      return;
    }
    if (messageText.startsWith(":")) {
      const commandResult = await this.handleColonCommand(messageText);
      if (commandResult) {
        this.inputHandler.setValue("");
        return;
      }
    }
    let processedMessage = messageText;
    let multiDocContext = null;
    if (this.currentFile) {
      const context = await this.contextManager.buildContext(messageText, this.currentFile);
      const contextResult = context ? { cleanedMessage: "", context } : null;
      processedMessage = (contextResult == null ? void 0 : contextResult.cleanedMessage) || messageText;
      multiDocContext = (contextResult == null ? void 0 : contextResult.context) || null;
      this.currentContext = multiDocContext;
      this.updateContextIndicator();
      const previousPersistentCount = ((_b = (_a = this.currentContext) == null ? void 0 : _a.persistentDocs) == null ? void 0 : _b.length) || 0;
      const currentPersistentCount = ((_c = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _c.length) || 0;
      const hasNewDocs = currentPersistentCount > previousPersistentCount;
      const isContextOnlyMessage = processedMessage.trim().length === 0 && hasNewDocs;
      if (isContextOnlyMessage) {
        const newDocsCount = currentPersistentCount - previousPersistentCount;
        if (newDocsCount > 0 && (multiDocContext == null ? void 0 : multiDocContext.persistentDocs) && multiDocContext.persistentDocs.length > 0) {
          const newDocs = multiDocContext.persistentDocs.slice(-newDocsCount);
          const docNames = newDocs.filter((doc) => {
            var _a2;
            return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
          }).map((doc) => doc.file.basename).join(", ");
          if (docNames) {
            this.addSuccessMessage(this.createIconMessage("check-circle", `Added ${newDocsCount} document${newDocsCount !== 1 ? "s" : ""} to persistent context: ${docNames}`));
          }
        }
        this.inputHandler.setValue("");
        this.updateContextIndicator();
        if (this.contextPreview) {
          this.contextPreview.style.display = "none";
        }
        return;
      }
      if ((_d = multiDocContext == null ? void 0 : multiDocContext.persistentDocs) == null ? void 0 : _d.length) {
        const allDocs = multiDocContext.persistentDocs;
        const docNames = allDocs.filter((doc) => {
          var _a2;
          return (_a2 = doc == null ? void 0 : doc.file) == null ? void 0 : _a2.basename;
        }).map((doc) => doc.file.basename).join(", ");
        if (docNames && allDocs.length > 0) {
          const tokenInfo = multiDocContext.tokenCount > 0 ? ` (~${multiDocContext.tokenCount} tokens)` : "";
          const currentFile = ((_e = this.currentFile) == null ? void 0 : _e.basename) || "current file";
          this.addSuccessMessage(`\u2713 Included ${allDocs.length} document${allDocs.length !== 1 ? "s" : ""} in context: ${docNames}${tokenInfo}. Context documents are read-only; edit commands will only modify ${currentFile}.`);
        }
      }
      if (multiDocContext == null ? void 0 : multiDocContext.isNearLimit) {
        new import_obsidian10.Notice("\u26A0\uFE0F Approaching token limit. Consider removing some documents from context.", _NovaSidebarView.NOTICE_DURATION_MS);
      }
    }
    this.inputHandler.setValue("");
    if (this.contextPreview) {
      this.contextPreview.style.display = "none";
    }
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(true);
    try {
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile) {
        await this.plugin.conversationManager.addUserMessage(activeFile, messageText, null);
        this.addMessage("user", messageText);
      }
      const loadingEl = this.chatContainer.createDiv({ cls: "nova-loading" });
      loadingEl.style.cssText = `
				padding: 12px 16px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 12px;
				margin-bottom: 8px;
				max-width: 80%;
				display: flex;
				align-items: center;
				gap: 10px;
			`;
      const novaContainer = loadingEl.createDiv({ cls: "nova-burst-container" });
      novaContainer.innerHTML = `
				<div class="nova-burst">
					<div class="nova-core"></div>
					<div class="nova-ring nova-ring-1"></div>
					<div class="nova-ring nova-ring-2"></div>
					<div class="nova-ring nova-ring-3"></div>
				</div>
			`;
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
      const selectedText = (_f = activeView == null ? void 0 : activeView.editor) == null ? void 0 : _f.getSelection();
      const hasSelection = !!(selectedText && selectedText.trim().length > 0);
      const intent = await this.plugin.aiIntentClassifier.classifyIntent(processedMessage, hasSelection);
      let contextualCommand;
      if (intent === "METADATA" || intent === "CONTENT") {
        contextualCommand = this.plugin.commandParser.parseCommand(processedMessage);
      }
      const initialPhrase = this.getContextualThinkingPhrase(contextualCommand, processedMessage);
      const loadingTextEl = loadingEl.createSpan({ text: initialPhrase });
      loadingTextEl.style.cssText = "color: var(--interactive-accent); font-size: var(--font-text-size); font-weight: 500;";
      this.startThinkingPhraseRotation(loadingTextEl, contextualCommand, processedMessage);
      let response = null;
      if (intent === "METADATA" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else if (intent === "CONTENT" && activeFile) {
        const parsedCommand = this.plugin.commandParser.parseCommand(processedMessage);
        response = await this.executeCommand(parsedCommand);
      } else {
        const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(processedMessage, activeFile || void 0);
        if (multiDocContext && multiDocContext.contextString) {
          const enhancedSystemPrompt = (prompt2.systemPrompt || "") + `

MULTI-DOCUMENT CONTEXT INSTRUCTIONS:
- You have access to multiple documents as REFERENCE CONTEXT ONLY
- These documents are for your understanding and background knowledge
- DO NOT echo, quote, or output content from these context documents unless specifically requested
- When responding, focus on the user's request, not the content of context documents
- Context documents are read-only; you can only edit the current working document
- If the user asks about context documents, you may reference and discuss their content`;
          const enhancedUserPrompt = `REFERENCE CONTEXT (for your understanding only):
${multiDocContext.contextString}

---

USER REQUEST: ${processedMessage}`;
          response = await this.plugin.aiProviderManager.complete(enhancedSystemPrompt, enhancedUserPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        } else {
          response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt, {
            temperature: prompt2.config.temperature,
            maxTokens: prompt2.config.maxTokens
          });
        }
      }
      const loadingTextSpan = loadingEl.querySelector("span");
      if (loadingTextSpan) {
        this.stopThinkingPhraseRotation(loadingTextSpan);
      }
      loadingEl.remove();
      const filteredResponse = response ? this.filterThinkingContent(response) : response;
      if (activeFile && filteredResponse) {
        await this.plugin.documentEngine.addAssistantMessage(filteredResponse);
      }
      if (filteredResponse) {
        if (filteredResponse.includes("x-circle") || filteredResponse.includes("Error executing command") || filteredResponse.includes("Failed to") || filteredResponse.includes("No markdown file is open") || filteredResponse.includes("Unable to access") || filteredResponse.includes("Unable to set")) {
          this.addErrorMessage(filteredResponse);
        } else {
          this.addMessage("assistant", filteredResponse);
        }
      }
    } catch (error) {
      const loadingEl = this.chatContainer.querySelector(".nova-loading");
      if (loadingEl) {
        const loadingTextSpan = loadingEl.querySelector("span");
        if (loadingTextSpan) {
          this.stopThinkingPhraseRotation(loadingTextSpan);
        }
        loadingEl.remove();
      }
      const errorMessage = error.message;
      let displayMessage;
      if (errorMessage.includes("Google API error")) {
        displayMessage = errorMessage;
      } else if (errorMessage.includes("OpenAI API error")) {
        displayMessage = errorMessage;
      } else if (errorMessage.includes("API key")) {
        displayMessage = `${errorMessage}. Please check your settings.`;
      } else if (errorMessage.includes("Failed to fetch") || errorMessage.includes("NetworkError")) {
        displayMessage = "Network error. Please check your internet connection and try again.";
      } else {
        displayMessage = `Sorry, I encountered an error: ${errorMessage}`;
      }
      this.addErrorMessage(displayMessage);
    } finally {
      const sendButton2 = this.inputHandler.sendButton;
      if (sendButton2) sendButton2.setDisabled(false);
      await this.refreshContext();
    }
  }
  async insertTextIntoActiveNote(text) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.ItemView);
    if (activeView && "editor" in activeView) {
      const editor = activeView.editor;
      if (editor) {
        const cursor = editor.getCursor();
        editor.replaceRange(text, cursor);
      }
    }
  }
  async executeCommand(command) {
    try {
      if (!this.currentFile) {
        return this.createIconMessage("x-circle", "No markdown file is open. Please open a file in the editor to use editing commands.");
      }
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let markdownView = null;
      for (const leaf of leaves) {
        const view = leaf.view;
        if (view.file === this.currentFile) {
          markdownView = view;
          break;
        }
      }
      if (!markdownView) {
        const leaf = this.app.workspace.getLeaf(false);
        if (leaf) {
          await leaf.openFile(this.currentFile);
          markdownView = leaf.view;
        }
      }
      if (!markdownView) {
        return this.createIconMessage("x-circle", `Unable to access the file "${this.currentFile.basename}". Please make sure it's open in the editor.`);
      }
      const activeFile = this.app.workspace.getActiveFile();
      if (!activeFile || activeFile !== this.currentFile) {
        this.app.workspace.setActiveLeaf(markdownView.leaf, { focus: false });
        await new Promise((resolve) => setTimeout(resolve, 50));
        const nowActiveFile = this.app.workspace.getActiveFile();
        if (!nowActiveFile || nowActiveFile !== this.currentFile) {
          return this.createIconMessage("x-circle", `Unable to set "${this.currentFile.basename}" as the active file. Edit commands can only modify the file you're chatting about to prevent accidental changes to context documents.`);
        }
      }
      const currentPos = this.plugin.documentEngine.getCursorPosition();
      if (currentPos) {
        this.currentFileCursorPosition = currentPos;
      }
      this.restoreCursorPosition();
      let result;
      switch (command.action) {
        case "add":
          result = await this.executeAddCommandWithStreaming(command);
          break;
        case "edit":
          result = await this.executeEditCommandWithStreaming(command);
          break;
        case "delete":
          result = await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          result = await this.executeGrammarCommandWithStreaming(command);
          break;
        case "rewrite":
          result = await this.executeRewriteCommandWithStreaming(command);
          break;
        case "metadata":
          result = await this.plugin.metadataCommandHandler.execute(command);
          break;
        default:
          return `I don't understand the command "${command.action}". Try asking me to add, edit, delete, fix grammar, rewrite content, or update metadata/properties.`;
      }
      if (result.success) {
        this.addSuccessIndicator(command.action);
        return null;
      } else {
        this.addErrorIndicator(command.action, result.error);
        return null;
      }
    } catch (error) {
      this.addErrorIndicator("execute", error.message);
      return null;
    }
  }
  async loadConversationForActiveFile() {
    const activeFile = this.app.workspace.getActiveFile();
    this.isUserInitiatedProviderChange = false;
    const operationId = Date.now().toString() + Math.random().toString(36).substr(2, 9);
    this.currentFileLoadOperation = operationId;
    let targetFile = activeFile;
    if (!targetFile) {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (activeLeaf && activeLeaf.view instanceof import_obsidian10.MarkdownView) {
        targetFile = activeLeaf.view.file;
      } else {
        const leaves = this.app.workspace.getLeavesOfType("markdown");
        if (leaves.length > 0) {
          const view = leaves[0].view;
          targetFile = view.file;
        }
      }
    }
    if (!targetFile && this.currentFile) {
      this.currentFile = null;
      this.chatContainer.empty();
      this.currentContext = null;
      this.contextManager.setCurrentFile(null);
      this.refreshContext();
      this.addWelcomeMessage("Open a document to get started.");
      return;
    }
    if (!targetFile || targetFile === this.currentFile) {
      return;
    }
    this.contextManager.setCurrentFile(targetFile);
    this.currentFileCursorPosition = null;
    this.currentFile = targetFile;
    this.currentContext = this.contextManager.getCurrentContext();
    this.updateContextIndicator();
    this.refreshAllStats();
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    if (activeView && activeView.editor) {
      this.trackCursorPosition(activeView.editor);
    }
    this.chatContainer.empty();
    if (this.currentFileLoadOperation !== operationId) {
      return;
    }
    try {
      await this.chatRenderer.loadConversationHistory(targetFile);
      if (this.currentFileLoadOperation !== operationId) {
        return;
      }
      await this.contextManager.restoreContextAfterChatLoad(targetFile);
      await this.refreshContext();
      await this.showDocumentInsights(targetFile);
      if (this.currentFileLoadOperation !== operationId) {
        return;
      }
    } catch (error) {
      console.error("Conversation loading error:", error);
      this.addWelcomeMessage();
    }
  }
  async clearChat() {
    this.chatContainer.empty();
    if (this.currentFile) {
      try {
        await this.plugin.conversationManager.clearConversation(this.currentFile);
        this.lastTokenWarnings = {};
      } catch (error) {
      }
    }
    new import_obsidian10.Notice("Chat cleared");
    this.addWelcomeMessage();
    if (this.currentFile) {
      await this.refreshContext();
    }
  }
  // Coordinator method that updates both document stats and context remaining
  async refreshAllStats() {
    if (this.streamingManager.isStreaming()) {
      return;
    }
    await this.updateDocumentStats();
    await this.refreshContext();
    this.updateContextRemaining();
  }
  // Update only document statistics (word count, sections)
  async updateDocumentStats() {
    const activeFile = this.app.workspace.getActiveFile();
    if (!activeFile) return;
    try {
      const content = await this.app.vault.read(activeFile);
      if (!content) return;
      const wordCount = content.split(/\s+/).filter((word) => word.length > 0).length;
      const headingCount = (content.match(/^#{1,6}\s/gm) || []).length;
      const headerEl = this.containerEl.querySelector(".nova-header");
      if (headerEl) {
        let statsContainer = headerEl.querySelector(".nova-document-stats-container");
        if (!statsContainer) {
          statsContainer = headerEl.createEl("div", { cls: "nova-document-stats-container" });
        }
        let statsEl = statsContainer.querySelector(".nova-document-stats");
        if (!statsEl) {
          statsEl = statsContainer.createEl("div", { cls: "nova-document-stats" });
        }
        if (statsEl && wordCount > 0) {
          const readingTime = Math.ceil(wordCount / 225);
          statsEl.textContent = `~ ${readingTime} min read`;
        }
      }
    } catch (error) {
    }
  }
  // Update only context remaining display (token percentage)
  updateContextRemaining() {
    this.updateTokenDisplay();
  }
  updateTokenDisplay() {
    var _a, _b;
    const headerEl = this.containerEl.querySelector(".nova-header");
    if (!headerEl) return;
    let statsContainer = headerEl.querySelector(".nova-document-stats-container");
    if (!statsContainer) {
      statsContainer = headerEl.createEl("div", { cls: "nova-document-stats-container" });
    }
    let statsEl = statsContainer.querySelector(".nova-document-stats");
    if (!statsEl) {
      statsEl = statsContainer.createEl("div", { cls: "nova-document-stats" });
    }
    let tokenEl = statsContainer.querySelector(".nova-token-usage");
    if (!tokenEl) {
      tokenEl = statsContainer.createEl("div", { cls: "nova-token-usage" });
    }
    const totalContextUsage = (_a = this.currentContext) == null ? void 0 : _a.totalContextUsage;
    let remainingPercent;
    let warningLevel;
    let displayText;
    let tooltipText;
    if (totalContextUsage) {
      remainingPercent = getRemainingContextPercentage(totalContextUsage);
      warningLevel = getContextWarningLevel(totalContextUsage);
      displayText = formatContextUsage(totalContextUsage);
      tooltipText = getContextTooltip(totalContextUsage);
    } else {
      const currentTokens = ((_b = this.currentContext) == null ? void 0 : _b.tokenCount) || 0;
      remainingPercent = 100;
      displayText = currentTokens > 0 ? `${currentTokens} tokens` : "0% left";
      tooltipText = `File context: ${currentTokens} tokens (total context calculation unavailable)`;
      warningLevel = "safe";
    }
    tokenEl.textContent = displayText;
    tokenEl.title = tooltipText;
    tokenEl.className = "nova-token-usage";
    if (warningLevel === "safe") {
      tokenEl.addClass("nova-token-safe");
    } else if (warningLevel === "warning") {
      tokenEl.addClass("nova-token-warning");
      this.showTokenWarning(85);
    } else if (warningLevel === "critical") {
      tokenEl.addClass("nova-token-danger");
      this.showTokenWarning(95);
    }
  }
  showTokenWarning(threshold) {
    const warningKey = `token-warning-${threshold}`;
    if (this.lastTokenWarnings[warningKey]) return;
    this.lastTokenWarnings[warningKey] = Date.now();
    let message;
    if (threshold === 75) {
      message = "\u2139\uFE0F Context usage is growing. Current conversation and file context are using significant tokens.";
    } else if (threshold === 85) {
      message = "\u26A0\uFE0F Context usage high (85%). Consider starting a new conversation or removing file context for better AI performance.";
    } else if (threshold === 95) {
      message = "\u26A0\uFE0F Context nearly full (95%). Start a new conversation or clear context immediately for reliable AI responses.";
    } else {
      message = "\u26A0\uFE0F Context approaching limit. Consider clearing context or starting a new conversation.";
    }
    this.addWarningMessage(message);
  }
  addWarningMessage(content) {
    this.chatRenderer.addWarningMessage(content, true);
  }
  async showDocumentInsights(file) {
    try {
      const content = await this.app.vault.read(file);
      const analysis = DocumentAnalyzer.analyzeStructure(content);
      if (analysis.emptyHeadings.length > 0 || analysis.incompleteBullets.length > 0) {
        const insights = [];
        if (analysis.emptyHeadings.length > 0) {
          insights.push(`${analysis.emptyHeadings.length} empty heading${analysis.emptyHeadings.length > 1 ? "s" : ""} to fill`);
        }
        if (analysis.incompleteBullets.length > 0) {
          insights.push(`${analysis.incompleteBullets.length} incomplete bullet${analysis.incompleteBullets.length > 1 ? "s" : ""}`);
        }
        if (insights.length > 0) {
          const bulletList = insights.map((insight) => `\u2022 ${insight}`).join("\n");
          const messageEl = this.chatContainer.createDiv({ cls: "nova-message nova-message-assistant nova-insights" });
          messageEl.style.cssText = `
						margin-bottom: var(--size-4-2);
						padding: var(--size-2-3) var(--size-4-3);
						border-radius: var(--radius-s);
						max-width: 85%;
						background: var(--background-modifier-hover);
						color: var(--text-muted);
						font-size: var(--font-ui-medium);
						text-align: left;
						margin-left: 0;
						margin-right: auto;
					`;
          const roleEl = messageEl.createEl("div", {
            text: "Nova",
            cls: "nova-message-role"
          });
          roleEl.style.cssText = `
						font-size: var(--font-ui-smaller);
						opacity: 0.7;
						margin-bottom: var(--size-2-1);
						font-weight: 600;
					`;
          const contentEl = messageEl.createEl("div", { cls: "nova-message-content" });
          contentEl.style.cssText = "white-space: pre-line; text-align: left;";
          contentEl.textContent = `I noticed:

${bulletList}

Let me help.`;
          setTimeout(() => {
            this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
          }, 50);
        }
      }
    } catch (error) {
    }
  }
  /**
   * Handle consultation requests - chat only, no document modification
   */
  async handleConsultationRequest(input) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(input, activeFile || void 0);
    const response = await this.plugin.aiProviderManager.complete(prompt2.systemPrompt, prompt2.userPrompt);
    this.displayChatResponse(response);
    this.showModeIndicator("consultation");
  }
  /**
   * Display AI response in chat without document modification
   */
  displayChatResponse(response) {
    this.chatRenderer.addMessage("assistant", response);
  }
  /**
   * Show subtle indicator for consultation vs editing mode
   */
  showModeIndicator(mode) {
  }
  /**
   * Handle editing requests - preserves existing behavior with intent tracking
   */
  async handleEditingRequest(input) {
    const parsedCommand = this.plugin.commandParser.parseCommand(input);
    this.trackIntentUsage("editing", input);
    return await this.executeCommand(parsedCommand);
  }
  /**
   * Track intent usage for analytics (placeholder for future enhancement)
   */
  trackIntentUsage(intent, input) {
  }
  /**
   * Handle ambiguous requests by routing to chosen handler
   */
  async handleAmbiguousRequest(input, chosenIntent) {
    if (chosenIntent === "consultation") {
      await this.handleConsultationRequest(input);
    } else {
      await this.handleEditingRequest(input);
    }
  }
  /**
   * Process user input with intent detection integration
   */
  async processUserInputWithIntent(input) {
    const intent = await this.plugin.aiIntentClassifier.classifyIntent(input);
    switch (intent) {
      case "CHAT":
        await this.handleConsultationRequest(input);
        break;
      case "CONTENT":
        await this.handleEditingRequest(input);
        break;
      case "METADATA":
        const parsedCommand = this.plugin.commandParser.parseCommand(input);
        await this.executeCommand(parsedCommand);
        break;
    }
  }
  // Public methods for testing
  async sendMessage(message) {
    const activeFile = this.plugin.documentEngine.getActiveFile();
    const prompt2 = await this.plugin.promptBuilder.buildPromptForMessage(message, activeFile || void 0);
    const command = this.plugin.commandParser.parseCommand(message);
    const validActions = ["add", "edit", "delete", "grammar", "rewrite", "metadata"];
    if (validActions.includes(command.action)) {
      const currentActiveFile = this.plugin.documentEngine.getActiveFile();
      if (activeFile && currentActiveFile && currentActiveFile !== activeFile) {
        throw new Error(`Security violation: Command attempted to edit wrong file. Expected: ${activeFile.basename}, Active: ${currentActiveFile.basename}`);
      }
      switch (command.action) {
        case "add":
          await this.plugin.addCommandHandler.execute(command);
          break;
        case "edit":
          await this.plugin.editCommandHandler.execute(command);
          break;
        case "delete":
          await this.plugin.deleteCommandHandler.execute(command);
          break;
        case "grammar":
          await this.plugin.grammarCommandHandler.execute(command);
          break;
        case "rewrite":
          await this.plugin.rewriteCommandHandler.execute(command);
          break;
        case "metadata":
          await this.plugin.metadataCommandHandler.execute(command);
          break;
      }
    } else {
      await this.plugin.aiProviderManager.complete(prompt2.systemPrompt || "", prompt2.userPrompt);
      if (activeFile) {
        await this.plugin.conversationManager.addAssistantMessage(activeFile, "AI response", { success: true, editType: "none" });
      }
    }
  }
  // REMOVED: Now using ChatRenderer's loadConversationHistory method directly
  /**
   * Update send button enabled/disabled state based on provider availability
   */
  async updateSendButtonState() {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    const sendButton = this.inputHandler.sendButton;
    if (sendButton) sendButton.setDisabled(!currentProviderType);
  }
  /**
   * Update privacy indicator icon and tooltip based on current provider
   */
  async updatePrivacyIndicator(privacyIndicator) {
    const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
    privacyIndicator.empty();
    privacyIndicator.removeClass("nova-status-pill", "local", "cloud");
    privacyIndicator.style.cssText = `
			display: inline-flex;
			align-items: center;
			gap: 4px;
			padding: 2px 8px;
			border-radius: 12px;
			font-size: 0.75em;
			font-weight: 500;
			height: auto;
			line-height: 1.5;
		`;
    if (currentProviderType) {
      const isLocalProvider = currentProviderType === "ollama";
      privacyIndicator.addClass("nova-status-pill");
      privacyIndicator.addClass(isLocalProvider ? "local" : "cloud");
      const iconEl = privacyIndicator.createSpan({ cls: "nova-status-icon" });
      iconEl.style.cssText = `
				display: inline-flex;
				align-items: center;
				width: 14px;
				height: 14px;
			`;
      const iconName = isLocalProvider ? "shield-check" : "cloud";
      (0, import_obsidian10.setIcon)(iconEl, iconName);
      const labelEl = privacyIndicator.createSpan({ text: isLocalProvider ? "Local" : "Cloud" });
      labelEl.style.cssText = `line-height: 1;`;
      const tooltip = isLocalProvider ? "Local processing - data stays on your device" : "Cloud processing - data sent to provider";
      privacyIndicator.setAttribute("aria-label", tooltip);
      privacyIndicator.setAttribute("title", tooltip);
    } else {
      privacyIndicator.addClass("nova-status-pill");
      const iconEl = privacyIndicator.createSpan({ cls: "nova-status-icon" });
      iconEl.style.cssText = `
				display: inline-flex;
				align-items: center;
				width: 14px;
				height: 14px;
			`;
      (0, import_obsidian10.setIcon)(iconEl, "help-circle");
      const labelEl = privacyIndicator.createSpan({ text: "No provider" });
      labelEl.style.cssText = `line-height: 1;`;
      privacyIndicator.setAttribute("aria-label", "No provider selected");
      privacyIndicator.setAttribute("title", "No provider selected");
    }
  }
  /**
   * Filter thinking content from AI responses
   * Removes content between <think>/<thinking> and </think>/<thinking> tags
   */
  filterThinkingContent(content) {
    return content.replace(/<think(?:ing)?[\s\S]*?<\/think(?:ing)?>/gi, "").trim();
  }
  /**
   * Refresh all provider status indicators in the UI
   */
  async refreshProviderStatus() {
    var _a;
    if (this.privacyIndicator) {
      await this.updatePrivacyIndicator(this.privacyIndicator);
    }
    this.updateSendButtonState();
    if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
      await this.currentProviderDropdown.updateCurrentProvider();
    }
  }
  /**
   * Create provider dropdown for all users with their own API keys
   */
  async createProviderDropdown(container) {
    const dropdownContainer = container.createDiv({ cls: "nova-provider-dropdown-container" });
    dropdownContainer.style.cssText = `
			position: relative;
			display: flex;
			align-items: center;
		`;
    const providerButton = dropdownContainer.createEl("button", { cls: "nova-provider-button" });
    providerButton.style.cssText = `
			display: flex;
			align-items: center;
			gap: 4px;
			padding: 4px 8px;
			font-size: 0.75em;
			color: var(--text-normal);
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s ease;
		`;
    const providerName = providerButton.createSpan({ text: "Loading...", cls: "nova-provider-name" });
    const dropdownArrow = providerButton.createSpan({ text: "\u25BC" });
    dropdownArrow.style.cssText = `
			font-size: 0.6em;
			margin-left: 4px;
			transition: transform 0.2s ease;
		`;
    const dropdownMenu = dropdownContainer.createDiv({ cls: "nova-provider-dropdown-menu" });
    dropdownMenu.style.cssText = `
			position: absolute;
			top: 100%;
			right: 0;
			min-width: 200px;
			max-width: 280px;
			max-height: 300px;
			background: var(--background-primary);
			border: 1px solid var(--background-modifier-border);
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			z-index: 1000;
			display: none;
			overflow-y: auto;
			overflow-x: hidden;
			
			/* Mobile responsive adjustments */
			@media (max-width: 768px) {
				min-width: 180px;
				max-width: 250px;
				max-height: 250px;
				right: -20px; /* Offset to prevent edge cutoff */
			}
			
			/* Smooth scrolling */
			scroll-behavior: smooth;
			
			/* Custom scrollbar styling */
			scrollbar-width: thin;
			scrollbar-color: var(--background-modifier-border) transparent;
		`;
    const scrollbarStyle = document.createElement("style");
    scrollbarStyle.textContent = `
			.nova-provider-dropdown-menu::-webkit-scrollbar {
				width: 6px;
			}
			.nova-provider-dropdown-menu::-webkit-scrollbar-track {
				background: transparent;
			}
			.nova-provider-dropdown-menu::-webkit-scrollbar-thumb {
				background: var(--background-modifier-border);
				border-radius: 3px;
			}
			.nova-provider-dropdown-menu::-webkit-scrollbar-thumb:hover {
				background: var(--background-modifier-border-hover);
			}
		`;
    if (!document.querySelector(".nova-scrollbar-style")) {
      scrollbarStyle.className = "nova-scrollbar-style";
      document.head.appendChild(scrollbarStyle);
    }
    let isDropdownOpen = false;
    const updateCurrentProvider = () => {
      try {
        const currentModel = this.plugin.aiProviderManager.getCurrentModel();
        if (currentModel) {
          const providerType = getProviderTypeForModel(currentModel, this.plugin.settings);
          if (providerType) {
            const displayText = this.getModelDisplayName(providerType, currentModel);
            providerName.setText(displayText);
          } else {
            providerName.setText(currentModel);
          }
        } else {
          providerName.setText("Select Model");
        }
      } catch (error) {
        console.error("Error updating model display:", error);
        providerName.setText("Select Model");
      }
    };
    const toggleDropdown = () => {
      isDropdownOpen = !isDropdownOpen;
      dropdownMenu.style.display = isDropdownOpen ? "block" : "none";
      dropdownArrow.style.transform = isDropdownOpen ? "rotate(180deg)" : "rotate(0deg)";
      if (isDropdownOpen) {
        this.populateProviderDropdown(dropdownMenu);
      }
    };
    const closeDropdown = (event) => {
      if (!dropdownContainer.contains(event.target)) {
        isDropdownOpen = false;
        dropdownMenu.style.display = "none";
        dropdownArrow.style.transform = "rotate(0deg)";
      }
    };
    const closeDropdownInternal = () => {
      isDropdownOpen = false;
      dropdownMenu.style.display = "none";
      dropdownArrow.style.transform = "rotate(0deg)";
    };
    providerButton.addEventListener("click", (e) => {
      e.stopPropagation();
      toggleDropdown();
    });
    this.addTrackedEventListener(document, "click", closeDropdown);
    updateCurrentProvider();
    this.currentProviderDropdown = {
      updateCurrentProvider,
      closeDropdown: closeDropdownInternal,
      cleanup: () => document.removeEventListener("click", closeDropdown)
    };
  }
  /**
   * Get available models for a provider type
   */
  getAvailableModels(providerType) {
    return getAvailableModels(providerType, this.plugin.settings);
  }
  /**
   * Get current model for a provider type
   */
  getCurrentModel(providerType) {
    var _a;
    const providers = this.plugin.settings.aiProviders;
    const currentModel = (_a = providers[providerType]) == null ? void 0 : _a.model;
    if (currentModel) {
      return currentModel;
    }
    const availableModels = this.getAvailableModels(providerType);
    return availableModels.length > 0 ? availableModels[0].value : "";
  }
  /**
   * Get model display name from model value - searches all providers if needed
   */
  getModelDisplayName(providerType, modelValue) {
    let models = this.getAvailableModels(providerType);
    let model = models.find((m) => m.value === modelValue);
    if (!model) {
      const providerTypes = ["claude", "openai", "google", "ollama"];
      for (const searchProviderType of providerTypes) {
        if (searchProviderType === providerType) continue;
        models = this.getAvailableModels(searchProviderType);
        model = models.find((m) => m.value === modelValue);
        if (model) {
          break;
        }
      }
    }
    const displayName = model ? model.label : modelValue;
    return displayName;
  }
  /**
   * Switch to a specific model for a provider
   */
  switchToModel(providerType, modelValue) {
    try {
      const platform = import_obsidian10.Platform.isMobile ? "mobile" : "desktop";
      this.plugin.settings.platformSettings[platform].selectedModel = modelValue;
      const providers = this.plugin.settings.aiProviders;
      if (providers[providerType]) {
        providers[providerType].model = modelValue;
      }
      const modelDisplayName = this.getModelDisplayName(providerType, modelValue);
      const providerDisplayName = this.getProviderDisplayName(providerType);
      this.addSuccessMessage(`\u2713 Switched to ${providerDisplayName} ${modelDisplayName}`);
      this.plugin.saveSettings().catch((error) => {
        console.error("Error saving model selection:", error);
        this.addErrorMessage("Failed to save model selection");
      });
      this.refreshProviderStatus().catch((error) => {
        console.error("Error refreshing provider status:", error);
      });
      this.refreshContext().catch((error) => {
        console.error("Error refreshing context after model switch:", error);
      });
    } catch (error) {
      console.error("Error switching model:", error);
      this.addErrorMessage("Failed to switch model");
    }
  }
  /**
   * Populate provider dropdown with grouped models and section headers
   */
  async populateProviderDropdown(dropdownMenu) {
    var _a, _b, _c;
    dropdownMenu.empty();
    const loadingItem = dropdownMenu.createDiv({ cls: "nova-dropdown-loading" });
    loadingItem.style.cssText = `
			padding: 12px;
			text-align: center;
			color: var(--text-muted);
			font-size: 0.8em;
		`;
    loadingItem.setText("Loading providers...");
    try {
      const providerAvailability = await this.plugin.aiProviderManager.getAvailableProvidersWithStatus();
      const currentModel = this.plugin.aiProviderManager.getCurrentModel();
      const currentProviderType = await this.plugin.aiProviderManager.getCurrentProviderType();
      dropdownMenu.empty();
      let hasAnyProviders = false;
      for (const [providerType, isAvailable] of providerAvailability) {
        if (providerType === "none" || !isAvailable) continue;
        const providers = this.plugin.settings.aiProviders;
        const hasApiKey = (_a = providers[providerType]) == null ? void 0 : _a.apiKey;
        if (!hasApiKey && providerType !== "ollama") continue;
        const providerStatus = (_b = this.plugin.settings.providerStatus) == null ? void 0 : _b[providerType];
        if (!providerStatus || providerStatus.status !== "connected") continue;
        const models = this.getAvailableModels(providerType);
        const providerDisplayName = this.getProviderDisplayName(providerType);
        const providerColor = this.getProviderColor(providerType);
        if (models.length === 0 && providerType !== "ollama") continue;
        if (hasAnyProviders) {
          const separator = dropdownMenu.createDiv({ cls: "nova-provider-separator" });
          separator.style.cssText = `
						height: 1px;
						background: var(--background-modifier-border);
						margin: 4px 8px;
					`;
        }
        const sectionHeader = dropdownMenu.createDiv({ cls: "nova-provider-section-header" });
        sectionHeader.style.cssText = `
					padding: 8px 12px 4px 12px;
					font-size: 0.75em;
					font-weight: 600;
					color: var(--text-muted);
					text-transform: uppercase;
					letter-spacing: 0.5px;
					display: flex;
					align-items: center;
					gap: 6px;
				`;
        const headerDot = sectionHeader.createSpan();
        headerDot.style.cssText = `
					width: 6px;
					height: 6px;
					border-radius: 50%;
					background: ${providerColor};
					flex-shrink: 0;
				`;
        sectionHeader.createSpan({ text: providerDisplayName });
        hasAnyProviders = true;
        if (models.length === 0) {
          this.createModelDropdownItem(
            dropdownMenu,
            providerType,
            ((_c = providers[providerType]) == null ? void 0 : _c.model) || providerDisplayName,
            providerDisplayName,
            providerColor,
            currentProviderType === providerType,
            currentModel
          );
        } else {
          for (const model of models) {
            const isCurrentSelection = currentProviderType === providerType && model.value === currentModel;
            this.createModelDropdownItem(
              dropdownMenu,
              providerType,
              model.value,
              model.label,
              providerColor,
              isCurrentSelection,
              currentModel
            );
          }
        }
      }
      if (!hasAnyProviders) {
        const noProvidersItem = dropdownMenu.createDiv();
        noProvidersItem.style.cssText = `
					padding: 12px;
					text-align: center;
					color: var(--text-muted);
					font-size: 0.8em;
				`;
        noProvidersItem.setText("None configured");
      }
    } catch (error) {
      console.error("Error populating provider dropdown:", error);
      dropdownMenu.empty();
      const errorItem = dropdownMenu.createDiv();
      errorItem.style.cssText = `
				padding: 12px;
				text-align: center;
				color: var(--text-error);
				font-size: 0.8em;
			`;
      errorItem.setText("Error loading providers");
    }
  }
  /**
   * Create a single model dropdown item (just model name, no provider prefix)
   */
  createModelDropdownItem(container, providerType, modelValue, modelDisplayName, providerColor, isCurrent, currentModel) {
    const item = container.createDiv({ cls: "nova-model-dropdown-item" });
    item.style.cssText = `
			padding: 8px 12px 8px 20px;
			cursor: pointer;
			display: flex;
			align-items: center;
			gap: 8px;
			font-size: 0.85em;
			color: var(--text-normal);
			transition: background-color 0.2s ease;
			border-radius: 3px;
			margin: 1px 6px;
			${isCurrent ? "background: var(--background-modifier-hover);" : ""}
		`;
    const dot = item.createSpan();
    dot.style.cssText = `
			width: 6px;
			height: 6px;
			border-radius: 50%;
			background: ${providerColor};
			flex-shrink: 0;
			opacity: 0.7;
		`;
    const textSpan = item.createSpan({ text: modelDisplayName });
    textSpan.style.cssText = `
			flex: 1;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		`;
    if (isCurrent) {
      const checkmark = item.createSpan({ text: "\u2713" });
      checkmark.style.cssText = `
				color: ${providerColor};
				font-weight: 600;
				font-size: 0.9em;
				flex-shrink: 0;
			`;
    }
    item.addEventListener("click", (e) => {
      var _a;
      e.stopPropagation();
      if (!isCurrent) {
        try {
          this.switchToModel(providerType, modelValue || this.getCurrentModel(providerType));
          if ((_a = this.currentProviderDropdown) == null ? void 0 : _a.closeDropdown) {
            this.currentProviderDropdown.closeDropdown();
          }
          if (this.currentProviderDropdown) {
            this.currentProviderDropdown.updateCurrentProvider();
          }
        } catch (error) {
          console.error("Error switching provider/model:", error);
        }
      }
    });
    item.addEventListener("mouseenter", () => {
      if (!isCurrent) {
        item.style.background = "var(--background-modifier-border-hover)";
      }
    });
    item.addEventListener("mouseleave", () => {
      if (!isCurrent) {
        item.style.background = "transparent";
      }
    });
  }
  /**
   * Create a message with a clean icon (replaces emoji)
   */
  createIconMessage(iconName, message) {
    const iconSvg = this.getObsidianIcon(iconName, "14px");
    return `<span style="display: inline-flex; align-items: center; gap: 6px;">${iconSvg}<span>${message}</span></span>`;
  }
  /**
   * Create an inline icon for use in innerHTML
   */
  createInlineIcon(iconName, size = "14px") {
    return this.getObsidianIcon(iconName, size);
  }
  /**
   * Get Obsidian-style icon SVG
   */
  getObsidianIcon(iconName, size = "14px") {
    const icons = {
      "zap": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "refresh-cw": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 12A9 9 0 0 0 21 12A9 9 0 0 0 3 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12L17 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "edit": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M18.5 2.5A2.12 2.12 0 0 1 21 5L12 14L8 15L9 11L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "help-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9.09 9A3 3 0 0 1 12 6A3 3 0 0 1 15 9C15 10.5 12 11 12 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<circle cx="12" cy="17" r="1" fill="currentColor"/>
			</svg>`,
      "book-open": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M2 3H8A4 4 0 0 1 12 7A4 4 0 0 1 16 3H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2 3V19A2 2 0 0 0 4 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M22 3V19A2 2 0 0 1 20 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "more-horizontal": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="1" fill="currentColor"/>
				<circle cx="19" cy="12" r="1" fill="currentColor"/>
				<circle cx="5" cy="12" r="1" fill="currentColor"/>
			</svg>`,
      "file-text": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "check-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M9 12L11 14L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "x-circle": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
				<path d="M15 9L9 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`,
      "trash-2": `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: ${size}; height: ${size};">
				<path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M8 6V4A2 2 0 0 1 10 2H14A2 2 0 0 1 16 4V6M19 6V20A2 2 0 0 1 17 22H7A2 2 0 0 1 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>`
    };
    return icons[iconName] || icons["help-circle"];
  }
  /**
   * Get display name for provider
   */
  getProviderDisplayName(providerType) {
    const names = {
      "claude": "Anthropic",
      "openai": "OpenAI",
      "google": "Google",
      "ollama": "Ollama",
      "none": "None"
    };
    return names[providerType] || providerType;
  }
  /**
   * Get display name for header (just model name if available, otherwise provider name)
   */
  getProviderWithModelDisplayName(providerType) {
    const models = this.getAvailableModels(providerType);
    if (models.length > 0) {
      const currentModel = this.getCurrentModel(providerType);
      const modelDisplayName = this.getModelDisplayName(providerType, currentModel);
      if (modelDisplayName === "II" || modelDisplayName.match(/^I+$/)) {
        console.warn("Invalid model display name detected:", {
          providerType,
          currentModel,
          modelDisplayName,
          models
        });
      }
      return modelDisplayName;
    }
    return this.getProviderDisplayName(providerType);
  }
  /**
   * Get color for provider type
   */
  getProviderColor(providerType) {
    const colors = {
      "claude": "var(--color-orange)",
      "openai": "var(--color-green)",
      "google": "var(--color-blue)",
      "ollama": "var(--color-purple)",
      "none": "var(--text-muted)"
    };
    return colors[providerType] || "var(--text-success)";
  }
  /**
   * Switch to a different model and update conversation context
   */
  /**
   * Check if the command button should be shown based on feature availability and user preference
   */
  shouldShowCommandButton() {
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      return false;
    }
    return this.plugin.settings.showCommandButton;
  }
  /**
   * Refresh all Supernova-gated UI elements when license status changes
   */
  refreshSupernovaUI() {
    this.refreshCommandButton();
  }
  /**
   * Get the first available model from any working provider
   */
  async getFirstAvailableModel() {
    var _a;
    const providerAvailability = await this.plugin.aiProviderManager.getAvailableProvidersWithStatus();
    const providerPriority = ["claude", "openai", "google", "ollama"];
    for (const providerType of providerPriority) {
      const isAvailable = providerAvailability.get(providerType);
      const providerStatus = (_a = this.plugin.settings.providerStatus) == null ? void 0 : _a[providerType];
      if (isAvailable && (providerStatus == null ? void 0 : providerStatus.status) === "connected") {
        const models = getAvailableModels(providerType, this.plugin.settings);
        if (models.length > 0) {
          return models[0].value;
        }
      }
    }
    return null;
  }
  /**
   * Refresh the command button visibility when settings change
   */
  refreshCommandButton() {
    if (this.inputHandler) {
      this.inputHandler.refreshCommandButton();
    }
  }
  /**
   * Update input row layout when command button visibility changes
   */
  updateInputRowLayout() {
  }
  /**
   * Execute add command with streaming support
   */
  async executeAddCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.addCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming add command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute edit command with streaming support
   */
  async executeEditCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.editCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming edit command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeRewriteCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.rewriteCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming rewrite command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeGrammarCommandWithStreaming(command) {
    try {
      const editor = this.plugin.documentEngine.getActiveEditor();
      if (!editor) {
        return {
          success: false,
          error: "No active editor found"
        };
      }
      const cursorPosition = this.plugin.documentEngine.getCursorPosition();
      if (!cursorPosition) {
        return {
          success: false,
          error: "Could not determine cursor position"
        };
      }
      const { updateStream, stopStream } = this.streamingManager.startStreaming(
        editor,
        cursorPosition,
        void 0,
        {
          animationMode: "inline",
          onComplete: () => this.onStreamingComplete()
        }
      );
      try {
        const result = await this.plugin.grammarCommandHandler.execute(command, (chunk, isComplete) => {
          updateStream(chunk, isComplete);
        });
        stopStream();
        return result;
      } catch (error) {
        stopStream();
        throw error;
      }
    } catch (error) {
      console.error("Error in streaming grammar command:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  /**
   * Add files to persistent context
   */
  async addFilesToContext(filenames) {
    var _a;
    if (!this.currentFile) {
      new import_obsidian10.Notice("No file is open. Please open a file to add context.", 3e3);
      return;
    }
    const addedFiles = [];
    const alreadyExistingFiles = [];
    const currentFiles = [];
    const notFoundFiles = [];
    const existingPersistent = this.contextManager.getPersistentContext(this.currentFile.path) || [];
    const updatedPersistent = [...existingPersistent];
    for (const filename of filenames) {
      let file = this.app.vault.getAbstractFileByPath(filename);
      if (!file || !(file instanceof import_obsidian10.TFile)) {
        file = this.app.vault.getAbstractFileByPath(filename + ".md");
      }
      if (!file || !(file instanceof import_obsidian10.TFile)) {
        const files = this.app.vault.getMarkdownFiles();
        file = files.find(
          (f) => f.basename === filename || f.name === filename || f.path.endsWith("/" + filename) || f.path.endsWith("/" + filename + ".md")
        ) || null;
      }
      if (file instanceof import_obsidian10.TFile) {
        if (file.path === ((_a = this.currentFile) == null ? void 0 : _a.path)) {
          currentFiles.push(file.basename);
          this.chatRenderer.addWarningMessage("Current file is always in context and doesn't need to be added explicitly.", false);
        } else {
          const exists = updatedPersistent.some((ref) => ref.file.path === file.path);
          if (!exists) {
            updatedPersistent.push({
              file,
              property: void 0,
              isPersistent: true,
              rawReference: `+[[${file.basename}]]`
            });
            addedFiles.push(file.basename);
          } else {
            alreadyExistingFiles.push(file.basename);
          }
        }
      } else {
        notFoundFiles.push(filename);
      }
    }
    if (addedFiles.length > 0 || alreadyExistingFiles.length > 0 || currentFiles.length > 0) {
      this.contextManager.clearPersistentContext(this.currentFile.path);
      for (const doc of updatedPersistent) {
        await this.contextManager.addDocument(doc.file);
      }
    }
    await this.refreshContext();
    const totalFiles = filenames.length;
    const messages = [];
    if (addedFiles.length > 0) {
      if (addedFiles.length === 1) {
        messages.push(`Added "${addedFiles[0]}" to context`);
      } else {
        messages.push(`Added ${addedFiles.length} files to context`);
      }
    }
    if (alreadyExistingFiles.length > 0) {
      if (alreadyExistingFiles.length === 1) {
        messages.push(`"${alreadyExistingFiles[0]}" already in context`);
      } else {
        messages.push(`${alreadyExistingFiles.length} already in context`);
      }
    }
    if (currentFiles.length > 0) {
      if (currentFiles.length === 1) {
        messages.push(`Current file is always in context`);
      } else {
        messages.push(`${currentFiles.length} current files are always in context`);
      }
    }
    if (notFoundFiles.length > 0) {
      if (notFoundFiles.length === 1) {
        messages.push(`"${notFoundFiles[0]}" not found`);
      } else {
        messages.push(`${notFoundFiles.length} not found`);
      }
    }
    if (messages.length > 0) {
      const combinedMessage = messages.join(", ");
      const duration = notFoundFiles.length > 0 ? 3e3 : 2e3;
      new import_obsidian10.Notice(combinedMessage, duration);
    }
  }
  /**
   * Get contextual thinking phrase based on command type or message content
   */
  getContextualThinkingPhrase(command, messageText) {
    if (command) {
      switch (command.action) {
        case "grammar":
        case "edit":
          return this.getRandomPhrase("improve");
        case "add":
          return this.getRandomPhrase("generate");
        case "rewrite":
          return this.getRandomPhrase("improve");
        case "delete":
          return this.getRandomPhrase("process");
        default:
          return this.getRandomPhrase("chat");
      }
    } else if (messageText) {
      if (messageText.includes("improve") || messageText.includes("fix") || messageText.includes("grammar")) {
        return this.getRandomPhrase("improve");
      } else if (messageText.includes("add") || messageText.includes("create") || messageText.includes("write")) {
        return this.getRandomPhrase("generate");
      } else if (messageText.includes("switch") || messageText.includes("/")) {
        return this.getRandomPhrase("switch");
      }
    }
    return this.getRandomPhrase("chat");
  }
  /**
   * Get random phrase from specified category
   */
  getRandomPhrase(category) {
    const phrases = {
      "improve": ["refining...", "polishing...", "enhancing...", "crafting...", "perfecting...", "smoothing...", "sharpening...", "elevating...", "fine-tuning...", "sculpting..."],
      "generate": ["thinking...", "crafting...", "developing...", "composing...", "writing...", "creating...", "formulating...", "building...", "constructing...", "drafting..."],
      "switch": ["connecting...", "switching...", "updating...", "configuring...", "setting up...", "syncing...", "preparing...", "activating...", "initializing...", "establishing..."],
      "process": ["processing...", "analyzing...", "working...", "computing...", "calculating...", "examining...", "evaluating...", "interpreting...", "reviewing...", "scanning..."],
      "chat": ["thinking...", "processing...", "considering...", "analyzing...", "understanding...", "contemplating...", "exploring...", "evaluating...", "working on it...", "composing..."]
    };
    const categoryPhrases = phrases[category] || phrases.chat;
    return categoryPhrases[Math.floor(Math.random() * categoryPhrases.length)];
  }
  /**
   * Start phrase rotation animation for thinking text
   */
  startThinkingPhraseRotation(textEl, command, messageText) {
    const rotationInterval = setInterval(() => {
      const newPhrase = this.getContextualThinkingPhrase(command, messageText);
      textEl.textContent = newPhrase;
    }, 2e3);
    textEl.rotationInterval = rotationInterval;
  }
  /**
   * Stop phrase rotation animation and cleanup
   */
  stopThinkingPhraseRotation(textEl) {
    if (textEl.rotationInterval) {
      clearInterval(textEl.rotationInterval);
      textEl.rotationInterval = null;
    }
  }
};
_NovaSidebarView.CONTEXT_PREVIEW_DEBOUNCE_MS = 300;
_NovaSidebarView.SCROLL_DELAY_MS = 50;
_NovaSidebarView.FOCUS_DELAY_MS = 150;
_NovaSidebarView.HOVER_TIMEOUT_MS = 150;
_NovaSidebarView.NOTICE_DURATION_MS = 5e3;
var NovaSidebarView = _NovaSidebarView;

// src/ai/providers/claude.ts
var import_obsidian11 = require("obsidian");
var ClaudeProvider = class {
  constructor(config) {
    this.name = "Claude (Anthropic)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "claude-3-5-haiku-latest",
      max_tokens: (options == null ? void 0 : options.maxTokens) || this.config.maxTokens,
      temperature: (options == null ? void 0 : options.temperature) || this.config.temperature,
      system: options == null ? void 0 : options.systemPrompt,
      messages: messages.map((msg) => ({
        role: msg.role === "assistant" ? "assistant" : "user",
        content: msg.content
      }))
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await (0, import_obsidian11.requestUrl)({
          url: "https://api.anthropic.com/v1/messages",
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": this.config.apiKey,
            "anthropic-version": "2023-06-01"
          },
          body: requestBody
        });
        if (response.status === 200) {
          const data = response.json;
          return data.content[0].text;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`Claude API error: ${response.status} - ${response.text}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && (error.message.includes("Network error") || error.message.includes("Failed to connect"))) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        if (error instanceof Error && error.message.startsWith("Claude API error:")) {
          throw error;
        }
        throw new Error(`Failed to connect to Claude API: ${error instanceof Error ? error.message : "Network error"}`);
      }
    }
    throw new Error("Claude API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    const result = await this.chatCompletion(messages, options);
    const chunkSize = 3;
    for (let i = 0; i < result.length; i += chunkSize) {
      const chunk = result.slice(i, i + chunkSize);
      yield { content: chunk, done: false };
      await new Promise((resolve) => setTimeout(resolve, 20));
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Claude API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Claude API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const response = await (0, import_obsidian11.requestUrl)({
        url: "https://api.anthropic.com/v1/messages",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": this.config.apiKey,
          "anthropic-version": "2023-06-01"
        },
        body: JSON.stringify({
          model: "claude-3-5-haiku-latest",
          max_tokens: 1,
          messages: [{ role: "user", content: "test" }]
        })
      });
      if (response.status !== 200) {
        throw new Error(`API key validation failed: ${response.status} - ${response.text}`);
      }
      const models = [
        "claude-opus-4-20250514",
        "claude-sonnet-4-20250514",
        "claude-3-7-sonnet-latest",
        "claude-3-5-sonnet-latest",
        "claude-3-5-haiku-latest"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Claude models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/openai.ts
var OpenAIProvider = class {
  constructor(config) {
    this.name = "OpenAI";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const requestBody = JSON.stringify({
      model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
      messages: requestMessages,
      max_tokens: options == null ? void 0 : options.maxTokens,
      temperature: options == null ? void 0 : options.temperature
    });
    const maxRetries = 3;
    const baseDelay = 1e3;
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${this.config.apiKey}`
          },
          body: requestBody
        });
        if (response.ok) {
          const data = await response.json();
          return data.choices[0].message.content;
        }
        if (response.status >= 500 && attempt < maxRetries) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw new Error(`OpenAI API error: ${response.statusText}`);
      } catch (error) {
        if (attempt < maxRetries && error instanceof Error && error.message.includes("fetch")) {
          const delay = baseDelay * Math.pow(2, attempt);
          await new Promise((resolve) => setTimeout(resolve, delay));
          continue;
        }
        throw error;
      }
    }
    throw new Error("OpenAI API: Maximum retries exceeded");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d;
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    const requestMessages = [...messages];
    if (options == null ? void 0 : options.systemPrompt) {
      requestMessages.unshift({ role: "system", content: options.systemPrompt });
    }
    const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
    const endpoint = baseUrl.endsWith("/chat/completions") ? baseUrl : `${baseUrl}/chat/completions`;
    const response = await fetch(endpoint, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${this.config.apiKey}`
      },
      body: JSON.stringify({
        model: (options == null ? void 0 : options.model) || this.config.model || "gpt-3.5-turbo",
        messages: requestMessages,
        max_tokens: options == null ? void 0 : options.maxTokens,
        temperature: options == null ? void 0 : options.temperature,
        stream: true
      })
    });
    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";
        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") {
              yield { content: "", done: true };
              return;
            }
            try {
              const parsed = JSON.parse(data);
              const content = (_d = (_c = (_b = parsed.choices) == null ? void 0 : _b[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                const chunkSize = 3;
                for (let i = 0; i < content.length; i += chunkSize) {
                  const chunk = content.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from OpenAI API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("OpenAI API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const baseUrl = this.config.baseUrl || "https://api.openai.com/v1";
      const endpoint = baseUrl.endsWith("/models") ? baseUrl : `${baseUrl}/models`;
      const response = await fetch(endpoint, {
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.apiKey}`
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gpt-4.1-2025-04-14",
        "gpt-4.1-mini-2025-04-14",
        "gpt-4.1-nano-2025-04-14",
        "gpt-4o",
        "gpt-4o-mini"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch OpenAI models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/google.ts
var GoogleProvider = class {
  constructor(config) {
    this.name = "Google (Gemini)";
    this.cachedModels = null;
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    return !!this.config.apiKey;
  }
  async generateText(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    return this.chatCompletion(messages, options);
  }
  async *generateTextStream(prompt2, options) {
    const messages = [{ role: "user", content: prompt2 }];
    yield* this.chatCompletionStream(messages, options);
  }
  formatMessagesForGemini(messages) {
    const contents = [];
    for (const message of messages) {
      const role = message.role === "assistant" ? "model" : "user";
      contents.push({
        role,
        parts: [{ text: message.content }]
      });
    }
    if (contents.length === 0) {
      throw new Error("No messages provided for Google API");
    }
    return contents;
  }
  async chatCompletion(messages, options) {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.config.apiKey}`;
    const requestBody = {
      contents: this.formatMessagesForGemini(messages),
      generationConfig: {
        temperature: options == null ? void 0 : options.temperature,
        maxOutputTokens: options == null ? void 0 : options.maxTokens
      }
    };
    if ((options == null ? void 0 : options.systemPrompt) && options.systemPrompt.trim()) {
      requestBody.systemInstruction = {
        parts: [{ text: options.systemPrompt }]
      };
    }
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(requestBody)
    });
    if (!response.ok) {
      const errorText = await response.text();
      let errorMessage = "";
      try {
        const errorData = JSON.parse(errorText);
        if (errorData.error) {
          const code = errorData.error.code || response.status;
          const message = errorData.error.message || errorData.error.status || response.statusText;
          errorMessage = `[${code}]: ${message}`;
          if (response.status === 400) {
            errorMessage += " (Check request format or model name)";
          } else if (response.status === 401) {
            errorMessage += " (Check API key in settings)";
          } else if (response.status === 404) {
            errorMessage += " (Model may not be available)";
          } else if (response.status === 429) {
            errorMessage += " (Rate limit exceeded)";
          }
        } else {
          errorMessage = `[${response.status}]: ${errorText}`;
        }
      } catch (e) {
        errorMessage = `[${response.status}]: ${errorText || response.statusText}`;
      }
      console.error("Google API Error Details:", {
        status: response.status,
        statusText: response.statusText,
        errorText,
        requestBody,
        model,
        url
      });
      throw new Error(`Google API error ${errorMessage}`);
    }
    const data = await response.json();
    if (!data.candidates || data.candidates.length === 0) {
      if (data.error) {
        throw new Error(`Google API error: ${data.error.message || JSON.stringify(data.error)}`);
      }
      throw new Error("Google API returned no candidates");
    }
    if (data.candidates[0].finishReason === "SAFETY" || data.candidates[0].finishReason === "BLOCKED") {
      throw new Error("Google API blocked the response due to safety filters");
    }
    if (data.candidates[0].finishReason === "MAX_TOKENS" && (!data.candidates[0].content || !data.candidates[0].content.parts || data.candidates[0].content.parts.length === 0)) {
      throw new Error('API hit token limit before generating any content. Please increase "Default Max Tokens" in settings.');
    }
    if (data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
      const text = data.candidates[0].content.parts[0].text;
      if (data.candidates[0].finishReason === "MAX_TOKENS") {
        throw new Error('Response was truncated due to token limit. Please increase "Default Max Tokens" in settings.');
      }
      if (!text || text.trim().length === 0) {
        console.error("Google API returned empty text content");
        throw new Error("Google API returned empty text content");
      }
      return text;
    }
    throw new Error("Google API returned empty response");
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [{ role: "user", content: userPrompt }];
    const completeOptions = { ...options, systemPrompt };
    return this.chatCompletion(messages, completeOptions);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    const model = (options == null ? void 0 : options.model) || this.config.model || "gemini-2.0-flash";
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:streamGenerateContent?key=${this.config.apiKey}`;
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        contents: this.formatMessagesForGemini(messages),
        generationConfig: {
          temperature: options == null ? void 0 : options.temperature,
          maxOutputTokens: options == null ? void 0 : options.maxTokens
        },
        ...(options == null ? void 0 : options.systemPrompt) && options.systemPrompt.trim() ? {
          systemInstruction: {
            parts: [{ text: options.systemPrompt }]
          }
        } : {}
      })
    });
    if (!response.ok) {
      const errorText = await response.text();
      let errorMessage = "";
      try {
        const errorData = JSON.parse(errorText);
        if (errorData.error) {
          const code = errorData.error.code || response.status;
          const message = errorData.error.message || errorData.error.status || response.statusText;
          errorMessage = `[${code}]: ${message}`;
        } else {
          errorMessage = `[${response.status}]: ${errorText}`;
        }
      } catch (e) {
        errorMessage = `[${response.status}]: ${errorText || response.statusText}`;
      }
      throw new Error(`Google API error ${errorMessage}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    let buffer = "";
    let jsonBuffer = "";
    let braceCount = 0;
    let inJson = false;
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        buffer += decoder.decode(value, { stream: true });
        for (let i = 0; i < buffer.length; i++) {
          const char = buffer[i];
          if (char === "{") {
            if (!inJson) {
              inJson = true;
              jsonBuffer = "";
            }
            braceCount++;
            jsonBuffer += char;
          } else if (char === "}") {
            jsonBuffer += char;
            braceCount--;
            if (braceCount === 0 && inJson) {
              try {
                const parsed = JSON.parse(jsonBuffer);
                const text = (_f = (_e = (_d = (_c = (_b = parsed.candidates) == null ? void 0 : _b[0]) == null ? void 0 : _c.content) == null ? void 0 : _d.parts) == null ? void 0 : _e[0]) == null ? void 0 : _f.text;
                if (text) {
                  const chunkSize = 3;
                  for (let i2 = 0; i2 < text.length; i2 += chunkSize) {
                    const chunk = text.slice(i2, i2 + chunkSize);
                    yield { content: chunk, done: false };
                    await new Promise((resolve) => setTimeout(resolve, 20));
                  }
                }
              } catch (e) {
              }
              inJson = false;
              jsonBuffer = "";
            }
          } else if (inJson) {
            jsonBuffer += char;
          }
        }
        buffer = "";
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  /**
   * Fetch available models from Google API
   */
  async getAvailableModels() {
    if (!this.config.apiKey) {
      throw new Error("Google API key not configured");
    }
    if (this.cachedModels) {
      return this.cachedModels;
    }
    try {
      const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${this.config.apiKey}`;
      const response = await fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`API request failed: ${response.statusText}`);
      }
      const data = await response.json();
      const models = [
        "gemini-2.5-flash-preview-04-17",
        "gemini-2.5-pro-preview-03-25",
        "gemini-2.0-flash",
        "gemini-2.0-flash-lite"
      ];
      this.cachedModels = models;
      return models;
    } catch (error) {
      throw new Error(`Failed to fetch Google models: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  /**
   * Clear cached models
   */
  clearModelCache() {
    this.cachedModels = null;
  }
};

// src/ai/providers/ollama.ts
var OllamaProvider = class {
  constructor(config) {
    this.name = "Ollama (Local)";
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async isAvailable() {
    if (!this.config.model) return false;
    try {
      const baseUrl = this.config.baseUrl || "http://localhost:11434";
      const response = await fetch(`${baseUrl}/api/tags`, {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      return response.ok;
    } catch (e) {
      return false;
    }
  }
  async generateText(prompt2, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: false,
        options: {
          temperature: options == null ? void 0 : options.temperature,
          num_predict: options == null ? void 0 : options.maxTokens
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.response;
  }
  async *generateTextStream(prompt2, options) {
    var _a;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        prompt: prompt2,
        stream: true,
        options: {
          temperature: options == null ? void 0 : options.temperature,
          num_predict: options == null ? void 0 : options.maxTokens
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if (parsed.response) {
                const chunkSize = 3;
                for (let i = 0; i < parsed.response.length; i += chunkSize) {
                  const chunk = parsed.response.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
  async chatCompletion(messages, options) {
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: false,
        options: {
          temperature: options == null ? void 0 : options.temperature,
          num_predict: options == null ? void 0 : options.maxTokens
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const data = await response.json();
    return data.message.content;
  }
  async complete(systemPrompt, userPrompt, options) {
    const messages = [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt }
    ];
    return this.chatCompletion(messages, options);
  }
  async *chatCompletionStream(messages, options) {
    var _a, _b;
    const baseUrl = this.config.baseUrl || "http://localhost:11434";
    const model = (options == null ? void 0 : options.model) || this.config.model;
    if (!model) {
      throw new Error("Ollama model must be specified");
    }
    const response = await fetch(`${baseUrl}/api/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model,
        messages: messages.map((msg) => ({
          role: msg.role,
          content: msg.content
        })),
        stream: true,
        options: {
          temperature: options == null ? void 0 : options.temperature,
          num_predict: options == null ? void 0 : options.maxTokens
        }
      })
    });
    if (!response.ok) {
      throw new Error(`Ollama API error: ${response.statusText}`);
    }
    const reader = (_a = response.body) == null ? void 0 : _a.getReader();
    if (!reader) {
      throw new Error("Failed to get response reader");
    }
    const decoder = new TextDecoder();
    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        const lines = decoder.decode(value).split("\n");
        for (const line of lines) {
          if (line.trim()) {
            try {
              const parsed = JSON.parse(line);
              if ((_b = parsed.message) == null ? void 0 : _b.content) {
                const chunkSize = 3;
                for (let i = 0; i < parsed.message.content.length; i += chunkSize) {
                  const chunk = parsed.message.content.slice(i, i + chunkSize);
                  yield { content: chunk, done: false };
                  await new Promise((resolve) => setTimeout(resolve, 20));
                }
              }
              if (parsed.done) {
                yield { content: "", done: true };
                return;
              }
            } catch (e) {
            }
          }
        }
      }
    } finally {
      reader.releaseLock();
    }
    yield { content: "", done: true };
  }
};

// src/settings.ts
var NOVA_ICON_SVG = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var DEFAULT_SETTINGS = {
  aiProviders: {
    claude: {
      apiKey: "",
      temperature: 0.7,
      maxTokens: 1e3
    },
    openai: {
      apiKey: "",
      baseUrl: "https://api.openai.com/v1",
      temperature: 0.7,
      maxTokens: 1e3
    },
    google: {
      apiKey: "",
      temperature: 0.7,
      maxTokens: 1e3
    },
    ollama: {
      baseUrl: "http://localhost:11434",
      model: "",
      temperature: 0.7,
      maxTokens: 1e3
    }
  },
  platformSettings: {
    desktop: {
      selectedModel: ""
      // No default model
    },
    mobile: {
      selectedModel: ""
      // No default model
    }
  },
  customCommands: [],
  general: {
    defaultTemperature: 0.7,
    defaultMaxTokens: 1e3,
    autoSave: true
  },
  showCommandButton: true,
  licensing: {
    licenseKey: "",
    supernovaLicenseKey: "",
    isSupernova: false,
    debugSettings: {
      enabled: false,
      overrideDate: void 0,
      forceSupernova: false
    }
  },
  providerStatus: {},
  ollamaDefaultContext: 32e3
};
var NovaSettingTab = class extends import_obsidian12.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.activeTab = "getting-started";
    this.tabContainer = null;
    this.contentContainer = null;
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Nova Settings" });
    this.tabContainer = containerEl.createDiv({ cls: "nova-tab-container" });
    this.createTabNavigation();
    this.contentContainer = containerEl.createDiv({ cls: "nova-tab-content" });
    this.updateTabContent();
  }
  createTabNavigation() {
    if (!this.tabContainer) return;
    const tabs = [
      { id: "getting-started", label: "Getting Started" },
      { id: "general", label: "General" },
      { id: "providers", label: "AI Providers" },
      { id: "supernova", label: "Supernova" }
    ];
    if (true) {
      tabs.push({ id: "debug", label: "Debug" });
    }
    tabs.forEach((tab) => {
      const tabEl = this.tabContainer.createDiv({
        cls: `nova-tab ${this.activeTab === tab.id ? "active" : ""}`,
        text: tab.label
      });
      tabEl.dataset.tabId = tab.id;
      tabEl.addEventListener("click", () => {
        this.switchTab(tab.id);
      });
    });
  }
  switchTab(tabId) {
    this.activeTab = tabId;
    this.updateTabStates();
    this.updateTabContent();
    this.scrollToActiveTab();
  }
  updateTabStates() {
    if (!this.tabContainer) return;
    const tabElements = this.tabContainer.querySelectorAll(".nova-tab");
    tabElements.forEach((tabEl) => {
      const htmlTabEl = tabEl;
      if (htmlTabEl.dataset.tabId === this.activeTab) {
        htmlTabEl.addClass("active");
      } else {
        htmlTabEl.removeClass("active");
      }
    });
  }
  scrollToActiveTab() {
    if (!this.tabContainer) return;
    const activeTab = this.tabContainer.querySelector(".nova-tab.active");
    if (activeTab) {
      activeTab.scrollIntoView({
        behavior: "smooth",
        block: "nearest",
        inline: "center"
      });
    }
  }
  updateTabContent() {
    if (!this.contentContainer) return;
    this.contentContainer.empty();
    switch (this.activeTab) {
      case "getting-started":
        this.createGettingStartedTabContent(this.contentContainer);
        break;
      case "general":
        this.createGeneralTabContent(this.contentContainer);
        break;
      case "providers":
        this.createProvidersTabContent(this.contentContainer);
        break;
      case "supernova":
        this.createSupernovaTabContent(this.contentContainer);
        break;
      case "debug":
        this.createDebugTabContent(this.contentContainer);
        break;
    }
  }
  createGeneralTabContent(container) {
    this.createSupernovaCTA(container, {
      showOnlyIfNotSupporter: true,
      buttonAction: "tab",
      showLearnMore: false
    });
    this.createGeneralSettings(container);
    this.createPrivacySettings(container);
  }
  createProvidersTabContent(container) {
    this.createSupernovaCTA(container, {
      showOnlyIfNotSupporter: true,
      buttonAction: "tab",
      showLearnMore: false
    });
    this.createProviderSettings(container);
  }
  createGettingStartedTabContent(container) {
    this.createWelcomeSection(container);
    this.createNavigationHelp(container);
    this.createQuickStartGuide(container);
    this.createSupernovaCTA(container, {
      buttonAction: "tab",
      showLearnMore: true,
      marginTop: "32px",
      marginBottom: "32px"
    });
  }
  createSupernovaTabContent(container) {
    this.createSupernovaCTA(container, {
      buttonAction: "direct",
      showLearnMore: false,
      marginBottom: "32px"
    });
    const benefitsSection = container.createDiv({ cls: "nova-benefits-section" });
    benefitsSection.style.marginTop = "32px";
    benefitsSection.createEl("h3", { text: "Supernova Benefits" });
    benefitsSection.createEl("hr", { cls: "nova-section-divider" });
    const benefitsContent = benefitsSection.createDiv({ cls: "nova-benefits-content" });
    benefitsContent.innerHTML = `
			<p style="margin-bottom: 20px;">Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
			
			<div class="nova-benefits-list">
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u26A1</span>
					<div class="nova-benefit-content">
						<strong>Early Access</strong>
						<span>Get new features 2-4 months before general release</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u{1F4AC}</span>
					<div class="nova-benefit-content">
						<strong>Priority Support</strong>
						<span>Direct access to developers for feature requests and bug reports</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u{1F5F3}\uFE0F</span>
					<div class="nova-benefit-content">
						<strong>Vote on Features</strong>
						<span>Help shape Nova's development and future direction</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u{1F3C6}</span>
					<div class="nova-benefit-content">
						<strong>Supporter Badge</strong>
						<span>Recognition in the Nova community (coming soon)</span>
					</div>
				</div>
				<div class="nova-benefit-item">
					<span class="nova-benefit-icon">\u2764\uFE0F</span>
					<div class="nova-benefit-content">
						<strong>Open Source Support</strong>
						<span>Directly fund continued development of Nova</span>
					</div>
				</div>
			</div>
			
			<p style="margin-top: 20px; font-size: 0.9em; color: var(--text-muted);">Your support keeps Nova free and open source for everyone.</p>
		`;
    const licenseSection = container.createDiv({ cls: "nova-provider-section" });
    licenseSection.style.marginTop = "32px";
    licenseSection.createEl("h3", { text: "License Management" });
    this.createSupernovaLicenseInput(licenseSection);
  }
  createDebugTabContent(container) {
    const debugSection = container.createDiv({ cls: "nova-debug-section" });
    debugSection.createEl("h3", { text: "Debug Settings" });
    debugSection.createEl("hr", { cls: "nova-section-divider" });
    const infoEl = debugSection.createDiv({ cls: "nova-debug-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<p>Debug settings for development and testing. These options help developers troubleshoot issues and test new features.</p>
			</div>
			<div class="nova-info-card">
				<h4>\u26A0\uFE0F Developer Settings</h4>
				<ul class="nova-debug-features">
					<li><strong>Debug Mode</strong> - Enable detailed logging and development features</li>
					<li><strong>Override Date</strong> - Test time-sensitive features with custom dates</li>
					<li><strong>Force Supernova</strong> - Test Supernova-only features without a license</li>
				</ul>
				<p class="nova-debug-note">Only modify these settings if you understand their purpose.</p>
			</div>
		`;
    this.createDebugSettings(debugSection);
  }
  createPrivacySettings(container) {
    const privacySection = container.createDiv({ cls: "nova-privacy-section" });
    privacySection.createEl("h3", { text: "Privacy & Platform Settings" });
    privacySection.createEl("hr", { cls: "nova-section-divider" });
    const infoEl = privacySection.createDiv({ cls: "nova-privacy-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F512} Your Privacy Matters</h4>
				<p>Nova respects your privacy and gives you full control over how your data is handled. 
				All AI providers are accessed using your own API keys, so your content stays between you and your chosen AI service.</p>
			</div>
			<div class="nova-info-card">
				<h4>\u{1F4F1} Mobile Support</h4>
				<p>Mobile support is disabled by default to protect your privacy. When enabled, Nova provides identical selection-based editing capabilities across desktop and mobile with cloud-based AI providers.</p>
				<ul class="nova-privacy-features">
					<li><strong>Local-first</strong> - Ollama and desktop-only providers keep everything on your device</li>
					<li><strong>Your choice</strong> - Enable mobile only when you need cross-device access</li>
					<li><strong>Cross-platform editing</strong> - Selection-based editing works identically on mobile via Command Palette (Cmd+P)</li>
					<li><strong>Same experience</strong> - Mobile provides the same editing capabilities as desktop</li>
				</ul>
			</div>
		`;
    new import_obsidian12.Setting(privacySection).setName("Enable Mobile Support").setDesc("Allow Nova to work on mobile devices using cloud-based AI providers").addToggle((toggle) => {
      const currentMobileModel = this.plugin.settings.platformSettings.mobile.selectedModel;
      const isMobileEnabled = currentMobileModel !== "none" && currentMobileModel !== "";
      toggle.setValue(isMobileEnabled).onChange(async (value) => {
        if (value) {
          this.plugin.settings.platformSettings.mobile.selectedModel = "";
        } else {
          this.plugin.settings.platformSettings.mobile.selectedModel = "none";
        }
        await this.plugin.saveSettings();
        if (this.plugin.aiProviderManager) {
          this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
        }
      });
    });
  }
  createSecureApiKeyInput(container, options) {
    const setting = new import_obsidian12.Setting(container).setName(options.name).setDesc(options.desc);
    let actualValue = options.value;
    let isVisible = false;
    setting.addText((text) => {
      text.inputEl.type = "password";
      text.inputEl.style.fontFamily = "var(--font-monospace)";
      text.inputEl.style.width = "400px";
      text.inputEl.style.height = "40px";
      text.inputEl.style.position = "relative";
      text.setPlaceholder(options.placeholder);
      if (actualValue && actualValue.length > 12) {
        const masked = actualValue.slice(0, 8) + "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022" + actualValue.slice(-4);
        text.setValue(masked);
      } else {
        text.setValue(actualValue);
      }
      const inputContainer = text.inputEl.parentElement;
      if (inputContainer) {
        inputContainer.style.position = "relative";
        const toggleBtn = inputContainer.createEl("button", { cls: "nova-toggle-btn" });
        toggleBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
					<circle cx="12" cy="12" r="3"/>
				</svg>`;
        toggleBtn.addEventListener("click", (e) => {
          e.preventDefault();
          isVisible = !isVisible;
          if (isVisible) {
            text.inputEl.type = "text";
            text.setValue(actualValue);
            toggleBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="m9.88 9.88a3 3 0 1 0 4.24 4.24"/>
							<path d="m10.73 5.08a10.43 10.43 0 0 1 1.27-.08c7 0 11 8 11 8a13.16 13.16 0 0 1-1.67 2.68"/>
							<path d="M6.61 6.61A13.526 13.526 0 0 0 1 12s4 8 11 8a9.74 9.74 0 0 0 5.39-1.61"/>
							<line x1="2" y1="2" x2="22" y2="22"/>
						</svg>`;
          } else {
            text.inputEl.type = "password";
            if (actualValue && actualValue.length > 12) {
              const masked = actualValue.slice(0, 8) + "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022" + actualValue.slice(-4);
              text.setValue(masked);
            } else {
              text.setValue(actualValue);
            }
            toggleBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
							<circle cx="12" cy="12" r="3"/>
						</svg>`;
          }
        });
      }
      text.onChange(async (value) => {
        actualValue = value;
        await options.onChange(value);
      });
      return text;
    });
  }
  createProviderStatusIndicator(container, provider) {
    const statusContainer = container.createDiv({ cls: "nova-provider-status-container" });
    try {
      const status = this.getProviderStatus(provider);
      const statusEl = statusContainer.createDiv({ cls: `nova-provider-status ${status.status}` });
      const dot = statusEl.createSpan({ cls: "nova-status-dot" });
      const text = statusEl.createSpan({ cls: "nova-status-text" });
      text.textContent = this.getStatusDisplayText(status);
      if (status.lastChecked || status.message) {
        const tooltip = statusEl.createDiv({ cls: "nova-status-tooltip" });
        if (status.lastChecked) {
          const timeEl = tooltip.createDiv({ cls: "nova-status-time" });
          const date = status.lastChecked instanceof Date ? status.lastChecked : new Date(status.lastChecked);
          timeEl.textContent = `Last checked: ${date.toLocaleDateString()}`;
        }
        if (status.message) {
          const messageEl = tooltip.createDiv({ cls: "nova-status-message" });
          messageEl.textContent = status.message;
        }
      }
    } catch (error) {
      console.error("Error creating provider status indicator:", error);
      const statusEl = statusContainer.createDiv({ cls: "nova-provider-status untested" });
      const dot = statusEl.createSpan({ cls: "nova-status-dot" });
      const text = statusEl.createSpan({ cls: "nova-status-text" });
      text.textContent = "Status unknown";
    }
    return statusContainer;
  }
  getProviderStatus(provider) {
    var _a;
    try {
      const savedStatus = (_a = this.plugin.settings.providerStatus) == null ? void 0 : _a[provider];
      if (savedStatus) {
        return savedStatus;
      }
      const hasConfig = this.hasProviderConfig(provider);
      return {
        status: hasConfig ? "untested" : "not-configured",
        message: hasConfig ? "Configuration not tested" : "No API key configured",
        lastChecked: null
      };
    } catch (error) {
      console.error(`Error getting provider status for ${provider}:`, error);
      return {
        status: "not-configured",
        message: "Status unavailable",
        lastChecked: null
      };
    }
  }
  getStatusDisplayText(status) {
    switch (status.status) {
      case "connected":
        return "Connected";
      case "error":
        return "Connection failed";
      case "not-configured":
        return "Not configured";
      case "untested":
        return "Untested";
      case "testing":
        return "Testing...";
      default:
        return "Unknown";
    }
  }
  createTestConnectionButton(container, provider) {
    const setting = new import_obsidian12.Setting(container).setName("Connection Status").setDesc("Test your API connection");
    const statusContainer = setting.controlEl.createDiv({ cls: "nova-connection-status-container" });
    setting.addButton((button) => {
      button.setButtonText("Test Connection").setTooltip(`Test ${provider} connection`).onClick(async () => {
        await this.testProviderConnection(provider, button.buttonEl, statusContainer);
      });
      button.buttonEl.setAttribute("aria-label", `Test ${this.getProviderDisplayName(provider)} connection`);
      return button;
    });
    this.updateConnectionStatus(statusContainer, provider);
  }
  async testProviderConnection(provider, buttonEl, statusContainer) {
    var _a, _b, _c, _d, _e, _f, _g;
    const originalText = buttonEl.textContent || "Test Connection";
    const button = buttonEl;
    button.disabled = false;
    button.textContent = "Testing...";
    button.style.opacity = "0.6";
    await this.updateProviderStatus(provider, "testing", "Testing connection...");
    this.setConnectionStatus(statusContainer, "testing", "Testing...");
    const restoreButton = () => {
      button.disabled = false;
      button.textContent = originalText;
      button.style.opacity = "1";
    };
    const backupTimer = setTimeout(restoreButton, 12e3);
    try {
      const hasConfig = this.hasProviderConfig(provider);
      if (!hasConfig) {
        throw new Error("Provider not configured - missing API key or settings");
      }
      const timeoutPromise = new Promise((_, reject) => {
        setTimeout(() => reject(new Error("Connection timeout")), 1e4);
      });
      const testPromise = this.performRealConnectionTest(provider);
      await Promise.race([testPromise, timeoutPromise]);
      await this.updateProviderStatus(provider, "connected", "Connected successfully");
      this.setConnectionStatus(statusContainer, "success", "\u25CF Connected");
      if (provider === "ollama" && this.plugin.settings.aiProviders.ollama.model) {
        const platform = import_obsidian12.Platform.isMobile ? "mobile" : "desktop";
        this.plugin.settings.platformSettings[platform].selectedModel = this.plugin.settings.aiProviders.ollama.model;
        await this.plugin.saveSettings();
      }
      document.dispatchEvent(new CustomEvent("nova-provider-configured", {
        detail: { provider, status: "connected" }
      }));
    } catch (error) {
      console.error(`Connection test failed for ${provider}:`, error);
      let errorMessage = "Connection failed";
      if (error.message === "Connection timeout") {
        errorMessage = "Timeout";
      } else if (provider === "ollama") {
        const ollamaUrl = this.plugin.settings.aiProviders.ollama.baseUrl;
        if (!ollamaUrl || ollamaUrl.trim() === "") {
          errorMessage = "No URL configured";
        } else {
          errorMessage = "Connection failed";
        }
      } else if (((_a = error.message) == null ? void 0 : _a.includes("401")) || ((_b = error.message) == null ? void 0 : _b.includes("unauthorized")) || ((_c = error.message) == null ? void 0 : _c.includes("API key"))) {
        errorMessage = "Invalid API key";
      } else if ((_d = error.message) == null ? void 0 : _d.includes("429")) {
        errorMessage = "Rate limited";
      } else if ((_e = error.message) == null ? void 0 : _e.includes("quota")) {
        errorMessage = "Quota exceeded";
      } else if (((_f = error.message) == null ? void 0 : _f.includes("not configured")) || ((_g = error.message) == null ? void 0 : _g.includes("missing"))) {
        errorMessage = "Not configured";
      } else {
        errorMessage = "Connection failed";
      }
      await this.updateProviderStatus(provider, "error", errorMessage);
      this.setConnectionStatus(statusContainer, "error", `\u25CF ${errorMessage}`);
      document.dispatchEvent(new CustomEvent("nova-provider-disconnected", {
        detail: { provider, status: "error", message: errorMessage }
      }));
    } finally {
      clearTimeout(backupTimer);
      restoreButton();
    }
  }
  async updateProviderStatus(provider, status, message) {
    if (!this.plugin.settings.providerStatus) {
      this.plugin.settings.providerStatus = {};
    }
    this.plugin.settings.providerStatus[provider] = {
      status,
      message,
      lastChecked: status === "testing" ? null : /* @__PURE__ */ new Date()
    };
    await this.plugin.saveSettings();
    this.refreshProviderStatusIndicators();
  }
  refreshProviderStatusIndicators() {
    const containers = this.containerEl.querySelectorAll(".nova-provider-status-container");
    containers.forEach((container) => {
      const provider = container.getAttribute("data-provider");
      if (provider) {
        this.updateProviderStatusDisplay(container, provider);
      }
    });
  }
  updateProviderStatusDisplay(container, provider) {
    const status = this.getProviderStatus(provider);
    const statusEl = container.querySelector(".nova-provider-status");
    if (statusEl) {
      statusEl.className = `nova-provider-status ${status.status}`;
      const textEl = statusEl.querySelector(".nova-status-text");
      if (textEl) {
        textEl.textContent = this.getStatusDisplayText(status);
      }
      let tooltip = statusEl.querySelector(".nova-status-tooltip");
      if (status.lastChecked || status.message) {
        if (!tooltip) {
          tooltip = statusEl.createDiv({ cls: "nova-status-tooltip" });
        }
        tooltip.empty();
        if (status.lastChecked) {
          const timeEl = tooltip.createDiv({ cls: "nova-status-time" });
          const date = status.lastChecked instanceof Date ? status.lastChecked : new Date(status.lastChecked);
          timeEl.textContent = `Last checked: ${date.toLocaleDateString()}`;
        }
        if (status.message) {
          const messageEl = tooltip.createDiv({ cls: "nova-status-message" });
          messageEl.textContent = status.message;
        }
      } else if (tooltip) {
        tooltip.remove();
      }
    }
  }
  async performRealConnectionTest(provider) {
    switch (provider) {
      case "claude": {
        const claudeProvider = new ClaudeProvider(this.plugin.settings.aiProviders.claude);
        await claudeProvider.complete("You are a helpful assistant.", "Hi", { maxTokens: 1 });
        break;
      }
      case "openai": {
        const openaiProvider = new OpenAIProvider(this.plugin.settings.aiProviders.openai);
        await openaiProvider.getAvailableModels();
        break;
      }
      case "google": {
        const googleProvider = new GoogleProvider(this.plugin.settings.aiProviders.google);
        await googleProvider.getAvailableModels();
        break;
      }
      case "ollama": {
        const ollamaProvider = new OllamaProvider(this.plugin.settings.aiProviders.ollama);
        const isAvailable = await ollamaProvider.isAvailable();
        if (!isAvailable) {
          throw new Error("Ollama connection failed");
        }
        break;
      }
    }
  }
  setConnectionStatus(container, type, message) {
    container.empty();
    if (type === "none") return;
    const statusEl = container.createDiv({ cls: `nova-status-indicator ${type}` });
    statusEl.textContent = message;
  }
  updateConnectionStatus(container, provider) {
    const hasConfig = this.hasProviderConfig(provider);
    if (!hasConfig) {
      this.setConnectionStatus(container, "none", "");
    } else {
      this.setConnectionStatus(container, "none", "");
    }
  }
  hasProviderConfig(provider) {
    switch (provider) {
      case "claude":
        return !!this.plugin.settings.aiProviders.claude.apiKey;
      case "openai":
        return !!this.plugin.settings.aiProviders.openai.apiKey;
      case "google":
        return !!this.plugin.settings.aiProviders.google.apiKey;
      case "ollama":
        return !!this.plugin.settings.aiProviders.ollama.baseUrl;
      default:
        return false;
    }
  }
  createLicenseSettings(containerEl = this.containerEl) {
    var _a, _b;
    const licenseContainer = containerEl.createDiv({ cls: "nova-license-section" });
    licenseContainer.createEl("h3", { text: "Supernova Supporter Status" });
    const infoEl = licenseContainer.createDiv({ cls: "nova-model-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card compact">
				<p>Nova provides all features for free when you use your own AI provider API keys. 
				Supernova supporters get early access to new features.</p>
			</div>
		`;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    const statusDisplay = licenseContainer.createDiv({ cls: "nova-supernova-status" });
    const badge = this.getLicenseBadge(supernovaLicense);
    const statusText = (badge == null ? void 0 : badge.text) || (isSupernova ? "Supernova Supporter" : "Nova User");
    const statusIcon = badge ? badge.icon : isSupernova ? `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: #9333ea; filter: drop-shadow(0 0 4px rgba(147, 51, 234, 0.6));">
			<circle cx="12" cy="12" r="2.5" fill="currentColor"/>
			<path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
			<path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
			<path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
		</svg>` : `<svg viewBox="0 0 24 24" style="width: 14px; height: 14px; color: var(--text-normal);">
			${NOVA_ICON_SVG}
		</svg>`;
    statusDisplay.innerHTML = `
			<div class="nova-status-badge ${(badge == null ? void 0 : badge.className) || (isSupernova ? "supernova" : "nova")}" ${badge ? `style="border-color: ${badge.color}; color: ${badge.color};"` : ""}>
				<span class="status-icon">${statusIcon}</span>
				<span class="status-name">${statusText}</span>
			</div>
		`;
    if (supernovaLicense) {
      const statusEl = licenseContainer.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires: ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime Support";
      statusEl.innerHTML = `
				<div class="license-info">
					<span class="license-email">${supernovaLicense.email}</span>
					<span class="license-expiry">${expiryText}</span>
				</div>
			`;
    }
    this.createSecureApiKeyInput(licenseContainer, {
      name: "Supernova License Key (Optional)",
      desc: "Enter your Supernova supporter license key for early access to new features",
      placeholder: "Enter Supernova license key...",
      value: this.plugin.settings.licensing.supernovaLicenseKey || "",
      onChange: async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.updateTabContent();
        }
      }
    });
    const validateSetting = new import_obsidian12.Setting(licenseContainer).setDesc("Validate your Supernova license key").addButton((button) => {
      button.setButtonText("Validate License").onClick(async () => {
        const licenseKey = this.plugin.settings.licensing.supernovaLicenseKey;
        if (!licenseKey) {
          this.showLicenseMessage("Please enter a Supernova license key first.", "error");
          return;
        }
        button.setButtonText("Validating...");
        button.disabled = true;
        try {
          if (this.plugin.featureManager) {
            await this.plugin.featureManager.updateSupernovaLicense(licenseKey);
            const isSupernova2 = this.plugin.featureManager.isSupernovaSupporter();
            if (isSupernova2) {
              this.showLicenseMessage("Valid Supernova license! You now have early access to new features.", "success");
              this.showConfetti();
            } else {
              this.showLicenseMessage("Invalid or expired Supernova license key.", "error");
            }
            const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
            if (leaves.length > 0) {
              const sidebarView = leaves[0].view;
              sidebarView.refreshSupernovaUI();
            }
            this.updateTabContent();
          }
        } catch (error) {
          this.showLicenseMessage("Error validating Supernova license.", "error");
        } finally {
          button.setButtonText("Validate License");
          button.disabled = false;
        }
      });
    });
    this.createSupernovaInfo(licenseContainer);
  }
  createSupernovaInfo(container) {
    const supernovaInfo = container.createDiv({ cls: "nova-supernova-info" });
    supernovaInfo.innerHTML = `
			<div class="nova-info-card">
				<h5>Become a Supernova Supporter</h5>
				<p>Support Nova development and get early access to new features. All features eventually become free for everyone.</p>
				<ul>
					<li>Early access to new features (3-6 months before general release)</li>
					<li>Priority support and feature requests</li>
					<li>Supporter badge and recognition</li>
					<li>Directly support open-source development</li>
				</ul>
			</div>
		`;
  }
  createDebugSettings(container) {
    const debugContainer = container.createDiv({ cls: "nova-debug-section" });
    debugContainer.createEl("h4", { text: "Development Settings" });
    new import_obsidian12.Setting(debugContainer).setName("Debug Mode").setDesc("Enable development testing features").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.enabled).onChange(async (value) => {
      this.plugin.settings.licensing.debugSettings.enabled = value;
      await this.plugin.saveSettings();
      if (this.plugin.featureManager) {
        this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
      }
      this.display();
    }));
    if (this.plugin.settings.licensing.debugSettings.enabled) {
      new import_obsidian12.Setting(debugContainer).setName("Override Date").setDesc("Override current date for testing time-gated features (YYYY-MM-DD)").addText((text) => text.setPlaceholder("2025-12-01").setValue(this.plugin.settings.licensing.debugSettings.overrideDate || "").onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.overrideDate = value || void 0;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
      }));
      new import_obsidian12.Setting(debugContainer).setName("Force Supernova Status").setDesc("Override Supernova supporter status for testing").addToggle((toggle) => toggle.setValue(this.plugin.settings.licensing.debugSettings.forceSupernova || false).onChange(async (value) => {
        this.plugin.settings.licensing.debugSettings.forceSupernova = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        if (value) {
          this.showConfetti();
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.updateTabContent();
      }));
      new import_obsidian12.Setting(debugContainer).setName("Clear All Licenses").setDesc("Remove all applied licenses (for testing)").addButton((button) => button.setButtonText("Clear Licenses").setWarning().onClick(async () => {
        const confirmed = confirm("Are you sure you want to clear all licenses? This will remove any applied Supernova license.");
        if (!confirmed) return;
        this.plugin.settings.licensing.supernovaLicenseKey = "";
        if (this.plugin.settings.licensing.debugSettings.forceSupernova) {
          this.plugin.settings.licensing.debugSettings.forceSupernova = false;
        }
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(null);
          this.plugin.featureManager.updateDebugSettings(this.plugin.settings.licensing.debugSettings);
        }
        const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
        }
        this.showLicenseMessage("All licenses cleared successfully.", "success");
        this.updateTabContent();
      }));
    }
  }
  showLicenseMessage(message, type) {
    const existingMessage = this.containerEl.querySelector(".nova-license-message");
    if (existingMessage) {
      existingMessage.remove();
    }
    const messageEl = this.containerEl.createDiv({
      cls: `nova-license-message ${type}`,
      text: message
    });
    setTimeout(() => {
      messageEl.remove();
    }, 5e3);
  }
  showConfetti() {
    const confettiContainer = document.createElement("div");
    confettiContainer.className = "nova-confetti-container";
    document.body.appendChild(confettiContainer);
    const rect = this.containerEl.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + Math.min(rect.height / 2, 300);
    const colors = ["gold", "blue", "pink", "green", "red", ""];
    for (let i = 0; i < 150; i++) {
      const confetti = document.createElement("div");
      confetti.className = `nova-confetti-piece ${colors[Math.floor(Math.random() * colors.length)]}`;
      confetti.style.left = `${centerX}px`;
      confetti.style.top = `${centerY}px`;
      const angle = Math.PI * 2 * i / 150 + (Math.random() * 0.2 - 0.1);
      const velocity = 250 + Math.random() * 350;
      const explodeX = Math.cos(angle) * velocity;
      const explodeY = Math.sin(angle) * velocity - 150;
      confetti.style.setProperty("--explode-x", `${explodeX}px`);
      confetti.style.setProperty("--explode-y", `${explodeY}px`);
      confetti.style.animationDelay = `${Math.random() * 0.2}s`;
      const size = 6 + Math.random() * 14;
      confetti.style.width = `${size}px`;
      confetti.style.height = `${size}px`;
      if (Math.random() > 0.5) {
        confetti.style.height = `${size * 0.4}px`;
      }
      confettiContainer.appendChild(confetti);
    }
    setTimeout(() => {
      confettiContainer.remove();
    }, 4e3);
  }
  createGeneralSettings(containerEl = this.containerEl) {
    const coreSection = containerEl.createDiv({ cls: "nova-core-settings-section" });
    coreSection.createEl("h3", { text: "Core Settings" });
    coreSection.style.marginBottom = "32px";
    new import_obsidian12.Setting(coreSection).setName("Default Temperature").setDesc("Controls randomness in AI responses (0.0 = focused, 1.0 = creative)").addSlider((slider) => slider.setLimits(0, 1, 0.1).setValue(this.plugin.settings.general.defaultTemperature).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultTemperature = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(coreSection).setName("Default Max Tokens").setDesc("Maximum length of AI responses (1000-10000 tokens)").addSlider((slider) => slider.setLimits(1e3, 1e4, 500).setValue(this.plugin.settings.general.defaultMaxTokens).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.general.defaultMaxTokens = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian12.Setting(coreSection).setName("Auto-save settings").setDesc("Automatically save configuration changes").addToggle((toggle) => toggle.setValue(this.plugin.settings.general.autoSave).onChange(async (value) => {
      this.plugin.settings.general.autoSave = value;
      await this.plugin.saveSettings();
    }));
  }
  createProviderSettings(containerEl = this.containerEl) {
    const apiKeysSection = containerEl.createDiv({ cls: "nova-api-keys-section" });
    apiKeysSection.createEl("h3", { text: "Configure Your API Keys" });
    apiKeysSection.createEl("hr", { cls: "nova-section-divider" });
    const infoEl = apiKeysSection.createDiv({ cls: "nova-provider-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<p>Nova connects to AI providers using your own API keys. All providers are available to all users - 
				just add your API keys below to get started.</p>
				<p><strong>Model Selection:</strong> After connecting successfully, select models for any provider using the dropdown in the Nova sidebar.</p>
			</div>
			<div class="nova-info-card nova-model-guidance">
				<h4>Recommended Defaults</h4>
				<ul class="nova-model-recommendations">
					<li><strong>Claude Sonnet 4</strong> - Latest generation with excellent instruction following for collaborative editing</li>
					<li><strong>GPT-4.1 Mini</strong> - Current-generation model that outperforms GPT-4o while remaining cost-effective</li>
					<li><strong>Gemini 2.5 Flash</strong> - Best price/performance with "thinking" capabilities and strong coding support</li>
					<li><strong>Ollama (Local)</strong> - Complete privacy with local processing - requires setup but keeps all data on your device</li>
				</ul>
				<p class="nova-guidance-note">Cloud options offer modern AI capabilities without premium pricing, while local options provide complete privacy.</p>
			</div>
		`;
    const configSection = apiKeysSection.createDiv({ cls: "nova-provider-config-section" });
    configSection.createEl("h4", { text: "Configuration" });
    configSection.createEl("hr", { cls: "nova-section-divider" });
    this.createOllamaSettings(configSection);
    this.createClaudeSettings(configSection);
    this.createGoogleSettings(configSection);
    this.createOpenAISettings(configSection);
  }
  createClaudeSettings(containerEl = this.containerEl) {
    const claudeContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = claudeContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "Claude (Anthropic)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "claude");
    statusContainer.setAttribute("data-provider", "claude");
    this.createSecureApiKeyInput(claudeContainer, {
      name: "API Key",
      desc: "Your Anthropic API key",
      placeholder: "sk-ant-...",
      value: this.plugin.settings.aiProviders.claude.apiKey || "",
      onChange: async (value) => {
        this.plugin.settings.aiProviders.claude.apiKey = value;
        await this.plugin.saveSettings();
      }
    });
    this.createTestConnectionButton(claudeContainer, "claude");
  }
  createOpenAISettings(containerEl = this.containerEl) {
    const openaiContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = openaiContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "ChatGPT (OpenAI)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "openai");
    statusContainer.setAttribute("data-provider", "openai");
    this.createSecureApiKeyInput(openaiContainer, {
      name: "API Key",
      desc: "Your OpenAI API key",
      placeholder: "sk-...",
      value: this.plugin.settings.aiProviders.openai.apiKey || "",
      onChange: async (value) => {
        this.plugin.settings.aiProviders.openai.apiKey = value;
        await this.plugin.saveSettings();
      }
    });
    this.createTestConnectionButton(openaiContainer, "openai");
  }
  createGoogleSettings(containerEl = this.containerEl) {
    const googleContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = googleContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "Google (Gemini)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "google");
    statusContainer.setAttribute("data-provider", "google");
    this.createSecureApiKeyInput(googleContainer, {
      name: "API Key",
      desc: "Your Google AI API key",
      placeholder: "AI...",
      value: this.plugin.settings.aiProviders.google.apiKey || "",
      onChange: async (value) => {
        this.plugin.settings.aiProviders.google.apiKey = value;
        await this.plugin.saveSettings();
      }
    });
    this.createTestConnectionButton(googleContainer, "google");
  }
  createOllamaSettings(containerEl = this.containerEl) {
    const ollamaContainer = containerEl.createDiv({ cls: "nova-provider-section" });
    const headerContainer = ollamaContainer.createDiv({ cls: "nova-provider-header" });
    const titleEl = headerContainer.createEl("h4", { text: "Ollama (Local)" });
    const statusContainer = this.createProviderStatusIndicator(titleEl, "ollama");
    statusContainer.setAttribute("data-provider", "ollama");
    new import_obsidian12.Setting(ollamaContainer).setName("Base URL").setDesc("Ollama server URL").addText((text) => {
      text.inputEl.style.width = "350px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("http://localhost:11434").setValue(this.plugin.settings.aiProviders.ollama.baseUrl || "").onChange(async (value) => {
        this.plugin.settings.aiProviders.ollama.baseUrl = value;
        await this.plugin.saveSettings();
      });
    });
    this.createTestConnectionButton(ollamaContainer, "ollama");
    new import_obsidian12.Setting(ollamaContainer).setName("Model").setDesc("Ollama model to use").addText((text) => {
      text.inputEl.style.width = "200px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("llama2").setValue(this.plugin.settings.aiProviders.ollama.model || "").onChange(async (value) => {
        this.plugin.settings.aiProviders.ollama.model = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian12.Setting(ollamaContainer).setName("Default Context Limit").setDesc("Context window size for all Ollama models (Nova defaults to 32K vs Ollama's 2K)").addText((text) => {
      text.inputEl.type = "number";
      text.inputEl.style.width = "150px";
      text.inputEl.style.height = "40px";
      return text.setPlaceholder("32000").setValue((this.plugin.settings.ollamaDefaultContext || 32e3).toString()).onChange(async (value) => {
        const numValue = parseInt(value);
        if (!isNaN(numValue) && numValue > 0) {
          this.plugin.settings.ollamaDefaultContext = numValue;
          await this.plugin.saveSettings();
        }
      });
    });
  }
  createPlatformSettings(containerEl = this.containerEl) {
    containerEl.createEl("h3", { text: "Platform Settings" });
    const infoEl = containerEl.createDiv({ cls: "nova-platform-info" });
    infoEl.innerHTML = `
			<div class="nova-info-card">
				<h4>\u{1F5A5}\uFE0F Platform Configuration</h4>
				<p>Configure which AI provider to use as your primary provider on different platforms. 
				Nova works seamlessly across desktop and mobile with all providers.</p>
			</div>
		`;
    new import_obsidian12.Setting(containerEl).setName("Model Selection").setDesc("Models are now selected using the dropdown in the Nova sidebar. Each platform (desktop/mobile) remembers its selected model independently.");
  }
  getAllowedProvidersForPlatform(platform) {
    return platform === "desktop" ? ["claude", "openai", "google", "ollama"] : ["claude", "openai", "google"];
  }
  getProviderDisplayName(provider) {
    const names = {
      "claude": "Claude (Anthropic)",
      "openai": "ChatGPT (OpenAI)",
      "google": "Google (Gemini)",
      "ollama": "Ollama (Local)",
      "none": "None (Disabled)"
    };
    return names[provider] || provider;
  }
  async setCurrentModel(modelId) {
    const platform = import_obsidian12.Platform.isMobile ? "mobile" : "desktop";
    this.plugin.settings.platformSettings[platform].selectedModel = modelId;
    if (this.plugin.aiProviderManager) {
      this.plugin.aiProviderManager.updateSettings(this.plugin.settings);
    }
  }
  createCommandSettings(containerEl = this.containerEl) {
    containerEl.createEl("h3", { text: "Custom Commands" });
    if (!this.plugin.featureManager.isFeatureEnabled("commands")) {
      const noticeEl = containerEl.createDiv({ cls: "nova-feature-notice" });
      noticeEl.innerHTML = `
				<div style="padding: 16px; background: var(--background-modifier-hover); border-radius: 8px; border: 1px solid var(--background-modifier-border);">
					<h4 style="margin: 0 0 8px 0; color: var(--text-normal);">Supernova Supporter Feature</h4>
					<p style="margin: 0; color: var(--text-muted); font-size: 0.9em;">
						Custom commands are currently available to Supernova supporters. 
						They will be available to all users on <strong>October 1, 2025</strong>.
					</p>
				</div>
			`;
      return;
    }
    const descEl = containerEl.createDiv({ cls: "nova-command-description" });
    descEl.innerHTML = `
			<p style="color: var(--text-muted); margin-bottom: 16px;">
				Create custom command shortcuts that insert predefined text templates when triggered with <code>:trigger</code>.
			</p>
		`;
    new import_obsidian12.Setting(containerEl).setName("Show Command Button in Chat (Mobile)").setDesc("Show the Commands button beside the Send button for mobile quick access to Nova commands and selection actions").addToggle((toggle) => toggle.setValue(this.plugin.settings.showCommandButton).onChange(async (value) => {
      this.plugin.settings.showCommandButton = value;
      await this.plugin.saveSettings();
      const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
      if (leaves.length > 0) {
        const sidebarView = leaves[0].view;
        sidebarView.refreshCommandButton();
      }
    }));
    const buttonEl = containerEl.createDiv({ cls: "nova-add-command" });
    buttonEl.style.cssText = "margin-bottom: 16px;";
    new import_obsidian12.Setting(buttonEl).addButton(
      (button) => button.setButtonText("+ Add Custom Command").setCta().onClick(() => this.showAddCommandDialog())
    );
    this.renderCustomCommandsList(containerEl);
  }
  renderCustomCommandsList(container) {
    const existingList = container.querySelector(".nova-commands-list");
    if (existingList) existingList.remove();
    const commandsList = container.createDiv({ cls: "nova-commands-list" });
    const commands = this.plugin.settings.customCommands || [];
    if (commands.length === 0) {
      const emptyEl = commandsList.createDiv({ cls: "nova-commands-empty" });
      emptyEl.innerHTML = `
				<div style="text-align: center; padding: 24px; color: var(--text-muted);">
					<p>No custom commands yet.</p>
					<p style="font-size: 0.9em;">Create your first command to get started!</p>
				</div>
			`;
      return;
    }
    commands.forEach((command, index) => {
      const commandEl = commandsList.createDiv({ cls: "nova-command-item" });
      commandEl.style.cssText = `
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				padding: 16px;
				margin-bottom: 12px;
				background: var(--background-primary);
			`;
      const headerEl = commandEl.createDiv({ cls: "nova-command-header" });
      headerEl.style.cssText = "display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;";
      const infoEl = headerEl.createDiv({ cls: "nova-command-info" });
      const nameEl = infoEl.createDiv({ cls: "nova-command-name" });
      nameEl.textContent = command.name;
      nameEl.style.cssText = "font-weight: 600; margin-bottom: 4px;";
      const triggerEl = infoEl.createDiv({ cls: "nova-command-trigger" });
      triggerEl.innerHTML = `<code>:${command.trigger}</code>`;
      triggerEl.style.cssText = "font-family: var(--font-monospace); color: var(--interactive-accent); font-size: 0.9em;";
      const actionsEl = headerEl.createDiv({ cls: "nova-command-actions" });
      actionsEl.style.cssText = "display: flex; gap: 8px;";
      const editBtn = actionsEl.createEl("button", { text: "Edit" });
      editBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px;";
      editBtn.onclick = () => this.showEditCommandDialog(index);
      const deleteBtn = actionsEl.createEl("button", { text: "Delete" });
      deleteBtn.style.cssText = "padding: 4px 8px; font-size: 0.8em; border-radius: 4px; background: var(--background-modifier-error); color: var(--text-on-accent);";
      deleteBtn.onclick = () => this.deleteCommand(index);
      if (command.description) {
        const descEl = commandEl.createDiv({ cls: "nova-command-desc" });
        descEl.textContent = command.description;
        descEl.style.cssText = "color: var(--text-muted); font-size: 0.9em; margin-bottom: 8px;";
      }
      const templateEl = commandEl.createDiv({ cls: "nova-command-template" });
      templateEl.innerHTML = `
				<div style="background: var(--background-modifier-hover); padding: 8px; border-radius: 4px; font-family: var(--font-monospace); font-size: 0.8em; white-space: pre-wrap; max-height: 60px; overflow-y: auto;">
					${command.template}
				</div>
			`;
    });
  }
  showAddCommandDialog() {
    this.showCommandDialog();
  }
  showEditCommandDialog(index) {
    var _a;
    const command = (_a = this.plugin.settings.customCommands) == null ? void 0 : _a[index];
    if (command) {
      this.showCommandDialog(command, index);
    }
  }
  showCommandDialog(existingCommand, editIndex) {
    const name = prompt("Command name:", (existingCommand == null ? void 0 : existingCommand.name) || "");
    if (!name) return;
    const trigger = prompt("Command trigger (without :):", (existingCommand == null ? void 0 : existingCommand.trigger) || "");
    if (!trigger) return;
    const description = prompt("Description (optional):", (existingCommand == null ? void 0 : existingCommand.description) || "");
    const template = prompt("Template content:", (existingCommand == null ? void 0 : existingCommand.template) || "");
    if (!template) return;
    const result = {
      id: (existingCommand == null ? void 0 : existingCommand.id) || "cmd_" + Math.random().toString(36).substr(2, 9),
      name,
      trigger: trigger.toLowerCase(),
      template,
      description: description || void 0
    };
    if (editIndex !== void 0) {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands[editIndex] = result;
    } else {
      if (!this.plugin.settings.customCommands) this.plugin.settings.customCommands = [];
      this.plugin.settings.customCommands.push(result);
    }
    this.plugin.saveSettings();
    this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
  }
  deleteCommand(index) {
    if (!this.plugin.settings.customCommands) return;
    const command = this.plugin.settings.customCommands[index];
    const confirmed = confirm(`Delete command "${command.name}" (${command.trigger})?`);
    if (confirmed) {
      this.plugin.settings.customCommands.splice(index, 1);
      this.plugin.saveSettings();
      this.renderCustomCommandsList(this.containerEl.querySelector(".nova-command-section"));
    }
  }
  createWelcomeSection(container) {
    const welcomeSection = container.createDiv({ cls: "nova-welcome-section" });
    const headerDiv = welcomeSection.createDiv({ cls: "nova-welcome-header" });
    headerDiv.innerHTML = `
			<div class="nova-welcome-logo">
				${NOVA_ICON_SVG}
			</div>
			<div class="nova-welcome-content">
				<h2>Welcome to Nova</h2>
				<p class="nova-tagline">Your AI writing partner to make the writing process smoother</p>
				<p class="nova-story">Removes the friction of copy/paste from LLMs to Obsidian, and provides actionable insights to help improve your writing</p>
			</div>
		`;
  }
  createQuickStartGuide(container) {
    const guideSection = container.createDiv({ cls: "nova-quick-start-section" });
    guideSection.style.marginTop = "32px";
    const selectionCard = guideSection.createDiv({ cls: "nova-quick-start-card" });
    selectionCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F3AF}</span>
				<h4>Selection-Based Editing</h4>
			</div>
			<div class="nova-card-content">
				<ol>
					<li>Select any text in your document</li>
					<li>Right-click to open context menu</li>
					<li>Choose Nova action (Improve Writing, Make Longer)</li>
					<li>Watch AI transform text exactly in place</li>
				</ol>
				<div class="nova-tip">\u{1F4A1} Tip: Select any text in your document and right-click to see Nova actions</div>
			</div>
		`;
    const chatCard = guideSection.createDiv({ cls: "nova-quick-start-card" });
    chatCard.style.marginTop = "24px";
    chatCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F4AC}</span>
				<h4>Chat-Based Targeting</h4>
			</div>
			<div class="nova-card-content">
				<ol>
					<li>Place cursor where you want content</li>
					<li>Type command: "Add conclusion section"</li>
					<li>Nova edits precisely at cursor location</li>
				</ol>
				<div class="nova-tip">\u{1F4F1} Works identically on desktop and mobile</div>
			</div>
		`;
    const providerCard = guideSection.createDiv({ cls: "nova-quick-start-card" });
    providerCard.style.marginTop = "24px";
    providerCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u{1F916}</span>
				<h4>AI Provider Selection</h4>
			</div>
			<div class="nova-card-content">
				<p>Choose the right AI for your task:</p>
				<ul>
					<li><strong>Claude</strong> - For complex reasoning and analysis</li>
					<li><strong>OpenAI</strong> - For balanced performance and creativity</li>
					<li><strong>Gemini</strong> - For fast responses and research</li>
					<li><strong>Ollama</strong> - For local privacy and offline use \u{1F512}</li>
				</ul>
				<div class="nova-tip">Configure providers in the AI Providers tab</div>
			</div>
		`;
  }
  /**
   * Get badge information for license type
   */
  getLicenseBadge(license) {
    if (!license) return null;
    switch (license.type) {
      case "founding":
        return {
          icon: "\u2B50",
          color: "#fdcb6e",
          text: "Founding Supernova",
          className: "founding"
        };
      case "lifetime":
        return {
          icon: "\u221E",
          color: "#9333ea",
          text: "Lifetime Supernova",
          className: "lifetime"
        };
      case "annual":
        return {
          icon: "\u{1F680}",
          color: "#3b82f6",
          text: "Supernova",
          className: "supernova"
        };
      default:
        return null;
    }
  }
  createSupernovaLicenseInput(container) {
    var _a, _b;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    const supernovaLicense = (_b = this.plugin.featureManager) == null ? void 0 : _b.getSupernovaLicense();
    if (supernovaLicense) {
      const badge = this.getLicenseBadge(supernovaLicense);
      const statusEl = container.createDiv({ cls: "nova-license-status" });
      const expiryText = supernovaLicense.expiresAt ? `Expires ${supernovaLicense.expiresAt.toLocaleDateString()}` : "Lifetime License";
      statusEl.innerHTML = `
				<div class="nova-license-validated">
					<div class="nova-license-header">
						<span class="nova-license-checkmark">\u2713</span>
						<span class="nova-license-title">${(badge == null ? void 0 : badge.text) || "Valid Supernova License"}</span>
						${badge ? `<span class="nova-license-badge ${badge.className}" style="background: ${badge.color};">${badge.icon}</span>` : ""}
					</div>
					<div class="nova-license-details">
						<div class="nova-license-email">
							<span class="nova-license-label">Licensed to:</span>
							<span class="nova-license-value">${supernovaLicense.email}</span>
						</div>
						<div class="nova-license-expiry">
							<span class="nova-license-label">Status:</span>
							<span class="nova-license-value">${expiryText}</span>
						</div>
					</div>
				</div>
			`;
    }
    this.createSecureApiKeyInput(container, {
      name: "License Key",
      desc: "Enter your Supernova supporter license key",
      placeholder: "NOVA-XXXX-XXXX-XXXX",
      value: this.plugin.settings.licensing.supernovaLicenseKey || "",
      onChange: async (value) => {
        this.plugin.settings.licensing.supernovaLicenseKey = value;
        await this.plugin.saveSettings();
        if (this.plugin.featureManager) {
          await this.plugin.featureManager.updateSupernovaLicense(value || null);
          const leaves = this.plugin.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
          if (leaves.length > 0) {
            const sidebarView = leaves[0].view;
            sidebarView.refreshSupernovaUI();
          }
          this.updateTabContent();
        }
      }
    });
    const validationEl = container.createDiv({ cls: "nova-validation-status" });
    validationEl.style.marginTop = "8px";
    validationEl.style.fontSize = "0.9em";
  }
  createSupernovaCTA(container, options = {}) {
    var _a;
    const {
      showOnlyIfNotSupporter = false,
      buttonAction = "tab",
      showLearnMore = true,
      marginTop = "0",
      marginBottom = "32px"
    } = options;
    const isSupernova = ((_a = this.plugin.featureManager) == null ? void 0 : _a.isSupernovaSupporter()) || false;
    if (showOnlyIfNotSupporter && isSupernova) {
      return;
    }
    const statusText = isSupernova ? "Supernova Supporter" : "Nova User";
    const statusIcon = isSupernova ? "\u2B50" : "\u{1F31F}";
    const ctaSection = container.createDiv({ cls: "nova-prominent-supernova-section" });
    ctaSection.style.marginTop = marginTop;
    ctaSection.style.marginBottom = marginBottom;
    ctaSection.innerHTML = `
			<div class="nova-supernova-cta">
				<div class="nova-supernova-header">
					<span class="nova-supernova-icon">${statusIcon}</span>
					<div class="nova-supernova-info">
						<h3>Supernova Support</h3>
						<p>Status: <strong>${statusText}</strong></p>
					</div>
				</div>
				<div class="nova-supernova-actions">
					<button class="nova-supernova-btn primary" ${buttonAction === "tab" ? 'data-tab="supernova"' : ""}>
						${isSupernova ? buttonAction === "tab" ? "Manage License" : "Thank You for Supporting!" : "Become a Supporter"}
					</button>
					${showLearnMore ? '<button class="nova-supernova-btn secondary" data-tab="supernova">Learn More</button>' : ""}
				</div>
			</div>
		`;
    if (buttonAction === "tab") {
      ctaSection.querySelectorAll('[data-tab="supernova"]').forEach((button) => {
        button.addEventListener("click", (e) => {
          e.preventDefault();
          this.switchTab("supernova");
        });
      });
    }
  }
  createNavigationHelp(container) {
    const navSection = container.createDiv({ cls: "nova-navigation-section" });
    navSection.style.marginTop = "32px";
    const navCard = navSection.createDiv({ cls: "nova-navigation-card" });
    navCard.innerHTML = `
			<div class="nova-card-header">
				<span class="nova-card-icon">\u26A1</span>
				<h4>Quick Start</h4>
			</div>
			<div class="nova-card-content">
				<div class="nova-next-steps">
					<div class="nova-next-step">
						<span>1. Explore Privacy and General Settings</span>
						<a href="#" class="nova-step-link" data-tab="general">\u2192 Go to General tab</a>
					</div>
					<div class="nova-next-step">
						<span>2. Configure AI providers</span>
						<a href="#" class="nova-step-link" data-tab="providers">\u2192 Go to AI Providers tab</a>
					</div>
					<div class="nova-next-step">
						<span>3. Manage Supernova License</span>
						<a href="#" class="nova-step-link" data-tab="supernova">\u2192 Go to Supernova tab</a>
					</div>
				</div>
				<div class="nova-tip">\u{1F4A1} Tip: Press Cmd+P (Mac) or Ctrl+P (PC), then choose "Nova: Open sidebar" to access Nova</div>
			</div>
		`;
    navCard.querySelectorAll(".nova-step-link").forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const tabId = e.target.getAttribute("data-tab");
        this.switchTab(tabId);
      });
    });
  }
};

// src/ai/provider-manager.ts
var import_obsidian13 = require("obsidian");
var AIProviderManager = class {
  // 30 seconds
  constructor(settings, featureManager) {
    this.providers = /* @__PURE__ */ new Map();
    this.availabilityCache = /* @__PURE__ */ new Map();
    this.CACHE_TTL = 3e4;
    this.settings = settings;
    this.featureManager = featureManager;
  }
  async initialize() {
    this.providers.set("claude", new ClaudeProvider(this.settings.aiProviders.claude));
    this.providers.set("openai", new OpenAIProvider(this.settings.aiProviders.openai));
    this.providers.set("google", new GoogleProvider(this.settings.aiProviders.google));
    this.providers.set("ollama", new OllamaProvider(this.settings.aiProviders.ollama));
  }
  updateSettings(settings) {
    this.settings = settings;
    this.providers.forEach((provider, type) => {
      var _a;
      if (type !== "none" && type in this.settings.aiProviders) {
        (_a = provider.updateConfig) == null ? void 0 : _a.call(provider, this.settings.aiProviders[type]);
      }
    });
    this.availabilityCache.clear();
  }
  /**
   * Check provider availability with caching to avoid repeated network calls
   */
  async checkProviderAvailability(providerType) {
    const now = Date.now();
    const cached = this.availabilityCache.get(providerType);
    if (cached && now - cached.timestamp < this.CACHE_TTL) {
      return cached.isAvailable;
    }
    const provider = this.providers.get(providerType);
    const isAvailable = provider ? await provider.isAvailable() : false;
    this.availabilityCache.set(providerType, {
      isAvailable,
      timestamp: now
    });
    return isAvailable;
  }
  /**
   * Get the provider type that handles a specific model
   */
  getProviderForModel(modelName) {
    return getProviderTypeForModel(modelName, this.settings);
  }
  /**
   * Get the selected model for the current platform
   */
  getSelectedModel() {
    const platform = import_obsidian13.Platform.isMobile ? "mobile" : "desktop";
    const selectedModel = this.settings.platformSettings[platform].selectedModel;
    return selectedModel;
  }
  async getAvailableProvider() {
    const selectedModel = this.getSelectedModel();
    const providerType = this.getProviderForModel(selectedModel);
    if (!providerType || providerType === "none") {
      return null;
    }
    const provider = this.providers.get(providerType);
    const isAvailable = provider ? await this.checkProviderAvailability(providerType) : false;
    if (provider && isAvailable) {
      return provider;
    }
    return null;
  }
  async generateText(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    const enhancedOptions = {
      temperature: this.getDefaultTemperature(),
      maxTokens: this.getDefaultMaxTokens()
    };
    return provider.generateText(prompt2, enhancedOptions);
  }
  async *generateTextStream(prompt2, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    const enhancedOptions = {
      temperature: this.getDefaultTemperature(),
      maxTokens: this.getDefaultMaxTokens()
    };
    yield* provider.generateTextStream(prompt2, enhancedOptions);
  }
  async chatCompletion(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    const enhancedOptions = {
      temperature: this.getDefaultTemperature(),
      maxTokens: this.getDefaultMaxTokens()
    };
    return provider.chatCompletion(messages, enhancedOptions);
  }
  async *chatCompletionStream(messages, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    const enhancedOptions = {
      temperature: this.getDefaultTemperature(),
      maxTokens: this.getDefaultMaxTokens()
    };
    yield* provider.chatCompletionStream(messages, enhancedOptions);
  }
  getProviderNames() {
    return Array.from(this.providers.values()).map((p) => p.name);
  }
  async getCurrentProviderName() {
    const provider = await this.getAvailableProvider();
    return provider ? provider.name : "None";
  }
  async getCurrentProviderType() {
    const selectedModel = this.getSelectedModel();
    const providerType = this.getProviderForModel(selectedModel);
    if (!providerType || providerType === "none") {
      return null;
    }
    const provider = this.providers.get(providerType);
    if (provider && await this.checkProviderAvailability(providerType)) {
      return providerType;
    }
    return null;
  }
  /**
   * Get the currently selected model name
   */
  getCurrentModel() {
    return this.getSelectedModel();
  }
  async complete(systemPrompt, userPrompt, options) {
    const provider = await this.getAvailableProvider();
    if (!provider) {
      throw new Error("Nova is disabled or no AI provider is available");
    }
    const enhancedOptions = {
      temperature: this.getDefaultTemperature(),
      maxTokens: this.getDefaultMaxTokens()
    };
    return provider.complete(systemPrompt, userPrompt, enhancedOptions);
  }
  getAllowedProviders() {
    if (import_obsidian13.Platform.isMobile) {
      return ["claude", "openai", "google"];
    }
    return ["claude", "openai", "google", "ollama"];
  }
  /**
   * Get all available providers with their availability status in parallel
   */
  async getAvailableProvidersWithStatus() {
    const allowedProviders = this.getAllowedProviders();
    const availabilityChecks = allowedProviders.map(async (providerType) => {
      const isAvailable = await this.checkProviderAvailability(providerType);
      return { providerType, isAvailable };
    });
    const results = await Promise.all(availabilityChecks);
    const availabilityMap = /* @__PURE__ */ new Map();
    results.forEach(({ providerType, isAvailable }) => {
      availabilityMap.set(providerType, isAvailable);
    });
    return availabilityMap;
  }
  isProviderAllowed(providerType) {
    return true;
  }
  getProviderLimits() {
    return { local: Infinity, cloud: Infinity };
  }
  /**
   * Get available models for a specific provider
   */
  async getProviderModels(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      throw new Error(`Provider ${providerType} not found`);
    }
    if ("getAvailableModels" in provider && typeof provider.getAvailableModels === "function") {
      return await provider.getAvailableModels();
    }
    return [];
  }
  /**
   * Clear model cache for a specific provider
   */
  clearProviderModelCache(providerType) {
    const provider = this.providers.get(providerType);
    if (!provider) {
      return;
    }
    if ("clearModelCache" in provider && typeof provider.clearModelCache === "function") {
      provider.clearModelCache();
    }
  }
  cleanup() {
    this.providers.clear();
  }
  /**
   * Get the default max tokens from settings
   */
  getDefaultMaxTokens() {
    return this.settings.general.defaultMaxTokens;
  }
  getDefaultTemperature() {
    return this.settings.general.defaultTemperature;
  }
};

// src/core/document-engine.ts
var import_obsidian14 = require("obsidian");

// src/core/conversation-manager.ts
var ConversationManager = class {
  constructor(dataStore) {
    this.dataStore = dataStore;
    this.conversations = /* @__PURE__ */ new Map();
    this.maxMessagesPerFile = 100;
    // Limit conversation history
    this.storageKey = "nova-conversations";
    this.cleanupInterval = null;
    this.initializePromise = this.initialize();
  }
  async initialize() {
    await this.loadConversations();
    this.startPeriodicCleanup();
  }
  /**
   * Load conversations from plugin data
   */
  async loadConversations() {
    try {
      const data = await this.dataStore.loadData(this.storageKey);
      if (data && Array.isArray(data)) {
        for (const conversation of data) {
          try {
            const sanitizedConversation = this.sanitizeConversationData(conversation);
            this.conversations.set(sanitizedConversation.filePath, sanitizedConversation);
          } catch (error) {
            console.warn(`Skipped corrupted conversation for file: ${(conversation == null ? void 0 : conversation.filePath) || "unknown"}`, error);
          }
        }
      }
    } catch (error) {
      console.error("\u274C ConversationManager.loadConversations: Load failed:", error);
    }
  }
  /**
   * Sanitize and validate conversation data
   */
  sanitizeConversationData(conversation) {
    if (!conversation.filePath || typeof conversation.filePath !== "string") {
      throw new Error("Invalid or missing filePath");
    }
    const messages = Array.isArray(conversation.messages) ? conversation.messages : [];
    let contextDocuments = [];
    if (Array.isArray(conversation.contextDocuments)) {
      contextDocuments = conversation.contextDocuments.filter((doc) => this.isValidContextDocument(doc)).map((doc) => this.sanitizeContextDocument(doc));
    }
    return {
      filePath: conversation.filePath,
      messages,
      lastUpdated: typeof conversation.lastUpdated === "number" ? conversation.lastUpdated : Date.now(),
      contextDocuments,
      metadata: conversation.metadata || {
        editCount: 0,
        commandFrequency: {
          add: 0,
          edit: 0,
          delete: 0,
          grammar: 0,
          rewrite: 0,
          metadata: 0
        }
      }
    };
  }
  /**
   * Validate context document structure
   */
  isValidContextDocument(doc) {
    return doc && typeof doc.path === "string" && doc.path.trim().length > 0;
  }
  /**
   * Sanitize context document data
   */
  sanitizeContextDocument(doc) {
    return {
      path: doc.path,
      property: typeof doc.property === "string" ? doc.property : void 0,
      addedAt: typeof doc.addedAt === "number" ? doc.addedAt : Date.now()
    };
  }
  /**
   * Save conversations to plugin data
   */
  async saveConversations() {
    try {
      const conversationsArray = Array.from(this.conversations.values());
      await this.dataStore.saveData(this.storageKey, conversationsArray);
    } catch (error) {
      console.error("\u274C ConversationManager.saveConversations: Save failed:", error);
    }
  }
  /**
   * Get conversation for a specific file
   */
  getConversation(file) {
    const filePath = file.path;
    if (!this.conversations.has(filePath)) {
      const newConversation = {
        filePath,
        messages: [],
        lastUpdated: Date.now(),
        contextDocuments: [],
        metadata: {
          editCount: 0,
          commandFrequency: {
            add: 0,
            edit: 0,
            delete: 0,
            grammar: 0,
            rewrite: 0,
            metadata: 0
          }
        }
      };
      this.conversations.set(filePath, newConversation);
    }
    const conversation = this.conversations.get(filePath);
    if (!conversation.contextDocuments) {
      conversation.contextDocuments = [];
    }
    return conversation;
  }
  /**
   * Add a user message to the conversation
   */
  async addUserMessage(file, content, command) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "user",
      content,
      timestamp: Date.now(),
      command
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if (command && conversation.metadata) {
      conversation.metadata.commandFrequency[command.action]++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add an assistant response to the conversation
   */
  async addAssistantMessage(file, content, result) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "assistant",
      content,
      timestamp: Date.now(),
      result
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    if ((result == null ? void 0 : result.success) && conversation.metadata) {
      conversation.metadata.editCount++;
    }
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Add a system message to the conversation
   */
  async addSystemMessage(file, content, metadata) {
    const conversation = this.getConversation(file);
    const message = {
      id: this.generateMessageId(),
      role: "system",
      content,
      timestamp: Date.now(),
      metadata
    };
    conversation.messages.push(message);
    conversation.lastUpdated = Date.now();
    await this.trimAndSave(conversation);
    return message;
  }
  /**
   * Get recent messages for context
   */
  getRecentMessages(file, count = 10) {
    const conversation = this.getConversation(file);
    return conversation.messages.slice(-count);
  }
  /**
   * Get messages by role
   */
  getMessagesByRole(file, role) {
    const conversation = this.getConversation(file);
    return conversation.messages.filter((msg) => msg.role === role);
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(file, maxMessages = 6) {
    const messages = this.getRecentMessages(file, maxMessages);
    if (messages.length === 0) {
      return "";
    }
    const contextLines = messages.map((msg) => {
      const timestamp = new Date(msg.timestamp).toLocaleTimeString();
      let line = `[${timestamp}] ${msg.role.toUpperCase()}: ${msg.content}`;
      if (msg.command) {
        line += ` (Command: ${msg.command.action} ${msg.command.target})`;
      }
      if (msg.result) {
        line += ` (Result: ${msg.result.success ? "success" : "failed"})`;
      }
      return line;
    });
    return `Previous conversation:
${contextLines.join("\n")}
`;
  }
  /**
   * Clear conversation for a file
   */
  async clearConversation(file) {
    const conversation = this.getConversation(file);
    conversation.messages = [];
    conversation.lastUpdated = Date.now();
    if (conversation.metadata) {
      conversation.metadata.editCount = 0;
      conversation.metadata.commandFrequency = {
        add: 0,
        edit: 0,
        delete: 0,
        grammar: 0,
        rewrite: 0,
        metadata: 0
      };
    }
    await this.saveConversations();
  }
  /**
   * Get conversation statistics
   */
  getStats(file) {
    var _a;
    const conversation = this.getConversation(file);
    let mostUsedCommand = null;
    let maxCount = 0;
    if (conversation.metadata) {
      for (const [action, count] of Object.entries(conversation.metadata.commandFrequency)) {
        if (count > maxCount) {
          maxCount = count;
          mostUsedCommand = action;
        }
      }
    }
    const conversationAge = conversation.messages.length > 0 ? Date.now() - conversation.messages[0].timestamp : 0;
    return {
      messageCount: conversation.messages.length,
      editCount: ((_a = conversation.metadata) == null ? void 0 : _a.editCount) || 0,
      mostUsedCommand,
      conversationAge
    };
  }
  /**
   * Export conversation for a file
   */
  exportConversation(file) {
    const conversation = this.getConversation(file);
    const lines = [`# Conversation History for ${file.name}`, ""];
    for (const message of conversation.messages) {
      const timestamp = new Date(message.timestamp).toLocaleString();
      lines.push(`## ${message.role.toUpperCase()} (${timestamp})`);
      lines.push(message.content);
      if (message.command) {
        lines.push(`*Command: ${message.command.action} ${message.command.target}*`);
      }
      if (message.result) {
        lines.push(`*Result: ${message.result.success ? "Success" : "Failed"}*`);
        if (message.result.error) {
          lines.push(`*Error: ${message.result.error}*`);
        }
      }
      lines.push("");
    }
    return lines.join("\n");
  }
  /**
   * Generate unique message ID
   */
  generateMessageId() {
    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
  /**
   * Trim conversation to max length and save
   */
  async trimAndSave(conversation) {
    if (conversation.messages.length > this.maxMessagesPerFile) {
      conversation.messages = conversation.messages.slice(-this.maxMessagesPerFile);
    }
    await this.saveConversations();
  }
  /**
   * Get all conversation file paths
   */
  getAllConversationFiles() {
    return Array.from(this.conversations.keys());
  }
  /**
   * Check if file has active conversation
   */
  hasConversation(file) {
    const conversation = this.conversations.get(file.path);
    return conversation ? conversation.messages.length > 0 : false;
  }
  /**
   * Update conversation file path (for file renames)
   */
  async updateFilePath(oldPath, newPath) {
    const conversation = this.conversations.get(oldPath);
    if (conversation) {
      conversation.filePath = newPath;
      this.conversations.delete(oldPath);
      this.conversations.set(newPath, conversation);
      await this.saveConversations();
    }
  }
  /**
   * Start periodic cleanup of old conversations
   */
  startPeriodicCleanup() {
    this.cleanupInterval = window.setInterval(() => {
      this.cleanupOldConversations(7 * 24 * 60 * 60 * 1e3);
    }, 24 * 60 * 60 * 1e3);
  }
  /**
   * Clean up conversations older than the specified age
   */
  async cleanupOldConversations(maxAge) {
    const now = Date.now();
    let cleaned = false;
    for (const [filePath, conversation] of this.conversations.entries()) {
      if (conversation.messages.length > 0) {
        const lastMessage = conversation.messages[conversation.messages.length - 1];
        const age = now - lastMessage.timestamp;
        if (age > maxAge) {
          this.conversations.delete(filePath);
          cleaned = true;
        }
      }
    }
    if (cleaned) {
      await this.saveConversations();
    }
  }
  /**
   * Add a context document to the conversation
   */
  async addContextDocument(file, contextPath, property) {
    var _a, _b;
    await this.initializePromise;
    const conversation = this.getConversation(file);
    const exists = (_a = conversation.contextDocuments) == null ? void 0 : _a.some(
      (doc) => doc.path === contextPath && doc.property === property
    );
    if (!exists) {
      const contextDoc = {
        path: contextPath,
        property,
        addedAt: Date.now()
      };
      (_b = conversation.contextDocuments) == null ? void 0 : _b.push(contextDoc);
      conversation.lastUpdated = Date.now();
      await this.saveConversations();
    }
  }
  /**
   * Remove a context document from the conversation
   */
  async removeContextDocument(file, contextPath, property) {
    const conversation = this.getConversation(file);
    if (conversation.contextDocuments) {
      conversation.contextDocuments = conversation.contextDocuments.filter(
        (doc) => !(doc.path === contextPath && doc.property === property)
      );
      conversation.lastUpdated = Date.now();
      await this.saveConversations();
    }
  }
  /**
   * Get all context documents for a conversation
   */
  async getContextDocuments(file) {
    await this.initializePromise;
    const conversation = this.getConversation(file);
    return conversation.contextDocuments || [];
  }
  /**
   * Clear all context documents for a conversation
   */
  async clearContextDocuments(file) {
    const conversation = this.getConversation(file);
    conversation.contextDocuments = [];
    conversation.lastUpdated = Date.now();
    await this.saveConversations();
  }
  /**
   * Update context documents (replace entire list)
   */
  async setContextDocuments(file, documents) {
    const conversation = this.getConversation(file);
    conversation.contextDocuments = documents;
    conversation.lastUpdated = Date.now();
    await this.saveConversations();
  }
  /**
   * Cleanup method to call when plugin is disabled
   */
  cleanup() {
    if (this.cleanupInterval !== null) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
  }
};

// src/core/document-engine.ts
var DocumentEngine = class {
  constructor(app, dataStore) {
    this.app = app;
    this.conversationManager = null;
    if (dataStore) {
      this.conversationManager = new ConversationManager(dataStore);
    }
  }
  /**
   * Set conversation manager (for dependency injection)
   */
  setConversationManager(conversationManager) {
    this.conversationManager = conversationManager;
  }
  /**
   * Get the active editor instance - ensures we get the editor for the active file
   */
  getActiveEditor() {
    const activeFile = this.getActiveFile();
    if (!activeFile) {
      return null;
    }
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    for (const leaf of leaves) {
      const view2 = leaf.view;
      if (view2 instanceof import_obsidian14.MarkdownView && view2.file === activeFile) {
        return view2.editor;
      }
    }
    const activeEditor = this.app.workspace.activeEditor;
    if ((activeEditor == null ? void 0 : activeEditor.editor) && activeEditor.file === activeFile) {
      return activeEditor.editor;
    }
    const view = this.app.workspace.getActiveViewOfType(import_obsidian14.MarkdownView);
    if (view && view.file === activeFile) {
      return view.editor;
    }
    return null;
  }
  /**
   * Get the active file
   */
  getActiveFile() {
    return this.app.workspace.getActiveFile();
  }
  /**
   * Get the currently selected text
   */
  getSelectedText() {
    const editor = this.getActiveEditor();
    if (!editor) return "";
    return editor.getSelection();
  }
  /**
   * Get the current cursor position
   */
  getCursorPosition() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getCursor();
  }
  /**
   * Set the cursor position (optionally focus the editor)
   */
  setCursorPosition(position, shouldFocus = false) {
    const editor = this.getActiveEditor();
    if (!editor) return;
    editor.setCursor(position);
    if (shouldFocus) {
      editor.focus();
    }
  }
  /**
   * Extract comprehensive document context
   */
  async getDocumentContext() {
    const file = this.getActiveFile();
    const editor = this.getActiveEditor();
    if (!file || !editor) {
      return null;
    }
    const content = editor.getValue();
    const selectedText = this.getSelectedText();
    const cursorPosition = this.getCursorPosition();
    const headings = this.extractHeadings(content);
    const surroundingLines = cursorPosition ? this.getSurroundingLines(content, cursorPosition.line) : void 0;
    return {
      file,
      filename: file.basename,
      content,
      headings,
      selectedText: selectedText || void 0,
      cursorPosition: cursorPosition || void 0,
      surroundingLines
    };
  }
  /**
   * Extract headings from document content
   */
  extractHeadings(content) {
    const lines = content.split("\n");
    const headings = [];
    let charCount = 0;
    lines.forEach((line, index) => {
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        const text = headingMatch[2];
        headings.push({
          text,
          level,
          line: index,
          position: {
            start: charCount,
            end: charCount + line.length
          }
        });
      }
      charCount += line.length + 1;
    });
    return headings;
  }
  /**
   * Get lines surrounding the cursor position
   */
  getSurroundingLines(content, currentLine, contextSize = 5) {
    const lines = content.split("\n");
    const startLine = Math.max(0, currentLine - contextSize);
    const endLine = Math.min(lines.length - 1, currentLine + contextSize);
    return {
      before: lines.slice(startLine, currentLine),
      after: lines.slice(currentLine + 1, endLine + 1)
    };
  }
  /**
   * Apply an edit to the document
   */
  async applyEdit(content, position, options = {}) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "insert"
      };
    }
    try {
      let appliedAt;
      if (position === "cursor") {
        appliedAt = editor.getCursor();
        editor.replaceRange(content, appliedAt);
      } else if (position === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "replace"
          };
        }
        appliedAt = editor.getCursor("from");
        editor.replaceSelection(content);
      } else if (position === "end") {
        const lastLine = editor.lastLine();
        const lastLineLength = editor.getLine(lastLine).length;
        appliedAt = { line: lastLine, ch: lastLineLength };
        const currentContent = editor.getValue();
        const newContent = currentContent + (currentContent.endsWith("\n") ? "" : "\n") + content;
        await this.app.vault.modify(file, newContent);
      } else {
        appliedAt = position;
        editor.replaceRange(content, appliedAt);
      }
      if (options.selectNewText) {
        const endPos = {
          line: appliedAt.line + content.split("\n").length - 1,
          ch: content.includes("\n") ? content.split("\n").pop().length : appliedAt.ch + content.length
        };
        editor.setSelection(appliedAt, endPos);
      }
      if (options.scrollToEdit) {
        editor.scrollIntoView({
          from: appliedAt,
          to: appliedAt
        }, true);
      }
      return {
        success: true,
        content,
        editType: position === "selection" ? "replace" : position === "end" ? "append" : "insert",
        appliedAt
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Delete content at cursor location
   */
  async deleteContent(target) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "delete"
      };
    }
    try {
      if (target === "selection") {
        const selection = editor.getSelection();
        if (!selection) {
          return {
            success: false,
            error: "No text selected",
            editType: "delete"
          };
        }
        editor.replaceSelection("");
        return {
          success: true,
          editType: "delete"
        };
      } else if (target === "line") {
        const cursor = editor.getCursor();
        const line = cursor.line;
        editor.replaceRange(
          "",
          { line, ch: 0 },
          { line: line + 1, ch: 0 }
        );
        return {
          success: true,
          editType: "delete",
          appliedAt: { line, ch: 0 }
        };
      }
      return {
        success: false,
        error: "Invalid delete target",
        editType: "delete"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Get the full document content
   */
  async getDocumentContent() {
    const editor = this.getActiveEditor();
    if (!editor) return null;
    return editor.getValue();
  }
  /**
   * Replace the entire document content
   */
  async setDocumentContent(content) {
    const file = this.getActiveFile();
    if (!file) {
      return {
        success: false,
        error: "No active file",
        editType: "replace"
      };
    }
    try {
      await this.app.vault.modify(file, content);
      return {
        success: true,
        content,
        editType: "replace"
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  // Conversation management methods
  /**
   * Add user message to conversation
   */
  async addUserMessage(content, command) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addUserMessage(file, content, command);
    }
  }
  /**
   * Add assistant response to conversation
   */
  async addAssistantMessage(content, result) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addAssistantMessage(file, content, result);
    }
  }
  /**
   * Add system message to conversation
   */
  async addSystemMessage(content) {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.addSystemMessage(file, content);
    }
  }
  /**
   * Get conversation context for AI prompts
   */
  getConversationContext(maxMessages = 6) {
    if (!this.conversationManager) return "";
    const file = this.getActiveFile();
    if (!file) return "";
    return this.conversationManager.getConversationContext(file, maxMessages);
  }
  /**
   * Clear conversation for current file
   */
  async clearConversation() {
    if (!this.conversationManager) return;
    const file = this.getActiveFile();
    if (file) {
      await this.conversationManager.clearConversation(file);
    }
  }
  /**
   * Get conversation statistics for current file
   */
  getConversationStats() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.getStats(file);
  }
  /**
   * Check if current file has an active conversation
   */
  hasConversation() {
    if (!this.conversationManager) return false;
    const file = this.getActiveFile();
    if (!file) return false;
    return this.conversationManager.hasConversation(file);
  }
  /**
   * Export conversation for current file
   */
  exportConversation() {
    if (!this.conversationManager) return null;
    const file = this.getActiveFile();
    if (!file) return null;
    return this.conversationManager.exportConversation(file);
  }
  /**
   * Replace selected text with new content
   * Handles undo/redo properly and preserves cursor position
   */
  async replaceSelection(newText, from, to) {
    const editor = this.getActiveEditor();
    const file = this.getActiveFile();
    if (!editor || !file) {
      return {
        success: false,
        error: "No active editor or file",
        editType: "replace"
      };
    }
    try {
      const fromPos = from || editor.getCursor("from");
      const toPos = to || editor.getCursor("to");
      editor.replaceRange(newText, fromPos, toPos);
      const newCursorPos = {
        line: fromPos.line + (newText.split("\n").length - 1),
        ch: newText.includes("\n") ? newText.split("\n").pop().length : fromPos.ch + newText.length
      };
      editor.setCursor(newCursorPos);
      editor.focus();
      return {
        success: true,
        content: newText,
        appliedAt: fromPos,
        editType: "replace"
      };
    } catch (error) {
      console.error("Error replacing selection:", error);
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
};

// src/core/context-builder.ts
var ContextBuilder = class {
  constructor(settings) {
    var _a, _b, _c, _d;
    this.defaultConfig = {
      maxContextLines: 20,
      includeStructure: true,
      includeHistory: false,
      temperature: (_b = (_a = settings == null ? void 0 : settings.general) == null ? void 0 : _a.defaultTemperature) != null ? _b : 0.7,
      maxTokens: (_d = (_c = settings == null ? void 0 : settings.general) == null ? void 0 : _c.defaultMaxTokens) != null ? _d : 1e3
    };
  }
  /**
   * Build prompt for a specific command
   */
  buildPrompt(command, documentContext, options = {}, conversationContext) {
    const config = { ...this.defaultConfig, ...options };
    const systemPrompt = this.buildSystemPrompt(command.action, config);
    const contextInfo = this.buildContextInfo(documentContext, command, config, conversationContext);
    const userPrompt = this.buildUserPrompt(command, contextInfo);
    return {
      systemPrompt,
      userPrompt,
      context: contextInfo,
      config: {
        temperature: config.temperature || 0.7,
        maxTokens: config.maxTokens || 1e3
      }
    };
  }
  /**
   * Build system prompt based on action type
   */
  buildSystemPrompt(action, config) {
    const basePrompt = `You are Nova, an AI writing partner that helps users edit documents at their cursor position. You work with Markdown documents in Obsidian.

IMPORTANT GUIDELINES:
- Provide ONLY the content to be inserted/modified, no explanations or meta-text
- Maintain the document's existing style and tone unless specifically asked to change it
- Preserve formatting, structure, and markdown syntax
- Work at the user's cursor position - every edit happens where they are focused
- Do not add headers unless specifically requested
- Focus on the user's immediate editing context`;
    const actionSpecificPrompts = {
      "add": `

ACTION: ADD CONTENT
- Generate EXACTLY what the user requested - follow their instruction literally
- Do NOT create content related to the document theme unless specifically asked
- Focus on the user's specific request, not the document's existing content
- Match basic formatting style but prioritize the user's exact request`,
      "edit": `

ACTION: EDIT CONTENT  
- Improve, modify, or enhance the specified content
- Preserve the original intent while following user instructions
- Apply style, tone, or structural changes as requested`,
      "delete": `

ACTION: DELETE CONTENT
- Confirm what should be deleted by providing the exact text to remove
- Be precise about deletion boundaries
- Respond "CONFIRMED" if the deletion is clear`,
      "grammar": `

ACTION: GRAMMAR & SPELLING
- Fix grammar, spelling, and punctuation errors
- Improve clarity while preserving meaning
- Maintain the original tone and style`,
      "rewrite": `

ACTION: REWRITE CONTENT
- Generate alternative content that serves the same purpose
- Apply requested style, tone, or structural changes
- Create fresh content while maintaining core meaning`,
      "metadata": `

ACTION: UPDATE METADATA
- Modify frontmatter properties, tags, or document metadata
- Return ONLY a JSON object with the properties to update
- For tags, return as an array: {"tags": ["tag1", "tag2"]}
- For other properties: {"title": "New Title", "author": "Name"}
- Do NOT include properties that shouldn't be changed
- Do NOT return any explanatory text, ONLY the JSON object`
    };
    return basePrompt + (actionSpecificPrompts[action] || "");
  }
  /**
   * Build context information for the prompt
   */
  buildContextInfo(documentContext, command, config, conversationContext) {
    let context = `DOCUMENT: ${documentContext.filename}
`;
    if (config.includeStructure && documentContext.headings.length > 0) {
      context += `DOCUMENT STRUCTURE:
`;
      const structure = this.buildDocumentStructure(documentContext.headings);
      context += structure + "\n";
    }
    context += this.buildTargetContext(command, documentContext);
    if (conversationContext && config.includeHistory) {
      context += `
CONVERSATION CONTEXT:
${conversationContext}
`;
    }
    if (command.action === "add" && command.target === "cursor") {
      if (documentContext.surroundingLines) {
        const before = documentContext.surroundingLines.before.slice(-3).join("\n");
        const after = documentContext.surroundingLines.after.slice(0, 3).join("\n");
        context += `
LOCAL CONTEXT (for style reference only):
Before cursor:
${before}

After cursor:
${after}
`;
      }
    } else {
      context += `
FULL DOCUMENT:
${documentContext.content}
`;
    }
    return context;
  }
  /**
   * Build target-specific context
   */
  buildTargetContext(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return `
SELECTED TEXT:
${documentContext.selectedText}
`;
        }
        return `
No text currently selected.
`;
      case "cursor":
        if (documentContext.surroundingLines) {
          const context = `
CURSOR CONTEXT:
`;
          const before = documentContext.surroundingLines.before.join("\n");
          const after = documentContext.surroundingLines.after.join("\n");
          return context + `Before cursor:
${before}

After cursor:
${after}
`;
        }
        return `
Cursor position context not available.
`;
      case "document":
        return `
Targeting entire document.
`;
      case "end":
        return `
Targeting end of document.
`;
      default:
        return `
Working at cursor position.
`;
    }
  }
  /**
   * Build user prompt with instructions
   */
  buildUserPrompt(command, contextInfo) {
    let prompt2 = contextInfo;
    prompt2 += `
USER REQUEST: ${command.instruction}
`;
    if (command.context) {
      prompt2 += `ADDITIONAL REQUIREMENTS: ${command.context}
`;
    }
    prompt2 += this.getFocusInstructions(command);
    prompt2 += this.getOutputInstructions(command);
    return prompt2;
  }
  /**
   * Get focus instructions based on target
   */
  getFocusInstructions(command) {
    const actionGuidance = {
      "add": "Add new content",
      "edit": "Modify existing content",
      "delete": "Remove specified content",
      "rewrite": "Generate alternative content",
      "grammar": "Fix grammar and spelling",
      "metadata": "Update document metadata"
    };
    switch (command.target) {
      case "selection":
        return `
FOCUS: ${actionGuidance[command.action]} in the selected text.
`;
      case "cursor":
        return `
FOCUS: ${actionGuidance[command.action]} at the current cursor position.
`;
      case "document":
        return `
FOCUS: ${actionGuidance[command.action]} for the entire document.
`;
      case "end":
        return `
FOCUS: Add content at the very end of the document, after all existing content. Ensure it flows naturally.
`;
      default:
        return `
FOCUS: ${actionGuidance[command.action]} at the cursor position.
`;
    }
  }
  /**
   * Get output instructions based on action
   */
  getOutputInstructions(command) {
    switch (command.action) {
      case "add":
        return "OUTPUT: Provide only the new content to be added.";
      case "edit":
        return "OUTPUT: Provide only the improved version of the content.";
      case "delete":
        return 'OUTPUT: Confirm what should be deleted by providing the exact text to remove, or respond "CONFIRMED" if the deletion is clear.';
      case "grammar":
        return "OUTPUT: Provide the corrected version with proper grammar and spelling.";
      case "rewrite":
        return "OUTPUT: Provide the completely rewritten content that serves the same purpose.";
      case "metadata":
        return "OUTPUT: Provide the updated metadata in proper YAML format.";
      default:
        return "OUTPUT: Provide only the requested content changes.";
    }
  }
  /**
   * Build document structure from headings
   */
  buildDocumentStructure(headings) {
    return headings.map((heading) => {
      const indent = "  ".repeat(heading.level - 1);
      return `${indent}- ${heading.text}`;
    }).join("\n");
  }
  /**
   * Validate generated prompt
   */
  validatePrompt(prompt2) {
    const issues = [];
    if (!prompt2.systemPrompt || prompt2.systemPrompt.trim().length === 0) {
      issues.push("System prompt is empty");
    }
    if (!prompt2.userPrompt || prompt2.userPrompt.trim().length === 0) {
      issues.push("User prompt is empty");
    }
    if (prompt2.userPrompt.length > 1e4) {
      issues.push("User prompt is too long (>10000 characters)");
    }
    return {
      valid: issues.length === 0,
      issues
    };
  }
};

// src/core/command-parser.ts
var COMMAND_PATTERNS = [
  {
    action: "grammar",
    patterns: [
      /\b(grammar|spell|spelling|proofread|polish)\b/i,
      /\bcheck\b.*\b(grammar|spelling|errors)\b/i,
      /\bmake\s+.*\b(grammatical|correct|proper)\b/i,
      /\bfix\s+.*\b(grammar|errors|mistakes|typos)\b/i,
      /\bcorrect\b.*\b(grammar|spelling|errors)\b/i
    ],
    targets: ["selection", "document"]
  },
  {
    action: "metadata",
    patterns: [
      // Tag-specific patterns with colon format (highest priority)
      /^(add|set|update|remove)\s+tags?:/i,
      // Tag optimization patterns
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i,
      /^add tags$/i,
      // Simple "add tags" for AI suggestions
      // General metadata patterns
      /\b(update|set|change|modify)\s+.*\b(property|properties|metadata|frontmatter|tag|tags)\b/i,
      /\b(set|update|change|add)\s+.*\b(title|author|date|status)\b/i,
      /\bupdate\s+.*\bfrontmatter\b/i,
      // Tag-specific patterns that exclude content/text/section
      /\b(add|remove|update)\s+(?!.*\b(content|text|section|paragraph|about)\b).*\btag[s]?\b/i,
      /\bset\s+.*\bproperty\b/i
    ],
    targets: ["document"]
  },
  {
    action: "rewrite",
    patterns: [
      /\b(rewrite|reword|rephrase|restructure|reorganize)\b/i,
      /\bwrite\s+.*\b(new|different|alternative)\b/i,
      /\bgenerate\s+.*\b(sections|parts|multiple)\b/i,
      /\bmake\s+.*\b(sections|parts|multiple)\b/i
    ],
    targets: ["document", "end"]
  },
  {
    action: "delete",
    patterns: [
      /\b(delete|remove|eliminate|cut|erase)\b/i,
      /\bget\s+rid\s+of\b/i,
      /\btake\s+out\b/i,
      /\bdrop\b.*\b(section|paragraph|part)\b/i
    ],
    targets: ["selection"]
  },
  {
    action: "add",
    patterns: [
      /\b(add|create|write|insert|include|append|prepend)\b.*\b(section|paragraph|heading|content|text|part)\b/i,
      /\b(add|create|write|insert|append|prepend)\b(?!\s+.*\b(better|clearer|more|less|tags?|property|properties|metadata|frontmatter)\b)/i,
      /\bmake\s+.*\b(section|part)\b/i,
      /\bgenerate\b.*\b(section|content|text)\b/i,
      // Specific patterns for append/prepend with location
      /\b(append|add)\b.*\b(after|following)\b/i,
      /\b(prepend|add)\b.*\b(before|preceding)\b/i
    ],
    targets: ["end"]
  },
  {
    action: "edit",
    patterns: [
      /\b(edit|modify|change|update|revise|improve|enhance)\b/i,
      /\bmake\s+.*\b(better|clearer|more|less|formal|professional|detailed|comprehensive)\b/i,
      /\b(fix|correct|adjust)\b(?!.*\b(grammar|spelling|errors)\b)/i,
      /\b(expand|shorten|condense)\b/i
    ],
    targets: ["selection"]
  }
];
var TARGET_PATTERNS = [
  { pattern: /\b(?:selected|highlighted|chosen)\s+(?:text|content)/i, target: "selection" },
  { pattern: /\b(?:entire|whole|full)\s+(?:document|file|note)/i, target: "document" },
  { pattern: /\b(?:end|bottom|conclusion)/i, target: "end" }
];
var CommandParser = class {
  /**
   * Parse natural language input into an EditCommand
   */
  parseCommand(input, hasSelection = false) {
    const normalizedInput = input.trim().toLowerCase();
    const action = this.detectAction(normalizedInput);
    const target = this.detectTarget(normalizedInput, hasSelection, action);
    const context = this.extractContext(input);
    return {
      action,
      target,
      instruction: input,
      // Keep original input for display
      context
    };
  }
  /**
   * Detect the action type from the input
   */
  detectAction(input) {
    for (const commandPattern of COMMAND_PATTERNS) {
      for (const pattern of commandPattern.patterns) {
        if (pattern.test(input)) {
          return commandPattern.action;
        }
      }
    }
    if (/\b(add|create|write|insert|include|generate.*section)\b/i.test(input)) {
      return "add";
    }
    if (/\b(fix|correct|grammar|spell|proofread|polish)\b/i.test(input)) {
      return "grammar";
    }
    if (/\b(delete|remove|eliminate)\b/i.test(input)) {
      return "delete";
    }
    if (/\b(rewrite|rephrase|restructure|generate.*new)\b/i.test(input)) {
      return "rewrite";
    }
    if (/\b(update|set|change|modify|add).*\b(property|properties|metadata|frontmatter|tag|tags|title|author|date|status)\b/i.test(input)) {
      return "metadata";
    }
    return "edit";
  }
  /**
   * Detect the target type from the input (simplified for cursor-only editing)
   */
  detectTarget(input, hasSelection, action) {
    for (const targetPattern of TARGET_PATTERNS) {
      if (targetPattern.pattern.test(input)) {
        return targetPattern.target;
      }
    }
    if (hasSelection && (action === "edit" || action === "grammar" || action === "delete")) {
      return "selection";
    }
    switch (action) {
      case "add":
        return "cursor";
      // Changed from 'end' to 'cursor' for cursor-only editing
      case "edit":
        return hasSelection ? "selection" : "cursor";
      case "delete":
        return hasSelection ? "selection" : "cursor";
      case "grammar":
        return hasSelection ? "selection" : "document";
      case "rewrite":
        return hasSelection ? "selection" : "cursor";
      // Changed from 'end' to support cursor-only
      case "metadata":
        return "document";
      default:
        return "cursor";
    }
  }
  /**
   * Extract additional context from the input
   */
  extractContext(input) {
    const styleIndicators = [
      "formal",
      "informal",
      "casual",
      "professional",
      "academic",
      "technical",
      "simple",
      "complex",
      "detailed",
      "brief",
      "concise",
      "verbose",
      "friendly",
      "serious",
      "humorous",
      "creative",
      "analytical"
    ];
    const foundStyles = styleIndicators.filter(
      (style) => input.toLowerCase().includes(style)
    );
    let context = "";
    if (foundStyles.length > 0) {
      context += `Style: ${foundStyles.join(", ")}. `;
    }
    if (input.includes("short") || input.includes("brief") || input.includes("concise")) {
      context += "Keep it brief. ";
    }
    if (input.includes("long") || input.includes("detailed") || input.includes("comprehensive")) {
      context += "Provide detailed content. ";
    }
    if (input.includes("bullet") || input.includes("list")) {
      context += "Use bullet points or lists. ";
    }
    if (input.includes("example") || input.includes("examples")) {
      context += "Include examples. ";
    }
    if (input.includes("number") || input.includes("numbered")) {
      context += "Use numbered lists. ";
    }
    return context.trim();
  }
  /**
   * Validate if a command can be executed
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "This command requires text to be selected first"
      };
    }
    if (command.action === "add" && command.target === "selection") {
      return {
        valid: false,
        error: 'Cannot add content to a selection. Use "edit" to modify selected text'
      };
    }
    return { valid: true };
  }
  /**
   * Get suggested commands based on context
   */
  getSuggestions(hasSelection) {
    const suggestions = [];
    if (hasSelection) {
      suggestions.push(
        "Make this more concise",
        "Fix grammar in this text",
        "Make this more professional",
        "Expand on this point"
      );
    } else {
      suggestions.push(
        "Add content at cursor",
        "Fix grammar in this document",
        "Add conclusion at end",
        "Create a summary"
      );
    }
    return suggestions;
  }
  /**
   * Parse multiple commands from a single input
   */
  parseMultipleCommands(input) {
    const separators = /\b(?:then|also|and then|after that|next|additionally)\b/i;
    const parts = input.split(separators);
    if (parts.length === 1) {
      return [this.parseCommand(input)];
    }
    return parts.map((part) => part.trim()).filter((part) => part.length > 0).map((part) => this.parseCommand(part));
  }
  /**
   * Get command description for display
   */
  getCommandDescription(command) {
    const { action, target } = command;
    let description = "";
    switch (action) {
      case "add":
        description = "Add new content";
        break;
      case "edit":
        description = "Edit existing content";
        break;
      case "delete":
        description = "Remove content";
        break;
      case "grammar":
        description = "Fix grammar and spelling";
        break;
      case "rewrite":
        description = "Generate new content";
        break;
      case "metadata":
        description = "Update document metadata";
        break;
    }
    switch (target) {
      case "selection":
        description += " in selected text";
        break;
      case "cursor":
        description += " at cursor position";
        break;
      case "document":
        description += " in entire document";
        break;
      case "end":
        description += " at end of document";
        break;
    }
    return description;
  }
};

// src/core/prompt-builder.ts
var PromptBuilder = class {
  constructor(documentEngine, conversationManager) {
    this.contextBuilder = new ContextBuilder();
    this.documentEngine = documentEngine;
    this.conversationManager = conversationManager;
    this.commandParser = new CommandParser();
  }
  /**
   * Build prompt for a user message - determines if it's a command or conversation
   */
  async buildPromptForMessage(message, file, options = {}) {
    const isLikelyCommand = this.isLikelyCommand(message);
    if (isLikelyCommand && file) {
      const parsedCommand = this.commandParser.parseCommand(message);
      return this.buildCommandPrompt(parsedCommand, file, options);
    } else {
      return this.buildConversationPrompt(message, file, options);
    }
  }
  /**
   * Check if a message is likely a command vs conversation
   */
  isLikelyCommand(message) {
    const lowerMessage = message.toLowerCase().trim();
    if (lowerMessage.startsWith(":")) {
      return true;
    }
    const actionVerbs = [
      "add",
      "insert",
      "append",
      "prepend",
      "include",
      "create",
      "write",
      "generate",
      "edit",
      "modify",
      "change",
      "update",
      "revise",
      "improve",
      "enhance",
      "replace",
      "delete",
      "remove",
      "eliminate",
      "cut",
      "erase",
      "drop",
      "fix",
      "correct",
      "proofread",
      "polish",
      "check",
      "rewrite",
      "reword",
      "rephrase",
      "restructure",
      "reorganize"
    ];
    const startsWithAction = actionVerbs.some((verb) => {
      const verbPattern = new RegExp(`^${verb}\\b`, "i");
      return verbPattern.test(lowerMessage);
    });
    if (startsWithAction) {
      const questionIndicators = [
        /^(how|what|why|when|where|which|who|can|could|should|would|will|is|are|am|do|does|did)/i,
        /\?/,
        // Contains question mark
        /\b(help|advice|suggest|recommend|think|opinion)\b/i
      ];
      const isQuestion = questionIndicators.some((pattern) => pattern.test(lowerMessage));
      if (isQuestion) {
        return false;
      }
      return true;
    }
    const explicitCommandPatterns = [
      // Grammar/spelling commands that don't start with action verbs
      /\b(grammar|spell|spelling|proofread|polish)\b.*\b(check|fix|correct)\b/i,
      // Metadata commands with different structures
      /\bset\s+(the\s+)?(title|tags|metadata|properties)/i,
      /\bupdate\s+(the\s+)?(title|tags|metadata|properties)/i,
      // Tag-specific patterns
      /^(add|set|update|remove)\s+tags?:/i,
      /\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i,
      /\b(suggest|recommend)\s+.*\btags?\b/i,
      /^add suggested tags$/i
    ];
    for (const pattern of explicitCommandPatterns) {
      if (pattern.test(lowerMessage)) {
        return true;
      }
    }
    return false;
  }
  /**
   * Build prompt for a specific command
   */
  async buildCommandPrompt(command, file, options = {}) {
    if (!file) {
      throw new Error("File is required for command prompts");
    }
    const documentContext = await this.getDocumentContext(file);
    let conversationContext;
    if (options.includeHistory) {
      const recentMessages = await this.conversationManager.getRecentMessages(file, 5);
      conversationContext = this.formatConversationHistory(recentMessages);
    }
    return this.contextBuilder.buildPrompt(command, documentContext, options, conversationContext);
  }
  /**
   * Build prompt for conversation (non-command messages)
   */
  async buildConversationPrompt(message, file, options = {}) {
    let documentContext;
    let recentHistory = [];
    if (file) {
      documentContext = await this.getDocumentContext(file);
      recentHistory = await this.conversationManager.getRecentMessages(file, 5);
    }
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Key capabilities:
- Answer questions about documents and content
- Provide writing assistance and suggestions
- Help with research and analysis
- Engage in natural conversation about the user's work

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional
- Reference document context when relevant`;
    let userPrompt = `USER REQUEST: ${message}`;
    if (documentContext && file) {
      userPrompt = `Current document: ${documentContext.filename}

${userPrompt}`;
    }
    if (recentHistory.length > 0) {
      const historyString = this.formatConversationHistory(recentHistory);
      userPrompt = `RECENT CONVERSATION:
${historyString}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: (documentContext == null ? void 0 : documentContext.content) || "",
      config: {
        temperature: options.temperature || 0.7,
        maxTokens: options.maxTokens || 2e3
      }
    };
  }
  /**
   * Build simple prompt for basic operations
   */
  buildSimplePrompt(instruction, context) {
    const systemPrompt = `You are Nova, an AI writing partner that helps users with their documents and writing tasks.

Guidelines:
- Provide helpful, accurate responses
- Stay focused on the user's needs
- Be conversational but professional`;
    let userPrompt = `USER REQUEST: ${instruction}`;
    if (context) {
      userPrompt = `Context: ${context}

${userPrompt}`;
    }
    return {
      systemPrompt,
      userPrompt,
      context: context || "",
      config: {
        temperature: 0.7,
        maxTokens: 2e3
      }
    };
  }
  /**
   * Get document context for a file
   */
  async getDocumentContext(file) {
    const context = await this.documentEngine.getDocumentContext();
    if (!context) {
      const content = await this.documentEngine.getDocumentContent() || "";
      return {
        file,
        filename: file.basename,
        content,
        headings: [],
        selectedText: void 0,
        surroundingLines: void 0
      };
    }
    return context;
  }
  /**
   * Format conversation history for context
   */
  formatConversationHistory(messages) {
    if (messages.length === 0) return "";
    let formatted = "RECENT CONVERSATION:\n";
    messages.forEach((msg) => {
      const role = msg.role === "user" ? "You" : "Nova";
      formatted += `${role}: ${msg.content}
`;
    });
    return formatted;
  }
  /**
   * Validate and optimize prompt before sending to AI
   */
  validateAndOptimizePrompt(prompt2) {
    const validation = this.contextBuilder.validatePrompt(prompt2);
    if (!validation.valid) {
      let optimizedPrompt = { ...prompt2 };
      const tokenCount = this.estimateTokenCount(prompt2);
      if (tokenCount > 8e3) {
        const maxContextLength = Math.floor(prompt2.context.length * 0.6);
        optimizedPrompt.context = prompt2.context.substring(0, maxContextLength) + "\n[Context truncated...]";
      }
      if (prompt2.config.temperature < 0 || prompt2.config.temperature > 1) {
        optimizedPrompt.config.temperature = Math.max(0, Math.min(1, prompt2.config.temperature));
      }
      if (prompt2.config.maxTokens < 10 || prompt2.config.maxTokens > 4e3) {
        optimizedPrompt.config.maxTokens = Math.max(10, Math.min(4e3, prompt2.config.maxTokens));
      }
      return optimizedPrompt;
    }
    return prompt2;
  }
  /**
   * Get token count estimate for a prompt
   */
  getTokenCount(prompt2) {
    return this.estimateTokenCount(prompt2);
  }
  /**
   * Create prompt for a specific action with minimal context
   */
  async buildQuickPrompt(action, instruction, file) {
    const command = {
      action,
      target: "document",
      instruction,
      context: void 0
    };
    if (file) {
      return this.buildCommandPrompt(command, file, {
        maxContextLines: 10,
        includeStructure: false,
        includeHistory: false
      });
    } else {
      return this.buildSimplePrompt(instruction);
    }
  }
  /**
   * Simple token count estimation
   */
  estimateTokenCount(prompt2) {
    const totalText = prompt2.systemPrompt + prompt2.userPrompt + prompt2.context;
    return Math.ceil(totalText.length / 4);
  }
  /**
   * Build prompt with custom system prompt override
   */
  async buildCustomPrompt(systemPrompt, userMessage, file) {
    let context = "";
    if (file) {
      const documentContext = await this.getDocumentContext(file);
      context = `Document: ${documentContext.filename}
${documentContext.content}`;
    }
    return {
      systemPrompt,
      userPrompt: userMessage,
      context,
      config: {
        temperature: 0.7,
        maxTokens: 1e3
      }
    };
  }
};

// src/core/commands/add-command.ts
var AddCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute add command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "insert"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "insert"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "insert"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "insert"
            };
          }
          result = await this.applyAddition(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "insert"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "insert"
      };
    }
  }
  /**
   * Apply addition based on command target
   */
  async applyAddition(command, documentContext, content) {
    switch (command.target) {
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return await this.documentEngine.applyEdit(
            content,
            "cursor",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        }
      default:
        return {
          success: false,
          error: `Invalid add target: ${command.target}`,
          editType: "insert"
        };
    }
  }
  /**
   * Validate add command
   */
  validateCommand(command) {
    if (command.action !== "add") {
      return {
        valid: false,
        error: "Command action must be add"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Add instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute add command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "insert"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "insert",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "insert"
      };
    }
  }
};

// src/core/commands/edit-command.ts
var EditCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute edit command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyEdit(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply edit based on command target
   */
  async applyEdit(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for editing",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid edit target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate edit command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to edit"
      };
    }
    if (command.action !== "edit") {
      return {
        valid: false,
        error: "Command action must be edit"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Edit instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute edit command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/delete-command.ts
var DeleteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute delete command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "delete"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "delete"
        };
      }
      const result = await this.applyDeletion(command, documentContext);
      return result;
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "delete"
      };
    }
  }
  /**
   * Apply deletion based on command target
   */
  async applyDeletion(command, documentContext) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            "",
            "selection",
            {
              scrollToEdit: true,
              selectNewText: false
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for deletion",
            editType: "delete"
          };
        }
      case "cursor":
        return await this.documentEngine.deleteContent("line");
      case "document":
        return await this.documentEngine.setDocumentContent("");
      case "end":
        return {
          success: false,
          error: "Cannot delete from end - use cursor or selection instead",
          editType: "delete"
        };
      default:
        return {
          success: false,
          error: `Invalid delete target: ${command.target}`,
          editType: "delete"
        };
    }
  }
  /**
   * Validate delete command
   */
  validateCommand(command, hasSelection) {
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to delete"
      };
    }
    if (command.action !== "delete") {
      return {
        valid: false,
        error: "Command action must be delete"
      };
    }
    return { valid: true };
  }
};

// src/core/commands/grammar-command.ts
var GrammarCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute grammar command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command, !!documentContext.selectedText);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyGrammarFix(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply grammar fix based on command target
   */
  async applyGrammarFix(command, documentContext, content) {
    switch (command.target) {
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for grammar correction",
            editType: "replace"
          };
        }
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "cursor":
        return {
          success: false,
          error: 'Please select text to correct grammar, or use "document" to fix entire document',
          editType: "replace"
        };
      case "end":
        return {
          success: false,
          error: 'Grammar correction requires selecting text or specifying "document"',
          editType: "replace"
        };
      default:
        return {
          success: false,
          error: `Invalid grammar target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate grammar command
   */
  validateCommand(command, hasSelection) {
    if (command.action !== "grammar") {
      return {
        valid: false,
        error: "Command action must be grammar"
      };
    }
    if (command.target === "selection" && !hasSelection) {
      return {
        valid: false,
        error: "Please select text to correct grammar"
      };
    }
    if (command.target !== "selection" && command.target !== "document") {
      return {
        valid: false,
        error: "Grammar correction requires selecting text or targeting entire document"
      };
    }
    return { valid: true };
  }
  /**
   * Execute grammar command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/rewrite-command.ts
var RewriteCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute rewrite command
   */
  async execute(command, streamingCallback) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const validation = this.validateCommand(command);
      if (!validation.valid) {
        return {
          success: false,
          error: validation.error,
          editType: "replace"
        };
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const promptValidation = this.contextBuilder.validatePrompt(prompt2);
      if (!promptValidation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${promptValidation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      try {
        let content;
        let result;
        if (streamingCallback) {
          result = await this.executeWithStreaming(command, documentContext, prompt2, streamingCallback);
        } else {
          content = await this.providerManager.generateText(
            prompt2.userPrompt,
            {
              systemPrompt: prompt2.systemPrompt,
              temperature: prompt2.config.temperature,
              maxTokens: prompt2.config.maxTokens
            }
          );
          if (!content || content.trim().length === 0) {
            return {
              success: false,
              error: "AI provider returned empty content",
              editType: "replace"
            };
          }
          result = await this.applyRewrite(command, documentContext, content);
        }
        return result;
      } catch (error) {
        return {
          success: false,
          error: error instanceof Error ? error.message : "AI generation failed",
          editType: "replace"
        };
      }
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error",
        editType: "replace"
      };
    }
  }
  /**
   * Apply rewrite based on command target
   */
  async applyRewrite(command, documentContext, content) {
    switch (command.target) {
      case "document":
        return await this.documentEngine.setDocumentContent(content);
      case "end":
        return await this.documentEngine.applyEdit(
          content,
          "end",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      case "selection":
        if (documentContext.selectedText) {
          return await this.documentEngine.applyEdit(
            content,
            "selection",
            {
              scrollToEdit: true,
              selectNewText: true
            }
          );
        } else {
          return {
            success: false,
            error: "No text selected for rewriting",
            editType: "replace"
          };
        }
      case "cursor":
        return await this.documentEngine.applyEdit(
          content,
          "cursor",
          {
            scrollToEdit: true,
            selectNewText: true
          }
        );
      default:
        return {
          success: false,
          error: `Invalid rewrite target: ${command.target}`,
          editType: "replace"
        };
    }
  }
  /**
   * Validate rewrite command
   */
  validateCommand(command) {
    if (command.action !== "rewrite") {
      return {
        valid: false,
        error: "Command action must be rewrite"
      };
    }
    if (!command.instruction || command.instruction.trim().length === 0) {
      return {
        valid: false,
        error: "Rewrite instruction is required"
      };
    }
    return { valid: true };
  }
  /**
   * Execute rewrite command with streaming support
   */
  async executeWithStreaming(command, documentContext, prompt2, streamingCallback) {
    try {
      let fullContent = "";
      const stream = this.providerManager.generateTextStream(
        prompt2.userPrompt,
        {
          systemPrompt: prompt2.systemPrompt,
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      for await (const chunk of stream) {
        if (chunk.content) {
          fullContent += chunk.content;
          streamingCallback(fullContent, false);
        }
      }
      streamingCallback(fullContent, true);
      if (!fullContent || fullContent.trim().length === 0) {
        return {
          success: false,
          error: "AI provider returned empty content",
          editType: "replace"
        };
      }
      return {
        success: true,
        content: fullContent,
        editType: "replace",
        appliedAt: documentContext.cursorPosition || { line: 0, ch: 0 }
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : "Streaming failed",
        editType: "replace"
      };
    }
  }
};

// src/core/commands/metadata-command.ts
var MetadataCommand = class {
  constructor(app, documentEngine, contextBuilder, providerManager) {
    this.app = app;
    this.documentEngine = documentEngine;
    this.contextBuilder = contextBuilder;
    this.providerManager = providerManager;
  }
  /**
   * Execute a metadata update command
   */
  async execute(command) {
    try {
      const documentContext = await this.documentEngine.getDocumentContext();
      if (!documentContext) {
        return {
          success: false,
          error: "No active document found",
          editType: "replace"
        };
      }
      const tagResult = await this.handleDirectTagOperation(command.instruction, documentContext);
      if (tagResult) {
        return tagResult;
      }
      const conversationContext = this.documentEngine.getConversationContext();
      const promptConfig = conversationContext ? { includeHistory: true } : {};
      const prompt2 = this.contextBuilder.buildPrompt(command, documentContext, promptConfig, conversationContext);
      const validation = this.contextBuilder.validatePrompt(prompt2);
      if (!validation.valid) {
        return {
          success: false,
          error: `Prompt validation failed: ${validation.issues.join(", ")}`,
          editType: "replace"
        };
      }
      const aiResponse = await this.providerManager.complete(
        prompt2.systemPrompt,
        prompt2.userPrompt,
        {
          temperature: prompt2.config.temperature,
          maxTokens: prompt2.config.maxTokens
        }
      );
      const updates = this.parsePropertyUpdates(aiResponse);
      if (!updates || Object.keys(updates).length === 0) {
        console.error("Failed to parse metadata updates. AI response:", aiResponse);
        return {
          success: false,
          error: "No property updates found in AI response",
          editType: "replace"
        };
      }
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      const successMessage = this.generateSuccessMessage(updates);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to update metadata: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Parse AI response to extract property updates
   */
  parsePropertyUpdates(response) {
    try {
      const jsonMatch = response.match(/```json\s*([\s\S]*?)\s*```/);
      if (jsonMatch) {
        return JSON.parse(jsonMatch[1]);
      }
      const updates = {};
      const lines = response.split("\n");
      for (const line of lines) {
        const match = line.match(/^[-\s]*([^:]+):\s*(.+)$/);
        if (match) {
          const key = match[1].trim();
          let value = match[2].trim();
          try {
            value = JSON.parse(value);
          } catch (e) {
            if (value.startsWith('"') && value.endsWith('"') || value.startsWith("'") && value.endsWith("'")) {
              value = value.slice(1, -1);
            }
          }
          updates[key] = value;
        }
      }
      return Object.keys(updates).length > 0 ? updates : null;
    } catch (error) {
      return null;
    }
  }
  /**
   * Update or create frontmatter in document content
   */
  updateFrontmatter(content, updates) {
    const lines = content.split("\n");
    if (lines[0] === "---") {
      let endIndex = -1;
      for (let i = 1; i < lines.length; i++) {
        if (lines[i] === "---") {
          endIndex = i;
          break;
        }
      }
      if (endIndex > 0) {
        const existingProps = {};
        for (let i = 1; i < endIndex; i++) {
          const match = lines[i].match(/^([^:]+):\s*(.*)$/);
          if (match) {
            const key = match[1].trim();
            let value = match[2].trim();
            try {
              value = JSON.parse(value);
            } catch (e) {
            }
            existingProps[key] = value;
          }
        }
        const mergedProps = { ...existingProps, ...updates };
        const newFrontmatter2 = ["---"];
        for (const [key, value] of Object.entries(mergedProps)) {
          if (value === null || value === void 0) {
            continue;
          }
          const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
          newFrontmatter2.push(`${key}: ${formattedValue}`);
        }
        newFrontmatter2.push("---");
        return [
          ...newFrontmatter2,
          ...lines.slice(endIndex + 1)
        ].join("\n");
      }
    }
    const newFrontmatter = ["---"];
    for (const [key, value] of Object.entries(updates)) {
      if (value === null || value === void 0) {
        continue;
      }
      const formattedValue = typeof value === "object" ? JSON.stringify(value) : String(value);
      newFrontmatter.push(`${key}: ${formattedValue}`);
    }
    newFrontmatter.push("---", "");
    return newFrontmatter.join("\n") + content;
  }
  /**
   * Handle direct tag operations (add, remove, set tags)
   */
  async handleDirectTagOperation(instruction, documentContext) {
    const lowerInstruction = instruction.toLowerCase().trim();
    const colonMatch = lowerInstruction.match(/^(add|set|update|remove)\s+tags?:\s*(.*)$/);
    if (colonMatch) {
      const action = colonMatch[1];
      const tagString = colonMatch[2];
      const newTags = tagString ? tagString.split(",").map((t) => t.trim()).filter((t) => t) : [];
      if (action === "add" && newTags.length === 0) {
        return await this.handleAITagOperation("add suggested tags", documentContext);
      }
      const currentTags = this.getCurrentTags(documentContext.content);
      let updatedTags = [];
      let message = "";
      switch (action) {
        case "add":
          const tagsToAdd = newTags.filter(
            (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
          );
          updatedTags = [...currentTags, ...tagsToAdd];
          message = tagsToAdd.length > 0 ? `Added ${tagsToAdd.length} tag${tagsToAdd.length !== 1 ? "s" : ""}: ${tagsToAdd.join(", ")}` : "No new tags to add (duplicates filtered)";
          break;
        case "remove":
          const lowerNewTags = newTags.map((t) => t.toLowerCase());
          const beforeCount = currentTags.length;
          updatedTags = currentTags.filter(
            (tag) => !lowerNewTags.includes(tag.toLowerCase())
          );
          const removedCount = beforeCount - updatedTags.length;
          message = removedCount > 0 ? `Removed ${removedCount} tag${removedCount !== 1 ? "s" : ""}` : "No tags found to remove";
          break;
        case "set":
        case "update":
          updatedTags = [...new Set(newTags.map((t) => t.toLowerCase()))];
          message = `Set ${updatedTags.length} tag${updatedTags.length !== 1 ? "s" : ""}`;
          break;
      }
      const updates = { tags: updatedTags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    }
    if (/\b(clean up|cleanup|optimize|improve|review|analyze)\s+.*\btags?\b/i.test(lowerInstruction) || /\b(suggest|recommend)\s+.*\btags?\b/i.test(lowerInstruction) || /^add suggested tags$/i.test(lowerInstruction) || /^add tags$/i.test(lowerInstruction) || // Handle simple "add tags" as AI suggestion
    /^update tags$/i.test(lowerInstruction)) {
      return await this.handleAITagOperation(instruction, documentContext);
    }
    return null;
  }
  /**
   * Handle AI-powered tag operations (suggest, optimize, clean up)
   */
  async handleAITagOperation(instruction, documentContext) {
    const currentTags = this.getCurrentTags(documentContext.content);
    const systemPrompt = `You are an expert at document tagging and metadata organization. Your task is to analyze documents and provide optimal tags.

Rules for tags:
- Tags should be lowercase
- Use hyphens for multi-word tags (e.g., "machine-learning")
- Be specific but not overly granular
- Aim for 5-10 tags per document
- Focus on key concepts, topics, and themes FROM THE ACTUAL DOCUMENT CONTENT
- Tags must be directly relevant to the document's subject matter
- Avoid generic tags like "document" or "text"
- Consider the document's purpose, audience, and main topics
- Extract tags based on the document's actual content, not random topics

IMPORTANT: Base your tag suggestions ONLY on the content provided. Do not invent unrelated tags.

Return ONLY a JSON object with a "tags" array and a "reasoning" field explaining your choices.`;
    let userPrompt = "";
    if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
      userPrompt = `Carefully analyze the following document and suggest relevant tags based on its actual content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Based on the above document content, suggest additional tags that:
1. Reflect the actual topics discussed in the document
2. Capture key concepts, technologies, or themes mentioned
3. Would help with discoverability and organization
4. Are directly relevant to what this document is about

DO NOT suggest tags about topics not mentioned in the document.`;
    } else if (/clean up|cleanup/i.test(instruction)) {
      userPrompt = `Clean up and optimize the tags for this document by analyzing both the current tags and the document content.

Current tags: ${currentTags.join(", ")}

DOCUMENT CONTENT:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Remove duplicate or redundant tags
2. Consolidate similar tags (e.g., "js" and "javascript")
3. Remove tags that aren't relevant to the document content
4. Standardize tag format (lowercase, hyphenated)
5. Ensure remaining tags accurately reflect the document

Provide a cleaned-up tag list based on the actual document content.`;
    } else if (/optimize|improve|review|analyze|update/i.test(instruction)) {
      userPrompt = `Analyze this document thoroughly and provide an optimized set of tags that accurately represents its content.

Current tags: ${currentTags.length > 0 ? currentTags.join(", ") : "none"}

DOCUMENT TO ANALYZE:
===START OF DOCUMENT===
${documentContext.content}
===END OF DOCUMENT===

Tasks:
1. Review the document content carefully
2. Remove any tags that aren't relevant to the actual content
3. Add tags for important concepts, topics, or themes that are missing
4. Ensure all tags directly relate to what's discussed in the document
5. Aim for 5-10 highly relevant tags

Provide an optimized tag list that best represents THIS SPECIFIC document's content.`;
    }
    try {
      const defaultMaxTokens = this.providerManager.getDefaultMaxTokens();
      const aiResponse = await this.providerManager.complete(systemPrompt, userPrompt, {
        temperature: 0.3,
        maxTokens: defaultMaxTokens
      });
      const parsed = this.parseAITagResponse(aiResponse);
      if (!parsed || !parsed.tags || parsed.tags.length === 0) {
        const preview = aiResponse.length > 100 ? aiResponse.substring(0, 100) + "..." : aiResponse;
        return {
          success: false,
          error: `Could not parse AI tag suggestions. AI response: "${preview}"`,
          editType: "replace"
        };
      }
      const updates = { tags: parsed.tags };
      const updatedContent = this.updateFrontmatter(documentContext.content, updates);
      await this.app.vault.modify(documentContext.file, updatedContent);
      let message = "";
      if (/add suggested/i.test(instruction) || /^add tags$/i.test(instruction)) {
        const addedTags = parsed.tags.filter(
          (tag) => !currentTags.some((existing) => existing.toLowerCase() === tag.toLowerCase())
        );
        message = `Added ${addedTags.length} suggested tag${addedTags.length !== 1 ? "s" : ""}: ${addedTags.join(", ")}`;
      } else if (/clean up|cleanup/i.test(instruction)) {
        message = `Cleaned up tags: ${currentTags.length} \u2192 ${parsed.tags.length} tags`;
      } else {
        message = `Optimized tags: ${parsed.tags.length} tag${parsed.tags.length !== 1 ? "s" : ""} (was ${currentTags.length})`;
      }
      return {
        success: true,
        content: updatedContent,
        appliedAt: { line: 0, ch: 0 },
        editType: "replace",
        successMessage: message
      };
    } catch (error) {
      return {
        success: false,
        error: `Failed to process tag operation: ${error.message}`,
        editType: "replace"
      };
    }
  }
  /**
   * Get current tags from document content
   */
  getCurrentTags(content) {
    if (!content) return [];
    const lines = content.split("\n");
    if (lines.length > 0 && lines[0] === "---") {
      let inFrontmatter = true;
      for (let i = 1; i < lines.length && inFrontmatter; i++) {
        if (lines[i] === "---") {
          break;
        }
        const tagMatch = lines[i].match(/^tags:\s*(.*)$/);
        if (tagMatch) {
          const tagValue = tagMatch[1].trim();
          if (!tagValue) return [];
          try {
            const parsed = JSON.parse(tagValue);
            if (Array.isArray(parsed)) {
              return parsed.filter((t) => t);
            }
          } catch (e) {
            return tagValue.split(",").map((t) => t.trim()).filter((t) => t);
          }
        }
      }
    }
    return [];
  }
  /**
   * Parse AI response for tag operations
   */
  parseAITagResponse(response) {
    try {
      const cleanResponse = response.trim();
      const jsonMatch = cleanResponse.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        try {
          const parsed = JSON.parse(jsonMatch[0]);
          if (parsed.tags && Array.isArray(parsed.tags)) {
            return {
              tags: parsed.tags.map((t) => String(t).toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t),
              reasoning: parsed.reasoning
            };
          }
        } catch (e) {
        }
      }
      const patterns = [
        // JSON array: tags: ["tag1", "tag2"]
        /tags?:\s*\[([^\]]+)\]/i,
        // Comma list: Tags: tag1, tag2, tag3
        /tags?:\s*([^\n]+?)(?:\n|$)/i,
        // Bullet list: - tag1\n- tag2
        /(?:tags?:)?\s*(?:\n)?(\s*[-•*]\s*.+(?:\n\s*[-•*]\s*.+)*)/i
      ];
      for (const pattern of patterns) {
        const match = cleanResponse.match(pattern);
        if (match) {
          let tagString = match[1];
          let tags = [];
          if (tagString.includes("-") || tagString.includes("\u2022") || tagString.includes("*")) {
            tags = tagString.split(/\n/).map((line) => line.replace(/^\s*[-•*]\s*/, "").trim()).filter((t) => t);
          } else {
            tags = tagString.split(",").map((t) => t.trim().replace(/["']/g, "")).filter((t) => t);
          }
          if (tags.length > 0) {
            return {
              tags: tags.map((t) => t.toLowerCase().trim().replace(/\s+/g, "-")).filter((t) => t)
            };
          }
        }
      }
      const suggestMatch = cleanResponse.match(/(?:suggest|recommend|propose|here are|tags are)[:\s]+([^.]+)/i);
      if (suggestMatch) {
        const tags = suggestMatch[1].split(/[,\n]/).map((t) => t.trim().replace(/["']/g, "").replace(/^and\s+/i, "")).filter((t) => t);
        if (tags.length > 0) {
          return {
            tags: tags.map((t) => t.toLowerCase().trim()).filter((t) => t)
          };
        }
      }
      const lines = cleanResponse.split("\n").map((line) => line.trim()).filter((line) => line);
      const validTags = lines.filter((line) => {
        return line.length > 0 && line.length < 50 && !line.includes(":") && !line.toLowerCase().includes("tag") && !line.toLowerCase().includes("here") && !line.toLowerCase().includes("suggest");
      }).map((line) => {
        return line.toLowerCase().replace(/^[-•*#]\s*/, "").replace(/^\d+\.\s*/, "").trim().replace(/\s+/g, "-");
      }).filter((tag) => tag);
      if (validTags.length > 0) {
        return { tags: validTags };
      }
      console.error("Failed to parse AI tag response:", cleanResponse);
      return null;
    } catch (error) {
      console.error("Error parsing AI tag response:", error, "Response was:", response);
      return null;
    }
  }
  /**
   * Generate success message based on updates
   */
  generateSuccessMessage(updates) {
    const keys = Object.keys(updates);
    if (keys.length === 0) return "Metadata updated";
    if (keys.length === 1) {
      const key = keys[0];
      if (key === "tags") {
        const count = Array.isArray(updates.tags) ? updates.tags.length : 0;
        return `Updated tags (${count} tag${count !== 1 ? "s" : ""})`;
      }
      return `Updated ${key}`;
    }
    return `Updated ${keys.length} properties`;
  }
};

// src/licensing/feature-config.ts
var SUPERNOVA_FEATURES = {
  // Commands (unified) - 2 month early access
  "commands": {
    supernovaDate: "2025-07-20",
    // Supernova early access
    generalDate: "2025-09-30",
    // General availability 
    description: "Command system with : triggers, command button, and custom commands"
  }
};

// src/licensing/feature-manager.ts
var FeatureManager = class {
  constructor(licenseValidator, debugSettings) {
    this.licenseValidator = licenseValidator;
    this.features = /* @__PURE__ */ new Map();
    this.supernovaLicense = null;
    this.isSupernova = false;
    this.debugSettings = { enabled: false };
    if (debugSettings) {
      if (false) {
        this.debugSettings = { enabled: false };
      } else {
        this.debugSettings = debugSettings;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Initialize feature flags for time-gated features only
   * Core features work without any feature checking
   */
  initializeFeatureFlags() {
    Object.entries(SUPERNOVA_FEATURES).forEach(([key, config]) => {
      const enabled = this.isTimeGatedFeatureEnabled(key, config);
      this.registerFeature({
        key,
        enabled,
        description: config.description,
        isTimeGated: true,
        earlyAccessOnly: !this.isGenerallyAvailable(config)
      });
    });
  }
  /**
   * Check if a time-gated feature should be enabled
   */
  isTimeGatedFeatureEnabled(featureKey, config) {
    const now = this.getCurrentDate();
    const supernovaDate = new Date(config.supernovaDate);
    const generalDate = new Date(config.generalDate);
    const isSupernova = this.getIsSupernova();
    if (now >= generalDate) {
      return true;
    }
    if (isSupernova && now >= supernovaDate) {
      return true;
    }
    return false;
  }
  /**
   * Check if feature is generally available (past general date)
   */
  isGenerallyAvailable(config) {
    const now = this.getCurrentDate();
    const generalDate = new Date(config.generalDate);
    return now >= generalDate;
  }
  /**
   * Get current date (can be overridden in debug mode)
   */
  getCurrentDate() {
    if (this.debugSettings.enabled && this.debugSettings.overrideDate) {
      return new Date(this.debugSettings.overrideDate);
    }
    return /* @__PURE__ */ new Date();
  }
  /**
   * Get Supernova status (can be overridden in debug mode)
   */
  getIsSupernova() {
    if (this.debugSettings.enabled && this.debugSettings.forceSupernova !== void 0 && true) {
      return this.debugSettings.forceSupernova;
    }
    return this.isSupernova;
  }
  /**
   * Register a new feature flag
   */
  registerFeature(flag) {
    this.features.set(flag.key, flag);
  }
  /**
   * Update Supernova license and recalculate feature availability
   */
  async updateSupernovaLicense(licenseKey) {
    if (!licenseKey) {
      this.supernovaLicense = null;
      this.isSupernova = false;
    } else {
      const validation = await this.licenseValidator.validateSupernovaLicense(licenseKey);
      if (validation.valid && validation.license) {
        this.supernovaLicense = validation.license;
        this.isSupernova = true;
      } else {
        this.supernovaLicense = null;
        this.isSupernova = false;
      }
    }
    this.initializeFeatureFlags();
  }
  /**
   * Get current Supernova status
   */
  isSupernovaSupporter() {
    return this.getIsSupernova();
  }
  /**
   * Get current Supernova license
   */
  getSupernovaLicense() {
    return this.supernovaLicense;
  }
  /**
   * Check if user has lifetime access (lifetime or founding license)
   */
  hasLifetimeAccess() {
    const license = this.getSupernovaLicense();
    return license !== null && (license.type === "lifetime" || license.type === "founding");
  }
  /**
   * Check if a feature is enabled
   * Only handles time-gated features - everything else just works without checking
   */
  isFeatureEnabled(featureKey) {
    var _a;
    const feature = this.features.get(featureKey);
    return (_a = feature == null ? void 0 : feature.enabled) != null ? _a : false;
  }
  /**
   * Check feature access with detailed result
   * Only handles time-gated features
   */
  checkFeatureAccess(featureKey) {
    const feature = this.features.get(featureKey);
    if (!feature) {
      return {
        allowed: false,
        reason: `Feature '${featureKey}' not found`
      };
    }
    if (feature.enabled) {
      return { allowed: true };
    }
    if (feature.isTimeGated) {
      const config = SUPERNOVA_FEATURES[featureKey];
      if (config) {
        const now = this.getCurrentDate();
        const generalDate = new Date(config.generalDate);
        const supernovaDate = new Date(config.supernovaDate);
        if (this.getIsSupernova() && now < supernovaDate) {
          return {
            allowed: false,
            reason: `This feature will be available to Supernova supporters on ${config.supernovaDate}`,
            isSupernovaFeature: true,
            availableDate: supernovaDate
          };
        } else if (!this.getIsSupernova() && now < generalDate) {
          return {
            allowed: false,
            reason: `This feature is currently in early access for Supernova supporters. It will be available to all users on ${config.generalDate}`,
            isSupernovaFeature: true,
            availableDate: generalDate
          };
        }
      }
    }
    return {
      allowed: false,
      reason: "Feature is not available"
    };
  }
  /**
   * Get all enabled time-gated features
   */
  getEnabledFeatures() {
    return Array.from(this.features.values()).filter((feature) => feature.enabled);
  }
  /**
   * Get all Supernova early access features
   */
  getSupernovaFeatures() {
    return Array.from(this.features.values()).filter(
      (feature) => feature.isTimeGated && feature.earlyAccessOnly
    );
  }
  /**
   * Update debug settings for development testing
   */
  updateDebugSettings(settings) {
    if (false) {
      this.debugSettings = { enabled: false };
    } else {
      this.debugSettings = settings;
    }
    this.initializeFeatureFlags();
  }
  /**
   * Reset debug settings to safe defaults
   */
  resetDebugSettings() {
    this.debugSettings = { enabled: false };
    this.initializeFeatureFlags();
  }
  /**
   * Get debug settings
   */
  getDebugSettings() {
    return { ...this.debugSettings };
  }
  /**
   * Get feature summary for time-gated features only
   */
  getFeatureSummary() {
    const enabled = [];
    const comingSoon = [];
    for (const [key, feature] of this.features) {
      if (feature.enabled) {
        enabled.push(key);
      } else if (feature.isTimeGated) {
        const config = SUPERNOVA_FEATURES[key];
        if (config) {
          const isSupernovaUser = this.getIsSupernova();
          comingSoon.push({
            key,
            availableDate: isSupernovaUser ? config.supernovaDate : config.generalDate,
            isSupernova: isSupernovaUser
          });
        }
      }
    }
    return {
      isSupernova: this.getIsSupernova(),
      enabled,
      comingSoon
    };
  }
};

// src/core/crypto-service.ts
var CryptoService = class {
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  static base64Decode(str) {
    if (typeof atob !== "undefined") {
      return atob(str);
    }
    return Buffer.from(str, "base64").toString("utf8");
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  static base64Encode(str) {
    if (typeof btoa !== "undefined") {
      return btoa(str);
    }
    return Buffer.from(str, "utf8").toString("base64");
  }
  /**
   * Get the encryption key for API key AES-GCM encryption
   */
  static async getApiKeyEncryptionKey() {
    return await crypto.subtle.importKey(
      "raw",
      this.API_KEY_ENCRYPTION_DATA,
      { name: "AES-GCM" },
      false,
      ["encrypt", "decrypt"]
    );
  }
  /**
   * Encrypt a string value (typically an API key) using AES-GCM
   */
  static async encryptValue(value) {
    if (!value || value.trim() === "") {
      return value;
    }
    try {
      const key = await this.getApiKeyEncryptionKey();
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const encoder = new TextEncoder();
      const data = encoder.encode(value);
      const encrypted = await crypto.subtle.encrypt(
        {
          name: "AES-GCM",
          iv
        },
        key,
        data
      );
      const combined = new Uint8Array(iv.length + encrypted.byteLength);
      combined.set(iv);
      combined.set(new Uint8Array(encrypted), iv.length);
      return "encrypted:" + this.base64Encode(String.fromCharCode(...combined));
    } catch (error) {
      console.error("Failed to encrypt value:", error);
      return value;
    }
  }
  /**
   * Decrypt a string value (typically an API key) using AES-GCM
   */
  static async decryptValue(encryptedValue) {
    if (!encryptedValue || !encryptedValue.startsWith("encrypted:")) {
      return encryptedValue;
    }
    try {
      const key = await this.getApiKeyEncryptionKey();
      const base64Data = encryptedValue.substring("encrypted:".length);
      const combined = new Uint8Array(
        this.base64Decode(base64Data).split("").map((char) => char.charCodeAt(0))
      );
      const iv = combined.slice(0, 12);
      const encrypted = combined.slice(12);
      const decrypted = await crypto.subtle.decrypt(
        {
          name: "AES-GCM",
          iv
        },
        key,
        encrypted
      );
      const decoder = new TextDecoder();
      return decoder.decode(decrypted);
    } catch (error) {
      console.error("Failed to decrypt value:", error);
      return encryptedValue.startsWith("encrypted:") ? encryptedValue.substring("encrypted:".length) : encryptedValue;
    }
  }
  /**
   * Check if a value is encrypted
   */
  static isEncrypted(value) {
    return !!(value && value.startsWith("encrypted:"));
  }
  /**
   * Generate HMAC-SHA256 signature for license validation
   */
  static async generateHmacSignature(data, secretKey) {
    const encoder = new TextEncoder();
    const keyData = encoder.encode(secretKey);
    const messageData = encoder.encode(data);
    const cryptoKey = await crypto.subtle.importKey(
      "raw",
      keyData,
      { name: "HMAC", hash: "SHA-256" },
      false,
      ["sign"]
    );
    const signature = await crypto.subtle.sign("HMAC", cryptoKey, messageData);
    return Array.from(new Uint8Array(signature)).map((b) => b.toString(16).padStart(2, "0")).join("");
  }
};
// Fixed encryption key for API keys - ensures cross-device compatibility
CryptoService.API_KEY_ENCRYPTION_DATA = new Uint8Array([
  78,
  111,
  118,
  97,
  45,
  65,
  73,
  45,
  69,
  110,
  99,
  114,
  121,
  112,
  116,
  105,
  111,
  110,
  45,
  75,
  101,
  121,
  45,
  70,
  111,
  114,
  45,
  65,
  80,
  73,
  45,
  75
]);

// src/licensing/license-validator.ts
var LicenseValidator = class {
  constructor() {
    // Embedded signing key - in production this would be obfuscated
    this.SECRET_KEY = "nova-license-signing-key-2025";
  }
  /**
   * Validates a license key and returns validation result
   */
  async validateLicense(licenseKey) {
    try {
      const license = this.parseLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a license key string into a License object
   */
  parseLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, tier, expiresAtStr, issuedAtStr, signature] = parts;
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Safe base64 decode that handles both browser and Node.js environments
   */
  base64Decode(str) {
    return CryptoService.base64Decode(str);
  }
  /**
   * Safe base64 encode that handles both browser and Node.js environments
   */
  base64Encode(str) {
    return CryptoService.base64Encode(str);
  }
  /**
   * Validates a license object
   */
  async validateLicenseObject(license) {
    const expectedSignature = await this.generateSignature(
      license.email,
      "legacy",
      // Use legacy for old licenses
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for license data
   */
  async generateSignature(email, tier, expiresAt, issuedAt) {
    const data = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    return CryptoService.generateHmacSignature(data, this.SECRET_KEY);
  }
  /**
   * Creates a test license for development purposes
   */
  async createTestLicense(email, tier, lifetimeMode = true) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = lifetimeMode ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSignature(email, tier, expiresAt, issuedAt);
    const licenseData = `${email}|${tier}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
  /**
   * Validates a Supernova license key
   */
  async validateSupernovaLicense(licenseKey) {
    try {
      const license = this.parseSupernovaLicenseKey(licenseKey);
      if (!license) {
        return {
          valid: false,
          error: "INVALID_FORMAT" /* INVALID_FORMAT */
        };
      }
      const validationError = await this.validateSupernovaLicenseObject(license);
      if (validationError) {
        return {
          valid: false,
          license,
          error: validationError
        };
      }
      return {
        valid: true,
        license
      };
    } catch (error) {
      return {
        valid: false,
        error: "MALFORMED_DATA" /* MALFORMED_DATA */
      };
    }
  }
  /**
   * Parses a Supernova license key string
   */
  parseSupernovaLicenseKey(licenseKey) {
    try {
      const decoded = this.base64Decode(licenseKey);
      const parts = decoded.split("|");
      if (parts.length !== 5) {
        return null;
      }
      const [email, type, expiresAtStr, issuedAtStr, signature] = parts;
      if (type !== "annual" && type !== "lifetime" && type !== "founding") {
        return null;
      }
      const expiresAt = expiresAtStr === "lifetime" ? null : new Date(expiresAtStr);
      const issuedAt = new Date(issuedAtStr);
      if (isNaN(issuedAt.getTime())) {
        return null;
      }
      if (expiresAt && isNaN(expiresAt.getTime())) {
        return null;
      }
      return {
        email,
        type,
        expiresAt,
        issuedAt,
        signature,
        licenseKey
      };
    } catch (error) {
      return null;
    }
  }
  /**
   * Validates a Supernova license object
   */
  async validateSupernovaLicenseObject(license) {
    const expectedSignature = await this.generateSupernovaSignature(
      license.email,
      license.type,
      license.expiresAt,
      license.issuedAt
    );
    if (license.signature !== expectedSignature) {
      return "INVALID_SIGNATURE" /* INVALID_SIGNATURE */;
    }
    if (license.expiresAt && /* @__PURE__ */ new Date() > license.expiresAt) {
      return "EXPIRED" /* EXPIRED */;
    }
    if (license.issuedAt > /* @__PURE__ */ new Date()) {
      return "FUTURE_DATED" /* FUTURE_DATED */;
    }
    return null;
  }
  /**
   * Generates HMAC-SHA256 signature for Supernova license
   */
  async generateSupernovaSignature(email, type, expiresAt, issuedAt) {
    const data = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}`;
    return CryptoService.generateHmacSignature(data, this.SECRET_KEY);
  }
  /**
   * Creates a test Supernova license for development
   */
  async createTestSupernovaLicense(email, type) {
    const issuedAt = /* @__PURE__ */ new Date();
    const expiresAt = type === "lifetime" || type === "founding" ? null : new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3);
    const signature = await this.generateSupernovaSignature(email, type, expiresAt, issuedAt);
    const licenseData = `${email}|${type}|${(expiresAt == null ? void 0 : expiresAt.toISOString()) || "lifetime"}|${issuedAt.toISOString()}|${signature}`;
    return this.base64Encode(licenseData);
  }
};

// src/core/intent-detector.ts
var IntentDetector = class {
  constructor() {
    this.consultationPatterns = [
      { pattern: /^(Now is|Today|This week|Lately|Currently|These days)/i, name: "temporal" },
      { pattern: /\b(I'm (feeling|thinking|working|trying)|I've been|I was|I feel)\b/i, name: "personal_state" },
      { pattern: /\b(reminds me|makes me think|I wonder|I'm wondering)\b/i, name: "reflective" },
      { pattern: /\b(I think|I believe|I suspect|I notice|seems like|appears|looks like)\b/i, name: "opinion_observation" },
      { pattern: /\b(might be|could be|may be|probably|perhaps|maybe)\b/i, name: "speculation" }
    ];
    this.editingPatterns = [
      { pattern: /\b(write|mak(e|ing)|fix|improve|change|add|remove|rewrite|edit|create|compose|draft|generate)\b/i, name: "command_verb" },
      { pattern: /\b(this (section|paragraph|part|text|writing|better)|the writing here|here we|here needs|this is (unclear|wrong|confusing|right))\b/i, name: "document_reference" },
      { pattern: /\b(unclear|needs work|sounds wrong|too wordy|confusing)\b/i, name: "quality_assessment" },
      { pattern: /\b(at the end|in the (introduction|conclusion)|before this|after that)\b/i, name: "document_targeting" }
    ];
  }
  classifyInput(input) {
    const consultationMatches = [];
    const editingMatches = [];
    for (const { pattern, name } of this.consultationPatterns) {
      if (pattern.test(input)) {
        consultationMatches.push(name);
      }
    }
    for (const { pattern, name } of this.editingPatterns) {
      if (pattern.test(input)) {
        editingMatches.push(name);
      }
    }
    if (consultationMatches.length > 0 && editingMatches.length === 0) {
      return {
        type: "consultation",
        confidence: 0.9,
        matchedPatterns: consultationMatches
      };
    }
    if (editingMatches.length > 0 && consultationMatches.length === 0) {
      return {
        type: "editing",
        confidence: 0.9,
        matchedPatterns: editingMatches
      };
    }
    if (consultationMatches.length > 0 && editingMatches.length > 0) {
      const hasSpeculation = consultationMatches.includes("speculation") || consultationMatches.includes("opinion_observation");
      if (hasSpeculation) {
        return {
          type: "consultation",
          confidence: 0.8,
          matchedPatterns: consultationMatches
        };
      }
    }
    return {
      type: "ambiguous",
      confidence: 0.5,
      matchedPatterns: []
    };
  }
};

// src/core/ai-intent-classifier.ts
var AIIntentClassifier = class {
  constructor(providerManager) {
    this.providerManager = providerManager;
    this.intentDetector = new IntentDetector();
  }
  /**
   * Classify user input into one of three intents
   */
  async classifyIntent(userInput, hasSelection = false) {
    if (userInput.startsWith(":")) {
      return "CHAT";
    }
    return this.fallbackClassification(userInput);
  }
  /**
   * Enhanced fallback classification using IntentDetector
   */
  fallbackClassification(userInput) {
    const lowerInput = userInput.toLowerCase().trim();
    if (this.isGreeting(lowerInput)) {
      return "CHAT";
    }
    if (lowerInput.includes("?") || lowerInput.startsWith("what") || lowerInput.startsWith("why") || lowerInput.startsWith("how") || lowerInput.startsWith("when") || lowerInput.startsWith("where") || lowerInput.startsWith("who") || lowerInput.startsWith("can you") || lowerInput.startsWith("could you") || lowerInput.includes("explain") || lowerInput.includes("help me understand")) {
      return "CHAT";
    }
    const intentClassification = this.intentDetector.classifyInput(userInput);
    if (intentClassification.type === "consultation") {
      return "CHAT";
    }
    if (intentClassification.type === "editing") {
      if (this.isMetadataRelated(lowerInput)) {
        return "METADATA";
      }
      return "CONTENT";
    }
    if (intentClassification.type === "ambiguous") {
      if (this.isMetadataRelated(lowerInput)) {
        return "METADATA";
      }
      return "CHAT";
    }
    if (this.isMetadataRelated(lowerInput)) {
      return "METADATA";
    }
    return "CHAT";
  }
  /**
   * Helper method to check if input is a greeting
   */
  isGreeting(lowerInput) {
    return (
      // Basic greetings
      /^(hi|hello|hey|hiya|howdy)(\s|$)/i.test(lowerInput) || // Greetings with Nova
      /^(hi|hello|hey|hiya|howdy)\s+(nova|there)(\s|$)/i.test(lowerInput) || // Time-based greetings
      /^(good\s+(morning|afternoon|evening|night))(\s|$)/i.test(lowerInput) || // Just "nova" as a greeting
      /^nova(\s|$)/i.test(lowerInput)
    );
  }
  /**
   * Helper method to check if input is metadata-related
   */
  isMetadataRelated(lowerInput) {
    return (
      // Tag-specific patterns
      /\btags?\b/i.test(lowerInput) || /\btagging\b/i.test(lowerInput) || // Property patterns
      /\b(title|author|date|status|category|categories)\b/i.test(lowerInput) || // Metadata/frontmatter patterns
      /\b(metadata|frontmatter|properties|property)\b/i.test(lowerInput) || // Common metadata actions
      /^(add|update|set|remove|clean|optimize)\s+(tags?|title|author|metadata)/i.test(lowerInput)
    );
  }
};

// main.ts
var NOVA_ICON_SVG2 = `
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <!-- Central star core -->
  <circle cx="12" cy="12" r="2.5" fill="currentColor"/>
  
  <!-- Primary rays (4 main directions) -->
  <path d="M12 1L12 6" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M12 18L12 23" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M23 12L18 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  <path d="M6 12L1 12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Secondary rays (diagonals) -->
  <path d="M18.364 5.636L15.536 8.464" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 15.536L5.636 18.364" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M18.364 18.364L15.536 15.536" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
  <path d="M8.464 8.464L5.636 5.636" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
</svg>`;
var NovaPlugin = class extends import_obsidian15.Plugin {
  async onload() {
    try {
      await this.loadSettings();
      this.licenseValidator = new LicenseValidator();
      this.featureManager = new FeatureManager(
        this.licenseValidator,
        this.settings.licensing.debugSettings
      );
      if (this.settings.licensing.licenseKey) {
        await this.featureManager.updateSupernovaLicense(this.settings.licensing.licenseKey);
      }
      this.app.workspace.onLayoutReady(async () => {
        var _a;
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
        if (leaves.length > 0) {
          const sidebarView = leaves[0].view;
          sidebarView.refreshSupernovaUI();
          if ((_a = sidebarView.currentProviderDropdown) == null ? void 0 : _a.updateCurrentProvider) {
            try {
              sidebarView.currentProviderDropdown.updateCurrentProvider();
            } catch (error) {
              console.error("\u274C Failed to update provider dropdown on startup:", error);
            }
          }
        }
      });
      (0, import_obsidian15.addIcon)("nova-star", NOVA_ICON_SVG2);
      this.aiProviderManager = new AIProviderManager(this.settings, this.featureManager);
      await this.aiProviderManager.initialize();
      const dataStore = {
        loadData: (key) => this.loadDataWithKey(key),
        saveData: (key, data) => this.saveDataWithKey(key, data)
      };
      this.conversationManager = new ConversationManager(dataStore);
      this.documentEngine = new DocumentEngine(this.app, dataStore);
      this.documentEngine.setConversationManager(this.conversationManager);
      this.contextBuilder = new ContextBuilder(this.settings);
      this.commandParser = new CommandParser();
      this.promptBuilder = new PromptBuilder(this.documentEngine, this.conversationManager);
      this.aiIntentClassifier = new AIIntentClassifier(this.aiProviderManager);
      this.addCommandHandler = new AddCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.editCommandHandler = new EditCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.deleteCommandHandler = new DeleteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.grammarCommandHandler = new GrammarCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.rewriteCommandHandler = new RewriteCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.metadataCommandHandler = new MetadataCommand(this.app, this.documentEngine, this.contextBuilder, this.aiProviderManager);
      this.registerView(
        VIEW_TYPE_NOVA_SIDEBAR,
        (leaf) => new NovaSidebarView(leaf, this)
      );
      const ribbonIcon = this.addRibbonIcon("nova-star", "Nova AI", (evt) => {
        this.activateView();
      });
      this.addCommand({
        id: "nova-improve-writing",
        name: "Improve Writing",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("improve", editor);
        }
      });
      this.addCommand({
        id: "nova-make-longer",
        name: "Make Longer",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("longer", editor);
        }
      });
      this.addCommand({
        id: "nova-make-shorter",
        name: "Make Shorter",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("shorter", editor);
        }
      });
      TONE_OPTIONS.forEach((tone) => {
        this.addCommand({
          id: `nova-make-${tone.id}`,
          name: `Make ${tone.label}`,
          editorCallback: async (editor) => {
            await this.handleToneCommand(tone.id, editor);
          }
        });
      });
      this.addCommand({
        id: "nova-tell-nova",
        name: "Tell Nova...",
        editorCallback: async (editor) => {
          await this.handleSelectionCommand("custom", editor);
        }
      });
      this.addCommand({
        id: "open-nova-sidebar",
        name: "Open sidebar",
        callback: () => {
          this.activateView();
        }
      });
      this.selectionContextMenu = new SelectionContextMenu(this.app, this);
      this.selectionContextMenu.register();
      this.settingTab = new NovaSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
    } catch (error) {
    }
  }
  onunload() {
    var _a, _b;
    (_a = this.aiProviderManager) == null ? void 0 : _a.cleanup();
    (_b = this.conversationManager) == null ? void 0 : _b.cleanup();
  }
  async loadSettings() {
    var _a, _b, _c;
    const savedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, savedData);
    if (savedData == null ? void 0 : savedData.platformSettings) {
      this.settings.platformSettings = {
        desktop: Object.assign({}, DEFAULT_SETTINGS.platformSettings.desktop, savedData.platformSettings.desktop || {}),
        mobile: Object.assign({}, DEFAULT_SETTINGS.platformSettings.mobile, savedData.platformSettings.mobile || {})
      };
    }
    if (this.settings.aiProviders) {
      try {
        if ((_a = this.settings.aiProviders.claude) == null ? void 0 : _a.apiKey) {
          this.settings.aiProviders.claude.apiKey = await CryptoService.decryptValue(this.settings.aiProviders.claude.apiKey);
        }
        if ((_b = this.settings.aiProviders.openai) == null ? void 0 : _b.apiKey) {
          this.settings.aiProviders.openai.apiKey = await CryptoService.decryptValue(this.settings.aiProviders.openai.apiKey);
        }
        if ((_c = this.settings.aiProviders.google) == null ? void 0 : _c.apiKey) {
          this.settings.aiProviders.google.apiKey = await CryptoService.decryptValue(this.settings.aiProviders.google.apiKey);
        }
      } catch (error) {
        console.error("\u274C Failed to decrypt API keys:", error);
      }
    }
    if (this.settings.licensing) {
      try {
        if (this.settings.licensing.licenseKey) {
          this.settings.licensing.licenseKey = await CryptoService.decryptValue(this.settings.licensing.licenseKey);
        }
        if (this.settings.licensing.supernovaLicenseKey) {
          this.settings.licensing.supernovaLicenseKey = await CryptoService.decryptValue(this.settings.licensing.supernovaLicenseKey);
        }
      } catch (error) {
        console.error("\u274C Failed to decrypt license keys:", error);
      }
    }
    if (this.settings.licensing) {
      this.settings.licensing.debugSettings = DEFAULT_SETTINGS.licensing.debugSettings;
    }
  }
  /**
   * Deep merge two objects, preserving nested structures
   */
  deepMerge(target, source) {
    if (!source) return target;
    const result = { ...target };
    for (const key in source) {
      if (source.hasOwnProperty(key)) {
        if (source[key] && typeof source[key] === "object" && !Array.isArray(source[key])) {
          result[key] = this.deepMerge(target[key] || {}, source[key]);
        } else {
          result[key] = source[key];
        }
      }
    }
    return result;
  }
  async saveSettings() {
    var _a, _b, _c, _d, _e, _f, _g, _h, _i;
    const settingsToSave = JSON.parse(JSON.stringify(this.settings));
    if ((_a = settingsToSave.licensing) == null ? void 0 : _a.debugSettings) {
      delete settingsToSave.licensing.debugSettings;
    }
    if (settingsToSave.aiProviders) {
      try {
        if ((_b = settingsToSave.aiProviders.claude) == null ? void 0 : _b.apiKey) {
          settingsToSave.aiProviders.claude.apiKey = await CryptoService.encryptValue(settingsToSave.aiProviders.claude.apiKey);
        }
        if ((_c = settingsToSave.aiProviders.openai) == null ? void 0 : _c.apiKey) {
          settingsToSave.aiProviders.openai.apiKey = await CryptoService.encryptValue(settingsToSave.aiProviders.openai.apiKey);
        }
        if ((_d = settingsToSave.aiProviders.google) == null ? void 0 : _d.apiKey) {
          settingsToSave.aiProviders.google.apiKey = await CryptoService.encryptValue(settingsToSave.aiProviders.google.apiKey);
        }
      } catch (error) {
        console.error("\u274C Failed to encrypt API keys:", error);
      }
    }
    if (settingsToSave.licensing) {
      try {
        if (settingsToSave.licensing.licenseKey) {
          settingsToSave.licensing.licenseKey = await CryptoService.encryptValue(settingsToSave.licensing.licenseKey);
        }
        if (settingsToSave.licensing.supernovaLicenseKey) {
          settingsToSave.licensing.supernovaLicenseKey = await CryptoService.encryptValue(settingsToSave.licensing.supernovaLicenseKey);
        }
      } catch (error) {
        console.error("\u274C Failed to encrypt license keys:", error);
      }
    }
    try {
      await this.saveData(settingsToSave);
      await new Promise((resolve) => setTimeout(resolve, 200));
      await this.saveData(settingsToSave);
      await new Promise((resolve) => setTimeout(resolve, 200));
      const readBack = await this.loadData();
      const currentPlatform = import_obsidian15.Platform.isMobile ? "mobile" : "desktop";
      const expectedModel = this.settings.platformSettings[currentPlatform].selectedModel;
      const actualModel = (_f = (_e = readBack == null ? void 0 : readBack.platformSettings) == null ? void 0 : _e[currentPlatform]) == null ? void 0 : _f.selectedModel;
      if (expectedModel !== actualModel) {
        console.error("\u274C Save verification STILL failed after retry!", {
          expected: expectedModel,
          actual: actualModel,
          platform: currentPlatform
        });
        await this.saveData(settingsToSave);
        await new Promise((resolve) => setTimeout(resolve, 300));
        const finalCheck = await this.loadData();
        const finalActual = (_h = (_g = finalCheck == null ? void 0 : finalCheck.platformSettings) == null ? void 0 : _g[currentPlatform]) == null ? void 0 : _h.selectedModel;
        if (expectedModel !== finalActual) {
          console.error("\u274C Forced save also failed!", { finalActual });
        }
      }
      (_i = this.aiProviderManager) == null ? void 0 : _i.updateSettings(this.settings);
    } catch (error) {
      console.error("\u274C Error during save operation:", error);
      throw error;
    }
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf;
    const leaves = workspace.getLeavesOfType(VIEW_TYPE_NOVA_SIDEBAR);
    if (leaves.length > 0) {
      leaf = leaves[0];
    } else {
      leaf = workspace.getRightLeaf(false);
      await (leaf == null ? void 0 : leaf.setViewState({ type: VIEW_TYPE_NOVA_SIDEBAR, active: true }));
    }
    workspace.revealLeaf(leaf);
    if ((leaf == null ? void 0 : leaf.view) instanceof NovaSidebarView) {
      this.sidebarView = leaf.view;
    }
  }
  /**
   * Handle selection-based commands
   */
  async handleSelectionCommand(actionId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian15.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction(actionId, editor, selectedText);
    } catch (error) {
      console.error("Error executing Nova selection command:", error);
      new import_obsidian15.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Handle tone-specific commands
   */
  async handleToneCommand(toneId, editor) {
    try {
      const selectedText = editor.getSelection();
      if (!selectedText || selectedText.trim().length === 0) {
        new import_obsidian15.Notice("Please select some text first");
        return;
      }
      await this.selectionContextMenu.handleSelectionAction("tone", editor, selectedText, toneId);
    } catch (error) {
      console.error("Error executing Nova tone command:", error);
      new import_obsidian15.Notice("Failed to execute Nova action. Please try again.", 3e3);
    }
  }
  /**
   * Show upgrade prompt for Core tier mobile users
   */
  showMobileUpgradePrompt() {
    const modal = document.createElement("div");
    modal.className = "modal nova-mobile-upgrade-modal";
    modal.innerHTML = `
			<div class="modal-container">
				<div class="modal-bg"></div>
				<div class="modal-content">
					<div class="modal-header">
						<h3>Nova SuperNova Required</h3>
					</div>
					<div class="modal-body">
						<div class="nova-tier-badge core" style="margin-bottom: 1em;">
							<span class="tier-icon">FREE</span>
							<span class="tier-name">Core (Free)</span>
						</div>
						<p>Mobile access is available with Nova SuperNova.</p>
						<p>Core tier is limited to desktop use only.</p>
						<div class="nova-feature-list">
							<h4>SuperNova includes:</h4>
							<ul>
								<li>Mobile device support</li>
								<li>Multiple AI providers</li>
								<li>In-chat provider switching</li>
								<li>Advanced templates</li>
								<li>Priority support</li>
							</ul>
						</div>
					</div>
					<div class="modal-footer">
						<button class="mod-cta nova-upgrade-btn">Upgrade to SuperNova</button>
						<button class="nova-close-btn">Close</button>
					</div>
				</div>
			</div>
		`;
    const upgradeBtn = modal.querySelector(".nova-upgrade-btn");
    const closeBtn = modal.querySelector(".nova-close-btn");
    const modalBg = modal.querySelector(".modal-bg");
    const closeModal = () => {
      modal.remove();
    };
    upgradeBtn.addEventListener("click", () => {
      window.open("https://novawriter.ai/upgrade", "_blank");
      closeModal();
    });
    closeBtn.addEventListener("click", closeModal);
    modalBg.addEventListener("click", closeModal);
    document.body.appendChild(modal);
    new import_obsidian15.Notice("Nova mobile access requires SuperNova license", 8e3);
  }
  // DataStore interface implementation for ConversationManager
  async loadDataWithKey(key) {
    const allData = await this.loadData();
    return allData ? allData[key] : void 0;
  }
  async saveDataWithKey(key, data) {
    const allData = await this.loadData() || {};
    allData[key] = data;
    return await this.saveData(allData);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL3NpZGViYXItdmlldy50cyIsICJzcmMvY29yZS9kb2N1bWVudC1hbmFseXNpcy50cyIsICJzcmMvYWkvbW9kZWxzLnRzIiwgInNyYy91aS9pbnB1dC1oYW5kbGVyLnRzIiwgInNyYy91aS93aWtpbGluay1zdWdnZXN0LnRzIiwgInNyYy91aS9jb21tYW5kLXN5c3RlbS50cyIsICJzcmMvdWkvY29udGV4dC1tYW5hZ2VyLnRzIiwgInNyYy9haS9jb250ZXh0LWxpbWl0cy50cyIsICJzcmMvY29yZS9jb250ZXh0LWNhbGN1bGF0b3IudHMiLCAic3JjL3VpL2NoYXQtcmVuZGVyZXIudHMiLCAic3JjL3VpL3N0cmVhbWluZy1tYW5hZ2VyLnRzIiwgInNyYy91aS9zZWxlY3Rpb24tY29udGV4dC1tZW51LnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL3NlbGVjdGlvbi1lZGl0LWNvbW1hbmQudHMiLCAic3JjL3VpL3RvbmUtc2VsZWN0aW9uLW1vZGFsLnRzIiwgInNyYy91aS9jdXN0b20taW5zdHJ1Y3Rpb24tbW9kYWwudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9jbGF1ZGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vcGVuYWkudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9nb29nbGUudHMiLCAic3JjL2FpL3Byb3ZpZGVycy9vbGxhbWEudHMiLCAic3JjL2FpL3Byb3ZpZGVyLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvZG9jdW1lbnQtZW5naW5lLnRzIiwgInNyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyLnRzIiwgInNyYy9jb3JlL2NvbnRleHQtYnVpbGRlci50cyIsICJzcmMvY29yZS9jb21tYW5kLXBhcnNlci50cyIsICJzcmMvY29yZS9wcm9tcHQtYnVpbGRlci50cyIsICJzcmMvY29yZS9jb21tYW5kcy9hZGQtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQudHMiLCAic3JjL2NvcmUvY29tbWFuZHMvZ3JhbW1hci1jb21tYW5kLnRzIiwgInNyYy9jb3JlL2NvbW1hbmRzL3Jld3JpdGUtY29tbWFuZC50cyIsICJzcmMvY29yZS9jb21tYW5kcy9tZXRhZGF0YS1jb21tYW5kLnRzIiwgInNyYy9saWNlbnNpbmcvZmVhdHVyZS1jb25maWcudHMiLCAic3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXIudHMiLCAic3JjL2NvcmUvY3J5cHRvLXNlcnZpY2UudHMiLCAic3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvci50cyIsICJzcmMvY29yZS9pbnRlbnQtZGV0ZWN0b3IudHMiLCAic3JjL2NvcmUvYWktaW50ZW50LWNsYXNzaWZpZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgV29ya3NwYWNlTGVhZiwgSXRlbVZpZXcsIGFkZEljb24sIE5vdGljZSwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzLCBOb3ZhU2V0dGluZ1RhYiwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3NldHRpbmdzJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi9zcmMvYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBOb3ZhU2lkZWJhclZpZXcsIFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgfSBmcm9tICcuL3NyYy91aS9zaWRlYmFyLXZpZXcnO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuL3NyYy9jb3JlL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4vc3JjL2NvcmUvY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJzZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmQtcGFyc2VyJztcbmltcG9ydCB7IFByb21wdEJ1aWxkZXIgfSBmcm9tICcuL3NyYy9jb3JlL3Byb21wdC1idWlsZGVyJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIgfSBmcm9tICcuL3NyYy9jb3JlL2NvbnZlcnNhdGlvbi1tYW5hZ2VyJztcbmltcG9ydCB7IEFkZENvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2FkZC1jb21tYW5kJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi9zcmMvY29yZS9jb21tYW5kcy9lZGl0LWNvbW1hbmQnO1xuaW1wb3J0IHsgRGVsZXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvZGVsZXRlLWNvbW1hbmQnO1xuaW1wb3J0IHsgR3JhbW1hckNvbW1hbmQgfSBmcm9tICcuL3NyYy9jb3JlL2NvbW1hbmRzL2dyYW1tYXItY29tbWFuZCc7XG5pbXBvcnQgeyBSZXdyaXRlQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvcmV3cml0ZS1jb21tYW5kJztcbmltcG9ydCB7IE1ldGFkYXRhQ29tbWFuZCB9IGZyb20gJy4vc3JjL2NvcmUvY29tbWFuZHMvbWV0YWRhdGEtY29tbWFuZCc7XG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9mZWF0dXJlLW1hbmFnZXInO1xuaW1wb3J0IHsgTGljZW5zZVZhbGlkYXRvciB9IGZyb20gJy4vc3JjL2xpY2Vuc2luZy9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBOb3ZhV2lraWxpbmtBdXRvY29tcGxldGUgfSBmcm9tICcuL3NyYy91aS93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IFNlbGVjdGlvbkNvbnRleHRNZW51IH0gZnJvbSAnLi9zcmMvdWkvc2VsZWN0aW9uLWNvbnRleHQtbWVudSc7XG5pbXBvcnQgeyBUT05FX09QVElPTlMgfSBmcm9tICcuL3NyYy91aS90b25lLXNlbGVjdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBBSUludGVudENsYXNzaWZpZXIgfSBmcm9tICcuL3NyYy9jb3JlL2FpLWludGVudC1jbGFzc2lmaWVyJztcbmltcG9ydCB7IENyeXB0b1NlcnZpY2UgfSBmcm9tICcuL3NyYy9jb3JlL2NyeXB0by1zZXJ2aWNlJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3ZhUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3MhOiBOb3ZhU2V0dGluZ3M7XG5cdGFpUHJvdmlkZXJNYW5hZ2VyITogQUlQcm92aWRlck1hbmFnZXI7XG5cdGRvY3VtZW50RW5naW5lITogRG9jdW1lbnRFbmdpbmU7XG5cdGNvbnRleHRCdWlsZGVyITogQ29udGV4dEJ1aWxkZXI7XG5cdGNvbW1hbmRQYXJzZXIhOiBDb21tYW5kUGFyc2VyO1xuXHRwcm9tcHRCdWlsZGVyITogUHJvbXB0QnVpbGRlcjtcblx0Y29udmVyc2F0aW9uTWFuYWdlciE6IENvbnZlcnNhdGlvbk1hbmFnZXI7XG5cdGFpSW50ZW50Q2xhc3NpZmllciE6IEFJSW50ZW50Q2xhc3NpZmllcjtcblx0YWRkQ29tbWFuZEhhbmRsZXIhOiBBZGRDb21tYW5kO1xuXHRlZGl0Q29tbWFuZEhhbmRsZXIhOiBFZGl0Q29tbWFuZDtcblx0ZGVsZXRlQ29tbWFuZEhhbmRsZXIhOiBEZWxldGVDb21tYW5kO1xuXHRncmFtbWFyQ29tbWFuZEhhbmRsZXIhOiBHcmFtbWFyQ29tbWFuZDtcblx0cmV3cml0ZUNvbW1hbmRIYW5kbGVyITogUmV3cml0ZUNvbW1hbmQ7XG5cdG1ldGFkYXRhQ29tbWFuZEhhbmRsZXIhOiBNZXRhZGF0YUNvbW1hbmQ7XG5cdGZlYXR1cmVNYW5hZ2VyITogRmVhdHVyZU1hbmFnZXI7XG5cdGxpY2Vuc2VWYWxpZGF0b3IhOiBMaWNlbnNlVmFsaWRhdG9yO1xuXHRzZXR0aW5nVGFiITogTm92YVNldHRpbmdUYWI7XG5cdHNpZGViYXJWaWV3ITogTm92YVNpZGViYXJWaWV3O1xuXHRzZWxlY3Rpb25Db250ZXh0TWVudSE6IFNlbGVjdGlvbkNvbnRleHRNZW51O1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXG5cdFx0XHQvLyBJbml0aWFsaXplIGxpY2Vuc2luZyBzeXN0ZW1cblx0XHRcdHRoaXMubGljZW5zZVZhbGlkYXRvciA9IG5ldyBMaWNlbnNlVmFsaWRhdG9yKCk7XG5cdFx0XHR0aGlzLmZlYXR1cmVNYW5hZ2VyID0gbmV3IEZlYXR1cmVNYW5hZ2VyKFxuXHRcdFx0XHR0aGlzLmxpY2Vuc2VWYWxpZGF0b3IsXG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Ncblx0XHRcdCk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBsaWNlbnNlIGZyb20gc2V0dGluZ3Ncblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVmcmVzaCBTdXBlcm5vdmEgVUkgYWZ0ZXIgbGljZW5zZSB2YWxpZGF0aW9uIHRvIGhhbmRsZSBleHBpcmVkIGxpY2Vuc2VzXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeShhc3luYyAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdGlmIChsZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdC8vIFVwZGF0ZSBwcm92aWRlciBkcm9wZG93biBkaXNwbGF5IHRvIHJlZmxlY3QgbG9hZGVkIHNldHRpbmdzXG5cdFx0XHRcdFx0aWYgKChzaWRlYmFyVmlldyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy51cGRhdGVDdXJyZW50UHJvdmlkZXIpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdChzaWRlYmFyVmlldyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLnVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcignXHUyNzRDIEZhaWxlZCB0byB1cGRhdGUgcHJvdmlkZXIgZHJvcGRvd24gb24gc3RhcnR1cDonLCBlcnJvcik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gTm90ZTogTW9iaWxlIGFjY2VzcyByZXN0cmljdGlvbnMgYXJlIG5vdyBoYW5kbGVkIGluIHNpZGViYXIgVUlcblx0XHRcdC8vIFRoaXMgYWxsb3dzIENvcmUgbW9iaWxlIHVzZXJzIHRvIHNlZSB0aGUgdXBncmFkZSBpbnRlcmZhY2UgcmF0aGVyIHRoYW4gYSBicm9rZW4gcGx1Z2luXG5cblx0XHRcdC8vIFJlZ2lzdGVyIGN1c3RvbSBpY29uXG5cdFx0XHRhZGRJY29uKCdub3ZhLXN0YXInLCBOT1ZBX0lDT05fU1ZHKTtcblxuXHRcdFx0dGhpcy5haVByb3ZpZGVyTWFuYWdlciA9IG5ldyBBSVByb3ZpZGVyTWFuYWdlcih0aGlzLnNldHRpbmdzLCB0aGlzLmZlYXR1cmVNYW5hZ2VyKTtcblx0XHRcdGF3YWl0IHRoaXMuYWlQcm92aWRlck1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGFuZCBkb2N1bWVudCBlbmdpbmVcblx0XHRcdGNvbnN0IGRhdGFTdG9yZSA9IHtcblx0XHRcdFx0bG9hZERhdGE6IChrZXk6IHN0cmluZykgPT4gdGhpcy5sb2FkRGF0YVdpdGhLZXkoa2V5KSxcblx0XHRcdFx0c2F2ZURhdGE6IChrZXk6IHN0cmluZywgZGF0YTogYW55KSA9PiB0aGlzLnNhdmVEYXRhV2l0aEtleShrZXksIGRhdGEpXG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gbmV3IENvbnZlcnNhdGlvbk1hbmFnZXIoZGF0YVN0b3JlKTtcblx0XHRcdHRoaXMuZG9jdW1lbnRFbmdpbmUgPSBuZXcgRG9jdW1lbnRFbmdpbmUodGhpcy5hcHAsIGRhdGFTdG9yZSk7XG5cdFx0XHR0aGlzLmRvY3VtZW50RW5naW5lLnNldENvbnZlcnNhdGlvbk1hbmFnZXIodGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdHRoaXMuY29udGV4dEJ1aWxkZXIgPSBuZXcgQ29udGV4dEJ1aWxkZXIodGhpcy5zZXR0aW5ncyk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQYXJzZXIgPSBuZXcgQ29tbWFuZFBhcnNlcigpO1xuXHRcdFx0dGhpcy5wcm9tcHRCdWlsZGVyID0gbmV3IFByb21wdEJ1aWxkZXIodGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKTtcblx0XHRcdHRoaXMuYWlJbnRlbnRDbGFzc2lmaWVyID0gbmV3IEFJSW50ZW50Q2xhc3NpZmllcih0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdFxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kSGFuZGxlciA9IG5ldyBBZGRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZWRpdENvbW1hbmRIYW5kbGVyID0gbmV3IEVkaXRDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblx0XHRcdHRoaXMuZGVsZXRlQ29tbWFuZEhhbmRsZXIgPSBuZXcgRGVsZXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLmdyYW1tYXJDb21tYW5kSGFuZGxlciA9IG5ldyBHcmFtbWFyQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLnJld3JpdGVDb21tYW5kSGFuZGxlciA9IG5ldyBSZXdyaXRlQ29tbWFuZCh0aGlzLmFwcCwgdGhpcy5kb2N1bWVudEVuZ2luZSwgdGhpcy5jb250ZXh0QnVpbGRlciwgdGhpcy5haVByb3ZpZGVyTWFuYWdlcik7XG5cdFx0XHR0aGlzLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIgPSBuZXcgTWV0YWRhdGFDb21tYW5kKHRoaXMuYXBwLCB0aGlzLmRvY3VtZW50RW5naW5lLCB0aGlzLmNvbnRleHRCdWlsZGVyLCB0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyKTtcblxuXHRcdFx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0XHRcdFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsXG5cdFx0XHRcdChsZWFmKSA9PiBuZXcgTm92YVNpZGViYXJWaWV3KGxlYWYsIHRoaXMpXG5cdFx0XHQpO1xuXG5cdFx0XHQvLyBOb3RlOiBXaWtpbGluayBhdXRvY29tcGxldGUgaXMgbm93IGhhbmRsZWQgZGlyZWN0bHkgaW4gc2lkZWJhciB2aWV3XG5cblx0XHRcdGNvbnN0IHJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ25vdmEtc3RhcicsICdOb3ZhIEFJJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHR0aGlzLmFjdGl2YXRlVmlldygpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIFJlZ2lzdGVyIHNlbGVjdGlvbi1iYXNlZCBjb21tYW5kc1xuXHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6ICdub3ZhLWltcHJvdmUtd3JpdGluZycsXG5cdFx0XHRcdG5hbWU6ICdJbXByb3ZlIFdyaXRpbmcnLFxuXHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5oYW5kbGVTZWxlY3Rpb25Db21tYW5kKCdpbXByb3ZlJywgZWRpdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRcdGlkOiAnbm92YS1tYWtlLWxvbmdlcicsXG5cdFx0XHRcdG5hbWU6ICdNYWtlIExvbmdlcicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ2xvbmdlcicsIGVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtbWFrZS1zaG9ydGVyJyxcblx0XHRcdFx0bmFtZTogJ01ha2UgU2hvcnRlcicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ3Nob3J0ZXInLCBlZGl0b3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gSW5kaXZpZHVhbCB0b25lIGNvbW1hbmRzXG5cdFx0XHRUT05FX09QVElPTlMuZm9yRWFjaCh0b25lID0+IHtcblx0XHRcdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0XHRpZDogYG5vdmEtbWFrZS0ke3RvbmUuaWR9YCxcblx0XHRcdFx0XHRuYW1lOiBgTWFrZSAke3RvbmUubGFiZWx9YCxcblx0XHRcdFx0XHRlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yKSA9PiB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVRvbmVDb21tYW5kKHRvbmUuaWQsIGVkaXRvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ25vdmEtdGVsbC1ub3ZhJyxcblx0XHRcdFx0bmFtZTogJ1RlbGwgTm92YS4uLicsXG5cdFx0XHRcdGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoJ2N1c3RvbScsIGVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogJ29wZW4tbm92YS1zaWRlYmFyJyxcblx0XHRcdFx0bmFtZTogJ09wZW4gc2lkZWJhcicsXG5cdFx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmF0ZVZpZXcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgc2VsZWN0aW9uIGNvbnRleHQgbWVudVxuXHRcdFx0dGhpcy5zZWxlY3Rpb25Db250ZXh0TWVudSA9IG5ldyBTZWxlY3Rpb25Db250ZXh0TWVudSh0aGlzLmFwcCwgdGhpcyk7XG5cdFx0XHR0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51LnJlZ2lzdGVyKCk7XG5cblx0XHRcdHRoaXMuc2V0dGluZ1RhYiA9IG5ldyBOb3ZhU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcyk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKHRoaXMuc2V0dGluZ1RhYik7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHR9XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdFx0dGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyPy5jbGVhbnVwKCk7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0Y29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuXHRcdFxuXHRcdC8vIFVzZSBPYmplY3QuYXNzaWduIGZvciB0b3AgbGV2ZWwsIGJ1dCBtYW51YWxseSBtZXJnZSBwbGF0Zm9ybVNldHRpbmdzIHRvIHByZXNlcnZlIHNhdmVkIHZhbHVlc1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBzYXZlZERhdGEpO1xuXHRcdFxuXHRcdC8vIE1hbnVhbGx5IG1lcmdlIHBsYXRmb3JtU2V0dGluZ3MgdG8gZW5zdXJlIHNhdmVkIG1vZGVsIHNlbGVjdGlvbnMgYXJlIHByZXNlcnZlZFxuXHRcdGlmIChzYXZlZERhdGE/LnBsYXRmb3JtU2V0dGluZ3MpIHtcblx0XHRcdHRoaXMuc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncyA9IHtcblx0XHRcdFx0ZGVza3RvcDogT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUy5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AsIHNhdmVkRGF0YS5wbGF0Zm9ybVNldHRpbmdzLmRlc2t0b3AgfHwge30pLFxuXHRcdFx0XHRtb2JpbGU6IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUsIHNhdmVkRGF0YS5wbGF0Zm9ybVNldHRpbmdzLm1vYmlsZSB8fCB7fSlcblx0XHRcdH07XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERlY3J5cHQgQVBJIGtleXMgaWYgdGhleSBhcmUgZW5jcnlwdGVkXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZT8uYXBpS2V5KSB7XG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5ID0gYXdhaXQgQ3J5cHRvU2VydmljZS5kZWNyeXB0VmFsdWUodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5vcGVuYWk/LmFwaUtleSkge1xuXHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSA9IGF3YWl0IENyeXB0b1NlcnZpY2UuZGVjcnlwdFZhbHVlKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlPy5hcGlLZXkpIHtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkgPSBhd2FpdCBDcnlwdG9TZXJ2aWNlLmRlY3J5cHRWYWx1ZSh0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmdvb2dsZS5hcGlLZXkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdcdTI3NEMgRmFpbGVkIHRvIGRlY3J5cHQgQVBJIGtleXM6JywgZXJyb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBEZWNyeXB0IGxpY2Vuc2Uga2V5cyBpZiB0aGV5IGFyZSBlbmNyeXB0ZWRcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5saWNlbnNpbmcpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5saWNlbnNlS2V5KSB7XG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcubGljZW5zZUtleSA9IGF3YWl0IENyeXB0b1NlcnZpY2UuZGVjcnlwdFZhbHVlKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLmxpY2Vuc2VLZXkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5KSB7XG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9IGF3YWl0IENyeXB0b1NlcnZpY2UuZGVjcnlwdFZhbHVlKHRoaXMuc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdcdTI3NEMgRmFpbGVkIHRvIGRlY3J5cHQgbGljZW5zZSBrZXlzOicsIGVycm9yKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gQWx3YXlzIHVzZSBkZWZhdWx0IGRlYnVnU2V0dGluZ3MgKHRyYW5zaXRvcnkgZm9yIGRldmVsb3BtZW50IHNlc3Npb25zKVxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmxpY2Vuc2luZykge1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyA9IERFRkFVTFRfU0VUVElOR1MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHR9XG5cblxuXHQvKipcblx0ICogRGVlcCBtZXJnZSB0d28gb2JqZWN0cywgcHJlc2VydmluZyBuZXN0ZWQgc3RydWN0dXJlc1xuXHQgKi9cblx0cHJpdmF0ZSBkZWVwTWVyZ2UodGFyZ2V0OiBhbnksIHNvdXJjZTogYW55KTogYW55IHtcblx0XHRpZiAoIXNvdXJjZSkgcmV0dXJuIHRhcmdldDtcblx0XHRcblx0XHRjb25zdCByZXN1bHQgPSB7IC4uLnRhcmdldCB9O1xuXHRcdFxuXHRcdGZvciAoY29uc3Qga2V5IGluIHNvdXJjZSkge1xuXHRcdFx0aWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdGlmIChzb3VyY2Vba2V5XSAmJiB0eXBlb2Ygc291cmNlW2tleV0gPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHNvdXJjZVtrZXldKSkge1xuXHRcdFx0XHRcdHJlc3VsdFtrZXldID0gdGhpcy5kZWVwTWVyZ2UodGFyZ2V0W2tleV0gfHwge30sIHNvdXJjZVtrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXN1bHRba2V5XSA9IHNvdXJjZVtrZXldO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0Ly8gQ3JlYXRlIGEgY29weSBvZiBzZXR0aW5ncyB0byBlbmNyeXB0IEFQSSBrZXlzIGZvciBzdG9yYWdlXG5cdFx0Y29uc3Qgc2V0dGluZ3NUb1NhdmUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuc2V0dGluZ3MpKTtcblx0XHRcblx0XHQvLyBSZW1vdmUgZGVidWdTZXR0aW5ncyBmcm9tIHNhdmVkIGRhdGEgKHNob3VsZCBiZSB0cmFuc2l0b3J5IGZvciBkZXZlbG9wbWVudCBzZXNzaW9ucylcblx0XHRpZiAoc2V0dGluZ3NUb1NhdmUubGljZW5zaW5nPy5kZWJ1Z1NldHRpbmdzKSB7XG5cdFx0XHRkZWxldGUgc2V0dGluZ3NUb1NhdmUubGljZW5zaW5nLmRlYnVnU2V0dGluZ3M7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEVuY3J5cHQgQVBJIGtleXMgYmVmb3JlIHNhdmluZ1xuXHRcdGlmIChzZXR0aW5nc1RvU2F2ZS5haVByb3ZpZGVycykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0aWYgKHNldHRpbmdzVG9TYXZlLmFpUHJvdmlkZXJzLmNsYXVkZT8uYXBpS2V5KSB7XG5cdFx0XHRcdFx0c2V0dGluZ3NUb1NhdmUuYWlQcm92aWRlcnMuY2xhdWRlLmFwaUtleSA9IGF3YWl0IENyeXB0b1NlcnZpY2UuZW5jcnlwdFZhbHVlKHNldHRpbmdzVG9TYXZlLmFpUHJvdmlkZXJzLmNsYXVkZS5hcGlLZXkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChzZXR0aW5nc1RvU2F2ZS5haVByb3ZpZGVycy5vcGVuYWk/LmFwaUtleSkge1xuXHRcdFx0XHRcdHNldHRpbmdzVG9TYXZlLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXkgPSBhd2FpdCBDcnlwdG9TZXJ2aWNlLmVuY3J5cHRWYWx1ZShzZXR0aW5nc1RvU2F2ZS5haVByb3ZpZGVycy5vcGVuYWkuYXBpS2V5KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoc2V0dGluZ3NUb1NhdmUuYWlQcm92aWRlcnMuZ29vZ2xlPy5hcGlLZXkpIHtcblx0XHRcdFx0XHRzZXR0aW5nc1RvU2F2ZS5haVByb3ZpZGVycy5nb29nbGUuYXBpS2V5ID0gYXdhaXQgQ3J5cHRvU2VydmljZS5lbmNyeXB0VmFsdWUoc2V0dGluZ3NUb1NhdmUuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ1x1Mjc0QyBGYWlsZWQgdG8gZW5jcnlwdCBBUEkga2V5czonLCBlcnJvcik7XG5cdFx0XHRcdC8vIEZhbGwgYmFjayB0byBzYXZpbmcgd2l0aG91dCBlbmNyeXB0aW9uIGlmIGVuY3J5cHRpb24gZmFpbHNcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gRW5jcnlwdCBsaWNlbnNlIGtleXMgYmVmb3JlIHNhdmluZ1xuXHRcdGlmIChzZXR0aW5nc1RvU2F2ZS5saWNlbnNpbmcpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmIChzZXR0aW5nc1RvU2F2ZS5saWNlbnNpbmcubGljZW5zZUtleSkge1xuXHRcdFx0XHRcdHNldHRpbmdzVG9TYXZlLmxpY2Vuc2luZy5saWNlbnNlS2V5ID0gYXdhaXQgQ3J5cHRvU2VydmljZS5lbmNyeXB0VmFsdWUoc2V0dGluZ3NUb1NhdmUubGljZW5zaW5nLmxpY2Vuc2VLZXkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChzZXR0aW5nc1RvU2F2ZS5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSkge1xuXHRcdFx0XHRcdHNldHRpbmdzVG9TYXZlLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5ID0gYXdhaXQgQ3J5cHRvU2VydmljZS5lbmNyeXB0VmFsdWUoc2V0dGluZ3NUb1NhdmUubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdcdTI3NEMgRmFpbGVkIHRvIGVuY3J5cHQgbGljZW5zZSBrZXlzOicsIGVycm9yKTtcblx0XHRcdFx0Ly8gRmFsbCBiYWNrIHRvIHNhdmluZyB3aXRob3V0IGVuY3J5cHRpb24gaWYgZW5jcnlwdGlvbiBmYWlsc1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gRm9yY2Ugc2F2ZSBtdWx0aXBsZSB0aW1lcyB0byBlbnN1cmUgaXQgcGVyc2lzdHNcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEoc2V0dGluZ3NUb1NhdmUpO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgZGVsYXkgYW5kIHRyeSBhZ2FpblxuXHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMCkpO1xuXHRcdFx0YXdhaXQgdGhpcy5zYXZlRGF0YShzZXR0aW5nc1RvU2F2ZSk7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBhbm90aGVyIGRlbGF5IGFuZCB2ZXJpZnlcblx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDApKTtcblx0XHRcdFxuXHRcdFx0Ly8gVmVyaWZ5IHRoZSBzYXZlIGJ5IHJlYWRpbmcgaXQgYmFja1xuXHRcdFx0Y29uc3QgcmVhZEJhY2sgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG5cdFx0XHRcblx0XHRcdC8vIENoZWNrIGlmIHRoZSBzYXZlIGFjdHVhbGx5IHdvcmtlZFxuXHRcdFx0Y29uc3QgY3VycmVudFBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRcdGNvbnN0IGV4cGVjdGVkTW9kZWwgPSB0aGlzLnNldHRpbmdzLnBsYXRmb3JtU2V0dGluZ3NbY3VycmVudFBsYXRmb3JtXS5zZWxlY3RlZE1vZGVsO1xuXHRcdFx0Y29uc3QgYWN0dWFsTW9kZWwgPSByZWFkQmFjaz8ucGxhdGZvcm1TZXR0aW5ncz8uW2N1cnJlbnRQbGF0Zm9ybV0/LnNlbGVjdGVkTW9kZWw7XG5cdFx0XHRcblx0XHRcdGlmIChleHBlY3RlZE1vZGVsICE9PSBhY3R1YWxNb2RlbCkge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdcdTI3NEMgU2F2ZSB2ZXJpZmljYXRpb24gU1RJTEwgZmFpbGVkIGFmdGVyIHJldHJ5IScsIHtcblx0XHRcdFx0XHRleHBlY3RlZDogZXhwZWN0ZWRNb2RlbCxcblx0XHRcdFx0XHRhY3R1YWw6IGFjdHVhbE1vZGVsLFxuXHRcdFx0XHRcdHBsYXRmb3JtOiBjdXJyZW50UGxhdGZvcm1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBUcnkgb25lIG1vcmUgdGltZSB3aXRoIG1hbnVhbCBmaWxlIHdyaXRlXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEoc2V0dGluZ3NUb1NhdmUpO1xuXHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMzAwKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zdCBmaW5hbENoZWNrID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuXHRcdFx0XHRjb25zdCBmaW5hbEFjdHVhbCA9IGZpbmFsQ2hlY2s/LnBsYXRmb3JtU2V0dGluZ3M/LltjdXJyZW50UGxhdGZvcm1dPy5zZWxlY3RlZE1vZGVsO1xuXHRcdFx0XHRpZiAoZXhwZWN0ZWRNb2RlbCAhPT0gZmluYWxBY3R1YWwpIHtcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKCdcdTI3NEMgRm9yY2VkIHNhdmUgYWxzbyBmYWlsZWQhJywgeyBmaW5hbEFjdHVhbCB9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLmFpUHJvdmlkZXJNYW5hZ2VyPy51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignXHUyNzRDIEVycm9yIGR1cmluZyBzYXZlIG9wZXJhdGlvbjonLCBlcnJvcik7XG5cdFx0XHR0aHJvdyBlcnJvcjtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XG5cdFx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuXG5cdFx0bGV0IGxlYWY6IFdvcmtzcGFjZUxlYWYgfCBudWxsO1xuXHRcdGNvbnN0IGxlYXZlcyA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cblx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGxlYWYgPSBsZWF2ZXNbMF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxlYWYgPSB3b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWY/LnNldFZpZXdTdGF0ZSh7IHR5cGU6IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsIGFjdGl2ZTogdHJ1ZSB9KTtcblx0XHR9XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmISk7XG5cdFx0XG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIHRvIHNpZGViYXIgdmlld1xuXHRcdGlmIChsZWFmPy52aWV3IGluc3RhbmNlb2YgTm92YVNpZGViYXJWaWV3KSB7XG5cdFx0XHR0aGlzLnNpZGViYXJWaWV3ID0gbGVhZi52aWV3O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgc2VsZWN0aW9uLWJhc2VkIGNvbW1hbmRzXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGhhbmRsZVNlbGVjdGlvbkNvbW1hbmQoYWN0aW9uSWQ6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXHRcdFx0aWYgKCFzZWxlY3RlZFRleHQgfHwgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnUGxlYXNlIHNlbGVjdCBzb21lIHRleHQgZmlyc3QnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRhd2FpdCB0aGlzLnNlbGVjdGlvbkNvbnRleHRNZW51LmhhbmRsZVNlbGVjdGlvbkFjdGlvbihhY3Rpb25JZCwgZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgTm92YSBzZWxlY3Rpb24gY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHRvbmUtc3BlY2lmaWMgY29tbWFuZHNcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlVG9uZUNvbW1hbmQodG9uZUlkOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHNlbGVjdGVkVGV4dCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdGlmICghc2VsZWN0ZWRUZXh0IHx8IHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ1BsZWFzZSBzZWxlY3Qgc29tZSB0ZXh0IGZpcnN0Jyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2FsbCBoYW5kbGVTZWxlY3Rpb25BY3Rpb24gd2l0aCB0b25lIGFjdGlvbiBhbmQgdGhlIHNwZWNpZmljIHRvbmVcblx0XHRcdGF3YWl0IHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKCd0b25lJywgZWRpdG9yLCBzZWxlY3RlZFRleHQsIHRvbmVJZCk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGV4ZWN1dGluZyBOb3ZhIHRvbmUgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcblx0XHR9XG5cdH1cblxuXG5cdC8qKlxuXHQgKiBTaG93IHVwZ3JhZGUgcHJvbXB0IGZvciBDb3JlIHRpZXIgbW9iaWxlIHVzZXJzXG5cdCAqL1xuXHRwcml2YXRlIHNob3dNb2JpbGVVcGdyYWRlUHJvbXB0KCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0bW9kYWwuY2xhc3NOYW1lID0gJ21vZGFsIG5vdmEtbW9iaWxlLXVwZ3JhZGUtbW9kYWwnO1xuXHRcdG1vZGFsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250YWluZXJcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWJnXCI+PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuXHRcdFx0XHRcdFx0PGgzPk5vdmEgU3VwZXJOb3ZhIFJlcXVpcmVkPC9oMz5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibW9kYWwtYm9keVwiPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtdGllci1iYWRnZSBjb3JlXCIgc3R5bGU9XCJtYXJnaW4tYm90dG9tOiAxZW07XCI+XG5cdFx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwidGllci1pY29uXCI+RlJFRTwvc3Bhbj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJ0aWVyLW5hbWVcIj5Db3JlIChGcmVlKTwvc3Bhbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdFx0PHA+TW9iaWxlIGFjY2VzcyBpcyBhdmFpbGFibGUgd2l0aCBOb3ZhIFN1cGVyTm92YS48L3A+XG5cdFx0XHRcdFx0XHQ8cD5Db3JlIHRpZXIgaXMgbGltaXRlZCB0byBkZXNrdG9wIHVzZSBvbmx5LjwvcD5cblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWZlYXR1cmUtbGlzdFwiPlxuXHRcdFx0XHRcdFx0XHQ8aDQ+U3VwZXJOb3ZhIGluY2x1ZGVzOjwvaDQ+XG5cdFx0XHRcdFx0XHRcdDx1bD5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+TW9iaWxlIGRldmljZSBzdXBwb3J0PC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+TXVsdGlwbGUgQUkgcHJvdmlkZXJzPC9saT5cblx0XHRcdFx0XHRcdFx0XHQ8bGk+SW4tY2hhdCBwcm92aWRlciBzd2l0Y2hpbmc8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5BZHZhbmNlZCB0ZW1wbGF0ZXM8L2xpPlxuXHRcdFx0XHRcdFx0XHRcdDxsaT5Qcmlvcml0eSBzdXBwb3J0PC9saT5cblx0XHRcdFx0XHRcdFx0PC91bD5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJtb2QtY3RhIG5vdmEtdXBncmFkZS1idG5cIj5VcGdyYWRlIHRvIFN1cGVyTm92YTwvYnV0dG9uPlxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm5vdmEtY2xvc2UtYnRuXCI+Q2xvc2U8L2J1dHRvbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Y29uc3QgdXBncmFkZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXVwZ3JhZGUtYnRuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cdFx0Y29uc3QgY2xvc2VCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jbG9zZS1idG4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblx0XHRjb25zdCBtb2RhbEJnID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsLWJnJykgYXMgSFRNTEVsZW1lbnQ7XG5cblx0XHRjb25zdCBjbG9zZU1vZGFsID0gKCkgPT4ge1xuXHRcdFx0bW9kYWwucmVtb3ZlKCk7XG5cdFx0fTtcblxuXHRcdHVwZ3JhZGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3aW5kb3cub3BlbignaHR0cHM6Ly9ub3Zhd3JpdGVyLmFpL3VwZ3JhZGUnLCAnX2JsYW5rJyk7XG5cdFx0XHRjbG9zZU1vZGFsKCk7XG5cdFx0fSk7XG5cblx0XHRjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xuXHRcdG1vZGFsQmcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsKTtcblxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpO1xuXG5cdFx0Ly8gU2hvdyBub3RpY2UgYXMgd2VsbFxuXHRcdG5ldyBOb3RpY2UoJ05vdmEgbW9iaWxlIGFjY2VzcyByZXF1aXJlcyBTdXBlck5vdmEgbGljZW5zZScsIDgwMDApO1xuXHR9XG5cblx0Ly8gRGF0YVN0b3JlIGludGVyZmFjZSBpbXBsZW1lbnRhdGlvbiBmb3IgQ29udmVyc2F0aW9uTWFuYWdlclxuXHRhc3luYyBsb2FkRGF0YVdpdGhLZXkoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuXHRcdGNvbnN0IGFsbERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG5cdFx0cmV0dXJuIGFsbERhdGEgPyBhbGxEYXRhW2tleV0gOiB1bmRlZmluZWQ7XG5cdH1cblxuXHRhc3luYyBzYXZlRGF0YVdpdGhLZXkoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFsbERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCkgfHwge307XG5cdFx0YWxsRGF0YVtrZXldID0gZGF0YTtcblx0XHRyZXR1cm4gYXdhaXQgdGhpcy5zYXZlRGF0YShhbGxEYXRhKTtcblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vbWFpbic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyU2V0dGluZ3MsIFBsYXRmb3JtU2V0dGluZ3MsIFByb3ZpZGVyVHlwZSB9IGZyb20gJy4vYWkvdHlwZXMnO1xuaW1wb3J0IHsgRGVidWdTZXR0aW5ncywgU3VwZXJub3ZhTGljZW5zZSB9IGZyb20gJy4vbGljZW5zaW5nL3R5cGVzJztcbmltcG9ydCB7IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIsIE5vdmFTaWRlYmFyVmlldyB9IGZyb20gJy4vdWkvc2lkZWJhci12aWV3JztcbmltcG9ydCB7IGdldEF2YWlsYWJsZU1vZGVscyB9IGZyb20gJy4vYWkvbW9kZWxzJztcbmltcG9ydCB7IENsYXVkZVByb3ZpZGVyIH0gZnJvbSAnLi9haS9wcm92aWRlcnMvY2xhdWRlJztcbmltcG9ydCB7IE9wZW5BSVByb3ZpZGVyIH0gZnJvbSAnLi9haS9wcm92aWRlcnMvb3BlbmFpJztcbmltcG9ydCB7IEdvb2dsZVByb3ZpZGVyIH0gZnJvbSAnLi9haS9wcm92aWRlcnMvZ29vZ2xlJztcbmltcG9ydCB7IE9sbGFtYVByb3ZpZGVyIH0gZnJvbSAnLi9haS9wcm92aWRlcnMvb2xsYW1hJztcblxuY29uc3QgTk9WQV9JQ09OX1NWRyA9IGBcbjxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICA8IS0tIENlbnRyYWwgc3RhciBjb3JlIC0tPlxuICA8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjIuNVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIi8+XG4gIFxuICA8IS0tIFByaW1hcnkgcmF5cyAoNCBtYWluIGRpcmVjdGlvbnMpIC0tPlxuICA8cGF0aCBkPVwiTTEyIDFMMTIgNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuICA8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk02IDEyTDEgMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgXG4gIDwhLS0gU2Vjb25kYXJ5IHJheXMgKGRpYWdvbmFscykgLS0+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG4gIDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cbiAgPHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG48L3N2Zz5gO1xuXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbUNvbW1hbmQge1xuXHRpZDogc3RyaW5nO1xuXHRuYW1lOiBzdHJpbmc7XG5cdHRyaWdnZXI6IHN0cmluZztcblx0dGVtcGxhdGU6IHN0cmluZztcblx0ZGVzY3JpcHRpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTm92YVNldHRpbmdzIHtcblx0YWlQcm92aWRlcnM6IEFJUHJvdmlkZXJTZXR0aW5ncztcblx0cGxhdGZvcm1TZXR0aW5nczogUGxhdGZvcm1TZXR0aW5ncztcblx0Y3VzdG9tQ29tbWFuZHM/OiBDdXN0b21Db21tYW5kW107XG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IG51bWJlcjtcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiBudW1iZXI7XG5cdFx0YXV0b1NhdmU6IGJvb2xlYW47XG5cdH07XG5cdHNob3dDb21tYW5kQnV0dG9uOiBib29sZWFuO1xuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiBzdHJpbmc7XG5cdFx0c3VwZXJub3ZhTGljZW5zZUtleT86IHN0cmluZztcblx0XHRpc1N1cGVybm92YT86IGJvb2xlYW47XG5cdFx0ZGVidWdTZXR0aW5nczogRGVidWdTZXR0aW5ncztcblx0fTtcblx0cHJvdmlkZXJTdGF0dXM/OiB7XG5cdFx0W2tleTogc3RyaW5nXToge1xuXHRcdFx0c3RhdHVzOiAnY29ubmVjdGVkJyB8ICdlcnJvcicgfCAnbm90LWNvbmZpZ3VyZWQnIHwgJ3VudGVzdGVkJyB8ICd0ZXN0aW5nJztcblx0XHRcdG1lc3NhZ2U/OiBzdHJpbmc7XG5cdFx0XHRsYXN0Q2hlY2tlZD86IERhdGUgfCBzdHJpbmcgfCBudWxsO1xuXHRcdH07XG5cdH07XG5cdG9sbGFtYURlZmF1bHRDb250ZXh0PzogbnVtYmVyO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTm92YVNldHRpbmdzID0ge1xuXHRhaVByb3ZpZGVyczoge1xuXHRcdGNsYXVkZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9wZW5haToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdGJhc2VVcmw6ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdGdvb2dsZToge1xuXHRcdFx0YXBpS2V5OiAnJyxcblx0XHRcdHRlbXBlcmF0dXJlOiAwLjcsXG5cdFx0XHRtYXhUb2tlbnM6IDEwMDBcblx0XHR9LFxuXHRcdG9sbGFtYToge1xuXHRcdFx0YmFzZVVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuXHRcdFx0bW9kZWw6ICcnLFxuXHRcdFx0dGVtcGVyYXR1cmU6IDAuNyxcblx0XHRcdG1heFRva2VuczogMTAwMFxuXHRcdH1cblx0fSxcblx0cGxhdGZvcm1TZXR0aW5nczoge1xuXHRcdGRlc2t0b3A6IHtcblx0XHRcdHNlbGVjdGVkTW9kZWw6ICcnICAvLyBObyBkZWZhdWx0IG1vZGVsXG5cdFx0fSxcblx0XHRtb2JpbGU6IHtcblx0XHRcdHNlbGVjdGVkTW9kZWw6ICcnICAvLyBObyBkZWZhdWx0IG1vZGVsXG5cdFx0fVxuXHR9LFxuXHRjdXN0b21Db21tYW5kczogW10sXG5cdGdlbmVyYWw6IHtcblx0XHRkZWZhdWx0VGVtcGVyYXR1cmU6IDAuNyxcblx0XHRkZWZhdWx0TWF4VG9rZW5zOiAxMDAwLFxuXHRcdGF1dG9TYXZlOiB0cnVlXG5cdH0sXG5cdHNob3dDb21tYW5kQnV0dG9uOiB0cnVlLFxuXHRsaWNlbnNpbmc6IHtcblx0XHRsaWNlbnNlS2V5OiAnJyxcblx0XHRzdXBlcm5vdmFMaWNlbnNlS2V5OiAnJyxcblx0XHRpc1N1cGVybm92YTogZmFsc2UsXG5cdFx0ZGVidWdTZXR0aW5nczoge1xuXHRcdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0XHRvdmVycmlkZURhdGU6IHVuZGVmaW5lZCxcblx0XHRcdGZvcmNlU3VwZXJub3ZhOiBmYWxzZVxuXHRcdH1cblx0fSxcblx0cHJvdmlkZXJTdGF0dXM6IHt9LFxuXHRvbGxhbWFEZWZhdWx0Q29udGV4dDogMzIwMDBcbn07XG5cbmV4cG9ydCBjbGFzcyBOb3ZhU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgYWN0aXZlVGFiOiAnZ2V0dGluZy1zdGFydGVkJyB8ICdnZW5lcmFsJyB8ICdwcm92aWRlcnMnIHwgJ3N1cGVybm92YScgfCAnZGVidWcnID0gJ2dldHRpbmctc3RhcnRlZCc7XG5cdHByaXZhdGUgdGFiQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGNvbnRlbnRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ05vdmEgU2V0dGluZ3MnIH0pO1xuXG5cdFx0Ly8gQ3JlYXRlIHRhYiBuYXZpZ2F0aW9uIGNvbnRhaW5lciAob25seSBvbmNlKVxuXHRcdHRoaXMudGFiQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS10YWItY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNyZWF0ZVRhYk5hdmlnYXRpb24oKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29udGVudCBjb250YWluZXIgKG9ubHkgb25jZSkgIFxuXHRcdHRoaXMuY29udGVudENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtdGFiLWNvbnRlbnQnIH0pO1xuXHRcdHRoaXMudXBkYXRlVGFiQ29udGVudCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVUYWJOYXZpZ2F0aW9uKCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy50YWJDb250YWluZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCB0YWJzID0gW1xuXHRcdFx0eyBpZDogJ2dldHRpbmctc3RhcnRlZCcsIGxhYmVsOiAnR2V0dGluZyBTdGFydGVkJyB9LFxuXHRcdFx0eyBpZDogJ2dlbmVyYWwnLCBsYWJlbDogJ0dlbmVyYWwnIH0sXG5cdFx0XHR7IGlkOiAncHJvdmlkZXJzJywgbGFiZWw6ICdBSSBQcm92aWRlcnMnIH0sXG5cdFx0XHR7IGlkOiAnc3VwZXJub3ZhJywgbGFiZWw6ICdTdXBlcm5vdmEnIH1cblx0XHRdO1xuXG5cdFx0Ly8gQWRkIERlYnVnIHRhYiBvbmx5IGZvciBkZWJ1ZyBidWlsZHNcblx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcblx0XHRcdHRhYnMucHVzaCh7IGlkOiAnZGVidWcnLCBsYWJlbDogJ0RlYnVnJyB9KTtcblx0XHR9XG5cblx0XHR0YWJzLmZvckVhY2godGFiID0+IHtcblx0XHRcdGNvbnN0IHRhYkVsID0gdGhpcy50YWJDb250YWluZXIhLmNyZWF0ZURpdih7IFxuXHRcdFx0XHRjbHM6IGBub3ZhLXRhYiAke3RoaXMuYWN0aXZlVGFiID09PSB0YWIuaWQgPyAnYWN0aXZlJyA6ICcnfWAsXG5cdFx0XHRcdHRleHQ6IHRhYi5sYWJlbFxuXHRcdFx0fSk7XG5cdFx0XHR0YWJFbC5kYXRhc2V0LnRhYklkID0gdGFiLmlkO1xuXHRcdFx0XG5cdFx0XHR0YWJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zd2l0Y2hUYWIodGFiLmlkIGFzICdnZXR0aW5nLXN0YXJ0ZWQnIHwgJ2dlbmVyYWwnIHwgJ3Byb3ZpZGVycycgfCAnc3VwZXJub3ZhJyB8ICdkZWJ1ZycpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHN3aXRjaFRhYih0YWJJZDogJ2dldHRpbmctc3RhcnRlZCcgfCAnZ2VuZXJhbCcgfCAncHJvdmlkZXJzJyB8ICdzdXBlcm5vdmEnIHwgJ2RlYnVnJyk6IHZvaWQge1xuXHRcdHRoaXMuYWN0aXZlVGFiID0gdGFiSWQ7XG5cdFx0dGhpcy51cGRhdGVUYWJTdGF0ZXMoKTtcblx0XHR0aGlzLnVwZGF0ZVRhYkNvbnRlbnQoKTtcblx0XHR0aGlzLnNjcm9sbFRvQWN0aXZlVGFiKCk7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZVRhYlN0YXRlcygpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMudGFiQ29udGFpbmVyKSByZXR1cm47XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRhYiBhY3RpdmUgc3RhdGVzIHdpdGhvdXQgcmUtY3JlYXRpbmcgZWxlbWVudHNcblx0XHRjb25zdCB0YWJFbGVtZW50cyA9IHRoaXMudGFiQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3ZhLXRhYicpO1xuXHRcdHRhYkVsZW1lbnRzLmZvckVhY2godGFiRWwgPT4ge1xuXHRcdFx0Y29uc3QgaHRtbFRhYkVsID0gdGFiRWwgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAoaHRtbFRhYkVsLmRhdGFzZXQudGFiSWQgPT09IHRoaXMuYWN0aXZlVGFiKSB7XG5cdFx0XHRcdGh0bWxUYWJFbC5hZGRDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRodG1sVGFiRWwucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzY3JvbGxUb0FjdGl2ZVRhYigpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMudGFiQ29udGFpbmVyKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgYWN0aXZlVGFiID0gdGhpcy50YWJDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtdGFiLmFjdGl2ZScpIGFzIEhUTUxFbGVtZW50O1xuXHRcdGlmIChhY3RpdmVUYWIpIHtcblx0XHRcdGFjdGl2ZVRhYi5zY3JvbGxJbnRvVmlldyh7XG5cdFx0XHRcdGJlaGF2aW9yOiAnc21vb3RoJyxcblx0XHRcdFx0YmxvY2s6ICduZWFyZXN0Jyxcblx0XHRcdFx0aW5saW5lOiAnY2VudGVyJ1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVUYWJDb250ZW50KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZW50Q29udGFpbmVyKSByZXR1cm47XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgZXhpc3RpbmcgY29udGVudFxuXHRcdHRoaXMuY29udGVudENvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdHN3aXRjaCAodGhpcy5hY3RpdmVUYWIpIHtcblx0XHRcdGNhc2UgJ2dldHRpbmctc3RhcnRlZCc6XG5cdFx0XHRcdHRoaXMuY3JlYXRlR2V0dGluZ1N0YXJ0ZWRUYWJDb250ZW50KHRoaXMuY29udGVudENvbnRhaW5lcik7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnZ2VuZXJhbCc6XG5cdFx0XHRcdHRoaXMuY3JlYXRlR2VuZXJhbFRhYkNvbnRlbnQodGhpcy5jb250ZW50Q29udGFpbmVyKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdwcm92aWRlcnMnOlxuXHRcdFx0XHR0aGlzLmNyZWF0ZVByb3ZpZGVyc1RhYkNvbnRlbnQodGhpcy5jb250ZW50Q29udGFpbmVyKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdzdXBlcm5vdmEnOlxuXHRcdFx0XHR0aGlzLmNyZWF0ZVN1cGVybm92YVRhYkNvbnRlbnQodGhpcy5jb250ZW50Q29udGFpbmVyKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdkZWJ1Zyc6XG5cdFx0XHRcdHRoaXMuY3JlYXRlRGVidWdUYWJDb250ZW50KHRoaXMuY29udGVudENvbnRhaW5lcik7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR2VuZXJhbFRhYkNvbnRlbnQoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdC8vIFNob3cgc3VwcG9ydGVyIENUQSBvbmx5IGlmIG5vdCBhbHJlYWR5IGEgc3VwcG9ydGVyXG5cdFx0dGhpcy5jcmVhdGVTdXBlcm5vdmFDVEEoY29udGFpbmVyLCB7IFxuXHRcdFx0c2hvd09ubHlJZk5vdFN1cHBvcnRlcjogdHJ1ZSxcblx0XHRcdGJ1dHRvbkFjdGlvbjogJ3RhYicsXG5cdFx0XHRzaG93TGVhcm5Nb3JlOiBmYWxzZVxuXHRcdH0pO1xuXHRcdFxuXHRcdHRoaXMuY3JlYXRlR2VuZXJhbFNldHRpbmdzKGNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVQcml2YWN5U2V0dGluZ3MoY29udGFpbmVyKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJvdmlkZXJzVGFiQ29udGVudChjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Ly8gU2hvdyBzdXBwb3J0ZXIgQ1RBIG9ubHkgaWYgbm90IGFscmVhZHkgYSBzdXBwb3J0ZXJcblx0XHR0aGlzLmNyZWF0ZVN1cGVybm92YUNUQShjb250YWluZXIsIHsgXG5cdFx0XHRzaG93T25seUlmTm90U3VwcG9ydGVyOiB0cnVlLFxuXHRcdFx0YnV0dG9uQWN0aW9uOiAndGFiJyxcblx0XHRcdHNob3dMZWFybk1vcmU6IGZhbHNlXG5cdFx0fSk7XG5cdFx0XG5cdFx0dGhpcy5jcmVhdGVQcm92aWRlclNldHRpbmdzKGNvbnRhaW5lcik7XG5cdH1cblxuXG5cdHByaXZhdGUgY3JlYXRlR2V0dGluZ1N0YXJ0ZWRUYWJDb250ZW50KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNyZWF0ZVdlbGNvbWVTZWN0aW9uKGNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVOYXZpZ2F0aW9uSGVscChjb250YWluZXIpO1xuXHRcdHRoaXMuY3JlYXRlUXVpY2tTdGFydEd1aWRlKGNvbnRhaW5lcik7XG5cdFx0dGhpcy5jcmVhdGVTdXBlcm5vdmFDVEEoY29udGFpbmVyLCB7XG5cdFx0XHRidXR0b25BY3Rpb246ICd0YWInLFxuXHRcdFx0c2hvd0xlYXJuTW9yZTogdHJ1ZSxcblx0XHRcdG1hcmdpblRvcDogJzMycHgnLFxuXHRcdFx0bWFyZ2luQm90dG9tOiAnMzJweCdcblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlU3VwZXJub3ZhVGFiQ29udGVudChjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Ly8gVXNlIHRoZSByZXVzYWJsZSBDVEEgY29tcG9uZW50XG5cdFx0dGhpcy5jcmVhdGVTdXBlcm5vdmFDVEEoY29udGFpbmVyLCB7XG5cdFx0XHRidXR0b25BY3Rpb246ICdkaXJlY3QnLFxuXHRcdFx0c2hvd0xlYXJuTW9yZTogZmFsc2UsXG5cdFx0XHRtYXJnaW5Cb3R0b206ICczMnB4J1xuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIEJlbmVmaXRzIHNlY3Rpb24gd2l0aCBub3JtYWwgc3R5bGluZ1xuXHRcdGNvbnN0IGJlbmVmaXRzU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJlbmVmaXRzLXNlY3Rpb24nIH0pO1xuXHRcdGJlbmVmaXRzU2VjdGlvbi5zdHlsZS5tYXJnaW5Ub3AgPSAnMzJweCc7XG5cdFx0YmVuZWZpdHNTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1N1cGVybm92YSBCZW5lZml0cycgfSk7XG5cdFx0YmVuZWZpdHNTZWN0aW9uLmNyZWF0ZUVsKCdocicsIHsgY2xzOiAnbm92YS1zZWN0aW9uLWRpdmlkZXInIH0pO1xuXHRcdFxuXHRcdGNvbnN0IGJlbmVmaXRzQ29udGVudCA9IGJlbmVmaXRzU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJlbmVmaXRzLWNvbnRlbnQnIH0pO1xuXHRcdGJlbmVmaXRzQ29udGVudC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDIwcHg7XCI+U3VwcG9ydCBOb3ZhIGRldmVsb3BtZW50IGFuZCBnZXQgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy4gQWxsIGZlYXR1cmVzIGV2ZW50dWFsbHkgYmVjb21lIGZyZWUgZm9yIGV2ZXJ5b25lLjwvcD5cblx0XHRcdFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdHMtbGlzdFwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWl0ZW1cIj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pY29uXCI+XHUyNkExPC9zcGFuPlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJlbmVmaXQtY29udGVudFwiPlxuXHRcdFx0XHRcdFx0PHN0cm9uZz5FYXJseSBBY2Nlc3M8L3N0cm9uZz5cblx0XHRcdFx0XHRcdDxzcGFuPkdldCBuZXcgZmVhdHVyZXMgMi00IG1vbnRocyBiZWZvcmUgZ2VuZXJhbCByZWxlYXNlPC9zcGFuPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pdGVtXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWJlbmVmaXQtaWNvblwiPlx1RDgzRFx1RENBQzwvc3Bhbj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWNvbnRlbnRcIj5cblx0XHRcdFx0XHRcdDxzdHJvbmc+UHJpb3JpdHkgU3VwcG9ydDwvc3Ryb25nPlxuXHRcdFx0XHRcdFx0PHNwYW4+RGlyZWN0IGFjY2VzcyB0byBkZXZlbG9wZXJzIGZvciBmZWF0dXJlIHJlcXVlc3RzIGFuZCBidWcgcmVwb3J0czwvc3Bhbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJlbmVmaXQtaXRlbVwiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1iZW5lZml0LWljb25cIj5cdUQ4M0RcdURERjNcdUZFMEY8L3NwYW4+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHQ8c3Ryb25nPlZvdGUgb24gRmVhdHVyZXM8L3N0cm9uZz5cblx0XHRcdFx0XHRcdDxzcGFuPkhlbHAgc2hhcGUgTm92YSdzIGRldmVsb3BtZW50IGFuZCBmdXR1cmUgZGlyZWN0aW9uPC9zcGFuPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1pdGVtXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWJlbmVmaXQtaWNvblwiPlx1RDgzQ1x1REZDNjwvc3Bhbj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1iZW5lZml0LWNvbnRlbnRcIj5cblx0XHRcdFx0XHRcdDxzdHJvbmc+U3VwcG9ydGVyIEJhZGdlPC9zdHJvbmc+XG5cdFx0XHRcdFx0XHQ8c3Bhbj5SZWNvZ25pdGlvbiBpbiB0aGUgTm92YSBjb21tdW5pdHkgKGNvbWluZyBzb29uKTwvc3Bhbj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWJlbmVmaXQtaXRlbVwiPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1iZW5lZml0LWljb25cIj5cdTI3NjRcdUZFMEY8L3NwYW4+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYmVuZWZpdC1jb250ZW50XCI+XG5cdFx0XHRcdFx0XHQ8c3Ryb25nPk9wZW4gU291cmNlIFN1cHBvcnQ8L3N0cm9uZz5cblx0XHRcdFx0XHRcdDxzcGFuPkRpcmVjdGx5IGZ1bmQgY29udGludWVkIGRldmVsb3BtZW50IG9mIE5vdmE8L3NwYW4+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHRcblx0XHRcdDxwIHN0eWxlPVwibWFyZ2luLXRvcDogMjBweDsgZm9udC1zaXplOiAwLjllbTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1wiPllvdXIgc3VwcG9ydCBrZWVwcyBOb3ZhIGZyZWUgYW5kIG9wZW4gc291cmNlIGZvciBldmVyeW9uZS48L3A+XG5cdFx0YDtcblx0XHRcblx0XHQvLyBMaWNlbnNlIHNldHRpbmdzIHNlY3Rpb24gLSBzdHlsZWQgbGlrZSBBUEkga2V5c1xuXHRcdGNvbnN0IGxpY2Vuc2VTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0bGljZW5zZVNlY3Rpb24uc3R5bGUubWFyZ2luVG9wID0gJzMycHgnO1xuXHRcdGxpY2Vuc2VTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0xpY2Vuc2UgTWFuYWdlbWVudCcgfSk7XG5cdFx0XG5cdFx0dGhpcy5jcmVhdGVTdXBlcm5vdmFMaWNlbnNlSW5wdXQobGljZW5zZVNlY3Rpb24pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1RhYkNvbnRlbnQoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdC8vIERlYnVnIFNldHRpbmdzIFNlY3Rpb25cblx0XHRjb25zdCBkZWJ1Z1NlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kZWJ1Zy1zZWN0aW9uJyB9KTtcblx0XHRkZWJ1Z1NlY3Rpb24uY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnRGVidWcgU2V0dGluZ3MnIH0pO1xuXHRcdGRlYnVnU2VjdGlvbi5jcmVhdGVFbCgnaHInLCB7IGNsczogJ25vdmEtc2VjdGlvbi1kaXZpZGVyJyB9KTtcblx0XHRcblx0XHRjb25zdCBpbmZvRWwgPSBkZWJ1Z1NlY3Rpb24uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kZWJ1Zy1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxwPkRlYnVnIHNldHRpbmdzIGZvciBkZXZlbG9wbWVudCBhbmQgdGVzdGluZy4gVGhlc2Ugb3B0aW9ucyBoZWxwIGRldmVsb3BlcnMgdHJvdWJsZXNob290IGlzc3VlcyBhbmQgdGVzdCBuZXcgZmVhdHVyZXMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0Plx1MjZBMFx1RkUwRiBEZXZlbG9wZXIgU2V0dGluZ3M8L2g0PlxuXHRcdFx0XHQ8dWwgY2xhc3M9XCJub3ZhLWRlYnVnLWZlYXR1cmVzXCI+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+RGVidWcgTW9kZTwvc3Ryb25nPiAtIEVuYWJsZSBkZXRhaWxlZCBsb2dnaW5nIGFuZCBkZXZlbG9wbWVudCBmZWF0dXJlczwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+T3ZlcnJpZGUgRGF0ZTwvc3Ryb25nPiAtIFRlc3QgdGltZS1zZW5zaXRpdmUgZmVhdHVyZXMgd2l0aCBjdXN0b20gZGF0ZXM8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkZvcmNlIFN1cGVybm92YTwvc3Ryb25nPiAtIFRlc3QgU3VwZXJub3ZhLW9ubHkgZmVhdHVyZXMgd2l0aG91dCBhIGxpY2Vuc2U8L2xpPlxuXHRcdFx0XHQ8L3VsPlxuXHRcdFx0XHQ8cCBjbGFzcz1cIm5vdmEtZGVidWctbm90ZVwiPk9ubHkgbW9kaWZ5IHRoZXNlIHNldHRpbmdzIGlmIHlvdSB1bmRlcnN0YW5kIHRoZWlyIHB1cnBvc2UuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHR0aGlzLmNyZWF0ZURlYnVnU2V0dGluZ3MoZGVidWdTZWN0aW9uKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlUHJpdmFjeVNldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHQvLyBQcml2YWN5ICYgUGxhdGZvcm0gU2VjdGlvblxuXHRcdGNvbnN0IHByaXZhY3lTZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJpdmFjeS1zZWN0aW9uJyB9KTtcblx0XHRwcml2YWN5U2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdQcml2YWN5ICYgUGxhdGZvcm0gU2V0dGluZ3MnIH0pO1xuXHRcdHByaXZhY3lTZWN0aW9uLmNyZWF0ZUVsKCdocicsIHsgY2xzOiAnbm92YS1zZWN0aW9uLWRpdmlkZXInIH0pO1xuXHRcdFxuXHRcdGNvbnN0IGluZm9FbCA9IHByaXZhY3lTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJpdmFjeS1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5cdUQ4M0RcdUREMTIgWW91ciBQcml2YWN5IE1hdHRlcnM8L2g0PlxuXHRcdFx0XHQ8cD5Ob3ZhIHJlc3BlY3RzIHlvdXIgcHJpdmFjeSBhbmQgZ2l2ZXMgeW91IGZ1bGwgY29udHJvbCBvdmVyIGhvdyB5b3VyIGRhdGEgaXMgaGFuZGxlZC4gXG5cdFx0XHRcdEFsbCBBSSBwcm92aWRlcnMgYXJlIGFjY2Vzc2VkIHVzaW5nIHlvdXIgb3duIEFQSSBrZXlzLCBzbyB5b3VyIGNvbnRlbnQgc3RheXMgYmV0d2VlbiB5b3UgYW5kIHlvdXIgY2hvc2VuIEFJIHNlcnZpY2UuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmRcIj5cblx0XHRcdFx0PGg0Plx1RDgzRFx1RENGMSBNb2JpbGUgU3VwcG9ydDwvaDQ+XG5cdFx0XHRcdDxwPk1vYmlsZSBzdXBwb3J0IGlzIGRpc2FibGVkIGJ5IGRlZmF1bHQgdG8gcHJvdGVjdCB5b3VyIHByaXZhY3kuIFdoZW4gZW5hYmxlZCwgTm92YSBwcm92aWRlcyBpZGVudGljYWwgc2VsZWN0aW9uLWJhc2VkIGVkaXRpbmcgY2FwYWJpbGl0aWVzIGFjcm9zcyBkZXNrdG9wIGFuZCBtb2JpbGUgd2l0aCBjbG91ZC1iYXNlZCBBSSBwcm92aWRlcnMuPC9wPlxuXHRcdFx0XHQ8dWwgY2xhc3M9XCJub3ZhLXByaXZhY3ktZmVhdHVyZXNcIj5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5Mb2NhbC1maXJzdDwvc3Ryb25nPiAtIE9sbGFtYSBhbmQgZGVza3RvcC1vbmx5IHByb3ZpZGVycyBrZWVwIGV2ZXJ5dGhpbmcgb24geW91ciBkZXZpY2U8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPllvdXIgY2hvaWNlPC9zdHJvbmc+IC0gRW5hYmxlIG1vYmlsZSBvbmx5IHdoZW4geW91IG5lZWQgY3Jvc3MtZGV2aWNlIGFjY2VzczwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+Q3Jvc3MtcGxhdGZvcm0gZWRpdGluZzwvc3Ryb25nPiAtIFNlbGVjdGlvbi1iYXNlZCBlZGl0aW5nIHdvcmtzIGlkZW50aWNhbGx5IG9uIG1vYmlsZSB2aWEgQ29tbWFuZCBQYWxldHRlIChDbWQrUCk8L2xpPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPlNhbWUgZXhwZXJpZW5jZTwvc3Ryb25nPiAtIE1vYmlsZSBwcm92aWRlcyB0aGUgc2FtZSBlZGl0aW5nIGNhcGFiaWxpdGllcyBhcyBkZXNrdG9wPC9saT5cblx0XHRcdFx0PC91bD5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cdFx0XG5cdFx0Ly8gTW9iaWxlIFN1cHBvcnQgVG9nZ2xlXG5cdFx0bmV3IFNldHRpbmcocHJpdmFjeVNlY3Rpb24pXG5cdFx0XHQuc2V0TmFtZSgnRW5hYmxlIE1vYmlsZSBTdXBwb3J0Jylcblx0XHRcdC5zZXREZXNjKCdBbGxvdyBOb3ZhIHRvIHdvcmsgb24gbW9iaWxlIGRldmljZXMgdXNpbmcgY2xvdWQtYmFzZWQgQUkgcHJvdmlkZXJzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHtcblx0XHRcdFx0Y29uc3QgY3VycmVudE1vYmlsZU1vZGVsID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUuc2VsZWN0ZWRNb2RlbDtcblx0XHRcdFx0Y29uc3QgaXNNb2JpbGVFbmFibGVkID0gY3VycmVudE1vYmlsZU1vZGVsICE9PSAnbm9uZScgJiYgY3VycmVudE1vYmlsZU1vZGVsICE9PSAnJztcblx0XHRcdFx0XG5cdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZShpc01vYmlsZUVuYWJsZWQpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEVuYWJsZSBtb2JpbGUgd2l0aCBDbGF1ZGUgYXMgZGVmYXVsdCAobW9zdCByZWxpYWJsZSlcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUuc2VsZWN0ZWRNb2RlbCA9ICcnO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gRGlzYWJsZSBtb2JpbGVcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5ncy5tb2JpbGUuc2VsZWN0ZWRNb2RlbCA9ICdub25lJztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLnVwZGF0ZVNldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTZWN1cmVBcGlLZXlJbnB1dChjb250YWluZXI6IEhUTUxFbGVtZW50LCBvcHRpb25zOiB7XG5cdFx0bmFtZTogc3RyaW5nO1xuXHRcdGRlc2M6IHN0cmluZztcblx0XHRwbGFjZWhvbGRlcjogc3RyaW5nO1xuXHRcdHZhbHVlOiBzdHJpbmc7XG5cdFx0b25DaGFuZ2U6ICh2YWx1ZTogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuXHR9KTogdm9pZCB7XG5cdFx0Y29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKG9wdGlvbnMubmFtZSlcblx0XHRcdC5zZXREZXNjKG9wdGlvbnMuZGVzYyk7XG5cblx0XHRsZXQgYWN0dWFsVmFsdWUgPSBvcHRpb25zLnZhbHVlO1xuXHRcdGxldCBpc1Zpc2libGUgPSBmYWxzZTtcblxuXHRcdHNldHRpbmcuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3Bhc3N3b3JkJztcblx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS5mb250RmFtaWx5ID0gJ3ZhcigtLWZvbnQtbW9ub3NwYWNlKSc7XG5cdFx0XHR0ZXh0LmlucHV0RWwuc3R5bGUud2lkdGggPSAnNDAwcHgnO1xuXHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLmhlaWdodCA9ICc0MHB4Jztcblx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0XHR0ZXh0LnNldFBsYWNlaG9sZGVyKG9wdGlvbnMucGxhY2Vob2xkZXIpO1xuXG5cdFx0XHQvLyBTZXQgaW5pdGlhbCBkaXNwbGF5IHZhbHVlXG5cdFx0XHRpZiAoYWN0dWFsVmFsdWUgJiYgYWN0dWFsVmFsdWUubGVuZ3RoID4gMTIpIHtcblx0XHRcdFx0Y29uc3QgbWFza2VkID0gYWN0dWFsVmFsdWUuc2xpY2UoMCwgOCkgKyAnXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyXHUyMDIyJyArIGFjdHVhbFZhbHVlLnNsaWNlKC00KTtcblx0XHRcdFx0dGV4dC5zZXRWYWx1ZShtYXNrZWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGV4dC5zZXRWYWx1ZShhY3R1YWxWYWx1ZSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENyZWF0ZSB0b2dnbGUgYnV0dG9uXG5cdFx0XHRjb25zdCBpbnB1dENvbnRhaW5lciA9IHRleHQuaW5wdXRFbC5wYXJlbnRFbGVtZW50O1xuXHRcdFx0aWYgKGlucHV0Q29udGFpbmVyKSB7XG5cdFx0XHRcdGlucHV0Q29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnN0IHRvZ2dsZUJ0biA9IGlucHV0Q29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ25vdmEtdG9nZ2xlLWJ0bicgfSk7XG5cdFx0XHRcdHRvZ2dsZUJ0bi5pbm5lckhUTUwgPSBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCI+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xIDEyczQtOCAxMS04IDExIDggMTEgOC00IDgtMTEgOC0xMS04LTExLTh6XCIvPlxuXHRcdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiM1wiLz5cblx0XHRcdFx0PC9zdmc+YDtcblxuXHRcdFx0XHR0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRpc1Zpc2libGUgPSAhaXNWaXNpYmxlO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChpc1Zpc2libGUpIHtcblx0XHRcdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3RleHQnO1xuXHRcdFx0XHRcdFx0dGV4dC5zZXRWYWx1ZShhY3R1YWxWYWx1ZSk7XG5cdFx0XHRcdFx0XHR0b2dnbGVCdG4uaW5uZXJIVE1MID0gYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiPlxuXHRcdFx0XHRcdFx0XHQ8cGF0aCBkPVwibTkuODggOS44OGEzIDMgMCAxIDAgNC4yNCA0LjI0XCIvPlxuXHRcdFx0XHRcdFx0XHQ8cGF0aCBkPVwibTEwLjczIDUuMDhhMTAuNDMgMTAuNDMgMCAwIDEgMS4yNy0uMDhjNyAwIDExIDggMTEgOGExMy4xNiAxMy4xNiAwIDAgMS0xLjY3IDIuNjhcIi8+XG5cdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNNi42MSA2LjYxQTEzLjUyNiAxMy41MjYgMCAwIDAgMSAxMnM0IDggMTEgOGE5Ljc0IDkuNzQgMCAwIDAgNS4zOS0xLjYxXCIvPlxuXHRcdFx0XHRcdFx0XHQ8bGluZSB4MT1cIjJcIiB5MT1cIjJcIiB4Mj1cIjIyXCIgeTI9XCIyMlwiLz5cblx0XHRcdFx0XHRcdDwvc3ZnPmA7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ3Bhc3N3b3JkJztcblx0XHRcdFx0XHRcdGlmIChhY3R1YWxWYWx1ZSAmJiBhY3R1YWxWYWx1ZS5sZW5ndGggPiAxMikge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBtYXNrZWQgPSBhY3R1YWxWYWx1ZS5zbGljZSgwLCA4KSArICdcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjJcdTIwMjInICsgYWN0dWFsVmFsdWUuc2xpY2UoLTQpO1xuXHRcdFx0XHRcdFx0XHR0ZXh0LnNldFZhbHVlKG1hc2tlZCk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0ZXh0LnNldFZhbHVlKGFjdHVhbFZhbHVlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHRvZ2dsZUJ0bi5pbm5lckhUTUwgPSBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCI+XG5cdFx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJNMSAxMnM0LTggMTEtOCAxMSA4IDExIDgtNCA4LTExIDgtMTEtOC0xMS04elwiLz5cblx0XHRcdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIzXCIvPlxuXHRcdFx0XHRcdFx0PC9zdmc+YDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBIYW5kbGUgdmFsdWUgY2hhbmdlc1xuXHRcdFx0dGV4dC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0YWN0dWFsVmFsdWUgPSB2YWx1ZTtcblx0XHRcdFx0YXdhaXQgb3B0aW9ucy5vbkNoYW5nZSh2YWx1ZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIHRleHQ7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGNyZWF0ZVByb3ZpZGVyU3RhdHVzSW5kaWNhdG9yKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHByb3ZpZGVyOiAnY2xhdWRlJyB8ICdvcGVuYWknIHwgJ2dvb2dsZScgfCAnb2xsYW1hJyk6IEhUTUxFbGVtZW50IHtcblx0XHRjb25zdCBzdGF0dXNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zdGF0dXMtY29udGFpbmVyJyB9KTtcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc3RhdHVzID0gdGhpcy5nZXRQcm92aWRlclN0YXR1cyhwcm92aWRlcik7XG5cdFx0XHRjb25zdCBzdGF0dXNFbCA9IHN0YXR1c0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGBub3ZhLXByb3ZpZGVyLXN0YXR1cyAke3N0YXR1cy5zdGF0dXN9YCB9KTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RhdHVzIGRvdFxuXHRcdFx0Y29uc3QgZG90ID0gc3RhdHVzRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtc3RhdHVzLWRvdCcgfSk7XG5cdFx0XHRcblx0XHRcdC8vIFN0YXR1cyB0ZXh0XG5cdFx0XHRjb25zdCB0ZXh0ID0gc3RhdHVzRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtc3RhdHVzLXRleHQnIH0pO1xuXHRcdFx0dGV4dC50ZXh0Q29udGVudCA9IHRoaXMuZ2V0U3RhdHVzRGlzcGxheVRleHQoc3RhdHVzKTtcblx0XHRcdFxuXHRcdFx0Ly8gVG9vbHRpcCB3aXRoIGRldGFpbHNcblx0XHRcdGlmIChzdGF0dXMubGFzdENoZWNrZWQgfHwgc3RhdHVzLm1lc3NhZ2UpIHtcblx0XHRcdFx0Y29uc3QgdG9vbHRpcCA9IHN0YXR1c0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtc3RhdHVzLXRvb2x0aXAnIH0pO1xuXHRcdFx0XHRpZiAoc3RhdHVzLmxhc3RDaGVja2VkKSB7XG5cdFx0XHRcdFx0Y29uc3QgdGltZUVsID0gdG9vbHRpcC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy10aW1lJyB9KTtcblx0XHRcdFx0XHRjb25zdCBkYXRlID0gc3RhdHVzLmxhc3RDaGVja2VkIGluc3RhbmNlb2YgRGF0ZSA/IHN0YXR1cy5sYXN0Q2hlY2tlZCA6IG5ldyBEYXRlKHN0YXR1cy5sYXN0Q2hlY2tlZCk7XG5cdFx0XHRcdFx0dGltZUVsLnRleHRDb250ZW50ID0gYExhc3QgY2hlY2tlZDogJHtkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfWA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHN0YXR1cy5tZXNzYWdlKSB7XG5cdFx0XHRcdFx0Y29uc3QgbWVzc2FnZUVsID0gdG9vbHRpcC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy1tZXNzYWdlJyB9KTtcblx0XHRcdFx0XHRtZXNzYWdlRWwudGV4dENvbnRlbnQgPSBzdGF0dXMubWVzc2FnZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBwcm92aWRlciBzdGF0dXMgaW5kaWNhdG9yOicsIGVycm9yKTtcblx0XHRcdC8vIEZhbGxiYWNrOiBjcmVhdGUgYSBzaW1wbGUgc3RhdHVzIGluZGljYXRvclxuXHRcdFx0Y29uc3Qgc3RhdHVzRWwgPSBzdGF0dXNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zdGF0dXMgdW50ZXN0ZWQnIH0pO1xuXHRcdFx0Y29uc3QgZG90ID0gc3RhdHVzRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtc3RhdHVzLWRvdCcgfSk7XG5cdFx0XHRjb25zdCB0ZXh0ID0gc3RhdHVzRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtc3RhdHVzLXRleHQnIH0pO1xuXHRcdFx0dGV4dC50ZXh0Q29udGVudCA9ICdTdGF0dXMgdW5rbm93bic7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBzdGF0dXNDb250YWluZXI7XG5cdH1cblxuXHRwcml2YXRlIGdldFByb3ZpZGVyU3RhdHVzKHByb3ZpZGVyOiAnY2xhdWRlJyB8ICdvcGVuYWknIHwgJ2dvb2dsZScgfCAnb2xsYW1hJyk6IHsgc3RhdHVzOiBzdHJpbmcsIG1lc3NhZ2U/OiBzdHJpbmcsIGxhc3RDaGVja2VkPzogRGF0ZSB8IHN0cmluZyB8IG51bGwgfSB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHNhdmVkU3RhdHVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXJTdGF0dXM/Lltwcm92aWRlcl07XG5cdFx0XHRpZiAoc2F2ZWRTdGF0dXMpIHtcblx0XHRcdFx0cmV0dXJuIHNhdmVkU3RhdHVzO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBEZXRlcm1pbmUgaW5pdGlhbCBzdGF0dXMgYmFzZWQgb24gY29uZmlndXJhdGlvblxuXHRcdFx0Y29uc3QgaGFzQ29uZmlnID0gdGhpcy5oYXNQcm92aWRlckNvbmZpZyhwcm92aWRlcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdGF0dXM6IGhhc0NvbmZpZyA/ICd1bnRlc3RlZCcgOiAnbm90LWNvbmZpZ3VyZWQnLFxuXHRcdFx0XHRtZXNzYWdlOiBoYXNDb25maWcgPyAnQ29uZmlndXJhdGlvbiBub3QgdGVzdGVkJyA6ICdObyBBUEkga2V5IGNvbmZpZ3VyZWQnLFxuXHRcdFx0XHRsYXN0Q2hlY2tlZDogbnVsbFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgRXJyb3IgZ2V0dGluZyBwcm92aWRlciBzdGF0dXMgZm9yICR7cHJvdmlkZXJ9OmAsIGVycm9yKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHN0YXR1czogJ25vdC1jb25maWd1cmVkJyxcblx0XHRcdFx0bWVzc2FnZTogJ1N0YXR1cyB1bmF2YWlsYWJsZScsXG5cdFx0XHRcdGxhc3RDaGVja2VkOiBudWxsXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgZ2V0U3RhdHVzRGlzcGxheVRleHQoc3RhdHVzOiB7IHN0YXR1czogc3RyaW5nLCBtZXNzYWdlPzogc3RyaW5nIH0pOiBzdHJpbmcge1xuXHRcdHN3aXRjaCAoc3RhdHVzLnN0YXR1cykge1xuXHRcdFx0Y2FzZSAnY29ubmVjdGVkJzogcmV0dXJuICdDb25uZWN0ZWQnO1xuXHRcdFx0Y2FzZSAnZXJyb3InOiByZXR1cm4gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdGNhc2UgJ25vdC1jb25maWd1cmVkJzogcmV0dXJuICdOb3QgY29uZmlndXJlZCc7XG5cdFx0XHRjYXNlICd1bnRlc3RlZCc6IHJldHVybiAnVW50ZXN0ZWQnO1xuXHRcdFx0Y2FzZSAndGVzdGluZyc6IHJldHVybiAnVGVzdGluZy4uLic7XG5cdFx0XHRkZWZhdWx0OiByZXR1cm4gJ1Vua25vd24nO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlVGVzdENvbm5lY3Rpb25CdXR0b24oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogdm9pZCB7XG5cdFx0Y29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdDb25uZWN0aW9uIFN0YXR1cycpXG5cdFx0XHQuc2V0RGVzYygnVGVzdCB5b3VyIEFQSSBjb25uZWN0aW9uJyk7XG5cblx0XHQvLyBDcmVhdGUgc3RhdHVzIGluZGljYXRvciBmaXJzdCAodG8gdGhlIGxlZnQpXG5cdFx0Y29uc3Qgc3RhdHVzQ29udGFpbmVyID0gc2V0dGluZy5jb250cm9sRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb25uZWN0aW9uLXN0YXR1cy1jb250YWluZXInIH0pO1xuXHRcdFxuXHRcdHNldHRpbmcuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XG5cdFx0XHRidXR0b24uc2V0QnV0dG9uVGV4dCgnVGVzdCBDb25uZWN0aW9uJylcblx0XHRcdFx0LnNldFRvb2x0aXAoYFRlc3QgJHtwcm92aWRlcn0gY29ubmVjdGlvbmApXG5cdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnRlc3RQcm92aWRlckNvbm5lY3Rpb24ocHJvdmlkZXIsIGJ1dHRvbi5idXR0b25FbCwgc3RhdHVzQ29udGFpbmVyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRidXR0b24uYnV0dG9uRWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgYFRlc3QgJHt0aGlzLmdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXIpfSBjb25uZWN0aW9uYCk7XG5cdFx0XHRyZXR1cm4gYnV0dG9uO1xuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIFNob3cgaW5pdGlhbCBzdGF0dXMgaWYgd2UgaGF2ZSBpdFxuXHRcdHRoaXMudXBkYXRlQ29ubmVjdGlvblN0YXR1cyhzdGF0dXNDb250YWluZXIsIHByb3ZpZGVyKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgdGVzdFByb3ZpZGVyQ29ubmVjdGlvbihwcm92aWRlcjogJ2NsYXVkZScgfCAnb3BlbmFpJyB8ICdnb29nbGUnIHwgJ29sbGFtYScsIGJ1dHRvbkVsOiBIVE1MRWxlbWVudCwgc3RhdHVzQ29udGFpbmVyOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IG9yaWdpbmFsVGV4dCA9IGJ1dHRvbkVsLnRleHRDb250ZW50IHx8ICdUZXN0IENvbm5lY3Rpb24nO1xuXHRcdGNvbnN0IGJ1dHRvbiA9IGJ1dHRvbkVsIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXHRcdFxuXHRcdC8vIEZvcmNlIGVuYWJsZSBhbmQgc2V0IGluaXRpYWwgc3RhdGVcblx0XHRidXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRidXR0b24udGV4dENvbnRlbnQgPSAnVGVzdGluZy4uLic7XG5cdFx0YnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMC42Jztcblx0XHRcblx0XHQvLyBVcGRhdGUgcHJvdmlkZXIgc3RhdHVzIHRvIHRlc3Rpbmdcblx0XHRhd2FpdCB0aGlzLnVwZGF0ZVByb3ZpZGVyU3RhdHVzKHByb3ZpZGVyLCAndGVzdGluZycsICdUZXN0aW5nIGNvbm5lY3Rpb24uLi4nKTtcblx0XHRcblx0XHQvLyBTaG93IHRlc3Rpbmcgc3RhdHVzXG5cdFx0dGhpcy5zZXRDb25uZWN0aW9uU3RhdHVzKHN0YXR1c0NvbnRhaW5lciwgJ3Rlc3RpbmcnLCAnVGVzdGluZy4uLicpO1xuXHRcdFxuXHRcdC8vIFVzZSBhIGJhY2t1cCB0aW1lciB0byBlbnN1cmUgYnV0dG9uIGdldHMgcmVzdG9yZWRcblx0XHRjb25zdCByZXN0b3JlQnV0dG9uID0gKCkgPT4ge1xuXHRcdFx0YnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHRidXR0b24udGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQ7XG5cdFx0XHRidXR0b24uc3R5bGUub3BhY2l0eSA9ICcxJztcblx0XHR9O1xuXHRcdFxuXHRcdGNvbnN0IGJhY2t1cFRpbWVyID0gc2V0VGltZW91dChyZXN0b3JlQnV0dG9uLCAxMjAwMCk7IC8vIDEyIHNlY29uZCBiYWNrdXBcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gQ2hlY2sgYmFzaWMgY29uZmlndXJhdGlvbiBmaXJzdFxuXHRcdFx0Y29uc3QgaGFzQ29uZmlnID0gdGhpcy5oYXNQcm92aWRlckNvbmZpZyhwcm92aWRlcik7XG5cdFx0XHRpZiAoIWhhc0NvbmZpZykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZpZGVyIG5vdCBjb25maWd1cmVkIC0gbWlzc2luZyBBUEkga2V5IG9yIHNldHRpbmdzJyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNldCB0aW1lb3V0IGZvciAxMCBzZWNvbmRzXG5cdFx0XHRjb25zdCB0aW1lb3V0UHJvbWlzZSA9IG5ldyBQcm9taXNlPG5ldmVyPigoXywgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcignQ29ubmVjdGlvbiB0aW1lb3V0JykpLCAxMDAwMCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gVGVzdCB0aGUgY29ubmVjdGlvbiB1c2luZyB0aGUgcGx1Z2luJ3MgcHJvdmlkZXIgc3lzdGVtXG5cdFx0XHRjb25zdCB0ZXN0UHJvbWlzZSA9IHRoaXMucGVyZm9ybVJlYWxDb25uZWN0aW9uVGVzdChwcm92aWRlcik7XG5cdFx0XHRcblx0XHRcdGF3YWl0IFByb21pc2UucmFjZShbdGVzdFByb21pc2UsIHRpbWVvdXRQcm9taXNlXSk7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBwcm92aWRlciBzdGF0dXMgdG8gY29ubmVjdGVkXG5cdFx0XHRhd2FpdCB0aGlzLnVwZGF0ZVByb3ZpZGVyU3RhdHVzKHByb3ZpZGVyLCAnY29ubmVjdGVkJywgJ0Nvbm5lY3RlZCBzdWNjZXNzZnVsbHknKTtcblx0XHRcdHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cyhzdGF0dXNDb250YWluZXIsICdzdWNjZXNzJywgJ1x1MjVDRiBDb25uZWN0ZWQnKTtcblx0XHRcdFxuXHRcdFx0Ly8gRm9yIE9sbGFtYSwgaWYgYSBtb2RlbCBpcyBjb25maWd1cmVkLCBhdXRvbWF0aWNhbGx5IHNlbGVjdCBpdFxuXHRcdFx0aWYgKHByb3ZpZGVyID09PSAnb2xsYW1hJyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEubW9kZWwpIHtcblx0XHRcdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5zZWxlY3RlZE1vZGVsID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLm1vZGVsO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gRW1pdCBldmVudCB0byBub3RpZnkgc2lkZWJhciBvZiBwcm92aWRlciBjb25maWd1cmF0aW9uXG5cdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnbm92YS1wcm92aWRlci1jb25maWd1cmVkJywgeyBcblx0XHRcdFx0ZGV0YWlsOiB7IHByb3ZpZGVyLCBzdGF0dXM6ICdjb25uZWN0ZWQnIH0gXG5cdFx0XHR9KSk7XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcjogYW55KSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKGBDb25uZWN0aW9uIHRlc3QgZmFpbGVkIGZvciAke3Byb3ZpZGVyfTpgLCBlcnJvcik7XG5cdFx0XHRsZXQgZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdFxuXHRcdFx0aWYgKGVycm9yLm1lc3NhZ2UgPT09ICdDb25uZWN0aW9uIHRpbWVvdXQnKSB7XG5cdFx0XHRcdGVycm9yTWVzc2FnZSA9ICdUaW1lb3V0Jztcblx0XHRcdH0gZWxzZSBpZiAocHJvdmlkZXIgPT09ICdvbGxhbWEnKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIFVSTCBpcyBhY3R1YWxseSBjb25maWd1cmVkXG5cdFx0XHRcdGNvbnN0IG9sbGFtYVVybCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5iYXNlVXJsO1xuXHRcdFx0XHRpZiAoIW9sbGFtYVVybCB8fCBvbGxhbWFVcmwudHJpbSgpID09PSAnJykge1xuXHRcdFx0XHRcdGVycm9yTWVzc2FnZSA9ICdObyBVUkwgY29uZmlndXJlZCc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygnNDAxJykgfHwgZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ3VuYXV0aG9yaXplZCcpIHx8IGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCdBUEkga2V5JykpIHtcblx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ0ludmFsaWQgQVBJIGtleSc7XG5cdFx0XHR9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MjknKSkge1xuXHRcdFx0XHRlcnJvck1lc3NhZ2UgPSAnUmF0ZSBsaW1pdGVkJztcblx0XHRcdH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ3F1b3RhJykpIHtcblx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ1F1b3RhIGV4Y2VlZGVkJztcblx0XHRcdH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ25vdCBjb25maWd1cmVkJykgfHwgZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ21pc3NpbmcnKSkge1xuXHRcdFx0XHRlcnJvck1lc3NhZ2UgPSAnTm90IGNvbmZpZ3VyZWQnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gJ0Nvbm5lY3Rpb24gZmFpbGVkJztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIHByb3ZpZGVyIHN0YXR1cyB0byBlcnJvclxuXHRcdFx0YXdhaXQgdGhpcy51cGRhdGVQcm92aWRlclN0YXR1cyhwcm92aWRlciwgJ2Vycm9yJywgZXJyb3JNZXNzYWdlKTtcblx0XHRcdHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cyhzdGF0dXNDb250YWluZXIsICdlcnJvcicsIGBcdTI1Q0YgJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0XHRcblx0XHRcdC8vIEVtaXQgZXZlbnQgdG8gbm90aWZ5IHNpZGViYXIgdGhhdCBwcm92aWRlciBoYXMgZmFpbGVkXG5cdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnbm92YS1wcm92aWRlci1kaXNjb25uZWN0ZWQnLCB7IFxuXHRcdFx0XHRkZXRhaWw6IHsgcHJvdmlkZXIsIHN0YXR1czogJ2Vycm9yJywgbWVzc2FnZTogZXJyb3JNZXNzYWdlIH0gXG5cdFx0XHR9KSk7XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdC8vIENsZWFyIGJhY2t1cCB0aW1lciBhbmQgcmVzdG9yZSBidXR0b25cblx0XHRcdGNsZWFyVGltZW91dChiYWNrdXBUaW1lcik7XG5cdFx0XHRyZXN0b3JlQnV0dG9uKCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyB1cGRhdGVQcm92aWRlclN0YXR1cyhwcm92aWRlcjogJ2NsYXVkZScgfCAnb3BlbmFpJyB8ICdnb29nbGUnIHwgJ29sbGFtYScsIHN0YXR1czogJ2Nvbm5lY3RlZCcgfCAnZXJyb3InIHwgJ25vdC1jb25maWd1cmVkJyB8ICd1bnRlc3RlZCcgfCAndGVzdGluZycsIG1lc3NhZ2U/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLnByb3ZpZGVyU3RhdHVzKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1cyA9IHt9O1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1c1twcm92aWRlcl0gPSB7XG5cdFx0XHRzdGF0dXMsXG5cdFx0XHRtZXNzYWdlLFxuXHRcdFx0bGFzdENoZWNrZWQ6IHN0YXR1cyA9PT0gJ3Rlc3RpbmcnID8gbnVsbCA6IG5ldyBEYXRlKClcblx0XHR9O1xuXHRcdFxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFxuXHRcdC8vIFJlZnJlc2ggdGhlIHN0YXR1cyBpbmRpY2F0b3JzIGlmIG5lZWRlZFxuXHRcdHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzSW5kaWNhdG9ycygpO1xuXHR9XG5cblx0cHJpdmF0ZSByZWZyZXNoUHJvdmlkZXJTdGF0dXNJbmRpY2F0b3JzKCk6IHZvaWQge1xuXHRcdC8vIEZpbmQgYWxsIHByb3ZpZGVyIHN0YXR1cyBjb250YWluZXJzIGFuZCB1cGRhdGUgdGhlbVxuXHRcdGNvbnN0IGNvbnRhaW5lcnMgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3ZhLXByb3ZpZGVyLXN0YXR1cy1jb250YWluZXInKTtcblx0XHRjb250YWluZXJzLmZvckVhY2goY29udGFpbmVyID0+IHtcblx0XHRcdGNvbnN0IHByb3ZpZGVyID0gY29udGFpbmVyLmdldEF0dHJpYnV0ZSgnZGF0YS1wcm92aWRlcicpIGFzICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnO1xuXHRcdFx0aWYgKHByb3ZpZGVyKSB7XG5cdFx0XHRcdHRoaXMudXBkYXRlUHJvdmlkZXJTdGF0dXNEaXNwbGF5KGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudCwgcHJvdmlkZXIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVQcm92aWRlclN0YXR1c0Rpc3BsYXkoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogdm9pZCB7XG5cdFx0Y29uc3Qgc3RhdHVzID0gdGhpcy5nZXRQcm92aWRlclN0YXR1cyhwcm92aWRlcik7XG5cdFx0Y29uc3Qgc3RhdHVzRWwgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtcHJvdmlkZXItc3RhdHVzJyk7XG5cdFx0XG5cdFx0aWYgKHN0YXR1c0VsKSB7XG5cdFx0XHRzdGF0dXNFbC5jbGFzc05hbWUgPSBgbm92YS1wcm92aWRlci1zdGF0dXMgJHtzdGF0dXMuc3RhdHVzfWA7XG5cdFx0XHRjb25zdCB0ZXh0RWwgPSBzdGF0dXNFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1zdGF0dXMtdGV4dCcpO1xuXHRcdFx0aWYgKHRleHRFbCkge1xuXHRcdFx0XHR0ZXh0RWwudGV4dENvbnRlbnQgPSB0aGlzLmdldFN0YXR1c0Rpc3BsYXlUZXh0KHN0YXR1cyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSB0b29sdGlwXG5cdFx0XHRsZXQgdG9vbHRpcCA9IHN0YXR1c0VsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXN0YXR1cy10b29sdGlwJyk7XG5cdFx0XHRpZiAoc3RhdHVzLmxhc3RDaGVja2VkIHx8IHN0YXR1cy5tZXNzYWdlKSB7XG5cdFx0XHRcdGlmICghdG9vbHRpcCkge1xuXHRcdFx0XHRcdHRvb2x0aXAgPSBzdGF0dXNFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy10b29sdGlwJyB9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0b29sdGlwLmVtcHR5KCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoc3RhdHVzLmxhc3RDaGVja2VkKSB7XG5cdFx0XHRcdFx0Y29uc3QgdGltZUVsID0gdG9vbHRpcC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy10aW1lJyB9KTtcblx0XHRcdFx0XHRjb25zdCBkYXRlID0gc3RhdHVzLmxhc3RDaGVja2VkIGluc3RhbmNlb2YgRGF0ZSA/IHN0YXR1cy5sYXN0Q2hlY2tlZCA6IG5ldyBEYXRlKHN0YXR1cy5sYXN0Q2hlY2tlZCk7XG5cdFx0XHRcdFx0dGltZUVsLnRleHRDb250ZW50ID0gYExhc3QgY2hlY2tlZDogJHtkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfWA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHN0YXR1cy5tZXNzYWdlKSB7XG5cdFx0XHRcdFx0Y29uc3QgbWVzc2FnZUVsID0gdG9vbHRpcC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN0YXR1cy1tZXNzYWdlJyB9KTtcblx0XHRcdFx0XHRtZXNzYWdlRWwudGV4dENvbnRlbnQgPSBzdGF0dXMubWVzc2FnZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICh0b29sdGlwKSB7XG5cdFx0XHRcdHRvb2x0aXAucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBwZXJmb3JtUmVhbENvbm5lY3Rpb25UZXN0KHByb3ZpZGVyOiAnY2xhdWRlJyB8ICdvcGVuYWknIHwgJ2dvb2dsZScgfCAnb2xsYW1hJyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIFRlc3QgdGhlIHByb3ZpZGVyIGNsYXNzZXMgZGlyZWN0bHlcblx0XHRzd2l0Y2ggKHByb3ZpZGVyKSB7XG5cdFx0XHRjYXNlICdjbGF1ZGUnOiB7XG5cdFx0XHRcdGNvbnN0IGNsYXVkZVByb3ZpZGVyID0gbmV3IENsYXVkZVByb3ZpZGVyKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZSk7XG5cdFx0XHRcdC8vIEZvciBDbGF1ZGUsIGp1c3QgdGVzdCBhIG1pbmltYWwgY29tcGxldGlvbiBpbnN0ZWFkIG9mIGdldEF2YWlsYWJsZU1vZGVsc1xuXHRcdFx0XHRhd2FpdCBjbGF1ZGVQcm92aWRlci5jb21wbGV0ZSgnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50LicsICdIaScsIHsgbWF4VG9rZW5zOiAxIH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGNhc2UgJ29wZW5haSc6IHtcblx0XHRcdFx0Y29uc3Qgb3BlbmFpUHJvdmlkZXIgPSBuZXcgT3BlbkFJUHJvdmlkZXIodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpKTtcblx0XHRcdFx0YXdhaXQgb3BlbmFpUHJvdmlkZXIuZ2V0QXZhaWxhYmxlTW9kZWxzKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0Y2FzZSAnZ29vZ2xlJzoge1xuXHRcdFx0XHRjb25zdCBnb29nbGVQcm92aWRlciA9IG5ldyBHb29nbGVQcm92aWRlcih0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUpO1xuXHRcdFx0XHRhd2FpdCBnb29nbGVQcm92aWRlci5nZXRBdmFpbGFibGVNb2RlbHMoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlICdvbGxhbWEnOiB7XG5cdFx0XHRcdGNvbnN0IG9sbGFtYVByb3ZpZGVyID0gbmV3IE9sbGFtYVByb3ZpZGVyKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYSk7XG5cdFx0XHRcdC8vIE9sbGFtYSBkb2Vzbid0IGhhdmUgZ2V0QXZhaWxhYmxlTW9kZWxzLCBjaGVjayBjb25uZWN0aW9uIHdpdGggaXNBdmFpbGFibGVcblx0XHRcdFx0Y29uc3QgaXNBdmFpbGFibGUgPSBhd2FpdCBvbGxhbWFQcm92aWRlci5pc0F2YWlsYWJsZSgpO1xuXHRcdFx0XHRpZiAoIWlzQXZhaWxhYmxlKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgY29ubmVjdGlvbiBmYWlsZWQnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNldENvbm5lY3Rpb25TdGF0dXMoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgdHlwZTogJ3N1Y2Nlc3MnIHwgJ2Vycm9yJyB8ICd0ZXN0aW5nJyB8ICdub25lJywgbWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XG5cdFx0aWYgKHR5cGUgPT09ICdub25lJykgcmV0dXJuO1xuXHRcdFxuXHRcdGNvbnN0IHN0YXR1c0VsID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtc3RhdHVzLWluZGljYXRvciAke3R5cGV9YCB9KTtcblx0XHRzdGF0dXNFbC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUNvbm5lY3Rpb25TdGF0dXMoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcHJvdmlkZXI6ICdjbGF1ZGUnIHwgJ29wZW5haScgfCAnZ29vZ2xlJyB8ICdvbGxhbWEnKTogdm9pZCB7XG5cdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb25cblx0XHRjb25zdCBoYXNDb25maWcgPSB0aGlzLmhhc1Byb3ZpZGVyQ29uZmlnKHByb3ZpZGVyKTtcblx0XHRcblx0XHRpZiAoIWhhc0NvbmZpZykge1xuXHRcdFx0dGhpcy5zZXRDb25uZWN0aW9uU3RhdHVzKGNvbnRhaW5lciwgJ25vbmUnLCAnJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIERvbid0IHNob3cgYW55dGhpbmcgaW5pdGlhbGx5IC0gbGV0IHVzZXIgdGVzdCB3aGVuIHJlYWR5XG5cdFx0XHR0aGlzLnNldENvbm5lY3Rpb25TdGF0dXMoY29udGFpbmVyLCAnbm9uZScsICcnKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhc1Byb3ZpZGVyQ29uZmlnKHByb3ZpZGVyOiAnY2xhdWRlJyB8ICdvcGVuYWknIHwgJ2dvb2dsZScgfCAnb2xsYW1hJyk6IGJvb2xlYW4ge1xuXHRcdHN3aXRjaCAocHJvdmlkZXIpIHtcblx0XHRcdGNhc2UgJ2NsYXVkZSc6IFxuXHRcdFx0XHRyZXR1cm4gISF0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5O1xuXHRcdFx0Y2FzZSAnb3BlbmFpJzogXG5cdFx0XHRcdHJldHVybiAhIXRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9wZW5haS5hcGlLZXk7XG5cdFx0XHRjYXNlICdnb29nbGUnOiBcblx0XHRcdFx0cmV0dXJuICEhdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleTtcblx0XHRcdGNhc2UgJ29sbGFtYSc6IFxuXHRcdFx0XHRyZXR1cm4gISF0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEuYmFzZVVybDtcblx0XHRcdGRlZmF1bHQ6IFxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVMaWNlbnNlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0Y29uc3QgbGljZW5zZUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zZWN0aW9uJyB9KTtcblx0XHRsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1N1cGVybm92YSBTdXBwb3J0ZXIgU3RhdHVzJyB9KTtcblxuXHRcdC8vIEluZm8gYWJvdXQgdGhlIG5ldyBtb2RlbFxuXHRcdGNvbnN0IGluZm9FbCA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tb2RlbC1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkIGNvbXBhY3RcIj5cblx0XHRcdFx0PHA+Tm92YSBwcm92aWRlcyBhbGwgZmVhdHVyZXMgZm9yIGZyZWUgd2hlbiB5b3UgdXNlIHlvdXIgb3duIEFJIHByb3ZpZGVyIEFQSSBrZXlzLiBcblx0XHRcdFx0U3VwZXJub3ZhIHN1cHBvcnRlcnMgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEN1cnJlbnQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmlzU3VwZXJub3ZhU3VwcG9ydGVyKCkgfHwgZmFsc2U7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhTGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRTdXBlcm5vdmFMaWNlbnNlKCk7XG5cdFx0XG5cdFx0Y29uc3Qgc3RhdHVzRGlzcGxheSA9IGxpY2Vuc2VDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1zdXBlcm5vdmEtc3RhdHVzJyB9KTtcblx0XHRjb25zdCBiYWRnZSA9IHRoaXMuZ2V0TGljZW5zZUJhZGdlKHN1cGVybm92YUxpY2Vuc2UpO1xuXHRcdGNvbnN0IHN0YXR1c1RleHQgPSBiYWRnZT8udGV4dCB8fCAoaXNTdXBlcm5vdmEgPyAnU3VwZXJub3ZhIFN1cHBvcnRlcicgOiAnTm92YSBVc2VyJyk7XG5cdFx0Y29uc3Qgc3RhdHVzSWNvbiA9IGJhZGdlID8gYmFkZ2UuaWNvbiA6IChpc1N1cGVybm92YSA/IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHlsZT1cIndpZHRoOiAxNHB4OyBoZWlnaHQ6IDE0cHg7IGNvbG9yOiAjOTMzM2VhOyBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCA0cHggcmdiYSgxNDcsIDUxLCAyMzQsIDAuNikpO1wiPlxuXHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xMiAxTDEyIDZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMThMMTIgMjNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNNiAxMkwxIDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCA1LjYzNkwxNS41MzYgOC40NjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDE4LjM2NEwxNS41MzYgMTUuNTM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgOC40NjRMNS42MzYgNS42MzZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyLjVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdDwvc3ZnPmAgOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3R5bGU9XCJ3aWR0aDogMTRweDsgaGVpZ2h0OiAxNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1wiPlxuXHRcdFx0JHtOT1ZBX0lDT05fU1ZHfVxuXHRcdDwvc3ZnPmApO1xuXHRcdHN0YXR1c0Rpc3BsYXkuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3RhdHVzLWJhZGdlICR7YmFkZ2U/LmNsYXNzTmFtZSB8fCAoaXNTdXBlcm5vdmEgPyAnc3VwZXJub3ZhJyA6ICdub3ZhJyl9XCIgJHtiYWRnZSA/IGBzdHlsZT1cImJvcmRlci1jb2xvcjogJHtiYWRnZS5jb2xvcn07IGNvbG9yOiAke2JhZGdlLmNvbG9yfTtcImAgOiAnJ30+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic3RhdHVzLWljb25cIj4ke3N0YXR1c0ljb259PC9zcGFuPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInN0YXR1cy1uYW1lXCI+JHtzdGF0dXNUZXh0fTwvc3Bhbj5cblx0XHRcdDwvZGl2PlxuXHRcdGA7XG5cblx0XHQvLyBTdXBlcm5vdmEgbGljZW5zZSBzdGF0dXNcblx0XHRpZiAoc3VwZXJub3ZhTGljZW5zZSkge1xuXHRcdFx0Y29uc3Qgc3RhdHVzRWwgPSBsaWNlbnNlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zdGF0dXMnIH0pO1xuXHRcdFx0Y29uc3QgZXhwaXJ5VGV4dCA9IHN1cGVybm92YUxpY2Vuc2UuZXhwaXJlc0F0IFxuXHRcdFx0XHQ/IGBFeHBpcmVzOiAke3N1cGVybm92YUxpY2Vuc2UuZXhwaXJlc0F0LnRvTG9jYWxlRGF0ZVN0cmluZygpfWBcblx0XHRcdFx0OiAnTGlmZXRpbWUgU3VwcG9ydCc7XG5cdFx0XHRzdGF0dXNFbC5pbm5lckhUTUwgPSBgXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJsaWNlbnNlLWluZm9cIj5cblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImxpY2Vuc2UtZW1haWxcIj4ke3N1cGVybm92YUxpY2Vuc2UuZW1haWx9PC9zcGFuPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibGljZW5zZS1leHBpcnlcIj4ke2V4cGlyeVRleHR9PC9zcGFuPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fVxuXG5cdFx0Ly8gU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IGlucHV0IHVzaW5nIHNlY3VyZSBpbnB1dCBwYXR0ZXJuXG5cdFx0dGhpcy5jcmVhdGVTZWN1cmVBcGlLZXlJbnB1dChsaWNlbnNlQ29udGFpbmVyLCB7XG5cdFx0XHRuYW1lOiAnU3VwZXJub3ZhIExpY2Vuc2UgS2V5IChPcHRpb25hbCknLFxuXHRcdFx0ZGVzYzogJ0VudGVyIHlvdXIgU3VwZXJub3ZhIHN1cHBvcnRlciBsaWNlbnNlIGtleSBmb3IgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcycsXG5cdFx0XHRwbGFjZWhvbGRlcjogJ0VudGVyIFN1cGVybm92YSBsaWNlbnNlIGtleS4uLicsXG5cdFx0XHR2YWx1ZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLnN1cGVybm92YUxpY2Vuc2VLZXkgfHwgJycsXG5cdFx0XHRvbkNoYW5nZTogYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5ID0gdmFsdWU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gVXBkYXRlIFN1cGVybm92YSBsaWNlbnNlIGluIGZlYXR1cmUgbWFuYWdlclxuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVTdXBlcm5vdmFMaWNlbnNlKHZhbHVlIHx8IG51bGwpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIFJlZnJlc2ggdGhlIGNvbnRlbnQgdG8gc2hvdyB1cGRhdGVkIHN0YXR1c1xuXHRcdFx0XHRcdHRoaXMudXBkYXRlVGFiQ29udGVudCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBBZGQgdmFsaWRhdGlvbiBidXR0b24gc2VwYXJhdGVseVxuXHRcdGNvbnN0IHZhbGlkYXRlU2V0dGluZyA9IG5ldyBTZXR0aW5nKGxpY2Vuc2VDb250YWluZXIpXG5cdFx0XHQuc2V0RGVzYygnVmFsaWRhdGUgeW91ciBTdXBlcm5vdmEgbGljZW5zZSBrZXknKVxuXHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4ge1xuXHRcdFx0XHRidXR0b24uc2V0QnV0dG9uVGV4dCgnVmFsaWRhdGUgTGljZW5zZScpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgbGljZW5zZUtleSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5O1xuXHRcdFx0XHRcdFx0aWYgKCFsaWNlbnNlS2V5KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2hvd0xpY2Vuc2VNZXNzYWdlKCdQbGVhc2UgZW50ZXIgYSBTdXBlcm5vdmEgbGljZW5zZSBrZXkgZmlyc3QuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0YnV0dG9uLnNldEJ1dHRvblRleHQoJ1ZhbGlkYXRpbmcuLi4nKTtcblx0XHRcdFx0XHRcdGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZVN1cGVybm92YUxpY2Vuc2UobGljZW5zZUtleSk7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc1N1cGVybm92YVN1cHBvcnRlcigpO1xuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdGlmIChpc1N1cGVybm92YSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ1ZhbGlkIFN1cGVybm92YSBsaWNlbnNlISBZb3Ugbm93IGhhdmUgZWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcy4nLCAnc3VjY2VzcycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93Q29uZmV0dGkoKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0ludmFsaWQgb3IgZXhwaXJlZCBTdXBlcm5vdmEgbGljZW5zZSBrZXkuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhciB0byB1cGRhdGUgZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaFN1cGVybm92YVVJKCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggY29udGVudCBcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRhYkNvbnRlbnQoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0Vycm9yIHZhbGlkYXRpbmcgU3VwZXJub3ZhIGxpY2Vuc2UuJywgJ2Vycm9yJyk7XG5cdFx0XHRcdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHRcdFx0XHRidXR0b24uc2V0QnV0dG9uVGV4dCgnVmFsaWRhdGUgTGljZW5zZScpO1xuXHRcdFx0XHRcdFx0XHRidXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0Ly8gU3VwZXJub3ZhIHN1cHBvcnRlciBpbmZvcm1hdGlvbiBvbmx5XG5cdFx0dGhpcy5jcmVhdGVTdXBlcm5vdmFJbmZvKGxpY2Vuc2VDb250YWluZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFJbmZvKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBTdXBlcm5vdmEgc3VwcG9ydGVyIGluZm9ybWF0aW9uXG5cdFx0Y29uc3Qgc3VwZXJub3ZhSW5mbyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXN1cGVybm92YS1pbmZvJyB9KTtcblx0XHRzdXBlcm5vdmFJbmZvLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8aDU+QmVjb21lIGEgU3VwZXJub3ZhIFN1cHBvcnRlcjwvaDU+XG5cdFx0XHRcdDxwPlN1cHBvcnQgTm92YSBkZXZlbG9wbWVudCBhbmQgZ2V0IGVhcmx5IGFjY2VzcyB0byBuZXcgZmVhdHVyZXMuIEFsbCBmZWF0dXJlcyBldmVudHVhbGx5IGJlY29tZSBmcmVlIGZvciBldmVyeW9uZS48L3A+XG5cdFx0XHRcdDx1bD5cblx0XHRcdFx0XHQ8bGk+RWFybHkgYWNjZXNzIHRvIG5ldyBmZWF0dXJlcyAoMy02IG1vbnRocyBiZWZvcmUgZ2VuZXJhbCByZWxlYXNlKTwvbGk+XG5cdFx0XHRcdFx0PGxpPlByaW9yaXR5IHN1cHBvcnQgYW5kIGZlYXR1cmUgcmVxdWVzdHM8L2xpPlxuXHRcdFx0XHRcdDxsaT5TdXBwb3J0ZXIgYmFkZ2UgYW5kIHJlY29nbml0aW9uPC9saT5cblx0XHRcdFx0XHQ8bGk+RGlyZWN0bHkgc3VwcG9ydCBvcGVuLXNvdXJjZSBkZXZlbG9wbWVudDwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVEZWJ1Z1NldHRpbmdzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBkZWJ1Z0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWRlYnVnLXNlY3Rpb24nIH0pO1xuXHRcdGRlYnVnQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0RldmVsb3BtZW50IFNldHRpbmdzJyB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ0RlYnVnIE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXZlbG9wbWVudCB0ZXN0aW5nIGZlYXR1cmVzJylcblx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MuZW5hYmxlZClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLnVwZGF0ZURlYnVnU2V0dGluZ3ModGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIGRlYnVnIG9wdGlvbnNcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQpIHtcblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnT3ZlcnJpZGUgRGF0ZScpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBjdXJyZW50IGRhdGUgZm9yIHRlc3RpbmcgdGltZS1nYXRlZCBmZWF0dXJlcyAoWVlZWS1NTS1ERCknKVxuXHRcdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJzIwMjUtMTItMDEnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5vdmVycmlkZURhdGUgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGljZW5zaW5nLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlID0gdmFsdWUgfHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgcmVmcmVzaCBkaXNwbGF5IG9uIGV2ZXJ5IGtleXN0cm9rZSAtIGp1c3QgdXBkYXRlIHRoZSBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdG5ldyBTZXR0aW5nKGRlYnVnQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZSgnRm9yY2UgU3VwZXJub3ZhIFN0YXR1cycpXG5cdFx0XHRcdC5zZXREZXNjKCdPdmVycmlkZSBTdXBlcm5vdmEgc3VwcG9ydGVyIHN0YXR1cyBmb3IgdGVzdGluZycpXG5cdFx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSB8fCBmYWxzZSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncy5mb3JjZVN1cGVybm92YSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci51cGRhdGVEZWJ1Z1NldHRpbmdzKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gU2hvdyBjb25mZXR0aSB3aGVuIHR1cm5pbmcgT04gRm9yY2UgU3VwZXJub3ZhXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zaG93Q29uZmV0dGkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBzaWRlYmFyIHRvIHVwZGF0ZSBmZWF0dXJlIGF2YWlsYWJpbGl0eVxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGNvbnRlbnQgdG8gc2hvdyB1cGRhdGVkIGZlYXR1cmUgc3RhdHVzXG5cdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRhYkNvbnRlbnQoKTtcblx0XHRcdFx0XHR9KSk7XG5cblx0XHRcdC8vIENsZWFyIGxpY2Vuc2VzIGJ1dHRvblxuXHRcdFx0bmV3IFNldHRpbmcoZGVidWdDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKCdDbGVhciBBbGwgTGljZW5zZXMnKVxuXHRcdFx0XHQuc2V0RGVzYygnUmVtb3ZlIGFsbCBhcHBsaWVkIGxpY2Vuc2VzIChmb3IgdGVzdGluZyknKVxuXHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgTGljZW5zZXMnKVxuXHRcdFx0XHRcdC5zZXRXYXJuaW5nKClcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBDb25maXJtIGFjdGlvblxuXHRcdFx0XHRcdFx0Y29uc3QgY29uZmlybWVkID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBsaWNlbnNlcz8gVGhpcyB3aWxsIHJlbW92ZSBhbnkgYXBwbGllZCBTdXBlcm5vdmEgbGljZW5zZS4nKTtcblx0XHRcdFx0XHRcdGlmICghY29uZmlybWVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdC8vIENsZWFyIGxpY2Vuc2Uga2V5XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9ICcnO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBDbGVhciBGb3JjZSBTdXBlcm5vdmEgaWYgZW5hYmxlZFxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgZmVhdHVyZSBtYW5hZ2VyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZShudWxsKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlRGVidWdTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuZGVidWdTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggc2lkZWJhclxuXHRcdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBOb3ZhU2lkZWJhclZpZXc7XG5cdFx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuXHRcdFx0XHRcdFx0dGhpcy5zaG93TGljZW5zZU1lc3NhZ2UoJ0FsbCBsaWNlbnNlcyBjbGVhcmVkIHN1Y2Nlc3NmdWxseS4nLCAnc3VjY2VzcycpO1xuXG5cdFx0XHRcdFx0XHQvLyBSZWZyZXNoIGNvbnRlbnRcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlVGFiQ29udGVudCgpO1xuXHRcdFx0XHRcdH0pKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dMaWNlbnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIHR5cGU6ICdzdWNjZXNzJyB8ICdlcnJvcicpIHtcblx0XHQvLyBDcmVhdGUgb3IgdXBkYXRlIG1lc3NhZ2UgZWxlbWVudFxuXHRcdGNvbnN0IGV4aXN0aW5nTWVzc2FnZSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtbGljZW5zZS1tZXNzYWdlJyk7XG5cdFx0aWYgKGV4aXN0aW5nTWVzc2FnZSkge1xuXHRcdFx0ZXhpc3RpbmdNZXNzYWdlLnJlbW92ZSgpO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgXG5cdFx0XHRjbHM6IGBub3ZhLWxpY2Vuc2UtbWVzc2FnZSAke3R5cGV9YCxcblx0XHRcdHRleHQ6IG1lc3NhZ2Vcblx0XHR9KTtcblxuXHRcdC8vIEF1dG8tcmVtb3ZlIGFmdGVyIDUgc2Vjb25kc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0bWVzc2FnZUVsLnJlbW92ZSgpO1xuXHRcdH0sIDUwMDApO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29uZmV0dGkoKSB7XG5cdFx0Ly8gQ3JlYXRlIGNvbmZldHRpIGNvbnRhaW5lclxuXHRcdGNvbnN0IGNvbmZldHRpQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0Y29uZmV0dGlDb250YWluZXIuY2xhc3NOYW1lID0gJ25vdmEtY29uZmV0dGktY29udGFpbmVyJztcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbmZldHRpQ29udGFpbmVyKTtcblxuXHRcdC8vIEdldCBzZXR0aW5ncyBjb250YWluZXIgcG9zaXRpb24gZm9yIGV4cGxvc2lvbiBjZW50ZXJcblx0XHRjb25zdCByZWN0ID0gdGhpcy5jb250YWluZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRjb25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7XG5cdFx0Y29uc3QgY2VudGVyWSA9IHJlY3QudG9wICsgTWF0aC5taW4ocmVjdC5oZWlnaHQgLyAyLCAzMDApO1xuXG5cdFx0Ly8gQ29sb3JzIGZvciBjb25mZXR0aVxuXHRcdGNvbnN0IGNvbG9ycyA9IFsnZ29sZCcsICdibHVlJywgJ3BpbmsnLCAnZ3JlZW4nLCAncmVkJywgJyddOyAgLy8gZW1wdHkgc3RyaW5nID0gZGVmYXVsdCBwdXJwbGVcblxuXHRcdC8vIENyZWF0ZSBjb25mZXR0aSBwaWVjZXNcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7XG5cdFx0XHRjb25zdCBjb25mZXR0aSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0Y29uZmV0dGkuY2xhc3NOYW1lID0gYG5vdmEtY29uZmV0dGktcGllY2UgJHtjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldfWA7XG5cdFx0XHRcblx0XHRcdC8vIFBvc2l0aW9uIGF0IGV4cGxvc2lvbiBjZW50ZXJcblx0XHRcdGNvbmZldHRpLnN0eWxlLmxlZnQgPSBgJHtjZW50ZXJYfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLnRvcCA9IGAke2NlbnRlcll9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBDYWxjdWxhdGUgZXhwbG9zaW9uIHRyYWplY3Rvcnlcblx0XHRcdGNvbnN0IGFuZ2xlID0gKE1hdGguUEkgKiAyICogaSkgLyAxNTAgKyAoTWF0aC5yYW5kb20oKSAqIDAuMiAtIDAuMSk7XG5cdFx0XHRjb25zdCB2ZWxvY2l0eSA9IDI1MCArIE1hdGgucmFuZG9tKCkgKiAzNTA7IC8vIHBpeGVsc1xuXHRcdFx0Y29uc3QgZXhwbG9kZVggPSBNYXRoLmNvcyhhbmdsZSkgKiB2ZWxvY2l0eTtcblx0XHRcdGNvbnN0IGV4cGxvZGVZID0gTWF0aC5zaW4oYW5nbGUpICogdmVsb2NpdHkgLSAxNTA7IC8vIFN0cm9uZyB1cHdhcmQgYmlhc1xuXHRcdFx0XG5cdFx0XHQvLyBTZXQgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzIGZvciBhbmltYXRpb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLnNldFByb3BlcnR5KCctLWV4cGxvZGUteCcsIGAke2V4cGxvZGVYfXB4YCk7XG5cdFx0XHRjb25mZXR0aS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1leHBsb2RlLXknLCBgJHtleHBsb2RlWX1weGApO1xuXHRcdFx0XG5cdFx0XHQvLyBSYW5kb20gZGVsYXkgZm9yIHN0YWdnZXJlZCBleHBsb3Npb25cblx0XHRcdGNvbmZldHRpLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gYCR7TWF0aC5yYW5kb20oKSAqIDAuMn1zYDtcblx0XHRcdFxuXHRcdFx0Ly8gUmFuZG9tIHNpemVcblx0XHRcdGNvbnN0IHNpemUgPSA2ICsgTWF0aC5yYW5kb20oKSAqIDE0O1xuXHRcdFx0Y29uZmV0dGkuc3R5bGUud2lkdGggPSBgJHtzaXplfXB4YDtcblx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemV9cHhgO1xuXHRcdFx0XG5cdFx0XHQvLyBNYWtlIHNvbWUgY29uZmV0dGkgcmVjdGFuZ3VsYXJcblx0XHRcdGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG5cdFx0XHRcdGNvbmZldHRpLnN0eWxlLmhlaWdodCA9IGAke3NpemUgKiAwLjR9cHhgO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb25mZXR0aSk7XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGNvbnRhaW5lciBhZnRlciBhbmltYXRpb24gY29tcGxldGVzXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjb25mZXR0aUNvbnRhaW5lci5yZW1vdmUoKTtcblx0XHR9LCA0MDAwKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlR2VuZXJhbFNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdC8vIENvcmUgU2V0dGluZ3Mgc2VjdGlvbiB3aXRoIGNsZWFuIGhlYWRlclxuXHRcdGNvbnN0IGNvcmVTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb3JlLXNldHRpbmdzLXNlY3Rpb24nIH0pO1xuXHRcdGNvcmVTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0NvcmUgU2V0dGluZ3MnIH0pO1xuXHRcdFxuXHRcdC8vIEFkZCBzZWN0aW9uIHNwYWNpbmcgcGVyIHNwZWNpZmljYXRpb25cblx0XHRjb3JlU2VjdGlvbi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMzJweCc7XG5cblx0XHRuZXcgU2V0dGluZyhjb3JlU2VjdGlvbilcblx0XHRcdC5zZXROYW1lKCdEZWZhdWx0IFRlbXBlcmF0dXJlJylcblx0XHRcdC5zZXREZXNjKCdDb250cm9scyByYW5kb21uZXNzIGluIEFJIHJlc3BvbnNlcyAoMC4wID0gZm9jdXNlZCwgMS4wID0gY3JlYXRpdmUpJylcblx0XHRcdC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuXHRcdFx0XHQuc2V0TGltaXRzKDAsIDEsIDAuMSlcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlKVxuXHRcdFx0XHQuc2V0RHluYW1pY1Rvb2x0aXAoKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0VGVtcGVyYXR1cmUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29yZVNlY3Rpb24pXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBNYXggVG9rZW5zJylcblx0XHRcdC5zZXREZXNjKCdNYXhpbXVtIGxlbmd0aCBvZiBBSSByZXNwb25zZXMgKDEwMDAtMTAwMDAgdG9rZW5zKScpXG5cdFx0XHQuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcblx0XHRcdFx0LnNldExpbWl0cygxMDAwLCAxMDAwMCwgNTAwKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zKVxuXHRcdFx0XHQuc2V0RHluYW1pY1Rvb2x0aXAoKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhbC5kZWZhdWx0TWF4VG9rZW5zID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvcmVTZWN0aW9uKVxuXHRcdFx0LnNldE5hbWUoJ0F1dG8tc2F2ZSBzZXR0aW5ncycpXG5cdFx0XHQuc2V0RGVzYygnQXV0b21hdGljYWxseSBzYXZlIGNvbmZpZ3VyYXRpb24gY2hhbmdlcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYWwuYXV0b1NhdmUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmFsLmF1dG9TYXZlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQcm92aWRlclNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdC8vIENvbmZpZ3VyZSBZb3VyIEFQSSBLZXlzIFNlY3Rpb25cblx0XHRjb25zdCBhcGlLZXlzU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtYXBpLWtleXMtc2VjdGlvbicgfSk7XG5cdFx0YXBpS2V5c1NlY3Rpb24uY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ29uZmlndXJlIFlvdXIgQVBJIEtleXMnIH0pO1xuXHRcdGFwaUtleXNTZWN0aW9uLmNyZWF0ZUVsKCdocicsIHsgY2xzOiAnbm92YS1zZWN0aW9uLWRpdmlkZXInIH0pO1xuXHRcdFxuXHRcdGNvbnN0IGluZm9FbCA9IGFwaUtleXNTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaW5mbycgfSk7XG5cdFx0aW5mb0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWluZm8tY2FyZFwiPlxuXHRcdFx0XHQ8cD5Ob3ZhIGNvbm5lY3RzIHRvIEFJIHByb3ZpZGVycyB1c2luZyB5b3VyIG93biBBUEkga2V5cy4gQWxsIHByb3ZpZGVycyBhcmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyAtIFxuXHRcdFx0XHRqdXN0IGFkZCB5b3VyIEFQSSBrZXlzIGJlbG93IHRvIGdldCBzdGFydGVkLjwvcD5cblx0XHRcdFx0PHA+PHN0cm9uZz5Nb2RlbCBTZWxlY3Rpb246PC9zdHJvbmc+IEFmdGVyIGNvbm5lY3Rpbmcgc3VjY2Vzc2Z1bGx5LCBzZWxlY3QgbW9kZWxzIGZvciBhbnkgcHJvdmlkZXIgdXNpbmcgdGhlIGRyb3Bkb3duIGluIHRoZSBOb3ZhIHNpZGViYXIuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1pbmZvLWNhcmQgbm92YS1tb2RlbC1ndWlkYW5jZVwiPlxuXHRcdFx0XHQ8aDQ+UmVjb21tZW5kZWQgRGVmYXVsdHM8L2g0PlxuXHRcdFx0XHQ8dWwgY2xhc3M9XCJub3ZhLW1vZGVsLXJlY29tbWVuZGF0aW9uc1wiPlxuXHRcdFx0XHRcdDxsaT48c3Ryb25nPkNsYXVkZSBTb25uZXQgNDwvc3Ryb25nPiAtIExhdGVzdCBnZW5lcmF0aW9uIHdpdGggZXhjZWxsZW50IGluc3RydWN0aW9uIGZvbGxvd2luZyBmb3IgY29sbGFib3JhdGl2ZSBlZGl0aW5nPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HUFQtNC4xIE1pbmk8L3N0cm9uZz4gLSBDdXJyZW50LWdlbmVyYXRpb24gbW9kZWwgdGhhdCBvdXRwZXJmb3JtcyBHUFQtNG8gd2hpbGUgcmVtYWluaW5nIGNvc3QtZWZmZWN0aXZlPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HZW1pbmkgMi41IEZsYXNoPC9zdHJvbmc+IC0gQmVzdCBwcmljZS9wZXJmb3JtYW5jZSB3aXRoIFwidGhpbmtpbmdcIiBjYXBhYmlsaXRpZXMgYW5kIHN0cm9uZyBjb2Rpbmcgc3VwcG9ydDwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+T2xsYW1hIChMb2NhbCk8L3N0cm9uZz4gLSBDb21wbGV0ZSBwcml2YWN5IHdpdGggbG9jYWwgcHJvY2Vzc2luZyAtIHJlcXVpcmVzIHNldHVwIGJ1dCBrZWVwcyBhbGwgZGF0YSBvbiB5b3VyIGRldmljZTwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHRcdDxwIGNsYXNzPVwibm92YS1ndWlkYW5jZS1ub3RlXCI+Q2xvdWQgb3B0aW9ucyBvZmZlciBtb2Rlcm4gQUkgY2FwYWJpbGl0aWVzIHdpdGhvdXQgcHJlbWl1bSBwcmljaW5nLCB3aGlsZSBsb2NhbCBvcHRpb25zIHByb3ZpZGUgY29tcGxldGUgcHJpdmFjeS48L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gQ29uZmlndXJhdGlvbiBTdWJzZWN0aW9uICh3aXRoaW4gQVBJIEtleXMgc2VjdGlvbilcblx0XHRjb25zdCBjb25maWdTZWN0aW9uID0gYXBpS2V5c1NlY3Rpb24uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1jb25maWctc2VjdGlvbicgfSk7XG5cdFx0Y29uZmlnU2VjdGlvbi5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDb25maWd1cmF0aW9uJyB9KTtcblx0XHRjb25maWdTZWN0aW9uLmNyZWF0ZUVsKCdocicsIHsgY2xzOiAnbm92YS1zZWN0aW9uLWRpdmlkZXInIH0pO1xuXG5cdFx0Ly8gU2hvdyBhbGwgcHJvdmlkZXJzIC0gbm8gcmVzdHJpY3Rpb25zXG5cdFx0dGhpcy5jcmVhdGVPbGxhbWFTZXR0aW5ncyhjb25maWdTZWN0aW9uKTtcblx0XHR0aGlzLmNyZWF0ZUNsYXVkZVNldHRpbmdzKGNvbmZpZ1NlY3Rpb24pO1xuXHRcdHRoaXMuY3JlYXRlR29vZ2xlU2V0dGluZ3MoY29uZmlnU2VjdGlvbik7XG5cdFx0dGhpcy5jcmVhdGVPcGVuQUlTZXR0aW5ncyhjb25maWdTZWN0aW9uKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ2xhdWRlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3QgY2xhdWRlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHQvLyBQcm92aWRlciBoZWFkZXIgd2l0aCBzdGF0dXMgaW5kaWNhdG9yXG5cdFx0Y29uc3QgaGVhZGVyQ29udGFpbmVyID0gY2xhdWRlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaGVhZGVyJyB9KTtcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0NsYXVkZSAoQW50aHJvcGljKScgfSk7XG5cdFx0XG5cdFx0Ly8gQWRkIHN0YXR1cyBpbmRpY2F0b3IgdG8gdGhlIHNhbWUgaDQgZWxlbWVudFxuXHRcdGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IHRoaXMuY3JlYXRlUHJvdmlkZXJTdGF0dXNJbmRpY2F0b3IodGl0bGVFbCwgJ2NsYXVkZScpO1xuXHRcdHN0YXR1c0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvdmlkZXInLCAnY2xhdWRlJyk7XG5cblx0XHR0aGlzLmNyZWF0ZVNlY3VyZUFwaUtleUlucHV0KGNsYXVkZUNvbnRhaW5lciwge1xuXHRcdFx0bmFtZTogJ0FQSSBLZXknLFxuXHRcdFx0ZGVzYzogJ1lvdXIgQW50aHJvcGljIEFQSSBrZXknLFxuXHRcdFx0cGxhY2Vob2xkZXI6ICdzay1hbnQtLi4uJyxcblx0XHRcdHZhbHVlOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5IHx8ICcnLFxuXHRcdFx0b25DaGFuZ2U6IGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5jbGF1ZGUuYXBpS2V5ID0gdmFsdWU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gVGVzdCBDb25uZWN0aW9uIGJ1dHRvblxuXHRcdHRoaXMuY3JlYXRlVGVzdENvbm5lY3Rpb25CdXR0b24oY2xhdWRlQ29udGFpbmVyLCAnY2xhdWRlJyk7XG5cblx0fVxuXG5cblxuXHRwcml2YXRlIGNyZWF0ZU9wZW5BSVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFxuXHRcdGNvbnN0IG9wZW5haUNvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItc2VjdGlvbicgfSk7XG5cdFx0XG5cdFx0Ly8gUHJvdmlkZXIgaGVhZGVyIHdpdGggc3RhdHVzIGluZGljYXRvclxuXHRcdGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IG9wZW5haUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWhlYWRlcicgfSk7XG5cdFx0Y29uc3QgdGl0bGVFbCA9IGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDaGF0R1BUIChPcGVuQUkpJyB9KTtcblx0XHRcblx0XHQvLyBBZGQgc3RhdHVzIGluZGljYXRvciB0byB0aGUgc2FtZSBoNCBlbGVtZW50XG5cdFx0Y29uc3Qgc3RhdHVzQ29udGFpbmVyID0gdGhpcy5jcmVhdGVQcm92aWRlclN0YXR1c0luZGljYXRvcih0aXRsZUVsLCAnb3BlbmFpJyk7XG5cdFx0c3RhdHVzQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1wcm92aWRlcicsICdvcGVuYWknKTtcblxuXHRcdHRoaXMuY3JlYXRlU2VjdXJlQXBpS2V5SW5wdXQob3BlbmFpQ29udGFpbmVyLCB7XG5cdFx0XHRuYW1lOiAnQVBJIEtleScsXG5cdFx0XHRkZXNjOiAnWW91ciBPcGVuQUkgQVBJIGtleScsXG5cdFx0XHRwbGFjZWhvbGRlcjogJ3NrLS4uLicsXG5cdFx0XHR2YWx1ZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSB8fCAnJyxcblx0XHRcdG9uQ2hhbmdlOiBhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFRlc3QgQ29ubmVjdGlvbiBidXR0b25cblx0XHR0aGlzLmNyZWF0ZVRlc3RDb25uZWN0aW9uQnV0dG9uKG9wZW5haUNvbnRhaW5lciwgJ29wZW5haScpO1xuXG5cdH1cblxuXG5cdHByaXZhdGUgY3JlYXRlR29vZ2xlU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XG5cdFx0Y29uc3QgZ29vZ2xlQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHQvLyBQcm92aWRlciBoZWFkZXIgd2l0aCBzdGF0dXMgaW5kaWNhdG9yXG5cdFx0Y29uc3QgaGVhZGVyQ29udGFpbmVyID0gZ29vZ2xlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaGVhZGVyJyB9KTtcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dvb2dsZSAoR2VtaW5pKScgfSk7XG5cdFx0XG5cdFx0Ly8gQWRkIHN0YXR1cyBpbmRpY2F0b3IgdG8gdGhlIHNhbWUgaDQgZWxlbWVudFxuXHRcdGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IHRoaXMuY3JlYXRlUHJvdmlkZXJTdGF0dXNJbmRpY2F0b3IodGl0bGVFbCwgJ2dvb2dsZScpO1xuXHRcdHN0YXR1c0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvdmlkZXInLCAnZ29vZ2xlJyk7XG5cblx0XHR0aGlzLmNyZWF0ZVNlY3VyZUFwaUtleUlucHV0KGdvb2dsZUNvbnRhaW5lciwge1xuXHRcdFx0bmFtZTogJ0FQSSBLZXknLFxuXHRcdFx0ZGVzYzogJ1lvdXIgR29vZ2xlIEFJIEFQSSBrZXknLFxuXHRcdFx0cGxhY2Vob2xkZXI6ICdBSS4uLicsXG5cdFx0XHR2YWx1ZTogdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSB8fCAnJyxcblx0XHRcdG9uQ2hhbmdlOiBhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMuZ29vZ2xlLmFwaUtleSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFRlc3QgQ29ubmVjdGlvbiBidXR0b25cblx0XHR0aGlzLmNyZWF0ZVRlc3RDb25uZWN0aW9uQnV0dG9uKGdvb2dsZUNvbnRhaW5lciwgJ2dvb2dsZScpO1xuXG5cdH1cblxuXG5cdHByaXZhdGUgY3JlYXRlT2xsYW1hU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0Y29uc3Qgb2xsYW1hQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uJyB9KTtcblx0XHRcblx0XHQvLyBQcm92aWRlciBoZWFkZXIgd2l0aCBzdGF0dXMgaW5kaWNhdG9yXG5cdFx0Y29uc3QgaGVhZGVyQ29udGFpbmVyID0gb2xsYW1hQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcHJvdmlkZXItaGVhZGVyJyB9KTtcblx0XHRjb25zdCB0aXRsZUVsID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ09sbGFtYSAoTG9jYWwpJyB9KTtcblx0XHRcblx0XHQvLyBBZGQgc3RhdHVzIGluZGljYXRvciB0byB0aGUgc2FtZSBoNCBlbGVtZW50XG5cdFx0Y29uc3Qgc3RhdHVzQ29udGFpbmVyID0gdGhpcy5jcmVhdGVQcm92aWRlclN0YXR1c0luZGljYXRvcih0aXRsZUVsLCAnb2xsYW1hJyk7XG5cdFx0c3RhdHVzQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1wcm92aWRlcicsICdvbGxhbWEnKTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdCYXNlIFVSTCcpXG5cdFx0XHQuc2V0RGVzYygnT2xsYW1hIHNlcnZlciBVUkwnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICczNTBweCc7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSAnNDBweCc7XG5cdFx0XHRcdHJldHVybiB0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdodHRwOi8vbG9jYWxob3N0OjExNDM0Jylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgfHwgJycpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYWlQcm92aWRlcnMub2xsYW1hLmJhc2VVcmwgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHQvLyBUZXN0IENvbm5lY3Rpb24gYnV0dG9uXG5cdFx0dGhpcy5jcmVhdGVUZXN0Q29ubmVjdGlvbkJ1dHRvbihvbGxhbWFDb250YWluZXIsICdvbGxhbWEnKTtcblxuXHRcdG5ldyBTZXR0aW5nKG9sbGFtYUNvbnRhaW5lcilcblx0XHRcdC5zZXROYW1lKCdNb2RlbCcpXG5cdFx0XHQuc2V0RGVzYygnT2xsYW1hIG1vZGVsIHRvIHVzZScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzIwMHB4Jztcblx0XHRcdFx0dGV4dC5pbnB1dEVsLnN0eWxlLmhlaWdodCA9ICc0MHB4Jztcblx0XHRcdFx0cmV0dXJuIHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ2xsYW1hMicpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYS5tb2RlbCB8fCAnJylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycy5vbGxhbWEubW9kZWwgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRuZXcgU2V0dGluZyhvbGxhbWFDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnRGVmYXVsdCBDb250ZXh0IExpbWl0Jylcblx0XHRcdC5zZXREZXNjKCdDb250ZXh0IHdpbmRvdyBzaXplIGZvciBhbGwgT2xsYW1hIG1vZGVscyAoTm92YSBkZWZhdWx0cyB0byAzMksgdnMgT2xsYW1hXFwncyAySyknKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC50eXBlID0gJ251bWJlcic7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICcxNTBweCc7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSAnNDBweCc7XG5cdFx0XHRcdHJldHVybiB0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCczMjAwMCcpXG5cdFx0XHRcdFx0LnNldFZhbHVlKCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFEZWZhdWx0Q29udGV4dCB8fCAzMjAwMCkudG9TdHJpbmcoKSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBudW1WYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcblx0XHRcdFx0XHRcdGlmICghaXNOYU4obnVtVmFsdWUpICYmIG51bVZhbHVlID4gMCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbGxhbWFEZWZhdWx0Q29udGV4dCA9IG51bVZhbHVlO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVQbGF0Zm9ybVNldHRpbmdzKGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbCkge1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1BsYXRmb3JtIFNldHRpbmdzJyB9KTtcblx0XHRcblx0XHQvLyBJbmZvIGFib3V0IHBsYXRmb3JtIHNldHRpbmdzXG5cdFx0Y29uc3QgaW5mb0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wbGF0Zm9ybS1pbmZvJyB9KTtcblx0XHRpbmZvRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtaW5mby1jYXJkXCI+XG5cdFx0XHRcdDxoND5cdUQ4M0RcdUREQTVcdUZFMEYgUGxhdGZvcm0gQ29uZmlndXJhdGlvbjwvaDQ+XG5cdFx0XHRcdDxwPkNvbmZpZ3VyZSB3aGljaCBBSSBwcm92aWRlciB0byB1c2UgYXMgeW91ciBwcmltYXJ5IHByb3ZpZGVyIG9uIGRpZmZlcmVudCBwbGF0Zm9ybXMuIFxuXHRcdFx0XHROb3ZhIHdvcmtzIHNlYW1sZXNzbHkgYWNyb3NzIGRlc2t0b3AgYW5kIG1vYmlsZSB3aXRoIGFsbCBwcm92aWRlcnMuPC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0XHRcblx0XHQvLyBQbGF0Zm9ybSBzZXR0aW5ncyBtYW5hZ2VkIHZpYSBzaWRlYmFyIGRyb3Bkb3duIG5vd1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnTW9kZWwgU2VsZWN0aW9uJylcblx0XHRcdC5zZXREZXNjKCdNb2RlbHMgYXJlIG5vdyBzZWxlY3RlZCB1c2luZyB0aGUgZHJvcGRvd24gaW4gdGhlIE5vdmEgc2lkZWJhci4gRWFjaCBwbGF0Zm9ybSAoZGVza3RvcC9tb2JpbGUpIHJlbWVtYmVycyBpdHMgc2VsZWN0ZWQgbW9kZWwgaW5kZXBlbmRlbnRseS4nKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QWxsb3dlZFByb3ZpZGVyc0ZvclBsYXRmb3JtKHBsYXRmb3JtOiAnZGVza3RvcCcgfCAnbW9iaWxlJyk6IFByb3ZpZGVyVHlwZVtdIHtcblx0XHQvLyBBbGwgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgdG8gYWxsIHVzZXJzIGluIHRoZSBTdXBlcm5vdmEgbW9kZWxcblx0XHRyZXR1cm4gcGxhdGZvcm0gPT09ICdkZXNrdG9wJyBcblx0XHRcdD8gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXVxuXHRcdFx0OiBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJ107XG5cdH1cblxuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXI6IFByb3ZpZGVyVHlwZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbmFtZXM6IFJlY29yZDxQcm92aWRlclR5cGUsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ0NsYXVkZSAoQW50aHJvcGljKScsXG5cdFx0XHQnb3BlbmFpJzogJ0NoYXRHUFQgKE9wZW5BSSknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUgKEdlbWluaSknLCBcblx0XHRcdCdvbGxhbWEnOiAnT2xsYW1hIChMb2NhbCknLFxuXHRcdFx0J25vbmUnOiAnTm9uZSAoRGlzYWJsZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIG5hbWVzW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcblx0fVxuXG5cdGFzeW5jIHNldEN1cnJlbnRNb2RlbChtb2RlbElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MucGxhdGZvcm1TZXR0aW5nc1twbGF0Zm9ybV0uc2VsZWN0ZWRNb2RlbCA9IG1vZGVsSWQ7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHRoZSBwcm92aWRlciBtYW5hZ2VyIHdpdGggbmV3IHNldHRpbmdzXG5cdFx0aWYgKHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci51cGRhdGVTZXR0aW5ncyh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kU2V0dGluZ3MoY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQ3VzdG9tIENvbW1hbmRzJyB9KTtcblxuXHRcdC8vIEZlYXR1cmUgYXZhaWxhYmlsaXR5IGNoZWNrXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBub3RpY2VFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtZmVhdHVyZS1ub3RpY2UnIH0pO1xuXHRcdFx0bm90aWNlRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwicGFkZGluZzogMTZweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1wiPlxuXHRcdFx0XHRcdDxoNCBzdHlsZT1cIm1hcmdpbjogMCAwIDhweCAwOyBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1wiPlN1cGVybm92YSBTdXBwb3J0ZXIgRmVhdHVyZTwvaDQ+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJtYXJnaW46IDA7IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTtcIj5cblx0XHRcdFx0XHRcdEN1c3RvbSBjb21tYW5kcyBhcmUgY3VycmVudGx5IGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycy4gXG5cdFx0XHRcdFx0XHRUaGV5IHdpbGwgYmUgYXZhaWxhYmxlIHRvIGFsbCB1c2VycyBvbiA8c3Ryb25nPk9jdG9iZXIgMSwgMjAyNTwvc3Ryb25nPi5cblx0XHRcdFx0XHQ8L3A+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBEZXNjcmlwdGlvblxuXHRcdGNvbnN0IGRlc2NFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1kZXNjcmlwdGlvbicgfSk7XG5cdFx0ZGVzY0VsLmlubmVySFRNTCA9IGBcblx0XHRcdDxwIHN0eWxlPVwiY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiAxNnB4O1wiPlxuXHRcdFx0XHRDcmVhdGUgY3VzdG9tIGNvbW1hbmQgc2hvcnRjdXRzIHRoYXQgaW5zZXJ0IHByZWRlZmluZWQgdGV4dCB0ZW1wbGF0ZXMgd2hlbiB0cmlnZ2VyZWQgd2l0aCA8Y29kZT46dHJpZ2dlcjwvY29kZT4uXG5cdFx0XHQ8L3A+XG5cdFx0YDtcblxuXHRcdC8vIFNob3cgQ29tbWFuZCBCdXR0b24gc2V0dGluZyAoU3VwZXJub3ZhLW9ubHksIE1vYmlsZS1vbmx5KVxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1Nob3cgQ29tbWFuZCBCdXR0b24gaW4gQ2hhdCAoTW9iaWxlKScpXG5cdFx0XHQuc2V0RGVzYygnU2hvdyB0aGUgQ29tbWFuZHMgYnV0dG9uIGJlc2lkZSB0aGUgU2VuZCBidXR0b24gZm9yIG1vYmlsZSBxdWljayBhY2Nlc3MgdG8gTm92YSBjb21tYW5kcyBhbmQgc2VsZWN0aW9uIGFjdGlvbnMnKVxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29tbWFuZEJ1dHRvbilcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gRmluZCBhbmQgcmVmcmVzaCBzaWRlYmFyIHZpZXdcblx0XHRcdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfTk9WQV9TSURFQkFSKTtcblx0XHRcdFx0XHRpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHNpZGViYXJWaWV3ID0gbGVhdmVzWzBdLnZpZXcgYXMgTm92YVNpZGViYXJWaWV3O1xuXHRcdFx0XHRcdFx0c2lkZWJhclZpZXcucmVmcmVzaENvbW1hbmRCdXR0b24oKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIEFkZCBuZXcgY29tbWFuZCBidXR0b24gYXQgdGhlIHRvcFxuXHRcdGNvbnN0IGJ1dHRvbkVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1hZGQtY29tbWFuZCcgfSk7XG5cdFx0YnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tYm90dG9tOiAxNnB4Oyc7XG5cdFx0XG5cdFx0bmV3IFNldHRpbmcoYnV0dG9uRWwpXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBcblx0XHRcdFx0YnV0dG9uXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJysgQWRkIEN1c3RvbSBDb21tYW5kJylcblx0XHRcdFx0XHQuc2V0Q3RhKClcblx0XHRcdFx0XHQub25DbGljaygoKSA9PiB0aGlzLnNob3dBZGRDb21tYW5kRGlhbG9nKCkpXG5cdFx0XHQpO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KGNvbnRhaW5lckVsKTtcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29tbWFuZHNMaXN0KGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHQvLyBDbGVhciBleGlzdGluZyBjb21tYW5kcyBsaXN0XG5cdFx0Y29uc3QgZXhpc3RpbmdMaXN0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWNvbW1hbmRzLWxpc3QnKTtcblx0XHRpZiAoZXhpc3RpbmdMaXN0KSBleGlzdGluZ0xpc3QucmVtb3ZlKCk7XG5cblx0XHRjb25zdCBjb21tYW5kc0xpc3QgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kcy1saXN0JyB9KTtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXG5cdFx0aWYgKGNvbW1hbmRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Y29uc3QgZW1wdHlFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmRzLWVtcHR5JyB9KTtcblx0XHRcdGVtcHR5RWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAyNHB4OyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XCI+XG5cdFx0XHRcdFx0PHA+Tm8gY3VzdG9tIGNvbW1hbmRzIHlldC48L3A+XG5cdFx0XHRcdFx0PHAgc3R5bGU9XCJmb250LXNpemU6IDAuOWVtO1wiPkNyZWF0ZSB5b3VyIGZpcnN0IGNvbW1hbmQgdG8gZ2V0IHN0YXJ0ZWQhPC9wPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGNvbW1hbmRFbCA9IGNvbW1hbmRzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRjb21tYW5kRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA4cHg7XG5cdFx0XHRcdHBhZGRpbmc6IDE2cHg7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IDEycHg7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRgO1xuXG5cdFx0XHQvLyBDb21tYW5kIGhlYWRlclxuXHRcdFx0Y29uc3QgaGVhZGVyRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWhlYWRlcicgfSk7XG5cdFx0XHRoZWFkZXJFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IG1hcmdpbi1ib3R0b206IDhweDsnO1xuXG5cdFx0XHRjb25zdCBpbmZvRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaW5mbycgfSk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGluZm9FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbmFtZScgfSk7XG5cdFx0XHRuYW1lRWwudGV4dENvbnRlbnQgPSBjb21tYW5kLm5hbWU7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNjAwOyBtYXJnaW4tYm90dG9tOiA0cHg7JztcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaW5mb0VsLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC5pbm5lckhUTUwgPSBgPGNvZGU+OiR7Y29tbWFuZC50cmlnZ2VyfTwvY29kZT5gO1xuXHRcdFx0dHJpZ2dlckVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTsgY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGZvbnQtc2l6ZTogMC45ZW07JztcblxuXHRcdFx0Ly8gQWN0aW9uc1xuXHRcdFx0Y29uc3QgYWN0aW9uc0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWFjdGlvbnMnIH0pO1xuXHRcdFx0YWN0aW9uc0VsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7JztcblxuXHRcdFx0Y29uc3QgZWRpdEJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRWRpdCcgfSk7XG5cdFx0XHRlZGl0QnRuLnN0eWxlLmNzc1RleHQgPSAncGFkZGluZzogNHB4IDhweDsgZm9udC1zaXplOiAwLjhlbTsgYm9yZGVyLXJhZGl1czogNHB4Oyc7XG5cdFx0XHRlZGl0QnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnNob3dFZGl0Q29tbWFuZERpYWxvZyhpbmRleCk7XG5cblx0XHRcdGNvbnN0IGRlbGV0ZUJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnRGVsZXRlJyB9KTtcblx0XHRcdGRlbGV0ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGZvbnQtc2l6ZTogMC44ZW07IGJvcmRlci1yYWRpdXM6IDRweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvcik7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7Jztcblx0XHRcdGRlbGV0ZUJ0bi5vbmNsaWNrID0gKCkgPT4gdGhpcy5kZWxldGVDb21tYW5kKGluZGV4KTtcblxuXHRcdFx0Ly8gRGVzY3JpcHRpb24gYW5kIHRlbXBsYXRlIHByZXZpZXdcblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGNvbW1hbmRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtZGVzYycgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC1zaXplOiAwLjllbTsgbWFyZ2luLWJvdHRvbTogOHB4Oyc7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHRlbXBsYXRlRWwgPSBjb21tYW5kRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLXRlbXBsYXRlJyB9KTtcblx0XHRcdHRlbXBsYXRlRWwuaW5uZXJIVE1MID0gYFxuXHRcdFx0XHQ8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7IHBhZGRpbmc6IDhweDsgYm9yZGVyLXJhZGl1czogNHB4OyBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpOyBmb250LXNpemU6IDAuOGVtOyB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7IG1heC1oZWlnaHQ6IDYwcHg7IG92ZXJmbG93LXk6IGF1dG87XCI+XG5cdFx0XHRcdFx0JHtjb21tYW5kLnRlbXBsYXRlfVxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHNob3dBZGRDb21tYW5kRGlhbG9nKCkge1xuXHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coKTtcblx0fVxuXG5cdHByaXZhdGUgc2hvd0VkaXRDb21tYW5kRGlhbG9nKGluZGV4OiBudW1iZXIpIHtcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHM/LltpbmRleF07XG5cdFx0aWYgKGNvbW1hbmQpIHtcblx0XHRcdHRoaXMuc2hvd0NvbW1hbmREaWFsb2coY29tbWFuZCwgaW5kZXgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgc2hvd0NvbW1hbmREaWFsb2coZXhpc3RpbmdDb21tYW5kPzogQ3VzdG9tQ29tbWFuZCwgZWRpdEluZGV4PzogbnVtYmVyKSB7XG5cdFx0Ly8gRm9yIG5vdywgdXNlIGEgc2ltcGxlIHByb21wdC1iYXNlZCBhcHByb2FjaFxuXHRcdC8vIFRPRE86IEltcGxlbWVudCBwcm9wZXIgbW9kYWwgd2hlbiBNb2RhbCBjbGFzcyBpcyBwcm9wZXJseSBhdmFpbGFibGVcblx0XHRjb25zdCBuYW1lID0gcHJvbXB0KCdDb21tYW5kIG5hbWU6JywgZXhpc3RpbmdDb21tYW5kPy5uYW1lIHx8ICcnKTtcblx0XHRpZiAoIW5hbWUpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCB0cmlnZ2VyID0gcHJvbXB0KCdDb21tYW5kIHRyaWdnZXIgKHdpdGhvdXQgOik6JywgZXhpc3RpbmdDb21tYW5kPy50cmlnZ2VyIHx8ICcnKTtcblx0XHRpZiAoIXRyaWdnZXIpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBkZXNjcmlwdGlvbiA9IHByb21wdCgnRGVzY3JpcHRpb24gKG9wdGlvbmFsKTonLCBleGlzdGluZ0NvbW1hbmQ/LmRlc2NyaXB0aW9uIHx8ICcnKTtcblx0XHRcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IHByb21wdCgnVGVtcGxhdGUgY29udGVudDonLCBleGlzdGluZ0NvbW1hbmQ/LnRlbXBsYXRlIHx8ICcnKTtcblx0XHRpZiAoIXRlbXBsYXRlKSByZXR1cm47XG5cdFx0XG5cdFx0Y29uc3QgcmVzdWx0OiBDdXN0b21Db21tYW5kID0ge1xuXHRcdFx0aWQ6IGV4aXN0aW5nQ29tbWFuZD8uaWQgfHwgKCdjbWRfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KSksXG5cdFx0XHRuYW1lLFxuXHRcdFx0dHJpZ2dlcjogdHJpZ2dlci50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0dGVtcGxhdGUsXG5cdFx0XHRkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgdW5kZWZpbmVkXG5cdFx0fTtcblx0XHRcblx0XHRpZiAoZWRpdEluZGV4ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdC8vIEVkaXQgZXhpc3RpbmcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzW2VkaXRJbmRleF0gPSByZXN1bHQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEFkZCBuZXcgY29tbWFuZFxuXHRcdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcykgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMgPSBbXTtcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzLnB1c2gocmVzdWx0KTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblxuXHRwcml2YXRlIGRlbGV0ZUNvbW1hbmQoaW5kZXg6IG51bWJlcikge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMpIHJldHVybjtcblx0XHRcblx0XHRjb25zdCBjb21tYW5kID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHNbaW5kZXhdO1xuXHRcdGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oYERlbGV0ZSBjb21tYW5kIFwiJHtjb21tYW5kLm5hbWV9XCIgKCR7Y29tbWFuZC50cmlnZ2VyfSk/YCk7XG5cdFx0XG5cdFx0aWYgKGNvbmZpcm1lZCkge1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29tbWFuZHMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5yZW5kZXJDdXN0b21Db21tYW5kc0xpc3QodGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1jb21tYW5kLXNlY3Rpb24nKSBhcyBIVE1MRWxlbWVudCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVXZWxjb21lU2VjdGlvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3Qgd2VsY29tZVNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS13ZWxjb21lLXNlY3Rpb24nIH0pO1xuXHRcdFxuXHRcdC8vIE5vdmEgbG9nbyBhbmQgdGl0bGVcblx0XHRjb25zdCBoZWFkZXJEaXYgPSB3ZWxjb21lU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUtaGVhZGVyJyB9KTtcblx0XHRoZWFkZXJEaXYuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtd2VsY29tZS1sb2dvXCI+XG5cdFx0XHRcdCR7Tk9WQV9JQ09OX1NWR31cblx0XHRcdDwvZGl2PlxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtd2VsY29tZS1jb250ZW50XCI+XG5cdFx0XHRcdDxoMj5XZWxjb21lIHRvIE5vdmE8L2gyPlxuXHRcdFx0XHQ8cCBjbGFzcz1cIm5vdmEtdGFnbGluZVwiPllvdXIgQUkgd3JpdGluZyBwYXJ0bmVyIHRvIG1ha2UgdGhlIHdyaXRpbmcgcHJvY2VzcyBzbW9vdGhlcjwvcD5cblx0XHRcdFx0PHAgY2xhc3M9XCJub3ZhLXN0b3J5XCI+UmVtb3ZlcyB0aGUgZnJpY3Rpb24gb2YgY29weS9wYXN0ZSBmcm9tIExMTXMgdG8gT2JzaWRpYW4sIGFuZCBwcm92aWRlcyBhY3Rpb25hYmxlIGluc2lnaHRzIHRvIGhlbHAgaW1wcm92ZSB5b3VyIHdyaXRpbmc8L3A+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVRdWlja1N0YXJ0R3VpZGUoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGNvbnN0IGd1aWRlU2VjdGlvbiA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXF1aWNrLXN0YXJ0LXNlY3Rpb24nIH0pO1xuXHRcdGd1aWRlU2VjdGlvbi5zdHlsZS5tYXJnaW5Ub3AgPSAnMzJweCc7XG5cdFx0XG5cdFx0Ly8gU2VsZWN0aW9uLUJhc2VkIEVkaXRpbmdcblx0XHRjb25zdCBzZWxlY3Rpb25DYXJkID0gZ3VpZGVTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcXVpY2stc3RhcnQtY2FyZCcgfSk7XG5cdFx0c2VsZWN0aW9uQ2FyZC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jYXJkLWhlYWRlclwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtY2FyZC1pY29uXCI+XHVEODNDXHVERkFGPC9zcGFuPlxuXHRcdFx0XHQ8aDQ+U2VsZWN0aW9uLUJhc2VkIEVkaXRpbmc8L2g0PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jYXJkLWNvbnRlbnRcIj5cblx0XHRcdFx0PG9sPlxuXHRcdFx0XHRcdDxsaT5TZWxlY3QgYW55IHRleHQgaW4geW91ciBkb2N1bWVudDwvbGk+XG5cdFx0XHRcdFx0PGxpPlJpZ2h0LWNsaWNrIHRvIG9wZW4gY29udGV4dCBtZW51PC9saT5cblx0XHRcdFx0XHQ8bGk+Q2hvb3NlIE5vdmEgYWN0aW9uIChJbXByb3ZlIFdyaXRpbmcsIE1ha2UgTG9uZ2VyKTwvbGk+XG5cdFx0XHRcdFx0PGxpPldhdGNoIEFJIHRyYW5zZm9ybSB0ZXh0IGV4YWN0bHkgaW4gcGxhY2U8L2xpPlxuXHRcdFx0XHQ8L29sPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aXBcIj5cdUQ4M0RcdURDQTEgVGlwOiBTZWxlY3QgYW55IHRleHQgaW4geW91ciBkb2N1bWVudCBhbmQgcmlnaHQtY2xpY2sgdG8gc2VlIE5vdmEgYWN0aW9uczwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIENoYXQgQ29tbWFuZHNcblx0XHRjb25zdCBjaGF0Q2FyZCA9IGd1aWRlU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXF1aWNrLXN0YXJ0LWNhcmQnIH0pO1xuXHRcdGNoYXRDYXJkLnN0eWxlLm1hcmdpblRvcCA9ICcyNHB4Jztcblx0XHRjaGF0Q2FyZC5pbm5lckhUTUwgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jYXJkLWhlYWRlclwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtY2FyZC1pY29uXCI+XHVEODNEXHVEQ0FDPC9zcGFuPlxuXHRcdFx0XHQ8aDQ+Q2hhdC1CYXNlZCBUYXJnZXRpbmc8L2g0PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jYXJkLWNvbnRlbnRcIj5cblx0XHRcdFx0PG9sPlxuXHRcdFx0XHRcdDxsaT5QbGFjZSBjdXJzb3Igd2hlcmUgeW91IHdhbnQgY29udGVudDwvbGk+XG5cdFx0XHRcdFx0PGxpPlR5cGUgY29tbWFuZDogXCJBZGQgY29uY2x1c2lvbiBzZWN0aW9uXCI8L2xpPlxuXHRcdFx0XHRcdDxsaT5Ob3ZhIGVkaXRzIHByZWNpc2VseSBhdCBjdXJzb3IgbG9jYXRpb248L2xpPlxuXHRcdFx0XHQ8L29sPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aXBcIj5cdUQ4M0RcdURDRjEgV29ya3MgaWRlbnRpY2FsbHkgb24gZGVza3RvcCBhbmQgbW9iaWxlPC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXG5cdFx0Ly8gQUkgUHJvdmlkZXIgU2VsZWN0aW9uXG5cdFx0Y29uc3QgcHJvdmlkZXJDYXJkID0gZ3VpZGVTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtcXVpY2stc3RhcnQtY2FyZCcgfSk7XG5cdFx0cHJvdmlkZXJDYXJkLnN0eWxlLm1hcmdpblRvcCA9ICcyNHB4Jztcblx0XHRwcm92aWRlckNhcmQuaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtY2FyZC1oZWFkZXJcIj5cblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWNhcmQtaWNvblwiPlx1RDgzRVx1REQxNjwvc3Bhbj5cblx0XHRcdFx0PGg0PkFJIFByb3ZpZGVyIFNlbGVjdGlvbjwvaDQ+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtY29udGVudFwiPlxuXHRcdFx0XHQ8cD5DaG9vc2UgdGhlIHJpZ2h0IEFJIGZvciB5b3VyIHRhc2s6PC9wPlxuXHRcdFx0XHQ8dWw+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+Q2xhdWRlPC9zdHJvbmc+IC0gRm9yIGNvbXBsZXggcmVhc29uaW5nIGFuZCBhbmFseXNpczwvbGk+XG5cdFx0XHRcdFx0PGxpPjxzdHJvbmc+T3BlbkFJPC9zdHJvbmc+IC0gRm9yIGJhbGFuY2VkIHBlcmZvcm1hbmNlIGFuZCBjcmVhdGl2aXR5PC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5HZW1pbmk8L3N0cm9uZz4gLSBGb3IgZmFzdCByZXNwb25zZXMgYW5kIHJlc2VhcmNoPC9saT5cblx0XHRcdFx0XHQ8bGk+PHN0cm9uZz5PbGxhbWE8L3N0cm9uZz4gLSBGb3IgbG9jYWwgcHJpdmFjeSBhbmQgb2ZmbGluZSB1c2UgXHVEODNEXHVERDEyPC9saT5cblx0XHRcdFx0PC91bD5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtdGlwXCI+Q29uZmlndXJlIHByb3ZpZGVycyBpbiB0aGUgQUkgUHJvdmlkZXJzIHRhYjwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblx0fVxuXG5cblx0LyoqXG5cdCAqIEdldCBiYWRnZSBpbmZvcm1hdGlvbiBmb3IgbGljZW5zZSB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldExpY2Vuc2VCYWRnZShsaWNlbnNlOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCk6IHsgaWNvbjogc3RyaW5nOyBjb2xvcjogc3RyaW5nOyB0ZXh0OiBzdHJpbmc7IGNsYXNzTmFtZTogc3RyaW5nIH0gfCBudWxsIHtcblx0XHRpZiAoIWxpY2Vuc2UpIHJldHVybiBudWxsO1xuXHRcdFxuXHRcdHN3aXRjaChsaWNlbnNlLnR5cGUpIHtcblx0XHRcdGNhc2UgJ2ZvdW5kaW5nJzpcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0aWNvbjogJ1x1MkI1MCcsIFxuXHRcdFx0XHRcdGNvbG9yOiAnI2ZkY2I2ZScsXG5cdFx0XHRcdFx0dGV4dDogJ0ZvdW5kaW5nIFN1cGVybm92YScsXG5cdFx0XHRcdFx0Y2xhc3NOYW1lOiAnZm91bmRpbmcnXG5cdFx0XHRcdH07XG5cdFx0XHRjYXNlICdsaWZldGltZSc6XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdGljb246ICdcdTIyMUUnLCBcblx0XHRcdFx0XHRjb2xvcjogJyM5MzMzZWEnLFxuXHRcdFx0XHRcdHRleHQ6ICdMaWZldGltZSBTdXBlcm5vdmEnLFxuXHRcdFx0XHRcdGNsYXNzTmFtZTogJ2xpZmV0aW1lJ1xuXHRcdFx0XHR9O1xuXHRcdFx0Y2FzZSAnYW5udWFsJzpcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0aWNvbjogJ1x1RDgzRFx1REU4MCcsIFxuXHRcdFx0XHRcdGNvbG9yOiAnIzNiODJmNicsXG5cdFx0XHRcdFx0dGV4dDogJ1N1cGVybm92YScsXG5cdFx0XHRcdFx0Y2xhc3NOYW1lOiAnc3VwZXJub3ZhJ1xuXHRcdFx0XHR9O1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFMaWNlbnNlSW5wdXQoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdC8vIEN1cnJlbnQgU3VwZXJub3ZhIHN0YXR1c1xuXHRcdGNvbnN0IGlzU3VwZXJub3ZhID0gdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXI/LmlzU3VwZXJub3ZhU3VwcG9ydGVyKCkgfHwgZmFsc2U7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhTGljZW5zZSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5nZXRTdXBlcm5vdmFMaWNlbnNlKCk7XG5cdFx0XG5cdFx0Ly8gU3RhdHVzIGRpc3BsYXlcblx0XHRpZiAoc3VwZXJub3ZhTGljZW5zZSkge1xuXHRcdFx0Y29uc3QgYmFkZ2UgPSB0aGlzLmdldExpY2Vuc2VCYWRnZShzdXBlcm5vdmFMaWNlbnNlKTtcblx0XHRcdGNvbnN0IHN0YXR1c0VsID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbGljZW5zZS1zdGF0dXMnIH0pO1xuXHRcdFx0Y29uc3QgZXhwaXJ5VGV4dCA9IHN1cGVybm92YUxpY2Vuc2UuZXhwaXJlc0F0IFxuXHRcdFx0XHQ/IGBFeHBpcmVzICR7c3VwZXJub3ZhTGljZW5zZS5leHBpcmVzQXQudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdFx0XHQ6ICdMaWZldGltZSBMaWNlbnNlJztcblx0XHRcdHN0YXR1c0VsLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtbGljZW5zZS12YWxpZGF0ZWRcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1saWNlbnNlLWhlYWRlclwiPlxuXHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWxpY2Vuc2UtY2hlY2ttYXJrXCI+XHUyNzEzPC9zcGFuPlxuXHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWxpY2Vuc2UtdGl0bGVcIj4ke2JhZGdlPy50ZXh0IHx8ICdWYWxpZCBTdXBlcm5vdmEgTGljZW5zZSd9PC9zcGFuPlxuXHRcdFx0XHRcdFx0JHtiYWRnZSA/IGA8c3BhbiBjbGFzcz1cIm5vdmEtbGljZW5zZS1iYWRnZSAke2JhZGdlLmNsYXNzTmFtZX1cIiBzdHlsZT1cImJhY2tncm91bmQ6ICR7YmFkZ2UuY29sb3J9O1wiPiR7YmFkZ2UuaWNvbn08L3NwYW4+YCA6ICcnfVxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWxpY2Vuc2UtZGV0YWlsc1wiPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtbGljZW5zZS1lbWFpbFwiPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtbGljZW5zZS1sYWJlbFwiPkxpY2Vuc2VkIHRvOjwvc3Bhbj5cblx0XHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLWxpY2Vuc2UtdmFsdWVcIj4ke3N1cGVybm92YUxpY2Vuc2UuZW1haWx9PC9zcGFuPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1saWNlbnNlLWV4cGlyeVwiPlxuXHRcdFx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cIm5vdmEtbGljZW5zZS1sYWJlbFwiPlN0YXR1czo8L3NwYW4+XG5cdFx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1saWNlbnNlLXZhbHVlXCI+JHtleHBpcnlUZXh0fTwvc3Bhbj5cblx0XHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdGA7XG5cdFx0fVxuXG5cdFx0Ly8gTGljZW5zZSBrZXkgaW5wdXQgLSBzdHlsZWQgbGlrZSBBUEkga2V5c1xuXHRcdHRoaXMuY3JlYXRlU2VjdXJlQXBpS2V5SW5wdXQoY29udGFpbmVyLCB7XG5cdFx0XHRuYW1lOiAnTGljZW5zZSBLZXknLFxuXHRcdFx0ZGVzYzogJ0VudGVyIHlvdXIgU3VwZXJub3ZhIHN1cHBvcnRlciBsaWNlbnNlIGtleScsXG5cdFx0XHRwbGFjZWhvbGRlcjogJ05PVkEtWFhYWC1YWFhYLVhYWFgnLFxuXHRcdFx0dmFsdWU6IHRoaXMucGx1Z2luLnNldHRpbmdzLmxpY2Vuc2luZy5zdXBlcm5vdmFMaWNlbnNlS2V5IHx8ICcnLFxuXHRcdFx0b25DaGFuZ2U6IGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saWNlbnNpbmcuc3VwZXJub3ZhTGljZW5zZUtleSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFVwZGF0ZSBTdXBlcm5vdmEgbGljZW5zZSBpbiBmZWF0dXJlIG1hbmFnZXJcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIudXBkYXRlU3VwZXJub3ZhTGljZW5zZSh2YWx1ZSB8fCBudWxsKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIHNpZGViYXIgdG8gdXBkYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdFx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX05PVkFfU0lERUJBUik7XG5cdFx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE5vdmFTaWRlYmFyVmlldztcblx0XHRcdFx0XHRcdHNpZGViYXJWaWV3LnJlZnJlc2hTdXBlcm5vdmFVSSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBSZWZyZXNoIHRoZSBjb250ZW50IHRvIHNob3cgdXBkYXRlZCBzdGF0dXNcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRhYkNvbnRlbnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gQWRkIHZhbGlkYXRpb24gc3RhdHVzIG1lc3NhZ2UgaWYgbmVlZGVkXG5cdFx0Y29uc3QgdmFsaWRhdGlvbkVsID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtdmFsaWRhdGlvbi1zdGF0dXMnIH0pO1xuXHRcdHZhbGlkYXRpb25FbC5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4Jztcblx0XHR2YWxpZGF0aW9uRWwuc3R5bGUuZm9udFNpemUgPSAnMC45ZW0nO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVTdXBlcm5vdmFDVEEoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgb3B0aW9uczoge1xuXHRcdHNob3dPbmx5SWZOb3RTdXBwb3J0ZXI/OiBib29sZWFuO1xuXHRcdGJ1dHRvbkFjdGlvbj86ICd0YWInIHwgJ2RpcmVjdCc7XG5cdFx0c2hvd0xlYXJuTW9yZT86IGJvb2xlYW47XG5cdFx0bWFyZ2luVG9wPzogc3RyaW5nO1xuXHRcdG1hcmdpbkJvdHRvbT86IHN0cmluZztcblx0fSA9IHt9KTogdm9pZCB7XG5cdFx0Ly8gRGVmYXVsdCBvcHRpb25zXG5cdFx0Y29uc3Qge1xuXHRcdFx0c2hvd09ubHlJZk5vdFN1cHBvcnRlciA9IGZhbHNlLFxuXHRcdFx0YnV0dG9uQWN0aW9uID0gJ3RhYicsXG5cdFx0XHRzaG93TGVhcm5Nb3JlID0gdHJ1ZSxcblx0XHRcdG1hcmdpblRvcCA9ICcwJyxcblx0XHRcdG1hcmdpbkJvdHRvbSA9ICczMnB4J1xuXHRcdH0gPSBvcHRpb25zO1xuXHRcdFxuXHRcdC8vIENoZWNrIHN1cHBvcnRlciBzdGF0dXNcblx0XHRjb25zdCBpc1N1cGVybm92YSA9IHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyPy5pc1N1cGVybm92YVN1cHBvcnRlcigpIHx8IGZhbHNlO1xuXHRcdFxuXHRcdC8vIERvbid0IHJlbmRlciBpZiB1c2VyIGlzIGFscmVhZHkgYSBzdXBwb3J0ZXIgYW5kIHdlIG9ubHkgd2FudCB0byBzaG93IGZvciBub24tc3VwcG9ydGVyc1xuXHRcdGlmIChzaG93T25seUlmTm90U3VwcG9ydGVyICYmIGlzU3VwZXJub3ZhKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IHN0YXR1c1RleHQgPSBpc1N1cGVybm92YSA/ICdTdXBlcm5vdmEgU3VwcG9ydGVyJyA6ICdOb3ZhIFVzZXInO1xuXHRcdGNvbnN0IHN0YXR1c0ljb24gPSBpc1N1cGVybm92YSA/ICdcdTJCNTAnIDogJ1x1RDgzQ1x1REYxRic7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIHRoZSBDVEEgc2VjdGlvblxuXHRcdGNvbnN0IGN0YVNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm9taW5lbnQtc3VwZXJub3ZhLXNlY3Rpb24nIH0pO1xuXHRcdGN0YVNlY3Rpb24uc3R5bGUubWFyZ2luVG9wID0gbWFyZ2luVG9wO1xuXHRcdGN0YVNlY3Rpb24uc3R5bGUubWFyZ2luQm90dG9tID0gbWFyZ2luQm90dG9tO1xuXHRcdFxuXHRcdGN0YVNlY3Rpb24uaW5uZXJIVE1MID0gYFxuXHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3VwZXJub3ZhLWN0YVwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1zdXBlcm5vdmEtaGVhZGVyXCI+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJub3ZhLXN1cGVybm92YS1pY29uXCI+JHtzdGF0dXNJY29ufTwvc3Bhbj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1zdXBlcm5vdmEtaW5mb1wiPlxuXHRcdFx0XHRcdFx0PGgzPlN1cGVybm92YSBTdXBwb3J0PC9oMz5cblx0XHRcdFx0XHRcdDxwPlN0YXR1czogPHN0cm9uZz4ke3N0YXR1c1RleHR9PC9zdHJvbmc+PC9wPlxuXHRcdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtc3VwZXJub3ZhLWFjdGlvbnNcIj5cblx0XHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibm92YS1zdXBlcm5vdmEtYnRuIHByaW1hcnlcIiAke2J1dHRvbkFjdGlvbiA9PT0gJ3RhYicgPyAnZGF0YS10YWI9XCJzdXBlcm5vdmFcIicgOiAnJ30+XG5cdFx0XHRcdFx0XHQke2lzU3VwZXJub3ZhID8gKGJ1dHRvbkFjdGlvbiA9PT0gJ3RhYicgPyAnTWFuYWdlIExpY2Vuc2UnIDogJ1RoYW5rIFlvdSBmb3IgU3VwcG9ydGluZyEnKSA6ICdCZWNvbWUgYSBTdXBwb3J0ZXInfVxuXHRcdFx0XHRcdDwvYnV0dG9uPlxuXHRcdFx0XHRcdCR7c2hvd0xlYXJuTW9yZSA/ICc8YnV0dG9uIGNsYXNzPVwibm92YS1zdXBlcm5vdmEtYnRuIHNlY29uZGFyeVwiIGRhdGEtdGFiPVwic3VwZXJub3ZhXCI+TGVhcm4gTW9yZTwvYnV0dG9uPicgOiAnJ31cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHRgO1xuXHRcdFxuXHRcdC8vIEFkZCBjbGljayBoYW5kbGVycyBpZiB1c2luZyB0YWIgbmF2aWdhdGlvblxuXHRcdGlmIChidXR0b25BY3Rpb24gPT09ICd0YWInKSB7XG5cdFx0XHRjdGFTZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRhYj1cInN1cGVybm92YVwiXScpLmZvckVhY2goYnV0dG9uID0+IHtcblx0XHRcdFx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0dGhpcy5zd2l0Y2hUYWIoJ3N1cGVybm92YScpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlTmF2aWdhdGlvbkhlbHAoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGNvbnN0IG5hdlNlY3Rpb24gPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1uYXZpZ2F0aW9uLXNlY3Rpb24nIH0pO1xuXHRcdG5hdlNlY3Rpb24uc3R5bGUubWFyZ2luVG9wID0gJzMycHgnO1xuXHRcdFxuXHRcdGNvbnN0IG5hdkNhcmQgPSBuYXZTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogJ25vdmEtbmF2aWdhdGlvbi1jYXJkJyB9KTtcblx0XHRuYXZDYXJkLmlubmVySFRNTCA9IGBcblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtaGVhZGVyXCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwibm92YS1jYXJkLWljb25cIj5cdTI2QTE8L3NwYW4+XG5cdFx0XHRcdDxoND5RdWljayBTdGFydDwvaDQ+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLWNhcmQtY29udGVudFwiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1uZXh0LXN0ZXBzXCI+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtbmV4dC1zdGVwXCI+XG5cdFx0XHRcdFx0XHQ8c3Bhbj4xLiBFeHBsb3JlIFByaXZhY3kgYW5kIEdlbmVyYWwgU2V0dGluZ3M8L3NwYW4+XG5cdFx0XHRcdFx0XHQ8YSBocmVmPVwiI1wiIGNsYXNzPVwibm92YS1zdGVwLWxpbmtcIiBkYXRhLXRhYj1cImdlbmVyYWxcIj5cdTIxOTIgR28gdG8gR2VuZXJhbCB0YWI8L2E+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtbmV4dC1zdGVwXCI+XG5cdFx0XHRcdFx0XHQ8c3Bhbj4yLiBDb25maWd1cmUgQUkgcHJvdmlkZXJzPC9zcGFuPlxuXHRcdFx0XHRcdFx0PGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5vdmEtc3RlcC1saW5rXCIgZGF0YS10YWI9XCJwcm92aWRlcnNcIj5cdTIxOTIgR28gdG8gQUkgUHJvdmlkZXJzIHRhYjwvYT5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1uZXh0LXN0ZXBcIj5cblx0XHRcdFx0XHRcdDxzcGFuPjMuIE1hbmFnZSBTdXBlcm5vdmEgTGljZW5zZTwvc3Bhbj5cblx0XHRcdFx0XHRcdDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJub3ZhLXN0ZXAtbGlua1wiIGRhdGEtdGFiPVwic3VwZXJub3ZhXCI+XHUyMTkyIEdvIHRvIFN1cGVybm92YSB0YWI8L2E+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS10aXBcIj5cdUQ4M0RcdURDQTEgVGlwOiBQcmVzcyBDbWQrUCAoTWFjKSBvciBDdHJsK1AgKFBDKSwgdGhlbiBjaG9vc2UgXCJOb3ZhOiBPcGVuIHNpZGViYXJcIiB0byBhY2Nlc3MgTm92YTwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdC8vIEFkZCBjbGljayBoYW5kbGVycyBmb3IgbmF2aWdhdGlvbiBsaW5rc1xuXHRcdG5hdkNhcmQucXVlcnlTZWxlY3RvckFsbCgnLm5vdmEtc3RlcC1saW5rJykuZm9yRWFjaChsaW5rID0+IHtcblx0XHRcdGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGNvbnN0IHRhYklkID0gKGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiJykgYXMgJ2dlbmVyYWwnIHwgJ3Byb3ZpZGVycycgfCAnc3VwZXJub3ZhJztcblx0XHRcdFx0dGhpcy5zd2l0Y2hUYWIodGFiSWQpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIEJ1dHRvbkNvbXBvbmVudCwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlLCBOb3RpY2UsIE1hcmtkb3duVmlldywgUGxhdGZvcm0sIHNldEljb24sIEVkaXRvclBvc2l0aW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRBbmFseXplciB9IGZyb20gJy4uL2NvcmUvZG9jdW1lbnQtYW5hbHlzaXMnO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IE11bHRpRG9jQ29udGV4dCB9IGZyb20gJy4vY29udGV4dC1tYW5hZ2VyJztcbmltcG9ydCB7IGdldEF2YWlsYWJsZU1vZGVscywgZ2V0UHJvdmlkZXJUeXBlRm9yTW9kZWwgfSBmcm9tICcuLi9haS9tb2RlbHMnO1xuaW1wb3J0IHsgUHJvdmlkZXJUeXBlIH0gZnJvbSAnLi4vYWkvdHlwZXMnO1xuaW1wb3J0IHsgSW5wdXRIYW5kbGVyIH0gZnJvbSAnLi9pbnB1dC1oYW5kbGVyJztcbmltcG9ydCB7IENvbW1hbmRTeXN0ZW0gfSBmcm9tICcuL2NvbW1hbmQtc3lzdGVtJztcbmltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9jb250ZXh0LW1hbmFnZXInO1xuaW1wb3J0IHsgQ2hhdFJlbmRlcmVyIH0gZnJvbSAnLi9jaGF0LXJlbmRlcmVyJztcbmltcG9ydCB7IFN0cmVhbWluZ01hbmFnZXIgfSBmcm9tICcuL3N0cmVhbWluZy1tYW5hZ2VyJztcbmltcG9ydCB7IFNlbGVjdGlvbkNvbnRleHRNZW51LCBTRUxFQ1RJT05fQUNUSU9OUyB9IGZyb20gJy4vc2VsZWN0aW9uLWNvbnRleHQtbWVudSc7XG5pbXBvcnQgeyBmb3JtYXRDb250ZXh0VXNhZ2UsIGdldFJlbWFpbmluZ0NvbnRleHRQZXJjZW50YWdlLCBnZXRDb250ZXh0V2FybmluZ0xldmVsLCBnZXRDb250ZXh0VG9vbHRpcCB9IGZyb20gJy4uL2NvcmUvY29udGV4dC1jYWxjdWxhdG9yJztcblxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9OT1ZBX1NJREVCQVIgPSAnbm92YS1zaWRlYmFyJztcblxuZXhwb3J0IGNsYXNzIE5vdmFTaWRlYmFyVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcblx0cGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNoYXRDb250YWluZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBpbnB1dENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGN1cnJlbnRDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBsYXN0VG9rZW5XYXJuaW5nczogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHt9O1xuXHRcblx0Ly8gUEhBU0UgMyBGSVg6IFJhY2UgY29uZGl0aW9uIHByZXZlbnRpb25cblx0cHJpdmF0ZSBjdXJyZW50RmlsZUxvYWRPcGVyYXRpb246IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXHRcblx0Ly8gVHJhY2sgdXNlci1pbml0aWF0ZWQgcHJvdmlkZXIgY2hhbmdlcyB0byBwcmV2ZW50IHNwdXJpb3VzIG1lc3NhZ2VzXG5cdHByaXZhdGUgaXNVc2VySW5pdGlhdGVkUHJvdmlkZXJDaGFuZ2U6IGJvb2xlYW4gPSBmYWxzZTtcblx0XG5cdC8vIE5ldyBhcmNoaXRlY3R1cmUgY29tcG9uZW50c1xuXHRwcml2YXRlIGlucHV0SGFuZGxlciE6IElucHV0SGFuZGxlcjtcblx0cHJpdmF0ZSBjb21tYW5kU3lzdGVtITogQ29tbWFuZFN5c3RlbTtcblx0cHJpdmF0ZSBjb250ZXh0TWFuYWdlciE6IENvbnRleHRNYW5hZ2VyO1xuXHRwcml2YXRlIGNoYXRSZW5kZXJlciE6IENoYXRSZW5kZXJlcjtcblx0cHJpdmF0ZSBzdHJlYW1pbmdNYW5hZ2VyITogU3RyZWFtaW5nTWFuYWdlcjtcblx0cHJpdmF0ZSBzZWxlY3Rpb25Db250ZXh0TWVudSE6IFNlbGVjdGlvbkNvbnRleHRNZW51O1xuXHRcblx0Ly8gQ3Vyc29yLW9ubHkgYXJjaGl0ZWN0dXJlIC0gZGVsZWdhdGUgdG8gbmV3IGNvbXBvbmVudHNcblx0cHJpdmF0ZSBnZXQgdGV4dEFyZWEoKSB7IHJldHVybiB0aGlzLmlucHV0SGFuZGxlcj8uZ2V0VGV4dEFyZWEoKTsgfVxuXHRwcml2YXRlIGdldCB3aWtpbGlua0F1dG9jb21wbGV0ZSgpIHsgcmV0dXJuIHRoaXMuaW5wdXRIYW5kbGVyID8geyBkZXN0cm95OiAoKSA9PiB7fSB9IDogbnVsbDsgfVxuXHRwcml2YXRlIGdldCBhdXRvR3Jvd1RleHRhcmVhKCkgeyByZXR1cm4gKCkgPT4ge307IH1cblx0XG5cdC8vIENvbW1hbmQgc3lzdGVtIGRlbGVnYXRpb25cblx0cHJpdmF0ZSBfY29tbWFuZFBpY2tlckl0ZW1zOiBhbnlbXSA9IFtdO1xuXHRwcml2YXRlIGdldCBjb21tYW5kUGlja2VySXRlbXMoKSB7IHJldHVybiB0aGlzLl9jb21tYW5kUGlja2VySXRlbXM7IH1cblx0cHJpdmF0ZSBzZXQgY29tbWFuZFBpY2tlckl0ZW1zKHZhbHVlOiBhbnlbXSkgeyB0aGlzLl9jb21tYW5kUGlja2VySXRlbXMgPSB2YWx1ZTsgfVxuXHRwcml2YXRlIF9zZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyID0gLTE7XG5cdHByaXZhdGUgZ2V0IHNlbGVjdGVkQ29tbWFuZEluZGV4KCkgeyByZXR1cm4gdGhpcy5fc2VsZWN0ZWRDb21tYW5kSW5kZXg7IH1cblx0cHJpdmF0ZSBzZXQgc2VsZWN0ZWRDb21tYW5kSW5kZXgodmFsdWU6IG51bWJlcikgeyB0aGlzLl9zZWxlY3RlZENvbW1hbmRJbmRleCA9IHZhbHVlOyB9XG5cdHByaXZhdGUgX2lzQ29tbWFuZE1lbnVWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgZ2V0IGlzQ29tbWFuZE1lbnVWaXNpYmxlKCkgeyByZXR1cm4gdGhpcy5faXNDb21tYW5kTWVudVZpc2libGU7IH1cblx0cHJpdmF0ZSBzZXQgaXNDb21tYW5kTWVudVZpc2libGUodmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5faXNDb21tYW5kTWVudVZpc2libGUgPSB2YWx1ZTsgfVxuXHRcblx0Ly8gQ29udGV4dCBzeXN0ZW0gZGVsZWdhdGlvblxuXHRwcml2YXRlIGdldCBjb250ZXh0UHJldmlldygpIHsgcmV0dXJuIHRoaXMuY29udGV4dE1hbmFnZXI/LmNvbnRleHRQcmV2aWV3OyB9XG5cdHByaXZhdGUgZ2V0IGNvbnRleHRJbmRpY2F0b3IoKSB7IHJldHVybiB0aGlzLmNvbnRleHRNYW5hZ2VyPy5jb250ZXh0SW5kaWNhdG9yOyB9XG5cdFxuXHQvLyBDb21wb25lbnQgcmVmZXJlbmNlc1xuXHRwcml2YXRlIGNvbW1hbmRQaWNrZXIhOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjb21tYW5kTWVudSE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIGNvbW1hbmRCdXR0b24hOiBCdXR0b25Db21wb25lbnQ7XG5cdFxuXHQvLyBDdXJzb3IgcG9zaXRpb24gdHJhY2tpbmcgLSBmaWxlLXNjb3BlZCBsaWtlIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG5cdHByaXZhdGUgY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbjogRWRpdG9yUG9zaXRpb24gfCBudWxsID0gbnVsbDtcblx0XG5cdC8vIERvY3VtZW50IGRyYXdlciBzdGF0ZSAodHJhbnNpZW50IC0gYWx3YXlzIHN0YXJ0cyBjbG9zZWQgb24gZmlsZSBzd2l0Y2gpXG5cdHByaXZhdGUgaXNEcmF3ZXJPcGVuOiBib29sZWFuID0gZmFsc2U7XG5cdHByaXZhdGUgY29udGV4dERyYXdlckNsb3NlSGFuZGxlcjogRXZlbnRMaXN0ZW5lciB8IG51bGwgPSBudWxsO1xuXHRcblx0XG5cdC8vIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiAtIGRlYm91bmNpbmcgYW5kIHRpbWluZyBjb25zdGFudHNcblx0cHJpdmF0ZSBjb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ09OVEVYVF9QUkVWSUVXX0RFQk9VTkNFX01TID0gMzAwO1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBTQ1JPTExfREVMQVlfTVMgPSA1MDtcblx0cHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRk9DVVNfREVMQVlfTVMgPSAxNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEhPVkVSX1RJTUVPVVRfTVMgPSAxNTA7XG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE5PVElDRV9EVVJBVElPTl9NUyA9IDUwMDA7XG5cdFxuXHQvLyBFdmVudCBsaXN0ZW5lciBjbGVhbnVwIHRyYWNraW5nXG5cdHByaXZhdGUgZG9jdW1lbnRFdmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblx0cHJpdmF0ZSB0aW1lb3V0czogTm9kZUpTLlRpbWVvdXRbXSA9IFtdO1xuXG5cdGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTm92YVBsdWdpbikge1xuXHRcdHN1cGVyKGxlYWYpO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdFxuXHRcdC8vIExpc3RlbiBmb3IgcHJvdmlkZXIgY29uZmlndXJhdGlvbiBldmVudHNcblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdub3ZhLXByb3ZpZGVyLWNvbmZpZ3VyZWQnIGFzIGFueSwgdGhpcy5oYW5kbGVQcm92aWRlckNvbmZpZ3VyZWQuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnbm92YS1wcm92aWRlci1kaXNjb25uZWN0ZWQnIGFzIGFueSwgdGhpcy5oYW5kbGVQcm92aWRlckRpc2Nvbm5lY3RlZC5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdGdldFZpZXdUeXBlKCkge1xuXHRcdHJldHVybiBWSUVXX1RZUEVfTk9WQV9TSURFQkFSO1xuXHR9XG5cblx0Z2V0RGlzcGxheVRleHQoKSB7XG5cdFx0cmV0dXJuICdOb3ZhJztcblx0fVxuXG5cdGdldEljb24oKSB7XG5cdFx0cmV0dXJuICdub3ZhLXN0YXInO1xuXHR9XG5cblx0LyoqXG5cdCAqIENlbnRyYWxpemVkIGNhbGxiYWNrIGZvciB3aGVuIGFueSBzdHJlYW1pbmcgb3BlcmF0aW9uIGNvbXBsZXRlc1xuXHQgKiBVcGRhdGVzIGFsbCBVSSBlbGVtZW50cyB0aGF0IGRlcGVuZCBvbiBkb2N1bWVudCBjb250ZW50XG5cdCAqL1xuXHRwcml2YXRlIG9uU3RyZWFtaW5nQ29tcGxldGUoKTogdm9pZCB7XG5cdFx0Ly8gVXBkYXRlIGRvY3VtZW50IHN0YXRzIGFuZCBjb250ZXh0IHJlbWFpbmluZ1xuXHRcdHRoaXMucmVmcmVzaEFsbFN0YXRzKCk7XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGluZGljYXRvcnNcblx0XHR0aGlzLnJlZnJlc2hDb250ZXh0KCk7XG5cdH1cblxuXHRhc3luYyBvbk9wZW4oKSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcblx0XHRjb250YWluZXIuZW1wdHkoKTtcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ25vdmEtc2lkZWJhci1jb250YWluZXInKTtcblx0XHRcblx0XHQvLyBBZGQgcGxhdGZvcm0tc3BlY2lmaWMgY2xhc3MgZm9yIHN0eWxpbmdcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdGNvbnRhaW5lci5hZGRDbGFzcygnaXMtbW9iaWxlJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRhaW5lci5hZGRDbGFzcygnaXMtZGVza3RvcCcpO1xuXHRcdH1cblxuXHRcdC8vIE1vYmlsZSBhY2Nlc3MgaXMgbm93IGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgd2l0aCB0aGVpciBvd24gQVBJIGtleXNcblx0XHRcblx0XHQvLyBDcmVhdGUgd3JhcHBlciB3aXRoIHByb3BlciBmbGV4IGxheW91dFxuXHRcdGNvbnN0IHdyYXBwZXJFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdyYXBwZXInIH0pO1xuXHRcdHdyYXBwZXJFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdFx0XHRoZWlnaHQ6IDEwMCU7XG5cdFx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdFx0cGFkZGluZy1ib3R0b206ICR7UGxhdGZvcm0uaXNEZXNrdG9wQXBwID8gJ3ZhcigtLXNpemUtNC02KScgOiAndmFyKC0tc2l6ZS00LTUpJ307XG5cdFx0YDtcblx0XHRcblx0XHQvLyBIZWFkZXIgd2l0aCBwcm92aWRlciBpbmZvXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB3cmFwcGVyRWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1oZWFkZXInIH0pO1xuXHRcdGhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIFRvcCByb3cgY29udGFpbmVyIGZvciB0aXRsZSBhbmQgY29udHJvbHNcblx0XHRjb25zdCB0b3BSb3dFbCA9IGhlYWRlckVsLmNyZWF0ZURpdigpO1xuXHRcdHRvcFJvd0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRgO1xuXHRcdFxuXHRcdC8vIExlZnQgc2lkZTogVGl0bGUgd2l0aCBOb3ZhIGljb25cblx0XHRjb25zdCB0aXRsZUVsID0gdG9wUm93RWwuY3JlYXRlRWwoJ2g0Jyk7XG5cdFx0dGl0bGVFbC5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbjogMDsgZm9udC1zaXplOiB2YXIoLS1mb250LXVpLW1lZGl1bSk7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogdmFyKC0tc2l6ZS0yLTIpOyBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsnO1xuXHRcdHRpdGxlRWwuaW5uZXJIVE1MID0gYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6IHZhcigtLWljb24tc2l6ZSk7IGhlaWdodDogdmFyKC0taWNvbi1zaXplKTtcIj5cblx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMi41XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTEyIDE4TDEyIDIzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTIzIDEyTDE4IDEyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0PHBhdGggZD1cIk0xOC4zNjQgNS42MzZMMTUuNTM2IDguNDY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdDxwYXRoIGQ9XCJNOC40NjQgMTUuNTM2TDUuNjM2IDE4LjM2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHQ8cGF0aCBkPVwiTTguNDY0IDguNDY0TDUuNjM2IDUuNjM2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHQ8L3N2Zz5Ob3ZhYDtcblx0XHRcblx0XHQvLyBSaWdodCBzaWRlOiBQcm92aWRlciBzdGF0dXMgYW5kIENsZWFyIGJ1dHRvblxuXHRcdGNvbnN0IHJpZ2h0Q29udGFpbmVyID0gdG9wUm93RWwuY3JlYXRlRGl2KCk7XG5cdFx0cmlnaHRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IHZhcigtLXNpemUtMi0zKTsnO1xuXHRcdFxuXHRcdC8vIFByaXZhY3kgaW5kaWNhdG9yIHBpbGxcblx0XHRjb25zdCBwcml2YWN5SW5kaWNhdG9yID0gcmlnaHRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcml2YWN5LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy51cGRhdGVQcml2YWN5SW5kaWNhdG9yKHByaXZhY3lJbmRpY2F0b3IpO1xuXHRcdFxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgdXBkYXRlc1xuXHRcdCh0aGlzIGFzIGFueSkucHJpdmFjeUluZGljYXRvciA9IHByaXZhY3lJbmRpY2F0b3I7XG5cdFx0XG5cdFx0Ly8gQWxsIHVzZXJzIGNhbiBzd2l0Y2ggcHJvdmlkZXJzIGZyZWVseVxuXHRcdGF3YWl0IHRoaXMuY3JlYXRlUHJvdmlkZXJEcm9wZG93bihyaWdodENvbnRhaW5lcik7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgQ2hhdCBidXR0b24gaW4gcmlnaHQgY29udGFpbmVyXG5cdFx0Y29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHJpZ2h0Q29udGFpbmVyKTtcblx0XHRjbGVhckJ1dHRvbi5zZXRJY29uKCdlcmFzZXInKVxuXHRcdFx0LnNldFRvb2x0aXAoJ0NsZWFyIGNvbnZlcnNhdGlvbiBoaXN0b3J5Jylcblx0XHRcdC5vbkNsaWNrKCgpID0+IHRoaXMuY2xlYXJDaGF0KCkpO1xuXHRcdFxuXHRcdC8vIEFwcGx5IGNvbnNpc3RlbnQgc3R5bGluZyB0byBtYXRjaCBkZWxldGUgYWxsIGZpbGVzIGJ1dHRvblxuXHRcdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0Y2xlYXJCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGJhY2tncm91bmQ6IG5vbmU7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnOHB4IDEycHgnIDogJzRweCA4cHgnfTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRtaW4td2lkdGg6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0bWluLWhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdGA7XG5cblx0XHR0aGlzLmNyZWF0ZUNoYXRJbnRlcmZhY2Uod3JhcHBlckVsKTtcblx0XHR0aGlzLmNyZWF0ZUlucHV0SW50ZXJmYWNlKHdyYXBwZXJFbCk7XG5cdFx0XG5cdFx0Ly8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXIgZm9yIGFjdGl2ZSBmaWxlIGNoYW5nZXNcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcblx0XHRcdFx0dGhpcy5sb2FkQ29udmVyc2F0aW9uRm9yQWN0aXZlRmlsZSgpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGN1cnNvciBwb3NpdGlvbiB0cmFja2luZyBmb3IgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1jaGFuZ2UnLCAoZWRpdG9yKSA9PiB7XG5cdFx0XHRcdHRoaXMudHJhY2tDdXJzb3JQb3NpdGlvbihlZGl0b3IpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHRcdFxuXHRcdC8vIFJlZ2lzdGVyIGJsdXIgbGlzdGVuZXIgZm9yIHN0YXRzIHVwZGF0ZXMgd2hlbiBlZGl0b3IgbG9zZXMgZm9jdXNcblx0XHR0aGlzLnNldHVwRWRpdG9yQmx1ckxpc3RlbmVyKCk7XG5cdFx0XG5cdFx0Ly8gTG9hZCBjb252ZXJzYXRpb24gZm9yIGN1cnJlbnQgZmlsZVxuXHRcdHRoaXMubG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKTtcblx0XHRcblx0XHQvLyBTZXQgY29tcGxldGlvbiBjYWxsYmFjayBvbiBwbHVnaW4ncyBzZWxlY3Rpb24gY29udGV4dCBtZW51XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNlbGVjdGlvbkNvbnRleHRNZW51KSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZWxlY3Rpb25Db250ZXh0TWVudS5zZXRDb21wbGV0aW9uQ2FsbGJhY2soKCkgPT4gdGhpcy5vblN0cmVhbWluZ0NvbXBsZXRlKCkpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBJbml0aWFsIHN0YXR1cyByZWZyZXNoIHRvIGVuc3VyZSBhbGwgaW5kaWNhdG9ycyBhcmUgdXAgdG8gZGF0ZSAobm90IHVzZXItaW5pdGlhdGVkKVxuXHRcdHRoaXMuaXNVc2VySW5pdGlhdGVkUHJvdmlkZXJDaGFuZ2UgPSBmYWxzZTtcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hQcm92aWRlclN0YXR1cygpO1xuXHRcdFxuXHRcdC8vIE5vdGU6IEF1dG8tZm9jdXMgcmVtb3ZlZCB0byBwcmV2ZW50IHN0ZWFsaW5nIGN1cnNvciBmcm9tIGVkaXRvclxuXHR9XG5cblx0LyoqXG5cdCAqIFRyYWNrIGN1cnNvciBwb3NpdGlvbiBjaGFuZ2VzIGluIHRoZSBhY3RpdmUgZWRpdG9yIChmaWxlLXNjb3BlZClcblx0ICovXG5cdHByaXZhdGUgdHJhY2tDdXJzb3JQb3NpdGlvbihlZGl0b3I6IGFueSkge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdGlmICghYWN0aXZlRmlsZSB8fCAhZWRpdG9yKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIE9ubHkgdHJhY2sgY3Vyc29yIHBvc2l0aW9uIGlmIHRoaXMgaXMgdGhlIGN1cnJlbnQgZmlsZSB3ZSdyZSB3b3JraW5nIHdpdGhcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSAmJiBhY3RpdmVGaWxlLnBhdGggPT09IHRoaXMuY3VycmVudEZpbGUucGF0aCkge1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRcdFx0aWYgKGN1cnNvclBvcykge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRGaWxlQ3Vyc29yUG9zaXRpb24gPSBjdXJzb3JQb3M7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHQvKipcblx0ICogUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24gZm9yIGN1cnJlbnQgZmlsZSAoZmlsZS1zY29wZWQpXG5cdCAqL1xuXHRwcml2YXRlIHJlc3RvcmVDdXJzb3JQb3NpdGlvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZUN1cnNvclBvc2l0aW9uKSB7XG5cdFx0XHQvLyBSZXN0b3JlIHdpdGhvdXQgc3RlYWxpbmcgZm9jdXNcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNldHVwIGZvY3VzLWJhc2VkIHN0YXRzIHVwZGF0ZXMgdXNpbmcgTm92YSBpbnB1dCBmb2N1cyBhcyB0cmlnZ2VyXG5cdCAqL1xuXHRwcml2YXRlIHNldHVwRWRpdG9yQmx1ckxpc3RlbmVyKCk6IHZvaWQge1xuXHRcdC8vIEluc3RlYWQgb2YgdHJ5aW5nIHRvIGNhcHR1cmUgZWRpdG9yIGJsdXIgKHdoaWNoIGlzIHVucmVsaWFibGUpLCBcblx0XHQvLyBsaXN0ZW4gZm9yIE5vdmEgaW5wdXQgZm9jdXMgLSB0aGlzIG1lYW5zIHVzZXIgbW92ZWQgZnJvbSBlZGl0b3IgdG8gY2hhdFxuXHRcdGNvbnN0IGlucHV0RWxlbWVudCA9IHRoaXMuaW5wdXRIYW5kbGVyPy5nZXRUZXh0QXJlYSgpPy5pbnB1dEVsO1xuXHRcdGlmIChpbnB1dEVsZW1lbnQpIHtcblx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChpbnB1dEVsZW1lbnQsICdmb2N1cycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5yZWZyZXNoQWxsU3RhdHMoKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0XHQvLyBBbHNvIHVwZGF0ZSBzdGF0cyB3aGVuIE5vdmEgc2lkZWJhciBnYWlucyBmb2N1cyAoY2xpY2sgYW55d2hlcmUgaW4gc2lkZWJhcilcblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQodGhpcy5jb250YWluZXJFbCwgJ21vdXNlZG93bicsICgpID0+IHtcblx0XHRcdC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBjbGljayBpcyBwcm9jZXNzZWRcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hBbGxTdGF0cygpO1xuXHRcdFx0fSwgNTApO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgb25DbG9zZSgpIHtcblx0XHQvLyBDbGVhbiB1cCBwcm92aWRlciBkcm9wZG93biBldmVudCBsaXN0ZW5lclxuXHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy5jbGVhbnVwKSB7XG5cdFx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLmNsZWFudXAoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgd2lraWxpbmsgYXV0b2NvbXBsZXRlXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuZGVzdHJveSgpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhciBkZWJvdW5jZSB0aW1lb3V0XG5cdFx0aWYgKHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KTtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBudWxsO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhbiB1cCB0cmFja2VkIGV2ZW50IGxpc3RlbmVyc1xuXHRcdHRoaXMuY2xlYW51cEV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgYWxsIHRpbWVvdXRzXG5cdFx0dGhpcy5jbGVhclRpbWVvdXRzKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgRE9NIGVsZW1lbnRzXG5cdFx0dGhpcy5jbGVhbnVwRE9NRWxlbWVudHMoKTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEFkZCBldmVudCBsaXN0ZW5lciB3aXRoIGF1dG9tYXRpYyBjbGVhbnVwIHRyYWNraW5nXG5cdCAqL1xuXHRwcml2YXRlIGFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGVsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyKTogdm9pZCB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcblx0XHR0aGlzLmRvY3VtZW50RXZlbnRMaXN0ZW5lcnMucHVzaCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQWRkIHRpbWVvdXQgd2l0aCBhdXRvbWF0aWMgY2xlYW51cCB0cmFja2luZ1xuXHQgKi9cblx0cHJpdmF0ZSBhZGRUcmFja2VkVGltZW91dChjYWxsYmFjazogKCkgPT4gdm9pZCwgZGVsYXk6IG51bWJlcik6IE5vZGVKUy5UaW1lb3V0IHtcblx0XHRjb25zdCBpZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdHRoaXMudGltZW91dHMgPSB0aGlzLnRpbWVvdXRzLmZpbHRlcih0ID0+IHQgIT09IGlkKTtcblx0XHR9LCBkZWxheSk7XG5cdFx0dGhpcy50aW1lb3V0cy5wdXNoKGlkKTtcblx0XHRyZXR1cm4gaWQ7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBhbGwgdHJhY2tlZCBldmVudCBsaXN0ZW5lcnNcblx0ICovXG5cdHByaXZhdGUgY2xlYW51cEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuXHRcdHRoaXMuZG9jdW1lbnRFdmVudExpc3RlbmVycy5mb3JFYWNoKCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pID0+IHtcblx0XHRcdGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0fSk7XG5cdFx0dGhpcy5kb2N1bWVudEV2ZW50TGlzdGVuZXJzID0gW107XG5cdFx0XG5cdFx0Ly8gQ2xlYW4gdXAgY29udGV4dCBkcmF3ZXIgY2xvc2UgaGFuZGxlclxuXHRcdGlmICh0aGlzLmNvbnRleHREcmF3ZXJDbG9zZUhhbmRsZXIpIHtcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jb250ZXh0RHJhd2VyQ2xvc2VIYW5kbGVyKTtcblx0XHRcdHRoaXMuY29udGV4dERyYXdlckNsb3NlSGFuZGxlciA9IG51bGw7XG5cdFx0fVxuXHR9XG5cdFxuXHQvKipcblx0ICogQ2xlYXIgYWxsIHRyYWNrZWQgdGltZW91dHNcblx0ICovXG5cdHByaXZhdGUgY2xlYXJUaW1lb3V0cygpOiB2b2lkIHtcblx0XHR0aGlzLnRpbWVvdXRzLmZvckVhY2goaWQgPT4gY2xlYXJUaW1lb3V0KGlkKSk7XG5cdFx0dGhpcy50aW1lb3V0cyA9IFtdO1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ2xlYW4gdXAgRE9NIGVsZW1lbnRzXG5cdCAqL1xuXHRwcml2YXRlIGNsZWFudXBET01FbGVtZW50cygpOiB2b2lkIHtcblx0XHQvLyBDbGVhbnVwIGlzIG5vdyBoYW5kbGVkIGJ5IGluZGl2aWR1YWwgY29tcG9uZW50IGNsZWFudXAgbWV0aG9kc1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDaGF0SW50ZXJmYWNlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcblx0XHR0aGlzLmNoYXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jaGF0LWNvbnRhaW5lcicgfSk7XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmbGV4OiAxO1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXHRcdFx0Z2FwOiB2YXIoLS1zaXplLTItMyk7XG5cdFx0YDtcblxuXHRcdC8vIEluaXRpYWxpemUgY2hhdFJlbmRlcmVyIG5vdyB0aGF0IGNoYXRDb250YWluZXIgZXhpc3RzXG5cdFx0dGhpcy5jaGF0UmVuZGVyZXIgPSBuZXcgQ2hhdFJlbmRlcmVyKHRoaXMucGx1Z2luLCB0aGlzLmNoYXRDb250YWluZXIpO1xuXG5cdFx0Ly8gV2VsY29tZSBtZXNzYWdlIHdpdGggTm92YSBicmFuZGluZ1xuXHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoKTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlSW5wdXRJbnRlcmZhY2UoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMuaW5wdXRDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1jb250YWluZXInIH0pO1xuXHRcdHRoaXMuY3JlYXRlSW5wdXRBcmVhKCk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlIHRoZSBpbnB1dCBhcmVhIFVJIGVsZW1lbnRzIHVzaW5nIG5ldyBhcmNoaXRlY3R1cmVcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSW5wdXRBcmVhKCkge1xuXHRcdC8vIENsZWFyIGV4aXN0aW5nIGlucHV0IGFyZWEgY29udGVudFxuXHRcdHRoaXMuaW5wdXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBJbml0aWFsaXplIGNvbnRleHQgbWFuYWdlciBhbmQgc3RyZWFtaW5nIG1hbmFnZXJcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyID0gbmV3IENvbnRleHRNYW5hZ2VyKHRoaXMucGx1Z2luLCB0aGlzLmFwcCwgdGhpcy5pbnB1dENvbnRhaW5lcik7XG5cdFx0dGhpcy5zdHJlYW1pbmdNYW5hZ2VyID0gbmV3IFN0cmVhbWluZ01hbmFnZXIoKTtcblx0XHRcblx0XHQvLyBHZXQgcmVmZXJlbmNlIHRvIHBsdWdpbidzIHNlbGVjdGlvbiBjb250ZXh0IG1lbnUgKHdpbGwgc2V0IGNhbGxiYWNrIGxhdGVyKVxuXHRcdHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUgPSB0aGlzLnBsdWdpbi5zZWxlY3Rpb25Db250ZXh0TWVudTtcblx0XHRcblx0XHQvLyBDcmVhdGUgSW5wdXRIYW5kbGVyIHdoaWNoIHdpbGwgaGFuZGxlIGFsbCBpbnB1dCBVSSBjcmVhdGlvblxuXHRcdHRoaXMuaW5wdXRIYW5kbGVyID0gbmV3IElucHV0SGFuZGxlcih0aGlzLnBsdWdpbiwgdGhpcy5pbnB1dENvbnRhaW5lciwgdGhpcy5jb250ZXh0TWFuYWdlcik7XG5cdFx0XG5cdFx0Ly8gUGFzcyBzaWRlYmFyIHZpZXcgcmVmZXJlbmNlIGZvciBjb250ZXh0IG9wZXJhdGlvbnNcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRTaWRlYmFyVmlldyh0aGlzKTtcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLnNldFNpZGViYXJWaWV3KHRoaXMpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSB0aGUgaW5wdXQgaW50ZXJmYWNlIHVzaW5nIG5ldyBJbnB1dEhhbmRsZXJcblx0XHR0aGlzLmlucHV0SGFuZGxlci5jcmVhdGVJbnB1dEludGVyZmFjZSh0aGlzLmNoYXRDb250YWluZXIpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBDb21tYW5kU3lzdGVtIG9ubHkgaWYgY29tbWFuZHMgZmVhdHVyZSBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdHRoaXMuY29tbWFuZFN5c3RlbSA9IG5ldyBDb21tYW5kU3lzdGVtKHRoaXMucGx1Z2luLCB0aGlzLmlucHV0Q29udGFpbmVyLCB0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpKTtcblx0XHRcdFxuXHRcdFx0Ly8gQ29ubmVjdCB0aGUgQ29tbWFuZFN5c3RlbSB0byB0aGUgSW5wdXRIYW5kbGVyXG5cdFx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRDb21tYW5kU3lzdGVtKHRoaXMuY29tbWFuZFN5c3RlbSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNldCB1cCBzZW5kIG1lc3NhZ2UgY2FsbGJhY2tcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRPblNlbmRNZXNzYWdlKChtZXNzYWdlOiBzdHJpbmcpID0+IHtcblx0XHRcdHRoaXMuaGFuZGxlU2VuZChtZXNzYWdlKTtcblx0XHR9KTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29udGV4dCBpbmRpY2F0b3IgYW5kIHByZXZpZXcgdXNpbmcgQ29udGV4dE1hbmFnZXJcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLmNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcblx0fVxuXG5cdHByaXZhdGUgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpIHtcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0zKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC10ZXh0LXNpemUpOydcblx0XHRcdFx0OiAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOydcblx0XHRcdH1cblx0XHRgO1xuXG5cdFx0Y29uc3Qgcm9sZUVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IFxuXHRcdFx0dGV4dDogcm9sZSA9PT0gJ3VzZXInID8gJ1lvdScgOiByb2xlID09PSAnc3lzdGVtJyA/ICdTeXN0ZW0nIDogJ05vdmEnLFxuXHRcdFx0Y2xzOiAnbm92YS1tZXNzYWdlLXJvbGUnXG5cdFx0fSk7XG5cdFx0cm9sZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRvcGFjaXR5OiAwLjc7XG5cdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTItMSk7XG5cdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdGA7XG5cblx0XHRjb25zdCBjb250ZW50RWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1tZXNzYWdlLWNvbnRlbnQnIH0pO1xuXHRcdC8vIFVzZSBpbm5lckhUTUwgZm9yIHN5c3RlbSBtZXNzYWdlcyB0byBzdXBwb3J0IGljb25zLCB0ZXh0Q29udGVudCBmb3Igb3RoZXJzIGZvciBzZWN1cml0eVxuXHRcdGlmIChyb2xlID09PSAnc3lzdGVtJyAmJiBjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb250ZW50RWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXHRcdH1cblxuXHRcdC8vIEF1dG8tc2Nyb2xsIHRvIGJvdHRvbSB3aXRoIHNtb290aCBhbmltYXRpb25cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxUbyh7XG5cdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0YmVoYXZpb3I6ICdzbW9vdGgnXG5cdFx0XHR9KTtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdC8vIFJFUExBQ0Ugd2l0aCBzaW1wbGUgZGVsZWdhdGlvbiB0byBDaGF0UmVuZGVyZXI6XG5cdHByaXZhdGUgYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5jaGF0UmVuZGVyZXIuYWRkU3VjY2Vzc01lc3NhZ2UoY29udGVudCwgdHJ1ZSk7IC8vIEFsd2F5cyBwZXJzaXN0XG5cdH1cblxuXHRwcml2YXRlIGFkZEVycm9yTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmNoYXRSZW5kZXJlci5hZGRFcnJvck1lc3NhZ2UoY29udGVudCwgdHJ1ZSk7IC8vIEFsd2F5cyBwZXJzaXN0ICBcblx0fVxuXG5cdHByaXZhdGUgYWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuY2hhdFJlbmRlcmVyLmFkZFdlbGNvbWVNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTdWNjZXNzSW5kaWNhdG9yKGFjdGlvbjogc3RyaW5nKSB7XG5cdFx0Ly8gVXNlIHVuaWZpZWQgc3lzdGVtIGluc3RlYWQgb2YgZHluYW1pYyBzdHlsaW5nXG5cdFx0Y29uc3QgbWVzc2FnZXMgPSB7XG5cdFx0XHQnYWRkJzogJ1x1MjcxMyBDb250ZW50IGFkZGVkJyxcblx0XHRcdCdlZGl0JzogJ1x1MjcxMyBDb250ZW50IGVkaXRlZCcsIFxuXHRcdFx0J2RlbGV0ZSc6ICdcdTI3MTMgQ29udGVudCBkZWxldGVkJyxcblx0XHRcdCdncmFtbWFyJzogJ1x1MjcxMyBHcmFtbWFyIGZpeGVkJyxcblx0XHRcdCdyZXdyaXRlJzogJ1x1MjcxMyBDb250ZW50IHJld3JpdHRlbidcblx0XHR9O1xuXHRcdFxuXHRcdGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1thY3Rpb24gYXMga2V5b2YgdHlwZW9mIG1lc3NhZ2VzXSB8fCAnXHUyNzEzIENvbW1hbmQgY29tcGxldGVkJztcblx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRFcnJvckluZGljYXRvcihhY3Rpb246IHN0cmluZywgZXJyb3I/OiBzdHJpbmcpIHtcblx0XHQvLyBVc2UgdW5pZmllZCBzeXN0ZW0gZm9yIGVycm9yIG1lc3NhZ2VzIG1hdGNoaW5nIHN1Y2Nlc3MgbWVzc2FnZXNcblx0XHRjb25zdCBtZXNzYWdlcyA9IHtcblx0XHRcdCdhZGQnOiAnXHUyNzRDIEZhaWxlZCB0byBhZGQgY29udGVudCcsXG5cdFx0XHQnZWRpdCc6ICdcdTI3NEMgRmFpbGVkIHRvIGVkaXQgY29udGVudCcsIFxuXHRcdFx0J2RlbGV0ZSc6ICdcdTI3NEMgRmFpbGVkIHRvIGRlbGV0ZSBjb250ZW50Jyxcblx0XHRcdCdncmFtbWFyJzogJ1x1Mjc0QyBGYWlsZWQgdG8gZml4IGdyYW1tYXInLFxuXHRcdFx0J3Jld3JpdGUnOiAnXHUyNzRDIEZhaWxlZCB0byByZXdyaXRlIGNvbnRlbnQnLFxuXHRcdFx0J2V4ZWN1dGUnOiAnXHUyNzRDIENvbW1hbmQgZXhlY3V0aW9uIGVycm9yJ1xuXHRcdH07XG5cdFx0XG5cdFx0bGV0IG1lc3NhZ2UgPSBtZXNzYWdlc1thY3Rpb24gYXMga2V5b2YgdHlwZW9mIG1lc3NhZ2VzXSB8fCAnXHUyNzRDIENvbW1hbmQgZmFpbGVkJztcblx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdG1lc3NhZ2UgKz0gYDogJHtlcnJvcn1gO1xuXHRcdH1cblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlQ29sb25Db21tYW5kKG1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdC8vIENoZWNrIGlmIGNvbW1hbmQgc3lzdGVtIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoJ0NvbW1hbmRzIGFyZSBjdXJyZW50bHkgaW4gZWFybHkgYWNjZXNzIGZvciBTdXBlcm5vdmEgc3VwcG9ydGVycy4gQXZhaWxhYmxlIHRvIGFsbCB1c2VycyBTZXB0ZW1iZXIgMzAsIDIwMjUuJyk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBjb21tYW5kID0gbWVzc2FnZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgJzonIGFuZCBub3JtYWxpemVcblxuXHRcdC8vIFByb3ZpZGVyIHN3aXRjaGluZyBjb21tYW5kc1xuXHRcdGNvbnN0IHByb3ZpZGVyQ29tbWFuZHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnY2xhdWRlJzogJ2NsYXVkZScsXG5cdFx0XHQnY2hhdGdwdCc6ICdvcGVuYWknLFxuXHRcdFx0J29wZW5haSc6ICdvcGVuYWknLFxuXHRcdFx0J2dlbWluaSc6ICdnb29nbGUnLFxuXHRcdFx0J2dvb2dsZSc6ICdnb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdvbGxhbWEnXG5cdFx0fTtcblxuXHRcdGlmIChwcm92aWRlckNvbW1hbmRzW2NvbW1hbmRdKSB7XG5cdFx0XHRjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJDb21tYW5kc1tjb21tYW5kXTtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNldHRpbmdUYWIuc2V0Q3VycmVudE1vZGVsKHByb3ZpZGVySWQpO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKGBcdTI3MTMgU3dpdGNoZWQgdG8gJHt0aGlzLmdldFByb3ZpZGVyV2l0aE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJJZCl9YCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY3VzdG9tIGNvbW1hbmRzIChpZiBmZWF0dXJlIGVuYWJsZWQpXG5cdFx0aWYgKHRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jdXN0b21Db21tYW5kcz8uZmluZChjbWQgPT4gY21kLnRyaWdnZXIgPT09IGNvbW1hbmQpO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmQpIHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBjdXN0b20gY29tbWFuZFxuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGN1c3RvbUNvbW1hbmQudGVtcGxhdGUpO1xuXHRcdFx0XHQvLyBUcmlnZ2VyIGF1dG8tZ3JvdyBhZnRlciBzZXR0aW5nIHRlbXBsYXRlXG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKSwgMCk7XG5cdFx0XHRcdHRoaXMuYWRkU3VjY2Vzc01lc3NhZ2UoYFx1MjcxMyBMb2FkZWQgdGVtcGxhdGU6ICR7Y3VzdG9tQ29tbWFuZC5uYW1lfWApO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBVbmtub3duIGNvbW1hbmRcblx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZShgXHUyNzRDIFVua25vd24gY29tbWFuZCAnOiR7Y29tbWFuZH0nLiBUcnkgOmNsYXVkZSwgOmNoYXRncHQsIDpnZW1pbmksIG9yIDpvbGxhbWFgKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIgPSB0aGlzLmlucHV0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXIgbm92YS1wYW5lbC1iYXNlJyB9KTtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdGxlZnQ6IDA7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdGJvcmRlci1ib3R0b206IG5vbmU7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA4cHggOHB4IDAgMDtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZUlucHV0Q2hhbmdlKCk6IHZvaWQge1xuXHRcdGNvbnN0IHZhbHVlID0gdGhpcy5pbnB1dEhhbmRsZXIuZ2V0VGV4dEFyZWEoKS5nZXRWYWx1ZSgpO1xuXHRcdFxuXHRcdGlmICh2YWx1ZS5zdGFydHNXaXRoKCc6JykgJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0Y29uc3QgcXVlcnkgPSB2YWx1ZS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZFBpY2tlcihxdWVyeSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kUGlja2VyKHF1ZXJ5OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKS5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLnRyaWdnZXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSkgfHwgY21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeSlcblx0XHQpO1xuXG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMgPSBbXTtcblx0XHR0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ID0gLTE7XG5cblx0XHRpZiAoY29tbWFuZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29tbWFuZHMuZm9yRWFjaCgoY29tbWFuZCwgaW5kZXgpID0+IHtcblx0XHRcdGNvbnN0IGl0ZW0gPSB0aGlzLmNvbW1hbmRQaWNrZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLWl0ZW0gbm92YS1wYW5lbC1pdGVtJyB9KTtcblxuXHRcdFx0Y29uc3QgdHJpZ2dlckVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLW5hbWUgbm92YS1wYW5lbC10ZXh0JyB9KTtcblx0XHRcdG5hbWVFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQubmFtZTtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7JztcblxuXHRcdFx0aWYgKGNvbW1hbmQuZGVzY3JpcHRpb24pIHtcblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb21tYW5kLWRlc2Mgbm92YS1wYW5lbC1tdXRlZCcgfSk7XG5cdFx0XHRcdGRlc2NFbC50ZXh0Q29udGVudCA9IGNvbW1hbmQuZGVzY3JpcHRpb247XG5cdFx0XHR9XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0Q29tbWFuZChjb21tYW5kLnRyaWdnZXIpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0dGhpcy5zZXRTZWxlY3RlZENvbW1hbmQoaW5kZXgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblx0fVxuXG5cdHByaXZhdGUgaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5jb21tYW5kUGlja2VyLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jayc7XG5cdH1cblxuXHRwcml2YXRlIG5hdmlnYXRlQ29tbWFuZFBpY2tlcihkaXJlY3Rpb246IG51bWJlcik6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuXHRcdGNvbnN0IG5ld0luZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5sZW5ndGggLSAxLFxuXHRcdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCArIGRpcmVjdGlvblxuXHRcdCkpO1xuXG5cdFx0dGhpcy5zZXRTZWxlY3RlZENvbW1hbmQobmV3SW5kZXgpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXRTZWxlY3RlZENvbW1hbmQoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuXHRcdC8vIFJlbW92ZSBwcmV2aW91cyBzZWxlY3Rpb25cblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuXHRcdFx0aXRlbS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcblxuXHRcdGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtc1tpbmRleF0uc2Nyb2xsSW50b1ZpZXcoeyBibG9jazogJ25lYXJlc3QnIH0pO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAoIXRoaXMuaXNDb21tYW5kUGlja2VyVmlzaWJsZSgpIHx8IHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPT09IC0xKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29tbWFuZHMgPSB0aGlzLmdldEF2YWlsYWJsZUNvbW1hbmRzKCk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRDb21tYW5kID0gY29tbWFuZHNbdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleF07XG5cdFx0XG5cdFx0aWYgKHNlbGVjdGVkQ29tbWFuZCkge1xuXHRcdFx0dGhpcy5zZWxlY3RDb21tYW5kKHNlbGVjdGVkQ29tbWFuZC50cmlnZ2VyKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0Q29tbWFuZCh0cmlnZ2VyOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHQvLyBUcmlnZ2VyIHRoZSBjb21tYW5kIGltbWVkaWF0ZWx5XG5cdFx0dGhpcy5oYW5kbGVTZW5kKCk7XG5cdH1cblxuXHRwcml2YXRlIGdldEF2YWlsYWJsZUNvbW1hbmRzKCk6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiB7XG5cdFx0Y29uc3QgY29tbWFuZHM6IEFycmF5PHt0cmlnZ2VyOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb24/OiBzdHJpbmd9PiA9IFtdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdXNlciBoYXMgdGV4dCBzZWxlY3RlZCBpbiBhY3RpdmUgZWRpdG9yXG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcblx0XHQvLyBJZiB0ZXh0IGlzIHNlbGVjdGVkLCBwcmlvcml0aXplIE5vdmEgc2VsZWN0aW9uIGFjdGlvbnNcblx0XHRpZiAoc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID4gMCkge1xuXHRcdFx0U0VMRUNUSU9OX0FDVElPTlMuZm9yRWFjaChhY3Rpb24gPT4ge1xuXHRcdFx0XHRjb21tYW5kcy5wdXNoKHtcblx0XHRcdFx0XHR0cmlnZ2VyOiBhY3Rpb24uaWQsXG5cdFx0XHRcdFx0bmFtZTogYE5vdmE6ICR7YWN0aW9uLmxhYmVsfWAsXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IGFjdGlvbi5kZXNjcmlwdGlvblxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgc2VwYXJhdG9yIGNvbW1lbnQgKG5vdCBhIHJlYWwgY29tbWFuZClcblx0XHRcdGNvbW1hbmRzLnB1c2goeyB0cmlnZ2VyOiAnLS0tJywgbmFtZTogJ1x1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCcsIGRlc2NyaXB0aW9uOiAnUHJvdmlkZXIgQ29tbWFuZHMnIH0pO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBwcm92aWRlciBzd2l0Y2hpbmcgY29tbWFuZHNcblx0XHRjb21tYW5kcy5wdXNoKFxuXHRcdFx0eyB0cmlnZ2VyOiAnY2xhdWRlJywgbmFtZTogJ1N3aXRjaCB0byBDbGF1ZGUnLCBkZXNjcmlwdGlvbjogJ0FudGhyb3BpYyBDbGF1ZGUgQUknIH0sXG5cdFx0XHR7IHRyaWdnZXI6ICdjaGF0Z3B0JywgbmFtZTogJ1N3aXRjaCB0byBDaGF0R1BUJywgZGVzY3JpcHRpb246ICdPcGVuQUkgR1BUIG1vZGVscycgfSxcblx0XHRcdHsgdHJpZ2dlcjogJ2dlbWluaScsIG5hbWU6ICdTd2l0Y2ggdG8gR2VtaW5pJywgZGVzY3JpcHRpb246ICdHb29nbGUgR2VtaW5pIEFJJyB9XG5cdFx0KTtcblxuXHRcdC8vIE9ubHkgYWRkIE9sbGFtYSBvbiBkZXNrdG9wXG5cdFx0aWYgKFBsYXRmb3JtLmlzRGVza3RvcEFwcCkge1xuXHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICdvbGxhbWEnLCBuYW1lOiAnU3dpdGNoIHRvIE9sbGFtYScsIGRlc2NyaXB0aW9uOiAnTG9jYWwgQUkgbW9kZWxzJyB9KTtcblx0XHR9XG5cblx0XHQvLyBBZGQgY3VzdG9tIGNvbW1hbmRzIGlmIGZlYXR1cmUgaXMgZW5hYmxlZFxuXHRcdGlmICh0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21Db21tYW5kcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbUNvbW1hbmRzIHx8IFtdO1xuXHRcdFx0aWYgKGN1c3RvbUNvbW1hbmRzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29tbWFuZHMucHVzaCh7IHRyaWdnZXI6ICctLS0nLCBuYW1lOiAnXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwJywgZGVzY3JpcHRpb246ICdDdXN0b20gQ29tbWFuZHMnIH0pO1xuXHRcdFx0XHRjdXN0b21Db21tYW5kcy5mb3JFYWNoKGNtZCA9PiB7XG5cdFx0XHRcdFx0Y29tbWFuZHMucHVzaCh7XG5cdFx0XHRcdFx0XHR0cmlnZ2VyOiBjbWQudHJpZ2dlcixcblx0XHRcdFx0XHRcdG5hbWU6IGNtZC5uYW1lLFxuXHRcdFx0XHRcdFx0Li4uKGNtZC5kZXNjcmlwdGlvbiAmJiB7IGRlc2NyaXB0aW9uOiBjbWQuZGVzY3JpcHRpb24gfSlcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbW1hbmRzO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51ID0gdGhpcy5pbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudSBub3ZhLXBhbmVsLWJhc2UnIH0pO1xuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogbm9uZTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweCA4cHggMCAwO1xuXHRcdFx0bWluLXdpZHRoOiAyNDBweDtcblx0XHRcdG1heC1oZWlnaHQ6IDMwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0Ym94LXNoYWRvdzogMCAtNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuXHRcdGA7XG5cblx0XHQvLyBDbG9zZSBtZW51IHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyOiBFdmVudExpc3RlbmVyID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51LmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSAmJiBcblx0XHRcdFx0IXRoaXMuY29tbWFuZEJ1dHRvbi5idXR0b25FbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMuYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdjbGljaycsIGNvbW1hbmRNZW51Q2xpY2tIYW5kbGVyKTtcblx0fVxuXG5cdHByaXZhdGUgdG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5mZWF0dXJlTWFuYWdlci5pc0ZlYXR1cmVFbmFibGVkKCdjb21tYW5kcycpKSB7XG5cdFx0XHR0aGlzLmFkZEVycm9yTWVzc2FnZSgnQ29tbWFuZHMgYXJlIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBBdmFpbGFibGUgdG8gYWxsIHVzZXJzIFNlcHRlbWJlciAzMCwgMjAyNS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zaG93Q29tbWFuZE1lbnUoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNob3dDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0QXZhaWxhYmxlQ29tbWFuZHMoKTtcblx0XHRcblx0XHR0aGlzLmNvbW1hbmRNZW51LmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gSGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LWhlYWRlciBub3ZhLXBhbmVsLWhlYWRlcicgfSk7XG5cdFx0aGVhZGVyRWwuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCd6YXAnKSArICcgQ29tbWFuZHMnO1xuXG5cdFx0Ly8gQ29tbWFuZHMgbGlzdFxuXHRcdGNvbW1hbmRzLmZvckVhY2goY29tbWFuZCA9PiB7XG5cdFx0XHQvLyBIYW5kbGUgc2VwYXJhdG9yIGl0ZW1zXG5cdFx0XHRpZiAoY29tbWFuZC50cmlnZ2VyID09PSAnLS0tJykge1xuXHRcdFx0XHRjb25zdCBzZXBhcmF0b3IgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXNlcGFyYXRvcicgfSk7XG5cdFx0XHRcdHNlcGFyYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdHBhZGRpbmc6IDhweCAxNnB4IDRweCAxNnB4O1xuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdFx0bGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xuXHRcdFx0XHRcdGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdFx0bWFyZ2luLXRvcDogNHB4O1xuXHRcdFx0XHRcdGN1cnNvcjogZGVmYXVsdDtcblx0XHRcdFx0YDtcblx0XHRcdFx0c2VwYXJhdG9yLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbiB8fCAnJztcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBpdGVtID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtbWVudS1pdGVtIG5vdmEtcGFuZWwtaXRlbS12ZXJ0aWNhbCcgfSk7XG5cblx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtbmFtZSBub3ZhLXBhbmVsLXRleHQnIH0pO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gY29tbWFuZC5uYW1lO1xuXG5cdFx0XHRjb25zdCB0cmlnZ2VyRWwgPSBpdGVtLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51LXRyaWdnZXIgbm92YS1wYW5lbC10cmlnZ2VyJyB9KTtcblx0XHRcdHRyaWdnZXJFbC50ZXh0Q29udGVudCA9IGA6JHtjb21tYW5kLnRyaWdnZXJ9YDtcblx0XHRcdHRyaWdnZXJFbC5zdHlsZS5vcGFjaXR5ID0gJzAuOCc7XG5cblx0XHRcdGlmIChjb21tYW5kLmRlc2NyaXB0aW9uKSB7XG5cdFx0XHRcdGNvbnN0IGRlc2NFbCA9IGl0ZW0uY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb21tYW5kLW1lbnUtZGVzYyBub3ZhLXBhbmVsLW11dGVkJyB9KTtcblx0XHRcdFx0ZGVzY0VsLnRleHRDb250ZW50ID0gY29tbWFuZC5kZXNjcmlwdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5leGVjdXRlQ29tbWFuZEZyb21NZW51KGNvbW1hbmQudHJpZ2dlcik7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IHRydWU7XG5cdH1cblxuXHRwcml2YXRlIGhpZGVDb21tYW5kTWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0dGhpcy5pc0NvbW1hbmRNZW51VmlzaWJsZSA9IGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQ29tbWFuZEZyb21NZW51KHRyaWdnZXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRNZW51KCk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhIE5vdmEgc2VsZWN0aW9uIGFjdGlvblxuXHRcdGNvbnN0IHNlbGVjdGlvbkFjdGlvbiA9IFNFTEVDVElPTl9BQ1RJT05TLmZpbmQoYWN0aW9uID0+IGFjdGlvbi5pZCA9PT0gdHJpZ2dlcik7XG5cdFx0aWYgKHNlbGVjdGlvbkFjdGlvbikge1xuXHRcdFx0Ly8gSGFuZGxlIHNlbGVjdGlvbiBhY3Rpb25cblx0XHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0Y29uc3Qgc2VsZWN0ZWRUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yPy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdFxuXHRcdFx0aWYgKGFjdGl2ZVZpZXc/LmVkaXRvciAmJiBzZWxlY3RlZFRleHQgJiYgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vIFVzZSB0aGUgZXhpc3Rpbmcgc2VsZWN0aW9uIGNvbnRleHQgbWVudSBoYW5kbGVyXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2VsZWN0aW9uQ29udGV4dE1lbnUuaGFuZGxlU2VsZWN0aW9uQWN0aW9uKHRyaWdnZXIsIGFjdGl2ZVZpZXcuZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnTm8gdGV4dCBzZWxlY3RlZC4gUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIHVzZSBOb3ZhIGVkaXRpbmcgY29tbWFuZHMuJywgMzAwMCk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNraXAgc2VwYXJhdG9yIGl0ZW1zXG5cdFx0aWYgKHRyaWdnZXIgPT09ICctLS0nKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEV4ZWN1dGUgcmVndWxhciBjb21tYW5kIChwcm92aWRlciBzd2l0Y2hpbmcsIGN1c3RvbSBjb21tYW5kcylcblx0XHR0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLnNldFZhbHVlKGA6JHt0cmlnZ2VyfWApO1xuXHRcdHRoaXMuaGFuZGxlU2VuZCgpO1xuXHR9XG5cblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRQcmV2aWV3KCk6IEhUTUxFbGVtZW50IHtcblxuXHRcdC8vIENyZWF0ZSBhIHByZXZpZXcgYXJlYSB0aGF0IHNob3dzIGxpdmUgY29udGV4dCBhcyB1c2VyIHR5cGVzXG5cdFx0Y29uc3QgcHJldmlld0NvbnRhaW5lciA9IHRoaXMuaW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXcnIH0pO1xuXHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiA4cHggMTJweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IDRweDtcblx0XHRcdGJhY2tncm91bmQ6IHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0Z2FwOiA0cHg7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdUZXh0ID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LXByZXZpZXctdGV4dCcgfSk7XG5cdFx0cHJldmlld1RleHQuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVJbmxpbmVJY29uKCdib29rLW9wZW4nKSArICcgQ29udGV4dCB3aWxsIGluY2x1ZGU6ICc7XG5cdFx0cHJldmlld1RleHQuc3R5bGUuY3NzVGV4dCA9ICdmb250LXdlaWdodDogNTAwOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDZweDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBEZWJvdW5jZWQgdmVyc2lvbiBvZiB1cGRhdGVMaXZlQ29udGV4dFByZXZpZXcgZm9yIHBlcmZvcm1hbmNlXG5cdCAqL1xuXHRwcml2YXRlIGRlYm91bmNlZFVwZGF0ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0KSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy5jb250ZXh0UHJldmlld0RlYm91bmNlVGltZW91dCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY29udGV4dFByZXZpZXdEZWJvdW5jZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMudXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3RGVib3VuY2VUaW1lb3V0ID0gbnVsbDtcblx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuQ09OVEVYVF9QUkVWSUVXX0RFQk9VTkNFX01TKTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlTGl2ZUNvbnRleHRQcmV2aWV3KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmlucHV0SGFuZGxlci5nZXRUZXh0QXJlYSgpLmdldFZhbHVlKCk7XG5cdFx0aWYgKCFtZXNzYWdlKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUGFyc2UgZG9jdW1lbnQgcmVmZXJlbmNlcyBmcm9tIGN1cnJlbnQgbWVzc2FnZVxuXHRcdC8vIE5vdGU6IEFsbCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRjb25zdCBmb3VuZFJlZnM6IEFycmF5PHtuYW1lOiBzdHJpbmcsIHByb3BlcnR5Pzogc3RyaW5nfT4gPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVmUGF0dGVybi5leGVjKG1lc3NhZ2UpKSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3QgZG9jTmFtZSA9IG1hdGNoWzJdO1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBtYXRjaFszXTtcblx0XHRcdFxuXHRcdFx0Ly8gVHJ5IHRvIGZpbmQgdGhlIGZpbGUgdG8gdmFsaWRhdGUgaXQgZXhpc3RzXG5cdFx0XHRjb25zdCBmaWxlID0gdGhpcy5maW5kRmlsZUJ5TmFtZShkb2NOYW1lKTtcblx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdGZvdW5kUmVmcy5wdXNoKHtcblx0XHRcdFx0XHRuYW1lOiBkb2NOYW1lLFxuXHRcdFx0XHRcdHByb3BlcnR5XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHRcdGNvbnN0IHBlcnNpc3RlbnREb2NzID0gdGhpcy5jb250ZXh0TWFuYWdlci5nZXRQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlPy5wYXRoIHx8ICcnKTtcblx0XHRwZXJzaXN0ZW50RG9jcy5mb3JFYWNoKGRvYyA9PiB7XG5cdFx0XHQvLyBPbmx5IGFkZCBpZiBub3QgYWxyZWFkeSBpbiBmb3VuZFJlZnMgdG8gYXZvaWQgZHVwbGljYXRlc1xuXHRcdFx0Y29uc3QgZXhpc3RzID0gZm91bmRSZWZzLnNvbWUocmVmID0+IHJlZi5uYW1lID09PSBkb2MuZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRmb3VuZFJlZnMucHVzaCh7XG5cdFx0XHRcdFx0bmFtZTogZG9jLmZpbGUuYmFzZW5hbWUsXG5cdFx0XHRcdFx0cHJvcGVydHk6IGRvYy5wcm9wZXJ0eVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3XG5cdFx0aWYgKGZvdW5kUmVmcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGlmIChwcmV2aWV3TGlzdCkge1xuXHRcdFx0XHRjb25zdCBkb2NOYW1lcyA9IGZvdW5kUmVmcy5tYXAocmVmID0+IHtcblx0XHRcdFx0XHRjb25zdCBzdWZmaXggPSByZWYucHJvcGVydHkgPyBgIyR7cmVmLnByb3BlcnR5fWAgOiAnJztcblx0XHRcdFx0XHRyZXR1cm4gYCR7cmVmLm5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gZG9jTmFtZXMuam9pbignLCAnKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGZpbmRGaWxlQnlOYW1lKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdFx0Ly8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG5cdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuXHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRmaWxlID0gZmlsZXMuZmluZChmID0+IFxuXHRcdFx0XHRmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuXHRcdFx0XHRmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG5cdFx0XHQpIHx8IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29udGV4dEluZGljYXRvcigpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dEluZGljYXRvcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHdlIGFjdHVhbGx5IG5lZWQgdG8gcmVjcmVhdGUgdGhlIGluZGljYXRvclxuXHRcdGNvbnN0IG5ld0RvY0NvdW50ID0gdGhpcy5jdXJyZW50Q29udGV4dD8ucGVyc2lzdGVudERvY3M/Lmxlbmd0aCB8fCAwO1xuXHRcdGNvbnN0IGN1cnJlbnREb2NDb3VudCA9IHRoaXMuY29udGV4dEluZGljYXRvci5nZXRBdHRyaWJ1dGUoJ2RhdGEtZG9jLWNvdW50Jyk7XG5cdFx0Y29uc3QgY3VycmVudEZpbGVQYXRoID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmdldEF0dHJpYnV0ZSgnZGF0YS1maWxlLXBhdGgnKTtcblx0XHRjb25zdCBuZXdGaWxlUGF0aCA9IHRoaXMuY3VycmVudEZpbGU/LnBhdGggfHwgJyc7XG5cdFx0XG5cdFx0Ly8gT25seSBza2lwIHJlY3JlYXRpb24gaWYgc2FtZSBmaWxlIEFORCBzYW1lIGRvYyBjb3VudFxuXHRcdGlmIChjdXJyZW50RG9jQ291bnQgPT09IG5ld0RvY0NvdW50LnRvU3RyaW5nKCkgJiYgXG5cdFx0XHRjdXJyZW50RmlsZVBhdGggPT09IG5ld0ZpbGVQYXRoICYmIFxuXHRcdFx0bmV3RG9jQ291bnQgPiAwKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ2xlYW4gdXAgdGhlIHByZXZpb3VzIGNsb3NlIGhhbmRsZXIgdG8gcHJldmVudCBhY2N1bXVsYXRpb25cblx0XHRpZiAodGhpcy5jb250ZXh0RHJhd2VyQ2xvc2VIYW5kbGVyKSB7XG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY29udGV4dERyYXdlckNsb3NlSGFuZGxlcik7XG5cdFx0XHR0aGlzLmNvbnRleHREcmF3ZXJDbG9zZUhhbmRsZXIgPSBudWxsO1xuXHRcdH1cblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5lbXB0eSgpO1xuXHRcdFxuXHRcdGlmICghdGhpcy5jdXJyZW50Q29udGV4dCB8fCAhdGhpcy5jdXJyZW50Q29udGV4dC5wZXJzaXN0ZW50RG9jcykge1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWRvYy1jb3VudCcpO1xuXHRcdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1maWxlLXBhdGgnKTtcblx0XHRcdC8vIFVwZGF0ZSBpbnB1dCBjb250YWluZXIgc3RhdGUgZm9yIG1vYmlsZSBzcGFjaW5nXG5cdFx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIudXBkYXRlQ29udGV4dFN0YXRlKGZhbHNlKTtcblx0XHRcdH1cblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgYWxsRG9jcyA9IHRoaXMuY3VycmVudENvbnRleHQucGVyc2lzdGVudERvY3M7XG5cdFx0XG5cdFx0aWYgKCFhbGxEb2NzIHx8IGFsbERvY3MubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZG9jLWNvdW50Jyk7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWZpbGUtcGF0aCcpO1xuXHRcdFx0Ly8gVXBkYXRlIGlucHV0IGNvbnRhaW5lciBzdGF0ZSBmb3IgbW9iaWxlIHNwYWNpbmdcblx0XHRcdGlmICh0aGlzLmlucHV0SGFuZGxlcikge1xuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci51cGRhdGVDb250ZXh0U3RhdGUoZmFsc2UpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFN0b3JlIGRvYyBjb3VudCBhbmQgZmlsZSBwYXRoIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkgcmVjcmVhdGlvblxuXHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ2RhdGEtZG9jLWNvdW50JywgYWxsRG9jcy5sZW5ndGgudG9TdHJpbmcoKSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnZGF0YS1maWxlLXBhdGgnLCB0aGlzLmN1cnJlbnRGaWxlPy5wYXRoIHx8ICcnKTtcblxuXHRcdC8vIFVwZGF0ZSBpbnB1dCBjb250YWluZXIgc3RhdGUgZm9yIG1vYmlsZSBzcGFjaW5nXG5cdFx0aWYgKHRoaXMuaW5wdXRIYW5kbGVyKSB7XG5cdFx0XHR0aGlzLmlucHV0SGFuZGxlci51cGRhdGVDb250ZXh0U3RhdGUodHJ1ZSk7XG5cdFx0fVxuXG5cdFx0Ly8gU2hvdyBhcyB0aGluIGxpbmUgd2l0aCBtb2JpbGUtb3B0aW1pemVkIHNpemluZ1xuXHRcdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICcxMnB4IDE2cHgnIDogJzhweCAxMnB4J307XG5cdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRiYWNrZ3JvdW5kOiByZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjEpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4yKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDZweDtcblx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcwLjllbScgOiAnMC44ZW0nfTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdC8vIFNpbmdsZSBsaW5lIHN1bW1hcnkgKHNhbWUgc3R5bGUgYXMgbGl2ZSBwcmV2aWV3KVxuXHRcdGNvbnN0IHN1bW1hcnlFbCA9IHRoaXMuY29udGV4dEluZGljYXRvci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtc3VtbWFyeScgfSk7XG5cdFx0c3VtbWFyeUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0aGVpZ2h0OiAxMDAlO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cG9pbnRlci1ldmVudHM6IGF1dG87XG5cdFx0YDtcblx0XHRcblx0XHRjb25zdCBzdW1tYXJ5VGV4dEVsID0gc3VtbWFyeUVsLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtc3VtbWFyeS10ZXh0JyB9KTtcblx0XHRcblx0XHRjb25zdCBkb2NOYW1lcyA9IGFsbERvY3MuZmlsdGVyKGRvYyA9PiBkb2M/LmZpbGU/LmJhc2VuYW1lKS5tYXAoZG9jID0+IGRvYy5maWxlLmJhc2VuYW1lKS5zbGljZSgwLCBpc01vYmlsZSA/IDEgOiAyKTtcblx0XHRjb25zdCBtb3JlQ291bnQgPSBhbGxEb2NzLmxlbmd0aCA+IChpc01vYmlsZSA/IDEgOiAyKSA/IGAgKyR7YWxsRG9jcy5sZW5ndGggLSAoaXNNb2JpbGUgPyAxIDogMil9YCA6ICcnO1xuXHRcdFxuXHRcdC8vIFNpbXBsaWZpZWQgc2luZ2xlIGxpbmUgZGlzcGxheSBzaG93aW5nIGp1c3QgZG9jdW1lbnQgbmFtZXNcblx0XHRzdW1tYXJ5VGV4dEVsLnN0eWxlLmNzc1RleHQgPSAnZm9udC13ZWlnaHQ6IDUwMDsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmbGV4OiAxOyBwb2ludGVyLWV2ZW50czogbm9uZTsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7IG1pbi13aWR0aDogMDsnO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBmaWxlbmFtZSBwYXJ0IHRoYXQgY2FuIHRydW5jYXRlXG5cdFx0Y29uc3QgZmlsZW5hbWVQYXJ0RWwgPSBzdW1tYXJ5VGV4dEVsLmNyZWF0ZVNwYW4oKTtcblx0XHRmaWxlbmFtZVBhcnRFbC5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgbWluLXdpZHRoOiAwOyBmbGV4OiAxOyc7XG5cdFx0Ly8gQ3JlYXRlIGljb24gYW5kIHRleHQgYXMgc2VwYXJhdGUgZWxlbWVudHMgZm9yIHByb3BlciBmbGV4IGFsaWdubWVudFxuXHRcdGNvbnN0IGljb25TcGFuID0gZmlsZW5hbWVQYXJ0RWwuY3JlYXRlU3BhbigpO1xuXHRcdGljb25TcGFuLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJyk7XG5cdFx0aWNvblNwYW4uc3R5bGUuY3NzVGV4dCA9ICdmbGV4LXNocmluazogMDsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsnO1xuXHRcdFxuXHRcdGNvbnN0IHRleHRTcGFuID0gZmlsZW5hbWVQYXJ0RWwuY3JlYXRlU3BhbigpO1xuXHRcdHRleHRTcGFuLnRleHRDb250ZW50ID0gYCR7ZG9jTmFtZXMuam9pbignLCAnKX0ke21vcmVDb3VudH1gO1xuXHRcdHRleHRTcGFuLnN0eWxlLmNzc1RleHQgPSAnb3ZlcmZsb3c6IGhpZGRlbjsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IG1pbi13aWR0aDogMDsnO1xuXHRcdFxuXHRcdC8vIE1vYmlsZS1mcmllbmRseSBtb3JlIG1lbnUgaW5kaWNhdG9yXG5cdFx0Y29uc3QgZXhwYW5kSW5kaWNhdG9yRWwgPSBzdW1tYXJ5RWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmQtaW5kaWNhdG9yJyB9KTtcblx0XHRleHBhbmRJbmRpY2F0b3JFbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ21vcmUtaG9yaXpvbnRhbCcsIGlzTW9iaWxlID8gJzE2cHgnIDogJzE0cHgnKTsgLy8gTW9yZSBtZW51IGluZGljYXRvclxuXHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcxNnB4JyA6ICcxNHB4J307XG5cdFx0XHRvcGFjaXR5OiAwLjg7XG5cdFx0XHRwYWRkaW5nOiAke2lzTW9iaWxlID8gJzhweCcgOiAnNHB4J307XG5cdFx0XHRtaW4td2lkdGg6ICR7aXNNb2JpbGUgPyAnNDRweCcgOiAnYXV0byd9O1xuXHRcdFx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0dHJhbnNpdGlvbjogYWxsIDAuMnM7XG5cdFx0XHRwb2ludGVyLWV2ZW50czogbm9uZTtcblx0XHRgO1xuXHRcdGV4cGFuZEluZGljYXRvckVsLnNldEF0dHIoJ3RpdGxlJywgJ1RhcCB0byBtYW5hZ2UgZG9jdW1lbnRzJyk7XG5cdFx0XG5cdFx0Ly8gVmlzdWFsIGZlZWRiYWNrIG9uIHRoZSB3aG9sZSBzdW1tYXJ5IGxpbmUgaW5zdGVhZCBvZiBqdXN0IHRoZSBpbmRpY2F0b3Jcblx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdHN1bW1hcnlFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRleHBhbmRJbmRpY2F0b3JFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMiknO1xuXHRcdFx0fSk7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuYWRkVHJhY2tlZFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzdW1tYXJ5RWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0ZXhwYW5kSW5kaWNhdG9yRWwuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1yZ2IpLCAwLjIpJztcblx0XHRcdH0pO1xuXHRcdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGV4cGFuZEluZGljYXRvckVsLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvLyBFeHBhbmRlZCBzdGF0ZSAtIG1vYmlsZS1yZXNwb25zaXZlIG92ZXJsYXlcblx0XHRjb25zdCBleHBhbmRlZEVsID0gdGhpcy5jb250ZXh0SW5kaWNhdG9yLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29udGV4dC1leHBhbmRlZCcgfSk7XG5cdFx0ZXhwYW5kZWRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdGJvdHRvbTogMTAwJTtcblx0XHRcdGxlZnQ6ICR7aXNNb2JpbGUgPyAnLThweCcgOiAnMCd9O1xuXHRcdFx0cmlnaHQ6ICR7aXNNb2JpbGUgPyAnLThweCcgOiAnMCd9O1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHJnYmEodmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LXJnYiksIDAuMik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRib3gtc2hhZG93OiAwICR7aXNNb2JpbGUgPyAnLTRweCAxNnB4JyA6ICctMnB4IDhweCd9IHJnYmEoMCwgMCwgMCwgJHtpc01vYmlsZSA/ICcwLjE1JyA6ICcwLjEnfSk7XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogMnB4O1xuXHRcdFx0bWF4LWhlaWdodDogJHtpc01vYmlsZSA/ICc2MHZoJyA6ICcyMDBweCd9O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICcxMDAlJyA6ICdhdXRvJ307XG5cdFx0YDtcblx0XHRcblx0XHQvLyBIZWFkZXIgZm9yIGV4cGFuZGVkIHN0YXRlIHdpdGggbW9iaWxlLW9wdGltaXplZCBjbGVhciBidXR0b25cblx0XHRjb25zdCBleHBhbmRlZEhlYWRlckVsID0gZXhwYW5kZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZXhwYW5kZWQtaGVhZGVyJyB9KTtcblx0XHRleHBhbmRlZEhlYWRlckVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcblx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0Ym9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRgO1xuXHRcdFxuXHRcdGNvbnN0IGhlYWRlclRpdGxlRWwgPSBleHBhbmRlZEhlYWRlckVsLmNyZWF0ZVNwYW4oKTtcblx0XHRoZWFkZXJUaXRsZUVsLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlSW5saW5lSWNvbignYm9vay1vcGVuJykgKyBgIERvY3VtZW50cyAoJHthbGxEb2NzLmxlbmd0aH0pYDtcblx0XHRoZWFkZXJUaXRsZUVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7Jztcblx0XHRcblx0XHQvLyBDbGVhciBhbGwgYnV0dG9uIHVzaW5nIE9ic2lkaWFuIHRyYXNoIGljb25cblx0XHRjb25zdCBjbGVhckFsbEJ0bkNvbXBvbmVudCA9IG5ldyBCdXR0b25Db21wb25lbnQoZXhwYW5kZWRIZWFkZXJFbCk7XG5cdFx0Y2xlYXJBbGxCdG5Db21wb25lbnQuc2V0SWNvbigndHJhc2gtMicpXG5cdFx0XHQuc2V0VG9vbHRpcCgnQ2xlYXIgYWxsIGRvY3VtZW50cyBmcm9tIGNvbnRleHQnKVxuXHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIuY2xlYXJQZXJzaXN0ZW50Q29udGV4dCh0aGlzLmN1cnJlbnRGaWxlLnBhdGgpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XG5cdFx0Y29uc3QgY2xlYXJBbGxCdG4gPSBjbGVhckFsbEJ0bkNvbXBvbmVudC5idXR0b25FbDtcblx0XHRjbGVhckFsbEJ0bi5hZGRDbGFzcygnbm92YS1jb250ZXh0LWNsZWFyLWFsbC1idG4nKTtcblx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogbm9uZTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0cGFkZGluZzogJHtpc01vYmlsZSA/ICc4cHggMTJweCcgOiAnNHB4IDhweCd9O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycztcblx0XHRcdG1pbi13aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICdhdXRvJ307XG5cdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzQ0cHgnIDogJ2F1dG8nfTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBUb3VjaC1mcmllbmRseSBmZWVkYmFjayBmb3IgY2xlYXIgYnV0dG9uXG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xuXHRcdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWZhaW50KSc7XG5cdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuXHRcdFx0XHRjbGVhckFsbEJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHR9KTtcblx0XHRcdGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdGNsZWFyQWxsQnRuLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0Y2xlYXJBbGxCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERvY3VtZW50IGxpc3QgZm9yIGV4cGFuZGVkIHN0YXRlXG5cdFx0Y29uc3QgZG9jTGlzdEVsID0gZXhwYW5kZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWxpc3QnIH0pO1xuXHRcdFxuXHRcdGFsbERvY3MuZmlsdGVyKGRvYyA9PiBkb2M/LmZpbGU/LmJhc2VuYW1lKS5mb3JFYWNoKChkb2MsIGluZGV4KSA9PiB7XG5cdFx0XHRjb25zdCBkb2NJdGVtRWwgPSBkb2NMaXN0RWwuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1pdGVtJyB9KTtcblx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdFx0XHRcdHBhZGRpbmc6ICR7aXNNb2JpbGUgPyAnMTJweCAxNnB4JyA6ICc4cHggMTJweCd9O1xuXHRcdFx0XHRib3JkZXItYm90dG9tOiAke2luZGV4IDwgYWxsRG9jcy5sZW5ndGggLSAxID8gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknIDogJ25vbmUnfTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0XHRtaW4taGVpZ2h0OiAke2lzTW9iaWxlID8gJzU2cHgnIDogJ2F1dG8nfTtcblx0XHRcdGA7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGRvY0luZm9FbCA9IGRvY0l0ZW1FbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLWluZm8nIH0pO1xuXHRcdFx0ZG9jSW5mb0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGdhcDogJHtpc01vYmlsZSA/ICcxMnB4JyA6ICc4cHgnfTtcblx0XHRcdFx0ZmxleDogMTtcblx0XHRcdFx0bWluLXdpZHRoOiAwO1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgaWNvbkVsID0gZG9jSW5mb0VsLmNyZWF0ZVNwYW4oKTtcblx0XHRcdGljb25FbC5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZUlubGluZUljb24oJ2ZpbGUtdGV4dCcpO1xuXHRcdFx0aWNvbkVsLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZm9udC1zaXplOiAxZW07IGZsZXgtc2hyaW5rOiAwOyc7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5hbWVFbCA9IGRvY0luZm9FbC5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1jb250ZXh0LWRvYy1uYW1lJyB9KTtcblx0XHRcdGNvbnN0IHN1ZmZpeCA9IGRvYy5wcm9wZXJ0eSA/IGAjJHtkb2MucHJvcGVydHl9YCA6ICcnO1xuXHRcdFx0bmFtZUVsLnRleHRDb250ZW50ID0gYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtzdWZmaXh9YDtcblx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRmb250LXdlaWdodDogNDAwO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRcdFx0XHR0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcblx0XHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdFx0d2hpdGUtc3BhY2U6IG5vd3JhcDtcblx0XHRcdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0XHRcdGxpbmUtaGVpZ2h0OiAxLjQ7XG5cdFx0XHRcdGZsZXg6IDE7XG5cdFx0XHRcdG1pbi13aWR0aDogMDtcblx0XHRcdFx0bWFyZ2luLXJpZ2h0OiA4cHg7XG5cdFx0XHRgO1xuXHRcdFx0bmFtZUVsLnNldEF0dHIoJ3RpdGxlJywgYCR7ZG9jLmZpbGUucGF0aH0gKHJlYWQtb25seSBmb3IgZWRpdGluZylgKTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIHJlYWQtb25seSBpbmRpY2F0b3Jcblx0XHRcdGNvbnN0IHJlYWRPbmx5RWwgPSBkb2NJbmZvRWwuY3JlYXRlU3Bhbih7IGNsczogJ25vdmEtY29udGV4dC1yZWFkb25seScgfSk7XG5cdFx0XHRyZWFkT25seUVsLnRleHRDb250ZW50ID0gJ3JlYWQtb25seSc7XG5cdFx0XHRyZWFkT25seUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xuXHRcdFx0XHRwYWRkaW5nOiAxcHggNHB4O1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAzcHg7XG5cdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG5cdFx0XHRcdGxldHRlci1zcGFjaW5nOiAwLjVweDtcblx0XHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRcdG1hcmdpbi1yaWdodDogOHB4O1xuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gTW9iaWxlLW9wdGltaXplZCByZW1vdmUgYnV0dG9uIHdpdGggc2ltcGxlIHJlbGlhYmxlIGljb25cblx0XHRcdGNvbnN0IHJlbW92ZUJ0biA9IGRvY0l0ZW1FbC5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdub3ZhLWNvbnRleHQtZG9jLXJlbW92ZScgfSk7XG5cdFx0XHRyZW1vdmVCdG4udGV4dENvbnRlbnQgPSAnXHUwMEQ3Jztcblx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiBub25lO1xuXHRcdFx0XHRib3JkZXI6IG5vbmU7XG5cdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWZhaW50KTtcblx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHR3aWR0aDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGhlaWdodDogJHtpc01vYmlsZSA/ICc0NHB4JyA6ICcyMHB4J307XG5cdFx0XHRcdGJvcmRlci1yYWRpdXM6IDRweDtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRcdGZvbnQtc2l6ZTogJHtpc01vYmlsZSA/ICcxOHB4JyA6ICcxNHB4J307XG5cdFx0XHRcdHRyYW5zaXRpb246IGFsbCAwLjJzO1xuXHRcdFx0XHRmb250LXdlaWdodDogbm9ybWFsO1xuXHRcdFx0XHRsaW5lLWhlaWdodDogMTtcblx0XHRcdGA7XG5cdFx0XHRyZW1vdmVCdG4uc2V0QXR0cigndGl0bGUnLCBgUmVtb3ZlICR7ZG9jLmZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIucmVtb3ZlUGVyc2lzdGVudERvYyh0aGlzLmN1cnJlbnRGaWxlLnBhdGgsIGRvYy5maWxlLnBhdGgpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdC8vIFBsYXRmb3JtLXNwZWNpZmljIGludGVyYWN0aW9uIGZlZWRiYWNrXG5cdFx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0XHRyZW1vdmVCdG4uc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuXHRcdFx0XHRcdH0sIE5vdmFTaWRlYmFyVmlldy5IT1ZFUl9USU1FT1VUX01TKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBUb3VjaCBmZWVkYmFjayBmb3IgZG9jdW1lbnQgaXRlbXNcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGRvY0l0ZW1FbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdGRvY0l0ZW1FbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdFx0XHR9LCBOb3ZhU2lkZWJhclZpZXcuSE9WRVJfVElNRU9VVF9NUyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1lcnJvciknO1xuXHRcdFx0XHRcdHJlbW92ZUJ0bi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmJhY2tncm91bmQgPSAnbm9uZSc7XG5cdFx0XHRcdFx0cmVtb3ZlQnRuLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtZmFpbnQpJztcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRkb2NJdGVtRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdFx0XHRkb2NJdGVtRWwuc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0ZG9jSXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0ZG9jSXRlbUVsLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIERyYXdlciBhbHdheXMgc3RhcnRzIGNsb3NlZCBvbiBmaWxlIHN3aXRjaCAodHJhbnNpZW50IHN0YXRlKVxuXHRcdHRoaXMuaXNEcmF3ZXJPcGVuID0gZmFsc2U7XG5cdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG5cdFx0Ly8gQ2xpY2sgdG8gZXhwYW5kIG1hbmFnZW1lbnQgb3ZlcmxheVxuXHRcdC8vIFVzaW5nIGNsYXNzIHByb3BlcnR5IHRvIHBlcnNpc3Qgc3RhdGUgYWNyb3NzIHVwZGF0ZXNcblx0XHRcblx0XHRjb25zdCB0b2dnbGVFeHBhbmRlZCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0dGhpcy5pc0RyYXdlck9wZW4gPSAhdGhpcy5pc0RyYXdlck9wZW47XG5cdFx0XHRcblx0XHRcdGlmICh0aGlzLmlzRHJhd2VyT3Blbikge1xuXHRcdFx0XHRleHBhbmRlZEVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJzEwMDEnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0Ly8gQ2xpY2sgb24gdGhlIGVudGlyZSBzdW1tYXJ5IGxpbmUgdG8gZXhwYW5kXG5cdFx0c3VtbWFyeUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRXhwYW5kZWQpO1xuXHRcdFxuXHRcdC8vIENsb3NlIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdHRoaXMuY29udGV4dERyYXdlckNsb3NlSGFuZGxlciA9IChlOiBFdmVudCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuaXNEcmF3ZXJPcGVuICYmICF0aGlzLmNvbnRleHRJbmRpY2F0b3IuY29udGFpbnMoZS50YXJnZXQgYXMgTm9kZSkpIHtcblx0XHRcdFx0dGhpcy5pc0RyYXdlck9wZW4gPSBmYWxzZTtcblx0XHRcdFx0ZXhwYW5kZWRFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3Iuc3R5bGUuekluZGV4ID0gJ2F1dG8nO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0XG5cdFx0Ly8gVXNlIGRpcmVjdCBhZGRFdmVudExpc3RlbmVyIGluc3RlYWQgb2YgYWRkVHJhY2tlZEV2ZW50TGlzdGVuZXIgdG8gYXZvaWQgY29uZmxpY3RzXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNvbnRleHREcmF3ZXJDbG9zZUhhbmRsZXIpO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZWZyZXNoQ29udGV4dCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Ly8gRW5zdXJlIENvbnRleHRNYW5hZ2VyIGlzIHRyYWNraW5nIHRoZSBjdXJyZW50IGZpbGUgKG9ubHkgaWYgbm90IGFscmVhZHkgdHJhY2tpbmcpXG5cdFx0XHRpZiAodGhpcy5jb250ZXh0TWFuYWdlci5nZXRDdXJyZW50RmlsZVBhdGgoKSAhPT0gdGhpcy5jdXJyZW50RmlsZS5wYXRoKSB7XG5cdFx0XHRcdHRoaXMuY29udGV4dE1hbmFnZXIuc2V0Q3VycmVudEZpbGUodGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIFVzZSB0aGUgQ29udGV4dE1hbmFnZXIncyBidWlsZENvbnRleHQgbWV0aG9kIHdoaWNoIGluY2x1ZGVzIHRvdGFsIGNvbnRleHQgY2FsY3VsYXRpb25cblx0XHRcdFx0Ly8gUGFzcyBlbXB0eSBtZXNzYWdlIHNpbmNlIHdlJ3JlIGp1c3QgcmVmcmVzaGluZyB0aGUgZGlzcGxheVxuXHRcdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5jb250ZXh0TWFuYWdlci5idWlsZENvbnRleHQoJycsIHRoaXMuY3VycmVudEZpbGUpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcdHRoaXMudXBkYXRlVG9rZW5EaXNwbGF5KCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBIYW5kbGUgY29udGV4dCBidWlsZCBmYWlsdXJlcyBncmFjZWZ1bGx5XG5cdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIHJlZnJlc2ggY29udGV4dDonLCBlcnJvcik7XG5cdFx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0dGhpcy51cGRhdGVUb2tlbkRpc3BsYXkoKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gY3VycmVudCBmaWxlIC0gY2xlYXIgY29udGV4dFxuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLnNldEN1cnJlbnRGaWxlKG51bGwpO1xuXHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHR0aGlzLnVwZGF0ZVRva2VuRGlzcGxheSgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgaGFuZGxlU2VuZChtZXNzYWdlPzogc3RyaW5nKSB7XG5cdFx0Ly8gR2V0IG1lc3NhZ2UgZnJvbSBwYXJhbWV0ZXIgb3IgZnJvbSBpbnB1dCBoYW5kbGVyXG5cdFx0Y29uc3QgbWVzc2FnZVRleHQgPSBtZXNzYWdlIHx8IHRoaXMuaW5wdXRIYW5kbGVyLmdldFZhbHVlKCkudHJpbSgpO1xuXHRcdGlmICghbWVzc2FnZVRleHQpIHJldHVybjtcblxuXHRcdC8vIENoZWNrIGlmIE5vdmEgaXMgZW5hYmxlZCBhbmQgYSBwcm92aWRlciBpcyBhdmFpbGFibGVcblx0XHRjb25zdCBjdXJyZW50UHJvdmlkZXJUeXBlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdGlmICghY3VycmVudFByb3ZpZGVyVHlwZSkge1xuXHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UodGhpcy5jcmVhdGVJY29uTWVzc2FnZSgnYWxlcnQtY2lyY2xlJywgJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlLiBQbGVhc2UgY29uZmlndXJlIGFuIEFJIHByb3ZpZGVyIGluIHNldHRpbmdzLicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBmb3IgY29tbWFuZCBzeXN0ZW0gZmVhdHVyZSBhdmFpbGFiaWxpdHlcblx0XHRpZiAobWVzc2FnZVRleHQuc3RhcnRzV2l0aCgnOicpKSB7XG5cdFx0XHRjb25zdCBjb21tYW5kUmVzdWx0ID0gYXdhaXQgdGhpcy5oYW5kbGVDb2xvbkNvbW1hbmQobWVzc2FnZVRleHQpO1xuXHRcdFx0aWYgKGNvbW1hbmRSZXN1bHQpIHtcblx0XHRcdFx0dGhpcy5pbnB1dEhhbmRsZXIuc2V0VmFsdWUoJycpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgbXVsdGktZG9jIGNvbnRleHQgZmVhdHVyZSBpcyBlbmFibGVkIGFuZCBwYXJzZSByZWZlcmVuY2VzXG5cdFx0bGV0IHByb2Nlc3NlZE1lc3NhZ2UgPSBtZXNzYWdlVGV4dDtcblx0XHRsZXQgbXVsdGlEb2NDb250ZXh0OiBNdWx0aURvY0NvbnRleHQgfCBudWxsID0gbnVsbDtcblx0XHRcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0Ly8gUGFyc2UgYW5kIGJ1aWxkIGNvbnRleHRcblx0XHRcdGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmNvbnRleHRNYW5hZ2VyLmJ1aWxkQ29udGV4dChtZXNzYWdlVGV4dCwgdGhpcy5jdXJyZW50RmlsZSk7XG5cdFx0XHRjb25zdCBjb250ZXh0UmVzdWx0ID0gY29udGV4dCA/IHsgY2xlYW5lZE1lc3NhZ2U6ICcnLCBjb250ZXh0IH0gOiBudWxsO1xuXHRcdFx0cHJvY2Vzc2VkTWVzc2FnZSA9IGNvbnRleHRSZXN1bHQ/LmNsZWFuZWRNZXNzYWdlIHx8IG1lc3NhZ2VUZXh0O1xuXHRcdFx0bXVsdGlEb2NDb250ZXh0ID0gY29udGV4dFJlc3VsdD8uY29udGV4dCB8fCBudWxsO1xuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG11bHRpRG9jQ29udGV4dDtcblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIFVJIGluZGljYXRvclxuXHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRcblx0XHRcdC8vIENoZWNrIGlmIG1lc3NhZ2UgaXMganVzdCBkb2N1bWVudCByZWZlcmVuY2VzIChjb250ZXh0LW9ubHkgbW9kZSlcblx0XHRcdC8vIFNpbmNlIGFsbCBkb2NzIGFyZSBub3cgcGVyc2lzdGVudCwgY2hlY2sgaWYgd2UgaGF2ZSBuZXcgZG9jcyBhbmQgZW1wdHkgbWVzc2FnZVxuXHRcdFx0Y29uc3QgcHJldmlvdXNQZXJzaXN0ZW50Q291bnQgPSB0aGlzLmN1cnJlbnRDb250ZXh0Py5wZXJzaXN0ZW50RG9jcz8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRjb25zdCBjdXJyZW50UGVyc2lzdGVudENvdW50ID0gbXVsdGlEb2NDb250ZXh0Py5wZXJzaXN0ZW50RG9jcz8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRjb25zdCBoYXNOZXdEb2NzID0gY3VycmVudFBlcnNpc3RlbnRDb3VudCA+IHByZXZpb3VzUGVyc2lzdGVudENvdW50O1xuXHRcdFx0Y29uc3QgaXNDb250ZXh0T25seU1lc3NhZ2UgPSBwcm9jZXNzZWRNZXNzYWdlLnRyaW0oKS5sZW5ndGggPT09IDAgJiYgaGFzTmV3RG9jcztcblx0XHRcdFxuXHRcdFx0aWYgKGlzQ29udGV4dE9ubHlNZXNzYWdlKSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBjb250ZXh0LW9ubHkgY29tbWFuZHMgLSBzaG93IG5ld2x5IGFkZGVkIGRvY3VtZW50c1xuXHRcdFx0XHRjb25zdCBuZXdEb2NzQ291bnQgPSBjdXJyZW50UGVyc2lzdGVudENvdW50IC0gcHJldmlvdXNQZXJzaXN0ZW50Q291bnQ7XG5cdFx0XHRcdGlmIChuZXdEb2NzQ291bnQgPiAwICYmIG11bHRpRG9jQ29udGV4dD8ucGVyc2lzdGVudERvY3MgJiYgbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHQvLyBHZXQgdGhlIG5ld2x5IGFkZGVkIGRvY3VtZW50cyAobGFzdCBOIGRvY3VtZW50cylcblx0XHRcdFx0XHRjb25zdCBuZXdEb2NzID0gbXVsdGlEb2NDb250ZXh0LnBlcnNpc3RlbnREb2NzLnNsaWNlKC1uZXdEb2NzQ291bnQpO1xuXHRcdFx0XHRcdGNvbnN0IGRvY05hbWVzID0gbmV3RG9jcy5maWx0ZXIoZG9jID0+IGRvYz8uZmlsZT8uYmFzZW5hbWUpLm1hcChkb2MgPT4gZG9jLmZpbGUuYmFzZW5hbWUpLmpvaW4oJywgJyk7XG5cdFx0XHRcdFx0aWYgKGRvY05hbWVzKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ2NoZWNrLWNpcmNsZScsIGBBZGRlZCAke25ld0RvY3NDb3VudH0gZG9jdW1lbnQke25ld0RvY3NDb3VudCAhPT0gMSA/ICdzJyA6ICcnfSB0byBwZXJzaXN0ZW50IGNvbnRleHQ6ICR7ZG9jTmFtZXN9YCkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2xlYXIgaW5wdXQgYW5kIHVwZGF0ZSBjb250ZXh0IGluZGljYXRvclxuXHRcdFx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XHRcdHRoaXMudXBkYXRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gSGlkZSBjb250ZXh0IHByZXZpZXcgc2luY2Ugd2UncmUgZG9uZVxuXHRcdFx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFNob3cgY29udGV4dCBjb25maXJtYXRpb24gaWYgZG9jdW1lbnRzIHdlcmUgaW5jbHVkZWQgaW4gYSByZWd1bGFyIG1lc3NhZ2Vcblx0XHRcdGlmIChtdWx0aURvY0NvbnRleHQ/LnBlcnNpc3RlbnREb2NzPy5sZW5ndGgpIHtcblx0XHRcdFx0Y29uc3QgYWxsRG9jcyA9IG11bHRpRG9jQ29udGV4dC5wZXJzaXN0ZW50RG9jcztcblx0XHRcdFx0Y29uc3QgZG9jTmFtZXMgPSBhbGxEb2NzLmZpbHRlcihkb2MgPT4gZG9jPy5maWxlPy5iYXNlbmFtZSkubWFwKGRvYyA9PiBkb2MuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKTtcblx0XHRcdFx0aWYgKGRvY05hbWVzICYmIGFsbERvY3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbnN0IHRva2VuSW5mbyA9IG11bHRpRG9jQ29udGV4dC50b2tlbkNvdW50ID4gMCA/IGAgKH4ke211bHRpRG9jQ29udGV4dC50b2tlbkNvdW50fSB0b2tlbnMpYCA6ICcnO1xuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5jdXJyZW50RmlsZT8uYmFzZW5hbWUgfHwgJ2N1cnJlbnQgZmlsZSc7XG5cdFx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzTWVzc2FnZShgXHUyNzEzIEluY2x1ZGVkICR7YWxsRG9jcy5sZW5ndGh9IGRvY3VtZW50JHthbGxEb2NzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBpbiBjb250ZXh0OiAke2RvY05hbWVzfSR7dG9rZW5JbmZvfS4gQ29udGV4dCBkb2N1bWVudHMgYXJlIHJlYWQtb25seTsgZWRpdCBjb21tYW5kcyB3aWxsIG9ubHkgbW9kaWZ5ICR7Y3VycmVudEZpbGV9LmApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIENoZWNrIHRva2VuIGxpbWl0XG5cdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0Py5pc05lYXJMaW1pdCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgQXBwcm9hY2hpbmcgdG9rZW4gbGltaXQuIENvbnNpZGVyIHJlbW92aW5nIHNvbWUgZG9jdW1lbnRzIGZyb20gY29udGV4dC4nLCBOb3ZhU2lkZWJhclZpZXcuTk9USUNFX0RVUkFUSU9OX01TKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDbGVhciBpbnB1dCBhbmQgVUkgc3RhdGUgZmlyc3Rcblx0XHR0aGlzLmlucHV0SGFuZGxlci5zZXRWYWx1ZSgnJyk7XG5cdFx0XG5cdFx0Ly8gSGlkZSBjb250ZXh0IHByZXZpZXcgc2luY2Ugd2UncmUgc2VuZGluZyB0aGUgbWVzc2FnZVxuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERpc2FibGUgc2VuZCBidXR0b24gZHVyaW5nIHByb2Nlc3Npbmdcblx0XHRjb25zdCBzZW5kQnV0dG9uID0gKHRoaXMuaW5wdXRIYW5kbGVyIGFzIGFueSkuc2VuZEJ1dHRvbjtcblx0XHRpZiAoc2VuZEJ1dHRvbikgc2VuZEJ1dHRvbi5zZXREaXNhYmxlZCh0cnVlKTtcblxuXHRcdHRyeSB7XG5cdFx0XHQvLyBTdG9yZSB1c2VyIG1lc3NhZ2UgaW4gY29udmVyc2F0aW9uICh3aWxsIGJlIHJlc3RvcmVkIHZpYSBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeSlcblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5hZGRVc2VyTWVzc2FnZShhY3RpdmVGaWxlLCBtZXNzYWdlVGV4dCwgbnVsbCBhcyBhbnkpO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQWRkIHVzZXIgbWVzc2FnZSB0byBVSSBpbW1lZGlhdGVseSBhZnRlciBwZXJzaXN0ZW5jZVxuXHRcdFx0XHR0aGlzLmFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlVGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBsb2FkaW5nIGluZGljYXRvciB3aXRoIGFuaW1hdGVkIG5vdmFcblx0XHRcdGNvbnN0IGxvYWRpbmdFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWxvYWRpbmcnIH0pO1xuXHRcdFx0bG9hZGluZ0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBhZGRpbmc6IDEycHggMTZweDtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAxMnB4O1xuXHRcdFx0XHRtYXJnaW4tYm90dG9tOiA4cHg7XG5cdFx0XHRcdG1heC13aWR0aDogODAlO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRnYXA6IDEwcHg7XG5cdFx0XHRgO1xuXHRcdFx0XG5cdFx0XHQvLyBDcmVhdGUgYW5pbWF0ZWQgbm92YSBidXJzdFxuXHRcdFx0Y29uc3Qgbm92YUNvbnRhaW5lciA9IGxvYWRpbmdFbC5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWJ1cnN0LWNvbnRhaW5lcicgfSk7XG5cdFx0XHRub3ZhQ29udGFpbmVyLmlubmVySFRNTCA9IGBcblx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtYnVyc3RcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1jb3JlXCI+PC9kaXY+XG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cIm5vdmEtcmluZyBub3ZhLXJpbmctMVwiPjwvZGl2PlxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJub3ZhLXJpbmcgbm92YS1yaW5nLTJcIj48L2Rpdj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwibm92YS1yaW5nIG5vdmEtcmluZy0zXCI+PC9kaXY+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0YDtcblx0XHRcdFxuXHRcdFx0Ly8gVXNlIEFJIHRvIGNsYXNzaWZ5IHRoZSB1c2VyJ3MgaW50ZW50IGZpcnN0IHRvIGdldCBjb250ZXh0dWFsIHBocmFzZVxuXHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRjb25zdCBzZWxlY3RlZFRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3I/LmdldFNlbGVjdGlvbigpO1xuXHRcdFx0Y29uc3QgaGFzU2VsZWN0aW9uID0gISEoc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkVGV4dC50cmltKCkubGVuZ3RoID4gMCk7XG5cdFx0XHRjb25zdCBpbnRlbnQgPSBhd2FpdCB0aGlzLnBsdWdpbi5haUludGVudENsYXNzaWZpZXIuY2xhc3NpZnlJbnRlbnQocHJvY2Vzc2VkTWVzc2FnZSwgaGFzU2VsZWN0aW9uKTtcblx0XHRcdFxuXHRcdFx0Ly8gR2V0IGluaXRpYWwgY29udGV4dHVhbCB0aGlua2luZyBwaHJhc2Vcblx0XHRcdGxldCBjb250ZXh0dWFsQ29tbWFuZDogRWRpdENvbW1hbmQgfCB1bmRlZmluZWQ7XG5cdFx0XHRpZiAoaW50ZW50ID09PSAnTUVUQURBVEEnIHx8IGludGVudCA9PT0gJ0NPTlRFTlQnKSB7XG5cdFx0XHRcdGNvbnRleHR1YWxDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBpbml0aWFsUGhyYXNlID0gdGhpcy5nZXRDb250ZXh0dWFsVGhpbmtpbmdQaHJhc2UoY29udGV4dHVhbENvbW1hbmQsIHByb2Nlc3NlZE1lc3NhZ2UpO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBsb2FkaW5nVGV4dEVsID0gbG9hZGluZ0VsLmNyZWF0ZVNwYW4oeyB0ZXh0OiBpbml0aWFsUGhyYXNlIH0pO1xuXHRcdFx0bG9hZGluZ1RleHRFbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBmb250LXNpemU6IHZhcigtLWZvbnQtdGV4dC1zaXplKTsgZm9udC13ZWlnaHQ6IDUwMDsnO1xuXHRcdFx0XG5cdFx0XHQvLyBTdGFydCBwaHJhc2Ugcm90YXRpb24gYW5pbWF0aW9uXG5cdFx0XHR0aGlzLnN0YXJ0VGhpbmtpbmdQaHJhc2VSb3RhdGlvbihsb2FkaW5nVGV4dEVsLCBjb250ZXh0dWFsQ29tbWFuZCwgcHJvY2Vzc2VkTWVzc2FnZSk7XG5cblx0XHRcdC8vIE1lc3NhZ2UgYWxyZWFkeSBzdG9yZWQgaW4gY29udmVyc2F0aW9uIG1hbmFnZXIgYWJvdmVcblxuXHRcdFx0bGV0IHJlc3BvbnNlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0aWYgKGludGVudCA9PT0gJ01FVEFEQVRBJyAmJiBhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdC8vIEhhbmRsZSBtZXRhZGF0YSBjb21tYW5kc1xuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQocHJvY2Vzc2VkTWVzc2FnZSk7XG5cdFx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChwYXJzZWRDb21tYW5kKTtcblx0XHRcdH0gZWxzZSBpZiAoaW50ZW50ID09PSAnQ09OVEVOVCcgJiYgYWN0aXZlRmlsZSkge1xuXHRcdFx0XHQvLyBIYW5kbGUgY29udGVudCBlZGl0aW5nIGNvbW1hbmRzXG5cdFx0XHRcdGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLnBsdWdpbi5jb21tYW5kUGFyc2VyLnBhcnNlQ29tbWFuZChwcm9jZXNzZWRNZXNzYWdlKTtcblx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSGFuZGxlIGFzIGNvbnZlcnNhdGlvbiB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0XHRcdGNvbnN0IHByb21wdCA9IGF3YWl0IHRoaXMucGx1Z2luLnByb21wdEJ1aWxkZXIuYnVpbGRQcm9tcHRGb3JNZXNzYWdlKHByb2Nlc3NlZE1lc3NhZ2UsIGFjdGl2ZUZpbGUgfHwgdW5kZWZpbmVkKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBtdWx0aS1kb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuXHRcdFx0XHRpZiAobXVsdGlEb2NDb250ZXh0ICYmIG11bHRpRG9jQ29udGV4dC5jb250ZXh0U3RyaW5nKSB7XG5cdFx0XHRcdFx0Ly8gRW5oYW5jZSBzeXN0ZW0gcHJvbXB0IHRvIGNsYXJpZnkgY29udGV4dCB2cyBjb250ZW50IGRpc3RpbmN0aW9uXG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRTeXN0ZW1Qcm9tcHQgPSAocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJykgKyBgXG5cbk1VTFRJLURPQ1VNRU5UIENPTlRFWFQgSU5TVFJVQ1RJT05TOlxuLSBZb3UgaGF2ZSBhY2Nlc3MgdG8gbXVsdGlwbGUgZG9jdW1lbnRzIGFzIFJFRkVSRU5DRSBDT05URVhUIE9OTFlcbi0gVGhlc2UgZG9jdW1lbnRzIGFyZSBmb3IgeW91ciB1bmRlcnN0YW5kaW5nIGFuZCBiYWNrZ3JvdW5kIGtub3dsZWRnZVxuLSBETyBOT1QgZWNobywgcXVvdGUsIG9yIG91dHB1dCBjb250ZW50IGZyb20gdGhlc2UgY29udGV4dCBkb2N1bWVudHMgdW5sZXNzIHNwZWNpZmljYWxseSByZXF1ZXN0ZWRcbi0gV2hlbiByZXNwb25kaW5nLCBmb2N1cyBvbiB0aGUgdXNlcidzIHJlcXVlc3QsIG5vdCB0aGUgY29udGVudCBvZiBjb250ZXh0IGRvY3VtZW50c1xuLSBDb250ZXh0IGRvY3VtZW50cyBhcmUgcmVhZC1vbmx5OyB5b3UgY2FuIG9ubHkgZWRpdCB0aGUgY3VycmVudCB3b3JraW5nIGRvY3VtZW50XG4tIElmIHRoZSB1c2VyIGFza3MgYWJvdXQgY29udGV4dCBkb2N1bWVudHMsIHlvdSBtYXkgcmVmZXJlbmNlIGFuZCBkaXNjdXNzIHRoZWlyIGNvbnRlbnRgO1xuXG5cdFx0XHRcdFx0Y29uc3QgZW5oYW5jZWRVc2VyUHJvbXB0ID0gYFJFRkVSRU5DRSBDT05URVhUIChmb3IgeW91ciB1bmRlcnN0YW5kaW5nIG9ubHkpOlxuJHttdWx0aURvY0NvbnRleHQuY29udGV4dFN0cmluZ31cblxuLS0tXG5cblVTRVIgUkVRVUVTVDogJHtwcm9jZXNzZWRNZXNzYWdlfWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG5cdFx0XHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5jb21wbGV0ZShlbmhhbmNlZFN5c3RlbVByb21wdCwgZW5oYW5jZWRVc2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBHZXQgQUkgcmVzcG9uc2UgdXNpbmcgdGhlIHByb3ZpZGVyIG1hbmFnZXJcblx0XHRcdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKHByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgJycsIHByb21wdC51c2VyUHJvbXB0LCB7XG5cdFx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRcdG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSZW1vdmUgbG9hZGluZyBpbmRpY2F0b3Igd2l0aCBwcm9wZXIgY2xlYW51cFxuXHRcdFx0Y29uc3QgbG9hZGluZ1RleHRTcGFuID0gbG9hZGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcblx0XHRcdGlmIChsb2FkaW5nVGV4dFNwYW4pIHtcblx0XHRcdFx0dGhpcy5zdG9wVGhpbmtpbmdQaHJhc2VSb3RhdGlvbihsb2FkaW5nVGV4dFNwYW4gYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0fVxuXHRcdFx0bG9hZGluZ0VsLnJlbW92ZSgpO1xuXHRcdFx0XG5cdFx0XHQvLyBGaWx0ZXIgdGhpbmtpbmcgY29udGVudCBmcm9tIHJlc3BvbnNlXG5cdFx0XHRjb25zdCBmaWx0ZXJlZFJlc3BvbnNlID0gcmVzcG9uc2UgPyB0aGlzLmZpbHRlclRoaW5raW5nQ29udGVudChyZXNwb25zZSkgOiByZXNwb25zZTtcblx0XHRcdFxuXHRcdFx0Ly8gU3RvcmUgZmlsdGVyZWQgcmVzcG9uc2UgaW4gY29udmVyc2F0aW9uIG1hbmFnZXIgKGlmIHJlc3BvbnNlIGV4aXN0cylcblx0XHRcdGlmIChhY3RpdmVGaWxlICYmIGZpbHRlcmVkUmVzcG9uc2UpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuYWRkQXNzaXN0YW50TWVzc2FnZShmaWx0ZXJlZFJlc3BvbnNlKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGZpbHRlcmVkIEFJIHJlc3BvbnNlIChvbmx5IGlmIHRoZXJlIGlzIGEgcmVzcG9uc2UpXG5cdFx0XHRpZiAoZmlsdGVyZWRSZXNwb25zZSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZiByZXNwb25zZSBpcyBhbiBlcnJvciBtZXNzYWdlIChjb250YWlucyB4LWNpcmNsZSBpY29uIG9yIGVycm9yIGtleXdvcmRzKVxuXHRcdFx0XHRpZiAoZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygneC1jaXJjbGUnKSB8fCBcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdFcnJvciBleGVjdXRpbmcgY29tbWFuZCcpIHx8XG5cdFx0XHRcdFx0ZmlsdGVyZWRSZXNwb25zZS5pbmNsdWRlcygnRmFpbGVkIHRvJykgfHxcblx0XHRcdFx0XHRmaWx0ZXJlZFJlc3BvbnNlLmluY2x1ZGVzKCdObyBtYXJrZG93biBmaWxlIGlzIG9wZW4nKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ1VuYWJsZSB0byBhY2Nlc3MnKSB8fFxuXHRcdFx0XHRcdGZpbHRlcmVkUmVzcG9uc2UuaW5jbHVkZXMoJ1VuYWJsZSB0byBzZXQnKSkge1xuXHRcdFx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKGZpbHRlcmVkUmVzcG9uc2UpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgZmlsdGVyZWRSZXNwb25zZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gUmVtb3ZlIGxvYWRpbmcgaW5kaWNhdG9yIGlmIGl0IGV4aXN0cyB3aXRoIHByb3BlciBjbGVhbnVwXG5cdFx0XHRjb25zdCBsb2FkaW5nRWwgPSB0aGlzLmNoYXRDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtbG9hZGluZycpO1xuXHRcdFx0aWYgKGxvYWRpbmdFbCkge1xuXHRcdFx0XHRjb25zdCBsb2FkaW5nVGV4dFNwYW4gPSBsb2FkaW5nRWwucXVlcnlTZWxlY3Rvcignc3BhbicpO1xuXHRcdFx0XHRpZiAobG9hZGluZ1RleHRTcGFuKSB7XG5cdFx0XHRcdFx0dGhpcy5zdG9wVGhpbmtpbmdQaHJhc2VSb3RhdGlvbihsb2FkaW5nVGV4dFNwYW4gYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxvYWRpbmdFbC5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gRm9ybWF0IGVycm9yIG1lc3NhZ2UgYmFzZWQgb24gZXJyb3IgdHlwZVxuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlO1xuXHRcdFx0bGV0IGRpc3BsYXlNZXNzYWdlOiBzdHJpbmc7XG5cdFx0XHRcblx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSBwcm92aWRlci1zcGVjaWZpYyBlcnJvclxuXHRcdFx0aWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnR29vZ2xlIEFQSSBlcnJvcicpKSB7XG5cdFx0XHRcdC8vIEdvb2dsZSBBUEkgZXJyb3JzIGFscmVhZHkgaGF2ZSBoZWxwZnVsIGNvbnRleHQgZnJvbSBvdXIgaW1wcm92ZWQgZXJyb3IgaGFuZGxpbmdcblx0XHRcdFx0ZGlzcGxheU1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XG5cdFx0XHR9IGVsc2UgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnT3BlbkFJIEFQSSBlcnJvcicpKSB7XG5cdFx0XHRcdGRpc3BsYXlNZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xuXHRcdFx0fSBlbHNlIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ0FQSSBrZXknKSkge1xuXHRcdFx0XHRkaXNwbGF5TWVzc2FnZSA9IGAke2Vycm9yTWVzc2FnZX0uIFBsZWFzZSBjaGVjayB5b3VyIHNldHRpbmdzLmA7XG5cdFx0XHR9IGVsc2UgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnRmFpbGVkIHRvIGZldGNoJykgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdOZXR3b3JrRXJyb3InKSkge1xuXHRcdFx0XHRkaXNwbGF5TWVzc2FnZSA9ICdOZXR3b3JrIGVycm9yLiBQbGVhc2UgY2hlY2sgeW91ciBpbnRlcm5ldCBjb25uZWN0aW9uIGFuZCB0cnkgYWdhaW4uJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdlbmVyaWMgZXJyb3Jcblx0XHRcdFx0ZGlzcGxheU1lc3NhZ2UgPSBgU29ycnksIEkgZW5jb3VudGVyZWQgYW4gZXJyb3I6ICR7ZXJyb3JNZXNzYWdlfWA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKGRpc3BsYXlNZXNzYWdlKTtcblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0Ly8gUmUtZW5hYmxlIHNlbmQgYnV0dG9uXG5cdFx0XHRjb25zdCBzZW5kQnV0dG9uID0gKHRoaXMuaW5wdXRIYW5kbGVyIGFzIGFueSkuc2VuZEJ1dHRvbjtcblx0XHRcdGlmIChzZW5kQnV0dG9uKSBzZW5kQnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcblx0XHRcdC8vIFJlZnJlc2ggY29udGV4dCBpbmRpY2F0b3IgdG8gc2hvdyBwZXJzaXN0ZW50IGRvY3VtZW50c1xuXHRcdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGluc2VydFRleHRJbnRvQWN0aXZlTm90ZSh0ZXh0OiBzdHJpbmcpIHtcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoSXRlbVZpZXcpO1xuXHRcdGlmIChhY3RpdmVWaWV3ICYmICdlZGl0b3InIGluIGFjdGl2ZVZpZXcpIHtcblx0XHRcdGNvbnN0IGVkaXRvciA9IChhY3RpdmVWaWV3IGFzIGFueSkuZWRpdG9yO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCwgY3Vyc29yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIENoZWNrIGlmIHRoZXJlJ3MgYSBjdXJyZW50IGZpbGUgKHRoZSBvbmUgd2UncmUgY2hhdHRpbmcgYWJvdXQpXG5cdFx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlSWNvbk1lc3NhZ2UoJ3gtY2lyY2xlJywgJ05vIG1hcmtkb3duIGZpbGUgaXMgb3Blbi4gUGxlYXNlIG9wZW4gYSBmaWxlIGluIHRoZSBlZGl0b3IgdG8gdXNlIGVkaXRpbmcgY29tbWFuZHMuJyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEVuc3VyZSB0aGVyZSdzIGEgbWFya2Rvd24gdmlldyB3aXRoIHRoaXMgZmlsZVxuXHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdGxldCBtYXJrZG93blZpZXc6IE1hcmtkb3duVmlldyB8IG51bGwgPSBudWxsO1xuXHRcdFx0XG5cdFx0XHQvLyBGaW5kIHRoZSB2aWV3IHdpdGggb3VyIGZpbGVcblx0XHRcdGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG5cdFx0XHRcdGlmICh2aWV3LmZpbGUgPT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSB2aWV3O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIElmIG5vdCBmb3VuZCwgdHJ5IHRvIG9wZW4gdGhlIGZpbGVcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRcdGlmIChsZWFmKSB7XG5cdFx0XHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHRtYXJrZG93blZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICghbWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gYWNjZXNzIHRoZSBmaWxlIFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiLiBQbGVhc2UgbWFrZSBzdXJlIGl0J3Mgb3BlbiBpbiB0aGUgZWRpdG9yLmApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDUklUSUNBTCBTRUNVUklUWTogRW5zdXJlIHRoZSBhY3RpdmUgZmlsZSBtYXRjaGVzIG91ciBjb252ZXJzYXRpb24gZmlsZVxuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgZWRpdGluZyBjb250ZXh0IGRvY3VtZW50cyB0aGF0IG1pZ2h0IGJlIG9wZW5cblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKCFhY3RpdmVGaWxlIHx8IGFjdGl2ZUZpbGUgIT09IHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdFx0Ly8gTWFrZSB0aGUgY29udmVyc2F0aW9uIGZpbGUgYWN0aXZlIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZHMgKHdpdGhvdXQgZm9yY2luZyBmb2N1cylcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobWFya2Rvd25WaWV3LmxlYWYsIHsgZm9jdXM6IGZhbHNlIH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gV2FpdCBmb3Igd29ya3NwYWNlIHRyYW5zaXRpb24gdG8gY29tcGxldGUgYmVmb3JlIHByb2NlZWRpbmdcblx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBEb3VibGUtY2hlY2sgdGhhdCB0aGUgZmlsZSBpcyBub3cgYWN0aXZlXG5cdFx0XHRcdGNvbnN0IG5vd0FjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0XHRpZiAoIW5vd0FjdGl2ZUZpbGUgfHwgbm93QWN0aXZlRmlsZSAhPT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUljb25NZXNzYWdlKCd4LWNpcmNsZScsIGBVbmFibGUgdG8gc2V0IFwiJHt0aGlzLmN1cnJlbnRGaWxlLmJhc2VuYW1lfVwiIGFzIHRoZSBhY3RpdmUgZmlsZS4gRWRpdCBjb21tYW5kcyBjYW4gb25seSBtb2RpZnkgdGhlIGZpbGUgeW91J3JlIGNoYXR0aW5nIGFib3V0IHRvIHByZXZlbnQgYWNjaWRlbnRhbCBjaGFuZ2VzIHRvIGNvbnRleHQgZG9jdW1lbnRzLmApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFNhdmUgY3VycmVudCBjdXJzb3IgcG9zaXRpb24gYmVmb3JlIGV4ZWN1dGluZyBjb21tYW5kIChpbiBjYXNlIGVkaXRvci1jaGFuZ2UgZXZlbnQgbWlzc2VkIGl0KVxuXHRcdFx0Y29uc3QgY3VycmVudFBvcyA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEN1cnNvclBvc2l0aW9uKCk7XG5cdFx0XHRpZiAoY3VycmVudFBvcykge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRGaWxlQ3Vyc29yUG9zaXRpb24gPSBjdXJyZW50UG9zO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiBmb3IgdGhpcyBmaWxlIGJlZm9yZSBleGVjdXRpbmcgY29tbWFuZFxuXHRcdFx0Ly8gVGhpcyBub3cgaGFwcGVucyBBRlRFUiB3b3Jrc3BhY2UgaGFzIHN3aXRjaGVkIHRvIGVuc3VyZSBjb3JyZWN0IGZpbGUgaXMgYWN0aXZlXG5cdFx0XHR0aGlzLnJlc3RvcmVDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0XG5cdFx0XHRsZXQgcmVzdWx0O1xuXHRcdFx0XG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0cmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlQWRkQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUVkaXRDb21tYW5kV2l0aFN0cmVhbWluZyhjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5kZWxldGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdncmFtbWFyJzpcblx0XHRcdFx0XHRyZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVHcmFtbWFyQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJld3JpdGVDb21tYW5kV2l0aFN0cmVhbWluZyhjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnbWV0YWRhdGEnOlxuXHRcdFx0XHRcdHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLm1ldGFkYXRhQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gYEkgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgY29tbWFuZCBcIiR7Y29tbWFuZC5hY3Rpb259XCIuIFRyeSBhc2tpbmcgbWUgdG8gYWRkLCBlZGl0LCBkZWxldGUsIGZpeCBncmFtbWFyLCByZXdyaXRlIGNvbnRlbnQsIG9yIHVwZGF0ZSBtZXRhZGF0YS9wcm9wZXJ0aWVzLmA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChyZXN1bHQuc3VjY2Vzcykge1xuXHRcdFx0XHQvLyBTaG93IHN1Y2Nlc3MgaW5kaWNhdG9yIGZvciBjb21tYW5kIGNvbXBsZXRpb25cblx0XHRcdFx0dGhpcy5hZGRTdWNjZXNzSW5kaWNhdG9yKGNvbW1hbmQuYWN0aW9uKTtcblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiBudWxsOyAvLyBEb24ndCByZXR1cm4gdGV4dCBmb3IgcmVndWxhciBtZXNzYWdlXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBTaG93IGVycm9yIGluZGljYXRvciBmb3IgY29tbWFuZCBmYWlsdXJlXG5cdFx0XHRcdHRoaXMuYWRkRXJyb3JJbmRpY2F0b3IoY29tbWFuZC5hY3Rpb24sIHJlc3VsdC5lcnJvcik7XG5cdFx0XHRcdFxuXHRcdFx0XHRyZXR1cm4gbnVsbDsgLy8gRG9uJ3QgcmV0dXJuIHRleHQgZm9yIHJlZ3VsYXIgbWVzc2FnZVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBTaG93IGVycm9yIGluZGljYXRvciBmb3IgZXhlY3V0aW9uIGVycm9yXG5cdFx0XHR0aGlzLmFkZEVycm9ySW5kaWNhdG9yKCdleGVjdXRlJywgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIG51bGw7IC8vIERvbid0IHJldHVybiB0ZXh0IGZvciByZWd1bGFyIG1lc3NhZ2Vcblx0XHR9XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgbG9hZENvbnZlcnNhdGlvbkZvckFjdGl2ZUZpbGUoKSB7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gRW5zdXJlIGZpbGUgc3dpdGNoZXMgZG9uJ3QgdHJpZ2dlciBwcm92aWRlciBzd2l0Y2ggbWVzc2FnZXNcblx0XHR0aGlzLmlzVXNlckluaXRpYXRlZFByb3ZpZGVyQ2hhbmdlID0gZmFsc2U7XG5cdFx0XG5cdFx0Ly8gUEhBU0UgMyBGSVg6IEdlbmVyYXRlIG9wZXJhdGlvbiBJRCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuXHRcdGNvbnN0IG9wZXJhdGlvbklkID0gRGF0ZS5ub3coKS50b1N0cmluZygpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuXHRcdHRoaXMuY3VycmVudEZpbGVMb2FkT3BlcmF0aW9uID0gb3BlcmF0aW9uSWQ7XG5cdFx0XG5cdFx0Ly8gSWYgbm8gYWN0aXZlIGZpbGUsIHRyeSB0byBmaW5kIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxlYWYncyBmaWxlXG5cdFx0bGV0IHRhcmdldEZpbGUgPSBhY3RpdmVGaWxlO1xuXHRcdGlmICghdGFyZ2V0RmlsZSkge1xuXHRcdFx0Y29uc3QgYWN0aXZlTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmO1xuXHRcdFx0aWYgKGFjdGl2ZUxlYWYgJiYgYWN0aXZlTGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0XHRcdHRhcmdldEZpbGUgPSBhY3RpdmVMZWFmLnZpZXcuZmlsZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGwgYmFjayB0byBhbnkgb3BlbiBtYXJrZG93biBmaWxlIG9ubHkgaWYgbm8gYWN0aXZlIGxlYWZcblx0XHRcdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcblx0XHRcdFx0aWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYXZlc1swXS52aWV3IGFzIE1hcmtkb3duVmlldztcblx0XHRcdFx0XHR0YXJnZXRGaWxlID0gdmlldy5maWxlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIG5vIGZpbGUgYXZhaWxhYmxlIGFuZCB3ZSBoYXZlIGEgY3VycmVudCBmaWxlLCBjbGVhciBldmVyeXRoaW5nXG5cdFx0aWYgKCF0YXJnZXRGaWxlICYmIHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdHRoaXMuY3VycmVudEZpbGUgPSBudWxsO1xuXHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLmVtcHR5KCk7XG5cdFx0XHQvLyBJbW1lZGlhdGVseSBjbGVhciBjb250ZXh0IHN0YXRlIHRvIHByZXZlbnQgYmxlZWRpbmdcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0dGhpcy5jb250ZXh0TWFuYWdlci5zZXRDdXJyZW50RmlsZShudWxsKTtcblx0XHRcdHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoJ09wZW4gYSBkb2N1bWVudCB0byBnZXQgc3RhcnRlZC4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbm8gZmlsZSBvciBzYW1lIGZpbGUsIGRvIG5vdGhpbmdcblx0XHRpZiAoIXRhcmdldEZpbGUgfHwgdGFyZ2V0RmlsZSA9PT0gdGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBTZXQgY3VycmVudCBmaWxlIGluIENvbnRleHRNYW5hZ2VyIGJ1dCBkb24ndCByZXN0b3JlIGNvbnRleHQgeWV0ICh3aWxsIGRvIGFmdGVyIGNoYXQgbG9hZHMpXG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5zZXRDdXJyZW50RmlsZSh0YXJnZXRGaWxlKTtcblx0XHRcblx0XHQvLyBDbGVhciBjdXJzb3IgdHJhY2tpbmcgd2hlbiBzd2l0Y2hpbmcgdG8gYSBuZXcgZmlsZVxuXHRcdHRoaXMuY3VycmVudEZpbGVDdXJzb3JQb3NpdGlvbiA9IG51bGw7XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50RmlsZSA9IHRhcmdldEZpbGU7XG5cdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IHRoaXMuY29udGV4dE1hbmFnZXIuZ2V0Q3VycmVudENvbnRleHQoKTtcblx0XHRcblx0XHQvLyBVcGRhdGUgVUkgYWZ0ZXIgQ29udGV4dE1hbmFnZXIgaGFzIGxvYWRlZCBkYXRhXG5cdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIGRvY3VtZW50IHN0YXRpc3RpY3MgaW4gaGVhZGVyXG5cdFx0dGhpcy5yZWZyZXNoQWxsU3RhdHMoKTtcblx0XHRcblx0XHQvLyBJbW1lZGlhdGVseSB0cmFjayBjdXJzb3IgcG9zaXRpb24gZm9yIHRoZSBuZXdseSBhY3RpdmUgZmlsZVxuXHRcdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZWRpdG9yKSB7XG5cdFx0XHR0aGlzLnRyYWNrQ3Vyc29yUG9zaXRpb24oYWN0aXZlVmlldy5lZGl0b3IpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDbGVhciBjdXJyZW50IGNoYXRcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBQSEFTRSAzIEZJWDogQ2hlY2sgaWYgdGhpcyBvcGVyYXRpb24gaXMgc3RpbGwgY3VycmVudCBiZWZvcmUgcHJvY2VlZGluZ1xuXHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlTG9hZE9wZXJhdGlvbiAhPT0gb3BlcmF0aW9uSWQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFVzZSBDaGF0UmVuZGVyZXIncyBsb2FkQ29udmVyc2F0aW9uSGlzdG9yeSB3aGljaCBoYW5kbGVzIGFsbCBtZXNzYWdlIHR5cGVzIGluY2x1ZGluZyBzeXN0ZW0gbWVzc2FnZXMgd2l0aCBzdHlsaW5nXG5cdFx0XHRhd2FpdCB0aGlzLmNoYXRSZW5kZXJlci5sb2FkQ29udmVyc2F0aW9uSGlzdG9yeSh0YXJnZXRGaWxlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUEhBU0UgMyBGSVg6IENoZWNrIGFnYWluIGFmdGVyIGFzeW5jIG9wZXJhdGlvblxuXHRcdFx0aWYgKHRoaXMuY3VycmVudEZpbGVMb2FkT3BlcmF0aW9uICE9PSBvcGVyYXRpb25JZCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIE5vdyByZXN0b3JlIGNvbnRleHQgYWZ0ZXIgY2hhdCBpcyBsb2FkZWQgKHNvIG1pc3NpbmcgZmlsZSBub3RpZmljYXRpb25zIHBlcnNpc3QpXG5cdFx0XHRhd2FpdCB0aGlzLmNvbnRleHRNYW5hZ2VyLnJlc3RvcmVDb250ZXh0QWZ0ZXJDaGF0TG9hZCh0YXJnZXRGaWxlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmVmcmVzaCB0aGUgY29udGV4dCBVSSBhZnRlciByZXN0b3JhdGlvbiB0byByZW1vdmUgYW55IHN0YWxlIHJlZmVyZW5jZXNcblx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHRcdFxuXHRcdFx0Ly8gU2hvdyBkb2N1bWVudCBpbnNpZ2h0cyBhZnRlciBsb2FkaW5nIGNvbnZlcnNhdGlvblxuXHRcdFx0YXdhaXQgdGhpcy5zaG93RG9jdW1lbnRJbnNpZ2h0cyh0YXJnZXRGaWxlKTtcblx0XHRcdFxuXHRcdFx0Ly8gUEhBU0UgMyBGSVg6IEZpbmFsIGNoZWNrIGFmdGVyIGFsbCBhc3luYyBvcGVyYXRpb25zXG5cdFx0XHRpZiAodGhpcy5jdXJyZW50RmlsZUxvYWRPcGVyYXRpb24gIT09IG9wZXJhdGlvbklkKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQ2hhdFJlbmRlcmVyIHdpbGwgaGFuZGxlIHNob3dpbmcgd2VsY29tZSBtZXNzYWdlIGlmIG5vIGNvbnZlcnNhdGlvbiBleGlzdHNcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignQ29udmVyc2F0aW9uIGxvYWRpbmcgZXJyb3I6JywgZXJyb3IpO1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGxvYWQgY29udmVyc2F0aW9uIGhpc3RvcnkgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2Ugb24gZXJyb3Jcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNsZWFyQ2hhdCgpIHtcblx0XHQvLyBDbGVhciB0aGUgY2hhdCBjb250YWluZXJcblx0XHR0aGlzLmNoYXRDb250YWluZXIuZW1wdHkoKTtcblx0XHRcblx0XHQvLyBDbGVhciBjb252ZXJzYXRpb24gaW4gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnZlcnNhdGlvbih0aGlzLmN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENsZWFyIHRva2VuIHdhcm5pbmdzXG5cdFx0XHRcdHRoaXMubGFzdFRva2VuV2FybmluZ3MgPSB7fTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIEZhaWxlZCB0byBjbGVhciBjb252ZXJzYXRpb24gLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBTaG93IG5vdGljZSB0byB1c2VyXG5cdFx0bmV3IE5vdGljZSgnQ2hhdCBjbGVhcmVkJyk7XG5cdFx0XG5cdFx0Ly8gU2hvdyB3ZWxjb21lIG1lc3NhZ2UgZmlyc3QsIGJlZm9yZSBjb250ZXh0IHJlZnJlc2ggdHJpZ2dlcnMgd2FybmluZ3Ncblx0XHR0aGlzLmFkZFdlbGNvbWVNZXNzYWdlKCk7XG5cdFx0XG5cdFx0Ly8gVGhlbiByZWZyZXNoIGNvbnRleHQgdG8gcmVidWlsZCBjdXJyZW50Q29udGV4dCBmcm9tIHBlcnNpc3RlbnQgc3RvcmFnZSBhbmQgdXBkYXRlIFVJXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdGF3YWl0IHRoaXMucmVmcmVzaENvbnRleHQoKTtcblx0XHR9XG5cdH1cblxuXHQvLyBDb29yZGluYXRvciBtZXRob2QgdGhhdCB1cGRhdGVzIGJvdGggZG9jdW1lbnQgc3RhdHMgYW5kIGNvbnRleHQgcmVtYWluaW5nXG5cdHByaXZhdGUgYXN5bmMgcmVmcmVzaEFsbFN0YXRzKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdC8vIFNraXAgdXBkYXRlcyBkdXJpbmcgc3RyZWFtaW5nIHRvIGF2b2lkIGNvbmZsaWN0c1xuXHRcdGlmICh0aGlzLnN0cmVhbWluZ01hbmFnZXIuaXNTdHJlYW1pbmcoKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRhd2FpdCB0aGlzLnVwZGF0ZURvY3VtZW50U3RhdHMoKTtcblx0XHRcblx0XHQvLyBSZWZyZXNoIGNvbnRleHQgdG8gcmVjYWxjdWxhdGUgdG9rZW4gY291bnRzIHdpdGggdXBkYXRlZCBkb2N1bWVudCBjb250ZW50XG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFxuXHRcdHRoaXMudXBkYXRlQ29udGV4dFJlbWFpbmluZygpO1xuXHR9XG5cblx0Ly8gVXBkYXRlIG9ubHkgZG9jdW1lbnQgc3RhdGlzdGljcyAod29yZCBjb3VudCwgc2VjdGlvbnMpXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlRG9jdW1lbnRTdGF0cygpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRpZiAoIWFjdGl2ZUZpbGUpIHJldHVybjtcblx0XHRcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IGRvY3VtZW50IGNvbnRlbnRcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGFjdGl2ZUZpbGUpO1xuXHRcdFx0aWYgKCFjb250ZW50KSByZXR1cm47XG5cdFx0XHRcblx0XHRcdC8vIENhbGN1bGF0ZSBiYXNpYyBzdGF0c1xuXHRcdFx0Y29uc3Qgd29yZENvdW50ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMCkubGVuZ3RoO1xuXHRcdFx0Y29uc3QgaGVhZGluZ0NvdW50ID0gKGNvbnRlbnQubWF0Y2goL14jezEsNn1cXHMvZ20pIHx8IFtdKS5sZW5ndGg7XG5cdFx0XHRcblx0XHRcdC8vIFVwZGF0ZSBzdGF0cyBkaXNwbGF5IGluIGhlYWRlclxuXHRcdFx0Y29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLWhlYWRlcicpO1xuXHRcdFx0aWYgKGhlYWRlckVsKSB7XG5cdFx0XHRcdC8vIEZpbmQgb3IgY3JlYXRlIHN0YXRzIGNvbnRhaW5lclxuXHRcdFx0XHRsZXQgc3RhdHNDb250YWluZXIgPSBoZWFkZXJFbC5xdWVyeVNlbGVjdG9yKCcubm92YS1kb2N1bWVudC1zdGF0cy1jb250YWluZXInKTtcblx0XHRcdFx0aWYgKCFzdGF0c0NvbnRhaW5lcikge1xuXHRcdFx0XHRcdHN0YXRzQ29udGFpbmVyID0gaGVhZGVyRWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnbm92YS1kb2N1bWVudC1zdGF0cy1jb250YWluZXInIH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBGaW5kIG9yIGNyZWF0ZSBkb2N1bWVudCBzdGF0cyBlbGVtZW50XG5cdFx0XHRcdGxldCBzdGF0c0VsID0gc3RhdHNDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtZG9jdW1lbnQtc3RhdHMnKTtcblx0XHRcdFx0aWYgKCFzdGF0c0VsKSB7XG5cdFx0XHRcdFx0c3RhdHNFbCA9IHN0YXRzQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtZG9jdW1lbnQtc3RhdHMnIH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoc3RhdHNFbCAmJiB3b3JkQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0Ly8gQ2FsY3VsYXRlIHJlYWRpbmcgdGltZSAod29yZHMgLyAyMjUgPSBtaW51dGVzKVxuXHRcdFx0XHRcdGNvbnN0IHJlYWRpbmdUaW1lID0gTWF0aC5jZWlsKHdvcmRDb3VudCAvIDIyNSk7XG5cdFx0XHRcdFx0c3RhdHNFbC50ZXh0Q29udGVudCA9IGB+ICR7cmVhZGluZ1RpbWV9IG1pbiByZWFkYDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBTaWxlbnRseSBmYWlsIC0gc3RhdHMgYXJlIG9wdGlvbmFsXG5cdFx0fVxuXHR9XG5cblx0Ly8gVXBkYXRlIG9ubHkgY29udGV4dCByZW1haW5pbmcgZGlzcGxheSAodG9rZW4gcGVyY2VudGFnZSlcblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0UmVtYWluaW5nKCk6IHZvaWQge1xuXHRcdHRoaXMudXBkYXRlVG9rZW5EaXNwbGF5KCk7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZVRva2VuRGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCBoZWFkZXJFbCA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtaGVhZGVyJyk7XG5cdFx0aWYgKCFoZWFkZXJFbCkgcmV0dXJuO1xuXHRcdFxuXHRcdC8vIEZpbmQgb3IgY3JlYXRlIHN0YXRzIGNvbnRhaW5lciBhbmQgYm90aCBlbGVtZW50cyBpZiB0aGV5IGRvbid0IGV4aXN0XG5cdFx0bGV0IHN0YXRzQ29udGFpbmVyID0gaGVhZGVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtZG9jdW1lbnQtc3RhdHMtY29udGFpbmVyJyk7XG5cdFx0aWYgKCFzdGF0c0NvbnRhaW5lcikge1xuXHRcdFx0c3RhdHNDb250YWluZXIgPSBoZWFkZXJFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLWRvY3VtZW50LXN0YXRzLWNvbnRhaW5lcicgfSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEVuc3VyZSBkb2N1bWVudCBzdGF0cyBlbGVtZW50IGV4aXN0cyAobGVmdCBzaWRlKVxuXHRcdGxldCBzdGF0c0VsID0gc3RhdHNDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtZG9jdW1lbnQtc3RhdHMnKTtcblx0XHRpZiAoIXN0YXRzRWwpIHtcblx0XHRcdHN0YXRzRWwgPSBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLWRvY3VtZW50LXN0YXRzJyB9KTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRW5zdXJlIHRva2VuIGVsZW1lbnQgZXhpc3RzIChyaWdodCBzaWRlKVxuXHRcdGxldCB0b2tlbkVsID0gc3RhdHNDb250YWluZXIucXVlcnlTZWxlY3RvcignLm5vdmEtdG9rZW4tdXNhZ2UnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAoIXRva2VuRWwpIHtcblx0XHRcdHRva2VuRWwgPSBzdGF0c0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLXRva2VuLXVzYWdlJyB9KTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gR2V0IHRvdGFsIGNvbnRleHQgdXNhZ2UgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgZmFsbCBiYWNrIHRvIG9sZCBjYWxjdWxhdGlvblxuXHRcdGNvbnN0IHRvdGFsQ29udGV4dFVzYWdlID0gdGhpcy5jdXJyZW50Q29udGV4dD8udG90YWxDb250ZXh0VXNhZ2U7XG5cdFx0bGV0IHJlbWFpbmluZ1BlcmNlbnQ6IG51bWJlcjtcblx0XHRsZXQgd2FybmluZ0xldmVsOiBzdHJpbmc7XG5cdFx0bGV0IGRpc3BsYXlUZXh0OiBzdHJpbmc7XG5cdFx0bGV0IHRvb2x0aXBUZXh0OiBzdHJpbmc7XG5cdFx0XG5cdFx0aWYgKHRvdGFsQ29udGV4dFVzYWdlKSB7XG5cdFx0XHQvLyBVc2UgbmV3IHRvdGFsIGNvbnRleHQgY2FsY3VsYXRpb25cblx0XHRcdHJlbWFpbmluZ1BlcmNlbnQgPSBnZXRSZW1haW5pbmdDb250ZXh0UGVyY2VudGFnZSh0b3RhbENvbnRleHRVc2FnZSk7XG5cdFx0XHR3YXJuaW5nTGV2ZWwgPSBnZXRDb250ZXh0V2FybmluZ0xldmVsKHRvdGFsQ29udGV4dFVzYWdlKTtcblx0XHRcdGRpc3BsYXlUZXh0ID0gZm9ybWF0Q29udGV4dFVzYWdlKHRvdGFsQ29udGV4dFVzYWdlKTtcblx0XHRcdHRvb2x0aXBUZXh0ID0gZ2V0Q29udGV4dFRvb2x0aXAodG90YWxDb250ZXh0VXNhZ2UpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyB0b3RhbCBjb250ZXh0IHVzYWdlIGF2YWlsYWJsZSAtIHNob3cgbWluaW1hbCBpbmZvIHdpdGhvdXQgd2FybmluZ3Ncblx0XHRcdGNvbnN0IGN1cnJlbnRUb2tlbnMgPSB0aGlzLmN1cnJlbnRDb250ZXh0Py50b2tlbkNvdW50IHx8IDA7XG5cdFx0XHRyZW1haW5pbmdQZXJjZW50ID0gMTAwOyAvLyBEb24ndCBjYWxjdWxhdGUgcGVyY2VudGFnZSB3aXRob3V0IHByb3BlciBjb250ZXh0IGxpbWl0c1xuXHRcdFx0ZGlzcGxheVRleHQgPSBjdXJyZW50VG9rZW5zID4gMCA/IGAke2N1cnJlbnRUb2tlbnN9IHRva2Vuc2AgOiAnMCUgbGVmdCc7XG5cdFx0XHR0b29sdGlwVGV4dCA9IGBGaWxlIGNvbnRleHQ6ICR7Y3VycmVudFRva2Vuc30gdG9rZW5zICh0b3RhbCBjb250ZXh0IGNhbGN1bGF0aW9uIHVuYXZhaWxhYmxlKWA7XG5cdFx0XHR3YXJuaW5nTGV2ZWwgPSAnc2FmZSc7IC8vIE5vIHdhcm5pbmdzIHdoZW4gY2FsY3VsYXRpb24gdW5hdmFpbGFibGVcblx0XHR9XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIGRpc3BsYXkgdGV4dFxuXHRcdHRva2VuRWwudGV4dENvbnRlbnQgPSBkaXNwbGF5VGV4dDtcblx0XHRcblx0XHQvLyBTZXQgdG9vbHRpcFxuXHRcdHRva2VuRWwudGl0bGUgPSB0b29sdGlwVGV4dDtcblx0XHRcblx0XHQvLyBBcHBseSBjb2xvciBjb2RpbmcgYW5kIHNob3cgd2FybmluZ3Ncblx0XHR0b2tlbkVsLmNsYXNzTmFtZSA9ICdub3ZhLXRva2VuLXVzYWdlJztcblx0XHRpZiAod2FybmluZ0xldmVsID09PSAnc2FmZScpIHtcblx0XHRcdHRva2VuRWwuYWRkQ2xhc3MoJ25vdmEtdG9rZW4tc2FmZScpO1xuXHRcdH0gZWxzZSBpZiAod2FybmluZ0xldmVsID09PSAnd2FybmluZycpIHtcblx0XHRcdHRva2VuRWwuYWRkQ2xhc3MoJ25vdmEtdG9rZW4td2FybmluZycpO1xuXHRcdFx0dGhpcy5zaG93VG9rZW5XYXJuaW5nKDg1KTsgLy8gODUlIHVzYWdlID0gMTUlIHJlbWFpbmluZ1xuXHRcdH0gZWxzZSBpZiAod2FybmluZ0xldmVsID09PSAnY3JpdGljYWwnKSB7XG5cdFx0XHR0b2tlbkVsLmFkZENsYXNzKCdub3ZhLXRva2VuLWRhbmdlcicpO1xuXHRcdFx0dGhpcy5zaG93VG9rZW5XYXJuaW5nKDk1KTsgLy8gOTUlIHVzYWdlID0gNSUgcmVtYWluaW5nXG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzaG93VG9rZW5XYXJuaW5nKHRocmVzaG9sZDogbnVtYmVyKTogdm9pZCB7XG5cdFx0Ly8gUHJldmVudCBkdXBsaWNhdGUgd2FybmluZ3MgLSBvbmx5IHNob3cgb25jZSBwZXIgdGhyZXNob2xkIHBlciBjb250ZXh0IHNlc3Npb25cblx0XHRjb25zdCB3YXJuaW5nS2V5ID0gYHRva2VuLXdhcm5pbmctJHt0aHJlc2hvbGR9YDtcblx0XHRcblx0XHQvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IHNob3duIHRoaXMgdGhyZXNob2xkIHdhcm5pbmdcblx0XHRpZiAodGhpcy5sYXN0VG9rZW5XYXJuaW5nc1t3YXJuaW5nS2V5XSkgcmV0dXJuO1xuXHRcdFxuXHRcdC8vIE1hcmsgdGhpcyB0aHJlc2hvbGQgYXMgd2FybmVkXG5cdFx0dGhpcy5sYXN0VG9rZW5XYXJuaW5nc1t3YXJuaW5nS2V5XSA9IERhdGUubm93KCk7XG5cdFx0XG5cdFx0bGV0IG1lc3NhZ2U6IHN0cmluZztcblx0XHRpZiAodGhyZXNob2xkID09PSA3NSkge1xuXHRcdFx0bWVzc2FnZSA9IFwiXHUyMTM5XHVGRTBGIENvbnRleHQgdXNhZ2UgaXMgZ3Jvd2luZy4gQ3VycmVudCBjb252ZXJzYXRpb24gYW5kIGZpbGUgY29udGV4dCBhcmUgdXNpbmcgc2lnbmlmaWNhbnQgdG9rZW5zLlwiO1xuXHRcdH0gZWxzZSBpZiAodGhyZXNob2xkID09PSA4NSkge1xuXHRcdFx0bWVzc2FnZSA9IFwiXHUyNkEwXHVGRTBGIENvbnRleHQgdXNhZ2UgaGlnaCAoODUlKS4gQ29uc2lkZXIgc3RhcnRpbmcgYSBuZXcgY29udmVyc2F0aW9uIG9yIHJlbW92aW5nIGZpbGUgY29udGV4dCBmb3IgYmV0dGVyIEFJIHBlcmZvcm1hbmNlLlwiO1xuXHRcdH0gZWxzZSBpZiAodGhyZXNob2xkID09PSA5NSkge1xuXHRcdFx0bWVzc2FnZSA9IFwiXHUyNkEwXHVGRTBGIENvbnRleHQgbmVhcmx5IGZ1bGwgKDk1JSkuIFN0YXJ0IGEgbmV3IGNvbnZlcnNhdGlvbiBvciBjbGVhciBjb250ZXh0IGltbWVkaWF0ZWx5IGZvciByZWxpYWJsZSBBSSByZXNwb25zZXMuXCI7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIExlZ2FjeSBmYWxsYmFja1xuXHRcdFx0bWVzc2FnZSA9IFwiXHUyNkEwXHVGRTBGIENvbnRleHQgYXBwcm9hY2hpbmcgbGltaXQuIENvbnNpZGVyIGNsZWFyaW5nIGNvbnRleHQgb3Igc3RhcnRpbmcgYSBuZXcgY29udmVyc2F0aW9uLlwiO1xuXHRcdH1cblx0XHRcblx0XHR0aGlzLmFkZFdhcm5pbmdNZXNzYWdlKG1lc3NhZ2UpO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRXYXJuaW5nTWVzc2FnZShjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLmNoYXRSZW5kZXJlci5hZGRXYXJuaW5nTWVzc2FnZShjb250ZW50LCB0cnVlKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgc2hvd0RvY3VtZW50SW5zaWdodHMoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRjb25zdCBhbmFseXNpcyA9IERvY3VtZW50QW5hbHl6ZXIuYW5hbHl6ZVN0cnVjdHVyZShjb250ZW50KTtcblx0XHRcdFxuXHRcdFx0aWYgKGFuYWx5c2lzLmVtcHR5SGVhZGluZ3MubGVuZ3RoID4gMCB8fCBhbmFseXNpcy5pbmNvbXBsZXRlQnVsbGV0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGNvbnN0IGluc2lnaHRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGFuYWx5c2lzLmVtcHR5SGVhZGluZ3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGluc2lnaHRzLnB1c2goYCR7YW5hbHlzaXMuZW1wdHlIZWFkaW5ncy5sZW5ndGh9IGVtcHR5IGhlYWRpbmcke2FuYWx5c2lzLmVtcHR5SGVhZGluZ3MubGVuZ3RoID4gMSA/ICdzJyA6ICcnfSB0byBmaWxsYCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmIChhbmFseXNpcy5pbmNvbXBsZXRlQnVsbGV0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0aW5zaWdodHMucHVzaChgJHthbmFseXNpcy5pbmNvbXBsZXRlQnVsbGV0cy5sZW5ndGh9IGluY29tcGxldGUgYnVsbGV0JHthbmFseXNpcy5pbmNvbXBsZXRlQnVsbGV0cy5sZW5ndGggPiAxID8gJ3MnIDogJyd9YCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmIChpbnNpZ2h0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgYnVsbGV0TGlzdCA9IGluc2lnaHRzLm1hcChpbnNpZ2h0ID0+IGBcdTIwMjIgJHtpbnNpZ2h0fWApLmpvaW4oJ1xcbicpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIENyZWF0ZSBhIGN1c3RvbSBsZWZ0LWFsaWduZWQgbWVzc2FnZSBmb3IgZG9jdW1lbnQgaW5zaWdodHNcblx0XHRcdFx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS1hc3Npc3RhbnQgbm92YS1pbnNpZ2h0cycgfSk7XG5cdFx0XHRcdFx0bWVzc2FnZUVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XG5cdFx0XHRcdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMykgdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0XHRcdFx0bWF4LXdpZHRoOiA4NSU7XG5cdFx0XHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTtcblx0XHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1xuXHRcdFx0XHRcdFx0dGV4dC1hbGlnbjogbGVmdDtcblx0XHRcdFx0XHRcdG1hcmdpbi1sZWZ0OiAwO1xuXHRcdFx0XHRcdFx0bWFyZ2luLXJpZ2h0OiBhdXRvO1xuXHRcdFx0XHRcdGA7XG5cblx0XHRcdFx0XHRjb25zdCByb2xlRWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgXG5cdFx0XHRcdFx0XHR0ZXh0OiAnTm92YScsXG5cdFx0XHRcdFx0XHRjbHM6ICdub3ZhLW1lc3NhZ2Utcm9sZSdcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRyb2xlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTtcblx0XHRcdFx0XHRcdG9wYWNpdHk6IDAuNztcblx0XHRcdFx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0XHRcdFx0YDtcblxuXHRcdFx0XHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0XHRcdFx0Y29udGVudEVsLnN0eWxlLmNzc1RleHQgPSAnd2hpdGUtc3BhY2U6IHByZS1saW5lOyB0ZXh0LWFsaWduOiBsZWZ0Oyc7XG5cdFx0XHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gYEkgbm90aWNlZDpcXG5cXG4ke2J1bGxldExpc3R9XFxuXFxuTGV0IG1lIGhlbHAuYDtcblxuXHRcdFx0XHRcdC8vIFNjcm9sbCB0byBzaG93IHRoZSBuZXcgbWVzc2FnZVxuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbFRvcCA9IHRoaXMuY2hhdENvbnRhaW5lci5zY3JvbGxIZWlnaHQ7XG5cdFx0XHRcdFx0fSwgNTApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIFNpbGVudGx5IGZhaWwgLSBhbmFseXNpcyBpcyBvcHRpb25hbFxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgY29uc3VsdGF0aW9uIHJlcXVlc3RzIC0gY2hhdCBvbmx5LCBubyBkb2N1bWVudCBtb2RpZmljYXRpb25cblx0ICovXG5cdGFzeW5jIGhhbmRsZUNvbnN1bHRhdGlvblJlcXVlc3QoaW5wdXQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XG5cdFx0Ly8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIFByb21wdEJ1aWxkZXIgYnV0IGRvIE5PVCBtb2RpZnkgZG9jdW1lbnRcblx0XHRjb25zdCBwcm9tcHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wcm9tcHRCdWlsZGVyLmJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShpbnB1dCwgYWN0aXZlRmlsZSB8fCB1bmRlZmluZWQpO1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCwgcHJvbXB0LnVzZXJQcm9tcHQpO1xuXHRcdFxuXHRcdC8vIERpc3BsYXkgcmVzcG9uc2UgaW4gY2hhdCBvbmx5XG5cdFx0dGhpcy5kaXNwbGF5Q2hhdFJlc3BvbnNlKHJlc3BvbnNlKTtcblx0XHRcblx0XHQvLyBTaG93IHN1YnRsZSBtb2RlIGluZGljYXRvclxuXHRcdHRoaXMuc2hvd01vZGVJbmRpY2F0b3IoJ2NvbnN1bHRhdGlvbicpO1xuXHR9XG5cblx0LyoqXG5cdCAqIERpc3BsYXkgQUkgcmVzcG9uc2UgaW4gY2hhdCB3aXRob3V0IGRvY3VtZW50IG1vZGlmaWNhdGlvblxuXHQgKi9cblx0ZGlzcGxheUNoYXRSZXNwb25zZShyZXNwb25zZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Ly8gVXNlIGV4aXN0aW5nIGNoYXQgcmVuZGVyZXIgdG8gZGlzcGxheSByZXNwb25zZVxuXHRcdHRoaXMuY2hhdFJlbmRlcmVyLmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIHJlc3BvbnNlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTaG93IHN1YnRsZSBpbmRpY2F0b3IgZm9yIGNvbnN1bHRhdGlvbiB2cyBlZGl0aW5nIG1vZGVcblx0ICovXG5cdHNob3dNb2RlSW5kaWNhdG9yKG1vZGU6ICdjb25zdWx0YXRpb24nIHwgJ2VkaXRpbmcnKTogdm9pZCB7XG5cdFx0Ly8gRm9yIG5vdywgdGhpcyBpcyBhIG5vLW9wIHBsYWNlaG9sZGVyXG5cdFx0Ly8gRnV0dXJlIGVuaGFuY2VtZW50OiBzaG93IHN1YnRsZSBVSSBpbmRpY2F0b3Jcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgZWRpdGluZyByZXF1ZXN0cyAtIHByZXNlcnZlcyBleGlzdGluZyBiZWhhdmlvciB3aXRoIGludGVudCB0cmFja2luZ1xuXHQgKi9cblx0YXN5bmMgaGFuZGxlRWRpdGluZ1JlcXVlc3QoaW5wdXQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuXHRcdC8vIFBhcnNlIGNvbW1hbmQgdXNpbmcgZXhpc3RpbmcgcGFyc2VyXG5cdFx0Y29uc3QgcGFyc2VkQ29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKGlucHV0KTtcblx0XHRcblx0XHQvLyBUcmFjayBpbnRlbnQgdXNhZ2UgZm9yIGFuYWx5dGljc1xuXHRcdHRoaXMudHJhY2tJbnRlbnRVc2FnZSgnZWRpdGluZycsIGlucHV0KTtcblx0XHRcblx0XHQvLyBFeGVjdXRlIGNvbW1hbmQgdXNpbmcgZXhpc3Rpbmcgc3lzdGVtXG5cdFx0cmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZUNvbW1hbmQocGFyc2VkQ29tbWFuZCk7XG5cdH1cblxuXHQvKipcblx0ICogVHJhY2sgaW50ZW50IHVzYWdlIGZvciBhbmFseXRpY3MgKHBsYWNlaG9sZGVyIGZvciBmdXR1cmUgZW5oYW5jZW1lbnQpXG5cdCAqL1xuXHR0cmFja0ludGVudFVzYWdlKGludGVudDogJ2NvbnN1bHRhdGlvbicgfCAnZWRpdGluZycsIGlucHV0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHQvLyBGb3Igbm93LCB0aGlzIGlzIGEgbm8tb3AgcGxhY2Vob2xkZXJcblx0XHQvLyBGdXR1cmUgZW5oYW5jZW1lbnQ6IGNvbGxlY3QgYW5hbHl0aWNzIGRhdGFcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgYW1iaWd1b3VzIHJlcXVlc3RzIGJ5IHJvdXRpbmcgdG8gY2hvc2VuIGhhbmRsZXJcblx0ICovXG5cdGFzeW5jIGhhbmRsZUFtYmlndW91c1JlcXVlc3QoaW5wdXQ6IHN0cmluZywgY2hvc2VuSW50ZW50OiAnY29uc3VsdGF0aW9uJyB8ICdlZGl0aW5nJyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmIChjaG9zZW5JbnRlbnQgPT09ICdjb25zdWx0YXRpb24nKSB7XG5cdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUNvbnN1bHRhdGlvblJlcXVlc3QoaW5wdXQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhd2FpdCB0aGlzLmhhbmRsZUVkaXRpbmdSZXF1ZXN0KGlucHV0KTtcblx0XHR9XG5cdH1cblxuXG5cdC8qKlxuXHQgKiBQcm9jZXNzIHVzZXIgaW5wdXQgd2l0aCBpbnRlbnQgZGV0ZWN0aW9uIGludGVncmF0aW9uXG5cdCAqL1xuXHRhc3luYyBwcm9jZXNzVXNlcklucHV0V2l0aEludGVudChpbnB1dDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgaW50ZW50ID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlJbnRlbnRDbGFzc2lmaWVyLmNsYXNzaWZ5SW50ZW50KGlucHV0KTtcblx0XHRcblx0XHRzd2l0Y2ggKGludGVudCkge1xuXHRcdFx0Y2FzZSAnQ0hBVCc6XG5cdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlQ29uc3VsdGF0aW9uUmVxdWVzdChpbnB1dCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnQ09OVEVOVCc6XG5cdFx0XHRcdGF3YWl0IHRoaXMuaGFuZGxlRWRpdGluZ1JlcXVlc3QoaW5wdXQpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ01FVEFEQVRBJzpcblx0XHRcdFx0Ly8gSGFuZGxlIG1ldGFkYXRhIGNvbW1hbmRzIHRocm91Z2ggZXhpc3RpbmcgZmxvd1xuXHRcdFx0XHRjb25zdCBwYXJzZWRDb21tYW5kID0gdGhpcy5wbHVnaW4uY29tbWFuZFBhcnNlci5wYXJzZUNvbW1hbmQoaW5wdXQpO1xuXHRcdFx0XHRhd2FpdCB0aGlzLmV4ZWN1dGVDb21tYW5kKHBhcnNlZENvbW1hbmQpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblxuXHQvLyBQdWJsaWMgbWV0aG9kcyBmb3IgdGVzdGluZ1xuXHRhc3luYyBzZW5kTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFxuXHRcdC8vIEJ1aWxkIHByb21wdCB1c2luZyBQcm9tcHRCdWlsZGVyXG5cdFx0Y29uc3QgcHJvbXB0ID0gYXdhaXQgdGhpcy5wbHVnaW4ucHJvbXB0QnVpbGRlci5idWlsZFByb21wdEZvck1lc3NhZ2UobWVzc2FnZSwgYWN0aXZlRmlsZSB8fCB1bmRlZmluZWQpO1xuXHRcdFxuXHRcdC8vIFRyeSB0byBwYXJzZSBhcyBjb21tYW5kIGZpcnN0XG5cdFx0Y29uc3QgY29tbWFuZCA9IHRoaXMucGx1Z2luLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKG1lc3NhZ2UpO1xuXHRcdFxuXHRcdC8vIENoZWNrIGlmIGl0J3MgYSB2YWxpZCBjb21tYW5kIGFjdGlvblxuXHRcdGNvbnN0IHZhbGlkQWN0aW9ucyA9IFsnYWRkJywgJ2VkaXQnLCAnZGVsZXRlJywgJ2dyYW1tYXInLCAncmV3cml0ZScsICdtZXRhZGF0YSddO1xuXHRcdGlmICh2YWxpZEFjdGlvbnMuaW5jbHVkZXMoY29tbWFuZC5hY3Rpb24pKSB7XG5cdFx0XHQvLyBDUklUSUNBTCBTRUNVUklUWTogVmFsaWRhdGUgdGhhdCB3ZSdyZSBlZGl0aW5nIHRoZSBjb3JyZWN0IGZpbGVcblx0XHRcdC8vIFRoaXMgcHJldmVudHMgYWNjaWRlbnRhbGx5IGVkaXRpbmcgY29udGV4dCBkb2N1bWVudHMgdGhhdCBtaWdodCBiZSBvcGVuXG5cdFx0XHQvLyBPbmx5IGFwcGx5IHRoaXMgdmFsaWRhdGlvbiB3aGVuIGJvdGggZmlsZXMgZXhpc3QgKG5vdCBpbiB0ZXN0IHNjZW5hcmlvcylcblx0XHRcdGNvbnN0IGN1cnJlbnRBY3RpdmVGaWxlID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0aWYgKGFjdGl2ZUZpbGUgJiYgY3VycmVudEFjdGl2ZUZpbGUgJiYgY3VycmVudEFjdGl2ZUZpbGUgIT09IGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBTZWN1cml0eSB2aW9sYXRpb246IENvbW1hbmQgYXR0ZW1wdGVkIHRvIGVkaXQgd3JvbmcgZmlsZS4gRXhwZWN0ZWQ6ICR7YWN0aXZlRmlsZS5iYXNlbmFtZX0sIEFjdGl2ZTogJHtjdXJyZW50QWN0aXZlRmlsZS5iYXNlbmFtZX1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRXhlY3V0ZSBjb21tYW5kXG5cdFx0XHRzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG5cdFx0XHRcdGNhc2UgJ2FkZCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZWRpdCc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZWRpdENvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZGVsZXRlQ29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Jld3JpdGUnOlxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdtZXRhZGF0YSc6XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4ubWV0YWRhdGFDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBSZWd1bGFyIGNvbnZlcnNhdGlvbiAtIG1lc3NhZ2UgYWxyZWFkeSBwZXJzaXN0ZWQgYWJvdmVcblx0XHRcdFxuXHRcdFx0Ly8gQ2FsbCBBSSBwcm92aWRlclxuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuY29tcGxldGUocHJvbXB0LnN5c3RlbVByb21wdCB8fCAnJywgcHJvbXB0LnVzZXJQcm9tcHQpO1xuXHRcdFx0XG5cdFx0XHRpZiAoYWN0aXZlRmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZEFzc2lzdGFudE1lc3NhZ2UoYWN0aXZlRmlsZSwgJ0FJIHJlc3BvbnNlJywgeyBzdWNjZXNzOiB0cnVlLCBlZGl0VHlwZTogJ25vbmUnIH0gYXMgYW55KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBSRU1PVkVEOiBOb3cgdXNpbmcgQ2hhdFJlbmRlcmVyJ3MgbG9hZENvbnZlcnNhdGlvbkhpc3RvcnkgbWV0aG9kIGRpcmVjdGx5XG5cblxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgc2VuZCBidXR0b24gZW5hYmxlZC9kaXNhYmxlZCBzdGF0ZSBiYXNlZCBvbiBwcm92aWRlciBhdmFpbGFiaWxpdHlcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlU2VuZEJ1dHRvblN0YXRlKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0Y29uc3Qgc2VuZEJ1dHRvbiA9ICh0aGlzLmlucHV0SGFuZGxlciBhcyBhbnkpLnNlbmRCdXR0b247XG5cdFx0aWYgKHNlbmRCdXR0b24pIHNlbmRCdXR0b24uc2V0RGlzYWJsZWQoIWN1cnJlbnRQcm92aWRlclR5cGUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBwcml2YWN5IGluZGljYXRvciBpY29uIGFuZCB0b29sdGlwIGJhc2VkIG9uIGN1cnJlbnQgcHJvdmlkZXJcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgdXBkYXRlUHJpdmFjeUluZGljYXRvcihwcml2YWN5SW5kaWNhdG9yOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cdFx0XG5cdFx0Ly8gQ2xlYXIgcHJldmlvdXMgY29udGVudFxuXHRcdHByaXZhY3lJbmRpY2F0b3IuZW1wdHkoKTtcblx0XHRwcml2YWN5SW5kaWNhdG9yLnJlbW92ZUNsYXNzKCdub3ZhLXN0YXR1cy1waWxsJywgJ2xvY2FsJywgJ2Nsb3VkJyk7XG5cdFx0XG5cdFx0Ly8gQXBwbHkgaW5saW5lIHN0eWxlcyBmb3IgY29uc2lzdGVudCBzaXppbmdcblx0XHRwcml2YWN5SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBpbmxpbmUtZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDRweDtcblx0XHRcdHBhZGRpbmc6IDJweCA4cHg7XG5cdFx0XHRib3JkZXItcmFkaXVzOiAxMnB4O1xuXHRcdFx0Zm9udC1zaXplOiAwLjc1ZW07XG5cdFx0XHRmb250LXdlaWdodDogNTAwO1xuXHRcdFx0aGVpZ2h0OiBhdXRvO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNTtcblx0XHRgO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50UHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRjb25zdCBpc0xvY2FsUHJvdmlkZXIgPSBjdXJyZW50UHJvdmlkZXJUeXBlID09PSAnb2xsYW1hJztcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIHBpbGwgc3R5bGluZyBjbGFzc2VzXG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLmFkZENsYXNzKCdub3ZhLXN0YXR1cy1waWxsJyk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLmFkZENsYXNzKGlzTG9jYWxQcm92aWRlciA/ICdsb2NhbCcgOiAnY2xvdWQnKTtcblx0XHRcdFxuXHRcdFx0Ly8gQ3JlYXRlIGljb24gZWxlbWVudFxuXHRcdFx0Y29uc3QgaWNvbkVsID0gcHJpdmFjeUluZGljYXRvci5jcmVhdGVTcGFuKHsgY2xzOiAnbm92YS1zdGF0dXMtaWNvbicgfSk7XG5cdFx0XHRpY29uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0ZGlzcGxheTogaW5saW5lLWZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdHdpZHRoOiAxNHB4O1xuXHRcdFx0XHRoZWlnaHQ6IDE0cHg7XG5cdFx0XHRgO1xuXHRcdFx0Y29uc3QgaWNvbk5hbWUgPSBpc0xvY2FsUHJvdmlkZXIgPyAnc2hpZWxkLWNoZWNrJyA6ICdjbG91ZCc7XG5cdFx0XHRzZXRJY29uKGljb25FbCwgaWNvbk5hbWUpO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgdGV4dCBsYWJlbFxuXHRcdFx0Y29uc3QgbGFiZWxFbCA9IHByaXZhY3lJbmRpY2F0b3IuY3JlYXRlU3Bhbih7IHRleHQ6IGlzTG9jYWxQcm92aWRlciA/ICdMb2NhbCcgOiAnQ2xvdWQnIH0pO1xuXHRcdFx0bGFiZWxFbC5zdHlsZS5jc3NUZXh0ID0gYGxpbmUtaGVpZ2h0OiAxO2A7XG5cdFx0XHRcblx0XHRcdC8vIFNldCB0b29sdGlwXG5cdFx0XHRjb25zdCB0b29sdGlwID0gaXNMb2NhbFByb3ZpZGVyID8gJ0xvY2FsIHByb2Nlc3NpbmcgLSBkYXRhIHN0YXlzIG9uIHlvdXIgZGV2aWNlJyA6ICdDbG91ZCBwcm9jZXNzaW5nIC0gZGF0YSBzZW50IHRvIHByb3ZpZGVyJztcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgdG9vbHRpcCk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0b29sdGlwKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTm8gcHJvdmlkZXIgYXZhaWxhYmxlIC0gc2hvdyBnZW5lcmljIHN0YXR1c1xuXHRcdFx0cHJpdmFjeUluZGljYXRvci5hZGRDbGFzcygnbm92YS1zdGF0dXMtcGlsbCcpO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBpY29uRWwgPSBwcml2YWN5SW5kaWNhdG9yLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLXN0YXR1cy1pY29uJyB9KTtcblx0XHRcdGljb25FbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRkaXNwbGF5OiBpbmxpbmUtZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0d2lkdGg6IDE0cHg7XG5cdFx0XHRcdGhlaWdodDogMTRweDtcblx0XHRcdGA7XG5cdFx0XHRzZXRJY29uKGljb25FbCwgJ2hlbHAtY2lyY2xlJyk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGxhYmVsRWwgPSBwcml2YWN5SW5kaWNhdG9yLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnTm8gcHJvdmlkZXInIH0pO1xuXHRcdFx0bGFiZWxFbC5zdHlsZS5jc3NUZXh0ID0gYGxpbmUtaGVpZ2h0OiAxO2A7XG5cdFx0XHRcblx0XHRcdHByaXZhY3lJbmRpY2F0b3Iuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ05vIHByb3ZpZGVyIHNlbGVjdGVkJyk7XG5cdFx0XHRwcml2YWN5SW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnTm8gcHJvdmlkZXIgc2VsZWN0ZWQnKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRmlsdGVyIHRoaW5raW5nIGNvbnRlbnQgZnJvbSBBSSByZXNwb25zZXNcblx0ICogUmVtb3ZlcyBjb250ZW50IGJldHdlZW4gPHRoaW5rPi88dGhpbmtpbmc+IGFuZCA8L3RoaW5rPi88dGhpbmtpbmc+IHRhZ3Ncblx0ICovXG5cdHByaXZhdGUgZmlsdGVyVGhpbmtpbmdDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUmVtb3ZlIHRoaW5raW5nIHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnQgKGNhc2UtaW5zZW5zaXRpdmUsIG11bHRpLWxpbmUpXG5cdFx0Ly8gSGFuZGxlcyBib3RoIDx0aGluaz4gKFF3ZW4zKSBhbmQgPHRoaW5raW5nPiAoQ2xhdWRlKSB0YWdzXG5cdFx0cmV0dXJuIGNvbnRlbnQucmVwbGFjZSgvPHRoaW5rKD86aW5nKT9bXFxzXFxTXSo/PFxcL3RoaW5rKD86aW5nKT8+L2dpLCAnJykudHJpbSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggYWxsIHByb3ZpZGVyIHN0YXR1cyBpbmRpY2F0b3JzIGluIHRoZSBVSVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyByZWZyZXNoUHJvdmlkZXJTdGF0dXMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Ly8gVXBkYXRlIHByaXZhY3kgaW5kaWNhdG9yIGlmIGl0IGV4aXN0c1xuXHRcdGlmICgodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpIHtcblx0XHRcdGF3YWl0IHRoaXMudXBkYXRlUHJpdmFjeUluZGljYXRvcigodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBzZW5kIGJ1dHRvbiBzdGF0ZVxuXHRcdHRoaXMudXBkYXRlU2VuZEJ1dHRvblN0YXRlKCk7XG5cblx0XHQvLyBVcGRhdGUgZHJvcGRvd24gcHJvdmlkZXIgbmFtZSBpZiBpdCBleGlzdHNcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bj8udXBkYXRlQ3VycmVudFByb3ZpZGVyKSB7XG5cdFx0XHRhd2FpdCAodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLnVwZGF0ZUN1cnJlbnRQcm92aWRlcigpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcHJvdmlkZXIgZHJvcGRvd24gZm9yIGFsbCB1c2VycyB3aXRoIHRoZWlyIG93biBBUEkga2V5c1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBjcmVhdGVQcm92aWRlckRyb3Bkb3duKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBkcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLWNvbnRhaW5lcicgfSk7XG5cdFx0ZHJvcGRvd25Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiByZWxhdGl2ZTtcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHByb3ZpZGVyIGJ1dHRvblxuXHRcdGNvbnN0IHByb3ZpZGVyQnV0dG9uID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnbm92YS1wcm92aWRlci1idXR0b24nIH0pO1xuXHRcdHByb3ZpZGVyQnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdGdhcDogNHB4O1xuXHRcdFx0cGFkZGluZzogNHB4IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC43NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHR0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZTtcblx0XHRgO1xuXG5cdFx0Ly8gUHJvdmlkZXIgbmFtZSAtIHN0YXJ0IHdpdGggYSBwbGFjZWhvbGRlciB0byBwcmV2ZW50IFwiSUlcIiBkaXNwbGF5XG5cdFx0Y29uc3QgcHJvdmlkZXJOYW1lID0gcHJvdmlkZXJCdXR0b24uY3JlYXRlU3Bhbih7IHRleHQ6ICdMb2FkaW5nLi4uJywgY2xzOiAnbm92YS1wcm92aWRlci1uYW1lJyB9KTtcblxuXHRcdC8vIERyb3Bkb3duIGFycm93XG5cdFx0Y29uc3QgZHJvcGRvd25BcnJvdyA9IHByb3ZpZGVyQnV0dG9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnXHUyNUJDJyB9KTtcblx0XHRkcm9wZG93bkFycm93LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRmb250LXNpemU6IDAuNmVtO1xuXHRcdFx0bWFyZ2luLWxlZnQ6IDRweDtcblx0XHRcdHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzIGVhc2U7XG5cdFx0YDtcblxuXHRcdC8vIERyb3Bkb3duIG1lbnUgKGluaXRpYWxseSBoaWRkZW4pXG5cdFx0Y29uc3QgZHJvcGRvd25NZW51ID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1kcm9wZG93bi1tZW51JyB9KTtcblx0XHRkcm9wZG93bk1lbnUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdHRvcDogMTAwJTtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0bWluLXdpZHRoOiAyMDBweDtcblx0XHRcdG1heC13aWR0aDogMjgwcHg7XG5cdFx0XHRtYXgtaGVpZ2h0OiAzMDBweDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA2cHg7XG5cdFx0XHRib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xNSk7XG5cdFx0XHR6LWluZGV4OiAxMDAwO1xuXHRcdFx0ZGlzcGxheTogbm9uZTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRvdmVyZmxvdy14OiBoaWRkZW47XG5cdFx0XHRcblx0XHRcdC8qIE1vYmlsZSByZXNwb25zaXZlIGFkanVzdG1lbnRzICovXG5cdFx0XHRAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHtcblx0XHRcdFx0bWluLXdpZHRoOiAxODBweDtcblx0XHRcdFx0bWF4LXdpZHRoOiAyNTBweDtcblx0XHRcdFx0bWF4LWhlaWdodDogMjUwcHg7XG5cdFx0XHRcdHJpZ2h0OiAtMjBweDsgLyogT2Zmc2V0IHRvIHByZXZlbnQgZWRnZSBjdXRvZmYgKi9cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0LyogU21vb3RoIHNjcm9sbGluZyAqL1xuXHRcdFx0c2Nyb2xsLWJlaGF2aW9yOiBzbW9vdGg7XG5cdFx0XHRcblx0XHRcdC8qIEN1c3RvbSBzY3JvbGxiYXIgc3R5bGluZyAqL1xuXHRcdFx0c2Nyb2xsYmFyLXdpZHRoOiB0aGluO1xuXHRcdFx0c2Nyb2xsYmFyLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcikgdHJhbnNwYXJlbnQ7XG5cdFx0YDtcblx0XHRcblx0XHQvLyBBZGQgd2Via2l0IHNjcm9sbGJhciBzdHlsaW5nIGZvciBiZXR0ZXIgY3Jvc3MtYnJvd3NlciBzdXBwb3J0XG5cdFx0Y29uc3Qgc2Nyb2xsYmFyU3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuXHRcdHNjcm9sbGJhclN0eWxlLnRleHRDb250ZW50ID0gYFxuXHRcdFx0Lm5vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudTo6LXdlYmtpdC1zY3JvbGxiYXIge1xuXHRcdFx0XHR3aWR0aDogNnB4O1xuXHRcdFx0fVxuXHRcdFx0Lm5vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudTo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sge1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcblx0XHRcdH1cblx0XHRcdC5ub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLW1lbnU6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcblx0XHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiAzcHg7XG5cdFx0XHR9XG5cdFx0XHQubm92YS1wcm92aWRlci1kcm9wZG93bi1tZW51Ojotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciB7XG5cdFx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyLWhvdmVyKTtcblx0XHRcdH1cblx0XHRgO1xuXHRcdGlmICghZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdmEtc2Nyb2xsYmFyLXN0eWxlJykpIHtcblx0XHRcdHNjcm9sbGJhclN0eWxlLmNsYXNzTmFtZSA9ICdub3ZhLXNjcm9sbGJhci1zdHlsZSc7XG5cdFx0XHRkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcm9sbGJhclN0eWxlKTtcblx0XHR9XG5cblx0XHRsZXQgaXNEcm9wZG93bk9wZW4gPSBmYWxzZTtcblxuXHRcdC8vIFVwZGF0ZSBjdXJyZW50IG1vZGVsIGRpc3BsYXkgKG9wdGltaXplZCBmb3Igc3BlZWQpXG5cdFx0Y29uc3QgdXBkYXRlQ3VycmVudFByb3ZpZGVyID0gKCkgPT4ge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Ly8gR2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbW9kZWwgc3luY2hyb25vdXNseVxuXHRcdFx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50TW9kZWwoKTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChjdXJyZW50TW9kZWwpIHtcblx0XHRcdFx0XHQvLyBHZXQgcHJvdmlkZXIgdHlwZSBkaXJlY3RseSBmcm9tIG1vZGVsIG5hbWUgKG5vIGFzeW5jIG5lZWRlZClcblx0XHRcdFx0XHRjb25zdCBwcm92aWRlclR5cGUgPSBnZXRQcm92aWRlclR5cGVGb3JNb2RlbChjdXJyZW50TW9kZWwsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFx0XHRpZiAocHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBkaXNwbGF5VGV4dCA9IHRoaXMuZ2V0TW9kZWxEaXNwbGF5TmFtZShwcm92aWRlclR5cGUsIGN1cnJlbnRNb2RlbCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KGRpc3BsYXlUZXh0KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gVW5rbm93biBwcm92aWRlciwgdXNlIHJhdyBtb2RlbCBuYW1lXG5cdFx0XHRcdFx0XHRwcm92aWRlck5hbWUuc2V0VGV4dChjdXJyZW50TW9kZWwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBObyBtb2RlbCBzZWxlY3RlZCwgc2hvdyBmYWxsYmFja1xuXHRcdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KCdTZWxlY3QgTW9kZWwnKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgbW9kZWwgZGlzcGxheTonLCBlcnJvcik7XG5cdFx0XHRcdHByb3ZpZGVyTmFtZS5zZXRUZXh0KCdTZWxlY3QgTW9kZWwnKTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gVG9nZ2xlIGRyb3Bkb3duXG5cdFx0Y29uc3QgdG9nZ2xlRHJvcGRvd24gPSAoKSA9PiB7XG5cdFx0XHRpc0Ryb3Bkb3duT3BlbiA9ICFpc0Ryb3Bkb3duT3Blbjtcblx0XHRcdGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ID0gaXNEcm9wZG93bk9wZW4gPyAnYmxvY2snIDogJ25vbmUnO1xuXHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSBpc0Ryb3Bkb3duT3BlbiA/ICdyb3RhdGUoMTgwZGVnKScgOiAncm90YXRlKDBkZWcpJztcblx0XHRcdFxuXHRcdFx0aWYgKGlzRHJvcGRvd25PcGVuKSB7XG5cdFx0XHRcdHRoaXMucG9wdWxhdGVQcm92aWRlckRyb3Bkb3duKGRyb3Bkb3duTWVudSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIENsb3NlIGRyb3Bkb3duIHdoZW4gY2xpY2tpbmcgb3V0c2lkZVxuXHRcdGNvbnN0IGNsb3NlRHJvcGRvd246IEV2ZW50TGlzdGVuZXIgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoIWRyb3Bkb3duQ29udGFpbmVyLmNvbnRhaW5zKGV2ZW50LnRhcmdldCBhcyBOb2RlKSkge1xuXHRcdFx0XHRpc0Ryb3Bkb3duT3BlbiA9IGZhbHNlO1xuXHRcdFx0XHRkcm9wZG93bk1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdFx0ZHJvcGRvd25BcnJvdy5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDBkZWcpJztcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gQ2xvc2UgZHJvcGRvd24gaGVscGVyIGZ1bmN0aW9uIGZvciBpbnRlcm5hbCB1c2Vcblx0XHRjb25zdCBjbG9zZURyb3Bkb3duSW50ZXJuYWwgPSAoKSA9PiB7XG5cdFx0XHRpc0Ryb3Bkb3duT3BlbiA9IGZhbHNlO1xuXHRcdFx0ZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRkcm9wZG93bkFycm93LnN0eWxlLnRyYW5zZm9ybSA9ICdyb3RhdGUoMGRlZyknO1xuXHRcdH07XG5cblx0XHRwcm92aWRlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0dG9nZ2xlRHJvcGRvd24oKTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBnbG9iYWwgY2xpY2sgbGlzdGVuZXJcblx0XHR0aGlzLmFkZFRyYWNrZWRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZURyb3Bkb3duKTtcblxuXHRcdC8vIFVwZGF0ZSBtb2RlbCBuYW1lIGltbWVkaWF0ZWx5IChubyBhc3luYyBuZWVkZWQpXG5cdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cblx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIGNsZWFudXAgYW5kIGludGVybmFsIGRyb3Bkb3duIGNvbnRyb2xcblx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duID0ge1xuXHRcdFx0dXBkYXRlQ3VycmVudFByb3ZpZGVyLFxuXHRcdFx0Y2xvc2VEcm9wZG93bjogY2xvc2VEcm9wZG93bkludGVybmFsLFxuXHRcdFx0Y2xlYW51cDogKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZURyb3Bkb3duKVxuXHRcdH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGF2YWlsYWJsZSBtb2RlbHMgZm9yIGEgcHJvdmlkZXIgdHlwZVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiB7IHZhbHVlOiBzdHJpbmc7IGxhYmVsOiBzdHJpbmcgfVtdIHtcblx0XHRyZXR1cm4gZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IG1vZGVsIGZvciBhIHByb3ZpZGVyIHR5cGVcblx0ICovXG5cdHByaXZhdGUgZ2V0Q3VycmVudE1vZGVsKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBwcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXHRcdGNvbnN0IGN1cnJlbnRNb2RlbCA9IHByb3ZpZGVyc1twcm92aWRlclR5cGVdPy5tb2RlbDtcblx0XHRcblx0XHRpZiAoY3VycmVudE1vZGVsKSB7XG5cdFx0XHRyZXR1cm4gY3VycmVudE1vZGVsO1xuXHRcdH1cblx0XHRcblx0XHQvLyBHZXQgZGVmYXVsdCBtb2RlbCAoZmlyc3QgYXZhaWxhYmxlIG1vZGVsIGZvciB0aGUgcHJvdmlkZXIpXG5cdFx0Y29uc3QgYXZhaWxhYmxlTW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRyZXR1cm4gYXZhaWxhYmxlTW9kZWxzLmxlbmd0aCA+IDAgPyBhdmFpbGFibGVNb2RlbHNbMF0udmFsdWUgOiAnJztcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgbW9kZWwgZGlzcGxheSBuYW1lIGZyb20gbW9kZWwgdmFsdWUgLSBzZWFyY2hlcyBhbGwgcHJvdmlkZXJzIGlmIG5lZWRlZFxuXHQgKi9cblx0cHJpdmF0ZSBnZXRNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBtb2RlbFZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIEZpcnN0IHRyeSB0aGUgc3BlY2lmaWVkIHByb3ZpZGVyXG5cdFx0bGV0IG1vZGVscyA9IHRoaXMuZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSk7XG5cdFx0bGV0IG1vZGVsID0gbW9kZWxzLmZpbmQobSA9PiBtLnZhbHVlID09PSBtb2RlbFZhbHVlKTtcblx0XHRcblx0XHQvLyBJZiBub3QgZm91bmQgaW4gc3BlY2lmaWVkIHByb3ZpZGVyLCBzZWFyY2ggYWxsIHByb3ZpZGVyc1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdGNvbnN0IHByb3ZpZGVyVHlwZXMgPSBbJ2NsYXVkZScsICdvcGVuYWknLCAnZ29vZ2xlJywgJ29sbGFtYSddO1xuXHRcdFx0Zm9yIChjb25zdCBzZWFyY2hQcm92aWRlclR5cGUgb2YgcHJvdmlkZXJUeXBlcykge1xuXHRcdFx0XHRpZiAoc2VhcmNoUHJvdmlkZXJUeXBlID09PSBwcm92aWRlclR5cGUpIGNvbnRpbnVlOyAvLyBBbHJlYWR5IGNoZWNrZWRcblx0XHRcdFx0bW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMoc2VhcmNoUHJvdmlkZXJUeXBlKTtcblx0XHRcdFx0bW9kZWwgPSBtb2RlbHMuZmluZChtID0+IG0udmFsdWUgPT09IG1vZGVsVmFsdWUpO1xuXHRcdFx0XHRpZiAobW9kZWwpIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRjb25zdCBkaXNwbGF5TmFtZSA9IG1vZGVsID8gbW9kZWwubGFiZWwgOiBtb2RlbFZhbHVlO1xuXHRcdFxuXHRcdHJldHVybiBkaXNwbGF5TmFtZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBzcGVjaWZpYyBtb2RlbCBmb3IgYSBwcm92aWRlclxuXHQgKi9cblx0cHJpdmF0ZSBzd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBtb2RlbFZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gVXBkYXRlIHBsYXRmb3JtIHNldHRpbmdzIGZvciBwZXJzaXN0ZW5jZSAodGhpcyBpcyB3aGF0IGFjdHVhbGx5IG1hdHRlcnMpXG5cdFx0XHRjb25zdCBwbGF0Zm9ybSA9IFBsYXRmb3JtLmlzTW9iaWxlID8gJ21vYmlsZScgOiAnZGVza3RvcCc7XG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5zZWxlY3RlZE1vZGVsID0gbW9kZWxWYWx1ZTtcblx0XHRcdFxuXHRcdFx0Ly8gQWxzbyB1cGRhdGUgcHJvdmlkZXIgbW9kZWwgc2V0dGluZyBmb3IgY29uc2lzdGVuY3lcblx0XHRcdGNvbnN0IHByb3ZpZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmFpUHJvdmlkZXJzIGFzIFJlY29yZDxzdHJpbmcsIGFueT47XG5cdFx0XHRpZiAocHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0pIHtcblx0XHRcdFx0cHJvdmlkZXJzW3Byb3ZpZGVyVHlwZV0ubW9kZWwgPSBtb2RlbFZhbHVlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZSBpbW1lZGlhdGVseSAob3B0aW1pc3RpYyB1cGRhdGUpXG5cdFx0XHRjb25zdCBtb2RlbERpc3BsYXlOYW1lID0gdGhpcy5nZXRNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSwgbW9kZWxWYWx1ZSk7XG5cdFx0XHRjb25zdCBwcm92aWRlckRpc3BsYXlOYW1lID0gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdFx0XHR0aGlzLmFkZFN1Y2Nlc3NNZXNzYWdlKGBcdTI3MTMgU3dpdGNoZWQgdG8gJHtwcm92aWRlckRpc3BsYXlOYW1lfSAke21vZGVsRGlzcGxheU5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdC8vIFNhdmUgc2V0dGluZ3MgYXN5bmNocm9ub3VzbHkgKGRvbid0IGJsb2NrIFVJKVxuXHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCkuY2F0Y2goZXJyb3IgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgbW9kZWwgc2VsZWN0aW9uOicsIGVycm9yKTtcblx0XHRcdFx0dGhpcy5hZGRFcnJvck1lc3NhZ2UoJ0ZhaWxlZCB0byBzYXZlIG1vZGVsIHNlbGVjdGlvbicpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdC8vIEFERCBUSElTOiBSZWZyZXNoIHByaXZhY3kgaW5kaWNhdG9yIGFuZCBvdGhlciBzdGF0dXMgZWxlbWVudHNcblx0XHRcdHRoaXMucmVmcmVzaFByb3ZpZGVyU3RhdHVzKCkuY2F0Y2goZXJyb3IgPT4ge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciByZWZyZXNoaW5nIHByb3ZpZGVyIHN0YXR1czonLCBlcnJvcik7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gUmVmcmVzaCBjb250ZXh0IHRvIHVwZGF0ZSB0b2tlbiBjb3VudCBkaXNwbGF5IGZvciBuZXcgcHJvdmlkZXJcblx0XHRcdHRoaXMucmVmcmVzaENvbnRleHQoKS5jYXRjaChlcnJvciA9PiB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlZnJlc2hpbmcgY29udGV4dCBhZnRlciBtb2RlbCBzd2l0Y2g6JywgZXJyb3IpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igc3dpdGNoaW5nIG1vZGVsOicsIGVycm9yKTtcblx0XHRcdHRoaXMuYWRkRXJyb3JNZXNzYWdlKCdGYWlsZWQgdG8gc3dpdGNoIG1vZGVsJyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBvcHVsYXRlIHByb3ZpZGVyIGRyb3Bkb3duIHdpdGggZ3JvdXBlZCBtb2RlbHMgYW5kIHNlY3Rpb24gaGVhZGVyc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBwb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51OiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGRyb3Bkb3duTWVudS5lbXB0eSgpO1xuXG5cdFx0Ly8gU2hvdyBsb2FkaW5nIHN0YXRlXG5cdFx0Y29uc3QgbG9hZGluZ0l0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1kcm9wZG93bi1sb2FkaW5nJyB9KTtcblx0XHRsb2FkaW5nSXRlbS5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cGFkZGluZzogMTJweDtcblx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0YDtcblx0XHRsb2FkaW5nSXRlbS5zZXRUZXh0KCdMb2FkaW5nIHByb3ZpZGVycy4uLicpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBhbGwgcHJvdmlkZXJzIGluIHBhcmFsbGVsIHdpdGggYXZhaWxhYmlsaXR5IHN0YXR1c1xuXHRcdFx0Y29uc3QgcHJvdmlkZXJBdmFpbGFiaWxpdHkgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRBdmFpbGFibGVQcm92aWRlcnNXaXRoU3RhdHVzKCk7XG5cdFx0XHRjb25zdCBjdXJyZW50TW9kZWwgPSB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50TW9kZWwoKTtcblx0XHRcdGNvbnN0IGN1cnJlbnRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlci5nZXRDdXJyZW50UHJvdmlkZXJUeXBlKCk7XG5cblx0XHRcdC8vIENsZWFyIGxvYWRpbmcgc3RhdGVcblx0XHRcdGRyb3Bkb3duTWVudS5lbXB0eSgpO1xuXG5cdFx0XHQvLyBHcm91cCBtb2RlbHMgYnkgcHJvdmlkZXIgd2l0aCBzZWN0aW9uIGhlYWRlcnNcblx0XHRcdGxldCBoYXNBbnlQcm92aWRlcnMgPSBmYWxzZTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCBbcHJvdmlkZXJUeXBlLCBpc0F2YWlsYWJsZV0gb2YgcHJvdmlkZXJBdmFpbGFiaWxpdHkpIHtcblx0XHRcdFx0aWYgKHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnIHx8ICFpc0F2YWlsYWJsZSkgY29udGludWU7XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgcHJvdmlkZXIgaGFzIEFQSSBrZXkgY29uZmlndXJlZFxuXHRcdFx0XHRjb25zdCBwcm92aWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5haVByb3ZpZGVycyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuXHRcdFx0XHRjb25zdCBoYXNBcGlLZXkgPSBwcm92aWRlcnNbcHJvdmlkZXJUeXBlXT8uYXBpS2V5O1xuXHRcdFx0XHRpZiAoIWhhc0FwaUtleSAmJiBwcm92aWRlclR5cGUgIT09ICdvbGxhbWEnKSBjb250aW51ZTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIHByb3ZpZGVyIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSB0ZXN0ZWRcblx0XHRcdFx0Y29uc3QgcHJvdmlkZXJTdGF0dXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1cz8uW3Byb3ZpZGVyVHlwZV07XG5cdFx0XHRcdGlmICghcHJvdmlkZXJTdGF0dXMgfHwgcHJvdmlkZXJTdGF0dXMuc3RhdHVzICE9PSAnY29ubmVjdGVkJykgY29udGludWU7XG5cblx0XHRcdFx0Y29uc3QgbW9kZWxzID0gdGhpcy5nZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlKTtcblx0XHRcdFx0Y29uc3QgcHJvdmlkZXJEaXNwbGF5TmFtZSA9IHRoaXMuZ2V0UHJvdmlkZXJEaXNwbGF5TmFtZShwcm92aWRlclR5cGUpO1xuXHRcdFx0XHRjb25zdCBwcm92aWRlckNvbG9yID0gdGhpcy5nZXRQcm92aWRlckNvbG9yKHByb3ZpZGVyVHlwZSk7XG5cblx0XHRcdFx0Ly8gU2tpcCBwcm92aWRlcnMgd2l0aCBubyBtb2RlbHNcblx0XHRcdFx0aWYgKG1vZGVscy5sZW5ndGggPT09IDAgJiYgcHJvdmlkZXJUeXBlICE9PSAnb2xsYW1hJykgY29udGludWU7XG5cblx0XHRcdFx0Ly8gQWRkIHByb3ZpZGVyIHNlY3Rpb24gaGVhZGVyXG5cdFx0XHRcdGlmIChoYXNBbnlQcm92aWRlcnMpIHtcblx0XHRcdFx0XHQvLyBBZGQgc2VwYXJhdG9yIGJldHdlZW4gcHJvdmlkZXIgc2VjdGlvbnNcblx0XHRcdFx0XHRjb25zdCBzZXBhcmF0b3IgPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZXBhcmF0b3InIH0pO1xuXHRcdFx0XHRcdHNlcGFyYXRvci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdFx0aGVpZ2h0OiAxcHg7XG5cdFx0XHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRcdFx0XHRtYXJnaW46IDRweCA4cHg7XG5cdFx0XHRcdFx0YDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IHNlY3Rpb25IZWFkZXIgPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1wcm92aWRlci1zZWN0aW9uLWhlYWRlcicgfSk7XG5cdFx0XHRcdHNlY3Rpb25IZWFkZXIuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRwYWRkaW5nOiA4cHggMTJweCA0cHggMTJweDtcblx0XHRcdFx0XHRmb250LXNpemU6IDAuNzVlbTtcblx0XHRcdFx0XHRmb250LXdlaWdodDogNjAwO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHR0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuXHRcdFx0XHRcdGxldHRlci1zcGFjaW5nOiAwLjVweDtcblx0XHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdFx0Z2FwOiA2cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Ly8gUHJvdmlkZXIgY29sb3IgZG90IGluIGhlYWRlclxuXHRcdFx0XHRjb25zdCBoZWFkZXJEb3QgPSBzZWN0aW9uSGVhZGVyLmNyZWF0ZVNwYW4oKTtcblx0XHRcdFx0aGVhZGVyRG90LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0d2lkdGg6IDZweDtcblx0XHRcdFx0XHRoZWlnaHQ6IDZweDtcblx0XHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdFx0YmFja2dyb3VuZDogJHtwcm92aWRlckNvbG9yfTtcblx0XHRcdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRzZWN0aW9uSGVhZGVyLmNyZWF0ZVNwYW4oeyB0ZXh0OiBwcm92aWRlckRpc3BsYXlOYW1lIH0pO1xuXHRcdFx0XHRoYXNBbnlQcm92aWRlcnMgPSB0cnVlO1xuXG5cdFx0XHRcdGlmIChtb2RlbHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0Ly8gUHJvdmlkZXIgd2l0aG91dCBzcGVjaWZpYyBtb2RlbHMgKGxpa2UgT2xsYW1hKVxuXHRcdFx0XHRcdHRoaXMuY3JlYXRlTW9kZWxEcm9wZG93bkl0ZW0oXG5cdFx0XHRcdFx0XHRkcm9wZG93bk1lbnUsXG5cdFx0XHRcdFx0XHRwcm92aWRlclR5cGUsXG5cdFx0XHRcdFx0XHRwcm92aWRlcnNbcHJvdmlkZXJUeXBlXT8ubW9kZWwgfHwgcHJvdmlkZXJEaXNwbGF5TmFtZSxcblx0XHRcdFx0XHRcdHByb3ZpZGVyRGlzcGxheU5hbWUsXG5cdFx0XHRcdFx0XHRwcm92aWRlckNvbG9yLFxuXHRcdFx0XHRcdFx0Y3VycmVudFByb3ZpZGVyVHlwZSA9PT0gcHJvdmlkZXJUeXBlLFxuXHRcdFx0XHRcdFx0Y3VycmVudE1vZGVsXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBQcm92aWRlciB3aXRoIHNwZWNpZmljIG1vZGVsc1xuXHRcdFx0XHRcdGZvciAoY29uc3QgbW9kZWwgb2YgbW9kZWxzKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBpc0N1cnJlbnRTZWxlY3Rpb24gPSBjdXJyZW50UHJvdmlkZXJUeXBlID09PSBwcm92aWRlclR5cGUgJiYgbW9kZWwudmFsdWUgPT09IGN1cnJlbnRNb2RlbDtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0dGhpcy5jcmVhdGVNb2RlbERyb3Bkb3duSXRlbShcblx0XHRcdFx0XHRcdFx0ZHJvcGRvd25NZW51LFxuXHRcdFx0XHRcdFx0XHRwcm92aWRlclR5cGUsXG5cdFx0XHRcdFx0XHRcdG1vZGVsLnZhbHVlLFxuXHRcdFx0XHRcdFx0XHRtb2RlbC5sYWJlbCxcblx0XHRcdFx0XHRcdFx0cHJvdmlkZXJDb2xvcixcblx0XHRcdFx0XHRcdFx0aXNDdXJyZW50U2VsZWN0aW9uLFxuXHRcdFx0XHRcdFx0XHRjdXJyZW50TW9kZWxcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIElmIG5vIHByb3ZpZGVycyBhdmFpbGFibGUsIHNob3cgbWVzc2FnZVxuXHRcdFx0aWYgKCFoYXNBbnlQcm92aWRlcnMpIHtcblx0XHRcdFx0Y29uc3Qgbm9Qcm92aWRlcnNJdGVtID0gZHJvcGRvd25NZW51LmNyZWF0ZURpdigpO1xuXHRcdFx0XHRub1Byb3ZpZGVyc0l0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRwYWRkaW5nOiAxMnB4O1xuXHRcdFx0XHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0XHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRcdFx0Zm9udC1zaXplOiAwLjhlbTtcblx0XHRcdFx0YDtcblx0XHRcdFx0bm9Qcm92aWRlcnNJdGVtLnNldFRleHQoJ05vbmUgY29uZmlndXJlZCcpO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBvcHVsYXRpbmcgcHJvdmlkZXIgZHJvcGRvd246JywgZXJyb3IpO1xuXHRcdFx0ZHJvcGRvd25NZW51LmVtcHR5KCk7XG5cdFx0XHRjb25zdCBlcnJvckl0ZW0gPSBkcm9wZG93bk1lbnUuY3JlYXRlRGl2KCk7XG5cdFx0XHRlcnJvckl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0cGFkZGluZzogMTJweDtcblx0XHRcdFx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRcdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1lcnJvcik7XG5cdFx0XHRcdGZvbnQtc2l6ZTogMC44ZW07XG5cdFx0XHRgO1xuXHRcdFx0ZXJyb3JJdGVtLnNldFRleHQoJ0Vycm9yIGxvYWRpbmcgcHJvdmlkZXJzJyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhIHNpbmdsZSBtb2RlbCBkcm9wZG93biBpdGVtIChqdXN0IG1vZGVsIG5hbWUsIG5vIHByb3ZpZGVyIHByZWZpeClcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlTW9kZWxEcm9wZG93bkl0ZW0oXG5cdFx0Y29udGFpbmVyOiBIVE1MRWxlbWVudCxcblx0XHRwcm92aWRlclR5cGU6IHN0cmluZyxcblx0XHRtb2RlbFZhbHVlOiBzdHJpbmcsXG5cdFx0bW9kZWxEaXNwbGF5TmFtZTogc3RyaW5nLFxuXHRcdHByb3ZpZGVyQ29sb3I6IHN0cmluZyxcblx0XHRpc0N1cnJlbnQ6IGJvb2xlYW4sXG5cdFx0Y3VycmVudE1vZGVsOiBzdHJpbmdcblx0KTogdm9pZCB7XG5cdFx0Y29uc3QgaXRlbSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLW1vZGVsLWRyb3Bkb3duLWl0ZW0nIH0pO1xuXHRcdGl0ZW0uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdHBhZGRpbmc6IDhweCAxMnB4IDhweCAyMHB4O1xuXHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRnYXA6IDhweDtcblx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogM3B4O1xuXHRcdFx0bWFyZ2luOiAxcHggNnB4O1xuXHRcdFx0JHtpc0N1cnJlbnQgPyAnYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7JyA6ICcnfVxuXHRcdGA7XG5cblx0XHQvLyBQcm92aWRlciBjb2xvciBpbmRpY2F0b3IgKHNtYWxsZXIgZG90KVxuXHRcdGNvbnN0IGRvdCA9IGl0ZW0uY3JlYXRlU3BhbigpO1xuXHRcdGRvdC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0d2lkdGg6IDZweDtcblx0XHRcdGhlaWdodDogNnB4O1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0YmFja2dyb3VuZDogJHtwcm92aWRlckNvbG9yfTtcblx0XHRcdGZsZXgtc2hyaW5rOiAwO1xuXHRcdFx0b3BhY2l0eTogMC43O1xuXHRcdGA7XG5cblx0XHQvLyBNb2RlbCBuYW1lIG9ubHkgKG5vIHByb3ZpZGVyIHByZWZpeClcblx0XHRjb25zdCB0ZXh0U3BhbiA9IGl0ZW0uY3JlYXRlU3Bhbih7IHRleHQ6IG1vZGVsRGlzcGxheU5hbWUgfSk7XG5cdFx0dGV4dFNwYW4uc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZsZXg6IDE7XG5cdFx0XHR3aGl0ZS1zcGFjZTogbm93cmFwO1xuXHRcdFx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0XHRcdHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXHRcdGA7XG5cblx0XHQvLyBDdXJyZW50IHNlbGVjdGlvbiBpbmRpY2F0b3Jcblx0XHRpZiAoaXNDdXJyZW50KSB7XG5cdFx0XHRjb25zdCBjaGVja21hcmsgPSBpdGVtLmNyZWF0ZVNwYW4oeyB0ZXh0OiAnXHUyNzEzJyB9KTtcblx0XHRcdGNoZWNrbWFyay5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRjb2xvcjogJHtwcm92aWRlckNvbG9yfTtcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRcdFx0Zm9udC1zaXplOiAwLjllbTtcblx0XHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRgO1xuXHRcdH1cblxuXHRcdC8vIENsaWNrIGhhbmRsZXIgZm9yIHNpbmdsZS1jbGljayBzZWxlY3Rpb25cblx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcblx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Ly8gU3dpdGNoIG1vZGVsIGltbWVkaWF0ZWx5IChubyBhd2FpdCBuZWVkZWQpXG5cdFx0XHRcdFx0dGhpcy5zd2l0Y2hUb01vZGVsKHByb3ZpZGVyVHlwZSwgbW9kZWxWYWx1ZSB8fCB0aGlzLmdldEN1cnJlbnRNb2RlbChwcm92aWRlclR5cGUpKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBDbG9zZSBkcm9wZG93biBpbW1lZGlhdGVseVxuXHRcdFx0XHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy5jbG9zZURyb3Bkb3duKSB7XG5cdFx0XHRcdFx0XHQodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duLmNsb3NlRHJvcGRvd24oKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gVXBkYXRlIGRpc3BsYXkgaW1tZWRpYXRlbHlcblx0XHRcdFx0XHRpZiAoKHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bikge1xuXHRcdFx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3Igc3dpdGNoaW5nIHByb3ZpZGVyL21vZGVsOicsIGVycm9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSG92ZXIgZWZmZWN0c1xuXHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcblx0XHRcdGlmICghaXNDdXJyZW50KSB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3ZlciknO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0aWYgKCFpc0N1cnJlbnQpIHtcblx0XHRcdFx0aXRlbS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBjbGVhbiBpY29uIChyZXBsYWNlcyBlbW9qaSlcblx0ICovXG5cdHByaXZhdGUgY3JlYXRlSWNvbk1lc3NhZ2UoaWNvbk5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBpY29uU3ZnID0gdGhpcy5nZXRPYnNpZGlhbkljb24oaWNvbk5hbWUsICcxNHB4Jyk7XG5cdFx0Ly8gUmV0dXJuIGFzIEhUTUwgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGJ5IHRoZSBtZXNzYWdlIGRpc3BsYXlcblx0XHRyZXR1cm4gYDxzcGFuIHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4O1wiPiR7aWNvblN2Z308c3Bhbj4ke21lc3NhZ2V9PC9zcGFuPjwvc3Bhbj5gO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhbiBpbmxpbmUgaWNvbiBmb3IgdXNlIGluIGlubmVySFRNTFxuXHQgKi9cblx0cHJpdmF0ZSBjcmVhdGVJbmxpbmVJY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lLCBzaXplKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgT2JzaWRpYW4tc3R5bGUgaWNvbiBTVkdcblx0ICovXG5cdHByaXZhdGUgZ2V0T2JzaWRpYW5JY29uKGljb25OYW1lOiBzdHJpbmcsIHNpemU6IHN0cmluZyA9ICcxNHB4Jyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaWNvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG5cdFx0XHQnemFwJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMyAyTDMgMTRIMTJMMTEgMjJMMjEgMTBIMTJMMTMgMlpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdyZWZyZXNoLWN3JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0zIDEyQTkgOSAwIDAgMCAyMSAxMkE5IDkgMCAwIDAgMyAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMjEgMTJMMTcgMTZcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdlZGl0JzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0xMSA0SDRBMiAyIDAgMCAwIDIgNlYyMEEyIDIgMCAwIDAgNCAyMkgxOEEyIDIgMCAwIDAgMjAgMjBWMTNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjUgMi41QTIuMTIgMi4xMiAwIDAgMSAyMSA1TDEyIDE0TDggMTVMOSAxMUwxOC41IDIuNVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdoZWxwLWNpcmNsZSc6IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAke3NpemV9OyBoZWlnaHQ6ICR7c2l6ZX07XCI+XG5cdFx0XHRcdDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkuMDkgOUEzIDMgMCAwIDEgMTIgNkEzIDMgMCAwIDEgMTUgOUMxNSAxMC41IDEyIDExIDEyIDExXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxN1wiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnYm9vay1vcGVuJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PHBhdGggZD1cIk0yIDNIOEE0IDQgMCAwIDEgMTIgN0E0IDQgMCAwIDEgMTYgM0gyMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNMiAzVjE5QTIgMiAwIDAgMCA0IDIxSDlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTIyIDNWMTlBMiAyIDAgMCAxIDIwIDIxSDE1XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xMiA3VjIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnbW9yZS1ob3Jpem9udGFsJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjE5XCIgY3k9XCIxMlwiIHI9XCIxXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiLz5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjVcIiBjeT1cIjEyXCIgcj1cIjFcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0PC9zdmc+YCxcblx0XHRcdCdmaWxlLXRleHQnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE0IDJINkEyIDIgMCAwIDAgNCA0VjIwQTIgMiAwIDAgMCA2IDIySDE4QTIgMiAwIDAgMCAyMCAyMFY4TDE0IDJaXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAyVjhIMjBcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDEzSDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE2IDE3SDhcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDlIOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3gnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTE4IDZMNiAxOFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNNiA2TDE4IDE4XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQnY2hlY2stY2lyY2xlJzogYDxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHN0eWxlPVwid2lkdGg6ICR7c2l6ZX07IGhlaWdodDogJHtzaXplfTtcIj5cblx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdFx0XHRcdDxwYXRoIGQ9XCJNOSAxMkwxMSAxNEwxNiA5XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdDwvc3ZnPmAsXG5cdFx0XHQneC1jaXJjbGUnOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNSA5TDkgMTVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTkgOUwxNSAxNVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gLFxuXHRcdFx0J3RyYXNoLTInOiBgPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgc3R5bGU9XCJ3aWR0aDogJHtzaXplfTsgaGVpZ2h0OiAke3NpemV9O1wiPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTMgNkg1SDIxXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk04IDZWNEEyIDIgMCAwIDEgMTAgMkgxNEEyIDIgMCAwIDEgMTYgNFY2TTE5IDZWMjBBMiAyIDAgMCAxIDE3IDIySDdBMiAyIDAgMCAxIDUgMjBWNkgxOVpcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIvPlxuXHRcdFx0XHQ8cGF0aCBkPVwiTTEwIDExVjE3XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiLz5cblx0XHRcdFx0PHBhdGggZD1cIk0xNCAxMVYxN1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIi8+XG5cdFx0XHQ8L3N2Zz5gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gaWNvbnNbaWNvbk5hbWVdIHx8IGljb25zWydoZWxwLWNpcmNsZSddOyAvLyBGYWxsYmFjayB0byBoZWxwLWNpcmNsZSBpZiBpY29uIG5vdCBmb3VuZFxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBkaXNwbGF5IG5hbWUgZm9yIHByb3ZpZGVyXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICdBbnRocm9waWMnLFxuXHRcdFx0J29wZW5haSc6ICdPcGVuQUknLFxuXHRcdFx0J2dvb2dsZSc6ICdHb29nbGUnLFxuXHRcdFx0J29sbGFtYSc6ICdPbGxhbWEnLFxuXHRcdFx0J25vbmUnOiAnTm9uZSdcblx0XHR9O1xuXHRcdHJldHVybiBuYW1lc1twcm92aWRlclR5cGVdIHx8IHByb3ZpZGVyVHlwZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBoZWFkZXIgKGp1c3QgbW9kZWwgbmFtZSBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSBwcm92aWRlciBuYW1lKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRQcm92aWRlcldpdGhNb2RlbERpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBtb2RlbHMgPSB0aGlzLmdldEF2YWlsYWJsZU1vZGVscyhwcm92aWRlclR5cGUpO1xuXHRcdFxuXHRcdGlmIChtb2RlbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5nZXRDdXJyZW50TW9kZWwocHJvdmlkZXJUeXBlKTtcblx0XHRcdGNvbnN0IG1vZGVsRGlzcGxheU5hbWUgPSB0aGlzLmdldE1vZGVsRGlzcGxheU5hbWUocHJvdmlkZXJUeXBlLCBjdXJyZW50TW9kZWwpO1xuXHRcdFx0XG5cdFx0XHQvLyBEZWJ1ZyBsb2dnaW5nIGZvciBcIklJXCIgaXNzdWVcblx0XHRcdGlmIChtb2RlbERpc3BsYXlOYW1lID09PSBcIklJXCIgfHwgbW9kZWxEaXNwbGF5TmFtZS5tYXRjaCgvXkkrJC8pKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybignSW52YWxpZCBtb2RlbCBkaXNwbGF5IG5hbWUgZGV0ZWN0ZWQ6Jywge1xuXHRcdFx0XHRcdHByb3ZpZGVyVHlwZSxcblx0XHRcdFx0XHRjdXJyZW50TW9kZWwsXG5cdFx0XHRcdFx0bW9kZWxEaXNwbGF5TmFtZSxcblx0XHRcdFx0XHRtb2RlbHNcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiBtb2RlbERpc3BsYXlOYW1lO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdGhpcy5nZXRQcm92aWRlckRpc3BsYXlOYW1lKHByb3ZpZGVyVHlwZSk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbG9yIGZvciBwcm92aWRlciB0eXBlXG5cdCAqL1xuXHRwcml2YXRlIGdldFByb3ZpZGVyQ29sb3IocHJvdmlkZXJUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFVzZSB0aGVtZS1jb21wYXRpYmxlIGNvbG9ycyBpbnN0ZWFkIG9mIGhhcmRjb2RlZCBoZXggdmFsdWVzXG5cdFx0Y29uc3QgY29sb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuXHRcdFx0J2NsYXVkZSc6ICd2YXIoLS1jb2xvci1vcmFuZ2UpJyxcblx0XHRcdCdvcGVuYWknOiAndmFyKC0tY29sb3ItZ3JlZW4pJyxcblx0XHRcdCdnb29nbGUnOiAndmFyKC0tY29sb3ItYmx1ZSknLFxuXHRcdFx0J29sbGFtYSc6ICd2YXIoLS1jb2xvci1wdXJwbGUpJyxcblx0XHRcdCdub25lJzogJ3ZhcigtLXRleHQtbXV0ZWQpJ1xuXHRcdH07XG5cdFx0cmV0dXJuIGNvbG9yc1twcm92aWRlclR5cGVdIHx8ICd2YXIoLS10ZXh0LXN1Y2Nlc3MpJztcblx0fVxuXG5cdC8qKlxuXHQgKiBTd2l0Y2ggdG8gYSBkaWZmZXJlbnQgbW9kZWwgYW5kIHVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuXHQgKi9cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgdGhlIGNvbW1hbmQgYnV0dG9uIHNob3VsZCBiZSBzaG93biBiYXNlZCBvbiBmZWF0dXJlIGF2YWlsYWJpbGl0eSBhbmQgdXNlciBwcmVmZXJlbmNlXG5cdCAqL1xuXHRwcml2YXRlIHNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk6IGJvb2xlYW4ge1xuXHRcdC8vIENvbW1hbmQgYnV0dG9uIGlzIGdhdGVkIGJlaGluZCB0aGUgY29tbWFuZHMgZmVhdHVyZSBcblx0XHRpZiAoIXRoaXMucGx1Z2luLmZlYXR1cmVNYW5hZ2VyLmlzRmVhdHVyZUVuYWJsZWQoJ2NvbW1hbmRzJykpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb21tYW5kQnV0dG9uO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJlZnJlc2ggYWxsIFN1cGVybm92YS1nYXRlZCBVSSBlbGVtZW50cyB3aGVuIGxpY2Vuc2Ugc3RhdHVzIGNoYW5nZXNcblx0ICovXG5cdHJlZnJlc2hTdXBlcm5vdmFVSSgpOiB2b2lkIHtcblx0XHR0aGlzLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0Ly8gRnV0dXJlIFN1cGVybm92YSBmZWF0dXJlcyBjYW4gYWRkIHRoZWlyIHJlZnJlc2ggbG9naWMgaGVyZVxuXHR9XG5cblx0LyoqXG5cdCAqIEhhbmRsZSBwcm92aWRlciBjb25maWd1cmF0aW9uIGV2ZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBoYW5kbGVQcm92aWRlckNvbmZpZ3VyZWQgPSBhc3luYyAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0Ly8gVXBkYXRlIGN1cnJlbnQgcHJvdmlkZXIgZGlzcGxheSB0ZXh0XG5cdFx0aWYgKCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24/LnVwZGF0ZUN1cnJlbnRQcm92aWRlcikge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0KHRoaXMgYXMgYW55KS5jdXJyZW50UHJvdmlkZXJEcm9wZG93bi51cGRhdGVDdXJyZW50UHJvdmlkZXIoKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ1x1Mjc0QyBGYWlsZWQgdG8gdXBkYXRlIHByb3ZpZGVyIGRpc3BsYXkgYWZ0ZXIgY29uZmlndXJhdGlvbjonLCBlcnJvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFVwZGF0ZSBwcml2YWN5IGluZGljYXRvclxuXHRcdGlmICgodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpIHtcblx0XHRcdGF3YWl0IHRoaXMudXBkYXRlUHJpdmFjeUluZGljYXRvcigodGhpcyBhcyBhbnkpLnByaXZhY3lJbmRpY2F0b3IpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBJZiBkcm9wZG93biBpcyBjdXJyZW50bHkgb3BlbiwgcmVmcmVzaCB0aGUgYXZhaWxhYmxlIG1vZGVsc1xuXHRcdGNvbnN0IGRyb3Bkb3duTWVudSA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm5vdmEtcHJvdmlkZXItZHJvcGRvd24tbWVudScpIGFzIEhUTUxFbGVtZW50O1xuXHRcdGlmIChkcm9wZG93bk1lbnUgJiYgZHJvcGRvd25NZW51LnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykge1xuXHRcdFx0dGhpcy5wb3B1bGF0ZVByb3ZpZGVyRHJvcGRvd24oZHJvcGRvd25NZW51KTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIHByb3ZpZGVyIGRpc2Nvbm5lY3Rpb24gZXZlbnRzIC0gYXV0by1zd2l0Y2ggdG8gdmFsaWQgbW9kZWwgaWYgY3VycmVudCBiZWNvbWVzIGludmFsaWRcblx0ICovXG5cdHByaXZhdGUgaGFuZGxlUHJvdmlkZXJEaXNjb25uZWN0ZWQgPSBhc3luYyAoZXZlbnQ6IEV2ZW50KSA9PiB7XG5cdFx0Y29uc3QgY3VzdG9tRXZlbnQgPSBldmVudCBhcyBDdXN0b21FdmVudDtcblx0XHRjb25zdCB7IHByb3ZpZGVyOiBmYWlsZWRQcm92aWRlciB9ID0gY3VzdG9tRXZlbnQuZGV0YWlsO1xuXHRcdFxuXHRcdC8vIENoZWNrIGlmIGN1cnJlbnQgbW9kZWwgYmVsb25ncyB0byB0aGUgZmFpbGVkIHByb3ZpZGVyXG5cdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudE1vZGVsKCk7XG5cdFx0Y29uc3QgY3VycmVudFByb3ZpZGVyVHlwZSA9IGdldFByb3ZpZGVyVHlwZUZvck1vZGVsKGN1cnJlbnRNb2RlbCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50UHJvdmlkZXJUeXBlID09PSBmYWlsZWRQcm92aWRlcikge1xuXHRcdFx0Ly8gQ3VycmVudCBtb2RlbCBpcyBpbnZhbGlkIC0gc3dpdGNoIHRvIGZpcnN0IGF2YWlsYWJsZSBtb2RlbFxuXHRcdFx0Y29uc3QgZmlyc3RBdmFpbGFibGVNb2RlbCA9IGF3YWl0IHRoaXMuZ2V0Rmlyc3RBdmFpbGFibGVNb2RlbCgpO1xuXHRcdFx0aWYgKGZpcnN0QXZhaWxhYmxlTW9kZWwpIHtcblx0XHRcdFx0Ly8gU3dpdGNoIHRvIHRoZSBmYWxsYmFjayBtb2RlbFxuXHRcdFx0XHRjb25zdCBmYWxsYmFja1Byb3ZpZGVyVHlwZSA9IGdldFByb3ZpZGVyVHlwZUZvck1vZGVsKGZpcnN0QXZhaWxhYmxlTW9kZWwsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcblx0XHRcdFx0aWYgKGZhbGxiYWNrUHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRcdFx0dGhpcy5zd2l0Y2hUb01vZGVsKGZhbGxiYWNrUHJvdmlkZXJUeXBlLCBmaXJzdEF2YWlsYWJsZU1vZGVsKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gTm8gYXZhaWxhYmxlIG1vZGVscyAtIGNsZWFyIHRoZSBzZWxlY3Rpb25cblx0XHRcdFx0Y29uc3QgcGxhdGZvcm0gPSBQbGF0Zm9ybS5pc01vYmlsZSA/ICdtb2JpbGUnIDogJ2Rlc2t0b3AnO1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5zZWxlY3RlZE1vZGVsID0gJyc7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBVcGRhdGUgZGlzcGxheSByZWdhcmRsZXNzIChpbiBjYXNlIGRyb3Bkb3duIHdhcyBvcGVuKVxuXHRcdGlmICgodGhpcyBhcyBhbnkpLmN1cnJlbnRQcm92aWRlckRyb3Bkb3duPy51cGRhdGVDdXJyZW50UHJvdmlkZXIpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdCh0aGlzIGFzIGFueSkuY3VycmVudFByb3ZpZGVyRHJvcGRvd24udXBkYXRlQ3VycmVudFByb3ZpZGVyKCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdcdTI3NEMgRmFpbGVkIHRvIHVwZGF0ZSBwcm92aWRlciBkaXNwbGF5IGFmdGVyIGRpc2Nvbm5lY3Rpb246JywgZXJyb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBVcGRhdGUgcHJpdmFjeSBpbmRpY2F0b3Jcblx0XHRpZiAoKHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnVwZGF0ZVByaXZhY3lJbmRpY2F0b3IoKHRoaXMgYXMgYW55KS5wcml2YWN5SW5kaWNhdG9yKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgZHJvcGRvd24gaXMgY3VycmVudGx5IG9wZW4sIHJlZnJlc2ggdGhlIGF2YWlsYWJsZSBtb2RlbHNcblx0XHRjb25zdCBkcm9wZG93bk1lbnUgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5ub3ZhLXByb3ZpZGVyLWRyb3Bkb3duLW1lbnUnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAoZHJvcGRvd25NZW51ICYmIGRyb3Bkb3duTWVudS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpIHtcblx0XHRcdHRoaXMucG9wdWxhdGVQcm92aWRlckRyb3Bkb3duKGRyb3Bkb3duTWVudSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCB0aGUgZmlyc3QgYXZhaWxhYmxlIG1vZGVsIGZyb20gYW55IHdvcmtpbmcgcHJvdmlkZXJcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2V0Rmlyc3RBdmFpbGFibGVNb2RlbCgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHQvLyBHZXQgcHJvdmlkZXIgYXZhaWxhYmlsaXR5IHN0YXR1c1xuXHRcdGNvbnN0IHByb3ZpZGVyQXZhaWxhYmlsaXR5ID0gYXdhaXQgdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0QXZhaWxhYmxlUHJvdmlkZXJzV2l0aFN0YXR1cygpO1xuXHRcdFxuXHRcdC8vIFByb3ZpZGVyIHByaW9yaXR5IG9yZGVyOiBDbGF1ZGUgPiBPcGVuQUkgPiBHb29nbGUgPiBPbGxhbWFcblx0XHRjb25zdCBwcm92aWRlclByaW9yaXR5OiBQcm92aWRlclR5cGVbXSA9IFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ107XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBwcm92aWRlclR5cGUgb2YgcHJvdmlkZXJQcmlvcml0eSkge1xuXHRcdFx0Y29uc3QgaXNBdmFpbGFibGUgPSBwcm92aWRlckF2YWlsYWJpbGl0eS5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRcdC8vIEFsc28gY2hlY2sgaWYgcHJvdmlkZXIgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHRlc3RlZFxuXHRcdFx0Y29uc3QgcHJvdmlkZXJTdGF0dXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlclN0YXR1cz8uW3Byb3ZpZGVyVHlwZV07XG5cdFx0XHRpZiAoaXNBdmFpbGFibGUgJiYgcHJvdmlkZXJTdGF0dXM/LnN0YXR1cyA9PT0gJ2Nvbm5lY3RlZCcpIHtcblx0XHRcdFx0Y29uc3QgbW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXHRcdFx0XHRpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRyZXR1cm4gbW9kZWxzWzBdLnZhbHVlOyAvLyBSZXR1cm4gZmlyc3QgbW9kZWwgZnJvbSB0aGlzIHByb3ZpZGVyXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG51bGw7IC8vIE5vIGF2YWlsYWJsZSBtb2RlbHMgZm91bmRcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIHRoZSBjb21tYW5kIGJ1dHRvbiB2aXNpYmlsaXR5IHdoZW4gc2V0dGluZ3MgY2hhbmdlXG5cdCAqL1xuXHRyZWZyZXNoQ29tbWFuZEJ1dHRvbigpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5pbnB1dEhhbmRsZXIpIHtcblx0XHRcdHRoaXMuaW5wdXRIYW5kbGVyLnJlZnJlc2hDb21tYW5kQnV0dG9uKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZSBpbnB1dCByb3cgbGF5b3V0IHdoZW4gY29tbWFuZCBidXR0b24gdmlzaWJpbGl0eSBjaGFuZ2VzXG5cdCAqL1xuXHRwcml2YXRlIHVwZGF0ZUlucHV0Um93TGF5b3V0KCk6IHZvaWQge1xuXHRcdC8vIE5vIG5lZWQgdG8gbWFudWFsbHkgYWRqdXN0IHRleHRhcmVhIHdpZHRoIC0gZmxleGJveCBoYW5kbGVzIGl0XG5cdFx0Ly8gVGhlIHRleHRhcmVhIGNvbnRhaW5lciBoYXMgZmxleDogMSwgc28gaXQgd2lsbCBleHBhbmQvY29udHJhY3QgYXV0b21hdGljYWxseVxuXHRcdC8vIHdoZW4gdGhlIGNvbW1hbmQgYnV0dG9uIGlzIHNob3duL2hpZGRlblxuXHR9XG5cblx0LyoqXG5cdCAqIEV4ZWN1dGUgYWRkIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlQWRkQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb24gd2l0aCBjb21wbGV0aW9uIGNhbGxiYWNrc1xuXHRcdFx0Y29uc3QgeyB1cGRhdGVTdHJlYW0sIHN0b3BTdHJlYW0gfSA9IHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zdGFydFN0cmVhbWluZyhcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRjdXJzb3JQb3NpdGlvbixcblx0XHRcdFx0dW5kZWZpbmVkLFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0YW5pbWF0aW9uTW9kZTogJ2lubGluZScsXG5cdFx0XHRcdFx0b25Db21wbGV0ZTogKCkgPT4gdGhpcy5vblN0cmVhbWluZ0NvbXBsZXRlKClcblx0XHRcdFx0fVxuXHRcdFx0KTtcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBhZGQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBjYWxsYmFja1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hZGRDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQsIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0dXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmdcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nIG9uIGVycm9yXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaW4gc3RyZWFtaW5nIGFkZCBjb21tYW5kOicsIGVycm9yKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEV4ZWN1dGUgZWRpdCBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZXhlY3V0ZUVkaXRDb21tYW5kV2l0aFN0cmVhbWluZyhjb21tYW5kOiBFZGl0Q29tbWFuZCk6IFByb21pc2U8YW55PiB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCB0aGUgYWN0aXZlIGVkaXRvclxuXHRcdFx0Y29uc3QgZWRpdG9yID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0QWN0aXZlRWRpdG9yKCk7XG5cdFx0XHRpZiAoIWVkaXRvcikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnTm8gYWN0aXZlIGVkaXRvciBmb3VuZCdcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2V0IGN1cnNvciBwb3NpdGlvbiBmb3Igc3RyZWFtaW5nXG5cdFx0XHRjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEN1cnNvclBvc2l0aW9uKCk7XG5cdFx0XHRpZiAoIWN1cnNvclBvc2l0aW9uKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdDb3VsZCBub3QgZGV0ZXJtaW5lIGN1cnNvciBwb3NpdGlvbidcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU3RhcnQgc3RyZWFtaW5nIGF0IGN1cnNvciBwb3NpdGlvbiB3aXRoIGNvbXBsZXRpb24gY2FsbGJhY2tzXG5cdFx0XHRjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGN1cnNvclBvc2l0aW9uLFxuXHRcdFx0XHR1bmRlZmluZWQsXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRhbmltYXRpb25Nb2RlOiAnaW5saW5lJyxcblx0XHRcdFx0XHRvbkNvbXBsZXRlOiAoKSA9PiB0aGlzLm9uU3RyZWFtaW5nQ29tcGxldGUoKVxuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBFeGVjdXRlIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBjYWxsYmFja1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5lZGl0Q29tbWFuZEhhbmRsZXIuZXhlY3V0ZShjb21tYW5kLCAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZyBvbiBlcnJvclxuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBlZGl0IGNvbW1hbmQ6JywgZXJyb3IpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRXhlY3V0ZSByZXdyaXRlIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBleGVjdXRlUmV3cml0ZUNvbW1hbmRXaXRoU3RyZWFtaW5nKGNvbW1hbmQ6IEVkaXRDb21tYW5kKTogUHJvbWlzZTxhbnk+IHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gR2V0IHRoZSBhY3RpdmUgZWRpdG9yXG5cdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRBY3RpdmVFZGl0b3IoKTtcblx0XHRcdGlmICghZWRpdG9yKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0c3VjY2VzczogZmFsc2UsXG5cdFx0XHRcdFx0ZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIGZvdW5kJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHZXQgY3Vyc29yIHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcblx0XHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5wbHVnaW4uZG9jdW1lbnRFbmdpbmUuZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblx0XHRcdGlmICghY3Vyc29yUG9zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgY3Vyc29yIHBvc2l0aW9uJ1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGFydCBzdHJlYW1pbmcgYXQgY3Vyc29yIHBvc2l0aW9uIHdpdGggY29tcGxldGlvbiBjYWxsYmFja3Ncblx0XHRcdGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0cmVhbWluZ01hbmFnZXIuc3RhcnRTdHJlYW1pbmcoXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0Y3Vyc29yUG9zaXRpb24sXG5cdFx0XHRcdHVuZGVmaW5lZCxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGFuaW1hdGlvbk1vZGU6ICdpbmxpbmUnLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6ICgpID0+IHRoaXMub25TdHJlYW1pbmdDb21wbGV0ZSgpXG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdC8vIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kIHdpdGggc3RyZWFtaW5nIGNhbGxiYWNrXG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLnJld3JpdGVDb21tYW5kSGFuZGxlci5leGVjdXRlKGNvbW1hbmQsIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0dXBkYXRlU3RyZWFtKGNodW5rLCBpc0NvbXBsZXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmdcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFN0b3Agc3RyZWFtaW5nIG9uIGVycm9yXG5cdFx0XHRcdHN0b3BTdHJlYW0oKTtcblx0XHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0XHR9XG5cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgaW4gc3RyZWFtaW5nIHJld3JpdGUgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0ZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlIGdyYW1tYXIgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVHcmFtbWFyQ29tbWFuZFdpdGhTdHJlYW1pbmcoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPGFueT4ge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBHZXQgdGhlIGFjdGl2ZSBlZGl0b3Jcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMucGx1Z2luLmRvY3VtZW50RW5naW5lLmdldEFjdGl2ZUVkaXRvcigpO1xuXHRcdFx0aWYgKCFlZGl0b3IpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRzdWNjZXNzOiBmYWxzZSxcblx0XHRcdFx0XHRlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3IgZm91bmQnXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBjdXJzb3IgcG9zaXRpb24gZm9yIHN0cmVhbWluZ1xuXHRcdFx0Y29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLnBsdWdpbi5kb2N1bWVudEVuZ2luZS5nZXRDdXJzb3JQb3NpdGlvbigpO1xuXHRcdFx0aWYgKCFjdXJzb3JQb3NpdGlvbikge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRcdGVycm9yOiAnQ291bGQgbm90IGRldGVybWluZSBjdXJzb3IgcG9zaXRpb24nXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdC8vIFN0YXJ0IHN0cmVhbWluZyBhdCBjdXJzb3IgcG9zaXRpb24gd2l0aCBjb21wbGV0aW9uIGNhbGxiYWNrc1xuXHRcdFx0Y29uc3QgeyB1cGRhdGVTdHJlYW0sIHN0b3BTdHJlYW0gfSA9IHRoaXMuc3RyZWFtaW5nTWFuYWdlci5zdGFydFN0cmVhbWluZyhcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRjdXJzb3JQb3NpdGlvbixcblx0XHRcdFx0dW5kZWZpbmVkLFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0YW5pbWF0aW9uTW9kZTogJ2lubGluZScsXG5cdFx0XHRcdFx0b25Db21wbGV0ZTogKCkgPT4gdGhpcy5vblN0cmVhbWluZ0NvbXBsZXRlKClcblx0XHRcdFx0fVxuXHRcdFx0KTtcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Ly8gRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgY2FsbGJhY2tcblx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uZ3JhbW1hckNvbW1hbmRIYW5kbGVyLmV4ZWN1dGUoY29tbWFuZCwgKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0XHR1cGRhdGVTdHJlYW0oY2h1bmssIGlzQ29tcGxldGUpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBTdG9wIHN0cmVhbWluZ1xuXHRcdFx0XHRzdG9wU3RyZWFtKCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Ly8gU3RvcCBzdHJlYW1pbmcgb24gZXJyb3Jcblx0XHRcdFx0c3RvcFN0cmVhbSgpO1xuXHRcdFx0XHR0aHJvdyBlcnJvcjtcblx0XHRcdH1cblxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzdHJlYW1pbmcgZ3JhbW1hciBjb21tYW5kOicsIGVycm9yKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0XHRlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEFkZCBmaWxlcyB0byBwZXJzaXN0ZW50IGNvbnRleHRcblx0ICovXG5cdGFzeW5jIGFkZEZpbGVzVG9Db250ZXh0KGZpbGVuYW1lczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoJ05vIGZpbGUgaXMgb3Blbi4gUGxlYXNlIG9wZW4gYSBmaWxlIHRvIGFkZCBjb250ZXh0LicsIDMwMDApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IGFkZGVkRmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0Y29uc3QgYWxyZWFkeUV4aXN0aW5nRmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0Y29uc3QgY3VycmVudEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IG5vdEZvdW5kRmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XG5cdFx0Ly8gR2V0IGV4aXN0aW5nIHBlcnNpc3RlbnQgY29udGV4dCBkaXJlY3RseSAod2l0aG91dCBjbGVhcmluZyBpdClcblx0XHRjb25zdCBleGlzdGluZ1BlcnNpc3RlbnQgPSB0aGlzLmNvbnRleHRNYW5hZ2VyLmdldFBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCkgfHwgW107XG5cdFx0Y29uc3QgdXBkYXRlZFBlcnNpc3RlbnQgPSBbLi4uZXhpc3RpbmdQZXJzaXN0ZW50XTtcblx0XHRcblx0XHRcblx0XHRmb3IgKGNvbnN0IGZpbGVuYW1lIG9mIGZpbGVuYW1lcykge1xuXHRcdFx0Ly8gRmluZCB0aGUgZmlsZSBieSBuYW1lXG5cdFx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlbmFtZSk7XG5cdFx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZW5hbWUgKyAnLm1kJyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXHRcdFx0XHRmaWxlID0gZmlsZXMuZmluZChcblx0XHRcdFx0XHQoZikgPT4gZi5iYXNlbmFtZSA9PT0gZmlsZW5hbWUgfHwgZi5uYW1lID09PSBmaWxlbmFtZSB8fCBmLnBhdGguZW5kc1dpdGgoJy8nICsgZmlsZW5hbWUpIHx8IGYucGF0aC5lbmRzV2l0aCgnLycgKyBmaWxlbmFtZSArICcubWQnKVxuXHRcdFx0XHQpIHx8IG51bGw7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyB0aGUgY3VycmVudCBhY3RpdmUgZmlsZVxuXHRcdFx0XHRpZiAoZmlsZS5wYXRoID09PSB0aGlzLmN1cnJlbnRGaWxlPy5wYXRoKSB7XG5cdFx0XHRcdFx0Ly8gQ3VycmVudCBmaWxlIGlzIGFscmVhZHkgaW1wbGljaXRseSBpbiBjb250ZXh0XG5cdFx0XHRcdFx0Y3VycmVudEZpbGVzLnB1c2goZmlsZS5iYXNlbmFtZSk7XG5cdFx0XHRcdFx0Ly8gQWRkIHdhcm5pbmcgbWVzc2FnZSB0byBjaGF0IChub3Qgc2F2ZWQgdG8gY29udmVyc2F0aW9uIGhpc3RvcnkpXG5cdFx0XHRcdFx0dGhpcy5jaGF0UmVuZGVyZXIuYWRkV2FybmluZ01lc3NhZ2UoXCJDdXJyZW50IGZpbGUgaXMgYWx3YXlzIGluIGNvbnRleHQgYW5kIGRvZXNuJ3QgbmVlZCB0byBiZSBhZGRlZCBleHBsaWNpdGx5LlwiLCBmYWxzZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgYWxyZWFkeSBpbiBwZXJzaXN0ZW50IGNvbnRleHQgKGNoZWNrIGJvdGggZXhpc3RpbmcgYW5kIG5ld2x5IGFkZGVkIGluIHRoaXMgYmF0Y2gpXG5cdFx0XHRcdFx0Y29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShyZWYgPT4gcmVmLmZpbGUucGF0aCA9PT0gKGZpbGUgYXMgVEZpbGUpLnBhdGgpO1xuXHRcdFx0XHRcdGlmICghZXhpc3RzKSB7XG5cdFx0XHRcdFx0XHQvLyBBZGQgdG8gcGVyc2lzdGVudCBjb250ZXh0XG5cdFx0XHRcdFx0XHR1cGRhdGVkUGVyc2lzdGVudC5wdXNoKHtcblx0XHRcdFx0XHRcdFx0ZmlsZTogZmlsZSxcblx0XHRcdFx0XHRcdFx0cHJvcGVydHk6IHVuZGVmaW5lZCxcblx0XHRcdFx0XHRcdFx0aXNQZXJzaXN0ZW50OiB0cnVlLFxuXHRcdFx0XHRcdFx0XHRyYXdSZWZlcmVuY2U6IGArW1ske2ZpbGUuYmFzZW5hbWV9XV1gXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdGFkZGVkRmlsZXMucHVzaChmaWxlLmJhc2VuYW1lKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gRmlsZSBhbHJlYWR5IGV4aXN0cyBpbiBjb250ZXh0XG5cdFx0XHRcdFx0XHRhbHJlYWR5RXhpc3RpbmdGaWxlcy5wdXNoKGZpbGUuYmFzZW5hbWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsZSBub3QgZm91bmRcblx0XHRcdFx0bm90Rm91bmRGaWxlcy5wdXNoKGZpbGVuYW1lKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCBpZiB3ZSBtYWRlIGFueSBjaGFuZ2VzXG5cdFx0aWYgKGFkZGVkRmlsZXMubGVuZ3RoID4gMCB8fCBhbHJlYWR5RXhpc3RpbmdGaWxlcy5sZW5ndGggPiAwIHx8IGN1cnJlbnRGaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHQvLyBVc2UgQ29udGV4dE1hbmFnZXIgdG8gdXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0dGhpcy5jb250ZXh0TWFuYWdlci5jbGVhclBlcnNpc3RlbnRDb250ZXh0KHRoaXMuY3VycmVudEZpbGUucGF0aCk7XG5cdFx0XHRmb3IgKGNvbnN0IGRvYyBvZiB1cGRhdGVkUGVyc2lzdGVudCkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmNvbnRleHRNYW5hZ2VyLmFkZERvY3VtZW50KGRvYy5maWxlKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IFVJXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dCgpO1xuXHRcdFxuXHRcdC8vIFNob3cgYSBzaW5nbGUgY29tcHJlaGVuc2l2ZSBub3RpZmljYXRpb24gZm9yIGJldHRlciBVWFxuXHRcdGNvbnN0IHRvdGFsRmlsZXMgPSBmaWxlbmFtZXMubGVuZ3RoO1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdGlmIChhZGRlZEZpbGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChhZGRlZEZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBBZGRlZCBcIiR7YWRkZWRGaWxlc1swXX1cIiB0byBjb250ZXh0YCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBBZGRlZCAke2FkZGVkRmlsZXMubGVuZ3RofSBmaWxlcyB0byBjb250ZXh0YCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChhbHJlYWR5RXhpc3RpbmdGaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAoYWxyZWFkeUV4aXN0aW5nRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYFwiJHthbHJlYWR5RXhpc3RpbmdGaWxlc1swXX1cIiBhbHJlYWR5IGluIGNvbnRleHRgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYCR7YWxyZWFkeUV4aXN0aW5nRmlsZXMubGVuZ3RofSBhbHJlYWR5IGluIGNvbnRleHRgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRGaWxlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAoY3VycmVudEZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRtZXNzYWdlcy5wdXNoKGBDdXJyZW50IGZpbGUgaXMgYWx3YXlzIGluIGNvbnRleHRgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYCR7Y3VycmVudEZpbGVzLmxlbmd0aH0gY3VycmVudCBmaWxlcyBhcmUgYWx3YXlzIGluIGNvbnRleHRgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYgKG5vdEZvdW5kRmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKG5vdEZvdW5kRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdG1lc3NhZ2VzLnB1c2goYFwiJHtub3RGb3VuZEZpbGVzWzBdfVwiIG5vdCBmb3VuZGApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWVzc2FnZXMucHVzaChgJHtub3RGb3VuZEZpbGVzLmxlbmd0aH0gbm90IGZvdW5kYCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNob3cgc2luZ2xlIGNvbWJpbmVkIG1lc3NhZ2UgaWYgd2UgaGF2ZSBhbnkgcmVzdWx0c1xuXHRcdGlmIChtZXNzYWdlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCBjb21iaW5lZE1lc3NhZ2UgPSBtZXNzYWdlcy5qb2luKCcsICcpO1xuXHRcdFx0Y29uc3QgZHVyYXRpb24gPSBub3RGb3VuZEZpbGVzLmxlbmd0aCA+IDAgPyAzMDAwIDogMjAwMDsgLy8gTG9uZ2VyIGR1cmF0aW9uIGlmIHRoZXJlIGFyZSBlcnJvcnNcblx0XHRcdG5ldyBOb3RpY2UoY29tYmluZWRNZXNzYWdlLCBkdXJhdGlvbik7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjb250ZXh0dWFsIHRoaW5raW5nIHBocmFzZSBiYXNlZCBvbiBjb21tYW5kIHR5cGUgb3IgbWVzc2FnZSBjb250ZW50XG5cdCAqL1xuXHRwcml2YXRlIGdldENvbnRleHR1YWxUaGlua2luZ1BocmFzZShjb21tYW5kPzogRWRpdENvbW1hbmQsIG1lc3NhZ2VUZXh0Pzogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBEZXRlcm1pbmUgY29udGV4dCBiYXNlZCBvbiBjb21tYW5kIHR5cGUgb3IgbWVzc2FnZSBjb250ZW50XG5cdFx0aWYgKGNvbW1hbmQpIHtcblx0XHRcdHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcblx0XHRcdFx0Y2FzZSAnZ3JhbW1hcic6XG5cdFx0XHRcdGNhc2UgJ2VkaXQnOlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnaW1wcm92ZScpO1xuXHRcdFx0XHRjYXNlICdhZGQnOlxuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnZ2VuZXJhdGUnKTtcblx0XHRcdFx0Y2FzZSAncmV3cml0ZSc6XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0UmFuZG9tUGhyYXNlKCdpbXByb3ZlJyk7XG5cdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0UmFuZG9tUGhyYXNlKCdwcm9jZXNzJyk7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0UmFuZG9tUGhyYXNlKCdjaGF0Jyk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChtZXNzYWdlVGV4dCkge1xuXHRcdFx0Ly8gQW5hbHl6ZSBtZXNzYWdlIGNvbnRlbnQgZm9yIGNvbnRleHRcblx0XHRcdGlmIChtZXNzYWdlVGV4dC5pbmNsdWRlcygnaW1wcm92ZScpIHx8IG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCdmaXgnKSB8fCBtZXNzYWdlVGV4dC5pbmNsdWRlcygnZ3JhbW1hcicpKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnaW1wcm92ZScpO1xuXHRcdFx0fSBlbHNlIGlmIChtZXNzYWdlVGV4dC5pbmNsdWRlcygnYWRkJykgfHwgbWVzc2FnZVRleHQuaW5jbHVkZXMoJ2NyZWF0ZScpIHx8IG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCd3cml0ZScpKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldFJhbmRvbVBocmFzZSgnZ2VuZXJhdGUnKTtcblx0XHRcdH0gZWxzZSBpZiAobWVzc2FnZVRleHQuaW5jbHVkZXMoJ3N3aXRjaCcpIHx8IG1lc3NhZ2VUZXh0LmluY2x1ZGVzKCcvJykpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0UmFuZG9tUGhyYXNlKCdzd2l0Y2gnKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXMuZ2V0UmFuZG9tUGhyYXNlKCdjaGF0Jyk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHJhbmRvbSBwaHJhc2UgZnJvbSBzcGVjaWZpZWQgY2F0ZWdvcnlcblx0ICovXG5cdHByaXZhdGUgZ2V0UmFuZG9tUGhyYXNlKGNhdGVnb3J5OiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IHBocmFzZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcblx0XHRcdCdpbXByb3ZlJzogWydyZWZpbmluZy4uLicsICdwb2xpc2hpbmcuLi4nLCAnZW5oYW5jaW5nLi4uJywgJ2NyYWZ0aW5nLi4uJywgJ3BlcmZlY3RpbmcuLi4nLCAnc21vb3RoaW5nLi4uJywgJ3NoYXJwZW5pbmcuLi4nLCAnZWxldmF0aW5nLi4uJywgJ2ZpbmUtdHVuaW5nLi4uJywgJ3NjdWxwdGluZy4uLiddLFxuXHRcdFx0J2dlbmVyYXRlJzogWyd0aGlua2luZy4uLicsICdjcmFmdGluZy4uLicsICdkZXZlbG9waW5nLi4uJywgJ2NvbXBvc2luZy4uLicsICd3cml0aW5nLi4uJywgJ2NyZWF0aW5nLi4uJywgJ2Zvcm11bGF0aW5nLi4uJywgJ2J1aWxkaW5nLi4uJywgJ2NvbnN0cnVjdGluZy4uLicsICdkcmFmdGluZy4uLiddLFxuXHRcdFx0J3N3aXRjaCc6IFsnY29ubmVjdGluZy4uLicsICdzd2l0Y2hpbmcuLi4nLCAndXBkYXRpbmcuLi4nLCAnY29uZmlndXJpbmcuLi4nLCAnc2V0dGluZyB1cC4uLicsICdzeW5jaW5nLi4uJywgJ3ByZXBhcmluZy4uLicsICdhY3RpdmF0aW5nLi4uJywgJ2luaXRpYWxpemluZy4uLicsICdlc3RhYmxpc2hpbmcuLi4nXSxcblx0XHRcdCdwcm9jZXNzJzogWydwcm9jZXNzaW5nLi4uJywgJ2FuYWx5emluZy4uLicsICd3b3JraW5nLi4uJywgJ2NvbXB1dGluZy4uLicsICdjYWxjdWxhdGluZy4uLicsICdleGFtaW5pbmcuLi4nLCAnZXZhbHVhdGluZy4uLicsICdpbnRlcnByZXRpbmcuLi4nLCAncmV2aWV3aW5nLi4uJywgJ3NjYW5uaW5nLi4uJ10sXG5cdFx0XHQnY2hhdCc6IFsndGhpbmtpbmcuLi4nLCAncHJvY2Vzc2luZy4uLicsICdjb25zaWRlcmluZy4uLicsICdhbmFseXppbmcuLi4nLCAndW5kZXJzdGFuZGluZy4uLicsICdjb250ZW1wbGF0aW5nLi4uJywgJ2V4cGxvcmluZy4uLicsICdldmFsdWF0aW5nLi4uJywgJ3dvcmtpbmcgb24gaXQuLi4nLCAnY29tcG9zaW5nLi4uJ11cblx0XHR9O1xuXHRcdFxuXHRcdGNvbnN0IGNhdGVnb3J5UGhyYXNlcyA9IHBocmFzZXNbY2F0ZWdvcnldIHx8IHBocmFzZXMuY2hhdDtcblx0XHRyZXR1cm4gY2F0ZWdvcnlQaHJhc2VzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNhdGVnb3J5UGhyYXNlcy5sZW5ndGgpXTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTdGFydCBwaHJhc2Ugcm90YXRpb24gYW5pbWF0aW9uIGZvciB0aGlua2luZyB0ZXh0XG5cdCAqL1xuXHRwcml2YXRlIHN0YXJ0VGhpbmtpbmdQaHJhc2VSb3RhdGlvbih0ZXh0RWw6IEhUTUxFbGVtZW50LCBjb21tYW5kPzogRWRpdENvbW1hbmQsIG1lc3NhZ2VUZXh0Pzogc3RyaW5nKTogdm9pZCB7XG5cdFx0Ly8gQ2hhbmdlIHBocmFzZSBldmVyeSAyIHNlY29uZHMgZHVyaW5nIHByb2Nlc3Npbmdcblx0XHRjb25zdCByb3RhdGlvbkludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuXHRcdFx0Y29uc3QgbmV3UGhyYXNlID0gdGhpcy5nZXRDb250ZXh0dWFsVGhpbmtpbmdQaHJhc2UoY29tbWFuZCwgbWVzc2FnZVRleHQpO1xuXHRcdFx0dGV4dEVsLnRleHRDb250ZW50ID0gbmV3UGhyYXNlO1xuXHRcdH0sIDIwMDApO1xuXHRcdFxuXHRcdC8vIFN0b3JlIGludGVydmFsIElEIGZvciBjbGVhbnVwXG5cdFx0KHRleHRFbCBhcyBhbnkpLnJvdGF0aW9uSW50ZXJ2YWwgPSByb3RhdGlvbkludGVydmFsO1xuXHR9XG5cblx0LyoqXG5cdCAqIFN0b3AgcGhyYXNlIHJvdGF0aW9uIGFuaW1hdGlvbiBhbmQgY2xlYW51cFxuXHQgKi9cblx0cHJpdmF0ZSBzdG9wVGhpbmtpbmdQaHJhc2VSb3RhdGlvbih0ZXh0RWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0aWYgKCh0ZXh0RWwgYXMgYW55KS5yb3RhdGlvbkludGVydmFsKSB7XG5cdFx0XHRjbGVhckludGVydmFsKCh0ZXh0RWwgYXMgYW55KS5yb3RhdGlvbkludGVydmFsKTtcblx0XHRcdCh0ZXh0RWwgYXMgYW55KS5yb3RhdGlvbkludGVydmFsID0gbnVsbDtcblx0XHR9XG5cdH1cblxufSIsICJleHBvcnQgaW50ZXJmYWNlIERvY3VtZW50U3RydWN0dXJlIHtcblx0aGVhZGluZ3M6IEFycmF5PHsgbGV2ZWw6IG51bWJlcjsgdGV4dDogc3RyaW5nOyBpc0VtcHR5OiBib29sZWFuIH0+O1xuXHR3b3JkQ291bnQ6IG51bWJlcjtcblx0ZW1wdHlIZWFkaW5nczogc3RyaW5nW107XG5cdGluY29tcGxldGVCdWxsZXRzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGNsYXNzIERvY3VtZW50QW5hbHl6ZXIge1xuXHRzdGF0aWMgYW5hbHl6ZVN0cnVjdHVyZShjb250ZW50OiBzdHJpbmcpOiBEb2N1bWVudFN0cnVjdHVyZSB7XG5cdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRjb25zdCBoZWFkaW5nczogQXJyYXk8eyBsZXZlbDogbnVtYmVyOyB0ZXh0OiBzdHJpbmc7IGlzRW1wdHk6IGJvb2xlYW4gfT4gPSBbXTtcblx0XHRjb25zdCBlbXB0eUhlYWRpbmdzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdGNvbnN0IGluY29tcGxldGVCdWxsZXRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIEZpbmQgaGVhZGluZ3MgYW5kIGFuYWx5emUgY29udGVudCBhZnRlciBlYWNoXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcblx0XHRcdGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oI3sxLDZ9KVxccysoLispJC8pO1xuXHRcdFx0XG5cdFx0XHRpZiAoaGVhZGluZ01hdGNoKSB7XG5cdFx0XHRcdGNvbnN0IGxldmVsID0gaGVhZGluZ01hdGNoWzFdLmxlbmd0aDtcblx0XHRcdFx0Y29uc3QgdGV4dCA9IGhlYWRpbmdNYXRjaFsyXTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIGhlYWRpbmcgaGFzIGNvbnRlbnQgYWZ0ZXIgaXRcblx0XHRcdFx0Y29uc3QgaGFzQ29udGVudCA9IHRoaXMuaGFzQ29udGVudEFmdGVySGVhZGluZyhsaW5lcywgaSk7XG5cdFx0XHRcdGNvbnN0IGlzRW1wdHkgPSAhaGFzQ29udGVudDtcblx0XHRcdFx0XG5cdFx0XHRcdGhlYWRpbmdzLnB1c2goeyBsZXZlbCwgdGV4dCwgaXNFbXB0eSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChpc0VtcHR5KSB7XG5cdFx0XHRcdFx0ZW1wdHlIZWFkaW5ncy5wdXNoKHRleHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEZpbmQgaW5jb21wbGV0ZSBidWxsZXQgcG9pbnRzIChlbmRpbmcgd2l0aCBcIi4uLlwiIG9yIGVtcHR5KVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15bLSorXVxccyooLiopXFwuXFwuXFwuP1xccyokLykgfHwgbGluZS5tYXRjaCgvXlstKitdXFxzKiQvKSB8fCBsaW5lLm1hdGNoKC9eWy0qK11cXHMqKFRPRE98VEJEKS9pKSkge1xuXHRcdFx0XHRpbmNvbXBsZXRlQnVsbGV0cy5wdXNoKGxpbmUpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRjb25zdCB3b3JkQ291bnQgPSBjb250ZW50LnNwbGl0KC9cXHMrLykuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAwKS5sZW5ndGg7XG5cdFx0XG5cdFx0cmV0dXJuIHtcblx0XHRcdGhlYWRpbmdzLFxuXHRcdFx0d29yZENvdW50LFxuXHRcdFx0ZW1wdHlIZWFkaW5ncyxcblx0XHRcdGluY29tcGxldGVCdWxsZXRzXG5cdFx0fTtcblx0fVxuXHRcblx0cHJpdmF0ZSBzdGF0aWMgaGFzQ29udGVudEFmdGVySGVhZGluZyhsaW5lczogc3RyaW5nW10sIGhlYWRpbmdJbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG5cdFx0Y29uc3QgY3VycmVudEhlYWRpbmcgPSBsaW5lc1toZWFkaW5nSW5kZXhdLnRyaW0oKTtcblx0XHRjb25zdCBjdXJyZW50TGV2ZWwgPSBjdXJyZW50SGVhZGluZy5tYXRjaCgvXigjezEsNn0pLyk/LlsxXS5sZW5ndGggfHwgMDtcblx0XHRcblx0XHRmb3IgKGxldCBpID0gaGVhZGluZ0luZGV4ICsgMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRjb25zdCBsaW5lID0gbGluZXNbaV0udHJpbSgpO1xuXHRcdFx0XG5cdFx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGEgaGVhZGluZ1xuXHRcdFx0Y29uc3QgaGVhZGluZ01hdGNoID0gbGluZS5tYXRjaCgvXigjezEsNn0pXFxzLyk7XG5cdFx0XHRpZiAoaGVhZGluZ01hdGNoKSB7XG5cdFx0XHRcdGNvbnN0IG5leHRMZXZlbCA9IGhlYWRpbmdNYXRjaFsxXS5sZW5ndGg7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBJZiBuZXh0IGhlYWRpbmcgaXMgc2FtZSBvciBoaWdoZXIgbGV2ZWwgKGxvd2VyIG51bWJlciksIFxuXHRcdFx0XHQvLyBhbmQgd2UgaGF2ZW4ndCBmb3VuZCBjb250ZW50IHlldCwgdGhpcyBzZWN0aW9uIGlzIGVtcHR5XG5cdFx0XHRcdGlmIChuZXh0TGV2ZWwgPD0gY3VycmVudExldmVsKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIElmIGl0J3MgYSBzdWItaGVhZGluZyAoaGlnaGVyIG51bWJlciksIGNvbnRpbnVlIGxvb2tpbmcgZm9yIGNvbnRlbnRcblx0XHRcdFx0Ly8gVGhpcyBhbGxvd3MgZm9yIEgxIFx1MjE5MiBIMiBzdHJ1Y3R1cmUgd2l0aG91dCBjb3VudGluZyBhcyBlbXB0eVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBJZiB3ZSBmaW5kIHN1YnN0YW50aWFsIGNvbnRlbnQgKG5vdCBqdXN0IHdoaXRlc3BhY2UpLCBoZWFkaW5nIGlzIG5vdCBlbXB0eVxuXHRcdFx0aWYgKGxpbmUubGVuZ3RoID4gMCkgcmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIElmIHdlIHJlYWNoIGVuZCBvZiBkb2N1bWVudCB3aXRob3V0IGZpbmRpbmcgY29udGVudCwgaXQncyBlbXB0eVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufSIsICIvKipcbiAqIENlbnRyYWxpemVkIG1vZGVsIGRlZmluaXRpb25zIGZvciBhbGwgQUkgcHJvdmlkZXJzXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBNb2RlbERlZmluaXRpb24ge1xuXHR2YWx1ZTogc3RyaW5nO1xuXHRsYWJlbDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vZGVsQ29uZmlnIHtcblx0Z2V0QXZhaWxhYmxlTW9kZWxzKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBzZXR0aW5ncz86IGFueSk6IE1vZGVsRGVmaW5pdGlvbltdO1xufVxuXG4vKipcbiAqIEdldCB0aGUgcHJvdmlkZXIgdHlwZSBmb3IgYSBnaXZlbiBtb2RlbCBuYW1lIGJ5IHNlYXJjaGluZyBhbGwgcHJvdmlkZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm92aWRlclR5cGVGb3JNb2RlbChtb2RlbE5hbWU6IHN0cmluZywgc2V0dGluZ3M/OiBhbnkpOiBzdHJpbmcgfCBudWxsIHtcblx0Ly8gU2VhcmNoIGFsbCBwcm92aWRlciB0eXBlcyBmb3IgdGhpcyBtb2RlbFxuXHRjb25zdCBwcm92aWRlclR5cGVzID0gWydjbGF1ZGUnLCAnb3BlbmFpJywgJ2dvb2dsZScsICdvbGxhbWEnXTtcblx0XG5cdGZvciAoY29uc3QgcHJvdmlkZXJUeXBlIG9mIHByb3ZpZGVyVHlwZXMpIHtcblx0XHRjb25zdCBtb2RlbHMgPSBnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlLCBzZXR0aW5ncyk7XG5cdFx0Y29uc3QgZm91bmRNb2RlbCA9IG1vZGVscy5maW5kKG0gPT4gbS52YWx1ZSA9PT0gbW9kZWxOYW1lKTtcblx0XHRpZiAoZm91bmRNb2RlbCkge1xuXHRcdFx0cmV0dXJuIHByb3ZpZGVyVHlwZTtcblx0XHR9XG5cdH1cblx0XG5cdC8vIElmIG5vdCBmb3VuZCBpbiBhbnkgcHJvdmlkZXIsIHJldHVybiBudWxsXG5cdHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEdldCBhdmFpbGFibGUgbW9kZWxzIGZvciBhIHByb3ZpZGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdmFpbGFibGVNb2RlbHMocHJvdmlkZXJUeXBlOiBzdHJpbmcsIHNldHRpbmdzPzogYW55KTogTW9kZWxEZWZpbml0aW9uW10ge1xuXHRzd2l0Y2ggKHByb3ZpZGVyVHlwZSkge1xuXHRcdGNhc2UgJ2NsYXVkZSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLW9wdXMtNC0yMDI1MDUxNCcsIGxhYmVsOiAnQ2xhdWRlIE9wdXMgNCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS1zb25uZXQtNC0yMDI1MDUxNCcsIGxhYmVsOiAnQ2xhdWRlIFNvbm5ldCA0JyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnY2xhdWRlLTMtNy1zb25uZXQtbGF0ZXN0JywgbGFiZWw6ICdDbGF1ZGUgMy43IFNvbm5ldCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2NsYXVkZS0zLTUtc29ubmV0LWxhdGVzdCcsIGxhYmVsOiAnQ2xhdWRlIDMuNSBTb25uZXQnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCcsIGxhYmVsOiAnQ2xhdWRlIDMuNSBIYWlrdScgfVxuXHRcdFx0XTtcblx0XHRjYXNlICdvcGVuYWknOlxuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00LjEtMjAyNS0wNC0xNCcsIGxhYmVsOiAnR1BULTQuMScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00LjEtbWluaS0yMDI1LTA0LTE0JywgbGFiZWw6ICdHUFQtNC4xIE1pbmknIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdncHQtNC4xLW5hbm8tMjAyNS0wNC0xNCcsIGxhYmVsOiAnR1BULTQuMSBOYW5vJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnbzQtbWluaS0yMDI1LTA0LTE2JywgbGFiZWw6ICdvNCBNaW5pJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnbzMtbWluaS0yMDI1LTAxLTMxJywgbGFiZWw6ICdvMyBNaW5pJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnbzMtMjAyNS0wNC0xNicsIGxhYmVsOiAnbzMnIH0sXG5cdFx0XHRcdHsgdmFsdWU6ICdvMS0yMDI0LTEyLTE3JywgbGFiZWw6ICdvMScgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dwdC00bycsIGxhYmVsOiAnR1BULTRvJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ3B0LTRvLW1pbmknLCBsYWJlbDogJ0dQVC00byBNaW5pJyB9XG5cdFx0XHRdO1xuXHRcdGNhc2UgJ2dvb2dsZSc6XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuNS1wcm8nLCBsYWJlbDogJ0dlbWluaSAyLjUgUHJvJyB9LFxuXHRcdFx0XHR7IHZhbHVlOiAnZ2VtaW5pLTIuNS1mbGFzaCcsIGxhYmVsOiAnR2VtaW5pIDIuNSBGbGFzaCcgfSxcblx0XHRcdFx0eyB2YWx1ZTogJ2dlbWluaS0yLjUtZmxhc2gtbGl0ZS1wcmV2aWV3LTA2LTE3JywgbGFiZWw6ICdHZW1pbmkgMi41IEZsYXNoLUxpdGUnIH1cblx0XHRcdF07XG5cdFx0Y2FzZSAnb2xsYW1hJzpcblx0XHRcdC8vIFJldHVybiB0aGUgY29uZmlndXJlZCBtb2RlbCBmcm9tIHNldHRpbmdzXG5cdFx0XHRjb25zdCBvbGxhbWFNb2RlbCA9IHNldHRpbmdzPy5haVByb3ZpZGVycz8ub2xsYW1hPy5tb2RlbDtcblx0XHRcdGlmIChvbGxhbWFNb2RlbCAmJiBvbGxhbWFNb2RlbC50cmltKCkpIHtcblx0XHRcdFx0cmV0dXJuIFt7IHZhbHVlOiBvbGxhbWFNb2RlbCwgbGFiZWw6IG9sbGFtYU1vZGVsIH1dO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIFtdO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRyZXR1cm4gW107XG5cdH1cbn0iLCAiaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgUGxhdGZvcm0sIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIH0gZnJvbSAnLi93aWtpbGluay1zdWdnZXN0JztcbmltcG9ydCB7IENvbW1hbmRTeXN0ZW0gfSBmcm9tICcuL2NvbW1hbmQtc3lzdGVtJztcbmltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9jb250ZXh0LW1hbmFnZXInO1xuXG4vKipcbiAqIEhhbmRsZXMgdGV4dGFyZWEgaW5wdXQsIGF1dG8tZ3Jvdywgc2VuZCBidXR0b24sIGFuZCBpbnB1dCBldmVudHNcbiAqL1xuZXhwb3J0IGNsYXNzIElucHV0SGFuZGxlciB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgdGV4dEFyZWEhOiBUZXh0QXJlYUNvbXBvbmVudDtcblx0cHJpdmF0ZSBzZW5kQnV0dG9uITogQnV0dG9uQ29tcG9uZW50O1xuXHRwcml2YXRlIGF1dG9Hcm93VGV4dGFyZWEhOiAoKSA9PiB2b2lkO1xuXHRwcml2YXRlIHdpa2lsaW5rQXV0b2NvbXBsZXRlITogTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlO1xuXHRwcml2YXRlIGNvbW1hbmRTeXN0ZW0hOiBDb21tYW5kU3lzdGVtO1xuXHRwcml2YXRlIGNvbnRleHRNYW5hZ2VyOiBDb250ZXh0TWFuYWdlcjtcblx0cHJpdmF0ZSBpbnB1dFJvdyE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBGT0NVU19ERUxBWV9NUyA9IDE1MDtcblx0cHJpdmF0ZSBkcm9wWm9uZU92ZXJsYXk6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgaXNEcmFnZ2luZzogYm9vbGVhbiA9IGZhbHNlO1xuXHRwcml2YXRlIHNpZGViYXJWaWV3OiBhbnk7IC8vIFJlZmVyZW5jZSB0byBOb3ZhU2lkZWJhclZpZXcgZm9yIGNvbnRleHQgb3BlcmF0aW9uc1xuXG5cdC8vIEV2ZW50IGNsZWFudXAgdHJhY2tpbmdcblx0cHJpdmF0ZSBldmVudExpc3RlbmVyczogQXJyYXk8e2VsZW1lbnQ6IEV2ZW50VGFyZ2V0LCBldmVudDogc3RyaW5nLCBoYW5kbGVyOiBFdmVudExpc3RlbmVyfT4gPSBbXTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwbHVnaW46IE5vdmFQbHVnaW4sIFxuXHRcdGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIFxuXHRcdGNvbnRleHRNYW5hZ2VyOiBDb250ZXh0TWFuYWdlclxuXHQpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyID0gY29udGV4dE1hbmFnZXI7XG5cdH1cblxuXHRzZXRTaWRlYmFyVmlldyhzaWRlYmFyVmlldzogYW55KTogdm9pZCB7XG5cdFx0dGhpcy5zaWRlYmFyVmlldyA9IHNpZGViYXJWaWV3O1xuXHRcdC8vIEFsc28gcGFzcyB0byB3aWtpbGluayBhdXRvY29tcGxldGUgaWYgaXQgZXhpc3RzXG5cdFx0aWYgKHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuc2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXcpO1xuXHRcdH1cblx0fVxuXG5cdHNldENvbW1hbmRTeXN0ZW0oY29tbWFuZFN5c3RlbTogQ29tbWFuZFN5c3RlbSk6IHZvaWQge1xuXHRcdHRoaXMuY29tbWFuZFN5c3RlbSA9IGNvbW1hbmRTeXN0ZW07XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgYnV0dG9uIGJlZm9yZSBzZW5kIGJ1dHRvbiBmb3IgcHJvcGVyIERPTSBvcmRlclxuXHRcdGNvbnN0IHNlbmRCdXR0b25FbCA9IHRoaXMuc2VuZEJ1dHRvbi5idXR0b25FbDtcblx0XHRzZW5kQnV0dG9uRWwucmVtb3ZlKCk7XG5cdFx0XG5cdFx0Ly8gQ3JlYXRlIGNvbW1hbmQgYnV0dG9uXG5cdFx0dGhpcy5jb21tYW5kU3lzdGVtLmNyZWF0ZUNvbW1hbmRCdXR0b24odGhpcy5pbnB1dFJvdyk7XG5cdFx0XG5cdFx0Ly8gUmUtYWRkIHNlbmQgYnV0dG9uICh3aWxsIGJlIGxhc3QgaW4gRE9NIG9yZGVyKVxuXHRcdHRoaXMuaW5wdXRSb3cuYXBwZW5kQ2hpbGQoc2VuZEJ1dHRvbkVsKTtcblx0XHRcblx0XHQvLyBDcmVhdGUgY29tbWFuZCBwaWNrZXJcblx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0uY3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKHRoaXMuaW5wdXRSb3cpO1xuXHR9XG5cblx0Z2V0VGV4dEFyZWEoKTogVGV4dEFyZWFDb21wb25lbnQge1xuXHRcdHJldHVybiB0aGlzLnRleHRBcmVhO1xuXHR9XG5cblx0Y3JlYXRlSW5wdXRJbnRlcmZhY2UoY2hhdENvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtaW5wdXQtY29udGFpbmVyJyB9KTtcblx0XHR0aGlzLmNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGA7XG5cblx0XHR0aGlzLmlucHV0Um93ID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1pbnB1dC1yb3cnIH0pO1xuXHRcdHRoaXMuaW5wdXRSb3cuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRnYXA6IHZhcigtLXNpemUtMi0zKTtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0YDtcblxuXHRcdC8vIFRleHRhcmVhIGNvbnRhaW5lclxuXHRcdGNvbnN0IHRleHRBcmVhQ29udGFpbmVyID0gdGhpcy5pbnB1dFJvdy5jcmVhdGVEaXYoKTtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2ZsZXg6IDE7IHBvc2l0aW9uOiByZWxhdGl2ZTsnO1xuXG5cdFx0Ly8gQ3JlYXRlIHRleHRhcmVhXG5cdFx0dGhpcy50ZXh0QXJlYSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudCh0ZXh0QXJlYUNvbnRhaW5lcik7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRQbGFjZWhvbGRlcignSG93IGNhbiBJIGhlbHA/Jyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtYXgtaGVpZ2h0OiAyMDBweDtcblx0XHRcdHJlc2l6ZTogbm9uZTtcblx0XHRcdG92ZXJmbG93LXk6IGF1dG87XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0XHRmb250LWZhbWlseTogdmFyKC0tZm9udC1pbnRlcmZhY2UpO1xuXHRcdFx0bGluZS1oZWlnaHQ6IDEuNDtcblx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0Ym94LXNpemluZzogYm9yZGVyLWJveDtcblx0XHRgO1xuXG5cdFx0Ly8gQXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCB0ZXh0YXJlYSA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbDtcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcblx0XHRcdHRleHRhcmVhLnN0eWxlLmhlaWdodCA9IE1hdGgubWluKHRleHRhcmVhLnNjcm9sbEhlaWdodCwgMjAwKSArICdweCc7XG5cdFx0fTtcblxuXHRcdC8vIEFkZCBpbnB1dCBldmVudCBsaXN0ZW5lciBmb3IgYXV0by1ncm93XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgJ2lucHV0JywgdGhpcy5hdXRvR3Jvd1RleHRhcmVhKTtcblxuXHRcdC8vIFRyaWdnZXIgYXV0by1ncm93IG9uIGluaXRpYWwgbG9hZFxuXHRcdHNldFRpbWVvdXQodGhpcy5hdXRvR3Jvd1RleHRhcmVhLCAwKTtcblxuXHRcdC8vIEluaXRpYWxpemUgd2lraWxpbmsgYXV0b2NvbXBsZXRlIHdpdGggaW5wdXRSb3cgZm9yIGNvbnNpc3RlbnQgd2lkdGhcblx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlID0gbmV3IE5vdmFXaWtpbGlua0F1dG9jb21wbGV0ZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMudGV4dEFyZWEuaW5wdXRFbCwgdGhpcy5pbnB1dFJvdyk7XG5cdFx0XG5cdFx0Ly8gUGFzcyBzaWRlYmFyIHZpZXcgcmVmZXJlbmNlIHdoZW4gYXZhaWxhYmxlXG5cdFx0aWYgKHRoaXMuc2lkZWJhclZpZXcpIHtcblx0XHRcdHRoaXMud2lraWxpbmtBdXRvY29tcGxldGUuc2V0U2lkZWJhclZpZXcodGhpcy5zaWRlYmFyVmlldyk7XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIGRlYm91bmNlZCBjb250ZXh0IHByZXZpZXdcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAnaW5wdXQnLCAoKSA9PiB7XG5cdFx0XHR0aGlzLmNvbnRleHRNYW5hZ2VyLnVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyh0aGlzLnRleHRBcmVhLmdldFZhbHVlKCkpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ29tbWFuZCBidXR0b24gd2lsbCBiZSBjcmVhdGVkIGxhdGVyIHdoZW4gQ29tbWFuZFN5c3RlbSBpcyBzZXRcblxuXHRcdC8vIFNlbmQgYnV0dG9uXG5cdFx0dGhpcy5zZW5kQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh0aGlzLmlucHV0Um93KTtcblx0XHR0aGlzLnNlbmRCdXR0b24uc2V0SWNvbignc2VuZCcpO1xuXHRcdHRoaXMuc2VuZEJ1dHRvbi5zZXRUb29sdGlwKCdTZW5kIG1lc3NhZ2UnKTtcblx0XHR0aGlzLnNlbmRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmhhbmRsZVNlbmQoKSk7XG5cdFx0dGhpcy5zZW5kQnV0dG9uLmJ1dHRvbkVsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRtaW4td2lkdGg6IHZhcigtLXNpemUtNC05KTtcblx0XHRcdGhlaWdodDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0Ym9yZGVyLXJhZGl1czogNTAlO1xuXHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdHBhZGRpbmc6IDA7XG5cdFx0XHRmbGV4LXNocmluazogMDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xuXHRcdFx0Ym9yZGVyOiBub25lO1xuXHRcdGA7XG5cblx0XHQvLyBFbnRlciBrZXkgaGFuZGxpbmcgYW5kIGNvbW1hbmQvc2VjdGlvbiBwaWNrZXJcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50ZXh0QXJlYS5pbnB1dEVsLCAna2V5ZG93bicsIChldmVudDogRXZlbnQpID0+IHtcblx0XHRcdGNvbnN0IGtleUV2ZW50ID0gZXZlbnQgYXMgS2V5Ym9hcmRFdmVudDtcblxuXHRcdFx0aWYgKGtleUV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAha2V5RXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0KHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpIHx8IGZhbHNlKSB8fCB0aGlzLmhhbmRsZVNlbmQoKTtcblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuXHRcdFx0XHR0aGlzLmNvbW1hbmRTeXN0ZW0/LmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGtleUV2ZW50LmtleSA9PT0gJ0Fycm93VXAnIHx8IGtleUV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdFx0aWYgKHRoaXMuY29tbWFuZFN5c3RlbT8uaGFuZGxlQ29tbWFuZFBpY2tlck5hdmlnYXRpb24oa2V5RXZlbnQua2V5KSkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoa2V5RXZlbnQua2V5ID09PSAnVGFiJykge1xuXHRcdFx0XHRpZiAodGhpcy5jb21tYW5kU3lzdGVtPy5oYW5kbGVDb21tYW5kUGlja2VyTmF2aWdhdGlvbihrZXlFdmVudC5rZXkpKSB7XG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gSW5wdXQgY2hhbmdlIGhhbmRsaW5nIGZvciBjb21tYW5kIHBpY2tlclxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRleHRBcmVhLmlucHV0RWwsICdpbnB1dCcsICgpID0+IHtcblx0XHRcdGlmICh0aGlzLmNvbW1hbmRTeXN0ZW0pIHtcblx0XHRcdFx0dGhpcy5jb21tYW5kU3lzdGVtLmhhbmRsZUlucHV0Q2hhbmdlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBTZXR1cCBkcmFnIGFuZCBkcm9wIGZvciBmaWxlIGNvbnRleHRcblx0XHR0aGlzLnNldHVwRHJhZ0FuZERyb3AoKTtcblx0fVxuXG5cdGZvY3VzKCk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMudGV4dEFyZWE/LmlucHV0RWwpIHtcblx0XHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XHR9XG5cdFx0fSwgSW5wdXRIYW5kbGVyLkZPQ1VTX0RFTEFZX01TKTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlU2VuZCgpOiB2b2lkIHtcblx0XHRjb25zdCBtZXNzYWdlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRpZiAoIW1lc3NhZ2UpIHJldHVybjtcblxuXHRcdC8vIENsZWFyIGlucHV0XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZSgnJyk7XG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdFx0dGhpcy5jb250ZXh0TWFuYWdlci5oaWRlQ29udGV4dFByZXZpZXcoKTtcblxuXHRcdC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGNhbGwgYSBjYWxsYmFjayBvciBlbWl0IGFuIGV2ZW50XG5cdFx0Ly8gRm9yIG5vdywgd2UnbGwgYXNzdW1lIHRoZSBwYXJlbnQgaGFuZGxlcyB0aGUgYWN0dWFsIHNlbmRpbmdcblx0XHR0aGlzLm9uU2VuZE1lc3NhZ2U/LihtZXNzYWdlKTtcblx0fVxuXG5cdHByaXZhdGUgb25TZW5kTWVzc2FnZT86IChtZXNzYWdlOiBzdHJpbmcpID0+IHZvaWQ7XG5cblx0c2V0T25TZW5kTWVzc2FnZShjYWxsYmFjazogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZCk6IHZvaWQge1xuXHRcdHRoaXMub25TZW5kTWVzc2FnZSA9IGNhbGxiYWNrO1xuXHR9XG5cblx0Z2V0VmFsdWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHR9XG5cblx0c2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodmFsdWUpO1xuXHRcdHRoaXMuYXV0b0dyb3dUZXh0YXJlYSgpO1xuXHR9XG5cblx0aW5zZXJ0VGV4dCh0ZXh0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0Y29uc3QgdGV4dGFyZWEgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cdFx0Y29uc3Qgc3RhcnQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydDtcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XG5cblx0XHRjb25zdCBuZXdWYWx1ZSA9IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBzdGFydCkgKyB0ZXh0ICsgY3VycmVudFZhbHVlLnNsaWNlKGVuZCk7XG5cdFx0dGhpcy50ZXh0QXJlYS5zZXRWYWx1ZShuZXdWYWx1ZSk7XG5cblx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYWZ0ZXIgaW5zZXJ0ZWQgdGV4dFxuXHRcdGNvbnN0IG5ld1Bvc2l0aW9uID0gc3RhcnQgKyB0ZXh0Lmxlbmd0aDtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKG5ld1Bvc2l0aW9uLCBuZXdQb3NpdGlvbik7XG5cdFx0XHR0ZXh0YXJlYS5mb2N1cygpO1xuXHRcdH0sIDApO1xuXG5cdFx0dGhpcy5hdXRvR3Jvd1RleHRhcmVhKCk7XG5cdH1cblxuXHRpbnNlcnRUZXh0V2l0aEN1cnNvcihiZWZvcmVDdXJzb3I6IHN0cmluZywgYWZ0ZXJDdXJzb3I6IHN0cmluZyA9ICcnKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFZhbHVlID0gdGhpcy50ZXh0QXJlYS5nZXRWYWx1ZSgpO1xuXHRcdGNvbnN0IHRleHRhcmVhID0gdGhpcy50ZXh0QXJlYS5pbnB1dEVsO1xuXHRcdGNvbnN0IHN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7XG5cdFx0Y29uc3QgZW5kID0gdGV4dGFyZWEuc2VsZWN0aW9uRW5kO1xuXG5cdFx0Y29uc3QgbmV3VmFsdWUgPSBjdXJyZW50VmFsdWUuc2xpY2UoMCwgc3RhcnQpICsgYmVmb3JlQ3Vyc29yICsgYWZ0ZXJDdXJzb3IgKyBjdXJyZW50VmFsdWUuc2xpY2UoZW5kKTtcblx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKG5ld1ZhbHVlKTtcblxuXHRcdC8vIFBvc2l0aW9uIGN1cnNvciBiZXR3ZWVuIGJlZm9yZSBhbmQgYWZ0ZXIgdGV4dFxuXHRcdGNvbnN0IGN1cnNvclBvc2l0aW9uID0gc3RhcnQgKyBiZWZvcmVDdXJzb3IubGVuZ3RoO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yUG9zaXRpb24sIGN1cnNvclBvc2l0aW9uKTtcblx0XHRcdHRleHRhcmVhLmZvY3VzKCk7XG5cdFx0fSwgMCk7XG5cblx0XHR0aGlzLmF1dG9Hcm93VGV4dGFyZWEoKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkRXZlbnRMaXN0ZW5lcihlbGVtZW50OiBFdmVudFRhcmdldCwgZXZlbnQ6IHN0cmluZywgaGFuZGxlcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0dGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSk7XG5cdH1cblxuXHRwcml2YXRlIHNldHVwRHJhZ0FuZERyb3AoKTogdm9pZCB7XG5cdFx0Y29uc3QgZHJvcFpvbmUgPSB0aGlzLnRleHRBcmVhLmlucHV0RWw7XG5cblx0XHQvLyBQcmV2ZW50IGRlZmF1bHQgZHJhZyBiZWhhdmlvcnNcblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcmFnZW50ZXInLCAoZTogRXZlbnQpID0+IHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMuaGFuZGxlRHJhZ0VudGVyKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcmFnb3ZlcicsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Ly8gU2V0IGRyb3AgZWZmZWN0IHRvIHNob3cgaXQncyBhbGxvd2VkXG5cdFx0XHQoZSBhcyBEcmFnRXZlbnQpLmRhdGFUcmFuc2ZlciEuZHJvcEVmZmVjdCA9ICdjb3B5Jztcblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihkcm9wWm9uZSwgJ2RyYWdsZWF2ZScsIChlOiBFdmVudCkgPT4ge1xuXHRcdFx0Ly8gT25seSBoaWRlIG92ZXJsYXkgaWYgd2UncmUgbGVhdmluZyB0aGUgZHJvcCB6b25lIGVudGlyZWx5XG5cdFx0XHRpZiAoZS50YXJnZXQgPT09IGRyb3Bab25lKSB7XG5cdFx0XHRcdHRoaXMuaGFuZGxlRHJhZ0xlYXZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZHJvcFpvbmUsICdkcm9wJywgKGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLmhhbmRsZURyb3AoZSBhcyBEcmFnRXZlbnQpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVEcmFnRW50ZXIoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuaXNEcmFnZ2luZykgcmV0dXJuO1xuXHRcdHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG5cblx0XHQvLyBDcmVhdGUgb3ZlcmxheSBmb3IgdmlzdWFsIGZlZWRiYWNrXG5cdFx0aWYgKCF0aGlzLmRyb3Bab25lT3ZlcmxheSkge1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LmNsYXNzTmFtZSA9ICdub3ZhLWRyb3Atem9uZS1vdmVybGF5Jztcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRcdFx0dG9wOiAwO1xuXHRcdFx0XHRsZWZ0OiAwO1xuXHRcdFx0XHRyaWdodDogMDtcblx0XHRcdFx0Ym90dG9tOiAwO1xuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRcdFx0XHRvcGFjaXR5OiAwO1xuXHRcdFx0XHRib3JkZXI6IDJweCBkYXNoZWQgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xuXHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRcdFx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG5cdFx0XHRcdHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlO1xuXHRcdFx0XHR6LWluZGV4OiAxMDtcblx0XHRcdGA7XG5cblx0XHRcdC8vIEFkZCBpY29uIGNvbnRhaW5lclxuXHRcdFx0Y29uc3QgaWNvbkNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0aWNvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRcdHdpZHRoOiA0OHB4O1xuXHRcdFx0XHRoZWlnaHQ6IDQ4cHg7XG5cdFx0XHRcdGRpc3BsYXk6IGZsZXg7XG5cdFx0XHRcdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRcdFx0XHRib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdFx0b3BhY2l0eTogMDtcblx0XHRcdFx0dHJhbnNmb3JtOiBzY2FsZSgwLjgpO1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXHRcdFx0YDtcblxuXHRcdFx0Ly8gQWRkIE9ic2lkaWFuJ3MgcGx1cyBpY29uXG5cdFx0XHRjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRpY29uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGxpbmUgeDE9XCIxMlwiIHkxPVwiNVwiIHgyPVwiMTJcIiB5Mj1cIjE5XCI+PC9saW5lPjxsaW5lIHgxPVwiNVwiIHkxPVwiMTJcIiB4Mj1cIjE5XCIgeTI9XCIxMlwiPjwvbGluZT48L3N2Zz5gO1xuXHRcdFx0aWNvbi5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0XHRcdFx0ZGlzcGxheTogZmxleDtcblx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRgO1xuXG5cdFx0XHRpY29uQ29udGFpbmVyLmFwcGVuZENoaWxkKGljb24pO1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkuYXBwZW5kQ2hpbGQoaWNvbkNvbnRhaW5lcik7XG5cdFx0fVxuXG5cdFx0Ly8gUG9zaXRpb24gcmVsYXRpdmUgdG8gdGV4dGFyZWFcblx0XHRjb25zdCB0ZXh0QXJlYUNvbnRhaW5lciA9IHRoaXMudGV4dEFyZWEuaW5wdXRFbC5wYXJlbnRFbGVtZW50ITtcblx0XHR0ZXh0QXJlYUNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG5cdFx0dGV4dEFyZWFDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5kcm9wWm9uZU92ZXJsYXkpO1xuXG5cdFx0Ly8gQW5pbWF0ZSBpblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuZHJvcFpvbmVPdmVybGF5KSB7XG5cdFx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAnMC4xJztcblx0XHRcdFx0Y29uc3QgaWNvbiA9IHRoaXMuZHJvcFpvbmVPdmVybGF5LnF1ZXJ5U2VsZWN0b3IoJ2RpdicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRpZiAoaWNvbikge1xuXHRcdFx0XHRcdGljb24uc3R5bGUub3BhY2l0eSA9ICcxJztcblx0XHRcdFx0XHRpY29uLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LCAxMCk7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyYWdMZWF2ZSgpOiB2b2lkIHtcblx0XHR0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcblx0XHRpZiAodGhpcy5kcm9wWm9uZU92ZXJsYXkpIHtcblx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0XHRjb25zdCBpY29uID0gdGhpcy5kcm9wWm9uZU92ZXJsYXkucXVlcnlTZWxlY3RvcignZGl2JykgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRpZiAoaWNvbikge1xuXHRcdFx0XHRpY29uLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0XHRcdGljb24uc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDAuOCknO1xuXHRcdFx0fVxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMuZHJvcFpvbmVPdmVybGF5Py5yZW1vdmUoKTtcblx0XHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkgPSBudWxsO1xuXHRcdFx0fSwgMjAwKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZURyb3AoZTogRHJhZ0V2ZW50KTogdm9pZCB7XG5cdFx0dGhpcy5oYW5kbGVEcmFnTGVhdmUoKTtcblxuXHRcdGNvbnN0IGZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIFBhcnNlIE9ic2lkaWFuJ3Mgb2JzaWRpYW46Ly8gVVJMcyAtIHByZWZlciB0ZXh0L3BsYWluIGFzIGl0IGhhcyBwcm9wZXIgbmV3bGluZXNcblx0XHRjb25zdCB0ZXh0UGxhaW5EYXRhID0gZS5kYXRhVHJhbnNmZXI/LmdldERhdGEoJ3RleHQvcGxhaW4nKTtcblx0XHRcblx0XHRpZiAodGV4dFBsYWluRGF0YSAmJiB0ZXh0UGxhaW5EYXRhLmluY2x1ZGVzKCdvYnNpZGlhbjovL29wZW4/JykpIHtcblx0XHRcdC8vIEhhbmRsZSBtdWx0aXBsZSBVUkxzIHNlcGFyYXRlZCBieSBuZXdsaW5lc1xuXHRcdFx0Y29uc3QgdXJscyA9IHRleHRQbGFpbkRhdGEuc3BsaXQoL1tcXG5cXHJdLykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkuc3RhcnRzV2l0aCgnb2JzaWRpYW46Ly9vcGVuPycpKTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCB1cmxTdHJpbmcgb2YgdXJscykge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGNvbnN0IHVybCA9IG5ldyBVUkwodXJsU3RyaW5nLnRyaW0oKSk7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZVBhdGggPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZmlsZScpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChmaWxlUGF0aCkge1xuXHRcdFx0XHRcdFx0Ly8gRGVjb2RlIHRoZSBVUkwtZW5jb2RlZCBwYXRoXG5cdFx0XHRcdFx0XHRjb25zdCBkZWNvZGVkUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChmaWxlUGF0aCk7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIEV4dHJhY3QgZmlsZW5hbWUgZnJvbSBwYXRoIChoYW5kbGUgYm90aCAvIGFuZCBcXCBzZXBhcmF0b3JzKVxuXHRcdFx0XHRcdFx0Y29uc3QgcGF0aFBhcnRzID0gZGVjb2RlZFBhdGguc3BsaXQoL1svXFxcXF0vKTtcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGVuYW1lID0gcGF0aFBhcnRzW3BhdGhQYXJ0cy5sZW5ndGggLSAxXTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gT25seSBwcm9jZXNzIG1hcmtkb3duIGZpbGVzXG5cdFx0XHRcdFx0XHRpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5tZCcpKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGJhc2VOYW1lID0gZmlsZW5hbWUucmVwbGFjZSgnLm1kJywgJycpO1xuXHRcdFx0XHRcdFx0XHRpZiAoYmFzZU5hbWUgJiYgIWZpbGVzLmluY2x1ZGVzKGJhc2VOYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzLnB1c2goYmFzZU5hbWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBGb3IgZmlsZXMgd2l0aG91dCAubWQgZXh0ZW5zaW9uLCBhc3N1bWUgdGhleSdyZSBtYXJrZG93biBub3Rlc1xuXHRcdFx0XHRcdFx0XHQvLyAoT2JzaWRpYW4gc29tZXRpbWVzIG9taXRzIHRoZSAubWQgZXh0ZW5zaW9uIGluIHBhdGhzKVxuXHRcdFx0XHRcdFx0XHRpZiAoZmlsZW5hbWUgJiYgIWZpbGVzLmluY2x1ZGVzKGZpbGVuYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVzLnB1c2goZmlsZW5hbWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBhcnNlIE9ic2lkaWFuIFVSTDonLCB1cmxTdHJpbmcsIGVycm9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkZCBmaWxlcyB0byBjb250ZXh0IGlmIHdlIGdvdCBhbnlcblx0XHRpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0dGhpcy5hZGRGaWxlc1RvQ29udGV4dChmaWxlcyk7XG5cdFx0fSBlbHNlIGlmICh0ZXh0UGxhaW5EYXRhICYmIHRleHRQbGFpbkRhdGEuaW5jbHVkZXMoJ29ic2lkaWFuOi8vb3Blbj8nKSkge1xuXHRcdFx0Ly8gVXNlciBkcm9wcGVkIHNvbWV0aGluZyBmcm9tIE9ic2lkaWFuIGJ1dCBubyBmaWxlcyB3ZXJlIGV4dHJhY3RlZFxuXHRcdFx0Ly8gVGhpcyBsaWtlbHkgbWVhbnMgdGhleSBkcm9wcGVkIG5vbi1tYXJrZG93biBmaWxlc1xuXHRcdFx0bmV3IE5vdGljZSgnT25seSBtYXJrZG93biBmaWxlcyBjYW4gYmUgYWRkZWQgdG8gY29udGV4dCcsIDMwMDApO1xuXHRcdH0gZWxzZSBpZiAodGV4dFBsYWluRGF0YSAmJiB0ZXh0UGxhaW5EYXRhLnRyaW0oKSAmJiAhdGV4dFBsYWluRGF0YS5pbmNsdWRlcygnOi8vJykpIHtcblx0XHRcdC8vIFVzZXIgZHJvcHBlZCBhIGZvbGRlciAocGxhaW4gdGV4dCBwYXRoIHdpdGhvdXQgcHJvdG9jb2wpXG5cdFx0XHRuZXcgTm90aWNlKCdGb2xkZXJzIGNhbm5vdCBiZSBhZGRlZCB0byBjb250ZXh0LiBQbGVhc2Ugc2VsZWN0IGluZGl2aWR1YWwgZmlsZXMuJywgMzAwMCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBhZGRGaWxlc1RvQ29udGV4dChmaWxlbmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKGZpbGVuYW1lcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuXHRcdC8vIEFkZCBmaWxlcyB0byBjb250ZXh0XG5cdFx0aWYgKHRoaXMuc2lkZWJhclZpZXcpIHtcblx0XHRcdGF3YWl0IHRoaXMuc2lkZWJhclZpZXcuYWRkRmlsZXNUb0NvbnRleHQoZmlsZW5hbWVzKTtcblx0XHR9XG5cdH1cblxuXG5cdHJlZnJlc2hDb21tYW5kQnV0dG9uKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRTeXN0ZW0pIHtcblx0XHRcdHRoaXMuY29tbWFuZFN5c3RlbS51cGRhdGVDb21tYW5kQnV0dG9uVmlzaWJpbGl0eSgpO1xuXHRcdH1cblx0fVxuXG5cdHVwZGF0ZUNvbnRleHRTdGF0ZShoYXNDb250ZXh0OiBib29sZWFuKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29udGFpbmVyKSB7XG5cdFx0XHRpZiAoaGFzQ29udGV4dCkge1xuXHRcdFx0XHR0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdoYXMtY29udGV4dCcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGFzLWNvbnRleHQnKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRjbGVhbnVwKCk6IHZvaWQge1xuXHRcdC8vIENsZWFuIHVwIHdpa2lsaW5rIGF1dG9jb21wbGV0ZVxuXHRcdGlmICh0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlKSB7XG5cdFx0XHR0aGlzLndpa2lsaW5rQXV0b2NvbXBsZXRlLmRlc3Ryb3koKTtcblx0XHR9XG5cblx0XHQvLyBDbGVhbiB1cCBkcm9wIHpvbmUgb3ZlcmxheVxuXHRcdGlmICh0aGlzLmRyb3Bab25lT3ZlcmxheSkge1xuXHRcdFx0dGhpcy5kcm9wWm9uZU92ZXJsYXkucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLmRyb3Bab25lT3ZlcmxheSA9IG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gQ2xlYW4gdXAgZXZlbnQgbGlzdGVuZXJzXG5cdFx0dGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKCh7IGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyIH0pID0+IHtcblx0XHRcdGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG5cdFx0fSk7XG5cdFx0dGhpcy5ldmVudExpc3RlbmVycyA9IFtdO1xuXHR9XG59IiwgIi8qKlxuICogTmF0aXZlIHdpa2lsaW5rIGF1dG9jb21wbGV0ZSBmb3IgTm92YSB0ZXh0YXJlYVxuICogVXNlcyBPYnNpZGlhbidzIG5hdGl2ZSBGdXp6eVN1Z2dlc3RNb2RhbCBmb3IgY29uc2lzdGVudCBVWFxuICovXG5cbmltcG9ydCB7IFRGaWxlLCBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgTm92YVdpa2lsaW5rQXV0b2NvbXBsZXRlIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgdGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzaWRlYmFyVmlldzogYW55OyAvLyBSZWZlcmVuY2UgdG8gTm92YVNpZGViYXJWaWV3XG4gICAgcHJpdmF0ZSBsYXN0VHJpZ2dlclBvczogbnVtYmVyID0gLTE7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGV4dEFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQsIGNvbnRhaW5lcj86IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnRleHRBcmVhID0gdGV4dEFyZWE7XG4gICAgICAgIHRoaXMuc2V0dXBFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHNldFNpZGViYXJWaWV3KHNpZGViYXJWaWV3OiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zaWRlYmFyVmlldyA9IHNpZGViYXJWaWV3O1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0dXBFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHRoaXMuaGFuZGxlSW5wdXQuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVJbnB1dCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMudGV4dEFyZWEudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvcyA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgIFxuICAgICAgICAvLyBMb29rIGZvciBbWyBwYXR0ZXJuIGJlZm9yZSBjdXJzb3JcbiAgICAgICAgY29uc3QgYmVmb3JlQ3Vyc29yID0gdGV4dC5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTtcbiAgICAgICAgY29uc3QgbGlua01hdGNoID0gYmVmb3JlQ3Vyc29yLm1hdGNoKC9cXFtcXFsoW15cXF1dKj8pJC8pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGxpbmtNYXRjaCAmJiBjdXJzb3JQb3MgIT09IHRoaXMubGFzdFRyaWdnZXJQb3MpIHtcbiAgICAgICAgICAgIHRoaXMubGFzdFRyaWdnZXJQb3MgPSBjdXJzb3JQb3M7XG4gICAgICAgICAgICB0aGlzLnNob3dOYXRpdmVGaWxlTW9kYWwoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd05hdGl2ZUZpbGVNb2RhbCgpOiB2b2lkIHtcbiAgICAgICAgLy8gR2V0IGN1cnJlbnQgZmlsZSBmcm9tIHNpZGViYXIgdmlld1xuICAgICAgICBjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuc2lkZWJhclZpZXc/LmN1cnJlbnRGaWxlIHx8IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBXaWtpbGlua0ZpbGVNb2RhbChcbiAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgYXN5bmMgKGZpbGU6IFRGaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zZWxlY3RGaWxlKGZpbGUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIGNhbmNlbGxlZCAtIHJlc2V0IHRyaWdnZXIgcG9zaXRpb25cbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RUcmlnZ2VyUG9zID0gLTE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3VycmVudEZpbGVcbiAgICAgICAgKTtcbiAgICAgICAgbW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2VsZWN0RmlsZShmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy50ZXh0QXJlYS52YWx1ZTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zID0gdGhpcy50ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgdGhlIFtbIHBhdHRlcm4gdG8gcmVtb3ZlXG4gICAgICAgIGNvbnN0IGJlZm9yZUN1cnNvciA9IHRleHQuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmtNYXRjaCA9IGJlZm9yZUN1cnNvci5tYXRjaCgvXFxbXFxbKFteXFxdXSo/KSQvKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChsaW5rTWF0Y2gpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0gY3Vyc29yUG9zIC0gbGlua01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBpbmNvbXBsZXRlIFtbIHBhdHRlcm4gZnJvbSB0aGUgaW5wdXRcbiAgICAgICAgICAgIGNvbnN0IG5ld1RleHQgPSB0ZXh0LnN1YnN0cmluZygwLCBzdGFydFBvcykgKyB0ZXh0LnN1YnN0cmluZyhjdXJzb3JQb3MpO1xuICAgICAgICAgICAgdGhpcy50ZXh0QXJlYS52YWx1ZSA9IG5ld1RleHQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgY2xlYXJlZCBwb3NpdGlvblxuICAgICAgICAgICAgdGhpcy50ZXh0QXJlYS5zZXRTZWxlY3Rpb25SYW5nZShzdGFydFBvcywgc3RhcnRQb3MpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIGlucHV0IGV2ZW50IHRvIHVwZGF0ZSBhbnkgYXV0by1ncm93IGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgICAgIHRoaXMudGV4dEFyZWEuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZpbGUgdG8gY29udGV4dCBhdXRvbWF0aWNhbGx5IFxuICAgICAgICBpZiAodGhpcy5zaWRlYmFyVmlldyAmJiB0aGlzLnNpZGViYXJWaWV3LmFkZEZpbGVzVG9Db250ZXh0KSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNpZGViYXJWaWV3LmFkZEZpbGVzVG9Db250ZXh0KFtmaWxlLmJhc2VuYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2V0IHRyaWdnZXIgcG9zaXRpb25cbiAgICAgICAgdGhpcy5sYXN0VHJpZ2dlclBvcyA9IC0xO1xuICAgICAgICB0aGlzLnRleHRBcmVhLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgLy8gTm8gY2xlYW51cCBuZWVkZWQgZm9yIG5hdGl2ZSBtb2RhbFxuICAgIH1cbn1cblxuLyoqXG4gKiBOYXRpdmUgT2JzaWRpYW4gZmlsZSBtb2RhbCBmb3Igd2lraWxpbmsgc2VsZWN0aW9uXG4gKi9cbmNsYXNzIFdpa2lsaW5rRmlsZU1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VEZpbGU+IHtcbiAgICBwcml2YXRlIG9uU2VsZWN0Q2FsbGJhY2s6IChmaWxlOiBURmlsZSkgPT4gdm9pZDtcbiAgICBwcml2YXRlIG9uQ2FuY2VsQ2FsbGJhY2s/OiAoKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbDtcbiAgICBwcml2YXRlIGFsbEZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIG9uU2VsZWN0OiAoZmlsZTogVEZpbGUpID0+IHZvaWQsXG4gICAgICAgIG9uQ2FuY2VsPzogKCkgPT4gdm9pZCxcbiAgICAgICAgY3VycmVudEZpbGU/OiBURmlsZSB8IG51bGxcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5vblNlbGVjdENhbGxiYWNrID0gb25TZWxlY3Q7XG4gICAgICAgIHRoaXMub25DYW5jZWxDYWxsYmFjayA9IG9uQ2FuY2VsO1xuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gY3VycmVudEZpbGUgfHwgbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ1NlYXJjaCBmaWxlcyB0byBhZGQgdG8gY29udGV4dC4uLicpO1xuICAgICAgICB0aGlzLmxvYWRGaWxlcygpO1xuICAgIH1cblxuICAgIG9uT3BlbigpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIub25PcGVuKCk7XG4gICAgICAgIHRoaXMuYWRkSW5zdHJ1Y3Rpb25zKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRJbnN0cnVjdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIC8vIEFkZCB0aGUgaW5zdHJ1Y3Rpb24gZm9vdGVyIGxpa2UgbmF0aXZlIE9ic2lkaWFuIG1vZGFsc1xuICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnNFbCA9IHRoaXMubW9kYWxFbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb25zJyB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5hdkluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb25zRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KTtcbiAgICAgICAgbmF2SW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogJ1x1MjE5MVx1MjE5MycgfSk7XG4gICAgICAgIG5hdkluc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAndG8gbmF2aWdhdGUnIH0pO1xuXG4gICAgICAgIGNvbnN0IHVzZUluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb25zRWwuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KTtcbiAgICAgICAgdXNlSW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogJ1x1MjFCNScgfSk7XG4gICAgICAgIHVzZUluc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiAndG8gdXNlJyB9KTtcblxuICAgICAgICBjb25zdCBlc2NJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbicgfSk7XG4gICAgICAgIGVzY0luc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24tY29tbWFuZCcsIHRleHQ6ICdlc2MnIH0pO1xuICAgICAgICBlc2NJbnN0cnVjdGlvbi5jcmVhdGVTcGFuKHsgdGV4dDogJ3RvIGRpc21pc3MnIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgbG9hZEZpbGVzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFsbEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsdGVyIG91dCB0aGUgY3VycmVudCBmaWxlIGlmIGl0IGV4aXN0c1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuICAgICAgICAgICAgdGhpcy5hbGxGaWxlcyA9IHRoaXMuYWxsRmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS5wYXRoICE9PSB0aGlzLmN1cnJlbnRGaWxlIS5wYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gU29ydCBieSBtb2RpZmljYXRpb24gdGltZSAobW9zdCByZWNlbnQgZmlyc3QpXG4gICAgICAgIHRoaXMuYWxsRmlsZXMuc29ydCgoYSwgYikgPT4gYi5zdGF0Lm10aW1lIC0gYS5zdGF0Lm10aW1lKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBURmlsZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsRmlsZXM7XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQoZmlsZTogVEZpbGUpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gZmlsZS5iYXNlbmFtZTtcbiAgICB9XG5cbiAgICBvbkNob29zZUl0ZW0oZmlsZTogVEZpbGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vblNlbGVjdENhbGxiYWNrKGZpbGUpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24obWF0Y2g6IEZ1enp5TWF0Y2g8VEZpbGU+LCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IG1hdGNoLml0ZW07XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgY29udGFpbmVyIHdpdGggbmF0aXZlIE9ic2lkaWFuIHN1Z2dlc3Rpb24gc3R5bGluZ1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gVGl0bGVcbiAgICAgICAgY29uc3QgdGl0bGUgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XG4gICAgICAgIHRpdGxlLnRleHRDb250ZW50ID0gZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgXG4gICAgICAgIC8vIEF1eGlsaWFyeSBpbmZvIChwYXRoKVxuICAgICAgICBjb25zdCBhdXggPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgICBhdXgudGV4dENvbnRlbnQgPSBmaWxlLnBhdGg7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIub25DbG9zZSgpO1xuICAgICAgICBpZiAodGhpcy5vbkNhbmNlbENhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ2FuY2VsQ2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCwgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIH0gZnJvbSAnLi4vY29yZS90eXBlcyc7XG5cbmludGVyZmFjZSBTdHJ1Y3R1cmVkQ29tbWFuZCB7XG5cdG5hbWU6IHN0cmluZztcblx0ZGVzY3JpcHRpb246IHN0cmluZztcblx0Y29tbWFuZDogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRleGFtcGxlOiBzdHJpbmc7XG5cdGtleXdvcmRzOiBzdHJpbmdbXTtcbn1cblxuXG4vKipcbiAqIEhhbmRsZXMgY29tbWFuZCBwaWNrZXIsIGNvbW1hbmQgbWVudSwgYW5kIGNvbW1hbmQgZXhlY3V0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBDb21tYW5kU3lzdGVtIHtcblx0cHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW47XG5cdHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0ZXh0QXJlYTogVGV4dEFyZWFDb21wb25lbnQ7XG5cdHByaXZhdGUgY29tbWFuZEJ1dHRvbiE6IEJ1dHRvbkNvbXBvbmVudDtcblx0cHJpdmF0ZSBjb21tYW5kUGlja2VyITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY29tbWFuZFBpY2tlckl0ZW1zOiBIVE1MRWxlbWVudFtdID0gW107XG5cdHByaXZhdGUgc2VsZWN0ZWRDb21tYW5kSW5kZXg6IG51bWJlciA9IC0xO1xuXHRwcml2YXRlIGNvbW1hbmRNZW51ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgaXNDb21tYW5kTWVudVZpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE5vdmFQbHVnaW4sIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHRleHRBcmVhOiBUZXh0QXJlYUNvbXBvbmVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdHRoaXMudGV4dEFyZWEgPSB0ZXh0QXJlYTtcblx0fVxuXG5cdGNyZWF0ZUNvbW1hbmRCdXR0b24oaW5wdXRSb3c6IEhUTUxFbGVtZW50KTogQnV0dG9uQ29tcG9uZW50IHtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Um93KTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uc2V0SWNvbignemFwJyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLnNldFRvb2x0aXAoJ0NvbW1hbmRzJyk7XG5cdFx0dGhpcy5jb21tYW5kQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy50b2dnbGVDb21tYW5kTWVudSgpKTtcblx0XHR0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1pbi13aWR0aDogdmFyKC0tc2l6ZS00LTkpO1xuXHRcdFx0aGVpZ2h0OiB2YXIoLS1zaXplLTQtOSk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiA1MCU7XG5cdFx0XHRkaXNwbGF5OiAke3RoaXMuc2hvdWxkU2hvd0NvbW1hbmRCdXR0b24oKSA/ICdmbGV4JyA6ICdub25lJ307XG5cdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdFx0XHRwYWRkaW5nOiAwO1xuXHRcdFx0ZmxleC1zaHJpbms6IDA7XG5cdFx0XHRtYXJnaW4tcmlnaHQ6IHZhcigtLXNpemUtMi0zKTtcblx0XHRgO1xuXHRcdHJldHVybiB0aGlzLmNvbW1hbmRCdXR0b247XG5cdH1cblxuXHRjcmVhdGVDb21tYW5kUGlja2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuY3JlYXRlQ29tbWFuZFBpY2tlckluQ29udGFpbmVyKHRoaXMuY29udGFpbmVyKTtcblx0fVxuXG5cdGNyZWF0ZUNvbW1hbmRQaWNrZXJJbkNvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1waWNrZXInIH0pO1xuXHRcdHRoaXMuY29tbWFuZFBpY2tlci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0Ym90dG9tOiAxMDAlO1xuXHRcdFx0bGVmdDogMDtcblx0XHRcdHJpZ2h0OiAwO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IDhweDtcblx0XHRcdGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcblx0XHRcdG1heC1oZWlnaHQ6IDIwMHB4O1xuXHRcdFx0b3ZlcmZsb3cteTogYXV0bztcblx0XHRcdHotaW5kZXg6IDEwMDA7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogNHB4O1xuXHRcdGA7XG5cdH1cblxuXHRzaG91bGRTaG93Q29tbWFuZEJ1dHRvbigpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gUGxhdGZvcm0uaXNNb2JpbGUgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0NvbW1hbmRCdXR0b24gJiYgdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKTtcblx0fVxuXG5cdHVwZGF0ZUNvbW1hbmRCdXR0b25WaXNpYmlsaXR5KCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbW1hbmRCdXR0b24pIHtcblx0XHRcdGNvbnN0IHNob3VsZFNob3cgPSB0aGlzLnNob3VsZFNob3dDb21tYW5kQnV0dG9uKCk7XG5cdFx0XHR0aGlzLmNvbW1hbmRCdXR0b24uYnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IHNob3VsZFNob3cgPyAnZmxleCcgOiAnbm9uZSc7XG5cdFx0fVxuXHR9XG5cblx0dG9nZ2xlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmNvbW1hbmRNZW51KSB7XG5cdFx0XHR0aGlzLmNyZWF0ZUNvbW1hbmRNZW51KCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICh0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlKSB7XG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kTWVudSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnNob3dDb21tYW5kTWVudSgpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5jb21tYW5kTWVudSA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ25vdmEtY29tbWFuZC1tZW51JyB9KTtcblx0XHR0aGlzLmNvbW1hbmRNZW51LnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHRib3R0b206IDEwMCU7XG5cdFx0XHRyaWdodDogMDtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctcyk7XG5cdFx0XHRtaW4td2lkdGg6IDI1MHB4O1xuXHRcdFx0bWF4LWhlaWdodDogMzAwcHg7XG5cdFx0XHRvdmVyZmxvdy15OiBhdXRvO1xuXHRcdFx0ei1pbmRleDogMTAwMDtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMik7XG5cdFx0YDtcblxuXHRcdC8vIENvbW1hbmRzIGF2YWlsYWJsZSB0byBhbGwgdXNlcnNcblx0XHRjb25zdCBjb21tYW5kcyA9IFtcblx0XHRcdHsgbmFtZTogJ0ltcHJvdmUgV3JpdGluZycsIGRlc2NyaXB0aW9uOiAnRW5oYW5jZSBjbGFyaXR5IGFuZCBmbG93JywgY29tbWFuZDogJ2ltcHJvdmUgd3JpdGluZycgfSxcblx0XHRcdHsgbmFtZTogJ0ZpeCBHcmFtbWFyJywgZGVzY3JpcHRpb246ICdDb3JyZWN0IGdyYW1tYXIgYW5kIHNwZWxsaW5nJywgY29tbWFuZDogJ2ZpeCBncmFtbWFyJyB9LFxuXHRcdFx0eyBuYW1lOiAnU3VtbWFyaXplJywgZGVzY3JpcHRpb246ICdDcmVhdGUgYSBjb25jaXNlIHN1bW1hcnknLCBjb21tYW5kOiAnc3VtbWFyaXplJyB9LFxuXHRcdFx0eyBuYW1lOiAnRXhwYW5kIElkZWFzJywgZGVzY3JpcHRpb246ICdEZXZlbG9wIHRob3VnaHRzIGZ1cnRoZXInLCBjb21tYW5kOiAnZXhwYW5kJyB9LFxuXHRcdFx0eyBuYW1lOiAnRXhwbGFpbicsIGRlc2NyaXB0aW9uOiAnQ2xhcmlmeSBjb21wbGV4IGNvbmNlcHRzJywgY29tbWFuZDogJ2V4cGxhaW4gdGhpcycgfSxcblx0XHRcdHsgbmFtZTogJ0NvbnRpbnVlIFdyaXRpbmcnLCBkZXNjcmlwdGlvbjogJ0V4dGVuZCB0aGUgY3VycmVudCB0ZXh0JywgY29tbWFuZDogJ2NvbnRpbnVlIHdyaXRpbmcnIH1cblx0XHRdO1xuXG5cdFx0Y29uc3QgdGl0bGUgPSB0aGlzLmNvbW1hbmRNZW51LmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6ICdRdWljayBDb21tYW5kcycgfSk7XG5cdFx0dGl0bGUuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1tZWRpdW0pO1xuXHRcdFx0Zm9udC13ZWlnaHQ6IDYwMDtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0zKTtcblx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdFx0YDtcblxuXHRcdGNvbW1hbmRzLmZvckVhY2goY21kID0+IHtcblx0XHRcdGNvbnN0IGNtZEVsID0gdGhpcy5jb21tYW5kTWVudS5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtaXRlbScgfSk7XG5cdFx0XHRjbWRFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMteHMpO1xuXHRcdFx0XHRjdXJzb3I6IHBvaW50ZXI7XG5cdFx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjFzO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgbmFtZUVsID0gY21kRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLm5hbWUgfSk7XG5cdFx0XHRuYW1lRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTEpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y29uc3QgZGVzY0VsID0gY21kRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLmRlc2NyaXB0aW9uIH0pO1xuXHRcdFx0ZGVzY0VsLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTtcblx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuXHRcdFx0YDtcblxuXHRcdFx0Y21kRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoY21kLmNvbW1hbmQgKyAnICcpO1xuXHRcdFx0XHR0aGlzLnRleHRBcmVhLmlucHV0RWwuZm9jdXMoKTtcblx0XHRcdFx0dGhpcy5oaWRlQ29tbWFuZE1lbnUoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRjbWRFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRjbWRFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcblx0XHRcdH0pO1xuXG5cdFx0XHRjbWRFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0XHRjbWRFbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3RyYW5zcGFyZW50Jztcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzaG93Q29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0XHR0aGlzLmlzQ29tbWFuZE1lbnVWaXNpYmxlID0gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRoaWRlQ29tbWFuZE1lbnUoKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZE1lbnUpIHtcblx0XHRcdHRoaXMuY29tbWFuZE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHRoaXMuaXNDb21tYW5kTWVudVZpc2libGUgPSBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRoYW5kbGVJbnB1dENoYW5nZSgpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMudGV4dEFyZWEpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgaW5wdXQgPSB0aGlzLnRleHRBcmVhLmdldFZhbHVlKCk7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgY29tbWFuZHMgZmVhdHVyZSBpcyBlbmFibGVkIGJlZm9yZSBoYW5kbGluZyB0cmlnZ2Vyc1xuXHRcdGlmICghdGhpcy5wbHVnaW4uZmVhdHVyZU1hbmFnZXIuaXNGZWF0dXJlRW5hYmxlZCgnY29tbWFuZHMnKSkge1xuXHRcdFx0dGhpcy5oaWRlQ29tbWFuZFBpY2tlcigpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBIYW5kbGUgZGlmZmVyZW50IHRyaWdnZXJzXG5cdFx0aWYgKGlucHV0LnN0YXJ0c1dpdGgoJzonKSkge1xuXHRcdFx0Ly8gQ3VzdG9tIGNvbW1hbmQgdHJpZ2dlciAtIHNob3cgc3RydWN0dXJlZCBjb21tYW5kc1xuXHRcdFx0dGhpcy5zaG93U3RydWN0dXJlZENvbW1hbmRQaWNrZXIoaW5wdXQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBObyB0cmlnZ2VycyBhY3RpdmUgLSBoaWRlIGNvbW1hbmQgcGlja2VyXG5cdFx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdFx0fVxuXHR9XG5cblxuXHQvKipcblx0ICogU2hvdyBzdHJ1Y3R1cmVkIGNvbW1hbmQgcGlja2VyIGZvciBcIjpcIiB0cmlnZ2VyICBcblx0ICovXG5cdHByaXZhdGUgc2hvd1N0cnVjdHVyZWRDb21tYW5kUGlja2VyKGlucHV0OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRjb25zdCBzdHJ1Y3R1cmVkQ29tbWFuZHMgPSB0aGlzLmdldFN0cnVjdHVyZWRDb21tYW5kcygpO1xuXHRcdGNvbnN0IGZpbHRlclRleHQgPSBpbnB1dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpOyAvLyBSZW1vdmUgXCI6XCJcblx0XHRcblx0XHRjb25zdCBmaWx0ZXJlZCA9IHN0cnVjdHVyZWRDb21tYW5kcy5maWx0ZXIoY21kID0+IFxuXHRcdFx0Y21kLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0Y21kLmNvbW1hbmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0Y21kLmtleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBrZXl3b3JkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyVGV4dCkpXG5cdFx0KTtcblxuXHRcdHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zID0gW107XG5cdFx0dGhpcy5jb21tYW5kUGlja2VyLmVtcHR5KCk7XG5cdFx0dGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA9IC0xO1xuXG5cdFx0aWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcblx0XHRcdGZpbHRlcmVkLmZvckVhY2goKGNtZCwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3QgaXRlbSA9IHRoaXMuY29tbWFuZFBpY2tlci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbW1hbmQtcGlja2VyLWl0ZW0nIH0pO1xuXHRcdFx0XHRpdGVtLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRcdFx0cGFkZGluZzogOHB4IDEycHg7XG5cdFx0XHRcdFx0Y3Vyc29yOiBwb2ludGVyO1xuXHRcdFx0XHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1ob3Zlcik7XG5cdFx0XHRcdFx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xuXHRcdFx0XHRgO1xuXG5cdFx0XHRcdGNvbnN0IG5hbWVFbCA9IGl0ZW0uY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogY21kLm5hbWUgfSk7XG5cdFx0XHRcdG5hbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiA1MDA7XG5cdFx0XHRcdFx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Y29uc3QgZGVzY0VsID0gaXRlbS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBjbWQuZGVzY3JpcHRpb24gfSk7XG5cdFx0XHRcdGRlc2NFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMC44NWVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0XHRcdFx0XHRtYXJnaW4tYm90dG9tOiA0cHg7XG5cdFx0XHRcdGA7XG5cblx0XHRcdFx0Y29uc3QgZXhhbXBsZUVsID0gaXRlbS5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBgRXhhbXBsZTogJHtjbWQuZXhhbXBsZX1gIH0pO1xuXHRcdFx0XHRleGFtcGxlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdFx0XHRmb250LXNpemU6IDAuOGVtO1xuXHRcdFx0XHRcdGNvbG9yOiB2YXIoLS10ZXh0LWFjY2VudCk7XG5cdFx0XHRcdFx0Zm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcblx0XHRcdFx0YDtcblxuXHRcdFx0XHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0U3RydWN0dXJlZENvbW1hbmQoY21kLnRlbXBsYXRlKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBpbmRleDtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dGhpcy5jb21tYW5kUGlja2VySXRlbXMucHVzaChpdGVtKTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHR9XG5cdH1cblxuXHRoaWRlQ29tbWFuZFBpY2tlcigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcyA9IFtdO1xuXHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSAtMTtcblx0fVxuXG5cdGhhbmRsZUNvbW1hbmRQaWNrZXJOYXZpZ2F0aW9uKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0aWYgKGtleSA9PT0gJ0Fycm93RG93bicpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1pbih0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgMSwgdGhpcy5jb21tYW5kUGlja2VySXRlbXMubGVuZ3RoIC0gMSk7XG5cdFx0XHR0aGlzLnVwZGF0ZUNvbW1hbmRQaWNrZXJTZWxlY3Rpb24oKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0gZWxzZSBpZiAoa2V5ID09PSAnQXJyb3dVcCcpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPSBNYXRoLm1heCh0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4IC0gMSwgLTEpO1xuXHRcdFx0dGhpcy51cGRhdGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ1RhYicgJiYgdGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA+PSAwKSB7XG5cdFx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgaGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbiBmb3IgVGFiXG5cdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVDb21tYW5kUGlja2VyU2VsZWN0aW9uKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0aGFuZGxlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiBib29sZWFuIHtcblx0XHRpZiAodGhpcy5zZWxlY3RlZENvbW1hbmRJbmRleCA+PSAwICYmIHRoaXMuY29tbWFuZFBpY2tlckl0ZW1zLmxlbmd0aCA+IDApIHtcblx0XHRcdC8vIEZvciBzdHJ1Y3R1cmVkIGNvbW1hbmRzLCB3ZSBuZWVkIHRvIGdldCB0aGUgc2VsZWN0ZWQgY29tbWFuZCBmcm9tIHRoZSBmaWx0ZXJlZCBsaXN0XG5cdFx0XHRjb25zdCBjb21tYW5kcyA9IHRoaXMuZ2V0U3RydWN0dXJlZENvbW1hbmRzKCk7XG5cdFx0XHRjb25zdCBpbnB1dCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKTtcblx0XHRcdGlmIChpbnB1dC5zdGFydHNXaXRoKCc6JykpIHtcblx0XHRcdFx0Y29uc3QgZmlsdGVyVGV4dCA9IGlucHV0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdGNvbnN0IGZpbHRlcmVkID0gY29tbWFuZHMuZmlsdGVyKGNtZCA9PiBcblx0XHRcdFx0XHRjbWQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpIHx8XG5cdFx0XHRcdFx0Y21kLmNvbW1hbmQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJUZXh0KSB8fFxuXHRcdFx0XHRcdGNtZC5rZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4ga2V5d29yZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclRleHQpKVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXggPCBmaWx0ZXJlZC5sZW5ndGgpIHtcblx0XHRcdFx0XHRjb25zdCBzZWxlY3RlZENtZCA9IGZpbHRlcmVkW3RoaXMuc2VsZWN0ZWRDb21tYW5kSW5kZXhdO1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0U3RydWN0dXJlZENvbW1hbmQoc2VsZWN0ZWRDbWQudGVtcGxhdGUpO1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ29tbWFuZFBpY2tlclNlbGVjdGlvbigpOiB2b2lkIHtcblx0XHR0aGlzLmNvbW1hbmRQaWNrZXJJdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuXHRcdFx0aWYgKGluZGV4ID09PSB0aGlzLnNlbGVjdGVkQ29tbWFuZEluZGV4KSB7XG5cdFx0XHRcdGl0ZW0uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzZWxlY3RDb21tYW5kKGNvbW1hbmQ6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUoY29tbWFuZCArICcgJyk7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0XG5cdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IGVuZFxuXHRcdGNvbnN0IGxlbmd0aCA9IHRoaXMudGV4dEFyZWEuZ2V0VmFsdWUoKS5sZW5ndGg7XG5cdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLnNldFNlbGVjdGlvblJhbmdlKGxlbmd0aCwgbGVuZ3RoKTtcblx0XHRcblx0XHR0aGlzLmhpZGVDb21tYW5kUGlja2VyKCk7XG5cdH1cblxuXG5cdC8qKlxuXHQgKiBHZXQgc3RydWN0dXJlZCBjb21tYW5kcyBmb3IgXCI6XCIgdHJpZ2dlclxuXHQgKi9cblx0cHJpdmF0ZSBnZXRTdHJ1Y3R1cmVkQ29tbWFuZHMoKTogU3RydWN0dXJlZENvbW1hbmRbXSB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0FkZCBDb250ZW50Jyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdBZGQgbmV3IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uJyxcblx0XHRcdFx0Y29tbWFuZDogJ2FkZCcsXG5cdFx0XHRcdHRlbXBsYXRlOiAnYWRkIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzphZGQgcGFyYWdyYXBoIGFib3V0IG1ldGhvZG9sb2d5Jyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY3JlYXRlJywgJ25ldycsICdpbnNlcnQnLCAnd3JpdGUnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0VkaXQgU2VsZWN0aW9uJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdFZGl0IHRoZSBzZWxlY3RlZCB0ZXh0Jyxcblx0XHRcdFx0Y29tbWFuZDogJ2VkaXQnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2VkaXQgdG8ge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmVkaXQgdG8gYmUgbW9yZSBmb3JtYWwnLFxuXHRcdFx0XHRrZXl3b3JkczogWydtb2RpZnknLCAndXBkYXRlJywgJ2NoYW5nZScsICdyZXZpc2UnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0RlbGV0ZSBTZWxlY3Rpb24nLFxuXHRcdFx0XHRkZXNjcmlwdGlvbjogJ1JlbW92ZSB0aGUgc2VsZWN0ZWQgdGV4dCcsXG5cdFx0XHRcdGNvbW1hbmQ6ICdkZWxldGUnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ2RlbGV0ZSB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6ZGVsZXRlIHNlbGVjdGVkIHRleHQnLFxuXHRcdFx0XHRrZXl3b3JkczogWydyZW1vdmUnLCAnZWxpbWluYXRlJywgJ2VyYXNlJ11cblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdG5hbWU6ICdSZXdyaXRlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdSZXdyaXRlIGNvbnRlbnQgd2l0aCBzcGVjaWZpYyBzdHlsZScsXG5cdFx0XHRcdGNvbW1hbmQ6ICdyZXdyaXRlJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdyZXdyaXRlIGFzIHtjdXJzb3J9Jyxcblx0XHRcdFx0ZXhhbXBsZTogJzpyZXdyaXRlIGFzIGJ1bGxldCBwb2ludHMnLFxuXHRcdFx0XHRrZXl3b3JkczogWydyZXBocmFzZScsICdyZXN0cnVjdHVyZScsICdyZXdvcmQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0ZpeCBHcmFtbWFyJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdDb3JyZWN0IGdyYW1tYXIgYW5kIHNwZWxsaW5nIGVycm9ycycsXG5cdFx0XHRcdGNvbW1hbmQ6ICdncmFtbWFyJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdmaXggZ3JhbW1hciB7Y3Vyc29yfScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6Zml4IGdyYW1tYXIgaW4gc2VsZWN0aW9uJyxcblx0XHRcdFx0a2V5d29yZHM6IFsnY29ycmVjdCcsICdwcm9vZnJlYWQnLCAnc3BlbGxpbmcnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ0NvbnRpbnVlJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246ICdDb250aW51ZSB3cml0aW5nIGZyb20gY3VycmVudCBwb3NpdGlvbicsXG5cdFx0XHRcdGNvbW1hbmQ6ICdjb250aW51ZScsXG5cdFx0XHRcdHRlbXBsYXRlOiAnY29udGludWUge2N1cnNvcn0nLFxuXHRcdFx0XHRleGFtcGxlOiAnOmNvbnRpbnVlIHdpdGggZXhhbXBsZXMnLFxuXHRcdFx0XHRrZXl3b3JkczogWydleHRlbmQnLCAnZXhwYW5kJywgJ3Byb2NlZWQnXVxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0bmFtZTogJ1VwZGF0ZSBNZXRhZGF0YScsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiAnVXBkYXRlIGRvY3VtZW50IHByb3BlcnRpZXMnLFxuXHRcdFx0XHRjb21tYW5kOiAnbWV0YWRhdGEnLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ3VwZGF0ZSB7Y3Vyc29yfSBwcm9wZXJ0eScsXG5cdFx0XHRcdGV4YW1wbGU6ICc6dXBkYXRlIHRhZ3MgcHJvcGVydHknLFxuXHRcdFx0XHRrZXl3b3JkczogWydmcm9udG1hdHRlcicsICdwcm9wZXJ0aWVzJywgJ3RhZ3MnXVxuXHRcdFx0fVxuXHRcdF07XG5cdH1cblxuXHQvKipcblx0ICogU2VsZWN0IGEgc3RydWN0dXJlZCBjb21tYW5kIGFuZCBpbnNlcnQgdGVtcGxhdGVcblx0ICovXG5cdHByaXZhdGUgc2VsZWN0U3RydWN0dXJlZENvbW1hbmQodGVtcGxhdGU6IHN0cmluZyk6IHZvaWQge1xuXHRcdHRoaXMuaGlkZUNvbW1hbmRQaWNrZXIoKTtcblx0XHRcblx0XHQvLyBSZXBsYWNlIGN1cnNvciBwbGFjZWhvbGRlciBhbmQgaW5zZXJ0IHRlbXBsYXRlXG5cdFx0Y29uc3QgY3Vyc29yUG9zID0gdGVtcGxhdGUuaW5kZXhPZigne2N1cnNvcn0nKTtcblx0XHRpZiAoY3Vyc29yUG9zICE9PSAtMSkge1xuXHRcdFx0Y29uc3QgYmVmb3JlQ3Vyc29yID0gdGVtcGxhdGUuc2xpY2UoMCwgY3Vyc29yUG9zKTtcblx0XHRcdGNvbnN0IGFmdGVyQ3Vyc29yID0gdGVtcGxhdGUuc2xpY2UoY3Vyc29yUG9zICsgOCk7IC8vIExlbmd0aCBvZiAne2N1cnNvcn0nXG5cdFx0XHR0aGlzLnRleHRBcmVhLnNldFZhbHVlKGJlZm9yZUN1cnNvciArIGFmdGVyQ3Vyc29yKTtcblx0XHRcdFxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIHdoZXJlIHtjdXJzb3J9IHdhc1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3JQb3MsIGN1cnNvclBvcyk7XG5cdFx0XHRcdHRoaXMudGV4dEFyZWEuaW5wdXRFbC5mb2N1cygpO1xuXHRcdFx0fSwgMCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudGV4dEFyZWEuc2V0VmFsdWUodGVtcGxhdGUpO1xuXHRcdFx0dGhpcy50ZXh0QXJlYS5pbnB1dEVsLmZvY3VzKCk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb21tYW5kTWVudSkge1xuXHRcdFx0dGhpcy5jb21tYW5kTWVudS5yZW1vdmUoKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuY29tbWFuZFBpY2tlcikge1xuXHRcdFx0dGhpcy5jb21tYW5kUGlja2VyLnJlbW92ZSgpO1xuXHRcdH1cblx0fVxufSIsICJpbXBvcnQgeyBBcHAsIFBsYXRmb3JtLCBURmlsZSwgTm90aWNlLCBDYWNoZWRNZXRhZGF0YSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uRGF0YSB9IGZyb20gJy4uL2NvcmUvdHlwZXMnO1xuaW1wb3J0IHsgY2FsY3VsYXRlQ29udGV4dFVzYWdlLCBDb250ZXh0VXNhZ2UsIGVzdGltYXRlVG9rZW5zIGFzIGNhbGN1bGF0ZVRva2VucyB9IGZyb20gJy4uL2NvcmUvY29udGV4dC1jYWxjdWxhdG9yJztcblxuZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudFJlZmVyZW5jZSB7XG5cdC8qKiBUaGUgZmlsZSBiZWluZyByZWZlcmVuY2VkICovXG5cdGZpbGU6IFRGaWxlO1xuXHRcblx0LyoqIFdoZXRoZXIgdGhpcyBpcyBwZXJzaXN0ZW50IGNvbnRleHQgKCtbW2RvY11dKSAqL1xuXHRpc1BlcnNpc3RlbnQ6IGJvb2xlYW47XG5cdFxuXHQvKiogVGhlIHJhdyByZWZlcmVuY2UgdGV4dCAoZS5nLiwgXCJbW015IERvY3VtZW50XV1cIikgKi9cblx0cmF3UmVmZXJlbmNlOiBzdHJpbmc7XG5cdFxuXHQvKiogU3BlY2lmaWMgcHJvcGVydHkgdG8gZXh0cmFjdCAoZS5nLiwgXCJbW2RvYyNwcm9wZXJ0eV1dXCIpICovXG5cdHByb3BlcnR5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpRG9jQ29udGV4dCB7XG5cdC8qKiBEb2N1bWVudHMgaW4gcGVyc2lzdGVudCBjb250ZXh0ICovXG5cdHBlcnNpc3RlbnREb2NzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuXHRcblx0LyoqIENvbWJpbmVkIGNvbnRleHQgc3RyaW5nICovXG5cdGNvbnRleHRTdHJpbmc6IHN0cmluZztcblx0XG5cdC8qKiBFc3RpbWF0ZWQgdG9rZW4gY291bnQgKGZvciBmaWxlIGF0dGFjaG1lbnRzIG9ubHkpICovXG5cdHRva2VuQ291bnQ6IG51bWJlcjtcblx0XG5cdC8qKiBXaGV0aGVyIHdlJ3JlIGFwcHJvYWNoaW5nIHRva2VuIGxpbWl0ICovXG5cdGlzTmVhckxpbWl0OiBib29sZWFuO1xuXHRcblx0LyoqIFRvdGFsIGNvbnRleHQgdXNhZ2UgY2FsY3VsYXRpb24gaW5jbHVkaW5nIGNvbnZlcnNhdGlvbiBoaXN0b3J5ICovXG5cdHRvdGFsQ29udGV4dFVzYWdlPzogQ29udGV4dFVzYWdlO1xufVxuXG4vKipcbiAqIEhhbmRsZXMgbXVsdGktZG9jdW1lbnQgY29udGV4dCBVSSBhbmQgbWFuYWdlbWVudFxuICovXG5leHBvcnQgY2xhc3MgQ29udGV4dE1hbmFnZXIge1xuXHRwcml2YXRlIHBsdWdpbjogTm92YVBsdWdpbjtcblx0cHJpdmF0ZSBhcHA6IEFwcDtcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHBlcnNpc3RlbnRDb250ZXh0OiBNYXA8c3RyaW5nLCBEb2N1bWVudFJlZmVyZW5jZVtdPiA9IG5ldyBNYXAoKTtcblx0cHVibGljIGNvbnRleHRJbmRpY2F0b3IhOiBIVE1MRWxlbWVudDtcblx0cHVibGljIGNvbnRleHRQcmV2aWV3ITogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VycmVudENvbnRleHQ6IE11bHRpRG9jQ29udGV4dCB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGN1cnJlbnRGaWxlUGF0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7IC8vIFRyYWNrIGN1cnJlbnQgZmlsZSBmb3IgdmFsaWRhdGlvblxuXHRwcml2YXRlIGN1cnJlbnRPcGVyYXRpb25JZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7IC8vIFRyYWNrIGN1cnJlbnQgYXN5bmMgb3BlcmF0aW9uXG5cdHByaXZhdGUgc2lkZWJhclZpZXc6IGFueTsgLy8gUmVmZXJlbmNlIHRvIE5vdmFTaWRlYmFyVmlldyBmb3IgYWRkaW5nIGZpbGVzXG5cdHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE5PVElDRV9EVVJBVElPTl9NUyA9IDUwMDA7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBOb3ZhUGx1Z2luLCBhcHA6IEFwcCwgY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuYXBwID0gYXBwO1xuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHR9XG5cblx0c2V0U2lkZWJhclZpZXcoc2lkZWJhclZpZXc6IGFueSk6IHZvaWQge1xuXHRcdHRoaXMuc2lkZWJhclZpZXcgPSBzaWRlYmFyVmlldztcblx0fVxuXG5cdGNyZWF0ZUNvbnRleHRJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbm92YS1jb250ZXh0LWluZGljYXRvcicgfSk7XG5cdFx0dGhpcy5jb250ZXh0SW5kaWNhdG9yLnN0eWxlLmNzc1RleHQgPSBgXG5cdFx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0XHR0b3A6IC0ycHg7XG5cdFx0XHRyaWdodDogdmFyKC0tc2l6ZS00LTMpO1xuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTtcblx0XHRcdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0XHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0xKSB2YXIoLS1zaXplLTItMik7XG5cdFx0XHRmb250LXNpemU6IHZhcigtLWZvbnQtdWktc21hbGxlcik7XG5cdFx0XHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0ei1pbmRleDogMTAwO1xuXHRcdFx0bWF4LXdpZHRoOiAyMDBweDtcblx0XHRcdGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTtcblx0XHRgO1xuXHR9XG5cblx0Y3JlYXRlQ29udGV4dFByZXZpZXcoKTogSFRNTEVsZW1lbnQge1xuXHRcdGNvbnN0IHByZXZpZXdDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldycgfSk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0YmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRwYWRkaW5nOiB2YXIoLS1zaXplLTItMikgdmFyKC0tc2l6ZS0yLTMpO1xuXHRcdFx0bWFyZ2luLWJvdHRvbTogdmFyKC0tc2l6ZS0yLTIpO1xuXHRcdFx0Zm9udC1zaXplOiB2YXIoLS1mb250LXVpLXNtYWxsKTtcblx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0YDtcblxuXHRcdGNvbnN0IHByZXZpZXdMYWJlbCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlU3Bhbih7IHRleHQ6ICdDb250ZXh0OiAnIH0pO1xuXHRcdHByZXZpZXdMYWJlbC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsgZm9udC13ZWlnaHQ6IDYwMDsnO1xuXG5cdFx0Y29uc3QgcHJldmlld0xpc3QgPSBwcmV2aWV3Q29udGFpbmVyLmNyZWF0ZVNwYW4oeyBjbHM6ICdub3ZhLWNvbnRleHQtcHJldmlldy1saXN0JyB9KTtcblx0XHRwcmV2aWV3TGlzdC5zdHlsZS5jc3NUZXh0ID0gJ2NvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyc7XG5cblx0XHRyZXR1cm4gcHJldmlld0NvbnRhaW5lcjtcblx0fVxuXG5cdHVwZGF0ZUxpdmVDb250ZXh0UHJldmlldyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMuY29udGV4dFByZXZpZXcpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBWYWxpZGF0ZSB3ZSBoYXZlIGEgY3VycmVudCBmaWxlIHNldFxuXHRcdGlmICghdGhpcy5jdXJyZW50RmlsZVBhdGgpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIW1lc3NhZ2UpIHtcblx0XHRcdHRoaXMuY29udGV4dFByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQYXJzZSBkb2N1bWVudCByZWZlcmVuY2VzIGZyb20gY3VycmVudCBtZXNzYWdlXG5cdFx0Y29uc3QgcmVmUGF0dGVybiA9IC8oXFwrKT9cXFtcXFsoW15cXF1dKz8pKD86IyhbXlxcXV0rPykpP1xcXVxcXS9nO1xuXHRcdGNvbnN0IGZvdW5kUmVmczogQXJyYXk8e25hbWU6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmd9PiA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWZQYXR0ZXJuLmV4ZWMobWVzc2FnZSkpICE9PSBudWxsKSB7XG5cdFx0XHRjb25zdCBkb2NOYW1lID0gbWF0Y2hbMl07XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG1hdGNoWzNdO1xuXHRcdFx0Zm91bmRSZWZzLnB1c2goeyBuYW1lOiBkb2NOYW1lLCBwcm9wZXJ0eSB9KTtcblx0XHR9XG5cblx0XHRpZiAoZm91bmRSZWZzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFVwZGF0ZSBwcmV2aWV3IGRpc3BsYXlcblx0XHRjb25zdCBwcmV2aWV3TGlzdCA9IHRoaXMuY29udGV4dFByZXZpZXcucXVlcnlTZWxlY3RvcignLm5vdmEtY29udGV4dC1wcmV2aWV3LWxpc3QnKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAocHJldmlld0xpc3QpIHtcblx0XHRcdGNvbnN0IHJlZnNUZXh0ID0gZm91bmRSZWZzLm1hcChyZWYgPT4gXG5cdFx0XHRcdHJlZi5wcm9wZXJ0eSA/IGAke3JlZi5uYW1lfSMke3JlZi5wcm9wZXJ0eX1gIDogcmVmLm5hbWVcblx0XHRcdCkuam9pbignLCAnKTtcblx0XHRcdHByZXZpZXdMaXN0LnRleHRDb250ZW50ID0gcmVmc1RleHQ7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0fVxuXG5cdGFzeW5jIGJ1aWxkQ29udGV4dChtZXNzYWdlOiBzdHJpbmcsIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPE11bHRpRG9jQ29udGV4dCB8IG51bGw+IHtcblx0XHRpZiAoIWN1cnJlbnRGaWxlKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBWYWxpZGF0ZSB3ZSBoYXZlIGEgY3VycmVudCBmaWxlIHNldCBmb3IgdmFsaWRhdGlvblxuXHRcdGlmICghdGhpcy5jdXJyZW50RmlsZVBhdGgpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIEdlbmVyYXRlIG9wZXJhdGlvbiBJRCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuXHRcdGNvbnN0IG9wZXJhdGlvbklkID0gRGF0ZS5ub3coKS50b1N0cmluZygpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuXHRcdHRoaXMuY3VycmVudE9wZXJhdGlvbklkID0gb3BlcmF0aW9uSWQ7XG5cdFx0XG5cdFx0Ly8gVHJhY2sgY3VycmVudCBmaWxlIHBhdGggZm9yIHZhbGlkYXRpb25cblx0XHRjb25zdCB0YXJnZXRGaWxlUGF0aCA9IGN1cnJlbnRGaWxlLnBhdGg7XG5cdFx0XG5cdFx0Ly8gVmFsaWRhdGUgdGhlIHJlcXVlc3RlZCBmaWxlIG1hdGNoZXMgb3VyIGN1cnJlbnQgdHJhY2tlZCBmaWxlXG5cdFx0aWYgKHRoaXMuY3VycmVudEZpbGVQYXRoICE9PSB0YXJnZXRGaWxlUGF0aCkge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIFBhcnNlIGN1cnJlbnQgbWVzc2FnZVxuXHRcdFx0Y29uc3QgeyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9ID0gdGhpcy5wYXJzZU1lc3NhZ2UobWVzc2FnZSwgY3VycmVudEZpbGUucGF0aCk7XG5cblx0XHRcdC8vIEdldCBleGlzdGluZyBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIHRoaXMgY29udmVyc2F0aW9uXG5cdFx0XHRjb25zdCBleGlzdGluZ1BlcnNpc3RlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjdXJyZW50RmlsZS5wYXRoKSB8fCBbXTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIG5ldyByZWZlcmVuY2VzIHRvIHBlcnNpc3RlbnQgY29udGV4dCAoYWxsIHJlZmVyZW5jZXMgYXJlIG5vdyBwZXJzaXN0ZW50KVxuXHRcdFx0aWYgKHJlZmVyZW5jZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ1BlcnNpc3RlbnRdO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQWRkIG5ldyByZWZlcmVuY2VzIHRoYXQgYXJlbid0IGFscmVhZHkgaW4gcGVyc2lzdGVudCBjb250ZXh0XG5cdFx0XHRcdGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcblx0XHRcdFx0XHRjb25zdCBleGlzdHMgPSB1cGRhdGVkUGVyc2lzdGVudC5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLmZpbGUucGF0aCA9PT0gcmVmLmZpbGUucGF0aCk7XG5cdFx0XHRcdFx0aWYgKCFleGlzdHMpIHtcblx0XHRcdFx0XHRcdHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGN1cnJlbnRGaWxlLnBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gR2V0IGZpbmFsIHBlcnNpc3RlbnQgY29udGV4dCAoaW5jbHVkaW5nIG5ld2x5IGFkZGVkIGRvY3MpXG5cdFx0XHRjb25zdCByYXdQZXJzaXN0ZW50RG9jcyA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGN1cnJlbnRGaWxlLnBhdGgpIHx8IFtdO1xuXHRcdFx0XG5cdFx0XHQvLyBGaWx0ZXIgb3V0IGFueSBzdGFsZSBmaWxlIHJlZmVyZW5jZXMgKGZpbGVzIHRoYXQgbm8gbG9uZ2VyIGV4aXN0KVxuXHRcdFx0Y29uc3QgYWxsUGVyc2lzdGVudERvY3MgPSByYXdQZXJzaXN0ZW50RG9jcy5maWx0ZXIoZG9jUmVmID0+IHtcblx0XHRcdFx0aWYgKCFkb2NSZWY/LmZpbGUgfHwgIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkb2NSZWYuZmlsZS5wYXRoKSkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgdGhlIHBlcnNpc3RlbnQgY29udGV4dCB0byByZW1vdmUgc3RhbGUgcmVmZXJlbmNlc1xuXHRcdFx0aWYgKGFsbFBlcnNpc3RlbnREb2NzLmxlbmd0aCAhPT0gcmF3UGVyc2lzdGVudERvY3MubGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChhbGxQZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0dGhpcy5wZXJzaXN0ZW50Q29udGV4dC5zZXQoY3VycmVudEZpbGUucGF0aCwgYWxsUGVyc2lzdGVudERvY3MpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGN1cnJlbnRGaWxlLnBhdGgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEJ1aWxkIGNvbnRleHQgc3RyaW5nIGZyb20gYWxsIGRvY3VtZW50c1xuXHRcdFx0Y29uc3QgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFx0XG5cdFx0XHQvLyBBTFdBWVMgaW5jbHVkZSBjdXJyZW50IGZpbGUgY29udGVudCBhbmQgbWV0YWRhdGEgZmlyc3QgKGltcGxpY2l0IGNvbnRleHQpXG5cdFx0XHRjb25zdCBjdXJyZW50RmlsZUNvbnRleHQgPSBhd2FpdCB0aGlzLmdldEZ1bGxEb2N1bWVudENvbnRleHQoY3VycmVudEZpbGUsIHRydWUsIDEwMCk7XG5cdFx0XHRpZiAoY3VycmVudEZpbGVDb250ZXh0KSB7XG5cdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKGN1cnJlbnRGaWxlQ29udGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFRoZW4gYWRkIGFsbCBwZXJzaXN0ZW50IGRvY3VtZW50cyB3aXRoIHRoZWlyIG1ldGFkYXRhXG5cdFx0XHRmb3IgKGNvbnN0IGRvY1JlZiBvZiBhbGxQZXJzaXN0ZW50RG9jcykge1xuXHRcdFx0XHRjb25zdCBjb250ZXh0UGFydCA9IGF3YWl0IHRoaXMuZ2V0RG9jdW1lbnRDb250ZXh0KGRvY1JlZik7XG5cdFx0XHRcdGlmIChjb250ZXh0UGFydCkge1xuXHRcdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKGNvbnRleHRQYXJ0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBjb250ZXh0U3RyaW5nID0gY29udGV4dFBhcnRzLmpvaW4oJ1xcblxcbi0tLVxcblxcbicpO1xuXHRcdFx0Y29uc3QgdG9rZW5Db3VudCA9IHRoaXMuZXN0aW1hdGVUb2tlbnMoY29udGV4dFN0cmluZyk7XG5cblx0XHRcdC8vIENhbGN1bGF0ZSB0b3RhbCBjb250ZXh0IHVzYWdlIGluY2x1ZGluZyBjb252ZXJzYXRpb24gaGlzdG9yeVxuXHRcdFx0Y29uc3QgZmlsZUF0dGFjaG1lbnRzID0gY29udGV4dFBhcnRzLm1hcChjb250ZW50ID0+ICh7IGNvbnRlbnQgfSkpO1xuXHRcdFx0Y29uc3QgdG90YWxDb250ZXh0VXNhZ2UgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVRvdGFsQ29udGV4dFVzYWdlKGZpbGVBdHRhY2htZW50cyk7XG5cblx0XHRcdGNvbnN0IGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCA9IHtcblx0XHRcdFx0cGVyc2lzdGVudERvY3M6IGFsbFBlcnNpc3RlbnREb2NzLFxuXHRcdFx0XHRjb250ZXh0U3RyaW5nLFxuXHRcdFx0XHR0b2tlbkNvdW50LFxuXHRcdFx0XHRpc05lYXJMaW1pdDogZmFsc2UsIC8vIExlZ2FjeSBmaWVsZCAtIHdhcm5pbmdzIG5vdyBoYW5kbGVkIGluIHNpZGViYXItdmlldy50c1xuXHRcdFx0XHR0b3RhbENvbnRleHRVc2FnZTogdG90YWxDb250ZXh0VXNhZ2Vcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdC8vIFZhbGlkYXRlIG9wZXJhdGlvbiBpcyBzdGlsbCBjdXJyZW50IGFuZCBmaWxlIGhhc24ndCBjaGFuZ2VkXG5cdFx0XHRpZiAodGhpcy5jdXJyZW50T3BlcmF0aW9uSWQgIT09IG9wZXJhdGlvbklkIHx8IFxuXHRcdFx0XHQhdGhpcy5jdXJyZW50RmlsZVBhdGggfHwgXG5cdFx0XHRcdHRoaXMuY3VycmVudEZpbGVQYXRoICE9PSB0YXJnZXRGaWxlUGF0aCkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IGNvbnRleHQ7XG5cblx0XHRcdGlmIChjb250ZXh0Py5wZXJzaXN0ZW50RG9jcy5sZW5ndGgpIHtcblx0XHRcdFx0dGhpcy51cGRhdGVDb250ZXh0SW5kaWNhdG9yKGNvbnRleHQpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gY29udGV4dDtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIGJ1aWxkIGNvbnRleHQgLSBncmFjZWZ1bCBmYWxsYmFja1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVDb250ZXh0SW5kaWNhdG9yKGNvbnRleHQ6IE11bHRpRG9jQ29udGV4dCk6IHZvaWQge1xuXHRcdC8vIENvbnRleHQgaW5kaWNhdG9yIFVJIGlzIG5vdyBmdWxseSBtYW5hZ2VkIGJ5IHNpZGViYXItdmlldy50c1xuXHRcdC8vIFRoaXMgbWV0aG9kIGlzIGtlcHQgZm9yIGNvbXBhdGliaWxpdHkgYnV0IGRvZXMgbm90aGluZ1xuXHRcdC8vIFRoZSBzaWRlYmFyLXZpZXcudHMgdXBkYXRlQ29udGV4dEluZGljYXRvcigpIG1ldGhvZCBoYW5kbGVzIGFsbCBkaXNwbGF5IGxvZ2ljXG5cdH1cblxuXG5cdGhpZGVDb250ZXh0UHJldmlldygpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5jb250ZXh0UHJldmlldykge1xuXHRcdFx0dGhpcy5jb250ZXh0UHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGhpZGVDb250ZXh0SW5kaWNhdG9yKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmNvbnRleHRJbmRpY2F0b3IpIHtcblx0XHRcdHRoaXMuY29udGV4dEluZGljYXRvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFyQ3VycmVudENvbnRleHQoKTogdm9pZCB7XG5cdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0dGhpcy5jdXJyZW50RmlsZVBhdGggPSBudWxsO1xuXHRcdHRoaXMuY3VycmVudE9wZXJhdGlvbklkID0gbnVsbDtcblx0XHR0aGlzLmhpZGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0dGhpcy5oaWRlQ29udGV4dFByZXZpZXcoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTZXQgY3VycmVudCBmaWxlIGFuZCBpbW1lZGlhdGVseSBjbGVhciBjb250ZXh0IHRvIHByZXZlbnQgYmxlZWRpbmdcblx0ICogVGhpcyBzaG91bGQgYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgd2hlbiBmaWxlIHN3aXRjaGVzIG9jY3VyXG5cdCAqL1xuXHRzZXRDdXJyZW50RmlsZShmaWxlOiBURmlsZSB8IG51bGwpOiB2b2lkIHtcblx0XHRjb25zdCBuZXdGaWxlUGF0aCA9IGZpbGU/LnBhdGggfHwgbnVsbDtcblx0XHRcblx0XHRpZiAodGhpcy5jdXJyZW50RmlsZVBhdGggIT09IG5ld0ZpbGVQYXRoKSB7XG5cdFx0XHQvLyBJbW1lZGlhdGVseSBjbGVhciBjb250ZXh0IHN0YXRlIHRvIHByZXZlbnQgYmxlZWRpbmdcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0dGhpcy5jdXJyZW50T3BlcmF0aW9uSWQgPSBudWxsOyAvLyBDYW5jZWwgYW55IHBlbmRpbmcgb3BlcmF0aW9uc1xuXHRcdFx0dGhpcy5oaWRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdFx0dGhpcy5oaWRlQ29udGV4dFByZXZpZXcoKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jdXJyZW50RmlsZVBhdGggPSBuZXdGaWxlUGF0aDtcblx0fVxuXG5cdGdldEN1cnJlbnRDb250ZXh0KCk6IE11bHRpRG9jQ29udGV4dCB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRDb250ZXh0O1xuXHR9XG5cblx0Z2V0Q3VycmVudEZpbGVQYXRoKCk6IHN0cmluZyB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLmN1cnJlbnRGaWxlUGF0aDtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXN0b3JlIGNvbnRleHQgYWZ0ZXIgY2hhdCBoYXMgYmVlbiBsb2FkZWQgKHByZXZlbnRzIG1pc3NpbmcgZmlsZSBub3RpZmljYXRpb25zIGZyb20gYmVpbmcgY2xlYXJlZClcblx0ICovXG5cdGFzeW5jIHJlc3RvcmVDb250ZXh0QWZ0ZXJDaGF0TG9hZChmaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBSZXN0b3JlIGNvbnRleHQgZnJvbSBjb252ZXJzYXRpb24gbWFuYWdlciBpZiBhdmFpbGFibGVcblx0XHRpZiAoZmlsZSAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnJlc3RvcmVDb250ZXh0RnJvbUNvbnZlcnNhdGlvbihmaWxlKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gTG9hZCBjb250ZXh0IGRhdGEgYW5kIHVwZGF0ZSBpbmRpY2F0b3Jcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0RnJvbVN0b3JhZ2UoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiBkcmF3ZXIgc2hvdWxkIGJlIHZpc2libGUgKGhhcyBjb250ZXh0IGRvY3VtZW50cylcblx0ICovXG5cdGlzRHJhd2VyVmlzaWJsZSgpOiBib29sZWFuIHtcblx0XHRjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDdXJyZW50Q29udGV4dCgpO1xuXHRcdHJldHVybiAoY29udGV4dD8ucGVyc2lzdGVudERvY3M/Lmxlbmd0aCB8fCAwKSA+IDA7XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGRvY3VtZW50IHRvIGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHQgKi9cblx0YXN5bmMgYWRkRG9jdW1lbnQoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMuY3VycmVudEZpbGVQYXRoKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRyeWluZyB0byBhZGQgdGhlIGN1cnJlbnQgZmlsZSB0byBpdHMgb3duIGNvbnRleHRcblx0XHRpZiAoZmlsZS5wYXRoID09PSB0aGlzLmN1cnJlbnRGaWxlUGF0aCkge1xuXHRcdFx0Ly8gQ3VycmVudCBmaWxlIGlzIGFscmVhZHkgaW1wbGljaXRseSBpbiBjb250ZXh0LCBza2lwIHNpbGVudGx5XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEdldCBjdXJyZW50IHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdGNvbnN0IGN1cnJlbnQgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldCh0aGlzLmN1cnJlbnRGaWxlUGF0aCkgfHwgW107XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgZG9jdW1lbnQgaXMgYWxyZWFkeSBpbiBjb250ZXh0XG5cdFx0Y29uc3QgZXhpc3RzID0gY3VycmVudC5zb21lKGRvYyA9PiBkb2MuZmlsZS5wYXRoID09PSBmaWxlLnBhdGgpO1xuXHRcdGlmIChleGlzdHMpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQWRkIHRoZSBkb2N1bWVudFxuXHRcdGNvbnN0IG5ld1JlZjogRG9jdW1lbnRSZWZlcmVuY2UgPSB7IFxuXHRcdFx0ZmlsZSwgXG5cdFx0XHRwcm9wZXJ0eTogdW5kZWZpbmVkLFxuXHRcdFx0aXNQZXJzaXN0ZW50OiB0cnVlLFxuXHRcdFx0cmF3UmVmZXJlbmNlOiBgW1ske2ZpbGUuYmFzZW5hbWV9XV1gXG5cdFx0fTtcblx0XHRjb25zdCB1cGRhdGVkID0gWy4uLmN1cnJlbnQsIG5ld1JlZl07XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCBkaXJlY3RseVxuXHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KHRoaXMuY3VycmVudEZpbGVQYXRoLCB1cGRhdGVkKTtcblx0XHRcblx0XHQvLyBTYXZlIHRvIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGZvciBwZXJzaXN0ZW5jZVxuXHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuY3VycmVudEZpbGVQYXRoKTtcblx0XHRcblx0XHRpZiAoY3VycmVudEZpbGUgJiYgY3VycmVudEZpbGUucGF0aCAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZENvbnRleHREb2N1bWVudChjdXJyZW50RmlsZSBhcyBURmlsZSwgZmlsZS5wYXRoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gUmVmcmVzaCBjb250ZXh0IGFuZCBpbmRpY2F0b3Jcblx0XHRhd2FpdCB0aGlzLnJlZnJlc2hDb250ZXh0RnJvbVN0b3JhZ2UoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZW1vdmUgZG9jdW1lbnQgZnJvbSBjb250ZXh0IGZvciBjdXJyZW50IGZpbGVcblx0ICovXG5cdGFzeW5jIHJlbW92ZURvY3VtZW50KGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlUGF0aCkgcmV0dXJuO1xuXHRcdFxuXHRcdC8vIFJlbW92ZSB0aGUgZG9jdW1lbnQgZnJvbSBwZXJzaXN0ZW50IGNvbnRleHRcblx0XHRjb25zdCBjdXJyZW50ID0gdGhpcy5wZXJzaXN0ZW50Q29udGV4dC5nZXQodGhpcy5jdXJyZW50RmlsZVBhdGgpIHx8IFtdO1xuXHRcdGNvbnN0IGZpbHRlcmVkID0gY3VycmVudC5maWx0ZXIocmVmID0+IHJlZi5maWxlLnBhdGggIT09IGZpbGUucGF0aCk7XG5cdFx0XG5cdFx0aWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KHRoaXMuY3VycmVudEZpbGVQYXRoLCBmaWx0ZXJlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKHRoaXMuY3VycmVudEZpbGVQYXRoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2F2ZSB0byBjb252ZXJzYXRpb24gbWFuYWdlciBmb3IgcGVyc2lzdGVuY2Vcblx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLmN1cnJlbnRGaWxlUGF0aCk7XG5cdFx0aWYgKGN1cnJlbnRGaWxlICYmIGN1cnJlbnRGaWxlLnBhdGggJiYgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikge1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5yZW1vdmVDb250ZXh0RG9jdW1lbnQoY3VycmVudEZpbGUgYXMgVEZpbGUsIGZpbGUucGF0aCk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFJlZnJlc2ggY29udGV4dCBhbmQgaW5kaWNhdG9yXG5cdFx0YXdhaXQgdGhpcy5yZWZyZXNoQ29udGV4dEZyb21TdG9yYWdlKCk7XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIGluZGljYXRvciBiYXNlZCBvbiBjdXJyZW50IGNvbnRleHQgc3RhdGVcblx0ICogTm90ZTogU2lkZWJhclZpZXcgaGFuZGxlcyBhY3R1YWwgVUkgdXBkYXRlcyB0byBwcmVzZXJ2ZSBjb21wbGV4IGRyYXdlciBmdW5jdGlvbmFsaXR5XG5cdCAqL1xuXHR1cGRhdGVJbmRpY2F0b3IoKTogdm9pZCB7XG5cdFx0Ly8gU3RhdGUgaXMgbWFuYWdlZCBoZXJlLCBidXQgVUkgdXBkYXRlcyBhcmUgaGFuZGxlZCBieSBTaWRlYmFyVmlld1xuXHRcdC8vIFRoaXMgbWV0aG9kIGV4aXN0cyBmb3IgQVBJIGNvbXBsZXRlbmVzcyBidXQgZG9lc24ndCB1cGRhdGUgVUkgZGlyZWN0bHlcblx0fVxuXG5cdC8qKlxuXHQgKiBQcml2YXRlIG1ldGhvZCB0byByZWZyZXNoIGNvbnRleHQgZnJvbSBzdG9yYWdlIGFuZCB1cGRhdGUgaW5kaWNhdG9yXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHJlZnJlc2hDb250ZXh0RnJvbVN0b3JhZ2UoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKCF0aGlzLmN1cnJlbnRGaWxlUGF0aCkge1xuXHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHR0aGlzLmhpZGVDb250ZXh0SW5kaWNhdG9yKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGN1cnJlbnQgZmlsZVxuXHRcdFx0Y29uc3QgcGVyc2lzdGVudERvY3MgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldCh0aGlzLmN1cnJlbnRGaWxlUGF0aCkgfHwgW107XG5cdFx0XHRcblx0XHRcdGlmIChwZXJzaXN0ZW50RG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29udGV4dCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuaGlkZUNvbnRleHRJbmRpY2F0b3IoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDYWxjdWxhdGUgdG9rZW4gY291bnRcblx0XHRcdGxldCB0b3RhbFRva2VucyA9IDA7XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBjdXJyZW50IGZpbGUgdG9rZW5zXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLmN1cnJlbnRGaWxlUGF0aCk7XG5cdFx0XHRcdGlmIChjdXJyZW50RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudENvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGN1cnJlbnRGaWxlKTtcblx0XHRcdFx0XHR0b3RhbFRva2VucyArPSBNYXRoLmNlaWwoY3VycmVudENvbnRlbnQubGVuZ3RoIC8gNCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIFNraXAgaWYgY2FuJ3QgcmVhZCBjdXJyZW50IGZpbGVcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQWRkIHBlcnNpc3RlbnQgZG9jcyB0b2tlbnNcblx0XHRcdGZvciAoY29uc3QgZG9jIG9mIHBlcnNpc3RlbnREb2NzKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZG9jLmZpbGUpO1xuXHRcdFx0XHRcdHRvdGFsVG9rZW5zICs9IE1hdGguY2VpbChjb250ZW50Lmxlbmd0aCAvIDQpO1xuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdC8vIFNraXAgZmlsZXMgdGhhdCBjYW4ndCBiZSByZWFkXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXG5cdFx0XHQvLyBDYWxjdWxhdGUgdG90YWwgY29udGV4dCB1c2FnZSBmb3IgdGhlIHN0b3JlZCBjb250ZXh0XG5cdFx0XHRjb25zdCBmaWxlQXR0YWNobWVudHMgPSBwZXJzaXN0ZW50RG9jcy5sZW5ndGggPiAwID8gXG5cdFx0XHRcdFt7IGNvbnRlbnQ6IGBDb250ZXh0IGZpbGVzOiAke3BlcnNpc3RlbnREb2NzLm1hcChkID0+IGQuZmlsZS5iYXNlbmFtZSkuam9pbignLCAnKX1gIH1dIDogXG5cdFx0XHRcdFtdO1xuXHRcdFx0Y29uc3QgdG90YWxDb250ZXh0VXNhZ2UgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVRvdGFsQ29udGV4dFVzYWdlKGZpbGVBdHRhY2htZW50cyk7XG5cblx0XHRcdC8vIEJ1aWxkIGNvbnRleHQgb2JqZWN0XG5cdFx0XHR0aGlzLmN1cnJlbnRDb250ZXh0ID0ge1xuXHRcdFx0XHRwZXJzaXN0ZW50RG9jczogcGVyc2lzdGVudERvY3MsXG5cdFx0XHRcdGNvbnRleHRTdHJpbmc6ICcnLCAvLyBOb3QgbmVlZGVkIGZvciBVSVxuXHRcdFx0XHR0b2tlbkNvdW50OiB0b3RhbFRva2Vucyxcblx0XHRcdFx0aXNOZWFyTGltaXQ6IGZhbHNlLCAvLyBMZWdhY3kgZmllbGQgLSB3YXJuaW5ncyBub3cgaGFuZGxlZCBpbiBzaWRlYmFyLXZpZXcudHNcblx0XHRcdFx0dG90YWxDb250ZXh0VXNhZ2U6IHRvdGFsQ29udGV4dFVzYWdlXG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBOb3RlOiBVSSB1cGRhdGVzIGhhbmRsZWQgYnkgU2lkZWJhclZpZXcgdG8gcHJlc2VydmUgY29tcGxleCBkcmF3ZXIgZnVuY3Rpb25hbGl0eVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIEhhbmRsZSBjb250ZXh0IGJ1aWxkIGZhaWx1cmVzIGdyYWNlZnVsbHlcblx0XHRcdHRoaXMuY3VycmVudENvbnRleHQgPSBudWxsO1xuXHRcdFx0dGhpcy5oaWRlQ29udGV4dEluZGljYXRvcigpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBSZXN0b3JlIGNvbnRleHQgZnJvbSBjb252ZXJzYXRpb24gbWFuYWdlclxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyByZXN0b3JlQ29udGV4dEZyb21Db252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCBzYXZlZCBjb250ZXh0IGRvY3VtZW50cyBmcm9tIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHRjb25zdCBzYXZlZENvbnRleHREb2NzID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb250ZXh0RG9jdW1lbnRzKGZpbGUpO1xuXHRcdFx0XG5cdFx0XHRpZiAoc2F2ZWRDb250ZXh0RG9jcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0Ly8gTm8gc2F2ZWQgY29udGV4dCwgZW5zdXJlIGNsZWFuIHN0YXRlXG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGUucGF0aCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gVmFsaWRhdGUgYW5kIGNvbnZlcnQgQ29udGV4dERvY3VtZW50UmVmcyBiYWNrIHRvIERvY3VtZW50UmVmZXJlbmNlc1xuXHRcdFx0Y29uc3QgdmFsaWREb2N1bWVudFJlZnM6IERvY3VtZW50UmVmZXJlbmNlW10gPSBbXTtcblx0XHRcdGNvbnN0IGludmFsaWRQYXRoczogc3RyaW5nW10gPSBbXTtcblx0XHRcdFxuXHRcdFx0Zm9yIChjb25zdCBjb250ZXh0RG9jIG9mIHNhdmVkQ29udGV4dERvY3MpIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHQvLyBWYWxpZGF0ZSBjb250ZXh0IGRvY3VtZW50IHN0cnVjdHVyZVxuXHRcdFx0XHRcdGlmICghY29udGV4dERvYyB8fCAhY29udGV4dERvYy5wYXRoIHx8IHR5cGVvZiBjb250ZXh0RG9jLnBhdGggIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ0ludmFsaWQgY29udGV4dCBkb2N1bWVudCBzdHJ1Y3R1cmU6JywgY29udGV4dERvYyk7XG5cdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gRmluZCB0aGUgYWN0dWFsIGZpbGUgaW4gdGhlIHZhdWx0XG5cdFx0XHRcdFx0Y29uc3QgY29udGV4dEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoY29udGV4dERvYy5wYXRoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoY29udGV4dEZpbGUgJiYgY29udGV4dEZpbGUucGF0aCAmJiBjb250ZXh0RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdFx0XHQvLyBGaWxlIGV4aXN0cyAtIGFkZCB0byB2YWxpZCBkb2N1bWVudHNcblx0XHRcdFx0XHRcdHZhbGlkRG9jdW1lbnRSZWZzLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRmaWxlOiBjb250ZXh0RmlsZSxcblx0XHRcdFx0XHRcdFx0cHJvcGVydHk6IGNvbnRleHREb2MucHJvcGVydHksXG5cdFx0XHRcdFx0XHRcdGlzUGVyc2lzdGVudDogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0cmF3UmVmZXJlbmNlOiBjb250ZXh0RG9jLnByb3BlcnR5IFxuXHRcdFx0XHRcdFx0XHRcdD8gYFtbJHtjb250ZXh0RmlsZS5iYXNlbmFtZX0jJHtjb250ZXh0RG9jLnByb3BlcnR5fV1dYFxuXHRcdFx0XHRcdFx0XHRcdDogYFtbJHtjb250ZXh0RmlsZS5iYXNlbmFtZX1dXWBcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBGaWxlIG1pc3NpbmcgLSB0cmFjayBmb3IgY2xlYW51cFxuXHRcdFx0XHRcdFx0aW52YWxpZFBhdGhzLnB1c2goY29udGV4dERvYy5wYXRoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGRvY0Vycm9yKSB7XG5cdFx0XHRcdFx0Ly8gU2tpcCBjb3JydXB0ZWQgaW5kaXZpZHVhbCBjb250ZXh0IGRvY3VtZW50c1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybignRXJyb3IgcHJvY2Vzc2luZyBjb250ZXh0IGRvY3VtZW50LCBza2lwcGluZzonLCBkb2NFcnJvcik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gQ2xlYW4gdXAgbWlzc2luZyBmaWxlcyBmcm9tIGNvbnZlcnNhdGlvbiBzdG9yYWdlIGFuZCBzaG93IG5vdGljZVxuXHRcdFx0aWYgKGludmFsaWRQYXRocy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuY2xlYW51cE1pc3NpbmdGaWxlcyhmaWxlLCBpbnZhbGlkUGF0aHMpO1xuXHRcdFx0XHR0aGlzLnNob3dNaXNzaW5nRmlsZXNOb3RpY2UoaW52YWxpZFBhdGhzKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCB3aXRoIHZhbGlkYXRlZCBkb2N1bWVudHNcblx0XHRcdGlmICh2YWxpZERvY3VtZW50UmVmcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGZpbGUucGF0aCwgdmFsaWREb2N1bWVudFJlZnMpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gTm8gdmFsaWQgZmlsZXMgLSBjbGVhciBjb250ZXh0XG5cdFx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGUucGF0aCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gR3JhY2VmdWwgZmFsbGJhY2sgb24gcmVzdG9yYXRpb24gZXJyb3JzXG5cdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byByZXN0b3JlIGNvbnRleHQgZnJvbSBjb252ZXJzYXRpb246JywgZXJyb3IpO1xuXHRcdFx0Ly8gRW5zdXJlIGNsZWFuIHN0YXRlIG9uIGVycm9yXG5cdFx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmRlbGV0ZShmaWxlLnBhdGgpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhbiB1cCBtaXNzaW5nIGZpbGVzIGZyb20gY29udmVyc2F0aW9uIHN0b3JhZ2Vcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgY2xlYW51cE1pc3NpbmdGaWxlcyhmaWxlOiBURmlsZSwgaW52YWxpZFBhdGhzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHQvLyBSZW1vdmUgZWFjaCBpbnZhbGlkIHBhdGggZnJvbSBjb252ZXJzYXRpb24gc3RvcmFnZVxuXHRcdFx0Zm9yIChjb25zdCBpbnZhbGlkUGF0aCBvZiBpbnZhbGlkUGF0aHMpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5yZW1vdmVDb250ZXh0RG9jdW1lbnQoZmlsZSwgaW52YWxpZFBhdGgpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBHcmFjZWZ1bCBmYWxsYmFjayBpZiBjbGVhbnVwIGZhaWxzXG5cdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjbGVhbnVwIG1pc3NpbmcgZmlsZXMgZnJvbSBjb252ZXJzYXRpb246JywgZXJyb3IpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBTaG93IG5vdGljZSBhbmQgY2hhdCBtZXNzYWdlIGFib3V0IG1pc3NpbmcgY29udGV4dCBmaWxlc1xuXHQgKi9cblx0cHJpdmF0ZSBzaG93TWlzc2luZ0ZpbGVzTm90aWNlKG1pc3NpbmdGaWxlczogc3RyaW5nW10pOiB2b2lkIHtcblx0XHRpZiAobWlzc2luZ0ZpbGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRsZXQgbm90aWNlTWVzc2FnZTogc3RyaW5nO1xuXHRcdFx0bGV0IGNoYXRNZXNzYWdlOiBzdHJpbmc7XG5cdFx0XHRcblx0XHRcdGlmIChtaXNzaW5nRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdG5vdGljZU1lc3NhZ2UgPSBgXHUyNkEwXHVGRTBGIENvbnRleHQgZmlsZSBubyBsb25nZXIgYXZhaWxhYmxlOiAke21pc3NpbmdGaWxlc1swXX1gO1xuXHRcdFx0XHRjaGF0TWVzc2FnZSA9IGBDb250ZXh0IGZpbGUgbm8gbG9uZ2VyIGF2YWlsYWJsZTogJHttaXNzaW5nRmlsZXNbMF19YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIExpbWl0IGRpc3BsYXkgdG8gYXZvaWQgb3Zlcmx5IGxvbmcgbm90aWNlc1xuXHRcdFx0XHRjb25zdCBkaXNwbGF5RmlsZXMgPSBtaXNzaW5nRmlsZXMuc2xpY2UoMCwgMyk7XG5cdFx0XHRcdGNvbnN0IHJlbWFpbmluZ0NvdW50ID0gbWlzc2luZ0ZpbGVzLmxlbmd0aCAtIGRpc3BsYXlGaWxlcy5sZW5ndGg7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAocmVtYWluaW5nQ291bnQgPiAwKSB7XG5cdFx0XHRcdFx0bm90aWNlTWVzc2FnZSA9IGBcdTI2QTBcdUZFMEYgJHttaXNzaW5nRmlsZXMubGVuZ3RofSBjb250ZXh0IGZpbGVzIG5vIGxvbmdlciBhdmFpbGFibGU6ICR7ZGlzcGxheUZpbGVzLmpvaW4oJywgJyl9IGFuZCAke3JlbWFpbmluZ0NvdW50fSBtb3JlYDtcblx0XHRcdFx0XHRjaGF0TWVzc2FnZSA9IGAke21pc3NpbmdGaWxlcy5sZW5ndGh9IGNvbnRleHQgZmlsZXMgbm8gbG9uZ2VyIGF2YWlsYWJsZTogJHtkaXNwbGF5RmlsZXMuam9pbignLCAnKX0gYW5kICR7cmVtYWluaW5nQ291bnR9IG1vcmVgO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG5vdGljZU1lc3NhZ2UgPSBgXHUyNkEwXHVGRTBGICR7bWlzc2luZ0ZpbGVzLmxlbmd0aH0gY29udGV4dCBmaWxlcyBubyBsb25nZXIgYXZhaWxhYmxlOiAke2Rpc3BsYXlGaWxlcy5qb2luKCcsICcpfWA7XG5cdFx0XHRcdFx0Y2hhdE1lc3NhZ2UgPSBgJHttaXNzaW5nRmlsZXMubGVuZ3RofSBjb250ZXh0IGZpbGVzIG5vIGxvbmdlciBhdmFpbGFibGU6ICR7ZGlzcGxheUZpbGVzLmpvaW4oJywgJyl9YDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBTaG93IHRlbXBvcmFyeSBub3RpY2UgZm9yIGltbWVkaWF0ZSBmZWVkYmFja1xuXHRcdFx0bmV3IE5vdGljZShub3RpY2VNZXNzYWdlLCBDb250ZXh0TWFuYWdlci5OT1RJQ0VfRFVSQVRJT05fTVMpO1xuXHRcdFx0XG5cdFx0XHQvLyBBZGQgcGVybWFuZW50IGNoYXQgbWVzc2FnZSBmb3IgY29udmVyc2F0aW9uIGhpc3Rvcnlcblx0XHRcdGlmICh0aGlzLnNpZGViYXJWaWV3ICYmIHR5cGVvZiB0aGlzLnNpZGViYXJWaWV3LmFkZFdhcm5pbmdNZXNzYWdlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdHRoaXMuc2lkZWJhclZpZXcuYWRkV2FybmluZ01lc3NhZ2UoY2hhdE1lc3NhZ2UpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBHcmFjZWZ1bCBmYWxsYmFjayBpZiBub3RpY2Ugb3IgY2hhdCBtZXNzYWdlIGZhaWxzXG5cdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzaG93IG1pc3NpbmcgZmlsZXMgbm90aWZpY2F0aW9uOicsIGVycm9yKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGUgYWxsIGNvbnRleHQgZG9jdW1lbnRzIGZvciBhIGZpbGUgYW5kIHJldHVybiByZXN1bHRzXG5cdCAqL1xuXHRhc3luYyB2YWxpZGF0ZUNvbnRleHREb2N1bWVudHMoZmlsZTogVEZpbGUpOiBQcm9taXNlPHtcblx0XHR2YWxpZEZpbGVzOiBzdHJpbmdbXTtcblx0XHRtaXNzaW5nRmlsZXM6IHN0cmluZ1tdO1xuXHRcdHRvdGFsQ291bnQ6IG51bWJlcjtcblx0fT4ge1xuXHRcdGlmICghdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikge1xuXHRcdFx0cmV0dXJuIHsgdmFsaWRGaWxlczogW10sIG1pc3NpbmdGaWxlczogW10sIHRvdGFsQ291bnQ6IDAgfTtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3Qgc2F2ZWRDb250ZXh0RG9jcyA9IGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udGV4dERvY3VtZW50cyhmaWxlKTtcblx0XHRcdGNvbnN0IHZhbGlkRmlsZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XHRjb25zdCBtaXNzaW5nRmlsZXM6IHN0cmluZ1tdID0gW107XG5cblx0XHRcdGZvciAoY29uc3QgY29udGV4dERvYyBvZiBzYXZlZENvbnRleHREb2NzKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRleHRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGNvbnRleHREb2MucGF0aCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoY29udGV4dEZpbGUgJiYgY29udGV4dEZpbGUucGF0aCkge1xuXHRcdFx0XHRcdHZhbGlkRmlsZXMucHVzaChjb250ZXh0RG9jLnBhdGgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG1pc3NpbmdGaWxlcy5wdXNoKGNvbnRleHREb2MucGF0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0dmFsaWRGaWxlcyxcblx0XHRcdFx0bWlzc2luZ0ZpbGVzLFxuXHRcdFx0XHR0b3RhbENvdW50OiBzYXZlZENvbnRleHREb2NzLmxlbmd0aFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gR3JhY2VmdWwgZmFsbGJhY2tcblx0XHRcdHJldHVybiB7IHZhbGlkRmlsZXM6IFtdLCBtaXNzaW5nRmlsZXM6IFtdLCB0b3RhbENvdW50OiAwIH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNjaGVkdWxlIGFzeW5jIHBlcnNpc3RlbmNlIHVwZGF0ZVxuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBzY2hlZHVsZVBlcnNpc3RlbmNlVXBkYXRlKGNvbnZlcnNhdGlvbkZpbGVQYXRoOiBzdHJpbmcsIHJlZmVyZW5jZXM6IERvY3VtZW50UmVmZXJlbmNlW10pOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBSdW4gYXN5bmMgc2F2ZSBpbiBiYWNrZ3JvdW5kXG5cdFx0Y29uc3QgY29udmVyc2F0aW9uRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjb252ZXJzYXRpb25GaWxlUGF0aCk7XG5cdFx0aWYgKGNvbnZlcnNhdGlvbkZpbGUgJiYgY29udmVyc2F0aW9uRmlsZS5wYXRoICYmIHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHtcblx0XHRcdC8vIENvbnZlcnQgRG9jdW1lbnRSZWZlcmVuY2VzIHRvIENvbnRleHREb2N1bWVudFJlZnNcblx0XHRcdGNvbnN0IGNvbnRleHRSZWZzID0gcmVmZXJlbmNlcy5tYXAocmVmID0+ICh7XG5cdFx0XHRcdHBhdGg6IHJlZi5maWxlLnBhdGgsXG5cdFx0XHRcdHByb3BlcnR5OiByZWYucHJvcGVydHksXG5cdFx0XHRcdGFkZGVkQXQ6IERhdGUubm93KClcblx0XHRcdH0pKTtcblx0XHRcdFxuXHRcdFx0Ly8gU2F2ZSBhbGwgY29udGV4dCBkb2N1bWVudHNcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuc2V0Q29udGV4dERvY3VtZW50cyhjb252ZXJzYXRpb25GaWxlIGFzIFRGaWxlLCBjb250ZXh0UmVmcyk7XG5cdFx0fVxuXHR9XG5cblx0Y2xlYW51cCgpOiB2b2lkIHtcblx0XHR0aGlzLmNsZWFyQ3VycmVudENvbnRleHQoKTtcblx0XHRpZiAodGhpcy5jb250ZXh0SW5kaWNhdG9yKSB7XG5cdFx0XHR0aGlzLmNvbnRleHRJbmRpY2F0b3IucmVtb3ZlKCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbnRleHRQcmV2aWV3KSB7XG5cdFx0XHR0aGlzLmNvbnRleHRQcmV2aWV3LnJlbW92ZSgpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZSBhIG1lc3NhZ2UgZm9yIGRvY3VtZW50IHJlZmVyZW5jZXNcblx0ICovXG5cdHBhcnNlTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIGNvbnZlcnNhdGlvbkZpbGVQYXRoOiBzdHJpbmcpOiB7XG5cdFx0Y2xlYW5lZE1lc3NhZ2U6IHN0cmluZztcblx0XHRyZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdO1xuXHR9IHtcblx0XHRjb25zdCByZWZlcmVuY2VzOiBEb2N1bWVudFJlZmVyZW5jZVtdID0gW107XG5cdFx0bGV0IGNsZWFuZWRNZXNzYWdlID0gbWVzc2FnZTtcblxuXHRcdC8vIFBhdHRlcm4gdG8gbWF0Y2ggW1tkb2NdXSBhbmQgK1tbZG9jXV0gd2l0aCBvcHRpb25hbCBwcm9wZXJ0eVxuXHRcdC8vIE5vdGU6IEFsbCBkb2N1bWVudCByZWZlcmVuY2VzIGFyZSBub3cgcGVyc2lzdGVudCBmb3Igc2ltcGxpZmllZCBVWFxuXHRcdGNvbnN0IHJlZlBhdHRlcm4gPSAvKFxcKyk/XFxbXFxbKFteXFxdXSs/KSg/OiMoW15cXF1dKz8pKT9cXF1cXF0vZztcblx0XHRcblx0XHRsZXQgbWF0Y2g7XG5cdFx0d2hpbGUgKChtYXRjaCA9IHJlZlBhdHRlcm4uZXhlYyhtZXNzYWdlKSkgIT09IG51bGwpIHtcblx0XHRcdGNvbnN0IGRvY05hbWUgPSBtYXRjaFsyXTtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbWF0Y2hbM107XG5cdFx0XHRjb25zdCByYXdSZWZlcmVuY2UgPSBtYXRjaFswXTtcblxuXHRcdFx0Ly8gVHJ5IHRvIGZpbmQgdGhlIGZpbGVcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmZpbmRGaWxlKGRvY05hbWUpO1xuXHRcdFx0XG5cdFx0XHRpZiAoZmlsZSkge1xuXHRcdFx0XHRyZWZlcmVuY2VzLnB1c2goe1xuXHRcdFx0XHRcdGZpbGUsXG5cdFx0XHRcdFx0aXNQZXJzaXN0ZW50OiB0cnVlLCAvLyBBbGwgcmVmZXJlbmNlcyBhcmUgbm93IHBlcnNpc3RlbnRcblx0XHRcdFx0XHRyYXdSZWZlcmVuY2UsXG5cdFx0XHRcdFx0cHJvcGVydHlcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGFsbCBmb3VuZCByZWZlcmVuY2VzIGZyb20gbWVzc2FnZVxuXHRcdGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcblx0XHRcdGNsZWFuZWRNZXNzYWdlID0gY2xlYW5lZE1lc3NhZ2UucmVwbGFjZShyZWYucmF3UmVmZXJlbmNlLCAnICcpO1xuXHRcdH1cblxuXHRcdC8vIENsZWFuIHVwIGV4Y2Vzc2l2ZSBzcGFjZXMgYnV0IHByZXNlcnZlIG5lY2Vzc2FyeSBzcGFjaW5nXG5cdFx0Y2xlYW5lZE1lc3NhZ2UgPSBjbGVhbmVkTWVzc2FnZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJykudHJpbSgpO1xuXG5cdFx0Ly8gVXBkYXRlIHBlcnNpc3RlbnQgY29udGV4dCBpZiBuZWVkZWRcblx0XHRjb25zdCBwZXJzaXN0ZW50UmVmcyA9IHJlZmVyZW5jZXMuZmlsdGVyKHJlZiA9PiByZWYuaXNQZXJzaXN0ZW50KTtcblx0XHRpZiAocGVyc2lzdGVudFJlZnMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgZXhpc3RpbmcgPSB0aGlzLnBlcnNpc3RlbnRDb250ZXh0LmdldChjb252ZXJzYXRpb25GaWxlUGF0aCkgfHwgW107XG5cdFx0XHRjb25zdCB1cGRhdGVkUGVyc2lzdGVudCA9IFsuLi5leGlzdGluZ107XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBuZXcgcmVmZXJlbmNlcyB0aGF0IGFyZW4ndCBhbHJlYWR5IGluIHBlcnNpc3RlbnQgY29udGV4dFxuXHRcdFx0Zm9yIChjb25zdCByZWYgb2YgcGVyc2lzdGVudFJlZnMpIHtcblx0XHRcdFx0Y29uc3QgZXhpc3RzID0gdXBkYXRlZFBlcnNpc3RlbnQuc29tZShleGlzdGluZyA9PiBleGlzdGluZy5maWxlLnBhdGggPT09IHJlZi5maWxlLnBhdGgpO1xuXHRcdFx0XHRpZiAoIWV4aXN0cykge1xuXHRcdFx0XHRcdHVwZGF0ZWRQZXJzaXN0ZW50LnB1c2gocmVmKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnBlcnNpc3RlbnRDb250ZXh0LnNldChjb252ZXJzYXRpb25GaWxlUGF0aCwgdXBkYXRlZFBlcnNpc3RlbnQpO1xuXHRcdFx0XG5cdFx0XHQvLyBTY2hlZHVsZSBhc3luYyBzYXZlIHRvIGNvbnZlcnNhdGlvbiBtYW5hZ2VyXG5cdFx0XHR0aGlzLnNjaGVkdWxlUGVyc2lzdGVuY2VVcGRhdGUoY29udmVyc2F0aW9uRmlsZVBhdGgsIHVwZGF0ZWRQZXJzaXN0ZW50KTtcblx0XHR9XG5cblx0XHRyZXR1cm4geyBjbGVhbmVkTWVzc2FnZSwgcmVmZXJlbmNlcyB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBmdWxsIGRvY3VtZW50IGNvbnRleHQgaW5jbHVkaW5nIG1ldGFkYXRhL3Byb3BlcnRpZXNcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlOiBURmlsZSwgaW5jbHVkZUNvbnRlbnQ6IGJvb2xlYW4gPSB0cnVlLCBtYXhMaW5lczogbnVtYmVyID0gNTApOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblx0XHR0cnkge1xuXHRcdFx0bGV0IGNvbnRleHRQYXJ0czogc3RyaW5nW10gPSBbXTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGRvY3VtZW50IGhlYWRlclxuXHRcdFx0Y29udGV4dFBhcnRzLnB1c2goYCMjIERvY3VtZW50OiAke2ZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcblx0XHRcdC8vIEdldCBhbmQgYWRkIG1ldGFkYXRhL3Byb3BlcnRpZXMgaWYgYXZhaWxhYmxlXG5cdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBPYmplY3Qua2V5cyhjYWNoZS5mcm9udG1hdHRlcikubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb250ZXh0UGFydHMucHVzaCgnXFxuIyMjIFByb3BlcnRpZXMvTWV0YWRhdGE6Jyk7XG5cdFx0XHRcdGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNhY2hlLmZyb250bWF0dGVyKSkge1xuXHRcdFx0XHRcdC8vIEZvcm1hdCB0aGUgcHJvcGVydHkgdmFsdWUgKGhhbmRsZSBhcnJheXMsIG9iamVjdHMsIGV0Yy4pXG5cdFx0XHRcdFx0Y29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogdmFsdWU7XG5cdFx0XHRcdFx0Y29udGV4dFBhcnRzLnB1c2goYC0gJHtrZXl9OiAke2Zvcm1hdHRlZFZhbHVlfWApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEFkZCBjb250ZW50IGlmIHJlcXVlc3RlZFxuXHRcdFx0aWYgKGluY2x1ZGVDb250ZW50KSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gU2tpcCBmcm9udG1hdHRlciBpbiBjb250ZW50IGRpc3BsYXkgKGJldHdlZW4gLS0tIG1hcmtlcnMpXG5cdFx0XHRcdFx0bGV0IGNvbnRlbnRTdGFydEluZGV4ID0gMDtcblx0XHRcdFx0XHRpZiAobGluZXNbMF0gPT09ICctLS0nKSB7XG5cdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcblx0XHRcdFx0XHRcdFx0XHRjb250ZW50U3RhcnRJbmRleCA9IGkgKyAxO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IGNvbnRlbnRMaW5lcyA9IGxpbmVzLnNsaWNlKGNvbnRlbnRTdGFydEluZGV4KTtcblx0XHRcdFx0XHRjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gY29udGVudExpbmVzLnNsaWNlKDAsIG1heExpbmVzKS5qb2luKCdcXG4nKTtcblx0XHRcdFx0XHRjb25zdCB3YXNUcnVuY2F0ZWQgPSBjb250ZW50TGluZXMubGVuZ3RoID4gbWF4TGluZXM7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29udGV4dFBhcnRzLnB1c2goJ1xcbiMjIyBDb250ZW50OicpO1xuXHRcdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKHRydW5jYXRlZENvbnRlbnQpO1xuXHRcdFx0XHRcdGlmICh3YXNUcnVuY2F0ZWQpIHtcblx0XHRcdFx0XHRcdGNvbnRleHRQYXJ0cy5wdXNoKCdcXG5bLi4uIHRydW5jYXRlZCBmb3IgYnJldml0eSAuLi5dJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiBjb250ZXh0UGFydHMuam9pbignXFxuJyk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdC8vIEZhaWxlZCB0byByZWFkIGZ1bGwgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGNvbnRleHQgZm9yIGEgc3BlY2lmaWMgZG9jdW1lbnQgcmVmZXJlbmNlXG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIGdldERvY3VtZW50Q29udGV4dChkb2NSZWY6IERvY3VtZW50UmVmZXJlbmNlKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHsgZmlsZSwgcHJvcGVydHkgfSA9IGRvY1JlZjtcblx0XHRcdFxuXHRcdFx0Ly8gVmFsaWRhdGUgdGhhdCB0aGUgZmlsZSBzdGlsbCBleGlzdHMgaW4gdGhlIHZhdWx0XG5cdFx0XHRpZiAoIWZpbGUgfHwgIXRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlLnBhdGgpKSB7XG5cdFx0XHRcdC8vIEZpbGUgbm8gbG9uZ2VyIGV4aXN0cyAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAocHJvcGVydHkpIHtcblx0XHRcdFx0Ly8gR2V0IHNwZWNpZmljIHByb3BlcnR5IGZyb20gZnJvbnRtYXR0ZXJcblx0XHRcdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRcdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBjYWNoZS5mcm9udG1hdHRlcltwcm9wZXJ0eV0pIHtcblx0XHRcdFx0XHRyZXR1cm4gYCMjICR7ZmlsZS5iYXNlbmFtZX0gLSAke3Byb3BlcnR5fVxcbiR7Y2FjaGUuZnJvbnRtYXR0ZXJbcHJvcGVydHldfWA7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBHZXQgZnVsbCBkb2N1bWVudCBjb250ZXh0IHdpdGggbWV0YWRhdGFcblx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0RnVsbERvY3VtZW50Q29udGV4dChmaWxlKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Ly8gRmFpbGVkIHRvIHJlYWQgY29udGV4dCAtIGdyYWNlZnVsIGZhbGxiYWNrXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRmluZCBhIGZpbGUgYnkgbmFtZSBvciBwYXRoXG5cdCAqL1xuXHRwcml2YXRlIGZpbmRGaWxlKG5hbWVPclBhdGg6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdFx0Ly8gRmlyc3QgdHJ5IGV4YWN0IHBhdGggbWF0Y2hcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuYW1lT3JQYXRoKTtcblx0XHRcblx0XHRpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHQvLyBUcnkgd2l0aCAubWQgZXh0ZW5zaW9uXG5cdFx0XHRmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5hbWVPclBhdGggKyAnLm1kJyk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdC8vIFNlYXJjaCBieSBiYXNlbmFtZVxuXHRcdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0XHRmaWxlID0gZmlsZXMuZmluZChmID0+IFxuXHRcdFx0XHRmLmJhc2VuYW1lID09PSBuYW1lT3JQYXRoIHx8IFxuXHRcdFx0XHRmLm5hbWUgPT09IG5hbWVPclBhdGggfHxcblx0XHRcdFx0Zi5wYXRoLmVuZHNXaXRoKCcvJyArIG5hbWVPclBhdGgpIHx8XG5cdFx0XHRcdGYucGF0aC5lbmRzV2l0aCgnLycgKyBuYW1lT3JQYXRoICsgJy5tZCcpXG5cdFx0XHQpIHx8IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBFc3RpbWF0ZSB0b2tlbiBjb3VudCAocm91Z2ggYXBwcm94aW1hdGlvbilcblx0ICovXG5cdHByaXZhdGUgZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcblx0XHQvLyBSb3VnaCBlc3RpbWF0ZTogfjQgY2hhcmFjdGVycyBwZXIgdG9rZW5cblx0XHRyZXR1cm4gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7XG5cdH1cblxuXHQvKipcblx0ICogQ2FsY3VsYXRlIHRvdGFsIGNvbnRleHQgdXNhZ2UgaW5jbHVkaW5nIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG5cdCAqL1xuXHRhc3luYyBjYWxjdWxhdGVUb3RhbENvbnRleHRVc2FnZShcblx0XHRmaWxlQXR0YWNobWVudHM6IEFycmF5PHtjb250ZW50OiBzdHJpbmd9PiA9IFtdLFxuXHRcdGN1cnJlbnRJbnB1dDogc3RyaW5nID0gJycsXG5cdFx0cmVjZW50UmVzcG9uc2U6IHN0cmluZyA9ICcnXG5cdCk6IFByb21pc2U8Q29udGV4dFVzYWdlPiB7XG5cdFx0Ly8gVHJ5IHRvIGdldCBhY3R1YWwgcHJvdmlkZXIgYW5kIG1vZGVsIC0gbm8gaGFyZGNvZGVkIGRlZmF1bHRzXG5cdFx0bGV0IHByb3ZpZGVyVHlwZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdFx0bGV0IG1vZGVsOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0XHRsZXQgY29udmVyc2F0aW9uSGlzdG9yeTogQXJyYXk8e2NvbnRlbnQ6IHN0cmluZ30+ID0gW107XG5cdFx0XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFRyeSB0byBnZXQgYWN0dWFsIHByb3ZpZGVyIGFuZCBtb2RlbFxuXHRcdFx0Y29uc3QgZGV0ZWN0ZWRQcm92aWRlclR5cGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5haVByb3ZpZGVyTWFuYWdlcj8uZ2V0Q3VycmVudFByb3ZpZGVyVHlwZSgpO1xuXHRcdFx0aWYgKGRldGVjdGVkUHJvdmlkZXJUeXBlKSB7XG5cdFx0XHRcdHByb3ZpZGVyVHlwZSA9IGRldGVjdGVkUHJvdmlkZXJUeXBlO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gR2V0IG1vZGVsIGZyb20gcHJvdmlkZXIgbWFuYWdlclxuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Y29uc3QgY3VycmVudE1vZGVsID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2V0Q3VycmVudE1vZGVsKCk7XG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudE1vZGVsKSB7XG5cdFx0XHRcdFx0XHRcdG1vZGVsID0gY3VycmVudE1vZGVsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBnZXQgY3VycmVudCBtb2RlbDonLCBlcnJvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIElmIG5vIHByb3ZpZGVyIG9yIG1vZGVsIGNvbmZpZ3VyZWQsIHJldHVybiBtaW5pbWFsIGNvbnRleHQgdXNhZ2Vcblx0XHRcdGlmICghcHJvdmlkZXJUeXBlIHx8ICFtb2RlbCkge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHRvdGFsVG9rZW5zOiAwLFxuXHRcdFx0XHRcdGNvbnRleHRMaW1pdDogMzIwMDAsIC8vIEdlbmVyaWMgZmFsbGJhY2sgY29udGV4dCBzaXplXG5cdFx0XHRcdFx0dXNhZ2VQZXJjZW50YWdlOiAwLFxuXHRcdFx0XHRcdGJyZWFrZG93bjoge1xuXHRcdFx0XHRcdFx0Y29udmVyc2F0aW9uSGlzdG9yeTogMCxcblx0XHRcdFx0XHRcdGZpbGVBdHRhY2htZW50czogMCxcblx0XHRcdFx0XHRcdGN1cnJlbnRJbnB1dDogMCxcblx0XHRcdFx0XHRcdHJlY2VudFJlc3BvbnNlOiAwXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGFzIENvbnRleHRVc2FnZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gR2V0IGNvbnZlcnNhdGlvbiBoaXN0b3J5IGZvciBjdXJyZW50IGZpbGVcblx0XHRcdGlmICh0aGlzLmN1cnJlbnRGaWxlUGF0aCAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuY3VycmVudEZpbGVQYXRoKSBhcyBURmlsZTtcblx0XHRcdFx0aWYgKGN1cnJlbnRGaWxlKSB7XG5cdFx0XHRcdFx0Y29uc3QgY29udmVyc2F0aW9uID0gYXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb252ZXJzYXRpb24oY3VycmVudEZpbGUpO1xuXHRcdFx0XHRcdGNvbnZlcnNhdGlvbkhpc3RvcnkgPSAoY29udmVyc2F0aW9uPy5tZXNzYWdlcyB8fCBbXSkubWFwKG1zZyA9PiAoeyBjb250ZW50OiBtc2cuY29udGVudCB9KSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0Vycm9yIGR1cmluZyBjb250ZXh0IGNhbGN1bGF0aW9uIHNldHVwLCB1c2luZyBkZWZhdWx0czonLCBlcnJvcik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEFsd2F5cyBjYWxjdWxhdGUgY29udGV4dCB1c2FnZSB3aXRoIGZhbGxiYWNrIHZhbHVlc1xuXHRcdGNvbnN0IG9sbGFtYURlZmF1bHRDb250ZXh0ID0gdGhpcy5wbHVnaW4/LnNldHRpbmdzPy5vbGxhbWFEZWZhdWx0Q29udGV4dCB8fCAzMjAwMDtcblx0XHRcblx0XHRjb25zdCB1c2FnZSA9IGNhbGN1bGF0ZUNvbnRleHRVc2FnZShcblx0XHRcdHByb3ZpZGVyVHlwZSEsXG5cdFx0XHRtb2RlbCEsXG5cdFx0XHRjb252ZXJzYXRpb25IaXN0b3J5LFxuXHRcdFx0ZmlsZUF0dGFjaG1lbnRzLFxuXHRcdFx0Y3VycmVudElucHV0LFxuXHRcdFx0cmVjZW50UmVzcG9uc2UsXG5cdFx0XHRvbGxhbWFEZWZhdWx0Q29udGV4dFxuXHRcdCk7XG5cdFx0XG5cdFx0cmV0dXJuIHVzYWdlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIHBlcnNpc3RlbnQgY29udGV4dCBmb3IgYSBjb252ZXJzYXRpb25cblx0ICovXG5cdGFzeW5jIGNsZWFyUGVyc2lzdGVudENvbnRleHQoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcblx0XHRcblx0XHQvLyBBbHNvIGNsZWFyIGZyb20gY29udmVyc2F0aW9uIG1hbmFnZXJcblx0XHRjb25zdCBjb252ZXJzYXRpb25GaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblx0XHRpZiAoY29udmVyc2F0aW9uRmlsZSAmJiBjb252ZXJzYXRpb25GaWxlLnBhdGggJiYgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlcikge1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uY29udmVyc2F0aW9uTWFuYWdlci5jbGVhckNvbnRleHREb2N1bWVudHMoY29udmVyc2F0aW9uRmlsZSBhcyBURmlsZSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBwZXJzaXN0ZW50IGNvbnRleHQgZm9yIGEgY29udmVyc2F0aW9uXG5cdCAqL1xuXHRnZXRQZXJzaXN0ZW50Q29udGV4dChmaWxlUGF0aDogc3RyaW5nKTogRG9jdW1lbnRSZWZlcmVuY2VbXSB7XG5cdFx0cmV0dXJuIHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGZpbGVQYXRoKSB8fCBbXTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZW1vdmUgYSBzcGVjaWZpYyBkb2N1bWVudCBmcm9tIHBlcnNpc3RlbnQgY29udGV4dFxuXHQgKi9cblx0YXN5bmMgcmVtb3ZlUGVyc2lzdGVudERvYyhmaWxlUGF0aDogc3RyaW5nLCBkb2NUb1JlbW92ZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgY3VycmVudCA9IHRoaXMucGVyc2lzdGVudENvbnRleHQuZ2V0KGZpbGVQYXRoKSB8fCBbXTtcblx0XHRjb25zdCBmaWx0ZXJlZCA9IGN1cnJlbnQuZmlsdGVyKHJlZiA9PiByZWYuZmlsZS5wYXRoICE9PSBkb2NUb1JlbW92ZSk7XG5cdFx0XG5cdFx0aWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuc2V0KGZpbGVQYXRoLCBmaWx0ZXJlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucGVyc2lzdGVudENvbnRleHQuZGVsZXRlKGZpbGVQYXRoKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQWxzbyByZW1vdmUgZnJvbSBjb252ZXJzYXRpb24gbWFuYWdlclxuXHRcdGNvbnN0IGNvbnZlcnNhdGlvbkZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdGlmIChjb252ZXJzYXRpb25GaWxlICYmIGNvbnZlcnNhdGlvbkZpbGUucGF0aCAmJiB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyKSB7XG5cdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLnJlbW92ZUNvbnRleHREb2N1bWVudChjb252ZXJzYXRpb25GaWxlIGFzIFRGaWxlLCBkb2NUb1JlbW92ZSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEdldCB2aXN1YWwgaW5kaWNhdG9ycyBmb3IgY29udGV4dCBzdGF0ZVxuXHQgKi9cblx0Z2V0Q29udGV4dEluZGljYXRvcnMoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KToge1xuXHRcdHRleHQ6IHN0cmluZztcblx0XHRjbGFzc05hbWU6IHN0cmluZztcblx0XHR0b29sdGlwOiBzdHJpbmc7XG5cdH0ge1xuXHRcdGNvbnN0IGRvY0NvdW50ID0gY29udGV4dC5wZXJzaXN0ZW50RG9jcy5sZW5ndGg7XG5cdFx0XG5cdFx0bGV0IGNsYXNzTmFtZSA9ICdub3ZhLWNvbnRleHQtaW5kaWNhdG9yJztcblx0XHRsZXQgdG9vbHRpcCA9IGBDb250ZXh0OiAke2RvY0NvdW50fSBkb2N1bWVudCR7ZG9jQ291bnQgIT09IDEgPyAncycgOiAnJ30sIH4ke2NvbnRleHQudG9rZW5Db3VudH0gdG9rZW5zIChmaWxlcyBvbmx5KWA7XG5cdFx0XG5cdFx0Y29uc3QgdGV4dCA9IGAke2RvY0NvdW50fSBkb2NzYDtcblx0XHRcblx0XHRyZXR1cm4geyB0ZXh0LCBjbGFzc05hbWUsIHRvb2x0aXAgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGb3JtYXQgY29udGV4dCBmb3IgZGlzcGxheSBpbiBVSVxuXHQgKi9cblx0Zm9ybWF0Q29udGV4dEZvckRpc3BsYXkoY29udGV4dDogTXVsdGlEb2NDb250ZXh0KTogc3RyaW5nW10ge1xuXHRcdGNvbnN0IGl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFxuXHRcdC8vIEFkZCBwZXJzaXN0ZW50IGRvY3VtZW50c1xuXHRcdGZvciAoY29uc3QgZG9jIG9mIGNvbnRleHQucGVyc2lzdGVudERvY3MpIHtcblx0XHRcdGl0ZW1zLnB1c2goYCR7ZG9jLmZpbGUuYmFzZW5hbWV9JHtkb2MucHJvcGVydHkgPyBgIyR7ZG9jLnByb3BlcnR5fWAgOiAnJ31gKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGl0ZW1zO1xuXHR9XG59IiwgImV4cG9ydCBpbnRlcmZhY2UgQ29udGV4dExpbWl0IHtcbiAgICB0b2tlbnM6IG51bWJlcjtcbiAgICBmYWxsYmFjaz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmlkZXJDb250ZXh0TGltaXRzIHtcbiAgICBbbW9kZWxOYW1lOiBzdHJpbmddOiBDb250ZXh0TGltaXQ7XG59XG5cbi8vIENvbnRleHQgd2luZG93IGxpbWl0cyBmb3IgYWxsIHN1cHBvcnRlZCBwcm92aWRlcnNcbmNvbnN0IENMT1VEX1BST1ZJREVSX0xJTUlUUzogUmVjb3JkPHN0cmluZywgUHJvdmlkZXJDb250ZXh0TGltaXRzPiA9IHtcbiAgICBjbGF1ZGU6IHtcbiAgICAgICAgLy8gQ2xhdWRlIG1vZGVscyAtIGFsbCBjdXJyZW50IHZlcnNpb25zIGhhdmUgMjAwayB0b2tlbnNcbiAgICAgICAgJ2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtc29ubmV0LTQtMjAyNTA1MTQnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtMy03LXNvbm5ldC1sYXRlc3QnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtMy01LXNvbm5ldC1sYXRlc3QnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCc6IHsgdG9rZW5zOiAyMDAwMDAgfSxcbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIGFueSBDbGF1ZGUgbW9kZWxcbiAgICAgICAgJ2RlZmF1bHQnOiB7IHRva2VuczogMjAwMDAwLCBmYWxsYmFjazogdHJ1ZSB9XG4gICAgfSxcbiAgICBcbiAgICBvcGVuYWk6IHtcbiAgICAgICAgLy8gR1BULTQuMSBtb2RlbHMgXG4gICAgICAgICdncHQtNC4xLTIwMjUtMDQtMTQnOiB7IHRva2VuczogMTA0NzU3NiB9LFxuICAgICAgICAnZ3B0LTQuMS1taW5pLTIwMjUtMDQtMTQnOiB7IHRva2VuczogMTA0NzU3NiB9LFxuICAgICAgICAnZ3B0LTQuMS1uYW5vLTIwMjUtMDQtMTQnOiB7IHRva2VuczogMTA0NzU3NiB9LFxuXG4gICAgICAgIC8vIG80IG1vZGVscyBcbiAgICAgICAgJ280LW1pbmktMjAyNS0wNC0xNic6IHsgdG9rZW5zOiAyMDAwMDAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIG8zIG1vZGVscyBcbiAgICAgICAgJ28zLTIwMjUtMDQtMTYnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgICdvMy1taW5pLTIwMjUtMDEtMzEnOiB7IHRva2VuczogMjAwMDAwIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBvMSBtb2RlbHMgXG4gICAgICAgICdvMS0yMDI0LTEyLTE3JzogeyB0b2tlbnM6IDEyODAwMCB9LFxuICAgICAgXG4gICAgICAgIC8vIEdQVC00byBtb2RlbHMgXG4gICAgICAgICdncHQtNG8nOiB7IHRva2VuczogMTI4MDAwIH0sXG4gICAgICAgICdncHQtNG8tbWluaSc6IHsgdG9rZW5zOiAxMjgwMDAgfSxcbiAgICBcbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIE9wZW5BSSBtb2RlbHMgLSBhc3N1bWUgR1BULTRvIGNhcGFjaXR5XG4gICAgICAgICdkZWZhdWx0JzogeyB0b2tlbnM6IDEyODAwMCwgZmFsbGJhY2s6IHRydWUgfVxuICAgIH0sXG4gICAgXG4gICAgZ29vZ2xlOiB7XG4gICAgICAgIC8vIEdlbWluaSAyLjUgbW9kZWxzIC0gMU0gdG9rZW5zXG4gICAgICAgICdnZW1pbmktMi41LXBybyc6IHsgdG9rZW5zOiAxMDQ4NTc2IH0sXG4gICAgICAgICdnZW1pbmktMi41LWZsYXNoJzogeyB0b2tlbnM6IDEwNDg1NzYgfSxcbiAgICAgICAgJ2dlbWluaS0yLjUtZmxhc2gtbGl0ZS1wcmV2aWV3LTA2LTE3JzogeyB0b2tlbnM6IDEwMDAwMDAgfSxcbiAgICAgICAgICAgXG4gICAgICAgIC8vIEZhbGxiYWNrIGZvciBHb29nbGUgbW9kZWxzIC0gYXNzdW1lIG1vZGVybiBHZW1pbmkgY2FwYWNpdHlcbiAgICAgICAgJ2RlZmF1bHQnOiB7IHRva2VuczogMTAwMDAwMCwgZmFsbGJhY2s6IHRydWUgfVxuICAgIH1cbn07XG5cbi8vIERlZmF1bHQgY29udGV4dCB3aW5kb3cgZm9yIE9sbGFtYSB3aGVuIG5vdCBjb25maWd1cmVkIGJ5IHVzZXJcbmV4cG9ydCBjb25zdCBPTExBTUFfREVGQVVMVF9DT05URVhUID0gMzIwMDA7XG5cbi8qKlxuICogR2V0IGNvbnRleHQgd2luZG93IGxpbWl0IGZvciBhIHNwZWNpZmljIHByb3ZpZGVyIGFuZCBtb2RlbFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29udGV4dExpbWl0KHByb3ZpZGVyOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IHByb3ZpZGVyTGltaXRzID0gQ0xPVURfUFJPVklERVJfTElNSVRTW3Byb3ZpZGVyLnRvTG93ZXJDYXNlKCldO1xuICAgIGlmICghcHJvdmlkZXJMaW1pdHMpIHtcbiAgICAgICAgLy8gVW5rbm93biBwcm92aWRlciBmYWxsYmFja1xuICAgICAgICByZXR1cm4gMzIwMDA7XG4gICAgfVxuICAgIFxuICAgIC8vIFRyeSBleGFjdCBtb2RlbCBtYXRjaCBmaXJzdFxuICAgIGNvbnN0IG1vZGVsTGltaXQgPSBwcm92aWRlckxpbWl0c1ttb2RlbF07XG4gICAgaWYgKG1vZGVsTGltaXQpIHtcbiAgICAgICAgcmV0dXJuIG1vZGVsTGltaXQudG9rZW5zO1xuICAgIH1cbiAgICBcbiAgICAvLyBGYWxsIGJhY2sgdG8gcHJvdmlkZXIgZGVmYXVsdFxuICAgIGNvbnN0IGRlZmF1bHRMaW1pdCA9IHByb3ZpZGVyTGltaXRzWydkZWZhdWx0J107XG4gICAgaWYgKGRlZmF1bHRMaW1pdCkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdExpbWl0LnRva2VucztcbiAgICB9XG4gICAgXG4gICAgLy8gRmluYWwgZmFsbGJhY2tcbiAgICByZXR1cm4gMzIwMDA7XG59XG5cblxuLyoqXG4gKiBHZXQgYWxsIGNvbnRleHQgbGltaXRzIGZvciBhIHByb3ZpZGVyIChmb3IgVUkgZGlzcGxheSlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3ZpZGVyQ29udGV4dExpbWl0cyhwcm92aWRlcjogc3RyaW5nKTogUHJvdmlkZXJDb250ZXh0TGltaXRzIHtcbiAgICByZXR1cm4gQ0xPVURfUFJPVklERVJfTElNSVRTW3Byb3ZpZGVyLnRvTG93ZXJDYXNlKCldIHx8IHt9O1xufVxuXG4vKipcbiAqIENoZWNrIGlmIGEgbW9kZWwgaGFzIGEga25vd24gY29udGV4dCBsaW1pdFxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzS25vd25Db250ZXh0TGltaXQocHJvdmlkZXI6IHN0cmluZywgbW9kZWw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHByb3ZpZGVyTGltaXRzID0gQ0xPVURfUFJPVklERVJfTElNSVRTW3Byb3ZpZGVyLnRvTG93ZXJDYXNlKCldO1xuICAgIGlmICghcHJvdmlkZXJMaW1pdHMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gISFwcm92aWRlckxpbWl0c1ttb2RlbF0gJiYgIXByb3ZpZGVyTGltaXRzW21vZGVsXS5mYWxsYmFjaztcbn0iLCAiaW1wb3J0IHsgZ2V0Q29udGV4dExpbWl0IH0gZnJvbSAnLi4vYWkvY29udGV4dC1saW1pdHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbnRleHRVc2FnZSB7XG4gICAgdG90YWxUb2tlbnM6IG51bWJlcjtcbiAgICBjb250ZXh0TGltaXQ6IG51bWJlcjtcbiAgICB1c2FnZVBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgICBicmVha2Rvd246IHtcbiAgICAgICAgY29udmVyc2F0aW9uSGlzdG9yeTogbnVtYmVyO1xuICAgICAgICBmaWxlQXR0YWNobWVudHM6IG51bWJlcjtcbiAgICAgICAgY3VycmVudElucHV0OiBudW1iZXI7XG4gICAgICAgIHJlY2VudFJlc3BvbnNlOiBudW1iZXI7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBDaGFyYWN0ZXItYmFzZWQgdG9rZW4gZXN0aW1hdGlvbiAoMSB0b2tlbiBcdTIyNDggNCBjaGFyYWN0ZXJzKVxuICogTW9yZSBhY2N1cmF0ZSB0aGFuIHdvcmQtYmFzZWQgZm9yIGNvZGUvdGVjaG5pY2FsIGNvbnRlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVzdGltYXRlVG9rZW5zKHRleHQ6IHN0cmluZyk6IG51bWJlciB7XG4gICAgaWYgKCF0ZXh0KSByZXR1cm4gMDtcbiAgICByZXR1cm4gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHRvdGFsIGNvbnRleHQgdXNhZ2UgYWNyb3NzIGFsbCBzb3VyY2VzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVDb250ZXh0VXNhZ2UoXG4gICAgcHJvdmlkZXI6IHN0cmluZyxcbiAgICBtb2RlbDogc3RyaW5nLFxuICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IEFycmF5PHtjb250ZW50OiBzdHJpbmd9PiA9IFtdLFxuICAgIGZpbGVBdHRhY2htZW50czogQXJyYXk8e2NvbnRlbnQ6IHN0cmluZ30+ID0gW10sXG4gICAgY3VycmVudElucHV0OiBzdHJpbmcgPSAnJyxcbiAgICByZWNlbnRSZXNwb25zZTogc3RyaW5nID0gJycsXG4gICAgb2xsYW1hRGVmYXVsdENvbnRleHQ6IG51bWJlciA9IDMyMDAwXG4pOiBDb250ZXh0VXNhZ2Uge1xuICAgIC8vIEdldCBjb250ZXh0IGxpbWl0IGZvciB0aGUgcHJvdmlkZXIvbW9kZWxcbiAgICBsZXQgY29udGV4dExpbWl0OiBudW1iZXI7XG4gICAgaWYgKHByb3ZpZGVyLnRvTG93ZXJDYXNlKCkgPT09ICdvbGxhbWEnKSB7XG4gICAgICAgIGNvbnRleHRMaW1pdCA9IG9sbGFtYURlZmF1bHRDb250ZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRleHRMaW1pdCA9IGdldENvbnRleHRMaW1pdChwcm92aWRlciwgbW9kZWwpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgdG9rZW5zIGZvciBlYWNoIGNvbnRleHQgY29tcG9uZW50XG4gICAgY29uc3QgY29udmVyc2F0aW9uVG9rZW5zID0gY29udmVyc2F0aW9uSGlzdG9yeS5yZWR1Y2UoKHRvdGFsLCBtc2cpID0+IHtcbiAgICAgICAgcmV0dXJuIHRvdGFsICsgZXN0aW1hdGVUb2tlbnMobXNnLmNvbnRlbnQpO1xuICAgIH0sIDApO1xuICAgIFxuICAgIGNvbnN0IGZpbGVUb2tlbnMgPSBmaWxlQXR0YWNobWVudHMucmVkdWNlKCh0b3RhbCwgZmlsZSkgPT4ge1xuICAgICAgICByZXR1cm4gdG90YWwgKyBlc3RpbWF0ZVRva2VucyhmaWxlLmNvbnRlbnQpO1xuICAgIH0sIDApO1xuICAgIFxuICAgIGNvbnN0IGlucHV0VG9rZW5zID0gZXN0aW1hdGVUb2tlbnMoY3VycmVudElucHV0KTtcbiAgICBjb25zdCByZXNwb25zZVRva2VucyA9IGVzdGltYXRlVG9rZW5zKHJlY2VudFJlc3BvbnNlKTtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgdG90YWwgdXNhZ2VcbiAgICBjb25zdCB0b3RhbFRva2VucyA9IGNvbnZlcnNhdGlvblRva2VucyArIGZpbGVUb2tlbnMgKyBpbnB1dFRva2VucyArIHJlc3BvbnNlVG9rZW5zO1xuICAgIGNvbnN0IHVzYWdlUGVyY2VudGFnZSA9IE1hdGgucm91bmQoKHRvdGFsVG9rZW5zIC8gY29udGV4dExpbWl0KSAqIDEwMCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdG90YWxUb2tlbnMsXG4gICAgICAgIGNvbnRleHRMaW1pdCxcbiAgICAgICAgdXNhZ2VQZXJjZW50YWdlLFxuICAgICAgICBicmVha2Rvd246IHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IGNvbnZlcnNhdGlvblRva2VucyxcbiAgICAgICAgICAgIGZpbGVBdHRhY2htZW50czogZmlsZVRva2VucyxcbiAgICAgICAgICAgIGN1cnJlbnRJbnB1dDogaW5wdXRUb2tlbnMsXG4gICAgICAgICAgICByZWNlbnRSZXNwb25zZTogcmVzcG9uc2VUb2tlbnNcbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8qKlxuICogR2V0IHJlbWFpbmluZyBjb250ZXh0IHBlcmNlbnRhZ2UgZm9yIGRpc3BsYXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlbWFpbmluZ0NvbnRleHRQZXJjZW50YWdlKHVzYWdlOiBDb250ZXh0VXNhZ2UpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLm1heCgwLCAxMDAgLSB1c2FnZS51c2FnZVBlcmNlbnRhZ2UpO1xufVxuXG4vKipcbiAqIENoZWNrIGlmIGNvbnRleHQgdXNhZ2UgaXMgaW4gd2FybmluZyB0ZXJyaXRvcnlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnRleHRXYXJuaW5nTGV2ZWwodXNhZ2U6IENvbnRleHRVc2FnZSk6ICdzYWZlJyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCcge1xuICAgIGNvbnN0IHJlbWFpbmluZ1BlcmNlbnRhZ2UgPSBnZXRSZW1haW5pbmdDb250ZXh0UGVyY2VudGFnZSh1c2FnZSk7XG4gICAgXG4gICAgaWYgKHJlbWFpbmluZ1BlcmNlbnRhZ2UgPD0gNSkge1xuICAgICAgICByZXR1cm4gJ2NyaXRpY2FsJztcbiAgICB9IGVsc2UgaWYgKHJlbWFpbmluZ1BlcmNlbnRhZ2UgPD0gMTUpIHtcbiAgICAgICAgcmV0dXJuICd3YXJuaW5nJztcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3NhZmUnO1xuICAgIH1cbn1cblxuLyoqXG4gKiBHZXQgZm9ybWF0dGVkIGNvbnRleHQgdXNhZ2Ugc3RyaW5nIGZvciBkaXNwbGF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRDb250ZXh0VXNhZ2UodXNhZ2U6IENvbnRleHRVc2FnZSk6IHN0cmluZyB7XG4gICAgY29uc3QgcmVtYWluaW5nUGVyY2VudGFnZSA9IGdldFJlbWFpbmluZ0NvbnRleHRQZXJjZW50YWdlKHVzYWdlKTtcbiAgICBjb25zdCB3YXJuaW5nTGV2ZWwgPSBnZXRDb250ZXh0V2FybmluZ0xldmVsKHVzYWdlKTtcbiAgICBcbiAgICBpZiAod2FybmluZ0xldmVsID09PSAnY3JpdGljYWwnKSB7XG4gICAgICAgIHJldHVybiBgJHtyZW1haW5pbmdQZXJjZW50YWdlfSUgbGVmdCFgO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgJHtyZW1haW5pbmdQZXJjZW50YWdlfSUgbGVmdGA7XG4gICAgfVxufVxuXG4vKipcbiAqIEdldCBkZXRhaWxlZCB0b29sdGlwIGNvbnRlbnQgZm9yIGNvbnRleHQgdXNhZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnRleHRUb29sdGlwKHVzYWdlOiBDb250ZXh0VXNhZ2UpOiBzdHJpbmcge1xuICAgIGNvbnN0IHsgdG90YWxUb2tlbnMsIGNvbnRleHRMaW1pdCwgYnJlYWtkb3duIH0gPSB1c2FnZTtcbiAgICBjb25zdCByZW1haW5pbmdUb2tlbnMgPSBjb250ZXh0TGltaXQgLSB0b3RhbFRva2VucztcbiAgICBcbiAgICBjb25zdCBsaW5lcyA9IFtcbiAgICAgICAgYENvbnRleHQgVXNhZ2U6ICR7dG90YWxUb2tlbnMudG9Mb2NhbGVTdHJpbmcoKX0gLyAke2NvbnRleHRMaW1pdC50b0xvY2FsZVN0cmluZygpfSB0b2tlbnNgLFxuICAgICAgICBgUmVtYWluaW5nOiAke3JlbWFpbmluZ1Rva2Vucy50b0xvY2FsZVN0cmluZygpfSB0b2tlbnNgLFxuICAgICAgICAnJyxcbiAgICAgICAgJ0JyZWFrZG93bjonXG4gICAgXTtcbiAgICBcbiAgICBpZiAoYnJlYWtkb3duLmNvbnZlcnNhdGlvbkhpc3RvcnkgPiAwKSB7XG4gICAgICAgIGxpbmVzLnB1c2goYFx1MjAyMiBDb252ZXJzYXRpb246ICR7YnJlYWtkb3duLmNvbnZlcnNhdGlvbkhpc3RvcnkudG9Mb2NhbGVTdHJpbmcoKX0gdG9rZW5zYCk7XG4gICAgfVxuICAgIFxuICAgIGlmIChicmVha2Rvd24uZmlsZUF0dGFjaG1lbnRzID4gMCkge1xuICAgICAgICBsaW5lcy5wdXNoKGBcdTIwMjIgRmlsZSBjb250ZXh0OiAke2JyZWFrZG93bi5maWxlQXR0YWNobWVudHMudG9Mb2NhbGVTdHJpbmcoKX0gdG9rZW5zYCk7XG4gICAgfVxuICAgIFxuICAgIGlmIChicmVha2Rvd24uY3VycmVudElucHV0ID4gMCkge1xuICAgICAgICBsaW5lcy5wdXNoKGBcdTIwMjIgQ3VycmVudCBpbnB1dDogJHticmVha2Rvd24uY3VycmVudElucHV0LnRvTG9jYWxlU3RyaW5nKCl9IHRva2Vuc2ApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoYnJlYWtkb3duLnJlY2VudFJlc3BvbnNlID4gMCkge1xuICAgICAgICBsaW5lcy5wdXNoKGBcdTIwMjIgUmVjZW50IHJlc3BvbnNlOiAke2JyZWFrZG93bi5yZWNlbnRSZXNwb25zZS50b0xvY2FsZVN0cmluZygpfSB0b2tlbnNgKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBOb3ZhUGx1Z2luIGZyb20gJy4uLy4uL21haW4nO1xuXG4vKipcbiAqIE1lc3NhZ2Ugb3B0aW9ucyBmb3IgdW5pZmllZCBtZXNzYWdlIGNyZWF0aW9uXG4gKi9cbmludGVyZmFjZSBNZXNzYWdlT3B0aW9ucyB7XG5cdHR5cGU6ICdwaWxsJyB8ICdidWJibGUnO1xuXHR2YXJpYW50OiAnc3VjY2VzcycgfCAnZXJyb3InIHwgJ3dhcm5pbmcnIHwgJ3N5c3RlbScgfCAndXNlcicgfCAnYXNzaXN0YW50Jztcblx0cGVyc2lzdD86IGJvb2xlYW47IC8vIFdoZXRoZXIgdG8gc2F2ZSB0byBjb252ZXJzYXRpb24gbWFuYWdlclxufVxuXG4vKipcbiAqIEhhbmRsZXMgYWxsIGNoYXQgbWVzc2FnZSByZW5kZXJpbmcgYW5kIGRpc3BsYXkgbG9naWNcbiAqL1xuZXhwb3J0IGNsYXNzIENoYXRSZW5kZXJlciB7XG5cdHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luO1xuXHRwcml2YXRlIGNoYXRDb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHN0YXRpYyByZWFkb25seSBTQ1JPTExfREVMQVlfTVMgPSA1MDtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE5vdmFQbHVnaW4sIGNoYXRDb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jaGF0Q29udGFpbmVyID0gY2hhdENvbnRhaW5lcjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgYSBjaGF0IG1lc3NhZ2Ugd2l0aCByb2xlIGhlYWRlclxuXHQgKi9cblx0YWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nLCBjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcblx0XHRcblx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBgbm92YS1tZXNzYWdlIG5vdmEtbWVzc2FnZS0ke3JvbGV9YCB9KTtcblx0XHRtZXNzYWdlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0yKTtcblx0XHRcdHBhZGRpbmc6IHZhcigtLXNpemUtMi0zKSB2YXIoLS1zaXplLTQtMyk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRtYXgtd2lkdGg6IDg1JTtcblx0XHRcdCR7cm9sZSA9PT0gJ3VzZXInIFxuXHRcdFx0XHQ/ICdtYXJnaW4tbGVmdDogYXV0bzsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTsnIFxuXHRcdFx0XHQ6IHJvbGUgPT09ICdzeXN0ZW0nXG5cdFx0XHRcdD8gJ21hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbCk7J1xuXHRcdFx0XHQ6ICdiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7J1xuXHRcdFx0fVxuXHRcdGA7XG5cblx0XHRjb25zdCByb2xlRWwgPSBtZXNzYWdlRWwuY3JlYXRlRWwoJ2RpdicsIHsgXG5cdFx0XHR0ZXh0OiByb2xlID09PSAndXNlcicgPyAnWW91JyA6IHJvbGUgPT09ICdzeXN0ZW0nID8gJ1N5c3RlbScgOiAnTm92YScsXG5cdFx0XHRjbHM6ICdub3ZhLW1lc3NhZ2Utcm9sZSdcblx0XHR9KTtcblx0XHRyb2xlRWwuc3R5bGUuY3NzVGV4dCA9IGBcblx0XHRcdGZvbnQtc2l6ZTogdmFyKC0tZm9udC11aS1zbWFsbGVyKTtcblx0XHRcdG9wYWNpdHk6IDAuNztcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtMi0xKTtcblx0XHRcdGZvbnQtd2VpZ2h0OiA2MDA7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnRFbCA9IG1lc3NhZ2VFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdub3ZhLW1lc3NhZ2UtY29udGVudCcgfSk7XG5cdFx0Ly8gVXNlIGlubmVySFRNTCBmb3Igc3lzdGVtIG1lc3NhZ2VzIHRvIHN1cHBvcnQgaWNvbnMsIHRleHRDb250ZW50IGZvciBvdGhlcnMgZm9yIHNlY3VyaXR5XG5cdFx0aWYgKHJvbGUgPT09ICdzeXN0ZW0nICYmIGNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRlbnRFbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0dGhpcy5zY3JvbGxUb0JvdHRvbSh0cnVlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVbmlmaWVkIG1lc3NhZ2UgY3JlYXRpb24gLSBkZXRlcm1pbmVzIENTUyBjbGFzcyBhdCBjcmVhdGlvbiB0aW1lXG5cdCAqL1xuXHRhZGRTdGF0dXNNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgb3B0aW9uczogTWVzc2FnZU9wdGlvbnMpOiB2b2lkIHtcblx0XHQvLyBEZXRlcm1pbmUgQ1NTIGNsYXNzIGJhc2VkIG9uIHR5cGUgYW5kIHZhcmlhbnRcblx0XHRjb25zdCBjc3NDbGFzcyA9IHRoaXMuZ2V0TWVzc2FnZUNTU0NsYXNzKGNvbnRlbnQsIG9wdGlvbnMpO1xuXHRcdFxuXHRcdC8vIENyZWF0ZSBtZXNzYWdlIGVsZW1lbnQgd2l0aCBzdGF0aWMgQ1NTIGNsYXNzXG5cdFx0Y29uc3QgbWVzc2FnZUVsID0gdGhpcy5jaGF0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYG5vdmEtbWVzc2FnZSAke2Nzc0NsYXNzfWAgfSk7XG5cdFx0Y29uc3QgY29udGVudEVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtbWVzc2FnZS1jb250ZW50JyB9KTtcblx0XHRcblx0XHRpZiAoY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50RWwuaW5uZXJIVE1MID0gY29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gY29udGVudDtcblx0XHR9XG5cblx0XHQvLyBTYXZlIHRvIGNvbnZlcnNhdGlvbiBtYW5hZ2VyIGlmIHJlcXVlc3RlZFxuXHRcdGlmIChvcHRpb25zLnBlcnNpc3QpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLmNvbnZlcnNhdGlvbk1hbmFnZXIuYWRkU3lzdGVtTWVzc2FnZShcblx0XHRcdFx0XHRhY3RpdmVGaWxlLCBcblx0XHRcdFx0XHRjb250ZW50LFxuXHRcdFx0XHRcdHsgbWVzc2FnZVR5cGU6IGNzc0NsYXNzIH0gLy8gU3RvcmUgQ1NTIGNsYXNzIGFzIG1ldGFkYXRhXG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5zY3JvbGxUb0JvdHRvbSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRNZXNzYWdlQ1NTQ2xhc3MoY29udGVudDogc3RyaW5nLCBvcHRpb25zOiBNZXNzYWdlT3B0aW9ucyk6IHN0cmluZyB7XG5cdFx0aWYgKG9wdGlvbnMudHlwZSA9PT0gJ3BpbGwnKSB7XG5cdFx0XHRyZXR1cm4gYG5vdmEtcGlsbC0ke29wdGlvbnMudmFyaWFudH1gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gYG5vdmEtYnViYmxlLSR7b3B0aW9ucy52YXJpYW50fWA7XG5cdFx0fVxuXHR9XG5cblx0Ly8gU2ltcGxlIHdyYXBwZXIgbWV0aG9kcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXHRhZGRTdWNjZXNzTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIHBlcnNpc3Q6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuXHRcdC8vIEF1dG8tcHJlcGVuZCBjaGVja21hcmsgaWYgbm90IGFscmVhZHkgcHJlc2VudFxuXHRcdGlmICghY29udGVudC5zdGFydHNXaXRoKCdcdTI3MTMgJykgJiYgIWNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0Y29udGVudCA9ICdcdTI3MTMgJyArIGNvbnRlbnQ7XG5cdFx0fVxuXHRcdC8vIEFsd2F5cyB1c2UgcGlsbHMgZm9yIHN1Y2Nlc3MgbWVzc2FnZXMgdG8gbWFpbnRhaW4gY29uc2lzdGVuY3lcblx0XHR0aGlzLmFkZFN0YXR1c01lc3NhZ2UoY29udGVudCwgeyB0eXBlOiAncGlsbCcsIHZhcmlhbnQ6ICdzdWNjZXNzJywgcGVyc2lzdCB9KTtcblx0fVxuXG5cdGFkZEVycm9yTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIHBlcnNpc3Q6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuXHRcdC8vIEF1dG8tcHJlcGVuZCBYIGlmIG5vdCBhbHJlYWR5IHByZXNlbnRcblx0XHRpZiAoIWNvbnRlbnQuc3RhcnRzV2l0aCgnXHUyNzRDICcpICYmICFjb250ZW50LmluY2x1ZGVzKCc8c3ZnJykpIHtcblx0XHRcdGNvbnRlbnQgPSAnXHUyNzRDICcgKyBjb250ZW50O1xuXHRcdH1cblx0XHRjb25zdCB0eXBlID0gY29udGVudC5sZW5ndGggPD0gMzAgPyAncGlsbCcgOiAnYnViYmxlJztcblx0XHR0aGlzLmFkZFN0YXR1c01lc3NhZ2UoY29udGVudCwgeyB0eXBlLCB2YXJpYW50OiAnZXJyb3InLCBwZXJzaXN0IH0pO1xuXHR9XG5cblx0YWRkV2FybmluZ01lc3NhZ2UoY29udGVudDogc3RyaW5nLCBwZXJzaXN0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcblx0XHQvLyBBdXRvLXByZXBlbmQgd2FybmluZyBpZiBub3QgYWxyZWFkeSBwcmVzZW50XG5cdFx0aWYgKCFjb250ZW50LnN0YXJ0c1dpdGgoJ1x1MjZBMFx1RkUwRiAnKSAmJiAhY29udGVudC5pbmNsdWRlcygnPHN2ZycpKSB7XG5cdFx0XHRjb250ZW50ID0gJ1x1MjZBMFx1RkUwRiAnICsgY29udGVudDtcblx0XHR9XG5cdFx0Y29uc3QgdHlwZSA9IGNvbnRlbnQubGVuZ3RoIDw9IDMwID8gJ3BpbGwnIDogJ2J1YmJsZSc7XG5cdFx0dGhpcy5hZGRTdGF0dXNNZXNzYWdlKGNvbnRlbnQsIHsgdHlwZSwgdmFyaWFudDogJ3dhcm5pbmcnLCBwZXJzaXN0IH0pO1xuXHR9XG5cblx0YWRkV2VsY29tZU1lc3NhZ2UobWVzc2FnZT86IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IHdlbGNvbWVFbCA9IHRoaXMuY2hhdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdub3ZhLXdlbGNvbWUnIH0pO1xuXHRcdHdlbGNvbWVFbC5zdHlsZS5jc3NUZXh0ID0gYFxuXHRcdFx0cGFkZGluZzogMjBweDtcblx0XHRcdG1hcmdpbi1ib3R0b206IHZhcigtLXNpemUtNC0zKTtcblx0XHRcdGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdFx0XHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdFx0XHRib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0YDtcblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBtZXNzYWdlIHx8IGBcblx0XHRcdDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPlxuXHRcdFx0XHQ8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBzdHlsZT1cIndpZHRoOiAzMnB4OyBoZWlnaHQ6IDMycHg7IGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBtYXJnaW4tYm90dG9tOiB2YXIoLS1zaXplLTQtMik7XCI+XG5cdFx0XHRcdFx0PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIyLjVcIiBmaWxsPVwiY3VycmVudENvbG9yXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTIgMUwxMiA2XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiM1wiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk0xMiAxOEwxMiAyM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMjMgMTJMMTggMTJcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIzXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTYgMTJMMSAxMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjNcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIvPlxuXHRcdFx0XHRcdDxwYXRoIGQ9XCJNMTguMzY0IDUuNjM2TDE1LjUzNiA4LjQ2NFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCAxNS41MzZMNS42MzYgMTguMzY0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMi41XCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiLz5cblx0XHRcdFx0XHQ8cGF0aCBkPVwiTTE4LjM2NCAxOC4zNjRMMTUuNTM2IDE1LjUzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdFx0PHBhdGggZD1cIk04LjQ2NCA4LjQ2NEw1LjYzNiA1LjYzNlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjIuNVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIi8+XG5cdFx0XHRcdDwvc3ZnPlxuXHRcdFx0XHQ8cCBzdHlsZT1cIm1hcmdpbjogMDsgbWFyZ2luLWxlZnQ6IHZhcigtLXNpemUtMi0zKTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBmb250LXNpemU6IHZhcigtLWZvbnQtdWktbWVkaXVtKTsgbGluZS1oZWlnaHQ6IDEuNDsgdGV4dC1hbGlnbjogbGVmdDsgYWxpZ24tc2VsZjogZmxleC1zdGFydDtcIj5cblx0XHRcdFx0XHRJJ20geW91ciBBSSB3cml0aW5nIHBhcnRuZXIuIFNlbGVjdCB0ZXh0IGFuZCByaWdodC1jbGljayBmb3IgaW5zdGFudCBlZGl0aW5nLCBvciBjaGF0IGZvciBjdXJzb3ItcHJlY2lzZSBjb21tYW5kcy5cblx0XHRcdFx0PC9wPlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuXHRcdHdlbGNvbWVFbC5pbm5lckhUTUwgPSBjb250ZW50O1xuXG5cdFx0dGhpcy5zY3JvbGxUb0JvdHRvbSh0cnVlKTtcblx0fVxuXG5cblx0Y2xlYXJDaGF0KCk6IHZvaWQge1xuXHRcdHRoaXMuY2hhdENvbnRhaW5lci5lbXB0eSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBzY3JvbGxUb0JvdHRvbShzbW9vdGg6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHNtb290aCkge1xuXHRcdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG8oe1xuXHRcdFx0XHRcdHRvcDogdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodCxcblx0XHRcdFx0XHRiZWhhdmlvcjogJ3Ntb290aCdcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNoYXRDb250YWluZXIuc2Nyb2xsVG9wID0gdGhpcy5jaGF0Q29udGFpbmVyLnNjcm9sbEhlaWdodDtcblx0XHRcdH1cblx0XHR9LCBDaGF0UmVuZGVyZXIuU0NST0xMX0RFTEFZX01TKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRDb252ZXJzYXRpb25IaXN0b3J5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnBsdWdpbi5jb252ZXJzYXRpb25NYW5hZ2VyLmdldFJlY2VudE1lc3NhZ2VzKGZpbGUsIDUwKTtcblx0XHRcblx0XHRpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHQvLyBObyBjb252ZXJzYXRpb24gZXhpc3RzIC0gc2hvdyB3ZWxjb21lIG1lc3NhZ2Vcblx0XHRcdHRoaXMuYWRkV2VsY29tZU1lc3NhZ2UoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBtZXNzYWdlIG9mIG1lc3NhZ2VzKSB7XG5cdFx0XHRpZiAobWVzc2FnZS5yb2xlID09PSAnc3lzdGVtJyAmJiBtZXNzYWdlLm1ldGFkYXRhPy5tZXNzYWdlVHlwZSkge1xuXHRcdFx0XHQvLyBSZXN0b3JlIHN5c3RlbSBtZXNzYWdlIHdpdGggb3JpZ2luYWwgc3R5bGluZ1xuXHRcdFx0XHRjb25zdCBtZXNzYWdlRWwgPSB0aGlzLmNoYXRDb250YWluZXIuY3JlYXRlRGl2KHsgXG5cdFx0XHRcdFx0Y2xzOiBgbm92YS1tZXNzYWdlICR7bWVzc2FnZS5tZXRhZGF0YS5tZXNzYWdlVHlwZX1gIFxuXHRcdFx0XHR9KTtcblx0XHRcdFx0Y29uc3QgY29udGVudEVsID0gbWVzc2FnZUVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ25vdmEtbWVzc2FnZS1jb250ZW50JyB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChtZXNzYWdlLmNvbnRlbnQuaW5jbHVkZXMoJzxzdmcnKSkge1xuXHRcdFx0XHRcdGNvbnRlbnRFbC5pbm5lckhUTUwgPSBtZXNzYWdlLmNvbnRlbnQ7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gbWVzc2FnZS5jb250ZW50O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBSZWd1bGFyIHVzZXIvYXNzaXN0YW50IG1lc3NhZ2VzXG5cdFx0XHRcdHRoaXMuYWRkTWVzc2FnZShtZXNzYWdlLnJvbGUgYXMgJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJywgbWVzc2FnZS5jb250ZW50KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5zY3JvbGxUb0JvdHRvbSgpO1xuXHR9XG59IiwgIi8qKlxuICogVW5pZmllZCBzdHJlYW1pbmcgYW5kIG5vdGljZSBtYW5hZ2VtZW50IGZvciBOb3ZhXG4gKiBQcm92aWRlcyBjb25zaXN0ZW50IHZpc3VhbCBmZWVkYmFjayBhbmQgc3RyZWFtaW5nIGFjcm9zcyBhbGwgY29tbWFuZCB0eXBlc1xuICovXG5cbmltcG9ydCB7IEVkaXRvciwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0cmVhbWluZ09wdGlvbnMge1xuICAgIG9uQ2h1bms/OiAoY2h1bms6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4gdm9pZDtcbiAgICBvbkNvbXBsZXRlPzogKCkgPT4gdm9pZDtcbiAgICBvbkVycm9yPzogKGVycm9yOiBFcnJvcikgPT4gdm9pZDtcbiAgICBhbmltYXRpb25Nb2RlPzogJ25vdGljZScgfCAnaW5saW5lJzsgLy8gQ29udHJvbHMgd2hldGhlciB0byB1c2UgTm90aWNlIGFuaW1hdGlvbnMgb3IgaW5saW5lXG59XG5cbmV4cG9ydCB0eXBlIEFjdGlvblR5cGUgPSAnaW1wcm92ZScgfCAnbG9uZ2VyJyB8ICdzaG9ydGVyJyB8ICd0b25lJyB8ICdjdXN0b20nIHwgJ2NoYXQnIHwgJ2FkZCcgfCAnZWRpdCcgfCAncmV3cml0ZScgfCAnZ3JhbW1hcicgfCAnZGVsZXRlJztcblxuZXhwb3J0IGNsYXNzIFN0cmVhbWluZ01hbmFnZXIge1xuICAgIHByaXZhdGUgZG90c0FuaW1hdGlvbkludGVydmFsOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgdGhpbmtpbmdOb3RpY2U6IE5vdGljZSB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgY3VycmVudFN0cmVhbWluZ0VuZFBvczogYW55ID0gbnVsbDtcbiAgICBwcml2YXRlIHN0cmVhbWluZ1N0YXJ0UG9zOiBhbnkgPSBudWxsO1xuICAgIHByaXZhdGUgb3JpZ2luYWxQb3NpdGlvbjogYW55ID0gbnVsbDtcblxuICAgIC8vIENvbXByZWhlbnNpdmUgdGhpbmtpbmcgcGhyYXNlcyBmb3IgYWxsIGFjdGlvbiB0eXBlc1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFRISU5LSU5HX1BIUkFTRVM6IFJlY29yZDxBY3Rpb25UeXBlLCBzdHJpbmdbXT4gPSB7XG4gICAgICAgICdpbXByb3ZlJzogW1xuICAgICAgICAgICAgJ3JlZmluaW5nLi4uJyxcbiAgICAgICAgICAgICdwb2xpc2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2VuaGFuY2luZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3BlcmZlY3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3Ntb290aGluZy4uLicsXG4gICAgICAgICAgICAnc2hhcnBlbmluZy4uLicsXG4gICAgICAgICAgICAnZWxldmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdmaW5lLXR1bmluZy4uLicsXG4gICAgICAgICAgICAnc2N1bHB0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnbG9uZ2VyJzogW1xuICAgICAgICAgICAgJ2V4cGFuZGluZy4uLicsXG4gICAgICAgICAgICAnZGV2ZWxvcGluZy4uLicsXG4gICAgICAgICAgICAnZWxhYm9yYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2J1aWxkaW5nLi4uJyxcbiAgICAgICAgICAgICdlbnJpY2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2RlZXBlbmluZy4uLicsXG4gICAgICAgICAgICAnZ3Jvd2luZy4uLicsXG4gICAgICAgICAgICAnZXh0ZW5kaW5nLi4uJyxcbiAgICAgICAgICAgICdhbXBsaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICd1bmZvbGRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdzaG9ydGVyJzogW1xuICAgICAgICAgICAgJ2NvbmRlbnNpbmcuLi4nLFxuICAgICAgICAgICAgJ2Rpc3RpbGxpbmcuLi4nLFxuICAgICAgICAgICAgJ3RpZ2h0ZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2ZvY3VzaW5nLi4uJyxcbiAgICAgICAgICAgICdzdHJlYW1saW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbXByZXNzaW5nLi4uJyxcbiAgICAgICAgICAgICd0cmltbWluZy4uLicsXG4gICAgICAgICAgICAnY2xhcmlmeWluZy4uLicsXG4gICAgICAgICAgICAnc2ltcGxpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbmNlbnRyYXRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICd0b25lJzogW1xuICAgICAgICAgICAgJ2FkanVzdGluZyB0b25lLi4uJyxcbiAgICAgICAgICAgICdyZXNoYXBpbmcuLi4nLFxuICAgICAgICAgICAgJ3JlZnJhbWluZy4uLicsXG4gICAgICAgICAgICAnYWRhcHRpbmcuLi4nLFxuICAgICAgICAgICAgJ3RyYW5zZm9ybWluZy4uLicsXG4gICAgICAgICAgICAnbW9kdWxhdGluZy4uLicsXG4gICAgICAgICAgICAncmVjYXN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzaGlmdGluZy4uLicsXG4gICAgICAgICAgICAncmVmb3JtaW5nLi4uJyxcbiAgICAgICAgICAgICdyZWltYWdpbmluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2N1c3RvbSc6IFtcbiAgICAgICAgICAgICd3b3JraW5nIG9uIGl0Li4uJyxcbiAgICAgICAgICAgICdjb25zaWRlcmluZy4uLicsXG4gICAgICAgICAgICAndGhpbmtpbmcuLi4nLFxuICAgICAgICAgICAgJ3Byb2Nlc3NpbmcuLi4nLFxuICAgICAgICAgICAgJ2FuYWx5emluZy4uLicsXG4gICAgICAgICAgICAnY29udGVtcGxhdGluZy4uLicsXG4gICAgICAgICAgICAndW5kZXJzdGFuZGluZy4uLicsXG4gICAgICAgICAgICAnaW50ZXJwcmV0aW5nLi4uJyxcbiAgICAgICAgICAgICdleHBsb3JpbmcuLi4nLFxuICAgICAgICAgICAgJ2V2YWx1YXRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdjaGF0JzogW1xuICAgICAgICAgICAgJ2NvbXBvc2luZy4uLicsXG4gICAgICAgICAgICAnZHJhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyZWF0aW5nLi4uJyxcbiAgICAgICAgICAgICdnZW5lcmF0aW5nLi4uJyxcbiAgICAgICAgICAgICd3cml0aW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAnZm9ybXVsYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2RldmVsb3BpbmcuLi4nLFxuICAgICAgICAgICAgJ2J1aWxkaW5nLi4uJyxcbiAgICAgICAgICAgICdjb25zdHJ1Y3RpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdhZGQnOiBbXG4gICAgICAgICAgICAnY29tcG9zaW5nLi4uJyxcbiAgICAgICAgICAgICdkcmFmdGluZy4uLicsXG4gICAgICAgICAgICAnY3JlYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2dlbmVyYXRpbmcuLi4nLFxuICAgICAgICAgICAgJ3dyaXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdmb3JtdWxhdGluZy4uLicsXG4gICAgICAgICAgICAnZGV2ZWxvcGluZy4uLicsXG4gICAgICAgICAgICAnYnVpbGRpbmcuLi4nLFxuICAgICAgICAgICAgJ2NvbnN0cnVjdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2VkaXQnOiBbXG4gICAgICAgICAgICAncmVmaW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3BvbGlzaGluZy4uLicsXG4gICAgICAgICAgICAnZW5oYW5jaW5nLi4uJyxcbiAgICAgICAgICAgICdjcmFmdGluZy4uLicsXG4gICAgICAgICAgICAncGVyZmVjdGluZy4uLicsXG4gICAgICAgICAgICAnc21vb3RoaW5nLi4uJyxcbiAgICAgICAgICAgICdzaGFycGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdlbGV2YXRpbmcuLi4nLFxuICAgICAgICAgICAgJ2ZpbmUtdHVuaW5nLi4uJyxcbiAgICAgICAgICAgICdzY3VscHRpbmcuLi4nXG4gICAgICAgIF0sXG4gICAgICAgICdyZXdyaXRlJzogW1xuICAgICAgICAgICAgJ3JlZmluaW5nLi4uJyxcbiAgICAgICAgICAgICdwb2xpc2hpbmcuLi4nLFxuICAgICAgICAgICAgJ2VuaGFuY2luZy4uLicsXG4gICAgICAgICAgICAnY3JhZnRpbmcuLi4nLFxuICAgICAgICAgICAgJ3BlcmZlY3RpbmcuLi4nLFxuICAgICAgICAgICAgJ3Ntb290aGluZy4uLicsXG4gICAgICAgICAgICAnc2hhcnBlbmluZy4uLicsXG4gICAgICAgICAgICAnZWxldmF0aW5nLi4uJyxcbiAgICAgICAgICAgICdmaW5lLXR1bmluZy4uLicsXG4gICAgICAgICAgICAnc2N1bHB0aW5nLi4uJ1xuICAgICAgICBdLFxuICAgICAgICAnZ3JhbW1hcic6IFtcbiAgICAgICAgICAgICdyZWZpbmluZy4uLicsXG4gICAgICAgICAgICAncG9saXNoaW5nLi4uJyxcbiAgICAgICAgICAgICdlbmhhbmNpbmcuLi4nLFxuICAgICAgICAgICAgJ2NyYWZ0aW5nLi4uJyxcbiAgICAgICAgICAgICdwZXJmZWN0aW5nLi4uJyxcbiAgICAgICAgICAgICdzbW9vdGhpbmcuLi4nLFxuICAgICAgICAgICAgJ3NoYXJwZW5pbmcuLi4nLFxuICAgICAgICAgICAgJ2VsZXZhdGluZy4uLicsXG4gICAgICAgICAgICAnZmluZS10dW5pbmcuLi4nLFxuICAgICAgICAgICAgJ3NjdWxwdGluZy4uLidcbiAgICAgICAgXSxcbiAgICAgICAgJ2RlbGV0ZSc6IFtcbiAgICAgICAgICAgICdjb25kZW5zaW5nLi4uJyxcbiAgICAgICAgICAgICdkaXN0aWxsaW5nLi4uJyxcbiAgICAgICAgICAgICd0aWdodGVuaW5nLi4uJyxcbiAgICAgICAgICAgICdmb2N1c2luZy4uLicsXG4gICAgICAgICAgICAnc3RyZWFtbGluaW5nLi4uJyxcbiAgICAgICAgICAgICdjb21wcmVzc2luZy4uLicsXG4gICAgICAgICAgICAndHJpbW1pbmcuLi4nLFxuICAgICAgICAgICAgJ2NsYXJpZnlpbmcuLi4nLFxuICAgICAgICAgICAgJ3NpbXBsaWZ5aW5nLi4uJyxcbiAgICAgICAgICAgICdjb25jZW50cmF0aW5nLi4uJ1xuICAgICAgICBdXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhpbmtpbmcgbm90aWNlIHdpdGggY29udGV4dC1hd2FyZSBwaHJhc2UgYW5kIGFuaW1hdGVkIGRvdHNcbiAgICAgKiBPbmx5IHNob3dzIG5vdGljZSBpZiBhbmltYXRpb24gbW9kZSBpcyAnbm90aWNlJyBvciBub3Qgc3BlY2lmaWVkIChkZWZhdWx0KVxuICAgICAqL1xuICAgIHNob3dUaGlua2luZ05vdGljZShhY3Rpb25UeXBlOiBBY3Rpb25UeXBlLCBhbmltYXRpb25Nb2RlOiAnbm90aWNlJyB8ICdpbmxpbmUnID0gJ25vdGljZScpOiB2b2lkIHtcbiAgICAgICAgLy8gT25seSBzaG93IG5vdGljZSBmb3IgJ25vdGljZScgbW9kZSAobWVudS9zZWxlY3Rpb24gYWN0aW9ucylcbiAgICAgICAgaWYgKGFuaW1hdGlvbk1vZGUgIT09ICdub3RpY2UnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gU2VsZWN0IHJhbmRvbSBwaHJhc2UgYmFzZWQgb24gYWN0aW9uIHR5cGVcbiAgICAgICAgICAgIGNvbnN0IHBocmFzZXMgPSBTdHJlYW1pbmdNYW5hZ2VyLlRISU5LSU5HX1BIUkFTRVNbYWN0aW9uVHlwZV0gfHwgU3RyZWFtaW5nTWFuYWdlci5USElOS0lOR19QSFJBU0VTWydjaGF0J107XG4gICAgICAgICAgICBjb25zdCByYW5kb21QaHJhc2UgPSBwaHJhc2VzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBocmFzZXMubGVuZ3RoKV07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBwZXJzaXN0ZW50IG5vdGljZSAoMCB0aW1lb3V0ID0gbWFudWFsIGRpc21pc3NhbClcbiAgICAgICAgICAgIHRoaXMudGhpbmtpbmdOb3RpY2UgPSBuZXcgTm90aWNlKGBOb3ZhOiAke3JhbmRvbVBocmFzZX0uYCwgMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNob3cgaW5pdGlhbCBzdGF0ZSB3aXRoIDEgZG90IGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsTm90aWNlVGV4dCA9IGBOb3ZhOiAke3JhbmRvbVBocmFzZX0uYDtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUVsID0gKHRoaXMudGhpbmtpbmdOb3RpY2UgYXMgYW55KS5ub3RpY2VFbDtcbiAgICAgICAgICAgIGlmIChub3RpY2VFbCkge1xuICAgICAgICAgICAgICAgIG5vdGljZUVsLnRleHRDb250ZW50ID0gaW5pdGlhbE5vdGljZVRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0YXJ0IGRvdHMgYW5pbWF0aW9uIGluIG5vdGljZVxuICAgICAgICAgICAgdGhpcy5zdGFydE5vdGljZURvdHNBbmltYXRpb24ocmFuZG9tUGhyYXNlKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY3JlYXRlIHRoaW5raW5nIG5vdGljZTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBzdHJlYW1pbmcgYXQgYSBzcGVjaWZpYyBwb3NpdGlvbiB3aXRoIGh5YnJpZCBhcHByb2FjaFxuICAgICAqIEZvciBzZWxlY3Rpb24gcmVwbGFjZW1lbnQ6IHN0YXJ0UG9zIGFuZCBlbmRQb3MgZGVmaW5lIHRoZSByYW5nZSB0byByZXBsYWNlXG4gICAgICogRm9yIGN1cnNvciBpbnNlcnRpb246IHN0YXJ0UG9zIGlzIHRoZSBjdXJzb3IgcG9zaXRpb24sIGVuZFBvcyBzaG91bGQgYmUgbnVsbFxuICAgICAqL1xuICAgIHN0YXJ0U3RyZWFtaW5nKFxuICAgICAgICBlZGl0b3I6IEVkaXRvciwgXG4gICAgICAgIHN0YXJ0UG9zOiBhbnksIFxuICAgICAgICBlbmRQb3M/OiBhbnksIFxuICAgICAgICBvcHRpb25zOiBTdHJlYW1pbmdPcHRpb25zID0ge31cbiAgICApOiB7XG4gICAgICAgIHVwZGF0ZVN0cmVhbTogKG5ld1RleHQ6IHN0cmluZywgaXNDb21wbGV0ZTogYm9vbGVhbikgPT4gdm9pZDtcbiAgICAgICAgc3RvcFN0cmVhbTogKCkgPT4gdm9pZDtcbiAgICB9IHtcbiAgICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgcG9zaXRpb24ocylcbiAgICAgICAgdGhpcy5vcmlnaW5hbFBvc2l0aW9uID0geyBmcm9tOiBzdGFydFBvcywgdG86IGVuZFBvcyB9O1xuICAgICAgICBcbiAgICAgICAgaWYgKGVuZFBvcykge1xuICAgICAgICAgICAgLy8gU2VsZWN0aW9uIHJlcGxhY2VtZW50IG1vZGUgLSBjbGVhciB0aGUgc2VsZWN0aW9uXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IHN0YXJ0UG9zO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQ3Vyc29yIGluc2VydGlvbiBtb2RlIC0gc2V0IHBvc2l0aW9uIGZvciBzdHJlYW1pbmdcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IHN0YXJ0UG9zO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0gbnVsbDsgLy8gV2lsbCBiZSBzZXQgb24gZmlyc3QgY2h1bmtcblxuICAgICAgICBjb25zdCB1cGRhdGVTdHJlYW0gPSAobmV3VGV4dDogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0cmVhbWluZ1RleHQoZWRpdG9yLCBuZXdUZXh0LCBpc0NvbXBsZXRlLCBvcHRpb25zKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBzdG9wU3RyZWFtID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4geyB1cGRhdGVTdHJlYW0sIHN0b3BTdHJlYW0gfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgc3RyZWFtaW5nIHRleHQgd2l0aCBwcm9wZXIgcG9zaXRpb24gdHJhY2tpbmdcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZVN0cmVhbWluZ1RleHQoXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLCBcbiAgICAgICAgbmV3VGV4dDogc3RyaW5nLCBcbiAgICAgICAgaXNDb21wbGV0ZTogYm9vbGVhbixcbiAgICAgICAgb3B0aW9uczogU3RyZWFtaW5nT3B0aW9uc1xuICAgICk6IHZvaWQge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcykge1xuICAgICAgICAgICAgICAgIC8vIEtlZXAgbm90aWNlIGFuaW1hdGlvbiBydW5uaW5nIGR1cmluZyBzdHJlYW1pbmcgZm9yIG5vdGljZSBtb2RlXG4gICAgICAgICAgICAgICAgLy8gSXQgd2lsbCBiZSBzdG9wcGVkIHdoZW4gc3RyZWFtaW5nIGNvbXBsZXRlcyAoaXNDb21wbGV0ZSA9IHRydWUpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBhIHN0YXJ0IHBvc2l0aW9uIHlldCwgc2V0IGl0XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MgPSB7IC4uLnRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgbmV3IGVuZCBwb3NpdGlvbiBiYXNlZCBvbiB0aGUgY29tcGxldGUgbmV3IHRleHRcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IG5ld1RleHQuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0VuZFBvcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGluZTogdGhpcy5zdHJlYW1pbmdTdGFydFBvcy5saW5lICsgbGluZXMubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgY2g6IGxpbmVzLmxlbmd0aCA+IDEgPyBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5sZW5ndGggOiB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zLmNoICsgbmV3VGV4dC5sZW5ndGhcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBhbGwgY29udGVudCBmcm9tIHN0YXJ0IHRvIGN1cnJlbnQgZW5kIHdpdGggbmV3IHRleHRcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld1RleHQsIHRoaXMuc3RyZWFtaW5nU3RhcnRQb3MsIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtaW5nRW5kUG9zID0gbmV3RW5kUG9zO1xuXG4gICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBjaHVuayBjYWxsYmFja1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm9uQ2h1bmspIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5vbkNodW5rKG5ld1RleHQsIGlzQ29tcGxldGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGN1cnNvciBhdCB0aGUgZW5kIG9mIHRoZSBuZXcgdGV4dCBvbmx5IHdoZW4gY29tcGxldGVcbiAgICAgICAgICAgIGlmIChpc0NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgY29tcGxldGlvbiBjYWxsYmFja1xuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm9uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdFcnJvciB1cGRhdGluZyBzdHJlYW1pbmcgdGV4dDonLCBlcnJvcik7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJpZ2dlciBlcnJvciBjYWxsYmFja1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMub25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMub25FcnJvcihlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQW5pbWF0ZSBkb3RzIGluIG5vdGljZSB0ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGFydE5vdGljZURvdHNBbmltYXRpb24oYmFzZVBocmFzZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGxldCBkb3RDb3VudCA9IDE7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmRvdHNBbmltYXRpb25JbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRoaW5raW5nTm90aWNlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZG90Q291bnQrKztcbiAgICAgICAgICAgICAgICBpZiAoZG90Q291bnQgPiA1KSB7XG4gICAgICAgICAgICAgICAgICAgIGRvdENvdW50ID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgZG90cyA9ICcuJy5yZXBlYXQoZG90Q291bnQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vdGljZVRleHQgPSBgTm92YTogJHtiYXNlUGhyYXNlfSR7ZG90c31gO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBub3RpY2UgdGV4dCBkaXJlY3RseVxuICAgICAgICAgICAgICAgIGNvbnN0IG5vdGljZUVsID0gKHRoaXMudGhpbmtpbmdOb3RpY2UgYXMgYW55KS5ub3RpY2VFbDtcbiAgICAgICAgICAgICAgICBpZiAobm90aWNlRWwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWNlRWwudGV4dENvbnRlbnQgPSBub3RpY2VUZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdFcnJvciBpbiBub3RpY2UgZG90cyBhbmltYXRpb246JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcERvdHNBbmltYXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgNDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIHRoZSBkb3RzIGFuaW1hdGlvbiBhbmQgZGlzbWlzcyBub3RpY2VcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0b3BEb3RzQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5kb3RzQW5pbWF0aW9uSW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5kb3RzQW5pbWF0aW9uSW50ZXJ2YWwpO1xuICAgICAgICAgICAgdGhpcy5kb3RzQW5pbWF0aW9uSW50ZXJ2YWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEaXNtaXNzIHRoaW5raW5nIG5vdGljZVxuICAgICAgICBpZiAodGhpcy50aGlua2luZ05vdGljZSkge1xuICAgICAgICAgICAgdGhpcy50aGlua2luZ05vdGljZS5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLnRoaW5raW5nTm90aWNlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3AgYWxsIGFuaW1hdGlvbnMgYW5kIGNsZWFuIHVwXG4gICAgICovXG4gICAgc3RvcEFuaW1hdGlvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdG9wRG90c0FuaW1hdGlvbigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIHVwIGFsbCBpbnRlcm5hbCBzdGF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgLy8gU3RvcCBub3RpY2UgYW5pbWF0aW9uIGlmIGl0J3MgcnVubmluZ1xuICAgICAgICB0aGlzLnN0b3BEb3RzQW5pbWF0aW9uKCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgPSBudWxsO1xuICAgICAgICB0aGlzLnN0cmVhbWluZ1N0YXJ0UG9zID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIG9yaWdpbmFsIHBvc2l0aW9uIGJlZm9yZSBzdHJlYW1pbmcgc3RhcnRlZFxuICAgICAqL1xuICAgIGdldE9yaWdpbmFsUG9zaXRpb24oKTogeyBmcm9tOiBhbnk7IHRvPzogYW55IH0gfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZ2luYWxQb3NpdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBjdXJyZW50bHkgc3RyZWFtaW5nXG4gICAgICovXG4gICAgaXNTdHJlYW1pbmcoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdHJlYW1pbmdFbmRQb3MgIT09IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVW5pZmllZCBzdHJlYW1pbmcgbWV0aG9kIGZvciBzZWxlY3Rpb24tYmFzZWQgb3BlcmF0aW9uc1xuICAgICAqIEhhbmRsZXMgYm90aCBub3RpY2UgYW5pbWF0aW9ucyBhbmQgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAqL1xuICAgIGFzeW5jIHN0YXJ0U2VsZWN0aW9uU3RyZWFtaW5nKFxuICAgICAgICBlZGl0b3I6IEVkaXRvcixcbiAgICAgICAgb3JpZ2luYWxSYW5nZTogeyBmcm9tOiBhbnk7IHRvOiBhbnk7IHRleHQ6IHN0cmluZyB9LFxuICAgICAgICBhY3Rpb25UeXBlOiBBY3Rpb25UeXBlLFxuICAgICAgICBzdHJlYW1pbmdDYWxsYmFjazogKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHZvaWQsXG4gICAgICAgIG9wdGlvbnM6IFN0cmVhbWluZ09wdGlvbnMgPSB7fVxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBTZXQgYW5pbWF0aW9uIG1vZGUgdG8gJ25vdGljZScgZm9yIHNlbGVjdGlvbiBvcGVyYXRpb25zXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbk9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIGFuaW1hdGlvbk1vZGU6ICdub3RpY2UnIGFzIGNvbnN0IH07XG4gICAgICAgIFxuICAgICAgICAvLyBTaG93IHRoaW5raW5nIG5vdGljZSBmb3Igc2VsZWN0aW9uIG9wZXJhdGlvbnNcbiAgICAgICAgdGhpcy5zaG93VGhpbmtpbmdOb3RpY2UoYWN0aW9uVHlwZSwgJ25vdGljZScpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYXIgdGhlIHNlbGVjdGlvbiBhbmQgcHJlcGFyZSBmb3Igc3RyZWFtaW5nXG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJycsIG9yaWdpbmFsUmFuZ2UuZnJvbSwgb3JpZ2luYWxSYW5nZS50byk7XG4gICAgICAgIHRoaXMuY3VycmVudFN0cmVhbWluZ0VuZFBvcyA9IG9yaWdpbmFsUmFuZ2UuZnJvbTtcbiAgICAgICAgdGhpcy5zdHJlYW1pbmdTdGFydFBvcyA9IG51bGw7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBzdHJlYW1pbmcgaW50ZXJmYWNlXG4gICAgICAgIGNvbnN0IHsgdXBkYXRlU3RyZWFtLCBzdG9wU3RyZWFtIH0gPSB0aGlzLnN0YXJ0U3RyZWFtaW5nKFxuICAgICAgICAgICAgZWRpdG9yLFxuICAgICAgICAgICAgb3JpZ2luYWxSYW5nZS5mcm9tLFxuICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgc2VsZWN0aW9uT3B0aW9uc1xuICAgICAgICApO1xuXG4gICAgICAgIC8vIFNldCB1cCB0aGUgY2FsbGJhY2sgdG8gZm9yd2FyZCBjaHVua3NcbiAgICAgICAgY29uc3Qgd3JhcHBlZENhbGxiYWNrID0gKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIHVwZGF0ZVN0cmVhbShjaHVuaywgaXNDb21wbGV0ZSk7XG4gICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhjaHVuaywgaXNDb21wbGV0ZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSB3cmFwcGVkIGNhbGxiYWNrIGZvciBleHRlcm5hbCB1c2VcbiAgICAgICAgcmV0dXJuIHdyYXBwZWRDYWxsYmFjayBhcyBhbnk7XG4gICAgfVxufSIsICIvKipcbiAqIFNlbGVjdGlvbi1iYXNlZCBjb250ZXh0IG1lbnUgZm9yIE5vdmFcbiAqIEFkZHMgTm92YSBzdWJtZW51IHRvIE9ic2lkaWFuJ3MgcmlnaHQtY2xpY2sgY29udGV4dCBtZW51IHdoZW4gdGV4dCBpcyBzZWxlY3RlZFxuICovXG5cbmltcG9ydCB7IEFwcCwgRWRpdG9yLCBNZW51LCBNZW51SXRlbSwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE5vdmFQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBTZWxlY3Rpb25FZGl0Q29tbWFuZCB9IGZyb20gJy4uL2NvcmUvY29tbWFuZHMvc2VsZWN0aW9uLWVkaXQtY29tbWFuZCc7XG5pbXBvcnQgeyBUb25lU2VsZWN0aW9uTW9kYWwgfSBmcm9tICcuL3RvbmUtc2VsZWN0aW9uLW1vZGFsJztcbmltcG9ydCB7IEN1c3RvbUluc3RydWN0aW9uTW9kYWwgfSBmcm9tICcuL2N1c3RvbS1pbnN0cnVjdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBTdHJlYW1pbmdNYW5hZ2VyLCBBY3Rpb25UeXBlIH0gZnJvbSAnLi9zdHJlYW1pbmctbWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0aW9uQWN0aW9uIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG4gICAgaWNvbj86IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IFNFTEVDVElPTl9BQ1RJT05TOiBTZWxlY3Rpb25BY3Rpb25bXSA9IFtcbiAgICB7XG4gICAgICAgIGlkOiAnaW1wcm92ZScsXG4gICAgICAgIGxhYmVsOiAnSW1wcm92ZSBXcml0aW5nJyxcbiAgICAgICAgaWNvbjogJ3NwYXJrbGVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdNYWtlIHRleHQgY2xlYXJlciwgbW9yZSBjb25jaXNlLCBiZXR0ZXIgZmxvdydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdsb25nZXInLFxuICAgICAgICBsYWJlbDogJ01ha2UgTG9uZ2VyJyxcbiAgICAgICAgaWNvbjogJ3BsdXMtY2lyY2xlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdFeHBhbmQgaWRlYXMgd2l0aCBtb3JlIGRldGFpbCBhbmQgZXhhbXBsZXMnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnc2hvcnRlcicsXG4gICAgICAgIGxhYmVsOiAnTWFrZSBTaG9ydGVyJyxcbiAgICAgICAgaWNvbjogJ21pbnVzLWNpcmNsZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29uZGVuc2UgdG8gZXNzZW50aWFsIHBvaW50cydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICd0b25lJyxcbiAgICAgICAgbGFiZWw6ICdDaGFuZ2UgVG9uZScsXG4gICAgICAgIGljb246ICdwYWxldHRlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZGp1c3Qgd3JpdGluZyBzdHlsZSBhbmQgdG9uZSdcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdjdXN0b20nLFxuICAgICAgICBsYWJlbDogJ1RlbGwgTm92YS4uLicsXG4gICAgICAgIGljb246ICdtZXNzYWdlLWNpcmNsZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ3VzdG9tIGluc3RydWN0aW9uIGZvciB0cmFuc2Zvcm1hdGlvbidcbiAgICB9XG5dO1xuXG5leHBvcnQgY2xhc3MgU2VsZWN0aW9uQ29udGV4dE1lbnUge1xuICAgIHByaXZhdGUgc2VsZWN0aW9uRWRpdENvbW1hbmQ6IFNlbGVjdGlvbkVkaXRDb21tYW5kO1xuICAgIHByaXZhdGUgY29tcGxldGlvbkNhbGxiYWNrPzogKCkgPT4gdm9pZDtcbiAgICBwcml2YXRlIHN0cmVhbWluZ01hbmFnZXI6IFN0cmVhbWluZ01hbmFnZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE5vdmFQbHVnaW5cbiAgICApIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25FZGl0Q29tbWFuZCA9IG5ldyBTZWxlY3Rpb25FZGl0Q29tbWFuZChwbHVnaW4pO1xuICAgICAgICB0aGlzLnN0cmVhbWluZ01hbmFnZXIgPSBuZXcgU3RyZWFtaW5nTWFuYWdlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2hlbiBzdHJlYW1pbmcgY29tcGxldGVzXG4gICAgICovXG4gICAgc2V0Q29tcGxldGlvbkNhbGxiYWNrKGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29tcGxldGlvbkNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gc3RyZWFtaW5nIGNvbXBsZXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgb25TdHJlYW1pbmdDb21wbGV0ZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY29tcGxldGlvbkNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRpb25DYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXIgdGhlIGNvbnRleHQgbWVudSB3aXRoIE9ic2lkaWFuJ3MgZWRpdG9yXG4gICAgICovXG4gICAgcmVnaXN0ZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1tZW51JywgKG1lbnU6IE1lbnUsIGVkaXRvcjogRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGROb3ZhU3VibWVudShtZW51LCBlZGl0b3IpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgTm92YSBzdWJtZW51IHRvIHRoZSBjb250ZXh0IG1lbnUgaWYgdGV4dCBpcyBzZWxlY3RlZFxuICAgICAqL1xuICAgIHByaXZhdGUgYWRkTm92YVN1Ym1lbnUobWVudTogTWVudSwgZWRpdG9yOiBFZGl0b3IpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gT25seSBzaG93IE5vdmEgc3VibWVudSB3aGVuIHRleHQgaXMgc2VsZWN0ZWRcbiAgICAgICAgaWYgKCFzZWxlY3RlZFRleHQgfHwgc2VsZWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBzZXBhcmF0b3IgYmVmb3JlIE5vdmEgc3VibWVudSBmb3IgdmlzdWFsIGNsYXJpdHlcbiAgICAgICAgbWVudS5hZGRTZXBhcmF0b3IoKTtcblxuICAgICAgICAvLyBDcmVhdGUgTm92YSBhY3Rpb24gaXRlbXMgZGlyZWN0bHkgKG5vIHN0YW5kYWxvbmUgTm92YSBpdGVtKVxuICAgICAgICBTRUxFQ1RJT05fQUNUSU9OUy5mb3JFYWNoKGFjdGlvbiA9PiB7XG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoYE5vdmE6ICR7YWN0aW9uLmxhYmVsfWApXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKGFjdGlvbi5pY29uIHx8ICdlZGl0JylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTZWxlY3Rpb25BY3Rpb24oYWN0aW9uLmlkLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHNlbGVjdGlvbiBhY3Rpb24gd2hlbiBtZW51IGl0ZW0gaXMgY2xpY2tlZFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBoYW5kbGVTZWxlY3Rpb25BY3Rpb24oYWN0aW9uSWQ6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nLCBjdXN0b21JbnN0cnVjdGlvbj86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gSGFuZGxlIHRvbmUgc2VsZWN0aW9uIHdpdGggbW9kYWwgKHdoZW4gbm8gc3BlY2lmaWMgdG9uZSBwcm92aWRlZClcbiAgICAgICAgICAgIGlmIChhY3Rpb25JZCA9PT0gJ3RvbmUnICYmICFjdXN0b21JbnN0cnVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1RvbmVTZWxlY3Rpb25Nb2RhbChlZGl0b3IsIHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoYWN0aW9uSWQgPT09ICdjdXN0b20nICYmICFjdXN0b21JbnN0cnVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0N1c3RvbUluc3RydWN0aW9uTW9kYWwoZWRpdG9yLCBzZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgc2VsZWN0aW9uIGVkaXQgY29tbWFuZCBmb3Igb3RoZXIgYWN0aW9ucyBvciBkaXJlY3QgdG9uZS9jdXN0b20gY2FsbHNcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVNlbGVjdGlvbkVkaXQoYWN0aW9uSWQsIGVkaXRvciwgc2VsZWN0ZWRUZXh0LCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgTm92YSBzZWxlY3Rpb24gYWN0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0ZhaWxlZCB0byBleGVjdXRlIE5vdmEgYWN0aW9uLiBQbGVhc2UgdHJ5IGFnYWluLicsIDMwMDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyB0b25lIHNlbGVjdGlvbiBtb2RhbFxuICAgICAqL1xuICAgIHByaXZhdGUgc2hvd1RvbmVTZWxlY3Rpb25Nb2RhbChlZGl0b3I6IEVkaXRvciwgc2VsZWN0ZWRUZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgVG9uZVNlbGVjdGlvbk1vZGFsKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICBhc3luYyAoc2VsZWN0ZWRUb25lOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHRvbmUgY2hhbmdlIHdpdGggdGhlIHNlbGVjdGVkIHRvbmVcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVTZWxlY3Rpb25FZGl0KCd0b25lJywgZWRpdG9yLCBzZWxlY3RlZFRleHQsIHNlbGVjdGVkVG9uZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgY2FuY2VsbGVkLCBkbyBub3RoaW5nXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IGN1c3RvbSBpbnN0cnVjdGlvbiBtb2RhbFxuICAgICAqL1xuICAgIHByaXZhdGUgc2hvd0N1c3RvbUluc3RydWN0aW9uTW9kYWwoZWRpdG9yOiBFZGl0b3IsIHNlbGVjdGVkVGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEN1c3RvbUluc3RydWN0aW9uTW9kYWwoXG4gICAgICAgICAgICB0aGlzLmFwcCxcbiAgICAgICAgICAgIGFzeW5jIChpbnN0cnVjdGlvbjogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSBjdXN0b20gdHJhbnNmb3JtYXRpb24gd2l0aCB0aGUgaW5zdHJ1Y3Rpb25cbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVTZWxlY3Rpb25FZGl0KCdjdXN0b20nLCBlZGl0b3IsIHNlbGVjdGVkVGV4dCwgaW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIGNhbmNlbGxlZCwgZG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSB0aGUgc2VsZWN0aW9uIGVkaXQgY29tbWFuZCB3aXRoIHN0cmVhbWluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVNlbGVjdGlvbkVkaXQoXG4gICAgICAgIGFjdGlvbklkOiBzdHJpbmcsIFxuICAgICAgICBlZGl0b3I6IEVkaXRvciwgXG4gICAgICAgIHNlbGVjdGVkVGV4dDogc3RyaW5nLCBcbiAgICAgICAgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gU3RhcnQgc2VsZWN0aW9uIGFuaW1hdGlvblxuICAgICAgICB0aGlzLnN0YXJ0U2VsZWN0aW9uQW5pbWF0aW9uKGVkaXRvcik7XG4gICAgICAgIFxuICAgICAgICAvLyBTdG9yZSBvcmlnaW5hbCBzZWxlY3Rpb24gcmFuZ2VcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxSYW5nZSA9IHtcbiAgICAgICAgICAgIGZyb206IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKSxcbiAgICAgICAgICAgIHRvOiBlZGl0b3IuZ2V0Q3Vyc29yKCd0bycpXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gU3RhcnQgdGhlIHVuaWZpZWQgc3RyZWFtaW5nIHN5c3RlbSB3aXRoIG5vdGljZSBhbmltYXRpb25zXG4gICAgICAgICAgICBjb25zdCB7IHVwZGF0ZVN0cmVhbSwgc3RvcFN0cmVhbSB9ID0gdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0YXJ0U3RyZWFtaW5nKFxuICAgICAgICAgICAgICAgIGVkaXRvcixcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFJhbmdlLmZyb20sXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxSYW5nZS50byxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbk1vZGU6ICdub3RpY2UnLFxuICAgICAgICAgICAgICAgICAgICBvbkNvbXBsZXRlOiAoKSA9PiB0aGlzLm9uU3RyZWFtaW5nQ29tcGxldGUoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFNob3cgbm90aWNlIHRoaW5raW5nIGFuaW1hdGlvblxuICAgICAgICAgICAgdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnNob3dUaGlua2luZ05vdGljZShhY3Rpb25JZCBhcyBBY3Rpb25UeXBlLCAnbm90aWNlJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSBzdHJlYW1pbmcgdG8gcHJvZ3Jlc3NpdmVseSByZXBsYWNlIHRleHRcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc2VsZWN0aW9uRWRpdENvbW1hbmQuZXhlY3V0ZVN0cmVhbWluZyhcbiAgICAgICAgICAgICAgICBhY3Rpb25JZCwgXG4gICAgICAgICAgICAgICAgZWRpdG9yLCBcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFRleHQsXG4gICAgICAgICAgICAgICAgKGNodW5rOiBzdHJpbmcsIGlzQ29tcGxldGU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHVuaWZpZWQgc3RyZWFtaW5nIHN5c3RlbVxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVTdHJlYW0oY2h1bmssIGlzQ29tcGxldGUpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY3VzdG9tSW5zdHJ1Y3Rpb25cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIFN0b3Agc3RyZWFtaW5nIHdoZW4gZG9uZVxuICAgICAgICAgICAgc3RvcFN0cmVhbSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3Rpb25OYW1lID0gdGhpcy5nZXRBY3Rpb25EaXNwbGF5TmFtZShhY3Rpb25JZCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm92YTogVGV4dCAke2FjdGlvbk5hbWV9IHN1Y2Nlc3NmdWxseWAsIDIwMDApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFkZCBzdWNjZXNzIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgICAgIHRoaXMuYWRkU3VjY2Vzc0NoYXRNZXNzYWdlKGFjdGlvbklkLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm92YTogJHtyZXN1bHQuZXJyb3IgfHwgJ0ZhaWxlZCB0byBwcm9jZXNzIHRleHQnfWAsIDMwMDApO1xuICAgICAgICAgICAgICAgIC8vIEFkZCBmYWlsdXJlIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgICAgIHRoaXMuYWRkRmFpbHVyZUNoYXRNZXNzYWdlKGFjdGlvbklkLCByZXN1bHQuZXJyb3IgfHwgJ0ZhaWxlZCB0byBwcm9jZXNzIHRleHQnKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIHRleHQgd2hlbiBzdHJlYW1pbmcgZmFpbHNcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3RvcmVPcmlnaW5hbFRleHQoZWRpdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0cmVhbWluZyBzZWxlY3Rpb24gZWRpdDonLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gZXhlY3V0ZSBOb3ZhIGFjdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAzMDAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCB0ZXh0IG9uIGNvbXBsZXRlIGZhaWx1cmVcbiAgICAgICAgICAgIHRoaXMucmVzdG9yZU9yaWdpbmFsVGV4dChlZGl0b3IpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgLy8gQWx3YXlzIHN0b3AgYW5pbWF0aW9ucyBhbmQgY2xlYW4gdXBcbiAgICAgICAgICAgIHRoaXMuc3RvcFNlbGVjdGlvbkFuaW1hdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5zdHJlYW1pbmdNYW5hZ2VyLnN0b3BBbmltYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc3RvcmUgb3JpZ2luYWwgdGV4dCBpZiBzdHJlYW1pbmcgZmFpbHMgY29tcGxldGVseVxuICAgICAqL1xuICAgIHByaXZhdGUgcmVzdG9yZU9yaWdpbmFsVGV4dChlZGl0b3I6IEVkaXRvcik6IHZvaWQge1xuICAgICAgICAvLyBUaGUgU3RyZWFtaW5nTWFuYWdlciBub3cgaGFuZGxlcyB0ZXh0IHJlc3RvcmF0aW9uXG4gICAgICAgIC8vIFRoaXMgaXMga2VwdCBmb3IgY29tcGF0aWJpbGl0eSBidXQgbW9zdCByZXN0b3JhdGlvbiBpcyBoYW5kbGVkIGJ5IHRoZSB1bmlmaWVkIHN5c3RlbVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHB1bHNpbmcgYW5pbWF0aW9uIG9uIHNlbGVjdGVkIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXJ0U2VsZWN0aW9uQW5pbWF0aW9uKGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBlZGl0b3IgY29udGFpbmVyIGluIHRoZSBET01cbiAgICAgICAgICAgIGNvbnN0IGVkaXRvckNvbnRhaW5lciA9IChlZGl0b3IgYXMgYW55KS5jbT8uZG9tIHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbS1lZGl0b3InKTtcbiAgICAgICAgICAgIGlmIChlZGl0b3JDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3JDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnbm92YS1zZWxlY3Rpb24tcHJvY2Vzc2luZycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdG9yZSB0aGUgb3JpZ2luYWwgc2VsZWN0aW9uIGZvciBsYXRlciBjbGVhbnVwXG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRlZFNlbGVjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogZWRpdG9yLmdldEN1cnNvcignZnJvbScpLFxuICAgICAgICAgICAgICAgICAgICB0bzogZWRpdG9yLmdldEN1cnNvcigndG8nKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzdGFydCBzZWxlY3Rpb24gYW5pbWF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3AgcHVsc2luZyBhbmltYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIHN0b3BTZWxlY3Rpb25BbmltYXRpb24oKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgYW5pbWF0aW9uIGNsYXNzIGZyb20gYWxsIHBvc3NpYmxlIGVkaXRvciBlbGVtZW50c1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuQ29kZU1pcnJvciwgLmNtLWVkaXRvcicpO1xuICAgICAgICAgICAgZWRpdG9yRWxlbWVudHMuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnbm92YS1zZWxlY3Rpb24tcHJvY2Vzc2luZycpO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgdGhpcy5hbmltYXRlZFNlbGVjdGlvbiA9IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzdG9wIHNlbGVjdGlvbiBhbmltYXRpb246JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhbmltYXRlZFNlbGVjdGlvbjogeyBmcm9tOiBhbnk7IHRvOiBhbnkgfSB8IG51bGwgPSBudWxsO1xuXG5cblxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGlzcGxheSBuYW1lIGZvciBhY3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEFjdGlvbkRpc3BsYXlOYW1lKGFjdGlvbklkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbklkKSB7XG4gICAgICAgICAgICBjYXNlICdpbXByb3ZlJzogcmV0dXJuICdpbXByb3ZlZCc7XG4gICAgICAgICAgICBjYXNlICdsb25nZXInOiByZXR1cm4gJ2V4cGFuZGVkJztcbiAgICAgICAgICAgIGNhc2UgJ3Nob3J0ZXInOiByZXR1cm4gJ2NvbmRlbnNlZCc7XG4gICAgICAgICAgICBjYXNlICd0b25lJzogcmV0dXJuICd0b25lIGFkanVzdGVkJztcbiAgICAgICAgICAgIGNhc2UgJ2N1c3RvbSc6IHJldHVybiAndHJhbnNmb3JtZWQnO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuICdwcm9jZXNzZWQnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHN1Y2Nlc3MgbWVzc2FnZSB0byBjaGF0IHVzaW5nIHVuaWZpZWQgc3lzdGVtXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRTdWNjZXNzQ2hhdE1lc3NhZ2UoYWN0aW9uSWQ6IHN0cmluZywgb3JpZ2luYWxUZXh0OiBzdHJpbmcsIGN1c3RvbUluc3RydWN0aW9uPzogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBhY3RpdmUgTm92YSBzaWRlYmFyIHZpZXcgYW5kIGFkZCBtZXNzYWdlIHRvIGNoYXRcbiAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ25vdmEtc2lkZWJhcicpO1xuICAgICAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lkZWJhclZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBhbnk7XG4gICAgICAgICAgICAgICAgaWYgKHNpZGViYXJWaWV3Py5jaGF0UmVuZGVyZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uRGVzY3JpcHRpb24gPSB0aGlzLmdldEFjdGlvbkRlc2NyaXB0aW9uKGFjdGlvbklkLCBjdXN0b21JbnN0cnVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZFRleHQgPSBvcmlnaW5hbFRleHQubGVuZ3RoID4gNTAgXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG9yaWdpbmFsVGV4dC5zdWJzdHJpbmcoMCwgNTApICsgJy4uLicgXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG9yaWdpbmFsVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgXHUyNzEzICR7YWN0aW9uRGVzY3JpcHRpb259IHRleHQ6IFwiJHt0cnVuY2F0ZWRUZXh0fVwiYDtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB1bmlmaWVkIHN5c3RlbSB3aXRoIHBlcnNpc3RlbmNlXG4gICAgICAgICAgICAgICAgICAgIHNpZGViYXJWaWV3LmNoYXRSZW5kZXJlci5hZGRTdWNjZXNzTWVzc2FnZShtZXNzYWdlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBhZGQgc3VjY2VzcyBjaGF0IG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGZhaWx1cmUgbWVzc2FnZSB0byBjaGF0IHVzaW5nIHVuaWZpZWQgc3lzdGVtXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRGYWlsdXJlQ2hhdE1lc3NhZ2UoYWN0aW9uSWQ6IHN0cmluZywgZXJyb3JNZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGFjdGl2ZSBOb3ZhIHNpZGViYXIgdmlldyBhbmQgYWRkIG1lc3NhZ2UgdG8gY2hhdFxuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbm92YS1zaWRlYmFyJyk7XG4gICAgICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWRlYmFyVmlldyA9IGxlYXZlc1swXS52aWV3IGFzIGFueTtcbiAgICAgICAgICAgICAgICBpZiAoc2lkZWJhclZpZXc/LmNoYXRSZW5kZXJlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3Rpb25OYW1lID0gdGhpcy5nZXRBY3Rpb25EaXNwbGF5TmFtZShhY3Rpb25JZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgXHUyNzE3IEZhaWxlZCB0byAke2FjdGlvbk5hbWUucmVwbGFjZSgnZWQnLCAnJyl9IHRleHQ6ICR7ZXJyb3JNZXNzYWdlfWA7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdW5pZmllZCBzeXN0ZW0gd2l0aCBwZXJzaXN0ZW5jZVxuICAgICAgICAgICAgICAgICAgICBzaWRlYmFyVmlldy5jaGF0UmVuZGVyZXIuYWRkRXJyb3JNZXNzYWdlKG1lc3NhZ2UsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGFkZCBlcnJvciBjaGF0IG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRldGFpbGVkIGFjdGlvbiBkZXNjcmlwdGlvbiBmb3IgY2hhdFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0QWN0aW9uRGVzY3JpcHRpb24oYWN0aW9uSWQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbklkKSB7XG4gICAgICAgICAgICBjYXNlICdpbXByb3ZlJzogcmV0dXJuICdJbXByb3ZlZCc7XG4gICAgICAgICAgICBjYXNlICdsb25nZXInOiByZXR1cm4gJ0V4cGFuZGVkJztcbiAgICAgICAgICAgIGNhc2UgJ3Nob3J0ZXInOiByZXR1cm4gJ0NvbmRlbnNlZCc7XG4gICAgICAgICAgICBjYXNlICd0b25lJzogcmV0dXJuIGBDaGFuZ2VkIHRvbmUgdG8gJHtjdXN0b21JbnN0cnVjdGlvbiB8fCAnZm9ybWFsJ31gO1xuICAgICAgICAgICAgY2FzZSAnY3VzdG9tJzogcmV0dXJuIGBBcHBsaWVkIFwiJHtjdXN0b21JbnN0cnVjdGlvbn1cImA7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gJ1Byb2Nlc3NlZCc7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogU2VsZWN0aW9uLWJhc2VkIGVkaXRpbmcgY29tbWFuZCBoYW5kbGVyIGZvciBOb3ZhXG4gKiBQcm9jZXNzZXMgQUkgdHJhbnNmb3JtYXRpb25zIG9uIHNlbGVjdGVkIHRleHRcbiAqL1xuXG5pbXBvcnQgeyBFZGl0b3IsIEVkaXRvclBvc2l0aW9uLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTm92YVBsdWdpbiBmcm9tICcuLi8uLi8uLi9tYWluJztcbmltcG9ydCB7IEFJUHJvdmlkZXIgfSBmcm9tICcuLi8uLi9haS90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0aW9uRWRpdFJlc3VsdCB7XG4gICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICB0cmFuc2Zvcm1lZFRleHQ/OiBzdHJpbmc7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgb3JpZ2luYWxSYW5nZT86IHtcbiAgICAgICAgZnJvbTogRWRpdG9yUG9zaXRpb247XG4gICAgICAgIHRvOiBFZGl0b3JQb3NpdGlvbjtcbiAgICB9O1xufVxuXG5leHBvcnQgY2xhc3MgU2VsZWN0aW9uRWRpdENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBOb3ZhUGx1Z2luKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIHNlbGVjdGlvbi1iYXNlZCBlZGl0IGFjdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoYWN0aW9uOiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yLCBzZWxlY3RlZFRleHQ6IHN0cmluZywgY3VzdG9tSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBQcm9taXNlPFNlbGVjdGlvbkVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBzZWxlY3Rpb24gcmFuZ2UgZm9yIGxhdGVyIHJlcGxhY2VtZW50XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25SYW5nZSA9IHtcbiAgICAgICAgICAgICAgICBmcm9tOiBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyksXG4gICAgICAgICAgICAgICAgdG86IGVkaXRvci5nZXRDdXJzb3IoJ3RvJylcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFNob3cgbG9hZGluZyBpbmRpY2F0b3JcbiAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdOb3RpY2UgPSBuZXcgTm90aWNlKCdOb3ZhIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0Li4uJywgMCk7XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHByb21wdCBiYXNlZCBvbiBhY3Rpb25cbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQoYWN0aW9uLCBzZWxlY3RlZFRleHQsIGN1c3RvbUluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2V0IEFJIHJlc3BvbnNlIHVzaW5nIHRoZSBwcm92aWRlciBtYW5hZ2VyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucGx1Z2luLmFpUHJvdmlkZXJNYW5hZ2VyLmNvbXBsZXRlKFxuICAgICAgICAgICAgICAgIHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGxvYWRpbmdOb3RpY2UuaGlkZSgpO1xuXG4gICAgICAgICAgICAvLyBDbGVhbiB1cCBBSSByZXNwb25zZSAocmVtb3ZlIGFueSBleHBsYW5hdGlvbiB0ZXh0KVxuICAgICAgICAgICAgY29uc3QgdHJhbnNmb3JtZWRUZXh0ID0gdGhpcy5jbGVhbkFJUmVzcG9uc2UocmVzcG9uc2UpO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRUZXh0LFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2U6IHNlbGVjdGlvblJhbmdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTZWxlY3Rpb24gZWRpdCBjb21tYW5kIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBhIHNlbGVjdGlvbi1iYXNlZCBlZGl0IGFjdGlvbiB3aXRoIHN0cmVhbWluZ1xuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGVTdHJlYW1pbmcoXG4gICAgICAgIGFjdGlvbjogc3RyaW5nLCBcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsIFxuICAgICAgICBzZWxlY3RlZFRleHQ6IHN0cmluZywgXG4gICAgICAgIG9uQ2h1bms6IChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKSA9PiB2b2lkLFxuICAgICAgICBjdXN0b21JbnN0cnVjdGlvbj86IHN0cmluZ1xuICAgICk6IFByb21pc2U8U2VsZWN0aW9uRWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IHNlbGVjdGlvbiByYW5nZSBmb3IgbGF0ZXIgcmVwbGFjZW1lbnRcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvblJhbmdlID0ge1xuICAgICAgICAgICAgICAgIGZyb206IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKSxcbiAgICAgICAgICAgICAgICB0bzogZWRpdG9yLmdldEN1cnNvcigndG8nKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgcHJvbXB0IGJhc2VkIG9uIGFjdGlvblxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5idWlsZFByb21wdChhY3Rpb24sIHNlbGVjdGVkVGV4dCwgY3VzdG9tSW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgZnVsbFJlc3BvbnNlID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0cmVhbSBBSSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wbHVnaW4uYWlQcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdC51c2VyUHJvbXB0LCB7XG4gICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGNodW5rLmVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZnVsbFJlc3BvbnNlICs9IGNodW5rLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gT25seSBjYWxsIG9uQ2h1bmsgaWYgd2UgaGF2ZSBjb250ZW50IG9yIGlmIGl0J3MgdGhlIGZpbmFsIGNodW5rXG4gICAgICAgICAgICAgICAgaWYgKGZ1bGxSZXNwb25zZS50cmltKCkubGVuZ3RoID4gMCB8fCBjaHVuay5kb25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRDaHVuayA9IHRoaXMuY2xlYW5BSVJlc3BvbnNlKGZ1bGxSZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2h1bmsoY2xlYW5lZENodW5rLCBjaHVuay5kb25lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmRvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBhY3R1YWxseSBnb3QgYSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QgZmluYWxUZXh0ID0gdGhpcy5jbGVhbkFJUmVzcG9uc2UoZnVsbFJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmICghZmluYWxUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IHJlc3BvbnNlJyxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxSYW5nZTogc2VsZWN0aW9uUmFuZ2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRUZXh0OiBmaW5hbFRleHQsXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxSYW5nZTogc2VsZWN0aW9uUmFuZ2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NlbGVjdGlvbiBlZGl0IHN0cmVhbWluZyBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgdGhlIEFJIGJhc2VkIG9uIHRoZSBhY3Rpb24gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRQcm9tcHQoYWN0aW9uOiBzdHJpbmcsIHNlbGVjdGVkVGV4dDogc3RyaW5nLCBjdXN0b21JbnN0cnVjdGlvbj86IHN0cmluZyk6IHtcbiAgICAgICAgc3lzdGVtUHJvbXB0OiBzdHJpbmc7XG4gICAgICAgIHVzZXJQcm9tcHQ6IHN0cmluZztcbiAgICB9IHtcbiAgICAgICAgY29uc3QgYmFzZVN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgYXNzaXN0YW50LiBZb3VyIHRhc2sgaXMgdG8gdHJhbnNmb3JtIHRoZSBwcm92aWRlZCB0ZXh0IGFjY29yZGluZyB0byB0aGUgdXNlcidzIHJlcXVlc3QuIFxuXG5DUklUSUNBTCBSVUxFUzpcbi0gUHJvdmlkZSBPTkxZIHRoZSB0cmFuc2Zvcm1lZCB0ZXh0LCBubyBleHBsYW5hdGlvbnMgb3IgbWV0YS1jb21tZW50YXJ5XG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCBtZWFuaW5nIHVubGVzcyBzcGVjaWZpY2FsbHkgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBmb3JtYXQgKG1hcmtkb3duLCBzdHJ1Y3R1cmUsIGV0Yy4pIHVubGVzcyBpbnN0cnVjdGVkIG90aGVyd2lzZVxuLSBEbyBub3QgYWRkIGludHJvZHVjdG9yeSBwaHJhc2VzIGxpa2UgXCJIZXJlJ3MgdGhlIGltcHJvdmVkIHRleHQ6XCIgb3Igc2ltaWxhclxuLSBSZXR1cm4gb25seSB0aGUgY29udGVudCB0aGF0IHNob3VsZCByZXBsYWNlIHRoZSBzZWxlY3RlZCB0ZXh0YDtcblxuICAgICAgICBsZXQgc3BlY2lmaWNQcm9tcHQgPSAnJztcbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSAnJztcblxuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnaW1wcm92ZSc6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBJbXByb3ZlIHRoZSB3cml0aW5nIHF1YWxpdHlcbi0gTWFrZSB0aGUgdGV4dCBjbGVhcmVyIGFuZCBtb3JlIGNvbmNpc2Vcbi0gSW1wcm92ZSBmbG93IGFuZCByZWFkYWJpbGl0eVxuLSBGaXggYW55IGF3a3dhcmQgcGhyYXNpbmdcbi0gUHJlc2VydmUgdGhlIG9yaWdpbmFsIHRvbmUgYW5kIG1lYW5pbmdgO1xuICAgICAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgSW1wcm92ZSB0aGlzIHRleHQ6XFxuXFxuJHtzZWxlY3RlZFRleHR9YDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnbG9uZ2VyJzpcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IEV4cGFuZCB0aGUgdGV4dCB3aXRoIG1vcmUgZGV0YWlsXG4tIEFkZCByZWxldmFudCBleGFtcGxlcywgY29udGV4dCwgb3IgZXhwbGFuYXRpb25zXG4tIE1haW50YWluIHRoZSBvcmlnaW5hbCBzdHlsZSBhbmQgdm9pY2Vcbi0gRXhwYW5kIGlkZWFzIHdpdGhvdXQgY2hhbmdpbmcgdGhlIGNvcmUgbWVzc2FnZVxuLSBNYWtlIGl0IG1vcmUgY29tcHJlaGVuc2l2ZSBhbmQgZGV0YWlsZWRgO1xuICAgICAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgTWFrZSB0aGlzIHRleHQgbG9uZ2VyIGFuZCBtb3JlIGRldGFpbGVkOlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3Nob3J0ZXInOlxuICAgICAgICAgICAgICAgIHNwZWNpZmljUHJvbXB0ID0gYFxuVEFTSzogQ29uZGVuc2UgdGhlIHRleHQgdG8gZXNzZW50aWFsIHBvaW50c1xuLSBSZW1vdmUgcmVkdW5kYW5jeSBhbmQgdW5uZWNlc3Nhcnkgd29yZHNcbi0gS2VlcCBhbGwga2V5IGluZm9ybWF0aW9uIGFuZCBtZWFuaW5nXG4tIE1ha2UgaXQgbW9yZSBjb25jaXNlIGFuZCBkaXJlY3Rcbi0gUHJlc2VydmUgdGhlIG9yaWdpbmFsIHRvbmVgO1xuICAgICAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgTWFrZSB0aGlzIHRleHQgc2hvcnRlciBhbmQgbW9yZSBjb25jaXNlOlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ3RvbmUnOlxuICAgICAgICAgICAgICAgIGNvbnN0IHRvbmVNYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAgICAgICAgICAgICAgICdmb3JtYWwnOiAncHJvZmVzc2lvbmFsIGFuZCBzdHJ1Y3R1cmVkLCBzdWl0YWJsZSBmb3IgYnVzaW5lc3Mgb3IgYWNhZGVtaWMgY29udGV4dHMnLFxuICAgICAgICAgICAgICAgICAgICAnY2FzdWFsJzogJ3JlbGF4ZWQgYW5kIGNvbnZlcnNhdGlvbmFsLCBzdWl0YWJsZSBmb3IgaW5mb3JtYWwgY29tbXVuaWNhdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICdhY2FkZW1pYyc6ICdzY2hvbGFybHkgYW5kIHByZWNpc2UsIHVzaW5nIHRlY2huaWNhbCB2b2NhYnVsYXJ5IHdoZXJlIGFwcHJvcHJpYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgJ2ZyaWVuZGx5JzogJ3dhcm0gYW5kIGFwcHJvYWNoYWJsZSwgYnVpbGRpbmcgY29ubmVjdGlvbiB3aXRoIHRoZSByZWFkZXInXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCB0b25lRGVzY3JpcHRpb24gPSB0b25lTWFwW2N1c3RvbUluc3RydWN0aW9uIHx8ICdmb3JtYWwnXSB8fCB0b25lTWFwLmZvcm1hbDtcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IENoYW5nZSB0aGUgdG9uZSB0byBiZSAke3RvbmVEZXNjcmlwdGlvbn1cbi0gQWRqdXN0IGxhbmd1YWdlIGFuZCB2b2NhYnVsYXJ5IHRvIG1hdGNoIHRoZSByZXF1ZXN0ZWQgdG9uZVxuLSBLZWVwIHRoZSBzYW1lIGNvbnRlbnQgYW5kIG1lYW5pbmdcbi0gTWFpbnRhaW4gYXBwcm9wcmlhdGUgZm9ybWFsaXR5IGxldmVsIGZvciB0aGUgY2hvc2VuIHRvbmVgO1xuICAgICAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgUmV3cml0ZSB0aGlzIHRleHQgaW4gYSAke2N1c3RvbUluc3RydWN0aW9uIHx8ICdmb3JtYWwnfSB0b25lOlxcblxcbiR7c2VsZWN0ZWRUZXh0fWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1c3RvbSc6XG4gICAgICAgICAgICAgICAgc3BlY2lmaWNQcm9tcHQgPSBgXG5UQVNLOiBBcHBseSBjdXN0b20gdHJhbnNmb3JtYXRpb25cbi0gRm9sbG93IHRoZSB1c2VyJ3Mgc3BlY2lmaWMgaW5zdHJ1Y3Rpb24gZXhhY3RseVxuLSBNYWludGFpbiBjb250ZW50IGludGVncml0eSB1bmxlc3MgYXNrZWQgdG8gY2hhbmdlIGl0XG4tIEFwcGx5IHRoZSByZXF1ZXN0ZWQgY2hhbmdlcyBwcmVjaXNlbHlgO1xuICAgICAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQXBwbHkgdGhpcyBpbnN0cnVjdGlvbiB0byB0aGUgdGV4dDogXCIke2N1c3RvbUluc3RydWN0aW9ufVwiXFxuXFxuVGV4dCB0byB0cmFuc2Zvcm06XFxuXFxuJHtzZWxlY3RlZFRleHR9YDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBzcGVjaWZpY1Byb21wdCA9IGBcblRBU0s6IEdlbmVyYWwgdGV4dCBpbXByb3ZlbWVudFxuLSBFbmhhbmNlIGNsYXJpdHkgYW5kIHJlYWRhYmlsaXR5XG4tIFByZXNlcnZlIG9yaWdpbmFsIG1lYW5pbmcgYW5kIHRvbmVgO1xuICAgICAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgSW1wcm92ZSB0aGlzIHRleHQ6XFxuXFxuJHtzZWxlY3RlZFRleHR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IGJhc2VTeXN0ZW1Qcm9tcHQgKyAnXFxuJyArIHNwZWNpZmljUHJvbXB0LFxuICAgICAgICAgICAgdXNlclByb21wdFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3Qgb25seSB0aGUgdHJhbnNmb3JtZWQgdGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgY2xlYW5BSVJlc3BvbnNlKHJlc3BvbnNlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICAvLyBSZW1vdmUgY29tbW9uIEFJIHJlc3BvbnNlIHBhdHRlcm5zXG4gICAgICAgIGxldCBjbGVhbmVkID0gcmVzcG9uc2UudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIGludHJvZHVjdG9yeSBwaHJhc2VzXG4gICAgICAgIGNvbnN0IGludHJvUGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvXkhlcmUncyB0aGUgaW1wcm92ZWQgdGV4dDo/XFxzKi9pLFxuICAgICAgICAgICAgL15IZXJlJ3MgdGhlIHJld3JpdHRlbiB0ZXh0Oj9cXHMqL2ksXG4gICAgICAgICAgICAvXkhlcmUncyB0aGUgdHJhbnNmb3JtZWQgdGV4dDo/XFxzKi9pLFxuICAgICAgICAgICAgL15JbXByb3ZlZCB2ZXJzaW9uOj9cXHMqL2ksXG4gICAgICAgICAgICAvXlJld3JpdHRlbjo/XFxzKi9pLFxuICAgICAgICAgICAgL15SZXN1bHQ6P1xccyovaSxcbiAgICAgICAgICAgIC9eT3V0cHV0Oj9cXHMqL2lcbiAgICAgICAgXTtcblxuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgaW50cm9QYXR0ZXJucykge1xuICAgICAgICAgICAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZShwYXR0ZXJuLCAnJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgdHJhaWxpbmcgZXhwbGFuYXRpb25zICh0ZXh0IGFmdGVyIFwiLS0tXCIgb3Igc2ltaWxhciBwYXR0ZXJucylcbiAgICAgICAgY2xlYW5lZCA9IGNsZWFuZWQuc3BsaXQoL1xcblxccyotLS0rXFxzKi8pLnNoaWZ0KCkgfHwgY2xlYW5lZDtcbiAgICAgICAgY2xlYW5lZCA9IGNsZWFuZWQuc3BsaXQoL1xcblxccypcXCpcXCo/RXhwbGFuYXRpb25cXCo/XFwqPzovaSkuc2hpZnQoKSB8fCBjbGVhbmVkO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNsZWFuZWQudHJpbSgpO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBOYXRpdmUgdG9uZSBzZWxlY3Rpb24gbW9kYWwgZm9yIE5vdmEgdXNpbmcgT2JzaWRpYW4ncyBGdXp6eVN1Z2dlc3RNb2RhbFxuICogUHJvdmlkZXMgY29uc2lzdGVudCBVWCB3aXRoIGNvcmUgT2JzaWRpYW4gZmVhdHVyZXNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRvbmVPcHRpb24ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbGFiZWw6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgVE9ORV9PUFRJT05TOiBUb25lT3B0aW9uW10gPSBbXG4gICAge1xuICAgICAgICBpZDogJ2Zvcm1hbCcsXG4gICAgICAgIGxhYmVsOiAnRm9ybWFsJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdQcm9mZXNzaW9uYWwsIHN0cnVjdHVyZWQgbGFuZ3VhZ2Ugc3VpdGFibGUgZm9yIGJ1c2luZXNzIG9yIGFjYWRlbWljIGNvbnRleHRzJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2Nhc3VhbCcsXG4gICAgICAgIGxhYmVsOiAnQ2FzdWFsJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdSZWxheGVkLCBjb252ZXJzYXRpb25hbCB0b25lIGZvciBpbmZvcm1hbCBjb21tdW5pY2F0aW9uJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2FjYWRlbWljJyxcbiAgICAgICAgbGFiZWw6ICdBY2FkZW1pYycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnU2Nob2xhcmx5LCBwcmVjaXNlIGxhbmd1YWdlIHdpdGggdGVjaG5pY2FsIHZvY2FidWxhcnknXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnZnJpZW5kbHknLFxuICAgICAgICBsYWJlbDogJ0ZyaWVuZGx5JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdXYXJtLCBhcHByb2FjaGFibGUgdG9uZSB0aGF0IGJ1aWxkcyBjb25uZWN0aW9uJ1xuICAgIH1cbl07XG5cbmV4cG9ydCBjbGFzcyBUb25lU2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxUb25lT3B0aW9uPiB7XG4gICAgcHJpdmF0ZSBvblNlbGVjdDogKHRvbmU6IHN0cmluZykgPT4gdm9pZDtcbiAgICBwcml2YXRlIG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBvblNlbGVjdDogKHRvbmU6IHN0cmluZykgPT4gdm9pZCxcbiAgICAgICAgb25DYW5jZWw6ICgpID0+IHZvaWRcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5vblNlbGVjdCA9IG9uU2VsZWN0O1xuICAgICAgICB0aGlzLm9uQ2FuY2VsID0gb25DYW5jZWw7XG4gICAgICAgIFxuICAgICAgICAvLyBTZXQgcGxhY2Vob2xkZXIgdGV4dFxuICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKCdDaG9vc2UgYSB3cml0aW5nIHRvbmUuLi4nKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBpbnN0cnVjdGlvblxuICAgICAgICB0aGlzLnNldEluc3RydWN0aW9ucyhbXG4gICAgICAgICAgICB7IGNvbW1hbmQ6ICdcdTIxOTFcdTIxOTMnLCBwdXJwb3NlOiAndG8gbmF2aWdhdGUnIH0sXG4gICAgICAgICAgICB7IGNvbW1hbmQ6ICdcdTIxQjUnLCBwdXJwb3NlOiAndG8gYXBwbHkgdG9uZScgfSxcbiAgICAgICAgICAgIHsgY29tbWFuZDogJ2VzYycsIHB1cnBvc2U6ICd0byBjYW5jZWwnIH1cbiAgICAgICAgXSk7XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVG9uZU9wdGlvbltdIHtcbiAgICAgICAgcmV0dXJuIFRPTkVfT1BUSU9OUztcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dCh0b25lOiBUb25lT3B0aW9uKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGAke3RvbmUubGFiZWx9IC0gJHt0b25lLmRlc2NyaXB0aW9ufWA7XG4gICAgfVxuXG4gICAgb25DaG9vc2VJdGVtKHRvbmU6IFRvbmVPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vblNlbGVjdCh0b25lLmlkKTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICAvLyBJZiBubyBzZWxlY3Rpb24gd2FzIG1hZGUsIGNhbGwgb25DYW5jZWxcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGlmIChjb250ZW50RWwucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5vbkNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIE5hdGl2ZSBjdXN0b20gaW5zdHJ1Y3Rpb24gbW9kYWwgZm9yIE5vdmEgdXNpbmcgT2JzaWRpYW4ncyBNb2RhbCBjbGFzc1xuICogU2ltcGxpZmllZCBkZXNpZ24gZm9sbG93aW5nIE9ic2lkaWFuJ3MgbmF0aXZlIHBhdHRlcm5zXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIEN1c3RvbUluc3RydWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSBpbnN0cnVjdGlvbjogc3RyaW5nID0gJyc7XG4gICAgcHJpdmF0ZSBvblN1Ym1pdDogKGluc3RydWN0aW9uOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgcHJpdmF0ZSBvbkNhbmNlbDogKCkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhcHA6IEFwcCxcbiAgICAgICAgb25TdWJtaXQ6IChpbnN0cnVjdGlvbjogc3RyaW5nKSA9PiB2b2lkLFxuICAgICAgICBvbkNhbmNlbDogKCkgPT4gdm9pZFxuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gICAgICAgIHRoaXMub25DYW5jZWwgPSBvbkNhbmNlbDtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBuYXRpdmUgbW9kYWwgc3R5bGluZ1xuICAgICAgICB0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ25vdmEtY3VzdG9tLWluc3RydWN0aW9uLW1vZGFsJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaXRsZVxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnVGVsbCBOb3ZhJyB9KTtcblxuICAgICAgICAvLyBEZXNjcmlwdGlvblxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnSW5zdHJ1Y3Rpb24nKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Rlc2NyaWJlIGhvdyB5b3Ugd2FudCBOb3ZhIHRvIHRyYW5zZm9ybSB5b3VyIHNlbGVjdGVkIHRleHQnKTtcblxuICAgICAgICAvLyBUZXh0IGFyZWEgdXNpbmcgU2V0dGluZyBjb21wb25lbnQgZm9yIGNvbnNpc3RlbnQgc3R5bGluZ1xuICAgICAgICBjb25zdCB0ZXh0QXJlYVNldHRpbmcgPSBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2UuZy4sIFwibWFrZSB0aGlzIG1vcmUgcGVyc3Vhc2l2ZVwiLCBcImFkZCBzdGF0aXN0aWNzXCIsIFwid3JpdGUgaW4gYnVsbGV0IHBvaW50c1wiJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuaW5zdHJ1Y3Rpb24pXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluc3RydWN0aW9uID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIHRleHQgYXJlYSBsYXJnZXJcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS5taW5IZWlnaHQgPSAnMTAwcHgnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEZvY3VzIG9uIHRoZSB0ZXh0IGFyZWFcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRleHQuaW5wdXRFbC5mb2N1cygpLCA1MCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gSGFuZGxlIEN0cmwvQ21kK0VudGVyIHRvIHN1Ym1pdFxuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInICYmIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBIaWRlIHRoZSBzZXR0aW5nIG5hbWUvZGVzY3JpcHRpb24gYXJlYSB0byBnaXZlIGZ1bGwgd2lkdGggdG8gdGV4dGFyZWFcbiAgICAgICAgdGV4dEFyZWFTZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5ib3JkZXIgPSAnbm9uZSc7XG4gICAgICAgIHRleHRBcmVhU2V0dGluZy5zZXR0aW5nRWwucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1pbmZvJyk/LnJlbW92ZSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gTWFrZSB0aGUgY29udHJvbCB0YWtlIGZ1bGwgd2lkdGhcbiAgICAgICAgY29uc3QgY29udHJvbCA9IHRleHRBcmVhU2V0dGluZy5zZXR0aW5nRWwucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1jb250cm9sJyk7XG4gICAgICAgIGlmIChjb250cm9sIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnRyb2wuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdXR0b25zIHVzaW5nIFNldHRpbmcgY29tcG9uZW50XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnVHJhbnNmb3JtIFRleHQnKVxuICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHRoaXMuc3VibWl0KCkpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN1Ym1pdCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaW5zdHJ1Y3Rpb24udHJpbSgpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMuaW5zdHJ1Y3Rpb24udHJpbSgpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG59IiwgImltcG9ydCB7IEFJUHJvdmlkZXIsIEFJTWVzc2FnZSwgQUlHZW5lcmF0aW9uT3B0aW9ucywgQUlTdHJlYW1SZXNwb25zZSwgUHJvdmlkZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyByZXF1ZXN0VXJsIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgQ2xhdWRlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdDbGF1ZGUgKEFudGhyb3BpYyknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyBjaGF0Q29tcGxldGlvbihtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlcXVlc3RCb2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdjbGF1ZGUtMy01LWhhaWt1LWxhdGVzdCcsXG5cdFx0XHRtYXhfdG9rZW5zOiBvcHRpb25zPy5tYXhUb2tlbnMgfHwgdGhpcy5jb25maWcubWF4VG9rZW5zLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlIHx8IHRoaXMuY29uZmlnLnRlbXBlcmF0dXJlLFxuXHRcdFx0c3lzdGVtOiBvcHRpb25zPy5zeXN0ZW1Qcm9tcHQsXG5cdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRyb2xlOiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnYXNzaXN0YW50JyA6ICd1c2VyJyxcblx0XHRcdFx0Y29udGVudDogbXNnLmNvbnRlbnRcblx0XHRcdH0pKVxuXHRcdH0pO1xuXG5cdFx0Ly8gUmV0cnkgbG9naWMgZm9yIDUwMC1sZXZlbCBlcnJvcnNcblx0XHRjb25zdCBtYXhSZXRyaWVzID0gMztcblx0XHRjb25zdCBiYXNlRGVsYXkgPSAxMDAwOyAvLyAxIHNlY29uZFxuXG5cdFx0Zm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0XHRcdHVybDogJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLFxuXHRcdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG5cdFx0XHRcdFx0XHQneC1hcGkta2V5JzogdGhpcy5jb25maWcuYXBpS2V5LFxuXHRcdFx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRib2R5OiByZXF1ZXN0Qm9keVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcblx0XHRcdFx0XHRjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbjtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YS5jb250ZW50WzBdLnRleHQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgNTAwLWxldmVsIGVycm9yIHRoYXQgd2Ugc2hvdWxkIHJldHJ5XG5cdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPj0gNTAwICYmIGF0dGVtcHQgPCBtYXhSZXRyaWVzKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTsgLy8gRXhwb25lbnRpYWwgYmFja29mZlxuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlOyAvLyBSZXRyeVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRm9yIGFsbCBvdGhlciBlcnJvcnMgb3IgZmluYWwgYXR0ZW1wdCwgdGhyb3cgZXJyb3Jcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBDbGF1ZGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gLSAke3Jlc3BvbnNlLnRleHR9YCk7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdC8vIE5ldHdvcmsvY29ubmVjdGlvbiBlcnJvcnMgLSByZXRyeSBpZiBub3QgZmluYWwgYXR0ZW1wdFxuXHRcdFx0XHRpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMgJiYgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiAoXG5cdFx0XHRcdFx0ZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnTmV0d29yayBlcnJvcicpIHx8IFxuXHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0ZhaWxlZCB0byBjb25uZWN0Jylcblx0XHRcdFx0KSkge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7XG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIFJlLXRocm93IHRoZSBlcnJvciBpZiBpdCdzIHRoZSBmaW5hbCBhdHRlbXB0IG9yIG5vdCBhIHJldHJ5YWJsZSBlcnJvclxuXHRcdFx0XHRpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLnN0YXJ0c1dpdGgoJ0NsYXVkZSBBUEkgZXJyb3I6JykpIHtcblx0XHRcdFx0XHR0aHJvdyBlcnJvcjsgLy8gQWxyZWFkeSBmb3JtYXR0ZWQgZXJyb3Jcblx0XHRcdFx0fVxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjb25uZWN0IHRvIENsYXVkZSBBUEk6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnTmV0d29yayBlcnJvcid9YCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gVGhpcyBzaG91bGQgbmV2ZXIgYmUgcmVhY2hlZCwgYnV0IFR5cGVTY3JpcHQgd2FudHMgaXRcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEk6IE1heGltdW0gcmV0cmllcyBleGNlZWRlZCcpO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Ly8gR2V0IHRoZSBmdWxsIHJlc3BvbnNlIGZyb20gQ2xhdWRlLCB0aGVuIHNpbXVsYXRlIHN0cmVhbWluZyB3aXRoIGNvbnNpc3RlbnQgY2h1bmtpbmdcblx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0XHRcblx0XHQvLyBTcGxpdCByZXN1bHQgaW50byBzbWFsbGVyIGNodW5rcyBmb3IgY29uc2lzdGVudCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdGNvbnN0IGNodW5rU2l6ZSA9IDM7IC8vIENoYXJhY3RlcnMgcGVyIGNodW5rXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuXHRcdFx0Y29uc3QgY2h1bmsgPSByZXN1bHQuc2xpY2UoaSwgaSArIGNodW5rU2l6ZSk7XG5cdFx0XHR5aWVsZCB7IGNvbnRlbnQ6IGNodW5rLCBkb25lOiBmYWxzZSB9O1xuXHRcdFx0Ly8gU21hbGwgZGVsYXkgYmV0d2VlbiBjaHVua3MgdG8gY3JlYXRlIHNtb290aCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwKSk7XG5cdFx0fVxuXHRcdFxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gQ2xhdWRlIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdDbGF1ZGUgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHQvLyBGb3IgQ2xhdWRlLCB3ZSdsbCB1c2UgYSBoYXJkY29kZWQgbGlzdCBzaW5jZSBBbnRocm9waWMgZG9lc24ndCBwcm92aWRlIGEgbW9kZWxzIGVuZHBvaW50XG5cdFx0Ly8gQnV0IHdlIGNhbiB2YWxpZGF0ZSB0aGUgQVBJIGtleSBieSBtYWtpbmcgYSB0ZXN0IGNhbGxcblx0XHR0cnkge1xuXHRcdFx0Ly8gVmFsaWRhdGUgQVBJIGtleSB3aXRoIGEgbWluaW1hbCByZXF1ZXN0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0XHR1cmw6ICdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJyxcblx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHRcdCd4LWFwaS1rZXknOiB0aGlzLmNvbmZpZy5hcGlLZXksXG5cdFx0XHRcdFx0J2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0XHRtb2RlbDogJ2NsYXVkZS0zLTUtaGFpa3UtbGF0ZXN0Jyxcblx0XHRcdFx0XHRtYXhfdG9rZW5zOiAxLFxuXHRcdFx0XHRcdG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICd0ZXN0JyB9XVxuXHRcdFx0XHR9KVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSBrZXkgdmFsaWRhdGlvbiBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7cmVzcG9uc2UudGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmV0dXJuIGN1cnJlbnQgYXZhaWxhYmxlIG1vZGVscyAoZnJvbSBBUEkgZG9jcylcblx0XHRcdGNvbnN0IG1vZGVscyA9IFtcblx0XHRcdFx0J2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnLFxuXHRcdFx0XHQnY2xhdWRlLXNvbm5ldC00LTIwMjUwNTE0Jyxcblx0XHRcdFx0J2NsYXVkZS0zLTctc29ubmV0LWxhdGVzdCcsXG5cdFx0XHRcdCdjbGF1ZGUtMy01LXNvbm5ldC1sYXRlc3QnLFxuXHRcdFx0XHQnY2xhdWRlLTMtNS1oYWlrdS1sYXRlc3QnXG5cdFx0XHRdO1xuXG5cdFx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG1vZGVscztcblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIENsYXVkZSBtb2RlbHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIENsZWFyIGNhY2hlZCBtb2RlbHNcblx0ICovXG5cdGNsZWFyTW9kZWxDYWNoZSgpOiB2b2lkIHtcblx0XHR0aGlzLmNhY2hlZE1vZGVscyA9IG51bGw7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNZXNzYWdlLCBBSUdlbmVyYXRpb25PcHRpb25zLCBBSVN0cmVhbVJlc3BvbnNlLCBQcm92aWRlckNvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE9wZW5BSVByb3ZpZGVyIGltcGxlbWVudHMgQUlQcm92aWRlciB7XG5cdG5hbWUgPSAnT3BlbkFJJztcblx0cHJpdmF0ZSBjb25maWc6IFByb3ZpZGVyQ29uZmlnO1xuXHRwcml2YXRlIGNhY2hlZE1vZGVsczogc3RyaW5nW10gfCBudWxsID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0cmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5O1xuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0cmV0dXJuIHRoaXMuY2hhdENvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmdlbmVyYXRlVGV4dFN0cmVhbShwcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgbWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV07XG5cdFx0eWllbGQqIHRoaXMuY2hhdENvbXBsZXRpb25TdHJlYW0obWVzc2FnZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXF1ZXN0TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGlmIChvcHRpb25zPy5zeXN0ZW1Qcm9tcHQpIHtcblx0XHRcdHJlcXVlc3RNZXNzYWdlcy51bnNoaWZ0KHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJztcblx0XHRjb25zdCBlbmRwb2ludCA9IGJhc2VVcmwuZW5kc1dpdGgoJy9jaGF0L2NvbXBsZXRpb25zJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2A7XG5cdFx0XG5cdFx0Y29uc3QgcmVxdWVzdEJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRtb2RlbDogb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dwdC0zLjUtdHVyYm8nLFxuXHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdG1heF90b2tlbnM6IG9wdGlvbnM/Lm1heFRva2Vucyxcblx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZVxuXHRcdH0pO1xuXG5cdFx0Ly8gUmV0cnkgbG9naWMgZm9yIDUwMC1sZXZlbCBlcnJvcnNcblx0XHRjb25zdCBtYXhSZXRyaWVzID0gMztcblx0XHRjb25zdCBiYXNlRGVsYXkgPSAxMDAwOyAvLyAxIHNlY29uZFxuXG5cdFx0Zm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG5cdFx0XHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblx0XHRcdFx0XHRcdCdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLmFwaUtleX1gXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRib2R5OiByZXF1ZXN0Qm9keVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAocmVzcG9uc2Uub2spIHtcblx0XHRcdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIDUwMC1sZXZlbCBlcnJvciB0aGF0IHdlIHNob3VsZCByZXRyeVxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCAmJiBhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuXHRcdFx0XHRcdGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5ICogTWF0aC5wb3coMiwgYXR0ZW1wdCk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcblx0XHRcdFx0XHRjb250aW51ZTsgLy8gUmV0cnlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEZvciBhbGwgb3RoZXIgZXJyb3JzIG9yIGZpbmFsIGF0dGVtcHQsIHRocm93IGVycm9yXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvLyBOZXR3b3JrIGVycm9ycyAtIHJldHJ5IGlmIG5vdCBmaW5hbCBhdHRlbXB0XG5cdFx0XHRcdGlmIChhdHRlbXB0IDwgbWF4UmV0cmllcyAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ2ZldGNoJykpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGJhc2VEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZS10aHJvdyB0aGUgZXJyb3IgaWYgaXQncyB0aGUgZmluYWwgYXR0ZW1wdCBvciBub3QgYSBuZXR3b3JrIGVycm9yXG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFRoaXMgc2hvdWxkIG5ldmVyIGJlIHJlYWNoZWQsIGJ1dCBUeXBlU2NyaXB0IHdhbnRzIGl0XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJOiBNYXhpbXVtIHJldHJpZXMgZXhjZWVkZWQnKTtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVxdWVzdE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRpZiAob3B0aW9ucz8uc3lzdGVtUHJvbXB0KSB7XG5cdFx0XHRyZXF1ZXN0TWVzc2FnZXMudW5zaGlmdCh7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBvcHRpb25zLnN5c3RlbVByb21wdCB9KTtcblx0XHR9XG5cblx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSc7XG5cdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvY2hhdC9jb21wbGV0aW9ucycpID8gYmFzZVVybCA6IGAke2Jhc2VVcmx9L2NoYXQvY29tcGxldGlvbnNgO1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuXHRcdFx0XHQnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YFxuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0bW9kZWw6IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdncHQtMy41LXR1cmJvJyxcblx0XHRcdFx0bWVzc2FnZXM6IHJlcXVlc3RNZXNzYWdlcyxcblx0XHRcdFx0bWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zLFxuXHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRzdHJlYW06IHRydWVcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCByZWFkZXIgPSByZXNwb25zZS5ib2R5Py5nZXRSZWFkZXIoKTtcblx0XHRpZiAoIXJlYWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlc3BvbnNlIHJlYWRlcicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblx0XHRsZXQgYnVmZmVyID0gJyc7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0YnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG5cblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhcnRzV2l0aCgnZGF0YTogJykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG5cdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gcGFyc2VkLmNob2ljZXM/LlswXT8uZGVsdGE/LmNvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgY29udGVudCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciBjb25zaXN0ZW50IHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRlbnQubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmsgPSBjb250ZW50LnNsaWNlKGksIGkgKyBjaHVua1NpemUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gY2h1bmtzIHRvIGNyZWF0ZSBzbW9vdGggdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMCkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGZXRjaCBhdmFpbGFibGUgbW9kZWxzIGZyb20gT3BlbkFJIEFQSVxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcblx0XHRpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuXHRcdH1cblxuXHRcdC8vIElmIHdlIGhhdmUgY2FjaGVkIG1vZGVscywgcmV0dXJuIHRoZW1cblx0XHRpZiAodGhpcy5jYWNoZWRNb2RlbHMpIHtcblx0XHRcdHJldHVybiB0aGlzLmNhY2hlZE1vZGVscztcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnO1xuXHRcdFx0Y29uc3QgZW5kcG9pbnQgPSBiYXNlVXJsLmVuZHNXaXRoKCcvbW9kZWxzJykgPyBiYXNlVXJsIDogYCR7YmFzZVVybH0vbW9kZWxzYDtcblx0XHRcdFxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWBcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBUEkgcmVxdWVzdCBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFxuXHRcdFx0Ly8gUmV0dXJuIGhhcmRjb2RlZCBjdXJyZW50IG1vZGVsc1xuXHRcdFx0Y29uc3QgbW9kZWxzID0gW1xuXHRcdFx0XHQnZ3B0LTQuMS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbWluaS0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00LjEtbmFuby0yMDI1LTA0LTE0Jyxcblx0XHRcdFx0J2dwdC00bycsXG5cdFx0XHRcdCdncHQtNG8tbWluaSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggT3BlbkFJIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgR29vZ2xlUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdHb29nbGUgKEdlbWluaSknO1xuXHRwcml2YXRlIGNvbmZpZzogUHJvdmlkZXJDb25maWc7XG5cdHByaXZhdGUgY2FjaGVkTW9kZWxzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xuXG5cdGNvbnN0cnVjdG9yKGNvbmZpZzogUHJvdmlkZXJDb25maWcpIHtcblx0XHR0aGlzLmNvbmZpZyA9IGNvbmZpZztcblx0fVxuXG5cdHVwZGF0ZUNvbmZpZyhjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHRhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRyZXR1cm4gISF0aGlzLmNvbmZpZy5hcGlLZXk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHRyZXR1cm4gdGhpcy5jaGF0Q29tcGxldGlvbihtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRhc3luYyAqZ2VuZXJhdGVUZXh0U3RyZWFtKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IEFzeW5jR2VuZXJhdG9yPEFJU3RyZWFtUmVzcG9uc2U+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XTtcblx0XHR5aWVsZCogdGhpcy5jaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlcywgb3B0aW9ucyk7XG5cdH1cblxuXHRwcml2YXRlIGZvcm1hdE1lc3NhZ2VzRm9yR2VtaW5pKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSk6IGFueSB7XG5cdFx0Y29uc3QgY29udGVudHMgPSBbXTtcblxuXHRcdGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuXHRcdFx0Y29uc3Qgcm9sZSA9IG1lc3NhZ2Uucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnbW9kZWwnIDogJ3VzZXInO1xuXHRcdFx0Y29udGVudHMucHVzaCh7XG5cdFx0XHRcdHJvbGUsXG5cdFx0XHRcdHBhcnRzOiBbeyB0ZXh0OiBtZXNzYWdlLmNvbnRlbnQgfV1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEVuc3VyZSB3ZSBoYXZlIGF0IGxlYXN0IG9uZSBtZXNzYWdlXG5cdFx0aWYgKGNvbnRlbnRzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdObyBtZXNzYWdlcyBwcm92aWRlZCBmb3IgR29vZ2xlIEFQSScpO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb250ZW50cztcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5jb25maWcuYXBpS2V5KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0dvb2dsZSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG5cdFx0fVxuXG5cdFx0Ly8gVXNlIGEgbmV3ZXIgbW9kZWwgYnkgZGVmYXVsdCBpZiBubyBtb2RlbCBpcyBzcGVjaWZpZWRcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsIHx8ICdnZW1pbmktMi4wLWZsYXNoJztcblx0XHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7dGhpcy5jb25maWcuYXBpS2V5fWA7XG5cdFx0XG5cblx0XHRjb25zdCByZXF1ZXN0Qm9keTogYW55ID0ge1xuXHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMpLFxuXHRcdFx0Z2VuZXJhdGlvbkNvbmZpZzoge1xuXHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUsXG5cdFx0XHRcdG1heE91dHB1dFRva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIEFkZCBzeXN0ZW0gaW5zdHJ1Y3Rpb24gaWYgcHJvdmlkZWQgKEdvb2dsZSdzIHByb3BlciBmb3JtYXQpXG5cdFx0aWYgKG9wdGlvbnM/LnN5c3RlbVByb21wdCAmJiBvcHRpb25zLnN5c3RlbVByb21wdC50cmltKCkpIHtcblx0XHRcdHJlcXVlc3RCb2R5LnN5c3RlbUluc3RydWN0aW9uID0ge1xuXHRcdFx0XHRwYXJ0czogW3sgdGV4dDogb3B0aW9ucy5zeXN0ZW1Qcm9tcHQgfV1cblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG5cdFx0XHR9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHRjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG5cdFx0XHRsZXQgZXJyb3JNZXNzYWdlID0gJyc7XG5cdFx0XHRcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IGVycm9yRGF0YSA9IEpTT04ucGFyc2UoZXJyb3JUZXh0KTtcblx0XHRcdFx0aWYgKGVycm9yRGF0YS5lcnJvcikge1xuXHRcdFx0XHRcdC8vIEZvcm1hdCBhcyBbQ09ERV06IG1lc3NhZ2Vcblx0XHRcdFx0XHRjb25zdCBjb2RlID0gZXJyb3JEYXRhLmVycm9yLmNvZGUgfHwgcmVzcG9uc2Uuc3RhdHVzO1xuXHRcdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSBlcnJvckRhdGEuZXJyb3IubWVzc2FnZSB8fCBlcnJvckRhdGEuZXJyb3Iuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1c1RleHQ7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske2NvZGV9XTogJHttZXNzYWdlfWA7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gQWRkIHNwZWNpZmljIGd1aWRhbmNlIGZvciBjb21tb24gZXJyb3JzXG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKSB7XG5cdFx0XHRcdFx0XHRlcnJvck1lc3NhZ2UgKz0gJyAoQ2hlY2sgcmVxdWVzdCBmb3JtYXQgb3IgbW9kZWwgbmFtZSknO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblx0XHRcdFx0XHRcdGVycm9yTWVzc2FnZSArPSAnIChDaGVjayBBUEkga2V5IGluIHNldHRpbmdzKSc7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuXHRcdFx0XHRcdFx0ZXJyb3JNZXNzYWdlICs9ICcgKE1vZGVsIG1heSBub3QgYmUgYXZhaWxhYmxlKSc7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQyOSkge1xuXHRcdFx0XHRcdFx0ZXJyb3JNZXNzYWdlICs9ICcgKFJhdGUgbGltaXQgZXhjZWVkZWQpJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske3Jlc3BvbnNlLnN0YXR1c31dOiAke2Vycm9yVGV4dH1gO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtyZXNwb25zZS5zdGF0dXN9XTogJHtlcnJvclRleHQgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dH1gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBMb2cgZGV0YWlsZWQgZXJyb3IgZm9yIGRlYnVnZ2luZ1xuXHRcdFx0Y29uc29sZS5lcnJvcignR29vZ2xlIEFQSSBFcnJvciBEZXRhaWxzOicsIHtcblx0XHRcdFx0c3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG5cdFx0XHRcdHN0YXR1c1RleHQ6IHJlc3BvbnNlLnN0YXR1c1RleHQsXG5cdFx0XHRcdGVycm9yVGV4dDogZXJyb3JUZXh0LFxuXHRcdFx0XHRyZXF1ZXN0Qm9keTogcmVxdWVzdEJvZHksXG5cdFx0XHRcdG1vZGVsOiBtb2RlbCxcblx0XHRcdFx0dXJsOiB1cmxcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3IgJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcblx0XHRcblx0XHQvLyBDaGVjayBpZiByZXNwb25zZSBoYXMgdmFsaWQgc3RydWN0dXJlXG5cdFx0aWYgKCFkYXRhLmNhbmRpZGF0ZXMgfHwgZGF0YS5jYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhbiBlcnJvciBtZXNzYWdlIGluIHRoZSByZXNwb25zZVxuXHRcdFx0aWYgKGRhdGEuZXJyb3IpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQVBJIGVycm9yOiAke2RhdGEuZXJyb3IubWVzc2FnZSB8fCBKU09OLnN0cmluZ2lmeShkYXRhLmVycm9yKX1gKTtcblx0XHRcdH1cblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBubyBjYW5kaWRhdGVzJyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRoZSByZXNwb25zZSB3YXMgYmxvY2tlZCBvciBmaWx0ZXJlZFxuXHRcdGlmIChkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnU0FGRVRZJyB8fCBkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnQkxPQ0tFRCcpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBibG9ja2VkIHRoZSByZXNwb25zZSBkdWUgdG8gc2FmZXR5IGZpbHRlcnMnKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgd2UgaGl0IHRoZSB0b2tlbiBsaW1pdCBiZWZvcmUgZ2VuZXJhdGluZyBjb250ZW50XG5cdFx0aWYgKGRhdGEuY2FuZGlkYXRlc1swXS5maW5pc2hSZWFzb24gPT09ICdNQVhfVE9LRU5TJyAmJiBcblx0XHQgICAgKCFkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudCB8fCAhZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMgfHwgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMubGVuZ3RoID09PSAwKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdBUEkgaGl0IHRva2VuIGxpbWl0IGJlZm9yZSBnZW5lcmF0aW5nIGFueSBjb250ZW50LiBQbGVhc2UgaW5jcmVhc2UgXCJEZWZhdWx0IE1heCBUb2tlbnNcIiBpbiBzZXR0aW5ncy4nKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgcmVzcG9uc2UgaGFzIGNvbnRlbnRcblx0XHRpZiAoZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQgJiYgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMgJiYgZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgdGV4dCA9IGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG5cdFx0XHRcblx0XHRcdFxuXHRcdFx0Ly8gSWYgcmVzcG9uc2Ugd2FzIHRydW5jYXRlZCwgdGhyb3cgZXJyb3IgaW5zdGVhZCBvZiByZXR1cm5pbmcgcGFydGlhbCBjb250ZW50XG5cdFx0XHRpZiAoZGF0YS5jYW5kaWRhdGVzWzBdLmZpbmlzaFJlYXNvbiA9PT0gJ01BWF9UT0tFTlMnKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignUmVzcG9uc2Ugd2FzIHRydW5jYXRlZCBkdWUgdG8gdG9rZW4gbGltaXQuIFBsZWFzZSBpbmNyZWFzZSBcIkRlZmF1bHQgTWF4IFRva2Vuc1wiIGluIHNldHRpbmdzLicpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhY3R1YWwgdGV4dCBjb250ZW50XG5cdFx0XHRpZiAoIXRleHQgfHwgdGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0dvb2dsZSBBUEkgcmV0dXJuZWQgZW1wdHkgdGV4dCBjb250ZW50Jyk7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBlbXB0eSB0ZXh0IGNvbnRlbnQnKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmV0dXJuIHRleHQ7XG5cdFx0fVxuXHRcdFxuXHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSByZXR1cm5lZCBlbXB0eSByZXNwb25zZScpO1xuXHR9XG5cblx0YXN5bmMgY29tcGxldGUoc3lzdGVtUHJvbXB0OiBzdHJpbmcsIHVzZXJQcm9tcHQ6IHN0cmluZywgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlclByb21wdCB9XTtcblx0XHRjb25zdCBjb21wbGV0ZU9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIHN5c3RlbVByb21wdCB9O1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBjb21wbGV0ZU9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBVc2UgYSBuZXdlciBtb2RlbCBieSBkZWZhdWx0IGlmIG5vIG1vZGVsIGlzIHNwZWNpZmllZFxuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnO1xuXHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWx9OnN0cmVhbUdlbmVyYXRlQ29udGVudD9rZXk9JHt0aGlzLmNvbmZpZy5hcGlLZXl9YDtcblxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0fSxcblx0XHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0Y29udGVudHM6IHRoaXMuZm9ybWF0TWVzc2FnZXNGb3JHZW1pbmkobWVzc2FnZXMpLFxuXHRcdFx0XHRnZW5lcmF0aW9uQ29uZmlnOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRtYXhPdXRwdXRUb2tlbnM6IG9wdGlvbnM/Lm1heFRva2Vuc1xuXHRcdFx0XHR9LFxuXHRcdFx0XHQuLi4ob3B0aW9ucz8uc3lzdGVtUHJvbXB0ICYmIG9wdGlvbnMuc3lzdGVtUHJvbXB0LnRyaW0oKSA/IHtcblx0XHRcdFx0XHRzeXN0ZW1JbnN0cnVjdGlvbjoge1xuXHRcdFx0XHRcdFx0cGFydHM6IFt7IHRleHQ6IG9wdGlvbnMuc3lzdGVtUHJvbXB0IH1dXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IDoge30pXG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0Y29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXHRcdFx0bGV0IGVycm9yTWVzc2FnZSA9ICcnO1xuXHRcdFx0XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBlcnJvckRhdGEgPSBKU09OLnBhcnNlKGVycm9yVGV4dCk7XG5cdFx0XHRcdGlmIChlcnJvckRhdGEuZXJyb3IpIHtcblx0XHRcdFx0XHRjb25zdCBjb2RlID0gZXJyb3JEYXRhLmVycm9yLmNvZGUgfHwgcmVzcG9uc2Uuc3RhdHVzO1xuXHRcdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSBlcnJvckRhdGEuZXJyb3IubWVzc2FnZSB8fCBlcnJvckRhdGEuZXJyb3Iuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1c1RleHQ7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske2NvZGV9XTogJHttZXNzYWdlfWA7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXJyb3JNZXNzYWdlID0gYFske3Jlc3BvbnNlLnN0YXR1c31dOiAke2Vycm9yVGV4dH1gO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGVycm9yTWVzc2FnZSA9IGBbJHtyZXNwb25zZS5zdGF0dXN9XTogJHtlcnJvclRleHQgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dH1gO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEdvb2dsZSBBUEkgZXJyb3IgJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cdFx0bGV0IGJ1ZmZlciA9ICcnO1xuXHRcdGxldCBqc29uQnVmZmVyID0gJyc7XG5cdFx0bGV0IGJyYWNlQ291bnQgPSAwO1xuXHRcdGxldCBpbkpzb24gPSBmYWxzZTtcblxuXHRcdHRyeSB7XG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXHRcdFx0XHRpZiAoZG9uZSkgYnJlYWs7XG5cblx0XHRcdFx0YnVmZmVyICs9IGRlY29kZXIuZGVjb2RlKHZhbHVlLCB7IHN0cmVhbTogdHJ1ZSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIFByb2Nlc3MgY2hhcmFjdGVyIGJ5IGNoYXJhY3RlciB0byBwcm9wZXJseSBwYXJzZSB0aGUgc3RyZWFtaW5nIEpTT05cblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRjb25zdCBjaGFyID0gYnVmZmVyW2ldO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChjaGFyID09PSAneycpIHtcblx0XHRcdFx0XHRcdGlmICghaW5Kc29uKSB7XG5cdFx0XHRcdFx0XHRcdGluSnNvbiA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGpzb25CdWZmZXIgPSAnJztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyYWNlQ291bnQrKztcblx0XHRcdFx0XHRcdGpzb25CdWZmZXIgKz0gY2hhcjtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGNoYXIgPT09ICd9Jykge1xuXHRcdFx0XHRcdFx0anNvbkJ1ZmZlciArPSBjaGFyO1xuXHRcdFx0XHRcdFx0YnJhY2VDb3VudC0tO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAoYnJhY2VDb3VudCA9PT0gMCAmJiBpbkpzb24pIHtcblx0XHRcdFx0XHRcdFx0Ly8gV2UgaGF2ZSBhIGNvbXBsZXRlIEpTT04gb2JqZWN0XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uQnVmZmVyKTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCB0ZXh0ID0gcGFyc2VkLmNhbmRpZGF0ZXM/LlswXT8uY29udGVudD8ucGFydHM/LlswXT8udGV4dDtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGV4dCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgdGV4dCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNodW5rID0gdGV4dC5zbGljZShpLCBpICsgY2h1bmtTaXplKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgYmV0d2VlbiBjaHVua3MgdG8gY3JlYXRlIHNtb290aCB0eXBld3JpdGVyIGVmZmVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjApKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdGluSnNvbiA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRqc29uQnVmZmVyID0gJyc7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChpbkpzb24pIHtcblx0XHRcdFx0XHRcdGpzb25CdWZmZXIgKz0gY2hhcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIENsZWFyIHRoZSBwcm9jZXNzZWQgYnVmZmVyXG5cdFx0XHRcdGJ1ZmZlciA9ICcnO1xuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRyZWFkZXIucmVsZWFzZUxvY2soKTtcblx0XHR9XG5cblx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdH1cblxuXHQvKipcblx0ICogRmV0Y2ggYXZhaWxhYmxlIG1vZGVscyBmcm9tIEdvb2dsZSBBUElcblx0ICovXG5cdGFzeW5jIGdldEF2YWlsYWJsZU1vZGVscygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtb2RlbHMsIHJldHVybiB0aGVtXG5cdFx0aWYgKHRoaXMuY2FjaGVkTW9kZWxzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jYWNoZWRNb2RlbHM7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzP2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gO1xuXHRcdFx0XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XG5cdFx0XHQvLyBSZXR1cm4gaGFyZGNvZGVkIGN1cnJlbnQgbW9kZWxzXG5cdFx0XHRjb25zdCBtb2RlbHMgPSBbXG5cdFx0XHRcdCdnZW1pbmktMi41LWZsYXNoLXByZXZpZXctMDQtMTcnLFxuXHRcdFx0XHQnZ2VtaW5pLTIuNS1wcm8tcHJldmlldy0wMy0yNScsXG5cdFx0XHRcdCdnZW1pbmktMi4wLWZsYXNoJyxcblx0XHRcdFx0J2dlbWluaS0yLjAtZmxhc2gtbGl0ZSdcblx0XHRcdF07XG5cblx0XHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbW9kZWxzO1xuXHRcdFx0cmV0dXJuIG1vZGVscztcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggR29vZ2xlIG1vZGVsczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXIgY2FjaGVkIG1vZGVsc1xuXHQgKi9cblx0Y2xlYXJNb2RlbENhY2hlKCk6IHZvaWQge1xuXHRcdHRoaXMuY2FjaGVkTW9kZWxzID0gbnVsbDtcblx0fVxufSIsICJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIFByb3ZpZGVyQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgT2xsYW1hUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcblx0bmFtZSA9ICdPbGxhbWEgKExvY2FsKSc7XG5cdHByaXZhdGUgY29uZmlnOiBQcm92aWRlckNvbmZpZztcblxuXHRjb25zdHJ1Y3Rvcihjb25maWc6IFByb3ZpZGVyQ29uZmlnKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdH1cblxuXHR1cGRhdGVDb25maWcoY29uZmlnOiBQcm92aWRlckNvbmZpZykge1xuXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xuXHR9XG5cblx0YXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0aWYgKCF0aGlzLmNvbmZpZy5tb2RlbCkgcmV0dXJuIGZhbHNlOyAvLyBSZXF1aXJlIG1vZGVsIHRvIGJlIHNldFxuXHRcdFxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBiYXNlVXJsID0gdGhpcy5jb25maWcuYmFzZVVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDoxMTQzNCc7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS90YWdzYCwge1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHRoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2Uub2s7XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgYmFzZVVybCA9IHRoaXMuY29uZmlnLmJhc2VVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXHRcdGNvbnN0IG1vZGVsID0gb3B0aW9ucz8ubW9kZWwgfHwgdGhpcy5jb25maWcubW9kZWw7XG5cdFx0aWYgKCFtb2RlbCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPbGxhbWEgbW9kZWwgbXVzdCBiZSBzcGVjaWZpZWQnKTtcblx0XHR9XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRwcm9tcHQsXG5cdFx0XHRcdHN0cmVhbTogZmFsc2UsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2Vuc1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRyZXR1cm4gZGF0YS5yZXNwb25zZTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvZ2VuZXJhdGVgLCB7XG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuXHRcdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHRtb2RlbCxcblx0XHRcdFx0cHJvbXB0LFxuXHRcdFx0XHRzdHJlYW06IHRydWUsXG5cdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHR0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUsXG5cdFx0XHRcdFx0bnVtX3ByZWRpY3Q6IG9wdGlvbnM/Lm1heFRva2Vuc1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0aWYgKCFyZXNwb25zZS5vaykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG5cdFx0aWYgKCFyZWFkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCByZXNwb25zZSByZWFkZXInKTtcblx0XHR9XG5cblx0XHRjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG5cblx0XHR0cnkge1xuXHRcdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdFx0Y29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcblx0XHRcdFx0aWYgKGRvbmUpIGJyZWFrO1xuXG5cdFx0XHRcdGNvbnN0IGxpbmVzID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpLnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUudHJpbSgpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLnJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgdGV4dCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciBjb25zaXN0ZW50IHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHBhcnNlZC5yZXNwb25zZS5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaHVuayA9IHBhcnNlZC5yZXNwb25zZS5zbGljZShpLCBpICsgY2h1bmtTaXplKTtcblx0XHRcdFx0XHRcdFx0XHRcdHlpZWxkIHsgY29udGVudDogY2h1bmssIGRvbmU6IGZhbHNlIH07XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTbWFsbCBkZWxheSBiZXR3ZWVuIGNodW5rcyB0byBjcmVhdGUgc21vb3RoIHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjApKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5kb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBTa2lwIG1hbGZvcm1lZCBKU09OXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdHJlYWRlci5yZWxlYXNlTG9jaygpO1xuXHRcdH1cblxuXHRcdHlpZWxkIHsgY29udGVudDogJycsIGRvbmU6IHRydWUgfTtcblx0fVxuXG5cdGFzeW5jIGNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiBmYWxzZSxcblx0XHRcdFx0b3B0aW9uczoge1xuXHRcdFx0XHRcdHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSxcblx0XHRcdFx0XHRudW1fcHJlZGljdDogb3B0aW9ucz8ubWF4VG9rZW5zXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHRpZiAoIXJlc3BvbnNlLm9rKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE9sbGFtYSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblx0XHR9XG5cblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHJldHVybiBkYXRhLm1lc3NhZ2UuY29udGVudDtcblx0fVxuXG5cdGFzeW5jIGNvbXBsZXRlKHN5c3RlbVByb21wdDogc3RyaW5nLCB1c2VyUHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBtZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXG5cdFx0XHR7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcblx0XHRcdHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiB1c2VyUHJvbXB0IH1cblx0XHRdO1xuXHRcdHJldHVybiB0aGlzLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBvcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpjaGF0Q29tcGxldGlvblN0cmVhbShtZXNzYWdlczogQUlNZXNzYWdlW10sIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IGJhc2VVcmwgPSB0aGlzLmNvbmZpZy5iYXNlVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0Jztcblx0XHRjb25zdCBtb2RlbCA9IG9wdGlvbnM/Lm1vZGVsIHx8IHRoaXMuY29uZmlnLm1vZGVsO1xuXHRcdGlmICghbW9kZWwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT2xsYW1hIG1vZGVsIG11c3QgYmUgc3BlY2lmaWVkJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hcGkvY2hhdGAsIHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0aGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG5cdFx0XHRib2R5OiBKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdG1vZGVsLFxuXHRcdFx0XHRtZXNzYWdlczogbWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuXHRcdFx0XHRcdHJvbGU6IG1zZy5yb2xlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IG1zZy5jb250ZW50XG5cdFx0XHRcdH0pKSxcblx0XHRcdFx0c3RyZWFtOiB0cnVlLFxuXHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0dGVtcGVyYXR1cmU6IG9wdGlvbnM/LnRlbXBlcmF0dXJlLFxuXHRcdFx0XHRcdG51bV9wcmVkaWN0OiBvcHRpb25zPy5tYXhUb2tlbnNcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9KTtcblxuXHRcdGlmICghcmVzcG9uc2Uub2spIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuXHRcdGlmICghcmVhZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UgcmVhZGVyJyk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHdoaWxlICh0cnVlKSB7XG5cdFx0XHRcdGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG5cdFx0XHRcdGlmIChkb25lKSBicmVhaztcblxuXHRcdFx0XHRjb25zdCBsaW5lcyA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKS5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0XHRcdGlmIChsaW5lLnRyaW0oKSkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShsaW5lKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlZC5tZXNzYWdlPy5jb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgdGV4dCBpbnRvIHNtYWxsZXIgY2h1bmtzIGZvciBjb25zaXN0ZW50IHR5cGV3cml0ZXIgZWZmZWN0XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmtTaXplID0gMzsgLy8gQ2hhcmFjdGVycyBwZXIgY2h1bmtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHBhcnNlZC5tZXNzYWdlLmNvbnRlbnQubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgY2h1bmsgPSBwYXJzZWQubWVzc2FnZS5jb250ZW50LnNsaWNlKGksIGkgKyBjaHVua1NpemUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0eWllbGQgeyBjb250ZW50OiBjaHVuaywgZG9uZTogZmFsc2UgfTtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gY2h1bmtzIHRvIGNyZWF0ZSBzbW9vdGggdHlwZXdyaXRlciBlZmZlY3Rcblx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMCkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocGFyc2VkLmRvbmUpIHtcblx0XHRcdFx0XHRcdFx0XHR5aWVsZCB7IGNvbnRlbnQ6ICcnLCBkb25lOiB0cnVlIH07XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNraXAgbWFsZm9ybWVkIEpTT05cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGZpbmFsbHkge1xuXHRcdFx0cmVhZGVyLnJlbGVhc2VMb2NrKCk7XG5cdFx0fVxuXG5cdFx0eWllbGQgeyBjb250ZW50OiAnJywgZG9uZTogdHJ1ZSB9O1xuXHR9XG59IiwgImltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQUlQcm92aWRlciwgUHJvdmlkZXJUeXBlLCBBSU1lc3NhZ2UsIEFJR2VuZXJhdGlvbk9wdGlvbnMsIEFJU3RyZWFtUmVzcG9uc2UsIEFJUHJvdmlkZXJTZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ2xhdWRlUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9jbGF1ZGUnO1xuaW1wb3J0IHsgT3BlbkFJUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9vcGVuYWknO1xuaW1wb3J0IHsgR29vZ2xlUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9nb29nbGUnO1xuaW1wb3J0IHsgT2xsYW1hUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9vbGxhbWEnO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgRmVhdHVyZU1hbmFnZXIgfSBmcm9tICcuLi9saWNlbnNpbmcvZmVhdHVyZS1tYW5hZ2VyJztcbmltcG9ydCB7IGdldFByb3ZpZGVyVHlwZUZvck1vZGVsIH0gZnJvbSAnLi9tb2RlbHMnO1xuXG5leHBvcnQgY2xhc3MgQUlQcm92aWRlck1hbmFnZXIge1xuXHRwcml2YXRlIHByb3ZpZGVyczogTWFwPFByb3ZpZGVyVHlwZSwgQUlQcm92aWRlcj4gPSBuZXcgTWFwKCk7XG5cdHByaXZhdGUgc2V0dGluZ3M6IE5vdmFTZXR0aW5ncztcblx0cHJpdmF0ZSBmZWF0dXJlTWFuYWdlcj86IEZlYXR1cmVNYW5hZ2VyO1xuXHRwcml2YXRlIGF2YWlsYWJpbGl0eUNhY2hlOiBNYXA8UHJvdmlkZXJUeXBlLCB7IGlzQXZhaWxhYmxlOiBib29sZWFuOyB0aW1lc3RhbXA6IG51bWJlciB9PiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSByZWFkb25seSBDQUNIRV9UVEwgPSAzMDAwMDsgLy8gMzAgc2Vjb25kc1xuXG5cdGNvbnN0cnVjdG9yKHNldHRpbmdzOiBOb3ZhU2V0dGluZ3MsIGZlYXR1cmVNYW5hZ2VyPzogRmVhdHVyZU1hbmFnZXIpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdFx0dGhpcy5mZWF0dXJlTWFuYWdlciA9IGZlYXR1cmVNYW5hZ2VyO1xuXHR9XG5cblx0YXN5bmMgaW5pdGlhbGl6ZSgpIHtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ2NsYXVkZScsIG5ldyBDbGF1ZGVQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLmNsYXVkZSkpO1xuXHRcdHRoaXMucHJvdmlkZXJzLnNldCgnb3BlbmFpJywgbmV3IE9wZW5BSVByb3ZpZGVyKHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMub3BlbmFpKSk7XG5cdFx0dGhpcy5wcm92aWRlcnMuc2V0KCdnb29nbGUnLCBuZXcgR29vZ2xlUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5haVByb3ZpZGVycy5nb29nbGUpKTtcblx0XHR0aGlzLnByb3ZpZGVycy5zZXQoJ29sbGFtYScsIG5ldyBPbGxhbWFQcm92aWRlcih0aGlzLnNldHRpbmdzLmFpUHJvdmlkZXJzLm9sbGFtYSkpO1xuXHR9XG5cblx0dXBkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IE5vdmFTZXR0aW5ncykge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR0aGlzLnByb3ZpZGVycy5mb3JFYWNoKChwcm92aWRlciwgdHlwZSkgPT4ge1xuXHRcdFx0aWYgKHR5cGUgIT09ICdub25lJyAmJiB0eXBlIGluIHRoaXMuc2V0dGluZ3MuYWlQcm92aWRlcnMpIHtcblx0XHRcdFx0cHJvdmlkZXIudXBkYXRlQ29uZmlnPy4odGhpcy5zZXR0aW5ncy5haVByb3ZpZGVyc1t0eXBlIGFzIGtleW9mIEFJUHJvdmlkZXJTZXR0aW5nc10pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdC8vIENsZWFyIGNhY2hlIHdoZW4gc2V0dGluZ3MgY2hhbmdlIHRvIGZvcmNlIHJlLWNoZWNrXG5cdFx0dGhpcy5hdmFpbGFiaWxpdHlDYWNoZS5jbGVhcigpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIHByb3ZpZGVyIGF2YWlsYWJpbGl0eSB3aXRoIGNhY2hpbmcgdG8gYXZvaWQgcmVwZWF0ZWQgbmV0d29yayBjYWxsc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBjaGVja1Byb3ZpZGVyQXZhaWxhYmlsaXR5KHByb3ZpZGVyVHlwZTogUHJvdmlkZXJUeXBlKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdFx0Y29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcblx0XHRjb25zdCBjYWNoZWQgPSB0aGlzLmF2YWlsYWJpbGl0eUNhY2hlLmdldChwcm92aWRlclR5cGUpO1xuXHRcdFxuXHRcdC8vIFJldHVybiBjYWNoZWQgcmVzdWx0IGlmIHN0aWxsIHZhbGlkXG5cdFx0aWYgKGNhY2hlZCAmJiAobm93IC0gY2FjaGVkLnRpbWVzdGFtcCkgPCB0aGlzLkNBQ0hFX1RUTCkge1xuXHRcdFx0cmV0dXJuIGNhY2hlZC5pc0F2YWlsYWJsZTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gR2V0IGZyZXNoIGF2YWlsYWJpbGl0eSBzdGF0dXNcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGNvbnN0IGlzQXZhaWxhYmxlID0gcHJvdmlkZXIgPyBhd2FpdCBwcm92aWRlci5pc0F2YWlsYWJsZSgpIDogZmFsc2U7XG5cdFx0XG5cdFx0Ly8gQ2FjaGUgdGhlIHJlc3VsdFxuXHRcdHRoaXMuYXZhaWxhYmlsaXR5Q2FjaGUuc2V0KHByb3ZpZGVyVHlwZSwge1xuXHRcdFx0aXNBdmFpbGFibGUsXG5cdFx0XHR0aW1lc3RhbXA6IG5vd1xuXHRcdH0pO1xuXHRcdFxuXHRcdHJldHVybiBpc0F2YWlsYWJsZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIHByb3ZpZGVyIHR5cGUgdGhhdCBoYW5kbGVzIGEgc3BlY2lmaWMgbW9kZWxcblx0ICovXG5cdHByaXZhdGUgZ2V0UHJvdmlkZXJGb3JNb2RlbChtb2RlbE5hbWU6IHN0cmluZyk6IFByb3ZpZGVyVHlwZSB8IG51bGwge1xuXHRcdHJldHVybiBnZXRQcm92aWRlclR5cGVGb3JNb2RlbChtb2RlbE5hbWUsIHRoaXMuc2V0dGluZ3MpIGFzIFByb3ZpZGVyVHlwZSB8IG51bGw7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBzZWxlY3RlZCBtb2RlbCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm1cblx0ICovXG5cdHByaXZhdGUgZ2V0U2VsZWN0ZWRNb2RlbCgpOiBzdHJpbmcge1xuXHRcdGNvbnN0IHBsYXRmb3JtID0gUGxhdGZvcm0uaXNNb2JpbGUgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJztcblx0XHRjb25zdCBzZWxlY3RlZE1vZGVsID0gdGhpcy5zZXR0aW5ncy5wbGF0Zm9ybVNldHRpbmdzW3BsYXRmb3JtXS5zZWxlY3RlZE1vZGVsO1xuXHRcdFxuXHRcdHJldHVybiBzZWxlY3RlZE1vZGVsO1xuXHR9XG5cblxuXHRwcml2YXRlIGFzeW5jIGdldEF2YWlsYWJsZVByb3ZpZGVyKCk6IFByb21pc2U8QUlQcm92aWRlciB8IG51bGw+IHtcblx0XHRjb25zdCBzZWxlY3RlZE1vZGVsID0gdGhpcy5nZXRTZWxlY3RlZE1vZGVsKCk7XG5cdFx0Y29uc3QgcHJvdmlkZXJUeXBlID0gdGhpcy5nZXRQcm92aWRlckZvck1vZGVsKHNlbGVjdGVkTW9kZWwpO1xuXHRcdFxuXHRcdGlmICghcHJvdmlkZXJUeXBlIHx8IHByb3ZpZGVyVHlwZSA9PT0gJ25vbmUnKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRjb25zdCBpc0F2YWlsYWJsZSA9IHByb3ZpZGVyID8gYXdhaXQgdGhpcy5jaGVja1Byb3ZpZGVyQXZhaWxhYmlsaXR5KHByb3ZpZGVyVHlwZSkgOiBmYWxzZTtcblx0XHRcblx0XHRpZiAocHJvdmlkZXIgJiYgaXNBdmFpbGFibGUpIHtcblx0XHRcdHJldHVybiBwcm92aWRlcjtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZVRleHQocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0QXZhaWxhYmxlUHJvdmlkZXIoKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdmEgaXMgZGlzYWJsZWQgb3Igbm8gQUkgcHJvdmlkZXIgaXMgYXZhaWxhYmxlJyk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEFsd2F5cyB1c2UgZ2xvYmFsIHNldHRpbmdzXG5cdFx0Y29uc3QgZW5oYW5jZWRPcHRpb25zOiBBSUdlbmVyYXRpb25PcHRpb25zID0ge1xuXHRcdFx0dGVtcGVyYXR1cmU6IHRoaXMuZ2V0RGVmYXVsdFRlbXBlcmF0dXJlKCksXG5cdFx0XHRtYXhUb2tlbnM6IHRoaXMuZ2V0RGVmYXVsdE1heFRva2VucygpXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gcHJvdmlkZXIuZ2VuZXJhdGVUZXh0KHByb21wdCwgZW5oYW5jZWRPcHRpb25zKTtcblx0fVxuXG5cdGFzeW5jICpnZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0OiBzdHJpbmcsIG9wdGlvbnM/OiBBSUdlbmVyYXRpb25PcHRpb25zKTogQXN5bmNHZW5lcmF0b3I8QUlTdHJlYW1SZXNwb25zZT4ge1xuXHRcdGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVQcm92aWRlcigpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm92YSBpcyBkaXNhYmxlZCBvciBubyBBSSBwcm92aWRlciBpcyBhdmFpbGFibGUnKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQWx3YXlzIHVzZSBnbG9iYWwgc2V0dGluZ3Ncblx0XHRjb25zdCBlbmhhbmNlZE9wdGlvbnM6IEFJR2VuZXJhdGlvbk9wdGlvbnMgPSB7XG5cdFx0XHR0ZW1wZXJhdHVyZTogdGhpcy5nZXREZWZhdWx0VGVtcGVyYXR1cmUoKSxcblx0XHRcdG1heFRva2VuczogdGhpcy5nZXREZWZhdWx0TWF4VG9rZW5zKClcblx0XHR9O1xuXHRcdFxuXHRcdHlpZWxkKiBwcm92aWRlci5nZW5lcmF0ZVRleHRTdHJlYW0ocHJvbXB0LCBlbmhhbmNlZE9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgY2hhdENvbXBsZXRpb24obWVzc2FnZXM6IEFJTWVzc2FnZVtdLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBBbHdheXMgdXNlIGdsb2JhbCBzZXR0aW5nc1xuXHRcdGNvbnN0IGVuaGFuY2VkT3B0aW9uczogQUlHZW5lcmF0aW9uT3B0aW9ucyA9IHtcblx0XHRcdHRlbXBlcmF0dXJlOiB0aGlzLmdldERlZmF1bHRUZW1wZXJhdHVyZSgpLFxuXHRcdFx0bWF4VG9rZW5zOiB0aGlzLmdldERlZmF1bHRNYXhUb2tlbnMoKVxuXHRcdH07XG5cdFx0XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uKG1lc3NhZ2VzLCBlbmhhbmNlZE9wdGlvbnMpO1xuXHR9XG5cblx0YXN5bmMgKmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSwgb3B0aW9ucz86IEFJR2VuZXJhdGlvbk9wdGlvbnMpOiBBc3luY0dlbmVyYXRvcjxBSVN0cmVhbVJlc3BvbnNlPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBBbHdheXMgdXNlIGdsb2JhbCBzZXR0aW5nc1xuXHRcdGNvbnN0IGVuaGFuY2VkT3B0aW9uczogQUlHZW5lcmF0aW9uT3B0aW9ucyA9IHtcblx0XHRcdHRlbXBlcmF0dXJlOiB0aGlzLmdldERlZmF1bHRUZW1wZXJhdHVyZSgpLFxuXHRcdFx0bWF4VG9rZW5zOiB0aGlzLmdldERlZmF1bHRNYXhUb2tlbnMoKVxuXHRcdH07XG5cdFx0XG5cdFx0eWllbGQqIHByb3ZpZGVyLmNoYXRDb21wbGV0aW9uU3RyZWFtKG1lc3NhZ2VzLCBlbmhhbmNlZE9wdGlvbnMpO1xuXHR9XG5cblx0Z2V0UHJvdmlkZXJOYW1lcygpOiBzdHJpbmdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5wcm92aWRlcnMudmFsdWVzKCkpLm1hcChwID0+IHAubmFtZSk7XG5cdH1cblxuXHRhc3luYyBnZXRDdXJyZW50UHJvdmlkZXJOYW1lKCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0cmV0dXJuIHByb3ZpZGVyID8gcHJvdmlkZXIubmFtZSA6ICdOb25lJztcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRQcm92aWRlclR5cGUoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG5cdFx0Y29uc3Qgc2VsZWN0ZWRNb2RlbCA9IHRoaXMuZ2V0U2VsZWN0ZWRNb2RlbCgpO1xuXHRcdGNvbnN0IHByb3ZpZGVyVHlwZSA9IHRoaXMuZ2V0UHJvdmlkZXJGb3JNb2RlbChzZWxlY3RlZE1vZGVsKTtcblx0XHRcblx0XHRpZiAoIXByb3ZpZGVyVHlwZSB8fCBwcm92aWRlclR5cGUgPT09ICdub25lJykge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyVHlwZSk7XG5cdFx0aWYgKHByb3ZpZGVyICYmIGF3YWl0IHRoaXMuY2hlY2tQcm92aWRlckF2YWlsYWJpbGl0eShwcm92aWRlclR5cGUpKSB7XG5cdFx0XHRyZXR1cm4gcHJvdmlkZXJUeXBlO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtb2RlbCBuYW1lXG5cdCAqL1xuXHRnZXRDdXJyZW50TW9kZWwoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRTZWxlY3RlZE1vZGVsKCk7XG5cdH1cblxuXHRhc3luYyBjb21wbGV0ZShzeXN0ZW1Qcm9tcHQ6IHN0cmluZywgdXNlclByb21wdDogc3RyaW5nLCBvcHRpb25zPzogQUlHZW5lcmF0aW9uT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZVByb3ZpZGVyKCk7XG5cdFx0aWYgKCFwcm92aWRlcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdOb3ZhIGlzIGRpc2FibGVkIG9yIG5vIEFJIHByb3ZpZGVyIGlzIGF2YWlsYWJsZScpO1xuXHRcdH1cblx0XHRcblx0XHQvLyBBbHdheXMgdXNlIGdsb2JhbCBzZXR0aW5nc1xuXHRcdGNvbnN0IGVuaGFuY2VkT3B0aW9uczogQUlHZW5lcmF0aW9uT3B0aW9ucyA9IHtcblx0XHRcdHRlbXBlcmF0dXJlOiB0aGlzLmdldERlZmF1bHRUZW1wZXJhdHVyZSgpLFxuXHRcdFx0bWF4VG9rZW5zOiB0aGlzLmdldERlZmF1bHRNYXhUb2tlbnMoKVxuXHRcdH07XG5cdFx0XG5cdFx0cmV0dXJuIHByb3ZpZGVyLmNvbXBsZXRlKHN5c3RlbVByb21wdCwgdXNlclByb21wdCwgZW5oYW5jZWRPcHRpb25zKTtcblx0fVxuXG5cdGdldEFsbG93ZWRQcm92aWRlcnMoKTogUHJvdmlkZXJUeXBlW10ge1xuXHRcdC8vIE9sbGFtYSByZXF1aXJlcyBsb2NhbCBzZXJ2ZXIgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZVxuXHRcdGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuXHRcdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnXTtcblx0XHR9XG5cdFx0cmV0dXJuIFsnY2xhdWRlJywgJ29wZW5haScsICdnb29nbGUnLCAnb2xsYW1hJ107XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGFsbCBhdmFpbGFibGUgcHJvdmlkZXJzIHdpdGggdGhlaXIgYXZhaWxhYmlsaXR5IHN0YXR1cyBpbiBwYXJhbGxlbFxuXHQgKi9cblx0YXN5bmMgZ2V0QXZhaWxhYmxlUHJvdmlkZXJzV2l0aFN0YXR1cygpOiBQcm9taXNlPE1hcDxQcm92aWRlclR5cGUsIGJvb2xlYW4+PiB7XG5cdFx0Y29uc3QgYWxsb3dlZFByb3ZpZGVycyA9IHRoaXMuZ2V0QWxsb3dlZFByb3ZpZGVycygpO1xuXHRcdGNvbnN0IGF2YWlsYWJpbGl0eUNoZWNrcyA9IGFsbG93ZWRQcm92aWRlcnMubWFwKGFzeW5jIChwcm92aWRlclR5cGUpID0+IHtcblx0XHRcdGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgdGhpcy5jaGVja1Byb3ZpZGVyQXZhaWxhYmlsaXR5KHByb3ZpZGVyVHlwZSk7XG5cdFx0XHRyZXR1cm4geyBwcm92aWRlclR5cGUsIGlzQXZhaWxhYmxlIH07XG5cdFx0fSk7XG5cblx0XHRjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoYXZhaWxhYmlsaXR5Q2hlY2tzKTtcblx0XHRjb25zdCBhdmFpbGFiaWxpdHlNYXAgPSBuZXcgTWFwPFByb3ZpZGVyVHlwZSwgYm9vbGVhbj4oKTtcblx0XHRcblx0XHRyZXN1bHRzLmZvckVhY2goKHsgcHJvdmlkZXJUeXBlLCBpc0F2YWlsYWJsZSB9KSA9PiB7XG5cdFx0XHRhdmFpbGFiaWxpdHlNYXAuc2V0KHByb3ZpZGVyVHlwZSwgaXNBdmFpbGFibGUpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGF2YWlsYWJpbGl0eU1hcDtcblx0fVxuXG5cdGlzUHJvdmlkZXJBbGxvd2VkKHByb3ZpZGVyVHlwZTogUHJvdmlkZXJUeXBlKTogYm9vbGVhbiB7XG5cdFx0Ly8gQWxsIHByb3ZpZGVycyBhcmUgYWxsb3dlZFxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0Z2V0UHJvdmlkZXJMaW1pdHMoKTogeyBsb2NhbDogbnVtYmVyOyBjbG91ZDogbnVtYmVyIH0ge1xuXHRcdC8vIE5vIGxpbWl0cyBpbiB0aGUgU3VwZXJub3ZhIG1vZGVsXG5cdFx0cmV0dXJuIHsgbG9jYWw6IEluZmluaXR5LCBjbG91ZDogSW5maW5pdHkgfTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYXZhaWxhYmxlIG1vZGVscyBmb3IgYSBzcGVjaWZpYyBwcm92aWRlclxuXHQgKi9cblx0YXN5bmMgZ2V0UHJvdmlkZXJNb2RlbHMocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG5cdFx0Y29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcblx0XHRpZiAoIXByb3ZpZGVyKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFByb3ZpZGVyICR7cHJvdmlkZXJUeXBlfSBub3QgZm91bmRgKTtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgZ2V0QXZhaWxhYmxlTW9kZWxzIG1ldGhvZFxuXHRcdGlmICgnZ2V0QXZhaWxhYmxlTW9kZWxzJyBpbiBwcm92aWRlciAmJiB0eXBlb2YgcHJvdmlkZXIuZ2V0QXZhaWxhYmxlTW9kZWxzID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRyZXR1cm4gYXdhaXQgKHByb3ZpZGVyIGFzIGFueSkuZ2V0QXZhaWxhYmxlTW9kZWxzKCk7XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHByb3ZpZGVycyB3aXRob3V0IEFQSSBtb2RlbCBsaXN0aW5nIChsaWtlIE9sbGFtYSksIHJldHVybiBlbXB0eSBhcnJheVxuXHRcdHJldHVybiBbXTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhciBtb2RlbCBjYWNoZSBmb3IgYSBzcGVjaWZpYyBwcm92aWRlclxuXHQgKi9cblx0Y2xlYXJQcm92aWRlck1vZGVsQ2FjaGUocHJvdmlkZXJUeXBlOiBQcm92aWRlclR5cGUpOiB2b2lkIHtcblx0XHRjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xuXHRcdGlmICghcHJvdmlkZXIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBwcm92aWRlciBoYXMgY2xlYXJNb2RlbENhY2hlIG1ldGhvZFxuXHRcdGlmICgnY2xlYXJNb2RlbENhY2hlJyBpbiBwcm92aWRlciAmJiB0eXBlb2YgcHJvdmlkZXIuY2xlYXJNb2RlbENhY2hlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHQocHJvdmlkZXIgYXMgYW55KS5jbGVhck1vZGVsQ2FjaGUoKTtcblx0XHR9XG5cdH1cblxuXHRjbGVhbnVwKCkge1xuXHRcdHRoaXMucHJvdmlkZXJzLmNsZWFyKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IHRoZSBkZWZhdWx0IG1heCB0b2tlbnMgZnJvbSBzZXR0aW5nc1xuXHQgKi9cblx0Z2V0RGVmYXVsdE1heFRva2VucygpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdE1heFRva2Vucztcblx0fVxuXG5cdGdldERlZmF1bHRUZW1wZXJhdHVyZSgpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzLmdlbmVyYWwuZGVmYXVsdFRlbXBlcmF0dXJlO1xuXHR9XG59IiwgIi8qKlxuICogQ29yZSBkb2N1bWVudCBlbmdpbmUgZm9yIE5vdmFcbiAqIEhhbmRsZXMgYWxsIGRvY3VtZW50IG1hbmlwdWxhdGlvbiBhbmQgZWRpdG9yIGludGVyYWN0aW9uc1xuICovXG5cbmltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blZpZXcsIFRGaWxlLCBFZGl0b3JQb3NpdGlvbiwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRDb250ZXh0LCBIZWFkaW5nSW5mbywgRWRpdFJlc3VsdCwgRWRpdE9wdGlvbnMsIERvY3VtZW50U2VjdGlvbiwgRWRpdENvbW1hbmQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1hbmFnZXIsIERhdGFTdG9yZSB9IGZyb20gJy4vY29udmVyc2F0aW9uLW1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgRG9jdW1lbnRFbmdpbmUge1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlciB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCwgZGF0YVN0b3JlPzogRGF0YVN0b3JlKSB7XG4gICAgICAgIGlmIChkYXRhU3RvcmUpIHtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlciA9IG5ldyBDb252ZXJzYXRpb25NYW5hZ2VyKGRhdGFTdG9yZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgY29udmVyc2F0aW9uIG1hbmFnZXIgKGZvciBkZXBlbmRlbmN5IGluamVjdGlvbilcbiAgICAgKi9cbiAgICBzZXRDb252ZXJzYXRpb25NYW5hZ2VyKGNvbnZlcnNhdGlvbk1hbmFnZXI6IENvbnZlcnNhdGlvbk1hbmFnZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyID0gY29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGl2ZSBlZGl0b3IgaW5zdGFuY2UgLSBlbnN1cmVzIHdlIGdldCB0aGUgZWRpdG9yIGZvciB0aGUgYWN0aXZlIGZpbGVcbiAgICAgKi9cbiAgICBnZXRBY3RpdmVFZGl0b3IoKTogRWRpdG9yIHwgbnVsbCB7XG4gICAgICAgIC8vIEdldCB0aGUgYWN0aXZlIGZpbGUgZmlyc3QgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XG4gICAgICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRmluZCB0aGUgbWFya2Rvd24gdmlldyBmb3IgdGhlIGFjdGl2ZSBmaWxlIHNwZWNpZmljYWxseVxuICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuICAgICAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuICAgICAgICAgICAgaWYgKHZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgdmlldy5maWxlID09PSBhY3RpdmVGaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcuZWRpdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBGYWxsYmFjazogdHJ5IHRoZSB3b3Jrc3BhY2UgYWN0aXZlIGVkaXRvciBpZiBpdCBtYXRjaGVzIHRoZSBhY3RpdmUgZmlsZVxuICAgICAgICBjb25zdCBhY3RpdmVFZGl0b3IgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlRWRpdG9yO1xuICAgICAgICBpZiAoYWN0aXZlRWRpdG9yPy5lZGl0b3IgJiYgYWN0aXZlRWRpdG9yLmZpbGUgPT09IGFjdGl2ZUZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBhY3RpdmVFZGl0b3IuZWRpdG9yO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5hbCBmYWxsYmFjazogdHJ5IGdldEFjdGl2ZVZpZXdPZlR5cGVcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICh2aWV3ICYmIHZpZXcuZmlsZSA9PT0gYWN0aXZlRmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZpZXcuZWRpdG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgYWN0aXZlIGZpbGVcbiAgICAgKi9cbiAgICBnZXRBY3RpdmVGaWxlKCk6IFRGaWxlIHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHRleHRcbiAgICAgKi9cbiAgICBnZXRTZWxlY3RlZFRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IGN1cnNvciBwb3NpdGlvblxuICAgICAqL1xuICAgIGdldEN1cnNvclBvc2l0aW9uKCk6IEVkaXRvclBvc2l0aW9uIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gICAgICAgIGlmICghZWRpdG9yKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBjdXJzb3IgcG9zaXRpb24gKG9wdGlvbmFsbHkgZm9jdXMgdGhlIGVkaXRvcilcbiAgICAgKi9cbiAgICBzZXRDdXJzb3JQb3NpdGlvbihwb3NpdGlvbjogRWRpdG9yUG9zaXRpb24sIHNob3VsZEZvY3VzOiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIGVkaXRvci5zZXRDdXJzb3IocG9zaXRpb24pO1xuICAgICAgICBpZiAoc2hvdWxkRm9jdXMpIHtcbiAgICAgICAgICAgIGVkaXRvci5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBjb21wcmVoZW5zaXZlIGRvY3VtZW50IGNvbnRleHRcbiAgICAgKi9cbiAgICBhc3luYyBnZXREb2N1bWVudENvbnRleHQoKTogUHJvbWlzZTxEb2N1bWVudENvbnRleHQgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZmlsZSB8fCAhZWRpdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gdGhpcy5nZXRTZWxlY3RlZFRleHQoKTtcbiAgICAgICAgY29uc3QgY3Vyc29yUG9zaXRpb24gPSB0aGlzLmdldEN1cnNvclBvc2l0aW9uKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IGhlYWRpbmdzIGZyb20gdGhlIGRvY3VtZW50XG4gICAgICAgIGNvbnN0IGhlYWRpbmdzID0gdGhpcy5leHRyYWN0SGVhZGluZ3MoY29udGVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgc3Vycm91bmRpbmcgbGluZXMgZm9yIGNvbnRleHRcbiAgICAgICAgY29uc3Qgc3Vycm91bmRpbmdMaW5lcyA9IGN1cnNvclBvc2l0aW9uID8gXG4gICAgICAgICAgICB0aGlzLmdldFN1cnJvdW5kaW5nTGluZXMoY29udGVudCwgY3Vyc29yUG9zaXRpb24ubGluZSkgOiBcbiAgICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlLmJhc2VuYW1lLFxuICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIGhlYWRpbmdzLFxuICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiBzZWxlY3RlZFRleHQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgY3Vyc29yUG9zaXRpb246IGN1cnNvclBvc2l0aW9uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHN1cnJvdW5kaW5nTGluZXNcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGhlYWRpbmdzIGZyb20gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgZXh0cmFjdEhlYWRpbmdzKGNvbnRlbnQ6IHN0cmluZyk6IEhlYWRpbmdJbmZvW10ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBjb25zdCBoZWFkaW5nczogSGVhZGluZ0luZm9bXSA9IFtdO1xuICAgICAgICBsZXQgY2hhckNvdW50ID0gMDtcblxuICAgICAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaGVhZGluZ01hdGNoID0gbGluZS5tYXRjaCgvXigjezEsNn0pXFxzKyguKykkLyk7XG4gICAgICAgICAgICBpZiAoaGVhZGluZ01hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBoZWFkaW5nTWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaGVhZGluZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHRleHQsXG4gICAgICAgICAgICAgICAgICAgIGxldmVsLFxuICAgICAgICAgICAgICAgICAgICBsaW5lOiBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBjaGFyQ291bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGNoYXJDb3VudCArIGxpbmUubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGxpbmUgbGVuZ3RoICsgbmV3bGluZSBjaGFyYWN0ZXJcbiAgICAgICAgICAgIGNoYXJDb3VudCArPSBsaW5lLmxlbmd0aCArIDE7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBoZWFkaW5ncztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbGluZXMgc3Vycm91bmRpbmcgdGhlIGN1cnNvciBwb3NpdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0U3Vycm91bmRpbmdMaW5lcyhcbiAgICAgICAgY29udGVudDogc3RyaW5nLCBcbiAgICAgICAgY3VycmVudExpbmU6IG51bWJlciwgXG4gICAgICAgIGNvbnRleHRTaXplOiBudW1iZXIgPSA1XG4gICAgKTogeyBiZWZvcmU6IHN0cmluZ1tdOyBhZnRlcjogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdGFydExpbmUgPSBNYXRoLm1heCgwLCBjdXJyZW50TGluZSAtIGNvbnRleHRTaXplKTtcbiAgICAgICAgY29uc3QgZW5kTGluZSA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCAtIDEsIGN1cnJlbnRMaW5lICsgY29udGV4dFNpemUpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJlZm9yZTogbGluZXMuc2xpY2Uoc3RhcnRMaW5lLCBjdXJyZW50TGluZSksXG4gICAgICAgICAgICBhZnRlcjogbGluZXMuc2xpY2UoY3VycmVudExpbmUgKyAxLCBlbmRMaW5lICsgMSlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBhbiBlZGl0IHRvIHRoZSBkb2N1bWVudFxuICAgICAqL1xuICAgIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29udGVudDogc3RyaW5nLFxuICAgICAgICBwb3NpdGlvbjogJ2N1cnNvcicgfCAnc2VsZWN0aW9uJyB8ICdlbmQnIHwgeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfSxcbiAgICAgICAgb3B0aW9uczogRWRpdE9wdGlvbnMgPSB7fVxuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBhcHBsaWVkQXQ6IEVkaXRvclBvc2l0aW9uO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocG9zaXRpb24gPT09ICdjdXJzb3InKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IGN1cnNvciBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdCA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGNvbnRlbnQsIGFwcGxpZWRBdCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnc2VsZWN0aW9uJykge1xuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0gZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGNvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ2VuZCcpIHtcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgdG8gZW5kIG9mIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmUgPSBlZGl0b3IubGFzdExpbmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZUxlbmd0aCA9IGVkaXRvci5nZXRMaW5lKGxhc3RMaW5lKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgYXBwbGllZEF0ID0geyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudENvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gY3VycmVudENvbnRlbnQgKyAoY3VycmVudENvbnRlbnQuZW5kc1dpdGgoJ1xcbicpID8gJycgOiAnXFxuJykgKyBjb250ZW50O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFVzZSB2YXVsdC5tb2RpZnkgZm9yIHVuZG8vcmVkbyBzdXBwb3J0XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgc3BlY2lmaWMgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQgPSBwb3NpdGlvbjtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGNvbnRlbnQsIGFwcGxpZWRBdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBwb3N0LWVkaXQgb3B0aW9uc1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2VsZWN0TmV3VGV4dCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgbGluZTogYXBwbGllZEF0LmxpbmUgKyBjb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICAgICBjaDogY29udGVudC5pbmNsdWRlcygnXFxuJykgPyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3BsaXQoJ1xcbicpLnBvcCgpIS5sZW5ndGggOiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWRBdC5jaCArIGNvbnRlbnQubGVuZ3RoXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0U2VsZWN0aW9uKGFwcGxpZWRBdCwgZW5kUG9zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2Nyb2xsVG9FZGl0KSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogYXBwbGllZEF0LFxuICAgICAgICAgICAgICAgICAgICB0bzogYXBwbGllZEF0XG4gICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiBwb3NpdGlvbiA9PT0gJ3NlbGVjdGlvbicgPyAncmVwbGFjZScgOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gJ2VuZCcgPyAnYXBwZW5kJyA6ICdpbnNlcnQnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVsZXRlIGNvbnRlbnQgYXQgY3Vyc29yIGxvY2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgZGVsZXRlQ29udGVudChcbiAgICAgICAgdGFyZ2V0OiAnc2VsZWN0aW9uJyB8ICdsaW5lJ1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEFjdGl2ZUVkaXRvcigpO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWVkaXRvciB8fCAhZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBlZGl0b3Igb3IgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09ICdzZWxlY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gdGV4dCBzZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJ2xpbmUnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBjdXJzb3IubGluZTtcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lLCBjaDogMCB9LCBcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBsaW5lICsgMSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZSwgY2g6IDAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGRlbGV0ZSB0YXJnZXQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGZ1bGwgZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIGFzeW5jIGdldERvY3VtZW50Q29udGVudCgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcGxhY2UgdGhlIGVudGlyZSBkb2N1bWVudCBjb250ZW50XG4gICAgICovXG4gICAgYXN5bmMgc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZmlsZScsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ29udmVyc2F0aW9uIG1hbmFnZW1lbnQgbWV0aG9kc1xuXG4gICAgLyoqXG4gICAgICogQWRkIHVzZXIgbWVzc2FnZSB0byBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRVc2VyTWVzc2FnZShjb250ZW50OiBzdHJpbmcsIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFVzZXJNZXNzYWdlKGZpbGUsIGNvbnRlbnQsIGNvbW1hbmQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFzc2lzdGFudCByZXNwb25zZSB0byBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRBc3Npc3RhbnRNZXNzYWdlKGNvbnRlbnQ6IHN0cmluZywgcmVzdWx0PzogRWRpdFJlc3VsdCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZEFzc2lzdGFudE1lc3NhZ2UoZmlsZSwgY29udGVudCwgcmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBzeXN0ZW0gbWVzc2FnZSB0byBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBhZGRTeXN0ZW1NZXNzYWdlKGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmFkZFN5c3RlbU1lc3NhZ2UoZmlsZSwgY29udGVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KG1heE1lc3NhZ2VzOiBudW1iZXIgPSA2KTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiAnJztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm4gJyc7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmdldENvbnZlcnNhdGlvbkNvbnRleHQoZmlsZSwgbWF4TWVzc2FnZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGNvbnZlcnNhdGlvbiBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb252ZXJzYXRpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm47XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuY2xlYXJDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIHN0YXRpc3RpY3MgZm9yIGN1cnJlbnQgZmlsZVxuICAgICAqL1xuICAgIGdldENvbnZlcnNhdGlvblN0YXRzKCk6IHtcbiAgICAgICAgbWVzc2FnZUNvdW50OiBudW1iZXI7XG4gICAgICAgIGVkaXRDb3VudDogbnVtYmVyO1xuICAgICAgICBtb3N0VXNlZENvbW1hbmQ6IHN0cmluZyB8IG51bGw7XG4gICAgICAgIGNvbnZlcnNhdGlvbkFnZTogbnVtYmVyO1xuICAgIH0gfCBudWxsIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRTdGF0cyhmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBjdXJyZW50IGZpbGUgaGFzIGFuIGFjdGl2ZSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBoYXNDb252ZXJzYXRpb24oKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5oYXNDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0IGNvbnZlcnNhdGlvbiBmb3IgY3VycmVudCBmaWxlXG4gICAgICovXG4gICAgZXhwb3J0Q29udmVyc2F0aW9uKCk6IHN0cmluZyB8IG51bGwge1xuICAgICAgICBpZiAoIXRoaXMuY29udmVyc2F0aW9uTWFuYWdlcikgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJzYXRpb25NYW5hZ2VyLmV4cG9ydENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIHNlbGVjdGVkIHRleHQgd2l0aCBuZXcgY29udGVudFxuICAgICAqIEhhbmRsZXMgdW5kby9yZWRvIHByb3Blcmx5IGFuZCBwcmVzZXJ2ZXMgY3Vyc29yIHBvc2l0aW9uXG4gICAgICovXG4gICAgYXN5bmMgcmVwbGFjZVNlbGVjdGlvbihcbiAgICAgICAgbmV3VGV4dDogc3RyaW5nLFxuICAgICAgICBmcm9tPzogRWRpdG9yUG9zaXRpb24sXG4gICAgICAgIHRvPzogRWRpdG9yUG9zaXRpb25cbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZWRpdG9yIG9yIGZpbGUnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVXNlIHByb3ZpZGVkIHJhbmdlIG9yIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICBjb25zdCBmcm9tUG9zID0gZnJvbSB8fCBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XG4gICAgICAgICAgICBjb25zdCB0b1BvcyA9IHRvIHx8IGVkaXRvci5nZXRDdXJzb3IoJ3RvJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFBlcmZvcm0gdGhlIHJlcGxhY2VtZW50IHVzaW5nIE9ic2lkaWFuJ3MgdHJhbnNhY3Rpb24gc3lzdGVtIGZvciBwcm9wZXIgdW5kby9yZWRvXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld1RleHQsIGZyb21Qb3MsIHRvUG9zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2V0IGN1cnNvciBhdCB0aGUgZW5kIG9mIHRoZSByZXBsYWNlZCB0ZXh0XG4gICAgICAgICAgICBjb25zdCBuZXdDdXJzb3JQb3MgPSB7XG4gICAgICAgICAgICAgICAgbGluZTogZnJvbVBvcy5saW5lICsgKG5ld1RleHQuc3BsaXQoJ1xcbicpLmxlbmd0aCAtIDEpLFxuICAgICAgICAgICAgICAgIGNoOiBuZXdUZXh0LmluY2x1ZGVzKCdcXG4nKSA/IFxuICAgICAgICAgICAgICAgICAgICBuZXdUZXh0LnNwbGl0KCdcXG4nKS5wb3AoKSEubGVuZ3RoIDogXG4gICAgICAgICAgICAgICAgICAgIGZyb21Qb3MuY2ggKyBuZXdUZXh0Lmxlbmd0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcihuZXdDdXJzb3JQb3MpO1xuICAgICAgICAgICAgZWRpdG9yLmZvY3VzKCk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBuZXdUZXh0LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZnJvbVBvcyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXBsYWNpbmcgc2VsZWN0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbn0iLCAiLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlciBmb3IgTm92YVxuICogSGFuZGxlcyBmaWxlLXNjb3BlZCBjb252ZXJzYXRpb24gc3RvcmFnZSBhbmQgcmV0cmlldmFsXG4gKi9cblxuaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25EYXRhLCBDb252ZXJzYXRpb25NZXNzYWdlLCBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRWRpdEFjdGlvbiwgQ29udGV4dERvY3VtZW50UmVmIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVN0b3JlIHtcbiAgICBsb2FkRGF0YShrZXk6IHN0cmluZyk6IFByb21pc2U8YW55PjtcbiAgICBzYXZlRGF0YShrZXk6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbk1hbmFnZXIge1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uczogTWFwPHN0cmluZywgQ29udmVyc2F0aW9uRGF0YT4gPSBuZXcgTWFwKCk7XG4gICAgcHJpdmF0ZSBtYXhNZXNzYWdlc1BlckZpbGUgPSAxMDA7IC8vIExpbWl0IGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgcHJpdmF0ZSBzdG9yYWdlS2V5ID0gJ25vdmEtY29udmVyc2F0aW9ucyc7XG4gICAgcHJpdmF0ZSBjbGVhbnVwSW50ZXJ2YWw6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgaW5pdGlhbGl6ZVByb21pc2U6IFByb21pc2U8dm9pZD47XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRhdGFTdG9yZTogRGF0YVN0b3JlKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZVByb21pc2UgPSB0aGlzLmluaXRpYWxpemUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZENvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgdGhpcy5zdGFydFBlcmlvZGljQ2xlYW51cCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWQgY29udmVyc2F0aW9ucyBmcm9tIHBsdWdpbiBkYXRhXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkQ29udmVyc2F0aW9ucygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmRhdGFTdG9yZS5sb2FkRGF0YSh0aGlzLnN0b3JhZ2VLZXkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb252ZXJzYXRpb24gb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgYW5kIHNhbml0aXplIGNvbnZlcnNhdGlvbiBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzYW5pdGl6ZWRDb252ZXJzYXRpb24gPSB0aGlzLnNhbml0aXplQ29udmVyc2F0aW9uRGF0YShjb252ZXJzYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25zLnNldChzYW5pdGl6ZWRDb252ZXJzYXRpb24uZmlsZVBhdGgsIHNhbml0aXplZENvbnZlcnNhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGNvcnJ1cHRlZCBpbmRpdmlkdWFsIGNvbnZlcnNhdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgU2tpcHBlZCBjb3JydXB0ZWQgY29udmVyc2F0aW9uIGZvciBmaWxlOiAke2NvbnZlcnNhdGlvbj8uZmlsZVBhdGggfHwgJ3Vua25vd24nfWAsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxlZCB0byBsb2FkIGNvbnZlcnNhdGlvbiBkYXRhIC0gZ3JhY2VmdWwgZmFsbGJhY2tcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1Mjc0QyBDb252ZXJzYXRpb25NYW5hZ2VyLmxvYWRDb252ZXJzYXRpb25zOiBMb2FkIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYW5pdGl6ZSBhbmQgdmFsaWRhdGUgY29udmVyc2F0aW9uIGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIHNhbml0aXplQ29udmVyc2F0aW9uRGF0YShjb252ZXJzYXRpb246IGFueSk6IENvbnZlcnNhdGlvbkRhdGEge1xuICAgICAgICAvLyBFbnN1cmUgcmVxdWlyZWQgZmllbGRzIGV4aXN0IGFuZCBhcmUgdmFsaWRcbiAgICAgICAgaWYgKCFjb252ZXJzYXRpb24uZmlsZVBhdGggfHwgdHlwZW9mIGNvbnZlcnNhdGlvbi5maWxlUGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBvciBtaXNzaW5nIGZpbGVQYXRoJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFbnN1cmUgbWVzc2FnZXMgYXJyYXkgZXhpc3RzIGFuZCBpcyB2YWxpZFxuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IEFycmF5LmlzQXJyYXkoY29udmVyc2F0aW9uLm1lc3NhZ2VzKSA/IGNvbnZlcnNhdGlvbi5tZXNzYWdlcyA6IFtdO1xuXG4gICAgICAgIC8vIEVuc3VyZSBjb250ZXh0RG9jdW1lbnRzIGFycmF5IGV4aXN0cyBhbmQgaXMgdmFsaWRcbiAgICAgICAgbGV0IGNvbnRleHREb2N1bWVudHM6IENvbnRleHREb2N1bWVudFJlZltdID0gW107XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnZlcnNhdGlvbi5jb250ZXh0RG9jdW1lbnRzKSkge1xuICAgICAgICAgICAgY29udGV4dERvY3VtZW50cyA9IGNvbnZlcnNhdGlvbi5jb250ZXh0RG9jdW1lbnRzXG4gICAgICAgICAgICAgICAgLmZpbHRlcigoZG9jOiBhbnkpID0+IHRoaXMuaXNWYWxpZENvbnRleHREb2N1bWVudChkb2MpKVxuICAgICAgICAgICAgICAgIC5tYXAoKGRvYzogYW55KSA9PiB0aGlzLnNhbml0aXplQ29udGV4dERvY3VtZW50KGRvYykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRW5zdXJlIGJhc2ljIHN0cnVjdHVyZVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmlsZVBhdGg6IGNvbnZlcnNhdGlvbi5maWxlUGF0aCxcbiAgICAgICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IHR5cGVvZiBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPT09ICdudW1iZXInID8gY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkIDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIGNvbnRleHREb2N1bWVudHMsXG4gICAgICAgICAgICBtZXRhZGF0YTogY29udmVyc2F0aW9uLm1ldGFkYXRhIHx8IHtcbiAgICAgICAgICAgICAgICBlZGl0Q291bnQ6IDAsXG4gICAgICAgICAgICAgICAgY29tbWFuZEZyZXF1ZW5jeToge1xuICAgICAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICAgICAgcmV3cml0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgY29udGV4dCBkb2N1bWVudCBzdHJ1Y3R1cmVcbiAgICAgKi9cbiAgICBwcml2YXRlIGlzVmFsaWRDb250ZXh0RG9jdW1lbnQoZG9jOiBhbnkpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGRvYyAmJiBcbiAgICAgICAgICAgICAgIHR5cGVvZiBkb2MucGF0aCA9PT0gJ3N0cmluZycgJiYgXG4gICAgICAgICAgICAgICBkb2MucGF0aC50cmltKCkubGVuZ3RoID4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYW5pdGl6ZSBjb250ZXh0IGRvY3VtZW50IGRhdGFcbiAgICAgKi9cbiAgICBwcml2YXRlIHNhbml0aXplQ29udGV4dERvY3VtZW50KGRvYzogYW55KTogQ29udGV4dERvY3VtZW50UmVmIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBhdGg6IGRvYy5wYXRoLFxuICAgICAgICAgICAgcHJvcGVydHk6IHR5cGVvZiBkb2MucHJvcGVydHkgPT09ICdzdHJpbmcnID8gZG9jLnByb3BlcnR5IDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgYWRkZWRBdDogdHlwZW9mIGRvYy5hZGRlZEF0ID09PSAnbnVtYmVyJyA/IGRvYy5hZGRlZEF0IDogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhdmUgY29udmVyc2F0aW9ucyB0byBwbHVnaW4gZGF0YVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbnZlcnNhdGlvbnMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25zQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMuY29udmVyc2F0aW9ucy52YWx1ZXMoKSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRhdGFTdG9yZS5zYXZlRGF0YSh0aGlzLnN0b3JhZ2VLZXksIGNvbnZlcnNhdGlvbnNBcnJheSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcdTI3NEMgQ29udmVyc2F0aW9uTWFuYWdlci5zYXZlQ29udmVyc2F0aW9uczogU2F2ZSBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbnZlcnNhdGlvbiBmb3IgYSBzcGVjaWZpYyBmaWxlXG4gICAgICovXG4gICAgZ2V0Q29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogQ29udmVyc2F0aW9uRGF0YSB7XG4gICAgICAgIC8vIE5vdGU6IFRoaXMgbWV0aG9kIGlzIHN5bmNocm9ub3VzIGFuZCB1c2VkIGJ5IG90aGVyIG1ldGhvZHMgdGhhdCBhd2FpdCBpbml0aWFsaXplUHJvbWlzZVxuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgXG4gICAgICAgIGlmICghdGhpcy5jb252ZXJzYXRpb25zLmhhcyhmaWxlUGF0aCkpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgY29udmVyc2F0aW9uIGZvciB0aGlzIGZpbGVcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbnZlcnNhdGlvbjogQ29udmVyc2F0aW9uRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgY29udGV4dERvY3VtZW50czogW10sXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdENvdW50OiAwLFxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kRnJlcXVlbmN5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JhbW1hcjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJld3JpdGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5zZXQoZmlsZVBhdGgsIG5ld0NvbnZlcnNhdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFbnN1cmUgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAtIGFkZCBjb250ZXh0RG9jdW1lbnRzIGlmIG1pc3NpbmdcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChmaWxlUGF0aCkhO1xuICAgICAgICBpZiAoIWNvbnZlcnNhdGlvbi5jb250ZXh0RG9jdW1lbnRzKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cyA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSB1c2VyIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFVzZXJNZXNzYWdlKFxuICAgICAgICBmaWxlOiBURmlsZSwgXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGNvbW1hbmQ/OiBFZGl0Q29tbWFuZFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXNzYWdlOiBDb252ZXJzYXRpb25NZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVNZXNzYWdlSWQoKSxcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICBjb21tYW5kXG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmQgZnJlcXVlbmN5IGlmIGNvbW1hbmQgcHJvdmlkZWRcbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeVtjb21tYW5kLmFjdGlvbl0rKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGFuIGFzc2lzdGFudCByZXNwb25zZSB0byB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgYWRkQXNzaXN0YW50TWVzc2FnZShcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICAgICAgcmVzdWx0PzogRWRpdFJlc3VsdFxuICAgICk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZT4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgIH07XG5cbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgLy8gSW5jcmVtZW50IGVkaXQgY291bnQgaWYgcmVzdWx0IGluZGljYXRlcyBzdWNjZXNzZnVsIGVkaXRcbiAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcyAmJiBjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMudHJpbUFuZFNhdmUoY29udmVyc2F0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgc3lzdGVtIG1lc3NhZ2UgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN5c3RlbU1lc3NhZ2UoXG4gICAgICAgIGZpbGU6IFRGaWxlLCBcbiAgICAgICAgY29udGVudDogc3RyaW5nLCBcbiAgICAgICAgbWV0YWRhdGE/OiB7IG1lc3NhZ2VUeXBlPzogc3RyaW5nOyBzb3VyY2U/OiAnY2hhdCcgfCAnc2VsZWN0aW9uJyB8ICdjb21tYW5kJyB9XG4gICAgKTogUHJvbWlzZTxDb252ZXJzYXRpb25NZXNzYWdlPiB7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IENvbnZlcnNhdGlvbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZU1lc3NhZ2VJZCgpLFxuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgbWV0YWRhdGFcbiAgICAgICAgfTtcblxuICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbik7XG4gICAgICAgIHJldHVybiBtZXNzYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCByZWNlbnQgbWVzc2FnZXMgZm9yIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRSZWNlbnRNZXNzYWdlcyhmaWxlOiBURmlsZSwgY291bnQ6IG51bWJlciA9IDEwKTogQ29udmVyc2F0aW9uTWVzc2FnZVtdIHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24ubWVzc2FnZXMuc2xpY2UoLWNvdW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbWVzc2FnZXMgYnkgcm9sZVxuICAgICAqL1xuICAgIGdldE1lc3NhZ2VzQnlSb2xlKGZpbGU6IFRGaWxlLCByb2xlOiBDb252ZXJzYXRpb25NZXNzYWdlWydyb2xlJ10pOiBDb252ZXJzYXRpb25NZXNzYWdlW10ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5yb2xlID09PSByb2xlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgZm9yIEFJIHByb21wdHNcbiAgICAgKi9cbiAgICBnZXRDb252ZXJzYXRpb25Db250ZXh0KGZpbGU6IFRGaWxlLCBtYXhNZXNzYWdlczogbnVtYmVyID0gNik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCBtYXhNZXNzYWdlcyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZXh0TGluZXMgPSBtZXNzYWdlcy5tYXAobXNnID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZygpO1xuICAgICAgICAgICAgbGV0IGxpbmUgPSBgWyR7dGltZXN0YW1wfV0gJHttc2cucm9sZS50b1VwcGVyQ2FzZSgpfTogJHttc2cuY29udGVudH1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobXNnLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKENvbW1hbmQ6ICR7bXNnLmNvbW1hbmQuYWN0aW9ufSAke21zZy5jb21tYW5kLnRhcmdldH0pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1zZy5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lICs9IGAgKFJlc3VsdDogJHttc2cucmVzdWx0LnN1Y2Nlc3MgPyAnc3VjY2VzcycgOiAnZmFpbGVkJ30pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBgUHJldmlvdXMgY29udmVyc2F0aW9uOlxcbiR7Y29udGV4dExpbmVzLmpvaW4oJ1xcbicpfVxcbmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckNvbnZlcnNhdGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gW107XG4gICAgICAgIC8vIERvIE5PVCBjbGVhciBjb250ZXh0RG9jdW1lbnRzIC0gdGhvc2UgYXJlIG1hbmFnZWQgc2VwYXJhdGVseSBmcm9tIHRoZSBkcmF3ZXJcbiAgICAgICAgY29udmVyc2F0aW9uLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb252ZXJzYXRpb24ubWV0YWRhdGEpIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXRhZGF0YS5lZGl0Q291bnQgPSAwO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhLmNvbW1hbmRGcmVxdWVuY3kgPSB7XG4gICAgICAgICAgICAgICAgYWRkOiAwLFxuICAgICAgICAgICAgICAgIGVkaXQ6IDAsXG4gICAgICAgICAgICAgICAgZGVsZXRlOiAwLFxuICAgICAgICAgICAgICAgIGdyYW1tYXI6IDAsXG4gICAgICAgICAgICAgICAgcmV3cml0ZTogMCxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY29udmVyc2F0aW9uIHN0YXRpc3RpY3NcbiAgICAgKi9cbiAgICBnZXRTdGF0cyhmaWxlOiBURmlsZSk6IHtcbiAgICAgICAgbWVzc2FnZUNvdW50OiBudW1iZXI7XG4gICAgICAgIGVkaXRDb3VudDogbnVtYmVyO1xuICAgICAgICBtb3N0VXNlZENvbW1hbmQ6IEVkaXRBY3Rpb24gfCBudWxsO1xuICAgICAgICBjb252ZXJzYXRpb25BZ2U6IG51bWJlcjtcbiAgICB9IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIFxuICAgICAgICBsZXQgbW9zdFVzZWRDb21tYW5kOiBFZGl0QWN0aW9uIHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGxldCBtYXhDb3VudCA9IDA7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1ldGFkYXRhKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFthY3Rpb24sIGNvdW50XSBvZiBPYmplY3QuZW50cmllcyhjb252ZXJzYXRpb24ubWV0YWRhdGEuY29tbWFuZEZyZXF1ZW5jeSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY291bnQgPiBtYXhDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBtYXhDb3VudCA9IGNvdW50O1xuICAgICAgICAgICAgICAgICAgICBtb3N0VXNlZENvbW1hbmQgPSBhY3Rpb24gYXMgRWRpdEFjdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb252ZXJzYXRpb25BZ2UgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCBcbiAgICAgICAgICAgID8gRGF0ZS5ub3coKSAtIGNvbnZlcnNhdGlvbi5tZXNzYWdlc1swXS50aW1lc3RhbXBcbiAgICAgICAgICAgIDogMDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWVzc2FnZUNvdW50OiBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoLFxuICAgICAgICAgICAgZWRpdENvdW50OiBjb252ZXJzYXRpb24ubWV0YWRhdGE/LmVkaXRDb3VudCB8fCAwLFxuICAgICAgICAgICAgbW9zdFVzZWRDb21tYW5kLFxuICAgICAgICAgICAgY29udmVyc2F0aW9uQWdlXG4gICAgICAgIH07XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgY29udmVyc2F0aW9uIGZvciBhIGZpbGVcbiAgICAgKi9cbiAgICBleHBvcnRDb252ZXJzYXRpb24oZmlsZTogVEZpbGUpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgY29uc3QgbGluZXMgPSBbYCMgQ29udmVyc2F0aW9uIEhpc3RvcnkgZm9yICR7ZmlsZS5uYW1lfWAsICcnXTtcblxuICAgICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgY29udmVyc2F0aW9uLm1lc3NhZ2VzKSB7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZShtZXNzYWdlLnRpbWVzdGFtcCkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICAgICAgICAgIGxpbmVzLnB1c2goYCMjICR7bWVzc2FnZS5yb2xlLnRvVXBwZXJDYXNlKCl9ICgke3RpbWVzdGFtcH0pYCk7XG4gICAgICAgICAgICBsaW5lcy5wdXNoKG1lc3NhZ2UuY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLmNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqQ29tbWFuZDogJHttZXNzYWdlLmNvbW1hbmQuYWN0aW9ufSAke21lc3NhZ2UuY29tbWFuZC50YXJnZXR9KmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5yZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAqUmVzdWx0OiAke21lc3NhZ2UucmVzdWx0LnN1Y2Nlc3MgPyAnU3VjY2VzcycgOiAnRmFpbGVkJ30qYCk7XG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UucmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCpFcnJvcjogJHttZXNzYWdlLnJlc3VsdC5lcnJvcn0qYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBsaW5lcy5wdXNoKCcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSB1bmlxdWUgbWVzc2FnZSBJRFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVNZXNzYWdlSWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBtc2dfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaW0gY29udmVyc2F0aW9uIHRvIG1heCBsZW5ndGggYW5kIHNhdmVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHRyaW1BbmRTYXZlKGNvbnZlcnNhdGlvbjogQ29udmVyc2F0aW9uRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IHRoaXMubWF4TWVzc2FnZXNQZXJGaWxlKSB7XG4gICAgICAgICAgICAvLyBLZWVwIHRoZSBtb3N0IHJlY2VudCBtZXNzYWdlc1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLnNsaWNlKC10aGlzLm1heE1lc3NhZ2VzUGVyRmlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYWxsIGNvbnZlcnNhdGlvbiBmaWxlIHBhdGhzXG4gICAgICovXG4gICAgZ2V0QWxsQ29udmVyc2F0aW9uRmlsZXMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmNvbnZlcnNhdGlvbnMua2V5cygpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBmaWxlIGhhcyBhY3RpdmUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgaGFzQ29udmVyc2F0aW9uKGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuY29udmVyc2F0aW9ucy5nZXQoZmlsZS5wYXRoKTtcbiAgICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbiA/IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPiAwIDogZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGNvbnZlcnNhdGlvbiBmaWxlIHBhdGggKGZvciBmaWxlIHJlbmFtZXMpXG4gICAgICovXG4gICAgYXN5bmMgdXBkYXRlRmlsZVBhdGgob2xkUGF0aDogc3RyaW5nLCBuZXdQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5jb252ZXJzYXRpb25zLmdldChvbGRQYXRoKTtcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbikge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLmZpbGVQYXRoID0gbmV3UGF0aDtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9ucy5kZWxldGUob2xkUGF0aCk7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuc2V0KG5ld1BhdGgsIGNvbnZlcnNhdGlvbik7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBwZXJpb2RpYyBjbGVhbnVwIG9mIG9sZCBjb252ZXJzYXRpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGFydFBlcmlvZGljQ2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2xlYW4gdXAgZXZlcnkgMjQgaG91cnNcbiAgICAgICAgdGhpcy5jbGVhbnVwSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwT2xkQ29udmVyc2F0aW9ucyg3ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDcgZGF5c1xuICAgICAgICB9LCAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBjb252ZXJzYXRpb25zIG9sZGVyIHRoYW4gdGhlIHNwZWNpZmllZCBhZ2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGNsZWFudXBPbGRDb252ZXJzYXRpb25zKG1heEFnZTogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGxldCBjbGVhbmVkID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChjb25zdCBbZmlsZVBhdGgsIGNvbnZlcnNhdGlvbl0gb2YgdGhpcy5jb252ZXJzYXRpb25zLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY29udmVyc2F0aW9uIGlzIG9sZCBiYXNlZCBvbiBsYXN0IG1lc3NhZ2VcbiAgICAgICAgICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RNZXNzYWdlID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzW2NvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBjb25zdCBhZ2UgPSBub3cgLSBsYXN0TWVzc2FnZS50aW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGFnZSA+IG1heEFnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbnMuZGVsZXRlKGZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgY2xlYW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNsZWFuZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIGNvbnRleHQgZG9jdW1lbnQgdG8gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGFkZENvbnRleHREb2N1bWVudChmaWxlOiBURmlsZSwgY29udGV4dFBhdGg6IHN0cmluZywgcHJvcGVydHk/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplUHJvbWlzZTsgLy8gRW5zdXJlIGluaXRpYWxpemF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGRvY3VtZW50IGFscmVhZHkgaW4gY29udGV4dFxuICAgICAgICBjb25zdCBleGlzdHMgPSBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cz8uc29tZShkb2MgPT4gXG4gICAgICAgICAgICBkb2MucGF0aCA9PT0gY29udGV4dFBhdGggJiYgZG9jLnByb3BlcnR5ID09PSBwcm9wZXJ0eVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHREb2M6IENvbnRleHREb2N1bWVudFJlZiA9IHtcbiAgICAgICAgICAgICAgICBwYXRoOiBjb250ZXh0UGF0aCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSxcbiAgICAgICAgICAgICAgICBhZGRlZEF0OiBEYXRlLm5vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cz8ucHVzaChjb250ZXh0RG9jKTtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbnZlcnNhdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIGNvbnRleHQgZG9jdW1lbnQgZnJvbSB0aGUgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgcmVtb3ZlQ29udGV4dERvY3VtZW50KGZpbGU6IFRGaWxlLCBjb250ZXh0UGF0aDogc3RyaW5nLCBwcm9wZXJ0eT86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSB0aGlzLmdldENvbnZlcnNhdGlvbihmaWxlKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cykge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uLmNvbnRleHREb2N1bWVudHMgPSBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cy5maWx0ZXIoZG9jID0+XG4gICAgICAgICAgICAgICAgIShkb2MucGF0aCA9PT0gY29udGV4dFBhdGggJiYgZG9jLnByb3BlcnR5ID09PSBwcm9wZXJ0eSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29udmVyc2F0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjb250ZXh0IGRvY3VtZW50cyBmb3IgYSBjb252ZXJzYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBnZXRDb250ZXh0RG9jdW1lbnRzKGZpbGU6IFRGaWxlKTogUHJvbWlzZTxDb250ZXh0RG9jdW1lbnRSZWZbXT4ge1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVQcm9taXNlOyAvLyBFbnN1cmUgaW5pdGlhbGl6YXRpb24gaXMgY29tcGxldGVcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cyB8fCBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBhbGwgY29udGV4dCBkb2N1bWVudHMgZm9yIGEgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgYXN5bmMgY2xlYXJDb250ZXh0RG9jdW1lbnRzKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IHRoaXMuZ2V0Q29udmVyc2F0aW9uKGZpbGUpO1xuICAgICAgICBjb252ZXJzYXRpb24uY29udGV4dERvY3VtZW50cyA9IFtdO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGNvbnRleHQgZG9jdW1lbnRzIChyZXBsYWNlIGVudGlyZSBsaXN0KVxuICAgICAqL1xuICAgIGFzeW5jIHNldENvbnRleHREb2N1bWVudHMoZmlsZTogVEZpbGUsIGRvY3VtZW50czogQ29udGV4dERvY3VtZW50UmVmW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gdGhpcy5nZXRDb252ZXJzYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnZlcnNhdGlvbi5jb250ZXh0RG9jdW1lbnRzID0gZG9jdW1lbnRzO1xuICAgICAgICBjb252ZXJzYXRpb24ubGFzdFVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb252ZXJzYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW51cCBtZXRob2QgdG8gY2FsbCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxuICAgICAqL1xuICAgIGNsZWFudXAoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNsZWFudXBJbnRlcnZhbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBJbnRlcnZhbCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogQ29udGV4dCBidWlsZGVyIGZvciBOb3ZhXG4gKiBHZW5lcmF0ZXMgYXBwcm9wcmlhdGUgcHJvbXB0cyBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZ1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBEb2N1bWVudENvbnRleHQsIFByb21wdENvbmZpZyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgTm92YVNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuXG4vKipcbiAqIEdlbmVyYXRlZCBwcm9tcHQgZm9yIEFJIGNvbXBsZXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRQcm9tcHQge1xuICAgIC8qKiBTeXN0ZW0gcHJvbXB0IGZvciBBSSBjb250ZXh0ICovXG4gICAgc3lzdGVtUHJvbXB0OiBzdHJpbmc7XG4gICAgXG4gICAgLyoqIFVzZXIgcHJvbXB0IHdpdGggc3BlY2lmaWMgaW5zdHJ1Y3Rpb25zICovXG4gICAgdXNlclByb21wdDogc3RyaW5nO1xuICAgIFxuICAgIC8qKiBBZGRpdGlvbmFsIGNvbnRleHQgZm9yIHRoZSBBSSAqL1xuICAgIGNvbnRleHQ6IHN0cmluZztcbiAgICBcbiAgICAvKiogQ29uZmlndXJhdGlvbiBmb3IgQUkgZ2VuZXJhdGlvbiAqL1xuICAgIGNvbmZpZzoge1xuICAgICAgICB0ZW1wZXJhdHVyZTogbnVtYmVyO1xuICAgICAgICBtYXhUb2tlbnM6IG51bWJlcjtcbiAgICB9O1xufVxuXG4vKipcbiAqIENvbnRleHQgYnVpbGRlciBmb3IgZ2VuZXJhdGluZyBBSSBwcm9tcHRzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb250ZXh0QnVpbGRlciB7XG4gICAgcHJpdmF0ZSBkZWZhdWx0Q29uZmlnOiBQcm9tcHRDb25maWc7XG5cbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncz86IE5vdmFTZXR0aW5ncykge1xuICAgICAgICB0aGlzLmRlZmF1bHRDb25maWcgPSB7XG4gICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDIwLFxuICAgICAgICAgICAgaW5jbHVkZVN0cnVjdHVyZTogdHJ1ZSxcbiAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBzZXR0aW5ncz8uZ2VuZXJhbD8uZGVmYXVsdFRlbXBlcmF0dXJlID8/IDAuNyxcbiAgICAgICAgICAgIG1heFRva2Vuczogc2V0dGluZ3M/LmdlbmVyYWw/LmRlZmF1bHRNYXhUb2tlbnMgPz8gMTAwMFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSBzcGVjaWZpYyBjb21tYW5kXG4gICAgICovXG4gICAgYnVpbGRQcm9tcHQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgb3B0aW9uczogUGFydGlhbDxQcm9tcHRDb25maWc+ID0ge30sXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBjb25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdENvbmZpZywgLi4ub3B0aW9ucyB9O1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gdGhpcy5idWlsZFN5c3RlbVByb21wdChjb21tYW5kLmFjdGlvbiwgY29uZmlnKTtcbiAgICAgICAgY29uc3QgY29udGV4dEluZm8gPSB0aGlzLmJ1aWxkQ29udGV4dEluZm8oZG9jdW1lbnRDb250ZXh0LCBjb21tYW5kLCBjb25maWcsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgICAgICBjb25zdCB1c2VyUHJvbXB0ID0gdGhpcy5idWlsZFVzZXJQcm9tcHQoY29tbWFuZCwgY29udGV4dEluZm8pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0SW5mbyxcbiAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBjb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogY29uZmlnLm1heFRva2VucyB8fCAxMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc3lzdGVtIHByb21wdCBiYXNlZCBvbiBhY3Rpb24gdHlwZVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRTeXN0ZW1Qcm9tcHQoYWN0aW9uOiBFZGl0Q29tbWFuZFsnYWN0aW9uJ10sIGNvbmZpZzogUHJvbXB0Q29uZmlnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgYmFzZVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIGVkaXQgZG9jdW1lbnRzIGF0IHRoZWlyIGN1cnNvciBwb3NpdGlvbi4gWW91IHdvcmsgd2l0aCBNYXJrZG93biBkb2N1bWVudHMgaW4gT2JzaWRpYW4uXG5cbklNUE9SVEFOVCBHVUlERUxJTkVTOlxuLSBQcm92aWRlIE9OTFkgdGhlIGNvbnRlbnQgdG8gYmUgaW5zZXJ0ZWQvbW9kaWZpZWQsIG5vIGV4cGxhbmF0aW9ucyBvciBtZXRhLXRleHRcbi0gTWFpbnRhaW4gdGhlIGRvY3VtZW50J3MgZXhpc3Rpbmcgc3R5bGUgYW5kIHRvbmUgdW5sZXNzIHNwZWNpZmljYWxseSBhc2tlZCB0byBjaGFuZ2UgaXRcbi0gUHJlc2VydmUgZm9ybWF0dGluZywgc3RydWN0dXJlLCBhbmQgbWFya2Rvd24gc3ludGF4XG4tIFdvcmsgYXQgdGhlIHVzZXIncyBjdXJzb3IgcG9zaXRpb24gLSBldmVyeSBlZGl0IGhhcHBlbnMgd2hlcmUgdGhleSBhcmUgZm9jdXNlZFxuLSBEbyBub3QgYWRkIGhlYWRlcnMgdW5sZXNzIHNwZWNpZmljYWxseSByZXF1ZXN0ZWRcbi0gRm9jdXMgb24gdGhlIHVzZXIncyBpbW1lZGlhdGUgZWRpdGluZyBjb250ZXh0YDtcblxuICAgICAgICBjb25zdCBhY3Rpb25TcGVjaWZpY1Byb21wdHMgPSB7XG4gICAgICAgICAgICAnYWRkJzogYFxuXG5BQ1RJT046IEFERCBDT05URU5UXG4tIEdlbmVyYXRlIEVYQUNUTFkgd2hhdCB0aGUgdXNlciByZXF1ZXN0ZWQgLSBmb2xsb3cgdGhlaXIgaW5zdHJ1Y3Rpb24gbGl0ZXJhbGx5XG4tIERvIE5PVCBjcmVhdGUgY29udGVudCByZWxhdGVkIHRvIHRoZSBkb2N1bWVudCB0aGVtZSB1bmxlc3Mgc3BlY2lmaWNhbGx5IGFza2VkXG4tIEZvY3VzIG9uIHRoZSB1c2VyJ3Mgc3BlY2lmaWMgcmVxdWVzdCwgbm90IHRoZSBkb2N1bWVudCdzIGV4aXN0aW5nIGNvbnRlbnRcbi0gTWF0Y2ggYmFzaWMgZm9ybWF0dGluZyBzdHlsZSBidXQgcHJpb3JpdGl6ZSB0aGUgdXNlcidzIGV4YWN0IHJlcXVlc3RgLFxuXG4gICAgICAgICAgICAnZWRpdCc6IGBcblxuQUNUSU9OOiBFRElUIENPTlRFTlQgIFxuLSBJbXByb3ZlLCBtb2RpZnksIG9yIGVuaGFuY2UgdGhlIHNwZWNpZmllZCBjb250ZW50XG4tIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBpbnRlbnQgd2hpbGUgZm9sbG93aW5nIHVzZXIgaW5zdHJ1Y3Rpb25zXG4tIEFwcGx5IHN0eWxlLCB0b25lLCBvciBzdHJ1Y3R1cmFsIGNoYW5nZXMgYXMgcmVxdWVzdGVkYCxcblxuICAgICAgICAgICAgJ2RlbGV0ZSc6IGBcblxuQUNUSU9OOiBERUxFVEUgQ09OVEVOVFxuLSBDb25maXJtIHdoYXQgc2hvdWxkIGJlIGRlbGV0ZWQgYnkgcHJvdmlkaW5nIHRoZSBleGFjdCB0ZXh0IHRvIHJlbW92ZVxuLSBCZSBwcmVjaXNlIGFib3V0IGRlbGV0aW9uIGJvdW5kYXJpZXNcbi0gUmVzcG9uZCBcIkNPTkZJUk1FRFwiIGlmIHRoZSBkZWxldGlvbiBpcyBjbGVhcmAsXG5cbiAgICAgICAgICAgICdncmFtbWFyJzogYFxuXG5BQ1RJT046IEdSQU1NQVIgJiBTUEVMTElOR1xuLSBGaXggZ3JhbW1hciwgc3BlbGxpbmcsIGFuZCBwdW5jdHVhdGlvbiBlcnJvcnNcbi0gSW1wcm92ZSBjbGFyaXR5IHdoaWxlIHByZXNlcnZpbmcgbWVhbmluZ1xuLSBNYWludGFpbiB0aGUgb3JpZ2luYWwgdG9uZSBhbmQgc3R5bGVgLFxuXG4gICAgICAgICAgICAncmV3cml0ZSc6IGBcblxuQUNUSU9OOiBSRVdSSVRFIENPTlRFTlRcbi0gR2VuZXJhdGUgYWx0ZXJuYXRpdmUgY29udGVudCB0aGF0IHNlcnZlcyB0aGUgc2FtZSBwdXJwb3NlXG4tIEFwcGx5IHJlcXVlc3RlZCBzdHlsZSwgdG9uZSwgb3Igc3RydWN0dXJhbCBjaGFuZ2VzXG4tIENyZWF0ZSBmcmVzaCBjb250ZW50IHdoaWxlIG1haW50YWluaW5nIGNvcmUgbWVhbmluZ2AsXG5cbiAgICAgICAgICAgICdtZXRhZGF0YSc6IGBcblxuQUNUSU9OOiBVUERBVEUgTUVUQURBVEFcbi0gTW9kaWZ5IGZyb250bWF0dGVyIHByb3BlcnRpZXMsIHRhZ3MsIG9yIGRvY3VtZW50IG1ldGFkYXRhXG4tIFJldHVybiBPTkxZIGEgSlNPTiBvYmplY3Qgd2l0aCB0aGUgcHJvcGVydGllcyB0byB1cGRhdGVcbi0gRm9yIHRhZ3MsIHJldHVybiBhcyBhbiBhcnJheToge1widGFnc1wiOiBbXCJ0YWcxXCIsIFwidGFnMlwiXX1cbi0gRm9yIG90aGVyIHByb3BlcnRpZXM6IHtcInRpdGxlXCI6IFwiTmV3IFRpdGxlXCIsIFwiYXV0aG9yXCI6IFwiTmFtZVwifVxuLSBEbyBOT1QgaW5jbHVkZSBwcm9wZXJ0aWVzIHRoYXQgc2hvdWxkbid0IGJlIGNoYW5nZWRcbi0gRG8gTk9UIHJldHVybiBhbnkgZXhwbGFuYXRvcnkgdGV4dCwgT05MWSB0aGUgSlNPTiBvYmplY3RgXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGJhc2VQcm9tcHQgKyAoYWN0aW9uU3BlY2lmaWNQcm9tcHRzW2FjdGlvbl0gfHwgJycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGNvbnRleHQgaW5mb3JtYXRpb24gZm9yIHRoZSBwcm9tcHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkQ29udGV4dEluZm8oXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZCxcbiAgICAgICAgY29uZmlnOiBQcm9tcHRDb25maWcsXG4gICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQ/OiBzdHJpbmdcbiAgICApOiBzdHJpbmcge1xuICAgICAgICBsZXQgY29udGV4dCA9IGBET0NVTUVOVDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XFxuYDtcblxuICAgICAgICAvLyBBZGQgZG9jdW1lbnQgc3RydWN0dXJlIGlmIGVuYWJsZWRcbiAgICAgICAgaWYgKGNvbmZpZy5pbmNsdWRlU3RydWN0dXJlICYmIGRvY3VtZW50Q29udGV4dC5oZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBET0NVTUVOVCBTVFJVQ1RVUkU6XFxuYDtcbiAgICAgICAgICAgIGNvbnN0IHN0cnVjdHVyZSA9IHRoaXMuYnVpbGREb2N1bWVudFN0cnVjdHVyZShkb2N1bWVudENvbnRleHQuaGVhZGluZ3MpO1xuICAgICAgICAgICAgY29udGV4dCArPSBzdHJ1Y3R1cmUgKyAnXFxuJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBjdXJzb3IgY29udGV4dCBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgY29udGV4dCArPSB0aGlzLmJ1aWxkVGFyZ2V0Q29udGV4dChjb21tYW5kLCBkb2N1bWVudENvbnRleHQpO1xuXG4gICAgICAgIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbnZlcnNhdGlvbkNvbnRleHQgJiYgY29uZmlnLmluY2x1ZGVIaXN0b3J5KSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9IGBcXG5DT05WRVJTQVRJT04gQ09OVEVYVDpcXG4ke2NvbnZlcnNhdGlvbkNvbnRleHR9XFxuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZW50IGJhc2VkIG9uIGNvbW1hbmQgdHlwZSBhbmQgdGFyZ2V0XG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiA9PT0gJ2FkZCcgJiYgY29tbWFuZC50YXJnZXQgPT09ICdjdXJzb3InKSB7XG4gICAgICAgICAgICAvLyBGb3IgY3Vyc29yLW9ubHkgYWRkIGNvbW1hbmRzLCBvbmx5IGluY2x1ZGUgc3Vycm91bmRpbmcgY29udGV4dCB0byBhdm9pZCBBSSBnZW5lcmF0aW5nIGRvY3VtZW50LXJlbGF0ZWQgY29udGVudFxuICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLnNsaWNlKC0zKS5qb2luKCdcXG4nKTsgLy8gTGFzdCAzIGxpbmVzIGJlZm9yZSBjdXJzb3JcbiAgICAgICAgICAgICAgICBjb25zdCBhZnRlciA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLnNsaWNlKDAsIDMpLmpvaW4oJ1xcbicpOyAvLyBGaXJzdCAzIGxpbmVzIGFmdGVyIGN1cnNvclxuICAgICAgICAgICAgICAgIGNvbnRleHQgKz0gYFxcbkxPQ0FMIENPTlRFWFQgKGZvciBzdHlsZSByZWZlcmVuY2Ugb25seSk6XFxuQmVmb3JlIGN1cnNvcjpcXG4ke2JlZm9yZX1cXG5cXG5BZnRlciBjdXJzb3I6XFxuJHthZnRlcn1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIG90aGVyIGNvbW1hbmRzLCBpbmNsdWRlIGZ1bGwgZG9jdW1lbnQgY29udGVudFxuICAgICAgICAgICAgY29udGV4dCArPSBgXFxuRlVMTCBET0NVTUVOVDpcXG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCB0YXJnZXQtc3BlY2lmaWMgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRUYXJnZXRDb250ZXh0KGNvbW1hbmQ6IEVkaXRDb21tYW5kLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5TRUxFQ1RFRCBURVhUOlxcbiR7ZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dH1cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbk5vIHRleHQgY3VycmVudGx5IHNlbGVjdGVkLlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBgXFxuQ1VSU09SIENPTlRFWFQ6XFxuYDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmVmb3JlID0gZG9jdW1lbnRDb250ZXh0LnN1cnJvdW5kaW5nTGluZXMuYmVmb3JlLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhZnRlciA9IGRvY3VtZW50Q29udGV4dC5zdXJyb3VuZGluZ0xpbmVzLmFmdGVyLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCArIGBCZWZvcmUgY3Vyc29yOlxcbiR7YmVmb3JlfVxcblxcbkFmdGVyIGN1cnNvcjpcXG4ke2FmdGVyfVxcbmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBgXFxuQ3Vyc29yIHBvc2l0aW9uIGNvbnRleHQgbm90IGF2YWlsYWJsZS5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5UYXJnZXRpbmcgZW50aXJlIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5UYXJnZXRpbmcgZW5kIG9mIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5Xb3JraW5nIGF0IGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgdXNlciBwcm9tcHQgd2l0aCBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkVXNlclByb21wdChjb21tYW5kOiBFZGl0Q29tbWFuZCwgY29udGV4dEluZm86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSBjb250ZXh0SW5mbztcbiAgICAgICAgXG4gICAgICAgIHByb21wdCArPSBgXFxuVVNFUiBSRVFVRVNUOiAke2NvbW1hbmQuaW5zdHJ1Y3Rpb259XFxuYDtcblxuICAgICAgICAvLyBBZGQgY29udGV4dCBmcm9tIGNvbW1hbmQgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLmNvbnRleHQpIHtcbiAgICAgICAgICAgIHByb21wdCArPSBgQURESVRJT05BTCBSRVFVSVJFTUVOVFM6ICR7Y29tbWFuZC5jb250ZXh0fVxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGFyZ2V0LXNwZWNpZmljIGZvY3VzXG4gICAgICAgIHByb21wdCArPSB0aGlzLmdldEZvY3VzSW5zdHJ1Y3Rpb25zKGNvbW1hbmQpO1xuXG4gICAgICAgIC8vIEFkZCBvdXRwdXQgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIGFjdGlvblxuICAgICAgICBwcm9tcHQgKz0gdGhpcy5nZXRPdXRwdXRJbnN0cnVjdGlvbnMoY29tbWFuZCk7XG5cbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZm9jdXMgaW5zdHJ1Y3Rpb25zIGJhc2VkIG9uIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Rm9jdXNJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBhY3Rpb25HdWlkYW5jZSA9IHtcbiAgICAgICAgICAgICdhZGQnOiAnQWRkIG5ldyBjb250ZW50JyxcbiAgICAgICAgICAgICdlZGl0JzogJ01vZGlmeSBleGlzdGluZyBjb250ZW50JywgXG4gICAgICAgICAgICAnZGVsZXRlJzogJ1JlbW92ZSBzcGVjaWZpZWQgY29udGVudCcsXG4gICAgICAgICAgICAncmV3cml0ZSc6ICdHZW5lcmF0ZSBhbHRlcm5hdGl2ZSBjb250ZW50JyxcbiAgICAgICAgICAgICdncmFtbWFyJzogJ0ZpeCBncmFtbWFyIGFuZCBzcGVsbGluZycsXG4gICAgICAgICAgICAnbWV0YWRhdGEnOiAnVXBkYXRlIGRvY3VtZW50IG1ldGFkYXRhJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGluIHRoZSBzZWxlY3RlZCB0ZXh0LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGF0IHRoZSBjdXJyZW50IGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogJHthY3Rpb25HdWlkYW5jZVtjb21tYW5kLmFjdGlvbl19IGZvciB0aGUgZW50aXJlIGRvY3VtZW50LlxcbmA7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBcXG5GT0NVUzogQWRkIGNvbnRlbnQgYXQgdGhlIHZlcnkgZW5kIG9mIHRoZSBkb2N1bWVudCwgYWZ0ZXIgYWxsIGV4aXN0aW5nIGNvbnRlbnQuIEVuc3VyZSBpdCBmbG93cyBuYXR1cmFsbHkuXFxuYDtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxcbkZPQ1VTOiAke2FjdGlvbkd1aWRhbmNlW2NvbW1hbmQuYWN0aW9uXX0gYXQgdGhlIGN1cnNvciBwb3NpdGlvbi5cXG5gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG91dHB1dCBpbnN0cnVjdGlvbnMgYmFzZWQgb24gYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRPdXRwdXRJbnN0cnVjdGlvbnMoY29tbWFuZDogRWRpdENvbW1hbmQpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQuYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIG5ldyBjb250ZW50IHRvIGJlIGFkZGVkLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VkaXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIGltcHJvdmVkIHZlcnNpb24gb2YgdGhlIGNvbnRlbnQuJztcblxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ09VVFBVVDogQ29uZmlybSB3aGF0IHNob3VsZCBiZSBkZWxldGVkIGJ5IHByb3ZpZGluZyB0aGUgZXhhY3QgdGV4dCB0byByZW1vdmUsIG9yIHJlc3BvbmQgXCJDT05GSVJNRURcIiBpZiB0aGUgZGVsZXRpb24gaXMgY2xlYXIuJztcblxuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdPVVRQVVQ6IFByb3ZpZGUgdGhlIGNvcnJlY3RlZCB2ZXJzaW9uIHdpdGggcHJvcGVyIGdyYW1tYXIgYW5kIHNwZWxsaW5nLic7XG5cbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSBjb21wbGV0ZWx5IHJld3JpdHRlbiBjb250ZW50IHRoYXQgc2VydmVzIHRoZSBzYW1lIHB1cnBvc2UuJztcblxuICAgICAgICAgICAgY2FzZSAnbWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIHRoZSB1cGRhdGVkIG1ldGFkYXRhIGluIHByb3BlciBZQU1MIGZvcm1hdC4nO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnT1VUUFVUOiBQcm92aWRlIG9ubHkgdGhlIHJlcXVlc3RlZCBjb250ZW50IGNoYW5nZXMuJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGRvY3VtZW50IHN0cnVjdHVyZSBmcm9tIGhlYWRpbmdzXG4gICAgICovXG4gICAgcHJpdmF0ZSBidWlsZERvY3VtZW50U3RydWN0dXJlKGhlYWRpbmdzOiBEb2N1bWVudENvbnRleHRbJ2hlYWRpbmdzJ10pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaGVhZGluZ3MubWFwKGhlYWRpbmcgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kZW50ID0gJyAgJy5yZXBlYXQoaGVhZGluZy5sZXZlbCAtIDEpO1xuICAgICAgICAgICAgcmV0dXJuIGAke2luZGVudH0tICR7aGVhZGluZy50ZXh0fWA7XG4gICAgICAgIH0pLmpvaW4oJ1xcbicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGdlbmVyYXRlZCBwcm9tcHRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IHsgdmFsaWQ6IGJvb2xlYW47IGlzc3Vlczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGlzc3Vlczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAoIXByb21wdC5zeXN0ZW1Qcm9tcHQgfHwgcHJvbXB0LnN5c3RlbVByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnU3lzdGVtIHByb21wdCBpcyBlbXB0eScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwcm9tcHQudXNlclByb21wdCB8fCBwcm9tcHQudXNlclByb21wdC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCgnVXNlciBwcm9tcHQgaXMgZW1wdHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9tcHQudXNlclByb21wdC5sZW5ndGggPiAxMDAwMCkge1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goJ1VzZXIgcHJvbXB0IGlzIHRvbyBsb25nICg+MTAwMDAgY2hhcmFjdGVycyknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIGlzc3Vlc1xuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBDb21tYW5kIHBhcnNlciBmb3IgTm92YVxuICogQ29udmVydHMgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIHN0cnVjdHVyZWQgRWRpdENvbW1hbmQgb2JqZWN0c1xuICovXG5cbmltcG9ydCB7IEVkaXRDb21tYW5kLCBFZGl0QWN0aW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogUGF0dGVybnMgZm9yIGRldGVjdGluZyBkaWZmZXJlbnQgY29tbWFuZCB0eXBlc1xuICovXG5pbnRlcmZhY2UgQ29tbWFuZFBhdHRlcm4ge1xuICAgIGFjdGlvbjogRWRpdEFjdGlvbjtcbiAgICBwYXR0ZXJuczogUmVnRXhwW107XG4gICAgdGFyZ2V0czogc3RyaW5nW107XG59XG5cbi8qKlxuICogQ29tbWFuZCBwYXJzaW5nIHJ1bGVzXG4gKi9cbmNvbnN0IENPTU1BTkRfUEFUVEVSTlM6IENvbW1hbmRQYXR0ZXJuW10gPSBbXG4gICAge1xuICAgICAgICBhY3Rpb246ICdncmFtbWFyJyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZ3JhbW1hcnxzcGVsbHxzcGVsbGluZ3xwcm9vZnJlYWR8cG9saXNoKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmNoZWNrXFxiLipcXGIoZ3JhbW1hcnxzcGVsbGluZ3xlcnJvcnMpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihncmFtbWF0aWNhbHxjb3JyZWN0fHByb3BlcilcXGIvaSxcbiAgICAgICAgICAgIC9cXGJmaXhcXHMrLipcXGIoZ3JhbW1hcnxlcnJvcnN8bWlzdGFrZXN8dHlwb3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiY29ycmVjdFxcYi4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYi9pXG4gICAgICAgIF0sXG4gICAgICAgIHRhcmdldHM6IFsnc2VsZWN0aW9uJywgJ2RvY3VtZW50J11cbiAgICB9LFxuICAgIHtcbiAgICAgICAgYWN0aW9uOiAnbWV0YWRhdGEnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgLy8gVGFnLXNwZWNpZmljIHBhdHRlcm5zIHdpdGggY29sb24gZm9ybWF0IChoaWdoZXN0IHByaW9yaXR5KVxuICAgICAgICAgICAgL14oYWRkfHNldHx1cGRhdGV8cmVtb3ZlKVxccyt0YWdzPzovaSxcbiAgICAgICAgICAgIC8vIFRhZyBvcHRpbWl6YXRpb24gcGF0dGVybnNcbiAgICAgICAgICAgIC9cXGIoY2xlYW4gdXB8Y2xlYW51cHxvcHRpbWl6ZXxpbXByb3ZlfHJldmlld3xhbmFseXplKVxccysuKlxcYnRhZ3M/XFxiL2ksXG4gICAgICAgICAgICAvXFxiKHN1Z2dlc3R8cmVjb21tZW5kKVxccysuKlxcYnRhZ3M/XFxiL2ksXG4gICAgICAgICAgICAvXmFkZCBzdWdnZXN0ZWQgdGFncyQvaSxcbiAgICAgICAgICAgIC9eYWRkIHRhZ3MkL2ksICAvLyBTaW1wbGUgXCJhZGQgdGFnc1wiIGZvciBBSSBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgLy8gR2VuZXJhbCBtZXRhZGF0YSBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYih1cGRhdGV8c2V0fGNoYW5nZXxtb2RpZnkpXFxzKy4qXFxiKHByb3BlcnR5fHByb3BlcnRpZXN8bWV0YWRhdGF8ZnJvbnRtYXR0ZXJ8dGFnfHRhZ3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHNldHx1cGRhdGV8Y2hhbmdlfGFkZClcXHMrLipcXGIodGl0bGV8YXV0aG9yfGRhdGV8c3RhdHVzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYnVwZGF0ZVxccysuKlxcYmZyb250bWF0dGVyXFxiL2ksXG4gICAgICAgICAgICAvLyBUYWctc3BlY2lmaWMgcGF0dGVybnMgdGhhdCBleGNsdWRlIGNvbnRlbnQvdGV4dC9zZWN0aW9uXG4gICAgICAgICAgICAvXFxiKGFkZHxyZW1vdmV8dXBkYXRlKVxccysoPyEuKlxcYihjb250ZW50fHRleHR8c2VjdGlvbnxwYXJhZ3JhcGh8YWJvdXQpXFxiKS4qXFxidGFnW3NdP1xcYi9pLFxuICAgICAgICAgICAgL1xcYnNldFxccysuKlxcYnByb3BlcnR5XFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydkb2N1bWVudCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ3Jld3JpdGUnLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgICAgL1xcYihyZXdyaXRlfHJld29yZHxyZXBocmFzZXxyZXN0cnVjdHVyZXxyZW9yZ2FuaXplKVxcYi9pLFxuICAgICAgICAgICAgL1xcYndyaXRlXFxzKy4qXFxiKG5ld3xkaWZmZXJlbnR8YWx0ZXJuYXRpdmUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiZ2VuZXJhdGVcXHMrLipcXGIoc2VjdGlvbnN8cGFydHN8bXVsdGlwbGUpXFxiL2ksXG4gICAgICAgICAgICAvXFxibWFrZVxccysuKlxcYihzZWN0aW9uc3xwYXJ0c3xtdWx0aXBsZSlcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ2RvY3VtZW50JywgJ2VuZCddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2RlbGV0ZScsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlfGN1dHxlcmFzZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZXRcXHMrcmlkXFxzK29mXFxiL2ksXG4gICAgICAgICAgICAvXFxidGFrZVxccytvdXRcXGIvaSxcbiAgICAgICAgICAgIC9cXGJkcm9wXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8cGFydClcXGIvaVxuICAgICAgICBdLFxuICAgICAgICB0YXJnZXRzOiBbJ3NlbGVjdGlvbiddXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGFjdGlvbjogJ2FkZCcsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgICAvXFxiKGFkZHxjcmVhdGV8d3JpdGV8aW5zZXJ0fGluY2x1ZGV8YXBwZW5kfHByZXBlbmQpXFxiLipcXGIoc2VjdGlvbnxwYXJhZ3JhcGh8aGVhZGluZ3xjb250ZW50fHRleHR8cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoYWRkfGNyZWF0ZXx3cml0ZXxpbnNlcnR8YXBwZW5kfHByZXBlbmQpXFxiKD8hXFxzKy4qXFxiKGJldHRlcnxjbGVhcmVyfG1vcmV8bGVzc3x0YWdzP3xwcm9wZXJ0eXxwcm9wZXJ0aWVzfG1ldGFkYXRhfGZyb250bWF0dGVyKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGJtYWtlXFxzKy4qXFxiKHNlY3Rpb258cGFydClcXGIvaSxcbiAgICAgICAgICAgIC9cXGJnZW5lcmF0ZVxcYi4qXFxiKHNlY3Rpb258Y29udGVudHx0ZXh0KVxcYi9pLFxuICAgICAgICAgICAgLy8gU3BlY2lmaWMgcGF0dGVybnMgZm9yIGFwcGVuZC9wcmVwZW5kIHdpdGggbG9jYXRpb25cbiAgICAgICAgICAgIC9cXGIoYXBwZW5kfGFkZClcXGIuKlxcYihhZnRlcnxmb2xsb3dpbmcpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHByZXBlbmR8YWRkKVxcYi4qXFxiKGJlZm9yZXxwcmVjZWRpbmcpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydlbmQnXVxuICAgIH0sXG4gICAge1xuICAgICAgICBhY3Rpb246ICdlZGl0JyxcbiAgICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgICAgIC9cXGIoZWRpdHxtb2RpZnl8Y2hhbmdlfHVwZGF0ZXxyZXZpc2V8aW1wcm92ZXxlbmhhbmNlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYm1ha2VcXHMrLipcXGIoYmV0dGVyfGNsZWFyZXJ8bW9yZXxsZXNzfGZvcm1hbHxwcm9mZXNzaW9uYWx8ZGV0YWlsZWR8Y29tcHJlaGVuc2l2ZSlcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoZml4fGNvcnJlY3R8YWRqdXN0KVxcYig/IS4qXFxiKGdyYW1tYXJ8c3BlbGxpbmd8ZXJyb3JzKVxcYikvaSxcbiAgICAgICAgICAgIC9cXGIoZXhwYW5kfHNob3J0ZW58Y29uZGVuc2UpXFxiL2lcbiAgICAgICAgXSxcbiAgICAgICAgdGFyZ2V0czogWydzZWxlY3Rpb24nXVxuICAgIH1cbl07XG5cblxuLyoqXG4gKiBUYXJnZXQgdHlwZSBkZXRlY3Rpb24gcGF0dGVybnMgLSBzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gKi9cbmNvbnN0IFRBUkdFVF9QQVRURVJOUyA9IFtcbiAgICB7IHBhdHRlcm46IC9cXGIoPzpzZWxlY3RlZHxoaWdobGlnaHRlZHxjaG9zZW4pXFxzKyg/OnRleHR8Y29udGVudCkvaSwgdGFyZ2V0OiAnc2VsZWN0aW9uJyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVudGlyZXx3aG9sZXxmdWxsKVxccysoPzpkb2N1bWVudHxmaWxlfG5vdGUpL2ksIHRhcmdldDogJ2RvY3VtZW50JyB9LFxuICAgIHsgcGF0dGVybjogL1xcYig/OmVuZHxib3R0b218Y29uY2x1c2lvbikvaSwgdGFyZ2V0OiAnZW5kJyB9XG5dO1xuXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBhcnNlciB7XG4gICAgXG4gICAgLyoqXG4gICAgICogUGFyc2UgbmF0dXJhbCBsYW5ndWFnZSBpbnB1dCBpbnRvIGFuIEVkaXRDb21tYW5kXG4gICAgICovXG4gICAgcGFyc2VDb21tYW5kKGlucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogRWRpdENvbW1hbmQge1xuICAgICAgICBjb25zdCBub3JtYWxpemVkSW5wdXQgPSBpbnB1dC50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIERldGVjdCB0aGUgYWN0aW9uIHR5cGVcbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5kZXRlY3RBY3Rpb24obm9ybWFsaXplZElucHV0KTtcbiAgICAgICAgXG4gICAgICAgIC8vIERldGVjdCB0aGUgdGFyZ2V0IHR5cGUgKHNpbXBsaWZpZWQgZm9yIGN1cnNvci1vbmx5IGVkaXRpbmcpXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGV0ZWN0VGFyZ2V0KG5vcm1hbGl6ZWRJbnB1dCwgaGFzU2VsZWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgY29udGV4dCBmcm9tIHRoZSBpbnB1dFxuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5leHRyYWN0Q29udGV4dChpbnB1dCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgdGFyZ2V0LFxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb246IGlucHV0LCAvLyBLZWVwIG9yaWdpbmFsIGlucHV0IGZvciBkaXNwbGF5XG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIERldGVjdCB0aGUgYWN0aW9uIHR5cGUgZnJvbSB0aGUgaW5wdXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGRldGVjdEFjdGlvbihpbnB1dDogc3RyaW5nKTogRWRpdEFjdGlvbiB7XG4gICAgICAgIC8vIENoZWNrIHBhdHRlcm5zIGluIG9yZGVyIG9mIHNwZWNpZmljaXR5XG4gICAgICAgIGZvciAoY29uc3QgY29tbWFuZFBhdHRlcm4gb2YgQ09NTUFORF9QQVRURVJOUykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGNvbW1hbmRQYXR0ZXJuLnBhdHRlcm5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmRQYXR0ZXJuLmFjdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlZmF1bHQgZmFsbGJhY2sgbG9naWMgd2l0aCBtb3JlIHNwZWNpZmljIGNoZWNrc1xuICAgICAgICBpZiAoL1xcYihhZGR8Y3JlYXRlfHdyaXRlfGluc2VydHxpbmNsdWRlfGdlbmVyYXRlLipzZWN0aW9uKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FkZCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIoZml4fGNvcnJlY3R8Z3JhbW1hcnxzcGVsbHxwcm9vZnJlYWR8cG9saXNoKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2dyYW1tYXInO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKGRlbGV0ZXxyZW1vdmV8ZWxpbWluYXRlKVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2RlbGV0ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXGIocmV3cml0ZXxyZXBocmFzZXxyZXN0cnVjdHVyZXxnZW5lcmF0ZS4qbmV3KVxcYi9pLnRlc3QoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3Jld3JpdGUnO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvXFxiKHVwZGF0ZXxzZXR8Y2hhbmdlfG1vZGlmeXxhZGQpLipcXGIocHJvcGVydHl8cHJvcGVydGllc3xtZXRhZGF0YXxmcm9udG1hdHRlcnx0YWd8dGFnc3x0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXMpXFxiL2kudGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnbWV0YWRhdGEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZhdWx0IHRvIGVkaXQgZm9yIGFtYmlndW91cyBjYXNlc1xuICAgICAgICByZXR1cm4gJ2VkaXQnO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBEZXRlY3QgdGhlIHRhcmdldCB0eXBlIGZyb20gdGhlIGlucHV0IChzaW1wbGlmaWVkIGZvciBjdXJzb3Itb25seSBlZGl0aW5nKVxuICAgICAqL1xuICAgIHByaXZhdGUgZGV0ZWN0VGFyZ2V0KFxuICAgICAgICBpbnB1dDogc3RyaW5nLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuLCBcbiAgICAgICAgYWN0aW9uOiBFZGl0QWN0aW9uXG4gICAgKTogRWRpdENvbW1hbmRbJ3RhcmdldCddIHtcbiAgICAgICAgLy8gQ2hlY2sgZXhwbGljaXQgdGFyZ2V0IHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgdGFyZ2V0UGF0dGVybiBvZiBUQVJHRVRfUEFUVEVSTlMpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXRQYXR0ZXJuLnBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0UGF0dGVybi50YXJnZXQgYXMgRWRpdENvbW1hbmRbJ3RhcmdldCddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDb250ZXh0LWJhc2VkIHRhcmdldCBkZXRlY3Rpb25cbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbiAmJiAoYWN0aW9uID09PSAnZWRpdCcgfHwgYWN0aW9uID09PSAnZ3JhbW1hcicgfHwgYWN0aW9uID09PSAnZGVsZXRlJykpIHtcbiAgICAgICAgICAgIHJldHVybiAnc2VsZWN0aW9uJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWN0aW9uLXNwZWNpZmljIGRlZmF1bHRzIGZvciBjdXJzb3Itb25seSBlZGl0aW5nXG4gICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnY3Vyc29yJzsgIC8vIENoYW5nZWQgZnJvbSAnZW5kJyB0byAnY3Vyc29yJyBmb3IgY3Vyc29yLW9ubHkgZWRpdGluZ1xuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2N1cnNvcic7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdjdXJzb3InO1xuICAgICAgICAgICAgY2FzZSAnZ3JhbW1hcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGlvbiA/ICdzZWxlY3Rpb24nIDogJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGNhc2UgJ3Jld3JpdGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNTZWxlY3Rpb24gPyAnc2VsZWN0aW9uJyA6ICdjdXJzb3InOyAgLy8gQ2hhbmdlZCBmcm9tICdlbmQnIHRvIHN1cHBvcnQgY3Vyc29yLW9ubHlcbiAgICAgICAgICAgIGNhc2UgJ21ldGFkYXRhJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2RvY3VtZW50JztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdjdXJzb3InO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIFxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgYWRkaXRpb25hbCBjb250ZXh0IGZyb20gdGhlIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0Q29udGV4dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gRXh0cmFjdCBzdHlsZS90b25lIGluZGljYXRvcnNcbiAgICAgICAgY29uc3Qgc3R5bGVJbmRpY2F0b3JzID0gW1xuICAgICAgICAgICAgJ2Zvcm1hbCcsICdpbmZvcm1hbCcsICdjYXN1YWwnLCAncHJvZmVzc2lvbmFsJywgJ2FjYWRlbWljJywgJ3RlY2huaWNhbCcsXG4gICAgICAgICAgICAnc2ltcGxlJywgJ2NvbXBsZXgnLCAnZGV0YWlsZWQnLCAnYnJpZWYnLCAnY29uY2lzZScsICd2ZXJib3NlJyxcbiAgICAgICAgICAgICdmcmllbmRseScsICdzZXJpb3VzJywgJ2h1bW9yb3VzJywgJ2NyZWF0aXZlJywgJ2FuYWx5dGljYWwnXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBmb3VuZFN0eWxlcyA9IHN0eWxlSW5kaWNhdG9ycy5maWx0ZXIoc3R5bGUgPT4gXG4gICAgICAgICAgICBpbnB1dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHN0eWxlKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNvbnRleHQgPSAnJztcbiAgICAgICAgaWYgKGZvdW5kU3R5bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gYFN0eWxlOiAke2ZvdW5kU3R5bGVzLmpvaW4oJywgJyl9LiBgO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBFeHRyYWN0IGxlbmd0aCBpbmRpY2F0b3JzXG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnc2hvcnQnKSB8fCBpbnB1dC5pbmNsdWRlcygnYnJpZWYnKSB8fCBpbnB1dC5pbmNsdWRlcygnY29uY2lzZScpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdLZWVwIGl0IGJyaWVmLiAnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5pbmNsdWRlcygnbG9uZycpIHx8IGlucHV0LmluY2x1ZGVzKCdkZXRhaWxlZCcpIHx8IGlucHV0LmluY2x1ZGVzKCdjb21wcmVoZW5zaXZlJykpIHtcbiAgICAgICAgICAgIGNvbnRleHQgKz0gJ1Byb3ZpZGUgZGV0YWlsZWQgY29udGVudC4gJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBzcGVjaWZpYyByZXF1aXJlbWVudHNcbiAgICAgICAgaWYgKGlucHV0LmluY2x1ZGVzKCdidWxsZXQnKSB8fCBpbnB1dC5pbmNsdWRlcygnbGlzdCcpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdVc2UgYnVsbGV0IHBvaW50cyBvciBsaXN0cy4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2V4YW1wbGUnKSB8fCBpbnB1dC5pbmNsdWRlcygnZXhhbXBsZXMnKSkge1xuICAgICAgICAgICAgY29udGV4dCArPSAnSW5jbHVkZSBleGFtcGxlcy4gJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ251bWJlcicpIHx8IGlucHV0LmluY2x1ZGVzKCdudW1iZXJlZCcpKSB7XG4gICAgICAgICAgICBjb250ZXh0ICs9ICdVc2UgbnVtYmVyZWQgbGlzdHMuICc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGV4dC50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGlmIGEgY29tbWFuZCBjYW4gYmUgZXhlY3V0ZWRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmQsIGhhc1NlbGVjdGlvbjogYm9vbGVhbik6IHtcbiAgICAgICAgdmFsaWQ6IGJvb2xlYW47XG4gICAgICAgIGVycm9yPzogc3RyaW5nO1xuICAgIH0ge1xuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3Rpb24gaXMgcmVxdWlyZWQgYnV0IG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKGNvbW1hbmQudGFyZ2V0ID09PSAnc2VsZWN0aW9uJyAmJiAhaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1RoaXMgY29tbWFuZCByZXF1aXJlcyB0ZXh0IHRvIGJlIHNlbGVjdGVkIGZpcnN0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uLXRhcmdldCBjb21iaW5hdGlvbnNcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uID09PSAnYWRkJyAmJiBjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ2Fubm90IGFkZCBjb250ZW50IHRvIGEgc2VsZWN0aW9uLiBVc2UgXCJlZGl0XCIgdG8gbW9kaWZ5IHNlbGVjdGVkIHRleHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgc3VnZ2VzdGVkIGNvbW1hbmRzIGJhc2VkIG9uIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRTdWdnZXN0aW9ucyhoYXNTZWxlY3Rpb246IGJvb2xlYW4pOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICAnTWFrZSB0aGlzIG1vcmUgY29uY2lzZScsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgdGV4dCcsXG4gICAgICAgICAgICAgICAgJ01ha2UgdGhpcyBtb3JlIHByb2Zlc3Npb25hbCcsXG4gICAgICAgICAgICAgICAgJ0V4cGFuZCBvbiB0aGlzIHBvaW50J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgICAgICAgICAgJ0FkZCBjb250ZW50IGF0IGN1cnNvcicsXG4gICAgICAgICAgICAgICAgJ0ZpeCBncmFtbWFyIGluIHRoaXMgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICdBZGQgY29uY2x1c2lvbiBhdCBlbmQnLFxuICAgICAgICAgICAgICAgICdDcmVhdGUgYSBzdW1tYXJ5J1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBQYXJzZSBtdWx0aXBsZSBjb21tYW5kcyBmcm9tIGEgc2luZ2xlIGlucHV0XG4gICAgICovXG4gICAgcGFyc2VNdWx0aXBsZUNvbW1hbmRzKGlucHV0OiBzdHJpbmcpOiBFZGl0Q29tbWFuZFtdIHtcbiAgICAgICAgLy8gU3BsaXQgb24gY29tbW9uIGNvbW1hbmQgc2VwYXJhdG9yc1xuICAgICAgICBjb25zdCBzZXBhcmF0b3JzID0gL1xcYig/OnRoZW58YWxzb3xhbmQgdGhlbnxhZnRlciB0aGF0fG5leHR8YWRkaXRpb25hbGx5KVxcYi9pO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IGlucHV0LnNwbGl0KHNlcGFyYXRvcnMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnBhcnNlQ29tbWFuZChpbnB1dCldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFydHNcbiAgICAgICAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRyaW0oKSlcbiAgICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0Lmxlbmd0aCA+IDApXG4gICAgICAgICAgICAubWFwKHBhcnQgPT4gdGhpcy5wYXJzZUNvbW1hbmQocGFydCkpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXQgY29tbWFuZCBkZXNjcmlwdGlvbiBmb3IgZGlzcGxheVxuICAgICAqL1xuICAgIGdldENvbW1hbmREZXNjcmlwdGlvbihjb21tYW5kOiBFZGl0Q29tbWFuZCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCB0YXJnZXQgfSA9IGNvbW1hbmQ7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSAnJztcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ0FkZCBuZXcgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdFZGl0IGV4aXN0aW5nIGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdSZW1vdmUgY29udGVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdncmFtbWFyJzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICdGaXggZ3JhbW1hciBhbmQgc3BlbGxpbmcnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncmV3cml0ZSc6XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAnR2VuZXJhdGUgbmV3IGNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJ1VwZGF0ZSBkb2N1bWVudCBtZXRhZGF0YSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAodGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgaW4gc2VsZWN0ZWQgdGV4dCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdjdXJzb3InOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgY3Vyc29yIHBvc2l0aW9uJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiArPSAnIGluIGVudGlyZSBkb2N1bWVudCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uICs9ICcgYXQgZW5kIG9mIGRvY3VtZW50JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0aW9uO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBQcm9tcHQgYnVpbGRlciBzZXJ2aWNlIGZvciBOb3ZhXG4gKiBJbnRlZ3JhdGVzIENvbnRleHRCdWlsZGVyIHdpdGggZG9jdW1lbnQgZW5naW5lIGFuZCBjb252ZXJzYXRpb24gaGlzdG9yeVxuICovXG5cbmltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIsIEdlbmVyYXRlZFByb21wdCB9IGZyb20gJy4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciB9IGZyb20gJy4vY29udmVyc2F0aW9uLW1hbmFnZXInO1xuaW1wb3J0IHsgQ29tbWFuZFBhcnNlciB9IGZyb20gJy4vY29tbWFuZC1wYXJzZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQsIERvY3VtZW50Q29udGV4dCwgUHJvbXB0Q29uZmlnLCBDb252ZXJzYXRpb25NZXNzYWdlIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogUHJvbXB0IGJ1aWxkaW5nIHNlcnZpY2VcbiAqL1xuZXhwb3J0IGNsYXNzIFByb21wdEJ1aWxkZXIge1xuICAgIHByaXZhdGUgY29udGV4dEJ1aWxkZXI6IENvbnRleHRCdWlsZGVyO1xuICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lO1xuICAgIHByaXZhdGUgY29udmVyc2F0aW9uTWFuYWdlcjogQ29udmVyc2F0aW9uTWFuYWdlcjtcbiAgICBwcml2YXRlIGNvbW1hbmRQYXJzZXI6IENvbW1hbmRQYXJzZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBjb252ZXJzYXRpb25NYW5hZ2VyOiBDb252ZXJzYXRpb25NYW5hZ2VyXG4gICAgKSB7XG4gICAgICAgIHRoaXMuY29udGV4dEJ1aWxkZXIgPSBuZXcgQ29udGV4dEJ1aWxkZXIoKTtcbiAgICAgICAgdGhpcy5kb2N1bWVudEVuZ2luZSA9IGRvY3VtZW50RW5naW5lO1xuICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIgPSBjb252ZXJzYXRpb25NYW5hZ2VyO1xuICAgICAgICB0aGlzLmNvbW1hbmRQYXJzZXIgPSBuZXcgQ29tbWFuZFBhcnNlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgYSB1c2VyIG1lc3NhZ2UgLSBkZXRlcm1pbmVzIGlmIGl0J3MgYSBjb21tYW5kIG9yIGNvbnZlcnNhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkUHJvbXB0Rm9yTWVzc2FnZShcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGUsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9XG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBsaWtlbHkgYSBjb21tYW5kIGJhc2VkIG9uIGFjdGlvbiB3b3Jkc1xuICAgICAgICBjb25zdCBpc0xpa2VseUNvbW1hbmQgPSB0aGlzLmlzTGlrZWx5Q29tbWFuZChtZXNzYWdlKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChpc0xpa2VseUNvbW1hbmQgJiYgZmlsZSkge1xuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIGNvbW1hbmRcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZENvbW1hbmQgPSB0aGlzLmNvbW1hbmRQYXJzZXIucGFyc2VDb21tYW5kKG1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRDb21tYW5kUHJvbXB0KHBhcnNlZENvbW1hbmQsIGZpbGUsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSXQncyBhIGNvbnZlcnNhdGlvbiAtIGJ1aWxkIGNvbnZlcnNhdGlvbiBwcm9tcHRcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkQ29udmVyc2F0aW9uUHJvbXB0KG1lc3NhZ2UsIGZpbGUsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgYSBtZXNzYWdlIGlzIGxpa2VseSBhIGNvbW1hbmQgdnMgY29udmVyc2F0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc0xpa2VseUNvbW1hbmQobWVzc2FnZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyAxLiBFeHBsaWNpdCBjb21tYW5kIHN5bnRheCAoY29sb24gY29tbWFuZHMpXG4gICAgICAgIGlmIChsb3dlck1lc3NhZ2Uuc3RhcnRzV2l0aCgnOicpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gMi4gQ2hlY2sgZm9yIGFjdGlvbiB2ZXJicyB0aGF0IGluZGljYXRlIGRvY3VtZW50IG1vZGlmaWNhdGlvbiBjb21tYW5kc1xuICAgICAgICBjb25zdCBhY3Rpb25WZXJicyA9IFtcbiAgICAgICAgICAgICdhZGQnLCAnaW5zZXJ0JywgJ2FwcGVuZCcsICdwcmVwZW5kJywgJ2luY2x1ZGUnLCAnY3JlYXRlJywgJ3dyaXRlJywgJ2dlbmVyYXRlJyxcbiAgICAgICAgICAgICdlZGl0JywgJ21vZGlmeScsICdjaGFuZ2UnLCAndXBkYXRlJywgJ3JldmlzZScsICdpbXByb3ZlJywgJ2VuaGFuY2UnLCAncmVwbGFjZScsXG4gICAgICAgICAgICAnZGVsZXRlJywgJ3JlbW92ZScsICdlbGltaW5hdGUnLCAnY3V0JywgJ2VyYXNlJywgJ2Ryb3AnLFxuICAgICAgICAgICAgJ2ZpeCcsICdjb3JyZWN0JywgJ3Byb29mcmVhZCcsICdwb2xpc2gnLCAnY2hlY2snLFxuICAgICAgICAgICAgJ3Jld3JpdGUnLCAncmV3b3JkJywgJ3JlcGhyYXNlJywgJ3Jlc3RydWN0dXJlJywgJ3Jlb3JnYW5pemUnXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBtZXNzYWdlIHN0YXJ0cyB3aXRoIGFuIGFjdGlvbiB2ZXJiIChpbXBlcmF0aXZlIGNvbW1hbmQgc3RydWN0dXJlKVxuICAgICAgICBjb25zdCBzdGFydHNXaXRoQWN0aW9uID0gYWN0aW9uVmVyYnMuc29tZSh2ZXJiID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZlcmJQYXR0ZXJuID0gbmV3IFJlZ0V4cChgXiR7dmVyYn1cXFxcYmAsICdpJyk7XG4gICAgICAgICAgICByZXR1cm4gdmVyYlBhdHRlcm4udGVzdChsb3dlck1lc3NhZ2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChzdGFydHNXaXRoQWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBBZGRpdGlvbmFsIGZpbHRlcmluZzogZXhjbHVkZSBxdWVzdGlvbnMgYW5kIGRpc2N1c3Npb25zXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbkluZGljYXRvcnMgPSBbXG4gICAgICAgICAgICAgICAgL14oaG93fHdoYXR8d2h5fHdoZW58d2hlcmV8d2hpY2h8d2hvfGNhbnxjb3VsZHxzaG91bGR8d291bGR8d2lsbHxpc3xhcmV8YW18ZG98ZG9lc3xkaWQpL2ksXG4gICAgICAgICAgICAgICAgL1xcPy8sICAvLyBDb250YWlucyBxdWVzdGlvbiBtYXJrXG4gICAgICAgICAgICAgICAgL1xcYihoZWxwfGFkdmljZXxzdWdnZXN0fHJlY29tbWVuZHx0aGlua3xvcGluaW9uKVxcYi9pXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiBpdCdzIGEgcXVlc3Rpb24gb3IgZGlzY3Vzc2lvbiwgcm91dGUgdG8gY29udmVyc2F0aW9uXG4gICAgICAgICAgICBjb25zdCBpc1F1ZXN0aW9uID0gcXVlc3Rpb25JbmRpY2F0b3JzLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKSk7XG4gICAgICAgICAgICBpZiAoaXNRdWVzdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDMuIENoZWNrIGZvciBleHBsaWNpdCBjb21tYW5kIHBhdHRlcm5zIChmb3IgZWRnZSBjYXNlcylcbiAgICAgICAgY29uc3QgZXhwbGljaXRDb21tYW5kUGF0dGVybnMgPSBbXG4gICAgICAgICAgICAvLyBHcmFtbWFyL3NwZWxsaW5nIGNvbW1hbmRzIHRoYXQgZG9uJ3Qgc3RhcnQgd2l0aCBhY3Rpb24gdmVyYnNcbiAgICAgICAgICAgIC9cXGIoZ3JhbW1hcnxzcGVsbHxzcGVsbGluZ3xwcm9vZnJlYWR8cG9saXNoKVxcYi4qXFxiKGNoZWNrfGZpeHxjb3JyZWN0KVxcYi9pLFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBNZXRhZGF0YSBjb21tYW5kcyB3aXRoIGRpZmZlcmVudCBzdHJ1Y3R1cmVzXG4gICAgICAgICAgICAvXFxic2V0XFxzKyh0aGVcXHMrKT8odGl0bGV8dGFnc3xtZXRhZGF0YXxwcm9wZXJ0aWVzKS9pLFxuICAgICAgICAgICAgL1xcYnVwZGF0ZVxccysodGhlXFxzKyk/KHRpdGxlfHRhZ3N8bWV0YWRhdGF8cHJvcGVydGllcykvaSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVGFnLXNwZWNpZmljIHBhdHRlcm5zXG4gICAgICAgICAgICAvXihhZGR8c2V0fHVwZGF0ZXxyZW1vdmUpXFxzK3RhZ3M/Oi9pLFxuICAgICAgICAgICAgL1xcYihjbGVhbiB1cHxjbGVhbnVwfG9wdGltaXplfGltcHJvdmV8cmV2aWV3fGFuYWx5emUpXFxzKy4qXFxidGFncz9cXGIvaSxcbiAgICAgICAgICAgIC9cXGIoc3VnZ2VzdHxyZWNvbW1lbmQpXFxzKy4qXFxidGFncz9cXGIvaSxcbiAgICAgICAgICAgIC9eYWRkIHN1Z2dlc3RlZCB0YWdzJC9pXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBtZXNzYWdlIG1hdGNoZXMgZXhwbGljaXQgY29tbWFuZCBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZXhwbGljaXRDb21tYW5kUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QobG93ZXJNZXNzYWdlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyA0LiBFdmVyeXRoaW5nIGVsc2UgZ29lcyB0byBjb252ZXJzYXRpb24gbW9kZVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgcHJvbXB0IGZvciBhIHNwZWNpZmljIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbW1hbmRQcm9tcHQoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kLFxuICAgICAgICBmaWxlPzogVEZpbGUsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9XG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpbGUgaXMgcmVxdWlyZWQgZm9yIGNvbW1hbmQgcHJvbXB0cycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgY29udmVyc2F0aW9uIGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgIGxldCBjb252ZXJzYXRpb25Db250ZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChvcHRpb25zLmluY2x1ZGVIaXN0b3J5KSB7XG4gICAgICAgICAgICBjb25zdCByZWNlbnRNZXNzYWdlcyA9IGF3YWl0IHRoaXMuY29udmVyc2F0aW9uTWFuYWdlci5nZXRSZWNlbnRNZXNzYWdlcyhmaWxlLCA1KTtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbkNvbnRleHQgPSB0aGlzLmZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkocmVjZW50TWVzc2FnZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQnVpbGQgdGhlIHByb21wdFxuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIG9wdGlvbnMsIGNvbnZlcnNhdGlvbkNvbnRleHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIHByb21wdCBmb3IgY29udmVyc2F0aW9uIChub24tY29tbWFuZCBtZXNzYWdlcylcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZENvbnZlcnNhdGlvblByb21wdChcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBmaWxlPzogVEZpbGUsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8UHJvbXB0Q29uZmlnPiA9IHt9XG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgbGV0IGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0IHwgdW5kZWZpbmVkO1xuICAgICAgICBsZXQgcmVjZW50SGlzdG9yeTogQ29udmVyc2F0aW9uTWVzc2FnZVtdID0gW107XG5cbiAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHQgaWYgZmlsZSBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXREb2N1bWVudENvbnRleHQoZmlsZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCByZWNlbnQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICAgICAgICAgIHJlY2VudEhpc3RvcnkgPSBhd2FpdCB0aGlzLmNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0UmVjZW50TWVzc2FnZXMoZmlsZSwgNSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCdWlsZCBjb252ZXJzYXRpb24tc3R5bGUgcHJvbXB0IChub3QgY29tbWFuZCBmb3JtYXQpXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIE5vdmEsIGFuIEFJIHdyaXRpbmcgcGFydG5lciB0aGF0IGhlbHBzIHVzZXJzIHdpdGggdGhlaXIgZG9jdW1lbnRzIGFuZCB3cml0aW5nIHRhc2tzLlxuXG5LZXkgY2FwYWJpbGl0aWVzOlxuLSBBbnN3ZXIgcXVlc3Rpb25zIGFib3V0IGRvY3VtZW50cyBhbmQgY29udGVudFxuLSBQcm92aWRlIHdyaXRpbmcgYXNzaXN0YW5jZSBhbmQgc3VnZ2VzdGlvbnNcbi0gSGVscCB3aXRoIHJlc2VhcmNoIGFuZCBhbmFseXNpc1xuLSBFbmdhZ2UgaW4gbmF0dXJhbCBjb252ZXJzYXRpb24gYWJvdXQgdGhlIHVzZXIncyB3b3JrXG5cbkd1aWRlbGluZXM6XG4tIFByb3ZpZGUgaGVscGZ1bCwgYWNjdXJhdGUgcmVzcG9uc2VzXG4tIFN0YXkgZm9jdXNlZCBvbiB0aGUgdXNlcidzIG5lZWRzXG4tIEJlIGNvbnZlcnNhdGlvbmFsIGJ1dCBwcm9mZXNzaW9uYWxcbi0gUmVmZXJlbmNlIGRvY3VtZW50IGNvbnRleHQgd2hlbiByZWxldmFudGA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBgVVNFUiBSRVFVRVNUOiAke21lc3NhZ2V9YDtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBkb2N1bWVudCBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0ICYmIGZpbGUpIHtcbiAgICAgICAgICAgIHVzZXJQcm9tcHQgPSBgQ3VycmVudCBkb2N1bWVudDogJHtkb2N1bWVudENvbnRleHQuZmlsZW5hbWV9XG5cbiR7dXNlclByb21wdH1gO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY29udmVyc2F0aW9uIGhpc3RvcnkgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChyZWNlbnRIaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnlTdHJpbmcgPSB0aGlzLmZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkocmVjZW50SGlzdG9yeSk7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYFJFQ0VOVCBDT05WRVJTQVRJT046XG4ke2hpc3RvcnlTdHJpbmd9XG5cbiR7dXNlclByb21wdH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBkb2N1bWVudENvbnRleHQ/LmNvbnRlbnQgfHwgJycsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBvcHRpb25zLm1heFRva2VucyB8fCAyMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgc2ltcGxlIHByb21wdCBmb3IgYmFzaWMgb3BlcmF0aW9uc1xuICAgICAqL1xuICAgIGJ1aWxkU2ltcGxlUHJvbXB0KGluc3RydWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBOb3ZhLCBhbiBBSSB3cml0aW5nIHBhcnRuZXIgdGhhdCBoZWxwcyB1c2VycyB3aXRoIHRoZWlyIGRvY3VtZW50cyBhbmQgd3JpdGluZyB0YXNrcy5cblxuR3VpZGVsaW5lczpcbi0gUHJvdmlkZSBoZWxwZnVsLCBhY2N1cmF0ZSByZXNwb25zZXNcbi0gU3RheSBmb2N1c2VkIG9uIHRoZSB1c2VyJ3MgbmVlZHNcbi0gQmUgY29udmVyc2F0aW9uYWwgYnV0IHByb2Zlc3Npb25hbGA7XG5cbiAgICAgICAgbGV0IHVzZXJQcm9tcHQgPSBgVVNFUiBSRVFVRVNUOiAke2luc3RydWN0aW9ufWA7XG4gICAgICAgIFxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBDb250ZXh0OiAke2NvbnRleHR9XG5cbiR7dXNlclByb21wdH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN5c3RlbVByb21wdCxcbiAgICAgICAgICAgIHVzZXJQcm9tcHQsXG4gICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0IHx8ICcnLFxuICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IDIwMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZG9jdW1lbnQgY29udGV4dCBmb3IgYSBmaWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZXREb2N1bWVudENvbnRleHQoZmlsZTogVEZpbGUpOiBQcm9taXNlPERvY3VtZW50Q29udGV4dD4ge1xuICAgICAgICAvLyBVc2UgdGhlIGRvY3VtZW50IGVuZ2luZSdzIGJ1aWx0LWluIGNvbnRleHQgZ2F0aGVyaW5nXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjazogY3JlYXRlIG1pbmltYWwgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZW50KCkgfHwgJyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUuYmFzZW5hbWUsXG4gICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICBoZWFkaW5nczogW10sXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRUZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgc3Vycm91bmRpbmdMaW5lczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSBjb250ZXh0IGFzLWlzLCBzaW5jZSBpdCdzIGFscmVhZHkgaW4gdGhlIGNvcnJlY3QgZm9ybWF0XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBjb252ZXJzYXRpb24gaGlzdG9yeSBmb3IgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgZm9ybWF0Q29udmVyc2F0aW9uSGlzdG9yeShtZXNzYWdlczogQ29udmVyc2F0aW9uTWVzc2FnZVtdKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnO1xuXG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSAnUkVDRU5UIENPTlZFUlNBVElPTjpcXG4nO1xuICAgICAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAgICAgICBjb25zdCByb2xlID0gbXNnLnJvbGUgPT09ICd1c2VyJyA/ICdZb3UnIDogJ05vdmEnO1xuICAgICAgICAgICAgZm9ybWF0dGVkICs9IGAke3JvbGV9OiAke21zZy5jb250ZW50fVxcbmA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIG9wdGltaXplIHByb21wdCBiZWZvcmUgc2VuZGluZyB0byBBSVxuICAgICAqL1xuICAgIHZhbGlkYXRlQW5kT3B0aW1pemVQcm9tcHQocHJvbXB0OiBHZW5lcmF0ZWRQcm9tcHQpOiBHZW5lcmF0ZWRQcm9tcHQge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAvLyBQcm9tcHQgdmFsaWRhdGlvbiBpc3N1ZXMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdG8gZml4IGNvbW1vbiBpc3N1ZXNcbiAgICAgICAgICAgIGxldCBvcHRpbWl6ZWRQcm9tcHQgPSB7IC4uLnByb21wdCB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnVuY2F0ZSBpZiB0b28gbG9uZ1xuICAgICAgICAgICAgY29uc3QgdG9rZW5Db3VudCA9IHRoaXMuZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdCk7XG4gICAgICAgICAgICBpZiAodG9rZW5Db3VudCA+IDgwMDApIHtcbiAgICAgICAgICAgICAgICAvLyBSZWR1Y2UgY29udGV4dCBzaXplIG1vcmUgYWdncmVzc2l2ZWx5XG4gICAgICAgICAgICAgICAgY29uc3QgbWF4Q29udGV4dExlbmd0aCA9IE1hdGguZmxvb3IocHJvbXB0LmNvbnRleHQubGVuZ3RoICogMC42KTtcbiAgICAgICAgICAgICAgICBvcHRpbWl6ZWRQcm9tcHQuY29udGV4dCA9IHByb21wdC5jb250ZXh0LnN1YnN0cmluZygwLCBtYXhDb250ZXh0TGVuZ3RoKSArICdcXG5bQ29udGV4dCB0cnVuY2F0ZWQuLi5dJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2xhbXAgdGVtcGVyYXR1cmVcbiAgICAgICAgICAgIGlmIChwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlIDwgMCB8fCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlID4gMSkge1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb25maWcudGVtcGVyYXR1cmUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENsYW1wIG1heCB0b2tlbnNcbiAgICAgICAgICAgIGlmIChwcm9tcHQuY29uZmlnLm1heFRva2VucyA8IDEwIHx8IHByb21wdC5jb25maWcubWF4VG9rZW5zID4gNDAwMCkge1xuICAgICAgICAgICAgICAgIG9wdGltaXplZFByb21wdC5jb25maWcubWF4VG9rZW5zID0gTWF0aC5tYXgoMTAsIE1hdGgubWluKDQwMDAsIHByb21wdC5jb25maWcubWF4VG9rZW5zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBvcHRpbWl6ZWRQcm9tcHQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0b2tlbiBjb3VudCBlc3RpbWF0ZSBmb3IgYSBwcm9tcHRcbiAgICAgKi9cbiAgICBnZXRUb2tlbkNvdW50KHByb21wdDogR2VuZXJhdGVkUHJvbXB0KTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXN0aW1hdGVUb2tlbkNvdW50KHByb21wdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHByb21wdCBmb3IgYSBzcGVjaWZpYyBhY3Rpb24gd2l0aCBtaW5pbWFsIGNvbnRleHRcbiAgICAgKi9cbiAgICBhc3luYyBidWlsZFF1aWNrUHJvbXB0KFxuICAgICAgICBhY3Rpb246IEVkaXRDb21tYW5kWydhY3Rpb24nXSxcbiAgICAgICAgaW5zdHJ1Y3Rpb246IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlXG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgY29uc3QgY29tbWFuZDogRWRpdENvbW1hbmQgPSB7XG4gICAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgICB0YXJnZXQ6ICdkb2N1bWVudCcsXG4gICAgICAgICAgICBpbnN0cnVjdGlvbixcbiAgICAgICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZENvbW1hbmRQcm9tcHQoY29tbWFuZCwgZmlsZSwgeyBcbiAgICAgICAgICAgICAgICBtYXhDb250ZXh0TGluZXM6IDEwLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVTdHJ1Y3R1cmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGluY2x1ZGVIaXN0b3J5OiBmYWxzZSBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVpbGRTaW1wbGVQcm9tcHQoaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2ltcGxlIHRva2VuIGNvdW50IGVzdGltYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGVzdGltYXRlVG9rZW5Db3VudChwcm9tcHQ6IEdlbmVyYXRlZFByb21wdCk6IG51bWJlciB7XG4gICAgICAgIC8vIFJvdWdoIGVzdGltYXRpb246IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gICAgICAgIGNvbnN0IHRvdGFsVGV4dCA9IHByb21wdC5zeXN0ZW1Qcm9tcHQgKyBwcm9tcHQudXNlclByb21wdCArIHByb21wdC5jb250ZXh0O1xuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHRvdGFsVGV4dC5sZW5ndGggLyA0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCBwcm9tcHQgd2l0aCBjdXN0b20gc3lzdGVtIHByb21wdCBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIGJ1aWxkQ3VzdG9tUHJvbXB0KFxuICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZyxcbiAgICAgICAgdXNlck1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgZmlsZT86IFRGaWxlXG4gICAgKTogUHJvbWlzZTxHZW5lcmF0ZWRQcm9tcHQ+IHtcbiAgICAgICAgbGV0IGNvbnRleHQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmdldERvY3VtZW50Q29udGV4dChmaWxlKTtcbiAgICAgICAgICAgIGNvbnRleHQgPSBgRG9jdW1lbnQ6ICR7ZG9jdW1lbnRDb250ZXh0LmZpbGVuYW1lfVxcbiR7ZG9jdW1lbnRDb250ZXh0LmNvbnRlbnR9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICB1c2VyUHJvbXB0OiB1c2VyTWVzc2FnZSxcbiAgICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICAgICAgICAgIG1heFRva2VuczogMTAwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBBZGQgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBhZGRpbmcgbmV3IGNvbnRlbnQgdG8gZG9jdW1lbnRzIGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ01hbmFnZXIgfSBmcm9tICcuLi8uLi91aS9zdHJlYW1pbmctbWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RyZWFtaW5nQ2FsbGJhY2sge1xuICAgIChjaHVuazogc3RyaW5nLCBpc0NvbXBsZXRlOiBib29sZWFuKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIEFkZENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYWRkIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIGNvbW1hbmQgcmVxdWlyZW1lbnRzXG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUNvbW1hbmQoY29tbWFuZCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IEFJIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBtZXNzYWdlIGFscmVhZHkgbG9nZ2VkIGJ5IGNoYXQgaW5wdXQgaGFuZGxlclxuXG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0OiBFZGl0UmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbWluZ0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBzdHJlYW1pbmcgbW9kZVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoU3RyZWFtaW5nKGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0LCBzdHJlYW1pbmdDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHRyYWRpdGlvbmFsIHN5bmNocm9ub3VzIG1vZGUgKGZhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0KFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGFkZGl0aW9uIGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5QWRkaXRpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgb25seSBmYWlsdXJlcyBhcyBhc3Npc3RhbnQgbWVzc2FnZXNcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIHdpbGwgYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3Mgc3VjY2VzcyBpbmRpY2F0b3JcbiAgICAgICAgICAgICAgICAvLyBGYWlsdXJlIHdpbGwgYWxzbyBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBlcnJvciBpbmRpY2F0b3JcblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0JyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGFkZGl0aW9uIGJhc2VkIG9uIGNvbW1hbmQgdGFyZ2V0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBhcHBseUFkZGl0aW9uKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdjdXJzb3InLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gQWRkIHRvIGRvY3VtZW50ICh0eXBpY2FsbHkgYXBwZW5kIHRvIGVuZClcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugc2VsZWN0aW9uIHdpdGggbmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBObyBzZWxlY3Rpb24sIGFkZCBhdCBjdXJzb3IgaW5zdGVhZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBhZGQgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBhZGQgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAgICAgICAvLyBWYWxpZGF0ZSBhY3Rpb24gaXMgYWRkXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ2FkZCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBhZGQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgaW5zdHJ1Y3Rpb24gaXMgcHJvdmlkZWRcbiAgICAgICAgaWYgKCFjb21tYW5kLmluc3RydWN0aW9uIHx8IGNvbW1hbmQuaW5zdHJ1Y3Rpb24udHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdBZGQgaW5zdHJ1Y3Rpb24gaXMgcmVxdWlyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGFkZCBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoU3RyZWFtaW5nKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBwcm9tcHQ6IGFueSxcbiAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2s6IFN0cmVhbWluZ0NhbGxiYWNrXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBjb250ZW50IHdpdGggc3RyZWFtaW5nXG4gICAgICAgICAgICBsZXQgZnVsbENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIHRoZSBzdHJlYW1pbmcgZ2VuZXJhdG9yXG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHRTdHJlYW0oXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsQ29udGVudCArPSBjaHVuay5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3J3YXJkIHRvIHRoZSBzdHJlYW1pbmcgY2FsbGJhY2sgd2hpY2ggaGFuZGxlcyBkb2N1bWVudCB1cGRhdGVzXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaWduYWwgY29tcGxldGlvblxuICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoIWZ1bGxDb250ZW50IHx8IGZ1bGxDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHN0cmVhbWluZyBtb2RlLCB0aGUgZG9jdW1lbnQgaGFzIGFscmVhZHkgYmVlbiB1cGRhdGVkIHZpYSBjYWxsYmFja1xuICAgICAgICAgICAgLy8gSnVzdCByZXR1cm4gc3VjY2VzcyB3aXRoIHRoZSBmaW5hbCBjb250ZW50XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogZnVsbENvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uIHx8IHsgbGluZTogMCwgY2g6IDAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3RyZWFtaW5nIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdpbnNlcnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIEVkaXQgY29tbWFuZCBpbXBsZW1lbnRhdGlvbiBmb3IgTm92YVxuICogSGFuZGxlcyBtb2RpZnlpbmcgYW5kIGltcHJvdmluZyBleGlzdGluZyBjb250ZW50IGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ0NhbGxiYWNrIH0gZnJvbSAnLi9hZGQtY29tbWFuZCc7XG5cbmV4cG9ydCBjbGFzcyBFZGl0Q29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBlZGl0IGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIG1lc3NhZ2UgYWxyZWFkeSBsb2dnZWQgYnkgY2hhdCBpbnB1dCBoYW5kbGVyXG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGVkaXQgYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwbHlFZGl0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTG9nIG9ubHkgZmFpbHVyZXMgYXMgYXNzaXN0YW50IG1lc3NhZ2VzXG4gICAgICAgICAgICAgICAgLy8gU3VjY2VzcyB3aWxsIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIHN1Y2Nlc3MgaW5kaWNhdG9yXG4gICAgICAgICAgICAgICAgLy8gRmFpbHVyZSB3aWxsIGFsc28gYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3MgZXJyb3IgaW5kaWNhdG9yXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQUkgZ2VuZXJhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGVkaXQgYmFzZWQgb24gY29tbWFuZCB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGFwcGx5RWRpdChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHN3aXRjaCAoY29tbWFuZC50YXJnZXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciBlZGl0aW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgZW50aXJlIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuc2V0RG9jdW1lbnRDb250ZW50KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCB0byBlbmQgb2YgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0VkaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgZWRpdCB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBlZGl0IGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuXG4gICAgKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGlvbiBpcyByZXF1aXJlZCBidXQgbm90IGF2YWlsYWJsZVxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGVkaXQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIGlzIGVkaXRcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZWRpdCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ29tbWFuZCBhY3Rpb24gbXVzdCBiZSBlZGl0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGluc3RydWN0aW9uIGlzIHByb3ZpZGVkXG4gICAgICAgIGlmICghY29tbWFuZC5pbnN0cnVjdGlvbiB8fCBjb21tYW5kLmluc3RydWN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnRWRpdCBpbnN0cnVjdGlvbiBpcyByZXF1aXJlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgZWRpdCBjb21tYW5kIHdpdGggc3RyZWFtaW5nIHN1cHBvcnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVXaXRoU3RyZWFtaW5nKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBwcm9tcHQ6IGFueSxcbiAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2s6IFN0cmVhbWluZ0NhbGxiYWNrXG4gICAgKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBjb250ZW50IHdpdGggc3RyZWFtaW5nXG4gICAgICAgICAgICBsZXQgZnVsbENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXNlIHRoZSBzdHJlYW1pbmcgZ2VuZXJhdG9yXG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHRTdHJlYW0oXG4gICAgICAgICAgICAgICAgcHJvbXB0LnVzZXJQcm9tcHQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBmdWxsQ29udGVudCArPSBjaHVuay5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3J3YXJkIHRvIHRoZSBzdHJlYW1pbmcgY2FsbGJhY2sgd2hpY2ggaGFuZGxlcyBkb2N1bWVudCB1cGRhdGVzXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaWduYWwgY29tcGxldGlvblxuICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoIWZ1bGxDb250ZW50IHx8IGZ1bGxDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBzdHJlYW1pbmcgbW9kZSwgdGhlIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZCB2aWEgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIEp1c3QgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgZmluYWwgY29udGVudFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxDb250ZW50LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiBkb2N1bWVudENvbnRleHQuY3Vyc29yUG9zaXRpb24gfHwgeyBsaW5lOiAwLCBjaDogMCB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdTdHJlYW1pbmcgZmFpbGVkJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSIsICIvKipcbiAqIERlbGV0ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIHJlbW92aW5nIGNvbnRlbnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRG9jdW1lbnRFbmdpbmUgfSBmcm9tICcuLi9kb2N1bWVudC1lbmdpbmUnO1xuaW1wb3J0IHsgQ29udGV4dEJ1aWxkZXIgfSBmcm9tICcuLi9jb250ZXh0LWJ1aWxkZXInO1xuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi8uLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEVkaXRDb21tYW5kIGFzIEVkaXRDb21tYW5kVHlwZSwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgRGVsZXRlQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBkZWxldGUgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogUHJvbWlzZTxFZGl0UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBHZXQgZG9jdW1lbnQgY29udGV4dFxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnRDb250ZXh0ID0gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5nZXREb2N1bWVudENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmICghZG9jdW1lbnRDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gYWN0aXZlIGRvY3VtZW50IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdkZWxldGUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kLCAhIWRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBcHBseSB0aGUgZGVsZXRpb24gYmFzZWQgb24gdGFyZ2V0XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5RGVsZXRpb24oY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTG9nIG9ubHkgZmFpbHVyZXMgYXMgYXNzaXN0YW50IG1lc3NhZ2VzXG4gICAgICAgICAgICAvLyBTdWNjZXNzIHdpbGwgYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3Mgc3VjY2VzcyBpbmRpY2F0b3JcbiAgICAgICAgICAgIC8vIEZhaWx1cmUgd2lsbCBhbHNvIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIGVycm9yIGluZGljYXRvclxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBkZWxldGlvbiBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlEZWxldGlvbihcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dFxuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQudGFyZ2V0KSB7XG4gICAgICAgICAgICBjYXNlICdzZWxlY3Rpb24nOlxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENvbnRleHQuc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciBkZWxldGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ2RlbGV0ZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2N1cnNvcic6XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGN1cnJlbnQgbGluZSBhdCBjdXJzb3JcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5kZWxldGVDb250ZW50KCdsaW5lJyk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzpcbiAgICAgICAgICAgICAgICAvLyBDbGVhciBlbnRpcmUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoJycpO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0cmFpbGluZyBjb250ZW50IChub3QgdHlwaWNhbGx5IHVzZWQgZm9yIGRlbGV0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIGZyb20gZW5kIC0gdXNlIGN1cnNvciBvciBzZWxlY3Rpb24gaW5zdGVhZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBkZWxldGUgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAnZGVsZXRlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBkZWxldGUgY29tbWFuZFxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb21tYW5kKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIFxuICAgICAgICBoYXNTZWxlY3Rpb246IGJvb2xlYW5cbiAgICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0aW9uIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlXG4gICAgICAgIGlmIChjb21tYW5kLnRhcmdldCA9PT0gJ3NlbGVjdGlvbicgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gZGVsZXRlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBkZWxldGVcbiAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uICE9PSAnZGVsZXRlJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdDb21tYW5kIGFjdGlvbiBtdXN0IGJlIGRlbGV0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH1cbn0iLCAiLyoqXG4gKiBHcmFtbWFyIGNvbW1hbmQgaW1wbGVtZW50YXRpb24gZm9yIE5vdmFcbiAqIEhhbmRsZXMgZml4aW5nIGdyYW1tYXIgYW5kIHNwZWxsaW5nIGF0IGN1cnNvciBwb3NpdGlvblxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCBhcyBFZGl0Q29tbWFuZFR5cGUsIEVkaXRSZXN1bHQsIERvY3VtZW50Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0cmVhbWluZ0NhbGxiYWNrIH0gZnJvbSAnLi9hZGQtY29tbWFuZCc7XG5cbmV4cG9ydCBjbGFzcyBHcmFtbWFyQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgZG9jdW1lbnRFbmdpbmU6IERvY3VtZW50RW5naW5lLFxuICAgICAgICBwcml2YXRlIGNvbnRleHRCdWlsZGVyOiBDb250ZXh0QnVpbGRlcixcbiAgICAgICAgcHJpdmF0ZSBwcm92aWRlck1hbmFnZXI6IEFJUHJvdmlkZXJNYW5hZ2VyXG4gICAgKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmRcbiAgICAgKi9cbiAgICBhc3luYyBleGVjdXRlKGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSwgc3RyZWFtaW5nQ2FsbGJhY2s/OiBTdHJlYW1pbmdDYWxsYmFjayk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IGRvY3VtZW50IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGRvY3VtZW50Q29udGV4dCA9IGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0RG9jdW1lbnRDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoIWRvY3VtZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIGFjdGl2ZSBkb2N1bWVudCBmb3VuZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBjb21tYW5kIHJlcXVpcmVtZW50c1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb21tYW5kKGNvbW1hbmQsICEhZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBBSSBwcm9tcHQgd2l0aCBjb252ZXJzYXRpb24gY29udGV4dFxuICAgICAgICAgICAgY29uc3QgY29udmVyc2F0aW9uQ29udGV4dCA9IHRoaXMuZG9jdW1lbnRFbmdpbmUuZ2V0Q29udmVyc2F0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0Q29uZmlnID0gY29udmVyc2F0aW9uQ29udGV4dCA/IHsgaW5jbHVkZUhpc3Rvcnk6IHRydWUgfSA6IHt9O1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5jb250ZXh0QnVpbGRlci5idWlsZFByb21wdChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdENvbmZpZywgY29udmVyc2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHByb21wdFxuICAgICAgICAgICAgY29uc3QgcHJvbXB0VmFsaWRhdGlvbiA9IHRoaXMuY29udGV4dEJ1aWxkZXIudmFsaWRhdGVQcm9tcHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghcHJvbXB0VmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYFByb21wdCB2YWxpZGF0aW9uIGZhaWxlZDogJHtwcm9tcHRWYWxpZGF0aW9uLmlzc3Vlcy5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgQUkgY29tcGxldGlvblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBVc2VyIG1lc3NhZ2UgYWxyZWFkeSBsb2dnZWQgYnkgY2hhdCBpbnB1dCBoYW5kbGVyXG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGVudDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IEVkaXRSZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtaW5nQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0cmVhbWluZyBtb2RlXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhTdHJlYW1pbmcoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBwcm9tcHQsIHN0cmVhbWluZ0NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdHJhZGl0aW9uYWwgc3luY2hyb25vdXMgbW9kZSAoZmFsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZW5lcmF0ZVRleHQoXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1Qcm9tcHQ6IHByb21wdC5zeXN0ZW1Qcm9tcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBSSBwcm92aWRlciByZXR1cm5lZCBlbXB0eSBjb250ZW50JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnIGFzIGNvbnN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGdyYW1tYXIgZml4IGJhc2VkIG9uIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcGx5R3JhbW1hckZpeChjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIExvZyBvbmx5IGZhaWx1cmVzIGFzIGFzc2lzdGFudCBtZXNzYWdlc1xuICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3Mgd2lsbCBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBzdWNjZXNzIGluZGljYXRvclxuICAgICAgICAgICAgICAgIC8vIEZhaWx1cmUgd2lsbCBhbHNvIGJlIGhhbmRsZWQgYnkgc2lkZWJhcidzIGVycm9yIGluZGljYXRvclxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FJIGdlbmVyYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyBhcyBjb25zdFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBncmFtbWFyIGZpeCBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlHcmFtbWFyRml4KFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uJzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnRDb250ZXh0LnNlbGVjdGVkVGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5hcHBseUVkaXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ05vIHRleHQgc2VsZWN0ZWQgZm9yIGdyYW1tYXIgY29ycmVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdkb2N1bWVudCc6XG4gICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBlbnRpcmUgZG9jdW1lbnQgd2l0aCBjb3JyZWN0ZWQgdmVyc2lvblxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLnNldERvY3VtZW50Q29udGVudChjb250ZW50KTtcblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICAvLyBHcmFtbWFyIGNvcnJlY3Rpb24gYXQgY3Vyc29yIGRvZXNuJ3QgbWFrZSBtdWNoIHNlbnNlLCBcbiAgICAgICAgICAgICAgICAvLyBzdWdnZXN0IHNlbGVjdGluZyB0ZXh0IGluc3RlYWRcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdQbGVhc2Ugc2VsZWN0IHRleHQgdG8gY29ycmVjdCBncmFtbWFyLCBvciB1c2UgXCJkb2N1bWVudFwiIHRvIGZpeCBlbnRpcmUgZG9jdW1lbnQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAvLyBHcmFtbWFyIGNvcnJlY3Rpb24gYXQgZW5kIGRvZXNuJ3QgbWFrZSBzZW5zZVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0dyYW1tYXIgY29ycmVjdGlvbiByZXF1aXJlcyBzZWxlY3RpbmcgdGV4dCBvciBzcGVjaWZ5aW5nIFwiZG9jdW1lbnRcIicsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYEludmFsaWQgZ3JhbW1hciB0YXJnZXQ6ICR7Y29tbWFuZC50YXJnZXR9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBncmFtbWFyIGNvbW1hbmRcbiAgICAgKi9cbiAgICBwcml2YXRlIHZhbGlkYXRlQ29tbWFuZChcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLCBcbiAgICAgICAgaGFzU2VsZWN0aW9uOiBib29sZWFuXG4gICAgKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyBncmFtbWFyXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ2dyYW1tYXInKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgZ3JhbW1hcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3IgZ3JhbW1hciwgd2UgbmVlZCBlaXRoZXIgc2VsZWN0aW9uIG9yIGRvY3VtZW50IHRhcmdldFxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgPT09ICdzZWxlY3Rpb24nICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnUGxlYXNlIHNlbGVjdCB0ZXh0IHRvIGNvcnJlY3QgZ3JhbW1hcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29tbWFuZC50YXJnZXQgIT09ICdzZWxlY3Rpb24nICYmIGNvbW1hbmQudGFyZ2V0ICE9PSAnZG9jdW1lbnQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0dyYW1tYXIgY29ycmVjdGlvbiByZXF1aXJlcyBzZWxlY3RpbmcgdGV4dCBvciB0YXJnZXRpbmcgZW50aXJlIGRvY3VtZW50J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBncmFtbWFyIGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcgc3VwcG9ydFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdpdGhTdHJlYW1pbmcoXG4gICAgICAgIGNvbW1hbmQ6IEVkaXRDb21tYW5kVHlwZSxcbiAgICAgICAgZG9jdW1lbnRDb250ZXh0OiBEb2N1bWVudENvbnRleHQsXG4gICAgICAgIHByb21wdDogYW55LFxuICAgICAgICBzdHJlYW1pbmdDYWxsYmFjazogU3RyZWFtaW5nQ2FsbGJhY2tcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIGNvbnRlbnQgd2l0aCBzdHJlYW1pbmdcbiAgICAgICAgICAgIGxldCBmdWxsQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVc2UgdGhlIHN0cmVhbWluZyBnZW5lcmF0b3JcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dFN0cmVhbShcbiAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHByb21wdC5jb25maWcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heFRva2VuczogcHJvbXB0LmNvbmZpZy5tYXhUb2tlbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGlmIChjaHVuay5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxDb250ZW50ICs9IGNodW5rLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcndhcmQgdG8gdGhlIHN0cmVhbWluZyBjYWxsYmFjayB3aGljaCBoYW5kbGVzIGRvY3VtZW50IHVwZGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtaW5nQ2FsbGJhY2soZnVsbENvbnRlbnQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNpZ25hbCBjb21wbGV0aW9uXG4gICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICghZnVsbENvbnRlbnQgfHwgZnVsbENvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRm9yIHN0cmVhbWluZyBtb2RlLCB0aGUgZG9jdW1lbnQgaGFzIGFscmVhZHkgYmVlbiB1cGRhdGVkIHZpYSBjYWxsYmFja1xuICAgICAgICAgICAgLy8gSnVzdCByZXR1cm4gc3VjY2VzcyB3aXRoIHRoZSBmaW5hbCBjb250ZW50XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogZnVsbENvbnRlbnQsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IGRvY3VtZW50Q29udGV4dC5jdXJzb3JQb3NpdGlvbiB8fCB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1N0cmVhbWluZyBmYWlsZWQnLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8qKlxuICogUmV3cml0ZSBjb21tYW5kIGltcGxlbWVudGF0aW9uIGZvciBOb3ZhXG4gKiBIYW5kbGVzIGdlbmVyYXRpbmcgYWx0ZXJuYXRpdmUgY29udGVudCBhdCBjdXJzb3IgcG9zaXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBEb2N1bWVudEVuZ2luZSB9IGZyb20gJy4uL2RvY3VtZW50LWVuZ2luZSc7XG5pbXBvcnQgeyBDb250ZXh0QnVpbGRlciB9IGZyb20gJy4uL2NvbnRleHQtYnVpbGRlcic7XG5pbXBvcnQgeyBBSVByb3ZpZGVyTWFuYWdlciB9IGZyb20gJy4uLy4uL2FpL3Byb3ZpZGVyLW1hbmFnZXInO1xuaW1wb3J0IHsgRWRpdENvbW1hbmQgYXMgRWRpdENvbW1hbmRUeXBlLCBFZGl0UmVzdWx0LCBEb2N1bWVudENvbnRleHQgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdHJlYW1pbmdDYWxsYmFjayB9IGZyb20gJy4vYWRkLWNvbW1hbmQnO1xuXG5leHBvcnQgY2xhc3MgUmV3cml0ZUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgcmV3cml0ZSBjb21tYW5kXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsIHN0cmVhbWluZ0NhbGxiYWNrPzogU3RyZWFtaW5nQ2FsbGJhY2spOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgY29tbWFuZCByZXF1aXJlbWVudHNcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29tbWFuZChjb21tYW5kKTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRWYWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCFwcm9tcHRWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3Byb21wdFZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgbWVzc2FnZSBhbHJlYWR5IGxvZ2dlZCBieSBjaGF0IGlucHV0IGhhbmRsZXJcblxuICAgICAgICAgICAgICAgIGxldCBjb250ZW50OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogRWRpdFJlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1pbmdDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc3RyZWFtaW5nIG1vZGVcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlV2l0aFN0cmVhbWluZyhjb21tYW5kLCBkb2N1bWVudENvbnRleHQsIHByb21wdCwgc3RyZWFtaW5nQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0cmFkaXRpb25hbCBzeW5jaHJvbm91cyBtb2RlIChmYWxsYmFjaylcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMucHJvdmlkZXJNYW5hZ2VyLmdlbmVyYXRlVGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbVByb21wdDogcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ0FJIHByb3ZpZGVyIHJldHVybmVkIGVtcHR5IGNvbnRlbnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSB0aGUgcmV3cml0ZSBiYXNlZCBvbiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBseVJld3JpdGUoY29tbWFuZCwgZG9jdW1lbnRDb250ZXh0LCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2cgb25seSBmYWlsdXJlcyBhcyBhc3Npc3RhbnQgbWVzc2FnZXNcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIHdpbGwgYmUgaGFuZGxlZCBieSBzaWRlYmFyJ3Mgc3VjY2VzcyBpbmRpY2F0b3JcbiAgICAgICAgICAgICAgICAvLyBGYWlsdXJlIHdpbGwgYWxzbyBiZSBoYW5kbGVkIGJ5IHNpZGViYXIncyBlcnJvciBpbmRpY2F0b3JcblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBSSBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScgYXMgY29uc3RcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgcmV3cml0ZSBiYXNlZCBvbiBjb21tYW5kIHRhcmdldFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgYXBwbHlSZXdyaXRlKFxuICAgICAgICBjb21tYW5kOiBFZGl0Q29tbWFuZFR5cGUsXG4gICAgICAgIGRvY3VtZW50Q29udGV4dDogRG9jdW1lbnRDb250ZXh0LFxuICAgICAgICBjb250ZW50OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgc3dpdGNoIChjb21tYW5kLnRhcmdldCkge1xuICAgICAgICAgICAgY2FzZSAnZG9jdW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgZW50aXJlIGRvY3VtZW50IHdpdGggcmV3cml0dGVuIHZlcnNpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb2N1bWVudEVuZ2luZS5zZXREb2N1bWVudENvbnRlbnQoY29udGVudCk7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgLy8gQWRkIHJld3JpdHRlbiBjb250ZW50IHRvIGVuZCBvZiBkb2N1bWVudFxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmFwcGx5RWRpdChcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2VuZCcsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdE5ld1RleHQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgLy8gUmV3cml0ZSBzZWxlY3RlZCBjb250ZW50XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50Q29udGV4dC5zZWxlY3RlZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvRWRpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3ROZXdUZXh0OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyB0ZXh0IHNlbGVjdGVkIGZvciByZXdyaXRpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnY3Vyc29yJzpcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgcmV3cml0dGVuIGNvbnRlbnQgYXQgY3Vyc29yXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9jdW1lbnRFbmdpbmUuYXBwbHlFZGl0KFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAnY3Vyc29yJyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9FZGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0TmV3VGV4dDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBJbnZhbGlkIHJld3JpdGUgdGFyZ2V0OiAke2NvbW1hbmQudGFyZ2V0fWAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcmV3cml0ZSBjb21tYW5kXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbW1hbmQoY29tbWFuZDogRWRpdENvbW1hbmRUeXBlKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbiBpcyByZXdyaXRlXG4gICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiAhPT0gJ3Jld3JpdGUnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NvbW1hbmQgYWN0aW9uIG11c3QgYmUgcmV3cml0ZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWYWxpZGF0ZSBpbnN0cnVjdGlvbiBpcyBwcm92aWRlZFxuICAgICAgICBpZiAoIWNvbW1hbmQuaW5zdHJ1Y3Rpb24gfHwgY29tbWFuZC5pbnN0cnVjdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ1Jld3JpdGUgaW5zdHJ1Y3Rpb24gaXMgcmVxdWlyZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIHJld3JpdGUgY29tbWFuZCB3aXRoIHN0cmVhbWluZyBzdXBwb3J0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlV2l0aFN0cmVhbWluZyhcbiAgICAgICAgY29tbWFuZDogRWRpdENvbW1hbmRUeXBlLFxuICAgICAgICBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCxcbiAgICAgICAgcHJvbXB0OiBhbnksXG4gICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrOiBTdHJlYW1pbmdDYWxsYmFja1xuICAgICk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgY29udGVudCB3aXRoIHN0cmVhbWluZ1xuICAgICAgICAgICAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVzZSB0aGUgc3RyZWFtaW5nIGdlbmVyYXRvclxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcm92aWRlck1hbmFnZXIuZ2VuZXJhdGVUZXh0U3RyZWFtKFxuICAgICAgICAgICAgICAgIHByb21wdC51c2VyUHJvbXB0LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtUHJvbXB0OiBwcm9tcHQuc3lzdGVtUHJvbXB0LFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogcHJvbXB0LmNvbmZpZy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4VG9rZW5zOiBwcm9tcHQuY29uZmlnLm1heFRva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmsuY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0byB0aGUgc3RyZWFtaW5nIGNhbGxiYWNrIHdoaWNoIGhhbmRsZXMgZG9jdW1lbnQgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdDYWxsYmFjayhmdWxsQ29udGVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2lnbmFsIGNvbXBsZXRpb25cbiAgICAgICAgICAgIHN0cmVhbWluZ0NhbGxiYWNrKGZ1bGxDb250ZW50LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKCFmdWxsQ29udGVudCB8fCBmdWxsQ29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQUkgcHJvdmlkZXIgcmV0dXJuZWQgZW1wdHkgY29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3Igc3RyZWFtaW5nIG1vZGUsIHRoZSBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQgdmlhIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBKdXN0IHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGZpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBmdWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogZG9jdW1lbnRDb250ZXh0LmN1cnNvclBvc2l0aW9uIHx8IHsgbGluZTogMCwgY2g6IDAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3RyZWFtaW5nIGZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLyoqXG4gKiBNZXRhZGF0YSBjb21tYW5kIGhhbmRsZXIgZm9yIE5vdmFcbiAqIEhhbmRsZXMgdXBkYXRpbmcgZG9jdW1lbnQgcHJvcGVydGllcy9mcm9udG1hdHRlclxuICovXG5cbmltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERvY3VtZW50RW5naW5lIH0gZnJvbSAnLi4vZG9jdW1lbnQtZW5naW5lJztcbmltcG9ydCB7IENvbnRleHRCdWlsZGVyIH0gZnJvbSAnLi4vY29udGV4dC1idWlsZGVyJztcbmltcG9ydCB7IEFJUHJvdmlkZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vYWkvcHJvdmlkZXItbWFuYWdlcic7XG5pbXBvcnQgeyBFZGl0Q29tbWFuZCwgRWRpdFJlc3VsdCwgRG9jdW1lbnRDb250ZXh0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEhhbmRsZXMgbWV0YWRhdGEvcHJvcGVydHkgdXBkYXRlIGNvbW1hbmRzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YUNvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIGRvY3VtZW50RW5naW5lOiBEb2N1bWVudEVuZ2luZSxcbiAgICAgICAgcHJpdmF0ZSBjb250ZXh0QnVpbGRlcjogQ29udGV4dEJ1aWxkZXIsXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge31cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBtZXRhZGF0YSB1cGRhdGUgY29tbWFuZFxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoY29tbWFuZDogRWRpdENvbW1hbmQpOiBQcm9taXNlPEVkaXRSZXN1bHQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBkb2N1bWVudCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudENvbnRleHQgPSBhd2FpdCB0aGlzLmRvY3VtZW50RW5naW5lLmdldERvY3VtZW50Q29udGV4dCgpO1xuICAgICAgICAgICAgaWYgKCFkb2N1bWVudENvbnRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdObyBhY3RpdmUgZG9jdW1lbnQgZm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIGRpcmVjdCB0YWcgb3BlcmF0aW9uXG4gICAgICAgICAgICBjb25zdCB0YWdSZXN1bHQgPSBhd2FpdCB0aGlzLmhhbmRsZURpcmVjdFRhZ09wZXJhdGlvbihjb21tYW5kLmluc3RydWN0aW9uLCBkb2N1bWVudENvbnRleHQpO1xuICAgICAgICAgICAgaWYgKHRhZ1Jlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWdSZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIEFJIHByb21wdCB3aXRoIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gdGhpcy5kb2N1bWVudEVuZ2luZS5nZXRDb252ZXJzYXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHRDb25maWcgPSBjb252ZXJzYXRpb25Db250ZXh0ID8geyBpbmNsdWRlSGlzdG9yeTogdHJ1ZSB9IDoge307XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmNvbnRleHRCdWlsZGVyLmJ1aWxkUHJvbXB0KGNvbW1hbmQsIGRvY3VtZW50Q29udGV4dCwgcHJvbXB0Q29uZmlnLCBjb252ZXJzYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmFsaWRhdGUgcHJvbXB0XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5jb250ZXh0QnVpbGRlci52YWxpZGF0ZVByb21wdChwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgUHJvbXB0IHZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uaXNzdWVzLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCBBSSBjb21wbGV0aW9uXG4gICAgICAgICAgICBjb25zdCBhaVJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoXG4gICAgICAgICAgICAgICAgcHJvbXB0LnN5c3RlbVByb21wdCxcbiAgICAgICAgICAgICAgICBwcm9tcHQudXNlclByb21wdCxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBwcm9tcHQuY29uZmlnLnRlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IHByb21wdC5jb25maWcubWF4VG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUGFyc2UgdGhlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHRoaXMucGFyc2VQcm9wZXJ0eVVwZGF0ZXMoYWlSZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoIXVwZGF0ZXMgfHwgT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gTG9nIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgbWV0YWRhdGEgdXBkYXRlcy4gQUkgcmVzcG9uc2U6JywgYWlSZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnTm8gcHJvcGVydHkgdXBkYXRlcyBmb3VuZCBpbiBBSSByZXNwb25zZScsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IHRoaXMudXBkYXRlRnJvbnRtYXR0ZXIoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQsIHVwZGF0ZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBXcml0ZSB0aGUgdXBkYXRlZCBjb250ZW50IGJhY2sgdG8gdGhlIGZpbGUgZGlyZWN0bHlcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShkb2N1bWVudENvbnRleHQuZmlsZSwgdXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBzdWNjZXNzIG1lc3NhZ2UgYmFzZWQgb24gdXBkYXRlc1xuICAgICAgICAgICAgY29uc3Qgc3VjY2Vzc01lc3NhZ2UgPSB0aGlzLmdlbmVyYXRlU3VjY2Vzc01lc3NhZ2UodXBkYXRlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB1cGRhdGVkQ29udGVudCxcbiAgICAgICAgICAgICAgICBhcHBsaWVkQXQ6IHsgbGluZTogMCwgY2g6IDAgfSxcbiAgICAgICAgICAgICAgICBlZGl0VHlwZTogJ3JlcGxhY2UnLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogYEZhaWxlZCB0byB1cGRhdGUgbWV0YWRhdGE6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIEFJIHJlc3BvbnNlIHRvIGV4dHJhY3QgcHJvcGVydHkgdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VQcm9wZXJ0eVVwZGF0ZXMocmVzcG9uc2U6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBhcyBKU09OIGZpcnN0XG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvYGBganNvblxccyooW1xcc1xcU10qPylcXHMqYGBgLyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbk1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGFzIFlBTUwtbGlrZSBmb3JtYXRcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAvLyBNYXRjaCBwYXR0ZXJucyBsaWtlIFwia2V5OiB2YWx1ZVwiIG9yIFwiLSBrZXk6IHZhbHVlXCJcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL15bLVxcc10qKFteOl0rKTpcXHMqKC4rKSQvKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgdmFsdWUgYXMgSlNPTiAoZm9yIGFycmF5cy9vYmplY3RzKVxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBub3QgSlNPTiwgdHJlYXQgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVvdGVzIGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuc3RhcnRzV2l0aCgnXCInKSAmJiB2YWx1ZS5lbmRzV2l0aCgnXCInKSkgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlLnN0YXJ0c1dpdGgoXCInXCIpICYmIHZhbHVlLmVuZHNXaXRoKFwiJ1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModXBkYXRlcykubGVuZ3RoID4gMCA/IHVwZGF0ZXMgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHRvIHBhcnNlIHByb3BlcnR5IHVwZGF0ZXMgLSBncmFjZWZ1bCBmYWxsYmFja1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgY3JlYXRlIGZyb250bWF0dGVyIGluIGRvY3VtZW50IGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZywgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBmcm9udG1hdHRlciBleGlzdHNcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnLS0tJykge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgY2xvc2luZyAtLS1cbiAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IC0xO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChlbmRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBleGlzdGluZyBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUHJvcHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGVuZEluZGV4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gbWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgYXMgSlNPTlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9wc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgdXBkYXRlcyB3aXRoIGV4aXN0aW5nIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRQcm9wcyA9IHsgLi4uZXhpc3RpbmdQcm9wcywgLi4udXBkYXRlcyB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlYnVpbGQgZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGcm9udG1hdHRlciA9IFsnLS0tJ107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMobWVyZ2VkUHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIG51bGwvdW5kZWZpbmVkIHZhbHVlcyAoYWxsb3dzIGRlbGV0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0Zyb250bWF0dGVyLnB1c2goJy0tLScpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugb2xkIGZyb250bWF0dGVyIHdpdGggbmV3XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgLi4ubmV3RnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgIC4uLmxpbmVzLnNsaWNlKGVuZEluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICBdLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBObyBmcm9udG1hdHRlciBleGlzdHMsIGNyZWF0ZSBuZXdcbiAgICAgICAgY29uc3QgbmV3RnJvbnRtYXR0ZXIgPSBbJy0tLSddO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVzKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIFxuICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpXG4gICAgICAgICAgICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdGcm9udG1hdHRlci5wdXNoKGAke2tleX06ICR7Zm9ybWF0dGVkVmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3RnJvbnRtYXR0ZXIucHVzaCgnLS0tJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGZyb250bWF0dGVyIHRvIGJlZ2lubmluZyBvZiBkb2N1bWVudFxuICAgICAgICByZXR1cm4gbmV3RnJvbnRtYXR0ZXIuam9pbignXFxuJykgKyBjb250ZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBkaXJlY3QgdGFnIG9wZXJhdGlvbnMgKGFkZCwgcmVtb3ZlLCBzZXQgdGFncylcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZURpcmVjdFRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbjogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IFByb21pc2U8RWRpdFJlc3VsdCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgbG93ZXJJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUGFyc2UgdGFnIGNvbW1hbmRzIHdpdGggY29sb24gZm9ybWF0XG4gICAgICAgIGNvbnN0IGNvbG9uTWF0Y2ggPSBsb3dlckluc3RydWN0aW9uLm1hdGNoKC9eKGFkZHxzZXR8dXBkYXRlfHJlbW92ZSlcXHMrdGFncz86XFxzKiguKikkLyk7XG4gICAgICAgIGlmIChjb2xvbk1hdGNoKSB7XG4gICAgICAgICAgICBjb25zdCBhY3Rpb24gPSBjb2xvbk1hdGNoWzFdO1xuICAgICAgICAgICAgY29uc3QgdGFnU3RyaW5nID0gY29sb25NYXRjaFsyXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1RhZ3MgPSB0YWdTdHJpbmcgPyB0YWdTdHJpbmcuc3BsaXQoJywnKS5tYXAodCA9PiB0LnRyaW0oKSkuZmlsdGVyKHQgPT4gdCkgOiBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgXCJhZGQgdGFnc1wiIHdpdGggbm8gc3BlY2lmaWMgdGFncywgdHJlYXQgYXMgQUktcG93ZXJlZCBzdWdnZXN0aW9uXG4gICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnYWRkJyAmJiBuZXdUYWdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmhhbmRsZUFJVGFnT3BlcmF0aW9uKCdhZGQgc3VnZ2VzdGVkIHRhZ3MnLCBkb2N1bWVudENvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgY3VycmVudCB0YWdzXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50VGFncyA9IHRoaXMuZ2V0Q3VycmVudFRhZ3MoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgdXBkYXRlZFRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgdGFncyB3aXRob3V0IGR1cGxpY2F0ZXNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnc1RvQWRkID0gbmV3VGFncy5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgIWN1cnJlbnRUYWdzLnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcudG9Mb3dlckNhc2UoKSA9PT0gdGFnLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gWy4uLmN1cnJlbnRUYWdzLCAuLi50YWdzVG9BZGRdO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gdGFnc1RvQWRkLmxlbmd0aCA+IDAgXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGBBZGRlZCAke3RhZ3NUb0FkZC5sZW5ndGh9IHRhZyR7dGFnc1RvQWRkLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfTogJHt0YWdzVG9BZGQuam9pbignLCAnKX1gXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICdObyBuZXcgdGFncyB0byBhZGQgKGR1cGxpY2F0ZXMgZmlsdGVyZWQpJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZSc6XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBzcGVjaWZpZWQgdGFnc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb3dlck5ld1RhZ3MgPSBuZXdUYWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZUNvdW50ID0gY3VycmVudFRhZ3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVGFncyA9IGN1cnJlbnRUYWdzLmZpbHRlcih0YWcgPT4gXG4gICAgICAgICAgICAgICAgICAgICAgICAhbG93ZXJOZXdUYWdzLmluY2x1ZGVzKHRhZy50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVkQ291bnQgPSBiZWZvcmVDb3VudCAtIHVwZGF0ZWRUYWdzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IHJlbW92ZWRDb3VudCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYFJlbW92ZWQgJHtyZW1vdmVkQ291bnR9IHRhZyR7cmVtb3ZlZENvdW50ICE9PSAxID8gJ3MnIDogJyd9YFxuICAgICAgICAgICAgICAgICAgICAgICAgOiAnTm8gdGFncyBmb3VuZCB0byByZW1vdmUnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FzZSAnc2V0JzpcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgICAgICAgICAgICAvLyBSZXBsYWNlIGFsbCB0YWdzXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYWdzID0gWy4uLm5ldyBTZXQobmV3VGFncy5tYXAodCA9PiB0LnRvTG93ZXJDYXNlKCkpKV07XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgU2V0ICR7dXBkYXRlZFRhZ3MubGVuZ3RofSB0YWcke3VwZGF0ZWRUYWdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfWA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgY29udGVudFxuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHsgdGFnczogdXBkYXRlZFRhZ3MgfTtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIGFwcGxpZWRBdDogeyBsaW5lOiAwLCBjaDogMCB9LFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZScsXG4gICAgICAgICAgICAgICAgc3VjY2Vzc01lc3NhZ2U6IG1lc3NhZ2VcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBBSS1wb3dlcmVkIHRhZyBvcGVyYXRpb25zXG4gICAgICAgIGlmICgvXFxiKGNsZWFuIHVwfGNsZWFudXB8b3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZSlcXHMrLipcXGJ0YWdzP1xcYi9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHxcbiAgICAgICAgICAgIC9cXGIoc3VnZ2VzdHxyZWNvbW1lbmQpXFxzKy4qXFxidGFncz9cXGIvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pIHx8XG4gICAgICAgICAgICAvXmFkZCBzdWdnZXN0ZWQgdGFncyQvaS50ZXN0KGxvd2VySW5zdHJ1Y3Rpb24pIHx8XG4gICAgICAgICAgICAvXmFkZCB0YWdzJC9pLnRlc3QobG93ZXJJbnN0cnVjdGlvbikgfHwgIC8vIEhhbmRsZSBzaW1wbGUgXCJhZGQgdGFnc1wiIGFzIEFJIHN1Z2dlc3Rpb25cbiAgICAgICAgICAgIC9edXBkYXRlIHRhZ3MkL2kudGVzdChsb3dlckluc3RydWN0aW9uKSkgeyAgLy8gSGFuZGxlIFwidXBkYXRlIHRhZ3NcIiBhcyBBSSBvcGVyYXRpb25cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlQUlUYWdPcGVyYXRpb24oaW5zdHJ1Y3Rpb24sIGRvY3VtZW50Q29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBBSS1wb3dlcmVkIHRhZyBvcGVyYXRpb25zIChzdWdnZXN0LCBvcHRpbWl6ZSwgY2xlYW4gdXApXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVBSVRhZ09wZXJhdGlvbihpbnN0cnVjdGlvbjogc3RyaW5nLCBkb2N1bWVudENvbnRleHQ6IERvY3VtZW50Q29udGV4dCk6IFByb21pc2U8RWRpdFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBjdXJyZW50VGFncyA9IHRoaXMuZ2V0Q3VycmVudFRhZ3MoZG9jdW1lbnRDb250ZXh0LmNvbnRlbnQpO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgQUkgcHJvbXB0IGZvciB0YWcgb3BlcmF0aW9uXG4gICAgICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBhdCBkb2N1bWVudCB0YWdnaW5nIGFuZCBtZXRhZGF0YSBvcmdhbml6YXRpb24uIFlvdXIgdGFzayBpcyB0byBhbmFseXplIGRvY3VtZW50cyBhbmQgcHJvdmlkZSBvcHRpbWFsIHRhZ3MuXG5cblJ1bGVzIGZvciB0YWdzOlxuLSBUYWdzIHNob3VsZCBiZSBsb3dlcmNhc2Vcbi0gVXNlIGh5cGhlbnMgZm9yIG11bHRpLXdvcmQgdGFncyAoZS5nLiwgXCJtYWNoaW5lLWxlYXJuaW5nXCIpXG4tIEJlIHNwZWNpZmljIGJ1dCBub3Qgb3Zlcmx5IGdyYW51bGFyXG4tIEFpbSBmb3IgNS0xMCB0YWdzIHBlciBkb2N1bWVudFxuLSBGb2N1cyBvbiBrZXkgY29uY2VwdHMsIHRvcGljcywgYW5kIHRoZW1lcyBGUk9NIFRIRSBBQ1RVQUwgRE9DVU1FTlQgQ09OVEVOVFxuLSBUYWdzIG11c3QgYmUgZGlyZWN0bHkgcmVsZXZhbnQgdG8gdGhlIGRvY3VtZW50J3Mgc3ViamVjdCBtYXR0ZXJcbi0gQXZvaWQgZ2VuZXJpYyB0YWdzIGxpa2UgXCJkb2N1bWVudFwiIG9yIFwidGV4dFwiXG4tIENvbnNpZGVyIHRoZSBkb2N1bWVudCdzIHB1cnBvc2UsIGF1ZGllbmNlLCBhbmQgbWFpbiB0b3BpY3Ncbi0gRXh0cmFjdCB0YWdzIGJhc2VkIG9uIHRoZSBkb2N1bWVudCdzIGFjdHVhbCBjb250ZW50LCBub3QgcmFuZG9tIHRvcGljc1xuXG5JTVBPUlRBTlQ6IEJhc2UgeW91ciB0YWcgc3VnZ2VzdGlvbnMgT05MWSBvbiB0aGUgY29udGVudCBwcm92aWRlZC4gRG8gbm90IGludmVudCB1bnJlbGF0ZWQgdGFncy5cblxuUmV0dXJuIE9OTFkgYSBKU09OIG9iamVjdCB3aXRoIGEgXCJ0YWdzXCIgYXJyYXkgYW5kIGEgXCJyZWFzb25pbmdcIiBmaWVsZCBleHBsYWluaW5nIHlvdXIgY2hvaWNlcy5gO1xuXG4gICAgICAgIGxldCB1c2VyUHJvbXB0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBpZiAoL2FkZCBzdWdnZXN0ZWQvaS50ZXN0KGluc3RydWN0aW9uKSB8fCAvXmFkZCB0YWdzJC9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENhcmVmdWxseSBhbmFseXplIHRoZSBmb2xsb3dpbmcgZG9jdW1lbnQgYW5kIHN1Z2dlc3QgcmVsZXZhbnQgdGFncyBiYXNlZCBvbiBpdHMgYWN0dWFsIGNvbnRlbnQuXG5cbkN1cnJlbnQgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGggPiAwID8gY3VycmVudFRhZ3Muam9pbignLCAnKSA6ICdub25lJ31cblxuRE9DVU1FTlQgVE8gQU5BTFlaRTpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cbkJhc2VkIG9uIHRoZSBhYm92ZSBkb2N1bWVudCBjb250ZW50LCBzdWdnZXN0IGFkZGl0aW9uYWwgdGFncyB0aGF0OlxuMS4gUmVmbGVjdCB0aGUgYWN0dWFsIHRvcGljcyBkaXNjdXNzZWQgaW4gdGhlIGRvY3VtZW50XG4yLiBDYXB0dXJlIGtleSBjb25jZXB0cywgdGVjaG5vbG9naWVzLCBvciB0aGVtZXMgbWVudGlvbmVkXG4zLiBXb3VsZCBoZWxwIHdpdGggZGlzY292ZXJhYmlsaXR5IGFuZCBvcmdhbml6YXRpb25cbjQuIEFyZSBkaXJlY3RseSByZWxldmFudCB0byB3aGF0IHRoaXMgZG9jdW1lbnQgaXMgYWJvdXRcblxuRE8gTk9UIHN1Z2dlc3QgdGFncyBhYm91dCB0b3BpY3Mgbm90IG1lbnRpb25lZCBpbiB0aGUgZG9jdW1lbnQuYDtcbiAgICAgICAgfSBlbHNlIGlmICgvY2xlYW4gdXB8Y2xlYW51cC9pLnRlc3QoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICAgICAgICB1c2VyUHJvbXB0ID0gYENsZWFuIHVwIGFuZCBvcHRpbWl6ZSB0aGUgdGFncyBmb3IgdGhpcyBkb2N1bWVudCBieSBhbmFseXppbmcgYm90aCB0aGUgY3VycmVudCB0YWdzIGFuZCB0aGUgZG9jdW1lbnQgY29udGVudC5cblxuQ3VycmVudCB0YWdzOiAke2N1cnJlbnRUYWdzLmpvaW4oJywgJyl9XG5cbkRPQ1VNRU5UIENPTlRFTlQ6XG49PT1TVEFSVCBPRiBET0NVTUVOVD09PVxuJHtkb2N1bWVudENvbnRleHQuY29udGVudH1cbj09PUVORCBPRiBET0NVTUVOVD09PVxuXG5UYXNrczpcbjEuIFJlbW92ZSBkdXBsaWNhdGUgb3IgcmVkdW5kYW50IHRhZ3NcbjIuIENvbnNvbGlkYXRlIHNpbWlsYXIgdGFncyAoZS5nLiwgXCJqc1wiIGFuZCBcImphdmFzY3JpcHRcIilcbjMuIFJlbW92ZSB0YWdzIHRoYXQgYXJlbid0IHJlbGV2YW50IHRvIHRoZSBkb2N1bWVudCBjb250ZW50XG40LiBTdGFuZGFyZGl6ZSB0YWcgZm9ybWF0IChsb3dlcmNhc2UsIGh5cGhlbmF0ZWQpXG41LiBFbnN1cmUgcmVtYWluaW5nIHRhZ3MgYWNjdXJhdGVseSByZWZsZWN0IHRoZSBkb2N1bWVudFxuXG5Qcm92aWRlIGEgY2xlYW5lZC11cCB0YWcgbGlzdCBiYXNlZCBvbiB0aGUgYWN0dWFsIGRvY3VtZW50IGNvbnRlbnQuYDtcbiAgICAgICAgfSBlbHNlIGlmICgvb3B0aW1pemV8aW1wcm92ZXxyZXZpZXd8YW5hbHl6ZXx1cGRhdGUvaS50ZXN0KGluc3RydWN0aW9uKSkge1xuICAgICAgICAgICAgdXNlclByb21wdCA9IGBBbmFseXplIHRoaXMgZG9jdW1lbnQgdGhvcm91Z2hseSBhbmQgcHJvdmlkZSBhbiBvcHRpbWl6ZWQgc2V0IG9mIHRhZ3MgdGhhdCBhY2N1cmF0ZWx5IHJlcHJlc2VudHMgaXRzIGNvbnRlbnQuXG5cbkN1cnJlbnQgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGggPiAwID8gY3VycmVudFRhZ3Muam9pbignLCAnKSA6ICdub25lJ31cblxuRE9DVU1FTlQgVE8gQU5BTFlaRTpcbj09PVNUQVJUIE9GIERPQ1VNRU5UPT09XG4ke2RvY3VtZW50Q29udGV4dC5jb250ZW50fVxuPT09RU5EIE9GIERPQ1VNRU5UPT09XG5cblRhc2tzOlxuMS4gUmV2aWV3IHRoZSBkb2N1bWVudCBjb250ZW50IGNhcmVmdWxseVxuMi4gUmVtb3ZlIGFueSB0YWdzIHRoYXQgYXJlbid0IHJlbGV2YW50IHRvIHRoZSBhY3R1YWwgY29udGVudFxuMy4gQWRkIHRhZ3MgZm9yIGltcG9ydGFudCBjb25jZXB0cywgdG9waWNzLCBvciB0aGVtZXMgdGhhdCBhcmUgbWlzc2luZ1xuNC4gRW5zdXJlIGFsbCB0YWdzIGRpcmVjdGx5IHJlbGF0ZSB0byB3aGF0J3MgZGlzY3Vzc2VkIGluIHRoZSBkb2N1bWVudFxuNS4gQWltIGZvciA1LTEwIGhpZ2hseSByZWxldmFudCB0YWdzXG5cblByb3ZpZGUgYW4gb3B0aW1pemVkIHRhZyBsaXN0IHRoYXQgYmVzdCByZXByZXNlbnRzIFRISVMgU1BFQ0lGSUMgZG9jdW1lbnQncyBjb250ZW50LmA7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVXNlIHVuaWZpZWQgYXBwcm9hY2ggZm9yIGFsbCBwcm92aWRlcnNcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRNYXhUb2tlbnMgPSB0aGlzLnByb3ZpZGVyTWFuYWdlci5nZXREZWZhdWx0TWF4VG9rZW5zKCk7XG4gICAgICAgICAgICBjb25zdCBhaVJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoc3lzdGVtUHJvbXB0LCB1c2VyUHJvbXB0LCB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgICAgICAgICAgICAgICBtYXhUb2tlbnM6IGRlZmF1bHRNYXhUb2tlbnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQYXJzZSBBSSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZUFJVGFnUmVzcG9uc2UoYWlSZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoIXBhcnNlZCB8fCAhcGFyc2VkLnRhZ3MgfHwgcGFyc2VkLnRhZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gU2hvdyB0aGUgYWN0dWFsIEFJIHJlc3BvbnNlIGluIHRoZSBlcnJvciBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlldyA9IGFpUmVzcG9uc2UubGVuZ3RoID4gMTAwIFxuICAgICAgICAgICAgICAgICAgICA/IGFpUmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJyBcbiAgICAgICAgICAgICAgICAgICAgOiBhaVJlc3BvbnNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYENvdWxkIG5vdCBwYXJzZSBBSSB0YWcgc3VnZ2VzdGlvbnMuIEFJIHJlc3BvbnNlOiBcIiR7cHJldmlld31cImAsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGFnc1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IHsgdGFnczogcGFyc2VkLnRhZ3MgfTtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVGcm9udG1hdHRlcihkb2N1bWVudENvbnRleHQuY29udGVudCwgdXBkYXRlcyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZG9jdW1lbnRDb250ZXh0LmZpbGUsIHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgYXBwcm9wcmlhdGUgbWVzc2FnZVxuICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSAnJztcbiAgICAgICAgICAgIGlmICgvYWRkIHN1Z2dlc3RlZC9pLnRlc3QoaW5zdHJ1Y3Rpb24pIHx8IC9eYWRkIHRhZ3MkL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhZGRlZFRhZ3MgPSBwYXJzZWQudGFncy5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgICAgICAgICAhY3VycmVudFRhZ3Muc29tZShleGlzdGluZyA9PiBleGlzdGluZy50b0xvd2VyQ2FzZSgpID09PSB0YWcudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgQWRkZWQgJHthZGRlZFRhZ3MubGVuZ3RofSBzdWdnZXN0ZWQgdGFnJHthZGRlZFRhZ3MubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9OiAke2FkZGVkVGFncy5qb2luKCcsICcpfWA7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKC9jbGVhbiB1cHxjbGVhbnVwL2kudGVzdChpbnN0cnVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYENsZWFuZWQgdXAgdGFnczogJHtjdXJyZW50VGFncy5sZW5ndGh9IFx1MjE5MiAke3BhcnNlZC50YWdzLmxlbmd0aH0gdGFnc2A7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgT3B0aW1pemVkIHRhZ3M6ICR7cGFyc2VkLnRhZ3MubGVuZ3RofSB0YWcke3BhcnNlZC50YWdzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSAod2FzICR7Y3VycmVudFRhZ3MubGVuZ3RofSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgY29udGVudDogdXBkYXRlZENvbnRlbnQsXG4gICAgICAgICAgICAgICAgYXBwbGllZEF0OiB7IGxpbmU6IDAsIGNoOiAwIH0sXG4gICAgICAgICAgICAgICAgZWRpdFR5cGU6ICdyZXBsYWNlJyxcbiAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZTogbWVzc2FnZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGBGYWlsZWQgdG8gcHJvY2VzcyB0YWcgb3BlcmF0aW9uOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgIGVkaXRUeXBlOiAncmVwbGFjZSdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCB0YWdzIGZyb20gZG9jdW1lbnQgY29udGVudFxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Q3VycmVudFRhZ3MoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBpZiAoIWNvbnRlbnQpIHJldHVybiBbXTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobGluZXMubGVuZ3RoID4gMCAmJiBsaW5lc1swXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgIGxldCBpbkZyb250bWF0dGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoICYmIGluRnJvbnRtYXR0ZXI7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lc1tpXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ01hdGNoID0gbGluZXNbaV0ubWF0Y2goL150YWdzOlxccyooLiopJC8pO1xuICAgICAgICAgICAgICAgIGlmICh0YWdNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdWYWx1ZSA9IHRhZ01hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFnVmFsdWUpIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSBwYXJzaW5nIGFzIEpTT04gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UodGFnVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyc2VkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZWQuZmlsdGVyKHQgPT4gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IEpTT04sIHRyeSBjb21tYS1zZXBhcmF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWdWYWx1ZS5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKS5maWx0ZXIodCA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTm8gZnJvbnRtYXR0ZXIgb3Igbm8gdGFncyBmb3VuZFxuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgQUkgcmVzcG9uc2UgZm9yIHRhZyBvcGVyYXRpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBwYXJzZUFJVGFnUmVzcG9uc2UocmVzcG9uc2U6IHN0cmluZyk6IHsgdGFnczogc3RyaW5nW10sIHJlYXNvbmluZz86IHN0cmluZyB9IHwgbnVsbCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDbGVhbiB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuUmVzcG9uc2UgPSByZXNwb25zZS50cmltKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gZnJvbSByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QganNvbk1hdGNoID0gY2xlYW5SZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgICAgICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VkLnRhZ3MgJiYgQXJyYXkuaXNBcnJheShwYXJzZWQudGFncykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogcGFyc2VkLnRhZ3MubWFwKCh0OiBhbnkpID0+IFN0cmluZyh0KS50b0xvd2VyQ2FzZSgpLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICctJykpLmZpbHRlcigodDogc3RyaW5nKSA9PiB0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25pbmc6IHBhcnNlZC5yZWFzb25pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEpTT04gcGFyc2UgZmFpbGVkLCBjb250aW51ZSB0byBvdGhlciBmb3JtYXRzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUcnkgdmFyaW91cyBsaXN0IGZvcm1hdHNcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm5zID0gW1xuICAgICAgICAgICAgICAgIC8vIEpTT04gYXJyYXk6IHRhZ3M6IFtcInRhZzFcIiwgXCJ0YWcyXCJdXG4gICAgICAgICAgICAgICAgL3RhZ3M/OlxccypcXFsoW15cXF1dKylcXF0vaSxcbiAgICAgICAgICAgICAgICAvLyBDb21tYSBsaXN0OiBUYWdzOiB0YWcxLCB0YWcyLCB0YWczXG4gICAgICAgICAgICAgICAgL3RhZ3M/OlxccyooW15cXG5dKz8pKD86XFxufCQpL2ksXG4gICAgICAgICAgICAgICAgLy8gQnVsbGV0IGxpc3Q6IC0gdGFnMVxcbi0gdGFnMlxuICAgICAgICAgICAgICAgIC8oPzp0YWdzPzopP1xccyooPzpcXG4pPyhcXHMqWy1cdTIwMjIqXVxccyouKyg/OlxcblxccypbLVx1MjAyMipdXFxzKi4rKSopL2ksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGNsZWFuUmVzcG9uc2UubWF0Y2gocGF0dGVybik7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0YWdTdHJpbmcgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgYnVsbGV0IGxpc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWdTdHJpbmcuaW5jbHVkZXMoJy0nKSB8fCB0YWdTdHJpbmcuaW5jbHVkZXMoJ1x1MjAyMicpIHx8IHRhZ1N0cmluZy5pbmNsdWRlcygnKicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzID0gdGFnU3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9cXG4vKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKGxpbmU6IHN0cmluZykgPT4gbGluZS5yZXBsYWNlKC9eXFxzKlstXHUyMDIyKl1cXHMqLywgJycpLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh0OiBzdHJpbmcpID0+IHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGNvbW1hLXNlcGFyYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFncyA9IHRhZ1N0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgodDogc3RyaW5nKSA9PiB0LnRyaW0oKS5yZXBsYWNlKC9bXCInXS9nLCAnJykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigodDogc3RyaW5nKSA9PiB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogdGFncy5tYXAodCA9PiB0LnRvTG93ZXJDYXNlKCkudHJpbSgpLnJlcGxhY2UoL1xccysvZywgJy0nKSkuZmlsdGVyKHQgPT4gdClcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIExhc3QgcmVzb3J0OiBleHRyYWN0IGFueSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBhZnRlciBcInN1Z2dlc3RcIiBvciBcInJlY29tbWVuZFwiXG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0TWF0Y2ggPSBjbGVhblJlc3BvbnNlLm1hdGNoKC8oPzpzdWdnZXN0fHJlY29tbWVuZHxwcm9wb3NlfGhlcmUgYXJlfHRhZ3MgYXJlKVs6XFxzXSsoW14uXSspL2kpO1xuICAgICAgICAgICAgaWYgKHN1Z2dlc3RNYXRjaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3MgPSBzdWdnZXN0TWF0Y2hbMV1cbiAgICAgICAgICAgICAgICAgICAgLnNwbGl0KC9bLFxcbl0vKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHQgPT4gdC50cmltKCkucmVwbGFjZSgvW1wiJ10vZywgJycpLnJlcGxhY2UoL15hbmRcXHMrL2ksICcnKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0ID0+IHQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiB0YWdzLm1hcCh0ID0+IHQudG9Mb3dlckNhc2UoKS50cmltKCkpLmZpbHRlcih0ID0+IHQpXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGaW5hbCBmYWxsYmFjazogdHJlYXQgZWFjaCBsaW5lIGFzIGEgdGFnIChmb3IgR29vZ2xlJ3Mgc2ltcGxlIGZvcm1hdClcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY2xlYW5SZXNwb25zZS5zcGxpdCgnXFxuJykubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihsaW5lID0+IGxpbmUpO1xuICAgICAgICAgICAgY29uc3QgdmFsaWRUYWdzID0gbGluZXNcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGxpbmVzIHRoYXQgYXJlIGNsZWFybHkgbm90IHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUubGVuZ3RoID4gMCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUubGVuZ3RoIDwgNTAgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS5pbmNsdWRlcygnOicpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0YWcnKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIWxpbmUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnaGVyZScpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzdWdnZXN0Jyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cCB0aGUgbGluZSBhbmQgY29udmVydCBzcGFjZXMgdG8gaHlwaGVuc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXlstXHUyMDIyKiNdXFxzKi8sICcnKSAvLyBSZW1vdmUgYnVsbGV0IHBvaW50cyBhbmQgaGFzaHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9eXFxkK1xcLlxccyovLCAnJykgLy8gUmVtb3ZlIG51bWJlcmVkIGxpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnLScpOyAvLyBDb252ZXJ0IHNwYWNlcyB0byBoeXBoZW5zXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHRhZyA9PiB0YWcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodmFsaWRUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB0YWdzOiB2YWxpZFRhZ3MgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgd2Ugc3RpbGwgY2FuJ3QgcGFyc2UsIGxvZyB0aGUgcmVzcG9uc2UgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIEFJIHRhZyByZXNwb25zZTonLCBjbGVhblJlc3BvbnNlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBBSSB0YWcgcmVzcG9uc2U6JywgZXJyb3IsICdSZXNwb25zZSB3YXM6JywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBzdWNjZXNzIG1lc3NhZ2UgYmFzZWQgb24gdXBkYXRlc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2VuZXJhdGVTdWNjZXNzTWVzc2FnZSh1cGRhdGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpO1xuICAgICAgICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHJldHVybiAnTWV0YWRhdGEgdXBkYXRlZCc7XG4gICAgICAgIFxuICAgICAgICBpZiAoa2V5cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGtleXNbMF07XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAndGFncycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb3VudCA9IEFycmF5LmlzQXJyYXkodXBkYXRlcy50YWdzKSA/IHVwZGF0ZXMudGFncy5sZW5ndGggOiAwO1xuICAgICAgICAgICAgICAgIHJldHVybiBgVXBkYXRlZCB0YWdzICgke2NvdW50fSB0YWcke2NvdW50ICE9PSAxID8gJ3MnIDogJyd9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYFVwZGF0ZWQgJHtrZXl9YDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGBVcGRhdGVkICR7a2V5cy5sZW5ndGh9IHByb3BlcnRpZXNgO1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUaW1lR2F0ZWRGZWF0dXJlIHtcbiAgICBzdXBlcm5vdmFEYXRlOiBzdHJpbmc7ICAvLyBZWVlZLU1NLUREIGZvcm1hdFxuICAgIGdlbmVyYWxEYXRlOiBzdHJpbmc7ICAgLy8gWVlZWS1NTS1ERCBmb3JtYXRcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIEZlYXR1cmUgcmVsZWFzZSBjb25maWd1cmF0aW9uIGZvciBTdXBlcm5vdmEgZWFybHkgYWNjZXNzIG1vZGVsXG4gKiBTdXBlcm5vdmEgc3VwcG9ydGVycyBnZXQgZmVhdHVyZXMgb24gc3VwZXJub3ZhRGF0ZVxuICogQWxsIHVzZXJzIGdldCBmZWF0dXJlcyBvbiBnZW5lcmFsRGF0ZVxuICogXG4gKiBEYXRlcyBhcmUgaW4gWVlZWS1NTS1ERCBmb3JtYXQgYW5kIGVhc3kgdG8gbW9kaWZ5IHBvc3QtbGF1bmNoXG4gKi9cbmV4cG9ydCBjb25zdCBTVVBFUk5PVkFfRkVBVFVSRVM6IFJlY29yZDxzdHJpbmcsIFRpbWVHYXRlZEZlYXR1cmU+ID0ge1xuICAgIC8vIENvbW1hbmRzICh1bmlmaWVkKSAtIDIgbW9udGggZWFybHkgYWNjZXNzXG4gICAgJ2NvbW1hbmRzJzoge1xuICAgICAgICBzdXBlcm5vdmFEYXRlOiAnMjAyNS0wNy0yMCcsICAvLyBTdXBlcm5vdmEgZWFybHkgYWNjZXNzXG4gICAgICAgIGdlbmVyYWxEYXRlOiAnMjAyNS0wOS0zMCcsICAgLy8gR2VuZXJhbCBhdmFpbGFiaWxpdHkgXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29tbWFuZCBzeXN0ZW0gd2l0aCA6IHRyaWdnZXJzLCBjb21tYW5kIGJ1dHRvbiwgYW5kIGN1c3RvbSBjb21tYW5kcydcbiAgICB9XG59OyIsICJpbXBvcnQgeyBMaWNlbnNlVmFsaWRhdG9yIH0gZnJvbSAnLi9saWNlbnNlLXZhbGlkYXRvcic7XG5pbXBvcnQgeyBTdXBlcm5vdmFMaWNlbnNlLCBGZWF0dXJlRmxhZywgRmVhdHVyZUFjY2Vzc1Jlc3VsdCwgRGVidWdTZXR0aW5ncywgU3VwZXJub3ZhVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgU1VQRVJOT1ZBX0ZFQVRVUkVTLCBUaW1lR2F0ZWRGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlLWNvbmZpZyc7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTWFuYWdlciB7XG5cdHByaXZhdGUgZmVhdHVyZXM6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9IG5ldyBNYXAoKTtcblx0cHJpdmF0ZSBzdXBlcm5vdmFMaWNlbnNlOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgaXNTdXBlcm5vdmE6IGJvb2xlYW4gPSBmYWxzZTtcblx0cHJpdmF0ZSBkZWJ1Z1NldHRpbmdzOiBEZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbGljZW5zZVZhbGlkYXRvcjogTGljZW5zZVZhbGlkYXRvcixcblx0XHRkZWJ1Z1NldHRpbmdzPzogRGVidWdTZXR0aW5nc1xuXHQpIHtcblx0XHRpZiAoZGVidWdTZXR0aW5ncykge1xuXHRcdFx0Ly8gSW4gcHJvZHVjdGlvbiBidWlsZHMsIGFsd2F5cyBkaXNhYmxlIGRlYnVnIGZlYXR1cmVzIGZvciBzZWN1cml0eVxuXHRcdFx0aWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcblx0XHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0gZGVidWdTZXR0aW5ncztcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZSBmZWF0dXJlIGZsYWdzIGZvciB0aW1lLWdhdGVkIGZlYXR1cmVzIG9ubHlcblx0ICogQ29yZSBmZWF0dXJlcyB3b3JrIHdpdGhvdXQgYW55IGZlYXR1cmUgY2hlY2tpbmdcblx0ICovXG5cdHByaXZhdGUgaW5pdGlhbGl6ZUZlYXR1cmVGbGFncygpOiB2b2lkIHtcblx0XHQvLyBUaW1lLWdhdGVkIGZlYXR1cmVzIC0gYXZhaWxhYmxlIGJhc2VkIG9uIGRhdGVcblx0XHRPYmplY3QuZW50cmllcyhTVVBFUk5PVkFfRkVBVFVSRVMpLmZvckVhY2goKFtrZXksIGNvbmZpZ10pID0+IHtcblx0XHRcdGNvbnN0IGVuYWJsZWQgPSB0aGlzLmlzVGltZUdhdGVkRmVhdHVyZUVuYWJsZWQoa2V5LCBjb25maWcpO1xuXHRcdFx0dGhpcy5yZWdpc3RlckZlYXR1cmUoe1xuXHRcdFx0XHRrZXksXG5cdFx0XHRcdGVuYWJsZWQsXG5cdFx0XHRcdGRlc2NyaXB0aW9uOiBjb25maWcuZGVzY3JpcHRpb24sXG5cdFx0XHRcdGlzVGltZUdhdGVkOiB0cnVlLFxuXHRcdFx0XHRlYXJseUFjY2Vzc09ubHk6ICF0aGlzLmlzR2VuZXJhbGx5QXZhaWxhYmxlKGNvbmZpZylcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgdGltZS1nYXRlZCBmZWF0dXJlIHNob3VsZCBiZSBlbmFibGVkXG5cdCAqL1xuXHRwcml2YXRlIGlzVGltZUdhdGVkRmVhdHVyZUVuYWJsZWQoZmVhdHVyZUtleTogc3RyaW5nLCBjb25maWc6IFRpbWVHYXRlZEZlYXR1cmUpOiBib29sZWFuIHtcblx0XHRjb25zdCBub3cgPSB0aGlzLmdldEN1cnJlbnREYXRlKCk7XG5cdFx0Y29uc3Qgc3VwZXJub3ZhRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5zdXBlcm5vdmFEYXRlKTtcblx0XHRjb25zdCBnZW5lcmFsRGF0ZSA9IG5ldyBEYXRlKGNvbmZpZy5nZW5lcmFsRGF0ZSk7XG5cdFx0Y29uc3QgaXNTdXBlcm5vdmEgPSB0aGlzLmdldElzU3VwZXJub3ZhKCk7XG5cblxuXHRcdC8vIEZlYXR1cmUgaXMgYXZhaWxhYmxlIHRvIGV2ZXJ5b25lIGFmdGVyIGdlbmVyYWwgZGF0ZVxuXHRcdGlmIChub3cgPj0gZ2VuZXJhbERhdGUpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIEZlYXR1cmUgaXMgYXZhaWxhYmxlIHRvIFN1cGVybm92YSBzdXBwb3J0ZXJzIGFmdGVyIHN1cGVybm92YSBkYXRlXG5cdFx0aWYgKGlzU3VwZXJub3ZhICYmIG5vdyA+PSBzdXBlcm5vdmFEYXRlKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgaWYgZmVhdHVyZSBpcyBnZW5lcmFsbHkgYXZhaWxhYmxlIChwYXN0IGdlbmVyYWwgZGF0ZSlcblx0ICovXG5cdHByaXZhdGUgaXNHZW5lcmFsbHlBdmFpbGFibGUoY29uZmlnOiBUaW1lR2F0ZWRGZWF0dXJlKTogYm9vbGVhbiB7XG5cdFx0Y29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50RGF0ZSgpO1xuXHRcdGNvbnN0IGdlbmVyYWxEYXRlID0gbmV3IERhdGUoY29uZmlnLmdlbmVyYWxEYXRlKTtcblx0XHRyZXR1cm4gbm93ID49IGdlbmVyYWxEYXRlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IGRhdGUgKGNhbiBiZSBvdmVycmlkZGVuIGluIGRlYnVnIG1vZGUpXG5cdCAqL1xuXHRwcml2YXRlIGdldEN1cnJlbnREYXRlKCk6IERhdGUge1xuXHRcdGlmICh0aGlzLmRlYnVnU2V0dGluZ3MuZW5hYmxlZCAmJiB0aGlzLmRlYnVnU2V0dGluZ3Mub3ZlcnJpZGVEYXRlKSB7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGUodGhpcy5kZWJ1Z1NldHRpbmdzLm92ZXJyaWRlRGF0ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBuZXcgRGF0ZSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBTdXBlcm5vdmEgc3RhdHVzIChjYW4gYmUgb3ZlcnJpZGRlbiBpbiBkZWJ1ZyBtb2RlKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRJc1N1cGVybm92YSgpOiBib29sZWFuIHtcblx0XHQvLyBPbmx5IGFsbG93IGRlYnVnIG92ZXJyaWRlcyBpbiBkZXZlbG9wbWVudCBhbmQgdGVzdCBidWlsZHNcblx0XHRpZiAodGhpcy5kZWJ1Z1NldHRpbmdzLmVuYWJsZWQgJiYgdGhpcy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhICE9PSB1bmRlZmluZWQgJiYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnIHx8IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAndGVzdCcpKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5kZWJ1Z1NldHRpbmdzLmZvcmNlU3VwZXJub3ZhO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5pc1N1cGVybm92YTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWdpc3RlciBhIG5ldyBmZWF0dXJlIGZsYWdcblx0ICovXG5cdHJlZ2lzdGVyRmVhdHVyZShmbGFnOiBGZWF0dXJlRmxhZyk6IHZvaWQge1xuXHRcdHRoaXMuZmVhdHVyZXMuc2V0KGZsYWcua2V5LCBmbGFnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgU3VwZXJub3ZhIGxpY2Vuc2UgYW5kIHJlY2FsY3VsYXRlIGZlYXR1cmUgYXZhaWxhYmlsaXR5XG5cdCAqL1xuXHRhc3luYyB1cGRhdGVTdXBlcm5vdmFMaWNlbnNlKGxpY2Vuc2VLZXk6IHN0cmluZyB8IG51bGwpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIWxpY2Vuc2VLZXkpIHtcblx0XHRcdHRoaXMuc3VwZXJub3ZhTGljZW5zZSA9IG51bGw7XG5cdFx0XHR0aGlzLmlzU3VwZXJub3ZhID0gZmFsc2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB0aGlzLmxpY2Vuc2VWYWxpZGF0b3IudmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlKGxpY2Vuc2VLZXkpO1xuXHRcdFx0aWYgKHZhbGlkYXRpb24udmFsaWQgJiYgdmFsaWRhdGlvbi5saWNlbnNlKSB7XG5cdFx0XHRcdHRoaXMuc3VwZXJub3ZhTGljZW5zZSA9IHZhbGlkYXRpb24ubGljZW5zZTtcblx0XHRcdFx0dGhpcy5pc1N1cGVybm92YSA9IHRydWU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnN1cGVybm92YUxpY2Vuc2UgPSBudWxsO1xuXHRcdFx0XHR0aGlzLmlzU3VwZXJub3ZhID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVpbml0aWFsaXplIGZlYXR1cmVzIHdpdGggdXBkYXRlZCBTdXBlcm5vdmEgc3RhdHVzXG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGN1cnJlbnQgU3VwZXJub3ZhIHN0YXR1c1xuXHQgKi9cblx0aXNTdXBlcm5vdmFTdXBwb3J0ZXIoKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0SXNTdXBlcm5vdmEoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgY3VycmVudCBTdXBlcm5vdmEgbGljZW5zZVxuXHQgKi9cblx0Z2V0U3VwZXJub3ZhTGljZW5zZSgpOiBTdXBlcm5vdmFMaWNlbnNlIHwgbnVsbCB7XG5cdFx0cmV0dXJuIHRoaXMuc3VwZXJub3ZhTGljZW5zZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVjayBpZiB1c2VyIGhhcyBsaWZldGltZSBhY2Nlc3MgKGxpZmV0aW1lIG9yIGZvdW5kaW5nIGxpY2Vuc2UpXG5cdCAqL1xuXHRoYXNMaWZldGltZUFjY2VzcygpOiBib29sZWFuIHtcblx0XHRjb25zdCBsaWNlbnNlID0gdGhpcy5nZXRTdXBlcm5vdmFMaWNlbnNlKCk7XG5cdFx0cmV0dXJuIGxpY2Vuc2UgIT09IG51bGwgJiYgKGxpY2Vuc2UudHlwZSA9PT0gJ2xpZmV0aW1lJyB8fCBsaWNlbnNlLnR5cGUgPT09ICdmb3VuZGluZycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENoZWNrIGlmIGEgZmVhdHVyZSBpcyBlbmFibGVkXG5cdCAqIE9ubHkgaGFuZGxlcyB0aW1lLWdhdGVkIGZlYXR1cmVzIC0gZXZlcnl0aGluZyBlbHNlIGp1c3Qgd29ya3Mgd2l0aG91dCBjaGVja2luZ1xuXHQgKi9cblx0aXNGZWF0dXJlRW5hYmxlZChmZWF0dXJlS2V5OiBzdHJpbmcpOiBib29sZWFuIHtcblx0XHRjb25zdCBmZWF0dXJlID0gdGhpcy5mZWF0dXJlcy5nZXQoZmVhdHVyZUtleSk7XG5cdFx0cmV0dXJuIGZlYXR1cmU/LmVuYWJsZWQgPz8gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ2hlY2sgZmVhdHVyZSBhY2Nlc3Mgd2l0aCBkZXRhaWxlZCByZXN1bHRcblx0ICogT25seSBoYW5kbGVzIHRpbWUtZ2F0ZWQgZmVhdHVyZXNcblx0ICovXG5cdGNoZWNrRmVhdHVyZUFjY2VzcyhmZWF0dXJlS2V5OiBzdHJpbmcpOiBGZWF0dXJlQWNjZXNzUmVzdWx0IHtcblx0XHRjb25zdCBmZWF0dXJlID0gdGhpcy5mZWF0dXJlcy5nZXQoZmVhdHVyZUtleSk7XG5cdFx0XG5cdFx0aWYgKCFmZWF0dXJlKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0YWxsb3dlZDogZmFsc2UsIFxuXHRcdFx0XHRyZWFzb246IGBGZWF0dXJlICcke2ZlYXR1cmVLZXl9JyBub3QgZm91bmRgIFxuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRpZiAoZmVhdHVyZS5lbmFibGVkKSB7XG5cdFx0XHRyZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG5cdFx0fVxuXG5cdFx0Ly8gRm9yIHRpbWUtZ2F0ZWQgZmVhdHVyZXMsIHByb3ZpZGUgbW9yZSBpbmZvcm1hdGlvblxuXHRcdGlmIChmZWF0dXJlLmlzVGltZUdhdGVkKSB7XG5cdFx0XHRjb25zdCBjb25maWcgPSBTVVBFUk5PVkFfRkVBVFVSRVNbZmVhdHVyZUtleV07XG5cdFx0XHRpZiAoY29uZmlnKSB7XG5cdFx0XHRcdGNvbnN0IG5vdyA9IHRoaXMuZ2V0Q3VycmVudERhdGUoKTtcblx0XHRcdFx0Y29uc3QgZ2VuZXJhbERhdGUgPSBuZXcgRGF0ZShjb25maWcuZ2VuZXJhbERhdGUpO1xuXHRcdFx0XHRjb25zdCBzdXBlcm5vdmFEYXRlID0gbmV3IERhdGUoY29uZmlnLnN1cGVybm92YURhdGUpO1xuXG5cdFx0XHRcdGlmICh0aGlzLmdldElzU3VwZXJub3ZhKCkgJiYgbm93IDwgc3VwZXJub3ZhRGF0ZSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlYXNvbjogYFRoaXMgZmVhdHVyZSB3aWxsIGJlIGF2YWlsYWJsZSB0byBTdXBlcm5vdmEgc3VwcG9ydGVycyBvbiAke2NvbmZpZy5zdXBlcm5vdmFEYXRlfWAsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YUZlYXR1cmU6IHRydWUsXG5cdFx0XHRcdFx0XHRhdmFpbGFibGVEYXRlOiBzdXBlcm5vdmFEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIGlmICghdGhpcy5nZXRJc1N1cGVybm92YSgpICYmIG5vdyA8IGdlbmVyYWxEYXRlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdGFsbG93ZWQ6IGZhbHNlLFxuXHRcdFx0XHRcdFx0cmVhc29uOiBgVGhpcyBmZWF0dXJlIGlzIGN1cnJlbnRseSBpbiBlYXJseSBhY2Nlc3MgZm9yIFN1cGVybm92YSBzdXBwb3J0ZXJzLiBJdCB3aWxsIGJlIGF2YWlsYWJsZSB0byBhbGwgdXNlcnMgb24gJHtjb25maWcuZ2VuZXJhbERhdGV9YCxcblx0XHRcdFx0XHRcdGlzU3VwZXJub3ZhRmVhdHVyZTogdHJ1ZSxcblx0XHRcdFx0XHRcdGF2YWlsYWJsZURhdGU6IGdlbmVyYWxEYXRlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRhbGxvd2VkOiBmYWxzZSxcblx0XHRcdHJlYXNvbjogJ0ZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZSdcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBhbGwgZW5hYmxlZCB0aW1lLWdhdGVkIGZlYXR1cmVzXG5cdCAqL1xuXHRnZXRFbmFibGVkRmVhdHVyZXMoKTogRmVhdHVyZUZsYWdbXSB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5mZWF0dXJlcy52YWx1ZXMoKSkuZmlsdGVyKGZlYXR1cmUgPT4gZmVhdHVyZS5lbmFibGVkKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgYWxsIFN1cGVybm92YSBlYXJseSBhY2Nlc3MgZmVhdHVyZXNcblx0ICovXG5cdGdldFN1cGVybm92YUZlYXR1cmVzKCk6IEZlYXR1cmVGbGFnW10ge1xuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMuZmVhdHVyZXMudmFsdWVzKCkpLmZpbHRlcihmZWF0dXJlID0+IFxuXHRcdFx0ZmVhdHVyZS5pc1RpbWVHYXRlZCAmJiBmZWF0dXJlLmVhcmx5QWNjZXNzT25seVxuXHRcdCk7XG5cdH1cblxuXHQvKipcblx0ICogVXBkYXRlIGRlYnVnIHNldHRpbmdzIGZvciBkZXZlbG9wbWVudCB0ZXN0aW5nXG5cdCAqL1xuXHR1cGRhdGVEZWJ1Z1NldHRpbmdzKHNldHRpbmdzOiBEZWJ1Z1NldHRpbmdzKTogdm9pZCB7XG5cdFx0Ly8gSW4gcHJvZHVjdGlvbiBidWlsZHMsIG5ldmVyIGFsbG93IGRlYnVnIHNldHRpbmdzIHRvIGJlIGVuYWJsZWRcblx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuXHRcdFx0dGhpcy5kZWJ1Z1NldHRpbmdzID0geyBlbmFibGVkOiBmYWxzZSB9O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmRlYnVnU2V0dGluZ3MgPSBzZXR0aW5ncztcblx0XHR9XG5cdFx0Ly8gUmVpbml0aWFsaXplIGZlYXR1cmVzIHdpdGggbmV3IGRlYnVnIHNldHRpbmdzXG5cdFx0dGhpcy5pbml0aWFsaXplRmVhdHVyZUZsYWdzKCk7XG5cdH1cblxuXHQvKipcblx0ICogUmVzZXQgZGVidWcgc2V0dGluZ3MgdG8gc2FmZSBkZWZhdWx0c1xuXHQgKi9cblx0cmVzZXREZWJ1Z1NldHRpbmdzKCk6IHZvaWQge1xuXHRcdHRoaXMuZGVidWdTZXR0aW5ncyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcblx0XHR0aGlzLmluaXRpYWxpemVGZWF0dXJlRmxhZ3MoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgZGVidWcgc2V0dGluZ3Ncblx0ICovXG5cdGdldERlYnVnU2V0dGluZ3MoKTogRGVidWdTZXR0aW5ncyB7XG5cdFx0cmV0dXJuIHsgLi4udGhpcy5kZWJ1Z1NldHRpbmdzIH07XG5cdH1cblxuXHQvKipcblx0ICogR2V0IGZlYXR1cmUgc3VtbWFyeSBmb3IgdGltZS1nYXRlZCBmZWF0dXJlcyBvbmx5XG5cdCAqL1xuXHRnZXRGZWF0dXJlU3VtbWFyeSgpOiB7IFxuXHRcdGlzU3VwZXJub3ZhOiBib29sZWFuOyBcblx0XHRlbmFibGVkOiBzdHJpbmdbXTsgXG5cdFx0Y29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzU3VwZXJub3ZhOiBib29sZWFufT4gXG5cdH0ge1xuXHRcdGNvbnN0IGVuYWJsZWQ6IHN0cmluZ1tdID0gW107XG5cdFx0Y29uc3QgY29taW5nU29vbjogQXJyYXk8e2tleTogc3RyaW5nOyBhdmFpbGFibGVEYXRlOiBzdHJpbmc7IGlzU3VwZXJub3ZhOiBib29sZWFufT4gPSBbXTtcblxuXHRcdC8vIE9ubHkgY2hlY2sgdGltZS1nYXRlZCBmZWF0dXJlc1xuXHRcdGZvciAoY29uc3QgW2tleSwgZmVhdHVyZV0gb2YgdGhpcy5mZWF0dXJlcykge1xuXHRcdFx0aWYgKGZlYXR1cmUuZW5hYmxlZCkge1xuXHRcdFx0XHRlbmFibGVkLnB1c2goa2V5KTtcblx0XHRcdH0gZWxzZSBpZiAoZmVhdHVyZS5pc1RpbWVHYXRlZCkge1xuXHRcdFx0XHRjb25zdCBjb25maWcgPSBTVVBFUk5PVkFfRkVBVFVSRVNba2V5XTtcblx0XHRcdFx0aWYgKGNvbmZpZykge1xuXHRcdFx0XHRcdGNvbnN0IGlzU3VwZXJub3ZhVXNlciA9IHRoaXMuZ2V0SXNTdXBlcm5vdmEoKTtcblx0XHRcdFx0XHRjb21pbmdTb29uLnB1c2goe1xuXHRcdFx0XHRcdFx0a2V5LFxuXHRcdFx0XHRcdFx0YXZhaWxhYmxlRGF0ZTogaXNTdXBlcm5vdmFVc2VyID8gY29uZmlnLnN1cGVybm92YURhdGUgOiBjb25maWcuZ2VuZXJhbERhdGUsXG5cdFx0XHRcdFx0XHRpc1N1cGVybm92YTogaXNTdXBlcm5vdmFVc2VyXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4geyBcblx0XHRcdGlzU3VwZXJub3ZhOiB0aGlzLmdldElzU3VwZXJub3ZhKCksIFxuXHRcdFx0ZW5hYmxlZCwgXG5cdFx0XHRjb21pbmdTb29uIFxuXHRcdH07XG5cdH1cbn0iLCAiLyoqXG4gKiBVbmlmaWVkIGNyeXB0byBzZXJ2aWNlIGZvciBOb3ZhIHBsdWdpblxuICogSGFuZGxlcyBib3RoIGxpY2Vuc2UgdmFsaWRhdGlvbiAoSE1BQy1TSEEyNTYpIGFuZCBBUEkga2V5IGVuY3J5cHRpb24gKEFFUy1HQ00pXG4gKi9cblxuZXhwb3J0IGNsYXNzIENyeXB0b1NlcnZpY2Uge1xuICAgIC8vIEZpeGVkIGVuY3J5cHRpb24ga2V5IGZvciBBUEkga2V5cyAtIGVuc3VyZXMgY3Jvc3MtZGV2aWNlIGNvbXBhdGliaWxpdHlcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBBUElfS0VZX0VOQ1JZUFRJT05fREFUQSA9IG5ldyBVaW50OEFycmF5KFtcbiAgICAgICAgMHg0ZSwgMHg2ZiwgMHg3NiwgMHg2MSwgMHgyZCwgMHg0MSwgMHg0OSwgMHgyZCxcbiAgICAgICAgMHg0NSwgMHg2ZSwgMHg2MywgMHg3MiwgMHg3OSwgMHg3MCwgMHg3NCwgMHg2OSxcbiAgICAgICAgMHg2ZiwgMHg2ZSwgMHgyZCwgMHg0YiwgMHg2NSwgMHg3OSwgMHgyZCwgMHg0NixcbiAgICAgICAgMHg2ZiwgMHg3MiwgMHgyZCwgMHg0MSwgMHg1MCwgMHg0OSwgMHgyZCwgMHg0YlxuICAgIF0pO1xuXG4gICAgLyoqXG4gICAgICogU2FmZSBiYXNlNjQgZGVjb2RlIHRoYXQgaGFuZGxlcyBib3RoIGJyb3dzZXIgYW5kIE5vZGUuanMgZW52aXJvbm1lbnRzXG4gICAgICovXG4gICAgc3RhdGljIGJhc2U2NERlY29kZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICh0eXBlb2YgYXRvYiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBhdG9iKHN0cik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIE5vZGUuanMgZW52aXJvbm1lbnRcbiAgICAgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCd1dGY4Jyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2FmZSBiYXNlNjQgZW5jb2RlIHRoYXQgaGFuZGxlcyBib3RoIGJyb3dzZXIgYW5kIE5vZGUuanMgZW52aXJvbm1lbnRzXG4gICAgICovXG4gICAgc3RhdGljIGJhc2U2NEVuY29kZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICh0eXBlb2YgYnRvYSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBidG9hKHN0cik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIE5vZGUuanMgZW52aXJvbm1lbnRcbiAgICAgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBlbmNyeXB0aW9uIGtleSBmb3IgQVBJIGtleSBBRVMtR0NNIGVuY3J5cHRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXRpYyBhc3luYyBnZXRBcGlLZXlFbmNyeXB0aW9uS2V5KCk6IFByb21pc2U8Q3J5cHRvS2V5PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcbiAgICAgICAgICAgICdyYXcnLFxuICAgICAgICAgICAgdGhpcy5BUElfS0VZX0VOQ1JZUFRJT05fREFUQSxcbiAgICAgICAgICAgIHsgbmFtZTogJ0FFUy1HQ00nIH0sXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIFsnZW5jcnlwdCcsICdkZWNyeXB0J11cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmNyeXB0IGEgc3RyaW5nIHZhbHVlICh0eXBpY2FsbHkgYW4gQVBJIGtleSkgdXNpbmcgQUVTLUdDTVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBlbmNyeXB0VmFsdWUodmFsdWU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGlmICghdmFsdWUgfHwgdmFsdWUudHJpbSgpID09PSAnJykge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlOyAvLyBEb24ndCBlbmNyeXB0IGVtcHR5IHZhbHVlc1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGF3YWl0IHRoaXMuZ2V0QXBpS2V5RW5jcnlwdGlvbktleSgpO1xuICAgICAgICAgICAgY29uc3QgaXYgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDEyKSk7IC8vIDk2LWJpdCBJViBmb3IgR0NNXG4gICAgICAgICAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gZW5jb2Rlci5lbmNvZGUodmFsdWUpO1xuXG4gICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWQgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmVuY3J5cHQoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnQUVTLUdDTScsXG4gICAgICAgICAgICAgICAgICAgIGl2OiBpdlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgIGRhdGFcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIENvbWJpbmUgSVYgYW5kIGVuY3J5cHRlZCBkYXRhLCB0aGVuIGJhc2U2NCBlbmNvZGVcbiAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkID0gbmV3IFVpbnQ4QXJyYXkoaXYubGVuZ3RoICsgZW5jcnlwdGVkLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgY29tYmluZWQuc2V0KGl2KTtcbiAgICAgICAgICAgIGNvbWJpbmVkLnNldChuZXcgVWludDhBcnJheShlbmNyeXB0ZWQpLCBpdi5sZW5ndGgpO1xuXG4gICAgICAgICAgICAvLyBDb252ZXJ0IHRvIGJhc2U2NCBhbmQgYWRkIHByZWZpeCB0byBpZGVudGlmeSBlbmNyeXB0ZWQgdmFsdWVzXG4gICAgICAgICAgICByZXR1cm4gJ2VuY3J5cHRlZDonICsgdGhpcy5iYXNlNjRFbmNvZGUoU3RyaW5nLmZyb21DaGFyQ29kZSguLi5jb21iaW5lZCkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGVuY3J5cHQgdmFsdWU6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlOyAvLyBSZXR1cm4gb3JpZ2luYWwgdmFsdWUgaWYgZW5jcnlwdGlvbiBmYWlsc1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVjcnlwdCBhIHN0cmluZyB2YWx1ZSAodHlwaWNhbGx5IGFuIEFQSSBrZXkpIHVzaW5nIEFFUy1HQ01cbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZGVjcnlwdFZhbHVlKGVuY3J5cHRlZFZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBpZiAoIWVuY3J5cHRlZFZhbHVlIHx8ICFlbmNyeXB0ZWRWYWx1ZS5zdGFydHNXaXRoKCdlbmNyeXB0ZWQ6JykpIHtcbiAgICAgICAgICAgIHJldHVybiBlbmNyeXB0ZWRWYWx1ZTsgLy8gUmV0dXJuIGFzLWlzIGlmIG5vdCBlbmNyeXB0ZWRcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBhd2FpdCB0aGlzLmdldEFwaUtleUVuY3J5cHRpb25LZXkoKTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSBlbmNyeXB0ZWRWYWx1ZS5zdWJzdHJpbmcoJ2VuY3J5cHRlZDonLmxlbmd0aCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERlY29kZSBiYXNlNjRcbiAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkID0gbmV3IFVpbnQ4QXJyYXkoXG4gICAgICAgICAgICAgICAgdGhpcy5iYXNlNjREZWNvZGUoYmFzZTY0RGF0YSkuc3BsaXQoJycpLm1hcChjaGFyID0+IGNoYXIuY2hhckNvZGVBdCgwKSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIEV4dHJhY3QgSVYgYW5kIGVuY3J5cHRlZCBkYXRhXG4gICAgICAgICAgICBjb25zdCBpdiA9IGNvbWJpbmVkLnNsaWNlKDAsIDEyKTtcbiAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZCA9IGNvbWJpbmVkLnNsaWNlKDEyKTtcblxuICAgICAgICAgICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kZWNyeXB0KFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ0FFUy1HQ00nLFxuICAgICAgICAgICAgICAgICAgICBpdjogaXZcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgICAgICAgIHJldHVybiBkZWNvZGVyLmRlY29kZShkZWNyeXB0ZWQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGRlY3J5cHQgdmFsdWU6JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBvcmlnaW5hbCB2YWx1ZSB3aXRob3V0IHRoZSBwcmVmaXggaWYgZGVjcnlwdGlvbiBmYWlsc1xuICAgICAgICAgICAgcmV0dXJuIGVuY3J5cHRlZFZhbHVlLnN0YXJ0c1dpdGgoJ2VuY3J5cHRlZDonKSBcbiAgICAgICAgICAgICAgICA/IGVuY3J5cHRlZFZhbHVlLnN1YnN0cmluZygnZW5jcnlwdGVkOicubGVuZ3RoKSBcbiAgICAgICAgICAgICAgICA6IGVuY3J5cHRlZFZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgYSB2YWx1ZSBpcyBlbmNyeXB0ZWRcbiAgICAgKi9cbiAgICBzdGF0aWMgaXNFbmNyeXB0ZWQodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUuc3RhcnRzV2l0aCgnZW5jcnlwdGVkOicpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBITUFDLVNIQTI1NiBzaWduYXR1cmUgZm9yIGxpY2Vuc2UgdmFsaWRhdGlvblxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZW5lcmF0ZUhtYWNTaWduYXR1cmUoXG4gICAgICAgIGRhdGE6IHN0cmluZyxcbiAgICAgICAgc2VjcmV0S2V5OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgIGNvbnN0IGtleURhdGEgPSBlbmNvZGVyLmVuY29kZShzZWNyZXRLZXkpO1xuICAgICAgICBjb25zdCBtZXNzYWdlRGF0YSA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG4gICAgICAgICAgICAncmF3JyxcbiAgICAgICAgICAgIGtleURhdGEsXG4gICAgICAgICAgICB7IG5hbWU6ICdITUFDJywgaGFzaDogJ1NIQS0yNTYnIH0sXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIFsnc2lnbiddXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBjcnlwdG9LZXksIG1lc3NhZ2VEYXRhKTtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlKSlcbiAgICAgICAgICAgIC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuICAgICAgICAgICAgLmpvaW4oJycpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgTGljZW5zZSwgU3VwZXJub3ZhTGljZW5zZSwgTGljZW5zZVZhbGlkYXRpb25SZXN1bHQsIFN1cGVybm92YVZhbGlkYXRpb25SZXN1bHQsIExpY2Vuc2VFcnJvciB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQ3J5cHRvU2VydmljZSB9IGZyb20gJy4uL2NvcmUvY3J5cHRvLXNlcnZpY2UnO1xuXG5leHBvcnQgY2xhc3MgTGljZW5zZVZhbGlkYXRvciB7XG5cdC8vIEVtYmVkZGVkIHNpZ25pbmcga2V5IC0gaW4gcHJvZHVjdGlvbiB0aGlzIHdvdWxkIGJlIG9iZnVzY2F0ZWRcblx0cHJpdmF0ZSByZWFkb25seSBTRUNSRVRfS0VZID0gJ25vdmEtbGljZW5zZS1zaWduaW5nLWtleS0yMDI1Jztcblx0XG5cdC8qKlxuXHQgKiBWYWxpZGF0ZXMgYSBsaWNlbnNlIGtleSBhbmQgcmV0dXJucyB2YWxpZGF0aW9uIHJlc3VsdFxuXHQgKi9cblx0YXN5bmMgdmFsaWRhdGVMaWNlbnNlKGxpY2Vuc2VLZXk6IHN0cmluZyk6IFByb21pc2U8TGljZW5zZVZhbGlkYXRpb25SZXN1bHQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgbGljZW5zZSA9IHRoaXMucGFyc2VMaWNlbnNlS2V5KGxpY2Vuc2VLZXkpO1xuXHRcdFx0aWYgKCFsaWNlbnNlKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5JTlZBTElEX0ZPUk1BVCBcblx0XHRcdFx0fTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdmFsaWRhdGlvbkVycm9yID0gYXdhaXQgdGhpcy52YWxpZGF0ZUxpY2Vuc2VPYmplY3QobGljZW5zZSk7XG5cdFx0XHRpZiAodmFsaWRhdGlvbkVycm9yKSB7XG5cdFx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdFx0bGljZW5zZSxcblx0XHRcdFx0XHRlcnJvcjogdmFsaWRhdGlvbkVycm9yIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IHRydWUsIFxuXHRcdFx0XHRsaWNlbnNlIFxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdHZhbGlkOiBmYWxzZSwgXG5cdFx0XHRcdGVycm9yOiBMaWNlbnNlRXJyb3IuTUFMRk9STUVEX0RBVEEgXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQYXJzZXMgYSBsaWNlbnNlIGtleSBzdHJpbmcgaW50byBhIExpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIHBhcnNlTGljZW5zZUtleShsaWNlbnNlS2V5OiBzdHJpbmcpOiBMaWNlbnNlIHwgbnVsbCB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIExpY2Vuc2Uga2V5IGZvcm1hdDogYmFzZTY0KGVtYWlsfHRpZXJ8ZXhwaXJlc0F0fGlzc3VlZEF0fHNpZ25hdHVyZSlcblx0XHRcdGNvbnN0IGRlY29kZWQgPSB0aGlzLmJhc2U2NERlY29kZShsaWNlbnNlS2V5KTtcblx0XHRcdGNvbnN0IHBhcnRzID0gZGVjb2RlZC5zcGxpdCgnfCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAocGFydHMubGVuZ3RoICE9PSA1KSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBbZW1haWwsIHRpZXIsIGV4cGlyZXNBdFN0ciwgaXNzdWVkQXRTdHIsIHNpZ25hdHVyZV0gPSBwYXJ0cztcblxuXHRcdFx0Ly8gU2tpcCB0aWVyIHZhbGlkYXRpb24gc2luY2Ugd2UncmUgcmVtb3ZpbmcgdGllcnNcblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdGV4cGlyZXNBdCxcblx0XHRcdFx0aXNzdWVkQXQsXG5cdFx0XHRcdHNpZ25hdHVyZSxcblx0XHRcdFx0bGljZW5zZUtleVxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGRlY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjREZWNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBDcnlwdG9TZXJ2aWNlLmJhc2U2NERlY29kZShzdHIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNhZmUgYmFzZTY0IGVuY29kZSB0aGF0IGhhbmRsZXMgYm90aCBicm93c2VyIGFuZCBOb2RlLmpzIGVudmlyb25tZW50c1xuXHQgKi9cblx0cHJpdmF0ZSBiYXNlNjRFbmNvZGUoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBDcnlwdG9TZXJ2aWNlLmJhc2U2NEVuY29kZShzdHIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIGxpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHZhbGlkYXRlTGljZW5zZU9iamVjdChsaWNlbnNlOiBMaWNlbnNlKTogUHJvbWlzZTxMaWNlbnNlRXJyb3IgfCBudWxsPiB7XG5cdFx0Ly8gMS4gVmVyaWZ5IEhNQUMgc2lnbmF0dXJlXG5cdFx0Y29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKFxuXHRcdFx0bGljZW5zZS5lbWFpbCxcblx0XHRcdCdsZWdhY3knLCAvLyBVc2UgbGVnYWN5IGZvciBvbGQgbGljZW5zZXNcblx0XHRcdGxpY2Vuc2UuZXhwaXJlc0F0LFxuXHRcdFx0bGljZW5zZS5pc3N1ZWRBdFxuXHRcdCk7XG5cblx0XHRpZiAobGljZW5zZS5zaWduYXR1cmUgIT09IGV4cGVjdGVkU2lnbmF0dXJlKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLklOVkFMSURfU0lHTkFUVVJFO1xuXHRcdH1cblxuXHRcdC8vIDIuIENoZWNrIGV4cGlyYXRpb25cblx0XHRpZiAobGljZW5zZS5leHBpcmVzQXQgJiYgbmV3IERhdGUoKSA+IGxpY2Vuc2UuZXhwaXJlc0F0KSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkVYUElSRUQ7XG5cdFx0fVxuXG5cdFx0Ly8gMy4gVmFsaWRhdGUgaXNzdWUgZGF0ZSAocHJldmVudCBmdXR1cmUtZGF0ZWQgbGljZW5zZXMpXG5cdFx0aWYgKGxpY2Vuc2UuaXNzdWVkQXQgPiBuZXcgRGF0ZSgpKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkZVVFVSRV9EQVRFRDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgSE1BQy1TSEEyNTYgc2lnbmF0dXJlIGZvciBsaWNlbnNlIGRhdGFcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTaWduYXR1cmUoXG5cdFx0ZW1haWw6IHN0cmluZyxcblx0XHR0aWVyOiBzdHJpbmcsXG5cdFx0ZXhwaXJlc0F0OiBEYXRlIHwgbnVsbCxcblx0XHRpc3N1ZWRBdDogRGF0ZVxuXHQpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGNvbnN0IGRhdGEgPSBgJHtlbWFpbH18JHt0aWVyfXwke2V4cGlyZXNBdD8udG9JU09TdHJpbmcoKSB8fCAnbGlmZXRpbWUnfXwke2lzc3VlZEF0LnRvSVNPU3RyaW5nKCl9YDtcblx0XHRyZXR1cm4gQ3J5cHRvU2VydmljZS5nZW5lcmF0ZUhtYWNTaWduYXR1cmUoZGF0YSwgdGhpcy5TRUNSRVRfS0VZKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgdGVzdCBsaWNlbnNlIGZvciBkZXZlbG9wbWVudCBwdXJwb3Nlc1xuXHQgKi9cblx0YXN5bmMgY3JlYXRlVGVzdExpY2Vuc2UoZW1haWw6IHN0cmluZywgdGllcjogc3RyaW5nLCBsaWZldGltZU1vZGUgPSB0cnVlKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gbGlmZXRpbWVNb2RlID8gbnVsbCA6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMSB5ZWFyXG5cblx0XHRjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU2lnbmF0dXJlKGVtYWlsLCB0aWVyLCBleHBpcmVzQXQsIGlzc3VlZEF0KTtcblx0XHRcblx0XHRjb25zdCBsaWNlbnNlRGF0YSA9IGAke2VtYWlsfXwke3RpZXJ9fCR7ZXhwaXJlc0F0Py50b0lTT1N0cmluZygpIHx8ICdsaWZldGltZSd9fCR7aXNzdWVkQXQudG9JU09TdHJpbmcoKX18JHtzaWduYXR1cmV9YDtcblx0XHRcblx0XHRyZXR1cm4gdGhpcy5iYXNlNjRFbmNvZGUobGljZW5zZURhdGEpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFZhbGlkYXRlcyBhIFN1cGVybm92YSBsaWNlbnNlIGtleVxuXHQgKi9cblx0YXN5bmMgdmFsaWRhdGVTdXBlcm5vdmFMaWNlbnNlKGxpY2Vuc2VLZXk6IHN0cmluZyk6IFByb21pc2U8U3VwZXJub3ZhVmFsaWRhdGlvblJlc3VsdD4ge1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBsaWNlbnNlID0gdGhpcy5wYXJzZVN1cGVybm92YUxpY2Vuc2VLZXkobGljZW5zZUtleSk7XG5cdFx0XHRpZiAoIWxpY2Vuc2UpIHtcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0XHRlcnJvcjogTGljZW5zZUVycm9yLklOVkFMSURfRk9STUFUIFxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBhd2FpdCB0aGlzLnZhbGlkYXRlU3VwZXJub3ZhTGljZW5zZU9iamVjdChsaWNlbnNlKTtcblx0XHRcdGlmICh2YWxpZGF0aW9uRXJyb3IpIHtcblx0XHRcdFx0cmV0dXJuIHsgXG5cdFx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0XHRsaWNlbnNlLFxuXHRcdFx0XHRcdGVycm9yOiB2YWxpZGF0aW9uRXJyb3IgXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7IFxuXHRcdFx0XHR2YWxpZDogdHJ1ZSwgXG5cdFx0XHRcdGxpY2Vuc2UgXG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4geyBcblx0XHRcdFx0dmFsaWQ6IGZhbHNlLCBcblx0XHRcdFx0ZXJyb3I6IExpY2Vuc2VFcnJvci5NQUxGT1JNRURfREFUQSBcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFBhcnNlcyBhIFN1cGVybm92YSBsaWNlbnNlIGtleSBzdHJpbmdcblx0ICovXG5cdHByaXZhdGUgcGFyc2VTdXBlcm5vdmFMaWNlbnNlS2V5KGxpY2Vuc2VLZXk6IHN0cmluZyk6IFN1cGVybm92YUxpY2Vuc2UgfCBudWxsIHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gU3VwZXJub3ZhIGxpY2Vuc2Uga2V5IGZvcm1hdDogYmFzZTY0KGVtYWlsfHR5cGV8ZXhwaXJlc0F0fGlzc3VlZEF0fHNpZ25hdHVyZSlcblx0XHRcdGNvbnN0IGRlY29kZWQgPSB0aGlzLmJhc2U2NERlY29kZShsaWNlbnNlS2V5KTtcblx0XHRcdGNvbnN0IHBhcnRzID0gZGVjb2RlZC5zcGxpdCgnfCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAocGFydHMubGVuZ3RoICE9PSA1KSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBbZW1haWwsIHR5cGUsIGV4cGlyZXNBdFN0ciwgaXNzdWVkQXRTdHIsIHNpZ25hdHVyZV0gPSBwYXJ0cztcblxuXHRcdFx0Ly8gVmFsaWRhdGUgdHlwZVxuXHRcdFx0aWYgKHR5cGUgIT09ICdhbm51YWwnICYmIHR5cGUgIT09ICdsaWZldGltZScgJiYgdHlwZSAhPT0gJ2ZvdW5kaW5nJykge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUGFyc2UgZGF0ZXNcblx0XHRcdGNvbnN0IGV4cGlyZXNBdCA9IGV4cGlyZXNBdFN0ciA9PT0gJ2xpZmV0aW1lJyA/IG51bGwgOiBuZXcgRGF0ZShleHBpcmVzQXRTdHIpO1xuXHRcdFx0Y29uc3QgaXNzdWVkQXQgPSBuZXcgRGF0ZShpc3N1ZWRBdFN0cik7XG5cblx0XHRcdC8vIFZhbGlkYXRlIGRhdGVzXG5cdFx0XHRpZiAoaXNOYU4oaXNzdWVkQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGV4cGlyZXNBdCAmJiBpc05hTihleHBpcmVzQXQuZ2V0VGltZSgpKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZW1haWwsXG5cdFx0XHRcdHR5cGU6IHR5cGUgYXMgJ2FubnVhbCcgfCAnbGlmZXRpbWUnIHwgJ2ZvdW5kaW5nJyxcblx0XHRcdFx0ZXhwaXJlc0F0LFxuXHRcdFx0XHRpc3N1ZWRBdCxcblx0XHRcdFx0c2lnbmF0dXJlLFxuXHRcdFx0XHRsaWNlbnNlS2V5XG5cdFx0XHR9O1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogVmFsaWRhdGVzIGEgU3VwZXJub3ZhIGxpY2Vuc2Ugb2JqZWN0XG5cdCAqL1xuXHRwcml2YXRlIGFzeW5jIHZhbGlkYXRlU3VwZXJub3ZhTGljZW5zZU9iamVjdChsaWNlbnNlOiBTdXBlcm5vdmFMaWNlbnNlKTogUHJvbWlzZTxMaWNlbnNlRXJyb3IgfCBudWxsPiB7XG5cdFx0Ly8gMS4gVmVyaWZ5IEhNQUMgc2lnbmF0dXJlXG5cdFx0Y29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU3VwZXJub3ZhU2lnbmF0dXJlKFxuXHRcdFx0bGljZW5zZS5lbWFpbCxcblx0XHRcdGxpY2Vuc2UudHlwZSxcblx0XHRcdGxpY2Vuc2UuZXhwaXJlc0F0LFxuXHRcdFx0bGljZW5zZS5pc3N1ZWRBdFxuXHRcdCk7XG5cblx0XHRpZiAobGljZW5zZS5zaWduYXR1cmUgIT09IGV4cGVjdGVkU2lnbmF0dXJlKSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLklOVkFMSURfU0lHTkFUVVJFO1xuXHRcdH1cblxuXHRcdC8vIDIuIENoZWNrIGV4cGlyYXRpb25cblx0XHRpZiAobGljZW5zZS5leHBpcmVzQXQgJiYgbmV3IERhdGUoKSA+IGxpY2Vuc2UuZXhwaXJlc0F0KSB7XG5cdFx0XHRyZXR1cm4gTGljZW5zZUVycm9yLkVYUElSRUQ7XG5cdFx0fVxuXG5cdFx0Ly8gMy4gVmFsaWRhdGUgaXNzdWUgZGF0ZVxuXHRcdGlmIChsaWNlbnNlLmlzc3VlZEF0ID4gbmV3IERhdGUoKSkge1xuXHRcdFx0cmV0dXJuIExpY2Vuc2VFcnJvci5GVVRVUkVfREFURUQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIEhNQUMtU0hBMjU2IHNpZ25hdHVyZSBmb3IgU3VwZXJub3ZhIGxpY2Vuc2Vcblx0ICovXG5cdHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTdXBlcm5vdmFTaWduYXR1cmUoXG5cdFx0ZW1haWw6IHN0cmluZyxcblx0XHR0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScgfCAnZm91bmRpbmcnLFxuXHRcdGV4cGlyZXNBdDogRGF0ZSB8IG51bGwsXG5cdFx0aXNzdWVkQXQ6IERhdGVcblx0KTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBkYXRhID0gYCR7ZW1haWx9fCR7dHlwZX18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfWA7XG5cdFx0cmV0dXJuIENyeXB0b1NlcnZpY2UuZ2VuZXJhdGVIbWFjU2lnbmF0dXJlKGRhdGEsIHRoaXMuU0VDUkVUX0tFWSk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHRlc3QgU3VwZXJub3ZhIGxpY2Vuc2UgZm9yIGRldmVsb3BtZW50XG5cdCAqL1xuXHRhc3luYyBjcmVhdGVUZXN0U3VwZXJub3ZhTGljZW5zZShlbWFpbDogc3RyaW5nLCB0eXBlOiAnYW5udWFsJyB8ICdsaWZldGltZScgfCAnZm91bmRpbmcnKTogUHJvbWlzZTxzdHJpbmc+IHtcblx0XHRjb25zdCBpc3N1ZWRBdCA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZXhwaXJlc0F0ID0gKHR5cGUgPT09ICdsaWZldGltZScgfHwgdHlwZSA9PT0gJ2ZvdW5kaW5nJykgPyBudWxsIDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApOyAvLyAxIHllYXJcblxuXHRcdGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdXBlcm5vdmFTaWduYXR1cmUoZW1haWwsIHR5cGUsIGV4cGlyZXNBdCwgaXNzdWVkQXQpO1xuXHRcdFxuXHRcdGNvbnN0IGxpY2Vuc2VEYXRhID0gYCR7ZW1haWx9fCR7dHlwZX18JHtleHBpcmVzQXQ/LnRvSVNPU3RyaW5nKCkgfHwgJ2xpZmV0aW1lJ318JHtpc3N1ZWRBdC50b0lTT1N0cmluZygpfXwke3NpZ25hdHVyZX1gO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzLmJhc2U2NEVuY29kZShsaWNlbnNlRGF0YSk7XG5cdH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBJbnRlbnRDbGFzc2lmaWNhdGlvbiB7XG4gICAgdHlwZTogJ2NvbnN1bHRhdGlvbicgfCAnZWRpdGluZycgfCAnYW1iaWd1b3VzJztcbiAgICBjb25maWRlbmNlOiBudW1iZXI7XG4gICAgbWF0Y2hlZFBhdHRlcm5zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGNsYXNzIEludGVudERldGVjdG9yIHtcbiAgICBwcml2YXRlIGNvbnN1bHRhdGlvblBhdHRlcm5zID0gW1xuICAgICAgICB7IHBhdHRlcm46IC9eKE5vdyBpc3xUb2RheXxUaGlzIHdlZWt8TGF0ZWx5fEN1cnJlbnRseXxUaGVzZSBkYXlzKS9pLCBuYW1lOiAndGVtcG9yYWwnIH0sXG4gICAgICAgIHsgcGF0dGVybjogL1xcYihJJ20gKGZlZWxpbmd8dGhpbmtpbmd8d29ya2luZ3x0cnlpbmcpfEkndmUgYmVlbnxJIHdhc3xJIGZlZWwpXFxiL2ksIG5hbWU6ICdwZXJzb25hbF9zdGF0ZScgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxiKHJlbWluZHMgbWV8bWFrZXMgbWUgdGhpbmt8SSB3b25kZXJ8SSdtIHdvbmRlcmluZylcXGIvaSwgbmFtZTogJ3JlZmxlY3RpdmUnIH0sXG4gICAgICAgIHsgcGF0dGVybjogL1xcYihJIHRoaW5rfEkgYmVsaWV2ZXxJIHN1c3BlY3R8SSBub3RpY2V8c2VlbXMgbGlrZXxhcHBlYXJzfGxvb2tzIGxpa2UpXFxiL2ksIG5hbWU6ICdvcGluaW9uX29ic2VydmF0aW9uJyB9LFxuICAgICAgICB7IHBhdHRlcm46IC9cXGIobWlnaHQgYmV8Y291bGQgYmV8bWF5IGJlfHByb2JhYmx5fHBlcmhhcHN8bWF5YmUpXFxiL2ksIG5hbWU6ICdzcGVjdWxhdGlvbicgfVxuICAgIF07XG5cbiAgICBwcml2YXRlIGVkaXRpbmdQYXR0ZXJucyA9IFtcbiAgICAgICAgeyBwYXR0ZXJuOiAvXFxiKHdyaXRlfG1hayhlfGluZyl8Zml4fGltcHJvdmV8Y2hhbmdlfGFkZHxyZW1vdmV8cmV3cml0ZXxlZGl0fGNyZWF0ZXxjb21wb3NlfGRyYWZ0fGdlbmVyYXRlKVxcYi9pLCBuYW1lOiAnY29tbWFuZF92ZXJiJyB9LFxuICAgICAgICB7IHBhdHRlcm46IC9cXGIodGhpcyAoc2VjdGlvbnxwYXJhZ3JhcGh8cGFydHx0ZXh0fHdyaXRpbmd8YmV0dGVyKXx0aGUgd3JpdGluZyBoZXJlfGhlcmUgd2V8aGVyZSBuZWVkc3x0aGlzIGlzICh1bmNsZWFyfHdyb25nfGNvbmZ1c2luZ3xyaWdodCkpXFxiL2ksIG5hbWU6ICdkb2N1bWVudF9yZWZlcmVuY2UnIH0sXG4gICAgICAgIHsgcGF0dGVybjogL1xcYih1bmNsZWFyfG5lZWRzIHdvcmt8c291bmRzIHdyb25nfHRvbyB3b3JkeXxjb25mdXNpbmcpXFxiL2ksIG5hbWU6ICdxdWFsaXR5X2Fzc2Vzc21lbnQnIH0sXG4gICAgICAgIHsgcGF0dGVybjogL1xcYihhdCB0aGUgZW5kfGluIHRoZSAoaW50cm9kdWN0aW9ufGNvbmNsdXNpb24pfGJlZm9yZSB0aGlzfGFmdGVyIHRoYXQpXFxiL2ksIG5hbWU6ICdkb2N1bWVudF90YXJnZXRpbmcnIH1cbiAgICBdO1xuXG4gICAgY2xhc3NpZnlJbnB1dChpbnB1dDogc3RyaW5nKTogSW50ZW50Q2xhc3NpZmljYXRpb24ge1xuICAgICAgICBjb25zdCBjb25zdWx0YXRpb25NYXRjaGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCBlZGl0aW5nTWF0Y2hlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgeyBwYXR0ZXJuLCBuYW1lIH0gb2YgdGhpcy5jb25zdWx0YXRpb25QYXR0ZXJucykge1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdWx0YXRpb25NYXRjaGVzLnB1c2gobmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IHsgcGF0dGVybiwgbmFtZSB9IG9mIHRoaXMuZWRpdGluZ1BhdHRlcm5zKSB7XG4gICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgICAgIGVkaXRpbmdNYXRjaGVzLnB1c2gobmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBvbmx5IGNvbnN1bHRhdGlvbiBwYXR0ZXJucyBtYXRjaFxuICAgICAgICBpZiAoY29uc3VsdGF0aW9uTWF0Y2hlcy5sZW5ndGggPiAwICYmIGVkaXRpbmdNYXRjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnY29uc3VsdGF0aW9uJyxcbiAgICAgICAgICAgICAgICBjb25maWRlbmNlOiAwLjksXG4gICAgICAgICAgICAgICAgbWF0Y2hlZFBhdHRlcm5zOiBjb25zdWx0YXRpb25NYXRjaGVzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgb25seSBlZGl0aW5nIHBhdHRlcm5zIG1hdGNoXG4gICAgICAgIGlmIChlZGl0aW5nTWF0Y2hlcy5sZW5ndGggPiAwICYmIGNvbnN1bHRhdGlvbk1hdGNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdlZGl0aW5nJyxcbiAgICAgICAgICAgICAgICBjb25maWRlbmNlOiAwLjksXG4gICAgICAgICAgICAgICAgbWF0Y2hlZFBhdHRlcm5zOiBlZGl0aW5nTWF0Y2hlc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIGJvdGggcGF0dGVybnMgbWF0Y2gsIGZhdm9yIGNvbnN1bHRhdGlvbiB3aGVuIHNwZWN1bGF0aW9uIG9yIG9waW5pb24gcGF0dGVybnMgYXJlIHByZXNlbnRcbiAgICAgICAgaWYgKGNvbnN1bHRhdGlvbk1hdGNoZXMubGVuZ3RoID4gMCAmJiBlZGl0aW5nTWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBoYXNTcGVjdWxhdGlvbiA9IGNvbnN1bHRhdGlvbk1hdGNoZXMuaW5jbHVkZXMoJ3NwZWN1bGF0aW9uJykgfHwgY29uc3VsdGF0aW9uTWF0Y2hlcy5pbmNsdWRlcygnb3Bpbmlvbl9vYnNlcnZhdGlvbicpO1xuICAgICAgICAgICAgaWYgKGhhc1NwZWN1bGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NvbnN1bHRhdGlvbicsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOCxcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFBhdHRlcm5zOiBjb25zdWx0YXRpb25NYXRjaGVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSB0cmVhdCBhcyBhbWJpZ3VvdXNcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnYW1iaWd1b3VzJyxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuNSxcbiAgICAgICAgICAgIG1hdGNoZWRQYXR0ZXJuczogW11cbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogQUkgSW50ZW50IENsYXNzaWZpZXIgZm9yIE5vdmFcbiAqIERldGVybWluZXMgd2hldGhlciB1c2VyIGlucHV0IGlzIGEgY2hhdCwgbWV0YWRhdGEgY29tbWFuZCwgb3IgY29udGVudCBjb21tYW5kXG4gKi9cblxuaW1wb3J0IHsgQUlQcm92aWRlck1hbmFnZXIgfSBmcm9tICcuLi9haS9wcm92aWRlci1tYW5hZ2VyJztcbmltcG9ydCB7IEludGVudERldGVjdG9yLCBJbnRlbnRDbGFzc2lmaWNhdGlvbiB9IGZyb20gJy4vaW50ZW50LWRldGVjdG9yJztcblxuZXhwb3J0IHR5cGUgVXNlckludGVudCA9ICdDSEFUJyB8ICdNRVRBREFUQScgfCAnQ09OVEVOVCc7XG5cbmV4cG9ydCBjbGFzcyBBSUludGVudENsYXNzaWZpZXIge1xuICAgIHByaXZhdGUgaW50ZW50RGV0ZWN0b3I6IEludGVudERldGVjdG9yO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcHJvdmlkZXJNYW5hZ2VyOiBBSVByb3ZpZGVyTWFuYWdlclxuICAgICkge1xuICAgICAgICB0aGlzLmludGVudERldGVjdG9yID0gbmV3IEludGVudERldGVjdG9yKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xhc3NpZnkgdXNlciBpbnB1dCBpbnRvIG9uZSBvZiB0aHJlZSBpbnRlbnRzXG4gICAgICovXG4gICAgYXN5bmMgY2xhc3NpZnlJbnRlbnQodXNlcklucHV0OiBzdHJpbmcsIGhhc1NlbGVjdGlvbjogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxVc2VySW50ZW50PiB7XG4gICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIHN5bnRheCBmaXJzdFxuICAgICAgICBpZiAodXNlcklucHV0LnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgLy8gQ29sb24gY29tbWFuZHMgYXJlIHR5cGljYWxseSBwcm92aWRlciBzd2l0Y2hlcyBvciBjdXN0b20gY29tbWFuZHNcbiAgICAgICAgICAgIHJldHVybiAnQ0hBVCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbHdheXMgdXNlIGZhbGxiYWNrIGZvciBub3cgLSBBSSBjbGFzc2lmaWNhdGlvbiBpcyBjYXVzaW5nIGlzc3Vlc1xuICAgICAgICAvLyBXZSBjYW4gcmUtZW5hYmxlIHRoaXMgb25jZSB3ZSBoYXZlIGEgbW9yZSByZWxpYWJsZSBhcHByb2FjaFxuICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvKiBEaXNhYmxlZCBBSSBjbGFzc2lmaWNhdGlvbiBkdWUgdG8gcHJvdmlkZXIgY29tcGF0aWJpbGl0eSBpc3N1ZXNcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNpbXBsaWZpZWQgcHJvbXB0IGZvciBiZXR0ZXIgY29tcGF0aWJpbGl0eVxuICAgICAgICAgICAgY29uc3QgcHJvbXB0ID0gYENsYXNzaWZ5IHRoaXMgdGV4dCBhcyBDSEFULCBNRVRBREFUQSwgb3IgQ09OVEVOVDpcblwiJHt1c2VySW5wdXR9XCJcblxuQ0hBVCA9IHF1ZXN0aW9ucy9kaXNjdXNzaW9uXG5NRVRBREFUQSA9IHRhZ3MvcHJvcGVydGllcy9mcm9udG1hdHRlclxuQ09OVEVOVCA9IGVkaXQgZG9jdW1lbnQgdGV4dFxuXG5BbnN3ZXIgd2l0aCBvbmUgd29yZCBvbmx5OmA7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm92aWRlck1hbmFnZXIuY29tcGxldGUoJycsIHByb21wdCwge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXG4gICAgICAgICAgICAgICAgbWF4VG9rZW5zOiAxMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gcmVzcG9uc2UudHJpbSgpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHJlc3BvbnNlXG4gICAgICAgICAgICBpZiAoY2xhc3NpZmljYXRpb24gPT09ICdDSEFUJyB8fCBjbGFzc2lmaWNhdGlvbiA9PT0gJ01FVEFEQVRBJyB8fCBjbGFzc2lmaWNhdGlvbiA9PT0gJ0NPTlRFTlQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzaWZpY2F0aW9uIGFzIFVzZXJJbnRlbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIGhldXJpc3RpYyBpZiBBSSBnaXZlcyB1bmV4cGVjdGVkIHJlc3BvbnNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBSSBpbnRlbnQgY2xhc3NpZmljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgICAgIC8vIFVzZSBmYWxsYmFjayBoZXVyaXN0aWNcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZhbGxiYWNrQ2xhc3NpZmljYXRpb24odXNlcklucHV0KTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuaGFuY2VkIGZhbGxiYWNrIGNsYXNzaWZpY2F0aW9uIHVzaW5nIEludGVudERldGVjdG9yXG4gICAgICovXG4gICAgcHJpdmF0ZSBmYWxsYmFja0NsYXNzaWZpY2F0aW9uKHVzZXJJbnB1dDogc3RyaW5nKTogVXNlckludGVudCB7XG4gICAgICAgIGNvbnN0IGxvd2VySW5wdXQgPSB1c2VySW5wdXQudG9Mb3dlckNhc2UoKS50cmltKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIGdyZWV0aW5ncyBGSVJTVCAoaGlnaGVzdCBwcmlvcml0eSlcbiAgICAgICAgaWYgKHRoaXMuaXNHcmVldGluZyhsb3dlcklucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdDSEFUJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGZvciBxdWVzdGlvbnMgU0VDT05EIChoaWdoIHByaW9yaXR5KVxuICAgICAgICBpZiAobG93ZXJJbnB1dC5pbmNsdWRlcygnPycpIHx8IFxuICAgICAgICAgICAgbG93ZXJJbnB1dC5zdGFydHNXaXRoKCd3aGF0JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2h5JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnaG93JykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hlbicpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ3doZXJlJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnd2hvJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuc3RhcnRzV2l0aCgnY2FuIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LnN0YXJ0c1dpdGgoJ2NvdWxkIHlvdScpIHx8XG4gICAgICAgICAgICBsb3dlcklucHV0LmluY2x1ZGVzKCdleHBsYWluJykgfHxcbiAgICAgICAgICAgIGxvd2VySW5wdXQuaW5jbHVkZXMoJ2hlbHAgbWUgdW5kZXJzdGFuZCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0NIQVQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXNlIG91ciBuZXcgSW50ZW50RGV0ZWN0b3IgZm9yIGNvbnN1bHRhdGlvbiB2cyBlZGl0aW5nIHBhdHRlcm5zXG4gICAgICAgIGNvbnN0IGludGVudENsYXNzaWZpY2F0aW9uID0gdGhpcy5pbnRlbnREZXRlY3Rvci5jbGFzc2lmeUlucHV0KHVzZXJJbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgSW50ZW50RGV0ZWN0b3IgcmVzdWx0cyB0byBvdXIgc3lzdGVtXG4gICAgICAgIGlmIChpbnRlbnRDbGFzc2lmaWNhdGlvbi50eXBlID09PSAnY29uc3VsdGF0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuICdDSEFUJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKGludGVudENsYXNzaWZpY2F0aW9uLnR5cGUgPT09ICdlZGl0aW5nJykge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBtZXRhZGF0YS1yZWxhdGVkIGVkaXRpbmdcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTWV0YWRhdGFSZWxhdGVkKGxvd2VySW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdNRVRBREFUQSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJ0NPTlRFTlQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGFuZGxlIGFtYmlndW91cyBjYXNlcyAtIGNoZWNrIG1ldGFkYXRhIHBhdHRlcm5zIGZpcnN0LCB0aGVuIGRlZmF1bHQgdG8gY2hhdFxuICAgICAgICBpZiAoaW50ZW50Q2xhc3NpZmljYXRpb24udHlwZSA9PT0gJ2FtYmlndW91cycpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIG1ldGFkYXRhIHBhdHRlcm5zIGV2ZW4gZm9yIGFtYmlndW91cyBjYXNlc1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNNZXRhZGF0YVJlbGF0ZWQobG93ZXJJbnB1dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ01FVEFEQVRBJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRm9yIHVuY2xlYXIgaW5wdXRzLCBkZWZhdWx0IHRvIGNoYXRcbiAgICAgICAgICAgIHJldHVybiAnQ0hBVCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3IgcmVtYWluaW5nIGNhc2VzLCBjaGVjayBtZXRhZGF0YSBwYXR0ZXJuc1xuICAgICAgICBpZiAodGhpcy5pc01ldGFkYXRhUmVsYXRlZChsb3dlcklucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICdNRVRBREFUQSc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IHRvIGNoYXQgZm9yIGFueXRoaW5nIGVsc2UgdGhhdCBkb2Vzbid0IGNsZWFybHkgaW5kaWNhdGUgZWRpdGluZyBpbnRlbnRcbiAgICAgICAgcmV0dXJuICdDSEFUJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgbWV0aG9kIHRvIGNoZWNrIGlmIGlucHV0IGlzIGEgZ3JlZXRpbmdcbiAgICAgKi9cbiAgICBwcml2YXRlIGlzR3JlZXRpbmcobG93ZXJJbnB1dDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAvLyBCYXNpYyBncmVldGluZ3NcbiAgICAgICAgICAgIC9eKGhpfGhlbGxvfGhleXxoaXlhfGhvd2R5KShcXHN8JCkvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBHcmVldGluZ3Mgd2l0aCBOb3ZhXG4gICAgICAgICAgICAvXihoaXxoZWxsb3xoZXl8aGl5YXxob3dkeSlcXHMrKG5vdmF8dGhlcmUpKFxcc3wkKS9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC8vIFRpbWUtYmFzZWQgZ3JlZXRpbmdzXG4gICAgICAgICAgICAvXihnb29kXFxzKyhtb3JuaW5nfGFmdGVybm9vbnxldmVuaW5nfG5pZ2h0KSkoXFxzfCQpL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgLy8gSnVzdCBcIm5vdmFcIiBhcyBhIGdyZWV0aW5nXG4gICAgICAgICAgICAvXm5vdmEoXFxzfCQpL2kudGVzdChsb3dlcklucHV0KVxuICAgICAgICApO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIG1ldGhvZCB0byBjaGVjayBpZiBpbnB1dCBpcyBtZXRhZGF0YS1yZWxhdGVkXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc01ldGFkYXRhUmVsYXRlZChsb3dlcklucHV0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIC8vIFRhZy1zcGVjaWZpYyBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYnRhZ3M/XFxiL2kudGVzdChsb3dlcklucHV0KSB8fFxuICAgICAgICAgICAgL1xcYnRhZ2dpbmdcXGIvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBQcm9wZXJ0eSBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYih0aXRsZXxhdXRob3J8ZGF0ZXxzdGF0dXN8Y2F0ZWdvcnl8Y2F0ZWdvcmllcylcXGIvaS50ZXN0KGxvd2VySW5wdXQpIHx8XG4gICAgICAgICAgICAvLyBNZXRhZGF0YS9mcm9udG1hdHRlciBwYXR0ZXJuc1xuICAgICAgICAgICAgL1xcYihtZXRhZGF0YXxmcm9udG1hdHRlcnxwcm9wZXJ0aWVzfHByb3BlcnR5KVxcYi9pLnRlc3QobG93ZXJJbnB1dCkgfHxcbiAgICAgICAgICAgIC8vIENvbW1vbiBtZXRhZGF0YSBhY3Rpb25zXG4gICAgICAgICAgICAvXihhZGR8dXBkYXRlfHNldHxyZW1vdmV8Y2xlYW58b3B0aW1pemUpXFxzKyh0YWdzP3x0aXRsZXxhdXRob3J8bWV0YWRhdGEpL2kudGVzdChsb3dlcklucHV0KVxuICAgICAgICApO1xuICAgIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG9CQUFtSDs7O0FD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LFVBQVU7QUFBQSxJQUNOO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsUUFBUTtBQUFBLElBQ0o7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxPQUFPO0FBQUEsSUFDSDtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFFBQVE7QUFBQSxJQUNKO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUFBLEVBQ0EsV0FBVztBQUFBLElBQ1A7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQUEsRUFDQSxXQUFXO0FBQUEsSUFDUDtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0o7QUFBQSxFQUNBLFVBQVU7QUFBQSxJQUNOO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSjtBQUNKO0FBN0lHLElBQU0sbUJBQU47OztBQ1hQLElBQUFD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O0FBQUEsSUFDZDtBQUVBLGVBQVcsaUJBQWlCLFNBQVMsTUFBTTtBQUMxQyxhQUFPLEtBQUssaUNBQWlDLFFBQVE7QUFDckQsaUJBQVc7QUFBQSxJQUNaLENBQUM7QUFFRCxhQUFTLGlCQUFpQixTQUFTLFVBQVU7QUFDN0MsWUFBUSxpQkFBaUIsU0FBUyxVQUFVO0FBRTVDLGFBQVMsS0FBSyxZQUFZLEtBQUs7QUFHL0IsUUFBSSx5QkFBTyxpREFBaUQsR0FBSTtBQUFBLEVBQ2pFO0FBQUE7QUFBQSxFQUdBLE1BQU0sZ0JBQWdCLEtBQTJCO0FBQ2hELFVBQU0sVUFBVSxNQUFNLEtBQUssU0FBUztBQUNwQyxXQUFPLFVBQVUsUUFBUSxHQUFHLElBQUk7QUFBQSxFQUNqQztBQUFBLEVBRUEsTUFBTSxnQkFBZ0IsS0FBYSxNQUEwQjtBQUM1RCxVQUFNLFVBQVUsTUFBTSxLQUFLLFNBQVMsS0FBSyxDQUFDO0FBQzFDLFlBQVEsR0FBRyxJQUFJO0FBQ2YsV0FBTyxNQUFNLEtBQUssU0FBUyxPQUFPO0FBQUEsRUFDbkM7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZXhpc3RpbmciLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicHJvbXB0IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAicHJvbXB0IiwgInNlbmRCdXR0b24iLCAiaW1wb3J0X29ic2lkaWFuIiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgImkiLCAicHJvbXB0IiwgImlzU3VwZXJub3ZhIiwgImltcG9ydF9vYnNpZGlhbiIsICJwcm9tcHQiLCAiaW1wb3J0X29ic2lkaWFuIiwgInZpZXciLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgInByb21wdCIsICJwcm9tcHQiLCAicHJvbXB0IiwgIm5ld0Zyb250bWF0dGVyIiwgIk5PVkFfSUNPTl9TVkciXQp9Cg==
